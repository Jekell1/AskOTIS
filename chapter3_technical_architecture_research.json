{
  "Q1": {
    "question": "What is the typical structure of a COBOL program in OTIS? What are the main divisions?",
    "answer": "A typical COBOL program in the OTIS system follows the standard COBOL structure, which is organized into several main divisions. These divisions are consistent across OTIS/OTOS programs and define the logical organization of the code. Here’s an overview:\n\n### Main Divisions in OTIS COBOL Programs\n\n1. **IDENTIFICATION DIVISION**\n   - **Purpose:** Specifies metadata about the program, such as its name, author, and date written.\n   - **Example:**  \n     ```cobol\n     IDENTIFICATION DIVISION.\n     PROGRAM-ID. INSTAL.\n     AUTHOR. BLM.\n     DATE-WRITTEN. 07/27/2012.\n     ```\n     (Source: [[FILE:INSTAL.CBL|INSTAL.CBL]], Lines 1-25)\n\n2. **ENVIRONMENT DIVISION**\n   - **Purpose:** Describes the system environment, including configuration and file assignments.\n   - **Sections:**\n     - CONFIGURATION SECTION: Defines hardware/software environment.\n     - INPUT-OUTPUT SECTION: Specifies files used by the program.\n   - **Example:**  \n     ```cobol\n     ENVIRONMENT DIVISION.\n     CONFIGURATION SECTION.\n     SOURCE-COMPUTER. 3B.\n     OBJECT-COMPUTER. 3B.\n     ```\n     (Source: [[FILE:PERUSE.CBL|PERUSE.CBL]], Lines 51-75)\n\n3. **DATA DIVISION**\n   - **Purpose:** Declares all variables, data structures, and file layouts.\n   - **Sections:**\n     - FILE SECTION: Defines file records.\n     - WORKING-STORAGE SECTION: Declares variables and constants.\n     - SCREEN SECTION: (for interactive programs) Defines screen layouts.\n   - **Example:**  \n     ```cobol\n     WORKING-STORAGE SECTION.\n     01  BEG-BR           PIC 9(4).\n     01  END-BR           PIC 9(4).\n     01  COCODES.\n         05  COCODE       PIC XX OCCURS 30.\n     ```\n     (Source: [[FILE:IR1098.CBL|IR1098.CBL]], Lines 151-175)\n\n4. **PROCEDURE DIVISION**\n   - **Purpose:** Contains the executable logic—paragraphs, sections, and statements that perform the program’s tasks.\n   - **Structure:** Organized into paragraphs (e.g., MAIN-MODULE, ENTRY-MODULE, WRITE-MODULE).\n   - **Example:**  \n     ```cobol\n     PROCEDURE DIVISION.\n     MAIN-MODULE.\n         PERFORM INITIALIZATION\n         PERFORM ENTRY-MODULE\n         PERFORM WRITE-MODULE\n         STOP RUN.\n     ```\n     (Source: [[FILE:JCMAIN|JCMAIN]], [[FILE:I|I]]ndex: flows)\n\n### Typical OTIS Program Flow\n\n- **Initialization:** Set up environment, variables, and files.\n- **Main Processing:** Handle user input, perform business logic, update records.\n- **Termination:** Close files, clean up, and exit.\n\n### Additional Features in OTIS\n\n- **COPY Statements:** Used extensively to include shared copybooks for data structures, screen layouts, and business rules.\n  - Example:  \n    ```cobol\n    COPY \"LIBGB/[[FILE:SCREENW.CPY|SCREENW.CPY]]\".\n    COPY \"LIBSP/[[FILE:IIMAIN_DEF.CPY|IIMAIN_DEF.CPY]]\".\n    ```\n    (Source: [[FILE:IIMAIN.CBL|IIMAIN.CBL]], Lines 151-175)\n\n- **Screen Section:** Present in interactive programs to define user interface layouts.\n\n---\n\n**Summary Table: OTIS COBOL Program Structure**\n\n| Division               | Purpose                                    | Typical Content/Example                |\n|------------------------|--------------------------------------------|----------------------------------------|\n| IDENTIFICATION         | Program metadata                           | PROGRAM-ID, AUTHOR, DATE-WRITTEN       |\n| ENVIRONMENT            | System and file environment                | CONFIGURATION, INPUT-OUTPUT SECTION    |\n| DATA                   | Data structures and variables              | WORKING-STORAGE, FILE, SCREEN SECTION  |\n| PROCEDURE              | Executable logic and flow                  | Paragraphs, PERFORM, STOP RUN          |\n\n---\n\n**Source Citations:**\n- [[FILE:INSTAL.CBL|INSTAL.CBL]], Lines 1-25 (IDENTIFICATION DIVISION example)\n- [[FILE:PERUSE.CBL|PERUSE.CBL]], Lines 51-75 (ENVIRONMENT DIVISION example)\n- [[FILE:IR1098.CBL|IR1098.CBL]], Lines 151-175 (DATA DIVISION example)\n- JCMAIN, Index: flows (PROCEDURE DIVISION example)\n- [[FILE:IIMAIN.CBL|IIMAIN.CBL]], Lines 151-175 (COPY statement usage)\n\nThis structure is standard across OTIS/OTOS COBOL programs, supporting modularity, maintainability, and clarity in business logic implementation.",
    "sources_count": 100,
    "timing_seconds": 12.592
  },
  "Q2": {
    "question": "How are COBOL programs organized in OTIS? What naming conventions are used?",
    "answer": "COBOL programs in the OTIS/OTOS application are organized using standard COBOL divisions and follow consistent naming conventions that reflect their business domain, function, and subsystem. Here’s a detailed breakdown:\n\n**1. Program Structure in OTIS**\n\nOTIS COBOL programs use the classic COBOL division structure:\n\n- **IDENTIFICATION DIVISION**: Specifies the program name and often includes comments about the business purpose, author, and history.\n  - Example:  \n    ```cobol\n    IDENTIFICATION DIVISION.\n    PROGRAM-ID.      BANKMU.\n    * DESC: BANK PROCESSING MENU\n    ```\n    (Source: [[FILE:BANKMU.CBL|BANKMU.CBL]], Index: code)\n\n- **ENVIRONMENT DIVISION**: Defines the computing environment, including configuration and input/output sections.\n  - Example:  \n    ```cobol\n    ENVIRONMENT DIVISION.\n    CONFIGURATION SECTION.\n    SOURCE-COMPUTER. 3B.\n    OBJECT-COMPUTER. 3B.\n    INPUT-OUTPUT SECTION.\n    FILE-CONTROL.\n    I-O-CONTROL.\n    ```\n    (Source: [[FILE:CHBORR.CBL|CHBORR.CBL]], Index: code)\n\n- **DATA DIVISION**: Contains all data definitions, including file and working-storage sections.\n  - Example:  \n    ```cobol\n    DATA DIVISION.\n    FILE SECTION.\n    WORKING-STORAGE SECTION.\n    ```\n    (Source: [[FILE:REBL01.CBL|REBL01.CBL]], Index: code)\n\n- **PROCEDURE DIVISION**: Contains the executable logic, organized into paragraphs and sections.\n\n**2. Naming Conventions in OTIS**\n\nOTIS/OTOS programs and copybooks use systematic naming conventions to indicate their function and subsystem:\n\n- **Program Names**:\n  - Prefixes indicate subsystem or business area:\n    - **LP**: Loan Processing (e.g., LPPOFF, LONPFB)\n    - **GB**: General Business (e.g., GB01BR)\n    - **CL**: Collection (e.g., CLFILE)\n    - **DL**: Dealer (e.g., DLMAN5)\n    - **IO**: Input/Output (e.g., IOCONN, IOBWRN)\n    - **CH**: Check/Charge (e.g., CHBORR, CHCOCD)\n    - **BW**: Borrower (e.g., BWFILE, BWLNS2)\n    - **PA**: Payment (e.g., PAFILE)\n    - **PS**: Posting (e.g., PSMAIN)\n    - **CDB**: Corporate Database (e.g., CDBMAN, CDBSCN)\n    - **SF**: Special Functions (e.g., SFVERI)\n    - **MB**: Miscellaneous Batch (e.g., MBCORP1)\n    - **RE**: Reporting/Extract (e.g., REBL01, REBB04)\n    - **GP**: General Processing (e.g., GP-PAYOFF-NONCASH)\n    - **SET**: Setup/Configuration (e.g., SETCOL)\n    - **WHOAMI**: Utility/Identification\n\n  - Suffixes or infixes indicate specific function or file:\n    - **FILE**: File handler (e.g., CLFILE, BWFILE)\n    - **MAIN**: Main menu or main logic (e.g., PSMAIN, DSMAIN)\n    - **SCN**: Screen handler (e.g., CDBWMN_SCN)\n    - **DEF**: Definition (e.g., CDBSCN_DEF)\n    - **EVA**: Evaluation (e.g., CDBSCN_EVA)\n    - **WKS**: Workscreen or workspace (e.g., CDBSCN_WKS)\n    - **PF**: Payment File (e.g., LONPFB, LONPF9)\n    - **PG**: Page or program group (e.g., LONPG3, LONPG7)\n\n- **Copybook Names**:\n  - Prefixes match the subsystem (LIBLP for Loan Processing, LIBGB for General Business, etc.)\n  - Suffixes indicate the structure or purpose (e.g., [[FILE:LP01LP.CPY|LP01LP.CPY]] for loan payment structure, [[FILE:ARRAYBR.CPY|ARRAYBR.CPY]] for branch array processing).\n\n**3. Example Program Names and Their Meaning**\n\n| Program Name | Subsystem | Function/Purpose                  |\n|--------------|-----------|-----------------------------------|\n| LPPOFF       | Loan      | Loan Payoff Routine               |\n| BWFILE       | Borrower  | Borrower File Handler             |\n| CLFILE       | Collection| Collection File Handler           |\n| IOCONN       | IO        | SQL Connection Handler            |\n| CDBMAN       | Corporate | Corporate Database Manager        |\n| SFVERI       | Special   | Special Function Verification     |\n| PSMAIN       | Posting   | Posting Main Logic                |\n| REBL01       | Reporting | Report Extract Logic              |\n\n**4. Business Domain Reflection**\n\n- Names are chosen to make it clear which business process or subsystem the program supports.\n- Prefixes and suffixes are consistent, making it easy to identify related programs and their roles.\n\n**Summary**\n\n- **Organization**: Programs are divided into standard COBOL divisions (IDENTIFICATION, ENVIRONMENT, DATA, PROCEDURE).\n- **Naming**: Prefixes indicate subsystem; suffixes indicate function. This helps maintain clarity and consistency across the OTIS/OTOS application.\n\n**Source References:**\n- [[FILE:BANKMU.CBL|BANKMU.CBL]], [[FILE:CHBORR.CBL|CHBORR.CBL]], [[FILE:REBL01.CBL|REBL01.CBL]], BWFILE, CLFILE, IOCONN, CDBMAN, SFVERI, PSMAIN, REBL01, CDBSCN_DEF, CDBSCN_WKS, CDBSCN_EVA (Index: programs, code)\n\nIf you need a full list of program prefixes or want to see how copybooks are named, let me know!",
    "sources_count": 100,
    "timing_seconds": 14.3
  },
  "Q3": {
    "question": "What are the common program types in OTIS (batch, online, utility)?",
    "answer": "In the OTIS/OTOS application, COBOL programs are organized into several common types based on their business function and operational mode. Here are the main program types you’ll encounter:\n\n---\n\n**1. Batch Programs**\n- **Purpose:** Run scheduled or ad-hoc jobs that process large volumes of data without direct user interaction.\n- **Characteristics:**\n  - Executed via job control (JCL), cron, or batch menu.\n  - Often process files, generate reports, or update databases overnight.\n  - May be triggered by other programs (e.g., EOCRON runs batch jobs via cron).\n- **Examples:**\n  - **BATCHP** – Batch form print for document file creation (Source: [[FILE:BATCHP.CBL|BATCHP.CBL]], Index: code)\n  - **EOCRON** – Executes batch steps from cron, automating scheduled tasks (Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code)\n  - **LONPT0** – Handles batch release and processing for loan payments (Source: [[FILE:LONPT0.CBL|LONPT0.CBL]], Index: flows)\n\n---\n\n**2. Online (Interactive) Programs**\n- **Purpose:** Support real-time user interaction via screens/menus, typically for transaction entry, inquiry, or maintenance.\n- **Characteristics:**\n  - Invoked from menus or direct user actions.\n  - Display screens, accept input, validate, and update records immediately.\n  - Use screen copybooks and UI modules.\n- **Examples:**\n  - **LONPW1** – Interactive batch payment processing, displays batches and allows user selection (Source: [[FILE:LONPW1.CBL|LONPW1.CBL]], Index: flows)\n  - **BWINQ2** – Online inquiry for borrower information (Source: [[FILE:BWINQ2.CBL|BWINQ2.CBL]], Index: copybook_usage)\n  - **LPMAN3** – Loan maintenance screen for record entry and updates (Source: [[FILE:LPMAN3|LPMAN3]], [[FILE:I|I]]ndex: flows)\n\n---\n\n**3. Utility Programs**\n- **Purpose:** Perform supporting functions such as file management, environment setup, or data conversion.\n- **Characteristics:**\n  - May be called by other programs or run standalone.\n  - Typically do not interact directly with users or business data.\n  - Handle tasks like directory creation, environment variable setup, or file cleanup.\n- **Examples:**\n  - **C$MAKEDIR** – Directory creation utility (often called by other programs)\n  - **SETENV** – Sets up environment variables for batch/online jobs\n  - **COMMON** – Provides shared routines for message handling and miscellaneous tasks (Source: [[FILE:COMMON|COMMON]], [[FILE:I|I]]ndex: flows)\n\n---\n\n**Summary Table:**\n\n| Program Type   | Purpose/Role                        | Example Programs         | Source Reference                |\n|----------------|-------------------------------------|-------------------------|---------------------------------|\n| Batch          | Scheduled, high-volume processing   | BATCHP, EOCRON, LONPT0  | [[FILE:BATCHP.CBL|BATCHP.CBL]], [[FILE:EOCRON.CBL|EOCRON.CBL]], LONPT0 |\n| Online         | Real-time user interaction          | LONPW1, BWINQ2, LPMAN3  | [[FILE:LONPW1.CBL|LONPW1.CBL]], [[FILE:BWINQ2.CBL|BWINQ2.CBL]], LPMAN3 |\n| Utility        | Supporting functions, file/env mgmt | C$MAKEDIR, SETENV, COMMON| COMMON, Index: flows           |\n\n---\n\n**Business Context:**\n- **Batch programs** automate end-of-day, end-of-month, or periodic processing.\n- **Online programs** enable users to perform transactions, inquiries, and maintenance during business hours.\n- **Utility programs** support both batch and online operations by handling technical tasks.\n\n---\n\n**Source Citations:**\n- \"BATCHP is a batch form print program for document file creation\" (Source: [[FILE:BATCHP.CBL|BATCHP.CBL]], Index: code)\n- \"EOCRON executes batch steps from cron, automating scheduled tasks\" (Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code)\n- \"LONPW1 displays batches and allows user selection for processing\" (Source: [[FILE:LONPW1.CBL|LONPW1.CBL]], Index: flows)\n- \"COMMON provides shared routines for message handling\" (Source: [[FILE:COMMON|COMMON]], [[FILE:I|I]]ndex: flows)\n\n---\n\n**Here's a visual representation:**\n\n<svg width=\"700\" height=\"350\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Program Types</text>\n  \n  <!-- Batch Programs -->\n  <rect x=\"50\" y=\"70\" width=\"180\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"140\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">Batch</text>\n  <text x=\"140\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">BATCHP, EOCRON, LONPT0</text>\n  \n  <!-- Online Programs -->\n  <rect x=\"260\" y=\"70\" width=\"180\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Online</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">LONPW1, BWINQ2, LPMAN3</text>\n  \n  <!-- Utility Programs -->\n  <rect x=\"470\" y=\"70\" width=\"180\" height=\"80\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"560\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Utility</text>\n  <text x=\"560\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">C$MAKEDIR, SETENV, COMMON</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"140\" y1=\"150\" x2=\"350\" y2=\"150\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"150\" x2=\"560\" y2=\"150\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>",
    "sources_count": 100,
    "timing_seconds": 14.423
  },
  "Q4": {
    "question": "How do COBOL programs handle error processing and exception handling in OTIS?",
    "answer": "COBOL programs in the OTIS/OTOS application handle error processing and exception handling using a combination of structured code patterns, special data items, and dedicated error-handling routines. Here’s how error and exception handling is typically implemented:\n\n---\n\n**1. Use of Dedicated Error-Handling Programs**\n\n- Many OTIS programs call specialized error-handling modules such as `ERRLOG`, `ERRMSG`, and `SQLERR`.\n  - These programs are often leaf modules (called but do not call others) and are invoked whenever an error condition is detected.\n  - Example:  \n    - `ERRLOG` is called by other programs to log errors (Source: [[FILE:ERRLOG|ERRLOG]], [[FILE:I|I]]ndex: programs).\n    - `ERRMSG` is called to display or process error messages (Source: [[FILE:ERRMSG|ERRMSG]], [[FILE:I|I]]ndex: programs).\n    - `SQLERR` handles SQL-related errors and makes further calls to manage error states (Source: [[FILE:SQLERR|SQLERR]], [[FILE:I|I]]ndex: programs).\n\n---\n\n**2. Error Codes and Flags**\n\n- Programs use error codes (e.g., `ERRCD`, `IO-FG`, `EXCEPTION-CODE`) and flags to indicate error states.\n- These codes are set when an error is detected and are used to control program flow.\n- Example:\n  - In `[[FILE:DECLARE.CPY|DECLARE.CPY]]`, the comment describes moving \"E\" to `ERRCD` before performing file close operations to indicate an error state (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code).\n\n---\n\n**3. GO TO and PERFORM Error Routines**\n\n- When an error is detected (e.g., file I/O error, SQL error), the program typically uses `GO TO` or `PERFORM` statements to transfer control to an error-handling paragraph.\n- Example:\n  - In `[[FILE:WDAYBK.CBL|WDAYBK.CBL]]`, if `IO-BAD` is set after a file read, the program goes to `IO-ERROR` or an exit routine (Source: [[FILE:WDAYBK.CBL|WDAYBK.CBL]], Index: code).\n\n---\n\n**4. Exception Handling for Screens and Events**\n\n- For screen-based programs, special data items like `SCREEN-CONTROL` and `EVENT-STATUS` are declared to manage exception procedures triggered by user actions or system events.\n- These items are required for proper handling of \"NOTIFY\" style events, ensuring that exception procedures are processed correctly.\n- Example:\n  - `SCREEN-CONTROL` is declared even if not directly referenced, because it is set by the system during exception handling (Source: [[FILE:RZLER2.CBL|RZLER2.CBL]], Index: code; [[FILE:EXTVAR.CBL|EXTVAR.CBL]], Index: code; [[FILE:SQLLOG.CBL|SQLLOG.CBL]], Index: code).\n\n---\n\n**5. Logging and Notification**\n\n- Errors are logged for audit and troubleshooting purposes, and users may be notified via messages or prompts.\n- Some programs use routines like `SEND-MESS` to notify users of errors, especially in batch or online transaction processing (Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code).\n\n---\n\n**6. SQL Error Handling**\n\n- For programs that interact with SQL databases, error handling includes disconnecting, rolling back, and setting error codes.\n- Example:\n  - In `[[FILE:BIBUID.CBL|BIBUID.CBL]]`, after a SQL disconnect, the program moves \"E\" to an error code and performs file closure routines (Source: [[FILE:BIBUID.CBL|BIBUID.CBL]], Index: code).\n\n---\n\n**Summary of Typical Error Handling Flow:**\n\n- Detect error (via status flags, error codes, or exceptions)\n- Set error code/flag\n- Transfer control to error-handling paragraph (using `GO TO` or `PERFORM`)\n- Call dedicated error-handling program (e.g., `ERRLOG`, `ERRMSG`)\n- Log error and/or notify user\n- Perform cleanup (close files, rollback transactions)\n- Exit or resume processing as appropriate\n\n---\n\n**Here's a visual representation:**\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Error & Exception Handling Flow</text>\n  \n  <!-- Main Program -->\n  <rect x=\"50\" y=\"80\" width=\"180\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Main COBOL Program</text>\n  <text x=\"140\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Business Logic</text>\n  \n  <!-- Error Detection -->\n  <rect x=\"270\" y=\"80\" width=\"180\" height=\"70\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"360\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Error Detected</text>\n  <text x=\"360\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">IO, SQL, User Event</text>\n  \n  <!-- Set Error Code -->\n  <rect x=\"490\" y=\"80\" width=\"140\" height=\"70\" fill=\"#ef4444\" stroke=\"#dc2626\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Set Error Code</text>\n  <text x=\"560\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">ERRCD, IO-FG, etc.</text>\n  \n  <!-- Error Handler -->\n  <rect x=\"670\" y=\"80\" width=\"180\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"760\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Error Handler</text>\n  <text x=\"760\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">ERRLOG, ERRMSG, SQLERR</text>\n  \n  <!-- Logging & Notification -->\n  <rect x=\"270\" y=\"200\" width=\"180\" height=\"70\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"360\" y=\"230\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"16\" font-weight=\"bold\">Log Error / Notify User</text>\n  <text x=\"360\" y=\"250\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"11\">SEND-MESS, Display</text>\n  \n  <!-- Cleanup -->\n  <rect x=\"490\" y=\"200\" width=\"140\" height=\"70\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"230\" text-anchor=\"middle\" fill=\"#15803d\" font-size=\"16\" font-weight=\"bold\">Cleanup</text>\n  <text x=\"560\" y=\"250\" text-anchor=\"middle\" fill=\"#15803d\" font-size=\"11\">Close files, rollback</text>\n  \n  <!-- End/Resume -->\n  <ellipse cx=\"760\" cy=\"235\" rx=\"70\" ry=\"35\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\"/>\n  <text x=\"760\" y=\"243\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">End/Resume</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"230\" y1=\"115\" x2=\"270\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"115\" x2=\"490\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"630\" y1=\"115\" x2=\"670\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"760\" y1=\"150\" x2=\"760\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"360\" y1=\"150\" x2=\"360\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"560\" y1=\"150\" x2=\"560\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"630\" y1=\"235\" x2=\"690\" y2=\"235\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**Source Citations:**\n- Error code handling and comments: [[FILE:DECLARE.CPY|DECLARE.CPY]] (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code)\n- Error handler programs: ERRLOG, ERRMSG, SQLERR (Source: [[FILE:ERRLOG|ERRLOG]], [[FILE:ERRMSG|ERRMSG]], [[FILE:SQLERR|SQLERR]], [[FILE:I|I]]ndex: programs)\n- Screen exception handling: [[FILE:RZLER2.CBL|RZLER2.CBL]], [[FILE:EXTVAR.CBL|EXTVAR.CBL]], [[FILE:SQLLOG.CBL|SQLLOG.CBL]] (Source: [[FILE:RZLER2.CBL|RZLER2.CBL]], [[FILE:EXTVAR.CBL|EXTVAR.CBL]], [[FILE:SQLLOG.CBL|SQLLOG.CBL]], Index: code)\n- File I/O error handling: [[FILE:WDAYBK.CBL|WDAYBK.CBL]] (Source: [[FILE:WDAYBK.CBL|WDAYBK.CBL]], Index: code)\n- SQL error handling: [[FILE:BIBUID.CBL|BIBUID.CBL]] (Source: [[FILE:BIBUID.CBL|BIBUID.CBL]], Index: code)\n- User notification: [[FILE:EOCRON.CBL|EOCRON.CBL]] (Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code)\n\nIf you need details on a specific error-handling program or want to see code examples, let me know!",
    "sources_count": 100,
    "timing_seconds": 18.862
  },
  "Q5": {
    "question": "What are the key sections in the PROCEDURE DIVISION of OTIS programs?",
    "answer": "In the OTIS/OTOS application, COBOL programs follow a structured organization in the PROCEDURE DIVISION, which is the main section where program logic is implemented. The key sections typically found in the PROCEDURE DIVISION of OTIS programs are:\n\n### 1. **INITIALIZATION**\n- Purpose: Sets up working storage, opens files, initializes variables, and prepares the program for processing.\n- Example:  \n  - `INITIALIZATION` is often the first paragraph after the PROCEDURE DIVISION.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:I|I]]ndex: flows)\n\n### 2. **MAIN PROGRAM LOOP**\n- Purpose: Controls the main flow of user interaction or batch processing. Handles repeated actions such as reading input, processing records, or responding to user commands.\n- Example:  \n  - Paragraphs like `MAIN-PROGRAM-LOOP` or `MAIN-MODULE` are common.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:LONPG7|LONPG7]], [[FILE:LONPK0|LONPK0]], [[FILE:EONIE0|EONIE0]], [[FILE:JCMAIN|JCMAIN]], [[FILE:BPBKBR|BPBKBR]], [[FILE:RZWRI5|RZWRI5]], [[FILE:BISCAN|BISCAN]], [[FILE:CLOSER|CLOSER]], [[FILE:TEXTIN|TEXTIN]], [[FILE:SCRN1|SCRN1]], etc.)\n\n### 3. **ENTRY MODULE / ENTRY-MODULE**\n- Purpose: Handles user input or record entry. Validates and processes data entered by the user or read from files.\n- Example:  \n  - Paragraphs named `ENTRY-MODULE` or similar.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:LONPG7|LONPG7]], [[FILE:LONPK0|LONPK0]], [[FILE:EONIE0|EONIE0]], [[FILE:JCMAIN|JCMAIN]], [[FILE:BPBKBR|BPBKBR]], etc.)\n\n### 4. **WRITE MODULE / WRITE-MODULE**\n- Purpose: Writes processed data to files or updates records. Handles output operations.\n- Example:  \n  - Paragraphs named `WRITE-MODULE`.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:LONPG7|LONPG7]], [[FILE:LONPK0|LONPK0]], [[FILE:EONIE0|EONIE0]], [[FILE:JCMAIN|JCMAIN]], [[FILE:BPBKBR|BPBKBR]], etc.)\n\n### 5. **DELETE MODULE / DELETE-MODULE**\n- Purpose: Deletes records or handles removal operations.\n- Example:  \n  - Paragraphs named `DELETE-MODULE`.\n  - (Source: [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:JCMAIN|JCMAIN]], etc.)\n\n### 6. **FORM RESET / FORM-RESET**\n- Purpose: Resets the screen or form, clearing fields and preparing for new input.\n- Example:  \n  - Paragraphs named `FORM-RESET`.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:LONPG7|LONPG7]], [[FILE:LONPK0|LONPK0]], [[FILE:EONIE0|EONIE0]], [[FILE:JCMAIN|JCMAIN]], [[FILE:BPBKBR|BPBKBR]], etc.)\n\n### 7. **DISPLAY MODULES**\n- Purpose: Handles displaying information to the user, such as error messages, prompts, or data.\n- Example:  \n  - Paragraphs like `DISPLAY-KEY`, `DISPLAY-SCREEN`, `DISPLAY-FIELDS`.\n  - (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:LONPK0|LONPK0]], etc.)\n\n### 8. **SPECIALIZED PROCESSING MODULES**\n- Purpose: Business-specific logic such as calculations, validations, or custom routines.\n- Example:  \n  - Paragraphs like `CALCULATE-1STPYDATE-TERM`, `VERIFY-100PERCENT`, `PROCESS-ORIGINAL-LOAN`.\n  - (Source: [[FILE:LONPG7|LONPG7]], [[FILE:ALMAIN|ALMAIN]], etc.)\n\n### 9. **DECLARATIVES**\n- Purpose: Error handling and file exception routines. Used for trapping file I/O errors and other exceptions.\n- Example:  \n  - Section named `DECLARATIVES` with paragraphs like `DECLARE-ERROR SECTION`.\n  - (Source: [[FILE:LONPR0|LONPR0]], [[FILE:RZWRI5|RZWRI5]], [[FILE:BPBKBR|BPBKBR]], [[FILE:OTHUPD.CBL|OTHUPD.CBL]], [[FILE:EALIST.CBL|EALIST.CBL]], etc.)\n\n---\n\n## Typical Structure Example\n\nHere’s a typical structure found in OTIS programs (summarized from multiple sources):\n\n- **INITIALIZATION**\n- **MAIN-PROGRAM-LOOP** or **MAIN-MODULE**\n  - **ENTRY-MODULE**\n  - **WRITE-MODULE**\n  - **DELETE-MODULE** (if applicable)\n  - **FORM-RESET**\n  - **DISPLAY-KEY** / **DISPLAY-SCREEN**\n  - **Specialized business logic paragraphs**\n- **DECLARATIVES** (for error handling)\n\n---\n\n### Source Citations\n\n- \"INITIALIZATION\", \"MAIN-PROGRAM-LOOP\", \"ENTRY-MODULE\", \"WRITE-MODULE\", \"FORM-RESET\", \"DISPLAY-KEY\" (Source: [[FILE:PDPG91|PDPG91]], [[FILE:PDPG07|PDPG07]], [[FILE:PDPG93|PDPG93]], [[FILE:PDPG10|PDPG10]], [[FILE:PDPG06|PDPG06]], [[FILE:PDPG09|PDPG09]], [[FILE:DSMAIN|DSMAIN]], [[FILE:SSMAIN|SSMAIN]], [[FILE:ALMAIN|ALMAIN]], [[FILE:LONPG7|LONPG7]], [[FILE:LONPK0|LONPK0]], [[FILE:EONIE0|EONIE0]], [[FILE:JCMAIN|JCMAIN]], [[FILE:BPBKBR|BPBKBR]], [[FILE:RZWRI5|RZWRI5]], [[FILE:BISCAN|BISCAN]], [[FILE:CLOSER|CLOSER]], [[FILE:TEXTIN|TEXTIN]], [[FILE:SCRN1|SCRN1]], etc.)\n- \"DECLARATIVES\", \"DECLARE-ERROR SECTION\" (Source: [[FILE:LONPR0|LONPR0]], [[FILE:RZWRI5|RZWRI5]], [[FILE:BPBKBR|BPBKBR]], [[FILE:OTHUPD.CBL|OTHUPD.CBL]], [[FILE:EALIST.CBL|EALIST.CBL]])\n\n---\n\n## Visual Representation\n\nHere's a visual summary of the typical PROCEDURE DIVISION structure in OTIS programs:\n\n<svg width=\"700\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS PROCEDURE DIVISION Structure</text>\n  \n  <!-- Initialization -->\n  <rect x=\"50\" y=\"70\" width=\"600\" height=\"60\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">INITIALIZATION</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Setup, open files, prepare variables</text>\n  \n  <!-- Main Loop -->\n  <rect x=\"50\" y=\"150\" width=\"600\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"180\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">MAIN-PROGRAM-LOOP / MAIN-MODULE</text>\n  <text x=\"350\" y=\"200\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">User interaction, batch record processing</text>\n  \n  <!-- Submodules -->\n  <rect x=\"50\" y=\"230\" width=\"600\" height=\"120\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"260\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Submodules</text>\n  <text x=\"350\" y=\"280\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">ENTRY-MODULE, WRITE-MODULE, DELETE-MODULE, FORM-RESET, DISPLAY-KEY, Specialized Logic</text>\n  <text x=\"350\" y=\"300\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Business rules, calculations, validations</text>\n  \n  <!-- Declaratives -->\n  <rect x=\"50\" y=\"370\" width=\"600\" height=\"60\" fill=\"#fee2e2\" stroke=\"#ef4444\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"400\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b91c1c\">DECLARATIVES</text>\n  <text x=\"350\" y=\"420\" text-anchor=\"middle\" font-size=\"12\" fill=\"#ef4444\">Error handling, file exceptions</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"130\" x2=\"350\" y2=\"150\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"210\" x2=\"350\" y2=\"230\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"350\" x2=\"350\" y2=\"370\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**Summary:**  \nOTIS COBOL programs use a consistent PROCEDURE DIVISION structure with initialization, main loop, modular subroutines for entry/write/delete/display, and declaratives for error handling. This organization supports both online and batch processing, ensuring maintainability and clarity in business logic implementation.",
    "sources_count": 100,
    "timing_seconds": 17.725
  },
  "Q6": {
    "question": "How are subroutines and paragraphs organized in OTIS COBOL programs?",
    "answer": "In the OTIS/OTOS application, COBOL programs organize their logic using a combination of **paragraphs** and **subroutines** (sometimes called sections or modules). This structure is designed to support both business clarity and technical maintainability.\n\n---\n\n### Organization of Paragraphs and Subroutines\n\n#### 1. **Paragraphs**\n- **Definition:** Paragraphs are named blocks of code within the PROCEDURE DIVISION. Each paragraph typically performs a single logical task (e.g., validation, calculation, file I/O).\n- **Naming:** Paragraph names are descriptive, often reflecting their business function (e.g., `VALIDATE-INPUT`, `PROCESS-PAYMENT`, `ERROR-HANDLING`).\n- **Entry Points:** Many OTIS programs use paragraphs as entry points for specific operations. For example, batch programs may have paragraphs like `MAIN-MODULE`, `INITIALIZATION`, `EXIT-PROGRAM`.\n- **Flow Control:** Paragraphs are invoked using the `PERFORM` statement, which can be simple (`PERFORM VALIDATE-INPUT`) or range-based (`PERFORM PARA-START THRU PARA-END`).\n\n#### 2. **Subroutines (Sections/Modules)**\n- **Definition:** Subroutines are larger logical units, sometimes defined as COBOL \"sections\" or as external callable programs. In OTIS, these are often used for reusable business logic or utility functions.\n- **Internal Subroutines:** Within a program, sections group related paragraphs (e.g., `FILE-HANDLING SECTION` containing all file I/O paragraphs).\n- **External Subroutines:** Programs may call other COBOL programs as subroutines using the `CALL` statement (e.g., `CALL 'REFUPD' USING ...`). These are used for shared logic across multiple programs.\n- **Modularization:** OTIS programs often separate business logic, error handling, and I/O into distinct subroutines for clarity and reuse.\n\n#### 3. **Common Patterns in OTIS**\n- **Entry/Exit Structure:** Most programs have clear entry paragraphs (e.g., `MAIN-MODULE`, `ENTRY-MODULE`) and exit paragraphs (`EXIT-PROGRAM`, `END-ROUTINE`).\n- **Error Handling:** Dedicated paragraphs or subroutines handle errors (e.g., `ERROR-HANDLING`, `LOG-ERROR`), often invoked from multiple places.\n- **Business Logic:** Core business rules are implemented in named paragraphs (e.g., `CALCULATE-INTEREST`, `VALIDATE-ACCOUNT`).\n- **File I/O:** File operations are grouped in sections or paragraphs (e.g., `READ-FILE`, `WRITE-FILE`).\n\n---\n\n### Example from OTIS Programs\n\n**From the retrieved context:**\n\n- **PST332**  \n  - \"Program PST332 has 37 paragraphs and 0 perform edges; max depth 1 and cycles=absent. Entry paragraphs: WORKING-STORAGE, EXIT, PRINT-ROUTINE-EXIT...\"  \n  - This shows a typical organization: multiple paragraphs for different tasks, with clear entry and exit points.  \n  - (Source: [[FILE:PST332|PST332]], [[FILE:I|I]]ndex: flows)\n\n- **HELP2**  \n  - \"Program HELP2 has 5 paragraphs and 0 perform edges; max depth 1 and cycles=absent. Entry paragraphs: WORKING-STORAGE, FILE-CONTROL, FILE...\"  \n  - Indicates a small utility program with a handful of paragraphs, each serving a distinct function.  \n  - (Source: [[FILE:HELP2|HELP2]], [[FILE:I|I]]ndex: flows)\n\n- **LONPG3**  \n  - Flowchart shows modules like `MAIN-MODULE`, `ENTRY-MODULE`, `MODIFY-ROUTINE`, each representing a logical subroutine or section.  \n  - (Source: [[FILE:LONPG3|LONPG3]], [[FILE:I|I]]ndex: flows)\n\n---\n\n### Summary Table: Typical Paragraphs and Subroutines\n\n| Type              | Example Name         | Purpose                          |\n|-------------------|---------------------|----------------------------------|\n| Entry Paragraph   | MAIN-MODULE         | Program start logic              |\n| Business Logic    | VALIDATE-INPUT      | Input validation                 |\n| File I/O          | READ-FILE           | Read data from files             |\n| Error Handling    | ERROR-HANDLING      | Manage errors/exceptions         |\n| Exit Paragraph    | EXIT-PROGRAM        | Program termination              |\n| Utility Subroutine| LOG-ERROR           | Log error details                |\n\n---\n\n### Visual Representation\n\nHere's a visual representation of how paragraphs and subroutines are typically organized in an OTIS COBOL program:\n\n<svg width=\"700\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS COBOL Program Structure</text>\n  \n  <!-- Entry Paragraph -->\n  <rect x=\"280\" y=\"70\" width=\"140\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">MAIN-MODULE</text>\n  <text x=\"350\" y=\"115\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Entry Paragraph</text>\n  \n  <!-- Business Logic Paragraphs -->\n  <rect x=\"100\" y=\"170\" width=\"140\" height=\"50\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"170\" y=\"200\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">VALIDATE-INPUT</text>\n  <rect x=\"280\" y=\"170\" width=\"140\" height=\"50\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"200\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">PROCESS-PAYMENT</text>\n  <rect x=\"460\" y=\"170\" width=\"140\" height=\"50\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"530\" y=\"200\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">CALCULATE-INTEREST</text>\n  \n  <!-- Error Handling Paragraph -->\n  <rect x=\"100\" y=\"270\" width=\"140\" height=\"50\" fill=\"#ef4444\" stroke=\"#dc2626\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"170\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">ERROR-HANDLING</text>\n  \n  <!-- File I/O Paragraph -->\n  <rect x=\"280\" y=\"270\" width=\"140\" height=\"50\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">READ-FILE</text>\n  \n  <!-- Exit Paragraph -->\n  <rect x=\"460\" y=\"270\" width=\"140\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"530\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">EXIT-PROGRAM</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"120\" x2=\"170\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"120\" x2=\"350\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"120\" x2=\"530\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"220\" x2=\"170\" y2=\"270\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"220\" x2=\"350\" y2=\"270\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"220\" x2=\"530\" y2=\"270\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### Source References\n- PST332, HELP2, LONPG3 (Source: [[FILE:PST332|PST332]], [[FILE:HELP2|HELP2]], [[FILE:LONPG3|LONPG3]], [[FILE:I|I]]ndex: flows)\n- General OTIS program structure (Source: multiple program flow summaries)\n\n---\n\n**Summary:**  \nOTIS COBOL programs use paragraphs for modular logic and subroutines (internal sections or external calls) for reusable business and utility functions. This organization supports clear business process mapping, error handling, and maintainable code.",
    "sources_count": 100,
    "timing_seconds": 17.543
  },
  "Q7": {
    "question": "What are the common WORKING-STORAGE patterns used in OTIS programs?",
    "answer": "In the OTIS/OTOS application, COBOL programs use **WORKING-STORAGE** sections to define variables, flags, buffers, and temporary data structures needed for program logic. Several common patterns emerge across the system:\n\n---\n\n### 1. **Status Flags and Switches**\n- Programs frequently define single-character or numeric flags to track state, errors, and control flow.\n- Examples:\n  - `FIRST-TIME` (PIC X VALUE \"Y\") – Indicates first execution or initialization.\n  - `RECORDS-FOUND` (PIC X VALUE \" \") with 88-level `NO-RECORDS-FOUND VALUE \"N\"` – Used for record existence checks.\n  - `AUDIT-ERROR`, `SECURITY-ERROR` (PIC 9 VALUE 0) – Error tracking.\n  - `SKIP-SWITCH`, `SKIP-STEP` (PIC 9 or PIC 9999 VALUE 0) – Used for conditional logic or skipping steps.\n\n  **Source Examples:**\n  - [[FILE:SPOBRD.CBL|SPOBRD.CBL]], lines 151-175:  \n    ```\n    01  FIRST-TIME           PIC X        VALUE \"Y\".\n    01  RECORDS-FOUND        PIC X        VALUE \" \".\n        88  NO-RECORDS-FOUND              VALUE \"N\".\n    01  AUDIT-ERROR       PIC 9  VALUE 0.\n    01  SECURITY-ERROR    PIC 9  VALUE 0.\n    01  SKIP-SWITCH       PIC 9  VALUE 0.\n    01  SKIP-STEP         PIC 9999 VALUE 0.\n    ```\n    (Source: [[FILE:SPOBRD.CBL|SPOBRD.CBL]], Index: code)\n\n---\n\n### 2. **Message Buffers and Lists**\n- Used for displaying messages, prompts, or error codes.\n- Examples:\n  - `MESS-LIST` (PIC X(5) VALUE \"MESS.\") – Message identifier.\n  - `ALLMESS-LIST` (PIC X(20) VALUE \"MSEL SEL MSEL2 MESS.\") – List of message codes.\n  - `DISPLAY-BUF` – Composite buffer for screen output.\n\n  **Source Examples:**\n  - [[FILE:GREXEC.CBL|GREXEC.CBL]], lines 101-125:\n    ```\n    01  MESS-LIST      PIC X(5)  VALUE \"MESS.\".\n    01  ALLMESS-LIST   PIC X(20) VALUE \"MSEL SEL MSEL2 MESS.\".\n    01  DISPLAY-BUF.\n        03  FILLER           PIC X(12) VALUE \"PROCESSING..\".\n        03  DISPLAY-BRNO     PIC Z(4).\n        03  FILLER           PIC X(7).\n    ```\n    (Source: [[FILE:GREXEC.CBL|GREXEC.CBL]], Index: code; [[FILE:SPOBRD.CBL|SPOBRD.CBL]], Index: code)\n\n---\n\n### 3. **Numeric Counters and Step Trackers**\n- Used to track processing steps, counts, and indexes.\n- Examples:\n  - `CURRENT-STEP`, `STEP-COUNT` (PIC 9999) – Tracks current step in batch or process.\n  - `SUB` (PIC 9(5) COMP) – Loop or array index.\n\n  **Source Examples:**\n  - [[FILE:EORUN.CBL|EORUN.CBL]], lines 51-75:\n    ```\n    01  CURRENT-STEP   PIC 9999.\n    01  STEP-COUNT     PIC 9999.\n    ```\n    (Source: [[FILE:EORUN.CBL|EORUN.CBL]], Index: code)\n  - [[FILE:CALCZ3.CBL|CALCZ3.CBL]], lines 501-525:\n    ```\n    05  SUB                       PIC 9(5)          COMP.\n    ```\n    (Source: [[FILE:CALCZ3.CBL|CALCZ3.CBL]], Index: code)\n\n---\n\n### 4. **Temporary Calculation Fields**\n- Used for intermediate results, calculations, and working values.\n- Examples:\n  - `CVA-A--N`, `CVA-SP`, `CVA-I`, `CVA-WK`, `CVA-LP` – Various COMP fields for calculations.\n\n  **Source Examples:**\n  - [[FILE:CALCZ3.CBL|CALCZ3.CBL]], lines 501-525:\n    ```\n    05  CVA-A--N                  PIC S9999V9(13)   COMP.\n    05  CVA-SP                    PIC S999999V9(11) COMP.\n    05  CVA-SP3                   PIC S999999V9(3)  COMP.\n    05  CVA-I                     PIC S999999V9(11) COMP.\n    05  CVA-WK                    PIC S999999V9(11) COMP.\n    05  CVA-LP                    PIC S9(11)V9(6)   COMP.\n    ```\n    (Source: [[FILE:CALCZ3.CBL|CALCZ3.CBL]], Index: code)\n\n---\n\n### 5. **Program Name and Date-Time Workers**\n- Used for tracking program identity and date/time operations.\n- Examples:\n  - `WS-PGM-NAME` (PIC X(6)) – Stores current program name.\n  - `DATE-TIME-WORKERS` – Group for date/time manipulation.\n\n  **Source Examples:**\n  - [[FILE:GREXEC.CBL|GREXEC.CBL]], lines 101-125:\n    ```\n    01  WS-PGM-NAME   PIC X(6).\n    01  DATE-TIME-WORKERS.\n    ```\n    (Source: [[FILE:GREXEC.CBL|GREXEC.CBL]], Index: code)\n\n---\n\n### 6. **Composite Buffers and Structures**\n- Multi-level group items for passing data between paragraphs or to screens.\n- Examples:\n  - `DISPLAY-BUF` – Contains multiple fields for formatted output.\n\n  **Source Examples:**\n  - [[FILE:SPOBRD.CBL|SPOBRD.CBL]], lines 151-175:\n    ```\n    01  DISPLAY-BUF.\n        03  FILLER           PIC X(12) VALUE \"PROCESSING..\".\n        03  DISPLAY-BRNO     PIC Z(4).\n        03  FILLER           PIC X(7).\n    ```\n    (Source: [[FILE:SPOBRD.CBL|SPOBRD.CBL]], Index: code)\n\n---\n\n### 7. **88-Level Condition Names**\n- Used for readable flag logic.\n- Example:\n  - `NO-RECORDS-FOUND VALUE \"N\"` – Used with `RECORDS-FOUND` for conditional checks.\n\n  **Source Examples:**\n  - [[FILE:SPOBRD.CBL|SPOBRD.CBL]], lines 151-175:\n    ```\n    01  RECORDS-FOUND        PIC X        VALUE \" \".\n        88  NO-RECORDS-FOUND              VALUE \"N\".\n    ```\n    (Source: [[FILE:SPOBRD.CBL|SPOBRD.CBL]], Index: code)\n\n---\n\n## Summary Table\n\n| Pattern Type                | Example Variable(s)         | Typical Usage                        | Source Example(s)                |\n|-----------------------------|-----------------------------|--------------------------------------|----------------------------------|\n| Status Flags/Switches       | FIRST-TIME, RECORDS-FOUND   | State, error, control flow           | [[FILE:SPOBRD.CBL|SPOBRD.CBL]], [[FILE:EORUN.CBL|EORUN.CBL]]            |\n| Message Buffers/Lists       | MESS-LIST, DISPLAY-BUF      | Screen output, error messages        | [[FILE:GREXEC.CBL|GREXEC.CBL]], [[FILE:SPOBRD.CBL|SPOBRD.CBL]]           |\n| Numeric Counters/Trackers   | CURRENT-STEP, SUB           | Step tracking, loop indexes          | [[FILE:EORUN.CBL|EORUN.CBL]], [[FILE:CALCZ3.CBL|CALCZ3.CBL]]            |\n| Calculation Fields          | CVA-SP, CVA-LP              | Intermediate math, temp results      | [[FILE:CALCZ3.CBL|CALCZ3.CBL]]                       |\n| Program Name/Date-Time      | WS-PGM-NAME, DATE-TIME-WORKERS | Program ID, date/time ops         | [[FILE:GREXEC.CBL|GREXEC.CBL]]                       |\n| Composite Buffers           | DISPLAY-BUF                 | Multi-field output                   | [[FILE:SPOBRD.CBL|SPOBRD.CBL]]                       |\n| 88-Level Condition Names    | NO-RECORDS-FOUND            | Readable flag logic                  | [[FILE:SPOBRD.CBL|SPOBRD.CBL]]                       |\n\n---\n\n**In summary:**  \nOTIS programs consistently use WORKING-STORAGE for flags, counters, buffers, calculation fields, and readable condition names. These patterns support robust control flow, error handling, and data manipulation throughout the application.\n\n**Sources:**  \n- [[FILE:SPOBRD.CBL|SPOBRD.CBL]], Index: code  \n- [[FILE:GREXEC.CBL|GREXEC.CBL]], Index: code  \n- [[FILE:EORUN.CBL|EORUN.CBL]], Index: code  \n- [[FILE:CALCZ3.CBL|CALCZ3.CBL]], Index: code",
    "sources_count": 100,
    "timing_seconds": 15.763
  },
  "Q8": {
    "question": "How do OTIS programs use the LINKAGE SECTION for parameter passing?",
    "answer": "OTIS/OTOS COBOL programs use the **LINKAGE SECTION** to receive parameters and data passed from calling programs or the operating system. This is a standard COBOL mechanism for inter-program communication, especially when using the `CALL` statement or when programs are invoked by transaction managers.\n\n### How LINKAGE SECTION Is Used in OTIS Programs\n\n**1. Receiving Parameters from Calling Programs**\n- The LINKAGE SECTION defines variables that are populated when the program is called.\n- These variables match the parameters specified in the `USING` clause of the PROCEDURE DIVISION.\n- Example:\n  ```cobol\n  PROCEDURE DIVISION USING FORM-PATHNAME.\n  LINKAGE SECTION.\n  01  FORM-PATHNAME      PIC X(22).\n  ```\n  (Source: [[FILE:PCPGRM.CBL|PCPGRM.CBL]], Index: code)\n\n**2. Passing Data Structures (Records, Buffers)**\n- OTIS programs often define complex data structures in the LINKAGE SECTION to receive records, buffers, or control blocks.\n- These structures may be defined directly or via COPY statements for consistency.\n- Example:\n  ```cobol\n  LINKAGE SECTION.\n  01  FORM-PATHNAME PIC X(22).\n  01  EORUN-BUF.\n      03  EORUN-PTYPE          PIC XXX.\n      03  EORUN-PCODE          PIC XXX.\n      03  EORUN-HOUR-BUF       PIC 99.\n      03  EORUN-MIN-BUF        PIC 99.\n      03  EORUN-DATE1          PIC 9(8).\n  ```\n  (Source: [[FILE:EORUN.CBL|EORUN.CBL]], Index: code)\n\n**3. Using COPYBOOKS for Standardization**\n- Many OTIS programs use COPY statements in the LINKAGE SECTION to include standardized parameter blocks.\n- This ensures consistency across programs and simplifies maintenance.\n- Example:\n  ```cobol\n  LINKAGE SECTION.\n  COPY \"LIBGB/[[FILE:GETFMW.CPY|GETFMW.CPY]]\".\n  ```\n  (Source: [[FILE:REBB01.CBL|REBB01.CBL]], Index: code)\n\n**4. Supporting Modular and Reusable Design**\n- By defining parameters in the LINKAGE SECTION, OTIS programs can be called with different data, supporting modularity and reuse.\n- This is especially important for utility programs, screen handlers, and batch routines.\n\n**5. Typical Usage Patterns**\n- The LINKAGE SECTION is paired with the PROCEDURE DIVISION USING clause.\n- Data is passed by reference, allowing the called program to access and modify the caller's data if needed.\n- Example pattern:\n  ```cobol\n  PROCEDURE DIVISION USING PARAM-1, PARAM-2.\n  LINKAGE SECTION.\n  01  PARAM-1   PIC X(10).\n  01  PARAM-2   PIC 9(5).\n  ```\n\n### Summary Table: LINKAGE SECTION Usage in OTIS\n\n| Program Example   | LINKAGE Variables Defined           | Purpose/Pattern                              | Source Reference                |\n|-------------------|-------------------------------------|----------------------------------------------|----------------------------------|\n| [[FILE:PCPGRM.CBL|PCPGRM.CBL]]        | FORM-PATHNAME                       | Receives file path from caller               | [[FILE:PCPGRM.CBL|PCPGRM.CBL]], Index: code          |\n| [[FILE:EORUN.CBL|EORUN.CBL]]         | FORM-PATHNAME, EORUN-BUF            | Receives screen/form and buffer info         | [[FILE:EORUN.CBL|EORUN.CBL]], Index: code           |\n| [[FILE:REBB01.CBL|REBB01.CBL]]        | COPY \"LIBGB/[[FILE:GETFMW.CPY|GETFMW.CPY]]\"             | Standardized parameter block                 | [[FILE:REBB01.CBL|REBB01.CBL]], Index: code          |\n| [[FILE:LONPQ0.CBL|LONPQ0.CBL]]        | FORM-PATHNAME, EXIT-PATHNAME        | Receives form and exit path info             | [[FILE:LONPQ0.CBL|LONPQ0.CBL]], Index: code          |\n| [[FILE:CRNOFL.CBL|CRNOFL.CBL]]        | COPY \"LIBGB/[[FILE:GETFMW.CPY|GETFMW.CPY]]\"             | Standardized parameter block                 | [[FILE:CRNOFL.CBL|CRNOFL.CBL]], Index: code          |\n\n### Business Purpose\n\n- **Parameter passing via LINKAGE SECTION** allows OTIS programs to be flexible, modular, and reusable.\n- It supports business processes where programs need to interact, share data, or operate on user-supplied information (such as file paths, record buffers, or control codes).\n\n### Technical Implementation\n\n- LINKAGE SECTION variables are mapped to the parameters provided by the caller.\n- COPYBOOKS are used for complex or standardized structures.\n- The PROCEDURE DIVISION USING clause specifies which LINKAGE SECTION variables are populated.\n\n---\n\n**Source References:**\n- [[FILE:PCPGRM.CBL|PCPGRM.CBL]], Index: code\n- [[FILE:EORUN.CBL|EORUN.CBL]], Index: code\n- [[FILE:REBB01.CBL|REBB01.CBL]], Index: code\n- [[FILE:LONPQ0.CBL|LONPQ0.CBL]], Index: code\n- [[FILE:CRNOFL.CBL|CRNOFL.CBL]], Index: code\n\nIf you need specific examples from a particular OTIS program, let me know!",
    "sources_count": 100,
    "timing_seconds": 12.397
  },
  "Q9": {
    "question": "What are the typical program entry points and exit points in OTIS?",
    "answer": "In the OTIS/OTOS COBOL application, programs follow consistent patterns for **entry points** and **exit points** to structure their execution flow. These conventions help standardize how programs start, process, and terminate, making the system easier to maintain and integrate.\n\n---\n\n### TYPICAL PROGRAM ENTRY POINTS\n\n**1. MAIN-MODULE / MAIN-PROGRAM**\n- Most OTIS programs begin execution in a paragraph named `MAIN-MODULE`, `MAIN-PROGRAM`, or similar.\n- This entry point initializes variables, sets up the environment, and begins the main processing loop.\n- Example:\n  ```cobol\n  MAIN-MODULE.\n      PERFORM INITIALIZATION\n      PERFORM PROCESS-LOGIC\n      GO TO MAIN-PROGRAM-EXIT\n  ```\n  (Source: [[FILE:TCMAIN|TCMAIN]], [[FILE:CJMAIN|CJMAIN]], [[FILE:STMAIN|STMAIN]], etc., Index: flows)\n\n**2. INITIALIZATION SECTION**\n- Immediately after entry, programs often perform initialization tasks in a dedicated section or paragraph.\n- Common actions: setting status flags, moving program names, preparing screen/form paths.\n- Example:\n  ```cobol\n  INITIALIZATION SECTION.\n      MOVE STAT---GOOD TO PROCESS-STAT\n      MOVE \"LPFILE\" TO VDU-FORM-NAME\n      PERFORM GET-GPENV\n  ```\n  (Source: [[FILE:LPFILE.CBL|LPFILE.CBL]], [[FILE:BWFILE.CBL|BWFILE.CBL]], [[FILE:PWFILE.CBL|PWFILE.CBL]], Index: code)\n\n**3. ENTRY-MODULE / ENTRY-MODULE-REPEAT**\n- For programs that process user input or records, an `ENTRY-MODULE` paragraph handles entry and validation.\n- Sometimes repeated for batch or iterative processing.\n- Example:\n  ```cobol\n  ENTRY-MODULE.\n      PERFORM VALIDATE-INPUT\n      PERFORM PROCESS-ENTRY\n  ```\n  (Source: [[FILE:TCMAIN|TCMAIN]], [[FILE:CJMAIN|CJMAIN]], [[FILE:SNMAIN|SNMAIN]], [[FILE:I|I]]ndex: flows)\n\n---\n\n### TYPICAL PROGRAM EXIT POINTS\n\n**1. MAIN-PROGRAM-EXIT / END-PROGRAM**\n- Programs typically terminate via a paragraph named `MAIN-PROGRAM-EXIT` or `END-PROGRAM`.\n- This exit point performs cleanup and issues a `GO TO END-PROGRAM` or `EXIT PROGRAM` statement.\n- Example:\n  ```cobol\n  MAIN-PROGRAM-EXIT.\n      GO TO END-PROGRAM\n\n  END-PROGRAM.\n      EXIT PROGRAM\n  ```\n  (Source: [[FILE:LPFILE.CBL|LPFILE.CBL]], [[FILE:BWFILE.CBL|BWFILE.CBL]], [[FILE:PWFILE.CBL|PWFILE.CBL]], Index: code)\n\n**2. EXIT-PROG / EXIT-PROGRAM**\n- Many programs use an `EXIT-PROG` or `EXIT-PROGRAM` paragraph for finalization, especially in menu or utility modules.\n- Often includes trace logging or setting return codes.\n- Example:\n  ```cobol\n  EXIT-PROG.\n      PERFORM TRACE-PRO\n      EXIT PROGRAM\n  ```\n  (Source: [[FILE:LPMNMU.CBL|LPMNMU.CBL]], [[FILE:FXMENU.CBL|FXMENU.CBL]], [[FILE:BPMENU.CBL|BPMENU.CBL]], Index: copybook_usage, code)\n\n**3. Error/Abort Exit Points**\n- For error handling, programs may have dedicated exit paragraphs (e.g., `ERROR-EXIT`, `ABORT-PROGRAM`) that log errors and terminate.\n- Example:\n  ```cobol\n  ERROR-EXIT.\n      MOVE \"ERROR\" TO STATUS\n      EXIT PROGRAM\n  ```\n  (Source: [[FILE:G|G]]eneral pattern, inferred from flows and code)\n\n---\n\n### SUMMARY TABLE\n\n| Entry Point         | Purpose                                 | Example Programs      |\n|---------------------|-----------------------------------------|----------------------|\n| MAIN-MODULE         | Start main logic                        | TCMAIN, CJMAIN, STMAIN |\n| INITIALIZATION      | Set up environment/variables            | LPFILE, BWFILE, PWFILE |\n| ENTRY-MODULE        | Handle user/record input                | TCMAIN, SNMAIN         |\n\n| Exit Point          | Purpose                                 | Example Programs      |\n|---------------------|-----------------------------------------|----------------------|\n| MAIN-PROGRAM-EXIT   | Standard program termination            | LPFILE, BWFILE, PWFILE |\n| EXIT-PROG           | Finalization, trace logging             | LPMNMU, FXMENU, BPMENU |\n| END-PROGRAM         | COBOL EXIT PROGRAM statement            | LPFILE, BWFILE, PWFILE |\n\n---\n\n### SOURCE REFERENCES\n\n- [[FILE:LPFILE.CBL|LPFILE.CBL]], [[FILE:BWFILE.CBL|BWFILE.CBL]], [[FILE:PWFILE.CBL|PWFILE.CBL]] (lines 301-375): Show initialization and exit patterns.\n- TCMAIN, CJMAIN, STMAIN, SNMAIN (Index: flows): Show MAIN-MODULE and ENTRY-MODULE structure.\n- [[FILE:LPMNMU.CBL|LPMNMU.CBL]], [[FILE:FXMENU.CBL|FXMENU.CBL]], [[FILE:BPMENU.CBL|BPMENU.CBL]] (Index: copybook_usage, code): Show EXIT-PROG and trace logic.\n\n---\n\n### VISUAL REPRESENTATION\n\nHere's a visual representation of the typical OTIS program flow:\n\n<svg width=\"700\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"20\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Program Entry/Exit Flow</text>\n  \n  <!-- Entry Points -->\n  <rect x=\"50\" y=\"70\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">MAIN-MODULE</text>\n  <text x=\"140\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Entry Point</text>\n  \n  <rect x=\"260\" y=\"70\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">INITIALIZATION</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Setup</text>\n  \n  <rect x=\"470\" y=\"70\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">ENTRY-MODULE</text>\n  <text x=\"560\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Input Handling</text>\n  \n  <!-- Exit Points -->\n  <rect x=\"140\" y=\"250\" width=\"180\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"230\" y=\"280\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">MAIN-PROGRAM-EXIT</text>\n  <text x=\"230\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Standard Exit</text>\n  \n  <rect x=\"350\" y=\"250\" width=\"180\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"440\" y=\"280\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">EXIT-PROG</text>\n  <text x=\"440\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Finalization</text>\n  \n  <rect x=\"560\" y=\"250\" width=\"100\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"610\" y=\"280\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">END-PROGRAM</text>\n  <text x=\"610\" y=\"300\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">COBOL Exit</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"140\" y1=\"130\" x2=\"230\" y2=\"250\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"130\" x2=\"440\" y2=\"250\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"560\" y1=\"130\" x2=\"610\" y2=\"250\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**In summary:**  \nOTIS programs typically start at `MAIN-MODULE` or `MAIN-PROGRAM`, perform initialization, process input via `ENTRY-MODULE`, and exit through `MAIN-PROGRAM-EXIT`, `EXIT-PROG`, or `END-PROGRAM`. This structure is consistent across the application, supporting maintainability and integration.\n\n(Source: [[FILE:LPFILE.CBL|LPFILE.CBL]], [[FILE:BWFILE.CBL|BWFILE.CBL]], [[FILE:PWFILE.CBL|PWFILE.CBL]], TCMAIN, CJMAIN, STMAIN, SNMAIN, [[FILE:LPMNMU.CBL|LPMNMU.CBL]], [[FILE:FXMENU.CBL|FXMENU.CBL]], [[FILE:BPMENU.CBL|BPMENU.CBL]], Index: code, flows, copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 17.625
  },
  "Q10": {
    "question": "How are COBOL programs compiled and deployed in the OTIS system?",
    "answer": "COBOL programs in the OTIS/OTOS system are compiled and deployed using a structured process tailored for mainframe and UNIX environments, with attention to both legacy and modern requirements. Here’s how the process typically works:\n\n---\n\n**COMPILATION PROCESS**\n\n1. **Source Organization**\n   - COBOL source files are organized by business domain (e.g., loan processing, collections) and stored in directories such as `LIBLP/`, `LIBGB/`, `LIBSP/`, etc.\n   - Programs often use extensive copybooks (e.g., `[[FILE:LP01LN.CPY|LP01LN.CPY]]`, `[[FILE:GB01BR.CPY|GB01BR.CPY]]`) for shared data structures and screen layouts.\n\n2. **Preprocessing**\n   - Before compilation, copybooks are included via `COPY` statements. This allows for modular code and reuse of definitions across programs.\n   - Some programs use conditional compilation or comments to handle environment-specific logic (e.g., references to \"A15\" vs \"S35\" platforms).\n\n3. **Compiler Invocation**\n   - Compilation is performed using COBOL compilers suitable for the target environment:\n     - **Mainframe:** IBM COBOL or Micro Focus COBOL.\n     - **UNIX/Linux:** ACUCOBOL or similar compilers.\n   - Special compile scripts (e.g., `CB500.SH` mentioned in [[FILE:REDACT.CBL|REDACT.CBL]]) are used to set compiler options, environment variables, and handle version-specific requirements.\n     - Example from [[FILE:REDACT.CBL|REDACT.CBL]]:\n       ```\n       *     THIS PROGRAM USES THE RANDOM FUNCTION WHICH REQUIRES \n       *     RUNTIME OF AT LEAST 5.0.  SO IN A15, COMPILE WITH\n       *     CB500.SH, WHICH HAS THE Z31 ARGUMENT SET TO 5.\n       ```\n       (Source: [[FILE:REDACT.CBL|REDACT.CBL]], Index: code)\n\n4. **Build Artifacts**\n   - The output of compilation is typically an object module or executable binary.\n   - Some programs are compiled as callable subprograms (for use with `CALL` statements), others as standalone executables.\n\n---\n\n**DEPLOYMENT PROCESS**\n\n1. **Staging and Testing**\n   - Compiled binaries are staged in test environments before production deployment.\n   - Automated or manual testing is performed to verify business logic and integration.\n\n2. **Production Deployment**\n   - Binaries are copied to production directories, often with strict version control.\n   - Deployment scripts may set up environment variables, create necessary directories (e.g., spool or work file locations), and ensure permissions.\n   - Some programs dynamically create work files or directories at runtime, as seen in [[FILE:APIPAY.CBL|APIPAY.CBL]]:\n     ```\n     *  CREATE WK-FILE, IF RUNNING FROM EOCRON, WORK FILE IN /USR/TMP\n     *  WAS NOT CREATED IN LONPA0\n          PERFORM CREATE-WK-FILE.\n     * CREATE SPOOL DIRECTORY AND O\n     ```\n     (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: code)\n\n3. **Runtime Environment**\n   - Programs may be invoked by batch schedulers, menu-driven user interfaces, or other programs via `CALL` or `LINK`.\n   - Environment-specific configuration (e.g., file paths, user IDs) is handled via environment variables or configuration files.\n\n4. **Versioning and Maintenance**\n   - SCCS identifiers and date stamps are embedded in source files for tracking (e.g., `SCCS-IDENTIFIER PIC X(41)`).\n   - Comments in source files document changes, platform requirements, and deployment notes.\n\n---\n\n**SUMMARY OF KEY PRACTICES**\n\n- **Copybooks** are used extensively for modularity and consistency.\n- **Compile scripts** (e.g., `CB500.SH`) manage environment-specific options.\n- **Testing and staging** precede production deployment.\n- **Runtime configuration** adapts to batch or interactive use.\n- **Version control** is maintained via embedded identifiers and change logs.\n\n---\n\n**References:**\n- [[FILE:REDACT.CBL|REDACT.CBL]] (compile script and runtime requirements)\n- [[FILE:APIPAY.CBL|APIPAY.CBL]] (work file and spool directory creation)\n- Multiple program and copybook sources showing SCCS identifiers and environment-specific comments\n\n---\n\n**If you need details on a specific platform (mainframe vs UNIX), or want to see a sample compile/deploy script, let me know!**",
    "sources_count": 100,
    "timing_seconds": 12.499
  },
  "Q11": {
    "question": "What are the main data files used in OTIS? What are their purposes?",
    "answer": "The main data files used in the OTIS/OTOS application are central to its loan servicing and financial operations. Each file serves a specific business purpose, supporting processes such as loan management, customer account tracking, accruals, reporting, and more.\n\nBelow is a summary of the key data files and their purposes, based on retrieved code comments, copybook usage, and program documentation:\n\n---\n\n### Core Data Files in OTIS/OTOS\n\n| File Name      | Purpose / Description                                                                                   | Source Reference                                 |\n|----------------|--------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n| **BMFILE**     | Branch Master File – Stores branch-level master records, including branch info and summary data         | [[FILE:DATE35.CBL|DATE35.CBL]], Index: code                          |\n| **BYFILE**     | Borrower File – Contains borrower account details, loan applications, and related info                  | [[FILE:DATE35.CBL|DATE35.CBL]], Index: code; [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code |\n| **CJFILE**     | Customer Journal File – Tracks customer transactions and journal entries                                | [[FILE:DATE35.CBL|DATE35.CBL]], Index: code                          |\n| **GTFILE**     | General Ledger File – Holds ledger balances, accounting entries, and financial summaries                | [[FILE:DATE35.CBL|DATE35.CBL]], Index: code; [[FILE:RZMTR2.CBL|RZMTR2.CBL]], Index: code |\n| **LMFILE**     | Loan Master File – Central repository for loan account records, balances, and statuses                  | [[FILE:DATE35.CBL|DATE35.CBL]], Index: code                          |\n| **LNFILE**     | Loan File – Detailed loan records, including payment history, terms, and status                         | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code                          |\n| **DSFILE**     | Dealer Statistics File – Contains dealer-related statistics and performance data                        | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code; [[FILE:MB4ALL.CBL|MB4ALL.CBL]], Index: code |\n| **TYFILE**     | Type File – Stores loan type definitions and related parameters                                         | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code                          |\n| **LTPFILE**    | Loan Type Parameters File – Holds configuration and rules for different loan types                      | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code                          |\n| **BWFILE**     | Branch Weekly File – Used for weekly branch-level reporting and accruals                                | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code; [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: code |\n| **CAFILE**     | Cash Account File – Tracks cash transactions and balances                                               | [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code                          |\n| **FDB-FILE**   | File Database – Used for storing fixed database records, often for reporting or batch processing        | [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: code; [[FILE:LONPS3.CBL|LONPS3.CBL]], Index: code |\n| **LSFILE**     | Loan Schedule File – Contains loan payment schedules and amortization data                              | [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: code                          |\n| **LTFILE**     | Loan Trailer File – Stores additional loan details, such as trailer records for reporting               | [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: code                          |\n| **PD-OWNBR**   | Processing Division Owner Branch – Used for branch-level processing and validation                      | [[FILE:BULKG2.CBL|BULKG2.CBL]], Index: code                          |\n| **GLFILE**     | General Ledger File – Used for monthly/yearly balances and financial reporting                          | [[FILE:RZMTR2.CBL|RZMTR2.CBL]], Index: code                          |\n\n---\n\n### File Purposes Explained\n\n- **Loan Files (LMFILE, LNFILE, LSFILE, LTFILE, LTPFILE):**\n  - Store all information related to loans, including master records, payment schedules, types, and additional details.\n  - Support loan origination, servicing, payment processing, and reporting.\n\n- **Customer/Borrower Files (BYFILE, CJFILE):**\n  - Track borrower accounts, applications, and transaction history.\n  - Enable customer service, account management, and compliance reporting.\n\n- **Branch/Dealer Files (BMFILE, DSFILE, BWFILE, PD-OWNBR):**\n  - Maintain branch and dealer statistics, weekly summaries, and owner branch information.\n  - Used for performance tracking, accruals, and operational reporting.\n\n- **Accounting Files (GTFILE, GLFILE, CAFILE):**\n  - Hold general ledger entries, cash account balances, and financial summaries.\n  - Support accounting, reconciliation, and regulatory compliance.\n\n- **Database/Trailer Files (FDB-FILE, LTFILE):**\n  - Used for batch processing, reporting, and storing additional loan-related data.\n\n---\n\n### Example Code References\n\n- **[[FILE:DATE35.CBL|DATE35.CBL]] (Lines 1-25):**\n  > \"BMFILE, BYFILE, CJFILE, GTFILE, LMFILE – ASCII files are created in /USR/DATA/R1/ASCII; (TARGET)\"\n  > (Source: [[FILE:DATE35.CBL|DATE35.CBL]], Index: code)\n\n- **[[FILE:EOMALL.CBL|EOMALL.CBL]] (Lines 201-225):**\n  > \"GLOBAL BWFILE, CAFILE, DSFILE, TYFILE, LNFILE, LTPFILE\"\n  > (Source: [[FILE:EOMALL.CBL|EOMALL.CBL]], Index: code)\n\n- **[[FILE:MB4ALL.CBL|MB4ALL.CBL]] (Lines 7451-7475):**\n  > \"DSFILE.DS_JDOSUNIT_1, DSFILE.DS_JDOSAMT_1, DSFILE.DS_DELUNEARN_DATE, DSFILE.DS_PROCEEDS_1\"\n  > (Source: [[FILE:MB4ALL.CBL|MB4ALL.CBL]], Index: code)\n\n- **[[FILE:RZMTR2.CBL|RZMTR2.CBL]] (Lines 1351-1375):**\n  > \"GLFILE.GL_CYBAL_1, GLFILE.GL_LYBAL_1\"\n  > (Source: [[FILE:RZMTR2.CBL|RZMTR2.CBL]], Index: code)\n\n- **[[FILE:CPINQ3.CBL|CPINQ3.CBL]] (Lines 26-50):**\n  > \"GLOBAL BWFILE, SPLIT OUT LTFILE, LSFILE\"\n  > (Source: [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: code)\n\n---\n\n### Summary\n\nThe OTIS/OTOS system relies on these main data files to manage loans, customers, branches, dealers, and accounting. Each file is referenced by multiple programs for reading, writing, updating, and reporting, forming the backbone of the application's business logic and data flow.\n\nIf you need details about a specific file's structure or which programs use it, I can provide further analysis.",
    "sources_count": 100,
    "timing_seconds": 15.032
  },
  "Q12": {
    "question": "How does data flow between different COBOL programs in OTIS?",
    "answer": "Data flow between COBOL programs in the OTIS/OTOS application is structured to support complex loan servicing and financial operations. Here’s how data typically moves through the system:\n\n---\n\n**BUSINESS PURPOSE:**\n- The OTIS system is designed to process loans, payments, collections, and reporting.\n- Data flows between programs to ensure that transactions are validated, recorded, updated, and reported accurately.\n- Each program is responsible for a specific business function (e.g., payment processing, account inquiry, reporting).\n\n---\n\n**TECHNICAL IMPLEMENTATION:**\n\n### 1. **File-Based Data Exchange**\n- Most COBOL programs in OTIS read and write to shared data files (e.g., LOAN-FILE, PAYMENT-FILE, LEDGER-FILE).\n- Programs update these files as part of their processing, and other programs read the updated data for further actions.\n- Example: APIPAY writes payment records to PAYMENT-FILE; REFUPD reads PAYMENT-FILE to update the ledger.\n\n### 2. **Program Calls and Modular Processing**\n- Programs often call other programs (static or dynamic CALL statements) to perform specialized tasks.\n- Data is passed via parameters (using LINKAGE SECTION) or through shared files.\n- Example: APIPAY calls REFUPD to update account balances after payment validation.\n\n### 3. **Screen and User Input**\n- User actions on screens (e.g., entering a payment) trigger program execution.\n- Data entered by users is validated and then written to files or passed to other programs for processing.\n\n### 4. **Batch and Real-Time Processing**\n- Some programs operate in batch mode (processing large volumes of data overnight), while others handle real-time transactions.\n- Batch programs read input files, process records, and write output files for downstream programs.\n\n### 5. **Data Validation and Transformation**\n- Data is validated at multiple points (e.g., payment amount checks, account status).\n- Programs may transform data formats or aggregate information before passing it on.\n\n---\n\n**EXAMPLE DATA FLOW CHAIN:**\n\nLet’s illustrate a typical payment workflow:\n\n1. **User enters payment on screen (SCRN1, GTFORM)**\n   - Data captured: account number, payment amount, date\n\n2. **PGMENU routes to APIPAY**\n   - APIPAY validates payment details\n   - Reads ACCOUNT-FILE for account status\n   - Writes payment record to PAYMENT-FILE\n\n3. **APIPAY calls REFUPD**\n   - REFUPD reads PAYMENT-FILE\n   - Updates account balance in LEDGER-FILE\n   - Writes transaction history to HISTORY-FILE\n\n4. **REFUPD calls LONPW9**\n   - LONPW9 reads updated account info\n   - Generates notification/confirmation letter\n\n5. **Reporting programs (e.g., RPTMON)**\n   - Read PAYMENT-FILE and LEDGER-FILE for monthly reports\n\n---\n\n**VISUAL REPRESENTATION:**\n\nHere's a visual diagram showing the data flow between key programs and files in OTIS:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Data Flow Example</text>\n  \n  <!-- Screens -->\n  <rect x=\"50\" y=\"80\" width=\"160\" height=\"60\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"130\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">SCRN1 / GTFORM</text>\n  <text x=\"130\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">User Input</text>\n  \n  <!-- PGMENU -->\n  <rect x=\"250\" y=\"80\" width=\"120\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"310\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">PGMENU</text>\n  <text x=\"310\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Routing</text>\n  \n  <!-- APIPAY -->\n  <rect x=\"400\" y=\"80\" width=\"120\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"460\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">APIPAY</text>\n  <text x=\"460\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Validation</text>\n  \n  <!-- REFUPD -->\n  <rect x=\"550\" y=\"80\" width=\"120\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"610\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">REFUPD</text>\n  <text x=\"610\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Ledger Update</text>\n  \n  <!-- LONPW9 -->\n  <rect x=\"700\" y=\"80\" width=\"120\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"760\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">LONPW9</text>\n  <text x=\"760\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Notification</text>\n  \n  <!-- Data Files -->\n  <rect x=\"250\" y=\"200\" width=\"120\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"310\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">ACCOUNT-FILE</text>\n  <rect x=\"400\" y=\"200\" width=\"120\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"460\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">PAYMENT-FILE</text>\n  <rect x=\"550\" y=\"200\" width=\"120\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"610\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">LEDGER-FILE</text>\n  <rect x=\"700\" y=\"200\" width=\"120\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"760\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">HISTORY-FILE</text>\n  \n  <!-- Arrows: User Input to PGMENU to APIPAY to REFUPD to LONPW9 -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"210\" y1=\"110\" x2=\"250\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"370\" y1=\"110\" x2=\"400\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"520\" y1=\"110\" x2=\"550\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"670\" y1=\"110\" x2=\"700\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Data arrows -->\n  <line x1=\"460\" y1=\"140\" x2=\"460\" y2=\"200\" stroke=\"#22c55e\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"310\" y1=\"140\" x2=\"310\" y2=\"200\" stroke=\"#22c55e\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"610\" y1=\"140\" x2=\"610\" y2=\"200\" stroke=\"#22c55e\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"760\" y1=\"140\" x2=\"760\" y2=\"200\" stroke=\"#22c55e\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Cross arrows for file access -->\n  <line x1=\"400\" y1=\"110\" x2=\"310\" y2=\"200\" stroke=\"#15803d\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"400\" y1=\"110\" x2=\"460\" y2=\"200\" stroke=\"#15803d\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"550\" y1=\"110\" x2=\"610\" y2=\"200\" stroke=\"#15803d\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"550\" y1=\"110\" x2=\"760\" y2=\"200\" stroke=\"#15803d\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**SUMMARY:**\n- Data flows through OTIS via shared files and program calls.\n- Each program reads/writes specific files and may call other programs for specialized processing.\n- User actions initiate the flow, and data is validated, transformed, and recorded at each step.\n- This modular approach ensures data integrity and supports complex business processes.\n\n(Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], [[FILE:REFUPD.CBL|REFUPD.CBL]], [[FILE:LONPW9.CBL|LONPW9.CBL]], Index: flows, program_deps, screen_nodes)",
    "sources_count": 200,
    "timing_seconds": 19.081
  },
  "Q13": {
    "question": "What indexed files are used in OTIS and what data do they contain?",
    "answer": "Indexed files in the OTIS/OTOS application are central to managing structured business data for loan servicing, customer accounts, and financial transactions. These files use keys to allow fast, direct access to records, supporting efficient updates and queries across the system.\n\n### Main Indexed Files Used in OTIS\n\nBelow is a list of key indexed files identified in the retrieved context, along with their business purpose and the type of data they contain:\n\n---\n\n#### 1. **LNFILE**  \n- **Purpose:** Loan master file  \n- **Data:** Contains detailed loan account information, including:\n  - Loan numbers, branch numbers\n  - Fee codes and amounts\n  - Insurance details (types, eligibility, premiums, coverage, commissions)\n  - Payment history and status\n  - Associated customer and dealer references  \n- **Indexed By:** Loan number (LN_NO), branch number (BR_NO)  \n- **Source:** [[FILE:LNFILE.CBL|LNFILE.CBL]], [[FILE:IOLNIN.CBL|IOLNIN.CBL]], [[FILE:RZWRI3.CBL|RZWRI3.CBL]] (see code examples below)\n\n#### 2. **FMFILE**  \n- **Purpose:** Financial master file  \n- **Data:** Tracks financial transactions, balances, and summary information for accounts  \n- **Indexed By:** Account number, transaction date  \n- **Source:** FMFILE (program metadata)\n\n#### 3. **CIFILE**  \n- **Purpose:** Customer information file  \n- **Data:** Stores customer master records, including:\n  - Personal details (name, address, contact info)\n  - Account relationships\n  - Credit history  \n- **Indexed By:** Customer ID  \n- **Source:** CIFILE (program metadata)\n\n#### 4. **ICFILE**  \n- **Purpose:** Insurance certificate file  \n- **Data:** Contains insurance certificate records linked to loans  \n- **Indexed By:** Certificate number  \n- **Source:** ICFILE (program metadata)\n\n#### 5. **SSFILE**  \n- **Purpose:** Subsystem file (often used for specialized loan or payment subsystems)  \n- **Data:** May contain subsystem-specific records, such as payment schedules or status flags  \n- **Indexed By:** Subsystem key  \n- **Source:** SSFILE (program metadata)\n\n#### 6. **CKFILE**  \n- **Purpose:** Check file  \n- **Data:** Stores check transaction records, including check numbers, amounts, and status  \n- **Indexed By:** Check number  \n- **Source:** CKFILE (program metadata)\n\n#### 7. **BWFILE**  \n- **Purpose:** Borrower file  \n- **Data:** Contains borrower-specific information, often linked to loans and payments  \n- **Indexed By:** Borrower ID  \n- **Source:** BWFILE (program metadata)\n\n#### 8. **GBFILE**  \n- **Purpose:** General business file  \n- **Data:** Holds general business records, such as branch info, dealer info, or system parameters  \n- **Indexed By:** Business key  \n- **Source:** GBFILE (program metadata)\n\n#### 9. **BXFILE**  \n- **Purpose:** Box file (often used for batch or archival records)  \n- **Data:** Stores batch processing or archival data  \n- **Indexed By:** Box ID  \n- **Source:** BXFILE (program metadata)\n\n#### 10. **IXFILE**  \n- **Purpose:** Index file (meta-index for alternate access paths)  \n- **Data:** Provides alternate indexes for other files, supporting secondary key access  \n- **Indexed By:** Alternate key fields  \n- **Source:** IXFILE (program metadata, [[FILE:UP1534_FS.CPY|UP1534_FS.CPY]])\n\n#### 11. **BYFILE**  \n- **Purpose:** Buyer file  \n- **Data:** Contains buyer records, often for dealer or customer relationships  \n- **Indexed By:** Buyer ID  \n- **Source:** BYFILE (program metadata)\n\n---\n\n### Example Indexed File Definition\n\nFrom **[[FILE:UP1534_FS.CPY|UP1534_FS.CPY]]** (Source: [[FILE:UP1534_FS.CPY|UP1534_FS.CPY]], Index: code):\n\n```cobol\nSELECT OIX-FILE ASSIGN TO OIX-PATH\n       ORGANIZATION INDEXED\n       ACCESS DYNAMIC\n       LOCK MODE AUTOMATIC WITH LOCK ON RECORD\n       RECORD KEY OIX1-KEY\n       ALTERNATE RECORD KEY OIX2-KEY WITH DUPLICATES\n       FILE STATUS FILE-STAT.\n```\n- **OIX-FILE** is an indexed file with a primary key (OIX1-KEY) and an alternate key (OIX2-KEY), supporting duplicate records for alternate access.\n\n---\n\n### Example Data Fields in LNFILE\n\nFrom **[[FILE:IOLNIN.CBL|IOLNIN.CBL]]** and **[[FILE:RZWRI3.CBL|RZWRI3.CBL]]** (Source: [[FILE:IOLNIN.CBL|IOLNIN.CBL]], [[FILE:RZWRI3.CBL|RZWRI3.CBL]], Index: code):\n\n```cobol\nLNFILE.LN_FEEOURS_19,\nLNFILE.LN_FEEFINCHG_19,\nLNFILE.LN_FEECODE_20,\nLNFILE.LN_FEEAMT_20,\nLNFILE.LN_INSURED,\nLNFILE.LN_INSTYPES,\nLNFILE.LN_INSELIGIBLE,\nLNFILE.LN_INSCOMP_1,\nLNFILE.LN_INSOURS_1,\nLNFILE.LN_INSEFF_DATE_1,\nLNFILE.LN_INSEXP_DATE_1,\nLNFILE.LN_INSPREM_1,\nLNFILE.LN_INSCOVR_1,\nLNFILE.LN_INSCOMM_1,\nLNFILE.LN_INSANTICERN_1,\nLNFILE.LN_INSANTICADJ_1,\nLNFILE.LN_INSUFERN_1,\nLNFILE.LN_INSACCERN_1,\nLNFILE.LN_INSEARN_ORDER_1,\nLNFILE.LN_INSFINCHG_1,\n```\n- These fields show the rich structure of LNFILE, supporting detailed loan and insurance tracking.\n\n---\n\n### Summary Table\n\n| File Name | Purpose                  | Indexed By         | Key Data Fields/Content                  |\n|-----------|--------------------------|--------------------|------------------------------------------|\n| LNFILE    | Loan master              | Loan/Branch No.    | Loan, fee, insurance, payment info       |\n| FMFILE    | Financial master         | Account/Date       | Transactions, balances                   |\n| CIFILE    | Customer info            | Customer ID        | Personal, account, credit info           |\n| ICFILE    | Insurance certificates   | Certificate No.    | Insurance records                        |\n| SSFILE    | Subsystem                | Subsystem key      | Subsystem-specific records               |\n| CKFILE    | Check transactions       | Check No.          | Check records                            |\n| BWFILE    | Borrower info            | Borrower ID        | Borrower details                         |\n| GBFILE    | General business         | Business key       | Branch, dealer, system params            |\n| BXFILE    | Batch/archive            | Box ID             | Batch/archive data                       |\n| IXFILE    | Alternate index/meta     | Alternate key      | Secondary access paths                   |\n| BYFILE    | Buyer info               | Buyer ID           | Buyer records                            |\n\n---\n\n### Business Impact\n\n- **Indexed files** enable fast lookups and updates for critical business operations (loan servicing, payments, customer management).\n- They support complex relationships (e.g., loans linked to customers, insurance, dealers).\n- Alternate indexes (IXFILE, OIX-FILE) provide flexible access for reporting and batch processing.\n\n---\n\n**Sources:**\n- [[FILE:LNFILE.CBL|LNFILE.CBL]], [[FILE:IOLNIN.CBL|IOLNIN.CBL]], [[FILE:RZWRI3.CBL|RZWRI3.CBL]] (loan file structure)\n- [[FILE:UP1534_FS.CPY|UP1534_FS.CPY]] (indexed file definition)\n- FMFILE, CIFILE, ICFILE, SSFILE, CKFILE, BWFILE, GBFILE, BXFILE, IXFILE, BYFILE (program metadata)\n\n---\n\n**If you need details on a specific indexed file’s structure or business logic, please specify the file name.**",
    "sources_count": 100,
    "timing_seconds": 16.279
  },
  "Q14": {
    "question": "How does OTIS handle file I/O operations (READ, WRITE, REWRITE, DELETE)?",
    "answer": "OTIS/OTOS handles file I/O operations (READ, WRITE, REWRITE, DELETE) using a structured approach typical of COBOL-based financial systems. Here’s how these operations are managed across the application:\n\n---\n\n**BUSINESS PURPOSE:**\n- File I/O operations are central to OTIS’s loan servicing, customer account management, and transaction processing.\n- Indexed and sequential files store persistent business data (loans, payments, customer info).\n- Programs perform I/O to update, retrieve, and maintain accurate records for regulatory and operational needs.\n\n---\n\n**TECHNICAL IMPLEMENTATION:**\n\n1. **File Control and Assignment:**\n   - Each COBOL program defines its files in the FILE-CONTROL section, specifying organization (INDEXED, SEQUENTIAL), access mode (INPUT, OUTPUT, I-O), and keys for indexed files.\n   - Example:  \n     ```\n     SELECT LOAN-FILE ASSIGN TO 'LOAN.DAT'\n       ORGANIZATION IS INDEXED\n       ACCESS MODE IS DYNAMIC\n       RECORD KEY IS LOAN-NUMBER.\n     ```\n\n2. **Standard I/O Operations:**\n   - **READ:** Retrieves records from files, often using keys for indexed files.\n     - Example:  \n       ```\n       READ LOAN-FILE\n         KEY IS LOAN-NUMBER\n         INVALID KEY\n           DISPLAY 'Loan not found'\n       END-READ.\n       ```\n     - Programs like LPMP1RN, WRFILE, and others contain paragraphs such as READ-OMP1-FILE-PREVIOUS, READ-WRFILE, etc. (Source: [[FILE:LPMP1RN|LPMP1RN]], [[FILE:WRFILE|WRFILE]], [[FILE:I|I]]ndex: paragraphs/programs)\n\n   - **WRITE:** Adds new records to files.\n     - Example:  \n       ```\n       WRITE LOAN-RECORD\n         INVALID KEY\n           DISPLAY 'Write failed'\n       END-WRITE.\n       ```\n     - Entry paragraphs like WRITE-XTRL-FILE, WRITE-IC-FILE, WRITE-XTRW-FILE are found in programs EXXTRLI, SPICI, EXXTRWI (Source: [[FILE:EXXTRLI|EXXTRLI]], [[FILE:SPICI|SPICI]], [[FILE:EXXTRWI|EXXTRWI]], [[FILE:I|I]]ndex: flows)\n\n   - **REWRITE:** Updates existing records in place.\n     - Example:  \n       ```\n       REWRITE LOAN-RECORD\n         INVALID KEY\n           DISPLAY 'Rewrite failed'\n       END-REWRITE.\n       ```\n     - Paragraphs such as REWRITE-WK1-FILE are present in programs like RZLER2, SQLER2, SQLLO2, CDBFLE, CLFILE, EAFILE (Source: [[FILE:RZLER2|RZLER2]], [[FILE:SQLER2|SQLER2]], [[FILE:SQLLO2|SQLLO2]], [[FILE:CDBFLE|CDBFLE]], [[FILE:CLFILE|CLFILE]], [[FILE:EAFILE|EAFILE]], [[FILE:I|I]]ndex: paragraphs)\n\n   - **DELETE:** Removes records from files.\n     - Example:  \n       ```\n       DELETE LOAN-FILE\n         RECORD KEY IS LOAN-NUMBER\n         INVALID KEY\n           DISPLAY 'Delete failed'\n       END-DELETE.\n       ```\n     - Paragraphs like DELETE-XTRL-FILE, DELETE-IC-FILE, DELETE-XLTD-FILE, DELETE-RX1-FILE, DELETE-IX1-FILE are found in EXXTRLI, SPICI, EXXLTDI, CREARX, CREAIX (Source: [[FILE:EXXTRLI|EXXTRLI]], [[FILE:SPICI|SPICI]], [[FILE:EXXLTDI|EXXLTDI]], [[FILE:CREARX|CREARX]], [[FILE:CREAIX|CREAIX]], [[FILE:I|I]]ndex: flows/flow_edges)\n\n3. **Modularization and Encapsulation:**\n   - Many programs encapsulate file I/O in dedicated paragraphs (e.g., READ-WRFILE, WRITE-WRFILE, DELETE-MODULE).\n   - Utility programs like CBL_DELETE_FILE are used for file deletion tasks (Source: [[FILE:CBL|CBL]]_DELETE_FILE, Index: programs).\n\n4. **Error Handling:**\n   - Each I/O operation checks for success/failure using INVALID KEY or AT END clauses.\n   - Error messages are displayed or logged, ensuring data integrity and user feedback.\n\n5. **Batch and Interactive Processing:**\n   - Batch programs (e.g., WRFILE, BWFILE, FMFILE) process large volumes of records in loops.\n   - Interactive programs (e.g., those handling screens) perform I/O in response to user actions.\n\n---\n\n**EXAMPLES FROM OTIS/OTOS:**\n\n- **WRFILE:** Handles reading and writing to work files, called by multiple programs for batch processing (Source: [[FILE:WRFILE|WRFILE]], [[FILE:I|I]]ndex: programs).\n- **LPMP1RN:** Contains paragraphs for reading previous records, supporting loan payment history retrieval (Source: [[FILE:LPMP1RN|LPMP1RN]], [[FILE:I|I]]ndex: paragraphs).\n- **EXXTRLI, SPICI, EXXLTDI:** Specialized programs for file operations (write, delete, rewrite) on extract and index files (Source: [[FILE:EXXTRLI|EXXTRLI]], [[FILE:SPICI|SPICI]], [[FILE:EXXLTDI|EXXLTDI]], [[FILE:I|I]]ndex: flows).\n- **CBL_DELETE_FILE:** Utility for deleting files, called by several programs for cleanup (Source: [[FILE:CBL|CBL]]_DELETE_FILE, Index: programs).\n\n---\n\n**DATA FLOW DIAGRAM:**\n\nHere's a visual representation of how file I/O operations are structured in OTIS:\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS File I/O Operations</text>\n  \n  <!-- Programs -->\n  <rect x=\"60\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">WRFILE</text>\n  <text x=\"140\" y=\"128\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Batch Processing</text>\n  \n  <rect x=\"260\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"340\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LPMP1RN</text>\n  <text x=\"340\" y=\"128\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Payments</text>\n  \n  <rect x=\"460\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"540\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">EXXTRLI</text>\n  <text x=\"540\" y=\"128\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Extract File Ops</text>\n  \n  <rect x=\"660\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"740\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">CBL_DELETE_FILE</text>\n  <text x=\"740\" y=\"128\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">File Deletion</text>\n  \n  <!-- File I/O Operations -->\n  <rect x=\"180\" y=\"200\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"240\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">READ</text>\n  \n  <rect x=\"340\" y=\"200\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"400\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">WRITE</text>\n  \n  <rect x=\"500\" y=\"200\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">REWRITE</text>\n  \n  <rect x=\"660\" y=\"200\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"720\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"15\" font-weight=\"bold\">DELETE</text>\n  \n  <!-- Data Files -->\n  <rect x=\"340\" y=\"320\" width=\"220\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"450\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Indexed/Sequential Files</text>\n  <text x=\"450\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">LOAN-FILE, PAYMENT-FILE, WORK-FILE, etc.</text>\n  \n  <!-- Arrows from programs to operations -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"140\" y1=\"140\" x2=\"240\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"340\" y1=\"140\" x2=\"400\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"540\" y1=\"140\" x2=\"560\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"740\" y1=\"140\" x2=\"720\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  \n  <!-- Arrows from operations to data files -->\n  <line x1=\"240\" y1=\"260\" x2=\"450\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"400\" y1=\"260\" x2=\"450\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"560\" y1=\"260\" x2=\"450\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"720\" y1=\"260\" x2=\"450\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**SUMMARY:**\n- OTIS uses dedicated COBOL paragraphs and utility programs for each file I/O operation.\n- Operations are modular, with error handling and business logic integrated.\n- Data flows from programs through I/O operations to persistent files, supporting all core business functions.\n\n**Sources:**\n- LPMP1RN, WRFILE, EXXTRLI, SPICI, EXXLTDI, CREARX, CREAIX, CBL_DELETE_FILE (Index: programs, paragraphs, flows, flow_edges)",
    "sources_count": 100,
    "timing_seconds": 17.52
  },
  "Q15": {
    "question": "What is the relationship between programs and the files they access?",
    "answer": "The relationship between COBOL programs and the files they access in the OTIS system is structured around business functions, with each program typically responsible for managing, updating, or querying specific indexed files. Here’s how this relationship works:\n\n---\n\n**DIRECT PROGRAM-FILE RELATIONSHIP:**\n\n- Each program is designed to handle operations (READ, WRITE, REWRITE, DELETE) on one or more files that contain business-critical data.\n- Programs often have names that reflect the file they manage (e.g., LNFILE for loan data, CHFILE for charge data).\n- The files are usually indexed, allowing programs to quickly locate records using keys (such as account numbers, loan IDs, or branch codes).\n\n**EXAMPLES FROM CONTEXT:**\n\n- **LNFILE**: Accessed by 113 programs, indicating it is a central file for loan records. Programs call LNFILE to read or update loan information.  \n  (Source: [[FILE:LNFILE|LNFILE]], [[FILE:I|I]]ndex: programs)\n- **CHFILE**: Called by and calls other programs, managing charge records. It uses copybooks like [[FILE:ACCESSW.CPY|ACCESSW.CPY]] and [[FILE:DACCESS.CPY|DACCESS.CPY]] to define file access logic.  \n  (Source: [[FILE:CHFILE|CHFILE]], [[FILE:I|I]]ndex: programs; [[FILE:CHFILE.CBL|CHFILE.CBL]], Index: copybook_usage)\n- **SSFILE**: Handles social security or similar data, accessed by multiple programs and uses [[FILE:DACCESS.CPY|DACCESS.CPY]] for file definitions.  \n  (Source: [[FILE:SSFILE|SSFILE]], [[FILE:I|I]]ndex: programs; [[FILE:SSFILE.CBL|SSFILE.CBL]], Index: copybook_usage)\n- **STFILE**: Manages state-related data, accessed by other programs and uses [[FILE:ACCESSW.CPY|ACCESSW.CPY]] for file access routines.  \n  (Source: [[FILE:STFILE|STFILE]], [[FILE:I|I]]ndex: programs; [[FILE:STFILE.CBL|STFILE.CBL]], Index: copybook_usage)\n\n**INTERMEDIATE PROGRAMS:**\n\n- Many programs are both called by other programs and make calls themselves, acting as intermediaries in data processing chains (e.g., FMFILE, CHFILE, CLFILE).\n- These programs often encapsulate file access logic, so other business logic programs can interact with files indirectly.\n\n**COPYBOOKS DEFINE FILE STRUCTURE:**\n\n- Programs use copybooks (e.g., [[FILE:ACCESSW.CPY|ACCESSW.CPY]], [[FILE:DACCESS.CPY|DACCESS.CPY]]) to define the structure and access routines for files.\n- This ensures consistency in how files are accessed and manipulated across different programs.\n\n**CALL CHAIN AND DATA FLOW:**\n\n- Programs may call file handler programs (e.g., LNFILE, CHFILE) to perform file operations, rather than accessing files directly.\n- This modular approach allows for centralized file management and easier maintenance.\n\n---\n\n**VISUAL REPRESENTATION:**\n\nHere's a visual diagram showing the relationship between programs and the files they access:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Program-File Relationships in OTIS</text>\n  \n  <!-- Programs -->\n  <rect x=\"100\" y=\"80\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LNFILE</text>\n  <text x=\"160\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan File Handler</text>\n  \n  <rect x=\"100\" y=\"180\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">CHFILE</text>\n  <text x=\"160\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Charge File Handler</text>\n  \n  <rect x=\"100\" y=\"280\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"310\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SSFILE</text>\n  <text x=\"160\" y=\"330\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">SSN File Handler</text>\n  \n  <rect x=\"100\" y=\"380\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"410\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">STFILE</text>\n  <text x=\"160\" y=\"430\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">State File Handler</text>\n  \n  <!-- Files -->\n  <rect x=\"400\" y=\"80\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Loan Indexed File</text>\n  <text x=\"490\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan records</text>\n  \n  <rect x=\"400\" y=\"180\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Charge Indexed File</text>\n  <text x=\"490\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Charge records</text>\n  \n  <rect x=\"400\" y=\"280\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"310\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SSN Indexed File</text>\n  <text x=\"490\" y=\"330\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">SSN records</text>\n  \n  <rect x=\"400\" y=\"380\" width=\"180\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"410\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">State Indexed File</text>\n  <text x=\"490\" y=\"430\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">State records</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"220\" y1=\"110\" x2=\"400\" y2=\"110\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"220\" y1=\"210\" x2=\"400\" y2=\"210\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"220\" y1=\"310\" x2=\"400\" y2=\"310\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"220\" y1=\"410\" x2=\"400\" y2=\"410\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**SUMMARY:**\n\n- Programs are tightly coupled to the files they manage, with clear boundaries for business logic and data access.\n- File handler programs encapsulate file operations, while business logic programs call these handlers to manipulate data.\n- Copybooks standardize file access routines and data structures across programs.\n- This modular approach ensures maintainability, consistency, and efficient data flow throughout the OTIS system.\n\n**Sources:**  \n- LNFILE, CHFILE, SSFILE, STFILE (Source: respective program indexes)  \n- [[FILE:CHFILE.CBL|CHFILE.CBL]], [[FILE:SSFILE.CBL|SSFILE.CBL]], [[FILE:STFILE.CBL|STFILE.CBL]] (Source: copybook_usage indexes)",
    "sources_count": 100,
    "timing_seconds": 16.352
  },
  "Q16": {
    "question": "How does OTIS use SQL to access database tables?",
    "answer": "OTIS uses embedded SQL within COBOL programs to access and manipulate database tables, supporting business processes such as loan servicing, transaction management, and reporting.\n\n**Business Purpose:**\n- SQL is used to read, insert, update, and delete records in relational database tables that store core business data (loans, payments, customer accounts, etc.).\n- This enables OTIS to efficiently manage large volumes of structured data, support reporting, and maintain data integrity across the system.\n\n**Technical Implementation:**\n\n1. **Embedded SQL Statements:**\n   - COBOL programs include EXEC SQL blocks to perform database operations.\n   - Typical operations include SELECT (read), INSERT (write), UPDATE (rewrite), and DELETE.\n\n   **Example:**\n   ```cobol\n   EXEC SQL\n    INSERT INTO DBO.BYAFILE\n     (BYAFILE.BYA_DATE_CCYYMM,\n      BYAFILE.BYA_BRNO,\n      BYAFILE.BYA_CLASS,\n      BYAFILE.BYA_LTOUCH_DATE,\n      BYAFILE.BYA_NO_1_1_1,\n      BYAFILE.BYA_AMT_1_1_1,\n      BYAFILE.BYA_O2_1_1_1,\n      BYAFILE.BYA_INT_1_1_1,\n      BYAFILE.BYA_NO_1_1_2,\n      ...\n   END-EXEC.\n   ```\n   (Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: code)\n\n2. **SQL Connection Management:**\n   - Programs use routines to establish and manage SQL database connections.\n   - Connection logic is often handled by specialized modules (e.g., IOCONN, SQLCONNECT) and copybooks (e.g., [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]]).\n   - Connection status is checked before performing I/O, and connections are swapped or closed as needed.\n\n   **Example:**\n   ```cobol\n   MOVE '2' TO SQL-UPDATE-CONN-USE-SW. *> USE UPDATE_CONNECT\n   PERFORM SQL-SWAP-UPDATE-CONNECTION.\n   ```\n   (Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: code)\n\n   - Comments highlight the need to set SQL connection fields for each table and ensure connections are open before I/O:\n     > \"SQL CONNECTION FIELDS NEED TO BE SET SO THAT THEY CAN BE USED FOR EACH IO ROUTINE NEEDED;\"  \n     (Source: [[FILE:DATE35.CBL|DATE35.CBL]], Index: code)\n\n3. **Validation and Error Handling:**\n   - SQL-IO-VALIDATION routines check connection status and handle errors.\n   - If a connection fails, programs may close files/tables and log errors, sometimes requiring user intervention.\n\n   **Example:**\n   > \"IN SQL-IO-VALIDATION ROUTINE ADDED A CHECK TO SEE IF THE SQL CONNECTION (EXT-ACUSQL-CONNECT-STAT) IS OPEN (GOOD) THEN `PERFORM CLOSE-FILES`;\"  \n   (Source: [[FILE:DECLRP_ASCII.CPY|DECLRP_ASCII.CPY]], Index: code)\n\n4. **Modular SQL Access Programs:**\n   - Dedicated programs (e.g., SQL, SQLLC, SQLCONNECT) encapsulate SQL access logic.\n   - These are called by business logic programs to perform database operations.\n\n   **Example:**\n   - Program SQL: role=DATA_ACCESS, called by 2 programs, no outgoing calls (Source: [[FILE:SQL|SQL]], [[FILE:I|I]]ndex: programs)\n   - Program SQLLC: handles file operations and SQL modules (Source: [[FILE:SQLLC|SQLLC]], [[FILE:I|I]]ndex: flows)\n\n5. **Dynamic SQL Construction:**\n   - Programs build SQL statements dynamically using COBOL STRING operations to customize queries based on business logic.\n\n   **Example:**\n   ```cobol\n   STRING \" WHERE TRBFILE.TB_BRNO = \",  \n          QTRB1-WBEG-BRNO ,  \n          \" AND TRBFILE.TB_DATE BETWEEN '\"  ,\n          QTRB1-WBEG-DATE  ,\n          \" ' AND '\" ,\n          QTRB1-WEND-DATE ,\n          \"' | \" INTO WS-WHER\n   ```\n   (Source: [[FILE:RECAPJ.CBL|RECAPJ.CBL]], Index: code)\n\n6. **Copybooks for SQL Integration:**\n   - Common SQL routines and connection logic are shared via copybooks such as [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]], [[FILE:DECLARE.CPY|DECLARE.CPY]], and [[FILE:CHKSEC.CPY|CHKSEC.CPY]].\n   - These provide reusable code for connection setup, error handling, and security checks.\n\n   **Example Copybooks:**\n   - [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]] – SQL connection routines (used by SPCTBL, SFCALC, PST467, RZ1DA4, etc.)\n   - [[FILE:DECLARE.CPY|DECLARE.CPY]] – SQL variable and cursor declarations (used by SPVERI)\n   - [[FILE:CHKSEC.CPY|CHKSEC.CPY]] – Security validation for SQL operations (used by AQMAIN, FMSCN2, EOSCAN, CDSCAN)\n\n**Summary Table: Key SQL Usage Patterns in OTIS**\n\n| Pattern                     | Example Program/Copybook | Purpose                                 |\n|-----------------------------|--------------------------|------------------------------------------|\n| EXEC SQL blocks             | [[FILE:LPEOD5.CBL|LPEOD5.CBL]], [[FILE:MBNOFL.CBL|MBNOFL.CBL]]   | Direct table access (INSERT/SELECT)      |\n| Connection management       | IOCONN, SQLCONNECT       | Establish/validate SQL connections       |\n| Validation routines         | [[FILE:DECLRP_ASCII.CPY|DECLRP_ASCII.CPY]]         | Ensure connection before I/O             |\n| Dynamic SQL construction    | [[FILE:RECAPJ.CBL|RECAPJ.CBL]], [[FILE:GLDIST.CBL|GLDIST.CBL]]   | Custom queries for reporting             |\n| Shared SQL copybooks        | [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]], [[FILE:DECLARE.CPY|DECLARE.CPY]] | Reusable connection/error logic     |\n\n**Here's a visual representation of the SQL access architecture in OTIS:**\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS SQL Access Architecture</text>\n  \n  <!-- Application Layer -->\n  <rect x=\"50\" y=\"70\" width=\"800\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"100\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">Application Programs</text>\n  <text x=\"450\" y=\"125\" text-anchor=\"middle\" font-size=\"14\" fill=\"#4338ca\">LPEOD5, MBNOFL, RECAPJ, GLDIST, etc.</text>\n  \n  <!-- SQL Access Layer -->\n  <rect x=\"50\" y=\"180\" width=\"800\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"210\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#1e40af\">SQL Access Modules & Copybooks</text>\n  <text x=\"450\" y=\"235\" text-anchor=\"middle\" font-size=\"14\" fill=\"#1e40af\">IOCONN, SQLCONNECT, [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]], [[FILE:DECLARE.CPY|DECLARE.CPY]], [[FILE:CHKSEC.CPY|CHKSEC.CPY]]</text>\n  \n  <!-- Database Layer -->\n  <rect x=\"50\" y=\"290\" width=\"800\" height=\"80\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"320\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#15803d\">Database Tables</text>\n  <text x=\"450\" y=\"345\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">BYAFILE, DSFILE, NOFILE, TRBFILE, TRJFILE, TRKFILE, etc.</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"450\" y1=\"150\" x2=\"450\" y2=\"180\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"260\" x2=\"450\" y2=\"290\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n**Source Citations:**\n- [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: code (SQL INSERT example, connection logic)\n- [[FILE:MBNOFL.CBL|MBNOFL.CBL]], Index: code (SQL INSERT example)\n- [[FILE:RECAPJ.CBL|RECAPJ.CBL]], Index: code (dynamic SQL SELECT construction)\n- [[FILE:DATE35.CBL|DATE35.CBL]], Index: code (connection management comments)\n- [[FILE:DECLRP_ASCII.CPY|DECLRP_ASCII.CPY]], Index: code (validation/error handling)\n- SQL, SQLLC, IOCONN, SQLCONNECT, CONNECT_SQL, CHKSEC, DECLARE (Index: programs, flows, copybook_usage)\n\n**Summary:**  \nOTIS leverages embedded SQL in COBOL, modular connection routines, and shared copybooks to access and manage relational database tables, ensuring robust data handling for its financial operations.",
    "sources_count": 100,
    "timing_seconds": 18.039
  },
  "Q17": {
    "question": "What are the key data structures passed between programs?",
    "answer": "In the OTIS system, key data structures passed between programs are primarily defined in copybooks and working-storage sections. These structures facilitate consistent data exchange for business processes such as file maintenance, transaction processing, and reporting.\n\n### Key Data Structures Passed Between Programs\n\n#### 1. **Record Buffers and Keys**\n- **Loan, Dealer, and Account Keys:**  \n  - Example:  \n    - `HOLD-DL1-KEY` (Source: [[FILE:DLMAN6.CBL|DLMAN6.CBL]], Index: code)  \n      - Contains branch number (`HOLD-DL-BRNO`) and dealer number (`HOLD-DL-NUM`).\n    - `SAVE-PD2-KEY` (Source: [[FILE:ZONPC0.CBL|ZONPC0.CBL]], Index: code)  \n      - Includes key ID, branch, and name fields.\n  - **Purpose:** Used to uniquely identify and transfer records between modules.\n\n#### 2. **Common Memory Buffers**\n- **PROG-BUF** (Source: [[FILE:LPLONIW.CPY|LPLONIW.CPY]], Index: code)\n  - Contains error codes, program form data, and other control fields.\n  - **Purpose:** Facilitates error handling and control flow between programs.\n\n#### 3. **File Record Structures**\n- **Original and Changed Records:**  \n  - Example:  \n    - `ORIGINAL-DL-REC` and `CHANGED-DL-REC` (Source: [[FILE:DLMAN6.CBL|DLMAN6.CBL]], Index: code)\n      - Used for before/after images in update operations.\n  - **Purpose:** Enables programs to compare, update, or audit changes.\n\n#### 4. **Screen and Message Buffers**\n- **Message Lines:**  \n  - Example:  \n    - `MSG-LINE1`, `MSG-LINE2` (Source: [[FILE:ZONPC0.CBL|ZONPC0.CBL]], Index: code)\n      - Used for passing status or error messages between programs and screens.\n  - **Purpose:** Communicates results, errors, or prompts to users.\n\n#### 5. **Copybook-Based Data Structures**\n- **Standardized Data Definitions:**  \n  - Example:  \n    - `LIBGB/[[FILE:GBFSPR.CPY|GBFSPR.CPY]]` - General business file structure definitions (used by many programs, e.g., DLLIST, CLMCTR, GCLIST, CKVOID, GLEOD2, LN1099)\n    - `LIBGB/[[FILE:GBFSWK2I.CPY|GBFSWK2I.CPY]]` - Ageing and trial balance structures (used by AGEALP)\n    - `LIBSP/[[FILE:SPINQ1.CPY|SPINQ1.CPY]]` - Specialized inquiry structures (used by SPINQ)\n    - `LIBLP/[[FILE:LPWSDL.CPY|LPWSDL.CPY]]` - Loan payment work structures (used by RZ1ERN)\n  - **Purpose:** Ensures consistent field layouts for records, keys, and transaction data across all modules.\n\n#### 6. **Specialized Buffers for Bulk Operations**\n- **Bulk Transfer Workers:**  \n  - Example:  \n    - `LIBLP/[[FILE:BULKTRW.CPY|BULKTRW.CPY]]` (Source: [[FILE:BULKTRW.CPY|BULKTRW.CPY]], Index: code)\n      - Contains fields for data paths and transfer control.\n  - **Purpose:** Supports batch and bulk data movement between programs.\n\n### Data Flow Example\n\n- When a program like DLFILE processes a dealer record:\n  - It passes `HOLD-DL1-KEY` to identify the record.\n  - Uses `ORIGINAL-DL-REC` and `CHANGED-DL-REC` to manage updates.\n  - Relies on copybooks like `[[FILE:LP01DL.CPY|LP01DL.CPY]]` for consistent record structure.\n\n- For loan processing, programs use:\n  - Key buffers (`SAVE-PD2-KEY`)\n  - Common memory (`PROG-BUF`)\n  - Standardized loan record structures from copybooks (`[[FILE:LP01LR.CPY|LP01LR.CPY]]`)\n\n### Summary Table of Key Data Structures\n\n| Structure Name         | Source/Copybook              | Purpose/Description                                 |\n|-----------------------|------------------------------|-----------------------------------------------------|\n| HOLD-DL1-KEY          | [[FILE:DLMAN6.CBL|DLMAN6.CBL]]                   | Dealer record key (branch, dealer number)           |\n| SAVE-PD2-KEY          | [[FILE:ZONPC0.CBL|ZONPC0.CBL]]                   | Payment/loan key (ID, branch, name)                 |\n| PROG-BUF              | [[FILE:LPLONIW.CPY|LPLONIW.CPY]]                  | Common memory for error/control info                |\n| ORIGINAL-DL-REC       | [[FILE:DLMAN6.CBL|DLMAN6.CBL]]                   | Before image of dealer record                       |\n| CHANGED-DL-REC        | [[FILE:DLMAN6.CBL|DLMAN6.CBL]]                   | After image of dealer record                        |\n| MSG-LINE1/MSG-LINE2   | [[FILE:ZONPC0.CBL|ZONPC0.CBL]]                   | Message buffers for status/error communication      |\n| [[FILE:GBFSPR.CPY|GBFSPR.CPY]]            | LIBGB/[[FILE:GBFSPR.CPY|GBFSPR.CPY]]             | General business file structure definitions         |\n| [[FILE:GBFSWK2I.CPY|GBFSWK2I.CPY]]          | LIBGB/[[FILE:GBFSWK2I.CPY|GBFSWK2I.CPY]]           | Ageing/trial balance structures                     |\n| [[FILE:SPINQ1.CPY|SPINQ1.CPY]]            | LIBSP/[[FILE:SPINQ1.CPY|SPINQ1.CPY]]             | Inquiry record structures                           |\n| [[FILE:LPWSDL.CPY|LPWSDL.CPY]]            | LIBLP/[[FILE:LPWSDL.CPY|LPWSDL.CPY]]             | Loan payment work structures                        |\n| [[FILE:BULKTRW.CPY|BULKTRW.CPY]]           | LIBLP/[[FILE:BULKTRW.CPY|BULKTRW.CPY]]            | Bulk transfer worker fields                         |\n\n### Visual Representation\n\nHere's a visual representation of how key data structures flow between programs:\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Data Structure Flow</text>\n  \n  <!-- Programs -->\n  <rect x=\"60\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">DLFILE</text>\n  <text x=\"140\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Dealer File Program</text>\n  \n  <rect x=\"360\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"440\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LPLONIW</text>\n  <text x=\"440\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Info Program</text>\n  \n  <rect x=\"660\" y=\"80\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"740\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SPINQ</text>\n  <text x=\"740\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Inquiry Program</text>\n  \n  <!-- Data Structures -->\n  <rect x=\"60\" y=\"200\" width=\"160\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">HOLD-DL1-KEY</text>\n  <text x=\"140\" y=\"240\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Dealer Key</text>\n  \n  <rect x=\"260\" y=\"200\" width=\"160\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"340\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">PROG-BUF</text>\n  <text x=\"340\" y=\"240\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Common Buffer</text>\n  \n  <rect x=\"460\" y=\"200\" width=\"160\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"540\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">SAVE-PD2-KEY</text>\n  <text x=\"540\" y=\"240\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Payment/Loan Key</text>\n  \n  <rect x=\"660\" y=\"200\" width=\"160\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"740\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">[[FILE:SPINQ1.CPY|SPINQ1.CPY]]</text>\n  <text x=\"740\" y=\"240\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Inquiry Structure</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"140\" y1=\"140\" x2=\"140\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"440\" y1=\"140\" x2=\"340\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"440\" y1=\"140\" x2=\"540\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"740\" y1=\"140\" x2=\"740\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n### Source Citations\n- [[FILE:DLMAN6.CBL|DLMAN6.CBL]], Index: code (HOLD-DL1-KEY, ORIGINAL-DL-REC, CHANGED-DL-REC)\n- [[FILE:ZONPC0.CBL|ZONPC0.CBL]], Index: code (SAVE-PD2-KEY, MSG-LINE1/2)\n- [[FILE:LPLONIW.CPY|LPLONIW.CPY]], Index: code (PROG-BUF)\n- [[FILE:BULKTRW.CPY|BULKTRW.CPY]], Index: code (Bulk transfer workers)\n- [[FILE:AGEALP.CBL|AGEALP.CBL]], Index: copybook_usage ([[FILE:GBFSWK2I.CPY|GBFSWK2I.CPY]])\n- [[FILE:DLLIST.CBL|DLLIST.CBL]], [[FILE:CLMCTR.CBL|CLMCTR.CBL]], [[FILE:GCLIST.CBL|GCLIST.CBL]], [[FILE:CKVOID.CBL|CKVOID.CBL]], [[FILE:GLEOD2.CBL|GLEOD2.CBL]], [[FILE:LN1099.CBL|LN1099.CBL]], Index: copybook_usage ([[FILE:GBFSPR.CPY|GBFSPR.CPY]])\n- [[FILE:SPINQ.CBL|SPINQ.CBL]], Index: copybook_usage ([[FILE:SPINQ1.CPY|SPINQ1.CPY]])\n- [[FILE:RZ1ERN.CBL|RZ1ERN.CBL]], Index: copybook_usage ([[FILE:LPWSDL.CPY|LPWSDL.CPY]])\n\nIf you need details on a specific data structure or how it is used in a particular program, let me know!",
    "sources_count": 100,
    "timing_seconds": 19.628
  },
  "Q18": {
    "question": "How does OTIS handle transaction processing and data consistency?",
    "answer": "OTIS handles transaction processing and data consistency through a combination of structured COBOL program flows, embedded SQL operations, and rigorous file management routines. Here’s how these mechanisms work together:\n\n---\n\n**BUSINESS PURPOSE:**\n- OTIS supports financial operations such as loan servicing, payments, transfers, and reporting.\n- Transaction processing ensures that business events (e.g., payments, transfers) are recorded accurately and consistently.\n- Data consistency is critical to maintain accurate account balances, transaction histories, and regulatory compliance.\n\n---\n\n**TECHNICAL IMPLEMENTATION:**\n\n### 1. **Transaction Processing Workflow**\n\n- **Program Structure:**  \n  Transaction processing is managed by dedicated COBOL programs (e.g., LONPD0, LPEOD5, TRXMN3, TRCMAN) that orchestrate the reading, updating, and writing of transaction records.\n- **File Operations:**  \n  Programs use PERFORM statements to sequence operations such as opening files, moving data, and updating records.  \n  Example (from LONPD0 and LPEOD5):\n  ```cobol\n  PERFORM OPEN-TRX1-FILE.\n  MOVE LPEOD5-BRANCH TO TX-BRNO.\n  MOVE LPEOD5-TRANS-DATE TO TX-DATE SQL-DATE-YYYYMMDD.\n  PERFORM SQL-SET-DATE.\n  PERFORM START-TRX1-FILE.\n  PERFORM READ-TRX1-FILE-NEXT.\n  IF IO-FG NOT = 0 OR (TRX-PATH-OWNBR NOT = TX-BRNO)\n     PERFORM ERROR-HANDLING.\n  ```\n  (Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: code; [[FILE:REDACT.CBL|REDACT.CBL]], Index: code)\n\n- **Embedded SQL:**  \n  Many programs use embedded SQL to interact with database tables, ensuring atomicity and consistency.\n  - SQL operations are wrapped in EXEC SQL blocks.\n  - COMMIT and ROLLBACK statements are used to finalize or revert transactions.\n  - Example:\n    ```cobol\n    EXEC SQL COMMIT END-EXEC\n    PERFORM SQL-IO-VALIDATION.\n    ```\n    (Source: [[FILE:IOTRXI.CBL|IOTRXI.CBL]], Index: code)\n\n### 2. **Data Consistency Mechanisms**\n\n- **Validation Routines:**  \n  Before updating files or committing transactions, programs validate input data and check business rules.\n  - Example: PERFORM SQL-IO-VALIDATION ensures the integrity of SQL operations.\n- **Error Handling:**  \n  If an error or inconsistency is detected (e.g., IO-FG not zero), the program triggers error handling routines and may roll back changes.\n  - Example:\n    ```cobol\n    IF ( IO-FG = 8 )     *> LOCKED\n       GO TO REWRITE-TRX1-FILE.\n    IF ( IO-FG = 0 )\n       EXEC SQL COMMIT END-EXEC\n       PERFORM SQL-IO-VALIDATION.\n    ```\n    (Source: [[FILE:IOTRXI.CBL|IOTRXI.CBL]], Index: code)\n\n- **Sequential File Updates:**  \n  Programs use MOVE and PERFORM statements to update transaction files in a controlled sequence, reducing the risk of partial updates.\n  - Example:\n    ```cobol\n    PERFORM WRITE-TRX1-FILE.\n    IF IO-FG = 0\n       GO TO EXIT-UPDATE-TR1-PURCHASED.\n    ```\n    (Source: [[FILE:LONPFZ.CBL|LONPFZ.CBL]], Index: code)\n\n- **Change Logging:**  \n  Many transaction maintenance programs (e.g., TRXMN3, TRBMN3, TRCMAN) include logic to write change files after updates, supporting audit trails and rollback capability.\n  - Example (from program comments):\n    ```\n    *   ADDED CODE TO WRITE CHANGE FILE AFTER REWRITE\n    ```\n    (Source: [[FILE:TRXMN3.CBL|TRXMN3.CBL]], [[FILE:TRBMN3.CBL|TRBMN3.CBL]], [[FILE:TRCMAN.CBL|TRCMAN.CBL]], Index: code)\n\n### 3. **Concurrency and Locking**\n\n- **Record Locking:**  \n  Programs check for locked records (IO-FG = 8) and handle them appropriately, either by retrying, skipping, or logging the issue.\n- **Commit/Rollback:**  \n  SQL transactions are only committed after successful validation, ensuring that only consistent data is saved.\n\n### 4. **Copybooks for Data Structure Consistency**\n\n- **Shared Data Structures:**  \n  Copybooks (e.g., LIBGB/[[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]], LIBLP/[[FILE:LPFDED.CPY|LPFDED.CPY]]) define transaction record layouts and SQL connection parameters, ensuring consistent data formats across programs.\n  - Example:\n    - [[FILE:LPFDED.CPY|LPFDED.CPY]] - Loan payment file definitions (used by LPEOD5, RECAPJ)\n    - [[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]] - SQL connection and transaction control structures (used by TRXMN3, TRXMN2, TRXSCN)\n    (Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], [[FILE:RECAPJ.CBL|RECAPJ.CBL]], [[FILE:TRXMN3.CBL|TRXMN3.CBL]], [[FILE:TRXMN2.CBL|TRXMN2.CBL]], [[FILE:TRXSCN.CBL|TRXSCN.CBL]], Index: copybook_usage)\n\n---\n\n**SUMMARY OF KEY MECHANISMS:**\n- Controlled program flow using PERFORM and MOVE statements\n- Embedded SQL for atomic database operations\n- Validation and error handling before committing changes\n- Change logging for audit and rollback\n- Shared copybooks for consistent data structures\n- Record locking and transaction control for concurrency\n\n---\n\n**Here's a visual representation of the transaction processing and data consistency flow in OTIS:**\n\n<svg width=\"900\" height=\"600\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Transaction Processing & Data Consistency</text>\n  \n  <!-- Step 1: User Input -->\n  <rect x=\"50\" y=\"80\" width=\"180\" height=\"60\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"140\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">User Input</text>\n  <text x=\"140\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Screen/Entry</text>\n  \n  <!-- Step 2: Program Validation -->\n  <rect x=\"270\" y=\"80\" width=\"180\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"360\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Validation</text>\n  <text x=\"360\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Business Rules</text>\n  \n  <!-- Step 3: Transaction Processing -->\n  <rect x=\"490\" y=\"80\" width=\"180\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"580\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Transaction Processing</text>\n  <text x=\"580\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">COBOL + SQL</text>\n  \n  <!-- Step 4: Data Consistency -->\n  <rect x=\"710\" y=\"80\" width=\"140\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"780\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Data Consistency</text>\n  <text x=\"780\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Commit/Rollback</text>\n  \n  <!-- Step 5: Change Logging -->\n  <rect x=\"270\" y=\"200\" width=\"180\" height=\"60\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"360\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b45309\">Change Logging</text>\n  <text x=\"360\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"#f59e0b\">Audit Trail</text>\n  \n  <!-- Step 6: Error Handling -->\n  <rect x=\"490\" y=\"200\" width=\"180\" height=\"60\" fill=\"#fee2e2\" stroke=\"#ef4444\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"580\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#dc2626\">Error Handling</text>\n  <text x=\"580\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"#ef4444\">Rollback/Notify</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"230\" y1=\"110\" x2=\"270\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"110\" x2=\"490\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"670\" y1=\"110\" x2=\"710\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"580\" y1=\"140\" x2=\"580\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"360\" y1=\"140\" x2=\"360\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**Source Citations:**\n- [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: code (transaction file operations)\n- [[FILE:REDACT.CBL|REDACT.CBL]], Index: code (transaction update and error handling)\n- [[FILE:IOTRXI.CBL|IOTRXI.CBL]], Index: code (SQL commit/rollback and validation)\n- [[FILE:TRXMN3.CBL|TRXMN3.CBL]], [[FILE:TRBMN3.CBL|TRBMN3.CBL]], [[FILE:TRCMAN.CBL|TRCMAN.CBL]], Index: code (change logging)\n- [[FILE:LPEOD5.CBL|LPEOD5.CBL]], [[FILE:RECAPJ.CBL|RECAPJ.CBL]], [[FILE:TRXMN3.CBL|TRXMN3.CBL]], [[FILE:TRXMN2.CBL|TRXMN2.CBL]], [[FILE:TRXSCN.CBL|TRXSCN.CBL]], Index: copybook_usage (shared copybooks for data consistency)\n\nIf you need details on a specific transaction type or program, let me know!",
    "sources_count": 100,
    "timing_seconds": 20.551
  },
  "Q19": {
    "question": "What file locking mechanisms are used in OTIS?",
    "answer": "OTIS uses several file locking mechanisms to ensure data consistency and prevent concurrent access issues during transaction processing. These mechanisms are implemented through COBOL file control clauses, embedded SQL, and programmatic logic. Here’s a summary of the main approaches:\n\n---\n\n**1. COBOL File Control Clauses**\n\n- **LOCK MODE AUTOMATIC WITH LOCK ON RECORD**  \n  Most COBOL SELECT statements in OTIS specify `LOCK MODE AUTOMATIC WITH LOCK ON RECORD`.  \n  This means:\n  - When a record is read for update, it is automatically locked by the runtime.\n  - Other users/programs cannot update the same record until the lock is released.\n  - This is visible in many file definitions, for example:\n\n    ```cobol\n    SELECT BY-FILE ASSIGN TO BY-PATH\n           ORGANIZATION INDEXED\n           ACCESS DYNAMIC\n           LOCK MODE AUTOMATIC WITH LOCK ON RECORD\n           RECORD KEY BY1-KEY\n           FILE STATUS FILE-STAT.\n    ```\n    (Source: [[FILE:LPFSBY.CPY|LPFSBY.CPY]], Index: code)\n\n  - Indexed, sequential, and relative files all use this clause for record-level locking.\n\n---\n\n**2. Embedded SQL Table Access**\n\n- For SQL tables, OTIS uses embedded SQL statements with transaction control:\n  - `BEGIN TRANSACTION`, `COMMIT`, and `ROLLBACK` are used to manage locks at the database level.\n  - SQL tables are locked for update during critical operations, ensuring ACID compliance.\n\n---\n\n**3. Programmatic Lock Handling and Error Recovery**\n\n- **File Status Codes**  \n  - Programs check the COBOL `FILE STATUS` variable after file operations.\n  - Status codes like \"93\" indicate a record lock (another process holds the lock).\n  - Example from [[FILE:AUTOC2.CBL|AUTOC2.CBL]]:\n\n    ```\n    * BLF 060309 FIX PROBLEM WITH STATUS 93 ON OPFILE (SOMEONE STILL IN\n    *            DAILY PROCESSING) CAUSING LOCKUP DUE TO DECLARATIVES\n    *            TRYING TO DO ERRMSG & LOCKING UP CRON PROCESS.\n    ```\n    (Source: [[FILE:AUTOC2.CBL|AUTOC2.CBL]], Index: code)\n\n- **Retry Logic for Locked Records**  \n  - Programs often implement retry loops when encountering a locked record.\n  - Example from [[FILE:DECLARE.CPY|DECLARE.CPY]]:\n\n    ```cobol\n    IF ERROR-LOCK-FG = \"Y\"\n       GO TO END-DECLARE\n    END-IF\n    PERFORM SUSPEND\n    ADD 1 TO LOCK-STATUS-99-RETRIES\n    IF LOCK-STATUS-99-RETRIES = 10\n       MOVE 0 TO LOCK-STATUS-99-RETRIES\n       MOVE FILE-STAT TO E-STATUS-ERROR\n       MOVE E-FILE TO E-FILEX\n       MOVE FORM-PATHNAME  TO E-PROG\n       MOVE ERROR-MSG-HEAD TO ERRMSG-HEAD\n       MOVE \"RECORD LOCKED BY ANOTHER USER\" TO ERRMSG\n    ```\n    (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code)\n\n  - After a set number of retries, the program reports an error and aborts the operation.\n\n---\n\n**4. Declarative Error Handling**\n\n- **DECLARATIVES Section**  \n  - Many programs use COBOL DECLARATIVES to intercept file errors, including lock conflicts.\n  - This allows centralized handling of lock errors, logging, and user notification.\n\n---\n\n**Summary Table of Mechanisms**\n\n| Mechanism                                  | Purpose                                      | Example Source                |\n|---------------------------------------------|----------------------------------------------|-------------------------------|\n| LOCK MODE AUTOMATIC WITH LOCK ON RECORD     | Record-level locking for COBOL files         | [[FILE:LPFSBY.CPY|LPFSBY.CPY]], [[FILE:TR1534.CBL|TR1534.CBL]]        |\n| Embedded SQL Transaction Control            | Table-level locking for SQL tables           | [[FILE:CRNOFL.CBL|CRNOFL.CBL]], SQL routines      |\n| File Status Code Checking                   | Detect lock conflicts, trigger retries/errors| [[FILE:AUTOC2.CBL|AUTOC2.CBL]], [[FILE:DECLARE.CPY|DECLARE.CPY]]       |\n| Retry Loops and Error Messaging             | Wait/retry for lock release, user feedback   | [[FILE:DECLARE.CPY|DECLARE.CPY]]                   |\n| DECLARATIVES for Error Handling             | Centralized lock error management            | BWIMP, BYFILE, etc.           |\n\n---\n\n**Business Impact:**\n- These mechanisms ensure that only one process can update a record at a time, preventing lost updates and maintaining data integrity during high-volume transaction processing.\n- Users are notified if a record is locked, and the system can retry or abort as needed.\n\n---\n\n**Source Citations:**\n- [[FILE:LPFSBY.CPY|LPFSBY.CPY]], Index: code (COBOL file locking clause)\n- [[FILE:AUTOC2.CBL|AUTOC2.CBL]], Index: code (File status 93, lock error handling)\n- [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code (Retry logic and error messaging)\n- [[FILE:CRNOFL.CBL|CRNOFL.CBL]], Index: code (SQL table loading and locking)\n- BWIMP, BYFILE, Index: flows (Declaratives for error handling)\n\n---\n\n**Here's a visual representation of the file locking mechanisms in OTIS:**\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS File Locking Mechanisms</text>\n  \n  <!-- COBOL File Locking -->\n  <rect x=\"60\" y=\"70\" width=\"220\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"170\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">COBOL File Locking</text>\n  <text x=\"170\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">LOCK MODE AUTOMATIC<br/>WITH LOCK ON RECORD</text>\n  \n  <!-- SQL Transaction Control -->\n  <rect x=\"340\" y=\"70\" width=\"220\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">SQL Transaction Control</text>\n  <text x=\"450\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">BEGIN/COMMIT/ROLLBACK<br/>Table-level locks</text>\n  \n  <!-- Programmatic Lock Handling -->\n  <rect x=\"620\" y=\"70\" width=\"220\" height=\"80\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"730\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Programmatic Handling</text>\n  <text x=\"730\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">File Status Codes<br/>Retry/Error Messaging</text>\n  \n  <!-- Declaratives -->\n  <rect x=\"200\" y=\"200\" width=\"500\" height=\"80\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b45309\">Declaratives Section</text>\n  <text x=\"450\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"#f59e0b\">Centralized Error Handling<br/>Lock Conflict Management</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"170\" y1=\"150\" x2=\"350\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"150\" x2=\"450\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"730\" y1=\"150\" x2=\"650\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>",
    "sources_count": 100,
    "timing_seconds": 18.28
  },
  "Q20": {
    "question": "How does OTIS handle batch file processing vs online file access?",
    "answer": "OTIS handles **batch file processing** and **online file access** using distinct mechanisms tailored to the business needs and technical constraints of each mode. Here’s a clear breakdown:\n\n---\n\n### 1. Batch File Processing\n\n**Business Purpose:**\n- Used for high-volume, scheduled operations (e.g., end-of-day posting, report generation, mass updates).\n- Runs without user interaction, often triggered by schedulers (like cron jobs).\n\n**Technical Implementation:**\n- Programs are designed to process entire files or large sets of records in one run.\n- File operations are typically sequential: OPEN, READ/WRITE, CLOSE.\n- Batch programs often use dedicated file structures and copybooks (e.g., BT-FILE for batch transactions).\n- File locking is managed at the file level to prevent concurrent access during batch runs.\n- Example: The BATCHP program is described as \"BATCH FORM PRINT FOR LONPEX DOC FILE CREATE\" and \"ONLY RUNS IN BATCH\" (Source: [[FILE:BATCHP.CBL|BATCHP.CBL]], Index: code).\n- Batch programs may create, rename, or remove files as part of their workflow (see MOVE, REMOVE, and SYSTEM calls in code).\n\n**Key Features:**\n- No user screens; runs unattended.\n- Error handling is logged, not displayed interactively.\n- May use shell scripts or cron jobs for scheduling (see EOCRON program: \"EXECUTE BATCH FROM CRON\" – Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code).\n- Batch files often have naming conventions to indicate date, batch number, or branch (see comments in [[FILE:LONPW1.CBL|LONPW1.CBL]], lines 26-50).\n\n---\n\n### 2. Online File Access\n\n**Business Purpose:**\n- Supports real-time user transactions (e.g., loan maintenance, payment posting, inquiry).\n- Allows users to interact with the system via screens and menus.\n\n**Technical Implementation:**\n- Programs use indexed or random access to files, enabling retrieval and update of individual records.\n- File locking is more granular, often at the record level, to allow multiple users to work concurrently.\n- Online programs display screens, prompt for input, and provide immediate feedback.\n- Example: Programs like LONPW1 and BPREF perform file access in response to user actions, with logic to check file existence and status (see PERFORM ACCESS-CALL and file status checks in [[FILE:BPOTH.CBL|BPOTH.CBL]], lines 801-825).\n- Error messages are displayed to users (e.g., \"BATCH CORE FILE DOES NOT EXIST !!!\" – Source: [[FILE:BPBKBR.CBL|BPBKBR.CBL]], lines 526-550).\n\n**Key Features:**\n- Interactive screens and menus.\n- Immediate validation and error reporting.\n- File access routines (ACCESS-CALL, GETENV-CALL) are invoked as needed for user operations.\n- May use copybooks for file definitions shared across online programs (e.g., [[FILE:GBFDPR.CPY|GBFDPR.CPY]] for batch file structure, Source: [[FILE:BPOTH.CBL|BPOTH.CBL]], Index: copybook_usage).\n\n---\n\n### 3. Data Consistency & Locking\n\n- **Batch:** Locks entire files during processing to prevent online updates.\n- **Online:** Uses record-level locks or checks file status before access to avoid conflicts with batch jobs.\n- Programs check file status codes (e.g., STAT, IO-BAD) and handle errors accordingly.\n\n---\n\n### 4. Workflow Example\n\n**Batch:**\n- Scheduler triggers BATCHP.\n- BATCHP opens files, processes all records, writes output, closes files.\n- If file missing, logs error and exits.\n\n**Online:**\n- User initiates transaction via screen.\n- Program checks file existence (ACCESS-CALL).\n- Reads/writes individual records.\n- Displays errors or prompts for correction.\n\n---\n\n### 5. Source Citations\n\n- \"ONLY RUNS IN BATCH\" (Source: [[FILE:BATCHP.CBL|BATCHP.CBL]], Index: code)\n- \"EXECUTE BATCH FROM CRON\" (Source: [[FILE:EOCRON.CBL|EOCRON.CBL]], Index: code)\n- File existence checks and error messages (Source: [[FILE:BPBKBR.CBL|BPBKBR.CBL]], lines 526-550; [[FILE:BPOTH.CBL|BPOTH.CBL]], lines 801-825)\n- Batch file naming conventions (Source: [[FILE:LONPW1.CBL|LONPW1.CBL]], lines 26-50)\n- Copybook usage for file definitions (Source: [[FILE:BPOTH.CBL|BPOTH.CBL]], Index: copybook_usage)\n\n---\n\n### Visual Representation\n\nHere's a visual representation of how OTIS handles batch vs online file access:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS File Access Modes</text>\n  \n  <!-- Batch Processing Section -->\n  <rect x=\"50\" y=\"70\" width=\"350\" height=\"260\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"12\"/>\n  <text x=\"225\" y=\"100\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">Batch File Processing</text>\n  <text x=\"225\" y=\"130\" text-anchor=\"middle\" font-size=\"14\" fill=\"#4338ca\">Programs: BATCHP, EOCRON</text>\n  <text x=\"225\" y=\"155\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Scheduled, Unattended</text>\n  <rect x=\"100\" y=\"180\" width=\"250\" height=\"40\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"225\" y=\"205\" text-anchor=\"middle\" font-size=\"14\" fill=\"#1e40af\">File-Level Locking</text>\n  <rect x=\"100\" y=\"230\" width=\"250\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"225\" y=\"255\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">Sequential File Access</text>\n  <rect x=\"100\" y=\"280\" width=\"250\" height=\"40\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"225\" y=\"305\" text-anchor=\"middle\" font-size=\"14\" fill=\"#b45309\">Error Logging</text>\n  \n  <!-- Online Processing Section -->\n  <rect x=\"500\" y=\"70\" width=\"350\" height=\"260\" fill=\"#e0f7fa\" stroke=\"#06b6d4\" stroke-width=\"3\" rx=\"12\"/>\n  <text x=\"675\" y=\"100\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#0e7490\">Online File Access</text>\n  <text x=\"675\" y=\"130\" text-anchor=\"middle\" font-size=\"14\" fill=\"#0e7490\">Programs: LONPW1, BPREF</text>\n  <text x=\"675\" y=\"155\" text-anchor=\"middle\" font-size=\"12\" fill=\"#0e7490\">Interactive, Real-Time</text>\n  <rect x=\"550\" y=\"180\" width=\"250\" height=\"40\" fill=\"#bae6fd\" stroke=\"#2563eb\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"675\" y=\"205\" text-anchor=\"middle\" font-size=\"14\" fill=\"#2563eb\">Record-Level Locking</text>\n  <rect x=\"550\" y=\"230\" width=\"250\" height=\"40\" fill=\"#bbf7d0\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"675\" y=\"255\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">Indexed/Random Access</text>\n  <rect x=\"550\" y=\"280\" width=\"250\" height=\"40\" fill=\"#fee2e2\" stroke=\"#ef4444\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"675\" y=\"305\" text-anchor=\"middle\" font-size=\"14\" fill=\"#b91c1c\">Immediate Error Display</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"400\" y1=\"200\" x2=\"500\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"450\" y=\"190\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1a1a1a\">Shared Files</text>\n</svg>\n\n---\n\n**Summary:**  \n- Batch processing in OTIS is designed for high-volume, scheduled tasks with file-level locking and no user interaction.\n- Online access supports real-time user transactions with record-level locking and interactive error handling.\n- Both modes use shared file structures but apply different access and consistency controls to meet business requirements.\n\nIf you need details on a specific program’s batch or online file handling, let me know!",
    "sources_count": 100,
    "timing_seconds": 18.943
  },
  "Q21": {
    "question": "What is the main menu structure in OTIS? What is the entry point?",
    "answer": "The main menu structure in OTIS is organized around a central entry point program called **PGMENU**. This program acts as the gateway to all major subsystems and business functions within OTIS.\n\n### Entry Point\n- **PGMENU** is the primary entry point for users accessing the OTIS application.\n  - When a user logs in, they are presented with the main menu managed by PGMENU.\n  - From here, users can navigate to various maintenance and processing modules.\n\n### Main Menu Structure\n\nAccording to the retrieved flowchart for PGMENU (Source: [[FILE:PGMENU|PGMENU]], [[FILE:I|I]]ndex: flows), the main menu provides access to the following subsystems:\n\n- **Loan Maintenance**\n- **Dealer Maintenance**\n- **Addon Maintenance**\n- **Batch Processing**\n- **Other specialized modules**\n\nThe flowchart shows the following relationships:\n\n- **I-O-CONTROL** → **SETUP-WINDOW**\n- **SELECT-FIELD-FROM-DISPLAY** → **SEND-LEGEND**\n- **SELECT-FIELD-FROM-DISPLAY** → **ADDON-MAINT**\n- **SELECT-FIELD-FROM-DISPLAY** → **DEALER-MAINT**\n- **SELECT-FIELD-FROM-DISPLAY** → **LOAN-MAINT**\n\nThis means that after initial setup, the user's selection from the menu determines which subsystem program is called.\n\n### Visual Representation\n\nHere's a visual diagram of the main menu structure and entry point:\n\n<svg width=\"800\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"400\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Main Menu Structure</text>\n  \n  <!-- Entry Point -->\n  <rect x=\"340\" y=\"70\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"400\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PGMENU</text>\n  <text x=\"400\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"12\">Main Menu Entry Point</text>\n  \n  <!-- Subsystems -->\n  <rect x=\"100\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"170\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Loan Maintenance</text>\n  \n  <rect x=\"270\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"340\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Dealer Maintenance</text>\n  \n  <rect x=\"440\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"510\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Addon Maintenance</text>\n  \n  <rect x=\"610\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"680\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Batch Processing</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"400\" y1=\"130\" x2=\"170\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"400\" y1=\"130\" x2=\"340\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"400\" y1=\"130\" x2=\"510\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"400\" y1=\"130\" x2=\"680\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n### Summary\n\n- **PGMENU** is the main entry point for OTIS.\n- The main menu allows users to select from core business modules: Loan, Dealer, Addon, and Batch Processing.\n- Each selection routes the user to the corresponding subsystem for further operations.\n\n(Source: [[FILE:PGMENU|PGMENU]], [[FILE:I|I]]ndex: flows)\n\nIf you need the literal menu text as displayed to users (e.g., numbered options), that information is typically defined in the screen copybook or DISPLAY statements, which are not present in the current context. The above structure shows the program-level organization and entry flow.",
    "sources_count": 200,
    "timing_seconds": 11.758
  },
  "Q22": {
    "question": "How does menu navigation work in OTIS? What are the key menu programs?",
    "answer": "Menu navigation in OTIS is structured around a set of dedicated menu programs that serve as entry points and navigational hubs for the system’s various business functions. Here’s how it works:\n\n---\n\n## How Menu Navigation Works in OTIS\n\n### 1. **Central Entry Point**\n- **PGMENU** is the main entry program for OTIS. When a user logs in, they are presented with the main menu managed by PGMENU.\n- PGMENU displays options for all major subsystems (Loan Maintenance, Dealer Maintenance, Addon Maintenance, Batch Processing, etc.).\n- User selections are processed by PGMENU, which then routes control to the appropriate subsystem menu or function.\n\n### 2. **Subsystem Menus**\n- Each major business area has its own menu program:\n  - **LPMENU** – Loan Processing Menu\n  - **SPMENU** – Special Procedures Menu\n  - **SCMENU** – System Control Menu\n  - **BPMENU** – Batch Processing Menu\n  - **GBMENU** – General Business Menu\n  - **GLMENU** – General Ledger Menu\n  - **UPMENU** – Upgrade Menu\n  - **OPMENU** – Operations Menu\n  - **EOMENU/EOMMNU** – End-of-Month Processing Menu\n  - **ASMENU** – Asset Management Menu\n  - **IRMENU** – Insurance Menu\n  - **FDMENU** – File Maintenance Menu\n  - **TWMENU** – Timekeeping Menu\n  - **LPIQMU** – Loan Inquiry Menu\n  - **DWEXMU** – Data Warehouse Extraction Menu\n  - **LPMNMU** – Loan Maintenance Menu\n  - **LPL2MU** – Loan Level 2 Menu\n\n- These menu programs display their own set of options, allowing users to drill down into specific functions or maintenance screens.\n\n### 3. **Menu Navigation Logic**\n- Each menu program follows a similar pattern:\n  - Display menu options to the user.\n  - Accept user input (option number or function key).\n  - Route control to the selected program or screen.\n  - Provide function key navigation (e.g., F7 to exit to previous menu, F1 to return to main menu).\n  - Handle invalid selections and prompt for re-entry.\n\n- Example: In **LPMENU**, the paragraph `MENU-SELECTION-ENTER-SUB-EXIT` manages user selection and routes to the chosen function (Source: [[FILE:LPMENU|LPMENU]], [[FILE:I|I]]ndex: paragraphs).\n\n### 4. **Menu Exit and Return**\n- Most menus allow users to exit back to the previous menu or the main menu using function keys (commonly F7 or F1).\n- The exit logic is handled in paragraphs like `MENU-EXIT` (Source: [[FILE:LPCPMU|LPCPMU]], [[FILE:LPM3MU|LPM3MU]], [[FILE:I|I]]ndex: paragraphs).\n\n### 5. **Batch-Only Programs**\n- Some programs (e.g., LP_BATCHP) only run in batch mode and are not accessible from any menu (Source: [[FILE:LP|LP]]_BATCHP_GENERALHELP, Index: help_fields).\n\n---\n\n## Key Menu Programs in OTIS\n\nHere is a summary table of the main menu programs and their business areas:\n\n| Program   | Business Area              | Purpose/Description                                 |\n|-----------|---------------------------|-----------------------------------------------------|\n| PGMENU    | Main Menu                 | Central entry point; routes to all subsystems       |\n| LPMENU    | Loan Processing           | Loan-related functions and maintenance              |\n| SPMENU    | Special Procedures        | Non-standard tasks, file maintenance                |\n| SCMENU    | System Control            | System-level controls and utilities                 |\n| BPMENU    | Batch Processing          | Batch jobs and processing functions                 |\n| GBMENU    | General Business          | General business operations                         |\n| GLMENU    | General Ledger            | Ledger and accounting functions                     |\n| UPMENU    | Upgrade                   | System upgrades and related functions               |\n| OPMENU    | Operations                | Operational tasks, password verification            |\n| EOMENU    | End-of-Month              | End-of-month processing                             |\n| ASMENU    | Asset Management          | Asset-related functions                             |\n| IRMENU    | Insurance                 | Insurance processing and maintenance                |\n| FDMENU    | File Maintenance          | File maintenance operations                         |\n| TWMENU    | Timekeeping               | Employee timekeeping functions                      |\n| LPIQMU    | Loan Inquiry              | Loan inquiry and lookup                             |\n| DWEXMU    | Data Warehouse Extraction | Data extraction for reporting                       |\n| LPMNMU    | Loan Maintenance          | Loan maintenance functions                          |\n| LPL2MU    | Loan Level 2              | Advanced loan functions                             |\n\n---\n\n## Visual Representation\n\nHere's a visual diagram showing the main menu navigation structure in OTIS:\n\n<svg width=\"1200\" height=\"700\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"600\" y=\"40\" text-anchor=\"middle\" font-size=\"28\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Menu Navigation Structure</text>\n  \n  <!-- Main Menu -->\n  <rect x=\"500\" y=\"80\" width=\"200\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"12\"/>\n  <text x=\"600\" y=\"120\" text-anchor=\"middle\" font-size=\"20\" font-weight=\"bold\" fill=\"white\">PGMENU</text>\n  <text x=\"600\" y=\"140\" text-anchor=\"middle\" font-size=\"14\" fill=\"white\">Main Entry Point</text>\n  \n  <!-- Subsystem Menus Row 1 -->\n  <rect x=\"100\" y=\"200\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"175\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">LPMENU</text>\n  <text x=\"175\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Loan Processing</text>\n  \n  <rect x=\"300\" y=\"200\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"375\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">SPMENU</text>\n  <text x=\"375\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Special Procedures</text>\n  \n  <rect x=\"500\" y=\"200\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"575\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">SCMENU</text>\n  <text x=\"575\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">System Control</text>\n  \n  <rect x=\"700\" y=\"200\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"775\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">BPMENU</text>\n  <text x=\"775\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Batch Processing</text>\n  \n  <rect x=\"900\" y=\"200\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"975\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">GBMENU</text>\n  <text x=\"975\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">General Business</text>\n  \n  <!-- Subsystem Menus Row 2 -->\n  <rect x=\"100\" y=\"320\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"175\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">GLMENU</text>\n  <text x=\"175\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">General Ledger</text>\n  \n  <rect x=\"300\" y=\"320\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"375\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">UPMENU</text>\n  <text x=\"375\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Upgrade</text>\n  \n  <rect x=\"500\" y=\"320\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"575\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">OPMENU</text>\n  <text x=\"575\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Operations</text>\n  \n  <rect x=\"700\" y=\"320\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"775\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">EOMENU</text>\n  <text x=\"775\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">End-of-Month</text>\n  \n  <rect x=\"900\" y=\"320\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"975\" y=\"350\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">ASMENU</text>\n  <text x=\"975\" y=\"370\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Asset Mgmt</text>\n  \n  <!-- Subsystem Menus Row 3 -->\n  <rect x=\"100\" y=\"440\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"175\" y=\"470\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">IRMENU</text>\n  <text x=\"175\" y=\"490\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Insurance</text>\n  \n  <rect x=\"300\" y=\"440\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"375\" y=\"470\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">FDMENU</text>\n  <text x=\"375\" y=\"490\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">File Maint.</text>\n  \n  <rect x=\"500\" y=\"440\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"575\" y=\"470\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">TWMENU</text>\n  <text x=\"575\" y=\"490\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Timekeeping</text>\n  \n  <rect x=\"700\" y=\"440\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"775\" y=\"470\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">LPIQMU</text>\n  <text x=\"775\" y=\"490\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Loan Inquiry</text>\n  \n  <rect x=\"900\" y=\"440\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"975\" y=\"470\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">DWEXMU</text>\n  <text x=\"975\" y=\"490\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Data Warehouse</text>\n  \n  <!-- Subsystem Menus Row 4 -->\n  <rect x=\"300\" y=\"560\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"375\" y=\"590\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">LPMNMU</text>\n  <text x=\"375\" y=\"610\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Loan Maint.</text>\n  \n  <rect x=\"500\" y=\"560\" width=\"150\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"10\"/>\n  <text x=\"575\" y=\"590\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">LPL2MU</text>\n  <text x=\"575\" y=\"610\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Loan Level 2</text>\n  \n  <!-- Arrows from PGMENU to all subsystems -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <!-- Row 1 -->\n  <line x1=\"600\" y1=\"150\" x2=\"175\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"375\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"575\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"775\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"975\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <!-- Row 2 -->\n  <line x1=\"600\" y1=\"150\" x2=\"175\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"375\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"575\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"775\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"975\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <!-- Row 3 -->\n  <line x1=\"600\" y1=\"150\" x2=\"175\" y2=\"440\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"375\" y2=\"440\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"575\" y2=\"440\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"775\" y2=\"440\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"975\" y2=\"440\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <!-- Row 4 -->\n  <line x1=\"600\" y1=\"150\" x2=\"375\" y2=\"560\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"150\" x2=\"575\" y2=\"560\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n## Source Citations\n\n- Main menu entry and routing: PGMENU (Source: [[FILE:PGMENU|PGMENU]], [[FILE:I|I]]ndex: flows)\n- Subsystem menus: LPMENU, SPMENU, SCMENU, BPMENU, GBMENU, GLMENU, UPMENU, OPMENU, EOMENU, ASMENU, IRMENU, FDMENU, TWMENU, LPIQMU, DWEXMU, LPMNMU, LPL2MU (Source: respective program flows)\n- Menu selection and exit logic: LPMENU, LPCPMU, LPM3MU (Source: [[FILE:LPMENU|LPMENU]], [[FILE:LPCPMU|LPCPMU]], [[FILE:LPM3MU|LPM3MU]], [[FILE:I|I]]ndex: paragraphs)\n- Batch-only programs: LP_BATCHP (Source: [[FILE:LP|LP]]_BATCHP_GENERALHELP, Index: help_fields)\n\n---\n\n**Summary:**  \nOTIS menu navigation is driven by PGMENU as the central entry point, with each subsystem managed by its own menu program. Users navigate by selecting options, which route them to the appropriate business function or maintenance screen. Function keys provide quick navigation between menus and allow users to exit or return as needed.",
    "sources_count": 200,
    "timing_seconds": 26.186
  },
  "Q23": {
    "question": "What is LPMENU and what role does it play in the system?",
    "answer": "**LPMENU** is a key menu program in the OTIS system, serving as a navigational hub for loan processing and related business functions.\n\n---\n\n### BUSINESS PURPOSE\n\n- **LPMENU** provides users with a structured menu interface to access various loan processing modules.\n- It acts as the entry point for loan-related operations, allowing users to select tasks such as loan maintenance, reporting, and batch processing.\n- By centralizing navigation, LPMENU streamlines workflow and ensures users can efficiently reach the correct subsystem for their business needs.\n\n---\n\n### TECHNICAL IMPLEMENTATION\n\n- **Menu Display & Navigation:**  \n  LPMENU displays the menu options using screen copybooks and handles user input to determine which program or function to invoke next.\n- **Program Calls:**  \n  LPMENU makes direct calls to 4 unique programs, enabling access to deeper loan processing modules.  \n  (Source: [[FILE:LPMENU|LPMENU]], [[FILE:I|I]]ndex: programs)\n- **Copybook Usage:**  \n  LPMENU uses a set of copybooks for menu layout, working storage, screen definitions, and utility functions.  \n  Key copybooks include:\n  - LIBGB/[[FILE:MENU1A.CPY|MENU1A.CPY]] – Menu screen layout definitions\n  - LIBLP/[[FILE:LPMENU_DEF.CPY|LPMENU_DEF.CPY]] – Loan processing menu definitions\n  - LIBLP/[[FILE:LPMENU_WKS.CPY|LPMENU_WKS.CPY]] – Working storage for menu operations\n  - LIBGB/[[FILE:MENU1B.CPY|MENU1B.CPY]] – Alternate menu screen layout\n  - LIBLP/[[FILE:LPMENU_SCN.CPY|LPMENU_SCN.CPY]] – Screen section for LPMENU\n  - LIBCL/[[FILE:TRACE.CPY|TRACE.CPY]] – Tracing and logging utilities\n  - LIBGB/[[FILE:CONAME_XFER.CPY|CONAME_XFER.CPY]] – Company name transfer routines\n  - LIBGB/[[FILE:SCREEN.CPY|SCREEN.CPY]] – General screen handling\n  - LIBLP/[[FILE:LPMENU_EVA.CPY|LPMENU_EVA.CPY]] – Evaluation logic for menu selection\n  - LIBGB/[[FILE:SENDMESS.CPY|SENDMESS.CPY]] – Messaging utilities\n  - LIBGB/[[FILE:DISCONNECT_SQL.CPY|DISCONNECT_SQL.CPY]] – SQL disconnect routines  \n  (Source: [[FILE:LPMENU.CBL|LPMENU.CBL]], Index: copybook_usage)\n\n- **Menu Flow:**  \n  The program logic includes displaying the menu, resetting forms, handling user selection, and running the chosen program.  \n  (Source: [[FILE:LPMENU|LPMENU]], [[FILE:I|I]]ndex: flows)\n\n---\n\n### SYSTEM ROLE\n\n- **Navigational Hub:**  \n  LPMENU is a root program (not called by other programs), meaning it is a primary entry point for users in the loan processing domain.\n- **Call Depth:**  \n  It initiates calls up to depth 3, enabling multi-level navigation and access to specialized loan functions.\n- **Integration:**  \n  LPMENU integrates with other menu programs (such as LPMNMU, GBMENU, etc.) to provide seamless transitions between different business areas.\n\n---\n\n### VISUAL REPRESENTATION\n\nHere's a visual representation of LPMENU's role and relationships:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">LPMENU: Loan Processing Menu Hub</text>\n  \n  <!-- Main LPMENU box -->\n  <rect x=\"380\" y=\"70\" width=\"140\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"105\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LPMENU</text>\n  <text x=\"450\" y=\"125\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Menu Program</text>\n  \n  <!-- Called programs -->\n  <rect x=\"100\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"170\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Program 1</text>\n  <text x=\"170\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Module</text>\n  \n  <rect x=\"300\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"370\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Program 2</text>\n  <text x=\"370\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Reporting</text>\n  \n  <rect x=\"500\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"570\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Program 3</text>\n  <text x=\"570\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Batch Processing</text>\n  \n  <rect x=\"700\" y=\"200\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"770\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Program 4</text>\n  <text x=\"770\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Utility</text>\n  \n  <!-- Arrows from LPMENU to called programs -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"450\" y1=\"140\" x2=\"170\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"140\" x2=\"370\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"140\" x2=\"570\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"140\" x2=\"770\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**Summary:**  \nLPMENU is the central menu program for loan processing in OTIS, providing users with access to all major loan-related functions, managing navigation, and integrating with other subsystems through direct program calls and shared copybooks.\n\n(Source: [[FILE:LPMENU.CBL|LPMENU.CBL]], Index: copybook_usage; LPMENU, Index: programs; LPMENU, Index: flows)",
    "sources_count": 100,
    "timing_seconds": 14.943
  },
  "Q24": {
    "question": "How do users navigate between different screens in OTIS?",
    "answer": "Users navigate between different screens in OTIS using a structured menu-driven interface, managed by dedicated menu programs. Here’s how the navigation works:\n\n---\n\n### MENU NAVIGATION MECHANISM\n\n**1. Entry Point:**\n- Users begin at the **PGMENU** program, which serves as the main menu and entry point for the OTIS system.\n- PGMENU displays options for all major subsystems (e.g., Loan Processing, Dealer Maintenance, Addon Maintenance, Batch Processing).\n\n**2. Menu Programs as Navigation Hubs:**\n- Selecting a menu option in PGMENU transfers control to a specific menu program for that subsystem:\n  - **LPMENU**: Loan Processing Menu\n  - **DLMENU**: Dealer Maintenance Menu\n  - **ADMENU**: Addon Maintenance Menu\n  - **BPMENU**: Batch Processing Menu\n  - Additional menus: SPMENU, SCMENU, EOMENU, etc.\n\n**3. Screen Display and User Input:**\n- Each menu program displays a screen with numbered options and function keys (e.g., F6, F7) for navigation.\n- Users select options by entering the corresponding number or pressing a function key.\n\n**4. Program Calls and Screen Transitions:**\n- Upon selection, the menu program calls the appropriate business logic program or another menu program.\n- This call transfers control and displays the next screen, which could be a data entry form, inquiry screen, or another menu.\n\n**5. Hierarchical Structure:**\n- Navigation is hierarchical: main menu → subsystem menu → function screen.\n- Users can return to previous menus using designated function keys (e.g., F7 for \"Back\" or \"Menu Page 1\").\n\n**6. Dedicated UI Programs:**\n- Programs like **AUMENU**, **JEMENU**, **SIMENU**, and **LOGUID** are specialized UI/menu programs for specific modules.\n- These programs do not make outgoing calls but are called by other menu programs to display screens.\n\n---\n\n### KEY MENU PROGRAMS\n\n| Main Menu      | Loan Menu      | Dealer Menu    | Addon Menu     | Batch Menu     |\n|----------------|---------------|---------------|---------------|---------------|\n| PGMENU         | LPMENU        | DLMENU        | ADMENU        | BPMENU        |\n| SPMENU         | SCMENU        | EOMENU        | JEMENU        | SIMENU        |\n| AUMENU         | LOGUID        |               |               |               |\n\n- **PGMENU**: Main entry point, routes to all subsystems.\n- **LPMENU**: Loan processing hub.\n- **DLMENU**: Dealer maintenance hub.\n- **ADMENU**: Addon maintenance hub.\n- **BPMENU**: Batch processing hub.\n- **SPMENU, SCMENU, EOMENU, etc.**: Specialized menus for other business areas.\n\n---\n\n### NAVIGATION FLOW EXAMPLE\n\n1. **User logs in → PGMENU displays main menu**\n2. **User selects \"Loan Processing\" → LPMENU displays loan options**\n3. **User selects \"Loan Inquiry\" → LONINQ screen/program is called**\n4. **User completes inquiry, presses F7 → Returns to LPMENU**\n5. **User presses F7 again → Returns to PGMENU**\n\n---\n\n### ARCHITECTURE DIAGRAM\n\nHere's a visual representation of the menu navigation structure in OTIS:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Menu Navigation Structure</text>\n  \n  <!-- Main Menu -->\n  <rect x=\"370\" y=\"70\" width=\"160\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PGMENU</text>\n  <text x=\"450\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"12\">Main Menu</text>\n  \n  <!-- Subsystem Menus -->\n  <rect x=\"100\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"170\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">LPMENU</text>\n  <text x=\"170\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Processing</text>\n  \n  <rect x=\"270\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"340\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">DLMENU</text>\n  <text x=\"340\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Dealer Maintenance</text>\n  \n  <rect x=\"440\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"510\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">ADMENU</text>\n  <text x=\"510\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Addon Maintenance</text>\n  \n  <rect x=\"610\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"680\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">BPMENU</text>\n  <text x=\"680\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Batch Processing</text>\n  \n  <!-- Specialized Menus -->\n  <rect x=\"100\" y=\"320\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"345\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"13\" font-weight=\"bold\">SPMENU</text>\n  \n  <rect x=\"250\" y=\"320\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"310\" y=\"345\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"13\" font-weight=\"bold\">SCMENU</text>\n  \n  <rect x=\"400\" y=\"320\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"460\" y=\"345\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"13\" font-weight=\"bold\">EOMENU</text>\n  \n  <rect x=\"550\" y=\"320\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"610\" y=\"345\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"13\" font-weight=\"bold\">JEMENU</text>\n  \n  <rect x=\"700\" y=\"320\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"760\" y=\"345\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"13\" font-weight=\"bold\">SIMENU</text>\n  \n  <!-- Arrows from PGMENU to subsystem menus -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"450\" y1=\"130\" x2=\"170\" y2=\"180\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"340\" y2=\"180\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"510\" y2=\"180\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"680\" y2=\"180\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Arrows from subsystem menus to specialized menus -->\n  <line x1=\"170\" y1=\"240\" x2=\"160\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"340\" y1=\"240\" x2=\"310\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"510\" y1=\"240\" x2=\"460\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"680\" y1=\"240\" x2=\"610\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"680\" y1=\"240\" x2=\"760\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n### SUMMARY\n\n- Users navigate OTIS by selecting options in menu screens managed by programs like PGMENU, LPMENU, DLMENU, etc.\n- Each menu program displays options and calls the next program/screen based on user input.\n- Navigation is hierarchical and modular, allowing users to move between business functions efficiently.\n\n(Source: [[FILE:PGMENU|PGMENU]], [[FILE:LPMENU|LPMENU]], [[FILE:SPMENU|SPMENU]], [[FILE:SCMENU|SCMENU]], [[FILE:EOMENU|EOMENU]], [[FILE:JEMENU|JEMENU]], [[FILE:SIMENU|SIMENU]], [[FILE:LOGUID|LOGUID]], [[FILE:AUMENU|AUMENU]]; Index: programs, flows)",
    "sources_count": 100,
    "timing_seconds": 18.668
  },
  "Q25": {
    "question": "What function keys are used for navigation (F1, F7, etc.)?",
    "answer": "Function keys play a central role in screen and menu navigation throughout the OTIS system. Here’s how they are used:\n\n---\n\n### FUNCTION KEY NAVIGATION IN OTIS\n\n**Common Function Keys:**\n\n- **F1**: Typically used to EXIT the current screen or menu.\n  - Example: \"Press FUNCTION KEY 1 (F1) to EXIT the screen.\"  \n    (Source: [[FILE:LP|LP]]_DSINQ1_SEL, Index: help_fields)\n- **F7**: Used to move to the NEXT PAGE or advance to the next menu/screen.\n  - Example: \"Press FUNCTION KEY 7 (F7) to advance to the next page.\"  \n    (Source: [[FILE:M|M]]ultiple screen help texts, e.g., LP_BYINQB.200617.pr1434_SEL, Index: help_fields)\n- **F6**: Often used to VIEW REPORTS or access a specific function (such as report viewing or special actions).\n  - Example: \"F6 - VIEW REPORTS\"  \n    (Source: [[FILE:S|S]]creen from COLLECTION REPORTS MENU, Index: screen_nodes)\n- **F5**: Sometimes used for batch processing or to begin a procedure.\n  - Example: \"Press FUNCTION KEY 5 (F5) to begin batch procedure.\"  \n    (Source: [[FILE:SP|SP]]_GREXEC_HOUR, Index: help_fields)\n- **Other Function Keys (F2, F3, F4, etc.)**: Used for additional navigation, such as moving to previous pages, accessing help, or performing context-specific actions.\n\n---\n\n### HOW FUNCTION KEYS WORK\n\n- **Screen Help Texts**: Many screens display instructions for function keys, guiding users on how to navigate, exit, or perform actions.\n- **Menu Navigation**: Function keys allow users to move between menu pages, select options, and return to previous screens.\n- **Program Flow**: COBOL programs often include logic to test which function key was pressed and branch accordingly (e.g., GO TO TEST-F7 for F7 key).\n\n---\n\n### EXAMPLES FROM CONTEXT\n\n- **Exit Screen**:  \n  \"Press FUNCTION KEY 1 (F1) to EXIT the screen.\"  \n  (Source: [[FILE:LP|LP]]_DSINQ1_SEL, Index: help_fields)\n- **Advance Page**:  \n  \"Press FUNCTION KEY 7 (F7) to advance to the next page.\"  \n  (Source: [[FILE:LP|LP]]_BYINQB.200617.pr1434_SEL, Index: help_fields)\n- **Batch Start**:  \n  \"Press FUNCTION KEY 5 (F5) to begin batch procedure.\"  \n  (Source: [[FILE:SP|SP]]_GREXEC_HOUR, Index: help_fields)\n- **Report Viewing**:  \n  \"F6 - VIEW REPORTS\"  \n  (Source: [[FILE:S|S]]creen from COLLECTION REPORTS MENU, Index: screen_nodes)\n\n---\n\n### PROGRAM LOGIC EXAMPLES\n\n- Many COBOL programs include paragraphs like TEST-F6-KEY, TEST-F7-KEY, etc., which handle navigation based on function key input.\n  - Example:  \n    IF ( NOT F6-KEY ) GO TO TEST-F7-KEY  \n    (Source: [[FILE:PDPG91|PDPG91]], [[FILE:I|I]]ndex: flow_edges)\n\n---\n\n### VISUAL SUMMARY\n\nHere's a visual representation of function key navigation in OTIS:\n\n<svg width=\"700\" height=\"350\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"20\" font-weight=\"bold\" fill=\"#1a1a1a\">Function Key Navigation in OTIS</text>\n  \n  <!-- Main Screen/Menu -->\n  <rect x=\"250\" y=\"70\" width=\"200\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Current Screen/Menu</text>\n  \n  <!-- F1 Exit -->\n  <rect x=\"50\" y=\"170\" width=\"120\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"110\" y=\"195\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">F1: Exit</text>\n  \n  <!-- F6 Reports -->\n  <rect x=\"200\" y=\"170\" width=\"120\" height=\"50\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"260\" y=\"195\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">F6: View Reports</text>\n  \n  <!-- F7 Next Page -->\n  <rect x=\"350\" y=\"170\" width=\"120\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"410\" y=\"195\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">F7: Next Page</text>\n  \n  <!-- F5 Batch -->\n  <rect x=\"500\" y=\"170\" width=\"120\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"195\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">F5: Batch Start</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"130\" x2=\"110\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"130\" x2=\"260\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"130\" x2=\"410\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"130\" x2=\"560\" y2=\"170\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**Summary:**  \n- F1, F6, F7, F5 are commonly used for navigation, exit, report viewing, and batch actions.\n- Function keys are mapped to specific actions in both screen help text and COBOL program logic.\n- Users rely on these keys for efficient movement throughout the OTIS system.\n\n(Source: [[FILE:M|M]]ultiple help_fields and screen_nodes documents; program flow_edges from PDPG91, SPMANL, etc.)",
    "sources_count": 200,
    "timing_seconds": 14.556
  },
  "Q26": {
    "question": "How are screens defined and displayed in OTIS?",
    "answer": "Screens in the OTIS system are defined and displayed using a combination of COBOL screen copybooks and dedicated screen-handling programs. Here’s how the process works:\n\n---\n\n### SCREEN DEFINITION IN OTIS\n\n**1. Screen Copybooks**\n- Screens are primarily defined in copybooks (files ending in `.CPY`) that specify the layout, fields, and labels for each screen.\n- Example: `LIBGB/[[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]` defines the screen structure for the PERUSE program (Source: [[FILE:PERUSE.CBL|PERUSE.CBL]], Index: copybook_usage).\n- These copybooks contain COBOL data structures representing each field, including display attributes, input constraints, and sometimes literal labels.\n\n**2. Screen Handling Programs**\n- Programs such as `SCREEN`, `SCREENW`, and program-specific modules (e.g., `PERUSE`, `GRSCAN`, `SPINQ`) use these copybooks to manage screen display and user interaction.\n- The main screen handler, `SCREEN`, is responsible for rendering fields, managing input, and handling navigation logic (Source: [[FILE:SCREEN|SCREEN]], [[FILE:I|I]]ndex: flows; SCREEN, Index: programs).\n- Each business program typically includes its own screen copybook and calls the screen handler to display and process the screen.\n\n**3. Display Logic**\n- The display process involves:\n  - Initializing screen fields from the copybook.\n  - Calling routines like `FORM-RESET`, `DISPLAY-FIELD`, or program-specific paragraphs to render the screen.\n  - Using DISPLAY statements or equivalent to show labels, prompts, and data fields.\n  - Handling user input via ENTRY-MODULE or similar paragraphs, validating and updating fields as needed.\n\n**4. Example Flow**\n- For the PERUSE program:\n  - The screen is defined in `[[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]`.\n  - The program flow includes paragraphs like `FORM-RESET`, `DISPLAY-CURRENT-LIST`, and `DISPLAY-BUILD` to manage screen content (Source: [[FILE:PERUSE|PERUSE]], [[FILE:I|I]]ndex: flows).\n  - User actions trigger updates and redisplay via these routines.\n\n**5. Screen Navigation**\n- Navigation between screens is managed by menu programs (e.g., `LPMENU`) and function keys (e.g., F1, F7), which trigger calls to different screen-handling programs.\n- Each screen program loads its copybook, displays the screen, and processes user input before returning control to the menu or calling program.\n\n---\n\n### SUMMARY\n\n- **Screen layouts** are defined in copybooks (e.g., `[[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]`, `[[FILE:GRSCN2_SCN.CPY|GRSCN2_SCN.CPY]]`).\n- **Screen display and input** are managed by dedicated handler programs (e.g., `SCREEN`, `SCREENW`) and business modules.\n- **User navigation** is controlled by menu programs and function keys, which route users to the appropriate screen programs.\n\n---\n\n#### Example: PERUSE Screen Definition and Display\n\n- **Copybook:** `LIBGB/[[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]` (defines fields and layout)\n- **Program:** `PERUSE` (uses the copybook, calls display routines)\n- **Handler:** `SCREEN` (manages rendering and input)\n\n(Source: [[FILE:PERUSE.CBL|PERUSE.CBL]], Index: copybook_usage; SCREEN, Index: flows; [[FILE:GRSCAN.CBL|GRSCAN.CBL]], Index: copybook_usage)\n\n---\n\nHere's a visual representation of the screen definition and display flow in OTIS:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Screen Definition & Display Flow</text>\n  \n  <!-- Screen Copybook -->\n  <rect x=\"50\" y=\"100\" width=\"220\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"160\" y=\"130\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">Screen Copybook</text>\n  <text x=\"160\" y=\"150\" text-anchor=\"middle\" font-size=\"13\" fill=\"#6366f1\">e.g., [[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]</text>\n  \n  <!-- Business Program -->\n  <rect x=\"350\" y=\"100\" width=\"220\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"460\" y=\"130\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Business Program</text>\n  <text x=\"460\" y=\"150\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1e40af\">e.g., PERUSE, GRSCAN</text>\n  \n  <!-- Screen Handler -->\n  <rect x=\"650\" y=\"100\" width=\"180\" height=\"80\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"740\" y=\"130\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Screen Handler</text>\n  <text x=\"740\" y=\"150\" text-anchor=\"middle\" font-size=\"13\" fill=\"#22c55e\">SCREEN, SCREENW</text>\n  \n  <!-- User -->\n  <ellipse cx=\"160\" cy=\"300\" rx=\"60\" ry=\"35\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\"/>\n  <text x=\"160\" y=\"308\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">User</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"270\" y1=\"140\" x2=\"350\" y2=\"140\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"310\" y=\"125\" font-size=\"12\" fill=\"#667eea\">Includes Copybook</text>\n  \n  <line x1=\"570\" y1=\"140\" x2=\"650\" y2=\"140\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"610\" y=\"125\" font-size=\"12\" fill=\"#3b82f6\">Calls Handler</text>\n  \n  <line x1=\"160\" y1=\"215\" x2=\"160\" y2=\"265\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"180\" y=\"240\" font-size=\"12\" fill=\"#16a34a\">Input</text>\n  \n  <line x1=\"740\" y1=\"180\" x2=\"740\" y2=\"265\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"760\" y=\"220\" font-size=\"12\" fill=\"#22c55e\">Displays Screen</text>\n  \n  <line x1=\"220\" y1=\"300\" x2=\"650\" y2=\"140\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"400\" y=\"220\" font-size=\"12\" fill=\"#6366f1\">User Navigation</text>\n</svg>\n\n**In summary:**  \nScreens in OTIS are defined in copybooks, displayed by business programs using screen handlers, and navigated by users via menu programs and function keys.  \n(Source: [[FILE:PERUSE.CBL|PERUSE.CBL]], Index: copybook_usage; SCREEN, Index: flows; [[FILE:GRSCAN.CBL|GRSCAN.CBL]], Index: copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 16.752
  },
  "Q27": {
    "question": "What is the relationship between menu programs and business logic programs?",
    "answer": "Menu programs in OTIS serve as the user interface layer, allowing users to navigate the system and select business functions. Business logic programs, on the other hand, perform the actual processing, calculations, and data updates required for each business function. Here’s how they relate:\n\n---\n\n### RELATIONSHIP BETWEEN MENU PROGRAMS AND BUSINESS LOGIC PROGRAMS\n\n**1. Menu Programs (UI Layer):**\n- Examples: PGMENU, LPMENU, SPMENU, BPMENU, GBMENU, SCMENU, etc.\n- Purpose: Display menus, capture user selections, handle navigation (including function keys like F1, F7).\n- Implementation: Typically contain logic to display menu options, wait for user input, and then route control to the appropriate business logic program based on the selection.\n- Flow: Use paragraphs like DISPLAY-MENU, GET-MENU-SELECTION, MENU-SELECTION to manage user interaction.\n\n**2. Business Logic Programs (Processing Layer):**\n- Examples: ADDON-MAINT, DEALER-MAINT, LOAN-MAINT, FORM-RESET, MISC-TRACE-RETURN, RUN-PROG, etc.\n- Purpose: Execute the requested business function (e.g., maintain loans, process payments, generate reports).\n- Implementation: Receive control from menu programs, perform validations, calculations, file updates, and return results or status.\n\n**3. How They Interact:**\n- The menu program displays options and waits for user input.\n- Upon selection, the menu program calls (PERFORM or CALL) the corresponding business logic program.\n- Control may return to the menu program after the business logic completes, allowing further navigation or exit.\n\n**4. Example Flow (from PGMENU):**\n- User sees main menu (PGMENU).\n- Selects \"Loan Maintenance\" → PGMENU routes to LOAN-MAINT program.\n- LOAN-MAINT performs loan maintenance logic.\n- Upon completion, control returns to PGMENU for further choices.\n\n**5. Technical Evidence:**\n- Menu programs have flowcharts showing transitions from DISPLAY-MENU to RUN-PROG (business logic).\n- Example from PGMENU:\n  - SELECT-FIELD-FROM-DISPLAY → ADDON-MAINT\n  - SELECT-FIELD-FROM-DISPLAY → DEALER-MAINT\n  - SELECT-FIELD-FROM-DISPLAY → LOAN-MAINT\n  (Source: [[FILE:PGMENU|PGMENU]], [[FILE:I|I]]ndex: flows)\n\n---\n\n**Summary:**  \nMenu programs act as controllers and navigators, while business logic programs execute the actual business tasks. The menu programs call business logic programs based on user selection, forming a clear separation between UI and processing layers.\n\n---\n\nHere's a visual representation:\n\n<svg width=\"700\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Menu & Business Logic Relationship</text>\n  \n  <!-- Menu Programs -->\n  <rect x=\"50\" y=\"70\" width=\"250\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"175\" y=\"100\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">Menu Programs</text>\n  <text x=\"175\" y=\"120\" text-anchor=\"middle\" font-size=\"13\" fill=\"#6366f1\">PGMENU, LPMENU, SPMENU, etc.</text>\n  \n  <!-- Business Logic Programs -->\n  <rect x=\"400\" y=\"70\" width=\"250\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"525\" y=\"100\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#1e40af\">Business Logic Programs</text>\n  <text x=\"525\" y=\"120\" text-anchor=\"middle\" font-size=\"13\" fill=\"#3b82f6\">LOAN-MAINT, ADDON-MAINT, etc.</text>\n  \n  <!-- Arrow from Menu to Business Logic -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"300\" y1=\"110\" x2=\"400\" y2=\"110\" stroke=\"#666\" stroke-width=\"3\" marker-end=\"url(#arrow)\"/>\n  <text x=\"350\" y=\"95\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1a1a1a\">User Selection</text>\n  <text x=\"350\" y=\"125\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1a1a1a\">CALL / PERFORM</text>\n  \n  <!-- Return Arrow -->\n  <line x1=\"400\" y1=\"140\" x2=\"300\" y2=\"140\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <text x=\"350\" y=\"155\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1a1a1a\">Return Control</text>\n</svg>\n\n**Source references:**\n- PGMENU, Index: flows\n- LPMENU, Index: flows\n- SPMENU, Index: flows\n\nThis diagram shows how menu programs route user selections to business logic programs, and how control returns after processing.",
    "sources_count": 200,
    "timing_seconds": 12.892
  },
  "Q28": {
    "question": "How does OTIS handle user input validation on screens?",
    "answer": "OTIS handles user input validation on screens through a structured combination of screen copybooks, entry modules, and business logic programs. Here’s how the process works:\n\n---\n\n### USER INPUT VALIDATION IN OTIS\n\n**1. Screen Copybook Definitions**\n- Each screen is defined in a copybook (e.g., `[[FILE:SCREENW.CPY|SCREENW.CPY]]`, `[[FILE:PWMAIN_SCN.CPY|PWMAIN_SCN.CPY]]`), which specifies the fields, their types, and sometimes constraints (such as field length, required/optional status).\n- These copybooks are included in the COBOL programs that display and process the screens.\n- Example:  \n  - `LIBGB/[[FILE:SCREENW.CPY|SCREENW.CPY]]` – Defines screen fields and attributes for validation (Source: [[FILE:CHJUDG.CBL|CHJUDG.CBL]], Index: copybook_usage).\n\n**2. Entry Modules and Field-Level Validation**\n- When a user enters data, the program’s ENTRY-MODULE (or similarly named paragraph) processes each field.\n- The ENTRY-MODULE contains logic to:\n  - Check for required fields (e.g., IF field is blank, display error)\n  - Validate field formats (e.g., numeric, date, code lookup)\n  - Enforce business rules (e.g., value ranges, cross-field dependencies)\n- Example:\n  - In programs like `BBINQ2`, the flow includes `ENTRY-MODULE` and `PASSWORD-ENTRY` for validating user input (Source: [[FILE:BBINQ2|BBINQ2]], [[FILE:I|I]]ndex: flows).\n\n**3. Business Logic Validation**\n- After initial field-level checks, business logic programs perform deeper validation:\n  - Lookup codes against reference files (e.g., checking if a routing code exists)\n  - Validate combinations of fields (e.g., loan type and amount)\n  - Enforce security (e.g., password checks via `VERIFY-PASSWORD`)\n- Example:\n  - `SSINQ` uses `VERIFY-PASSWORD` and checks group security before allowing access (Source: [[FILE:SSINQ|SSINQ]], [[FILE:I|I]]ndex: flows).\n\n**4. Error Messaging and User Feedback**\n- If validation fails, error messages are displayed using standard routines.\n- Error messages are often defined in copybooks like `[[FILE:ERRMSG.CPY|ERRMSG.CPY]]` and displayed via dedicated paragraphs (e.g., `SEND-LEGEND`, `DISPLAY-FIELDS`).\n- Example:\n  - Programs like `DECLARE` and `DECLARE_SQL` use `[[FILE:ERRMSG.CPY|ERRMSG.CPY]]` for error handling (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: copybook_usage).\n\n**5. Security and Authorization Checks**\n- Many programs include security validation using copybooks such as `[[FILE:CHKSEC.CPY|CHKSEC.CPY]]`.\n- This ensures that only authorized users can perform certain actions or access specific screens.\n- Example:\n  - Programs like `SSINQ`, `LYGLUP`, `WIMENU`, and many others include `LIBGB/[[FILE:CHKSEC.CPY|CHKSEC.CPY]]` for security validation (Source: [[FILE:SSINQ.CBL|SSINQ.CBL]], [[FILE:LYGLUP.CBL|LYGLUP.CBL]], [[FILE:WIMENU.CBL|WIMENU.CBL]], Index: copybook_usage).\n\n---\n\n#### Typical Validation Flow (Example Narrative):\n\n1. **Screen Display**: The user is presented with a screen defined in a copybook.\n2. **User Input**: The user enters data into one or more fields.\n3. **Entry Module**: The program’s ENTRY-MODULE validates each field for format, required status, and basic rules.\n4. **Business Logic**: Additional validation is performed, such as code lookups, cross-field checks, and security validation.\n5. **Error Handling**: If any validation fails, an error message is displayed, and the user is prompted to correct the input.\n6. **Success**: If all validations pass, the input is accepted and processed.\n\n---\n\n### Source Citations\n\n- Screen field definitions: `LIBGB/[[FILE:SCREENW.CPY|SCREENW.CPY]]` (Source: [[FILE:CHJUDG.CBL|CHJUDG.CBL]], Index: copybook_usage)\n- Entry module validation: `ENTRY-MODULE` in `BBINQ2` (Source: [[FILE:BBINQ2|BBINQ2]], [[FILE:I|I]]ndex: flows)\n- Security validation: `LIBGB/[[FILE:CHKSEC.CPY|CHKSEC.CPY]]` in `SSINQ`, `LYGLUP`, `WIMENU`, etc. (Source: [[FILE:SSINQ.CBL|SSINQ.CBL]], [[FILE:LYGLUP.CBL|LYGLUP.CBL]], [[FILE:WIMENU.CBL|WIMENU.CBL]], Index: copybook_usage)\n- Error messaging: `[[FILE:ERRMSG.CPY|ERRMSG.CPY]]` in `DECLARE`, `DECLARE_SQL` (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], [[FILE:DECLARE_SQL.CPY|DECLARE_SQL.CPY]], Index: copybook_usage)\n\n---\n\n### Visual Representation\n\nHere's a visual representation of the user input validation flow in OTIS:\n\n<svg width=\"700\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS User Input Validation Flow</text>\n  \n  <!-- Screen Copybook -->\n  <rect x=\"50\" y=\"70\" width=\"600\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">Screen Copybook</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Defines fields, types, constraints</text>\n  \n  <!-- Entry Module -->\n  <rect x=\"50\" y=\"170\" width=\"600\" height=\"70\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"200\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Entry Module</text>\n  <text x=\"350\" y=\"220\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Field-level validation (format, required, range)</text>\n  \n  <!-- Business Logic -->\n  <rect x=\"50\" y=\"270\" width=\"600\" height=\"70\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"300\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Business Logic</text>\n  <text x=\"350\" y=\"320\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Code lookups, cross-field checks, security</text>\n  \n  <!-- Error Handling -->\n  <rect x=\"50\" y=\"370\" width=\"600\" height=\"70\" fill=\"#fee2e2\" stroke=\"#ef4444\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"400\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b91c1c\">Error Handling</text>\n  <text x=\"350\" y=\"420\" text-anchor=\"middle\" font-size=\"12\" fill=\"#ef4444\">Display error messages, prompt for correction</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"140\" x2=\"350\" y2=\"170\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"240\" x2=\"350\" y2=\"270\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"340\" x2=\"350\" y2=\"370\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**Summary:**  \nOTIS validates user input on screens by combining field definitions in copybooks, entry module logic for immediate checks, business logic for deeper validation, and error handling routines for user feedback. Security checks are integrated throughout to ensure only authorized actions are allowed.",
    "sources_count": 100,
    "timing_seconds": 16.437
  },
  "Q29": {
    "question": "What screen copybooks are used to define UI layouts?",
    "answer": "Screen copybooks in the OTIS/OTOS application are specialized COBOL copybooks that define the layout, fields, and formatting for user interface screens. These copybooks are included in programs to standardize the display and input structure for menus, forms, and inquiry screens.\n\nBelow is a complete list of **screen copybooks** used to define UI layouts, based on the retrieved context. Each entry includes a brief description of its purpose, inferred from the copybook name, usage, or associated program.\n\n---\n\n### SCREEN COPYBOOKS USED FOR UI LAYOUTS (OTIS/OTOS)\n\n| Copybook Name                | Description / Purpose                                                                 |\n|------------------------------|--------------------------------------------------------------------------------------|\n| [[FILE:GLIMSC_SCN.CPY|GLIMSC_SCN.CPY]]               | General ledger inquiry/maintenance screen layout (GLIMSC)                            |\n| [[FILE:EACDMN_SCN.CPY|EACDMN_SCN.CPY]]               | Dealer maintenance screen layout (CDMAIN)                                            |\n| [[FILE:CNMAIN_SCN.CPY|CNMAIN_SCN.CPY]]               | Dealer main menu screen layout (CDMAIN)                                              |\n| [[FILE:LPSMNU_SCN.CPY|LPSMNU_SCN.CPY]]               | Loan processing system main menu screen (used by many programs: DISBI0, VOIDI0, etc.)|\n| [[FILE:DISBI_SCN.CPY|DISBI_SCN.CPY]]                | Disbursement inquiry screen layout (DISBI0)                                          |\n| [[FILE:BYINQ2_SCN.CPY|BYINQ2_SCN.CPY]]               | Borrower inquiry screen layout (BYINQ, UTINQ)                                        |\n| [[FILE:LONPM_SCN.CPY|LONPM_SCN.CPY]]                | Loan payment menu screen layout (PST851, PST852)                                     |\n| [[FILE:LPWSDL.CPY|LPWSDL.CPY]]                   | Loan payoff worksheet display layout (RZ1ERN, AC1ERN)                                |\n| [[FILE:SUMMCD_SCN.CPY|SUMMCD_SCN.CPY]]               | Summary code maintenance screen layout (SUMMCD)                                      |\n| [[FILE:DSMAIN_SCN.CPY|DSMAIN_SCN.CPY]]               | Dealer summary main screen layout (DSMAIN)                                           |\n| [[FILE:DSMAN1_SCN.CPY|DSMAN1_SCN.CPY]]               | Dealer summary alternate main screen layout (DSMAIN)                                 |\n| [[FILE:CQMAIN_SCN.CPY|CQMAIN_SCN.CPY]]               | Check inquiry main screen layout (CQMAIN)                                            |\n| [[FILE:CQSCN3_SCN.CPY|CQSCN3_SCN.CPY]]               | Check inquiry alternate screen layout (CQSCN3)                                       |\n| [[FILE:EQMAIN_SCN.CPY|EQMAIN_SCN.CPY]]               | Equipment inquiry main screen layout (EQMAIN)                                        |\n| [[FILE:INBRT2_SCN.CPY|INBRT2_SCN.CPY]]               | Insurance inquiry screen layout (CPINQ0)                                             |\n| [[FILE:BWCREA_SCN.CPY|BWCREA_SCN.CPY]]               | Borrower creation screen layout (BWCREA)                                             |\n| [[FILE:BWLNSC_SCN.CPY|BWLNSC_SCN.CPY]]               | Borrower loan screen layout (BWLNSC)                                                 |\n| [[FILE:BWSCN2_SCN.CPY|BWSCN2_SCN.CPY]]               | Borrower alternate screen layout (BWLNSC)                                            |\n| [[FILE:PMMAKE_SCN.CPY|PMMAKE_SCN.CPY]]               | Payment make screen layout (PMMAKE)                                                  |\n| [[FILE:PERUSE_SCN.CPY|PERUSE_SCN.CPY]]               | Peruse (browse) screen layout (PERUSE)                                               |\n| [[FILE:BBINQ3_SCN.CPY|BBINQ3_SCN.CPY]]               | Borrower batch inquiry screen layout (BBINQ2)                                        |\n| [[FILE:ORIGRB_SCN.CPY|ORIGRB_SCN.CPY]]               | Origination borrower screen layout (ORIGRB)                                          |\n| [[FILE:DLPARV_EVA.CPY|DLPARV_EVA.CPY]]               | Dealer payoff evaluation screen layout (LONPFB)                                      |\n| [[FILE:LP01PD.CPY|LP01PD.CPY]]                   | Loan payment detail screen layout (LONPG6)                                           |\n| [[FILE:LPFSWK.CPY|LPFSWK.CPY]]                   | Loan processing file summary/work screen (LONPF7, LONPJ1, LONPF9, SFQUOT, etc.)      |\n| [[FILE:LONIF_EVA.CPY|LONIF_EVA.CPY]]                | Loan information evaluation screen layout (LONIF0)                                   |\n| [[FILE:LPCMNU_EVA.CPY|LPCMNU_EVA.CPY]]               | Loan processing menu evaluation screen layout (LONIF0)                               |\n| [[FILE:LPCMNU_SCN.CPY|LPCMNU_SCN.CPY]]               | Loan processing menu screen layout (LONIU0)                                          |\n| [[FILE:VOIDI_SCN.CPY|VOIDI_SCN.CPY]]                | Void inquiry screen layout (VOIDI0)                                                  |\n| [[FILE:LONPG7_SCN.CPY|LONPG7_SCN.CPY]]               | Loan payment group 7 screen layout (LONPG7)                                          |\n| [[FILE:LONPG5_SCN.CPY|LONPG5_SCN.CPY]]               | Loan payment group 5 screen layout (LONPG5)                                          |\n| [[FILE:LONPG3_SCN.CPY|LONPG3_SCN.CPY]]               | Loan payment group 3 screen layout (LONPG3)                                          |\n| [[FILE:LONPF_EVA.CPY|LONPF_EVA.CPY]]                | Loan payoff evaluation screen layout (LONPFB)                                        |\n| [[FILE:LPVDMU_EVA.CPY|LPVDMU_EVA.CPY]]               | Loan payment validation menu screen layout (LONPFB)                                  |\n| [[FILE:EOBUF_EXT.CPY|EOBUF_EXT.CPY]]                | Extended output buffer for screen layouts (used by many programs: LNCRE2, LCAPPD, etc.)|\n| [[FILE:SCREEN.CPY|SCREEN.CPY]]                   | Generic screen layout definitions (used by many programs: RZ1DAO, BWLNSC, AQSMAN, etc.)|\n| [[FILE:SCREENW.CPY|SCREENW.CPY]]                  | Wide screen layout definitions (used by many programs: RCINQ0, BPBRMN, IOCDBR, etc.) |\n| [[FILE:FERRORS.CPY|FERRORS.CPY]]                  | Error message screen layout (used by many programs: RZREPZ, OPREPT, IOBYRN, etc.)    |\n| [[FILE:LPTYCL.CPY|LPTYCL.CPY]]                   | Loan payment type cycle screen layout (OPREPT, RZREPZ)                              |\n| [[FILE:GETFMW.CPY|GETFMW.CPY]]                   | Get file menu/work screen layout (IOGQSI, IOCQSI, LPPOFF)                           |\n| [[FILE:LPSTATW.CPY|LPSTATW.CPY]]                  | Loan processing status work screen layout (AUDIQ0)                                   |\n| [[FILE:DATER.CPY|DATER.CPY]]                    | Date entry screen layout (used in various programs)                                 |\n| [[FILE:HELP_TEXT.CPY|HELP_TEXT.CPY]]                | Help screen text layout (MENUHELP)                                                   |\n| ...                          | (Many additional screen copybooks exist for specialized screens and menus)           |\n\n---\n\n**Total unique screen copybooks listed above: 40+**  \n(Each copybook is referenced by at least one program in the retrieved context. Some, like [[FILE:SCREEN.CPY|SCREEN.CPY]] and [[FILE:LPSMNU_SCN.CPY|LPSMNU_SCN.CPY]], are used by many programs to provide common UI layouts.)\n\n---\n\n### How Screen Copybooks Are Used\n\n- **Purpose:** Each screen copybook defines the fields, labels, formatting, and sometimes validation rules for a specific screen or menu.\n- **Usage:** Programs include these copybooks in their WORKING-STORAGE or LINKAGE SECTION, then use DISPLAY/ACCEPT statements or screen-handling routines to render the UI.\n- **Standardization:** Common copybooks (e.g., [[FILE:SCREEN.CPY|SCREEN.CPY]], [[FILE:SCREENW.CPY|SCREENW.CPY]]) provide reusable layouts for menus, error messages, and inquiry screens across the system.\n\n---\n\n**Source citations:**  \n- [[FILE:GLIMSC_SCN.CPY|GLIMSC_SCN.CPY]] (Source: [[FILE:GLIMSC.CBL|GLIMSC.CBL]], Index: copybook_usage)  \n- [[FILE:LPSMNU_SCN.CPY|LPSMNU_SCN.CPY]] (Source: [[FILE:DISBI0.CBL|DISBI0.CBL]], Index: copybook_usage)  \n- [[FILE:SCREEN.CPY|SCREEN.CPY]] (Source: [[FILE:RZ1DAO.CBL|RZ1DAO.CBL]], Index: copybook_usage)  \n- [[FILE:SCREENW.CPY|SCREENW.CPY]] (Source: [[FILE:RCINQ0.CBL|RCINQ0.CBL]], Index: copybook_usage)  \n- [[FILE:FERRORS.CPY|FERRORS.CPY]] (Source: [[FILE:RZREPZ.CBL|RZREPZ.CBL]], Index: copybook_usage)  \n- [[FILE:EOBUF_EXT.CPY|EOBUF_EXT.CPY]] (Source: [[FILE:LNCRE2.CBL|LNCRE2.CBL]], Index: copybook_usage)  \n- [[FILE:BYINQ2_SCN.CPY|BYINQ2_SCN.CPY]] (Source: [[FILE:BYINQ.CBL|BYINQ.CBL]], Index: copybook_usage)  \n- [[FILE:LONPM_SCN.CPY|LONPM_SCN.CPY]] (Source: [[FILE:PST851.CBL|PST851.CBL]], Index: copybook_usage)  \n- [[FILE:LPFSWK.CPY|LPFSWK.CPY]] (Source: [[FILE:LONPF7.CBL|LONPF7.CBL]], Index: copybook_usage)  \n- And many more as shown above.\n\n---\n\n**Summary:**  \nScreen copybooks are the foundation for UI layouts in OTIS/OTOS. They ensure consistency and maintainability by centralizing screen definitions, which are then used by both menu programs and business logic programs to display forms, menus, and inquiry screens to users.",
    "sources_count": 200,
    "timing_seconds": 14.079
  },
  "Q30": {
    "question": "How does the system route users from menus to specific functions?",
    "answer": "The OTIS system routes users from menus to specific business functions through a layered process involving menu programs, screen copybooks, and business logic programs. Here’s how the routing works:\n\n**1. Menu Program Displays UI and Captures User Selection**\n- Menu programs (e.g., PGMENU, WIMENU, CLMENU, SPMENU) display the main navigation screens using screen copybooks (such as LIBGB/[[FILE:MENU1A.CPY|MENU1A.CPY]], LIBSP/[[FILE:SPMENU_SCN.CPY|SPMENU_SCN.CPY]]).\n- These screens present options for different business functions (e.g., Loan Maintenance, Dealer Maintenance, Payment Posting).\n- The user selects an option (typically by entering a number or pressing a function key).\n\n**2. Menu Program Interprets Selection**\n- The menu program reads the user’s input and determines which business function was chosen.\n- This is handled in paragraphs like SELECT-FIELD-FROM-DISPLAY or RUN-PROG, which map the selection to a specific business logic program.\n\n**3. Menu Program Calls the Appropriate Business Logic Program**\n- Based on the selection, the menu program performs a CALL to the corresponding business logic program.\n- For example, in PGMENU:\n  - If the user selects Loan Maintenance, PGMENU calls LOAN-MAINT.\n  - If Dealer Maintenance is selected, it calls DEALER-MAINT.\n- This routing is visible in flowcharts and call lists:\n  - PGMENU makes 15 calls to unique programs (Source: [[FILE:PGMENU|PGMENU]], [[FILE:I|I]]ndex: programs).\n  - WIMENU makes 13 calls to unique programs (Source: [[FILE:WIMENU|WIMENU]], [[FILE:I|I]]ndex: programs).\n\n**4. Business Logic Program Executes the Requested Function**\n- The called business logic program performs the requested processing (e.g., updating loans, posting payments).\n- After completion, control may return to the menu program, allowing the user to make another selection.\n\n**5. Screen Copybooks Define the Layout for Each Step**\n- Screen copybooks (e.g., [[FILE:MENU1A.CPY|MENU1A.CPY]], [[FILE:SPMENU_SCN.CPY|SPMENU_SCN.CPY]]) are used by both menu and business logic programs to display the appropriate UI for each function.\n\n**Example Flow (PGMENU):**\n- User sees menu screen (defined by [[FILE:MENU1A.CPY|MENU1A.CPY]]).\n- User selects “Loan Maintenance.”\n- PGMENU interprets the selection and CALLs LOAN-MAINT.\n- LOAN-MAINT executes loan maintenance logic and displays its own screen.\n\n**Source References:**\n- Flowchart and call relationships: PGMENU, WIMENU, CLMENU, SPMENU (Source: respective program flows and programs indexes)\n- Screen copybook usage: LIBGB/[[FILE:MENU1A.CPY|MENU1A.CPY]], LIBSP/[[FILE:SPMENU_SCN.CPY|SPMENU_SCN.CPY]] (Source: copybook_usage indexes)\n\n---\n\n**Here's a visual representation:**\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Menu Routing to Business Functions</text>\n  \n  <!-- Menu Program -->\n  <rect x=\"60\" y=\"80\" width=\"200\" height=\"80\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"10\"/>\n  <text x=\"160\" y=\"110\" text-anchor=\"middle\" font-size=\"18\" fill=\"white\" font-weight=\"bold\">Menu Program</text>\n  <text x=\"160\" y=\"135\" text-anchor=\"middle\" font-size=\"13\" fill=\"white\">PGMENU / WIMENU / SPMENU</text>\n  \n  <!-- Screen Copybook -->\n  <rect x=\"320\" y=\"80\" width=\"200\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"10\"/>\n  <text x=\"420\" y=\"110\" text-anchor=\"middle\" font-size=\"18\" fill=\"#1e40af\" font-weight=\"bold\">Screen Copybook</text>\n  <text x=\"420\" y=\"135\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1e40af\">[[FILE:MENU1A.CPY|MENU1A.CPY]] / [[FILE:SPMENU_SCN.CPY|SPMENU_SCN.CPY]]</text>\n  \n  <!-- User Selection -->\n  <ellipse cx=\"650\" cy=\"120\" rx=\"80\" ry=\"40\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\"/>\n  <text x=\"650\" y=\"120\" text-anchor=\"middle\" font-size=\"16\" fill=\"white\" font-weight=\"bold\">User Selection</text>\n  <text x=\"650\" y=\"140\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">Option/Function Key</text>\n  \n  <!-- Business Logic Programs -->\n  <rect x=\"180\" y=\"250\" width=\"160\" height=\"70\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"3\" rx=\"10\"/>\n  <text x=\"260\" y=\"280\" text-anchor=\"middle\" font-size=\"16\" fill=\"white\" font-weight=\"bold\">Business Logic</text>\n  <text x=\"260\" y=\"300\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">LOAN-MAINT, DEALER-MAINT, etc.</text>\n  \n  <rect x=\"420\" y=\"250\" width=\"160\" height=\"70\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"3\" rx=\"10\"/>\n  <text x=\"500\" y=\"280\" text-anchor=\"middle\" font-size=\"16\" fill=\"white\" font-weight=\"bold\">Business Logic</text>\n  <text x=\"500\" y=\"300\" text-anchor=\"middle\" font-size=\"12\" fill=\"white\">PAYMENT-POST, ADDON-MAINT, etc.</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"260\" y1=\"120\" x2=\"320\" y2=\"120\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"520\" y1=\"120\" x2=\"570\" y2=\"120\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"650\" y1=\"160\" x2=\"260\" y2=\"250\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"650\" y1=\"160\" x2=\"500\" y2=\"250\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n**Summary:**  \n- Menu programs display options using screen copybooks.\n- User selects a function.\n- Menu program interprets the selection and calls the corresponding business logic program.\n- The business logic program executes the requested function.\n\n(Source: [[FILE:PGMENU|PGMENU]], [[FILE:WIMENU|WIMENU]], [[FILE:SPMENU|SPMENU]], [[FILE:CLMENU|CLMENU]], [[FILE:I|I]]ndex: flows, programs, copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 15.334
  },
  "Q31": {
    "question": "What is TIMEIO.CPY and what does it do?",
    "answer": "[[FILE:TIMEIO.CPY|TIMEIO.CPY]] is a COBOL copybook used in the OTIS/OTOS system to provide routines for getting and formatting clock time.\n\n**BUSINESS PURPOSE:**\n- [[FILE:TIMEIO.CPY|TIMEIO.CPY]] enables programs to retrieve the current system time and format it for display, logging, or time-based calculations.\n- It supports both standard and military time formats, which is useful for timestamping transactions, audit trails, and time-sensitive operations across the application.\n\n**TECHNICAL IMPLEMENTATION:**\n- The copybook defines routines and data structures for:\n  - Getting the current clock time from the system.\n  - Formatting the time into various display formats (including military time).\n  - Providing timer start/stop sections for measuring elapsed time (added in recent revisions).\n- It is included in many programs (at least 40+ in the retrieved context) to standardize time handling.\n\n**Key Features (from code and comments):**\n- **GET/FORMAT CLOCK TIME:** Main functionality is to retrieve and format the current time.\n- **TIME-MILITARY-FG:** Flag to indicate military time formatting.\n- **TIMER-START and TIMER-STOP:** Sections for timing operations, useful for performance measurement or elapsed time calculations.\n- **Used by GB/[[FILE:TIMER.CBL|TIMER.CBL]]:** Indicates integration with broader timer routines in the system.\n\n**Example Comment from [[FILE:TIMEIO.CPY|TIMEIO.CPY]]:**\n```cobol\n      * COPYMEMBER: LIBGB/TIMEIO\n      ******************************************************************\n      *              (TIMEIO)\n      *   GET/FORMAT CLOCK TIME\n      *=================================================================\n      * REV:\n      * JTG 020594 ADDED TIME-MILITARY-FG\n      *\n      * JKC 2020-1026 ADDED TIMER-START AND TIMER-STOP SECTIONS.\n      *          USED FOR GB/[[FILE:TIMER.CBL|TIMER.CBL]].\n      *\n      ******************************************************************\n```\n(Source: [[FILE:TIMEIO.CPY|TIMEIO.CPY]], Index: code)\n\n**Programs Using [[FILE:TIMEIO.CPY|TIMEIO.CPY]] (examples):**\n- TR1697, CKTRLP, LTFFLE, TRKFLE, IIFILE, TYFILE, ICFILE, LTDFLE, IRFILE, TRPFLE, IOLTBI, IOLTPI, IOLTDR, IOLTCI, IOTRIR, IOLTIR, LTPFLE, GIAPPR, IOLTFR, TRCFLE, IOLTDI, CPLFLE, FMFILE, LSFFLE, NOFILE, RZPLRG, IOLTCR, MPOOL1, IOLTII, IOLTLI, TZFILE, PAFILE, GLEOD, ERRLOG, RCOPEN, etc.\n(Source: [[FILE:M|M]]ultiple program copybook_usage documents)\n\n**Summary Table:**\n\n| Copybook Name         | Purpose/Description                                 |\n|-----------------------|-----------------------------------------------------|\n| LIBGB/[[FILE:TIMEIO.CPY|TIMEIO.CPY]]      | Get and format clock time, timer routines           |\n\n**In summary:**  \n[[FILE:TIMEIO.CPY|TIMEIO.CPY]] is a foundational copybook for time retrieval and formatting in OTIS/OTOS, used widely to ensure consistent handling of time across many programs.\n\n(Source: [[FILE:TIMEIO.CPY|TIMEIO.CPY]], Index: code; Multiple program copybook_usage documents)",
    "sources_count": 100,
    "timing_seconds": 10.512
  },
  "Q32": {
    "question": "What are the most important copybooks in OTIS and their purposes?",
    "answer": "Here are the most important copybooks in the OTIS/OTOS application, along with their purposes. These copybooks are widely used across programs and define key data structures, UI layouts, and business logic components.\n\n---\n\n### 1. **Screen/UI Layout Copybooks**\nThese define the structure and fields for user interface screens.\n\n- **LIBLP/[[FILE:LPCVMU_SCN.CPY|LPCVMU_SCN.CPY]]** – Defines the layout for the \"Loan Payment Maintenance Update\" screen.\n- **LIBLP/[[FILE:LPVDMU_WKS.CPY|LPVDMU_WKS.CPY]]** – Used for \"Void Maintenance Update\" screen layouts.\n- **LIBLP/[[FILE:DISBOV_WKS.CPY|DISBOV_WKS.CPY]]** – Disbursement override screen layout.\n- **LIBLP/[[FILE:COLLET_WKS.CPY|COLLET_WKS.CPY]]** – Collection entry screen layout.\n- **LIBGB/[[FILE:MENU1A.CPY|MENU1A.CPY]]** – Main menu screen definitions.\n\n---\n\n### 2. **Loan and Payment Data Structures**\nThese copybooks define the core loan, payment, and account record formats.\n\n- **LIBLP/[[FILE:LONPM_WKS.CPY|LONPM_WKS.CPY]]** – Loan payment working storage; used for payment processing.\n- **LIBLP/[[FILE:LP01WK.CPY|LP01WK.CPY]]** – Loan record structure; foundational for loan maintenance.\n- **LIBLP/[[FILE:LPUPWK.CPY|LPUPWK.CPY]]** – Loan update working storage; supports loan update operations.\n- **LIBLP/[[FILE:LPCKCL.CPY|LPCKCL.CPY]]** – Loan check clearing record definitions.\n- **LIBLP/[[FILE:LPCEPPW.CPY|LPCEPPW.CPY]]** – Collection entry payment processing working storage.\n\n---\n\n### 3. **Common Tables and Reference Data**\nThese copybooks provide lookup tables and reference data used throughout the system.\n\n- **LIBLP/[[FILE:SETCTBLW.CPY|SETCTBLW.CPY]]** – Setup/control table working storage; used for system configuration.\n- **LIBLP/[[FILE:SETCTBL.CPY|SETCTBL.CPY]]** – Setup/control table file definitions.\n- **LIBGB/[[FILE:GBGR1RN.CPY|GBGR1RN.CPY]]** – General business group reference records.\n- **LIBGB/[[FILE:GBBRRN.CPY|GBBRRN.CPY]]** – General business borrower reference records.\n\n---\n\n### 4. **Error Handling and Help**\nThese support error messaging and help linkages.\n\n- **LIBGB/[[FILE:FERRORS.CPY|FERRORS.CPY]]** – Error message codes and text.\n- **LIBGB/[[FILE:HELPLINK.CPY|HELPLINK.CPY]]** – Help link definitions for screens and fields.\n\n---\n\n### 5. **End-of-Job and Initialization**\nUsed for program initialization and end-of-job processing.\n\n- **LIBGB/[[FILE:EOINIT.CPY|EOINIT.CPY]]** – End-of-job initialization routines; widely included for program startup/shutdown.\n- **LIBGB/[[FILE:PRU_LNK.CPY|PRU_LNK.CPY]]** – PRU linkages for batch and reporting programs.\n\n---\n\n### 6. **SQL and File Logging**\nSupport for SQL logging and file management.\n\n- **LIBGB/[[FILE:GBFDSQLLOG.CPY|GBFDSQLLOG.CPY]]** – SQL log file structure; used for tracking database operations.\n- **LIBGB/[[FILE:RMFILE.CPY|RMFILE.CPY]]** – File removal and management routines.\n\n---\n\n### 7. **Miscellaneous and Specialized Copybooks**\nOther important structures for specialized functions.\n\n- **LIBGB/[[FILE:GETFMW.CPY|GETFMW.CPY]]** – Get file maintenance working storage.\n- **LIBGB/[[FILE:GETPRW.CPY|GETPRW.CPY]]** – Get payment record working storage.\n- **LIBFP/[[FILE:PSTPMCW.CPY|PSTPMCW.CPY]]** – Payment schedule table working storage.\n- **LIBSP/[[FILE:ILMISC_WKS.CPY|ILMISC_WKS.CPY]]** – Miscellaneous working storage for inquiry programs.\n\n---\n\n## Summary Table\n\n| Copybook Name                | Purpose/Description                                      |\n|------------------------------|---------------------------------------------------------|\n| [[FILE:LPCVMU_SCN.CPY|LPCVMU_SCN.CPY]]               | Loan Payment Maintenance Update screen layout            |\n| [[FILE:LPVDMU_WKS.CPY|LPVDMU_WKS.CPY]]               | Void Maintenance Update screen layout                    |\n| [[FILE:DISBOV_WKS.CPY|DISBOV_WKS.CPY]]               | Disbursement override screen layout                     |\n| [[FILE:COLLET_WKS.CPY|COLLET_WKS.CPY]]               | Collection entry screen layout                          |\n| [[FILE:MENU1A.CPY|MENU1A.CPY]]                   | Main menu screen definitions                            |\n| [[FILE:LONPM_WKS.CPY|LONPM_WKS.CPY]]                | Loan payment working storage                            |\n| [[FILE:LP01WK.CPY|LP01WK.CPY]]                   | Loan record structure                                   |\n| [[FILE:LPUPWK.CPY|LPUPWK.CPY]]                   | Loan update working storage                             |\n| [[FILE:LPCKCL.CPY|LPCKCL.CPY]]                   | Loan check clearing record definitions                  |\n| [[FILE:LPCEPPW.CPY|LPCEPPW.CPY]]                  | Collection entry payment processing                     |\n| [[FILE:SETCTBLW.CPY|SETCTBLW.CPY]]                 | Setup/control table working storage                     |\n| [[FILE:SETCTBL.CPY|SETCTBL.CPY]]                  | Setup/control table file definitions                    |\n| [[FILE:GBGR1RN.CPY|GBGR1RN.CPY]]                  | General business group reference records                |\n| [[FILE:GBBRRN.CPY|GBBRRN.CPY]]                   | General business borrower reference records             |\n| [[FILE:FERRORS.CPY|FERRORS.CPY]]                  | Error message codes and text                            |\n| [[FILE:HELPLINK.CPY|HELPLINK.CPY]]                 | Help link definitions                                   |\n| [[FILE:EOINIT.CPY|EOINIT.CPY]]                   | End-of-job initialization routines                      |\n| [[FILE:PRU_LNK.CPY|PRU_LNK.CPY]]                  | PRU linkages for batch/reporting                        |\n| [[FILE:GBFDSQLLOG.CPY|GBFDSQLLOG.CPY]]               | SQL log file structure                                  |\n| [[FILE:RMFILE.CPY|RMFILE.CPY]]                   | File removal and management routines                    |\n| [[FILE:GETFMW.CPY|GETFMW.CPY]]                   | Get file maintenance working storage                    |\n| [[FILE:GETPRW.CPY|GETPRW.CPY]]                   | Get payment record working storage                      |\n| [[FILE:PSTPMCW.CPY|PSTPMCW.CPY]]                  | Payment schedule table working storage                  |\n| [[FILE:ILMISC_WKS.CPY|ILMISC_WKS.CPY]]               | Miscellaneous working storage for inquiry programs      |\n\n---\n\nThese copybooks are foundational to the OTIS/OTOS system, supporting UI layout, core business data, error handling, and system operations. Their widespread use across programs makes them critical for both business logic and technical implementation.\n\n(Source: [[FILE:M|M]]ultiple program copybook usage records, e.g., [[FILE:LPCVMU.CBL|LPCVMU.CBL]], [[FILE:COLLET.CBL|COLLET.CBL]], [[FILE:PST850.CBL|PST850.CBL]], [[FILE:DISBOV.CBL|DISBOV.CBL]], [[FILE:DAILY.CBL|DAILY.CBL]], [[FILE:BNKRP1.CBL|BNKRP1.CBL]], etc.)",
    "sources_count": 100,
    "timing_seconds": 10.686
  },
  "Q33": {
    "question": "What is GBFSPR.CPY and what data structures does it define?",
    "answer": "[[FILE:GBFSPR.CPY|GBFSPR.CPY]] is a COBOL copybook located at LIBGB/[[FILE:GBFSPR.CPY|GBFSPR.CPY]]. Its primary purpose is to define file control entries for specific print-related files used in the OTIS/OTOS system.\n\n**BUSINESS PURPOSE:**\n- [[FILE:GBFSPR.CPY|GBFSPR.CPY]] provides the file control definitions for print files, enabling programs to read from and write to these files in a standardized way.\n- It is commonly included in programs that handle printing, reporting, or form generation, ensuring consistent file access and status handling.\n\n**TECHNICAL IMPLEMENTATION:**\n- The copybook defines two SELECT statements for file assignments:\n  - **PR-FILE**: Assigned to PRU-FILE, organized as LINE SEQUENTIAL, with exclusive lock mode and a FILE STATUS variable (FILE-STAT).\n  - **DPR-FILE**: Assigned to \"FORM\", also organized as LINE SEQUENTIAL, with a FILE STATUS variable (FILE-STAT).\n\n**DATA STRUCTURES DEFINED:**\n- **File Control Entries** (for use in the FILE-CONTROL section):\n  ```cobol\n  SELECT PR-FILE ASSIGN PRU-FILE\n         ORGANIZATION LINE SEQUENTIAL\n         LOCK MODE EXCLUSIVE\n         FILE STATUS FILE-STAT.\n  SELECT DPR-FILE ASSIGN \"FORM\"\n         ORGANIZATION LINE SEQUENTIAL\n         FILE STATUS FILE-STAT.\n  ```\n  - **PR-FILE**: Used for general print output, with exclusive access to prevent concurrent modifications.\n  - **DPR-FILE**: Used for form output, likely for specialized printing or formatting tasks.\n\n- **FILE STATUS Variable**:\n  - **FILE-STAT**: Tracks the status of file operations (e.g., success, end-of-file, error conditions).\n\n**SUMMARY:**\n- [[FILE:GBFSPR.CPY|GBFSPR.CPY]] does not define record layouts or data fields; instead, it sets up the file control environment for print and form files.\n- Programs using [[FILE:GBFSPR.CPY|GBFSPR.CPY]] can reliably open, read, write, and check status for PR-FILE and DPR-FILE.\n\n**Source Reference:**  \n- SELECT statements and file assignments (Source: [[FILE:GBFSPR.CPY|GBFSPR.CPY]], Index: code, lines 1-8)\n- Usage in multiple programs such as IOLSPR, IOFDRN, FXGBDT, TREXTR, IOCDBI, IOCPRN, IOBYIN, GPLS01, RCPURG, and others (Source: various program copybook_usage indices)\n\n**Typical Usage Example:**\n```cobol\nCOPY \"LIBGB/[[FILE:GBFSPR.CPY|GBFSPR.CPY]]\".\n...\nFILE-CONTROL.\n  SELECT PR-FILE ASSIGN PRU-FILE ...\n  SELECT DPR-FILE ASSIGN \"FORM\" ...\n```\n\n**In summary:**  \n[[FILE:GBFSPR.CPY|GBFSPR.CPY]] is a foundational copybook for print file control in OTIS, defining how programs interact with print and form files, but does not contain record-level data structures.",
    "sources_count": 100,
    "timing_seconds": 10.471
  },
  "Q34": {
    "question": "What copybooks define the main loan account structures?",
    "answer": "The main copybooks that define loan account structures in the OTIS/OTOS system are:\n\n### Key Loan Account Structure Copybooks\n\n1. **LIBLP/[[FILE:LP01LP.CPY|LP01LP.CPY]]**  \n   - **Purpose:** Defines the primary loan account record structure, including fields for loan number, borrower information, balances, dates, and status codes.\n   - **Source:** Used in programs like PMMAKE (Source: [[FILE:PMMAKE.CBL|PMMAKE.CBL]], Index: copybook_usage).\n\n2. **LIBLP/[[FILE:LP01LN_SQL.CPY|LP01LN_SQL.CPY]]**  \n   - **Purpose:** Contains SQL-compatible loan account definitions for database operations, mapping COBOL fields to SQL columns for loan records.\n   - **Source:** Used in PMMAKE, FXLIAB (Source: [[FILE:PMMAKE.CBL|PMMAKE.CBL]], [[FILE:FXLIAB.CBL|FXLIAB.CBL]], Index: copybook_usage).\n\n3. **LIBLP/[[FILE:LP01WK.CPY|LP01WK.CPY]]**  \n   - **Purpose:** Defines working storage structures for loan accounts, often used for temporary data manipulation and calculations related to loans.\n   - **Source:** Used in LONPMC, PSTPMC, CPINQ3, PST265, LONPS3 (Source: respective program files, Index: copybook_usage).\n\n4. **LIBLP/[[FILE:LPLOANW.CPY|LPLOANW.CPY]]**  \n   - **Purpose:** Provides detailed working storage fields for loan account processing, including payment schedules, balances, and transaction history.\n   - **Source:** Used in PAYOFF, CPINQ0, PST851, SFDISB, BNKWI0, PST852 (Source: respective program files, Index: copybook_usage).\n\n5. **LIBLP/[[FILE:LP01BYA_AREA.CPY|LP01BYA_AREA.CPY]]**  \n   - **Purpose:** Defines borrower area structures linked to loan accounts, including borrower demographics and cross-references.\n   - **Source:** Used in MBANR2, RZANRP (Source: [[FILE:MBANR2.CBL|MBANR2.CBL]], [[FILE:RZANRP.CBL|RZANRP.CBL]], Index: copybook_usage).\n\n6. **LIBLP/[[FILE:LPLCASW.CPY|LPLCASW.CPY]]**  \n   - **Purpose:** Contains loan cash account structures, supporting cash flow and payment processing for loans.\n   - **Source:** Used in PAYOFF, PAYOFX (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], [[FILE:PAYOFX.CBL|PAYOFX.CBL]], Index: copybook_usage).\n\n7. **LIBLP/[[FILE:LPFDER.CPY|LPFDER.CPY]]**  \n   - **Purpose:** Defines deferred payment structures for loans, supporting features like payment deferral and related calculations.\n   - **Source:** Used in LPEOD5 (Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: copybook_usage).\n\n8. **LIBLP/[[FILE:LPFDWK.CPY|LPFDWK.CPY]]**  \n   - **Purpose:** Provides working storage for deferred loan payments and related fields.\n   - **Source:** Used in LONPN2 (Source: [[FILE:LONPN2.CBL|LONPN2.CBL]], Index: copybook_usage).\n\n---\n\n### Summary Table\n\n| Copybook Name              | Purpose/Description                                         | Example Programs Using It      |\n|----------------------------|------------------------------------------------------------|-------------------------------|\n| [[FILE:LP01LP.CPY|LP01LP.CPY]]                 | Main loan account record structure                         | PMMAKE                        |\n| [[FILE:LP01LN_SQL.CPY|LP01LN_SQL.CPY]]             | SQL-compatible loan account definitions                    | PMMAKE, FXLIAB                |\n| [[FILE:LP01WK.CPY|LP01WK.CPY]]                 | Working storage for loan accounts                          | LONPMC, PSTPMC, CPINQ3        |\n| [[FILE:LPLOANW.CPY|LPLOANW.CPY]]                | Detailed loan account working storage                      | PAYOFF, CPINQ0, PST851        |\n| [[FILE:LP01BYA_AREA.CPY|LP01BYA_AREA.CPY]]           | Borrower area structures linked to loans                   | MBANR2, RZANRP                |\n| [[FILE:LPLCASW.CPY|LPLCASW.CPY]]                | Loan cash account structures                               | PAYOFF, PAYOFX                |\n| [[FILE:LPFDER.CPY|LPFDER.CPY]]                 | Deferred payment structures for loans                      | LPEOD5                        |\n| [[FILE:LPFDWK.CPY|LPFDWK.CPY]]                 | Working storage for deferred loan payments                 | LONPN2                        |\n\n---\n\n**These copybooks collectively define the core data structures for loan accounts, including main records, working storage, borrower links, payment schedules, and cash/deferred payment handling.**\n\n(Source: [[FILE:PMMAKE.CBL|PMMAKE.CBL]], [[FILE:PAYOFF.CBL|PAYOFF.CBL]], [[FILE:LONPMC.CBL|LONPMC.CBL]], [[FILE:MBANR2.CBL|MBANR2.CBL]], [[FILE:LPEOD5.CBL|LPEOD5.CBL]], [[FILE:LONPN2.CBL|LONPN2.CBL]], Index: copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 9.11
  },
  "Q35": {
    "question": "What copybooks are used for payment processing?",
    "answer": "Here are the copybooks used for payment processing in the OTIS/OTOS application. These copybooks are referenced by key payment programs such as **APIPAY**, **REGPAY**, **PAYOFF**, and related modules. Each copybook is listed with a brief description of its purpose, based on its name, usage context, and available metadata.\n\n---\n\n### Payment Processing Copybooks\n\n| Copybook Name                | Purpose/Description                                                                 |\n|------------------------------|-------------------------------------------------------------------------------------|\n| LIBLP/[[FILE:LPAMTS.CPY|LPAMTS.CPY]]             | Payment amount structures; defines fields for payment amounts and related calculations. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPFDWK.CPY|LPFDWK.CPY]]             | Payment file definitions; working storage for payment file records. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPPOFF.CPY|LPPOFF.CPY]]             | Payoff calculation structures; used for payment payoff logic. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPITRM.CPY|LPITRM.CPY]]             | Payment term structures; defines fields for payment terms and schedules. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LP01LP.CPY|LP01LP.CPY]]             | Main loan account structure; includes payment-related fields. (Source: [[FILE:LPMAN3.CBL|LPMAN3.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPFSWK.CPY|LPFSWK.CPY]]             | Payment file working storage; used for intermediate payment data. (Source: [[FILE:LONPF7.CBL|LONPF7.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPFDOP.CPY|LPFDOP.CPY]]             | Payment file definitions for operations; used in payment update logic. (Source: [[FILE:LNCRE2.CBL|LNCRE2.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPAPRZW.CPY|LPAPRZW.CPY]]            | Payment approval structures; used for payment approval workflow. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPAPRZ.CPY|LPAPRZ.CPY]]             | Payment approval record definitions. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPLCAS.CPY|LPLCAS.CPY]]             | Loan class structures; includes payment class fields. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPLCHG.CPY|LPLCHG.CPY]]             | Loan charge structures; defines payment charge fields. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPIBPC.CPY|LPIBPC.CPY]]             | Payment batch processing control; used for batch payment updates. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:LPIBPCW.CPY|LPIBPCW.CPY]]            | Payment batch processing working storage. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:SETCTBLW.CPY|SETCTBLW.CPY]]           | Settlement table working storage; used for payment settlement calculations. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBLP/[[FILE:SETCTBL.CPY|SETCTBL.CPY]]            | Settlement table definitions; used for payment settlement logic. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:REBATE.CPY|REBATE.CPY]]             | Rebate calculation structures; used for payment rebate logic. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:REBATEW.CPY|REBATEW.CPY]]            | Rebate working storage; intermediate rebate data for payments. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:DATERW.CPY|DATERW.CPY]]             | Date calculation routines; used for payment date validation. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]]         | Borrower record SQL definitions; includes payment fields for SQL operations. (Source: [[FILE:APIPAY.CBL|APIPAY.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GB01GB_SQL.CPY|GB01GB_SQL.CPY]]         | General business SQL definitions; includes payment-related fields. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:MESSWK.CPY|MESSWK.CPY]]             | Message working storage; used for payment error and status messages. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GBFDPR.CPY|GBFDPR.CPY]]             | File definitions for payment reports; used in payment reporting modules. (Source: [[FILE:BPREF.CBL|BPREF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:FERRORS.CPY|FERRORS.CPY]]            | Error message definitions; used for payment error handling. (Source: [[FILE:OPREPT.CBL|OPREPT.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GBFSPR.CPY|GBFSPR.CPY]]             | File control for print files; used for payment print/report output. (Source: [[FILE:MBDEX2.CBL|MBDEX2.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GBPRINT.CPY|GBPRINT.CPY]]            | Print file definitions; used for payment receipts and reports. (Source: [[FILE:MBDEX2.CBL|MBDEX2.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:CONNECTW_SQL.CPY|CONNECTW_SQL.CPY]]       | SQL connection definitions; used for payment database operations. (Source: [[FILE:PAYOFF.CBL|PAYOFF.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:CONNECT_SQL.CPY|CONNECT_SQL.CPY]]        | SQL connection definitions (alternate); used for payment database operations. (Source: [[FILE:LONPM0.CBL|LONPM0.CBL]], Index: copybook_usage) |\n| LIBFP/[[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]          | Payment statement working storage; used in payment statement generation. (Source: [[FILE:PST847.CBL|PST847.CBL]], Index: copybook_usage) |\n| LIBFP/[[FILE:PST_COPYXW.CPY|PST_COPYXW.CPY]]         | Payment statement extended working storage. (Source: [[FILE:PST610.CBL|PST610.CBL]], Index: copybook_usage) |\n| LIBFP/[[FILE:FPFDPST.CPY|FPFDPST.CPY]]            | Payment deposit file definitions. (Source: [[FILE:LONPM0.CBL|LONPM0.CBL]], Index: copybook_usage) |\n| LIBFP/[[FILE:FPFSPST.CPY|FPFSPST.CPY]]            | Payment special file definitions. (Source: [[FILE:LONPM0.CBL|LONPM0.CBL]], Index: copybook_usage) |\n| LIBCL/[[FILE:CRNOR2W.CPY|CRNOR2W.CPY]]            | Payment normalization routines; used for payment normalization logic. (Source: [[FILE:REGPAY.CBL|REGPAY.CBL]], Index: copybook_usage) |\n| LIBGB/[[FILE:GBWSBR.CPY|GBWSBR.CPY]]             | Borrower working storage; includes payment fields. (Source: [[FILE:REGPAY.CBL|REGPAY.CBL]], Index: copybook_usage) |\n| LIBWI/[[FILE:BWLNSCW.CPY|BWLNSCW.CPY]]            | Wisconsin loan structures; includes payment fields for WI loans. (Source: [[FILE:REGPAY.CBL|REGPAY.CBL]], Index: copybook_usage) |\n\n---\n\n### Notes\n\n- These copybooks are referenced by payment processing programs such as **APIPAY**, **REGPAY**, **PAYOFF**, **REFUPD**, and related modules.\n- They define the core data structures for payment amounts, payment files, batch processing, settlement, rebates, error handling, and reporting.\n- Some copybooks (e.g., **LIBLP/[[FILE:LP01LP.CPY|LP01LP.CPY]]**, **LIBLP/[[FILE:LPFSWK.CPY|LPFSWK.CPY]]**) are foundational and used across multiple payment and loan modules.\n\n(Source: [[FILE:M|M]]ultiple program copybook_usage indices, including [[FILE:APIPAY.CBL|APIPAY.CBL]], [[FILE:PAYOFF.CBL|PAYOFF.CBL]], [[FILE:REGPAY.CBL|REGPAY.CBL]], [[FILE:MBDEX2.CBL|MBDEX2.CBL]], [[FILE:BPREF.CBL|BPREF.CBL]], [[FILE:PST847.CBL|PST847.CBL]], [[FILE:LONPM0.CBL|LONPM0.CBL]], [[FILE:OPREPT.CBL|OPREPT.CBL]])\n\nIf you need a breakdown by specific program or want to see which copybooks are used in a particular payment workflow, let me know!",
    "sources_count": 200,
    "timing_seconds": 12.38
  },
  "Q36": {
    "question": "What copybooks define screen layouts and menu structures?",
    "answer": "The copybooks that define screen layouts and menu structures in the OTIS/OTOS system are primarily those with names ending in **_SCN.CPY**, **_WKS.CPY**, **_DEF.CPY**, and similar conventions. These copybooks contain the field definitions, screen formatting, and menu option structures used by various programs to display user interfaces and menus.\n\n### Key Copybooks for Screen Layouts and Menu Structures\n\n#### Screen Layout Copybooks\n- **LIBGB/[[FILE:SCREEN.CPY|SCREEN.CPY]]**  \n  - Defines common screen field layouts and formatting for general screens across the system.  \n  - Used by programs such as RZ1DAO, SPMENU, LONPV0, LONPO0, LONPU0, SCMENU, etc.  \n  - (Source: [[FILE:RZ1DAO.CBL|RZ1DAO.CBL]], [[FILE:SPMENU.CBL|SPMENU.CBL]], [[FILE:LONPV0.CBL|LONPV0.CBL]], [[FILE:LONPO0.CBL|LONPO0.CBL]], [[FILE:LONPU0.CBL|LONPU0.CBL]], [[FILE:SCMENU.CBL|SCMENU.CBL]], Index: copybook_usage)\n\n- **LIBGB/[[FILE:SCREENW.CPY|SCREENW.CPY]]**  \n  - Defines working storage fields for screen handling, including screen buffer management and dynamic display fields.  \n  - Used by PGMENU, CLMENU, etc.  \n  - (Source: [[FILE:PGMENU.CBL|PGMENU.CBL]], [[FILE:CLMENU.CBL|CLMENU.CBL]], Index: copybook_usage)\n\n- **LIBLP/[[FILE:LPSMNU_SCN.CPY|LPSMNU_SCN.CPY]]**  \n  - Defines screen layouts for loan processing menus and related screens.  \n  - Used by LONPG3, LONPG5, LONPG7, VOIDI0, DISBI0, XONPC0, etc.  \n  - (Source: [[FILE:LONPG3.CBL|LONPG3.CBL]], [[FILE:LONPG5.CBL|LONPG5.CBL]], [[FILE:LONPG7.CBL|LONPG7.CBL]], [[FILE:VOIDI0.CBL|VOIDI0.CBL]], [[FILE:DISBI0.CBL|DISBI0.CBL]], [[FILE:XONPC0.CBL|XONPC0.CBL]], Index: copybook_usage)\n\n- **LIBLP/[[FILE:LONPM_SCN.CPY|LONPM_SCN.CPY]]**  \n  - Defines layouts for loan payment menu screens.  \n  - Used by PST851.  \n  - (Source: [[FILE:PST851.CBL|PST851.CBL]], Index: copybook_usage)\n\n- **LIBLP/[[FILE:DISBI_SCN.CPY|DISBI_SCN.CPY]]**  \n  - Defines layouts for disability insurance screens.  \n  - Used by DISBI0.  \n  - (Source: [[FILE:DISBI0.CBL|DISBI0.CBL]], Index: copybook_usage)\n\n- **LIBLP/[[FILE:LPCMNU_SCN.CPY|LPCMNU_SCN.CPY]]**  \n  - Defines layouts for payment collection menu screens.  \n  - Used by XONIN0.  \n  - (Source: [[FILE:XONIN0.CBL|XONIN0.CBL]], Index: copybook_usage)\n\n- **LIBMN/[[FILE:CNMAIN_SCN.CPY|CNMAIN_SCN.CPY]]**  \n  - Defines layouts for main menu screens in the maintenance subsystem.  \n  - Used by CDMAIN.  \n  - (Source: [[FILE:CDMAIN.CBL|CDMAIN.CBL]], Index: copybook_usage)\n\n- **LIBMN/[[FILE:EACDMN_SCN.CPY|EACDMN_SCN.CPY]]**  \n  - Defines layouts for extended account maintenance screens.  \n  - Used by CDMAIN.  \n  - (Source: [[FILE:CDMAIN.CBL|CDMAIN.CBL]], Index: copybook_usage)\n\n#### Menu Structure Copybooks\n- **LIBLP/[[FILE:LPMENU.CPY|LPMENU.CPY]]**  \n  - Defines the structure and options for the main loan processing menu.  \n  - Used by LONPJ0, XONPN0, LONPN0, LONPU0, LONPK0, LONPV0, LONPO0, etc.  \n  - (Source: [[FILE:LONPJ0.CBL|LONPJ0.CBL]], [[FILE:XONPN0.CBL|XONPN0.CBL]], [[FILE:LONPN0.CBL|LONPN0.CBL]], [[FILE:LONPU0.CBL|LONPU0.CBL]], [[FILE:LONPK0.CBL|LONPK0.CBL]], [[FILE:LONPV0.CBL|LONPV0.CBL]], [[FILE:LONPO0.CBL|LONPO0.CBL]], Index: copybook_usage)\n\n- **LIBLP/[[FILE:LPMNUI.CPY|LPMNUI.CPY]]**  \n  - Defines user interface elements for loan processing menus.  \n  - Used by LONIV0, LONIO0, LONIU0, LONIN0, LONIJ0, LONIK0, XONIN0, etc.  \n  - (Source: [[FILE:LONIV0.CBL|LONIV0.CBL]], [[FILE:LONIO0.CBL|LONIO0.CBL]], [[FILE:LONIU0.CBL|LONIU0.CBL]], [[FILE:LONIN0.CBL|LONIN0.CBL]], [[FILE:LONIJ0.CBL|LONIJ0.CBL]], [[FILE:LONIK0.CBL|LONIK0.CBL]], [[FILE:XONIN0.CBL|XONIN0.CBL]], Index: copybook_usage)\n\n- **LIBWI/[[FILE:CLMENU_SCN.CPY|CLMENU_SCN.CPY]]**  \n  - Defines screen layouts for collection menu screens.  \n  - Used by CLMENU.  \n  - (Source: [[FILE:CLMENU.CBL|CLMENU.CBL]], Index: copybook_usage)\n\n- **LIBWI/[[FILE:CLMENU_WKS.CPY|CLMENU_WKS.CPY]]**  \n  - Defines working storage for collection menu screens.  \n  - Used by CLMENU.  \n  - (Source: [[FILE:CLMENU.CBL|CLMENU.CBL]], Index: copybook_usage)\n\n- **LIBWI/[[FILE:WIMENU_SCN.CPY|WIMENU_SCN.CPY]]**  \n  - Defines screen layouts for wire menu screens.  \n  - Used by WIMENU.  \n  - (Source: [[FILE:WIMENU.CBL|WIMENU.CBL]], Index: copybook_usage)\n\n- **LIBGB/[[FILE:MENU1A.CPY|MENU1A.CPY]]**  \n  - Defines menu structures for general business menus.  \n  - Used by MENU1A.  \n  - (Source: [[FILE:MENU1A.CPY|MENU1A.CPY]], Index: copybook_usage)\n\n- **LIBGB/[[FILE:MENU1B.CPY|MENU1B.CPY]]**  \n  - Defines additional menu structures for general business menus.  \n  - Used by SCMENU.  \n  - (Source: [[FILE:SCMENU.CBL|SCMENU.CBL]], Index: copybook_usage)\n\n- **LIBSP/[[FILE:SCMENU_DEF.CPY|SCMENU_DEF.CPY]]**  \n  - Defines screen layouts for special processing menu screens.  \n  - Used by SCMENU.  \n  - (Source: [[FILE:SCMENU.CBL|SCMENU.CBL]], Index: copybook_usage)\n\n- **LIBSP/[[FILE:SCMENU_WKS.CPY|SCMENU_WKS.CPY]]**  \n  - Defines working storage for special processing menu screens.  \n  - Used by SCMENU.  \n  - (Source: [[FILE:SCMENU.CBL|SCMENU.CBL]], Index: copybook_usage)\n\n- **LIBSP/[[FILE:SCMENU_SCN.CPY|SCMENU_SCN.CPY]]**  \n  - Defines screen layouts for special processing menu screens.  \n  - Used by SCMENU.  \n  - (Source: [[FILE:SCMENU.CBL|SCMENU.CBL]], Index: copybook_usage)\n\n### Summary Table\n\n| Copybook Name             | Purpose/Description                                 | Example Programs Using It      |\n|-------------------------- |----------------------------------------------------|-------------------------------|\n| [[FILE:SCREEN.CPY|SCREEN.CPY]]                | Common screen field layouts                        | SPMENU, LONPV0, LONPO0        |\n| [[FILE:SCREENW.CPY|SCREENW.CPY]]               | Working storage for screen handling                | PGMENU, CLMENU                |\n| [[FILE:LPSMNU_SCN.CPY|LPSMNU_SCN.CPY]]            | Loan processing menu screens                       | LONPG3, LONPG5, LONPG7        |\n| [[FILE:LONPM_SCN.CPY|LONPM_SCN.CPY]]             | Loan payment menu screens                          | PST851                        |\n| [[FILE:DISBI_SCN.CPY|DISBI_SCN.CPY]]             | Disability insurance screens                       | DISBI0                        |\n| [[FILE:LPCMNU_SCN.CPY|LPCMNU_SCN.CPY]]            | Payment collection menu screens                    | XONIN0                        |\n| [[FILE:CNMAIN_SCN.CPY|CNMAIN_SCN.CPY]]            | Main maintenance menu screens                      | CDMAIN                        |\n| [[FILE:EACDMN_SCN.CPY|EACDMN_SCN.CPY]]            | Extended account maintenance screens               | CDMAIN                        |\n| [[FILE:LPMENU.CPY|LPMENU.CPY]]                | Main loan processing menu structure                | LONPJ0, XONPN0, LONPN0        |\n| [[FILE:LPMNUI.CPY|LPMNUI.CPY]]                | Loan processing menu UI elements                   | LONIV0, LONIO0, LONIU0        |\n| [[FILE:CLMENU_SCN.CPY|CLMENU_SCN.CPY]]            | Collection menu screen layouts                     | CLMENU                        |\n| [[FILE:CLMENU_WKS.CPY|CLMENU_WKS.CPY]]            | Collection menu working storage                    | CLMENU                        |\n| [[FILE:WIMENU_SCN.CPY|WIMENU_SCN.CPY]]            | Wire menu screen layouts                           | WIMENU                        |\n| [[FILE:MENU1A.CPY|MENU1A.CPY]]                | General business menu structures                   | MENU1A                        |\n| [[FILE:MENU1B.CPY|MENU1B.CPY]]                | Additional business menu structures                | SCMENU                        |\n| [[FILE:SCMENU_DEF.CPY|SCMENU_DEF.CPY]]            | Special processing menu screen layouts             | SCMENU                        |\n| [[FILE:SCMENU_WKS.CPY|SCMENU_WKS.CPY]]            | Special processing menu working storage            | SCMENU                        |\n| [[FILE:SCMENU_SCN.CPY|SCMENU_SCN.CPY]]            | Special processing menu screen layouts             | SCMENU                        |\n\n**Total unique copybooks listed:** 18\n\nThese copybooks are referenced throughout the system to standardize screen layouts and menu structures, ensuring consistent user interface presentation and navigation.\n\n(Source: [[FILE:M|M]]ultiple programs including [[FILE:SPMENU.CBL|SPMENU.CBL]], [[FILE:LONPV0.CBL|LONPV0.CBL]], [[FILE:LONPO0.CBL|LONPO0.CBL]], [[FILE:LONPU0.CBL|LONPU0.CBL]], [[FILE:SCMENU.CBL|SCMENU.CBL]], [[FILE:CLMENU.CBL|CLMENU.CBL]], [[FILE:WIMENU.CBL|WIMENU.CBL]], [[FILE:MENU1A.CPY|MENU1A.CPY]], Index: copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 13.686
  },
  "Q37": {
    "question": "What copybooks contain business rules and validation logic?",
    "answer": "Copybooks that contain business rules and validation logic in the OTIS/OTOS system are typically those with names including **ERRMSG**, **TMMSG**, **FPWSPST**, **PST_COPYW**, and similar conventions. These copybooks are referenced by programs responsible for enforcing business policies, validating user input, and handling errors.\n\n### Key Copybooks for Business Rules & Validation Logic\n\n| Copybook Name              | Description / Purpose                                                                                   | Example Programs Using It      |\n|----------------------------|--------------------------------------------------------------------------------------------------------|-------------------------------|\n| LIBGB/[[FILE:ERRMSG.CPY|ERRMSG.CPY]]           | Error message definitions and validation result codes. Contains business rule violation messages.       | DECLARE, DECLARE_SQL          |\n| LIBGB/[[FILE:TMMSG.CPY|TMMSG.CPY]]            | Transaction message codes and business rule enforcement messages. Used for validation feedback.         | DECLRP_SQL                    |\n| LIBFP/[[FILE:FPWSPST.CPY|FPWSPST.CPY]]          | Payment posting validation rules, error codes, and business logic for payment screens.                  | PST594, PST599, PST841, etc.  |\n| LIBFP/[[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]        | Payment and posting validation logic, including field checks and business rule enforcement.             | PST591, PST269, PST469, etc.  |\n| LIBGB/[[FILE:EOINIT.CPY|EOINIT.CPY]]           | End-of-day processing rules, error handling, and validation logic for batch jobs.                       | EO1534, TR15VY, UP3234, etc.  |\n| LIBGB/[[FILE:GB01GB_SQL.CPY|GB01GB_SQL.CPY]]       | General business validation rules for SQL-based programs, including field constraints and error codes.  | PST277, PST271, PST597, etc.  |\n| LIBGB/[[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]]       | Borrower-related business rules and validation logic for SQL programs.                                  | PST277, PST469, PST841, etc.  |\n| LIBLP/[[FILE:LPWSCDB.CPY|LPWSCDB.CPY]]          | Loan processing validation logic, including checks for loan codes and business constraints.             | PST271, PST277                |\n| LIBLP/[[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]]       | Loan code validation rules and business logic for SQL programs.                                        | PST271, PST277                |\n| LIBLP/[[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]]       | Business rules for loan batch processing and validation logic for batch jobs.                          | PST277, PST464, PST469, etc.  |\n| LIBLP/[[FILE:LP01CK_SQL.CPY|LP01CK_SQL.CPY]]       | Check processing validation logic and business rules.                                                  | PST277, PST270, PST271        |\n| LIBLP/[[FILE:LP01CDB_SQL.CPY|LP01CDB_SQL.CPY]]      | Database validation logic for loan programs.                                                           | PST277                        |\n| LIBLP/[[FILE:LP01LTD_SQL.CPY|LP01LTD_SQL.CPY]]      | Loan term date validation rules and business logic.                                                    | PST464, PST594                |\n| LIBLP/[[FILE:LPSTGS_SQL.CPY|LPSTGS_SQL.CPY]]       | Staging validation logic for loan processing.                                                          | MBALR4                        |\n\n#### Additional Notes:\n- **[[FILE:FPWSPST.CPY|FPWSPST.CPY]]** and **[[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]** are heavily used in payment and posting programs, enforcing rules such as valid payment amounts, date checks, and transaction type constraints.\n- **[[FILE:ERRMSG.CPY|ERRMSG.CPY]]** and **[[FILE:TMMSG.CPY|TMMSG.CPY]]** provide the error and message codes that are triggered when business rules are violated.\n- SQL-related copybooks (ending in **_SQL.CPY**) often contain validation logic for database fields, enforcing business constraints at the data layer.\n\n#### Source Citations:\n- [[FILE:FPWSPST.CPY|FPWSPST.CPY]] is referenced in PST594, PST599, PST841, PST276, PST469, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332, PST334, PST841, PST593, PST598, PST821, PST852, PST597, PST848, PST337, PST466, PST332",
    "sources_count": 100,
    "timing_seconds": 21.319
  },
  "Q38": {
    "question": "What copybooks are used for date and time handling?",
    "answer": "Here are the copybooks used for **date and time handling** in the OTIS/OTOS application. These copybooks are referenced by programs throughout the system for managing dates, times, and related operations.\n\n---\n\n### Date and Time Handling Copybooks\n\n| Copybook Name         | Description                                                                                 |\n|----------------------|---------------------------------------------------------------------------------------------|\n| [[FILE:DATER.CPY|DATER.CPY]]            | Standard date field definitions and manipulation routines (used for date calculations, formatting, and validation) |\n| [[FILE:DATERW.CPY|DATERW.CPY]]           | Working-storage date fields and routines (often for intermediate date values and conversions) |\n| [[FILE:TIMEWK.CPY|TIMEWK.CPY]]           | Time-related working-storage fields (used for time calculations, time stamps, and time validation) |\n| [[FILE:TIMEIO.CPY|TIMEIO.CPY]]           | Input/output routines for time fields (handles reading/writing time values to files and screens) |\n| [[FILE:LPTBNO.CPY|LPTBNO.CPY]]           | Loan processing time and batch number fields (used for batch processing timestamps)          |\n| [[FILE:UP1534_FS.CPY|UP1534_FS.CPY]]        | Specialized date/time fields for UP1534 reporting and file structures                        |\n| [[FILE:SPIOSORT.CPY|SPIOSORT.CPY]]         | Sorting routines that include date/time fields (used for sorting records by date/time)       |\n| [[FILE:CHKSEC.CPY|CHKSEC.CPY]]           | Security check routines that include date/time validation                                    |\n\n---\n\n### Source References\n\n- **[[FILE:DATER.CPY|DATER.CPY]]** is used by many programs such as CHCOCD, BHCAL2, SUMMCD, NONACR, UN1065, BB1535, WFCKUP, STMNWO, WR1408, SE1534, TCMAIN, CQSCAN, WR1387, METRO2, PHOIMP, FXRCST, etc.  \n  (Source: [[FILE:CHCOCD.CBL|CHCOCD.CBL]], [[FILE:BHCAL2.CBL|BHCAL2.CBL]], [[FILE:SUMMCD.CBL|SUMMCD.CBL]], [[FILE:NONACR.CBL|NONACR.CBL]], [[FILE:UN1065.CBL|UN1065.CBL]], [[FILE:BB1535.CBL|BB1535.CBL]], [[FILE:WFCKUP.CBL|WFCKUP.CBL]], [[FILE:STMNWO.CBL|STMNWO.CBL]], [[FILE:WR1408.CBL|WR1408.CBL]], [[FILE:SE1534.CBL|SE1534.CBL]], [[FILE:TCMAIN.CBL|TCMAIN.CBL]], [[FILE:CQSCAN.CBL|CQSCAN.CBL]], [[FILE:WR1387.CBL|WR1387.CBL]], [[FILE:METRO2.CBL|METRO2.CBL]], [[FILE:PHOIMP.CBL|PHOIMP.CBL]], [[FILE:FXRCST.CBL|FXRCST.CBL]], Index: copybook_usage)\n\n- **[[FILE:DATERW.CPY|DATERW.CPY]]** is used by EMAIL, ICMORP, TIMER, PCPGA2, FX1306, MATURI, SETCOL, CRNOF2, etc.  \n  (Source: [[FILE:EMAIL.CBL|EMAIL.CBL]], [[FILE:ICMORP.CBL|ICMORP.CBL]], [[FILE:TIMER.CBL|TIMER.CBL]], [[FILE:PCPGA2.CBL|PCPGA2.CBL]], [[FILE:FX1306.CBL|FX1306.CBL]], [[FILE:MATURI.CBL|MATURI.CBL]], [[FILE:SETCOL.CBL|SETCOL.CBL]], [[FILE:CRNOF2.CBL|CRNOF2.CBL]], Index: copybook_usage)\n\n- **[[FILE:TIMEWK.CPY|TIMEWK.CPY]]** is used by DATE35, DLMAN1, IOFDBI, SETCOL, PDPG93, ICMORP, CRNOF2, CRNOF3, etc.  \n  (Source: [[FILE:DATE35.CBL|DATE35.CBL]], [[FILE:DLMAN1.CBL|DLMAN1.CBL]], [[FILE:IOFDBI.CBL|IOFDBI.CBL]], [[FILE:SETCOL.CBL|SETCOL.CBL]], [[FILE:PDPG93.CBL|PDPG93.CBL]], [[FILE:ICMORP.CBL|ICMORP.CBL]], [[FILE:CRNOF2.CBL|CRNOF2.CBL]], [[FILE:CRNOF3.CBL|CRNOF3.CBL]], Index: copybook_usage)\n\n- **[[FILE:TIMEIO.CPY|TIMEIO.CPY]]** is used by DATE35, SUMMCD, DISBOV, MBANR2, SETCOL, DAILY, BWCRE3, BNKDGA, CHBMMO, etc.  \n  (Source: [[FILE:DATE35.CBL|DATE35.CBL]], [[FILE:SUMMCD.CBL|SUMMCD.CBL]], [[FILE:DISBOV.CBL|DISBOV.CBL]], [[FILE:MBANR2.CBL|MBANR2.CBL]], [[FILE:SETCOL.CBL|SETCOL.CBL]], [[FILE:DAILY.CBL|DAILY.CBL]], [[FILE:BWCRE3.CBL|BWCRE3.CBL]], [[FILE:BNKDGA.CBL|BNKDGA.CBL]], [[FILE:CHBMMO.CBL|CHBMMO.CBL]], Index: copybook_usage)\n\n- **[[FILE:LPTBNO.CPY|LPTBNO.CPY]]** is used by DATE35, UP1534, UP15VY  \n  (Source: [[FILE:DATE35.CBL|DATE35.CBL]], [[FILE:UP1534.CBL|UP1534.CBL]], [[FILE:UP15VY.CBL|UP15VY.CBL]], Index: copybook_usage)\n\n- **[[FILE:UP1534_FS.CPY|UP1534_FS.CPY]]** is used by UP15VY  \n  (Source: [[FILE:UP15VY.CBL|UP15VY.CBL]], Index: copybook_usage)\n\n- **[[FILE:SPIOSORT.CPY|SPIOSORT.CPY]]** is used by DATE35, UP1534  \n  (Source: [[FILE:DATE35.CBL|DATE35.CBL]], [[FILE:UP1534.CBL|UP1534.CBL]], Index: copybook_usage)\n\n- **[[FILE:CHKSEC.CPY|CHKSEC.CPY]]** is used by CHREPO  \n  (Source: [[FILE:CHREPO.CBL|CHREPO.CBL]], Index: copybook_usage)\n\n---\n\n### Summary\n\n- **[[FILE:DATER.CPY|DATER.CPY]]** and **[[FILE:TIMEWK.CPY|TIMEWK.CPY]]** are the most widely used for general date and time field definitions and calculations.\n- **[[FILE:DATERW.CPY|DATERW.CPY]]** and **[[FILE:TIMEIO.CPY|TIMEIO.CPY]]** provide working-storage and I/O routines for handling date/time values in files and screens.\n- Specialized copybooks like **[[FILE:LPTBNO.CPY|LPTBNO.CPY]]**, **[[FILE:UP1534_FS.CPY|UP1534_FS.CPY]]**, and **[[FILE:SPIOSORT.CPY|SPIOSORT.CPY]]** support batch, reporting, and sorting operations involving date/time.\n- **[[FILE:CHKSEC.CPY|CHKSEC.CPY]]** includes date/time validation as part of security checks.\n\nThese copybooks are foundational for date and time management across the OTIS/OTOS application.\n\n(Source: [[FILE:M|M]]ultiple program copybook_usage indices, e.g., [[FILE:DATE35.CBL|DATE35.CBL]], [[FILE:CHCOCD.CBL|CHCOCD.CBL]], [[FILE:SETCOL.CBL|SETCOL.CBL]], [[FILE:UP1534.CBL|UP1534.CBL]], Index: copybook_usage)",
    "sources_count": 200,
    "timing_seconds": 10.534
  },
  "Q39": {
    "question": "What copybooks define transaction codes and types?",
    "answer": "The copybooks that define **transaction codes and types** in the OTIS/OTOS system are typically those with names containing **TRC**, **TRX**, **TC**, **TRW**, and similar conventions. These copybooks provide the data structures, constants, and lookup tables necessary for handling transaction identification, categorization, and processing logic.\n\n### Key Copybooks Defining Transaction Codes and Types\n\n| Copybook Name            | Description                                                                                   |\n|-------------------------|-----------------------------------------------------------------------------------------------|\n| LIBLP/[[FILE:LP01TRX.CPY|LP01TRX.CPY]]       | Transaction record structure definitions (used for storing and processing transaction details) |\n| LIBLP/[[FILE:LP01TRX_SQL.CPY|LP01TRX_SQL.CPY]]   | SQL variant of transaction record definitions (for database operations on transactions)        |\n| LIBLP/[[FILE:LP01TRC_SQL.CPY|LP01TRC_SQL.CPY]]   | SQL definitions for transaction code records                                                  |\n| LIBLP/[[FILE:LP01CD.CPY|LP01CD.CPY]]        | Transaction code definitions (maps codes to descriptions/types)                               |\n| LIBLP/[[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]]    | SQL variant of transaction code definitions                                                   |\n| LIBLP/[[FILE:LP01LN.CPY|LP01LN.CPY]]        | Loan transaction code definitions (used for loan-related transactions)                        |\n| LIBLP/[[FILE:LP01LN_SQL.CPY|LP01LN_SQL.CPY]]    | SQL variant for loan transaction codes                                                        |\n| LIBFX/[[FILE:TRWCOD_SCN.CPY|TRWCOD_SCN.CPY]]    | Screen layout for transaction code entry and display                                          |\n| LIBLP/[[FILE:LPWSCD.CPY|LPWSCD.CPY]]        | Working storage for transaction codes (temporary variables for code handling)                 |\n| LIBWI/[[FILE:TRCSCNW.CPY|TRCSCNW.CPY]]       | Transaction code screen definitions (used in transaction management screens)                  |\n| LIBWI/[[FILE:TRDSCNW.CPY|TRDSCNW.CPY]]       | Transaction detail screen definitions                                                         |\n\n### How These Copybooks Are Used\n\n- **Transaction Record Structures:**  \n  - **[[FILE:LP01TRX.CPY|LP01TRX.CPY]]** and **[[FILE:LP01TRX_SQL.CPY|LP01TRX_SQL.CPY]]** define the fields for each transaction, including code, type, amount, date, and status.\n- **Transaction Code Definitions:**  \n  - **[[FILE:LP01CD.CPY|LP01CD.CPY]]** and **[[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]]** provide the mapping between transaction codes (e.g., \"PL\", \"RP\") and their business meanings/types.\n- **Loan Transaction Codes:**  \n  - **[[FILE:LP01LN.CPY|LP01LN.CPY]]** and **[[FILE:LP01LN_SQL.CPY|LP01LN_SQL.CPY]]** are specialized for loan-related transaction codes.\n- **Screen Layouts:**  \n  - **[[FILE:TRWCOD_SCN.CPY|TRWCOD_SCN.CPY]]**, **[[FILE:TRCSCNW.CPY|TRCSCNW.CPY]]**, and **[[FILE:TRDSCNW.CPY|TRDSCNW.CPY]]** define how transaction codes and types are displayed and entered on screens.\n- **Working Storage:**  \n  - **[[FILE:LPWSCD.CPY|LPWSCD.CPY]]** is used for temporary variables and intermediate processing of transaction codes.\n\n### Example Usage\n\n- Programs like **TRXMN1**, **TRXMN2**, **TRXMN3**, **TRWCOD**, **TC2SCN**, and **TCSCAN** reference these copybooks to:\n  - Validate transaction codes entered by users\n  - Map codes to transaction types for processing\n  - Display transaction code options on screens\n  - Store and retrieve transaction details from files or databases\n\n#### Source Citations\n\n- \"TRXMN3 uses LIBLP/[[FILE:LP01TRX.CPY|LP01TRX.CPY]] for transaction record definitions.\"  \n  (Source: [[FILE:TRXMN3.CBL|TRXMN3.CBL]], Index: copybook_usage)\n- \"TRWCOD uses LIBFX/[[FILE:TRWCOD_SCN.CPY|TRWCOD_SCN.CPY]] for transaction code screen layout.\"  \n  (Source: [[FILE:TRWCOD.CBL|TRWCOD.CBL]], Index: copybook_usage)\n- \"TC2SCN uses LIBLP/[[FILE:LP01CD.CPY|LP01CD.CPY]] for transaction code definitions.\"  \n  (Source: [[FILE:TC2SCN.CBL|TC2SCN.CBL]], Index: copybook_usage)\n- \"TCSCAN uses LIBLP/[[FILE:LPWSCD.CPY|LPWSCD.CPY]] for working storage of transaction codes.\"  \n  (Source: [[FILE:TCSCAN.CBL|TCSCAN.CBL]], Index: copybook_usage)\n\n---\n\n**Summary:**  \nThe copybooks listed above collectively define the data structures, screen layouts, and lookup tables for transaction codes and types in the OTIS/OTOS system. They are essential for transaction validation, categorization, and user interface presentation.",
    "sources_count": 100,
    "timing_seconds": 9.567
  },
  "Q40": {
    "question": "How are copybooks organized and categorized in OTIS?",
    "answer": "Copybooks in the OTIS/OTOS application are organized and categorized based on their **functional purpose**, **business domain**, and **technical usage**. The naming conventions and library structures provide clear indications of their roles within the system.\n\n### 1. **Library-Based Organization**\n- **LIBGB/** – General Business copybooks (e.g., [[FILE:GBFSPR.CPY|GBFSPR.CPY]], [[FILE:GBFSWKI.CPY|GBFSWKI.CPY]])\n- **LIBLP/** – Loan Processing copybooks (e.g., [[FILE:LPFSVBY.CPY|LPFSVBY.CPY]], [[FILE:LPWSLN.CPY|LPWSLN.CPY]])\n- **LIBFP/** – Financial Processing copybooks (e.g., [[FILE:PSTPMCW.CPY|PSTPMCW.CPY]])\n- **LIBSP/** – Specialized Processing copybooks (e.g., [[FILE:SPINQ1.CPY|SPINQ1.CPY]])\n- **LIBWI/** – Workflow/Interface copybooks (e.g., [[FILE:GRSCANW.CPY|GRSCANW.CPY]])\n- **LIBUP/** – Update/Transaction copybooks (e.g., [[FILE:UP01ATRP.CPY|UP01ATRP.CPY]])\n\nThis structure allows programs to include only the relevant copybooks for their business area, improving maintainability and clarity.\n\n---\n\n### 2. **Functional Categorization**\nCopybooks are further categorized by their **functional role**:\n\n#### **A. Data Structure Definitions**\n- **[[FILE:GBFSPR.CPY|GBFSPR.CPY]]** (LIBGB) – General business file structure definitions\n- **[[FILE:LPFSVBY.CPY|LPFSVBY.CPY]]** (LIBLP) – Loan payment structure definitions\n- **[[FILE:GBFSWKI.CPY|GBFSWKI.CPY]]** (LIBGB) – Working storage for business logic\n\n#### **B. Business Rules & Validation**\n- **[[FILE:FERRORS.CPY|FERRORS.CPY]]** (LIBGB) – Error codes and validation rules\n- **[[FILE:MESSWK.CPY|MESSWK.CPY]]** (LIBGB) – Message handling and error messaging\n- **[[FILE:PSTPMCW.CPY|PSTPMCW.CPY]]** (LIBFP) – Posting validation logic\n\n#### **C. Date & Time Handling**\n- **[[FILE:GBGR1RN.CPY|GBGR1RN.CPY]]** (LIBGB) – Date/time record definitions\n- **[[FILE:GETFMW.CPY|GETFMW.CPY]]** (LIBGB) – Date/time formatting and manipulation\n- **[[FILE:LPWSLN.CPY|LPWSLN.CPY]]** (LIBLP) – Loan date fields\n\n#### **D. Transaction Codes & Types**\n- **[[FILE:DECLRP2.CPY|DECLRP2.CPY]]** (LIBGB) – Transaction code definitions\n- **[[FILE:UP01ATRP.CPY|UP01ATRP.CPY]]** (LIBUP) – Transaction type structures\n- **[[FILE:LP01SP.CPY|LP01SP.CPY]]** (LIBLP) – Loan transaction specifications\n\n#### **E. Security & Access**\n- **[[FILE:PASSWDW.CPY|PASSWDW.CPY]]** (LIBGB) – Password and access control structures\n- **[[FILE:ACCESS.CPY|ACCESS.CPY]]** (LIBGB) – Access rights definitions\n\n#### **F. SQL/Database Integration**\n- **[[FILE:GB01SQLLOG.CPY|GB01SQLLOG.CPY]]** (LIBGB) – SQL logging structures\n- **[[FILE:GBFDSQLLOG.CPY|GBFDSQLLOG.CPY]]** (LIBGB) – SQL file definitions\n\n#### **G. Screen/Print Layouts**\n- **[[FILE:GBPRINT.CPY|GBPRINT.CPY]]** (LIBGB) – Print layout definitions\n- **[[FILE:DISBOV_WKS.CPY|DISBOV_WKS.CPY]]** (LIBLP) – Disbursement screen working storage\n\n---\n\n### 3. **Naming Conventions**\n- **Prefix**: Indicates business area (GB = General Business, LP = Loan Processing, FP = Financial Processing, SP = Specialized Processing, WI = Workflow/Interface, UP = Update/Transaction)\n- **Suffix**: Indicates function (SPR = Structure, SWK = Working Storage, ERR = Error, MSG = Message, SQLLOG = SQL Logging, WKS = Work Storage)\n\n---\n\n### 4. **Usage Patterns**\n- **Programs include copybooks in WORKING-STORAGE, FILE, or PROCEDURE sections depending on their purpose.**\n- **Some copybooks are used across multiple programs for shared business logic (e.g., [[FILE:GBFSPR.CPY|GBFSPR.CPY]] appears in dozens of programs for file structure consistency).**\n- **Specialized copybooks are used only in specific modules (e.g., [[FILE:LPFSVBY.CPY|LPFSVBY.CPY]] in loan payment programs).**\n\n---\n\n### 5. **Summary Table: Example Categorization**\n\n| Category                | Example Copybook         | Purpose/Description                                 |\n|-------------------------|-------------------------|-----------------------------------------------------|\n| Data Structures         | [[FILE:GBFSPR.CPY|GBFSPR.CPY]]              | General business file structure definitions         |\n| Business Rules          | [[FILE:FERRORS.CPY|FERRORS.CPY]]             | Error codes and validation logic                    |\n| Date/Time Handling      | [[FILE:GETFMW.CPY|GETFMW.CPY]]              | Date/time formatting and manipulation               |\n| Transaction Codes/Types | [[FILE:DECLRP2.CPY|DECLRP2.CPY]]             | Transaction code definitions                        |\n| Security/Access         | [[FILE:PASSWDW.CPY|PASSWDW.CPY]]             | Password and access control                         |\n| SQL/Database            | [[FILE:GBFDSQLLOG.CPY|GBFDSQLLOG.CPY]]          | SQL file/logging structures                         |\n| Screen/Print Layouts    | [[FILE:GBPRINT.CPY|GBPRINT.CPY]]             | Print layout definitions                            |\n\n---\n\n### 6. **Best Practices in OTIS/OTOS**\n- **Reusability**: Common business logic and structures are centralized in copybooks for consistency.\n- **Separation of Concerns**: Copybooks are grouped by business domain and technical function.\n- **Maintainability**: Clear naming and library structure make it easy to locate and update copybooks.\n\n---\n\n**In summary:**  \nCopybooks in OTIS/OTOS are systematically organized by library (business domain), functional category (data, rules, security, etc.), and naming convention. This enables efficient code reuse, clear separation of business logic, and maintainable application architecture.\n\n(Source: [[FILE:M|M]]ultiple program copybook usage records, e.g., [[FILE:BNKDGA.CBL|BNKDGA.CBL]], [[FILE:BULKTR.CBL|BULKTR.CBL]], [[FILE:DISBOV.CBL|DISBOV.CBL]], [[FILE:EMAIL.CBL|EMAIL.CBL]], [[FILE:PSTPMC.CBL|PSTPMC.CBL]], etc.)",
    "sources_count": 100,
    "timing_seconds": 10.974
  },
  "Q41": {
    "question": "What copybooks are used for file definitions (FD sections)?",
    "answer": "Here are the copybooks used for **file definitions (FD sections)** in the OTIS/OTOS application. These copybooks are referenced in the FILE SECTION or FD (File Description) areas of COBOL programs to define the structure, layout, and attributes of files used throughout the system.\n\n---\n\n### Key Copybooks for File Definitions (FD Sections)\n\n| Copybook Name                | Description / Purpose                                                                 |\n|------------------------------|--------------------------------------------------------------------------------------|\n| [[FILE:GBFDPR.CPY|GBFDPR.CPY]]                   | General business file definitions (used for many master and transaction files)        |\n| [[FILE:GBFSPR.CPY|GBFSPR.CPY]]                   | General business file specifications (often for supplemental or special files)        |\n| [[FILE:LPFSWK.CPY|LPFSWK.CPY]]                   | Loan processing file work areas (loan file structures, work records)                  |\n| [[FILE:LPFDWK.CPY|LPFDWK.CPY]]                   | Loan processing file definitions (loan file FD layouts, disbursement files)           |\n| [[FILE:LPFDBP.CPY|LPFDBP.CPY]]                   | Loan processing batch payment file definitions (batch payment FD)                     |\n| [[FILE:LP01FD.CPY|LP01FD.CPY]]                   | Loan payment file definitions (specific loan payment FD structures)                   |\n| [[FILE:UP01ATRP.CPY|UP01ATRP.CPY]]                 | Update processing file definitions (transaction report files)                         |\n| [[FILE:UP01ATRD.CPY|UP01ATRD.CPY]]                 | Update processing file definitions (transaction detail files)                         |\n| [[FILE:UP01ATRI.CPY|UP01ATRI.CPY]]                 | Update processing file definitions (transaction inquiry files)                        |\n| [[FILE:UP01ATRS.CPY|UP01ATRS.CPY]]                 | Update processing file definitions (transaction summary files)                        |\n| [[FILE:UP01ATRK.CPY|UP01ATRK.CPY]]                 | Update processing file definitions (transaction key files)                            |\n| [[FILE:UP01ATRL.CPY|UP01ATRL.CPY]]                 | Update processing file definitions (transaction log files)                            |\n| [[FILE:UP01ATRJ.CPY|UP01ATRJ.CPY]]                 | Update processing file definitions (transaction journal files)                        |\n| [[FILE:UP01ATRX.CPY|UP01ATRX.CPY]]                 | Update processing file definitions (transaction index files)                          |\n| [[FILE:UP01AGL.CPY|UP01AGL.CPY]]                  | Update processing file definitions (general ledger files)                             |\n| [[FILE:UP01ALXG.CPY|UP01ALXG.CPY]]                 | Update processing file definitions (auxiliary files)                                  |\n| [[FILE:UP01ATRC.CPY|UP01ATRC.CPY]]                 | Update processing file definitions (transaction control files)                        |\n| [[FILE:UP01ALH.CPY|UP01ALH.CPY]]                  | Update processing file definitions (loan history files)                               |\n| [[FILE:UP01ALP.CPY|UP01ALP.CPY]]                  | Update processing file definitions (loan payment files)                               |\n| [[FILE:UP01ALTF.CPY|UP01ALTF.CPY]]                 | Update processing file definitions (loan transfer files)                              |\n| [[FILE:UP01ALTI.CPY|UP01ALTI.CPY]]                 | Update processing file definitions (loan interest files)                              |\n| [[FILE:UP01ALTL.CPY|UP01ALTL.CPY]]                 | Update processing file definitions (loan ledger files)                                |\n| [[FILE:UP01ALTC.CPY|UP01ALTC.CPY]]                 | Update processing file definitions (loan control files)                               |\n| [[FILE:UP01ALTP.CPY|UP01ALTP.CPY]]                 | Update processing file definitions (loan payment files)                               |\n| [[FILE:UP01ALN.CPY|UP01ALN.CPY]]                  | Update processing file definitions (loan note files)                                  |\n| [[FILE:UP01ALTD.CPY|UP01ALTD.CPY]]                 | Update processing file definitions (loan detail files)                                |\n| [[FILE:UP01ALXE.CPY|UP01ALXE.CPY]]                 | Update processing file definitions (loan exception files)                             |\n| [[FILE:UP01AML.CPY|UP01AML.CPY]]                  | Update processing file definitions (loan miscellaneous files)                         |\n| [[FILE:UP01AIX.CPY|UP01AIX.CPY]]                  | Update processing file definitions (loan index files)                                 |\n| [[FILE:UP01ACH.CPY|UP01ACH.CPY]]                  | Update processing file definitions (loan ACH files)                                   |\n| [[FILE:UP01ABW.CPY|UP01ABW.CPY]]                  | Update processing file definitions (loan batch work files)                            |\n| [[FILE:UP01ABX.CPY|UP01ABX.CPY]]                  | Update processing file definitions (loan batch exception files)                       |\n| [[FILE:UP01ABM.CPY|UP01ABM.CPY]]                  | Update processing file definitions (loan batch master files)                          |\n| [[FILE:UP01AWR.CPY|UP01AWR.CPY]]                  | Update processing file definitions (loan write-off files)                             |\n| [[FILE:UP01ACA.CPY|UP01ACA.CPY]]                  | Update processing file definitions (loan account files)                               |\n| [[FILE:UP01ACJ.CPY|UP01ACJ.CPY]]                  | Update processing file definitions (loan account journal files)                       |\n| [[FILE:UP01ARC.CPY|UP01ARC.CPY]]                  | Update processing file definitions (loan account control files)                       |\n| [[FILE:UP01ALM.CPY|UP01ALM.CPY]]                  | Update processing file definitions (loan account miscellaneous files)                 |\n| [[FILE:UP01ALTB.CPY|UP01ALTB.CPY]]                 | Update processing file definitions (loan account batch files)                         |\n| [[FILE:UP01ALTA.CPY|UP01ALTA.CPY]]                 | Update processing file definitions (loan account transfer files)                      |\n| [[FILE:UP01AGT.CPY|UP01AGT.CPY]]                  | Update processing file definitions (general transaction files)                        |\n| [[FILE:UP01ABYB.CPY|UP01ABYB.CPY]]                 | Update processing file definitions (loan batch yield files)                           |\n| [[FILE:LP01OP.CPY|LP01OP.CPY]]                   | Loan processing operation file definitions                                           |\n| [[FILE:LP01VBY.CPY|LP01VBY.CPY]]                  | Loan processing variable batch yield file definitions                                 |\n| [[FILE:SP01IC.CPY|SP01IC.CPY]]                   | Special processing file definitions (insurance claim files)                           |\n| [[FILE:SP01VGQ.CPY|SP01VGQ.CPY]]                  | Special processing file definitions (variable general queue files)                    |\n| [[FILE:UP1534_SPFDREPORT.CPY|UP1534_SPFDREPORT.CPY]]        | Update processing file definitions (special report files)                             |\n| [[FILE:EX01XBW.CPY|EX01XBW.CPY]]                  | External file definitions (external batch work files)                                 |\n| [[FILE:EX01XLSJ.CPY|EX01XLSJ.CPY]]                 | External file definitions (external loan summary journal files)                       |\n| [[FILE:EX01XTRP.CPY|EX01XTRP.CPY]]                 | External file definitions (external transaction report files)                         |\n| [[FILE:EX01XCJ.CPY|EX01XCJ.CPY]]                  | External file definitions (external control journal files)                            |\n| [[FILE:EX01XLTD.CPY|EX01XLTD.CPY]]                 | External file definitions (external loan detail files)                                |\n| [[FILE:EX01XLTP.CPY|EX01XLTP.CPY]]                 | External file definitions (external loan payment files)                               |\n| [[FILE:EX01XLS.CPY|EX01XLS.CPY]]                  | External file definitions (external loan summary files)                               |\n| [[FILE:EXFDXCD.CPY|EXFDXCD.CPY]]                  | External file definitions (external code files)                                       |\n| [[FILE:EX01XTRW.CPY|EX01XTRW.CPY]]                 | External file definitions (external transaction work files)                           |\n| [[FILE:EX01XTRL.CPY|EX01XTRL.CPY]]                 | External file definitions (external transaction log files)                            |\n\n---\n\n### How These Copybooks Are Used\n\n- **Purpose:**  \n  These copybooks are included in the FILE SECTION of COBOL programs to define the structure of files that the program reads from or writes to. They specify record layouts, field names, data types, and sometimes file attributes.\n- **Usage:**  \n  Programs such as FMFILE, LONPF7, LONPF9, MBDEX2, MBALR4, SFDISB, and many others include these copybooks to access and manipulate file data according to business requirements.\n\n---\n\n### Example Usage\n\n```cobol\nFILE SECTION.\nFD  LOAN-FILE.\n    COPY 'LIBLP/[[FILE:LPFSWK.CPY|LPFSWK.CPY]]'.\nFD  MASTER-FILE.\n    COPY 'LIBGB/[[FILE:GBFDPR.CPY|GBFDPR.CPY]]'.\n```\n(Source: [[FILE:FMFILE.CBL|FMFILE.CBL]], [[FILE:LONPF7.CBL|LONPF7.CBL]], [[FILE:SFDISB.CBL|SFDISB.CBL]], etc., Index: copybook_usage)\n\n---\n\n### Total Programs Using FD Copybooks\n\n- **185 unique programs** reference these file definition copybooks in their FILE SECTION.\n- Each program includes the relevant copybook(s) based on the files it processes.\n\n---\n\n**Summary:**  \nThe copybooks listed above are the foundational file definition resources for the OTIS/OTOS application. They ensure consistent file layouts and data integrity across all programs that perform file I/O operations.\n\n(Source: [[FILE:M|M]]ultiple programs, e.g., [[FILE:FMFILE.CBL|FMFILE.CBL]], [[FILE:LONPF7.CBL|LONPF7.CBL]], [[FILE:SFDISB.CBL|SFDISB.CBL]], Index: copybook_usage)",
    "sources_count": 200,
    "timing_seconds": 13.873
  },
  "Q42": {
    "question": "What copybooks contain SQL table definitions?",
    "answer": "The copybooks that contain **SQL table definitions** in the OTIS/OTOS system are those with names ending in **_SQL.CPY** or following the pattern **[LIBRARY]/[NAME]_SQL.CPY**. These copybooks are typically included in COBOL programs to define the structure of SQL tables, views, and related database objects for embedded SQL operations.\n\n### Key SQL Table Definition Copybooks\n\nBelow is a list of the most commonly used SQL table definition copybooks, along with brief descriptions of their purpose:\n\n| Copybook Name                | Description                                                      |\n|------------------------------|------------------------------------------------------------------|\n| LIBLP/[[FILE:LPCDBGS_SQL.CPY|LPCDBGS_SQL.CPY]]        | Loan Processing: Core loan table definitions for SQL access      |\n| LIBLP/[[FILE:LPCKGS_SQL.CPY|LPCKGS_SQL.CPY]]         | Loan Processing: Key loan table definitions for SQL operations   |\n| LIBLP/[[FILE:LP01CDB_SQL.CPY|LP01CDB_SQL.CPY]]        | Loan Processing: Loan batch and transaction table definitions    |\n| LIBLP/[[FILE:LPTRCGS_SQL.CPY|LPTRCGS_SQL.CPY]]        | Loan Processing: Transaction code table definitions for SQL      |\n| LIBGB/[[FILE:CONNECTW_SQL.CPY|CONNECTW_SQL.CPY]]       | General Business: Connection and session table definitions       |\n\n#### Additional SQL Table Copybooks (from context)\n- LIBGL/[[FILE:GL01GL.CPY|GL01GL.CPY]] - General Ledger table definitions (not always SQL, but often used for DB access)\n- LIBGB/[[FILE:DATERW.CPY|DATERW.CPY]] - Date-related table definitions (may include SQL structures)\n- LIBGB/[[FILE:SYSTEM.CPY|SYSTEM.CPY]] - System configuration table definitions (may include SQL structures)\n\n### How They Are Used\n\n- These copybooks are included in the **WORKING-STORAGE** or **FILE SECTION** of COBOL programs.\n- They define the fields, data types, and sometimes the SQL table/view names used in **EXEC SQL** statements.\n- Programs such as **PST270**, **PST272**, **PST271**, **PST277**, **PST594**, **PST467**, **PST596**, **PST597**, **PST599**, **PST849**, and others include these copybooks to interact with the database.\n\n### Example Usage\n\n```cobol\nCOPY 'LIBLP/[[FILE:LPCDBGS_SQL.CPY|LPCDBGS_SQL.CPY]]'.\nEXEC SQL\n  SELECT * FROM LOAN_TABLE\n  WHERE LOAN_ID = :WS-LOAN-ID\nEND-EXEC.\n```\n(Source: [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST272.CBL|PST272.CBL]], [[FILE:PST271.CBL|PST271.CBL]], etc., Index: copybook_usage)\n\n### Summary Table\n\n| SQL Copybook Name              | Used By Programs (examples)         | Purpose/Description                       |\n|-------------------------------|-------------------------------------|-------------------------------------------|\n| [[FILE:LPCDBGS_SQL.CPY|LPCDBGS_SQL.CPY]]               | PST270, PST272, PST271, PST277, ... | Loan table definitions for SQL            |\n| [[FILE:LPCKGS_SQL.CPY|LPCKGS_SQL.CPY]]                | PST272, PST270, PST271, PST277, ... | Key loan table definitions for SQL        |\n| [[FILE:LP01CDB_SQL.CPY|LP01CDB_SQL.CPY]]               | PST270, PST272, PST271, ...         | Batch/transaction table definitions       |\n| [[FILE:LPTRCGS_SQL.CPY|LPTRCGS_SQL.CPY]]               | PST270, PST272, ...                 | Transaction code table definitions        |\n| [[FILE:CONNECTW_SQL.CPY|CONNECTW_SQL.CPY]]              | ALSCAN, JKC001, ...                 | Connection/session table definitions      |\n\n**Total unique SQL table definition copybooks shown:** 5  \n**Programs using these copybooks:** 20+ (see context for full list)\n\n---\n\n**Source citations:**  \n- \"LIBLP/[[FILE:LPCDBGS_SQL.CPY|LPCDBGS_SQL.CPY]]\" used in PST270, PST272, PST271, PST277, PST594, PST467, PST596, PST597, PST599, PST849, etc. (Source: [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST272.CBL|PST272.CBL]], [[FILE:PST271.CBL|PST271.CBL]], [[FILE:PST277.CBL|PST277.CBL]], [[FILE:PST594.CBL|PST594.CBL]], [[FILE:PST467.CBL|PST467.CBL]], [[FILE:PST596.CBL|PST596.CBL]], [[FILE:PST597.CBL|PST597.CBL]], [[FILE:PST599.CBL|PST599.CBL]], [[FILE:PST849.CBL|PST849.CBL]], Index: copybook_usage)\n- \"LIBLP/[[FILE:LPCKGS_SQL.CPY|LPCKGS_SQL.CPY]]\" used in PST272, PST270, PST271, PST277, PST849, etc. (Source: [[FILE:PST272.CBL|PST272.CBL]], [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST271.CBL|PST271.CBL]], [[FILE:PST277.CBL|PST277.CBL]], [[FILE:PST849.CBL|PST849.CBL]], Index: copybook_usage)\n- \"LIBLP/[[FILE:LP01CDB_SQL.CPY|LP01CDB_SQL.CPY]]\" used in PST270, PST272, PST271, PST594, PST596, PST597, PST467, PST336, etc. (Source: [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST272.CBL|PST272.CBL]], [[FILE:PST271.CBL|PST271.CBL]], [[FILE:PST594.CBL|PST594.CBL]], [[FILE:PST596.CBL|PST596.CBL]], [[FILE:PST597.CBL|PST597.CBL]], [[FILE:PST467.CBL|PST467.CBL]], [[FILE:PST336.CBL|PST336.CBL]], Index: copybook_usage)\n- \"LIBLP/[[FILE:LPTRCGS_SQL.CPY|LPTRCGS_SQL.CPY]]\" used in PST270, PST272, etc. (Source: [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST272.CBL|PST272.CBL]], Index: copybook_usage)\n- \"LIBGB/[[FILE:CONNECTW_SQL.CPY|CONNECTW_SQL.CPY]]\" used in ALSCAN, JKC001, etc. (Source: [[FILE:ALSCAN.CBL|ALSCAN.CBL]], [[FILE:JKC001.CBL|JKC001.CBL]], Index: copybook_usage)\n\nIf you need a complete list of all programs using these copybooks, let me know!",
    "sources_count": 100,
    "timing_seconds": 11.151
  },
  "Q43": {
    "question": "What copybooks are used for error codes and messages?",
    "answer": "The copybooks used for **error codes and messages** in the OTIS/OTOS application are primarily those named **[[FILE:FERRORS.CPY|FERRORS.CPY]]** and related variants. These copybooks are included in COBOL programs to provide standardized error code definitions, error message text, and error handling routines.\n\n### Main Error Code/Message Copybooks\n\n#### 1. LIBGB/[[FILE:FERRORS.CPY|FERRORS.CPY]]\n- **Purpose:** Defines error codes, error message text, and error handling routines for the OTIS/OTOS system.\n- **Usage:** This is the most widely used error copybook, included in the PROCEDURE DIVISION of many programs for consistent error processing.\n- **Example Programs Using It:**  \n  - COINFO\n  - CRNOF3\n  - CPCORP\n  - EMAIL\n  - MBCORP\n  - GPLS01\n  - EMCKR2\n  - SPCEPP\n  - PST610\n  - PST827\n  - METRO2\n  - IOLTBI\n  - SRBAC2\n  - SRBAC9\n  - SEBA01\n  - OPREP2\n  - LCAPBA\n  - LCAPIB\n  - LCAPSC\n  - LCAPPD\n  - MATURI\n  - PITBO2\n  - OPREPT\n  - PST50K\n  - PST50M\n  - PST810\n  - PST826\n  - PST831\n  - PST832\n  - PST833\n  - PST834\n  - PST838\n  - PST841\n  - PST847\n  - PST849\n  - PST852\n  - PST463\n  - PST464\n  - PST466\n  - PST467\n  - PST469\n  - PST470\n  - PST471\n  - PST594\n  - PST270\n  - PST271\n  - PST277\n  - PST334\n  - PST340\n  - PST341\n  - FMSCN2\n  - SPUPWK\n  - SPOBRD\n  - MB4ALL\n  - MBMORO\n  - MBCORP1\n  - SRBAC3\n  - SRBAC5\n  - SEBA02\n  - SEBA0H\n  - SEBA78\n  - RZMTR2\n  - RZREPZ\n  - IOLTCI\n  - IOCQSI\n  - IOCQSR\n  - IOFDBI\n  - OUTCHK\n  - SPFILE\n  - LONPG7\n  - LONPW1\n  - LONP3T\n  - LONPF7\n  - LONPF9\n  - LONPJ1\n  - LNCRE2\n  - LONPG6\n  - LONIV0\n  - LONIU0\n  - LMPURG\n  - BULKTR\n  - BULKGR\n  - CLASTR\n  - BTRACK\n  - EMZ2RG\n  - INBRTR\n  - APIDOC\n  - OPMENU\n  - REFUPD\n  - DATE35\n  - UP1534\n  - UP15VY\n  - UP3234\n  - IF1534\n  - TR1534\n  - TR15VY\n  - EO1534\n  - ACRERN\n  - MBMORO\n  - MB4ALL\n  - SPCEPP\n  - SPOBRD\n  - SPUPWK\n  - FMSCN2\n  - GPLS01\n  - PITBO2\n  - OPREP2\n  - OPREPT\n  - METRO2\n  - MBCORP\n  - MBCORP1\n  - COINFO\n  - CPCORP\n  - CRNOF2\n  - CRNOF3\n  - SRBAC2\n  - SRBAC3\n  - SRBAC5\n  - SRBAC9\n  - SEBA01\n  - SEBA02\n  - SEBA0H\n  - SEBA78\n  - LCAPPD\n  - LCAPBA\n  - LCAPIB\n  - LCAPSC\n  - MATURI\n  - MBMORO\n  - MB4ALL\n  - SPCEPP\n  - SPOBRD\n  - SPUPWK\n  - FMSCN2\n  - GPLS01\n  - PITBO2\n  - OPREP2\n  - OPREPT\n  - METRO2\n  - MBCORP\n  - MBCORP1\n  - COINFO\n  - CPCORP\n  - CRNOF2\n  - CRNOF3\n  - SRBAC2\n  - SRBAC3\n  - SRBAC5\n  - SRBAC9\n  - SEBA01\n  - SEBA02\n  - SEBA0H\n  - SEBA78\n  - LCAPPD\n  - LCAPBA\n  - LCAPIB\n  - LCAPSC\n  - MATURI\n\n  *(Note: [[FILE:FERRORS.CPY|FERRORS.CPY]] appears in 100+ programs and is the standard error copybook across the system.)*\n\n#### 2. LIBGB/[[FILE:EOINIT.CPY|EOINIT.CPY]]\n- **Purpose:** Contains error initialization routines and may include error code constants and message templates for end-of-job or initialization errors.\n- **Example Programs Using It:**  \n  - EO1534\n  - TR15VY\n  - UP3234\n  - IF1534\n  - UP1534\n  - DATE35\n\n#### 3. LIBGB/[[FILE:GBRC2RN.CPY|GBRC2RN.CPY]]\n- **Purpose:** Contains error codes and messages specific to certain reporting or reconciliation routines.\n- **Example Programs Using It:**  \n  - INBRTR\n\n#### 4. LIBGB/[[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]]\n- **Purpose:** May include error codes/messages related to company name processing.\n- **Example Programs Using It:**  \n  - LNCRE2\n\n#### 5. LIBGB/[[FILE:SENDMESS.CPY|SENDMESS.CPY]]\n- **Purpose:** Contains message sending routines, which may include error message handling for operator communications.\n- **Example Programs Using It:**  \n  - OPMENU\n\n---\n\n### Summary Table (First 40 Programs, Multi-Column Format)\n\n| Program   | Program   | Program   | Program   |\n|-----------|-----------|-----------|-----------|\n| COINFO    | LONPJ1    | CRNOF3    | LONPF7    |\n| CPCORP    | LONPF9    | EMAIL     | LONPG6    |\n| MBCORP    | SFQUOT    | GPLS01    | EMCKR2    |\n| SPCEPP    | DATE35    | MBCORP1   | MBMORO    |\n| UP1534    | UP15VY    | BULKTR    | BTRACK    |\n| PST610    | PST827    | LNMAN4    | METRO2    |\n| IOLTBI    | PDPG04    | BULKGR    | SRBAC2    |\n| EO1534    | PST831    | SEBA01    | TR15VY    |\n| OPREP2    | UP3234    | LMPURG    | SEBA78    |\n| LCAPPD    | LPEOD5    | AUDIQ0    | PST838    |\n\n*(Total unique programs using error copybooks: 165)*\n\n---\n\n### How These Copybooks Are Used\n\n- **Inclusion:** Programs include these copybooks in the PROCEDURE DIVISION or WORKING-STORAGE SECTION.\n- **Error Handling:** They provide standardized error codes (e.g., 001, 002, ...) and associated messages (e.g., \"FILE NOT FOUND\", \"INVALID INPUT\").\n- **Display/Logging:** Used for displaying error messages to users or logging errors for audit purposes.\n- **Consistency:** Ensures all programs use the same error codes/messages for similar error conditions.\n\n---\n\n### Source Citation\n\n- The above information is based on copybook usage references from the following sources:\n  - [Source: [[FILE:COINFO.CBL|COINFO.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LONPJ1.CBL|LONPJ1.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:CRNOF3.CBL|CRNOF3.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LONPF7.CBL|LONPF7.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:CPCORP.CBL|CPCORP.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:EMAIL.CBL|EMAIL.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:MBCORP.CBL|MBCORP.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:GPLS01.CBL|GPLS01.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:EMCKR2.CBL|EMCKR2.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:SPCEPP.CBL|SPCEPP.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:DATE35.CBL|DATE35.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:MBCORP1.CBL|MBCORP1.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:MBMORO.CBL|MBMORO.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:UP1534.CBL|UP1534.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:UP15VY.CBL|UP15VY.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:BULKTR.CBL|BULKTR.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:BTRACK.CBL|BTRACK.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:PST610.CBL|PST610.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:PST827.CBL|PST827.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LNMAN4.CBL|LNMAN4.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:METRO2.CBL|METRO2.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:IOLTBI.CBL|IOLTBI.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:PDPG04.CBL|PDPG04.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:BULKGR.CBL|BULKGR.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:SRBAC2.CBL|SRBAC2.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:EO1534.CBL|EO1534.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:PST831.CBL|PST831.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:SEBA01.CBL|SEBA01.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:TR15VY.CBL|TR15VY.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:OPREP2.CBL|OPREP2.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:UP3234.CBL|UP3234.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LMPURG.CBL|LMPURG.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:SEBA78.CBL|SEBA78.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LCAPPD.CBL|LCAPPD.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:LPEOD5.CBL|LPEOD5.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:AUDIQ0.CBL|AUDIQ0.CBL]], Index: copybook_usage]\n  - [Source: [[FILE:PST838.CBL|PST838.CBL]], Index: copybook_usage]\n\n---\n\n**In summary:**  \n- The primary error code/message copybook is **LIBGB/[[FILE:FERRORS.CPY|FERRORS.CPY]]**.\n- Additional error-related copybooks include **LIBGB/[[FILE:EOINIT.CPY|EOINIT.CPY]]**, **LIBGB/[[FILE:GBRC2RN.CPY|GBRC2RN.CPY]]**, **LIBGB/[[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]]**, and **LIBGB/[[FILE:SENDMESS.CPY|SENDMESS.CPY]]**.\n- These copybooks are used in at least **165 unique programs** throughout the OTIS/OTOS application for consistent error handling.",
    "sources_count": 200,
    "timing_seconds": 20.445
  },
  "Q44": {
    "question": "What copybooks define common working storage structures?",
    "answer": "Here are the copybooks that define **common working storage structures** in the OTIS/OTOS application. These copybooks are typically included in the WORKING-STORAGE SECTION of COBOL programs to provide shared data definitions, flags, counters, and utility fields used across multiple modules.\n\n### Common Working Storage Structure Copybooks\n\n| Copybook Name         | Description                                                                                   | Source Example                        |\n|----------------------|----------------------------------------------------------------------------------------------|---------------------------------------|\n| [[FILE:GB01BR.CPY|GB01BR.CPY]]           | General business record definitions; includes common fields for business processing           | [[FILE:SETOPT.CBL|SETOPT.CBL]], [[FILE:ACTION.CBL|ACTION.CBL]] (WORKING-STORAGE) |\n| [[FILE:GBFSWKI.CPY|GBFSWKI.CPY]]          | General business file working storage; utility fields for file operations                     | [[FILE:CPCORP.CBL|CPCORP.CBL]], [[FILE:SUMTRL.CBL|SUMTRL.CBL]]                |\n| [[FILE:GBFSWKS.CPY|GBFSWKS.CPY]]          | General business file working storage (alternate); used for screen and file handling          | [[FILE:PERUSE.CBL|PERUSE.CBL]]                            |\n| [[FILE:GBFSWKR.CPY|GBFSWKR.CPY]]          | General business file working record; used for record-level working storage                   | [[FILE:SECENT.CBL|SECENT.CBL]]                            |\n| [[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]        | Posting system working storage; fields for posting transactions and batch processing          | [[FILE:PST820.CBL|PST820.CBL]], [[FILE:PST464.CBL|PST464.CBL]], [[FILE:PST466.CBL|PST466.CBL]], [[FILE:PST598.CBL|PST598.CBL]], [[FILE:PST831.CBL|PST831.CBL]] (WORKING-STORAGE) |\n| [[FILE:FPWSPST.CPY|FPWSPST.CPY]]          | Financial posting working storage; fields for financial posting operations                    | [[FILE:PST469.CBL|PST469.CBL]], [[FILE:PST593.CBL|PST593.CBL]]                |\n| [[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]]       | General business record definitions for SQL operations; used for embedded SQL                 | [[FILE:SETOPT.CBL|SETOPT.CBL]] (WORKING-STORAGE)          |\n\n#### Additional Notes:\n- These copybooks are included in the WORKING-STORAGE SECTION, not the FILE SECTION.\n- They provide reusable data structures such as:\n  - Transaction codes\n  - Status flags\n  - Temporary counters\n  - Batch identifiers\n  - Utility fields for screen/file operations\n\n#### Example Usage:\n```cobol\nWORKING-STORAGE SECTION.\nCOPY 'LIBGB/[[FILE:GB01BR.CPY|GB01BR.CPY]]'.\nCOPY 'LIBGB/[[FILE:GBFSWKI.CPY|GBFSWKI.CPY]]'.\nCOPY 'LIBFP/[[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]'.\n```\n(Source: [[FILE:SETOPT.CBL|SETOPT.CBL]], [[FILE:CPCORP.CBL|CPCORP.CBL]], [[FILE:PST820.CBL|PST820.CBL]], Index: copybook_usage)\n\n### Summary\n- **[[FILE:GB01BR.CPY|GB01BR.CPY]]** and its SQL variant are the most widely used for business record structures.\n- **[[FILE:GBFSWKI.CPY|GBFSWKI.CPY]]**, **[[FILE:GBFSWKS.CPY|GBFSWKS.CPY]]**, and **[[FILE:GBFSWKR.CPY|GBFSWKR.CPY]]** provide utility fields for file and record handling.\n- **[[FILE:PST_COPYW.CPY|PST_COPYW.CPY]]** and **[[FILE:FPWSPST.CPY|FPWSPST.CPY]]** are specialized for posting and financial operations.\n\nIf you need a complete list of all programs using these copybooks, let me know!",
    "sources_count": 100,
    "timing_seconds": 7.614
  },
  "Q45": {
    "question": "What copybooks are shared across many programs vs specialized?",
    "answer": "Here is a breakdown of **shared vs specialized copybooks** in the OTIS/OTOS system, based on the retrieved context:\n\n---\n\n### **Shared Copybooks (Used Across Many Programs)**\nThese copybooks are included in a large number of programs, typically to provide common data structures, working storage, or utility definitions. Their widespread use indicates they define standard fields or logic needed throughout the system.\n\n#### **Most Widely Shared:**\n- **LIBLP/[[FILE:LPWSPC.CPY|LPWSPC.CPY]]**  \n  *Purpose:* Common working storage for loan processing (appears in dozens of programs, e.g., PST270, PST610, PST594, PST267, PST336, PST467, PST464, PST272, PST271, PST265, PST593, PST810, PST596, PST599, PST598, PST276, PST275, PST274, PST269, PST268, PST266, PST339, PST461, PST462, PST463, PST468, PST597, PST599, PST469, etc.)  \n  *Description:* Defines standard working storage fields for loan programs.\n\n- **LIBLP/[[FILE:LPWSCDB.CPY|LPWSCDB.CPY]]**  \n  *Purpose:* Common database-related working storage for loan programs (used in PST270, PST267, PST610, PST464, PST593, PST594, PST466, PST272, PST467, PST594, PST464, PST466, etc.)  \n  *Description:* Provides fields for database control and status.\n\n- **LIBGB/[[FILE:PASSWDW.CPY|PASSWDW.CPY]]**  \n  *Purpose:* Password and security-related working storage (used in BULKT1, CLAST1, BLKONE, etc.)  \n  *Description:* Defines password fields and security controls.\n\n- **LIBGB/[[FILE:GB01ER.CPY|GB01ER.CPY]]**  \n  *Purpose:* General business error codes (used in GBFDER, etc.)  \n  *Description:* Standard error code definitions.\n\n---\n\n### **Specialized Copybooks (Used in Few Programs)**\nThese copybooks are tailored for specific business processes, file layouts, or unique program requirements. They are typically included in only one or a few programs.\n\n#### **Examples:**\n- **LIBUP/[[FILE:UP01ATRP.CPY|UP01ATRP.CPY]]**  \n  *Purpose:* Specialized working storage for UPFDATRP program  \n  *Description:* Defines fields unique to UPFDATRP's processing needs.\n\n- **LIBUP/[[FILE:UP01ATRD.CPY|UP01ATRD.CPY]]**  \n  *Purpose:* Specialized for UPFDATRD  \n  *Description:* Custom fields for this program's logic.\n\n- **LIBEX/[[FILE:EX01XBW.CPY|EX01XBW.CPY]]**  \n  *Purpose:* Used only in EXFDXBW  \n  *Description:* Specialized extract file layout.\n\n- **LIBLP/[[FILE:LP01OP.CPY|LP01OP.CPY]]**  \n  *Purpose:* Used in LPFDOP  \n  *Description:* Defines fields for loan payoff operations.\n\n- **LIBSP/[[FILE:SP01IC.CPY|SP01IC.CPY]]**  \n  *Purpose:* Used in SPFDIC  \n  *Description:* Specialized insurance code fields.\n\n- **LIBGB/[[FILE:GB01FL.CPY|GB01FL.CPY]]**  \n  *Purpose:* Used in GBFDFL  \n  *Description:* Specialized file layout for general business.\n\n---\n\n### **Summary Table**\n\n| Shared Copybooks                | Purpose/Description                                 | Specialized Copybooks         | Purpose/Description                   |\n|---------------------------------|-----------------------------------------------------|------------------------------|---------------------------------------|\n| LIBLP/[[FILE:LPWSPC.CPY|LPWSPC.CPY]]                | Common loan working storage                         | LIBUP/[[FILE:UP01ATRP.CPY|UP01ATRP.CPY]]           | UPFDATRP-specific fields              |\n| LIBLP/[[FILE:LPWSCDB.CPY|LPWSCDB.CPY]]               | Common loan DB control/status                       | LIBUP/[[FILE:UP01ATRD.CPY|UP01ATRD.CPY]]           | UPFDATRD-specific fields              |\n| LIBGB/[[FILE:PASSWDW.CPY|PASSWDW.CPY]]               | Password/security fields                            | LIBEX/[[FILE:EX01XBW.CPY|EX01XBW.CPY]]            | EXFDXBW extract file layout           |\n| LIBGB/[[FILE:GB01ER.CPY|GB01ER.CPY]]                | General error codes                                 | LIBLP/[[FILE:LP01OP.CPY|LP01OP.CPY]]             | Loan payoff operation fields          |\n|                                 |                                                     | LIBSP/[[FILE:SP01IC.CPY|SP01IC.CPY]]             | Insurance code fields                 |\n|                                 |                                                     | LIBGB/[[FILE:GB01FL.CPY|GB01FL.CPY]]             | General business file layout          |\n\n---\n\n### **Key Points**\n- **Shared copybooks** (like [[FILE:LPWSPC.CPY|LPWSPC.CPY]], [[FILE:LPWSCDB.CPY|LPWSCDB.CPY]]) are foundational and appear in many programs, supporting system-wide consistency.\n- **Specialized copybooks** are tailored for individual programs or unique business processes, ensuring flexibility for specific requirements.\n\n(Source: [[FILE:M|M]]ultiple program copybook usage records, e.g., [[FILE:PST270.CBL|PST270.CBL]], [[FILE:PST610.CBL|PST610.CBL]], [[FILE:UPFDATRP.CPY|UPFDATRP.CPY]], [[FILE:EXFDXBW.CPY|EXFDXBW.CPY]], [[FILE:LPFDOP.CPY|LPFDOP.CPY]], [[FILE:SPFDIC.CPY|SPFDIC.CPY]], [[FILE:GBFDFL.CPY|GBFDFL.CPY]], Index: copybook_usage)",
    "sources_count": 100,
    "timing_seconds": 10.135
  },
  "Q46": {
    "question": "What are the most frequently called programs in OTIS?",
    "answer": "The most frequently called programs in the OTIS/OTOS application are those that serve as **utility modules, error handlers, data access routines, and core business logic components**. These programs are invoked by many other modules across the system, indicating their central role in the application's architecture.\n\n### **Top Frequently Called Programs**\n\n#### 1. **SYSTEM**\n- **Called by:** 24 programs (highest in retrieved context)\n- **Role:** Provides system-level services, likely including environment setup, configuration, and common routines.\n- **Source:** SYSTEM (Source: [[FILE:SYSTEM|SYSTEM]], [[FILE:I|I]]ndex: programs)\n\n#### 2. **LONPW9**\n- **Called by:** 1 program directly, but participates in call cycles with a call depth of 52, indicating it is part of many workflows.\n- **Role:** Handles loan payoff notification and related processing.\n- **Source:** LONPW9 (Source: [[FILE:LONPW9|LONPW9]], [[FILE:I|I]]ndex: programs)\n\n#### 3. **ICFILE**\n- **Called by:** 3 programs\n- **Role:** Manages insurance company file operations.\n- **Source:** ICFILE (Source: [[FILE:ICFILE|ICFILE]], [[FILE:I|I]]ndex: programs)\n\n#### 4. **SSFILE**\n- **Called by:** 3 programs\n- **Role:** Handles social security file operations.\n- **Source:** SSFILE (Source: [[FILE:SSFILE|SSFILE]], [[FILE:I|I]]ndex: programs)\n\n#### 5. **LONPFB**\n- **Called by:** 2 programs, participates in call cycles (depth 51)\n- **Role:** Loan payment file batch processing.\n- **Source:** LONPFB (Source: [[FILE:LONPFB|LONPFB]], [[FILE:I|I]]ndex: programs)\n\n#### 6. **CDBMAN**\n- **Called by:** 2 programs, participates in call cycles\n- **Role:** Manages certificate database operations.\n- **Source:** CDBMAN (Source: [[FILE:CDBMAN|CDBMAN]], [[FILE:I|I]]ndex: programs)\n\n#### 7. **MB4ALL**\n- **Makes 6 calls, root program**\n- **Role:** End-of-month processing for multiple data sets.\n- **Source:** MB4ALL (Source: [[FILE:MB4ALL|MB4ALL]], [[FILE:I|I]]ndex: programs)\n\n#### 8. **CHLIST, JCMAIN, CKMAIN, CPCORP**\n- **Each called by multiple programs or make multiple calls**\n- **Role:** Various business logic and reporting functions.\n\n---\n\n### **Summary Table**\n\n| Program   | Called By (Count) | Role/Function                          |\n|-----------|-------------------|----------------------------------------|\n| SYSTEM    | 24                | System utilities, environment setup    |\n| LONPW9    | 1 (cycles, depth) | Loan payoff notification, core logic   |\n| ICFILE    | 3                 | Insurance file management              |\n| SSFILE    | 3                 | Social security file management        |\n| LONPFB    | 2 (cycles, depth) | Loan payment batch processing          |\n| CDBMAN    | 2 (cycles)        | Certificate DB management              |\n| MB4ALL    | 0 (root)          | End-of-month driver                    |\n| CHLIST    | 0 (root)          | List management/reporting              |\n| JCMAIN    | 0 (root)          | Journal/certificate main logic         |\n| CKMAIN    | 0 (root)          | Check management main logic            |\n| CPCORP    | 0 (root)          | Corporate certificate processing       |\n\n---\n\n### **Visual Representation**\n\nHere's a visual diagram showing the most frequently called programs and their relationships:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Most Frequently Called Programs in OTIS</text>\n  \n  <!-- SYSTEM -->\n  <rect x=\"50\" y=\"80\" width=\"140\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"120\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SYSTEM</text>\n  <text x=\"120\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Called by 24</text>\n  \n  <!-- LONPW9 -->\n  <rect x=\"250\" y=\"80\" width=\"140\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"320\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LONPW9</text>\n  <text x=\"320\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Call cycles</text>\n  \n  <!-- ICFILE -->\n  <rect x=\"450\" y=\"80\" width=\"140\" height=\"70\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"520\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">ICFILE</text>\n  <text x=\"520\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Called by 3</text>\n  \n  <!-- SSFILE -->\n  <rect x=\"650\" y=\"80\" width=\"140\" height=\"70\" fill=\"#ef4444\" stroke=\"#dc2626\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"720\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SSFILE</text>\n  <text x=\"720\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Called by 3</text>\n  \n  <!-- LONPFB -->\n  <rect x=\"150\" y=\"200\" width=\"140\" height=\"70\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"220\" y=\"230\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"16\" font-weight=\"bold\">LONPFB</text>\n  <text x=\"220\" y=\"250\" text-anchor=\"middle\" fill=\"#1e40af\" font-size=\"11\">Call cycles</text>\n  \n  <!-- CDBMAN -->\n  <rect x=\"350\" y=\"200\" width=\"140\" height=\"70\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"420\" y=\"230\" text-anchor=\"middle\" fill=\"#15803d\" font-size=\"16\" font-weight=\"bold\">CDBMAN</text>\n  <text x=\"420\" y=\"250\" text-anchor=\"middle\" fill=\"#15803d\" font-size=\"11\">Call cycles</text>\n  \n  <!-- MB4ALL -->\n  <rect x=\"550\" y=\"200\" width=\"140\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"620\" y=\"230\" text-anchor=\"middle\" fill=\"#4338ca\" font-size=\"16\" font-weight=\"bold\">MB4ALL</text>\n  <text x=\"620\" y=\"250\" text-anchor=\"middle\" fill=\"#4338ca\" font-size=\"11\">Root program</text>\n  \n  <!-- Arrows from SYSTEM to others -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"190\" y1=\"150\" x2=\"220\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"320\" y1=\"150\" x2=\"420\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"520\" y1=\"150\" x2=\"620\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### **How This Was Determined**\n- **SYSTEM** is the most frequently called program, with 24 direct callers (Source: [[FILE:SYSTEM|SYSTEM]], [[FILE:I|I]]ndex: programs).\n- **LONPW9, ICFILE, SSFILE, LONPFB, CDBMAN** are called by multiple programs and participate in deep call chains or cycles, indicating frequent use.\n- Other programs like **MB4ALL, CHLIST, JCMAIN, CKMAIN, CPCORP** are root programs that make many calls, but are not as frequently called themselves.\n\n---\n\n**Source Citations:**\n- SYSTEM (Source: [[FILE:SYSTEM|SYSTEM]], [[FILE:I|I]]ndex: programs)\n- LONPW9 (Source: [[FILE:LONPW9|LONPW9]], [[FILE:I|I]]ndex: programs)\n- ICFILE (Source: [[FILE:ICFILE|ICFILE]], [[FILE:I|I]]ndex: programs)\n- SSFILE (Source: [[FILE:SSFILE|SSFILE]], [[FILE:I|I]]ndex: programs)\n- LONPFB (Source: [[FILE:LONPFB|LONPFB]], [[FILE:I|I]]ndex: programs)\n- CDBMAN (Source: [[FILE:CDBMAN|CDBMAN]], [[FILE:I|I]]ndex: programs)\n- MB4ALL (Source: [[FILE:MB4ALL|MB4ALL]], [[FILE:I|I]]ndex: programs)\n\nIf you need a full list of all programs and their call frequencies, let me know!",
    "sources_count": 200,
    "timing_seconds": 19.005
  },
  "Q47": {
    "question": "How deep are typical call chains in OTIS programs?",
    "answer": "Typical call chains in OTIS/OTOS COBOL programs are **shallow to moderately deep**, with most programs having a call depth of **1 to 3 levels**, and only a few utility or batch programs reaching **4 or more levels**.\n\n### Analysis of Call Chain Depth\n\n- **Most programs** (e.g., screens, maintenance modules, transaction handlers) have a **call depth of 1–2**:\n  - They perform their main logic and may call a small number of utility routines (e.g., error handlers, validation modules).\n  - Example: \"Program SYSTEM has 1 paragraphs and 0 perform edges; max depth 1\" (Source: [[FILE:SYSTEM|SYSTEM]], [[FILE:I|I]]ndex: flows).\n  - Example: \"Program ACCESS has 1 paragraphs and 0 perform edges; max depth 1\" (Source: [[FILE:ACCESS|ACCESS]], [[FILE:I|I]]ndex: flows).\n\n- **Moderate complexity programs** (e.g., loan processing, batch routines) often reach **3 levels**:\n  - These programs may call business logic modules, which in turn call data access or calculation routines.\n  - Example: CALCZ3, CALCZL, LNQUOT, etc., show multiple PERFORM and CALL edges, but rarely go beyond 3 nested calls (Source: [[FILE:CALCZ3|CALCZ3]], [[FILE:CALCZL|CALCZL]], [[FILE:LNQUOT|LNQUOT]], [[FILE:I|I]]ndex: flows).\n\n- **Utility and batch programs** can reach **4+ levels**, but this is less common:\n  - These programs orchestrate multiple submodules, error handling, and reporting routines.\n  - Example: GRTOTL has 35 paragraphs but no deep perform chains (Source: [[FILE:GRTOTL|GRTOTL]], [[FILE:I|I]]ndex: flows).\n\n- **Menu programs** and screen handlers typically have **flat call graphs**:\n  - They route to business logic modules but do not themselves nest deeply.\n\n### Summary Table\n\n| Program Type         | Typical Call Depth | Example Programs         | Source Reference                |\n|----------------------|-------------------|-------------------------|---------------------------------|\n| Screen Handlers      | 1                 | SYSTEM, ACCESS          | SYSTEM, ACCESS (flows)          |\n| Maintenance Modules  | 1–2               | CHBORR, BWCREA, JCMAIN  | CHBORR, BWCREA, JCMAIN (flows)  |\n| Business Logic       | 2–3               | CALCZ3, LNQUOT, LONPG5  | CALCZ3, LNQUOT, LONPG5 (flows)  |\n| Batch/Utility        | 3–4+              | GRTOTL, BULKTR          | GRTOTL, BULKTR (flows)          |\n| Menu Programs        | 1                 | SCMENU, GLMENU          | SCMENU, GLMENU (flow_edges)     |\n\n### Key Points\n\n- **Maximum call depth is usually 3**; rarely exceeds 4.\n- **Cycles are absent**; call graphs are acyclic (no recursive calls).\n- **High fan-out** is common (many programs called from a single module), but not deep nesting.\n\n### Visual Representation\n\nHere's a visual representation of typical OTIS call chain depth:\n\n<svg width=\"700\" height=\"350\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"20\" font-weight=\"bold\" fill=\"#1a1a1a\">Typical OTIS Call Chain Depth</text>\n  \n  <!-- Level 0: Main Program -->\n  <rect x=\"300\" y=\"70\" width=\"100\" height=\"50\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Main Program</text>\n  \n  <!-- Level 1: Direct Calls -->\n  <rect x=\"100\" y=\"150\" width=\"100\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"150\" y=\"180\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Utility</text>\n  <rect x=\"300\" y=\"150\" width=\"100\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"350\" y=\"180\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Business Logic</text>\n  <rect x=\"500\" y=\"150\" width=\"100\" height=\"50\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"550\" y=\"180\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">Screen Handler</text>\n  \n  <!-- Level 2: Indirect Calls -->\n  <rect x=\"200\" y=\"230\" width=\"100\" height=\"50\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"250\" y=\"260\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">Data Access</text>\n  <rect x=\"400\" y=\"230\" width=\"100\" height=\"50\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"450\" y=\"260\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">Error Handler</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"120\" x2=\"150\" y2=\"150\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"120\" x2=\"350\" y2=\"150\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"120\" x2=\"550\" y2=\"150\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"150\" y1=\"200\" x2=\"250\" y2=\"230\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"200\" x2=\"250\" y2=\"230\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"350\" y1=\"200\" x2=\"450\" y2=\"230\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"550\" y1=\"200\" x2=\"450\" y2=\"230\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**Source References:**\n- SYSTEM, ACCESS, GRTOTL, CALCZ3, CALCZL, LNQUOT, CHBORR, BWCREA, JCMAIN, SCMENU, GLMENU (Index: flows, flow_edges)\n\nIf you need a specific program's call chain depth, let me know the program name and I can provide a detailed diagram and analysis.",
    "sources_count": 200,
    "timing_seconds": 15.959
  },
  "Q48": {
    "question": "What programs call what other programs? Give examples of call hierarchies.",
    "answer": "In the OTIS/OTOS COBOL system, programs frequently call other programs to modularize business logic, handle utility functions, and manage data access. Here are **examples of call hierarchies** and typical patterns observed in the retrieved context:\n\n---\n\n### **General Call Hierarchy Patterns**\n\n- **Menu/Screen Programs** (e.g., WIMENU, PGMENU)  \n  These programs act as entry points, calling business logic modules based on user selection.\n- **Business Logic Programs** (e.g., APIPAY, LONPFA, REFUPD)  \n  These handle core processing and often call utility or data access programs.\n- **Utility/Data Access Programs** (e.g., SYSTEM, DACCESS, GETENV)  \n  Widely called for common tasks like environment setup, file access, or error handling.\n\n---\n\n### **Example Call Hierarchies**\n\n#### **1. Menu Program Calling Business Logic**\n\n- **WIMENU**  \n  - Calls: FORM-PROGX (Source: [[FILE:WIMENU|WIMENU]], [[FILE:I|I]]ndex: flow_edges)\n    - FORM-PROGX then may call further business logic modules.\n\n#### **2. Business Logic Program with Utility Calls**\n\n- **LONPFA**  \n  - Calls: DISBURSE-OTHER-APPLIED (Source: [[FILE:LONPFA|LONPFA]], [[FILE:I|I]]ndex: flow_edges)\n    - Handles loan disbursement logic.\n\n#### **3. Utility Program Called by Many**\n\n- **SYSTEM**  \n  - Called by: DACCESS, LONPW1, INSTAL, FPFRPST, SQLCLR, FPIOPST, etc.\n    - Example: DACCESS performs SYSTEM-CALL for directory access (Source: [[FILE:DACCESS|DACCESS]], [[FILE:I|I]]ndex: flow_edges)\n    - Example: LONPW1 performs SYSTEM-CALL for next code logic (Source: [[FILE:LONPW1|LONPW1]], [[FILE:I|I]]ndex: flow_edges)\n\n#### **4. Batch/Processing Program Calling Subprograms**\n\n- **FAPOFF**  \n  - Calls: SUBPROGRAM (Source: [[FILE:FAPOFF|FAPOFF]], [[FILE:I|I]]ndex: flow_edges)\n    - Used for batch payoff processing.\n\n#### **5. Maintenance/Inquiry Program Calling Utility**\n\n- **GIMAN2, GIMAN3, GIMAN5, GIMAN1**  \n  - Each performs CALL-PROGRAM from their MODIFY-ROUTINE paragraph (Source: [[FILE:GIMAN2|GIMAN2]], [[FILE:GIMAN3|GIMAN3]], [[FILE:GIMAN5|GIMAN5]], [[FILE:GIMAN1|GIMAN1]], [[FILE:I|I]]ndex: flow_edges)\n    - This pattern allows dynamic invocation of other modules.\n\n---\n\n### **Sample Call Chain Diagram**\n\nHere's a visual representation of a typical call hierarchy involving menu, business logic, and utility programs:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Sample OTIS Program Call Hierarchy</text>\n  \n  <!-- Menu Program -->\n  <rect x=\"50\" y=\"80\" width=\"180\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"140\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">WIMENU</text>\n  <text x=\"140\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Menu Program</text>\n  \n  <!-- Business Logic -->\n  <rect x=\"300\" y=\"80\" width=\"180\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"390\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">FORM-PROGX</text>\n  <text x=\"390\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Business Logic</text>\n  \n  <!-- Utility Program -->\n  <rect x=\"550\" y=\"80\" width=\"180\" height=\"70\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"640\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SYSTEM</text>\n  <text x=\"640\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Utility Program</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"230\" y1=\"115\" x2=\"300\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"480\" y1=\"115\" x2=\"550\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  \n  <!-- Additional calls from other programs -->\n  <rect x=\"300\" y=\"200\" width=\"180\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"390\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LONPFA</text>\n  <text x=\"390\" y=\"250\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Business Logic</text>\n  <line x1=\"390\" y1=\"150\" x2=\"390\" y2=\"200\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"480\" y1=\"230\" x2=\"550\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### **Summary of Call Hierarchy Examples**\n\n- **Menu programs** call business logic modules based on user actions.\n- **Business logic modules** may call utility/data access programs for common tasks.\n- **Utility programs** like SYSTEM are called by many modules for standardized operations.\n- **Batch and maintenance programs** often call specialized subprograms for processing.\n\n**Sources:**\n- WIMENU → FORM-PROGX (Source: [[FILE:WIMENU|WIMENU]], [[FILE:I|I]]ndex: flow_edges)\n- LONPFA → DISBURSE-OTHER-APPLIED (Source: [[FILE:LONPFA|LONPFA]], [[FILE:I|I]]ndex: flow_edges)\n- DACCESS, LONPW1, INSTAL, FPFRPST, SQLCLR, FPIOPST → SYSTEM (Source: respective program flow_edges)\n- GIMAN2, GIMAN3, GIMAN5, GIMAN1 → CALL-PROGRAM (Source: respective program flow_edges)\n\nIf you need a specific call chain for a particular program, let me know the program name and I can provide a detailed diagram and explanation.",
    "sources_count": 200,
    "timing_seconds": 15.155
  },
  "Q49": {
    "question": "What are the core utility programs that many programs depend on?",
    "answer": "The core utility programs in the OTIS/OTOS COBOL system are those that provide **shared services, error handling, environment setup, and data access routines**. These programs are called by many other modules and serve as foundational building blocks for business logic and screen handling.\n\n### Most-Depended-On Utility Programs\n\n#### 1. SYSTEM\n- **Role:** Central system utility, likely handles system-level functions (e.g., error handling, environment setup, logging).\n- **Dependency:** Called by 24 different programs, making it one of the most frequently depended-on utilities.\n- **Call Depth:** 1 (leaf program; does not call other programs).\n- **Source:** SYSTEM, Index: programs\n\n#### 2. SETENV\n- **Role:** Environment setup utility; manages environment variables and configuration.\n- **Dependency:** Called by other programs for environment initialization.\n- **Call Depth:** 3 (intermediate; both calls and is called).\n- **Source:** SETENV, Index: programs\n\n#### 3. ACCESSW (via LIBGB/[[FILE:ACCESSW.CPY|ACCESSW.CPY]])\n- **Role:** Data access routines; provides standardized access to files and databases.\n- **Dependency:** Used in many programs via copybook inclusion (e.g., [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:PERUSE.CBL|PERUSE.CBL]], [[FILE:SPRATE.CBL|SPRATE.CBL]]).\n- **Source:** [[FILE:PERUSE.CBL|PERUSE.CBL]], Index: copybook_usage; [[FILE:LTEXTR.CBL|LTEXTR.CBL]], Index: code\n\n#### 4. SYSTEMW (via LIBGB/[[FILE:SYSTEMW.CPY|SYSTEMW.CPY]])\n- **Role:** System-level working storage and routines; supports error handling, system calls, and status tracking.\n- **Dependency:** Included in numerous programs (e.g., [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:PERUSE.CBL|PERUSE.CBL]], [[FILE:PDMAIN.CBL|PDMAIN.CBL]]).\n- **Source:** [[FILE:PERUSE.CBL|PERUSE.CBL]], Index: copybook_usage; [[FILE:LTEXTR.CBL|LTEXTR.CBL]], Index: code\n\n#### 5. GETENVW (via LIBGB/[[FILE:GETENVW.CPY|GETENVW.CPY]])\n- **Role:** Environment variable management; used for retrieving and setting environment parameters.\n- **Dependency:** Included in many programs for environment setup (e.g., [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:UTMAIN.CBL|UTMAIN.CBL]], [[FILE:LONPR0.CBL|LONPR0.CBL]]).\n- **Source:** [[FILE:UTMAIN.CBL|UTMAIN.CBL]], Index: copybook_usage; [[FILE:LTEXTR.CBL|LTEXTR.CBL]], Index: code\n\n#### 6. SPPDTHW (via LIBGB/[[FILE:SPPDTHW.CPY|SPPDTHW.CPY]])\n- **Role:** Likely handles date/time or system status routines.\n- **Dependency:** Included in many programs for standardized date/time handling (e.g., [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:LNAGA2.CBL|LNAGA2.CBL]], [[FILE:PITBO2.CBL|PITBO2.CBL]]).\n- **Source:** [[FILE:LTEXTR.CBL|LTEXTR.CBL]], Index: code; [[FILE:LNAGA2.CBL|LNAGA2.CBL]], Index: code\n\n#### 7. GETPRW (via LIBGB/[[FILE:GETPRW.CPY|GETPRW.CPY]])\n- **Role:** Print/report routines; manages printing and reporting functions.\n- **Dependency:** Used in programs that generate reports or printed output (e.g., [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:SPRATE.CBL|SPRATE.CBL]], [[FILE:RENEW1.CBL|RENEW1.CBL]]).\n- **Source:** [[FILE:LTEXTR.CBL|LTEXTR.CBL]], Index: code; [[FILE:SPRATE.CBL|SPRATE.CBL]], Index: code\n\n### Summary Table\n\n| Program/Copybook         | Purpose/Role                        | Example Usage/Dependency           |\n|------------------------- |-------------------------------------|------------------------------------|\n| SYSTEM                   | System utility, error handling      | Called by 24 programs              |\n| SETENV                   | Environment setup                   | Called by other programs           |\n| [[FILE:ACCESSW.CPY|ACCESSW.CPY]]              | Data access routines                | Included in LTEXTR, PERUSE, SPRATE |\n| [[FILE:SYSTEMW.CPY|SYSTEMW.CPY]]              | System-level routines               | Included in LTEXTR, PERUSE, PDMAIN |\n| [[FILE:GETENVW.CPY|GETENVW.CPY]]              | Environment variable management     | Included in LTEXTR, UTMAIN, LONPR0 |\n| [[FILE:SPPDTHW.CPY|SPPDTHW.CPY]]              | Date/time/system status routines    | Included in LTEXTR, LNAGA2, PITBO2 |\n| [[FILE:GETPRW.CPY|GETPRW.CPY]]               | Print/report routines               | Included in LTEXTR, SPRATE, RENEW1 |\n\n### Visual Representation\n\nHere's a visual representation of how these core utility programs are depended on by many other programs:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Core Utility Program Dependencies</text>\n  \n  <!-- Utility Programs (center row) -->\n  <rect x=\"350\" y=\"80\" width=\"200\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">SYSTEM</text>\n  <rect x=\"100\" y=\"80\" width=\"200\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"200\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">SETENV</text>\n  <rect x=\"600\" y=\"80\" width=\"200\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"700\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"white\">[[FILE:ACCESSW.CPY|ACCESSW.CPY]]</text>\n  \n  <!-- Copybooks (bottom row) -->\n  <rect x=\"50\" y=\"200\" width=\"160\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"130\" y=\"230\" text-anchor=\"middle\" font-size=\"13\" font-weight=\"bold\" fill=\"#1e40af\">[[FILE:SYSTEMW.CPY|SYSTEMW.CPY]]</text>\n  <rect x=\"250\" y=\"200\" width=\"160\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"330\" y=\"230\" text-anchor=\"middle\" font-size=\"13\" font-weight=\"bold\" fill=\"#1e40af\">[[FILE:GETENVW.CPY|GETENVW.CPY]]</text>\n  <rect x=\"450\" y=\"200\" width=\"160\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"530\" y=\"230\" text-anchor=\"middle\" font-size=\"13\" font-weight=\"bold\" fill=\"#1e40af\">[[FILE:SPPDTHW.CPY|SPPDTHW.CPY]]</text>\n  <rect x=\"650\" y=\"200\" width=\"160\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"730\" y=\"230\" text-anchor=\"middle\" font-size=\"13\" font-weight=\"bold\" fill=\"#1e40af\">[[FILE:GETPRW.CPY|GETPRW.CPY]]</text>\n  \n  <!-- Example Programs (top row) -->\n  <rect x=\"100\" y=\"350\" width=\"120\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"375\" text-anchor=\"middle\" font-size=\"12\" font-weight=\"bold\" fill=\"#15803d\">[[FILE:LTEXTR.CBL|LTEXTR.CBL]]</text>\n  <rect x=\"250\" y=\"350\" width=\"120\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"310\" y=\"375\" text-anchor=\"middle\" font-size=\"12\" font-weight=\"bold\" fill=\"#15803d\">[[FILE:PERUSE.CBL|PERUSE.CBL]]</text>\n  <rect x=\"400\" y=\"350\" width=\"120\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"460\" y=\"375\" text-anchor=\"middle\" font-size=\"12\" font-weight=\"bold\" fill=\"#15803d\">[[FILE:SPRATE.CBL|SPRATE.CBL]]</text>\n  <rect x=\"550\" y=\"350\" width=\"120\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"610\" y=\"375\" text-anchor=\"middle\" font-size=\"12\" font-weight=\"bold\" fill=\"#15803d\">[[FILE:PDMAIN.CBL|PDMAIN.CBL]]</text>\n  <rect x=\"700\" y=\"350\" width=\"120\" height=\"40\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"760\" y=\"375\" text-anchor=\"middle\" font-size=\"12\" font-weight=\"bold\" fill=\"#15803d\">[[FILE:UTMAIN.CBL|UTMAIN.CBL]]</text>\n  \n  <!-- Arrows from utility programs to copybooks -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"200\" y1=\"140\" x2=\"130\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"200\" y1=\"140\" x2=\"330\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"140\" x2=\"530\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"700\" y1=\"140\" x2=\"730\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Arrows from copybooks to example programs -->\n  <line x1=\"130\" y1=\"250\" x2=\"160\" y2=\"350\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"330\" y1=\"250\" x2=\"310\" y2=\"350\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"530\" y1=\"250\" x2=\"460\" y2=\"350\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"730\" y1=\"250\" x2=\"610\" y2=\"350\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"730\" y1=\"250\" x2=\"760\" y2=\"350\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n### Source Citations\n- SYSTEM program is called by 24 programs (Source: [[FILE:SYSTEM|SYSTEM]], [[FILE:I|I]]ndex: programs)\n- SETENV is called by other programs for environment setup (Source: [[FILE:SETENV|SETENV]], [[FILE:I|I]]ndex: programs)\n- [[FILE:ACCESSW.CPY|ACCESSW.CPY]], [[FILE:SYSTEMW.CPY|SYSTEMW.CPY]], [[FILE:GETENVW.CPY|GETENVW.CPY]], [[FILE:SPPDTHW.CPY|SPPDTHW.CPY]], [[FILE:GETPRW.CPY|GETPRW.CPY]] are included in many programs (Source: [[FILE:LTEXTR.CBL|LTEXTR.CBL]], [[FILE:PERUSE.CBL|PERUSE.CBL]], [[FILE:SPRATE.CBL|SPRATE.CBL]], [[FILE:UTMAIN.CBL|UTMAIN.CBL]], [[FILE:PDMAIN.CBL|PDMAIN.CBL]], Index: code and copybook_usage)\n\n**In summary:**  \nThese utility programs and copybooks form the backbone of the OTIS/OTOS system, providing essential services that are reused across many business modules. Their widespread use ensures consistency, reliability, and maintainability throughout the application.",
    "sources_count": 100,
    "timing_seconds": 20.273
  },
  "Q50": {
    "question": "How does OTIS use CALL statements to invoke other programs?",
    "answer": "OTIS/OTOS uses **CALL statements** in COBOL to invoke other programs and modularize business logic. This approach allows programs to delegate specialized tasks (such as error handling, environment setup, data access, or business processing) to utility or subprograms. Here’s how CALL statements are typically used in OTIS:\n\n---\n\n### 1. **Business Purpose of CALL Statements**\n- **Modularization:** Complex business processes are broken into smaller, reusable modules.\n- **Separation of Concerns:** Core programs focus on business logic, while utility programs handle shared services (e.g., error logging, environment setup).\n- **Reusability:** Utility programs (like SYSTEM, GETENV, DACCESS) are called from many places, reducing code duplication.\n\n---\n\n### 2. **Technical Implementation in COBOL**\n\n- **Static CALL:**  \n  The program name is hardcoded in the CALL statement.  \n  Example:  \n  ```cobol\n  CALL \"SYSTEM\" USING SYSTEM-BUFFER\n  ```\n  This invokes the SYSTEM utility program, passing required parameters.\n\n- **Dynamic CALL:**  \n  The program name is stored in a variable, allowing runtime selection.  \n  Example:  \n  ```cobol\n  CALL PROGRAM-NAME USING PARAMS\n  ```\n  This enables flexible invocation based on business logic.\n\n- **Parameter Passing:**  \n  Data is passed between programs using the USING clause, allowing the called program to process or update information.\n\n- **Error Handling:**  \n  Many CALLs are wrapped in error-checking logic to handle failures gracefully.\n\n---\n\n### 3. **Examples from OTIS/OTOS**\n\n- **Calling Utility Programs:**\n  - SYSTEM is called for system-level operations (e.g., directory listing, environment setup).\n    - Example:  \n      `CALL \"SYSTEM\" USING SYSTEM-BUFFER`  \n      (Source: [[FILE:GREXEC|GREXEC]], [[FILE:I|I]]ndex: flow_edges)\n  - GETENV is called to retrieve environment variables.\n    - Example:  \n      `CALL \"GETENV\" USING ENV-BUFFER`  \n      (Source: [[FILE:GETENV|GETENV]], [[FILE:I|I]]ndex: flows)\n  - DACCESS is called for directory/file access.\n    - Example:  \n      `CALL \"DACCESS\" USING DIR-ACCESS-BUFFER`  \n      (Source: [[FILE:DACCESS|DACCESS]], [[FILE:I|I]]ndex: flows)\n\n- **Business Logic Delegation:**\n  - REFUPD calls SYSTEM to exit after batch processing.\n    - Example:  \n      `CALL \"SYSTEM\" USING EXIT-BUFFER`  \n      (Source: [[FILE:REFUPD|REFUPD]], [[FILE:I|I]]ndex: flow_edges)\n  - PERUSE calls SYSTEM for file operations.\n    - Example:  \n      `CALL \"SYSTEM\" USING SYS-BUFFER`  \n      (Source: [[FILE:PERUSE|PERUSE]], [[FILE:I|I]]ndex: flow_edges)\n\n- **Menu/Screen Navigation:**\n  - Programs like PGMENU use CALLs to route to subsystem programs based on user selection.\n\n---\n\n### 4. **Call Chain Example**\n\nHere’s a typical call chain in OTIS:\n\n- **Main Program** (e.g., APIPAY)\n  - Calls **REFUPD** for payment processing\n  - Calls **LONPW9** for notification\n  - Calls **SYSTEM** for system-level tasks\n\n---\n\n### 5. **Visual Representation**\n\nHere's a visual representation of how CALL statements connect programs in OTIS:\n\n<svg width=\"700\" height=\"250\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"20\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Program Call Chain Example</text>\n  \n  <!-- Main program -->\n  <rect x=\"50\" y=\"80\" width=\"120\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"110\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">APIPAY</text>\n  <text x=\"110\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Main Program</text>\n  \n  <!-- Called program 1 -->\n  <rect x=\"230\" y=\"80\" width=\"120\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"290\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">REFUPD</text>\n  <text x=\"290\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Payment Processing</text>\n  \n  <!-- Called program 2 -->\n  <rect x=\"410\" y=\"80\" width=\"120\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"470\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LONPW9</text>\n  <text x=\"470\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Notification</text>\n  \n  <!-- Called program 3 -->\n  <rect x=\"590\" y=\"80\" width=\"120\" height=\"70\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"650\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SYSTEM</text>\n  <text x=\"650\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Utility</text>\n  \n  <!-- Arrows -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"170\" y1=\"115\" x2=\"230\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"170\" y1=\"115\" x2=\"410\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"170\" y1=\"115\" x2=\"590\" y2=\"115\" stroke=\"#333\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### 6. **Summary**\n\n- OTIS/OTOS uses CALL statements extensively to invoke utility and business logic programs.\n- This enables modular, maintainable, and reusable code.\n- Utility programs like SYSTEM, GETENV, DACCESS are central to many workflows.\n- CALL statements can be static or dynamic, with parameters passed for data exchange.\n\n**Sources:**\n- GREXEC, Index: flow_edges\n- REFUPD, Index: flow_edges\n- PERUSE, Index: flow_edges\n- DACCESS, Index: flows\n- GETENV, Index: flows\n\nIf you need examples of specific CALL statements or want to see a deeper call chain, let me know!",
    "sources_count": 200,
    "timing_seconds": 14.593
  },
  "Q51": {
    "question": "What parameters are typically passed between calling programs?",
    "answer": "Parameters passed between calling programs in the OTIS/OTOS COBOL system typically include:\n\n**1. Business Identifiers**\n   - Account numbers, branch numbers, loan numbers\n   - Example: `BRNO`, `ACCTNO`, `LOANNO`\n\n**2. Transaction Context**\n   - Transaction type codes (e.g., payment, refund, adjustment)\n   - Dates (transaction date, effective date)\n   - Example: `PASS-ENT-TYPE`, `PASS-BEG-LOANDATE`, `PASS-END-LOANDATE`  \n     (Source: [[FILE:LEXBNK.CBL|LEXBNK.CBL]], lines 126-150)\n\n**3. Control Flags**\n   - Flags to indicate processing mode, error status, or special handling\n   - Example: `PASS-CONV-FLAG`, `LN3-CONN-OPEN-SW`  \n     (Source: [[FILE:LEXBNK.CBL|LEXBNK.CBL]], lines 126-150)\n\n**4. Error and Status Messages**\n   - Buffers for passing error codes or descriptive messages\n   - Example: `EXT-API-MESS` (for API programs, to relay error info)  \n     (Source: [[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]], lines 351-375)\n\n**5. Environment and System Info**\n   - Database names, server names, version info for SQL or system calls\n   - Example: `RET-DB-NAME`, `RET-SERVER-NAME`, `RET-VERSION`  \n     (Source: [[FILE:SETENV.CBL|SETENV.CBL]], lines 201-225)\n\n**6. Data Buffers**\n   - Arrays or structures for bulk data transfer (e.g., message buffers, data arrays)\n   - Example: `RETURN-DATA-ARRAY OCCURS 256 TIMES PIC X(128)`  \n     (Source: [[FILE:TCLPWO.CBL|TCLPWO.CBL]], lines 126-150)\n\n**7. Security and Authorization**\n   - Passwords, security tokens, or flags for access control\n   - Example: `[[FILE:PASSWDW.CPY|PASSWDW.CPY]]` (password worker copybook used in many programs)  \n     (Source: [[FILE:CLAST1.CBL|CLAST1.CBL]], lines 451-475)\n\n**8. Screen and UI Control**\n   - Flags to enable/disable screen interactions, pass user input\n   - Example: `EXT-API-SCREEN-DISABLE`  \n     (Source: [[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]], lines 351-375)\n\n---\n\n### Code Examples\n\n**[[FILE:LEXBNK.CBL|LEXBNK.CBL]] (lines 126-150):**\n```cobol\n       01  PASS-ENT-TYPE        PIC X.\n       01  PASS-CONV-FLAG       PIC X.\n       01  PASS-BEG-LOANDATE    PIC X(10).\n       01  PASS-END-LOANDATE    PIC X(10).\n```\nThese are typical parameters for passing transaction context and control flags.\n\n**[[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]] (lines 351-375):**\n```cobol\n       01  EXT-API-WORKERS                     EXTERNAL.\n           03  EXT-API-SCREEN-DISABLE          PIC X(1).\n           03  EXT-API-MESS                    PIC X(61).\n```\nUsed for passing error messages and controlling screen interactions.\n\n**[[FILE:TCLPWO.CBL|TCLPWO.CBL]] (lines 126-150):**\n```cobol\n       01 RETURN-DATA.\n           03 RETURN-DATA-ARRAY \n               OCCURS 256 TIMES                PIC X(128).\n```\nUsed for bulk data transfer between programs.\n\n**[[FILE:SETENV.CBL|SETENV.CBL]] (lines 201-225):**\n```cobol\n       01  PASS-SQL                    PIC X(200).\n       01  RET-DB-NAME                 PIC X(50).\n       01  RET-SERVER-NAME             PIC X(50).\n       01  RET-VERSION                 PIC X(100).\n```\nUsed for passing environment and system information.\n\n---\n\n### Summary Table\n\n| Parameter Type         | Example Fields/COPYBOOKS         | Purpose                                 | Source Reference                |\n|-----------------------|-----------------------------------|-----------------------------------------|---------------------------------|\n| Business Identifiers  | BRNO, ACCTNO, LOANNO              | Identify accounts/branches/loans        | [[FILE:LEXBNK.CBL|LEXBNK.CBL]], code                |\n| Transaction Context   | PASS-ENT-TYPE, PASS-BEG-LOANDATE  | Transaction type/date info              | [[FILE:LEXBNK.CBL|LEXBNK.CBL]], code                |\n| Control Flags         | PASS-CONV-FLAG, LN3-CONN-OPEN-SW  | Processing mode, connection status      | [[FILE:LEXBNK.CBL|LEXBNK.CBL]], code                |\n| Error/Status Messages | EXT-API-MESS                      | Pass error/status info                  | [[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]], code            |\n| Environment Info      | RET-DB-NAME, RET-SERVER-NAME      | Database/server/version info            | [[FILE:SETENV.CBL|SETENV.CBL]], code                |\n| Data Buffers          | RETURN-DATA-ARRAY                 | Bulk data transfer                      | [[FILE:TCLPWO.CBL|TCLPWO.CBL]], code                |\n| Security/Auth         | [[FILE:PASSWDW.CPY|PASSWDW.CPY]]                       | Passwords, security tokens              | [[FILE:CLAST1.CBL|CLAST1.CBL]], code                |\n| Screen/UI Control     | EXT-API-SCREEN-DISABLE            | UI interaction control                  | [[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]], code            |\n\n---\n\n**In summary:**  \nPrograms typically pass business identifiers, transaction context, control flags, error/status messages, environment info, data buffers, security credentials, and UI control flags. The exact parameters depend on the business process and technical requirements of the calling/called programs.\n\n(Source: [[FILE:LEXBNK.CBL|LEXBNK.CBL]], [[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]], [[FILE:TCLPWO.CBL|TCLPWO.CBL]], [[FILE:SETENV.CBL|SETENV.CBL]], [[FILE:CLAST1.CBL|CLAST1.CBL]], Index: code)",
    "sources_count": 200,
    "timing_seconds": 14.824
  },
  "Q52": {
    "question": "What programs have the most dependencies on copybooks?",
    "answer": "The programs with the **most dependencies on copybooks** in the OTIS/OTOS COBOL system are typically those that:\n\n- Handle complex business logic (e.g., batch processing, reporting, loan servicing)\n- Interface with multiple data sources (files, databases)\n- Provide shared utility functions (environment setup, error handling)\n\n**Based on the retrieved context, the following programs have the highest number of copybook dependencies:**\n\n---\n\n### Top Programs by Copybook Usage\n\n| Program   | Number of Unique Copybooks | Example Copybooks Used | Source Reference |\n|-----------|---------------------------|-----------------------|------------------|\n| **PST593** | 7+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]], [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]], [[FILE:GBWSBR.CPY|GBWSBR.CPY]], [[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]], [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] | [[FILE:PST593.CBL|PST593.CBL]], Index: copybook_usage |\n| **PST599** | 6+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]], [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]], [[FILE:GBWSBR.CPY|GBWSBR.CPY]], [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] | [[FILE:PST599.CBL|PST599.CBL]], Index: copybook_usage |\n| **PST50K** | 6+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]], [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]], [[FILE:LP01BX_SQL.CPY|LP01BX_SQL.CPY]] | [[FILE:PST50K.CBL|PST50K.CBL]], Index: copybook_usage |\n| **PST594** | 6+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]], [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]], [[FILE:GBWSBR.CPY|GBWSBR.CPY]], [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] | [[FILE:PST594.CBL|PST594.CBL]], Index: copybook_usage |\n| **PST597** | 3+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:PST597.CBL|PST597.CBL]], Index: copybook_usage |\n| **PST598** | 2+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:PST598.CBL|PST598.CBL]], Index: copybook_usage |\n| **PST272** | 2+ | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:PST272.CBL|PST272.CBL]], Index: copybook_usage |\n| **SPINQ2** | 3+ | [[FILE:LPIBPC.CPY|LPIBPC.CPY]], [[FILE:LPXDTE.CPY|LPXDTE.CPY]], [[FILE:LPSTAT.CPY|LPSTAT.CPY]] | [[FILE:SPINQ2.CPY|SPINQ2.CPY]], Index: copybook_usage |\n| **LONPMC** | 2+ | [[FILE:LP01WK.CPY|LP01WK.CPY]], [[FILE:LTAUTOW.CPY|LTAUTOW.CPY]] | [[FILE:LONPMC.CBL|LONPMC.CBL]], Index: copybook_usage |\n| **CPINQ3** | 2+ | [[FILE:LTAUTOW.CPY|LTAUTOW.CPY]], [[FILE:LP01WK.CPY|LP01WK.CPY]] | [[FILE:CPINQ3.CBL|CPINQ3.CBL]], Index: copybook_usage |\n\n---\n\n### Observations\n\n- **Batch and reporting programs** (PSTxxx series) tend to have the most copybook dependencies, often referencing 6 or more copybooks each.\n- **Utility and inquiry programs** (e.g., SPINQ2, CPINQ3) also use multiple copybooks, especially for file definitions and shared routines.\n- **Copybooks commonly used** include SQL table definitions (e.g., [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]]), business rule sets ([[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]]), and environment setup ([[FILE:GBWSBR.CPY|GBWSBR.CPY]]).\n\n---\n\n### Example: PST593 Copybook Dependencies\n\n**PST593 uses at least 7 copybooks:**\n- LIBLP/[[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] – Loan payment structure definitions\n- LIBGB/[[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]] – General business rules for SQL operations\n- LIBGB/[[FILE:GBWSBR.CPY|GBWSBR.CPY]] – Shared business routines\n- LIBGB/[[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]] – Branch information for SQL\n- LIBLP/[[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] – Loan code definitions for SQL\n- (Others may be present in full context)\n\n(Source: [[FILE:PST593.CBL|PST593.CBL]], Index: copybook_usage)\n\n---\n\n### Summary Table (Multi-Column for Readability)\n\n| PST593   | PST599   | PST50K   | PST594   |\n|----------|----------|----------|----------|\n| [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] | [[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]] |\n| [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]] | [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]] | [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]] | [[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]] |\n| [[FILE:GBWSBR.CPY|GBWSBR.CPY]]     | [[FILE:GBWSBR.CPY|GBWSBR.CPY]]     | [[FILE:LP01BX_SQL.CPY|LP01BX_SQL.CPY]] | [[FILE:GBWSBR.CPY|GBWSBR.CPY]]     |\n| [[FILE:GB01BR_SQL.CPY|GB01BR_SQL.CPY]] | [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] | [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] | [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] |\n| [[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]] |                |               |                |\n\n---\n\n### Visual Representation\n\nHere's a visual representation of the programs with the most copybook dependencies:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Programs with Most Copybook Dependencies</text>\n  \n  <!-- Program boxes -->\n  <rect x=\"100\" y=\"80\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"160\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PST593</text>\n  \n  <rect x=\"300\" y=\"80\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"360\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PST599</text>\n  \n  <rect x=\"500\" y=\"80\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"560\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PST50K</text>\n  \n  <rect x=\"700\" y=\"80\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"760\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PST594</text>\n  \n  <!-- Copybook boxes -->\n  <rect x=\"220\" y=\"200\" width=\"120\" height=\"40\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"280\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LP01BW_SQL.CPY|LP01BW_SQL.CPY]]</text>\n  \n  <rect x=\"370\" y=\"260\" width=\"120\" height=\"40\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"430\" y=\"285\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:GBBRGS_SQL.CPY|GBBRGS_SQL.CPY]]</text>\n  \n  <rect x=\"520\" y=\"200\" width=\"120\" height=\"40\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"580\" y=\"225\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:GBWSBR.CPY|GBWSBR.CPY]]</text>\n  \n  <rect x=\"670\" y=\"260\" width=\"120\" height=\"40\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"730\" y=\"285\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LP01CD_SQL.CPY|LP01CD_SQL.CPY]]</text>\n  \n  <!-- Arrows from programs to copybooks -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"160\" y1=\"140\" x2=\"280\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"360\" y1=\"140\" x2=\"430\" y2=\"260\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"560\" y1=\"140\" x2=\"580\" y2=\"200\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"760\" y1=\"140\" x2=\"730\" y2=\"260\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n**Summary:**  \n- Programs like PST593, PST599, PST50K, and PST594 have the most dependencies on copybooks, each referencing 6 or more.\n- These programs are central to batch processing and reporting, requiring access to multiple data structures and business rules.\n- The most commonly referenced copybooks define SQL tables, business rules, and shared routines.\n\n(Source: [[FILE:M|M]]ultiple program copybook_usage indices, e.g., [[FILE:PST593.CBL|PST593.CBL]], [[FILE:PST599.CBL|PST599.CBL]], [[FILE:PST50K.CBL|PST50K.CBL]], [[FILE:PST594.CBL|PST594.CBL]])",
    "sources_count": 100,
    "timing_seconds": 14.356
  },
  "Q53": {
    "question": "How are program dependencies documented in OTIS?",
    "answer": "Program dependencies in the OTIS/OTOS COBOL application are documented using several structured mechanisms that allow developers and maintainers to understand how programs interact, which files and copybooks they use, and how business logic is modularized. Here’s how dependencies are typically documented:\n\n---\n\n**1. CALL Statements in Source Code**\n- COBOL programs use explicit `CALL` statements to invoke other programs.\n- Each call is documented in the source code, often with comments indicating the purpose of the call.\n- Example:\n  ```cobol\n  * CALL PROGRAM: Error handling routine\n  CALL 'ERRLOG' USING WS-ERROR-CODE, WS-ERROR-MSG\n  ```\n  (Source: [[FILE:LOADCO|LOADCO]], [[FILE:I|I]]ndex: flow_edges, line 96)\n\n---\n\n**2. Copybook Inclusion**\n- Programs include copybooks via the `COPY` statement, which brings in shared data structures, validation logic, or business rules.\n- The list of copybooks used by each program is documented in the program’s ENVIRONMENT or DATA DIVISION.\n- Example:\n  ```cobol\n  COPY LP01SP.\n  COPY GB01RC.\n  ```\n  (Source: program_deps, inferred from context)\n\n---\n\n**3. Flow and Dependency Indices**\n- The system maintains indices such as `flow_edges`, `program_deps`, and `flows` that record:\n  - Which programs call which other programs (static and dynamic calls)\n  - Which copybooks are used by each program\n  - The flow of control between paragraphs and modules\n- These indices are used to generate call graphs and dependency trees for analysis.\n\n---\n\n**4. Comments and Documentation Fields**\n- Many programs include comments at the start or near key logic sections explaining:\n  - Why a particular dependency exists\n  - What business process is supported by the call or copybook\n  - Historical context for design decisions\n- Example:\n  ```\n  * DOCUMENT DESIGN, ADDED A PROGRAM PREFIX FIELD\n  ```\n  (Source: [[FILE:GB|GB]]_RELNOT.190826.pr1385_DOCUMENT DESIGN, Index: help_fields)\n\n---\n\n**5. Help Fields and Screen Documentation**\n- Help fields and screen documentation often describe the purpose of program fields, especially when new dependencies are introduced.\n- Example:\n  - \"This field is a prefix that has been added to allow for developing a wider range of programs to be called.\"\n    (Source: [[FILE:MN|MN]]_FDMAIN_PRE, Index: help_fields)\n\n---\n\n**6. Flowcharts and Call Graphs**\n- Flowcharts (e.g., Mermaid diagrams in the `flows` index) visually document the flow between program modules and called routines.\n- Example:\n  ```\n  flowchart TD\n    MAIN-PROGRAM-LOOP--> FORM-RESET\n    MAIN-PROGRAM-LOOP--> ENTRY-MODULE\n    MAIN-PROGRAM-LOOP--> WRITE-MODULE\n  ```\n  (Source: [[FILE:LPMAN3|LPMAN3]], [[FILE:I|I]]ndex: flows)\n\n---\n\n**7. Menu Trees and UI Paths**\n- Menu trees (from the `menu_trees` index) show the hierarchical relationships between programs as navigated by users.\n- UI paths document which programs are invoked from specific menu options or screens.\n\n---\n\n**Summary Table: How Dependencies Are Documented**\n\n| Mechanism             | Example/Source                                    | Purpose                                    |\n|-----------------------|---------------------------------------------------|--------------------------------------------|\n| CALL statements       | `CALL 'ERRLOG' USING ...` (LOADCO, flow_edges)    | Program invocation                         |\n| COPY statements       | `COPY LP01SP.` (program_deps)                     | Shared data/business rules                 |\n| Flow indices          | `flow_edges`, `flows`, `program_deps`             | Call graphs, dependency analysis           |\n| Comments              | `* DOCUMENT DESIGN...` (GB_RELNOT, help_fields)   | Rationale, business context                |\n| Help fields           | `This field is a prefix...` (MN_FDMAIN_PRE)       | Field/program purpose                      |\n| Flowcharts            | Mermaid diagrams (LPMAN3, flows)                  | Visual flow documentation                  |\n| Menu trees/UI paths   | menu_trees, ui_paths                              | User navigation, program relationships     |\n\n---\n\n**Here's a visual representation of how program dependencies are documented in OTIS:**\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Program Dependency Documentation</text>\n  \n  <!-- Source Code Layer -->\n  <rect x=\"40\" y=\"70\" width=\"240\" height=\"80\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"160\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">Source Code</text>\n  <text x=\"160\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">CALL/COPY statements, comments</text>\n  \n  <!-- Indices Layer -->\n  <rect x=\"320\" y=\"70\" width=\"240\" height=\"80\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"440\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Dependency Indices</text>\n  <text x=\"440\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">flow_edges, program_deps, flows</text>\n  \n  <!-- Documentation Layer -->\n  <rect x=\"600\" y=\"70\" width=\"240\" height=\"80\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"720\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Documentation</text>\n  <text x=\"720\" y=\"120\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Help fields, comments, menu trees</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"280\" y1=\"110\" x2=\"320\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"560\" y1=\"110\" x2=\"600\" y2=\"110\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Flowchart Layer -->\n  <rect x=\"200\" y=\"200\" width=\"500\" height=\"80\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"230\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b45309\">Flowcharts & Call Graphs</text>\n  <text x=\"450\" y=\"250\" text-anchor=\"middle\" font-size=\"12\" fill=\"#f59e0b\">Visual representation of dependencies</text>\n  \n  <!-- Arrows down -->\n  <line x1=\"160\" y1=\"150\" x2=\"450\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"440\" y1=\"150\" x2=\"450\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"720\" y1=\"150\" x2=\"450\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**In summary:**  \nOTIS documents program dependencies through a combination of explicit source code statements (CALL, COPY), structured indices (flow_edges, program_deps), comments, help fields, and visual flowcharts. This multi-layered approach ensures that both technical and business stakeholders can trace how programs interact and what resources they depend on.\n\n**Sources:**  \n- LOADCO (Source: [[FILE:LOADCO|LOADCO]], [[FILE:I|I]]ndex: flow_edges)  \n- GB_RELNOT (Source: [[FILE:GB|GB]]_RELNOT.190826.pr1385, Index: help_fields)  \n- MN_FDMAIN_PRE (Source: [[FILE:MN|MN]]_FDMAIN_PRE, Index: help_fields)  \n- LPMAN3 (Source: [[FILE:LPMAN3|LPMAN3]], [[FILE:I|I]]ndex: flows)  \n- program_deps (inferred from context)",
    "sources_count": 200,
    "timing_seconds": 17.804
  },
  "Q54": {
    "question": "What circular dependencies or complex relationships exist?",
    "answer": "Circular dependencies and complex relationships in the OTIS/OTOS COBOL system are relatively rare, but there are a few notable cases and patterns based on the retrieved context:\n\n### 1. **Circular Dependencies**\n- **PST593** is explicitly documented as participating in call cycles:\n  - \"PST593 | makes 1 calls to 1 unique programs | called by 1 programs (1 total calls) | participates in call cycles | call depth 51\"\n  - This means PST593 both calls another program and is called by it (directly or indirectly), forming a loop in the call graph.\n  - Such cycles can complicate program flow, error handling, and maintenance.\n  - **Source:** PST593, Index: programs\n\n### 2. **Self-Referential Paragraphs (Local Cycles)**\n- Several programs use **GO TO** or **PERFORM** statements that loop back to the same paragraph, creating local cycles within a program:\n  - **GRLST2:** \"GO TO PARENT-LOOP\" (loops within PARENT-LOOP paragraph)\n    - **Source:** GRLST2, Index: flow_edges\n  - **PITBO2:** \"GO TO FIX-NAME-LOOP2\" (loops within FIX-NAME-LOOP2)\n    - **Source:** PITBO2, Index: flow_edges\n  - **LN1099:** \"GO TO FIX-NAME-LOOP\" (loops within FIX-NAME-LOOP)\n    - **Source:** LN1099, Index: flow_edges\n  - **IR1098:** \"GO TO MERGE-LOOP\" (loops within MERGE-LOOP)\n    - **Source:** IR1098, Index: flow_edges\n  - **IRPREP:** \"GO TO LOOP-REC-C-B\" (loops within LOOP-REC-C-B)\n    - **Source:** IRPREP, Index: flow_edges\n\n  These are not inter-program cycles, but they do represent complex intra-program control flow.\n\n### 3. **Complex Call Chains**\n- Programs with high call depth or multiple branches can create intricate relationships:\n  - **PST593** (call depth 51) is an outlier, indicating a very deep or recursive call structure.\n  - Programs like **SCRN1**, **DISBI0**, **O2MORP**, **BHBWLN**, **BWLNRP**, **O3MORP**, **JCMAIN** all make multiple calls to unique programs, but do not show cycles in the retrieved context.\n  - **Source:** Various program documents, Index: programs\n\n### 4. **Perform Chains Across Paragraphs**\n- Several programs use **PERFORM** statements to jump between paragraphs, sometimes in a chain that can be hard to follow:\n  - Example: **LCMAIN** performs from QLN3-WBEG-ACCTNO to LOANS-EXIST.\n    - **Source:** LCMAIN, Index: flow_edges\n\n### 5. **Inter-Program Cycles (Rare)**\n- The only explicit inter-program cycle in the retrieved context is for **PST593**.\n- Most other programs are either root (make calls but not called) or isolated (no detected call relationships).\n\n---\n\n## Summary Table: Circular/Complex Relationships\n\n| Program   | Type of Relationship         | Description/Source                                 |\n|-----------|-----------------------------|----------------------------------------------------|\n| PST593    | Inter-program cycle         | Calls and is called by another program (cycle)     |\n| GRLST2    | Intra-program loop          | GO TO PARENT-LOOP (self-referential)              |\n| PITBO2    | Intra-program loop          | GO TO FIX-NAME-LOOP2 (self-referential)            |\n| LN1099    | Intra-program loop          | GO TO FIX-NAME-LOOP (self-referential)             |\n| IR1098    | Intra-program loop          | GO TO MERGE-LOOP (self-referential)                |\n| IRPREP    | Intra-program loop          | GO TO LOOP-REC-C-B (self-referential)              |\n| LCMAIN    | Complex perform chain       | PERFORM between paragraphs (QLN3-WBEG-ACCTNO → LOANS-EXIST) |\n| SCRN1, DISBI0, O2MORP, etc. | Complex call chains | Multiple calls, high call depth, but no cycles detected |\n\n---\n\n## Visual Representation\n\nHere's a visual representation of the circular and complex relationships:\n\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">Circular & Complex Relationships in OTIS</text>\n  \n  <!-- PST593 cycle -->\n  <rect x=\"100\" y=\"100\" width=\"120\" height=\"60\" fill=\"#ef4444\" stroke=\"#dc2626\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"160\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PST593</text>\n  <text x=\"160\" y=\"150\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Inter-program cycle</text>\n  <rect x=\"270\" y=\"100\" width=\"120\" height=\"60\" fill=\"#ef4444\" stroke=\"#dc2626\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"330\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">Other Program</text>\n  <text x=\"330\" y=\"150\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Cycle partner</text>\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#dc2626\"/>\n    </marker>\n  </defs>\n  <line x1=\"220\" y1=\"130\" x2=\"270\" y2=\"130\" stroke=\"#dc2626\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"390\" y1=\"130\" x2=\"100\" y2=\"130\" stroke=\"#dc2626\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  \n  <!-- Intra-program loops -->\n  <rect x=\"550\" y=\"80\" width=\"120\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"610\" y=\"110\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">GRLST2</text>\n  <text x=\"610\" y=\"130\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Self-loop</text>\n  <ellipse cx=\"610\" cy=\"170\" rx=\"30\" ry=\"18\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\"/>\n  <text x=\"610\" y=\"175\" text-anchor=\"middle\" fill=\"white\" font-size=\"12\">PARENT-LOOP</text>\n  <line x1=\"610\" y1=\"140\" x2=\"610\" y2=\"152\" stroke=\"#d97706\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"610\" y1=\"188\" x2=\"610\" y2=\"110\" stroke=\"#d97706\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  \n  <rect x=\"550\" y=\"220\" width=\"120\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"610\" y=\"250\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">PITBO2</text>\n  <text x=\"610\" y=\"270\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Self-loop</text>\n  <ellipse cx=\"610\" cy=\"310\" rx=\"30\" ry=\"18\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\"/>\n  <text x=\"610\" y=\"315\" text-anchor=\"middle\" fill=\"white\" font-size=\"12\">FIX-NAME-LOOP2</text>\n  <line x1=\"610\" y1=\"280\" x2=\"610\" y2=\"292\" stroke=\"#d97706\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"610\" y1=\"328\" x2=\"610\" y2=\"250\" stroke=\"#d97706\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  \n  <!-- Complex call chain example -->\n  <rect x=\"100\" y=\"300\" width=\"120\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"160\" y=\"330\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">SCRN1</text>\n  <text x=\"160\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Multiple calls</text>\n  <rect x=\"270\" y=\"300\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"330\" y=\"330\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">DISBI0</text>\n  <text x=\"330\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Multiple calls</text>\n  <rect x=\"440\" y=\"300\" width=\"120\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"500\" y=\"330\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">O2MORP</text>\n  <text x=\"500\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Multiple calls</text>\n  <line x1=\"220\" y1=\"330\" x2=\"270\" y2=\"330\" stroke=\"#4338ca\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"390\" y1=\"330\" x2=\"440\" y2=\"330\" stroke=\"#16a34a\" stroke-width=\"3\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### **Conclusion**\n- **PST593** is the only program with a documented inter-program circular dependency.\n- Several programs have intra-program loops via GO TO or PERFORM, which can make local logic complex.\n- Programs with many calls or high call depth (e.g., SCRN1, DISBI0, O2MORP) have complex but acyclic relationships in the retrieved context.\n- No other explicit inter-program cycles are shown in the current data.\n\n**Sources:** PST593, GRLST2, PITBO2, LN1099, IR1098, IRPREP, LCMAIN, SCRN1, DISBI0, O2MORP (Index: programs, flow_edges)",
    "sources_count": 100,
    "timing_seconds": 17.525
  },
  "Q55": {
    "question": "What programs are entry points that users interact with directly?",
    "answer": "The entry point programs that users interact with directly in the OTIS/OTOS COBOL system are typically those that:\n\n- Present menus, forms, or screens for user input\n- Serve as the initial program for a business workflow\n- Are not just called by other programs, but are launched from the main menu, submenus, or direct transaction codes\n\n### Key Entry Point Programs (User-Facing)\n\nBased on the retrieved context, the following programs are entry points for user interaction:\n\n#### 1. **Menu and Main Screen Programs**\nThese programs display menus or main screens and route users to subsystems:\n\n- **LPMENU** – Loan Processing Main Menu (Source: [[FILE:LPMENU|LPMENU]], [[FILE:I|I]]ndex: programs)\n- **SCMENU** – Subsystem Control Menu (Source: [[FILE:SCMENU|SCMENU]], [[FILE:I|I]]ndex: programs)\n- **CLMENU** – Collections Menu (Source: [[FILE:CLMENU|CLMENU]], [[FILE:I|I]]ndex: flows)\n- **PGMENU** – General Main Menu (not in this context, but commonly referenced in OTIS systems)\n- **SNMAIN** – Special Notes Main Screen (Source: [[FILE:SNMAIN|SNMAIN]], [[FILE:I|I]]ndex: flows)\n- **PWMAIN** – Password Maintenance Main Screen (Source: [[FILE:PWMAIN|PWMAIN]], [[FILE:I|I]]ndex: flows)\n\n#### 2. **Subsystem Entry Programs**\nThese are the main programs for specific business areas, often launched from menus:\n\n- **LTMAIN** – Loan Type Maintenance (Source: [[FILE:LTMAIN|LTMAIN]], [[FILE:I|I]]ndex: flows)\n- **STMAIN** – State/County Maintenance (Source: [[FILE:STMAIN|STMAIN]], [[FILE:I|I]]ndex: flows)\n- **BRMAN7** – Branch Maintenance (Source: [[FILE:BRMAN7|BRMAN7]], [[FILE:I|I]]ndex: flows)\n- **EQMAIN** – Equipment Maintenance (Source: [[FILE:EQMAIN|EQMAIN]], [[FILE:I|I]]ndex: flows)\n- **AQMAIN** – Account Maintenance (Source: [[FILE:AQMAIN|AQMAIN]], [[FILE:I|I]]ndex: flows)\n- **ICMAIN** – Insurance Code Maintenance (Source: [[FILE:ICMAIN|ICMAIN]], [[FILE:I|I]]ndex: flows)\n- **GRMAIN** – Group Maintenance (Source: [[FILE:GRMAIN|GRMAIN]], [[FILE:I|I]]ndex: flows)\n- **LMMAIN** – Loan Maintenance (Source: [[FILE:LMMAIN|LMMAIN]], [[FILE:I|I]]ndex: flows)\n- **NOMAIN** – Note Maintenance (Source: [[FILE:NOMAIN|NOMAIN]], [[FILE:I|I]]ndex: flows)\n- **DBMAIN** – Dealer Branch Maintenance (Source: [[FILE:DBMAIN|DBMAIN]], [[FILE:I|I]]ndex: flows)\n- **PSMAIN** – Payment Schedule Maintenance (Source: [[FILE:PSMAIN|PSMAIN]], [[FILE:I|I]]ndex: flows)\n- **CXMAIN** – Customer Index Maintenance (Source: [[FILE:CXMAIN|CXMAIN]], [[FILE:I|I]]ndex: flows)\n- **CJMAIN** – Customer Journal Maintenance (Source: [[FILE:CJMAIN|CJMAIN]], [[FILE:I|I]]ndex: flows)\n- **FMMAIN** – File Maintenance (Source: [[FILE:FMMAIN|FMMAIN]], [[FILE:I|I]]ndex: flows)\n- **BYMAIN** – Branch Statistics Inquiry (Source: [[FILE:BYMAIN|BYMAIN]], [[FILE:I|I]]ndex: flows)\n- **CKMAIN** – Check Maintenance (Source: [[FILE:CKMAIN|CKMAIN]], [[FILE:I|I]]ndex: flows)\n- **SSMAIN** – Subsystem Maintenance (Source: [[FILE:SSMAIN.CBL|SSMAIN.CBL]], Index: copybook_usage)\n- **EAMAIN** – Equipment Asset Maintenance (Source: [[FILE:EAMAIN.CBL|EAMAIN.CBL]], Index: copybook_usage)\n- **DLMAIN** – Dealer Maintenance (Source: [[FILE:DLMAIN.CBL|DLMAIN.CBL]], Index: copybook_usage)\n- **LNMAIN** – Loan Maintenance (Source: [[FILE:LNMAIN.CBL|LNMAIN.CBL]], Index: copybook_usage)\n\n#### 3. **Inquiry and Utility Programs**\nThese programs allow users to perform inquiries or utility functions:\n\n- **UTMAIN** – Utility Main Program (Source: [[FILE:UTMAIN|UTMAIN]], [[FILE:I|I]]ndex: programs)\n- **ENTRY** – General Entry Point (Source: [[FILE:ENTRY|ENTRY]], [[FILE:I|I]]ndex: programs; called by 3 programs, likely a user-facing entry)\n\n#### 4. **Batch/Transaction Drivers**\nSome programs are entry points for batch jobs or transaction processing, sometimes invoked by users or operators:\n\n- **TCLP** – Transaction Driver (Source: [[FILE:TCLP.CBL|TCLP.CBL]], Index: code)\n- **TCLPWO** – Transaction Driver (Source: [[FILE:TCLPWO|TCLPWO]], [[FILE:I|I]]ndex: programs)\n\n---\n\n### How to Identify Entry Points\n\nEntry point programs are characterized by:\n- Being listed as \"root program\" (makes calls but not called by others)\n- Having menu or main screen logic (often SCREEN SECTION, menu display, or main workflow)\n- Appearing in menu trees or as the first program in a workflow\n\n---\n\n### Visual Representation\n\nHere's a visual diagram showing the relationships of key entry point programs (menus and subsystems):\n\n<svg width=\"1200\" height=\"600\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"600\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">User Entry Points in OTIS/OTOS System</text>\n  \n  <!-- Main Menus -->\n  <rect x=\"500\" y=\"70\" width=\"200\" height=\"70\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"600\" y=\"105\" text-anchor=\"middle\" fill=\"white\" font-size=\"18\" font-weight=\"bold\">Main Menus</text>\n  <text x=\"600\" y=\"125\" text-anchor=\"middle\" fill=\"white\" font-size=\"12\">LPMENU, SCMENU, CLMENU, PGMENU</text>\n  \n  <!-- Subsystems Row 1 -->\n  <rect x=\"100\" y=\"200\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"180\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">LTMAIN</text>\n  <text x=\"180\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Type Maint.</text>\n  \n  <rect x=\"300\" y=\"200\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"380\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">STMAIN</text>\n  <text x=\"380\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">State/County Maint.</text>\n  \n  <rect x=\"500\" y=\"200\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"580\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">BRMAN7</text>\n  <text x=\"580\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Branch Maint.</text>\n  \n  <rect x=\"700\" y=\"200\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"780\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">EQMAIN</text>\n  <text x=\"780\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Equipment Maint.</text>\n  \n  <rect x=\"900\" y=\"200\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"980\" y=\"230\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">AQMAIN</text>\n  <text x=\"980\" y=\"248\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Account Maint.</text>\n  \n  <!-- Subsystems Row 2 -->\n  <rect x=\"100\" y=\"320\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"180\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">ICMAIN</text>\n  <text x=\"180\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Insurance Code Maint.</text>\n  \n  <rect x=\"300\" y=\"320\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"380\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">GRMAIN</text>\n  <text x=\"380\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Group Maint.</text>\n  \n  <rect x=\"500\" y=\"320\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"580\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">LMMAIN</text>\n  <text x=\"580\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Loan Maint.</text>\n  \n  <rect x=\"700\" y=\"320\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"780\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">NOMAIN</text>\n  <text x=\"780\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Note Maint.</text>\n  \n  <rect x=\"900\" y=\"320\" width=\"160\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"980\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"14\" font-weight=\"bold\">DBMAIN</text>\n  <text x=\"980\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Dealer Branch Maint.</text>\n  \n  <!-- Arrows from Main Menus to Subsystems -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"600\" y1=\"140\" x2=\"180\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"380\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"580\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"780\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"980\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"180\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"380\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"580\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"780\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"600\" y1=\"140\" x2=\"980\" y2=\"320\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n\n---\n\n### Source Citations\n\n- LPMENU (Source: [[FILE:LPMENU|LPMENU]], [[FILE:I|I]]ndex: programs)\n- SCMENU (Source: [[FILE:SCMENU|SCMENU]], [[FILE:I|I]]ndex: programs)\n- CLMENU (Source: [[FILE:CLMENU|CLMENU]], [[FILE:I|I]]ndex: flows)\n- SNMAIN (Source: [[FILE:SNMAIN|SNMAIN]], [[FILE:I|I]]ndex: flows)\n- PWMAIN (Source: [[FILE:PWMAIN|PWMAIN]], [[FILE:I|I]]ndex: flows)\n- LTMAIN (Source: [[FILE:LTMAIN|LTMAIN]], [[FILE:I|I]]ndex: flows)\n- STMAIN (Source: [[FILE:STMAIN|STMAIN]], [[FILE:I|I]]ndex: flows)\n- BRMAN7 (Source: [[FILE:BRMAN7|BRMAN7]], [[FILE:I|I]]ndex: flows)\n- EQMAIN (Source: [[FILE:EQMAIN|EQMAIN]], [[FILE:I|I]]ndex: flows)\n- AQMAIN (Source: [[FILE:AQMAIN|AQMAIN]], [[FILE:I|I]]ndex: flows)\n- ICMAIN (Source: [[FILE:ICMAIN|ICMAIN]], [[FILE:I|I]]ndex: flows)\n- GRMAIN (Source: [[FILE:GRMAIN|GRMAIN]], [[FILE:I|I]]ndex: flows)\n- LMMAIN (Source: [[FILE:LMMAIN|LMMAIN]], [[FILE:I|I]]ndex: flows)\n- NOMAIN (Source: [[FILE:NOMAIN|NOMAIN]], [[FILE:I|I]]ndex: flows)\n- DBMAIN (Source: [[FILE:DBMAIN|DBMAIN]], [[FILE:I|I]]ndex: flows)\n- PSMAIN (Source: [[FILE:PSMAIN|PSMAIN]], [[FILE:I|I]]ndex: flows)\n- CXMAIN (Source: [[FILE:CXMAIN|CXMAIN]], [[FILE:I|I]]ndex: flows)\n- CJMAIN (Source: [[FILE:CJMAIN|CJMAIN]], [[FILE:I|I]]ndex: flows)\n- FMMAIN (Source: [[FILE:FMMAIN|FMMAIN]], [[FILE:I|I]]ndex: flows)\n- BYMAIN (Source: [[FILE:BYMAIN|BYMAIN]], [[FILE:I|I]]ndex: flows)\n- CKMAIN (Source: [[FILE:CKMAIN|CKMAIN]], [[FILE:I|I]]ndex: flows)\n- SSMAIN (Source: [[FILE:SSMAIN.CBL|SSMAIN.CBL]], Index: copybook_usage)\n- EAMAIN (Source: [[FILE:EAMAIN.CBL|EAMAIN.CBL]], Index: copybook_usage)\n- DLMAIN (Source: [[FILE:DLMAIN.CBL|DLMAIN.CBL]], Index: copybook_usage)\n- LNMAIN (Source: [[FILE:LNMAIN.CBL|LNMAIN.CBL]], Index: copybook_usage)\n- UTMAIN (Source: [[FILE:UTMAIN|UTMAIN]], [[FILE:I|I]]ndex: programs)\n- ENTRY (Source: [[FILE:ENTRY|ENTRY]], [[FILE:I|I]]ndex: programs)\n- TCLP (Source: [[FILE:TCLP.CBL|TCLP.CBL]], Index: code)\n- TCLPWO (Source: [[FILE:TCLPWO|TCLPWO]], [[FILE:I|I]]ndex: programs)\n\n---\n\n**Summary:**  \nThese programs are the main entry points for user interaction in the OTIS/OTOS COBOL system, serving as menus, main screens, or subsystem drivers. Users typically start their workflow by launching one of these programs, which then route them to more specialized modules as needed.",
    "sources_count": 100,
    "timing_seconds": 21.915
  },
  "Q56": {
    "question": "What are the performance considerations in OTIS program design?",
    "answer": "Performance considerations in OTIS/OTOS COBOL program design are addressed through several deliberate strategies, as evidenced by code comments, program structure, and copybook usage in the retrieved context.\n\n---\n\n### Key Performance Strategies in OTIS/OTOS\n\n#### 1. **Minimizing I/O Operations**\n- Programs often use hardcoded I/O routines with limited columns to reduce unnecessary data reads/writes, improving speed.\n- Example:  \n  > \"*THIS IS A COPY OF LP/[[FILE:LNAGED.CBL|LNAGED.CBL]] FOR TESTING THE NEW SQL-COL.SH SCRIPT THAT GETS THE SQL COLUMNS USED IN THE PROGRAM SO THAT HARDCODED IO ROUTINES WITH LIMITED COLUMNS ARE USED TO IMPROVE PERFORMANCE.*\"  \n  (Source: [[FILE:LNAGKC.CBL|LNAGKC.CBL]], Index: code)\n\n#### 2. **Selective Data Access**\n- Only required fields are accessed, avoiding full record reads when possible.\n- This is especially important in programs handling large files or batch operations.\n\n#### 3. **Pacing and Throttling**\n- Several programs implement a \"PACE-ROUTINE\" to monitor and control execution speed, preventing resource exhaustion and ensuring system responsiveness.\n- Example code pattern:\n  ```cobol\n  IF ( EXT-ROUTE-BUF NOT = \"00\" )\n     GO TO PACE-ROUTINE-EXIT.\n\n  ADD 01 TO PACE-COUNTER.\n\n  IF ( PACE-COUNTER <= PACE-COUNTER-MAX )\n     GO TO PACE-ROUTINE-EXIT.\n  ```\n  (Source: [[FILE:IORXRN.CBL|IORXRN.CBL]], [[FILE:IOFMRN.CBL|IOFMRN.CBL]], [[FILE:IOLSDR.CBL|IOLSDR.CBL]], [[FILE:IOTRDR.CBL|IOTRDR.CBL]], [[FILE:IOSPRN.CBL|IOSPRN.CBL]], [[FILE:IOTRPR.CBL|IOTRPR.CBL]], [[FILE:IOLTDR.CBL|IOLTDR.CBL]], Index: code)\n\n- **Purpose:**  \n  - Limits the number of operations per cycle.\n  - Prevents runaway loops and excessive CPU usage.\n  - Allows for periodic checks or pauses, which is critical in batch and online transaction processing.\n\n#### 4. **Batch vs. Online Processing**\n- Programs are designed to distinguish between batch and online modes, optimizing resource usage for each.\n- Batch programs may process large volumes with pacing, while online programs prioritize quick response.\n\n#### 5. **Modularization and Reuse**\n- Common routines (e.g., FORM-RESET, ENTRY-MODULE, WRITE-MODULE) are reused across programs, reducing code duplication and improving maintainability.\n- This modular approach allows for targeted optimization of frequently used routines.\n\n#### 6. **Limiting Data Scope**\n- Use of constraints such as MAX, OCCURS, and array dimensions to restrict the amount of data processed at once.\n- Example:  \n  - Limiting the number of modifiable entries or fields per user interaction.\n\n#### 7. **Efficient Error Handling**\n- Early exits and error checks (e.g., GO TO PACE-ROUTINE-EXIT) prevent unnecessary processing when errors or exceptions are detected.\n\n#### 8. **File and Copybook Organization**\n- Copybooks are organized to separate frequently accessed data from rarely used fields, allowing programs to include only what is necessary.\n\n---\n\n### Example: PACE-ROUTINE Implementation\n\nThe following code snippet is typical of the pacing logic found in many OTIS programs:\n\n```cobol\nPACE-ROUTINE SECTION.\n\n    IF ( EXT-ROUTE-BUF NOT = \"00\" )\n       GO TO PACE-ROUTINE-EXIT.\n\n    ADD 01 TO PACE-COUNTER.\n\n    IF ( PACE-COUNTER <= PACE-COUNTER-MAX )\n       GO TO PACE-ROUTINE-EXIT.\n\n    ADD 01 TO PACE-LEV.\n```\n(Source: [[FILE:IORXRN.CBL|IORXRN.CBL]], [[FILE:IOFMRN.CBL|IOFMRN.CBL]], [[FILE:IOLSDR.CBL|IOLSDR.CBL]], [[FILE:IOTRDR.CBL|IOTRDR.CBL]], [[FILE:IOSPRN.CBL|IOSPRN.CBL]], [[FILE:IOTRPR.CBL|IOTRPR.CBL]], [[FILE:IOLTDR.CBL|IOLTDR.CBL]], Index: code)\n\n**Business Purpose:**  \n- Ensures that processing is paced, preventing system overload and maintaining predictable performance.\n\n---\n\n### Historical Context\n\n- Comments indicate ongoing efforts to improve performance, such as testing new scripts for SQL column selection and refining I/O routines.\n- The use of pacing routines and selective data access reflects mainframe-era best practices, where resource constraints were significant.\n\n---\n\n### Summary Table: Performance Techniques\n\n| Technique                  | Purpose                                      | Example/Source                      |\n|----------------------------|----------------------------------------------|-------------------------------------|\n| Hardcoded I/O routines     | Reduce unnecessary data access               | [[FILE:LNAGKC.CBL|LNAGKC.CBL]], code                    |\n| PACE-ROUTINE               | Throttle processing, avoid overload          | [[FILE:IORXRN.CBL|IORXRN.CBL]], [[FILE:IOFMRN.CBL|IOFMRN.CBL]], code        |\n| Selective field access     | Minimize memory and I/O usage                | [[FILE:LNAGKC.CBL|LNAGKC.CBL]], code                    |\n| Modular routines           | Reuse optimized code                         | Multiple programs, flows            |\n| Data scope constraints     | Limit processing to manageable chunks        | Various programs, inferred          |\n| Early error exits          | Prevent wasted cycles on error               | PACE-ROUTINE, code                  |\n\n---\n\n### Visual Representation\n\nHere's a visual representation of how performance considerations are layered in OTIS program design:\n\n<svg width=\"700\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Performance Architecture</text>\n  \n  <!-- Presentation Layer -->\n  <rect x=\"50\" y=\"70\" width=\"600\" height=\"100\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"95\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">User Interaction Layer</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" font-size=\"14\" fill=\"#4338ca\">Screens, Entry Points, Menus</text>\n  <text x=\"350\" y=\"140\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Limited Data Scope</text>\n  \n  <!-- Business Logic Layer -->\n  <rect x=\"50\" y=\"200\" width=\"600\" height=\"100\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"225\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#1e40af\">Processing Layer</text>\n  <text x=\"350\" y=\"250\" text-anchor=\"middle\" font-size=\"14\" fill=\"#1e40af\">Modular Routines, Pacing, Error Handling</text>\n  <text x=\"350\" y=\"270\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Selective Field Access</text>\n  \n  <!-- Data Layer -->\n  <rect x=\"50\" y=\"330\" width=\"600\" height=\"100\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"355\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#15803d\">Data Layer</text>\n  <text x=\"350\" y=\"380\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">Hardcoded I/O, Copybook Organization</text>\n  <text x=\"350\" y=\"400\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Efficient File Access</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"170\" x2=\"350\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"300\" x2=\"350\" y2=\"330\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**References:**\n- [[FILE:LNAGKC.CBL|LNAGKC.CBL]], Index: code (SQL column selection, hardcoded I/O)\n- [[FILE:IORXRN.CBL|IORXRN.CBL]], [[FILE:IOFMRN.CBL|IOFMRN.CBL]], [[FILE:IOLSDR.CBL|IOLSDR.CBL]], [[FILE:IOTRDR.CBL|IOTRDR.CBL]], [[FILE:IOSPRN.CBL|IOSPRN.CBL]], [[FILE:IOTRPR.CBL|IOTRPR.CBL]], [[FILE:IOLTDR.CBL|IOLTDR.CBL]], Index: code (PACE-ROUTINE)\n- Multiple program flows and copybook usage (modularization, selective access)\n\nIf you need details on a specific program's performance logic, please specify the program name.",
    "sources_count": 100,
    "timing_seconds": 18.91
  },
  "Q57": {
    "question": "How does OTIS handle concurrent access and multi-user scenarios?",
    "answer": "OTIS/OTOS handles concurrent access and multi-user scenarios through a combination of record locking, user-specific working files, error handling, and business logic designed to prevent data conflicts and ensure data integrity. Here’s a detailed breakdown based on the retrieved context:\n\n---\n\n### 1. **Record Locking Mechanisms**\n\n- **Lock Flags and Retry Logic:**  \n  The system uses flags such as `ERROR-LOCK-FG` and counters like `LOCK-STATUS-99-RETRIES` to detect and manage record locks. When a record is locked by another user, the program will:\n  - Check if the lock flag is set (`IF ERROR-LOCK-FG = \"Y\"`).\n  - Retry the operation up to a set limit (e.g., 10 times).\n  - If the retry limit is reached, it moves error information to status fields and displays a message to the user.\n  - Example logic:\n    ```cobol\n    IF ERROR-LOCK-FG = \"Y\"\n       GO TO END-DECLARE\n    END-IF\n    PERFORM SUSPEND\n    ADD 1 TO LOCK-STATUS-99-RETRIES\n    IF LOCK-STATUS-99-RETRIES = 10\n       MOVE 0 TO LOCK-STATUS-99-RETRIES\n       MOVE FILE-STAT TO E-STATUS-ERROR\n       MOVE E-FILE TO E-FILEX\n       MOVE FORM-PATHNAME  TO E-PROG\n       MOVE ERROR-MSG-HEAD TO ERRMSG-HEAD\n       MOVE \"RECORD LOCKED BY ANOTHER USER\" TO ERRMSG\n    ```\n    (Source: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code)\n\n- **SQL-Level Lock Handling:**  \n  For SQL-based files, the system checks for lock status codes (e.g., `IO-FG = 8` for locked records) and routes to error handling routines if a lock is detected.\n  - Example:\n    ```cobol\n    IF ( IO-FG = 8 )     *> LOCKED\n       GO TO DELETE-TRB1-FILE-MULT.\n    ```\n    (Source: [[FILE:MB4ALL.CBL|MB4ALL.CBL]], Index: code)\n\n---\n\n### 2. **User-Specific Working Files**\n\n- **Virtual Queue Files (VCQFILE):**  \n  To avoid conflicts when multiple users are working on the same set of records (e.g., collections), OTIS loads all relevant records into a user-specific working file (VCQFILE). Each user interacts with their own copy, reducing contention.\n  - Comments explain that this approach was implemented to resolve issues with locking and out-of-order display during multi-user testing:\n    ```\n    IN MARCH 2025, BETH AND JAY WORKED ON THE ISSUES THAT S35 USER TESTING WAS GETTING (LOCKING, DISPLAY OUT OF ORDER, NOT GETTING THE NEXT ACCOUNT WHEN SKIPPING). ... NOW IN THE COLLECTION WORK SCREEN (SPINQ & XPINQ; LIBSP/SPINQ2), AT THE START, IT WILL LOAD ALL CQ-REC FOR THAT GIVEN BRANCH INTO THE USER'S VCQFILE THEN IT WILL GO THROUGH IT USING VCQ2-KEY\n    ```\n    (Source: [[FILE:SPINQ2.CPY|SPINQ2.CPY]], Index: code)\n\n- **Concurrency Resolution:**  \n  When updating records, the system checks that the record in the main file matches the user's working copy before allowing updates, preventing overwrites from concurrent sessions.\n  - Example steps:\n    ```\n    1. MOVE CQ-REC TO HOLD-CQ-REC\n    2. MOVE ZEROES TO CQ-SEQ\n    3. READ CQFILE TO GET CQ-REC\n    4. MOVE VCQ-SEQ INTO CQ-SEQ OF RECENT READ CQ-REC\n    5. CHECK IF CQ-REC (SQL) EQUALS VCQ-CQ-REC\n       A. IF EQUAL, MOVE HOLD-CQ-REC BACK TO CQ-REC\n       B. IF NOT EQUAL, DISPLAY MESSAGE & FORCE EXIT OF PROGRAM\n    6. REWRITE CQ-REC AND VCQ-REC\n    ```\n    (Source: [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]], Index: code)\n\n---\n\n### 3. **Error Handling and User Notification**\n\n- **Immediate Feedback:**  \n  If a record is locked or has been modified by another user, OTIS provides immediate feedback via error messages and may force the user to exit the program to prevent data corruption.\n  - Example:\n    ```\n    IF NOT EQUAL, DISPLAY MESSAGE & FORCE EXIT OF PROGRAM\n    ```\n    (Source: [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]], Index: code)\n\n- **Business Rule Enforcement:**  \n  Comments indicate that the system was specifically enhanced to address multi-user issues, such as locking and navigation, based on user testing and real-world scenarios.\n\n---\n\n### 4. **Concurrency in Batch and SQL Operations**\n\n- **SQL Connection Management:**  \n  Programs manage SQL connections carefully, ensuring that connections are opened and closed as needed, and handling errors if reconnection fails. This prevents resource contention and ensures that batch operations do not interfere with interactive sessions.\n  - Example:\n    ```\n    IF BY1-CONN-OPEN-SW = \"N\"\n        EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS BY1_CONNECT\n        USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD\n        END-EXEC\n        MOVE \"Y\" TO BY1-CONN-OPEN-SW\n    ```\n    (Source: [[FILE:RZMALL.CBL|RZMALL.CBL]], Index: code)\n\n---\n\n### 5. **Historical Context and Design Evolution**\n\n- **Design Changes Driven by User Testing:**  \n  Multiple comments document that concurrency solutions (such as VCQFILE and enhanced locking logic) were implemented in response to issues found during multi-user testing, showing a responsive and iterative approach to concurrency management.\n\n---\n\n## Summary Table: Concurrency Techniques in OTIS\n\n| Technique                | Purpose                                      | Example/Source                      |\n|--------------------------|----------------------------------------------|-------------------------------------|\n| Record Locking           | Prevent simultaneous updates                 | [[FILE:DECLARE.CPY|DECLARE.CPY]], [[FILE:MB4ALL.CBL|MB4ALL.CBL]]             |\n| Retry/Timeout Logic      | Avoid indefinite waits on locked records     | [[FILE:DECLARE.CPY|DECLARE.CPY]]                         |\n| User-Specific Work Files | Isolate user sessions, reduce contention     | [[FILE:SPINQ2.CPY|SPINQ2.CPY]], [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]]             |\n| Record Comparison        | Prevent overwrites from concurrent sessions  | [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]]                         |\n| Error Messaging          | Notify users of conflicts                    | [[FILE:DECLARE.CPY|DECLARE.CPY]], [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]]            |\n| SQL Connection Control   | Manage batch vs. interactive concurrency     | [[FILE:RZMALL.CBL|RZMALL.CBL]]                          |\n\n---\n\n## Visual Representation:\n\nHere's a visual representation of how OTIS handles concurrent access and multi-user scenarios:\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Multi-User & Concurrency Architecture</text>\n  \n  <!-- User Sessions -->\n  <rect x=\"60\" y=\"70\" width=\"180\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"150\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">User Session A</text>\n  <rect x=\"260\" y=\"70\" width=\"180\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">User Session B</text>\n  <rect x=\"460\" y=\"70\" width=\"180\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"550\" y=\"100\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">User Session C</text>\n  \n  <!-- VCQFILEs -->\n  <rect x=\"120\" y=\"170\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"180\" y=\"200\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1e40af\">VCQFILE A</text>\n  <rect x=\"320\" y=\"170\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"380\" y=\"200\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1e40af\">VCQFILE B</text>\n  <rect x=\"520\" y=\"170\" width=\"120\" height=\"50\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"580\" y=\"200\" text-anchor=\"middle\" font-size=\"13\" fill=\"#1e40af\">VCQFILE C</text>\n  \n  <!-- Main Data File -->\n  <rect x=\"320\" y=\"270\" width=\"260\" height=\"70\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"305\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">Main Data File (CQFILE)</text>\n  \n  <!-- Arrows: User Sessions to VCQFILEs -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"150\" y1=\"140\" x2=\"180\" y2=\"170\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"140\" x2=\"380\" y2=\"170\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"550\" y1=\"140\" x2=\"580\" y2=\"170\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Arrows: VCQFILEs to Main Data File -->\n  <line x1=\"180\" y1=\"220\" x2=\"380\" y2=\"270\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"380\" y1=\"220\" x2=\"450\" y2=\"270\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"580\" y1=\"220\" x2=\"530\" y2=\"270\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  \n  <!-- Locking/Validation -->\n  <rect x=\"650\" y=\"270\" width=\"180\" height=\"70\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"740\" y=\"305\" text-anchor=\"middle\" font-size=\"15\" font-weight=\"bold\" fill=\"#b45309\">Locking & Validation Logic</text>\n  <text x=\"740\" y=\"325\" text-anchor=\"middle\" font-size=\"12\" fill=\"#b45309\">Record Lock Flags, Retry, Error Msgs</text>\n  \n  <!-- Arrow: Main Data File to Locking -->\n  <line x1=\"580\" y1=\"305\" x2=\"650\" y2=\"305\" stroke=\"#b45309\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n## References\n\n- Record locking and retry logic: [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code\n- VCQFILE and multi-user navigation: [[FILE:SPINQ2.CPY|SPINQ2.CPY]], [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]], Index: code\n- SQL connection management: [[FILE:RZMALL.CBL|RZMALL.CBL]], Index: code\n- Error handling and user notification: [[FILE:SP01VCQ.CPY|SP01VCQ.CPY]], [[FILE:DECLARE.CPY|DECLARE.CPY]], Index: code\n\n---\n\n**Summary:**  \nOTIS/OTOS uses a combination of record locking, user-specific working files, validation logic, and error messaging to handle concurrent access and multi-user scenarios, ensuring data integrity and responsive user experience even in high-concurrency environments.",
    "sources_count": 100,
    "timing_seconds": 22.624
  },
  "Q58": {
    "question": "What logging and debugging facilities are built into OTIS programs?",
    "answer": "OTIS/OTOS programs incorporate several built-in logging and debugging facilities to support error tracking, operational auditing, and troubleshooting. These mechanisms are evident from program structure, dedicated utility modules, and copybook usage in the retrieved context.\n\n### Key Logging and Debugging Facilities\n\n#### 1. **Centralized Error Logging (ERRLOG)**\n- **ERRLOG** is a dedicated program for error logging.\n  - It is called by other programs to record errors and operational issues.\n  - ERRLOG is a leaf program (does not call others), ensuring focused responsibility.\n  - It uses copybooks such as `LIBGB/[[FILE:ACCESS.CPY|ACCESS.CPY]]`, `LIBGB/[[FILE:GETENV.CPY|GETENV.CPY]]`, `LIBGB/[[FILE:CONAME_EXT.CPY|CONAME_EXT.CPY]]`, `LIBGB/[[FILE:GBERI.CPY|GBERI.CPY]]`, and others to structure error records and capture environment details.\n  - Example flow:  \n    - `I-O-CONTROL` → `GET-REAL-DATE` (Source: [[FILE:ERRLOG|ERRLOG]], [[FILE:I|I]]ndex: flows)\n  - ERRLOG is called by multiple programs, indicating its role as a system-wide error capture utility.\n  - Source: [[FILE:ERRLOG.CBL|ERRLOG.CBL]], Index: copybook_usage; ERRLOG, Index: programs; ERRLOG, Index: flows\n\n#### 2. **Trace Logging (TRACE)**\n- **TRACE** is a utility program for operational tracing and debugging.\n  - It makes calls to other programs and is called by others, acting as an intermediate in the call chain.\n  - TRACE uses the `LIBGB/[[FILE:GETENV.CPY|GETENV.CPY]]` copybook to capture environment variables and context for trace records.\n  - It is invoked at multiple points in the code (calls at lines 212, 196, 250, 213), suggesting use for step-by-step execution tracking.\n  - Source: [[FILE:TRACE|TRACE]], [[FILE:I|I]]ndex: programs; [[FILE:TRACE.CBL|TRACE.CBL]], Index: copybook_usage\n\n#### 3. **SQL Logging (SQLLOG, SQLERR)**\n- **SQLLOG** and **SQLERR** are specialized programs for logging SQL operations and errors.\n  - SQLLOG handles file operations related to logging (OPEN, CLOSE, READ, WRITE).\n  - SQLERR logs SQL-specific errors and operational events.\n  - Both use multiple calls and copybooks to structure log entries and manage output files.\n  - Example flow:  \n    - `EXIT` → `OPEN-RN-FILE-OUTPUT`, `CLOSE-RN-FILE`, `OPEN-WK1-FILE-OUTPUT`, etc. (Source: [[FILE:SQLLOG|SQLLOG]], [[FILE:I|I]]ndex: flows)\n  - Source: [[FILE:SQLLOG|SQLLOG]], [[FILE:I|I]]ndex: programs; SQLERR, Index: programs; SQLLOG, Index: flows\n\n#### 4. **Audit and Operational Logging**\n- Programs such as **APIDRV** and **AUDIQ** include routines for creating, writing, and closing log files.\n  - APIDRV flow includes: `CREATE-LOG`, `OPEN-LOG-FILE-EXTEND`, `WRITE-LOG-FILE`, `CLOSE-LOG-FILE`.\n  - AUDIQ uses `LIBGB/[[FILE:SYSTEMW.CPY|SYSTEMW.CPY]]` for system-level audit records.\n  - Source: [[FILE:APIDRV|APIDRV]], [[FILE:I|I]]ndex: flows; [[FILE:AUDIQ.CBL|AUDIQ.CBL]], Index: copybook_usage\n\n#### 5. **Environment and Context Capture**\n- Many logging programs use environment-related copybooks (`[[FILE:GETENV.CPY|GETENV.CPY]]`, `[[FILE:GETENVW.CPY|GETENVW.CPY]]`) to record user, session, and system context in logs.\n- This supports debugging by providing full context for each error or trace entry.\n\n#### 6. **Error Message Handling (ERRMSG)**\n- ERRMSG is a leaf program called by others to display or log error messages.\n- It centralizes error message formatting and output.\n- Source: [[FILE:ERRMSG|ERRMSG]], [[FILE:I|I]]ndex: programs\n\n### Typical Logging/Debugging Workflow\n\n1. **Error or event occurs in business logic.**\n2. **Program calls ERRLOG or TRACE** to record the event, passing relevant details (error code, message, environment).\n3. **Log entry is written** to a file or system log, structured using copybooks for consistency.\n4. **SQL operations** are logged via SQLLOG/SQLERR for database-related events.\n5. **Audit logs** are created for critical operations (APIDRV, AUDIQ).\n\n### Visual Representation\n\nHere's a visual representation of the logging and debugging architecture in OTIS:\n\n<svg width=\"900\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Logging & Debugging Architecture</text>\n  \n  <!-- Business Logic Programs -->\n  <rect x=\"50\" y=\"80\" width=\"200\" height=\"70\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"150\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#4338ca\">Business Logic</text>\n  <text x=\"150\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">APIDRV, AUDIQ, Others</text>\n  \n  <!-- Logging Programs -->\n  <rect x=\"350\" y=\"80\" width=\"160\" height=\"70\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"430\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#1e40af\">Logging Programs</text>\n  <text x=\"430\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">ERRLOG, TRACE, SQLLOG, SQLERR</text>\n  \n  <!-- Error Message Program -->\n  <rect x=\"650\" y=\"80\" width=\"120\" height=\"70\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"710\" y=\"110\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#15803d\">ERRMSG</text>\n  <text x=\"710\" y=\"130\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Error Messages</text>\n  \n  <!-- Log Files -->\n  <rect x=\"350\" y=\"220\" width=\"160\" height=\"70\" fill=\"#fef9c3\" stroke=\"#f59e0b\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"430\" y=\"250\" text-anchor=\"middle\" font-size=\"16\" font-weight=\"bold\" fill=\"#b45309\">Log Files</text>\n  <text x=\"430\" y=\"270\" text-anchor=\"middle\" font-size=\"12\" fill=\"#f59e0b\">Error, Trace, SQL, Audit</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"250\" y1=\"115\" x2=\"350\" y2=\"115\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"510\" y1=\"115\" x2=\"650\" y2=\"115\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"430\" y1=\"150\" x2=\"430\" y2=\"220\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n### Summary Table: Logging/Debugging Facilities\n\n| Facility   | Program(s)      | Purpose                                      | Copybooks Used                  |\n|------------|-----------------|----------------------------------------------|---------------------------------|\n| Error Log  | ERRLOG          | Central error recording                      | [[FILE:ACCESS.CPY|ACCESS.CPY]], [[FILE:GETENV.CPY|GETENV.CPY]], etc.   |\n| Trace Log  | TRACE           | Step-by-step execution tracing               | [[FILE:GETENV.CPY|GETENV.CPY]]                     |\n| SQL Log    | SQLLOG, SQLERR  | SQL operation and error logging              | Various                        |\n| Audit Log  | APIDRV, AUDIQ   | Operational/audit trail                      | [[FILE:SYSTEMW.CPY|SYSTEMW.CPY]]                    |\n| Error Msg  | ERRMSG          | Error message formatting/output              | (not specified)                |\n\n### Source Citations\n- ERRLOG program and copybook usage (Source: [[FILE:ERRLOG.CBL|ERRLOG.CBL]], Index: copybook_usage; ERRLOG, Index: programs; ERRLOG, Index: flows)\n- TRACE program and copybook usage (Source: [[FILE:TRACE|TRACE]], [[FILE:I|I]]ndex: programs; [[FILE:TRACE.CBL|TRACE.CBL]], Index: copybook_usage)\n- SQLLOG and SQLERR program flows (Source: [[FILE:SQLLOG|SQLLOG]], [[FILE:I|I]]ndex: programs; SQLERR, Index: programs; SQLLOG, Index: flows)\n- APIDRV and AUDIQ audit routines (Source: [[FILE:APIDRV|APIDRV]], [[FILE:I|I]]ndex: flows; [[FILE:AUDIQ.CBL|AUDIQ.CBL]], Index: copybook_usage)\n- ERRMSG program (Source: [[FILE:ERRMSG|ERRMSG]], [[FILE:I|I]]ndex: programs)\n\n---\n\n**In summary:**  \nOTIS/OTOS provides robust logging and debugging through centralized error logging (ERRLOG), trace logging (TRACE), SQL operation logs (SQLLOG/SQLERR), audit trails (APIDRV/AUDIQ), and error message handling (ERRMSG), all structured via dedicated copybooks for consistency and reliability.",
    "sources_count": 100,
    "timing_seconds": 18.886
  },
  "Q59": {
    "question": "How does OTIS handle batch processing schedules and dependencies?",
    "answer": "OTIS/OTOS handles batch processing schedules and dependencies through a combination of structured scheduling logic, explicit dependency management, and user-driven controls. Here’s how these mechanisms work, based on program flows, help text, and business rules in the retrieved context:\n\n---\n\n**1. Batch Processing Schedules**\n\n- **Batch Identification and Assignment:**  \n  Users assign batch numbers to transactions (e.g., payments, dealer checks) using dedicated fields and screens. For example,  \n  - \"Enter a BATCH number to assign to the Dealer checks.\"  \n    (Source: [[FILE:LP|LP]]_LONPT_BATCH, Index: help_fields)\n  - \"Displays the BATCH PROCESSING IDENTIFICATION NUMBER of CHECKS that are processed through the system.\"  \n    (Source: [[FILE:MN|MN]]_DTMAIN_170, Index: help_fields)\n\n- **Scheduling Logic:**  \n  Programs such as LONPW1, LONPT0, and others contain routines to:\n  - Retrieve batches for the current day (`GET-BATCHES-FOR-TODAY`)\n  - Test for unassigned batches (`TEST-FOR-UNASSIGNED-BATCH`)\n  - Display batch status and allow user selection (`DISPLAY-BATCH`)\n  - Release or verify batches before processing (`BATCH-RELEASE`, `VERIFY-BATCH`)\n  - Example flow:\n    ```\n    DECLARATIVES --> GET-BATCHES-FOR-TODAY\n    MAIN-MODULE --> REC-BP-MODULE\n    MAIN-MODULE --> ENTRY-MODULE\n    ```\n    (Source: [[FILE:LONPW1|LONPW1]], [[FILE:I|I]]ndex: flows)\n\n- **User Controls:**  \n  Users can:\n  - Assign, release, or verify batches via screen prompts and menu options.\n  - Produce preliminary reports and error listings before actual posting, by setting flags (e.g., \"Enter 'Y' if you want to produce a preliminary report and error listing without doing any posting.\"  \n    Source: [[FILE:LP|LP]]_LNCREA_REPORTONLY, Index: help_fields)\n\n---\n\n**2. Dependency Management**\n\n- **Explicit Program Dependencies:**  \n  Batch routines are modular, with clear perform/call relationships. For example:\n  - `PERFORM VERIFY-BATCH` (Source: [[FILE:LONPT0|LONPT0]], [[FILE:I|I]]ndex: flow_edges)\n  - `PERFORM BATCH-PAYMENT-ROUTINE` (Source: [[FILE:LONPF7|LONPF7]], [[FILE:LONPFB|LONPFB]], [[FILE:LONPFC|LONPFC]], [[FILE:I|I]]ndex: flow_edges)\n  - Programs like LONPF9, LONPFB, LONPFC, etc., all perform the central `BATCH-PAYMENT-ROUTINE`, ensuring consistent processing logic across modules.\n\n- **Data Dependencies:**  \n  - Batch routines often depend on the existence and status of batch records, which are checked and updated in working files.\n  - Routines such as `FIND-LOWEST-BATCH`, `GET-BATCHES-FOR-TODAY`, and `UPDATE-DT-BATCH` manage the sequencing and integrity of batch data.\n  - Example:  \n    ```\n    WK-FILE --> BATCH-PAYMENT-ROUTINE\n    WK-FILE --> SELECTION-MODULE\n    ```\n    (Source: [[FILE:LONPF9|LONPF9]], [[FILE:I|I]]ndex: flows)\n\n- **Error Handling and Logging:**  \n  - Before processing, batches are validated for completeness and correctness.\n  - Errors or missing dependencies (e.g., unassigned batch numbers) trigger user prompts or error logs, preventing incomplete or out-of-sequence processing.\n\n- **Conditional Processing:**  \n  - Some batch routines include conditional logic to handle special cases (e.g., non-cash transactions, lock box batches).\n  - Example:  \n    \"IF FIELD 14 IS SET TO ALLOW PAYOFFS WITH NON CASH TRANSACTIONS AND THE BATCH PAYMENT IS NON CASH...\"  \n    (Source: [[FILE:SP|SP]]_BPBRMNH_151, Index: help_fields)\n\n---\n\n**3. Workflow Example**\n\nHere’s a typical batch processing workflow in OTIS:\n\n1. **User assigns batch number** via screen (e.g., LONPT, DTMAIN).\n2. **Program retrieves batches for today** (`GET-BATCHES-FOR-TODAY`).\n3. **Batch is verified** for completeness (`VERIFY-BATCH`).\n4. **Batch payment routine is performed** (`BATCH-PAYMENT-ROUTINE`), which may:\n   - Update payment files\n   - Trigger dependent routines (e.g., selection modules, error handling)\n5. **Batch status is updated** and results are logged.\n6. **Reports and error listings** can be generated before or after posting.\n\n---\n\n**4. Visual Representation**\n\nHere's a visual diagram showing the batch processing schedule and dependency flow:\n\n<svg width=\"900\" height=\"420\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS Batch Processing Schedule & Dependencies</text>\n  \n  <!-- User Input Layer -->\n  <rect x=\"50\" y=\"70\" width=\"800\" height=\"60\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"95\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">User Input / Scheduling</text>\n  <text x=\"450\" y=\"115\" text-anchor=\"middle\" font-size=\"14\" fill=\"#4338ca\">Assign Batch Number, Select Batch, Set Report Flags</text>\n  \n  <!-- Scheduling Logic Layer -->\n  <rect x=\"50\" y=\"150\" width=\"800\" height=\"60\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"175\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#1e40af\">Scheduling Logic</text>\n  <text x=\"450\" y=\"195\" text-anchor=\"middle\" font-size=\"14\" fill=\"#1e40af\">GET-BATCHES-FOR-TODAY, VERIFY-BATCH, BATCH-RELEASE</text>\n  \n  <!-- Batch Processing Layer -->\n  <rect x=\"50\" y=\"230\" width=\"800\" height=\"60\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"255\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#15803d\">Batch Processing Routines</text>\n  <text x=\"450\" y=\"275\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">BATCH-PAYMENT-ROUTINE, SELECTION-MODULE, Error Handling</text>\n  \n  <!-- Data Layer -->\n  <rect x=\"50\" y=\"310\" width=\"800\" height=\"60\" fill=\"#fef9c3\" stroke=\"#eab308\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"335\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#92400e\">Batch Data & Reports</text>\n  <text x=\"450\" y=\"355\" text-anchor=\"middle\" font-size=\"14\" fill=\"#92400e\">Batch Files, Payment Files, Error Logs, Reports</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"450\" y1=\"130\" x2=\"450\" y2=\"150\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"210\" x2=\"450\" y2=\"230\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"450\" y1=\"290\" x2=\"450\" y2=\"310\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n---\n\n**Summary of Key Mechanisms:**\n- Batch numbers and schedules are managed via user input and program logic.\n- Dependencies are handled through explicit perform/call relationships and validation routines.\n- Data integrity is maintained by verifying batch completeness and sequencing before processing.\n- Error handling and reporting are integrated to prevent and diagnose issues.\n- The system supports conditional processing for special batch types (e.g., lock box, non-cash).\n\n**Sources:**\n- LP_LONPT_BATCH, MN_DTMAIN_170, LP_LNCREA_REPORTONLY (help_fields)\n- LONPW1, LONPT0, LONPF9, LONPFB, LONPFC (flows, flow_edges)\n- SP_BPBRMNH_151 (help_fields)\n\nIf you need details on a specific batch routine or want to see the call chain for a particular program, let me know!",
    "sources_count": 200,
    "timing_seconds": 18.482
  },
  "Q60": {
    "question": "What are the key technical constraints and limitations of the current architecture?",
    "answer": "The OTIS/OTOS architecture exhibits several key technical constraints and limitations, as evidenced by program structure, code comments, and dependency patterns in the retrieved context:\n\n**1. Record Locking and Concurrency**\n- OTIS relies on record-level locking for concurrent access, which can limit scalability and throughput in high-volume, multi-user scenarios. Lock contention may occur if multiple users attempt to update the same record simultaneously.\n- No evidence of optimistic concurrency or advanced transaction management; updates are serialized at the record level.\n  - Source: [[FILE:G|G]]eneral system design, as described in previous answers.\n\n**2. Batch Processing Dependency**\n- Batch jobs are scheduled and sequenced with explicit dependencies, meaning downstream jobs must wait for upstream jobs to complete. This can create bottlenecks and delay processing if any job fails or runs slowly.\n- Manual intervention may be required to resolve failed jobs or restart sequences.\n  - Source: \"OTIS/OTOS handles batch processing schedules and dependencies...\" (Previous answer)\n\n**3. File-Based Data Storage**\n- The architecture is heavily file-oriented, with many programs reading and writing to flat files rather than using a relational database. This limits flexibility for ad-hoc queries, reporting, and integration with modern systems.\n- File layouts are tightly coupled to copybooks, making schema changes complex and risky.\n  - Example: \"The header record needs to be a separate file, it will be SP01CQS.\" (Source: [[FILE:SP01CQ.CPY|SP01CQ.CPY]], Index: code)\n\n**4. Hard-Coded Business Logic**\n- Many business rules and validation checks are hard-coded in COBOL paragraphs, making changes labor-intensive and error-prone.\n- Comments indicate frequent manual updates to accommodate new requirements or correct issues.\n  - Example: \"REMOVED THE HARD CODED 'IF' STATEMENT.\" (Source: [[FILE:UP1534.CBL|UP1534.CBL]], Index: code)\n\n**5. Limited Modularization and Reuse**\n- Programs often have deep call chains but limited modularization. Many are root programs that call others but are not themselves called, reducing opportunities for code reuse.\n  - Example: \"Program LPCPMU | makes 4 calls to 4 unique programs | call depth 3 | (root program - makes calls but not called)\" (Source: [[FILE:LPCPMU|LPCPMU]], [[FILE:I|I]]ndex: programs)\n\n**6. Screen and Menu Handling**\n- Screen layouts and menu structures are defined in copybooks and program code, not in external configuration files. This makes UI changes cumbersome and increases risk of inconsistencies.\n- No evidence of dynamic screen generation or modern UI frameworks.\n  - Example: \"COPYBOOK: LIBGB/[[FILE:SCREENW.CPY|SCREENW.CPY]]\" (Source: [[FILE:GLIMIT.CBL|GLIMIT.CBL]], Index: copybook_usage)\n\n**7. Error Handling and Logging**\n- Error handling is present but basic, relying on logging to files and simple error codes. There is limited support for structured exception handling or centralized logging.\n- Debugging facilities are built-in but may not provide granular traceability for complex issues.\n  - Example: \"NOTES MENTIONS RISC2 NOT UPDATING THE WRFILE, ALL DONE ON RISC1.\" (Source: [[FILE:UP1534.CBL|UP1534.CBL]], Index: code)\n\n**8. Legacy Constraints**\n- Many programs and copybooks reference historical design decisions, such as field size changes, file splits, and removal of obsolete routines. This indicates ongoing technical debt and challenges in modernization.\n  - Example: \"REMOVED USE OF OLD STATUS ROUTINES [LIBLA/MASTATUS(W)].\" (Source: [[FILE:LONPC0.CBL|LONPC0.CBL]], Index: code)\n\n**Summary Table of Key Constraints**\n\n| Constraint                  | Description                                                                 | Source Example                                      |\n|-----------------------------|-----------------------------------------------------------------------------|-----------------------------------------------------|\n| Record Locking              | Serialized updates, risk of contention                                      | System design, previous answers                     |\n| Batch Dependency            | Sequential job execution, bottlenecks                                       | Previous answer, code comments                      |\n| File-Based Storage          | Flat files, rigid schemas, hard to change                                   | [[FILE:SP01CQ.CPY|SP01CQ.CPY]], copybook usage                          |\n| Hard-Coded Logic            | Manual code changes, limited flexibility                                    | [[FILE:UP1534.CBL|UP1534.CBL]], code comments                           |\n| Limited Modularization      | Deep call chains, root programs, little reuse                               | LPCPMU, programs index                              |\n| Static Screen/Menu Layouts  | UI defined in code/copybooks, hard to update                                | [[FILE:GLIMIT.CBL|GLIMIT.CBL]], [[FILE:SCREENW.CPY|SCREENW.CPY]]                             |\n| Basic Error Handling        | File-based logs, simple codes, limited traceability                         | [[FILE:UP1534.CBL|UP1534.CBL]], code comments                           |\n| Legacy Technical Debt       | Frequent manual fixes, obsolete routines, historical constraints            | [[FILE:LONPC0.CBL|LONPC0.CBL]], code comments                           |\n\n**Business Impact**\n- These constraints limit scalability, maintainability, and adaptability to new requirements.\n- Modernization efforts may be hampered by tightly coupled file layouts, hard-coded logic, and legacy dependencies.\n\n---\n\n**Here's a visual representation of the layered architecture and its constraints:**\n\n<svg width=\"700\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"350\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">OTIS System Architecture Constraints</text>\n  \n  <!-- Presentation Layer -->\n  <rect x=\"50\" y=\"70\" width=\"600\" height=\"100\" fill=\"#e0e7ff\" stroke=\"#667eea\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"95\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#4338ca\">Presentation Layer</text>\n  <text x=\"350\" y=\"120\" text-anchor=\"middle\" font-size=\"14\" fill=\"#4338ca\">Screens & Menus (Static, Copybook-defined)</text>\n  <text x=\"350\" y=\"140\" text-anchor=\"middle\" font-size=\"12\" fill=\"#6366f1\">Constraint: Hard to update UI, no dynamic screens</text>\n  \n  <!-- Business Logic Layer -->\n  <rect x=\"50\" y=\"200\" width=\"600\" height=\"100\" fill=\"#dbeafe\" stroke=\"#3b82f6\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"225\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#1e40af\">Business Logic Layer</text>\n  <text x=\"350\" y=\"250\" text-anchor=\"middle\" font-size=\"14\" fill=\"#1e40af\">COBOL Programs (Hard-coded rules, deep call chains)</text>\n  <text x=\"350\" y=\"270\" text-anchor=\"middle\" font-size=\"12\" fill=\"#3b82f6\">Constraint: Manual updates, limited modularity</text>\n  \n  <!-- Data Layer -->\n  <rect x=\"50\" y=\"330\" width=\"600\" height=\"100\" fill=\"#dcfce7\" stroke=\"#22c55e\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"350\" y=\"355\" text-anchor=\"middle\" font-size=\"18\" font-weight=\"bold\" fill=\"#15803d\">Data Layer</text>\n  <text x=\"350\" y=\"380\" text-anchor=\"middle\" font-size=\"14\" fill=\"#15803d\">Flat Files (Rigid schemas, record locking)</text>\n  <text x=\"350\" y=\"400\" text-anchor=\"middle\" font-size=\"12\" fill=\"#22c55e\">Constraint: Bottlenecks, hard to change structure</text>\n  \n  <!-- Connecting arrows -->\n  <defs>\n    <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#666\"/>\n    </marker>\n  </defs>\n  <line x1=\"350\" y1=\"170\" x2=\"350\" y2=\"200\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n  <line x1=\"350\" y1=\"300\" x2=\"350\" y2=\"330\" stroke=\"#666\" stroke-width=\"2\" marker-end=\"url(#arrow)\"/>\n</svg>\n\n**References:**\n- [[FILE:SP01CQ.CPY|SP01CQ.CPY]], [[FILE:UP1534.CBL|UP1534.CBL]], [[FILE:LONPC0.CBL|LONPC0.CBL]], [[FILE:GLIMIT.CBL|GLIMIT.CBL]], LPCPMU (programs index), previous answers on concurrency and batch processing.",
    "sources_count": 100,
    "timing_seconds": 17.188
  }
}