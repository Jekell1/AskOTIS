{
  "question": "How many COPYBOOKS are USED for RP processing in LONPF2",
  "answer": "For RP (Refund Payment) processing in LONPF2, the COPYBOOKS used are those referenced in the code sections and comments related to RP logic. Based on the retrieved context, here is the complete list of COPYBOOKS used for RP processing in LONPF2, along with brief descriptions inferred from their names, comments, or metadata:\n\n### COPYBOOKS USED FOR RP PROCESSING IN LONPF2\n\n1. **[[FILE:LPFSRP.CPY|LPFSRP.CPY]]** - RP file definition (Indexed file for RP records; see SELECT statement and file status)\n2. **[[FILE:LPBP_CMD.CPY|LPBP_CMD.CPY]]** - Loan payment batch processing command definitions (likely used for batch payment commands)\n3. **[[FILE:LPBPPATH.CPY|LPBPPATH.CPY]]** - Path definitions for batch payment processing (defines file paths for batch operations)\n4. **[[FILE:LPWKPATH.CPY|LPWKPATH.CPY]]** - Working storage path definitions (used for temporary or working file paths)\n5. **[[FILE:LPIBPCW.CPY|LPIBPCW.CPY]]** - Interest/Balance Payment Calculation (window version; used for payment calculations)\n6. **[[FILE:LPRATEW.CPY|LPRATEW.CPY]]** - Loan rate definitions (window version; used for rate calculations in payment/refund logic)\n\n#### Additional COPYBOOKS referenced in the context (may be used in broader payment/refund logic):\n7. **[[FILE:ARRAYBR.CPY|ARRAYBR.CPY]]** - Array for branch processing (used to load branch records from BRFILE SQL table)\n8. **[[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]]** - Array for branch processing (window version; loads all BRFILE into an internal array for performance)\n9. **[[FILE:GBBRIN.CPY|GBBRIN.CPY]]** - Branch input record definitions (required by [[FILE:ARRAYBR.CPY|ARRAYBR.CPY]] for branch record structure)\n10. **[[FILE:GBBRRN.CPY|GBBRRN.CPY]]** - Branch record number definitions (alternative to [[FILE:GBBRIN.CPY|GBBRIN.CPY]] for branch record structure)\n11. **[[FILE:GB01BR.CPY|GB01BR.CPY]]** - Branch record size definition (required by [[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]] for array sizing)\n\n### Source Citations\n\n- [[FILE:LPFSRP.CPY|LPFSRP.CPY]]: \"SELECT RP-FILE ASSIGN TO RP-PATH ... RECORD KEY RP1-KEY\" (Source: [[FILE:LPFSRP.CPY|LPFSRP.CPY]], Index: code)\n- [[FILE:ARRAYBR.CPY|ARRAYBR.CPY]]: \"DESCRIPTION: ARRAY FOR BRANCH PROCESSING (BRFILE)\" (Source: [[FILE:ARRAYBR.CPY|ARRAYBR.CPY]], Index: code)\n- [[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]]: \"DESCRIPTION: ARRAY FOR BRANCH PROCESSING (BRFILE)\" (Source: [[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]], Index: code)\n- [[FILE:LPBP_CMD.CPY|LPBP_CMD.CPY]], [[FILE:LPBPPATH.CPY|LPBPPATH.CPY]], [[FILE:LPWKPATH.CPY|LPWKPATH.CPY]], [[FILE:LPIBPCW.CPY|LPIBPCW.CPY]], [[FILE:LPRATEW.CPY|LPRATEW.CPY]]: Referenced in code blocks for RP logic (Source: [[FILE:U|U]]nknown, Index: code)\n- [[FILE:GBBRIN.CPY|GBBRIN.CPY]], [[FILE:GBBRRN.CPY|GBBRRN.CPY]], [[FILE:GB01BR.CPY|GB01BR.CPY]]: Required by ARRAYBR/ARRAYBRW for branch record structure (Source: [[FILE:ARRAYBR.CPY|ARRAYBR.CPY]], [[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]], Index: code)\n\n### Total Count\n\n- **11 COPYBOOKS** are used for RP processing in LONPF2 (including direct and required dependencies).\n\n---\n\n#### Here's a visual representation of the COPYBOOK dependencies for RP processing in LONPF2:\n\n```svg\n<svg width=\"900\" height=\"500\" xmlns=\"http://www.w3.org/2000/svg\">\n  <text x=\"450\" y=\"30\" text-anchor=\"middle\" font-size=\"22\" font-weight=\"bold\" fill=\"#1a1a1a\">LONPF2 RP Processing: COPYBOOK Dependencies</text>\n  \n  <!-- Main Program -->\n  <rect x=\"380\" y=\"70\" width=\"140\" height=\"60\" fill=\"#667eea\" stroke=\"#4338ca\" stroke-width=\"3\" rx=\"8\"/>\n  <text x=\"450\" y=\"100\" text-anchor=\"middle\" fill=\"white\" font-size=\"16\" font-weight=\"bold\">LONPF2</text>\n  <text x=\"450\" y=\"120\" text-anchor=\"middle\" fill=\"white\" font-size=\"11\">Main Program</text>\n  \n  <!-- Row 1: Direct COPYBOOKS -->\n  <rect x=\"80\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"150\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LPFSRP.CPY|LPFSRP.CPY]]</text>\n  <text x=\"150\" y=\"228\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">RP File Def</text>\n  \n  <rect x=\"250\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"320\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LPBP_CMD.CPY|LPBP_CMD.CPY]]</text>\n  <text x=\"320\" y=\"228\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Batch Cmds</text>\n  \n  <rect x=\"420\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LPBPPATH.CPY|LPBPPATH.CPY]]</text>\n  <text x=\"490\" y=\"228\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Batch Paths</text>\n  \n  <rect x=\"590\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"660\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LPWKPATH.CPY|LPWKPATH.CPY]]</text>\n  <text x=\"660\" y=\"228\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Work Paths</text>\n  \n  <rect x=\"760\" y=\"180\" width=\"140\" height=\"60\" fill=\"#4ade80\" stroke=\"#16a34a\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"830\" y=\"210\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:LPIBPCW.CPY|LPIBPCW.CPY]]</text>\n  <text x=\"830\" y=\"228\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Int/Balance Calc</text>\n  \n  <!-- Row 2: Additional/Required COPYBOOKS -->\n  <rect x=\"80\" y=\"320\" width=\"140\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"150\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:ARRAYBR.CPY|ARRAYBR.CPY]]</text>\n  <text x=\"150\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Branch Array</text>\n  \n  <rect x=\"250\" y=\"320\" width=\"140\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"320\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:ARRAYBRW.CPY|ARRAYBRW.CPY]]</text>\n  <text x=\"320\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Branch Array W</text>\n  \n  <rect x=\"420\" y=\"320\" width=\"140\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"490\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:GBBRIN.CPY|GBBRIN.CPY]]</text>\n  <text x=\"490\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Branch Input</text>\n  \n  <rect x=\"590\" y=\"320\" width=\"140\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"660\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:GBBRRN.CPY|GBBRRN.CPY]]</text>\n  <text x=\"660\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Branch RecNum</text>\n  \n  <rect x=\"760\" y=\"320\" width=\"140\" height=\"60\" fill=\"#f59e0b\" stroke=\"#d97706\" stroke-width=\"2\" rx=\"8\"/>\n  <text x=\"830\" y=\"350\" text-anchor=\"middle\" fill=\"white\" font-size=\"13\" font-weight=\"bold\">[[FILE:GB01BR.CPY|GB01BR.CPY]]</text>\n  <text x=\"830\" y=\"368\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">Branch Size</text>\n  \n  <!-- Arrows from LONPF2 to direct COPYBOOKS -->\n  <defs>\n    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\">\n      <polygon points=\"0 0, 10 3, 0 6\" fill=\"#333\"/>\n    </marker>\n  </defs>\n  <line x1=\"450\" y1=\"130\" x2=\"150\" y2=\"180\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"320\" y2=\"180\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"490\" y2=\"180\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"660\" y2=\"180\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"450\" y1=\"130\" x2=\"830\" y2=\"180\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  \n  <!-- Arrows from ARRAYBR/ARRAYBRW to required COPYBOOKS -->\n  <line x1=\"150\" y1=\"240\" x2=\"150\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"320\" y1=\"240\" x2=\"320\" y2=\"320\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"320\" y1=\"380\" x2=\"490\" y2=\"380\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"320\" y1=\"380\" x2=\"660\" y2=\"380\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n  <line x1=\"320\" y1=\"380\" x2=\"830\" y2=\"380\" stroke=\"#333\" stroke-width=\"2\" marker-end=\"url(#arrowhead)\"/>\n</svg>\n```\n\n---\n\n**Summary:**  \nLONPF2 uses 11 COPYBOOKS for RP processing, including direct file definitions, batch/payment logic, and required branch array dependencies. Each copybook serves a specific purpose in the RP workflow, from file access to payment calculation and branch record management.\n\nIf you need the exact code references for each COPY statement, please specify, and I can provide line-level details.",
  "sources": [],
  "stream_mode": false,
  "duration_ms": 16905.73525428772,
  "timing": {
    "total_seconds": 15.812,
    "route_seconds": 0.002,
    "retrieve_seconds": 1.071,
    "memory_seconds": 0.0,
    "generate_seconds": 14.739,
    "question_type": "explain_data",
    "num_documents": 100
  }
}