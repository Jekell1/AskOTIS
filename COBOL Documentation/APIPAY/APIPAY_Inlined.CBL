       IDENTIFICATION  DIVISION.
       PROGRAM-ID.       APIPAY.
       DATE-WRITTEN. 08/16/2023.
      *************************************************************************
      *  DESC:  SINGLE PAYMENT REFERENCE CODES PROCESSING
      *         $ SIGN RUN, NO SCREENS
      *
      * FOR PROGRAMMERS TO RUN IT;
      *         . SHH
      *         SH ./APIPAY.SH (DATA STRING OF BT-REC)     (REPAY TRANS ID)
      *                        00100786740000001000CUACH090123OT 1234567890
      *
      * RETURN-STATUS = 0 = SUCCESSFUL UPDATE
      * NO REPORTS ARE CREATED, ONLY A LOG
      * CREATES SC9990/EO/APIMMDDYY/0000LOG
      *
      *       2023/08/18 01:04 PM 0010 078674 BEGIN SINGLE BATCH PAYMENT POSTING
      *  PASS 2023/08/18 01:04 PM 0010 078674 SUCCESSFUL UPDATE
      *       2023/08/18 01:04 PM 0010 033333 BEGIN SINGLE BATCH PAYMENT POSTING
      *  FAIL 2023/08/18 01:04 PM 0010 033333 ACCOUNT NOT ON FILE, ABORTED
      *
      * LOGIC WAS TAKEN FROM REFUPD AND LONPW9 TO CREATE THIS PROGRAM
      * LOGIC WAS TAKEN FROM OTHUPD AND LONPWA TO CREATE THIS PROGRAM (OT)
      *
      *  FOR "RP" - NEEDED FOR AN "IN" REBATE FIX (LONPFB)
      *      "PL" "P2" "P3" (LONPF9) - MUST ADD BT-PL-REASON TO INPUT STRING
      *      "RE" (REPO) "O2" (LONPF7)
      *      "RV" "BK" "BD" CALL (LONPF2)
      *      "PY" "PA" ?  (LONPFC)
      *      "OT"         (LONPF7)
      *
      * 2024.0206 BAH #1641
      * BAH 2025.0228 LXE-EARN(4) - (7) WERE NOT GETTING CLEARED LIKE
      *               LONPF1 DOES! S35Q-168
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPFSWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPFSWK
           SELECT WK-FILE ASSIGN TO TEMP-PATH
                  ORGANIZATION RELATIVE
                  ACCESS DYNAMIC
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  RELATIVE KEY WK-KEY
                  FILE STATUS FILE-STAT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPFSWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPFSOP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPFSOP
           SELECT OP-FILE ASSIGN OPEN-PATH
                  ORGANIZATION SEQUENTIAL
                  LOCK MODE AUTOMATIC
                  FILE STATUS FILE-STAT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPFSOP.CPY                                *
      *================================================================*
           SELECT LOG-FILE ASSIGN LOG-PATH
                             ORGANIZATION LINE SEQUENTIAL
                             ACCESS SEQUENTIAL
                             FILE STATUS FILE-STAT.
       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPFDWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPFDWK
      *************************************************************
      *
      *          LOAN PROCESSING WORK RECORD
      *
      *  WK-KEY =
      *         =    1  SALES FINANCE INPUT
      *         =    2  DIRECT LOAN INPUT
      *         =    3  TRANSACTION POSTING
      *         =    4  CHECK DISBURSEMENT (DIRECT)
      *         =    5  SALES FINANCE MODIFY
      *         =    6  COLLATERAL TRAILER
      *         =    7  DIRECT LOAN MODIFY
      *         =    8  ADDONS
      *         =    9  ADDONS (USED TO HOLD ORIGINAL LOAN RECORD)
      *         =   11+ CHECKS
      *************************************************************
      $XFD  FILE=WKFILE
       FD  WK-FILE
           LABEL RECORD IS STANDARD.
       COPY "LIBLP/LP01WK.CPY".
      *================================================================*
      * END COPYBOOK: LIBLP\LPFDWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPFDOP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPFDOP
       FD  OP-FILE
           LABEL RECORDS ARE STANDARD.
       COPY "LIBLP/LP01OP.CPY".
      *================================================================*
      * END COPYBOOK: LIBLP\LPFDOP.CPY                                *
      *================================================================*

      **************************************************
      *  REFCODE BATCH LOG FILE                      *
      *   EO/APIMMDDYY/0000LOG
      **************************************************
       FD  LOG-FILE
           LABEL RECORDS ARE STANDARD.
       01  LOG-REC.
      * PASS OR FAIL
           03  LOG-STATUS    PIC X(4).
           03  FILLER            PIC X.
           03  LOG-RETURN    PIC 9(4).
           03  FILLER            PIC X.
           03  LOG-DATE      PIC 9999/99/99.
           03  FILLER            PIC X.
           03  LOG-TIME      PIC X(8).
           03  FILLER            PIC X.
           03  LOG-BRNO      PIC 9(4).
           03  FILLER            PIC X.
           03  LOG-NUMBER    PIC 9(6).
           03  FILLER            PIC X.
           03  LOG-MSG       PIC X(38).

       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(37) VALUE
           "@(#)SP/APIPAY S35 02/12/24-15:54:03 >".
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01BR.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01BR
      **************************************************************************
      *    BRANCH FILE RECORD      (GB01BR)   
      *
      *REV:
      * JTG 033095 ADDED BR-UNITPER-FG AND BR-UNITPER-Y-D-FG
      * JTG 051595 ADDED BR-RI-BEFORE-REPO
      *                  BR-RI-BEFORE-P4P5
      * JTG 061595 ADDED BR-NOT-OURS-REFUND
      * JTG 061995 ADDED BR-SFDLO3-WINDOW-FG
      * JTG 061995 ADDED BR-CALC-INS-ADJ
      * JTG 051595 ADDED BR-AC-BEFORE-REPO
      *                  BR-AC-BEFORE-P4P5
      * MJD 063095 ADDED BR-BANK-CLEARING-GL
      *                  BR-BANK-ROUTING-NO
      *                  BR-BANK-ACCTNO.
      * JTG 070595 ADDED BR-REB-METHOD-2       OCCURS 5
      *                  BR-REBDAYS-MONTH-2    OCCURS 5
      *                  BR-ACCRUAL-MONTHS-2   OCCURS 5
      * JTG 071395 ADDED BR-DEFAULT-SC-SUBCLASS
      * BLL 071795 EXPANDED UNUSED, BANK ACCT, ADDED BANKGL-DEPOSIT
      * BAH 083195 REMOVED BR-CASH-METHOD-ONLY AND BR-IB-ACCRUAL
      *            (MOVED TO GP RECORD)
      * MJD 011296 ADDED BR-NO-OUT-DLR-RSV.
      * KEC 020796 ADDED BR-COLLECTOR-QUEUE AND BR-COLL-QUEUE-CON-REC.
      * JTG 022096 ADDED BR-LNCHGS-WINDOW
      * JTG 062596 ADDED BR-EXPAND-APP-INPUT
      * BAH 082696 ADDED BR-A50-CPCORP TO USE A50'S COLLECTION REPORT (INSTANT)
      * MJD 100396 ADDED BR-INBR-BILNSC-FG. IF 'Y' THEN GLOBAL SCAN IS
      *            CALLED, ELSE A SINGLE BRANCH IS ENTERED.
      * KEC 112096 ADDED BR-LEDGER-JUST-INTCHG FOR QUICK CREDIT,
      *             FOR "MQ" AND "MR" TO ONLY PRINT INTCHG IN THE
      *             FINANCE CHARGE BOX.  FOR COPYING LP/LONPMQ FROM A48.
      * MJD 012897 ADDED BR-BYINQ-START-PAGE AND BR-DSINQ-START-PAGE.
      *            THESE ARE THE DEFAULT START PAGES FOR INQUIRIES.
      * JTG 022097 ADDED BR-APP-REQUIRED-FOR-INPUT  RE: STATISTICS UPDATE
      * BLV 022597 ADDED BR-CREDIT-SCORING-FG
      * BLV 041497 ADDED BR-COL-QUEUE-LOW-TO-HI
      * MJD 071797 ADDED BR-CAN-GROUP-ID.
      * KEC 072297 ADDED BR-CREDIT-BUREAU-SERVICES (5 BYTES).
      * MJD 072397 ADDED BR-AUTO-LNSTAT-WINDOW.
      * BLV 072497 ADDED BR-TIME-ZONE-FACTOR.
      * MJD 072897 ADDED BR-LONPF-OPT-DISPLAY.
      * JTG 081397 ADEED BR-DUEDATE-CHANGE-CD RELIANCE, #63
      * KEC 082097 ***CONVERSION-A90-TO-A10***
      *               ADDED BR-GIFTNET, BR-GIFTNET-LEDGER-LINE.
      * KEC 082697 REMOVED BR-DL-CHECK-NAME-CHG PER BETH BECAUSE OF PR#0543;
      *             CHANGING OF PAYEE IS ALREADY ALLOWING, SO THIS FLAG IS
      *             NOT NECESSARY.  MADE INTO FILLER.
      * MJD 082797 ADDED BR-NO-FT-EMP AND BR-NO-PT-EMP FOR BYMISC
      * MJD 082797 ADDED BR-NO-FT-EMP AND BR-NO-PT-EMP FOR MN/BYMISC.C
      * JTG 092597 ADDED BR-BALLOON-LOANS-FG, CASTLE FINANCE
      * BLV 103097 ADDED BR-GL-ENTRY-DEFAULT, BR-GL-TYPE-ALLOWED
      * BLV 110497 ADDED BR-MIDSTREAM-1STPAY-FG
      * JTG 111197 ADDED BR-DUEDATE-CHANGE-CD OPTION 'M' MERCURY
      * JTG 111197 ADDED BR-NODEF-1ST-X-MONTHS OPTION MERCURY
      * JTG 112197 EXPANDED RECORD BY 52 BYTES 798 --> 850
      * JTG 120197 ADDED WORLD BR-ADD-INS-FEECODE AD&D INSURANCE GA
      *                        BR-ROAD-G-SGL-FEECODE FOR VOYAGER
      *                        BR-ROAD-G-FAM-FEECODE
      * JTG 120397 ADDED BR-NODEF-IF-ZERO-AMT OPTION MERCURY
      * KEC 121797 ADDED BR-FXPRESS-OPTION FOR FORMSXPRESS FORMS.
      * MJD 012898 ADDED BR-NEXT-SOLICIT
      * BAH 022698 ADDED BR-ADDON-FEECD-O3 PIC XX OCCURS 2
      * BAH 022698 REMOVED BR-MEDIA-PURGE
      * MJD 031398 ADDED BR-SIZE - 78 LEVEL DOES NOT AFFECT REC SIZE.
      * BAH 032498 ADDED BR-IMMEDIATE-RECEIPT AND BR-IMMEDIATE-DOC-PRINT
      *            FROM A90 FOR WORLD...
      * BAH 042998 CHANGED BR-ADDON-FEECD TO BR-ADDON-FEECD-O2, BECAUSE WE
      *            DONT ALLOW FEES ON OTHER 1 ANYMORE..
      * BLV 052298 ADDED BR-CHECK-EOM-FG: CHECK EOM & CALENDAR EOY
      *            COMPLETE BEFORE ALLOWING LONPA0 TO OPEN DAY
      * BAH 060298 ADDED BR-AUTO-PL-REF-AC FOR MERCURY #E180 TO AUTOMATICALLY
      *            REFUND EVERYTHING AND ACCELERATE THE ACCOUNT
      * BLV 090298 TRASHED BR-EOM1-PROCEDURE, BR-EOM2-PROCEDURE, THESE ARE
      *            NOT USED & ARE CONFUSING PEOPLE
      * KEC 100698 ADDED BR-REVOLVING & BR-FAX-NUMBER. REGENCY REVOVLING
      * JTG 101298 CHANGED BR-REVOLVING TO BR-REVOLVING-SF-FG
      *                          AND ADDED BR-REVOLVING-LN-FG
      * CS  111798 ADDED BR-ALPHA-DRAWERS
      * KEC 011599 ADDED BR-REVOLVING-CONV-DATE SO TO PREVENT ANY
      *             UPDATES TO 'GL' FOR MANUAL CONVERSION OF REVOLVING
      *             ACCOUNTS (REGENCY).
      * MJD 990125 ----- UPDATED IN FLEXGEN -----
      * CS  1999.0312 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * GLF 990323 ADDED BR-LATECHG-ON-ALLOTMENTS, TFC #018
      * MJD 990323 ADDED BR-PRINTERFG-VALID. 88 LEVEL FOR VALID PRINTER
      *            CODES.
      * MJD 990412 CHANGED BR-BP-NEXT-BATCH TO BE PIC 9(2) COMP-3
      * KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * MJD 990617 ADDED BR-ALLOW-SYS-AS-EFFDATE (REG MGMT REQ # 867)
      * GLF 990715 ADDED BR-TAX-PREBOOK-CUST AND BR-TAX-PREBOOK-NONCUST
      *            WORLD PR#211
      * GLB 990715 ADD BR-PASSWORD-DRAWER FLAG, PR #901, REGMGM
      * BAH 990723 REMOVED BR-FXPRESS-OPTION
      * KEC 1999.0805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * MJD 990901 ADDED BR-INBR-BILNSC-FG-VALID - FLAG NOW CAN HAVE
      *            VALUE OF "M" (MUL PR# 925)
      * JTG 991129 ADDED BR-ONESTEP-RN-FG, TO ALLOW ONE STEP RENEWALS, WORLD
      * KEC 991130 ADDED BR-LI-LISCAN-FG; FOR CMSI/CSI PROJECT
      * MJD 000223 ADDED BR-HIDE-END-BAL (WORLD PR#219)
      * KEC 2000.0410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * MJD 000420 ADDED A SECOND SET OF BATCH ALLOTMENT FLAGS FOR LOCK
      *            BOX PROCESSING (MERC PR#227)
      * BAH 000531 ADDED NEW VALUE FOR BR-NO-CASH-PROCEEDS "B" TO ALLOW
      *            CASH PROCEEDS ON PB ACCTS ONLY, SUNBELT PR# 1213
      * MJD 000911 ADDED BR-LBOX AND BR-LATECHG-ON-LBOX (MFC PR#227)
      * JTG 001117 ADDED BR-ALLOW-OV-TRCD FOR 'OV' OVERPAYMENT TRANSACTION
      *                                                            PR#J015
      * MJD 001120 ADDED BR-GLOBAL-QUEUE (TFC PR#60)
      * JTG 001218 ADDED THE FOLLOWING FIELDS, RE: GP-ALLOW-SET-FOR-NONCASH
      *            MERCURY PR#239
      *            03  BR-BP-PAYOFF-NONCASH      PIC X.
      *            03  BR-BP-PAYOFF-OV           PIC X.
      *            03  BR-LBOX-PAYOFF-NONCASH    PIC X.
      *            03  BR-LBOX-PAYOFF-OV         PIC X.
      * BLV 010604 ADDED BR-ALLOW-INTERBR - IF "N" DON'T ALLOW OTHER
      *            BRANCHES TO POST INTERBRANCH PAYMENTS TO THIS BRANCH,
      *            REGACC PR# 1510
      * BAH 010621 NO PHYSICAL CHANGE, JUST CHANGED THE USE OF REB-METHOD-2
      *            SUBSCRIBT 4 FROM O6 TO CL(LEV), THE LOAN RECORD DOES NOT
      *            EVEN ALLOW O6, REGWAN PR# 1500
      * BLV 011207 ADDED BR-COLL-QUEUE-PAST-DUE, REGACC PR# 1677
      * JTG 020208 ADDED BR-FORCE-VALID-CITY-COUNTY                 WORLD PR#288
      * CS  020926 ADDED BR-LI-DLCOMM-CMSI-PP-MAX, BR-LI-DLCOMM-CMSI-O3-MAX..FOR
      *            MAXIUMUM AMOUNT OF DEALER COMMISSION FOR PP & O3 INSURANCE
      *            FED FROM CSMI(LOAN APP INTERFACE UPD) TO LOAN MANAGER
      * BAH 030507 ADDED BR-ASSESS-LATE-CHGS FOR MODERN PR# 2036, THEY WILL
      *            SET THIS TO "N", THEY DONT WANT LATE CHARGES IN LEGAL BRANCH
      * BAH 030917 REMOVED BR-FAIRCO-CPCORP-FG, BR-LNCHGS-WINDOW,
      *            BR-FAIRCO-TRW-OPT
      * BAH 030918 REMOVED BR-AS-TRAILER-NUMBER,MADE FILLER X(5),
      *            NOT USED ANYWHERE
      * KEC 030918 {PR#00039} REGIONAL ACCEPTANCE <A15> [KEVIN MULLEN]
      *            ADDED   03  BR-LR-GROUP-COLLID       PIC X.
      * BLV 031112 ADDED BR-INS-PRODUCER, WORLD NEEDS THIS FIELD IN BRANCH,
      *            NOT GLOBAL FOR CLAIMS; REDEFINED BR-STMNT2 SINCE ALMOST
      *            OUT OF SPACE
      * BLV 040218 ADDED BR-JE-ALLOCATION-SKIP, FLAG TO CAUSE GL JOURNAL ENTRY
      *            ALLOCATIONS TO SKIP BRANCH, WORLD
      * JTG 040219 ALLOWED NON MONTHLY CAN LOANS (NMQUOT.C) WORLD J043
      *             ADDED BR-NON-MONTHLY-CAN-LOANS
      * BLV 040315 RENAME BR-JE-ALLOCATION-SKIP TO BR-WORLD-BRANCH-TYPE, WILL
      *            BE USED BY WORLD TO INDICATE STATE ADMIN BRANCHES, 1ST &
      *            2ND YEAR DENOVO'S
      * BLV 040323 OKAY, NEED BOTH BR-JE-ALLOCATION-SKIP & WORLD-BRANCH-TYPE,
      *            SO RENAMED THE ALLOCATION FLAG BACK & ADDED THE TYPE, WORLD
      * BLV 040615 ADDED BR-COL-QUEUE-BEHAVIOR-FG, WHETHER TO ORDER QUEUE
      *            BY BEHAVIOR GRADE, REGACC PR# 59
      * JTG 040826 ALLOW BATCH PAYMENTS TO ACCOUNTS WITH OTHER BALANCE BUT
      *            NOT APPLY APPLY MONIES TO OTHER BALANCE          REGACC #0070
      * BAH 040830 ADDED BR-REGION-NUMBER FOR REGACC PR# 76
      * BAH 150930 CHANGED FROM RELATIVE TO INDEXED, PD0005
      * BAH 151020 COMBINED WITH B2FILE, CHANGED COMP-6 TO COMP-3, ADDED
      *            FILLER, INCREASED BR-OPEN-BAL TO OCCURS 20, REMOVED
      *            BR-REVOLVING-CONV-DATE, MADE BR-INS-PRODUCER ITS OWN
      *            FIELD INSTEAD OF REDEFINE OF STMNT2, INCREASED
      *            BR-REB-METHOD AND METHOD-2 TO 99, PD0003
      *  CS 160120 REMOVED BR-REB-METHOD-2 FIELDS
      * BLM 160914 ADD BR-ALLOW-SCANNED-CKS, WORLD PR# 1188
      * BLM 160915 ADD BR-CHECK-DEPOSIT-GL, WORLD PR# 1188 
      * AMM 161031 ADD BR-OPTION-PST-LASER, WORLD PR# 1200
      * BAH 180214 ADDED BR-USE-DEBIT-CARDS, BR-GL-DEBIT-CARD-PROCEEDS
      *            FOR NETSPEND, WORLD PR#1306
      * AMM 181113 REMOVED CREDIT BUREAU SERVCES FIELDS FORM RECORD LAYOUT
      *            SDP_002_T02
      *  CS 190124 ADD BR-WKDAY-BANKID FOR BANK INTEGRATION WORKDAY PR#1353A
      *  CS 190408 ADD FUTURE FIELDS,SAVED GB01BR.190408
      *  BAH 20190625 REMOVED BR-REVOLVING-SF-FG BR-REVOLVING-LN-FG PT0153
      *  BAH 20190702 REMOVED BR-USE-PARTIC-FLAT-TABLE PT0051
      *  BAH 20190730 ADDED BR-PURGE-NOW-FLAG TO REPLACE THE "PURGEME" TAG
      *               IN LNARCH. LNARCH GETS PUT IN A BATCH AND ONLY THE
      *               BRANCHES WITH THIS FLAG SET WILL ACTUALLY PURGE
      *  BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      *  BAH 20200326 ADDED BR-EMAIL AND BR-MANAGER-EMAIL
      *  BAH 20210421 REMOVED FUTURE FIEKDS. MOVE BR-NO TO BE GROUP LEVEL
      *  BAH 20220921 ADDED BR-VERITEC-LICENSE FOR "IL" VERITEC EXTRACTS #1570
      *  BAH 20230419 ADDED BR-TEST-PP-AUTO-INSCOVR #1594A
      *  20230600 BAH ADDED FILLER
      *  20230713 BAH ADDED BR-USE-NEW-WFARGO-ACCT #1616
      *  20230727 BAH ADDED BR-BRANCH-CLOSED #1618
      *  20231110 BAH ADDED BR-ALLOW-F3-ALL-DOCS FOR DOCUMENT PRINT #1630
      **************************************************************************
       78  BR-SIZE                      VALUE 1615.
       01  BR-REC.
           03  BR-KEY.
               05  BR-NO                PIC 9(4).
      $XFD DATE=YYYYMMDD
           03  BR-LTOUCH-DATE           PIC 9(8)     COMP-3.
           03  BR-NAME                  PIC X(40).
           03  BR-ADR1                  PIC X(24).
           03  BR-ADR2                  PIC X(24).
           03  BR-CITY                  PIC X(15).
           03  BR-STATE                 PIC XX.
           03  BR-ZIP                   PIC X(10).
           03  BR-PHONE                 PIC 9(10)    COMP-3.
           03  BR-RETAIN                PIC 9(11)    COMP-3.
           03  BR-NEXT-CHECK            PIC 9(6)     COMP-3.
           03  BR-PRINTERS.
               05  BR-PRINTTAB         OCCURS 4.
                   07  BR-PRINTER       PIC 99.
           03  BR-FEE-GL-BRNO           PIC 9(4).
           03  BR-REMIT1                PIC X(30).
           03  BR-REMIT2                PIC X(30).
           03  BR-REMIT3                PIC X(30).
           03  BR-STMNT1                PIC X(60).
           03  BR-STMNT2                PIC X(60).
           03  BR-INS-PRODUCER-NUM      PIC 9(8).
           03  BR-DLRCHK                PIC X.
           03  BR-FRONT-END-FG          PIC X.
           03  BR-EMLNRG-PHONE          PIC X.
           03  BR-POST-GL               PIC X.
           03  BR-ALLOTMNTS             PIC X.
           03  BR-EXTRACT-AUTO-UPD      PIC X.
           03  BR-PCNI-LEDGER           PIC X.
           03  BR-PRINTERFGS.
               05  BR-PRINTFGTAB       OCCURS 4.
                   07  BR-PRINTERFG     PIC X.
                       88 BR-PRINTERFG-CENTRONICS   VALUE "C".
                       88 BR-PRINTERFG-NEC          VALUE "N".
                       88 BR-PRINTERFG-OKIDATA      VALUE "O".
                       88 BR-PRINTERFG-OKIDATA-IBM  VALUE "I".
                       88 BR-PRINTERFG-LASER        VALUE "L".
                       88 BR-PRINTERFG-LASER-IIP    VALUE "2".
                       88 BR-PRINTERFG-PANASONIC    VALUE "P".
                       88 BR-PRINTERFG-DEFAULT      VALUE " ".
                       88 BR-PRINTERFG-VALID VALUE "C" "N" "O" "L"
                                                   "2" "P" " " "I".
           03  BR-NEGDLRSV              PIC X.
           03  BR-CPCORP-ORDER          PIC X.
           03  BR-PRIO-MEMO-FLAG        PIC X.
           03  BR-PREBILL-PL-JD-OPT     PIC X.
           03  BR-LOAN-NUM-FLAG         PIC X.
           03  BR-DOWNPY-FLAG           PIC X.
           03  BR-AUTO-INS-EARN         PIC X.
           03  BR-OTH-INS-LEVELS        PIC X.
           03  BR-ALLOW-INTERBR         PIC X.
           03  BR-UNER-DLANRP           PIC X.
           03  BR-SECOND-PROMISE        PIC X.
           03  BR-AVAIL-CREDIT          PIC X.
           03  BR-RECP1                 PIC X(30).
           03  BR-RECP2                 PIC X(30).
           03  BR-INC-WAIVERS           PIC X.
           03  BR-INC-INS               PIC X.

      *     BATCH PAYMENT FIELDS:
           03  BR-BP-NEXT-BATCH         PIC 9(2). 
           03  BR-BP-NOPAYOFF           PIC X.
           03  BR-BP-ODDPAY             PIC X.
           03  BR-BP-LC                 PIC X.
           03  BR-BP-NOPRIN             PIC X.
           03  BR-BP-FLASH              PIC X.
           03  BR-BP-ACTIONCD           PIC X.
           03  BR-BP-MAXCON             PIC 9(3)     COMP-3.
           03  BR-BP-MAXREC             PIC 9(3)     COMP-3.
           03  BR-BP-PL                 PIC X.
           03  BR-BP-JD                 PIC X.
           03  BR-BP-BRANCH             PIC 9(5)     COMP-3.

           03  BR-AGE-ERN               PIC X.
           03  BR-OTHER-BRANCH-GL       PIC X.
           03  BR-SALES-SMALL           PIC X.
           03  BR-NEW-COLL-INQUIRY      PIC X.
           03  BR-CHANGE-MEMO           PIC X.
           03  BR-INS-ADDON             PIC X.
               88  BR-INS-ADDON-VALID  VALUE "O" "Y" "N".
               88  BR-INS-ADDON-ORIG   VALUE "O".
               88  BR-INS-ADDON-NEW    VALUE "Y".
           03  BR-TRAILER-REC           PIC X.
           03  BR-ALDEL-FLAG            PIC X.
           03  BR-IB-LCHG-MESS          PIC X.
           03  BR-COL-QUEUE-PAST-DUE    PIC X.
           03  BR-LI-DLCOMM-CMSI-PP-MAX PIC 9(4)V99 COMP-3.
           03  BR-ADDON-FEECD-O2        PIC XX OCCURS 2 TIMES.
           03  BR-AUTO-CHECK            PIC X.
           03  BR-RECEIPT-PROMDATE      PIC X.
           03  BR-RECEIPT-INTPD         PIC X.
           03  BR-COLL-ID-SCAN          PIC X.
           03  BR-STOP-ON-COLL          PIC X.
           03  BR-DUEDATE-CHANGE-CD     PIC X.
           03  BR-CHECK-EOM-FG          PIC X.
           03  BR-VOLUME-DLANRP         PIC X.
           03  BR-PDTH-NXDUE            PIC X.
           03  BR-LC-CODE               PIC X.
           03  BR-VALIDATE-PRUS         PIC X.
           03  BR-AUTO-OPEN-BAL         PIC X.
           03  BR-OPEN-BALS.
               05  BR-OPEN-BAL          PIC S9(7)V99 COMP-3 OCCURS 20.
           03  BR-TENDER-CD             PIC X(5)     OCCURS 3.
           03  BR-DLPARV-ADJ-FG         PIC X.

           03  BR-OVERRIDE-BR-STATE     PIC X.
           03  BR-DEFAULT-SC-CLASS      PIC 9(3).
           03  BR-RECDEL-NOT-REC        PIC X.
           03  BR-POST-AHEAD-FG         PIC X.
           03  BR-CAN-LOANS-FG          PIC X.
               88  BR-CAN-LOANS-YES                  VALUE "Y".
               88  BR-CAN-LOANS-NO                   VALUE "N".
               88  BR-CAN-LOANS-ONLY                 VALUE "O".
               88  BR-CAN-LOANS-VALID                VALUE "Y"
                                                           "N" "O".
           03  BR-NON-MONTHLY-CAN-LOANS      PIC X.
           03  BR-BP-ALLOW-PMT-ACCT-OTHBAL   PIC X.
           03  BR-LBOX-ALLOW-PMT-ACCT-OTHBAL PIC X.
           03  BR-REGION-NUMBER              PIC 9(2).
           03  BR-OUR-FEE                    PIC X.

      *=================================================================
      *   THIS IS HOW IT IS USED IN A15.
      *    CL(DEC)  -  1      O1      - 4
      *    AH       -  2      O2      - 5
      *    PP       -  3
      *---------------------------------------------------------------
      *    ONLY METHOD2(1) AND METHOD2(4) ARE USED
      *    O3       -  1      CL(LEV) - 4
      *    O4       -  2      N/A     - 5
      *    O5       -  3
      * THE LOAN RECORD ONLY HAS O1 - O5, SO I USED O6 FOR CREDIT LIFE
      * LEVEL, REGWAN WANTS CREDIT LIFE DEC AND CREDIT LIFE LEV
      *---------------------------------------------------------------
      *   IN A30 
      *    CL(DEC)  -  1      O2       - 5     
      *    AH       -  2      O3       - 6     O5     -  9 
      *    PP       -  3      CL(LEV)  - 7     O6     - 10      
      *    O1       -  4      O4       - 8     O7     - 11
      *---------------------------------------------------------------

           03  BR-REB-METHOD            PIC 99       OCCURS 11.
           03  BR-REBDAYS-MONTH         PIC 99       OCCURS 11.
           03  BR-ACCRUAL-MONTHS        PIC 999      COMP-3 OCCURS 11.

      *=================================================================
           03  BR-GLOVERSHORT           PIC 9(11)    COMP-3.
           03  BR-GLBANK                PIC 9(11)    COMP-3.
           03  BR-GLONHAND              PIC 9(11)    COMP-3.
           03  BR-BANKBAL               PIC S9(9)V99 COMP-3.
           03  BR-RETAIN-AMT            PIC S9(9)V99 COMP-3.
           03  BR-LCARDFG               PIC X.

           03  BR-DATA-PATH             PIC X(6).
           03  BR-MACHINE               PIC XX.
           03  BR-MANAGER               PIC X(25).

           03  BR-EOD-PROCEDURE         PIC XXX.
           03  BR-BP-PAYOFF-NONCASH     PIC X.
           03  BR-BP-PAYOFF-OV          PIC X.
           03  BR-LI-DLCOMM-CMSI-O3-MAX PIC 9(4)V99 COMP-3.
           03  BR-LR-GROUP-COLLID       PIC X.

           03  BR-UNITPER-FG            PIC X.
           03  BR-UNITPER-Y-D-FG        PIC X.

           03  BR-NO-PROMPT-FOR-OTHBR    PIC X.
           03  BR-WORLD-BRANCH-TYPE      PIC X.
           03  BR-COL-QUEUE-BEHAVIOR-FG  PIC X.
           03  BR-CONVERT-AUTO-ACCTNO    PIC X.
           03  BR-TS-REPO-INS-FG         PIC X.
           03  BR-BOOK-SF-BR-ONLY        PIC X.
           03  BR-FORCE-VALID-CITY-COUNTY PIC X.
           03  BR-SET-COLLCD-DL-MFGCD    PIC X.
           03  BR-DEFAULT-SF-UNITPER-CD  PIC X.
           03  BR-DEFAULT-SF-PURCD       PIC X(3).
           03  BR-DEFAULT-LN-UNITPER-CD  PIC X.
           03  BR-DEFAULT-LN-PURCD       PIC X(3).
           03  BR-TAP-OTHER-DL           PIC X.
           03  BR-AH-AND-CL              PIC X.
           03  BR-NO-CASH-PROCEEDS       PIC X.
               88  BR-NO-CASH-PROCEEDS-VALID  VALUE "Y" "N" "B".
               88  BR-CASH-PB-ONLY       VALUE "B".
           03  BR-RI-BEFORE-REPO         PIC X.
           03  BR-RI-BEFORE-P4P5         PIC X.
           03  BR-NOT-OURS-REFUND        PIC X.
           03  BR-SFDLO3-WINDOW-FG       PIC X.
           03  BR-CALC-INS-ADJ           PIC X.
           03  BR-AC-BEFORE-REPO         PIC X.
           03  BR-AC-BEFORE-P4P5         PIC X.
           03  BR-BANK-ROUTING-NO        PIC 9(9)   COMP-3.
           03  BR-BANK-CLEARING-GL       PIC 9(11)  COMP-3.
           03  BR-GLBANK-DEPOSIT         PIC 9(11)  COMP-3.
           03  BR-BANK-ACCTNO            PIC X(17).
           03  BR-DEFAULT-SC-SUBCLASS    PIC 9(3).
           03  BR-NO-OUT-DLR-RSV         PIC X.
           03  BR-COLLECTOR-QUEUE        PIC X.
           03  BR-COLL-QUEUE-CON-REC     PIC X.
           03  BR-JE-ALLOCATION-SKIP     PIC X.
           03  BR-EXPAND-APP-INPUT       PIC X.
           03  BR-A50-CPCORP             PIC X.
           03  BR-INBR-BILNSC-FG         PIC X.
               88  BR-INBR-BILNSC-FG-VALID   VALUE "Y" "N" "M".
      *        ---------------------------------------------------------
      *         "Y" : USE GLOBAL SCAN WINDOW FOR INTER BRANCH SCAN.
      *         "N" : DO NOT USE GLOBAL SCAN WITH INTERBRANCH POSTING
      *               POP WINDOE TO ENTER BRNO AND GO TO THAT BRANCH.
      *         "M" : SAME AS "N" ABOVE PLUS THE FOLLOWING: WHEN IN
      *               COLLECTIONS OR F10 INT. GLOBAL SCAN WILL BE
      *               REPLACED WITH AN ENTRY BOX FOR BRNO ACCTNO TO VIEW.
      *        ---------------------------------------------------------
           03  BR-INBR-BRIEF-FG          PIC X.
           03  BR-LEDGER-JUST-INTCHG     PIC X.
           03  BR-BYINQ-START-PAGE       PIC 99.
           03  BR-DSINQ-START-PAGE       PIC 99.
           03  BR-APP-REQUIRED-FOR-INPUT PIC X.
           03  BR-CREDIT-SCORING-FG      PIC X.
           03  BR-COL-QUEUE-LOW-TO-HI    PIC X.
           03  BR-CAN-GROUP-ID           PIC X(4).
           03  BR-AUTO-LNSTAT-WINDOW     PIC X.
           03  BR-TIME-ZONE-FACTOR       PIC S9.
           03  BR-LONPF-OPT-DISPLAY      PIC X.
           03  BR-GIFTNET                PIC X.
           03  BR-GIFTNET-LEDGER-LINE    PIC X.
           03  BR-NO-FT-EMP              PIC 9(3)  COMP-3.
           03  BR-NO-PT-EMP              PIC 99V99 COMP-3.
           03  BR-BALLOON-LOANS-FG       PIC X.
           03  BR-GL-TYPE-ALLOWED        PIC X.
           03  BR-GL-ENTRY-DEFAULT       PIC X.
           03  BR-MIDSTREAM-1STPAY-FG    PIC X.
           03  BR-NODEF-1ST-X-MONTHS     PIC 9.
           03  BR-ADD-INS-FEECODE        PIC XX.
           03  BR-ROAD-G-SGL-FEECODE     PIC XX.
           03  BR-ROAD-G-FAM-FEECODE     PIC XX.
           03  BR-NODEF-IF-ZERO-AMT      PIC X.
           03  BR-ASSESS-LATE-CHGS       PIC X.
           03  BR-NEXT-SOLICIT-NO        PIC 9(6) COMP-3.
           03  BR-ADDON-FEECD-O3         PIC XX OCCURS 2 TIMES.
           03  BR-IMMEDIATE-RECEIPT      PIC X.
           03  BR-IMMEDIATE-DOC-PRINT    PIC X.
           03  BR-AUTO-PL-REF-AC         PIC X.
               88  BR-AUTO-PL-REF-AC-VALID  VALUE "Y" "2" "3".
           03  BR-FAX-NUMBER             PIC 9(10)    COMP-3.
           03  BR-ALPHA-DRAWERS          PIC X.
           03  BR-LATECHG-ON-ALLOTMENTS  PIC X.
           03  BR-ALLOW-SYS-AS-EFFDATE   PIC X(01).
           03  BR-TAX-PREBOOK-CUST       PIC 9(4) COMP-3.
           03  BR-TAX-PREBOOK-NONCUST    PIC 9(4) COMP-3.
           03  BR-PASSWORD-DRAWER        PIC X.
           03  BR-ONESTEP-RN-FG          PIC X.
           03  BR-LI-LISCAN-FG           PIC X.
           03  BR-HIDE-END-BAL           PIC X(01).
      *     BATCH PAYMENT FIELDS (LOCK BOX PROCESSING):
           03  BR-LBOX-NOPAYOFF          PIC X.
           03  BR-LBOX-ODDPAY            PIC X.
           03  BR-LBOX-LC                PIC X.
           03  BR-LBOX-NOPRIN            PIC X.
           03  BR-LBOX-FLASH             PIC X.
           03  BR-LBOX-ACTIONCD          PIC X.
           03  BR-LBOX-MAXCON            PIC 9(3)     COMP-3.
           03  BR-LBOX-MAXREC            PIC 9(3)     COMP-3.
           03  BR-LBOX-PL                PIC X.
           03  BR-LBOX-JD                PIC X.
           03  BR-LBOX                   PIC X(01).
           03  BR-LATECHG-ON-LBOX        PIC X(01).
           03  BR-ALLOW-OV-TRCD          PIC X.
           03  BR-GLOBAL-QUEUE           PIC X(01).
           03  BR-LBOX-PAYOFF-NONCASH    PIC X.
           03  BR-LBOX-PAYOFF-OV         PIC X.

           03  BR-COLLECT-MANAGER      PIC X(25).
           03  BR-COLLECT-PHONE        PIC 9(10) COMP-3.
           03  BR-COLLECT-EXT          PIC 9(4)  COMP-3.

           03  BR-ALT-INTO-THIS-BRANCH PIC X.
           03  BR-POFF-TITLE-WINDOW    PIC X.
           03  BR-COUPON-STATEMENT     PIC X.
           03  BR-SUPERVISOR           PIC X(25).
           03  BR-AREA-MANAGER         PIC X(25).

           03  BR-MIN-MONTHS-DEF       PIC 99.

      * COLLECTION CENTER INFO, PR# 164 REGACC
           03  BR-CC-FLAG              PIC X.
           03  BR-CC-ADR1              PIC X(24).
           03  BR-CC-CITY              PIC X(15).
           03  BR-CC-STATE             PIC XX.
           03  BR-CC-ZIP               PIC X(10).
      *USED TO INTERRUPT GRADE CODES COMING FROM CMSI TO POPULATE 
      *PARTIC. HELD
           03  BR-MIN-MONTHS-D2          PIC 99. 
           03  BR-SKIP-MIDSTREAM-TRW     PIC X.
           03  BR-GL-ESCROW-BALANCE      PIC 9(11) COMP-3.
           03  BR-GL-ESCROW-PAYABLE      PIC 9(11) COMP-3.
           03  BR-ALLOW-FORCE-OPEN-FG    PIC X.
           03  BR-ACH-BANK-NO            PIC 9.
           03  BR-WIMENU-CHECK-WRITING   PIC X.
           03  BR-ADP-PAY-GROUP          PIC X(3).
           03  BR-ALLOW-SCANNED-CKS      PIC X.
           03  BR-CHECK-DEPOSIT-GL       PIC 9(11) COMP-3.
           03  BR-OPTION-PST-LASER       PIC X.
           03  BR-USE-DEBIT-CARDS        PIC X.
           03  BR-GL-DEBIT-CARD-PROCEEDS PIC 9(11) COMP-3.
           03  BR-WKDAY-BANKID           PIC 9(4) COMP-3.
           03  BR-PURGE-NOW-FLAG         PIC X.
           03  BR-EMAIL                  PIC X(50).
           03  BR-MANAGER-EMAIL          PIC X(50).
           03  BR-VERITEC-LICENSE        PIC 9(7).
           03  BR-TEST-PP-AUTO-INSCOVR   PIC X.
           03  BR-USE-NEW-WFARGO-ACCT    PIC X.
           03  BR-BRANCH-CLOSED          PIC X.
           03  BR-ALLOW-F3-ALL-DOCS      PIC X.

           03  FILLER                    PIC X(396).
      *================================================================*
      * END COPYBOOK: LIBGB\GB01BR.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01BR_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01BR_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - BRANCH MASTER FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0430 ***NEW***
      * BAH 20220923 ADDED QBR-VERITEC-LICENSE #1570
      * BAH 20230419 ADDED QBR-TEST-PP-AUTO-INSCOVR #1594A
      * BAH 20230713 ADDED BR-USE-NEW-WFARGO-ACCT #1616
      * BAH 20230801 ADDED BR-BRANCH-CLOSED #1618
      * BAH 20231113 ADDED BR-ALLOW-F3-ALL-DOCS #1630
      * JKC 20231205 ADDED BR1-ROW-COUNT
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  BR-CURSOR-STAT               PIC X(2)  VALUE SPACES.
           88  BR-CURSOR-STAT-GOOD                VALUE "00".
           88  BR-CURSOR-STAT-BAD                 VALUE "  " THRU "//"
                                                        "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  BR1-RETURN-CODE               PIC S9(4)   COMP-5.
       01  BR1-ROW-COUNT                 PIC 9(4).

       01  QBR-WHERE-BEG-KEY.
           03  QBR-WBEG-NO               PIC 9(4).
 
       01  QBR-WHERE-END-KEY.
           03  QBR-WEND-NO               PIC 9(4).
 
       01  QBR-REC.
           03  QBR-NO                                 PIC 9(4).
           03  QBR-LTOUCH-DATE                        PIC X(10).
           03  QBR-NAME                               PIC X(40).
           03  QBR-ADR1                               PIC X(24).
           03  QBR-ADR2                               PIC X(24).
           03  QBR-CITY                               PIC X(15).
           03  QBR-STATE                              PIC XX.
           03  QBR-ZIP                                PIC X(10).
           03  QBR-PHONE                              PIC 9(10).
           03  QBR-RETAIN                             PIC 9(11).
           03  QBR-NEXT-CHECK                         PIC 9(6).
           03  QBR-PRINTER-1                          PIC 99.
           03  QBR-PRINTER-2                          PIC 99.
           03  QBR-PRINTER-3                          PIC 99.
           03  QBR-PRINTER-4                          PIC 99.
           03  QBR-FEE-GL-BRNO                        PIC 9(4).
           03  QBR-REMIT1                             PIC X(30).
           03  QBR-REMIT2                             PIC X(30).
           03  QBR-REMIT3                             PIC X(30).
           03  QBR-STMNT1                             PIC X(60).
           03  QBR-STMNT2                             PIC X(60).
           03  QBR-INS-PRODUCER-NUM                   PIC 9(8).
           03  QBR-DLRCHK                             PIC X.
           03  QBR-FRONT-END-FG                       PIC X.
           03  QBR-EMLNRG-PHONE                       PIC X.
           03  QBR-POST-GL                            PIC X.
           03  QBR-ALLOTMNTS                          PIC X.
           03  QBR-EXTRACT-AUTO-UPD                   PIC X.
           03  QBR-PCNI-LEDGER                        PIC X.
           03  QBR-PRINTERFG-1                        PIC X.
           03  QBR-PRINTERFG-2                        PIC X.
           03  QBR-PRINTERFG-3                        PIC X.
           03  QBR-PRINTERFG-4                        PIC X.
           03  QBR-NEGDLRSV                           PIC X.
           03  QBR-CPCORP-ORDER                       PIC X.
           03  QBR-PRIO-MEMO-FLAG                     PIC X.
           03  QBR-PREBILL-PL-JD-OPT                  PIC X.
           03  QBR-LOAN-NUM-FLAG                      PIC X.
           03  QBR-DOWNPY-FLAG                        PIC X.
           03  QBR-AUTO-INS-EARN                      PIC X.
           03  QBR-OTH-INS-LEVELS                     PIC X.
           03  QBR-ALLOW-INTERBR                      PIC X.
           03  QBR-UNER-DLANRP                        PIC X.
           03  QBR-SECOND-PROMISE                     PIC X.
           03  QBR-AVAIL-CREDIT                       PIC X.
           03  QBR-RECP1                              PIC X(30).
           03  QBR-RECP2                              PIC X(30).
           03  QBR-INC-WAIVERS                        PIC X.
           03  QBR-INC-INS                            PIC X.
           03  QBR-BP-NEXT-BATCH                      PIC 9(2).
           03  QBR-BP-NOPAYOFF                        PIC X.
           03  QBR-BP-ODDPAY                          PIC X.
           03  QBR-BP-LC                              PIC X.
           03  QBR-BP-NOPRIN                          PIC X.
           03  QBR-BP-FLASH                           PIC X.
           03  QBR-BP-ACTIONCD                        PIC X.
           03  QBR-BP-MAXCON                          PIC 9(3).
           03  QBR-BP-MAXREC                          PIC 9(3).
           03  QBR-BP-PL                              PIC X.
           03  QBR-BP-JD                              PIC X.
           03  QBR-BP-BRANCH                          PIC 9(5).
           03  QBR-AGE-ERN                            PIC X.
           03  QBR-OTHER-BRANCH-GL                    PIC X.
           03  QBR-SALES-SMALL                        PIC X.
           03  QBR-NEW-COLL-INQUIRY                   PIC X.
           03  QBR-CHANGE-MEMO                        PIC X.
           03  QBR-INS-ADDON                          PIC X.
           03  QBR-TRAILER-REC                        PIC X.
           03  QBR-ALDEL-FLAG                         PIC X.
           03  QBR-IB-LCHG-MESS                       PIC X.
           03  QBR-COL-QUEUE-PAST-DUE                 PIC X.
           03  QBR-LI-DLCOMM-CMSI-PP-MAX              PIC 9(4)V99.
           03  QBR-ADDON-FEECD-O2-1                   PIC XX.
           03  QBR-ADDON-FEECD-O2-2                   PIC XX.
           03  QBR-AUTO-CHECK                         PIC X.
           03  QBR-RECEIPT-PROMDATE                   PIC X.
           03  QBR-RECEIPT-INTPD                      PIC X.
           03  QBR-COLL-ID-SCAN                       PIC X.
           03  QBR-STOP-ON-COLL                       PIC X.
           03  QBR-DUEDATE-CHANGE-CD                  PIC X.
           03  QBR-CHECK-EOM-FG                       PIC X.
           03  QBR-VOLUME-DLANRP                      PIC X.
           03  QBR-PDTH-NXDUE                         PIC X.
           03  QBR-LC-CODE                            PIC X.
           03  QBR-VALIDATE-PRUS                      PIC X.
           03  QBR-AUTO-OPEN-BAL                      PIC X.
           03  QBR-OPEN-BAL-1                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-2                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-3                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-4                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-5                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-6                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-7                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-8                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-9                         PIC S9(7)V99.
           03  QBR-OPEN-BAL-10                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-11                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-12                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-13                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-14                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-15                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-16                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-17                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-18                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-19                        PIC S9(7)V99.
           03  QBR-OPEN-BAL-20                        PIC S9(7)V99.
           03  QBR-TENDER-CD-1                        PIC X(5).
           03  QBR-TENDER-CD-2                        PIC X(5).
           03  QBR-TENDER-CD-3                        PIC X(5).
           03  QBR-DLPARV-ADJ-FG                      PIC X.
           03  QBR-OVERRIDE-BR-STATE                  PIC X.
           03  QBR-DEFAULT-SC-CLASS                   PIC 9(3).
           03  QBR-RECDEL-NOT-REC                     PIC X.
           03  QBR-POST-AHEAD-FG                      PIC X.
           03  QBR-CAN-LOANS-FG                       PIC X.
           03  QBR-NON-MONTHLY-CAN-LOANS              PIC X.
           03  QBR-BP-ALLOW-PMT-ACCT-OTHBAL           PIC X.
           03  QBR-LBOX-ALLOW-PMT-ACCT-OTHBAL         PIC X.
           03  QBR-REGION-NUMBER                      PIC 9(2).
           03  QBR-OUR-FEE                            PIC X.
           03  QBR-REB-METHOD-1                       PIC 99.
           03  QBR-REB-METHOD-2                       PIC 99.
           03  QBR-REB-METHOD-3                       PIC 99.
           03  QBR-REB-METHOD-4                       PIC 99.
           03  QBR-REB-METHOD-5                       PIC 99.
           03  QBR-REB-METHOD-6                       PIC 99.
           03  QBR-REB-METHOD-7                       PIC 99.
           03  QBR-REB-METHOD-8                       PIC 99.
           03  QBR-REB-METHOD-9                       PIC 99.
           03  QBR-REB-METHOD-10                      PIC 99.
           03  QBR-REB-METHOD-11                      PIC 99.
           03  QBR-REBDAYS-MONTH-1                    PIC 99.
           03  QBR-REBDAYS-MONTH-2                    PIC 99.
           03  QBR-REBDAYS-MONTH-3                    PIC 99.
           03  QBR-REBDAYS-MONTH-4                    PIC 99.
           03  QBR-REBDAYS-MONTH-5                    PIC 99.
           03  QBR-REBDAYS-MONTH-6                    PIC 99.
           03  QBR-REBDAYS-MONTH-7                    PIC 99.
           03  QBR-REBDAYS-MONTH-8                    PIC 99.
           03  QBR-REBDAYS-MONTH-9                    PIC 99.
           03  QBR-REBDAYS-MONTH-10                   PIC 99.
           03  QBR-REBDAYS-MONTH-11                   PIC 99.
           03  QBR-ACCRUAL-MONTHS-1                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-2                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-3                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-4                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-5                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-6                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-7                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-8                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-9                   PIC 999.
           03  QBR-ACCRUAL-MONTHS-10                  PIC 999.
           03  QBR-ACCRUAL-MONTHS-11                  PIC 999.
           03  QBR-GLOVERSHORT                        PIC 9(11).
           03  QBR-GLBANK                             PIC 9(11).
           03  QBR-GLONHAND                           PIC 9(11).
           03  QBR-BANKBAL                            PIC S9(9)V99.
           03  QBR-RETAIN-AMT                         PIC S9(9)V99.
           03  QBR-LCARDFG                            PIC X.
           03  QBR-DATA-PATH                          PIC X(6).
           03  QBR-MACHINE                            PIC XX.
           03  QBR-MANAGER                            PIC X(25).
           03  QBR-EOD-PROCEDURE                      PIC XXX.
           03  QBR-BP-PAYOFF-NONCASH                  PIC X.
           03  QBR-BP-PAYOFF-OV                       PIC X.
           03  QBR-LI-DLCOMM-CMSI-O3-MAX              PIC 9(4)V99.
           03  QBR-LR-GROUP-COLLID                    PIC X.
           03  QBR-UNITPER-FG                         PIC X.
           03  QBR-UNITPER-Y-D-FG                     PIC X.
           03  QBR-NO-PROMPT-FOR-OTHBR                PIC X.
           03  QBR-WORLD-BRANCH-TYPE                  PIC X.
           03  QBR-COL-QUEUE-BEHAVIOR-FG              PIC X.
           03  QBR-CONVERT-AUTO-ACCTNO                PIC X.
           03  QBR-TS-REPO-INS-FG                     PIC X.
           03  QBR-BOOK-SF-BR-ONLY                    PIC X.
           03  QBR-FORCE-VALID-CITY-COUNTY            PIC X.
           03  QBR-SET-COLLCD-DL-MFGCD                PIC X.
           03  QBR-DEFAULT-SF-UNITPER-CD              PIC X.
           03  QBR-DEFAULT-SF-PURCD                   PIC X(3).
           03  QBR-DEFAULT-LN-UNITPER-CD              PIC X.
           03  QBR-DEFAULT-LN-PURCD                   PIC X(3).
           03  QBR-TAP-OTHER-DL                       PIC X.
           03  QBR-AH-AND-CL                          PIC X.
           03  QBR-NO-CASH-PROCEEDS                   PIC X.
           03  QBR-RI-BEFORE-REPO                     PIC X.
           03  QBR-RI-BEFORE-P4P5                     PIC X.
           03  QBR-NOT-OURS-REFUND                    PIC X.
           03  QBR-SFDLO3-WINDOW-FG                   PIC X.
           03  QBR-CALC-INS-ADJ                       PIC X.
           03  QBR-AC-BEFORE-REPO                     PIC X.
           03  QBR-AC-BEFORE-P4P5                     PIC X.
           03  QBR-BANK-ROUTING-NO                    PIC 9(9).
           03  QBR-BANK-CLEARING-GL                   PIC 9(11).
           03  QBR-GLBANK-DEPOSIT                     PIC 9(11).
           03  QBR-BANK-ACCTNO                        PIC X(17).
           03  QBR-DEFAULT-SC-SUBCLASS                PIC 9(3).
           03  QBR-NO-OUT-DLR-RSV                     PIC X.
           03  QBR-COLLECTOR-QUEUE                    PIC X.
           03  QBR-COLL-QUEUE-CON-REC                 PIC X.
           03  QBR-JE-ALLOCATION-SKIP                 PIC X.
           03  QBR-EXPAND-APP-INPUT                   PIC X.
           03  QBR-A50-CPCORP                         PIC X.
           03  QBR-INBR-BILNSC-FG                     PIC X.
           03  QBR-INBR-BRIEF-FG                      PIC X.
           03  QBR-LEDGER-JUST-INTCHG                 PIC X.
           03  QBR-BYINQ-START-PAGE                   PIC 99.
           03  QBR-DSINQ-START-PAGE                   PIC 99.
           03  QBR-APP-REQUIRED-FOR-INPUT             PIC X.
           03  QBR-CREDIT-SCORING-FG                  PIC X.
           03  QBR-COL-QUEUE-LOW-TO-HI                PIC X.
           03  QBR-CAN-GROUP-ID                       PIC X(4).
           03  QBR-AUTO-LNSTAT-WINDOW                 PIC X.
           03  QBR-TIME-ZONE-FACTOR                   PIC S9.
           03  QBR-LONPF-OPT-DISPLAY                  PIC X.
           03  QBR-GIFTNET                            PIC X.
           03  QBR-GIFTNET-LEDGER-LINE                PIC X.
           03  QBR-NO-FT-EMP                          PIC 9(3).
           03  QBR-NO-PT-EMP                          PIC 99V99.
           03  QBR-BALLOON-LOANS-FG                   PIC X.
           03  QBR-GL-TYPE-ALLOWED                    PIC X.
           03  QBR-GL-ENTRY-DEFAULT                   PIC X.
           03  QBR-MIDSTREAM-1STPAY-FG                PIC X.
           03  QBR-NODEF-1ST-X-MONTHS                 PIC 9.
           03  QBR-ADD-INS-FEECODE                    PIC XX.
           03  QBR-ROAD-G-SGL-FEECODE                 PIC XX.
           03  QBR-ROAD-G-FAM-FEECODE                 PIC XX.
           03  QBR-NODEF-IF-ZERO-AMT                  PIC X.
           03  QBR-ASSESS-LATE-CHGS                   PIC X.
           03  QBR-NEXT-SOLICIT-NO                    PIC 9(6).
           03  QBR-ADDON-FEECD-O3-1                   PIC XX.
           03  QBR-ADDON-FEECD-O3-2                   PIC XX.
           03  QBR-IMMEDIATE-RECEIPT                  PIC X.
           03  QBR-IMMEDIATE-DOC-PRINT                PIC X.
           03  QBR-AUTO-PL-REF-AC                     PIC X.
           03  QBR-FAX-NUMBER                         PIC 9(10).
           03  QBR-ALPHA-DRAWERS                      PIC X.
           03  QBR-LATECHG-ON-ALLOTMENTS              PIC X.
           03  QBR-ALLOW-SYS-AS-EFFDATE               PIC X(01).
           03  QBR-TAX-PREBOOK-CUST                   PIC 9(4).
           03  QBR-TAX-PREBOOK-NONCUST                PIC 9(4).
           03  QBR-PASSWORD-DRAWER                    PIC X.
           03  QBR-ONESTEP-RN-FG                      PIC X.
           03  QBR-LI-LISCAN-FG                       PIC X.
           03  QBR-HIDE-END-BAL                       PIC X(01).
           03  QBR-LBOX-NOPAYOFF                      PIC X.
           03  QBR-LBOX-ODDPAY                        PIC X.
           03  QBR-LBOX-LC                            PIC X.
           03  QBR-LBOX-NOPRIN                        PIC X.
           03  QBR-LBOX-FLASH                         PIC X.
           03  QBR-LBOX-ACTIONCD                      PIC X.
           03  QBR-LBOX-MAXCON                        PIC 9(3).
           03  QBR-LBOX-MAXREC                        PIC 9(3).
           03  QBR-LBOX-PL                            PIC X.
           03  QBR-LBOX-JD                            PIC X.
           03  QBR-LBOX                               PIC X(01).
           03  QBR-LATECHG-ON-LBOX                    PIC X(01).
           03  QBR-ALLOW-OV-TRCD                      PIC X.
           03  QBR-GLOBAL-QUEUE                       PIC X(01).
           03  QBR-LBOX-PAYOFF-NONCASH                PIC X.
           03  QBR-LBOX-PAYOFF-OV                     PIC X.
           03  QBR-COLLECT-MANAGER                    PIC X(25).
           03  QBR-COLLECT-PHONE                      PIC 9(10).
           03  QBR-COLLECT-EXT                        PIC 9(4).
           03  QBR-ALT-INTO-THIS-BRANCH               PIC X.
           03  QBR-POFF-TITLE-WINDOW                  PIC X.
           03  QBR-COUPON-STATEMENT                   PIC X.
           03  QBR-SUPERVISOR                         PIC X(25).
           03  QBR-AREA-MANAGER                       PIC X(25).
           03  QBR-MIN-MONTHS-DEF                     PIC 99.
           03  QBR-CC-FLAG                            PIC X.
           03  QBR-CC-ADR1                            PIC X(24).
           03  QBR-CC-CITY                            PIC X(15).
           03  QBR-CC-STATE                           PIC XX.
           03  QBR-CC-ZIP                             PIC X(10).
           03  QBR-MIN-MONTHS-D2                      PIC 99.
           03  QBR-SKIP-MIDSTREAM-TRW                 PIC X.
           03  QBR-GL-ESCROW-BALANCE                  PIC 9(11).
           03  QBR-GL-ESCROW-PAYABLE                  PIC 9(11).
           03  QBR-ALLOW-FORCE-OPEN-FG                PIC X.
           03  QBR-ACH-BANK-NO                        PIC 9.
           03  QBR-WIMENU-CHECK-WRITING               PIC X.
           03  QBR-ADP-PAY-GROUP                      PIC X(3).
           03  QBR-ALLOW-SCANNED-CKS                  PIC X.
           03  QBR-CHECK-DEPOSIT-GL                   PIC 9(11).
           03  QBR-OPTION-PST-LASER                   PIC X.
           03  QBR-USE-DEBIT-CARDS                    PIC X.
           03  QBR-GL-DEBIT-CARD-PROCEEDS             PIC 9(11).
           03  QBR-WKDAY-BANKID                       PIC 9(4).
           03  QBR-PURGE-NOW-FLAG                     PIC X.
           03  QBR-EMAIL                              PIC X(50).
           03  QBR-MANAGER-EMAIL                      PIC X(50).
           03  QBR-VERITEC-LICENSE                    PIC 9(7).
           03  QBR-TEST-PP-AUTO-INSCOVR               PIC X.
           03  QBR-USE-NEW-WFARGO-ACCT                PIC X.
           03  QBR-BRANCH-CLOSED                      PIC X.
           03  QBR-ALLOW-F3-ALL-DOCS                  PIC X.

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBGB\GB01BR_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBWSBR.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBWSBR
      *********************************************************
      *    LIBGB/LPWSBR:       BRFILE PATH WORKERS
      *
      * BR-PATH = /USR/DATA/R#/GB/BRFILE
      *           |----BEG----||-----FILE----|
      *                           |---SQL----|
      *
      *
      ******************************************************************
       01  BR-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.
       01  BR-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES BR-PATH.
           03  BR-PATH-BEG           PIC X(13).
           03  BR-PATH-FILE          PIC X(22).
           03  FILLER                REDEFINES BR-PATH-FILE.
               05  FILLER            PIC X(03).
               05  BR-PATH-SQL       PIC X(19).

       01  BR-ALL-PATH.
           03  BR-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES BR-ALL-BASE.
               05  BR-ALL-BASE-USR   PIC X(05).
               05  BR-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  BR-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/GB/BRFILE".
      *================================================================*
      * END COPYBOOK: LIBGB\GBWSBR.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01GB.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01GB
      **************************************************************************
      *      GLOBAL FILE
      *
      *    GB-KEY = GB-BRNO, GB-NO
      *
      * REV:
      *  KEC 011797 ADDED GB-NEXT-APPNO.
      *  JTG 082097 ADDED GB-NEXT-GIFTNET-PO
      *  JTG 101598 ADDED GB-NEXT-SF-REVOL GB-NEXT-LN-REVOL REGENCY REVOLVING
      *  MJD 990126 ----- UPDATED IN FLEXGEN -----
      *  CS  1999.0315 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  BAH 990622 ADDED GB-INS-PRODUCER FOR ANY TYPE OF INSURANCE NUMBER
      *             NEED FOR REGMGM VOYAGER PRODUCER NUMBER, PR# 891
      *  KEC 1999.0805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 2000.0410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 001120 {PR#00000} FINANCIAL MANAGEMENT [JUDY]
      *             ADDED GB-FEDERAL-TAXID      PIC X(10) AS PER BETH.
      *  BAH 051004 RENAMED GB-NEXT-GIFTNET-PO TO GB-NEXT-RECEIPT
      *             GB-NEXT-GIFTNET-PO WAS ONLY BEING USED BY 2 GL EXTRACTIONS
      *             AND GB-NEXT-NOTE IS BEING USED BY GIFTNET AT WORLD !!!
      *             WORLD PR# 436, MEXICO RECEIPT
      *  BAH 150930 MADE FILE INDEXED, ADDED GB-NO TO RECORD, PD0005
      *  BAH 160216 EXPANDED RECORD SIZE, EXPANDED CLASSES, ADDED BRNO PD0003
      *  BAH 181030 GLOBAL GBFILE, MOVED GB-BRNO UNDER GB-NO 
      *   CS 190408 ADD FUTURE FIELDS.SIZE WAS 550
      *   CS 190617 ADD GB-EOM-YYYYMM REPLACING END OF MONTH TAG FILE
      *  BAH 20190625 REMOVED GB-NEXT-SF-REVOL GB-NEXT-LN-REVOL PT0153
      *  BAH 20190705 REMOVED GB-NEXT-NOTE, GB-NEXT-APPNO, GB-NEXT-RECEIPT
      *  CS 20190708 ADD GB-EOM-UPDATE-DATE-TIME, GB-EOY-UPDATE-DATE-TIME, 
      *              GB-EOM-UPDATE-USERID,GB-EOY-UPDATE-USERID
      *  BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      *  BAH 20200519 REMOVED GB-PROGRP-1ST-LN-CLASS, GB-PROGRP-2ND-LN-CLASS,
      *               GB-FEDERAL-TAXID, GB-INS-PRODUCER, GB-TRW-CONTROL,
      *               GB-TRW-SUBSCRIBER
      *  BAH 20210909 REMOVED XFD DATE=HHNNSS ON TIMES
      *  20230600 BAH ADDED FILLER
      **************************************************************************
       78  GB-SIZE                     VALUE 500.
       01  GB-REC.
           03  GB-KEY.
               05  GB-BRNO                  PIC 9(4).
               05  GB-NO                    PIC 9.

      $XFD DATE=YYYYMMDD
           03  GB-LTOUCH-DATE               PIC 9(8)   COMP-3.
 
           03  GB-COMPANY-NAME              PIC X(40).
           03  GB-ADDR-1                    PIC X(25).
           03  GB-ADDR-2                    PIC X(25).
           03  GB-CITY                      PIC X(15).
           03  GB-STATE                     PIC XX.
           03  GB-ZIP                       PIC X(10).
           03  GB-PHONE                     PIC 9(10)  COMP-3.

           03  GB-NEXT-SF                   PIC 9(8)   COMP-3.
           03  GB-NEXT-SMALL                PIC 9(8)   COMP-3.
           03  GB-NEXT-OTHER                PIC 9(8)   COMP-3.

           03  GB-HOLIDAY-TAB.
               05  GB-HOLIDAY-TABLE  OCCURS 16 
                                     INDEXED BY GBHOIX.
                   07  GB-HOLIDAY           PIC 9(4)   COMP-3.

           03  GB-RPT-LINES                 PIC 99.
           03  GB-CHECK-PROG                PIC XX.
           03  GB-OTHER-BRANCH-POST         PIC X.
           03  GB-LAST-ACCRUE               PIC 9(4)   COMP-3.
           03  GB-AUTO-DEPOSIT              PIC X.
           03  GB-UUCP-HOME                 PIC X(8).
           03  GB-EOM-TAG-CCYYMM            PIC 9(6).
           03  GB-EOM-TAG-WORK     REDEFINES GB-EOM-TAG-CCYYMM.
               05  GB-EOM-TAG-CCYY          PIC 9999.
               05  GB-EOM-TAG-MM            PIC 99.
           03  GB-EOM-UPDATE-DATE-TIME.
      $XFD DATE=YYYYMMDD
               05  GB-EOM-UPDATE-DATE       PIC 9(8)   COMP-3.
               05  GB-EOM-UPDATE-TIME       PIC 9(6)   COMP-3.
           03  GB-EOM-UPDATE-USERID         PIC X(10).

           03  GB-FISCAL-EOY-TAG-CCYYMM     PIC 9(6).
           03  GB-FISCAL-EOY-TAG-WORK REDEFINES 
                         GB-FISCAL-EOY-TAG-CCYYMM.
               05  GB-FISCAL-EOY-TAG-CCYY   PIC 9999.
               05  GB-FISCAL-EOY-TAG-MM     PIC 99.

      *    EOYF = END OF YEAR FISCAL
           03  GB-EOYF-UPDATE-DATE-TIME.
      $XFD DATE=YYYYMMDD
               05  GB-EOYF-UPDATE-DATE      PIC 9(8)   COMP-3.
               05  GB-EOYF-UPDATE-TIME      PIC 9(6)   COMP-3.
           03  GB-EOYF-UPDATE-USERID        PIC X(10).
                
           03  GB-CALENDAR-EOY-TAG-CCYYMM   PIC 9(6).
           03  GB-CALENDAR-EOY-TAG-WORK REDEFINES
                           GB-CALENDAR-EOY-TAG-CCYYMM.
               05  GB-CALENDAR-EOY-TAG-CCYY PIC 9999.
               05  GB-CALENDAR-EOY-TAG-MM   PIC 99.

      *    EOYC = END OF YEAR CALENDAR
           03  GB-EOYC-UPDATE-DATE-TIME.
      $XFD DATE=YYYYMMDD
               05  GB-EOYC-UPDATE-DATE      PIC 9(8)   COMP-3.
               05  GB-EOYC-UPDATE-TIME      PIC 9(6)   COMP-3.
           03  GB-EOYC-UPDATE-USERID        PIC X(10).

           03  FILLER                       PIC X(212).
      *================================================================*
      * END COPYBOOK: LIBGB\GB01GB.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01GB_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01GB_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - GLOBAL FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0503 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  GB-CURSOR-STAT               PIC X(2)  VALUE SPACES.
           88  GB-CURSOR-STAT-GOOD                VALUE "00".
           88  GB-CURSOR-STAT-BAD                 VALUE "  " THRU "//"
                                                        "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  GB1-RETURN-CODE               PIC S9(4)   COMP-5.

       01  QGB-WHERE-BEG-KEY.
           03  QGB-WBEG-BRNO             PIC 9(04).
           03  QGB-WBEG-NO               PIC 9.
 
       01  QGB-WHERE-END-KEY.
           03  QGB-WEND-BRNO             PIC 9(04).
           03  QGB-WEND-NO               PIC 9.
 
       01  QGB-REC.
           03  QGB-BRNO                      PIC 9(4).
           03  QGB-NO                        PIC 9.
           03  QGB-LTOUCH-DATE               PIC X(10).
           03  QGB-COMPANY-NAME              PIC X(40).
           03  QGB-ADDR-1                    PIC X(25).
           03  QGB-ADDR-2                    PIC X(25).
           03  QGB-CITY                      PIC X(15).
           03  QGB-STATE                     PIC XX.
           03  QGB-ZIP                       PIC X(10).
           03  QGB-PHONE                     PIC 9(10).
           03  QGB-NEXT-SF                   PIC 9(8).
           03  QGB-NEXT-SMALL                PIC 9(8).
           03  QGB-NEXT-OTHER                PIC 9(8).
           03  QGB-HOLIDAY-1                 PIC 9(4).
           03  QGB-HOLIDAY-2                 PIC 9(4).
           03  QGB-HOLIDAY-3                 PIC 9(4).
           03  QGB-HOLIDAY-4                 PIC 9(4).
           03  QGB-HOLIDAY-5                 PIC 9(4).
           03  QGB-HOLIDAY-6                 PIC 9(4).
           03  QGB-HOLIDAY-7                 PIC 9(4).
           03  QGB-HOLIDAY-8                 PIC 9(4).
           03  QGB-HOLIDAY-9                 PIC 9(4).
           03  QGB-HOLIDAY-10                PIC 9(4).
           03  QGB-HOLIDAY-11                PIC 9(4).
           03  QGB-HOLIDAY-12                PIC 9(4).
           03  QGB-HOLIDAY-13                PIC 9(4).
           03  QGB-HOLIDAY-14                PIC 9(4).
           03  QGB-HOLIDAY-15                PIC 9(4).
           03  QGB-HOLIDAY-16                PIC 9(4).
           03  QGB-RPT-LINES                 PIC 99.
           03  QGB-CHECK-PROG                PIC XX.
           03  QGB-OTHER-BRANCH-POST         PIC X.
           03  QGB-LAST-ACCRUE               PIC 9(4).
           03  QGB-AUTO-DEPOSIT              PIC X.
           03  QGB-UUCP-HOME                 PIC X(8).
           03  QGB-EOM-TAG-CCYYMM            PIC 9(6).
           03  QGB-EOM-UPDATE-DATE           PIC X(10).
           03  QGB-EOM-UPDATE-TIME           PIC 9(6).
           03  QGB-EOM-UPDATE-USERID         PIC X(10).
           03  QGB-FISCAL-EOY-TAG-CCYYMM     PIC 9(6).
           03  QGB-EOYF-UPDATE-DATE          PIC X(10).
           03  QGB-EOYF-UPDATE-TIME          PIC 9(6).
           03  QGB-EOYF-UPDATE-USERID        PIC X(10).
           03  QGB-CALENDAR-EOY-TAG-CCYYMM   PIC 9(6).
           03  QGB-EOYC-UPDATE-DATE          PIC X(10).
           03  QGB-EOYC-UPDATE-TIME          PIC 9(6).
           03  QGB-EOYC-UPDATE-USERID        PIC X(10).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBGB\GB01GB_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBWSGB.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBWSGB
      *********************************************************
      *    LIBGB/GBWSGB: GBFILE PATH WORKERS
      *    GB-PATH = /USR/DATA/XX/XX####/GB/GBFILE
      *              |----BEG----||-MID-||-----FILE----|
      *
      ******************************************************************
       01  GB-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  GB-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES GB-PATH.
           03  GB-PATH-BEG           PIC X(13).
           03  GB-PATH-OWNST         PIC X(02).
           03  GB-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  GB-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES GB-PATH-FILE.
               05  FILLER            PIC X(03).
               05  GB-PATH-SQL       PIC X(12).

       01  GB-ALL-PATH.
           03  GB-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES GB-ALL-BASE.
               05  GB-ALL-BASE-USR   PIC X(05).
               05  GB-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  GB-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(01)   VALUE "/".
           03  GB-ALL-DATA           PIC X(06).
           03  FILLER                PIC X(10)   VALUE "/GB/GBFILE".
      *================================================================*
      * END COPYBOOK: LIBGB\GBWSGB.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01SP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01SP         
      ******************************************************************
      *
      * DESCRIPTION: STATE PARAMETER FILE   - MASTER LAYOUT
      *
      * COPY USAGE : LIBLP/LPWSSP.CPY
      *
      * FILE SIZE  : ----------- 6500 WAS 6000
      *              SP1-KEY   =    9
      *              SPA       = 1225 WAS 975
      *              SPB       = 2724 WAS 2544
      *              SPC       = 2542 WAS 1358
      *
      * FILE PATHS : /USR/DATA/R#/LP/SPAFILE  (LIBLP/LP01SPA_AREA.CPY)
      *              /USR/DATA/R#/LP/SPBFILE  (LIBLP/LP01SPB_AREA.CPY)
      *              /USR/DATA/R#/LP/SPCFILE  (LIBLP/LP01SPC_AREA.CPY)
      *
      * ATTENTION  : SPECIAL HARDCODED CODING FOR THE MULTIPLE BY FILES:
      *                 SP/SPMEMO
      *                 SP/SPCOPY
      *
      * ***ALL*** REVISION NOTES FOR FIELDS IN THE SPLIT FILES
      *           (SPAFILE, SPBFILE & SPCFILE) ARE LOCATED HERE.
      *
      * *** NOTE ***  : WHEN ADDING NEW FIELDS, NEED TO UPDATE CL/SPMEMO
      *
      *=================================================================
      * REV:
      * JTG 033095 ADDED SP-INS-UNITPER-MON = 11,  FL
      *            N O T E:
      *                LOGIC FOR CODE IN CALCZ3.C & NOT CALCZL.C
      *                USED FOR UNITPER OTHER THAN MONTHLY
      *                THIS IS SP-INSEXCEPT #10 IN REL: A50
      * JTG 033095 ADDED SP-INS-ADJ-CASH-ADVANCE  VALUE "S".
      *            N O T E:
      *                LOGIC FOR CODE IN CALCZ3.C & NOT CALCZL.C
      * JTG 033095 ADDED SP-FEEFRMLA, SP-FEECD , SP-FEEID
      *            N O T E:
      *                LOGIC FOR CODE IN CALCZ3.C & NOT CALCZL.C
      * SLC 051895 ADDED SP-CONTR-CREDIT.
      * SLC 051995 ADDED "U' TO SP-RBFRMLA-VALID.
      * JTG 052495 ADDED SP-CONTR-CREDIT-CD.
      * JTG 061095 ADDED SP-RBEARLY = 9, MERCURY
      * JTG 061295 ADDED SP-SCFRMLA = 20, MERCURY
      * SLC 062495 ADDED SP-DEFBASE VALID THRU 10
      *                  8 = WHOLE REMAINING PMTS
      *                  9 = NET BALANCE
      *                 10 = NET BALANCE + 5.00.
      * JTG 062695 ADDED SP-CONTR-CREDIT-MIN-DEL-PER.
      * JTG 062795 ADDED SP-RBEARLY = 10, MERCURY
      * JTG 062995 ADDED SP-OPT-CAL-CHGABLE, MERCURY MI SERCHG
      * SLC 070295 ADDED "V" AND "W" TO SP-RBFRMLA-VALID.
      * JTG 070595 ADDED SP-SCFRMLA = 21, MERCURY (MI)
      * JTG 070695 ADDED SP-LCFRMLA = L, MERCURY (UCCC) EX. 'IN'
      * SLC 070795 ADDED SP-INSREJECT-FG FOR RESTRICTIONS ON INS BASE
      *            ON AGE & TERM.
      * JTG 071995 ADDED SP-PBDEL-DAYS
      * JTG 072195 ADDED SP-PBINCR-PERCENT
      *                  SP-CPOT30-CD    SP-RDPOT30-CD
      *                  SP-CPOTCHGOFF-CD   SP-RDPOTCHGOFF-CD
      * JTG 081395 ADDED SP-ERNFRMLA = 60, MERCURY ACTUARIAL (ELAPSED DAYS)
      * JTG 082595 ADDED SP-LCFRMLA = M, MERCURY 'LA'
      * JTG 083095 ADDED SP-ERNFRMLA = 61, MERCURY MAINTFEE (ELAPSED DAYS)
      * JTG 083195 ADDED SP-INSRATECD = 5, MERCURY ACTUARIAL 78THS (SF) (VA)
      *                  SP-INSRATECD = 6, MERCURY ACTUARIAL (LOANS) (VA)
      * JTG 091995 ADD SP-INSEXCEPT = 12, MERCURY 'LA' SP-CALC-PREM-LESS-EXTCHG
      * BAH 092595 ADDED SP-RBEARLY = 11, MERCURY 'MS'
      * MJD 092895 ADDED SP-TX-PP-FIRE AS A VALID INS RATE CODE (VALUE 7).
      * JTG 101695 ADDED SP-RBFRMLA = 'X', MERCURY 'WI' DEFERMENT REFUND
      * JTG 110995 ADDED SP-INSCHGABLE = 'O', NC NET PAYOFF WITH CALCULATED MOB
      * BAH 111095 ADDED SP-RBEARLY = 12, MERCURY 'AL' (ACTION SPREAR = 1)
      * BAH 111595 ADDED SP-LCTYPE = "N", MERCURY 'TN' 'KS'
      * BAH 111595 ADDED SP-RBSPOPT1 = 12, MERCURY 'AL' INTEREST REFUND FORMULA
      *            ACTION SPRR78 = 13 RUILE OF 78/PRIOR TO 1STPYDATE
      * JTG 111595 ADDED RATECD SP-CA-NETPAYOFF-5A VALUE 8, ACTION CHARGABLE 5A
      * BAH 111695 ADDED SP-RBFRMLA = 'Y', MERCURY 'SC' DEFERMENT REFUND
      * BAH 111695 ADDED SP-RBFRMLA = 'Z', MERCURY 'AZ' DEFERMENT REFUND
      * BAH 111795 ADDED SP-RBFRMLA2 OCCURS 18 TIMES, RAN OUT OF RBFRMLA'S
      * JTG 112195 ADDED SP-RBSPOPT1 = 13, ACTUARIAL 'F' NEAREST DUE DATE
      *            OPTION MERCURY ARIZONA ACTION 24
      * JTG 112495 ADDED SP-RBEARLY = 13, MERCURY 'NV' PP REFUND ACTION 8
      * JTG 112895 ADDED SP-LCFRMLA = N, MERCURY 'NV'
      * BAH 011096 ADDED SP-MAX-ALLOW-DELINQ FOR MERCURY
      * JTG 011096 ADDED SP-RBFRMLA2 = 1, MERCURY 'AZ' FIRE REFUND (PP)
      *            ALSO OPENED UP SP-RBFRMLA = 0, AS TRIGGER TO SP-RBFRMLA2
      * JTG 112195 CHANGED SP-RBSPOPT1 = 13, TO ALSO BASE THE INTEREST START
      *            DATE FROM ONE MONTH PRIOR TO ORIGINAL FIRST PAY DATE
      *            ----
      *            ADDED SP-RBSPOPT1 = 14, TO  BASE THE INTEREST START DATE
      *            FROM ONE MONTH PRIOR TO ORIGINAL FIRST PAY DATE
      *            ACTION REBATE FORMULA 27
      * JTG 012696 ADDED RATECD SP-AL-NETPAYOFF VALUE 10, MERCURY ITT LYNDON
      * BAH 020296 ADDED LCTYPE = "O" FOR EAST TENNESSEE
      * JTG 021196 ADDED SP-RBSPOPT1 = 15, MERCURY 'OREGON' RULE OF
      *            ANTICIPATION OPTION
      * BAH 042996 ADDED SP-SCFRMLA = 22 , PACESETTER (MI)
      * BAH 043096 ADDED SP-SCFRMLA = 23 , NORTH CAROLINA
      * JTG 051596 CHANGED SP-INS-RATE-FILE VALUES TO 71 THRU 99
      * JTG 060396 RESERVED SP-SCFRMLA = 24 , NEBRASKA (GRAND ISLAND A48)
      * BAH 070196 REMOVED SP-INSTBL(13,14), SP-INSFEETBL(13,14)
      *                    SP-REBTBL(17,18), SP-REBTBL2(17,18)
      * JTG 070296 ADDED SP-LCUNITPER-CD, SP-DEFUNITPER-CD,
      *                  SP-RBUNITPER-CD(OCCURS 16)
      * BAH 070896 ADDED SP-SCFRMLA = 25, MERCURY 'KS'
      * BAH 072496 ADDED SP-DEFPERCD = 8 (INSTANT AUTO)
      * BAH 082996 ADDED SP-RBEARLY = 14 (SUN, LA)
      * JFF 100896 ADDED SP-SCFRMLA = 26, MERCURY 'WA'
      * JTG 102896 ADDED SP-ERNFRMLA = 21, ACTUARIAL PRIN.REDUCTION (INTDATE)
      *                  SAME AS SP-ERNFRMLA 12, EXCEPT FOR ACTUARIAL RATE USED
      * JTG 111596 ADDED SP-INSRATECD = 11, (88) SP-ADVANCE-MTG-FIRE
      * KEC 111596 ADDED SP-RESCIND-BUS-DAYS;
      *             (88) SP-RESCIND-BUS-DAYS-VALID
      * JTG 120496 CHANGED THE FOLLOWING TO ALLOW A 'Z' AND NOT 'B'
      *            TO MATCH LOGIC IN LONPFA.C & LONPFB.C
      *            88  SP-DLRVCHGS-RB-CD-VALID        VALUE " " "A" "Z".
      *            88  SP-PARVHELD-RB-CD-VALID        VALUE " " "A" "Z".
      *            88  SP-PARVPAID-RB-CD-VALID        VALUE " " "A" "Z".
      * BAH 121396 ADDED SCFRMLA 27, MERCURY CALIF. #L 042
      * BAH 121696 ADDED SCFRMLA 28, ADVANCE  # 405
      * JTG 011097 ADDED SP-ERNFRMLA = 22 DISCOUNT EARN FORMULA, ATLANTIC FIN
      *                  BALANCE REMAINING METHOD
      * BAH 021197 ADDED RBEARLY 15 = ALABAMA, SAME AS 12, EXCEPT 120 DAYS
      *            FOR MERCURY
      * BAH 021197 ADDED RBEARLY 16 = ALABAMA, SAME AS 3, EXCEPT 120 DAYS
      *            FOR SUN FINANCE
      * JTG 021297 ADDED THE FOLLOWING FOR MERCURY, OH 30 1 1
      *              88  SP-PYEXSPCODE-REGZ      VALUE 0.
      *              88  SP-PYEXSPCODE-REMAIN    VALUE 1.
      * BLV 022097 ADD SP-MIN-CREDIT-SCORE
      * KEC 031297 ADDED SP-RESCIND-SATURDAY; PR#459.
      * JTG 041097 MADE SP-EXPR-FRMLA 'B' VALID AND ADDED
      *            88  SP-EXPR-FRMLA-ORIG         VALID "B".
      *            88  SP-EXPR-FRMLA-USE-EXPIRED  VALID "A" "B".
      * JTG 051397 ADDED SP-RBEARLY = 17, CLAY FINANCIAL SINGLE PAY LOANS ONLY
      * BAH 062597 ADDED SP-RBEARLY 18, 19 AND 20 FOR WORLD (A90-9,10,11)
      * JTG 071197 ADDED SP-ERNFRMLA = 64, MERCURY DISCOUNT EARN FORMULA
      *            SAME RATIO AS INTEREST IS EARNED
      * BAH 071197 ADDED INSFINCHG(), AND REARRANGED RECORD.....CREATED FIX
      * JTG 071897 ADDED SP-PACESETTER-FG RE: GRAND ISLAND #135
      * JTG 072897 ADDED SP-WAGE-ASSIGN-DAYS RE: MERCURY/MIDLAND #E135
      * MJD 072997 ADDED SP-RBEARLY = 21: EARLY PROVISION FOR ACQUISITION
      *            CHARGES. ADDED 99 TO SP-RBEARLY-VALID.
      * JTG 091697 ADDED 'D' WORLD A90, TO SP-BANKRULE & SP-TRWBANKRULE
      * BAH 102997 ADDED FEEFRMLA = 'C' FOR DOC STAMPS, COMMERCIAL PR#579
      * BAH 123097 ADDED SP-SCFRMLA 29 FOR MULLEN, SAME AS 5 BUT WITH
      *            4'S RENEWAL RESTRICTION, PR# 589
      * JTG 051298 ADDED SP-CAL-PAYMENT-ROUND-FG, CAVILER #XXX
      * BLV 061198 ADDED SP-SIZE 4513; ALL REFERENCES TO SP REC SIZE IN
      *            A10 HAVE BEEN 4502 SINCE FALL OF 97!
      * KEC 071398 ADDED SP-CAN-LOANS-FG.                       PR# 187
      * JTG 072198 ADDED SP-INSRATECD = 13, SP-LYNDON-NET-PAYOFF MERCURY, AL
      * JTG 072198 REMOVED SP-INSRATECD = 13, SP-LYNDON-NET-PAYOFF MERCURY, AL
      * BAH 081098 ADDED SP-ALLOW-DELINQ-POLCD AND SP-YTD-MAX-ALLOW-DELINQ
      *            FOR MERCURY'S NEW EDIT ON ALLOW DELINQ'S, #193
      * JTG 082898 ADDED SP-ERNPERCD-EFFSMP  VALUE "S" CITIZENS #733.
      * KEC 092498 ADDED THE FOLLOWING FOR REVOLVING CREDIT (REGENCY):
      *              SP-REVOL-APPLY-ORDER[5]
      *              SP-REVOL-APPLY-PURCHASE
      *              SP-REVOL-BAL-FRMLA
      *              SP-REVOL-CYCLE-DATE-FRMLA
      *              SP-REVOL-CYCLE-DATE-TABLE[31]
      *              SP-REVOL-PYMT-DUE-FRMLA
      *              SP-REVOL-PYMT-DUE-WORK
      *              SP-REVOL-PYMT-EXCEPTION
      *              SP-REVOL-PYMT-MINIMUM
      *              SP-REVOL-PYMT-MAXIMUM
      *              SP-REVOL-PYMT-PERCENT
      *              SP-REVOL-PYMT-ROUND-CODE
      *              SP-REVOL-PROGRAM-TABLE[10]
      *              SP-REVOL-NO-MTHS-NA-PRINT-STMT
      * JTG 100598 ADDED SP-CAL-BREAK-ON-FLATAMT    VALUE "F", WORLD 'MO'
      * JTG 091697 ADDED 'R' REGENCY REVOL, TO SP-BANKRULE & SP-TRWBANKRULE
      *            ADDED 'R' REGENCY REVOL, TO SP-LCFRMLA
      * BAH 102198 ADDED SP-RBEARLY 22 FOR FREEDOM, AL #775, WITHIN 90 DAYS
      *            DO PRORATA, OTHERWISE, NO REFUND
      * KEC 103098 ADDED SP-REVOL-MEMBERSHIP-FEE
      *                  SP-REVOL-MEMBERSHIP-FORMULA; REGENCY REVOLVING
      * BAH 110398 ADDED SP-SCFRMLA 30, CITIZENS TN PR# 779
      * JTG 112098 EXPANDED SP-REVOL-APPLY-ORDER[5] TO [15]
      *                     SP-REVOL-IS-FINCHG[15]
      * JTG 122198 ADDED SP-RBSPOPT1 = 16 OHIO PREPAY PENALTY, REGENCY #001
      * JTG 122198 ADDED SP-LCTYPE = 'P'  OHIO PRIOR 07/12/96, REGENCY #002
      * JTG 122198 ADDED SP-SCFRMLA = 31, OHIO FLAT DOLLAR   , REGENCY #003
      * JTG 122198 ADDED SP-SCFRMLA = 32, OHIO % PRINCIPAL   , REGENCY #004
      * JTG 122198 ADDED SP-SCFRMLA = 33, OHIO %PRIN /FEE    , REGENCY #005
      * JTG 122198 ADDED SP-SCFRMLA-POINTS  VALUE 1 8 28 32 33
      * JTG 990112 ADDED SP-LNCOST-FRMLA AND SP-LNCOST-AMT,    REGENCY #006
      * JTG 990113 ADDED SP-EDT-TYPE 'P' POINTS,               REGENCY #012
      * JTG 990121 ADDED 88  SP-LCTYPE-REVOL-VALID VALUE " " "A" "B" "E" "F".
      * MJD 990127 ----- UPDATED IN FLEXGEN -----
      * JTG 990210 ADDED SP-SCFRMLA = 34, PA %CASH ADV.        REGENCY #013
      * KEC 990211 CHANGED SP-RESCIND-BUS-DAYS-VALID FROM
      *             'VALUE "0" THRU "5"' TO 'VALUE "0" THRU "8"'.
      *                                               REGENCY PR# 00015
      * BAH 990217 ADDED SP-SCFRMLA = 35, PA REGENCY #016
      * JTG 990218 ADDED SP-INSCHGABLE = 'F', CASH ADV LESS FEES, REGENCY #020
      * JTG 990218 ADDED SP-INSRATECD = 13,14,15, REGENCY CL NET PAYOFF FRMLA'S
      *           88  SP-RG-PA-NET                VALUE 13.
      *           88  SP-RG-OH-NET                VALUE 14.
      *           88  SP-RG-NY-NET                VALUE 15.
      * JTG 990218 ADDED SP-INSCHGABLE = 'K', AMTFIN - CL,         REGENCY
      * JTG 990218 ADDED SP-INSCHGABLE = 'L', AMTFIN + SC - CL,    REGENCY
      * BAH 990222 ADDED SP-INSEXCEPT 13, REGENCY  (SP-CL-AH-MAXIMUMS) #023
      * CS  1999.0301 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * GLF 030299 ADDED SP-LCTYPE-VALID OF "Q" FOR MULLEN
      * JTG 990309 ADDED SP-CPOTCHGOFF-CD-VALID "B" REGENCY
      * JTG 990311 ADDED SP-BANKUNITPER-CD & SP-TRWBANKUNITPER-CD = 'E' TFC
      * JTG 990317 ADDED SP-DLDISC-RVPRIN1-PCNT,                       TFC #008
      *                  SP-LNCOST-FRMLA-VALID VALUE "D"
      * JTG 990329 ADDED SP-ERNDELQFRMLA 'C'                           TFC #005
      * JTG 990419 ADDED SP-RECFRMLA-CALENDAR-DUEDAY  "D"         FROM REL: A50
      *            ADDED SP-RECFRMLA-PERCNT-PMT       "P"         MERCURY  #183
      * KEC 1999.0503 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BAH 990519 ADDED SP-RBFRMLA2 = '2', CL NET PAYOFF BALBOA  MULLEN   #???
      * JTG 990519 ADDED SP-RBFRMLA2 = '3', MEAN RULE 78THS       REGACC   #N/A
      * JTG 990520 ADDED SP-MAINE-NET            VALUE 16          MAINE   #999
      *                  SP-FREEDOM-NET-BALLOON  VALUE 17        FREEDOM   #862
      * BAH 990603 ADDED SP-RBEARLY = 23, WORLD (MO) #206
      * BAH 990603 ADDED SP-RBSPOPT1 = 17, REGACC  #875
      * BAH 990623 ADDED SP-SCFRMLA = 36,(POINTS) WESTERN  #879
      * JTG 990624 ADDED SP-BANKRULE & SP-TRWBANKRULE = 'S' REVOL REGENCY  #044
      * BAH 990720 ADDED SP-SCFRMLA 37, FIXED CHG WITH RENEW EDITS, #894 EXCEL
      * BAH 990720 ADDED SP-RBSPOPT2 8, INSURANCE ORGTERM SWING 16 DAYS FOR
      *            REBATES, REGACC # 911
      * KEC 990805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * KEC 990811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BAH 991014 ADDED MFFRMLA 3 FOR MERCURY PR# 220
      * GLB 991115 ADD NEW REVOLVING FIELD, SP-REVOLV-STMT-FORMAT
      * BLV 991117 ADDED SP-RENEWABLE-PAYS, SP-RENEWABLE-DAYS: WORLD PR# 213
      * JTG 991203 ADDED SP-ALLOW-LN-BACK-DATE, REGMGM# 1029
      * JTG 990317 ADDED SP-DLDISC-RVPRIN1-AF-PCNT,                    TFC #058
      * JTG 991202 ADDED SP-RBREDUC = 9999.03 NEW SOUTH, (GA)
      * MJD 991220 ADDED SP-DEFPOLCD = "B" (WORLD PR#216)
      * JTG 000104 ADDED SP-RBREDUC = 9999.04 WISCONSIN IB REAL ESTATE
      *            PREPAY PENALTY, WISCONSIN #1031
      * JTG 000111 ADDED SP-INSREJECT-FG OPTION 'C', WHICH WILL CAUSE WRITTING
      *            THE NO OF MONTHS INSURANCE NOT IN VIOLATION, WISCONSIN #1032
      * JTG 000119 ADDED SP-RBFRMLA2 '4', TN PROPERTY REFUND (SHORT RATE
      *            METHOD) CONSUMER FINANCIAL PR#1062
      * BAH 000124 ADDED SP-RBCOMCD  VALUE "B" FOR REGENCY, PR# 1048 FOR
      *            NOT ALLOWING COMBINED CL & AH REFS OF LESS THAN $10.
      * JTG 000124 ADDED SP-CAL-MAX-AT-ESTIMATE INSTANT AUTO #1047
      * BLV 000202 ADDED SIGN TO SP-RENEWABLE-PAYS, SP-RENEWABLE-DAYS:
      *            WORLD PR# 213, NEED SPECIAL FORMULA FOR WORLD CLASS 5
      * BAH 000225 ADDED SP-SCFRMLA 38 FOR REGENCY, PR# 1095
      * MJD 000228 ADDED SP-RBREDUC = 9999.05 NEW SOUTH, (GA)
      * JTG 000308 ADDED LOGIC FOR UNION SECURITY CREDIT LIFE NET PAYOFF,
      *                   SP-RG-TN-NET & SP-RG-KY-NET          REGENCY  TN & KY
      * JTG 000320 NEW DEFERMENT FORMULA SP-DEFFRMLA (> OF INTDUE OR 1/3 OF
      *            REGPAY)  MERCURY #224
      * GLB 000404 ADD VALID OPTION "M" TO SP-REVOL-CYCLE-DATE-FRMLA
      * GLB 000406 ADDED SP-RBREDUC = 9999.06 CAROLINA, (NC), PR# 1149
      * JTG 000406 ADDED NEW SP-ERNACCRL-FG() N D, NEW SOUTH #1129 TAKE EARN
      *            AFTER SAME AS CASH DATE
      * BAH 000407 ADDED SP-RBSPOPT1 = 18, SAME AS OPT1 = 7 PLUS MORE,
      *            MULLEN PR# 1118
      * KEC 2000.0410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BLV 000508 ADDED SP-CPOTCHGOFF-CD-VALID "C", CONSIDER 120+ AS
      *            POTENTIAL CHARGE-OFFS,  MERC PR# 230
      * MJD 000516 ADDED SCFRMLA-VALID FOR 39 (SUPPORT PR#1181)
      * BAH 000517 ADDED 88 SP-INSRATECD-NET-PAYOFF FOR REGENCY AMPLE
      *            REPORTING, TIRED OF TESTING STATES AND CLASSES !!
      * BAH 000523 ADDED SP-INSAH-RETRO AND SP-INSAH-DAYS-WAIT SO WE CAN
      *            STOP HARD CODING THESE OPTIONS !! ADD TO A&H PAGE 9
      * GLB 000524 ADD "B";VALID SP-REVOL-MEMBERSHIP-FRMLA TO " " OR "A"
      * JTG 000619 ADDED LOGIC FOR TENNESSEE RATE TYPE 'M' FLAT MONTHLY CHARGE
      *            #1225
      * MJD 000619 ADDED "V" TO SP-EDT-TYPE-VALID (PR#1220)
      * JTG 000621 CORRECTED FORMULA'S 99, 98 AND 97 INTEREST BEARING
      *            DEFERMENT CHARGES, BY SETTING UP DEF-TOTAL-INTDUE
      *            AS A INPUT FIELD AND NOT USING INDU-INTEREST MERCURY #224
      *            AND CREATED 88 SP-DEFFRMLA-IB-FORMULAS   VALUE 97 98 99.
      * JTG 000720 ADDED TWO 88'S FOR SP-LCFRMLA RE: FXLCGD.C, ETC
      *            SP-LCFRMLA-PRIN-ONLY
      *            SP-LCFRMLA-TOTAL-MONEY
      * JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *            SP-RBSPOPT1() = 19, WORLD #233
      * JTG 000919 ADDED SP-ADDON-EXCEPT-FG REGACC #71225 PR#1297
      * BAH 000920 ADDED SCFRMLA 40 AND TOTALLY CHANGING SCFRMLA 39, REGWAN
      *            NEVER USED AS WAS, AND NOW NEED 2 MORE !! PR# 1314
      * MJD 001030 ADDED SP-SCFRMLA = 41,(POINTS) WESTERN  #879
      * JTG 010112 ADDED NEW 88 SP-CAL-SET-SMPRATE-OVRRIDE VALUE 4 MERC PR#J016
      * JTG 010228 ADDED NEW RATE TYPE 'Z' AMORTIZED WHERE RUNTIME COMPUTES
      *            INTEREST ON A 30 DAY METHOD (REAL ESTATE) AND LOAN CALCS
      *            ARE DONE SIMPLE                   LENDMARK PR#1045 & PR#1380
      * BAH 010413 ADDED SP-RBSPOPT2 9 FOR LENDMARK, FULL REFUND UP TO "SAME
      *            AS CASH" DATE, PR# 1443
      * JTG 010503 NEW CODE 'B' FOR SP-RBUNITPER-CD(OCCURS 16)    PAACO PR#1466
      * BAH 010518 ADDED SP-SCFRMLA = 42,(SC SMALL LOANS)      SUNBELT  PR#1484
      * JTG 010521 NEW CODE 'T' FOR SP-ERNPERCD-VALID-SC
      *            NEW CODE '23' FOR SP-ERFRMLA                   PAACO PR#1469
      * BAH 010607 ADDED SP-SCFRMLA = 43 FOR FCF "NC", PR# 1506
      * BAH 010607 ADDED SP-SCFRMLA = 44 FOR FCF "VA", PR# 1498
      * KEC 010608 {PR#01478} REGIONAL ACCEPTANCE [KEVIN MULLEN]
      *            ADDED '03  SP-REPO-TRCD-FMNO-TABLE OCCURS 3 TIMES.'
      * BAH 010620 ADDED SP-PYEXFRMLA 11 FOR REGWAN, PR# 1515
      * JTG 010625 CREATED LCAP-X (BAD LOGIC) BY PUTTING BACK THE OLD LOGIC
      *            FOR LCAP-E                                     IDEAL PR#1509
      * JTG 010808 ADDED SP-LNCOST-FRMLA-VALID 'P' AMORTIZED
      *            PARTICIPATION EXPENSE                         REGACC PR#1559
      * BAH 010910 ADDED SP-RBSPOPT2 = 10, FULL REFUND UP TO 60 DAYS,
      *            REGACC PR# 1550
      * JTG 010912 NEW SP-CAL-TBFRMLA (5) SP-FORCE-ENTRY-OVRDRATE CENTRIX #1592
      * JTG 011024 NEW DEFERMENT REFUND SP-RBFRMLA2 = 5 SMALL LOANS
      *                                                          CITIZENS #1622
      * JTG 011026 CHANGED RBACT-APRATE TO RBACT-RATE FOR NEW REFUND FORMULA
      *            '0  6'                                       REGENCY PR#1631
      * JTG 011106 NEW SP-INSRATECD (20) 88 SP-CA-TRUNC-NET-MULL MULLEN PR#1641
      * JTG 011107 PLUS NEW SP-RBFRMLA (0 7) CL & AH REFUNDS     MULLEN PR#1641
      * BAH 011203 ADDED SP-INSEXCEPT 14, REGENCY (SP-ORGTERM-MAXIMUM)  PR#1657
      * BAH 011228 ADDED SP-SCFRMLA 45, HCRED "NC"  PR#1695
      * JTG 020419 PUT A48 LOGIC PACK AS AN OPTION FOR COMPUTING THE INTEREST
      *            REFUNDS FOR ALL ADDED: SP-CANCEL-ADDON-FG        COSMO #355
      * JTG 020530 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *            ADDED SP-INSCHGABL = 'Y' SP-INS-MIP
      * BAH 020802 ADDED SP-MFFRMLA 4 FOR REGWAN, "TN" PR# 1867
      * KEC 020821 {PR#01832} LENDMARK <A15> [JIM ROSENAUER]
      *             ADDED "SP-REVOL-STMT-EXTRACTION PIC X(01)"  (Y/N)
      * JTG 020919 ADDED NEW SHORT RATE FORMULA SP-RBEARLY = 24 (PP)    TFC #96
      * GLB 021114 ADD NEW FIELD SP-REVOL-ZERO-ADB PR#1946 FOR LENDMARK
      *            IF "Y" AND LN-CURBAL = 0, DONT CALCULATE CURRENT INTEREST
      * JTG 030128 CREATED FORMULA 12 LIKE 2 BUT SPREADS EXTENSION CHARGE
      *            OVER PAYMENTS  88  SP-PYEXFRMLA-SAME2-SPREAD VALUE 12.
      *                                                          CITIZENS #2006
      * BAH 030129 ADDED SCFRMLA 46 FOR LENDMARK PR# 2004
      * JTG 030513 ADDED SP-RBFRMLA2 (0 8) WISCONSIN CPI REFUND FORMULA
      *                                                          CITIZENS #2065
      * JTG 030528 ADDED SP-LCFRMLA = 'P' LIKE 'I'                  PACE #408
      * JTG 030620 ADDED LOGIC FOR IB SALES FINANCE AMORTIZATED PARTICIPATION
      *            RESERVE PAID EXPENSE, DIFFERENCE BETWEEN A BUY RATE
      *            AND THE CONTRACT RATE
      *            ADDED SP-LNCOST-FRMLA = '3'          WISCONSIN FINANCE #2049
      * JTG 030709 NEW INTEREST REFUND FORMULA (0 9) STATE OF TEXAS BASED
      *            ON DAILY INTEREST USING 365 DAYS AND SIMPLE      EXCEL #2111
      * JTG 030728 NEW INSURANCE REFUND 2ND FORMULAS:
      *            (0 A) MEAN OF PRORATA & RULE 78 (WORLD "NM", A&H)
      *            (0 B) RULE 78 FOR NET + 1  (WORLD "AL", LIFE)   WORLD #326
      * BAH 031001 ADDED 2 NEW INSURANCE CHARGEABLE CODES(SP-INSCHGABL) FOR
      *            SIGNAL(WISC), SP-INS-AMTFIN-2PMTS, SP-INS-AMTFIN-1PMTS
      *            AMTFIN-2PMTS = "2" AND AMTFIN-1PMT = "1", PR# 2157
      * BAH 040304 ADDED SP-DEFAULT-O2-INS-COMP FOR LENDMARK PR# 2258
      * BAH 040331 ADDED SP-LC-ON-JUDGEMENTS FOR RIVERSIDE PR# 2272
      *            STATE LAW SAYS NO LATE CHARGES ON JUDGEMENT ACCOUNTS
      * JTG 040501 ADDED LOGIC TO CAUSE THE UNEARNED LOAN COST TO ROLL TO
      *            THE NEW LOAN AFTER 'RENEWAL'. NOTE: THIS COST IS REFLECTIVE
      *            OF THE DISCOUNT WHEN PURCHASING LOAN PAPER NOT CARRIED AS
      *            SALES PAPER WITH DEALER DISCOUNT.
      *            ADDED SP-LNCOST-FRMLA = 'R'                    REGENCY #2287
      * BAH 040526 ADDED SP-RBSPOPT1 = 20, ACTUARIAL OREGON, DOLLAR PR# 2306`
      * JTG 040608 ADDED NEW SP-RBFRMLA (0 C) SHORT RATE FORMULA   MULLEN #2302
      * JTG 040811 ADDED SP-DELQ-IB-AGE AND SP-DELQ-IB-MAX-DAYS  LENDMARK #2344
      * JTG 040917 ADDED NEW FIELDS FOR SP-RBFRMLA (0 D)
      *            RULE 78THS USING DAYS IN TERM AND ELAPSED DAYS INSTEAD
      *            OF UNIT PERIODS IN TERM AND ELAPSE UNIT PERIODS
      *            ADDED AERN-LN-INSEFF & AERN-LN-INSEXP
      *            ALSO ADDED SP-RBSPOPT2 = 11 NEW ROUNDING OPTION TO
      *            TAKE COMPUTED REBATE AND ROUNDED UP OR DOWN TO
      *            WHOLE DOLLARS                                   REGACC #0074
      * JTG 041026 ADDED RATECD SP-AL-NETPAY-PLUS1       VALUE 21  WORLD  #J050
      * JTG 041102 ADDED ALAMAMA REFUND FRMLA ACTUARIAL (0 E)      WORLD  #J050
      * JTG 050324 ADDED RATECD SP-IN-NET-PACE           VALUE 22  PACE   #2469
      *  CS 050325 ADD SP-INSURANCE-WRITTEN (IF "N", INPUT TO ALL INSURANCES
      *            INCLUDING O2, O3 ARE BLOCKED). LENDMARK PR#2479
      * JTG 050401 REMOVED RATECD SP-IN-NET-PACE       REMOVED 22  PACE   #2469
      * BAH 050405 ADDED SP-RBSPOPT1 = 22, SUN "LA" PR# 2504
      * JTG 050418 NEW REFUND FORMULA '0 F' TRUE DAILY PRORATA REFUND FORMULA
      *            FOR STATE OF COLORADO                            WORLD #0401
      *  CS 050518 NEW VALUE FOR SP-EXPR-FRMLA OF 'C', PER JUDY ALWAYS USE
      *            EXPIRED RATES PR#484 (SP-EXPR-FRMLA-EXPRLA). PER JUDY
      *            WHEN LOAN IS EXPIRED CHARGE LESSER OF SIMPLE/EXPIRED RATE
      * JTG 050519 ADDED NEW FORMULAS FOR MEXICO
      *            SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  CS 050520 ADDED NEW SP-RBFRMLA2 "H" FOR REGIONAL. WORKS THE SAME AS
      *     0 9 EXCEPT.. IT USES THE SPLIT RATE TABLE TO ACCESS INTEREST
      *     INSTEAD OF THE SIMPLE RATE [REGIONAL MGMT] [PR#2527]
      * JTG 050718 ADDED RATECD SP-IN-NET-PACE           VALUE 22  PACE   #2469
      * BAH 050830 ADDED NEW SCFRMLA 47, EXACTLY LIKE 46 BUT INCLUDE "FB"
      *            BAY COUNTRY PR# 2582
      *  CS 060203 ADD SP-RBSPOPT1 23 DONT ROUND REBATE TO WHOLE DOLLARS #2670
      *                                                          PEOPLE
      * BAH 060214 ADDED SP-INTERIM-COUPON TO REQUEST INTERIM COUPONS AT
      *            SALES FINANCE INPUT, ACC PR# 2704
      *  CS 060215 ADD SP-RBSPOPT1 24 TO USE TIM360 INSTEAD OF 365 [PR#2680
      *                                                            PEOPLE]
      * JTG 060612 CHANGED LOGIC FOR SINGLE PAYS LOANS > 11 MONTHS
      *            TO YIELD REMAINING DAYS FROM UPER-INTDATE PLUS
      *            FULL UNIT PERIODS TO UPER-1STPYDATE
      *            ADDED NEW LOAN CALCULATION FOR RICHARD        LENDMARK #2709
      * MJD 060823 ADDED NEW IN CHARGEABLE CODE "D"  THIS WILL CAUSE
      *            COVERAGE AND PREMIUM TO BE CALCULATED BASED ON THE MAX
      *            TERM OF THE INSURANCE                       PACESETTER #2771
      * JTG 061205 ADDED SP-SCFRMLA = 48,(POINTS)FOR TN REAL ESTATE LOANS
      *            REGENCY  #2880
      * MJD 061207 ADDED SP-RBSPOPT1 = 25 OHIO PREPAY PENALTY, REGENCY #2878
      *  CS 070227 ADDED SP-AUTO-ASSESS-LCHG REGIONAL PR#152-R
      *  CS 070330 ADDED SP-LNCOST-FRMLA 'M' MANUALLY ENTERED AT DIRECT LOAN
      *            INPUT TIME PR#2942 COLTN
      *  CS 070703 NEW SP-DFFRMLA 96 INTEREST BEARING 2% OF BALANCE MULLEN
      *                                                             PR#2477
      * BAH 070726 NEW SP-SCFRMLA 49 FOR REGMGM, SAME AS 29 EXCEPT CLASSES
      *            CAN BE DIFFERENT ON THE RESTRICTION,, PR# 3017
      * BAH 070814 ADDED SP-RBSPOPT1 = 26 TO USE APR INSTEAD OF SMPRATE
      *            ONLY IN RBFRMLA 'Q', LENDMARK PR# 3026
      * JTG 071030 NEW INSURANCE REFUND FORMULA (0 I) FOR CPI POLICYS
      *            WHICH ARE ALWAYS 1 (ONE) YEAR TERMS          CITIZENS #3097
      * BAH 071127 ADDED SP-MAX-CASH-PROCEEDS FOR REGMGM PR# 3110
      * MJD 080206 ADDED INS REB FRMLA 2 VALID = "J" FOR NM   WORLD #563
      * BAH 080910 ADDED INS REB FRMLA 2  "K" FOR MULLEN PR#3250
      * BAH 081118 ADDED IB DEFFRMLA 95 FOR HAMPMTON PR# 3280
      * MJD 090406 ADDED SP-ALLOW-ZERO-PROC FLAG TO ALLOW FOR
      *            ENTRY OF A ZERO PROCEEDS LOAN                    REGMGM #3341
      * MJD 090424 ADDED SP-BANKRULE-PCT                 (BARNETT)  71284 #3189
      *            ADDED SP-BANKRULE "E"                 (BARNETT)  71284 #3189
      * BAH 090522 ADDED SP-AUTO-SEND-TABLE OCCURS 2 TIMES TO ADD ONTO THE REPO
      *            TRCD TABLE OF 3, REGACC PR# 245
      * BAH 090624 ADDED SP-INSEXCEPT 15, ITS 2 AND 13 COMBINED SO ADDED 15 TO
      *            SP-EXTEND-INSURANCE AND SP-CL-AH-MAXIMUMS, REGWAN PR# 3383
      *  CS 090729 ADD SP-DLDISC-CONV-BF-PCNT, THIS WILL BE USED BY WORLD AT
      *            CONVERSION BF LINE TO COMPUTE A DISCOUNT PR#648
      * BAH 090821 ADDED SP-INSCHGABLE "E" FOR REGMGM PR# 3437
      * BAH 100301 ADDED SP-INSRATECD 23 FOR REGMGM PR# 3553
      *  CS 100304 ADDED SP-RBFRMLA2 'L' FOR UNITED PR#3548
      * MJD 100311 ADDED SP-INSRATECD(24) FOR REGMGM ALABAMA      (71226) #3455
      * BAH 040415 ADDED SP-RBSPOPT2 = 12, FULL REFUND WITHIN 3 DAYS,
      *                                                       REGMGM PR #3570
      *  CS 100624 ADDED SP-UNITPER-INFO  WORLD(MEXICO) PR# 692
      * BAH 100810 ADDED SP-RBEARLY = 25, REGMGM PR# 3614
      * BAH 100908 ADDED SP-RBFRMLA2 'M' FOR WORLD TX ANTICAPTED PR# 711
      * BAH 101229 ADDED SP-SCFRMLA '50' FOR WORLD IL  PR# 731
      *  CS 110106 ADDED SP-RBEARLY = 26, THIS IS THE SAME AS SP-RBEARLY =21
      *            EXCEPT THAT THERE IS NO REFUND IF NOT A "PO" . ONLY VALID
      *            FOR SERVICE CHARGE WORLD PR#733
      * BAH 110117 ADDED SP-RENEWAL-EDIT FOR WORLD TO STOP RENEWALS WITHIN
      *            75 DAYS AND ALSO 'PO' CAN NOT BE REMADE SAME DAY PR# 734
      * MJD 110126 ADDED SP-LCFRMLA = 'S'.  SAME AS "F" BUT DOES NOT CHARGE
      *            LATE CHAGE ON THE LAST PAYMENT                   WORLD #0723
      * BAH 110307 ADDED SP-RBCOMCD "C" THAT ALLOWS A COMBINED MINIMUM
      *            OF $5, REGENCY PR# 3743
      *  CS 110407 ADD SP-LNCOST-FRMLA '4' DOES THE FLAT RATE 'F' (AMOUNT IN
      *            LOAN COST %, AND TAKES PARTICIPATION PAID & UPDATES
      *            TO LN-ANTICERN(3)  REGMGMT PR#3765
      * BAH 110601 ADDED SP-SCFRMLA 52 AND 53 FOR MULLEN PR# 3799
      * MJD 110516 ADDED SP-BANKRULE = "F"                          WORLD #0752
      * MJD 110614 ADDED SP-ROUND-MFEE.  THIS IS USED FOR NON-CAN MX LOANS
      *            USING MFFRMLA 05.  THE VAT CHARGE CAN CAUSE THE CALCULATOR
      *            TO GO OUT OF BALANCE IF IT IS NOT DIVISIBLE BY THE TERM.
      *            THE CALCULATOR HAS BEEN MODIFIED TO REOUND UP BY ENOUGH
      *            PENNIES TO MAKE IT EVENLY DIVISIBLE.
      *                                                  ADDENDUM TO WORLD 692
      *  CS 110823 ADD SP-TRWBANKRULE 'F' SP-BANKRULE 'F' WORLD PR#752
      *  CS 110907 ADD SP-RBEARLY 98 REGIONAL MGT   PR#3865
      * BAH 111031 ADD SP-RBSPOPT2 = 13 FOR COLTN, PR# 3900
      * MJD 111201 ADDED SP-ADV-TO-1ST-NO-CORR.  THIS OPTION NEEDS TO BE
      *            ABLE TO BE CONTROLLED VIA SPR SO IT CAN VARY BY CLASS PR#3907
      * MJD 120126 ADDED SP-RBFRMLA2 = "N"                          CFSC PR#3795
      *            THIS IS A NEW RULE OF ANTICIPATION FOR CREDIT LIFE.
      * MJD 120321 ADDED SP-OPT-CAL-PRO-INS-SC-NO-03.  THIS WILL WORK LIKE "B"
      *            BUT WILL EXCLUDE OTHER 3 (O3) FROM THE CALCULATION.
      * MJD 120502 ADDED SP-RBFRMLA2 = "O".  TX RULE OF ANTICIPATION FOR LIFE.
      *            GROSS LIFE, SINGLE PREMIUM PER $100/YEAR WITH DISCOUNT.
      *                                                              71226 #3938
      *  CS 120717 ADD SP-LC-INT-ON-REPO-NON-PL PR#314 REGACC, DONT ASSESS OR
      *            COLLECT LC/INT ON SX OR SS ACCOUNTS.
      *  CS 121005 ADD SP-CONTRACTUAL-SET-NONACCRUAL,SP-CONTRACTUAL-RESET-ACC
      *           RUAL, SP-MONTH-PAY-NAPP-COUNTER, THESE ARE INTERNAL REPORTING
      *           REQUIRMENT FOR THIS CUSTOMER AND HAVE NOT IMPACT ON
      *           THE ACCRUAL PROCESS #323 REGACC.
      * BAH 121009 ADDED SP-INSREJECT-FG "D" FOR MULLEN PR# 4088
      *            REJECT A&H IF WORK-HRS < 30
      *  CS 121116 ADD  SP-ERNDELQFRMLA 'R' ADJUST EARNINGS TO CASH
      *                                                 WORLD PR#829
      * MJD 130102 ADDED SP-INSRATECD-25.   SIMILAR TO RATECD 24 BUT WILL
      *            WORK WITH EXTENDED FIRST PAYMENTS.               REGMGM #4185
      * BAH 130115 ADDED SP-RBSPOPT1 27 FOR "CA" (MULLEN, COSMO) MULLEN PR# 4182
      * BAH 130426 ADDED SP-INSREJECT-FG "E" FOR CASHCO PR# 4261
      * BAH 130501 ADDED SP-SHORT-PAY-THRESHOLD FOR NEWPORT, PR# 4256
      * MJD 120530 ADDED 54 TO SCFRMLA-VALID                         WORLD #0874
      * MJD 130802 ADDED RBEARLY = 27 (ONLY WORKS WITH SCFRMLA 54)   WORLD #0911
      * BAH 130814 ADDED SCFMLA 55 "IN" WORLD, CROSS BETWEEN 23 & 32 WORLD #918
      * BAH 130912 ADDED SP-RBFRMLA2 = "P".  "IN" DECREASING LIFE, CFSC PR# 4367
      * BAH 130916 ADDED SP-RENEWAL-EDIT "B" AND "C" FOR WORLD, PR# 923
      *  CS 130919 ADD SP-ERNFRMLA 65 WORLD ONLY, USES FORMULA 52 BUT SETS THE
      *            DATE USED FOR THE ACCRUAL BASED ON FULL/PARTIAL PAYMENTS
      *                                                WROLD PR#930
      * BAH 131017 ADDED SP-DEFPOLCD "C" HONOR PR# 4382
      *
      * KEC 131107 {PR#00345} REGIONAL ACCEPTANCE <A15> [K.MULLEN]
      *            ADD SP-LNCOST-FRMLA '5' DOES THE FLAT RATE 'F'
      *            (AMOUNT IN LOAN COST %, AND TAKES PARTICIPATION PAID
      *            & UPDATES TO LN-ANTICERN(4)
      * BAH 131125 ADDED SP-CASH-AVAIL-PERCENT FOR WORLD PR# 944
      * BAH 131213 ADDED SP-SCFRMLA 56 FOR WORLD TX PR# 953
      * MJD 140128  ADDED SP-RBSPOPT1 = 28                           WORLD #0954
      * CS  140505 ADDED SP-O1-JOINT-FG  SUPPORT PR#4537
      * MJD 140723 ADDED SP-ADDON-RATE-FG = "A"           MULLEN/KSTREET PR#4556
      * BAH 150508 ADDED SP-SCFRMLA 57 FOR NSA PR# 4747
      * MJD 150512 ADDED SP-DEFBASE = 11                           REGENCY #4753
      *
      * BAH 151103 ADDED SP-NET-BAL-REQ AND SP-AMT-PROCEEDS-REQ, AND NEW
      *            SP-RENEWAL-EDIT "D" AND "E"  TO USE THESE NEW FIELDS REGMGM
      *                                                        REGMGM PR#4885
      * KEC 151117 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *            SP-REC & SP-SIZE = %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      *            ADDED SP-LTOUCH-DATE
      *            DATES CHANGED TO CCYYMMDD --- PIC 9(08) COMP-3.
      *            CHANGED COMP-6 TO BE COMP-3
      *  CS  160225 ADDED SP-ALT-PREPAY-MONTHS WHICH IS THE NUMBER OF MONTHS
      *             PAID AHEAD MINIMUM THAT FORCES A REBATE OF INTEREST,
      *             USED IN ALABAMA   WORLD PR#1140
      * BAH 160427 ADDED SP-SCFRMLA 58 FOR WORLD TX, NO SERCHG IF BORROWER HAD
      *            PREVIOUS SERCHG WITHIN 1 YR IN SAME STATE AND CLASS PR#1154
      * MJD 160511 ADDED SP-RBDTE = "D"                             71105#0918
      *  CS 160714 CHANGED CLASS 9(3)
      *            SP-ERNPERTBL FROM OCCURS 6 TO  OCCURS 10.
      *            SP-EARN-ORDER OCCURS FROM 6 TO 10.                  
      *            SP-INSTBL OCCURS FROM 12 TO 14.               
      *            SP-REBTBL OCCURS FROM 16 TO 22.
      *            SP-REVOL-APPLY-ORDER-TBL FROM 15 TO 21 CURS 21
      *            SP-REVOL-APPLY-ORDER             PIC 99.
      *            88  SP-REVOL-APPLY-ORDER-VALID       VALUE 1 -  12.
      *            88  SP-REVOL-APPLY-ORDER-NEW         VALUE 16 - 21.
      *            SP-SPRCLASS FROM 2 TO 3
      *            SP-EXPR-BREAK FROM 9(6) TO 9(7)
      *            SP-ACC-BREAK FROM 9(6) TO 9(7)                      
      *            SP-ERNAMT (UPFRONT) FROM 9(5) TO 9(7)          
      *            SP-MFMAX FROM 9(4) TO 9(5)                        
      *            SP-INSMAXCHGABL FROM 9(6) TO 9(7)
      *            SP-INSMAXBENIF FROM 9(6) TO 9(7)                     
      *            SP-INSMAXCOV  FROM 9(6) TO 9(7)                    
      *            SP-REVOL-PYMT-MINIMUM FROM 9(4) TO 9(7)                   
      *            SP-REVOL-PYMT-MAXIMUM FROM 9(4) TO 9(7)                  
      *            SP-REVOL-MEMBERSHIP-FEE FROM 9(4) TO 9(7)                 
      *            SP-LCGRACE REMOVED COMP                         
      *            SP-LNCOST-AMT FROM 9(5) TO 9(7) 
      *            SP-EDT-AMT FROM 9(6)V99 TO 9(7)V99                
      *            SP-LCFRMLA FROM PIC X TO PIC X(2)     
      *            SP-LCTYPE FROM PIC X TO PIC X(2).    
      *            SP-INS-FILLER FROM 5 TO 15                   
      *            SP-RB-FILLER FROM X(5) TO X(10)                
      *            SP-INSCHGABL FROM PIC X TO PIC X(2)         
      *            SP-RBFRMLA FROM PIC X TO PIC X(2)            
      *            SP-RBFRMLA2  FROM PIC X TO PIC X(2)   
      *            NEW   SP-INSEARN-ORDER   PIC 9(2) OCCURS 14.
      *            CHANGED COMP TO COMP-3
      *            ADD 500 FILLER
      *            SP-SIZE = 8050
      * BAH 161010 ADDED SP-PERCENT-REGPAY-AVAIL FOR WORLD PR# 1194
      * MJD 161213 ADDED DEFERMENT FORMULA 10 (71225 PR#384)
      * MJD 170330 ADDED SP-ALT-DEFFRMLA, SP-ALT-DEFMIN, SP-ALT-DEFMAX
      *            USED IN WI/COLAS2, USE FX/FIXSP8 TO SET INITIAL.
      *            NOTE THESE ARE NOT USED FOR ANY CALCULATIONS WITHIN LOAN
      *            PROCESSING                                          71225#386
      * BAH 170516 ADDED SP-EDT-AMTYPE "R" TOTAL REPAY FOR REGMGM PR#5291
      * BAH 171204 SP-NON-LOAN-FLAG AND SP-SKIP-TRW FOR TAX LOANS, WORLD PR#1288
      * BAH 190213 SPLIT INTO 3 FILES
      *            REMOVED SP-ANTICIATED, REMOVED ALL REVOLVING FIELDS
      *            CHANGED INSVERTBL TO OCCUR 5 INSTEAD OF 14 (IVER)
      *            CHANGED INSTBL    TO OCCUR 12 INSTEAD OF 14 (ILEV)
      *            CHANGED SPC-INSEARN-ORDER TO 12 FROM 14 TO MATCH INSTBL
      * KEC 190219 A32 FFR - REMOVED REDEFINE FOR SP-LC-CODEX; UNUSED
      *  CS 190508 LP01SPC, REPLACED ENDING FILLER WITH FUTURE FIELDS
      *  CS 190509 SIZE 5096 WAS 5500
      * BAH 2019.0529 ADDED SP-SCFRMLA 59, KY HB225, WORLD #1374
      * BAH 2020.0128 ADDED SP-RBEARLY 28, IL, WORLD #1417
      * AMM 2021.0427 REMOVED FUTURE FIELDS, RESIZED FILE
      * BAH 2021.0615 ADDED SP-SCFRMLA 60 & 61, TN, WORLD #1500
      * BAH 2021.0617 ADDED SP-RBEARLY 97, TN, WORLD #1500
      * BAH 2021.0813 ADDED SP-INSREJECT-FG "F" #1510
      * BAH 2023.0301 SP-INS-O1-EDIT ADDED "I" IUI AND "C" CPI/AUTO, #1594
      * BAH 2023.0328 SP-LCFRMLA "T", SAME AS "S" BUT TOTAL MONEY "WI" #1597
      * BAH 2023.0608 ADDED SP-SCFRMLA 62, TN, WORLD #1608
      * BAH 2024.1008 ADDED SP-SCFRMLA 63, WI, #1682
      ******************************************************************
       78  SP-SIZE                            VALUE 6500.
       01  SP-REC.
           03  SP1-KEY.
               05  SP-ORGST                   PIC XX.
               05  SP-SPRCLASS                PIC 999.
               05  SP-SUBCLASS                PIC 99.
               05  SP-LAWCODE                 PIC 99.

      * FIELDS ARE ALSO CALLED SPA-EXPR, ONLY WANT TO CHANGE INDEX
      * SIZE= 1225
       COPY "LIBLP/LP01SPA_AREA.CPY" REPLACING LEADING "SPA-" BY "SP-"
                                     LEADING "AEXPR" BY "EXPR"
                                     LEADING "AASTP" BY "ASTP"
                                     LEADING "ACTBL" BY "CTBL"
                                     LEADING "ACSTP" BY "CSTP"
                                     LEADING "AETBL" BY "ETBL"
                                     LEADING "AESTP" BY "ESTP".
      * SIZE=2724
       COPY "LIBLP/LP01SPB_AREA.CPY" REPLACING LEADING "SPB-" BY "SP-"
                                        LEADING "BILEV" BY "ILEV"
                                        LEADING "BISTP" BY "ISTP"
                                        LEADING "BIVER" BY "IVER".
      * SIZE=2542
       COPY "LIBLP/LP01SPC_AREA.CPY" REPLACING LEADING "SPC-" BY "SP-".

      *================================================================*
      * END COPYBOOK: LIBLP\LP01SP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01SPA.CPY                           *
      *================================================================*
       01  SPA-REC.
           03  SPA1-KEY.
               05  SPA-ORGST                   PIC XX.
               05  SPA-SPRCLASS                PIC 999.
               05  SPA-SUBCLASS                PIC 99.
               05  SPA-LAWCODE                 PIC 99.

       COPY "LIBLP/LP01SPA_AREA.CPY".
      *================================================================*
      * END COPYBOOK: LIBLP\LP01SPA.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01SPB.CPY                           *
      *================================================================*
       01  SPB-REC.
           03  SPB1-KEY.
               05  SPB-ORGST                   PIC XX.
               05  SPB-SPRCLASS                PIC 999.
               05  SPB-SUBCLASS                PIC 99.
               05  SPB-LAWCODE                 PIC 99.

       COPY "LIBLP/LP01SPB_AREA.CPY".
      *================================================================*
      * END COPYBOOK: LIBLP\LP01SPB.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01SPC.CPY                           *
      *================================================================*
       01  SPC-REC.
           03  SPC1-KEY.
               05  SPC-ORGST                   PIC XX.
               05  SPC-SPRCLASS                PIC 999.
               05  SPC-SUBCLASS                PIC 99.
               05  SPC-LAWCODE                 PIC 99.

       COPY "LIBLP/LP01SPC_AREA.CPY".
      *================================================================*
      * END COPYBOOK: LIBLP\LP01SPC.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01SP_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01SP_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - STATE PARAMETER FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0503 ***NEW***
      * JKC 2022-0427 ADDED '01 QSP-REC' AND MOVED ALL OF QSPA|B|C-REC
      *               UNDER IT.  DID THIS AS PART OF THE USE OF 'JOIN'
      *               USAGE IN THE IO (READ/READ-NEXT).
      *
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  SPA1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  SPA1-CURSOR-STAT-GOOD             VALUE "00".
           88  SPA1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  SPA1-CURSOR-GR-STAT          PIC X(2) VALUE SPACES.
           88  SPA1-CURSOR-GR-STAT-GOOD          VALUE "00".
           88  SPA1-CURSOR-GR-STAT-BAD           VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  SPA1-CURSOR-NG-STAT          PIC X(2) VALUE SPACES.
           88  SPA1-CURSOR-NG-STAT-GOOD          VALUE "00".
           88  SPA1-CURSOR-NG-STAT-BAD           VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  SPB1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  SPB1-CURSOR-STAT-GOOD             VALUE "00".
           88  SPB1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  SPC1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  SPC1-CURSOR-STAT-GOOD             VALUE "00".
           88  SPC1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  SP1-RETURN-CODE                 PIC S9(4)   COMP-5.

       01  QSP1-WHERE-BEG-KEY.
           03  QSP1-WBEG-ORGST             PIC XX.
           03  QSP1-WBEG-SPRCLASS          PIC 999.
           03  QSP1-WBEG-SUBCLASS          PIC 99.
           03  QSP1-WBEG-LAWCODE           PIC 99.
 
       01  QSP1-WHERE-END-KEY.
           03  QSP1-WEND-ORGST             PIC XX.
           03  QSP1-WEND-SPRCLASS          PIC 999.
           03  QSP1-WEND-SUBCLASS          PIC 99.
           03  QSP1-WEND-LAWCODE           PIC 99.

       01  QSP-REC.
           03  QSPA-REC.
               05  QSPA-ORGST                         PIC XX.
               05  QSPA-SPRCLASS                      PIC 999.
               05  QSPA-SUBCLASS                      PIC 99.
               05  QSPA-LAWCODE                       PIC 99.
               05  QSPA-LTOUCH-DATE                   PIC X(10).
               05  QSPA-DESC                          PIC X(15).
               05  QSPA-NOTES                         PIC X(60).
               05  QSPA-EFFDATE                       PIC X(10).
               05  QSPA-EXPDATE                       PIC X(10).
               05  QSPA-EXPD-MONTHS                   PIC 99.
               05  QSPA-EXPD-DAYS                     PIC 99.
               05  QSPA-EXPD-FRMLA                    PIC X.
               05  QSPA-EXPD-EXCEPT                   PIC X.
               05  QSPA-EXPR-FRMLA                    PIC X.
               05  QSPA-EXPR-REDU-FRMLA               PIC X.
               05  QSPA-EXPR-RATE-1                   PIC 999V999.
               05  QSPA-EXPR-BREAK-1                  PIC 9(7)V99.
               05  QSPA-EXPR-YRTYPE-1                 PIC 9(4).
               05  QSPA-EXPR-INTMETH-1                PIC X.
               05  QSPA-EXPR-RATE-2                   PIC 999V999.
               05  QSPA-EXPR-BREAK-2                  PIC 9(7)V99.
               05  QSPA-EXPR-YRTYPE-2                 PIC 9(4).
               05  QSPA-EXPR-INTMETH-2                PIC X.
               05  QSPA-EXPR-RATE-3                   PIC 999V999.
               05  QSPA-EXPR-BREAK-3                  PIC 9(7)V99.
               05  QSPA-EXPR-YRTYPE-3                 PIC 9(4).
               05  QSPA-EXPR-INTMETH-3                PIC X.
               05  QSPA-EXPR-RATE-4                   PIC 999V999.
               05  QSPA-EXPR-BREAK-4                  PIC 9(7)V99.
               05  QSPA-EXPR-YRTYPE-4                 PIC 9(4).
               05  QSPA-EXPR-INTMETH-4                PIC X.
               05  QSPA-EXPR-RATE-5                   PIC 999V999.
               05  QSPA-EXPR-BREAK-5                  PIC 9(7)V99.
               05  QSPA-EXPR-YRTYPE-5                 PIC 9(4).
               05  QSPA-EXPR-INTMETH-5                PIC X.
               05  QSPA-EXPR-LCHG                     PIC X.
               05  QSPA-JUDGFRMLA                     PIC X.
               05  QSPA-JUDGRATE                      PIC 999V999.
               05  QSPA-JUDGYRTYPE                    PIC 9(4).
               05  QSPA-JUDGINTMETH                   PIC X.
               05  QSPA-ACC-FRMLA                     PIC X.
               05  QSPA-ACC-YRTYPE                    PIC 9(4).
               05  QSPA-ACC-INTMETH                   PIC X.
               05  QSPA-ACC-RATE-1                    PIC 999V999.
               05  QSPA-ACC-BREAK-1                   PIC 9(7)V99.
               05  QSPA-ACC-RATE-2                    PIC 999V999.
               05  QSPA-ACC-BREAK-2                   PIC 9(7)V99.
               05  QSPA-ACC-RATE-3                    PIC 999V999.
               05  QSPA-ACC-BREAK-3                   PIC 9(7)V99.
               05  QSPA-ACC-RATE-4                    PIC 999V999.
               05  QSPA-ACC-BREAK-4                   PIC 9(7)V99.
               05  QSPA-ACC-RATE-5                    PIC 999V999.
               05  QSPA-ACC-BREAK-5                   PIC 9(7)V99.
               05  QSPA-1098FRMLA                     PIC X.
               05  QSPA-DISFRMLA                      PIC X.
               05  QSPA-CONTRFRMLA                    PIC X.
               05  QSPA-BANKRULE                      PIC X.
               05  QSPA-CONTPDTH                      PIC 9(4).
               05  QSPA-FINCHG                        PIC 99.
               05  QSPA-BANKUNITPER-CD                PIC X.
               05  QSPA-TRWBANKRULE                   PIC X.
               05  QSPA-TRWCONTPDTH                   PIC 9(4).
               05  QSPA-TRWBANKUNITPER-CD             PIC X.
               05  QSPA-RECFRMLA                      PIC X.
               05  QSPA-RECPAYCD                      PIC X.
               05  QSPA-RECPDTH                       PIC 9(3).
               05  QSPA-DISFRMLA-SPAY-FG              PIC X.
               05  QSPA-ERNFRMLA-1                    PIC 99.
               05  QSPA-ERNAMT-1                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-1                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-1                    PIC X.
               05  QSPA-ERNACCRL-FG-1                 PIC X.
               05  QSPA-ERNACCRL-START-CD-1           PIC X.
               05  QSPA-ERNACCRL-DFCD-1               PIC X.
               05  QSPA-ERN-DAYS-1                    PIC 99.
               05  QSPA-ERN-TERM-1                    PIC 999.
               05  QSPA-ERN-TYPE-1                    PIC X.
               05  QSPA-ERNFRMLA-2                    PIC 99.
               05  QSPA-ERNAMT-2                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-2                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-2                    PIC X.
               05  QSPA-ERNACCRL-FG-2                 PIC X.
               05  QSPA-ERNACCRL-START-CD-2           PIC X.
               05  QSPA-ERNACCRL-DFCD-2               PIC X.
               05  QSPA-ERN-DAYS-2                    PIC 99.
               05  QSPA-ERN-TERM-2                    PIC 999.
               05  QSPA-ERN-TYPE-2                    PIC X.
               05  QSPA-ERNFRMLA-3                    PIC 99.
               05  QSPA-ERNAMT-3                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-3                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-3                    PIC X.
               05  QSPA-ERNACCRL-FG-3                 PIC X.
               05  QSPA-ERNACCRL-START-CD-3           PIC X.
               05  QSPA-ERNACCRL-DFCD-3               PIC X.
               05  QSPA-ERN-DAYS-3                    PIC 99.
               05  QSPA-ERN-TERM-3                    PIC 999.
               05  QSPA-ERN-TYPE-3                    PIC X.
               05  QSPA-ERNFRMLA-4                    PIC 99.
               05  QSPA-ERNAMT-4                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-4                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-4                    PIC X.
               05  QSPA-ERNACCRL-FG-4                 PIC X.
               05  QSPA-ERNACCRL-START-CD-4           PIC X.
               05  QSPA-ERNACCRL-DFCD-4               PIC X.
               05  QSPA-ERN-DAYS-4                    PIC 99.
               05  QSPA-ERN-TERM-4                    PIC 999.
               05  QSPA-ERN-TYPE-4                    PIC X.
               05  QSPA-ERNFRMLA-5                    PIC 99.
               05  QSPA-ERNAMT-5                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-5                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-5                    PIC X.
               05  QSPA-ERNACCRL-FG-5                 PIC X.
               05  QSPA-ERNACCRL-START-CD-5           PIC X.
               05  QSPA-ERNACCRL-DFCD-5               PIC X.
               05  QSPA-ERN-DAYS-5                    PIC 99.
               05  QSPA-ERN-TERM-5                    PIC 999.
               05  QSPA-ERN-TYPE-5                    PIC X.
               05  QSPA-ERNFRMLA-6                    PIC 99.
               05  QSPA-ERNAMT-6                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-6                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-6                    PIC X.
               05  QSPA-ERNACCRL-FG-6                 PIC X.
               05  QSPA-ERNACCRL-START-CD-6           PIC X.
               05  QSPA-ERNACCRL-DFCD-6               PIC X.
               05  QSPA-ERN-DAYS-6                    PIC 99.
               05  QSPA-ERN-TERM-6                    PIC 999.
               05  QSPA-ERN-TYPE-6                    PIC X.
               05  QSPA-ERNFRMLA-7                    PIC 99.
               05  QSPA-ERNAMT-7                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-7                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-7                    PIC X.
               05  QSPA-ERNACCRL-FG-7                 PIC X.
               05  QSPA-ERNACCRL-START-CD-7           PIC X.
               05  QSPA-ERNACCRL-DFCD-7               PIC X.
               05  QSPA-ERN-DAYS-7                    PIC 99.
               05  QSPA-ERN-TERM-7                    PIC 999.
               05  QSPA-ERN-TYPE-7                    PIC X.
               05  QSPA-ERNFRMLA-8                    PIC 99.
               05  QSPA-ERNAMT-8                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-8                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-8                    PIC X.
               05  QSPA-ERNACCRL-FG-8                 PIC X.
               05  QSPA-ERNACCRL-START-CD-8           PIC X.
               05  QSPA-ERNACCRL-DFCD-8               PIC X.
               05  QSPA-ERN-DAYS-8                    PIC 99.
               05  QSPA-ERN-TERM-8                    PIC 999.
               05  QSPA-ERN-TYPE-8                    PIC X.
               05  QSPA-ERNFRMLA-9                    PIC 99.
               05  QSPA-ERNAMT-9                      PIC 9(7)V99.
               05  QSPA-ERNPERCT-9                    PIC 9(3)V99.
               05  QSPA-ERNPERCD-9                    PIC X.
               05  QSPA-ERNACCRL-FG-9                 PIC X.
               05  QSPA-ERNACCRL-START-CD-9           PIC X.
               05  QSPA-ERNACCRL-DFCD-9               PIC X.
               05  QSPA-ERN-DAYS-9                    PIC 99.
               05  QSPA-ERN-TERM-9                    PIC 999.
               05  QSPA-ERN-TYPE-9                    PIC X.
               05  QSPA-ERNFRMLA-10                   PIC 99.
               05  QSPA-ERNAMT-10                     PIC 9(7)V99.
               05  QSPA-ERNPERCT-10                   PIC 9(3)V99.
               05  QSPA-ERNPERCD-10                   PIC X.
               05  QSPA-ERNACCRL-FG-10                PIC X.
               05  QSPA-ERNACCRL-START-CD-10          PIC X.
               05  QSPA-ERNACCRL-DFCD-10              PIC X.
               05  QSPA-ERN-DAYS-10                   PIC 99.
               05  QSPA-ERN-TERM-10                   PIC 999.
               05  QSPA-ERN-TYPE-10                   PIC X.
               05  QSPA-ERNACCEL-CD                   PIC X.
               05  QSPA-ERNJD-CD                      PIC X.
               05  QSPA-MIDSTRERNCD                   PIC X.
               05  QSPA-EARN-ORDER-1                  PIC 99.
               05  QSPA-EARN-ORDER-2                  PIC 99.
               05  QSPA-EARN-ORDER-3                  PIC 99.
               05  QSPA-EARN-ORDER-4                  PIC 99.
               05  QSPA-EARN-ORDER-5                  PIC 99.
               05  QSPA-EARN-ORDER-6                  PIC 99.
               05  QSPA-EARN-ORDER-7                  PIC 99.
               05  QSPA-EARN-ORDER-8                  PIC 99.
               05  QSPA-EARN-ORDER-9                  PIC 99.
               05  QSPA-EARN-ORDER-10                 PIC 99.
               05  QSPA-ERNDELQFRMLA                  PIC X.
               05  QSPA-ERNDELQ-START                 PIC 999.
               05  QSPA-ERNDELQ-STOP                  PIC 999.
               05  QSPA-1098-INC-LC                   PIC X.
               05  QSPA-MAX-IB-ACR-DAYS               PIC 999.
               05  QSPA-LCGRACE                       PIC 9(2).
               05  QSPA-LCGRACECD                     PIC X.
               05  QSPA-LCTYPE                        PIC X(2).
               05  QSPA-LCRATE                        PIC 9(4)V9(4).
               05  QSPA-LCFRMLA                       PIC X(2).
               05  QSPA-LCMINCHG                      PIC 99V99.
               05  QSPA-LCMAXAMT                      PIC 9(4)V99.
               05  QSPA-LCDELFAC                      PIC 9(3).
               05  QSPA-LCYRTYPE                      PIC 9(4).
               05  QSPA-LC-CODE                       PIC 99.
               05  QSPA-LCUNITPER-CD                  PIC X.
               05  QSPA-DEFFRMLA                      PIC 99.
               05  QSPA-DEFEXCEPT                     PIC X.
               05  QSPA-DEFWORKER                     PIC 99V9999.
               05  QSPA-DEFPERCD                      PIC 99.
               05  QSPA-DEFBASE                       PIC 99.
               05  QSPA-DEFPOLCD                      PIC X.
               05  QSPA-DEFPOLMX-1                    PIC 99.
               05  QSPA-DEFPOLMX-2                    PIC 99.
               05  QSPA-DEFPOLMX-3                    PIC 99.
               05  QSPA-DEFMIN                        PIC 99V99.
               05  QSPA-DEFMAX                        PIC 9999V99.
               05  QSPA-DEFUNITPER-CD                 PIC X.
               05  QSPA-PRFORM-1                      PIC 9(4).
               05  QSPA-PRFLAG-1                      PIC X.
               05  QSPA-PRFORM-2                      PIC 9(4).
               05  QSPA-PRFLAG-2                      PIC X.
               05  QSPA-PRFORM-3                      PIC 9(4).
               05  QSPA-PRFLAG-3                      PIC X.
               05  QSPA-PRFORM-4                      PIC 9(4).
               05  QSPA-PRFLAG-4                      PIC X.
               05  QSPA-PRFORM-5                      PIC 9(4).
               05  QSPA-PRFLAG-5                      PIC X.
               05  QSPA-PRFORM-6                      PIC 9(4).
               05  QSPA-PRFLAG-6                      PIC X.
               05  QSPA-PRFORM-7                      PIC 9(4).
               05  QSPA-PRFLAG-7                      PIC X.
               05  QSPA-PRFORM-8                      PIC 9(4).
               05  QSPA-PRFLAG-8                      PIC X.
               05  QSPA-PRFORM-9                      PIC 9(4).
               05  QSPA-PRFLAG-9                      PIC X.
               05  QSPA-PRFORM-10                     PIC 9(4).
               05  QSPA-PRFLAG-10                     PIC X.
               05  QSPA-PRFORM-11                     PIC 9(4).
               05  QSPA-PRFLAG-11                     PIC X.
               05  QSPA-PRFORM-12                     PIC 9(4).
               05  QSPA-PRFLAG-12                     PIC X.
               05  QSPA-PRFORM-13                     PIC 9(4).
               05  QSPA-PRFLAG-13                     PIC X.
               05  QSPA-PRFORM-14                     PIC 9(4).
               05  QSPA-PRFLAG-14                     PIC X.
               05  QSPA-PRFORM-15                     PIC 9(4).
               05  QSPA-PRFLAG-15                     PIC X.
               05  QSPA-PRFORM-16                     PIC 9(4).
               05  QSPA-PRFLAG-16                     PIC X.
               05  QSPA-PRFORM-17                     PIC 9(4).
               05  QSPA-PRFLAG-17                     PIC X.
               05  QSPA-PRFORM-18                     PIC 9(4).
               05  QSPA-PRFLAG-18                     PIC X.
               05  QSPA-PRFORM-19                     PIC 9(4).
               05  QSPA-PRFLAG-19                     PIC X.
               05  QSPA-PRFORM-20                     PIC 9(4).
               05  QSPA-PRFLAG-20                     PIC X.
               05  QSPA-IMED-REC                      PIC X.
               05  QSPA-SCFRMLA                       PIC 99.
               05  QSPA-SCRATE                        PIC 99V99.
               05  QSPA-SCMIN                         PIC 9(4)V99.
               05  QSPA-SCMAX                         PIC 9(6)V99.
               05  QSPA-MFFRMLA                       PIC 99.
               05  QSPA-MFRATE                        PIC 99V99.
               05  QSPA-MFMIN                         PIC 9(4)V99.
               05  QSPA-MFMAX                         PIC 9(5)V99.
               05  QSPA-INTMETHOD                     PIC X.
               05  QSPA-YEARTYPE                      PIC 9(4).
               05  QSPA-PYEXFRMLA                     PIC 99.
               05  QSPA-PYEXSPCODE                    PIC 99.
               05  QSPA-PYEXYEARTP                    PIC 9(4).
               05  QSPA-PYEXFMDATE                    PIC X.
               05  QSPA-PYEXBASECD                    PIC X.
               05  QSPA-PYEXBASE                      PIC 9(4).
               05  QSPA-PYEXDAYS                      PIC 9(4).
               05  QSPA-CAL-SPFRMLA                   PIC 99.
               05  QSPA-CAL-RATETYPE-1                PIC X.
               05  QSPA-CAL-BREAKTYPE-1               PIC X.
               05  QSPA-CAL-CHGABLE-1                 PIC X.
               05  QSPA-CAL-NORATES-1                 PIC S9.
               05  QSPA-CAL-TBFRMLA-1                 PIC 99.
               05  QSPA-CAL-RATE-1-1                  PIC 999V999.
               05  QSPA-CAL-BREAK-1-1                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-1-2                  PIC 999V999.
               05  QSPA-CAL-BREAK-1-2                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-1-3                  PIC 999V999.
               05  QSPA-CAL-BREAK-1-3                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-1-4                  PIC 999V999.
               05  QSPA-CAL-BREAK-1-4                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-1-5                  PIC 999V999.
               05  QSPA-CAL-BREAK-1-5                 PIC 9(6)V99.
               05  QSPA-CAL-RATETYPE-2                PIC X.
               05  QSPA-CAL-BREAKTYPE-2               PIC X.
               05  QSPA-CAL-CHGABLE-2                 PIC X.
               05  QSPA-CAL-NORATES-2                 PIC S9.
               05  QSPA-CAL-TBFRMLA-2                 PIC 99.
               05  QSPA-CAL-RATE-2-1                  PIC 999V999.
               05  QSPA-CAL-BREAK-2-1                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-2-2                  PIC 999V999.
               05  QSPA-CAL-BREAK-2-2                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-2-3                  PIC 999V999.
               05  QSPA-CAL-BREAK-2-3                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-2-4                  PIC 999V999.
               05  QSPA-CAL-BREAK-2-4                 PIC 9(6)V99.
               05  QSPA-CAL-RATE-2-5                  PIC 999V999.
               05  QSPA-CAL-BREAK-2-5                 PIC 9(6)V99.
               05  QSPA-MINSF-FRMLA                   PIC 99.
               05  QSPA-MINSF-CHG                     PIC 9(6)V99.
               05  QSPA-MAXAPR-FRMLA                  PIC 99.
               05  QSPA-EDT-NOEDITS-1                 PIC S9.
               05  QSPA-EDT-TYPE-1-1                  PIC X.
               05  QSPA-EDT-HL-1-1                    PIC X.
               05  QSPA-EDT-COLL-1-1                  PIC XX.
               05  QSPA-EDT-CD-1-1                    PIC X.
               05  QSPA-EDT-RATE-1-1                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-1              PIC X.
               05  QSPA-EDT-AMT-1-1                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-1                PIC X.
               05  QSPA-EDT-TERM-1-1                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-1-2                  PIC X.
               05  QSPA-EDT-HL-1-2                    PIC X.
               05  QSPA-EDT-COLL-1-2                  PIC XX.
               05  QSPA-EDT-CD-1-2                    PIC X.
               05  QSPA-EDT-RATE-1-2                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-2              PIC X.
               05  QSPA-EDT-AMT-1-2                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-2                PIC X.
               05  QSPA-EDT-TERM-1-2                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-1-3                  PIC X.
               05  QSPA-EDT-HL-1-3                    PIC X.
               05  QSPA-EDT-COLL-1-3                  PIC XX.
               05  QSPA-EDT-CD-1-3                    PIC X.
               05  QSPA-EDT-RATE-1-3                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-3              PIC X.
               05  QSPA-EDT-AMT-1-3                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-3                PIC X.
               05  QSPA-EDT-TERM-1-3                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-1-4                  PIC X.
               05  QSPA-EDT-HL-1-4                    PIC X.
               05  QSPA-EDT-COLL-1-4                  PIC XX.
               05  QSPA-EDT-CD-1-4                    PIC X.
               05  QSPA-EDT-RATE-1-4                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-4              PIC X.
               05  QSPA-EDT-AMT-1-4                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-4                PIC X.
               05  QSPA-EDT-TERM-1-4                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-1-5                  PIC X.
               05  QSPA-EDT-HL-1-5                    PIC X.
               05  QSPA-EDT-COLL-1-5                  PIC XX.
               05  QSPA-EDT-CD-1-5                    PIC X.
               05  QSPA-EDT-RATE-1-5                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-5              PIC X.
               05  QSPA-EDT-AMT-1-5                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-5                PIC X.
               05  QSPA-EDT-TERM-1-5                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-1-6                  PIC X.
               05  QSPA-EDT-HL-1-6                    PIC X.
               05  QSPA-EDT-COLL-1-6                  PIC XX.
               05  QSPA-EDT-CD-1-6                    PIC X.
               05  QSPA-EDT-RATE-1-6                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-1-6              PIC X.
               05  QSPA-EDT-AMT-1-6                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-1-6                PIC X.
               05  QSPA-EDT-TERM-1-6                  PIC 9(3)V9.
               05  QSPA-EDT-NOEDITS-2                 PIC S9.
               05  QSPA-EDT-TYPE-2-1                  PIC X.
               05  QSPA-EDT-HL-2-1                    PIC X.
               05  QSPA-EDT-COLL-2-1                  PIC XX.
               05  QSPA-EDT-CD-2-1                    PIC X.
               05  QSPA-EDT-RATE-2-1                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-1              PIC X.
               05  QSPA-EDT-AMT-2-1                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-1                PIC X.
               05  QSPA-EDT-TERM-2-1                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-2-2                  PIC X.
               05  QSPA-EDT-HL-2-2                    PIC X.
               05  QSPA-EDT-COLL-2-2                  PIC XX.
               05  QSPA-EDT-CD-2-2                    PIC X.
               05  QSPA-EDT-RATE-2-2                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-2              PIC X.
               05  QSPA-EDT-AMT-2-2                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-2                PIC X.
               05  QSPA-EDT-TERM-2-2                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-2-3                  PIC X.
               05  QSPA-EDT-HL-2-3                    PIC X.
               05  QSPA-EDT-COLL-2-3                  PIC XX.
               05  QSPA-EDT-CD-2-3                    PIC X.
               05  QSPA-EDT-RATE-2-3                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-3              PIC X.
               05  QSPA-EDT-AMT-2-3                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-3                PIC X.
               05  QSPA-EDT-TERM-2-3                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-2-4                  PIC X.
               05  QSPA-EDT-HL-2-4                    PIC X.
               05  QSPA-EDT-COLL-2-4                  PIC XX.
               05  QSPA-EDT-CD-2-4                    PIC X.
               05  QSPA-EDT-RATE-2-4                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-4              PIC X.
               05  QSPA-EDT-AMT-2-4                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-4                PIC X.
               05  QSPA-EDT-TERM-2-4                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-2-5                  PIC X.
               05  QSPA-EDT-HL-2-5                    PIC X.
               05  QSPA-EDT-COLL-2-5                  PIC XX.
               05  QSPA-EDT-CD-2-5                    PIC X.
               05  QSPA-EDT-RATE-2-5                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-5              PIC X.
               05  QSPA-EDT-AMT-2-5                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-5                PIC X.
               05  QSPA-EDT-TERM-2-5                  PIC 9(3)V9.
               05  QSPA-EDT-TYPE-2-6                  PIC X.
               05  QSPA-EDT-HL-2-6                    PIC X.
               05  QSPA-EDT-COLL-2-6                  PIC XX.
               05  QSPA-EDT-CD-2-6                    PIC X.
               05  QSPA-EDT-RATE-2-6                  PIC 99V99.
               05  QSPA-EDT-RATETYPE-2-6              PIC X.
               05  QSPA-EDT-AMT-2-6                   PIC 9(7)V99.
               05  QSPA-EDT-AMTYPE-2-6                PIC X.
               05  QSPA-EDT-TERM-2-6                  PIC 9(3)V9.
           03  QSPB-REC.
               05  QSPB-ORGST                         PIC XX.
               05  QSPB-SPRCLASS                      PIC 999.
               05  QSPB-SUBCLASS                      PIC 99.
               05  QSPB-LAWCODE                       PIC 99.
               05  QSPB-INSCOM-1                      PIC 99.
               05  QSPB-INSRATECD-1                   PIC 999.
               05  QSPB-INSJFAC-1                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-1                   PIC 99V99.
               05  QSPB-INSCHGABL-1                   PIC X(2).
               05  QSPB-INSTERM-1-1                   PIC 9(3).
               05  QSPB-INSRATE-1-1                   PIC 99V9999.
               05  QSPB-INSTERM-1-2                   PIC 9(3).
               05  QSPB-INSRATE-1-2                   PIC 99V9999.
               05  QSPB-INSTERM-1-3                   PIC 9(3).
               05  QSPB-INSRATE-1-3                   PIC 99V9999.
               05  QSPB-INSTERM-1-4                   PIC 9(3).
               05  QSPB-INSRATE-1-4                   PIC 99V9999.
               05  QSPB-INSTERM-1-5                   PIC 9(3).
               05  QSPB-INSRATE-1-5                   PIC 99V9999.
               05  QSPB-INSTERM-1-6                   PIC 9(3).
               05  QSPB-INSRATE-1-6                   PIC 99V9999.
               05  QSPB-INSTERM-1-7                   PIC 9(3).
               05  QSPB-INSRATE-1-7                   PIC 99V9999.
               05  QSPB-INSTERM-1-8                   PIC 9(3).
               05  QSPB-INSRATE-1-8                   PIC 99V9999.
               05  QSPB-INSTERM-1-9                   PIC 9(3).
               05  QSPB-INSRATE-1-9                   PIC 99V9999.
               05  QSPB-INSTERM-1-10                  PIC 9(3).
               05  QSPB-INSRATE-1-10                  PIC 99V9999.
               05  QSPB-INSTERM-1-11                  PIC 9(3).
               05  QSPB-INSRATE-1-11                  PIC 99V9999.
               05  QSPB-INSTERM-1-12                  PIC 9(3).
               05  QSPB-INSRATE-1-12                  PIC 99V9999.
               05  QSPB-INSTERM-1-13                  PIC 9(3).
               05  QSPB-INSRATE-1-13                  PIC 99V9999.
               05  QSPB-INSTERM-1-14                  PIC 9(3).
               05  QSPB-INSRATE-1-14                  PIC 99V9999.
               05  QSPB-INSTERM-1-15                  PIC 9(3).
               05  QSPB-INSRATE-1-15                  PIC 99V9999.
               05  QSPB-INSTERM-1-16                  PIC 9(3).
               05  QSPB-INSRATE-1-16                  PIC 99V9999.
               05  QSPB-INSTERM-1-17                  PIC 9(3).
               05  QSPB-INSRATE-1-17                  PIC 99V9999.
               05  QSPB-INSTERM-1-18                  PIC 9(3).
               05  QSPB-INSRATE-1-18                  PIC 99V9999.
               05  QSPB-INSTERM-1-19                  PIC 9(3).
               05  QSPB-INSRATE-1-19                  PIC 99V9999.
               05  QSPB-INSTERM-1-20                  PIC 9(3).
               05  QSPB-INSRATE-1-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-1                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-1                PIC 9(6).
               05  QSPB-INSMAXCHGABL-1                PIC 9(7).
               05  QSPB-INSMAXBENIF-1                 PIC 9(7).
               05  QSPB-INSMAXTERM-1                  PIC 9(3).
               05  QSPB-INSCHGBEN-1                   PIC X.
               05  QSPB-INSEXCEPT-1                   PIC 99.
               05  QSPB-INSNOVER-1                    PIC 99.
               05  QSPB-INSMINAGE-1-1                 PIC 99.
               05  QSPB-INSMAXAGE-1-1                 PIC 99.
               05  QSPB-INSMAXCOV-1-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-1-1                 PIC 9(3).
               05  QSPB-INSMINAGE-1-2                 PIC 99.
               05  QSPB-INSMAXAGE-1-2                 PIC 99.
               05  QSPB-INSMAXCOV-1-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-1-2                 PIC 9(3).
               05  QSPB-INSMINAGE-1-3                 PIC 99.
               05  QSPB-INSMAXAGE-1-3                 PIC 99.
               05  QSPB-INSMAXCOV-1-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-1-3                 PIC 9(3).
               05  QSPB-INSMINAGE-1-4                 PIC 99.
               05  QSPB-INSMAXAGE-1-4                 PIC 99.
               05  QSPB-INSMAXCOV-1-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-1-4                 PIC 9(3).
               05  QSPB-INSMINAGE-1-5                 PIC 99.
               05  QSPB-INSMAXAGE-1-5                 PIC 99.
               05  QSPB-INSMAXCOV-1-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-1-5                 PIC 9(3).
               05  QSPB-INSFEECD-1                    PIC XX.
               05  QSPB-INSFEE-FRMLA-1                PIC X.
               05  QSPB-INSCHGABL-FG-1                PIC X.
               05  QSPB-INSREJECT-FG-1                PIC X.
               05  QSPB-INSFINCHG-1                   PIC X.
               05  QSPB-INSCOM-2                      PIC 99.
               05  QSPB-INSRATECD-2                   PIC 999.
               05  QSPB-INSJFAC-2                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-2                   PIC 99V99.
               05  QSPB-INSCHGABL-2                   PIC X(2).
               05  QSPB-INSTERM-2-1                   PIC 9(3).
               05  QSPB-INSRATE-2-1                   PIC 99V9999.
               05  QSPB-INSTERM-2-2                   PIC 9(3).
               05  QSPB-INSRATE-2-2                   PIC 99V9999.
               05  QSPB-INSTERM-2-3                   PIC 9(3).
               05  QSPB-INSRATE-2-3                   PIC 99V9999.
               05  QSPB-INSTERM-2-4                   PIC 9(3).
               05  QSPB-INSRATE-2-4                   PIC 99V9999.
               05  QSPB-INSTERM-2-5                   PIC 9(3).
               05  QSPB-INSRATE-2-5                   PIC 99V9999.
               05  QSPB-INSTERM-2-6                   PIC 9(3).
               05  QSPB-INSRATE-2-6                   PIC 99V9999.
               05  QSPB-INSTERM-2-7                   PIC 9(3).
               05  QSPB-INSRATE-2-7                   PIC 99V9999.
               05  QSPB-INSTERM-2-8                   PIC 9(3).
               05  QSPB-INSRATE-2-8                   PIC 99V9999.
               05  QSPB-INSTERM-2-9                   PIC 9(3).
               05  QSPB-INSRATE-2-9                   PIC 99V9999.
               05  QSPB-INSTERM-2-10                  PIC 9(3).
               05  QSPB-INSRATE-2-10                  PIC 99V9999.
               05  QSPB-INSTERM-2-11                  PIC 9(3).
               05  QSPB-INSRATE-2-11                  PIC 99V9999.
               05  QSPB-INSTERM-2-12                  PIC 9(3).
               05  QSPB-INSRATE-2-12                  PIC 99V9999.
               05  QSPB-INSTERM-2-13                  PIC 9(3).
               05  QSPB-INSRATE-2-13                  PIC 99V9999.
               05  QSPB-INSTERM-2-14                  PIC 9(3).
               05  QSPB-INSRATE-2-14                  PIC 99V9999.
               05  QSPB-INSTERM-2-15                  PIC 9(3).
               05  QSPB-INSRATE-2-15                  PIC 99V9999.
               05  QSPB-INSTERM-2-16                  PIC 9(3).
               05  QSPB-INSRATE-2-16                  PIC 99V9999.
               05  QSPB-INSTERM-2-17                  PIC 9(3).
               05  QSPB-INSRATE-2-17                  PIC 99V9999.
               05  QSPB-INSTERM-2-18                  PIC 9(3).
               05  QSPB-INSRATE-2-18                  PIC 99V9999.
               05  QSPB-INSTERM-2-19                  PIC 9(3).
               05  QSPB-INSRATE-2-19                  PIC 99V9999.
               05  QSPB-INSTERM-2-20                  PIC 9(3).
               05  QSPB-INSRATE-2-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-2                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-2                PIC 9(6).
               05  QSPB-INSMAXCHGABL-2                PIC 9(7).
               05  QSPB-INSMAXBENIF-2                 PIC 9(7).
               05  QSPB-INSMAXTERM-2                  PIC 9(3).
               05  QSPB-INSCHGBEN-2                   PIC X.
               05  QSPB-INSEXCEPT-2                   PIC 99.
               05  QSPB-INSNOVER-2                    PIC 99.
               05  QSPB-INSMINAGE-2-1                 PIC 99.
               05  QSPB-INSMAXAGE-2-1                 PIC 99.
               05  QSPB-INSMAXCOV-2-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-2-1                 PIC 9(3).
               05  QSPB-INSMINAGE-2-2                 PIC 99.
               05  QSPB-INSMAXAGE-2-2                 PIC 99.
               05  QSPB-INSMAXCOV-2-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-2-2                 PIC 9(3).
               05  QSPB-INSMINAGE-2-3                 PIC 99.
               05  QSPB-INSMAXAGE-2-3                 PIC 99.
               05  QSPB-INSMAXCOV-2-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-2-3                 PIC 9(3).
               05  QSPB-INSMINAGE-2-4                 PIC 99.
               05  QSPB-INSMAXAGE-2-4                 PIC 99.
               05  QSPB-INSMAXCOV-2-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-2-4                 PIC 9(3).
               05  QSPB-INSMINAGE-2-5                 PIC 99.
               05  QSPB-INSMAXAGE-2-5                 PIC 99.
               05  QSPB-INSMAXCOV-2-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-2-5                 PIC 9(3).
               05  QSPB-INSFEECD-2                    PIC XX.
               05  QSPB-INSFEE-FRMLA-2                PIC X.
               05  QSPB-INSCHGABL-FG-2                PIC X.
               05  QSPB-INSREJECT-FG-2                PIC X.
               05  QSPB-INSFINCHG-2                   PIC X.
               05  QSPB-INSCOM-3                      PIC 99.
               05  QSPB-INSRATECD-3                   PIC 999.
               05  QSPB-INSJFAC-3                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-3                   PIC 99V99.
               05  QSPB-INSCHGABL-3                   PIC X(2).
               05  QSPB-INSTERM-3-1                   PIC 9(3).
               05  QSPB-INSRATE-3-1                   PIC 99V9999.
               05  QSPB-INSTERM-3-2                   PIC 9(3).
               05  QSPB-INSRATE-3-2                   PIC 99V9999.
               05  QSPB-INSTERM-3-3                   PIC 9(3).
               05  QSPB-INSRATE-3-3                   PIC 99V9999.
               05  QSPB-INSTERM-3-4                   PIC 9(3).
               05  QSPB-INSRATE-3-4                   PIC 99V9999.
               05  QSPB-INSTERM-3-5                   PIC 9(3).
               05  QSPB-INSRATE-3-5                   PIC 99V9999.
               05  QSPB-INSTERM-3-6                   PIC 9(3).
               05  QSPB-INSRATE-3-6                   PIC 99V9999.
               05  QSPB-INSTERM-3-7                   PIC 9(3).
               05  QSPB-INSRATE-3-7                   PIC 99V9999.
               05  QSPB-INSTERM-3-8                   PIC 9(3).
               05  QSPB-INSRATE-3-8                   PIC 99V9999.
               05  QSPB-INSTERM-3-9                   PIC 9(3).
               05  QSPB-INSRATE-3-9                   PIC 99V9999.
               05  QSPB-INSTERM-3-10                  PIC 9(3).
               05  QSPB-INSRATE-3-10                  PIC 99V9999.
               05  QSPB-INSTERM-3-11                  PIC 9(3).
               05  QSPB-INSRATE-3-11                  PIC 99V9999.
               05  QSPB-INSTERM-3-12                  PIC 9(3).
               05  QSPB-INSRATE-3-12                  PIC 99V9999.
               05  QSPB-INSTERM-3-13                  PIC 9(3).
               05  QSPB-INSRATE-3-13                  PIC 99V9999.
               05  QSPB-INSTERM-3-14                  PIC 9(3).
               05  QSPB-INSRATE-3-14                  PIC 99V9999.
               05  QSPB-INSTERM-3-15                  PIC 9(3).
               05  QSPB-INSRATE-3-15                  PIC 99V9999.
               05  QSPB-INSTERM-3-16                  PIC 9(3).
               05  QSPB-INSRATE-3-16                  PIC 99V9999.
               05  QSPB-INSTERM-3-17                  PIC 9(3).
               05  QSPB-INSRATE-3-17                  PIC 99V9999.
               05  QSPB-INSTERM-3-18                  PIC 9(3).
               05  QSPB-INSRATE-3-18                  PIC 99V9999.
               05  QSPB-INSTERM-3-19                  PIC 9(3).
               05  QSPB-INSRATE-3-19                  PIC 99V9999.
               05  QSPB-INSTERM-3-20                  PIC 9(3).
               05  QSPB-INSRATE-3-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-3                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-3                PIC 9(6).
               05  QSPB-INSMAXCHGABL-3                PIC 9(7).
               05  QSPB-INSMAXBENIF-3                 PIC 9(7).
               05  QSPB-INSMAXTERM-3                  PIC 9(3).
               05  QSPB-INSCHGBEN-3                   PIC X.
               05  QSPB-INSEXCEPT-3                   PIC 99.
               05  QSPB-INSNOVER-3                    PIC 99.
               05  QSPB-INSMINAGE-3-1                 PIC 99.
               05  QSPB-INSMAXAGE-3-1                 PIC 99.
               05  QSPB-INSMAXCOV-3-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-3-1                 PIC 9(3).
               05  QSPB-INSMINAGE-3-2                 PIC 99.
               05  QSPB-INSMAXAGE-3-2                 PIC 99.
               05  QSPB-INSMAXCOV-3-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-3-2                 PIC 9(3).
               05  QSPB-INSMINAGE-3-3                 PIC 99.
               05  QSPB-INSMAXAGE-3-3                 PIC 99.
               05  QSPB-INSMAXCOV-3-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-3-3                 PIC 9(3).
               05  QSPB-INSMINAGE-3-4                 PIC 99.
               05  QSPB-INSMAXAGE-3-4                 PIC 99.
               05  QSPB-INSMAXCOV-3-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-3-4                 PIC 9(3).
               05  QSPB-INSMINAGE-3-5                 PIC 99.
               05  QSPB-INSMAXAGE-3-5                 PIC 99.
               05  QSPB-INSMAXCOV-3-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-3-5                 PIC 9(3).
               05  QSPB-INSFEECD-3                    PIC XX.
               05  QSPB-INSFEE-FRMLA-3                PIC X.
               05  QSPB-INSCHGABL-FG-3                PIC X.
               05  QSPB-INSREJECT-FG-3                PIC X.
               05  QSPB-INSFINCHG-3                   PIC X.
               05  QSPB-INSCOM-4                      PIC 99.
               05  QSPB-INSRATECD-4                   PIC 999.
               05  QSPB-INSJFAC-4                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-4                   PIC 99V99.
               05  QSPB-INSCHGABL-4                   PIC X(2).
               05  QSPB-INSTERM-4-1                   PIC 9(3).
               05  QSPB-INSRATE-4-1                   PIC 99V9999.
               05  QSPB-INSTERM-4-2                   PIC 9(3).
               05  QSPB-INSRATE-4-2                   PIC 99V9999.
               05  QSPB-INSTERM-4-3                   PIC 9(3).
               05  QSPB-INSRATE-4-3                   PIC 99V9999.
               05  QSPB-INSTERM-4-4                   PIC 9(3).
               05  QSPB-INSRATE-4-4                   PIC 99V9999.
               05  QSPB-INSTERM-4-5                   PIC 9(3).
               05  QSPB-INSRATE-4-5                   PIC 99V9999.
               05  QSPB-INSTERM-4-6                   PIC 9(3).
               05  QSPB-INSRATE-4-6                   PIC 99V9999.
               05  QSPB-INSTERM-4-7                   PIC 9(3).
               05  QSPB-INSRATE-4-7                   PIC 99V9999.
               05  QSPB-INSTERM-4-8                   PIC 9(3).
               05  QSPB-INSRATE-4-8                   PIC 99V9999.
               05  QSPB-INSTERM-4-9                   PIC 9(3).
               05  QSPB-INSRATE-4-9                   PIC 99V9999.
               05  QSPB-INSTERM-4-10                  PIC 9(3).
               05  QSPB-INSRATE-4-10                  PIC 99V9999.
               05  QSPB-INSTERM-4-11                  PIC 9(3).
               05  QSPB-INSRATE-4-11                  PIC 99V9999.
               05  QSPB-INSTERM-4-12                  PIC 9(3).
               05  QSPB-INSRATE-4-12                  PIC 99V9999.
               05  QSPB-INSTERM-4-13                  PIC 9(3).
               05  QSPB-INSRATE-4-13                  PIC 99V9999.
               05  QSPB-INSTERM-4-14                  PIC 9(3).
               05  QSPB-INSRATE-4-14                  PIC 99V9999.
               05  QSPB-INSTERM-4-15                  PIC 9(3).
               05  QSPB-INSRATE-4-15                  PIC 99V9999.
               05  QSPB-INSTERM-4-16                  PIC 9(3).
               05  QSPB-INSRATE-4-16                  PIC 99V9999.
               05  QSPB-INSTERM-4-17                  PIC 9(3).
               05  QSPB-INSRATE-4-17                  PIC 99V9999.
               05  QSPB-INSTERM-4-18                  PIC 9(3).
               05  QSPB-INSRATE-4-18                  PIC 99V9999.
               05  QSPB-INSTERM-4-19                  PIC 9(3).
               05  QSPB-INSRATE-4-19                  PIC 99V9999.
               05  QSPB-INSTERM-4-20                  PIC 9(3).
               05  QSPB-INSRATE-4-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-4                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-4                PIC 9(6).
               05  QSPB-INSMAXCHGABL-4                PIC 9(7).
               05  QSPB-INSMAXBENIF-4                 PIC 9(7).
               05  QSPB-INSMAXTERM-4                  PIC 9(3).
               05  QSPB-INSCHGBEN-4                   PIC X.
               05  QSPB-INSEXCEPT-4                   PIC 99.
               05  QSPB-INSNOVER-4                    PIC 99.
               05  QSPB-INSMINAGE-4-1                 PIC 99.
               05  QSPB-INSMAXAGE-4-1                 PIC 99.
               05  QSPB-INSMAXCOV-4-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-4-1                 PIC 9(3).
               05  QSPB-INSMINAGE-4-2                 PIC 99.
               05  QSPB-INSMAXAGE-4-2                 PIC 99.
               05  QSPB-INSMAXCOV-4-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-4-2                 PIC 9(3).
               05  QSPB-INSMINAGE-4-3                 PIC 99.
               05  QSPB-INSMAXAGE-4-3                 PIC 99.
               05  QSPB-INSMAXCOV-4-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-4-3                 PIC 9(3).
               05  QSPB-INSMINAGE-4-4                 PIC 99.
               05  QSPB-INSMAXAGE-4-4                 PIC 99.
               05  QSPB-INSMAXCOV-4-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-4-4                 PIC 9(3).
               05  QSPB-INSMINAGE-4-5                 PIC 99.
               05  QSPB-INSMAXAGE-4-5                 PIC 99.
               05  QSPB-INSMAXCOV-4-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-4-5                 PIC 9(3).
               05  QSPB-INSFEECD-4                    PIC XX.
               05  QSPB-INSFEE-FRMLA-4                PIC X.
               05  QSPB-INSCHGABL-FG-4                PIC X.
               05  QSPB-INSREJECT-FG-4                PIC X.
               05  QSPB-INSFINCHG-4                   PIC X.
               05  QSPB-INSCOM-5                      PIC 99.
               05  QSPB-INSRATECD-5                   PIC 999.
               05  QSPB-INSJFAC-5                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-5                   PIC 99V99.
               05  QSPB-INSCHGABL-5                   PIC X(2).
               05  QSPB-INSTERM-5-1                   PIC 9(3).
               05  QSPB-INSRATE-5-1                   PIC 99V9999.
               05  QSPB-INSTERM-5-2                   PIC 9(3).
               05  QSPB-INSRATE-5-2                   PIC 99V9999.
               05  QSPB-INSTERM-5-3                   PIC 9(3).
               05  QSPB-INSRATE-5-3                   PIC 99V9999.
               05  QSPB-INSTERM-5-4                   PIC 9(3).
               05  QSPB-INSRATE-5-4                   PIC 99V9999.
               05  QSPB-INSTERM-5-5                   PIC 9(3).
               05  QSPB-INSRATE-5-5                   PIC 99V9999.
               05  QSPB-INSTERM-5-6                   PIC 9(3).
               05  QSPB-INSRATE-5-6                   PIC 99V9999.
               05  QSPB-INSTERM-5-7                   PIC 9(3).
               05  QSPB-INSRATE-5-7                   PIC 99V9999.
               05  QSPB-INSTERM-5-8                   PIC 9(3).
               05  QSPB-INSRATE-5-8                   PIC 99V9999.
               05  QSPB-INSTERM-5-9                   PIC 9(3).
               05  QSPB-INSRATE-5-9                   PIC 99V9999.
               05  QSPB-INSTERM-5-10                  PIC 9(3).
               05  QSPB-INSRATE-5-10                  PIC 99V9999.
               05  QSPB-INSTERM-5-11                  PIC 9(3).
               05  QSPB-INSRATE-5-11                  PIC 99V9999.
               05  QSPB-INSTERM-5-12                  PIC 9(3).
               05  QSPB-INSRATE-5-12                  PIC 99V9999.
               05  QSPB-INSTERM-5-13                  PIC 9(3).
               05  QSPB-INSRATE-5-13                  PIC 99V9999.
               05  QSPB-INSTERM-5-14                  PIC 9(3).
               05  QSPB-INSRATE-5-14                  PIC 99V9999.
               05  QSPB-INSTERM-5-15                  PIC 9(3).
               05  QSPB-INSRATE-5-15                  PIC 99V9999.
               05  QSPB-INSTERM-5-16                  PIC 9(3).
               05  QSPB-INSRATE-5-16                  PIC 99V9999.
               05  QSPB-INSTERM-5-17                  PIC 9(3).
               05  QSPB-INSRATE-5-17                  PIC 99V9999.
               05  QSPB-INSTERM-5-18                  PIC 9(3).
               05  QSPB-INSRATE-5-18                  PIC 99V9999.
               05  QSPB-INSTERM-5-19                  PIC 9(3).
               05  QSPB-INSRATE-5-19                  PIC 99V9999.
               05  QSPB-INSTERM-5-20                  PIC 9(3).
               05  QSPB-INSRATE-5-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-5                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-5                PIC 9(6).
               05  QSPB-INSMAXCHGABL-5                PIC 9(7).
               05  QSPB-INSMAXBENIF-5                 PIC 9(7).
               05  QSPB-INSMAXTERM-5                  PIC 9(3).
               05  QSPB-INSCHGBEN-5                   PIC X.
               05  QSPB-INSEXCEPT-5                   PIC 99.
               05  QSPB-INSNOVER-5                    PIC 99.
               05  QSPB-INSMINAGE-5-1                 PIC 99.
               05  QSPB-INSMAXAGE-5-1                 PIC 99.
               05  QSPB-INSMAXCOV-5-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-5-1                 PIC 9(3).
               05  QSPB-INSMINAGE-5-2                 PIC 99.
               05  QSPB-INSMAXAGE-5-2                 PIC 99.
               05  QSPB-INSMAXCOV-5-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-5-2                 PIC 9(3).
               05  QSPB-INSMINAGE-5-3                 PIC 99.
               05  QSPB-INSMAXAGE-5-3                 PIC 99.
               05  QSPB-INSMAXCOV-5-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-5-3                 PIC 9(3).
               05  QSPB-INSMINAGE-5-4                 PIC 99.
               05  QSPB-INSMAXAGE-5-4                 PIC 99.
               05  QSPB-INSMAXCOV-5-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-5-4                 PIC 9(3).
               05  QSPB-INSMINAGE-5-5                 PIC 99.
               05  QSPB-INSMAXAGE-5-5                 PIC 99.
               05  QSPB-INSMAXCOV-5-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-5-5                 PIC 9(3).
               05  QSPB-INSFEECD-5                    PIC XX.
               05  QSPB-INSFEE-FRMLA-5                PIC X.
               05  QSPB-INSCHGABL-FG-5                PIC X.
               05  QSPB-INSREJECT-FG-5                PIC X.
               05  QSPB-INSFINCHG-5                   PIC X.
               05  QSPB-INSCOM-6                      PIC 99.
               05  QSPB-INSRATECD-6                   PIC 999.
               05  QSPB-INSJFAC-6                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-6                   PIC 99V99.
               05  QSPB-INSCHGABL-6                   PIC X(2).
               05  QSPB-INSTERM-6-1                   PIC 9(3).
               05  QSPB-INSRATE-6-1                   PIC 99V9999.
               05  QSPB-INSTERM-6-2                   PIC 9(3).
               05  QSPB-INSRATE-6-2                   PIC 99V9999.
               05  QSPB-INSTERM-6-3                   PIC 9(3).
               05  QSPB-INSRATE-6-3                   PIC 99V9999.
               05  QSPB-INSTERM-6-4                   PIC 9(3).
               05  QSPB-INSRATE-6-4                   PIC 99V9999.
               05  QSPB-INSTERM-6-5                   PIC 9(3).
               05  QSPB-INSRATE-6-5                   PIC 99V9999.
               05  QSPB-INSTERM-6-6                   PIC 9(3).
               05  QSPB-INSRATE-6-6                   PIC 99V9999.
               05  QSPB-INSTERM-6-7                   PIC 9(3).
               05  QSPB-INSRATE-6-7                   PIC 99V9999.
               05  QSPB-INSTERM-6-8                   PIC 9(3).
               05  QSPB-INSRATE-6-8                   PIC 99V9999.
               05  QSPB-INSTERM-6-9                   PIC 9(3).
               05  QSPB-INSRATE-6-9                   PIC 99V9999.
               05  QSPB-INSTERM-6-10                  PIC 9(3).
               05  QSPB-INSRATE-6-10                  PIC 99V9999.
               05  QSPB-INSTERM-6-11                  PIC 9(3).
               05  QSPB-INSRATE-6-11                  PIC 99V9999.
               05  QSPB-INSTERM-6-12                  PIC 9(3).
               05  QSPB-INSRATE-6-12                  PIC 99V9999.
               05  QSPB-INSTERM-6-13                  PIC 9(3).
               05  QSPB-INSRATE-6-13                  PIC 99V9999.
               05  QSPB-INSTERM-6-14                  PIC 9(3).
               05  QSPB-INSRATE-6-14                  PIC 99V9999.
               05  QSPB-INSTERM-6-15                  PIC 9(3).
               05  QSPB-INSRATE-6-15                  PIC 99V9999.
               05  QSPB-INSTERM-6-16                  PIC 9(3).
               05  QSPB-INSRATE-6-16                  PIC 99V9999.
               05  QSPB-INSTERM-6-17                  PIC 9(3).
               05  QSPB-INSRATE-6-17                  PIC 99V9999.
               05  QSPB-INSTERM-6-18                  PIC 9(3).
               05  QSPB-INSRATE-6-18                  PIC 99V9999.
               05  QSPB-INSTERM-6-19                  PIC 9(3).
               05  QSPB-INSRATE-6-19                  PIC 99V9999.
               05  QSPB-INSTERM-6-20                  PIC 9(3).
               05  QSPB-INSRATE-6-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-6                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-6                PIC 9(6).
               05  QSPB-INSMAXCHGABL-6                PIC 9(7).
               05  QSPB-INSMAXBENIF-6                 PIC 9(7).
               05  QSPB-INSMAXTERM-6                  PIC 9(3).
               05  QSPB-INSCHGBEN-6                   PIC X.
               05  QSPB-INSEXCEPT-6                   PIC 99.
               05  QSPB-INSNOVER-6                    PIC 99.
               05  QSPB-INSMINAGE-6-1                 PIC 99.
               05  QSPB-INSMAXAGE-6-1                 PIC 99.
               05  QSPB-INSMAXCOV-6-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-6-1                 PIC 9(3).
               05  QSPB-INSMINAGE-6-2                 PIC 99.
               05  QSPB-INSMAXAGE-6-2                 PIC 99.
               05  QSPB-INSMAXCOV-6-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-6-2                 PIC 9(3).
               05  QSPB-INSMINAGE-6-3                 PIC 99.
               05  QSPB-INSMAXAGE-6-3                 PIC 99.
               05  QSPB-INSMAXCOV-6-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-6-3                 PIC 9(3).
               05  QSPB-INSMINAGE-6-4                 PIC 99.
               05  QSPB-INSMAXAGE-6-4                 PIC 99.
               05  QSPB-INSMAXCOV-6-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-6-4                 PIC 9(3).
               05  QSPB-INSMINAGE-6-5                 PIC 99.
               05  QSPB-INSMAXAGE-6-5                 PIC 99.
               05  QSPB-INSMAXCOV-6-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-6-5                 PIC 9(3).
               05  QSPB-INSFEECD-6                    PIC XX.
               05  QSPB-INSFEE-FRMLA-6                PIC X.
               05  QSPB-INSCHGABL-FG-6                PIC X.
               05  QSPB-INSREJECT-FG-6                PIC X.
               05  QSPB-INSFINCHG-6                   PIC X.
               05  QSPB-INSCOM-7                      PIC 99.
               05  QSPB-INSRATECD-7                   PIC 999.
               05  QSPB-INSJFAC-7                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-7                   PIC 99V99.
               05  QSPB-INSCHGABL-7                   PIC X(2).
               05  QSPB-INSTERM-7-1                   PIC 9(3).
               05  QSPB-INSRATE-7-1                   PIC 99V9999.
               05  QSPB-INSTERM-7-2                   PIC 9(3).
               05  QSPB-INSRATE-7-2                   PIC 99V9999.
               05  QSPB-INSTERM-7-3                   PIC 9(3).
               05  QSPB-INSRATE-7-3                   PIC 99V9999.
               05  QSPB-INSTERM-7-4                   PIC 9(3).
               05  QSPB-INSRATE-7-4                   PIC 99V9999.
               05  QSPB-INSTERM-7-5                   PIC 9(3).
               05  QSPB-INSRATE-7-5                   PIC 99V9999.
               05  QSPB-INSTERM-7-6                   PIC 9(3).
               05  QSPB-INSRATE-7-6                   PIC 99V9999.
               05  QSPB-INSTERM-7-7                   PIC 9(3).
               05  QSPB-INSRATE-7-7                   PIC 99V9999.
               05  QSPB-INSTERM-7-8                   PIC 9(3).
               05  QSPB-INSRATE-7-8                   PIC 99V9999.
               05  QSPB-INSTERM-7-9                   PIC 9(3).
               05  QSPB-INSRATE-7-9                   PIC 99V9999.
               05  QSPB-INSTERM-7-10                  PIC 9(3).
               05  QSPB-INSRATE-7-10                  PIC 99V9999.
               05  QSPB-INSTERM-7-11                  PIC 9(3).
               05  QSPB-INSRATE-7-11                  PIC 99V9999.
               05  QSPB-INSTERM-7-12                  PIC 9(3).
               05  QSPB-INSRATE-7-12                  PIC 99V9999.
               05  QSPB-INSTERM-7-13                  PIC 9(3).
               05  QSPB-INSRATE-7-13                  PIC 99V9999.
               05  QSPB-INSTERM-7-14                  PIC 9(3).
               05  QSPB-INSRATE-7-14                  PIC 99V9999.
               05  QSPB-INSTERM-7-15                  PIC 9(3).
               05  QSPB-INSRATE-7-15                  PIC 99V9999.
               05  QSPB-INSTERM-7-16                  PIC 9(3).
               05  QSPB-INSRATE-7-16                  PIC 99V9999.
               05  QSPB-INSTERM-7-17                  PIC 9(3).
               05  QSPB-INSRATE-7-17                  PIC 99V9999.
               05  QSPB-INSTERM-7-18                  PIC 9(3).
               05  QSPB-INSRATE-7-18                  PIC 99V9999.
               05  QSPB-INSTERM-7-19                  PIC 9(3).
               05  QSPB-INSRATE-7-19                  PIC 99V9999.
               05  QSPB-INSTERM-7-20                  PIC 9(3).
               05  QSPB-INSRATE-7-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-7                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-7                PIC 9(6).
               05  QSPB-INSMAXCHGABL-7                PIC 9(7).
               05  QSPB-INSMAXBENIF-7                 PIC 9(7).
               05  QSPB-INSMAXTERM-7                  PIC 9(3).
               05  QSPB-INSCHGBEN-7                   PIC X.
               05  QSPB-INSEXCEPT-7                   PIC 99.
               05  QSPB-INSNOVER-7                    PIC 99.
               05  QSPB-INSMINAGE-7-1                 PIC 99.
               05  QSPB-INSMAXAGE-7-1                 PIC 99.
               05  QSPB-INSMAXCOV-7-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-7-1                 PIC 9(3).
               05  QSPB-INSMINAGE-7-2                 PIC 99.
               05  QSPB-INSMAXAGE-7-2                 PIC 99.
               05  QSPB-INSMAXCOV-7-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-7-2                 PIC 9(3).
               05  QSPB-INSMINAGE-7-3                 PIC 99.
               05  QSPB-INSMAXAGE-7-3                 PIC 99.
               05  QSPB-INSMAXCOV-7-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-7-3                 PIC 9(3).
               05  QSPB-INSMINAGE-7-4                 PIC 99.
               05  QSPB-INSMAXAGE-7-4                 PIC 99.
               05  QSPB-INSMAXCOV-7-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-7-4                 PIC 9(3).
               05  QSPB-INSMINAGE-7-5                 PIC 99.
               05  QSPB-INSMAXAGE-7-5                 PIC 99.
               05  QSPB-INSMAXCOV-7-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-7-5                 PIC 9(3).
               05  QSPB-INSFEECD-7                    PIC XX.
               05  QSPB-INSFEE-FRMLA-7                PIC X.
               05  QSPB-INSCHGABL-FG-7                PIC X.
               05  QSPB-INSREJECT-FG-7                PIC X.
               05  QSPB-INSFINCHG-7                   PIC X.
               05  QSPB-INSCOM-8                      PIC 99.
               05  QSPB-INSRATECD-8                   PIC 999.
               05  QSPB-INSJFAC-8                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-8                   PIC 99V99.
               05  QSPB-INSCHGABL-8                   PIC X(2).
               05  QSPB-INSTERM-8-1                   PIC 9(3).
               05  QSPB-INSRATE-8-1                   PIC 99V9999.
               05  QSPB-INSTERM-8-2                   PIC 9(3).
               05  QSPB-INSRATE-8-2                   PIC 99V9999.
               05  QSPB-INSTERM-8-3                   PIC 9(3).
               05  QSPB-INSRATE-8-3                   PIC 99V9999.
               05  QSPB-INSTERM-8-4                   PIC 9(3).
               05  QSPB-INSRATE-8-4                   PIC 99V9999.
               05  QSPB-INSTERM-8-5                   PIC 9(3).
               05  QSPB-INSRATE-8-5                   PIC 99V9999.
               05  QSPB-INSTERM-8-6                   PIC 9(3).
               05  QSPB-INSRATE-8-6                   PIC 99V9999.
               05  QSPB-INSTERM-8-7                   PIC 9(3).
               05  QSPB-INSRATE-8-7                   PIC 99V9999.
               05  QSPB-INSTERM-8-8                   PIC 9(3).
               05  QSPB-INSRATE-8-8                   PIC 99V9999.
               05  QSPB-INSTERM-8-9                   PIC 9(3).
               05  QSPB-INSRATE-8-9                   PIC 99V9999.
               05  QSPB-INSTERM-8-10                  PIC 9(3).
               05  QSPB-INSRATE-8-10                  PIC 99V9999.
               05  QSPB-INSTERM-8-11                  PIC 9(3).
               05  QSPB-INSRATE-8-11                  PIC 99V9999.
               05  QSPB-INSTERM-8-12                  PIC 9(3).
               05  QSPB-INSRATE-8-12                  PIC 99V9999.
               05  QSPB-INSTERM-8-13                  PIC 9(3).
               05  QSPB-INSRATE-8-13                  PIC 99V9999.
               05  QSPB-INSTERM-8-14                  PIC 9(3).
               05  QSPB-INSRATE-8-14                  PIC 99V9999.
               05  QSPB-INSTERM-8-15                  PIC 9(3).
               05  QSPB-INSRATE-8-15                  PIC 99V9999.
               05  QSPB-INSTERM-8-16                  PIC 9(3).
               05  QSPB-INSRATE-8-16                  PIC 99V9999.
               05  QSPB-INSTERM-8-17                  PIC 9(3).
               05  QSPB-INSRATE-8-17                  PIC 99V9999.
               05  QSPB-INSTERM-8-18                  PIC 9(3).
               05  QSPB-INSRATE-8-18                  PIC 99V9999.
               05  QSPB-INSTERM-8-19                  PIC 9(3).
               05  QSPB-INSRATE-8-19                  PIC 99V9999.
               05  QSPB-INSTERM-8-20                  PIC 9(3).
               05  QSPB-INSRATE-8-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-8                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-8                PIC 9(6).
               05  QSPB-INSMAXCHGABL-8                PIC 9(7).
               05  QSPB-INSMAXBENIF-8                 PIC 9(7).
               05  QSPB-INSMAXTERM-8                  PIC 9(3).
               05  QSPB-INSCHGBEN-8                   PIC X.
               05  QSPB-INSEXCEPT-8                   PIC 99.
               05  QSPB-INSNOVER-8                    PIC 99.
               05  QSPB-INSMINAGE-8-1                 PIC 99.
               05  QSPB-INSMAXAGE-8-1                 PIC 99.
               05  QSPB-INSMAXCOV-8-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-8-1                 PIC 9(3).
               05  QSPB-INSMINAGE-8-2                 PIC 99.
               05  QSPB-INSMAXAGE-8-2                 PIC 99.
               05  QSPB-INSMAXCOV-8-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-8-2                 PIC 9(3).
               05  QSPB-INSMINAGE-8-3                 PIC 99.
               05  QSPB-INSMAXAGE-8-3                 PIC 99.
               05  QSPB-INSMAXCOV-8-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-8-3                 PIC 9(3).
               05  QSPB-INSMINAGE-8-4                 PIC 99.
               05  QSPB-INSMAXAGE-8-4                 PIC 99.
               05  QSPB-INSMAXCOV-8-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-8-4                 PIC 9(3).
               05  QSPB-INSMINAGE-8-5                 PIC 99.
               05  QSPB-INSMAXAGE-8-5                 PIC 99.
               05  QSPB-INSMAXCOV-8-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-8-5                 PIC 9(3).
               05  QSPB-INSFEECD-8                    PIC XX.
               05  QSPB-INSFEE-FRMLA-8                PIC X.
               05  QSPB-INSCHGABL-FG-8                PIC X.
               05  QSPB-INSREJECT-FG-8                PIC X.
               05  QSPB-INSFINCHG-8                   PIC X.
               05  QSPB-INSCOM-9                      PIC 99.
               05  QSPB-INSRATECD-9                   PIC 999.
               05  QSPB-INSJFAC-9                     PIC 9(4)V99.
               05  QSPB-INSDISCNT-9                   PIC 99V99.
               05  QSPB-INSCHGABL-9                   PIC X(2).
               05  QSPB-INSTERM-9-1                   PIC 9(3).
               05  QSPB-INSRATE-9-1                   PIC 99V9999.
               05  QSPB-INSTERM-9-2                   PIC 9(3).
               05  QSPB-INSRATE-9-2                   PIC 99V9999.
               05  QSPB-INSTERM-9-3                   PIC 9(3).
               05  QSPB-INSRATE-9-3                   PIC 99V9999.
               05  QSPB-INSTERM-9-4                   PIC 9(3).
               05  QSPB-INSRATE-9-4                   PIC 99V9999.
               05  QSPB-INSTERM-9-5                   PIC 9(3).
               05  QSPB-INSRATE-9-5                   PIC 99V9999.
               05  QSPB-INSTERM-9-6                   PIC 9(3).
               05  QSPB-INSRATE-9-6                   PIC 99V9999.
               05  QSPB-INSTERM-9-7                   PIC 9(3).
               05  QSPB-INSRATE-9-7                   PIC 99V9999.
               05  QSPB-INSTERM-9-8                   PIC 9(3).
               05  QSPB-INSRATE-9-8                   PIC 99V9999.
               05  QSPB-INSTERM-9-9                   PIC 9(3).
               05  QSPB-INSRATE-9-9                   PIC 99V9999.
               05  QSPB-INSTERM-9-10                  PIC 9(3).
               05  QSPB-INSRATE-9-10                  PIC 99V9999.
               05  QSPB-INSTERM-9-11                  PIC 9(3).
               05  QSPB-INSRATE-9-11                  PIC 99V9999.
               05  QSPB-INSTERM-9-12                  PIC 9(3).
               05  QSPB-INSRATE-9-12                  PIC 99V9999.
               05  QSPB-INSTERM-9-13                  PIC 9(3).
               05  QSPB-INSRATE-9-13                  PIC 99V9999.
               05  QSPB-INSTERM-9-14                  PIC 9(3).
               05  QSPB-INSRATE-9-14                  PIC 99V9999.
               05  QSPB-INSTERM-9-15                  PIC 9(3).
               05  QSPB-INSRATE-9-15                  PIC 99V9999.
               05  QSPB-INSTERM-9-16                  PIC 9(3).
               05  QSPB-INSRATE-9-16                  PIC 99V9999.
               05  QSPB-INSTERM-9-17                  PIC 9(3).
               05  QSPB-INSRATE-9-17                  PIC 99V9999.
               05  QSPB-INSTERM-9-18                  PIC 9(3).
               05  QSPB-INSRATE-9-18                  PIC 99V9999.
               05  QSPB-INSTERM-9-19                  PIC 9(3).
               05  QSPB-INSRATE-9-19                  PIC 99V9999.
               05  QSPB-INSTERM-9-20                  PIC 9(3).
               05  QSPB-INSRATE-9-20                  PIC 99V9999.
               05  QSPB-INSMINPREM-9                  PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-9                PIC 9(6).
               05  QSPB-INSMAXCHGABL-9                PIC 9(7).
               05  QSPB-INSMAXBENIF-9                 PIC 9(7).
               05  QSPB-INSMAXTERM-9                  PIC 9(3).
               05  QSPB-INSCHGBEN-9                   PIC X.
               05  QSPB-INSEXCEPT-9                   PIC 99.
               05  QSPB-INSNOVER-9                    PIC 99.
               05  QSPB-INSMINAGE-9-1                 PIC 99.
               05  QSPB-INSMAXAGE-9-1                 PIC 99.
               05  QSPB-INSMAXCOV-9-1                 PIC 9(7).
               05  QSPB-INSMAXTRM-9-1                 PIC 9(3).
               05  QSPB-INSMINAGE-9-2                 PIC 99.
               05  QSPB-INSMAXAGE-9-2                 PIC 99.
               05  QSPB-INSMAXCOV-9-2                 PIC 9(7).
               05  QSPB-INSMAXTRM-9-2                 PIC 9(3).
               05  QSPB-INSMINAGE-9-3                 PIC 99.
               05  QSPB-INSMAXAGE-9-3                 PIC 99.
               05  QSPB-INSMAXCOV-9-3                 PIC 9(7).
               05  QSPB-INSMAXTRM-9-3                 PIC 9(3).
               05  QSPB-INSMINAGE-9-4                 PIC 99.
               05  QSPB-INSMAXAGE-9-4                 PIC 99.
               05  QSPB-INSMAXCOV-9-4                 PIC 9(7).
               05  QSPB-INSMAXTRM-9-4                 PIC 9(3).
               05  QSPB-INSMINAGE-9-5                 PIC 99.
               05  QSPB-INSMAXAGE-9-5                 PIC 99.
               05  QSPB-INSMAXCOV-9-5                 PIC 9(7).
               05  QSPB-INSMAXTRM-9-5                 PIC 9(3).
               05  QSPB-INSFEECD-9                    PIC XX.
               05  QSPB-INSFEE-FRMLA-9                PIC X.
               05  QSPB-INSCHGABL-FG-9                PIC X.
               05  QSPB-INSREJECT-FG-9                PIC X.
               05  QSPB-INSFINCHG-9                   PIC X.
               05  QSPB-INSCOM-10                     PIC 99.
               05  QSPB-INSRATECD-10                  PIC 999.
               05  QSPB-INSJFAC-10                    PIC 9(4)V99.
               05  QSPB-INSDISCNT-10                  PIC 99V99.
               05  QSPB-INSCHGABL-10                  PIC X(2).
               05  QSPB-INSTERM-10-1                  PIC 9(3).
               05  QSPB-INSRATE-10-1                  PIC 99V9999.
               05  QSPB-INSTERM-10-2                  PIC 9(3).
               05  QSPB-INSRATE-10-2                  PIC 99V9999.
               05  QSPB-INSTERM-10-3                  PIC 9(3).
               05  QSPB-INSRATE-10-3                  PIC 99V9999.
               05  QSPB-INSTERM-10-4                  PIC 9(3).
               05  QSPB-INSRATE-10-4                  PIC 99V9999.
               05  QSPB-INSTERM-10-5                  PIC 9(3).
               05  QSPB-INSRATE-10-5                  PIC 99V9999.
               05  QSPB-INSTERM-10-6                  PIC 9(3).
               05  QSPB-INSRATE-10-6                  PIC 99V9999.
               05  QSPB-INSTERM-10-7                  PIC 9(3).
               05  QSPB-INSRATE-10-7                  PIC 99V9999.
               05  QSPB-INSTERM-10-8                  PIC 9(3).
               05  QSPB-INSRATE-10-8                  PIC 99V9999.
               05  QSPB-INSTERM-10-9                  PIC 9(3).
               05  QSPB-INSRATE-10-9                  PIC 99V9999.
               05  QSPB-INSTERM-10-10                 PIC 9(3).
               05  QSPB-INSRATE-10-10                 PIC 99V9999.
               05  QSPB-INSTERM-10-11                 PIC 9(3).
               05  QSPB-INSRATE-10-11                 PIC 99V9999.
               05  QSPB-INSTERM-10-12                 PIC 9(3).
               05  QSPB-INSRATE-10-12                 PIC 99V9999.
               05  QSPB-INSTERM-10-13                 PIC 9(3).
               05  QSPB-INSRATE-10-13                 PIC 99V9999.
               05  QSPB-INSTERM-10-14                 PIC 9(3).
               05  QSPB-INSRATE-10-14                 PIC 99V9999.
               05  QSPB-INSTERM-10-15                 PIC 9(3).
               05  QSPB-INSRATE-10-15                 PIC 99V9999.
               05  QSPB-INSTERM-10-16                 PIC 9(3).
               05  QSPB-INSRATE-10-16                 PIC 99V9999.
               05  QSPB-INSTERM-10-17                 PIC 9(3).
               05  QSPB-INSRATE-10-17                 PIC 99V9999.
               05  QSPB-INSTERM-10-18                 PIC 9(3).
               05  QSPB-INSRATE-10-18                 PIC 99V9999.
               05  QSPB-INSTERM-10-19                 PIC 9(3).
               05  QSPB-INSRATE-10-19                 PIC 99V9999.
               05  QSPB-INSTERM-10-20                 PIC 9(3).
               05  QSPB-INSRATE-10-20                 PIC 99V9999.
               05  QSPB-INSMINPREM-10                 PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-10               PIC 9(6).
               05  QSPB-INSMAXCHGABL-10               PIC 9(7).
               05  QSPB-INSMAXBENIF-10                PIC 9(7).
               05  QSPB-INSMAXTERM-10                 PIC 9(3).
               05  QSPB-INSCHGBEN-10                  PIC X.
               05  QSPB-INSEXCEPT-10                  PIC 99.
               05  QSPB-INSNOVER-10                   PIC 99.
               05  QSPB-INSMINAGE-10-1                PIC 99.
               05  QSPB-INSMAXAGE-10-1                PIC 99.
               05  QSPB-INSMAXCOV-10-1                PIC 9(7).
               05  QSPB-INSMAXTRM-10-1                PIC 9(3).
               05  QSPB-INSMINAGE-10-2                PIC 99.
               05  QSPB-INSMAXAGE-10-2                PIC 99.
               05  QSPB-INSMAXCOV-10-2                PIC 9(7).
               05  QSPB-INSMAXTRM-10-2                PIC 9(3).
               05  QSPB-INSMINAGE-10-3                PIC 99.
               05  QSPB-INSMAXAGE-10-3                PIC 99.
               05  QSPB-INSMAXCOV-10-3                PIC 9(7).
               05  QSPB-INSMAXTRM-10-3                PIC 9(3).
               05  QSPB-INSMINAGE-10-4                PIC 99.
               05  QSPB-INSMAXAGE-10-4                PIC 99.
               05  QSPB-INSMAXCOV-10-4                PIC 9(7).
               05  QSPB-INSMAXTRM-10-4                PIC 9(3).
               05  QSPB-INSMINAGE-10-5                PIC 99.
               05  QSPB-INSMAXAGE-10-5                PIC 99.
               05  QSPB-INSMAXCOV-10-5                PIC 9(7).
               05  QSPB-INSMAXTRM-10-5                PIC 9(3).
               05  QSPB-INSFEECD-10                   PIC XX.
               05  QSPB-INSFEE-FRMLA-10               PIC X.
               05  QSPB-INSCHGABL-FG-10               PIC X.
               05  QSPB-INSREJECT-FG-10               PIC X.
               05  QSPB-INSFINCHG-10                  PIC X.
               05  QSPB-INSCOM-11                     PIC 99.
               05  QSPB-INSRATECD-11                  PIC 999.
               05  QSPB-INSJFAC-11                    PIC 9(4)V99.
               05  QSPB-INSDISCNT-11                  PIC 99V99.
               05  QSPB-INSCHGABL-11                  PIC X(2).
               05  QSPB-INSTERM-11-1                  PIC 9(3).
               05  QSPB-INSRATE-11-1                  PIC 99V9999.
               05  QSPB-INSTERM-11-2                  PIC 9(3).
               05  QSPB-INSRATE-11-2                  PIC 99V9999.
               05  QSPB-INSTERM-11-3                  PIC 9(3).
               05  QSPB-INSRATE-11-3                  PIC 99V9999.
               05  QSPB-INSTERM-11-4                  PIC 9(3).
               05  QSPB-INSRATE-11-4                  PIC 99V9999.
               05  QSPB-INSTERM-11-5                  PIC 9(3).
               05  QSPB-INSRATE-11-5                  PIC 99V9999.
               05  QSPB-INSTERM-11-6                  PIC 9(3).
               05  QSPB-INSRATE-11-6                  PIC 99V9999.
               05  QSPB-INSTERM-11-7                  PIC 9(3).
               05  QSPB-INSRATE-11-7                  PIC 99V9999.
               05  QSPB-INSTERM-11-8                  PIC 9(3).
               05  QSPB-INSRATE-11-8                  PIC 99V9999.
               05  QSPB-INSTERM-11-9                  PIC 9(3).
               05  QSPB-INSRATE-11-9                  PIC 99V9999.
               05  QSPB-INSTERM-11-10                 PIC 9(3).
               05  QSPB-INSRATE-11-10                 PIC 99V9999.
               05  QSPB-INSTERM-11-11                 PIC 9(3).
               05  QSPB-INSRATE-11-11                 PIC 99V9999.
               05  QSPB-INSTERM-11-12                 PIC 9(3).
               05  QSPB-INSRATE-11-12                 PIC 99V9999.
               05  QSPB-INSTERM-11-13                 PIC 9(3).
               05  QSPB-INSRATE-11-13                 PIC 99V9999.
               05  QSPB-INSTERM-11-14                 PIC 9(3).
               05  QSPB-INSRATE-11-14                 PIC 99V9999.
               05  QSPB-INSTERM-11-15                 PIC 9(3).
               05  QSPB-INSRATE-11-15                 PIC 99V9999.
               05  QSPB-INSTERM-11-16                 PIC 9(3).
               05  QSPB-INSRATE-11-16                 PIC 99V9999.
               05  QSPB-INSTERM-11-17                 PIC 9(3).
               05  QSPB-INSRATE-11-17                 PIC 99V9999.
               05  QSPB-INSTERM-11-18                 PIC 9(3).
               05  QSPB-INSRATE-11-18                 PIC 99V9999.
               05  QSPB-INSTERM-11-19                 PIC 9(3).
               05  QSPB-INSRATE-11-19                 PIC 99V9999.
               05  QSPB-INSTERM-11-20                 PIC 9(3).
               05  QSPB-INSRATE-11-20                 PIC 99V9999.
               05  QSPB-INSMINPREM-11                 PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-11               PIC 9(6).
               05  QSPB-INSMAXCHGABL-11               PIC 9(7).
               05  QSPB-INSMAXBENIF-11                PIC 9(7).
               05  QSPB-INSMAXTERM-11                 PIC 9(3).
               05  QSPB-INSCHGBEN-11                  PIC X.
               05  QSPB-INSEXCEPT-11                  PIC 99.
               05  QSPB-INSNOVER-11                   PIC 99.
               05  QSPB-INSMINAGE-11-1                PIC 99.
               05  QSPB-INSMAXAGE-11-1                PIC 99.
               05  QSPB-INSMAXCOV-11-1                PIC 9(7).
               05  QSPB-INSMAXTRM-11-1                PIC 9(3).
               05  QSPB-INSMINAGE-11-2                PIC 99.
               05  QSPB-INSMAXAGE-11-2                PIC 99.
               05  QSPB-INSMAXCOV-11-2                PIC 9(7).
               05  QSPB-INSMAXTRM-11-2                PIC 9(3).
               05  QSPB-INSMINAGE-11-3                PIC 99.
               05  QSPB-INSMAXAGE-11-3                PIC 99.
               05  QSPB-INSMAXCOV-11-3                PIC 9(7).
               05  QSPB-INSMAXTRM-11-3                PIC 9(3).
               05  QSPB-INSMINAGE-11-4                PIC 99.
               05  QSPB-INSMAXAGE-11-4                PIC 99.
               05  QSPB-INSMAXCOV-11-4                PIC 9(7).
               05  QSPB-INSMAXTRM-11-4                PIC 9(3).
               05  QSPB-INSMINAGE-11-5                PIC 99.
               05  QSPB-INSMAXAGE-11-5                PIC 99.
               05  QSPB-INSMAXCOV-11-5                PIC 9(7).
               05  QSPB-INSMAXTRM-11-5                PIC 9(3).
               05  QSPB-INSFEECD-11                   PIC XX.
               05  QSPB-INSFEE-FRMLA-11               PIC X.
               05  QSPB-INSCHGABL-FG-11               PIC X.
               05  QSPB-INSREJECT-FG-11               PIC X.
               05  QSPB-INSFINCHG-11                  PIC X.
               05  QSPB-INSCOM-12                     PIC 99.
               05  QSPB-INSRATECD-12                  PIC 999.
               05  QSPB-INSJFAC-12                    PIC 9(4)V99.
               05  QSPB-INSDISCNT-12                  PIC 99V99.
               05  QSPB-INSCHGABL-12                  PIC X(2).
               05  QSPB-INSTERM-12-1                  PIC 9(3).
               05  QSPB-INSRATE-12-1                  PIC 99V9999.
               05  QSPB-INSTERM-12-2                  PIC 9(3).
               05  QSPB-INSRATE-12-2                  PIC 99V9999.
               05  QSPB-INSTERM-12-3                  PIC 9(3).
               05  QSPB-INSRATE-12-3                  PIC 99V9999.
               05  QSPB-INSTERM-12-4                  PIC 9(3).
               05  QSPB-INSRATE-12-4                  PIC 99V9999.
               05  QSPB-INSTERM-12-5                  PIC 9(3).
               05  QSPB-INSRATE-12-5                  PIC 99V9999.
               05  QSPB-INSTERM-12-6                  PIC 9(3).
               05  QSPB-INSRATE-12-6                  PIC 99V9999.
               05  QSPB-INSTERM-12-7                  PIC 9(3).
               05  QSPB-INSRATE-12-7                  PIC 99V9999.
               05  QSPB-INSTERM-12-8                  PIC 9(3).
               05  QSPB-INSRATE-12-8                  PIC 99V9999.
               05  QSPB-INSTERM-12-9                  PIC 9(3).
               05  QSPB-INSRATE-12-9                  PIC 99V9999.
               05  QSPB-INSTERM-12-10                 PIC 9(3).
               05  QSPB-INSRATE-12-10                 PIC 99V9999.
               05  QSPB-INSTERM-12-11                 PIC 9(3).
               05  QSPB-INSRATE-12-11                 PIC 99V9999.
               05  QSPB-INSTERM-12-12                 PIC 9(3).
               05  QSPB-INSRATE-12-12                 PIC 99V9999.
               05  QSPB-INSTERM-12-13                 PIC 9(3).
               05  QSPB-INSRATE-12-13                 PIC 99V9999.
               05  QSPB-INSTERM-12-14                 PIC 9(3).
               05  QSPB-INSRATE-12-14                 PIC 99V9999.
               05  QSPB-INSTERM-12-15                 PIC 9(3).
               05  QSPB-INSRATE-12-15                 PIC 99V9999.
               05  QSPB-INSTERM-12-16                 PIC 9(3).
               05  QSPB-INSRATE-12-16                 PIC 99V9999.
               05  QSPB-INSTERM-12-17                 PIC 9(3).
               05  QSPB-INSRATE-12-17                 PIC 99V9999.
               05  QSPB-INSTERM-12-18                 PIC 9(3).
               05  QSPB-INSRATE-12-18                 PIC 99V9999.
               05  QSPB-INSTERM-12-19                 PIC 9(3).
               05  QSPB-INSRATE-12-19                 PIC 99V9999.
               05  QSPB-INSTERM-12-20                 PIC 9(3).
               05  QSPB-INSRATE-12-20                 PIC 99V9999.
               05  QSPB-INSMINPREM-12                 PIC 9(4)V99.
               05  QSPB-INSMINCHGABL-12               PIC 9(6).
               05  QSPB-INSMAXCHGABL-12               PIC 9(7).
               05  QSPB-INSMAXBENIF-12                PIC 9(7).
               05  QSPB-INSMAXTERM-12                 PIC 9(3).
               05  QSPB-INSCHGBEN-12                  PIC X.
               05  QSPB-INSEXCEPT-12                  PIC 99.
               05  QSPB-INSNOVER-12                   PIC 99.
               05  QSPB-INSMINAGE-12-1                PIC 99.
               05  QSPB-INSMAXAGE-12-1                PIC 99.
               05  QSPB-INSMAXCOV-12-1                PIC 9(7).
               05  QSPB-INSMAXTRM-12-1                PIC 9(3).
               05  QSPB-INSMINAGE-12-2                PIC 99.
               05  QSPB-INSMAXAGE-12-2                PIC 99.
               05  QSPB-INSMAXCOV-12-2                PIC 9(7).
               05  QSPB-INSMAXTRM-12-2                PIC 9(3).
               05  QSPB-INSMINAGE-12-3                PIC 99.
               05  QSPB-INSMAXAGE-12-3                PIC 99.
               05  QSPB-INSMAXCOV-12-3                PIC 9(7).
               05  QSPB-INSMAXTRM-12-3                PIC 9(3).
               05  QSPB-INSMINAGE-12-4                PIC 99.
               05  QSPB-INSMAXAGE-12-4                PIC 99.
               05  QSPB-INSMAXCOV-12-4                PIC 9(7).
               05  QSPB-INSMAXTRM-12-4                PIC 9(3).
               05  QSPB-INSMINAGE-12-5                PIC 99.
               05  QSPB-INSMAXAGE-12-5                PIC 99.
               05  QSPB-INSMAXCOV-12-5                PIC 9(7).
               05  QSPB-INSMAXTRM-12-5                PIC 9(3).
               05  QSPB-INSFEECD-12                   PIC XX.
               05  QSPB-INSFEE-FRMLA-12               PIC X.
               05  QSPB-INSCHGABL-FG-12               PIC X.
               05  QSPB-INSREJECT-FG-12               PIC X.
               05  QSPB-INSFINCHG-12                  PIC X.
           03  QSPC-REC.
               05  QSPC-ORGST                         PIC XX.
               05  QSPC-SPRCLASS                      PIC 999.
               05  QSPC-SUBCLASS                      PIC 99.
               05  QSPC-LAWCODE                       PIC 99.
               05  QSPC-INSEARN-ORDER-1               PIC 9(2).
               05  QSPC-INSEARN-ORDER-2               PIC 9(2).
               05  QSPC-INSEARN-ORDER-3               PIC 9(2).
               05  QSPC-INSEARN-ORDER-4               PIC 9(2).
               05  QSPC-INSEARN-ORDER-5               PIC 9(2).
               05  QSPC-INSEARN-ORDER-6               PIC 9(2).
               05  QSPC-INSEARN-ORDER-7               PIC 9(2).
               05  QSPC-INSEARN-ORDER-8               PIC 9(2).
               05  QSPC-INSEARN-ORDER-9               PIC 9(2).
               05  QSPC-INSEARN-ORDER-10              PIC 9(2).
               05  QSPC-INSEARN-ORDER-11              PIC 9(2).
               05  QSPC-INSEARN-ORDER-12              PIC 9(2).
               05  QSPC-INSAH-JOINT-FG                PIC X.
               05  QSPC-INS-O1-EDIT                   PIC X.
               05  QSPC-INS-O2-EDIT                   PIC X.
               05  QSPC-RBFRMLA-1                     PIC X(2).
               05  QSPC-RBDTE-1-1                     PIC X.
               05  QSPC-RBDAYS-1-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-1-1                  PIC 9(4).
               05  QSPC-RBDTE-1-2                     PIC X.
               05  QSPC-RBDAYS-1-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-1-2                  PIC 9(4).
               05  QSPC-RBMINRET-1                    PIC 9999V99.
               05  QSPC-RBNOMON-1                     PIC 9(2).
               05  QSPC-RBDEDCHG-1                    PIC 9999V99.
               05  QSPC-RBRECAST-1                    PIC 9(2).
               05  QSPC-RBEARLY-1                     PIC 9(2).
               05  QSPC-RBDEFER-1                     PIC 9(2).
               05  QSPC-RBPCT-1                       PIC 9(3)V9.
               05  QSPC-RBREDUC-1                     PIC 9(4)V99.
               05  QSPC-RBMIN-1                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-1                    PIC 9(2).
               05  QSPC-RBSPOPT2-1                    PIC 9(2).
               05  QSPC-RBMANAGER-1                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-1                PIC X.
               05  QSPC-RBFRMLA2-1                    PIC X(2).
               05  QSPC-RBFRMLA-2                     PIC X(2).
               05  QSPC-RBDTE-2-1                     PIC X.
               05  QSPC-RBDAYS-2-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-2-1                  PIC 9(4).
               05  QSPC-RBDTE-2-2                     PIC X.
               05  QSPC-RBDAYS-2-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-2-2                  PIC 9(4).
               05  QSPC-RBMINRET-2                    PIC 9999V99.
               05  QSPC-RBNOMON-2                     PIC 9(2).
               05  QSPC-RBDEDCHG-2                    PIC 9999V99.
               05  QSPC-RBRECAST-2                    PIC 9(2).
               05  QSPC-RBEARLY-2                     PIC 9(2).
               05  QSPC-RBDEFER-2                     PIC 9(2).
               05  QSPC-RBPCT-2                       PIC 9(3)V9.
               05  QSPC-RBREDUC-2                     PIC 9(4)V99.
               05  QSPC-RBMIN-2                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-2                    PIC 9(2).
               05  QSPC-RBSPOPT2-2                    PIC 9(2).
               05  QSPC-RBMANAGER-2                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-2                PIC X.
               05  QSPC-RBFRMLA2-2                    PIC X(2).
               05  QSPC-RBFRMLA-3                     PIC X(2).
               05  QSPC-RBDTE-3-1                     PIC X.
               05  QSPC-RBDAYS-3-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-3-1                  PIC 9(4).
               05  QSPC-RBDTE-3-2                     PIC X.
               05  QSPC-RBDAYS-3-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-3-2                  PIC 9(4).
               05  QSPC-RBMINRET-3                    PIC 9999V99.
               05  QSPC-RBNOMON-3                     PIC 9(2).
               05  QSPC-RBDEDCHG-3                    PIC 9999V99.
               05  QSPC-RBRECAST-3                    PIC 9(2).
               05  QSPC-RBEARLY-3                     PIC 9(2).
               05  QSPC-RBDEFER-3                     PIC 9(2).
               05  QSPC-RBPCT-3                       PIC 9(3)V9.
               05  QSPC-RBREDUC-3                     PIC 9(4)V99.
               05  QSPC-RBMIN-3                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-3                    PIC 9(2).
               05  QSPC-RBSPOPT2-3                    PIC 9(2).
               05  QSPC-RBMANAGER-3                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-3                PIC X.
               05  QSPC-RBFRMLA2-3                    PIC X(2).
               05  QSPC-RBFRMLA-4                     PIC X(2).
               05  QSPC-RBDTE-4-1                     PIC X.
               05  QSPC-RBDAYS-4-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-4-1                  PIC 9(4).
               05  QSPC-RBDTE-4-2                     PIC X.
               05  QSPC-RBDAYS-4-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-4-2                  PIC 9(4).
               05  QSPC-RBMINRET-4                    PIC 9999V99.
               05  QSPC-RBNOMON-4                     PIC 9(2).
               05  QSPC-RBDEDCHG-4                    PIC 9999V99.
               05  QSPC-RBRECAST-4                    PIC 9(2).
               05  QSPC-RBEARLY-4                     PIC 9(2).
               05  QSPC-RBDEFER-4                     PIC 9(2).
               05  QSPC-RBPCT-4                       PIC 9(3)V9.
               05  QSPC-RBREDUC-4                     PIC 9(4)V99.
               05  QSPC-RBMIN-4                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-4                    PIC 9(2).
               05  QSPC-RBSPOPT2-4                    PIC 9(2).
               05  QSPC-RBMANAGER-4                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-4                PIC X.
               05  QSPC-RBFRMLA2-4                    PIC X(2).
               05  QSPC-RBFRMLA-5                     PIC X(2).
               05  QSPC-RBDTE-5-1                     PIC X.
               05  QSPC-RBDAYS-5-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-5-1                  PIC 9(4).
               05  QSPC-RBDTE-5-2                     PIC X.
               05  QSPC-RBDAYS-5-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-5-2                  PIC 9(4).
               05  QSPC-RBMINRET-5                    PIC 9999V99.
               05  QSPC-RBNOMON-5                     PIC 9(2).
               05  QSPC-RBDEDCHG-5                    PIC 9999V99.
               05  QSPC-RBRECAST-5                    PIC 9(2).
               05  QSPC-RBEARLY-5                     PIC 9(2).
               05  QSPC-RBDEFER-5                     PIC 9(2).
               05  QSPC-RBPCT-5                       PIC 9(3)V9.
               05  QSPC-RBREDUC-5                     PIC 9(4)V99.
               05  QSPC-RBMIN-5                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-5                    PIC 9(2).
               05  QSPC-RBSPOPT2-5                    PIC 9(2).
               05  QSPC-RBMANAGER-5                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-5                PIC X.
               05  QSPC-RBFRMLA2-5                    PIC X(2).
               05  QSPC-RBFRMLA-6                     PIC X(2).
               05  QSPC-RBDTE-6-1                     PIC X.
               05  QSPC-RBDAYS-6-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-6-1                  PIC 9(4).
               05  QSPC-RBDTE-6-2                     PIC X.
               05  QSPC-RBDAYS-6-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-6-2                  PIC 9(4).
               05  QSPC-RBMINRET-6                    PIC 9999V99.
               05  QSPC-RBNOMON-6                     PIC 9(2).
               05  QSPC-RBDEDCHG-6                    PIC 9999V99.
               05  QSPC-RBRECAST-6                    PIC 9(2).
               05  QSPC-RBEARLY-6                     PIC 9(2).
               05  QSPC-RBDEFER-6                     PIC 9(2).
               05  QSPC-RBPCT-6                       PIC 9(3)V9.
               05  QSPC-RBREDUC-6                     PIC 9(4)V99.
               05  QSPC-RBMIN-6                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-6                    PIC 9(2).
               05  QSPC-RBSPOPT2-6                    PIC 9(2).
               05  QSPC-RBMANAGER-6                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-6                PIC X.
               05  QSPC-RBFRMLA2-6                    PIC X(2).
               05  QSPC-RBFRMLA-7                     PIC X(2).
               05  QSPC-RBDTE-7-1                     PIC X.
               05  QSPC-RBDAYS-7-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-7-1                  PIC 9(4).
               05  QSPC-RBDTE-7-2                     PIC X.
               05  QSPC-RBDAYS-7-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-7-2                  PIC 9(4).
               05  QSPC-RBMINRET-7                    PIC 9999V99.
               05  QSPC-RBNOMON-7                     PIC 9(2).
               05  QSPC-RBDEDCHG-7                    PIC 9999V99.
               05  QSPC-RBRECAST-7                    PIC 9(2).
               05  QSPC-RBEARLY-7                     PIC 9(2).
               05  QSPC-RBDEFER-7                     PIC 9(2).
               05  QSPC-RBPCT-7                       PIC 9(3)V9.
               05  QSPC-RBREDUC-7                     PIC 9(4)V99.
               05  QSPC-RBMIN-7                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-7                    PIC 9(2).
               05  QSPC-RBSPOPT2-7                    PIC 9(2).
               05  QSPC-RBMANAGER-7                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-7                PIC X.
               05  QSPC-RBFRMLA2-7                    PIC X(2).
               05  QSPC-RBFRMLA-8                     PIC X(2).
               05  QSPC-RBDTE-8-1                     PIC X.
               05  QSPC-RBDAYS-8-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-8-1                  PIC 9(4).
               05  QSPC-RBDTE-8-2                     PIC X.
               05  QSPC-RBDAYS-8-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-8-2                  PIC 9(4).
               05  QSPC-RBMINRET-8                    PIC 9999V99.
               05  QSPC-RBNOMON-8                     PIC 9(2).
               05  QSPC-RBDEDCHG-8                    PIC 9999V99.
               05  QSPC-RBRECAST-8                    PIC 9(2).
               05  QSPC-RBEARLY-8                     PIC 9(2).
               05  QSPC-RBDEFER-8                     PIC 9(2).
               05  QSPC-RBPCT-8                       PIC 9(3)V9.
               05  QSPC-RBREDUC-8                     PIC 9(4)V99.
               05  QSPC-RBMIN-8                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-8                    PIC 9(2).
               05  QSPC-RBSPOPT2-8                    PIC 9(2).
               05  QSPC-RBMANAGER-8                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-8                PIC X.
               05  QSPC-RBFRMLA2-8                    PIC X(2).
               05  QSPC-RBFRMLA-9                     PIC X(2).
               05  QSPC-RBDTE-9-1                     PIC X.
               05  QSPC-RBDAYS-9-1                    PIC 9(2).
               05  QSPC-RBYRTYPE-9-1                  PIC 9(4).
               05  QSPC-RBDTE-9-2                     PIC X.
               05  QSPC-RBDAYS-9-2                    PIC 9(2).
               05  QSPC-RBYRTYPE-9-2                  PIC 9(4).
               05  QSPC-RBMINRET-9                    PIC 9999V99.
               05  QSPC-RBNOMON-9                     PIC 9(2).
               05  QSPC-RBDEDCHG-9                    PIC 9999V99.
               05  QSPC-RBRECAST-9                    PIC 9(2).
               05  QSPC-RBEARLY-9                     PIC 9(2).
               05  QSPC-RBDEFER-9                     PIC 9(2).
               05  QSPC-RBPCT-9                       PIC 9(3)V9.
               05  QSPC-RBREDUC-9                     PIC 9(4)V99.
               05  QSPC-RBMIN-9                       PIC 9(4)V99.
               05  QSPC-RBSPOPT1-9                    PIC 9(2).
               05  QSPC-RBSPOPT2-9                    PIC 9(2).
               05  QSPC-RBMANAGER-9                   PIC 9(2).
               05  QSPC-RBUNITPER-CD-9                PIC X.
               05  QSPC-RBFRMLA2-9                    PIC X(2).
               05  QSPC-RBFRMLA-10                    PIC X(2).
               05  QSPC-RBDTE-10-1                    PIC X.
               05  QSPC-RBDAYS-10-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-10-1                 PIC 9(4).
               05  QSPC-RBDTE-10-2                    PIC X.
               05  QSPC-RBDAYS-10-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-10-2                 PIC 9(4).
               05  QSPC-RBMINRET-10                   PIC 9999V99.
               05  QSPC-RBNOMON-10                    PIC 9(2).
               05  QSPC-RBDEDCHG-10                   PIC 9999V99.
               05  QSPC-RBRECAST-10                   PIC 9(2).
               05  QSPC-RBEARLY-10                    PIC 9(2).
               05  QSPC-RBDEFER-10                    PIC 9(2).
               05  QSPC-RBPCT-10                      PIC 9(3)V9.
               05  QSPC-RBREDUC-10                    PIC 9(4)V99.
               05  QSPC-RBMIN-10                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-10                   PIC 9(2).
               05  QSPC-RBSPOPT2-10                   PIC 9(2).
               05  QSPC-RBMANAGER-10                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-10               PIC X.
               05  QSPC-RBFRMLA2-10                   PIC X(2).
               05  QSPC-RBFRMLA-11                    PIC X(2).
               05  QSPC-RBDTE-11-1                    PIC X.
               05  QSPC-RBDAYS-11-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-11-1                 PIC 9(4).
               05  QSPC-RBDTE-11-2                    PIC X.
               05  QSPC-RBDAYS-11-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-11-2                 PIC 9(4).
               05  QSPC-RBMINRET-11                   PIC 9999V99.
               05  QSPC-RBNOMON-11                    PIC 9(2).
               05  QSPC-RBDEDCHG-11                   PIC 9999V99.
               05  QSPC-RBRECAST-11                   PIC 9(2).
               05  QSPC-RBEARLY-11                    PIC 9(2).
               05  QSPC-RBDEFER-11                    PIC 9(2).
               05  QSPC-RBPCT-11                      PIC 9(3)V9.
               05  QSPC-RBREDUC-11                    PIC 9(4)V99.
               05  QSPC-RBMIN-11                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-11                   PIC 9(2).
               05  QSPC-RBSPOPT2-11                   PIC 9(2).
               05  QSPC-RBMANAGER-11                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-11               PIC X.
               05  QSPC-RBFRMLA2-11                   PIC X(2).
               05  QSPC-RBFRMLA-12                    PIC X(2).
               05  QSPC-RBDTE-12-1                    PIC X.
               05  QSPC-RBDAYS-12-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-12-1                 PIC 9(4).
               05  QSPC-RBDTE-12-2                    PIC X.
               05  QSPC-RBDAYS-12-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-12-2                 PIC 9(4).
               05  QSPC-RBMINRET-12                   PIC 9999V99.
               05  QSPC-RBNOMON-12                    PIC 9(2).
               05  QSPC-RBDEDCHG-12                   PIC 9999V99.
               05  QSPC-RBRECAST-12                   PIC 9(2).
               05  QSPC-RBEARLY-12                    PIC 9(2).
               05  QSPC-RBDEFER-12                    PIC 9(2).
               05  QSPC-RBPCT-12                      PIC 9(3)V9.
               05  QSPC-RBREDUC-12                    PIC 9(4)V99.
               05  QSPC-RBMIN-12                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-12                   PIC 9(2).
               05  QSPC-RBSPOPT2-12                   PIC 9(2).
               05  QSPC-RBMANAGER-12                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-12               PIC X.
               05  QSPC-RBFRMLA2-12                   PIC X(2).
               05  QSPC-RBFRMLA-13                    PIC X(2).
               05  QSPC-RBDTE-13-1                    PIC X.
               05  QSPC-RBDAYS-13-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-13-1                 PIC 9(4).
               05  QSPC-RBDTE-13-2                    PIC X.
               05  QSPC-RBDAYS-13-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-13-2                 PIC 9(4).
               05  QSPC-RBMINRET-13                   PIC 9999V99.
               05  QSPC-RBNOMON-13                    PIC 9(2).
               05  QSPC-RBDEDCHG-13                   PIC 9999V99.
               05  QSPC-RBRECAST-13                   PIC 9(2).
               05  QSPC-RBEARLY-13                    PIC 9(2).
               05  QSPC-RBDEFER-13                    PIC 9(2).
               05  QSPC-RBPCT-13                      PIC 9(3)V9.
               05  QSPC-RBREDUC-13                    PIC 9(4)V99.
               05  QSPC-RBMIN-13                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-13                   PIC 9(2).
               05  QSPC-RBSPOPT2-13                   PIC 9(2).
               05  QSPC-RBMANAGER-13                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-13               PIC X.
               05  QSPC-RBFRMLA2-13                   PIC X(2).
               05  QSPC-RBFRMLA-14                    PIC X(2).
               05  QSPC-RBDTE-14-1                    PIC X.
               05  QSPC-RBDAYS-14-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-14-1                 PIC 9(4).
               05  QSPC-RBDTE-14-2                    PIC X.
               05  QSPC-RBDAYS-14-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-14-2                 PIC 9(4).
               05  QSPC-RBMINRET-14                   PIC 9999V99.
               05  QSPC-RBNOMON-14                    PIC 9(2).
               05  QSPC-RBDEDCHG-14                   PIC 9999V99.
               05  QSPC-RBRECAST-14                   PIC 9(2).
               05  QSPC-RBEARLY-14                    PIC 9(2).
               05  QSPC-RBDEFER-14                    PIC 9(2).
               05  QSPC-RBPCT-14                      PIC 9(3)V9.
               05  QSPC-RBREDUC-14                    PIC 9(4)V99.
               05  QSPC-RBMIN-14                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-14                   PIC 9(2).
               05  QSPC-RBSPOPT2-14                   PIC 9(2).
               05  QSPC-RBMANAGER-14                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-14               PIC X.
               05  QSPC-RBFRMLA2-14                   PIC X(2).
               05  QSPC-RBFRMLA-15                    PIC X(2).
               05  QSPC-RBDTE-15-1                    PIC X.
               05  QSPC-RBDAYS-15-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-15-1                 PIC 9(4).
               05  QSPC-RBDTE-15-2                    PIC X.
               05  QSPC-RBDAYS-15-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-15-2                 PIC 9(4).
               05  QSPC-RBMINRET-15                   PIC 9999V99.
               05  QSPC-RBNOMON-15                    PIC 9(2).
               05  QSPC-RBDEDCHG-15                   PIC 9999V99.
               05  QSPC-RBRECAST-15                   PIC 9(2).
               05  QSPC-RBEARLY-15                    PIC 9(2).
               05  QSPC-RBDEFER-15                    PIC 9(2).
               05  QSPC-RBPCT-15                      PIC 9(3)V9.
               05  QSPC-RBREDUC-15                    PIC 9(4)V99.
               05  QSPC-RBMIN-15                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-15                   PIC 9(2).
               05  QSPC-RBSPOPT2-15                   PIC 9(2).
               05  QSPC-RBMANAGER-15                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-15               PIC X.
               05  QSPC-RBFRMLA2-15                   PIC X(2).
               05  QSPC-RBFRMLA-16                    PIC X(2).
               05  QSPC-RBDTE-16-1                    PIC X.
               05  QSPC-RBDAYS-16-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-16-1                 PIC 9(4).
               05  QSPC-RBDTE-16-2                    PIC X.
               05  QSPC-RBDAYS-16-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-16-2                 PIC 9(4).
               05  QSPC-RBMINRET-16                   PIC 9999V99.
               05  QSPC-RBNOMON-16                    PIC 9(2).
               05  QSPC-RBDEDCHG-16                   PIC 9999V99.
               05  QSPC-RBRECAST-16                   PIC 9(2).
               05  QSPC-RBEARLY-16                    PIC 9(2).
               05  QSPC-RBDEFER-16                    PIC 9(2).
               05  QSPC-RBPCT-16                      PIC 9(3)V9.
               05  QSPC-RBREDUC-16                    PIC 9(4)V99.
               05  QSPC-RBMIN-16                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-16                   PIC 9(2).
               05  QSPC-RBSPOPT2-16                   PIC 9(2).
               05  QSPC-RBMANAGER-16                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-16               PIC X.
               05  QSPC-RBFRMLA2-16                   PIC X(2).
               05  QSPC-RBFRMLA-17                    PIC X(2).
               05  QSPC-RBDTE-17-1                    PIC X.
               05  QSPC-RBDAYS-17-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-17-1                 PIC 9(4).
               05  QSPC-RBDTE-17-2                    PIC X.
               05  QSPC-RBDAYS-17-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-17-2                 PIC 9(4).
               05  QSPC-RBMINRET-17                   PIC 9999V99.
               05  QSPC-RBNOMON-17                    PIC 9(2).
               05  QSPC-RBDEDCHG-17                   PIC 9999V99.
               05  QSPC-RBRECAST-17                   PIC 9(2).
               05  QSPC-RBEARLY-17                    PIC 9(2).
               05  QSPC-RBDEFER-17                    PIC 9(2).
               05  QSPC-RBPCT-17                      PIC 9(3)V9.
               05  QSPC-RBREDUC-17                    PIC 9(4)V99.
               05  QSPC-RBMIN-17                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-17                   PIC 9(2).
               05  QSPC-RBSPOPT2-17                   PIC 9(2).
               05  QSPC-RBMANAGER-17                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-17               PIC X.
               05  QSPC-RBFRMLA2-17                   PIC X(2).
               05  QSPC-RBFRMLA-18                    PIC X(2).
               05  QSPC-RBDTE-18-1                    PIC X.
               05  QSPC-RBDAYS-18-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-18-1                 PIC 9(4).
               05  QSPC-RBDTE-18-2                    PIC X.
               05  QSPC-RBDAYS-18-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-18-2                 PIC 9(4).
               05  QSPC-RBMINRET-18                   PIC 9999V99.
               05  QSPC-RBNOMON-18                    PIC 9(2).
               05  QSPC-RBDEDCHG-18                   PIC 9999V99.
               05  QSPC-RBRECAST-18                   PIC 9(2).
               05  QSPC-RBEARLY-18                    PIC 9(2).
               05  QSPC-RBDEFER-18                    PIC 9(2).
               05  QSPC-RBPCT-18                      PIC 9(3)V9.
               05  QSPC-RBREDUC-18                    PIC 9(4)V99.
               05  QSPC-RBMIN-18                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-18                   PIC 9(2).
               05  QSPC-RBSPOPT2-18                   PIC 9(2).
               05  QSPC-RBMANAGER-18                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-18               PIC X.
               05  QSPC-RBFRMLA2-18                   PIC X(2).
               05  QSPC-RBFRMLA-19                    PIC X(2).
               05  QSPC-RBDTE-19-1                    PIC X.
               05  QSPC-RBDAYS-19-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-19-1                 PIC 9(4).
               05  QSPC-RBDTE-19-2                    PIC X.
               05  QSPC-RBDAYS-19-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-19-2                 PIC 9(4).
               05  QSPC-RBMINRET-19                   PIC 9999V99.
               05  QSPC-RBNOMON-19                    PIC 9(2).
               05  QSPC-RBDEDCHG-19                   PIC 9999V99.
               05  QSPC-RBRECAST-19                   PIC 9(2).
               05  QSPC-RBEARLY-19                    PIC 9(2).
               05  QSPC-RBDEFER-19                    PIC 9(2).
               05  QSPC-RBPCT-19                      PIC 9(3)V9.
               05  QSPC-RBREDUC-19                    PIC 9(4)V99.
               05  QSPC-RBMIN-19                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-19                   PIC 9(2).
               05  QSPC-RBSPOPT2-19                   PIC 9(2).
               05  QSPC-RBMANAGER-19                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-19               PIC X.
               05  QSPC-RBFRMLA2-19                   PIC X(2).
               05  QSPC-RBFRMLA-20                    PIC X(2).
               05  QSPC-RBDTE-20-1                    PIC X.
               05  QSPC-RBDAYS-20-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-20-1                 PIC 9(4).
               05  QSPC-RBDTE-20-2                    PIC X.
               05  QSPC-RBDAYS-20-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-20-2                 PIC 9(4).
               05  QSPC-RBMINRET-20                   PIC 9999V99.
               05  QSPC-RBNOMON-20                    PIC 9(2).
               05  QSPC-RBDEDCHG-20                   PIC 9999V99.
               05  QSPC-RBRECAST-20                   PIC 9(2).
               05  QSPC-RBEARLY-20                    PIC 9(2).
               05  QSPC-RBDEFER-20                    PIC 9(2).
               05  QSPC-RBPCT-20                      PIC 9(3)V9.
               05  QSPC-RBREDUC-20                    PIC 9(4)V99.
               05  QSPC-RBMIN-20                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-20                   PIC 9(2).
               05  QSPC-RBSPOPT2-20                   PIC 9(2).
               05  QSPC-RBMANAGER-20                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-20               PIC X.
               05  QSPC-RBFRMLA2-20                   PIC X(2).
               05  QSPC-RBFRMLA-21                    PIC X(2).
               05  QSPC-RBDTE-21-1                    PIC X.
               05  QSPC-RBDAYS-21-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-21-1                 PIC 9(4).
               05  QSPC-RBDTE-21-2                    PIC X.
               05  QSPC-RBDAYS-21-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-21-2                 PIC 9(4).
               05  QSPC-RBMINRET-21                   PIC 9999V99.
               05  QSPC-RBNOMON-21                    PIC 9(2).
               05  QSPC-RBDEDCHG-21                   PIC 9999V99.
               05  QSPC-RBRECAST-21                   PIC 9(2).
               05  QSPC-RBEARLY-21                    PIC 9(2).
               05  QSPC-RBDEFER-21                    PIC 9(2).
               05  QSPC-RBPCT-21                      PIC 9(3)V9.
               05  QSPC-RBREDUC-21                    PIC 9(4)V99.
               05  QSPC-RBMIN-21                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-21                   PIC 9(2).
               05  QSPC-RBSPOPT2-21                   PIC 9(2).
               05  QSPC-RBMANAGER-21                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-21               PIC X.
               05  QSPC-RBFRMLA2-21                   PIC X(2).
               05  QSPC-RBFRMLA-22                    PIC X(2).
               05  QSPC-RBDTE-22-1                    PIC X.
               05  QSPC-RBDAYS-22-1                   PIC 9(2).
               05  QSPC-RBYRTYPE-22-1                 PIC 9(4).
               05  QSPC-RBDTE-22-2                    PIC X.
               05  QSPC-RBDAYS-22-2                   PIC 9(2).
               05  QSPC-RBYRTYPE-22-2                 PIC 9(4).
               05  QSPC-RBMINRET-22                   PIC 9999V99.
               05  QSPC-RBNOMON-22                    PIC 9(2).
               05  QSPC-RBDEDCHG-22                   PIC 9999V99.
               05  QSPC-RBRECAST-22                   PIC 9(2).
               05  QSPC-RBEARLY-22                    PIC 9(2).
               05  QSPC-RBDEFER-22                    PIC 9(2).
               05  QSPC-RBPCT-22                      PIC 9(3)V9.
               05  QSPC-RBREDUC-22                    PIC 9(4)V99.
               05  QSPC-RBMIN-22                      PIC 9(4)V99.
               05  QSPC-RBSPOPT1-22                   PIC 9(2).
               05  QSPC-RBSPOPT2-22                   PIC 9(2).
               05  QSPC-RBMANAGER-22                  PIC 9(2).
               05  QSPC-RBUNITPER-CD-22               PIC X.
               05  QSPC-RBFRMLA2-22                   PIC X(2).
               05  QSPC-RBCOMCD                       PIC X.
               05  QSPC-ADDON-DISFRMLA                PIC X.
               05  QSPC-ADDON-WHOLE-FG                PIC X.
               05  QSPC-ADDON-ORG-MATURITY            PIC X.
               05  QSPC-CONSOLIDATE-RT-FG             PIC X.
               05  QSPC-1STPY-ADDON-DAYS              PIC 9(3).
               05  QSPC-1STPY-ADDON-YRTYPE            PIC 9(3).
               05  QSPC-ADDON-RATE-FG                 PIC X.
               05  QSPC-ADDON-RATE                    PIC 999V999.
               05  QSPC-FEEFRMLA-1                    PIC X.
               05  QSPC-FEECD-1                       PIC XX.
               05  QSPC-FEEID-1                       PIC X(7).
               05  QSPC-FEEFRMLA-2                    PIC X.
               05  QSPC-FEECD-2                       PIC XX.
               05  QSPC-FEEID-2                       PIC X(7).
               05  QSPC-ROUND-PAY-FG                  PIC X.
               05  QSPC-IRREGULAR-PAY-FG              PIC X.
               05  QSPC-DLRVCHGS-RB-CD-1              PIC X.
               05  QSPC-DLRVCHGS-RB-CD-2              PIC X.
               05  QSPC-DLRVCHGS-RB-CD-3              PIC X.
               05  QSPC-PARVHELD-RB-CD                PIC X.
               05  QSPC-PARVPAID-RB-CD                PIC X.
               05  QSPC-CONTR-CREDIT                  PIC 99V99.
               05  QSPC-CONTR-CREDIT-CD               PIC X.
               05  QSPC-CONTR-CREDIT-MIN-DEL-PER      PIC 999V9.
               05  QSPC-OPT-CAL-CHGABLE               PIC X.
               05  QSPC-PBDEL-DAYS                    PIC S999.
               05  QSPC-PBINCR-PERCENT                PIC 999.
               05  QSPC-CPOT30-CD                     PIC X.
               05  QSPC-CPOTCHGOFF-CD                 PIC X.
               05  QSPC-RDPOT30-CD                    PIC X.
               05  QSPC-RDPOTCHGOFF-CD                PIC X.
               05  QSPC-MAX-ALLOW-DELINQ              PIC 99.
               05  QSPC-RESCIND-BUS-DAYS              PIC X.
               05  QSPC-RESCIND-SATURDAY              PIC X.
               05  QSPC-MIN-CREDIT-SCORE              PIC 9(4).
               05  QSPC-DUAL-IN-BRANCH                PIC X.
               05  QSPC-DUAL-IN-STATE                 PIC X.
               05  QSPC-PACESETTER-FG                 PIC X.
               05  QSPC-WAGE-ASSIGN-DAYS              PIC 99.
               05  QSPC-CAL-PAYMENT-ROUND-FG          PIC X.
               05  QSPC-CAN-LOANS-FG                  PIC X.
               05  QSPC-ALLOW-DELINQ-POLCD            PIC X.
               05  QSPC-YTD-MAX-ALLOW-DELINQ          PIC 99.
               05  QSPC-LNCOST-FRMLA                  PIC X.
               05  QSPC-LNCOST-AMT                    PIC 9(7)V99.
               05  QSPC-DLDISC-RVPRIN1-PCNT           PIC 9(3)V99.
               05  QSPC-RENEWABLE-PAYS                PIC S9(4).
               05  QSPC-RENEWABLE-DAYS                PIC S9(4).
               05  QSPC-ALLOW-LN-BACK-DATE            PIC X.
               05  QSPC-DLDISC-RVPRIN1-AF-PCNT        PIC 9(3)V99.
               05  QSPC-CAL-MAX-AT-ESTIMATE           PIC X.
               05  QSPC-INSAH-RETRO                   PIC X.
               05  QSPC-INSAH-DAYS-WAIT               PIC XX.
               05  QSPC-ADDON-EXCEPT-FG               PIC X.
               05  QSPC-REPO-TRCD-1                   PIC X(02).
               05  QSPC-REPO-FMNO-1-1                 PIC 9(03).
               05  QSPC-REPO-FMNO-1-2                 PIC 9(03).
               05  QSPC-REPO-FMNO-1-3                 PIC 9(03).
               05  QSPC-REPO-FMNO-1-4                 PIC 9(03).
               05  QSPC-REPO-TRCD-2                   PIC X(02).
               05  QSPC-REPO-FMNO-2-1                 PIC 9(03).
               05  QSPC-REPO-FMNO-2-2                 PIC 9(03).
               05  QSPC-REPO-FMNO-2-3                 PIC 9(03).
               05  QSPC-REPO-FMNO-2-4                 PIC 9(03).
               05  QSPC-REPO-TRCD-3                   PIC X(02).
               05  QSPC-REPO-FMNO-3-1                 PIC 9(03).
               05  QSPC-REPO-FMNO-3-2                 PIC 9(03).
               05  QSPC-REPO-FMNO-3-3                 PIC 9(03).
               05  QSPC-REPO-FMNO-3-4                 PIC 9(03).
               05  QSPC-CANCEL-ADDON-FG               PIC X.
               05  QSPC-DEFAULT-O2-INS-COMP           PIC 9(2).
               05  QSPC-LC-ON-JUDGEMENTS              PIC X.
               05  QSPC-DELQ-IB-AGE                   PIC 999.
               05  QSPC-DELQ-IB-MAX-DAYS              PIC 999.
               05  QSPC-INSURANCE-WRITTEN             PIC X.
               05  QSPC-INTERIM-COUPON                PIC X.
               05  QSPC-AUTO-ASSESS-LCHG              PIC X.
               05  QSPC-MAX-CASH-PROCEEDS             PIC 9(6)V99.
               05  QSPC-ALLOW-ZERO-PROC               PIC X.
               05  QSPC-BANKRULE-RATE                 PIC 9(4).
               05  QSPC-AUTO-SEND-TRCD-1              PIC X(02).
               05  QSPC-AUTO-SEND-FMNO-1-1            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-1-2            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-1-3            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-1-4            PIC 9(03).
               05  QSPC-AUTO-SEND-TRCD-2              PIC X(02).
               05  QSPC-AUTO-SEND-FMNO-2-1            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-2-2            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-2-3            PIC 9(03).
               05  QSPC-AUTO-SEND-FMNO-2-4            PIC 9(03).
               05  QSPC-DLDISC-CONV-BF-PCNT           PIC 999V999.
               05  QSPC-UNITPER-CD                    PIC X.
               05  QSPC-RENEWAL-EDIT                  PIC X.
               05  QSPC-ROUND-MFEE                    PIC X.
               05  QSPC-ADV-TO-1ST-NO-CORR            PIC X.
               05  QSPC-LC-INT-ON-REPO-NON-PL         PIC X.
               05  QSPC-CONTRACTUAL-SET-NONACCRUAL    PIC 9(3).
               05  QSPC-CONTRACTUAL-RESET-ACCRUAL     PIC 9(3).
               05  QSPC-MONTHS-PAY-NAPP-COUNTER       PIC 99.
               05  QSPC-SHORT-PAY-THRESHOLD           PIC 9(3).
               05  QSPC-CASH-AVAIL-PERCENT            PIC 99.
               05  QSPC-O1-JOINT-FG                   PIC X.
               05  QSPC-NET-BAL-REQ                   PIC S9(3).
               05  QSPC-AMT-PROCEEDS-REQ              PIC S9(7).
               05  QSPC-ALT-PREPAY-MONTHS             PIC 9(2).
               05  QSPC-PERCENT-REGPAY-AVAIL          PIC 9(3).
               05  QSPC-ALT-DEFFRMLA                  PIC 99.
               05  QSPC-ALT-DEFMIN                    PIC 99V99.
               05  QSPC-ALT-DEFMAX                    PIC 9999V99.
               05  QSPC-NON-LOAN-FLAG                 PIC X.
               05  QSPC-SKIP-TRW                      PIC X.

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01SP_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSSP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSSP
      ******************************************************************
      *
      * DESCRIPTION: SPFILE PATH WORKERS
      * VISION FILE: /USR/DATA/XX/LP/SPFILE     (A15)
      * SQL TABLES : SPAFILE, SPBFILE, SPCFILE  (A34)
      *
      *=================================================================
      * REV:
      *  CS 2016-0824 ADDED LPWSSP-SP1-KEY (REPLACE WORKING STORAGE
      *            HOLD-SP1-KEY
      *
      * BAH 2019-0211 SPLIT SPFILE INTO SPAFILE SPBFILE SPCFILE
      *
      * JKC 2021-0521 COMMENTED OUT LP01SP SINCE NOT NEEDED FOR ACUSQL
      *
      * JKC 2023-0606 COMMENTED OUT THE SPLIT SPFILE INTO SPAFILE,
      *         SPBFILE, SPCFILE; USING THE A30 VERSION FOR FULL FILE.
      *
      ******************************************************************

       01  LPWSSP-SP1-KEY.
           03  LPWSSP-ORGST          PIC X(2)    VALUE SPACES.
           03  LPWSSP-SPRCLASS       PIC 9(3)    VALUE ZERO.
           03  LPWSSP-SUBCLASS       PIC 9(2)    VALUE ZEROS.
           03  LPWSSP-LAWCODE        PIC 9(2)    VALUE ZEROS.

       01  SP-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  SP-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES SP-PATH.
           03  SP-PATH-BEG           PIC X(13).
           03  SP-PATH-FILE          PIC X(22).
           03  FILLER REDEFINES SP-PATH-FILE.
               05  FILLER            PIC X(3).
               05  SP-PATH-SQL       PIC X(19).

      ******************************************************
      * SPAFILE
      ******************************************************
       01  SPA-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                     REDEFINES SPA-PATH.
           03  SPA-PATH-BEG           PIC X(13).
           03  SPA-PATH-FILE          PIC X(22).
           03  FILLER REDEFINES SPA-PATH-FILE.
               05  FILLER             PIC X(3).
               05  SPA-PATH-SQL       PIC X(19).

       01  SPA-ALL-PATH.
           03  SPA-ALL-BASE          PIC X(09).
           03  FILLER                REDEFINES SPA-ALL-BASE.
               05  SPA-ALL-BASE-USR  PIC X(05).
               05  SPA-ALL-BASE-DIR  PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  SPA-ALL-MACHINE       PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/LP/SPAFILE".

      ******************************************************
      * SPBFILE
      ******************************************************
       01  SPB-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                     REDEFINES SPB-PATH.
           03  SPB-PATH-BEG           PIC X(13).
           03  SPB-PATH-FILE          PIC X(22).
           03  FILLER REDEFINES SPB-PATH-FILE.
               05  FILLER             PIC X(3).
               05  SPB-PATH-SQL       PIC X(19).

       01  SPB-ALL-PATH.
           03  SPB-ALL-BASE          PIC X(09).
           03  FILLER                REDEFINES SPB-ALL-BASE.
               05  SPB-ALL-BASE-USR  PIC X(05).
               05  SPB-ALL-BASE-DIR  PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  SPB-ALL-MACHINE       PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/LP/SPBFILE".

      ******************************************************
      * SPCFILE
      ******************************************************
       01  SPC-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                     REDEFINES SPC-PATH.
           03  SPC-PATH-BEG           PIC X(13).
           03  SPC-PATH-FILE          PIC X(22).
           03  FILLER REDEFINES SPC-PATH-FILE.
               05  FILLER             PIC X(3).
               05  SPC-PATH-SQL       PIC X(19).

       01  SPC-ALL-PATH.
           03  SPC-ALL-BASE          PIC X(09).
           03  FILLER                REDEFINES SPC-ALL-BASE.
               05  SPC-ALL-BASE-USR  PIC X(05).
               05  SPC-ALL-BASE-DIR  PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  SPC-ALL-MACHINE       PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/LP/SPCFILE".

      ******************************************************************
      *01  LPWSSP-SP1-KEY.
      *    03  LPWSSP-ORGST          PIC X(2)    VALUE SPACES.
      *    03  LPWSSP-SPRCLASS       PIC 9(3)    VALUE ZERO.
      *    03  LPWSSP-SUBCLASS       PIC 9(2)    VALUE ZEROS.
      *    03  LPWSSP-LAWCODE        PIC 9(2)    VALUE ZEROS.

      *01  SP-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.
      *01  SP-PATH                   PIC X(35)   VALUE SPACES.
      *01  SP-ALL-PATH.
      *    03  SP-ALL-BASE           PIC X(09).
      *    03  FILLER                REDEFINES SP-ALL-BASE.
      *        05  SP-ALL-BASE-USR   PIC X(05).
      *        05  SP-ALL-BASE-DIR   PIC X(04).
      *    03  FILLER                PIC X(01)   VALUE "/".
      *    03  SP-ALL-MACHINE        PIC X(02).
      *    03  FILLER                PIC X(23)   VALUE "/LP/SPFILE".
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSSP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01BW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01BW
      **************************************************************************
      *            ( BORROWER MASTER FILE )
      *                     LP01BW
      *
      *           BW1-KEY = BW-OWNBR, BW-SSNO 
      *           BW2-KEY = BW-OWNBR, BW-LNAME, BW-FNAME WITH DUPLICATES
      *           BW3-KEY = BW-OWNBR, BW-SPSSNO WITH DUPLICATES
      *           BW4-KEY = BW-OWNBR, BW-SPLNAME, BW-SPFNAME WITH DUPLICATES
      *           BW5-KEY = BW-SSNO WITH DUPLICATES
      *
      * REV:
      *  BLV 022097 ADD BW-CREDIT-SCORE
      *  JTG 082197 ADDED BW-PRIOR-RN-FOR10 BW-LAST-RN-FOR10
      *                   BW-LAST-FORM-NO   BW-LAST-FORM-DATE
      *                   BW-OTHPHONE       BW-OTHPHONEX
      *  JTG 112097 EXPANDED BY 60 BYTES
      *  MJD 120297 EXPANDED BW-LOANS TO   PIC 9(2).
      *  MJD 120597 ADDED BW-SRCD
      *  MJD 021798 ADDED SIX MISC PHONE NUMBERS, EXTENTIONS AND CODES.
      *             (66 BYTES) CODES WILL BE LINKED TO CD-FILE FOR.
      *             DESCRIPTION OF PHONE # (IE. HOME, PAGER, ETC.)
      *  BLV 031198 REMOVED BW-OTHPHONE; REPLACED WITH FILLER
      *  JTG 093098 ALLOWED BW-LIASMLN & BW-LIAOTH TO GO NEGATIVE; REGENCY REVOL
      *                 BW-LIASMLN    9(6)V99 COMP-3  TO  S9(7)V99  COMP-3
      *                 BW-LIAOTH     9(6)V99 COMP-3  TO  S9(7)V99  COMP-3
      *  KEC 100698 ADDED BW-CREDIT-LIMIT & BW-FAX-NUMBER;
      *              FOR REGENCY REVOLVING
      *  KEC 102198 REMOVED BW-FAX-NUMBER.
      *  CS  1999.0315 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 2000.0410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  BAH 010627 ADDED BW-PRIVACY-OPT-OUT FOR TFC PR# 90
      *  CS  020214 ADDED BW-CITY-TAX-CD         [WORLD PR#288]
      *  BAH 030205 ADDED BW-CALL-ON-SUNDAY FOR REGACC PR# 15
      *  KEC 030327 {PR#00026} REGIONAL ACCEPTANCE <A15> [KEVIN MULLEN]
      *             ADDED BW-ADR-PHONE-CHG-DATE, BW-BAD-PHONE-FG,
      *                   BW-BAD-ADR-FG.
      *  BAH 030724 ADDED BW-BAD-EMPPHONE-FG, REGACC PR# 36
      *  BAH 060801 ADDED BW-BAD-MISC-PHONE1-FG
      *                   BW-BAD-MISC-PHONE2-FG FOR REGACC PR# 142
      *  BAH 100608 ADDED BW-BAD-CELL-FG FOR REGACC PR# 266
      *  BAH 120830 ADDED BW-DEALTRACK-CHG-DATE FOR LOGGING CHANGES TO LNAME,
      *             FNAME,ADR1,ADR2,CITY,ST,ZIP,PHONE,EMPPHONE REGACC PR# 319
      *  BAH 120927 ADDED BW-WORKHRS-NUM REDEFINES BW-WORKHRS, MULL PR# 4092
      *  BAH 160511 RECORD SIZE WENT FROM 546 TO 1900 FOR A30
      *  BAH 160822 ADDED BW-CONTACT-RELATION
      *  BAH 180920 ADDED BW-OWNBR AND PUT IN THE PRIMARY KEY. HAS TO BE THERE
      *             FOR PROGRAMS THAT DRIVE OFF THE BORROWER FILE! OTHERWISE
      *             YOU CANT TEST IF THE BORROWER BELONGS WITHIN THE BRANCH
      *             RANGE ENTERED ON THE SCREEN (FXLNSC WAS MY FIRST EXAMPLE)
      *             RENAMED BW-BRANCH BW-ORGBR, BRANCH THAT CREATED IT. L2G
      *  BAH 190307 REMOVED BW-WORKHRS-NUM REDEFINITION, WAS ONLY USED IN
      *             INPUT SCREENS AND ONLY FOR GP-I-AM-MULL
      *   CS 190415 ADDED FUTURE FIELDS, REMOVE END FILLER
      *  BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      *  BAH 20210427 REMOVED FUTURE FIELDS
      *  BAH 20230600 ADDED FILLER
      *  JKC 20240222 CHANGED BW-EMAIL FROM X(40) TO X(80);
      *               CHANGED BW-SIZE FROM 1852 TO 1892.
      *  BAH 2024.1203 ADDED BW-CEASE-DESIST-DATE BW-CEASE-DESIST-TYPE #1686
      *                                                          S35Q-145
      *  BAH 2024.1122 ADDED BW-UMC-EXPIRE-DATE BW-UMC-PR-EXPIRE-DATE #1687
      *                                                          S35Q-146
      **************************************************************************
       78  BW-SIZE                     VALUE 1892.
       01  BW-REC.
           03  BW1-KEY.
               05  BW-OWNBR             PIC 9(4).
               05  BW5-KEY.
                   07  BW-SSNO          PIC 9(9).
           03  BW-NAME.
               05  BW-LNAME             PIC X(35).
               05  BW-FNAME             PIC X(35).
           03  BW-MNAME                 PIC X(35).
           03  BW-NICKNAME              PIC X(35).
           03  BW-GENERATION            PIC X(7).
           03  BW-ADR1                  PIC X(30).
           03  BW-ADR2                  PIC X(30).
           03  BW-CITY                  PIC X(30).
           03  BW-STATE                 PIC XX.
           03  BW-ZIP                   PIC X(10).

      $XFD DATE=YYYYMMDD
           03  BW-LTOUCH-DATE           PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-REFDATE               PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-BDATE                 PIC 9(8)      COMP-3.

           03  BW-PHONE                 PIC 9(10)     COMP-3.
           03  BW-CELL-PHONE            PIC 9(10)     COMP-3.
           03  BW-NATIONALITY           PIC X(8).
           03  BW-GENDER                PIC X.
           03  BW-DEPEND                PIC 99.
           03  BW-RENTCD                PIC X(4).
           03  BW-TIMEADDR              PIC X(4).
           03  BW-CREDITCD              PIC X(4).
           03  BW-STRTGCD               PIC X(6).
           03  BW-DWELLCD               PIC XX.
           03  BW-COUNTY                PIC X(4).
           03  BW-ORIGIN                PIC X(4).
           03  BW-CENSUSCD              PIC X(10).
           03  BW-ORGSLSMN              PIC 9(4)      COMP-3.
           03  BW-REPCODE               PIC X(4).
      *----------------------------------------------------
           03  BW-SPSSNO                PIC 9(9).
           03  BW-SPNAME.
               05  BW-SPLNAME           PIC X(35).
               05  BW-SPFNAME           PIC X(35).
      $XFD DATE=YYYYMMDD
           03  BW-SP-BDATE              PIC 9(8)      COMP-3.
      *----------------------------------------------------
           03  BW-EMPLOYER              PIC X(35).
           03  BW-EMPLPOS               PIC X(24).
           03  BW-EMPPHONE              PIC 9(10)     COMP-3.
           03  BW-EMPEXT                PIC 9(4)      COMP-3.
           03  BW-EMPYEARS              PIC 99.
           03  BW-EMPPAY                PIC 9(7)V99   COMP-3.
           03  BW-EMPPAYOT              PIC 9(7)V99   COMP-3.
           03  BW-EMPPAYSR              PIC X(8).
           03  BW-EMPADDR1              PIC X(30).
           03  BW-EMPADDR2              PIC X(30).
           03  BW-EMPCITY               PIC X(30).
           03  BW-EMPSTATE              PIC XX.
           03  BW-EMPZIP                PIC X(10).
           03  BW-WORKHRS               PIC X(9).
      *----------------------------------------------------
           03  BW-LOANS                 PIC 99.
           03  BW-INTYTD                PIC S9(7)V99  COMP-3.
           03  BW-INTLYR                PIC S9(7)V99  COMP-3.
           03  BW-LIASMLN               PIC S9(7)V99  COMP-3.
           03  BW-LIAOTH                PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-LASTPODATE            PIC 9(8)      COMP-3.
           03  BW-PRLOANS               PIC 9(3).
           03  BW-RE-INTYTD             PIC S9(7)V99  COMP-3.
           03  BW-RE-INTLYR             PIC S9(7)V99  COMP-3.

           03  BW-CREDIT-LIMIT          PIC 9(7)V99   COMP-3.
           03  BW-CREDIT-SCORE          PIC 9(4)      COMP-3.
           03  BW-SCORE-TABLE.
               05  BW-CRED-SCORE        PIC 9(4) OCCURS 4.
               05  BW-BNKRPT-SCORE      PIC 9(4) OCCURS 4.

           03  BW-LAST-FORM-NO          PIC 9(4)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-LAST-FORM-DATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-PRIOR-RN-FOR10-DATE   PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  BW-LAST-RN-FOR10-DATE    PIC 9(8)      COMP-3.

      $XFD DATE=YYYYMMDD
           03  BW-ADR-PHONE-CHG-DATE    PIC 9(8)      COMP-3.
           03  BW-BAD-ADR-FG            PIC X(1).
           03  BW-BAD-PHONE-FG          PIC X(1).
           03  BW-BAD-EMPPHONE-FG       PIC X(1).
           03  BW-BAD-MISC-PHONE1-FG    PIC X(1).
           03  BW-BAD-MISC-PHONE2-FG    PIC X(1).
           03  BW-BAD-CELL-FG           PIC X(1).
           03  BW-MISC-PHONES          OCCURS 6 TIMES.
               05  BW-MISC-PHONE        PIC 9(10)     COMP-3.
               05  BW-MISC-EXT          PIC 9(4)      COMP-3.
               05  BW-MISC-PHONE-CD     PIC XX.

           03  BW-CONTACT-INFO         OCCURS 10 TIMES.
               05  BW-CONTACT-DESC      PIC X(46).
               05  BW-CONTACT-PHONE     PIC 9(10)     COMP-3.
               05  BW-CONTACT-EXT       PIC 9(4)      COMP-3.
               05  BW-CONTACT-RELATION  PIC X(12).

           03  BW-SRCD                  PIC XX.
           03  BW-CALL-ON-SUNDAY        PIC X.
           03  BW-SOLICIT               PIC X.
           03  BW-CONFIDENTIAL          PIC X.
           03  BW-PRIVACY-OPT-OUT       PIC X.
           03  BW-OPT-IN-EMAIL          PIC X.
           03  BW-OPT-IN-TEXT           PIC X.
           03  BW-CITY-TAX-CD           PIC X(3).
      $XFD DATE=YYYYMMDD
           03  BW-DEALTRACK-CHG-DATE    PIC 9(8)      COMP-3.
           03  BW-DECEASED              PIC X.
      $XFD DATE=YYYYMMDD
           03  BW-DECEASED-DATE         PIC 9(8)      COMP-3.
           03  BW-EMAIL                 PIC X(80).

           03  BW-IDENT-NO              PIC X(18).
           03  BW-IDENT-TYPE            PIC XX.
           03  BW-IDENT-STATE           PIC XX.
 
           03  BW-MILITARY-FLAG         PIC X.
      * THIS BRANCH IS ON THE INPUT SCREEN AND REALLY CANT BE USED FOR
      * ANYTHING EXCEPT WHAT BRANCH ENTERED THIS BORROWER (BW-BRANCH A15)
           03  BW-ORGBR                 PIC 9(4).

           03  BW-CEASE-DESIST-DATE     PIC 9(8)      COMP-3.
           03  BW-CEASE-DESIST-TYPE     PIC X.
               88 BW-IS-CEASE-DESIST            VALUE "W" "V" "R"
                                                      "E" "C".
           03  BW-UMC-EXPIRE-DATE       PIC 9(8)      COMP-3.
           03  BW-UMC-PR-EXPIRE-DATE    PIC 9(8)      COMP-3.
           03  FILLER                   PIC X(274).

      *================================================================*
      * END COPYBOOK: LIBLP\LP01BW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01BW_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01BW_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - BORROWER MASTER FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0503 ***NEW***
      * JKC 2022-1004 ADDED WHERE-SCAN FOR BW2 AND BW4
      * JKC 2024-0222 CHANGED BW-EMAIL FROM X(40) TO X(80)
      *
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  BW1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  BW1-CURSOR-STAT-GOOD              VALUE "00".
           88  BW1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".
       01  BW2-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  BW2-CURSOR-STAT-GOOD              VALUE "00".
           88  BW2-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".
       01  BW3-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  BW3-CURSOR-STAT-GOOD              VALUE "00".
           88  BW3-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".
       01  BW4-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  BW4-CURSOR-STAT-GOOD              VALUE "00".
           88  BW4-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  BW1-RETURN-CODE           PIC S9(4)   COMP-5.
       01  BW2-RETURN-CODE           PIC S9(4)   COMP-5.
       01  BW3-RETURN-CODE           PIC S9(4)   COMP-5.
       01  BW4-RETURN-CODE           PIC S9(4)   COMP-5.

       01  QBW1-WHERE-BEG-KEY.
           03  QBW1-WBEG-OWNBR         PIC 9(4).
           03  QBW1-WBEG-SSNO          PIC 9(9).
       01  QBW1-WHERE-END-KEY.
           03  QBW1-WEND-OWNBR         PIC 9(4).
           03  QBW1-WEND-SSNO          PIC 9(9).
       01  QBW2-WHERE-BEG-KEY.
           03  QBW2-WBEG-OWNBR         PIC 9(4).
           03  QBW2-WBEG-LNAME         PIC X(35).
           03  QBW2-WBEG-FNAME         PIC X(35).
       01  QBW2-WHERE-END-KEY.
           03  QBW2-WEND-OWNBR         PIC 9(4).
           03  QBW2-WEND-LNAME         PIC X(35).
           03  QBW2-WEND-FNAME         PIC X(35).
       01  QBW3-WHERE-BEG-KEY.
           03  QBW3-WBEG-OWNBR         PIC 9(4).
           03  QBW3-WBEG-SPSSNO        PIC 9(9).
       01  QBW3-WHERE-END-KEY.
           03  QBW3-WEND-OWNBR         PIC 9(4).
           03  QBW3-WEND-SPSSNO        PIC 9(9).
       01  QBW4-WHERE-BEG-KEY.
           03  QBW4-WBEG-OWNBR         PIC 9(4).
           03  QBW4-WBEG-SPLNAME       PIC X(35).
           03  QBW4-WBEG-SPFNAME       PIC X(35).
       01  QBW4-WHERE-END-KEY.
           03  QBW4-WEND-OWNBR         PIC 9(4).
           03  QBW4-WEND-SPLNAME       PIC X(35).
           03  QBW4-WEND-SPFNAME       PIC X(35).
       01  QBW2-WHERE-SCAN-BEG-KEY.
      *--> 03  QBW2-WSBEG-OWNBR        PIC 9(4).    ***NOT NEEDED***
           03  QBW2-WSBEG-LNAME        PIC X(35).
      *--> 03  QBW2-WSBEG-FNAME        PIC X(35).   ***NOT NEEDED***
       01  QBW4-WHERE-SCAN-BEG-KEY.
      *--> 03  QBW4-WSBEG-OWNBR        PIC 9(4).    ***NOT NEEDED***
           03  QBW4-WSBEG-SPLNAME      PIC X(35).
      *--> 03  QBW4-WSBEG-SPFNAME      PIC X(35).   ***NOT NEEDED***
 
       01  QBW-REC.
           03  QBW-OWNBR                              PIC 9(4).
           03  QBW-SSNO                               PIC 9(9).
           03  QBW-LNAME                              PIC X(35).
           03  QBW-FNAME                              PIC X(35).
           03  QBW-MNAME                              PIC X(35).
           03  QBW-NICKNAME                           PIC X(35).
           03  QBW-GENERATION                         PIC X(7).
           03  QBW-ADR1                               PIC X(30).
           03  QBW-ADR2                               PIC X(30).
           03  QBW-CITY                               PIC X(30).
           03  QBW-STATE                              PIC XX.
           03  QBW-ZIP                                PIC X(10).
           03  QBW-LTOUCH-DATE                        PIC X(10).
           03  QBW-REFDATE                            PIC X(10).
           03  QBW-BDATE                              PIC X(10).
           03  QBW-PHONE                              PIC 9(10).
           03  QBW-CELL-PHONE                         PIC 9(10).
           03  QBW-NATIONALITY                        PIC X(8).
           03  QBW-GENDER                             PIC X.
           03  QBW-DEPEND                             PIC 99.
           03  QBW-RENTCD                             PIC X(4).
           03  QBW-TIMEADDR                           PIC X(4).
           03  QBW-CREDITCD                           PIC X(4).
           03  QBW-STRTGCD                            PIC X(6).
           03  QBW-DWELLCD                            PIC XX.
           03  QBW-COUNTY                             PIC X(4).
           03  QBW-ORIGIN                             PIC X(4).
           03  QBW-CENSUSCD                           PIC X(10).
           03  QBW-ORGSLSMN                           PIC 9(4).
           03  QBW-REPCODE                            PIC X(4).
           03  QBW-SPSSNO                             PIC 9(9).
           03  QBW-SPLNAME                            PIC X(35).
           03  QBW-SPFNAME                            PIC X(35).
           03  QBW-SP-BDATE                           PIC X(10).
           03  QBW-EMPLOYER                           PIC X(35).
           03  QBW-EMPLPOS                            PIC X(24).
           03  QBW-EMPPHONE                           PIC 9(10).
           03  QBW-EMPEXT                             PIC 9(4).
           03  QBW-EMPYEARS                           PIC 99.
           03  QBW-EMPPAY                             PIC 9(7)V99.
           03  QBW-EMPPAYOT                           PIC 9(7)V99.
           03  QBW-EMPPAYSR                           PIC X(8).
           03  QBW-EMPADDR1                           PIC X(30).
           03  QBW-EMPADDR2                           PIC X(30).
           03  QBW-EMPCITY                            PIC X(30).
           03  QBW-EMPSTATE                           PIC XX.
           03  QBW-EMPZIP                             PIC X(10).
           03  QBW-WORKHRS                            PIC X(9).
           03  QBW-LOANS                              PIC 99.
           03  QBW-INTYTD                             PIC S9(7)V99.
           03  QBW-INTLYR                             PIC S9(7)V99.
           03  QBW-LIASMLN                            PIC S9(7)V99.
           03  QBW-LIAOTH                             PIC S9(7)V99.
           03  QBW-LASTPODATE                         PIC X(10).
           03  QBW-PRLOANS                            PIC 9(3).
           03  QBW-RE-INTYTD                          PIC S9(7)V99.
           03  QBW-RE-INTLYR                          PIC S9(7)V99.
           03  QBW-CREDIT-LIMIT                       PIC 9(7)V99.
           03  QBW-CREDIT-SCORE                       PIC 9(4).
           03  QBW-CRED-SCORE-1                       PIC 9(4).
           03  QBW-CRED-SCORE-2                       PIC 9(4).
           03  QBW-CRED-SCORE-3                       PIC 9(4).
           03  QBW-CRED-SCORE-4                       PIC 9(4).
           03  QBW-BNKRPT-SCORE-1                     PIC 9(4).
           03  QBW-BNKRPT-SCORE-2                     PIC 9(4).
           03  QBW-BNKRPT-SCORE-3                     PIC 9(4).
           03  QBW-BNKRPT-SCORE-4                     PIC 9(4).
           03  QBW-LAST-FORM-NO                       PIC 9(4).
           03  QBW-LAST-FORM-DATE                     PIC X(10).
           03  QBW-PRIOR-RN-FOR10-DATE                PIC X(10).
           03  QBW-LAST-RN-FOR10-DATE                 PIC X(10).
           03  QBW-ADR-PHONE-CHG-DATE                 PIC X(10).
           03  QBW-BAD-ADR-FG                         PIC X(1).
           03  QBW-BAD-PHONE-FG                       PIC X(1).
           03  QBW-BAD-EMPPHONE-FG                    PIC X(1).
           03  QBW-BAD-MISC-PHONE1-FG                 PIC X(1).
           03  QBW-BAD-MISC-PHONE2-FG                 PIC X(1).
           03  QBW-BAD-CELL-FG                        PIC X(1).
           03  QBW-MISC-PHONE-1                       PIC 9(10).
           03  QBW-MISC-EXT-1                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-1                    PIC XX.
           03  QBW-MISC-PHONE-2                       PIC 9(10).
           03  QBW-MISC-EXT-2                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-2                    PIC XX.
           03  QBW-MISC-PHONE-3                       PIC 9(10).
           03  QBW-MISC-EXT-3                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-3                    PIC XX.
           03  QBW-MISC-PHONE-4                       PIC 9(10).
           03  QBW-MISC-EXT-4                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-4                    PIC XX.
           03  QBW-MISC-PHONE-5                       PIC 9(10).
           03  QBW-MISC-EXT-5                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-5                    PIC XX.
           03  QBW-MISC-PHONE-6                       PIC 9(10).
           03  QBW-MISC-EXT-6                         PIC 9(4).
           03  QBW-MISC-PHONE-CD-6                    PIC XX.
           03  QBW-CONTACT-DESC-1                     PIC X(46).
           03  QBW-CONTACT-PHONE-1                    PIC 9(10).
           03  QBW-CONTACT-EXT-1                      PIC 9(4).
           03  QBW-CONTACT-RELATION-1                 PIC X(12).
           03  QBW-CONTACT-DESC-2                     PIC X(46).
           03  QBW-CONTACT-PHONE-2                    PIC 9(10).
           03  QBW-CONTACT-EXT-2                      PIC 9(4).
           03  QBW-CONTACT-RELATION-2                 PIC X(12).
           03  QBW-CONTACT-DESC-3                     PIC X(46).
           03  QBW-CONTACT-PHONE-3                    PIC 9(10).
           03  QBW-CONTACT-EXT-3                      PIC 9(4).
           03  QBW-CONTACT-RELATION-3                 PIC X(12).
           03  QBW-CONTACT-DESC-4                     PIC X(46).
           03  QBW-CONTACT-PHONE-4                    PIC 9(10).
           03  QBW-CONTACT-EXT-4                      PIC 9(4).
           03  QBW-CONTACT-RELATION-4                 PIC X(12).
           03  QBW-CONTACT-DESC-5                     PIC X(46).
           03  QBW-CONTACT-PHONE-5                    PIC 9(10).
           03  QBW-CONTACT-EXT-5                      PIC 9(4).
           03  QBW-CONTACT-RELATION-5                 PIC X(12).
           03  QBW-CONTACT-DESC-6                     PIC X(46).
           03  QBW-CONTACT-PHONE-6                    PIC 9(10).
           03  QBW-CONTACT-EXT-6                      PIC 9(4).
           03  QBW-CONTACT-RELATION-6                 PIC X(12).
           03  QBW-CONTACT-DESC-7                     PIC X(46).
           03  QBW-CONTACT-PHONE-7                    PIC 9(10).
           03  QBW-CONTACT-EXT-7                      PIC 9(4).
           03  QBW-CONTACT-RELATION-7                 PIC X(12).
           03  QBW-CONTACT-DESC-8                     PIC X(46).
           03  QBW-CONTACT-PHONE-8                    PIC 9(10).
           03  QBW-CONTACT-EXT-8                      PIC 9(4).
           03  QBW-CONTACT-RELATION-8                 PIC X(12).
           03  QBW-CONTACT-DESC-9                     PIC X(46).
           03  QBW-CONTACT-PHONE-9                    PIC 9(10).
           03  QBW-CONTACT-EXT-9                      PIC 9(4).
           03  QBW-CONTACT-RELATION-9                 PIC X(12).
           03  QBW-CONTACT-DESC-10                    PIC X(46).
           03  QBW-CONTACT-PHONE-10                   PIC 9(10).
           03  QBW-CONTACT-EXT-10                     PIC 9(4).
           03  QBW-CONTACT-RELATION-10                PIC X(12).
           03  QBW-SRCD                               PIC XX.
           03  QBW-CALL-ON-SUNDAY                     PIC X.
           03  QBW-SOLICIT                            PIC X.
           03  QBW-CONFIDENTIAL                       PIC X.
           03  QBW-PRIVACY-OPT-OUT                    PIC X.
           03  QBW-OPT-IN-EMAIL                       PIC X.
           03  QBW-OPT-IN-TEXT                        PIC X.
           03  QBW-CITY-TAX-CD                        PIC X(3).
           03  QBW-DEALTRACK-CHG-DATE                 PIC X(10).
           03  QBW-DECEASED                           PIC X.
           03  QBW-DECEASED-DATE                      PIC X(10).
           03  QBW-EMAIL                              PIC X(80).
           03  QBW-IDENT-NO                           PIC X(18).
           03  QBW-IDENT-TYPE                         PIC XX.
           03  QBW-IDENT-STATE                        PIC XX.
           03  QBW-MILITARY-FLAG                      PIC X.
           03  QBW-ORGBR                              PIC 9(4).
           03  QBW-CEASE-DESIST-DATE                  PIC X(10).
           03  QBW-CEASE-DESIST-TYPE                  PIC X.
           03  QBW-UMC-EXPIRE-DATE                    PIC X(10).
           03  QBW-UMC-PR-EXPIRE-DATE                 PIC X(10).
      *    03  QBW-VISION-KEY1                        PIC X(13).
      *    03  QBW-VISION-KEY2                        PIC X(74).
      *    03  QBW-VISION-KEY3                        PIC X(13).
      *    03  QBW-VISION-KEY4                        PIC X(74).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01BW_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSBW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSBW
      *********************************************************
      *    LIBLP/LPWSBW: BWFILE PATH WORKERS
      *
      *    BW-PATH = /USR/DATA/XX/XX####/GB/BWFILE
      *              |----BEG----||-MID-||-----FILE----|
      *
      ******************************************************************
       01  BW-BW-TEST-GROUP.
           03  BW-BW-TEST-FIELD-A    PIC X(06).
           03  BW-BW-TEST-FIELD-AX   REDEFINES BW-BW-TEST-FIELD-A.
               05  BW-IC-TEST-FIELD-A1   PIC X(01).
               05  BW-IC-TEST-FIELD-A2   PIC X(02).
               05  BW-IC-TEST-FIELD-A3   PIC X(03).

       01  BW-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  BW-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES BW-PATH.
           03  BW-PATH-BEG           PIC X(13).
           03  BW-PATH-OWNST         PIC X(02).
           03  BW-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  BW-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES BW-PATH-FILE.
               05  FILLER            PIC X(03).
               05  BW-PATH-SQL       PIC X(12).

       01  BW-ALL-PATH.
           03  BW-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES BW-ALL-BASE.
               05  BW-ALL-BASE-USR   PIC X(05).
               05  BW-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  BW-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(01)   VALUE "/".
           03  BW-ALL-DATA           PIC X(06).
           03  FILLER                PIC X(10)   VALUE "/GB/BWFILE".
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSBW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LP
      **************************************************************************
      *    LOAN PAYMENT FILE:   
      *
      *    LP1-KEY = LP-BRNO, LP-ACCTNO, LP-SEQNO 
      *
      *  REV:
      *  KEC 052998 CHANGED ALL AMOUNT FIELDS TO BE '9(7)' PER JOHN.
      *              THE RECORD SIZE WAS NOT CHANGED; FILLER AT THE
      *              BOTTOM WAS USED.  FIX: FX/BY1010.C
      *  MJD 060498 EXPANDED RECORD SIZE TO 239 BYTES, ADDED LP-SIZE.
      *  BAH 062498 CHANGED LP-TILLNO TO ALPHANUMERIC
      *  MJD 062598 REDEFINE FIELDS UNDER LCWORK1 AND LCWORK2 DID
      *             NOT MATCH ORIG FIELDI SIZE.
      *  CS  081998 ADDED LP-POSTING-BR
      *  JTG 082698 CHANGED LP-PRINBAL TO LP-CURBAL, REGENCY REVOLVING
      *  JTG 093098 ALLOWED LN-CURBAL & LN-PURBAL TO GO NEGATIVE; REGENCY REVOL
      *  JTG 110698 CHANGED LP-APPRIN TO LP-APCUR, REGENCY REVOLVING
      *  JTG 111298 ADDED LP-RT-SEQNO  REVOLVING REGENCY
      *  JTG 120798 ADDED LP-REVOL-OTHCD REVOLVING OTHER (OT) CHARGES
      *  MJD 990127 ----- UPDATED IN FLEXGEN -----
      *  CS  1999.0315 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  JTG 990729 REMOVED LP-REVOL-OTHCD, ADDED CD-RO-NUM TO PROVIDE
      *            AN ALPHA KEY RE: CD-RO-CODE
      *  KEC 1999.0805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  MJD 000119 ADDED LP-NOLCHG (WORLD PR#218)
      *  MJD 001016 ADDED LP-COLLECTOR (BAY PR#1317)
      *  JTG 010227 ADDED LN-EXTRA-PRIN-LFP LN-REMAIN-INT-SINCE-LFP
      *             LN-REMAIN-PRIN-SINCE-LFP  (LFP=LAST-FULL-PAYMENT)
      *             LENDMARK, PR#1045 & PR#1380
      * JTG 020308 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *            ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *            OPENED UP USE OF LP-PRORATED-INS-REB TO HOLD PRORATED PORTION
      *            OF INSURANCE REFUND                                WORLD #288
      * BLM 100305 ADDED LP-APPLIED-TO-ESCROW, REDEFINED AS LP-ESCROW-PREPAID,
      *            REGWAN PR# 3506
      **************************************************************************
      * A30 CHANGES   10/15/15
      * BLM 151015 ADDED UNUSED, INCREASED DATES TO 9(8), CHANGED COMP-6 TO
      *            COMP-3 FIELDS, INCREASED FIELD SIZES, CHANGED SEVERAL
      *            REDEFS TO BE SEPARATE FIELDS, ADDED LP-INT-PDTH,
      *            SUPPORT PR# PR0003
      *  CS 151016 ADD LP-ADDON-LAST-PYAMT WAS REDEFINE OF LC-WORK2.
      *  CS 151029 CHANGED LP-SIZE FROM 266 TO 371
      *  CS 151116 ADD BACK LP-ADDON-INTPDTH, SINCE ITS THE PRIOR INTEREST
      *            PAID THRU
      *  CS 151204 REMOVED LP-BRNO AS PART OF KEY
      *  CS 160201 REMOVED LP-T, REMOVED LP-FROMCL & LP-TOCL FROM REDEFINE AND
      *            MADE SEPARATE FIELDS, BOTH ARE NOW 9(3)
      * BAH 160304 CHANGED LP-TILLNO TO PIC 9(2) FROM PIC X.
      *  CS 160302 REDEFINE LP-USERID FOR LP-ALT-PREPAY-FG WHICH IS SET TO "Y"
      *            WHEN PDTH-PAYS > SP-ALT-PREPAY-MONTHS  WORLD PR#1140
      *  CS 160414 ADDED LP-ALT-PREPAY-FG AS ITS OWN FIELD
      * BAH 181219 GLOBAL LPFILE, MOVED LP-BRNO INTO LP1-KEY
      * BAH 190307 REMOVED LP1-KEY9, WAS ONLY USED IN MAINT FOR SCAN, USE
      *            WORKING STORAGE.
      *  CS 190501 ADD FUTURE FIELDS, SAVED LP01LP.190501 FILLER WAS 98
      * BAH 20190628 REMOVED LP-RT-SEQNO, REVOLVING
      * BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * BAH 20210427 REMOVED FUTURE FIELDS
      * BAH 20230600 ADDED FILLER
      * BAH 20240212 ADDED LP-REPAY-TRANS-ID #1641
      **************************************************************************
       78  LP-SIZE                     VALUE 410.
       01  LP-REC.
           03  LP1-KEY.
               05  LP-BRNO             PIC  9(4).
               05  LP-ACCTNO           PIC  9(8).
               05  LP-SEQNO            PIC  9(5).
      *-----------------------------------------------------
      $XFD DATE=YYYYMMDD
           03  LP-LTOUCH-DATE          PIC 9(8)      COMP-3.
           03  LP-USERID               PIC X(10).
      $XFD DATE=YYYYMMDD
           03  LP-POSTDATE             PIC 9(8)      COMP-3.
           03  LP-POSTTIME             PIC 9(6)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-TRDATE               PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-PAYDATE              PIC 9(8)      COMP-3.
           03  LP-TRCD                 PIC XX.
           03  LP-REFNO                PIC X(5).
      * ALL LP-REFNO REDEFINES WERE MOVED TO LPWSLP AND USED ACCORDINGLY
      *-----------------------------------------------------
           03  LP-TRAMT                PIC S9(7)V99  COMP-3.
           03  LP-APOTH                PIC S9(7)V99  COMP-3.
           03  LP-APOT2                PIC S9(7)V99  COMP-3.
           03  LP-APINT                PIC S9(7)V99  COMP-3.
           03  LP-APLC                 PIC S9(7)V99  COMP-3.
           03  LP-APCUR                PIC S9(7)V99  COMP-3.
      *-----------------------------------------------------
           03  LP-OTHBAL               PIC S9(7)V99  COMP-3.
           03  LP-OT2BAL               PIC S9(7)V99  COMP-3.
           03  LP-INTBAL               PIC S9(7)V99  COMP-3.
           03  LP-LCBAL                PIC S9(7)V99  COMP-3.
           03  LP-CURBAL               PIC S9(7)V99  COMP-3.
      *-----------------------------------------------------
           03  LP-INTDUE               PIC S9(7)V99  COMP-3.
           03  LP-DLPROC               PIC S9(7)V99  COMP-3.
           03  LP-EARNED               OCCURS 3
                                       PIC S9(7)V99  COMP-3.
           03  LP-INTPAID              PIC S9(7)V99  COMP-3.
           03  LP-SSNO                 PIC  9(10)    COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-PDTH-DATE            PIC  9(8)     COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-LCPDTH-DATE          PIC  9(8)     COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-INTPDTH-DATE         PIC  9(8)     COMP-3.
           03  LP-TILLNO               PIC  99.
           03  LP-APINTOWE             PIC S9(7)V99  COMP-3.

           03  LP-DLPARVHELD-ADJ       PIC S9(7)V99  COMP-3.
           03  LP-LT-SEQNO             PIC 9(3)      COMP-3.
           03  LP-IBPC                 PIC X.
           03  LP-MANUAL-RB            PIC X.
           03  LP-INSTYPES             PIC X.
           03  LP-REV                  PIC X.
           03  LP-REVTRCD              PIC XX.
           03  LP-REVSEQNO             PIC 9(5)      COMP-3.
           03  LP-STATUSFG             PIC X.
           03  LP-NEWSTAT-RATE         PIC 999V999   COMP-3.
           03  LP-LCPARTIALS           PIC S9(7)V99  COMP-3.
           03  LP-ADDON-ORIG-REGPY     PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-NEW1ST-PYDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-DEF-DUEDATE          PIC 9(8)      COMP-3.
      * LP-LCPAID CAN BE A DATE IN TRIPLE UCC STATES, MMDDYY
      * COULD NOT IDENTIFY HOW TO SPLIT THIS OUT VIA CONVERSION SO LEAVING
      * IT LIKE THIS, MUST STAY AS MMDDYY, USED AS DATE IN DEFI01.CBL
           03  LP-LCPAID               PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-OLD1ST-PYDATE        PIC 9(8)      COMP-3.
           03  LP-DEF-TERM             PIC 9(3)      COMP-3.
           03  LP-ADDON-LAST-PYAMT     PIC S9(7)V99  COMP-3.
           03  LP-DLRVCHGS-ADJ         OCCURS 3
                                       PIC S9(7)V99  COMP-3.
           03  LP-DLPARVPAID-ADJ       PIC S9(7)V99  COMP-3.
      * LP-DLNO MUST BE '0' UNLESS A PAYMENT FROM RESERVE
      * WAS POSTED FROM A DEALER OTHER THAN THE DEALER WHO
      * THE CONTRACT WAS PURCHASED FROM.
           03  LP-DLNO                  PIC 9(4)V99   COMP-3.
           03  LP-PREPAY-PENALTY        PIC S9(7)V99  COMP-3.
           03  LP-PRORATED-INS-REB      PIC S9(7)V99  COMP-3.
           03  LP-POSTING-BR            PIC 9(4)      COMP-3.
           03  LP-NOLCHG                PIC S9(3)     COMP-3.
           03  LP-COLLECTOR             PIC X(3).
           03  LP-EXTRA-PRIN-LFP        PIC S9(7)V99  COMP-3.
           03  LP-REMAIN-INT-SINCE-LFP  PIC S9(7)V99  COMP-3.
           03  LP-REMAIN-PRIN-SINCE-LFP PIC S9(7)V99  COMP-3.
           03  LP-APPLIED-TO-ESCROW     PIC S9(7)V99  COMP-3.
           03  LP-ESCROW-PREPAID        PIC S9(7)V99  COMP-3.
           03  LP-PRIOR-POOLID          PIC 9(5)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LP-ADDON-INTPDTH-DATE    PIC 9(8)      COMP-3.
           03  LP-FROMCL                PIC  999      COMP-3.
           03  LP-TOCL                  PIC  999      COMP-3.
           03  LP-ALT-PREPAY-FG         PIC X.
           03  LP-REPAY-TRANS-ID        PIC 9(10)     COMP-3.
        
           03  FILLER                   PIC X(95).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LP_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LP_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN PAYMENT FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0504 ***NEW***
      * JKC 2022-0915 ADDED QLP1-WHERE-SCAN-BEG-KEY.
      * BAH 20240212 ADDED QLP-REPAY-TRANS-ID  PIC 9(10).
      *
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  LP1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LP1-CURSOR-STAT-GOOD              VALUE "00".
           88  LP1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{NOT GREATER CURSOR FOR START-NOT-GREATER & READ-PREVIOUS}
       01  LP1-CURSOR-NG-STAT           PIC X(2) VALUE SPACES.
           88  LP1-CURSOR-NG-STAT-GOOD           VALUE "00".
           88  LP1-CURSOR-NG-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{SCAN CURSOR FOR START-SCAN  }
       01  LP1-CURSOR-SC-STAT           PIC X(2) VALUE SPACES.
           88  LP1-CURSOR-SC-STAT-GOOD           VALUE "00".
           88  LP1-CURSOR-SC-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LP1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLP1-WHERE-BEG-KEY.
           03  QLP1-WBEG-BRNO             PIC 9(04).
           03  QLP1-WBEG-ACCTNO           PIC 9(08).
           03  QLP1-WBEG-SEQNO            PIC 9(05).
 
       01  QLP1-WHERE-END-KEY.
           03  QLP1-WEND-BRNO             PIC 9(04).
           03  QLP1-WEND-ACCTNO           PIC 9(08).
           03  QLP1-WEND-SEQNO            PIC 9(05).
 
       01  QLP1-WHERE-SCAN-BEG-KEY.
           03  QLP1-WSBEG-BRNO            PIC 9(04).
           03  QLP1-WSBEG-ACCTNO          PIC 9(08).
      *--> 03  QLP1-WSBEG-SEQNO           PIC 9(05). ***NOT NEEDED***
 
       01  QLP-REC.
           03  QLP-BRNO             PIC  9(4).
           03  QLP-ACCTNO           PIC  9(8).
           03  QLP-SEQNO            PIC  9(5).
           03  QLP-LTOUCH-DATE          PIC X(10).
           03  QLP-USERID               PIC X(10).
           03  QLP-POSTDATE             PIC X(10).
           03  QLP-POSTTIME             PIC 9(6).
           03  QLP-TRDATE               PIC X(10).
           03  QLP-PAYDATE              PIC X(10).
           03  QLP-TRCD                 PIC XX.
           03  QLP-REFNO                PIC X(5).
           03  QLP-TRAMT                PIC S9(7)V99.
           03  QLP-APOTH                PIC S9(7)V99.
           03  QLP-APOT2                PIC S9(7)V99.
           03  QLP-APINT                PIC S9(7)V99.
           03  QLP-APLC                 PIC S9(7)V99.
           03  QLP-APCUR                PIC S9(7)V99.
           03  QLP-OTHBAL               PIC S9(7)V99.
           03  QLP-OT2BAL               PIC S9(7)V99.
           03  QLP-INTBAL               PIC S9(7)V99.
           03  QLP-LCBAL                PIC S9(7)V99.
           03  QLP-CURBAL               PIC S9(7)V99.
           03  QLP-INTDUE               PIC S9(7)V99.
           03  QLP-DLPROC               PIC S9(7)V99.
           03  QLP-EARNED-1             PIC S9(7)V99.
           03  QLP-EARNED-2             PIC S9(7)V99.
           03  QLP-EARNED-3             PIC S9(7)V99.
           03  QLP-INTPAID              PIC S9(7)V99.
           03  QLP-SSNO                 PIC 9(10).
           03  QLP-PDTH-DATE            PIC X(10).
           03  QLP-LCPDTH-DATE          PIC X(10).
           03  QLP-INTPDTH-DATE         PIC X(10).
           03  QLP-TILLNO               PIC 99.
           03  QLP-APINTOWE             PIC S9(7)V99.
           03  QLP-DLPARVHELD-ADJ       PIC S9(7)V99.
           03  QLP-LT-SEQNO             PIC 9(3).
           03  QLP-IBPC                 PIC X.
           03  QLP-MANUAL-RB            PIC X.
           03  QLP-INSTYPES             PIC X.
           03  QLP-REV                  PIC X.
           03  QLP-REVTRCD              PIC XX.
           03  QLP-REVSEQNO             PIC 9(5).
           03  QLP-STATUSFG             PIC X.
           03  QLP-NEWSTAT-RATE         PIC 999V999.
           03  QLP-LCPARTIALS           PIC S9(7)V99.
           03  QLP-ADDON-ORIG-REGPY     PIC S9(7)V99.
           03  QLP-NEW1ST-PYDATE        PIC X(10).
           03  QLP-DEF-DUEDATE          PIC X(10).
           03  QLP-LCPAID               PIC S9(7)V99.
           03  QLP-OLD1ST-PYDATE        PIC X(10).
           03  QLP-DEF-TERM             PIC 9(3).
           03  QLP-ADDON-LAST-PYAMT     PIC S9(7)V99.
           03  QLP-DLRVCHGS-ADJ-1       PIC S9(7)V99.
           03  QLP-DLRVCHGS-ADJ-2       PIC S9(7)V99.
           03  QLP-DLRVCHGS-ADJ-3       PIC S9(7)V99.
           03  QLP-DLPARVPAID-ADJ       PIC S9(7)V99.
           03  QLP-DLNO                  PIC 9(4)V99.
           03  QLP-PREPAY-PENALTY        PIC S9(7)V99.
           03  QLP-PRORATED-INS-REB      PIC S9(7)V99.
           03  QLP-POSTING-BR            PIC 9(4).
           03  QLP-NOLCHG                PIC S9(3).
           03  QLP-COLLECTOR             PIC X(3).
           03  QLP-EXTRA-PRIN-LFP        PIC S9(7)V99.
           03  QLP-REMAIN-INT-SINCE-LFP  PIC S9(7)V99.
           03  QLP-REMAIN-PRIN-SINCE-LFP PIC S9(7)V99.
           03  QLP-APPLIED-TO-ESCROW     PIC S9(7)V99.
           03  QLP-ESCROW-PREPAID        PIC S9(7)V99.
           03  QLP-PRIOR-POOLID          PIC 9(5).
           03  QLP-ADDON-INTPDTH-DATE    PIC X(10).
           03  QLP-FROMCL                PIC  999.
           03  QLP-TOCL                  PIC  999.
           03  QLP-ALT-PREPAY-FG         PIC X.
           03  QLP-REPAY-TRANS-ID        PIC 9(10).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LP_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLP
      *********************************************************
      *    LIBLP/LPWSLP: LPFILE PATH WORKERS
      *
      * LP-PATH = /USR/DATA/R#/XX####/GB/LPFILE
      *           |----BEG----||-MID-||-----FILE----|
      *                                  |---SQL----|
      *
      ******************************************************************
       01  LP-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  LP-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES LP-PATH.
           03  LP-PATH-BEG           PIC X(13).
           03  LP-PATH-OWNST         PIC X(02).
           03  LP-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  LP-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LP-PATH-FILE.
               05  FILLER            PIC X(03).
               05  LP-PATH-SQL       PIC X(12).

       01  LP-ALL-PATH.
           03  LP-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES LP-ALL-BASE.
               05  LP-ALL-BASE-USR   PIC X(05).
               05  LP-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  LP-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(01)   VALUE "/".
           03  LP-ALL-DATA           PIC X(06).
           03  FILLER                REDEFINES LP-ALL-DATA.
               05  LP-ALL-STATE      PIC X(02).
               05  LP-ALL-BRNO       PIC 9(04).
           03  FILLER                PIC X(10)   VALUE "/GB/LPFILE".

      **************************************************************
       01  LPWSLP-LP-REFNO             PIC X(5).

       01  LPWSLP-LP-POOLID   REDEFINES LPWSLP-LP-REFNO
                                       PIC  9(5).

      * THIS IS USED FOR DUE DATE CHANGES AND ALSO TRANSFER TO SERVICE/PURCHASE
      * THE TRANSFERS ARE FOR MEMO ONLY, TOCL AND FROMCL ARE THEIR OWN FIELDS
       01  LPWSLP-LP-DDNO     REDEFINES LPWSLP-LP-REFNO.
           03  LPWSLP-LP-FROMDD        PIC 99.
           03  LPWSLP-LP-T             PIC X.
           03  LPWSLP-LP-TODD          PIC 99.

       01  LPWSLP-LP-ADDON    REDEFINES LPWSLP-LP-REFNO.
           03  LPWSLP-LP-ADDON-TEXT    PIC X(3).
           03  LPWSLP-LP-ADDON-TYPE    PIC X(2).

       01  FILLER             REDEFINES LPWSLP-LP-REFNO.
           03  LPWSLP-LP-DLRVNO        PIC 9.
           03  FILLER                  PIC X(4).

       01  FILLER             REDEFINES LPWSLP-LP-REFNO.
           03  LPWSLP-LP-P4P5-TRCD     PIC XX.
           03  LPWSLP-LP-P4P5-DLRVNO   PIC 9.
           03  FILLER                  PIC X(2).
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LX.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LX
      ******************************************************************
      *
      * LOAN PAYMENT TRAILER FILE: 
      *
      *    LX1-KEY = LX-BRNO, LX-ACCTNO, LX-SEQNO
      *
      * CODE:
      *  A - ADDON TRAILER RECORD
      *  M - MONTHLY INSURANCE PREMIUM INFO
      *  Z - AMORTIZED INTEREST (Z) PAYMENT INFO
      *  T - TRANFER
      *  P - TRANFER (PURCHASED)
      *  X - INSURANCE TAX
      *  R - REBATE AMOUNT FOR GEORGIA 4% CLOSING FEE EARLY PROVISION
      *
      * REV:
      *  JTG 101196 ADDED 'LXE-WORKER' & 'LXE-WORKER2' FOR LPCERN-- A50 VERSION
      *                   SP-ERNFRMLA 15 & 16, REAL INTEREST BEARINGING METHOD
      *                                            - INSTANT AUTO, KY
      *  MJD 041797 ADDED LX-2 RECORD. EXTENSION OF LXA-PMR-SCHED-CHNG,
      *                   LEVELS 4-9
      *  JTG 112097 EXPANDED BY 10 BYTES
      *  KEC 990510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 990811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  JTG 011004 ADDED LX-Z RECORD AMORTIZED INTEREST (Z) PAYMENT INFO
      *  JTG 020603 ADDED LX-M RECORD MONTHLY INSURANCE PREMIUM PAYMENT INFO
      *                                                        REGENCY #1801
      *  CS  021120 ADDED LX-X RECORD INSURANCE TAX [WORLD PR#288]
      *  CS  151020 CHANGED LX-SEQ TO 9(5)
      *  CS  160209 ADD LX-BRNO,CHANGED LXA-START-PMT/LXA-END-PMT TO 9(5), 
      *             LX2-START-PMT,LX2-END-PMT TO 9(5). THIS HOLDS THE PAYMENT
      *             NUMBER WHERE THE NEW PAYMENT STARTS & STOPS.
      *             ADDED LP-EARN BUCKETS 7-10  (NEW EARNINGS)
      *  CS  160210 COMBINED LXA AND LX2
      *  MJD 160613 ADDED LX-R RECORD. THIS IS THE AMOUNT
      *             OF THE SERVICE CHARGE THAT
      *             IS THE GEORGIA 4% CLOSING FEE EARLY PROVISION CALCULATED 
      *             IN REBATE-EP54 (LIBGB/REBATE).
      *             THIS IS INCLUDED IN THE SERVICE CHARGE 
      *             REBATE BUT NEEDS TO BE BROKEN OUT ON CERTAIN CONTRACTS. 
      *             IT WILL BE STORED HERE IF NOT = 0               REGMGT #4915
      * BAH 190114 GLOBAL LXFILE, MOVED LX-BRNO UNDER LX1-KEY
      * BAH 190305 REMOVED FILLER FOR EACH CODE, ONLY HAVE FILLER AT END
      *  CS 190502 ADD FUTURE FIELDS
      *  CS 190502 TALKED WITH BETH, THE LX,LXE,LXG,LN,PD,LP ARE PASSED VIA
      *            LP01WK, A LOT OF EFFORT WAS PUT IN TO MAKE THE WORK RECORD
      *            ACCURATE, SO... KEEP THE FILE SIZES THE SAME SIZE AS THE
      *            WORK RECORD.
      * BAH 20200324 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * BAH 20210427 REMOVED FUTURE FIELDS
      * BAH 20230600 ADDED FILLER
      **************************************************************************
       78  LX-SIZE                 VALUE 530. 
      *-----------------------------------------------------------------
       01  LX-REC.
           03  LX1-KEY.
               05  LX-BRNO         PIC 9(4).
               05  LX-ACCTNO       PIC 9(8).
               05  LX-SEQNO        PIC 9(5).

      $XFD DATE=YYYYMMDD
           03  LX-LTOUCH-DATE      PIC 9(8) COMP-3.

      **************************************************
      *    T  - TRANSFER TRAILER RECORD.
      *  T   1 - 10  ANTIC          
      *  T  11 - 20 ANTIC-ADJ 
      **************************************************
           03  LXT-CODE            PIC X.
           03  LXT.
               05  LXT-EARN        PIC S9(7)V99  COMP-3 OCCURS 20.

      **************************************************
      *    P - TRANSFER TRAILER RECORD.
      *  P   1 - 10 ACCRERN
      *  P  11 - 20 UFERN(UPFRONT) 
      **************************************************
           03  LXP-CODE            PIC X.
           03  LXP.
               05  LXP-EARN        PIC S9(7)V99  COMP-3 OCCURS 20.

      **************************************************
      *    A - ADDON TRAILER RECORD.
      *                  (60 BYTES)
      *LXA-START-PMT HOLDS THE PAYMENT NUMBER WHERE THE NEW PAYMENT STARTS
      *LXA-END-PMT HOLD THE ENDING PAYMENT NUMBER FOR THE NEW PAYMENT.
      **************************************************
           03  LXA-CODE            PIC X.
           03  LXA.
               05  LXA-SRCD                PIC XX.

               05  LXA-PMT-SCHED-CHNG OCCURS 9.
                   07  LXA-START-PMT       PIC 99999     COMP-3.
                   07  LXA-END-PMT         PIC 99999     COMP-3.
                   07  LXA-NET-CHANGE      PIC S9(7)V99  COMP-3.

               05  LXA-LN-INSTBL.
                   07  LXA-LN-INSCOMP      PIC 99        COMP-3.
                   07  LXA-LN-INSOURS      PIC X.

      *-----------------------------------------------------------------
      * NOTE: THE USE OF LXA-LN-INSTRM CANNOT BE FOUND ANYWHERE IN
      *       A15 & A30.  I BELIEVE IT WAS ADDED AS TO MATCH UP
      *       WITH THE USE WITHIN THE LNFILE (LN-INSTRM).
      *       COMMENTING IT OUT TILL NEEDED.              JAY 2017-0508
      *-----------------------------------------------------------------
      $XFD DATE=YYYYMMDD
                   07  LXA-LN-INSEFF-DATE  PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
                   07  LXA-LN-INSEXP-DATE  PIC 9(8)      COMP-3.
                   07  LXA-LN-INSPREM      PIC S9(7)V99  COMP-3.
                   07  LXA-LN-INSCOVR      PIC S9(7)V99  COMP-3.
                   07  LXA-LN-INSCOMM      PIC S9(7)V99  COMP-3.

               05  LXA-LN-INS-REBATE       PIC X.
               05  LXA-LN-INSCODES         PIC X(3).

      **************************************************
      *    Z - AMORTIZED INTEREST (Z) PAYMENT INFO
      **************************************************
           03  LXZ-CODE         PIC X.
           03  LXZ.
               05  LXZ-POST-REGPY       PIC S9(7)V99 COMP-3.
               05  LXZ-POST-EXTRA-PRIN  PIC S9(7)V99 COMP-3.
               05  LXZ-POST-OTH         PIC S9(7)V99 COMP-3.
               05  LXZ-POST-LCHG        PIC S9(7)V99 COMP-3.

               05  LXZ-PDUE-APINT       PIC S9(7)V99 COMP-3.
               05  LXZ-PDUE-APPRIN      PIC S9(7)V99 COMP-3.
               05  LXZ-CUR-APINT        PIC S9(7)V99 COMP-3.
               05  LXZ-CUR-APPRIN       PIC S9(7)V99 COMP-3.


      **************************************************
      *    R - REBATE AMOUNT FOR 
      *        GEORGIA 4% CLOSING FEE EARLY PROVISION
      **************************************************
           03  LXR-CODE         PIC X.
           03  LXR.
               05  LXR-REB-AMT         PIC S9(7)V99  COMP-3.

      **************************************************
      *    X - INSURANCE TAX
      *                  (60 BYTES)
      **************************************************
           03  LXX-CODE         PIC X.
           03  LXX.
               05  LXX-INS-TAX-COUNTY-CD  PIC X(3).
               05  LXX-INS-TAX-CITY-CD    PIC X(3).


      **************************************************
      *    M - MONTHLY INSURANCE PREMIUM PAYMENT INFO:
      **************************************************
           03  LXM-CODE         PIC X.
           03  LXM.
               05  LXM-MIP-CLPAID      PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
               05  LXM-MIP-CLPDTH-DATE PIC 9(8)      COMP-3.
               05  LXM-MIP-AHPAID      PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
               05  LXM-MIP-AHPDTH-DATE PIC 9(8)      COMP-3.
           03  FILLER                 PIC X(97).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LX.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LX_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LX_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN PAYMENT TRAILER FILE - STANDARD
      *
      *=================================================================
      * REV:
      * BLM 2021-0504 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  LX1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LX1-CURSOR-STAT-GOOD              VALUE "00".
           88  LX1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LX1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLX1-WHERE-BEG-KEY.
           03  QLX1-WBEG-BRNO             PIC 9(04).
           03  QLX1-WBEG-ACCTNO           PIC 9(08).
           03  QLX1-WBEG-SEQNO            PIC 9(05).

       01  QLX1-WHERE-END-KEY.
           03  QLX1-WEND-BRNO             PIC 9(04).
           03  QLX1-WEND-ACCTNO           PIC 9(08).
           03  QLX1-WEND-SEQNO            PIC 9(05).

       01  QLX-REC.
           03  QLX-BRNO             PIC 9(4).
           03  QLX-ACCTNO           PIC 9(8).
           03  QLX-SEQNO            PIC 9(5).
           03  QLX-LTOUCH-DATE      PIC X(10).
           03  QLXT-CODE            PIC X.
           03  QLXT-EARN-1          PIC S9(7)V99.
           03  QLXT-EARN-2          PIC S9(7)V99.
           03  QLXT-EARN-3          PIC S9(7)V99.
           03  QLXT-EARN-4          PIC S9(7)V99.
           03  QLXT-EARN-5          PIC S9(7)V99.
           03  QLXT-EARN-6          PIC S9(7)V99.
           03  QLXT-EARN-7          PIC S9(7)V99.
           03  QLXT-EARN-8          PIC S9(7)V99.
           03  QLXT-EARN-9          PIC S9(7)V99.
           03  QLXT-EARN-10         PIC S9(7)V99.
           03  QLXT-EARN-11          PIC S9(7)V99.
           03  QLXT-EARN-12          PIC S9(7)V99.
           03  QLXT-EARN-13          PIC S9(7)V99.
           03  QLXT-EARN-14          PIC S9(7)V99.
           03  QLXT-EARN-15          PIC S9(7)V99.
           03  QLXT-EARN-16          PIC S9(7)V99.
           03  QLXT-EARN-17          PIC S9(7)V99.
           03  QLXT-EARN-18          PIC S9(7)V99.
           03  QLXT-EARN-19          PIC S9(7)V99.
           03  QLXT-EARN-20          PIC S9(7)V99.
           03  QLXP-CODE            PIC X.
           03  QLXP-EARN-1          PIC S9(7)V99.
           03  QLXP-EARN-2          PIC S9(7)V99.
           03  QLXP-EARN-3          PIC S9(7)V99.
           03  QLXP-EARN-4          PIC S9(7)V99.
           03  QLXP-EARN-5          PIC S9(7)V99.
           03  QLXP-EARN-6          PIC S9(7)V99.
           03  QLXP-EARN-7          PIC S9(7)V99.
           03  QLXP-EARN-8          PIC S9(7)V99.
           03  QLXP-EARN-9          PIC S9(7)V99.
           03  QLXP-EARN-10         PIC S9(7)V99.
           03  QLXP-EARN-11          PIC S9(7)V99.
           03  QLXP-EARN-12          PIC S9(7)V99.
           03  QLXP-EARN-13          PIC S9(7)V99.
           03  QLXP-EARN-14          PIC S9(7)V99.
           03  QLXP-EARN-15          PIC S9(7)V99.
           03  QLXP-EARN-16          PIC S9(7)V99.
           03  QLXP-EARN-17          PIC S9(7)V99.
           03  QLXP-EARN-18          PIC S9(7)V99.
           03  QLXP-EARN-19          PIC S9(7)V99.
           03  QLXP-EARN-20          PIC S9(7)V99.
           03  QLXA-CODE            PIC X.
           03  QLXA-SRCD                PIC XX.
           03  QLXA-START-PMT-1       PIC 99999.
           03  QLXA-END-PMT-1         PIC 99999.
           03  QLXA-NET-CHANGE-1      PIC S9(7)V99.
           03  QLXA-START-PMT-2       PIC 99999.
           03  QLXA-END-PMT-2         PIC 99999.
           03  QLXA-NET-CHANGE-2      PIC S9(7)V99.
           03  QLXA-START-PMT-3       PIC 99999.
           03  QLXA-END-PMT-3         PIC 99999.
           03  QLXA-NET-CHANGE-3      PIC S9(7)V99.
           03  QLXA-START-PMT-4       PIC 99999.
           03  QLXA-END-PMT-4         PIC 99999.
           03  QLXA-NET-CHANGE-4      PIC S9(7)V99.
           03  QLXA-START-PMT-5       PIC 99999.
           03  QLXA-END-PMT-5         PIC 99999.
           03  QLXA-NET-CHANGE-5      PIC S9(7)V99.
           03  QLXA-START-PMT-6       PIC 99999.
           03  QLXA-END-PMT-6         PIC 99999.
           03  QLXA-NET-CHANGE-6      PIC S9(7)V99.
           03  QLXA-START-PMT-7       PIC 99999.
           03  QLXA-END-PMT-7         PIC 99999.
           03  QLXA-NET-CHANGE-7      PIC S9(7)V99.
           03  QLXA-START-PMT-8       PIC 99999.
           03  QLXA-END-PMT-8         PIC 99999.
           03  QLXA-NET-CHANGE-8      PIC S9(7)V99.
           03  QLXA-START-PMT-9       PIC 99999.
           03  QLXA-END-PMT-9         PIC 99999.
           03  QLXA-NET-CHANGE-9      PIC S9(7)V99.
           03  QLXA-LN-INSCOMP        PIC 99.
           03  QLXA-LN-INSOURS        PIC X.
           03  QLXA-LN-INSEFF-DATE    PIC X(10).
           03  QLXA-LN-INSEXP-DATE    PIC X(10).
           03  QLXA-LN-INSPREM        PIC S9(7)V99.
           03  QLXA-LN-INSCOVR        PIC S9(7)V99.
           03  QLXA-LN-INSCOMM        PIC S9(7)V99.
           03  QLXA-LN-INS-REBATE     PIC X.
           03  QLXA-LN-INSCODES       PIC X(3).
           03  QLXZ-CODE             PIC X.
           03  QLXZ-POST-REGPY       PIC S9(7)V99.
           03  QLXZ-POST-EXTRA-PRIN  PIC S9(7)V99.
           03  QLXZ-POST-OTH         PIC S9(7)V99.
           03  QLXZ-POST-LCHG        PIC S9(7)V99.
           03  QLXZ-PDUE-APINT       PIC S9(7)V99.
           03  QLXZ-PDUE-APPRIN      PIC S9(7)V99.
           03  QLXZ-CUR-APINT        PIC S9(7)V99.
           03  QLXZ-CUR-APPRIN       PIC S9(7)V99.
           03  QLXR-CODE             PIC X.
           03  QLXR-REB-AMT          PIC S9(7)V99.
           03  QLXX-CODE               PIC X.
           03  QLXX-INS-TAX-COUNTY-CD  PIC X(3).
           03  QLXX-INS-TAX-CITY-CD    PIC X(3).
           03  QLXM-CODE               PIC X.
           03  QLXM-MIP-CLPAID         PIC S9(7)V99.
           03  QLXM-MIP-CLPDTH-DATE    PIC X(10).
           03  QLXM-MIP-AHPAID         PIC S9(7)V99.
           03  QLXM-MIP-AHPDTH-DATE    PIC X(10).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LX_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLX.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLX
      *********************************************************
      *        LIBLP/LPWSLX: LXFILE PATH WORKERS
      * LX-PATH = /USR/DATA/R#/XX####/GB/LXFILE
      *           |----BEG----||-MID-||-----FILE----|
      *                                  |---SQL----|
      *
      *********************************************************
       01  LX-PATH-OVERRIDE          PIC X(01)  VALUE SPACES.

       01  LX-PATH                   PIC X(35)  VALUE SPACES.
       01  FILLER                    REDEFINES LX-PATH.
           03  LX-PATH-BEG           PIC X(13).
           03  LX-PATH-OWNST         PIC X(02).
           03  LX-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  LX-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LX-PATH-FILE.
               05  FILLER            PIC X(03).
               05  LX-PATH-SQL       PIC X(12).

       01  LX-ALL-PATH.
           03  LX-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES LX-ALL-BASE.
               05  LX-ALL-BASE-USR   PIC X(05).
               05  LX-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)  VALUE "/".
           03  LX-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(01)  VALUE "/".
           03  LX-ALL-DATA           PIC X(06).
           03  FILLER                PIC X(10)  VALUE "/GB/LXFILE".

      * ADDED THIS BECAUSE IT WAS USING SUB IN THE CLEAR-LX-FILE AND THAT
      * TOTALLY MESSED UP LONPF2 USING SUB IN THE TR1 FILE UPDATE ROUTINE!
       01  LX-SUB                    PIC 99.
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLX.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LXE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LXE
      ******************************************************************
      *
      * LOAN PAYMENT TRAILER EARNINGS FILE: 
      *
      *   LXE1-KEY = LXE-BRNO, LXE-ACCTNO, LXE-SEQNO
      *
      *  BAH 190115 SPLIT OUT FROM LXFILE
      *  CS 190502 TALKED WITH BETH, THE LX,LXE,LXG,LN,PD,LP ARE PASSED VIA
      *            LP01WK, A LOT OF EFFORT WAS PUT IN TO MAKE THE WORK RECORD
      *            ACCURATE, SO... KEEP THE FILE SIZES THE SAME SIZE AS THE
      *            WORK RECORD.
      *   CS190516 CHANGED OCCURS FROM GROUP LEVEL
      *   CS 190606 NEEDS TO STAY SAME AS WK-LXE
      *  BAH 20200324 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      *  BAH 20210427 REMOVED FUTURE FIELDS
      *  BAH 20230600 ADDED FILLER
      **************************************************************************
       78  LXE-SIZE                                VALUE 270.
       01  LXE-REC.
           03  LXE1-KEY.
               05  LXE-BRNO         PIC 9(4).
               05  LXE-ACCTNO       PIC 9(8).
               05  LXE-SEQNO        PIC 9(5).
      $XFD DATE=YYYYMMDD
           03  LXE-LTOUCH-DATE      PIC 9(8) COMP-3.

      **************************************************
      *    E - EARNINGS TRAILER RECORD.
      *                  
      * EARNINGS 4 - 10
      **************************************************
           03  LXE-EARN            PIC S9(7)V99  COMP-3 OCCURS 7.

      * WHEN SP-ERNFRMLA = 15 & 16, THIS FIELD HOLDS IB-EARNINGS
      * INTEREST OWING BEFORE THIS TRANSACTION

           03  LXE-WORKER          PIC S9(7)V99  COMP-3.

      * WHEN SP-ERNFRMLA = 15 & 16, THIS FIELD HOLDS IB-EARNINGS
      * INTEREST TAKEN ON THIS TRANSACTION

           03  LXE-WORKER2         PIC S9(7)V99  COMP-3.
           03  FILLER                 PIC X(203).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LXE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LXE_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LXE_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN TRAILER FILE - EARNINGS
      *
      *=================================================================
      * REV:
      * BLM 2021-0504 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  LXE1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  LXE1-CURSOR-STAT-GOOD             VALUE "00".
           88  LXE1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LXE1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLXE1-WHERE-BEG-KEY.
           03  QLXE1-WBEG-BRNO             PIC 9(04).
           03  QLXE1-WBEG-ACCTNO           PIC 9(08).
           03  QLXE1-WBEG-SEQNO            PIC 9(05).

       01  QLXE1-WHERE-END-KEY.
           03  QLXE1-WEND-BRNO             PIC 9(04).
           03  QLXE1-WEND-ACCTNO           PIC 9(08).
           03  QLXE1-WEND-SEQNO            PIC 9(05).

       01  QLXE-REC.
           03  QLXE-BRNO         PIC 9(4).
           03  QLXE-ACCTNO       PIC 9(8).
           03  QLXE-SEQNO        PIC 9(5).
           03  QLXE-LTOUCH-DATE   PIC X(10).
           03  QLXE-EARN-1        PIC S9(7)V99.
           03  QLXE-EARN-2        PIC S9(7)V99.
           03  QLXE-EARN-3        PIC S9(7)V99.
           03  QLXE-EARN-4        PIC S9(7)V99.
           03  QLXE-EARN-5        PIC S9(7)V99.
           03  QLXE-EARN-6        PIC S9(7)V99.
           03  QLXE-EARN-7        PIC S9(7)V99.
           03  QLXE-WORKER        PIC S9(7)V99.
           03  QLXE-WORKER2       PIC S9(7)V99.

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LXE_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLXE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLXE
      *********************************************************
      *        LIBLP/LPWSLXE: LXEFILE PATH WORKERS
      * LXE-PATH = /USR/DATA/R#/XX####/GB/LXEFILE
      *           |----BEG----||-MID-||-----FILE----|
      *                                  |---SQL----|
      *
      *********************************************************
       01  LXE-PATH-OVERRIDE          PIC X(01)  VALUE SPACES.

       01  LXE-PATH                   PIC X(35)  VALUE SPACES.
       01  FILLER                     REDEFINES LXE-PATH.
           03  LXE-PATH-BEG           PIC X(13).
           03  LXE-PATH-OWNST         PIC X(02).
           03  LXE-PATH-OWNBR         PIC 9(04).
           03  FILLER                 PIC X(01).
           03  LXE-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LXE-PATH-FILE.
               05  FILLER             PIC X(03).
               05  LXE-PATH-SQL       PIC X(12).

       01  LXE-ALL-PATH.
           03  LXE-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES LXE-ALL-BASE.
               05  LXE-ALL-BASE-USR   PIC X(05).
               05  LXE-ALL-BASE-DIR   PIC X(04).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LXE-ALL-MACHINE        PIC X(02).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LXE-ALL-DATA           PIC X(06).
           03  FILLER                 PIC X(11)  VALUE "/GB/LXEFILE".
       01  LXE-SUB                    PIC 99.
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLXE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LXG.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LXG
      ******************************************************************
      *
      * LOAN PAYMENT TRAILER GENERAL LEDGER DIST FILE:
      *
      *    LXG1-KEY = LXG-BRNO, LXG-ACCTNO, LXG-SEQNO
      *
      * CODE:
      *=================================================================
      * REV:
      *  BAH 190115 SPLIT OUT FROM LXFILE
      *  CS 190502 TALKED WITH BETH, THE LX,LXE,LXG,LN,PD,LP ARE PASSED VIA
      *            LP01WK, A LOT OF EFFORT WAS PUT IN TO MAKE THE WORK RECORD
      *            ACCURATE, SO... KEEP THE FILE SIZES THE SAME SIZE AS THE
      *            WORK RECORD.
      *  CS 190516 CHANGE OCCURS FROM GROUP LEVEL ON FUTURE FIELDS
      *  BAH 20200324 CLEANED UP FUTURE FIELDS
      *  BAH 20210427 REMOVED FUTURE FIELDS
      *  BAH 20230600 ADDED FILLER
      **************************************************************************
       78  LXG-SIZE                                  VALUE 300. 
       01  LXG-REC.
           03  LXG1-KEY.
               05  LXG-BRNO         PIC 9(4).
               05  LXG-ACCTNO       PIC 9(8).
               05  LXG-SEQNO        PIC 9(5).
      $XFD DATE=YYYYMMDD
           03  LXG-LTOUCH-DATE      PIC 9(8) COMP-3.

      **************************************************
      *    G - GENERAL LEDGER DISTRIBUTION RECORD:
      **************************************************
           03  LXG-GLTBL           OCCURS 3.
               05  LXG-GLNO         PIC 9(11)     COMP-3.
               05  LXG-GLAMT        PIC S9(7)V99  COMP-3.
           03  FILLER                 PIC X(245).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LXG.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LXG_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LXG_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN TRAILER FILE - G/L
      *
      *=================================================================
      * REV:
      * BLM 2021-0504 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  LXG1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  LXG1-CURSOR-STAT-GOOD             VALUE "00".
           88  LXG1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LXG1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLXG1-WHERE-BEG-KEY.
           03  QLXG1-WBEG-BRNO             PIC 9(04).
           03  QLXG1-WBEG-ACCTNO           PIC 9(08).
           03  QLXG1-WBEG-SEQNO            PIC 9(05).

       01  QLXG1-WHERE-END-KEY.
           03  QLXG1-WEND-BRNO             PIC 9(04).
           03  QLXG1-WEND-ACCTNO           PIC 9(08).
           03  QLXG1-WEND-SEQNO            PIC 9(05).

       01  QLXG-REC.
           03  QLXG-BRNO         PIC 9(4).
           03  QLXG-ACCTNO       PIC 9(8).
           03  QLXG-SEQNO        PIC 9(5).
           03  QLXG-LTOUCH-DATE      PIC X(10).
           03  QLXG-GLNO-1         PIC 9(11).
           03  QLXG-GLAMT-1        PIC S9(7)V99.
           03  QLXG-GLNO-2         PIC 9(11).
           03  QLXG-GLAMT-2        PIC S9(7)V99.
           03  QLXG-GLNO-3         PIC 9(11).
           03  QLXG-GLAMT-3        PIC S9(7)V99.

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LXG_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLXG.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLXG
      *********************************************************
      *        LIBLP/LPWSLXG: LXGFILE PATH WORKERS
      * LXG-PATH = /USR/DATA/R#/XX####/GB/LXGFILE
      *           |----BEG----||-MID-||-----FILE----|
      *                                  |---SQL----|
      *
      *********************************************************
       01  LXG-PATH-OVERRIDE          PIC X(01)  VALUE SPACES.

       01  LXG-PATH                   PIC X(35)  VALUE SPACES.
       01  FILLER                     REDEFINES LXG-PATH.
           03  LXG-PATH-BEG           PIC X(13).
           03  LXG-PATH-OWNST         PIC X(02).
           03  LXG-PATH-OWNBR         PIC 9(04).
           03  FILLER                 PIC X(01).
           03  LXG-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LXG-PATH-FILE.
               05  FILLER             PIC X(03).
               05  LXG-PATH-SQL       PIC X(12).

       01  LXG-ALL-PATH.
           03  LXG-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES LXG-ALL-BASE.
               05  LXG-ALL-BASE-USR   PIC X(05).
               05  LXG-ALL-BASE-DIR   PIC X(04).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LXG-ALL-MACHINE        PIC X(02).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LXG-ALL-DATA           PIC X(06).
           03  FILLER                 PIC X(11)  VALUE "/GB/LXGFILE".
       01  LXG-SUB                    PIC 99.
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLXG.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01CD.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01CD
      ******************************************************************
      *
      *   DESCRIPTION:  CODE DESCRIPTION FILE
      *
      *  CD1-KEY = CD-TYPE, CD-CODE
      *
      *=================================================================
      *  TYPE CODE* NUM DESCRIPTION
      *  ---- ----- --- ----------------------------------------------
      *   AC    4    0  ACTION  [CD-CODE WAS "{" IN A15/A30]
      *   A2    4    0  ACTION CODE 2 SECURITIZATION
      *   AT    3    0  ACTIVITY
      *   BR    5    0  BATCH (PAYMENT) REFERENCE
      *   BS    5    0  PAYMENT REFERENCE CODE LP-REFNO
      *   BW    4    0  BORROWER HOUSING 
      *   CH    2    0  CHARGE OFF (P&L) REASON
      *   CL    4    0  CAN LOAN GROUP ID
      *   CO    2    0  COLLATERAL
      *   CT    5    0  COUNTY INSURANCE TAX RATES FOR KENTUCKY
      *   CY    5    0  CITY INSURANCE TAX RATES FOR KENTUCKY
      *   DF    2    0  DEFERMENT REASON  
      *   EA    6    0  EXTRACTION/ACTION GROUP ID
      *   EL    0    2  EXTENDED LATE CHARGE INFO
      *   FC    1    0  FORM CHARGES (AMT TO OTHBAL)
      *   FU    4    0  FOLLOW-UP             
      *   FZ    2    0  FROZEN REASON
      *   ID    2    0  ID TYPE (KNOW YOUR CUSTOMER SCREENS)  
      *   JT    5    0  JOB TYPE DESCRIPTIONS
      *   LO    4    0  LPO  (TFC)     
      *   LS    2    0  REPO REASON                         
      *   LV    0    1  GROUP LEVELS
      *   OR    4    0  BORROWER ORIGIN
      *** PA    1    0  PAYROLL CODES FOR TIMESHEET PROCESSING (REMOVED)
      *   PC    1    0  PROCESS (TFC)
      *   PH    2    0  PHONE NUMBER DESCRIPTIONS
      *   PL    0    5  POOL ID
      *   PO    2    0  PAYOFF
      *   PS    2    0  PAYMENT RESCHEDULE
      *   PU    3    0  PURPOSE
      *   PX    1    0  P&L
      *   RC    8    0  REP (TFC) 
      *   RE    3    0  COLLECTION RESULT
      *   SR    2    0  SOURCE
      *   TC    2    0  TRAN CODE REFERENCE PAYMENTS
      *   TS    2    0  TRW SPECIAL
      *   UW    2    0  UNWIND SALES FINANCE VOID                 
      *   XL    2    0  COLLATERAL LOCATION (REPO) CHREP4    
      *
      *   * = NUMBER FOR THE CODE REPRESENTS THE MAX LENGTH/BYTES
      *       OF THE CODE FOR GIVEN TYPE.
      *
      *=================================================================
      * REV:
      * SLC 042995 SLC ADDED PLTYPE LOGIC.
      * KEC 020596 KEC ADDED COLLECTOR QUEUE CODE GROUP ID.
      * KEC 020896 KEC ADDED COLLECTOR ID CODE.
      * KEC 031496 KEC ADDED THREE FIELDS:   CD-RE-WORKED;
      *                   CD-RE-RESCHEDULE-REQ; CD-RE-RESCHEDULE-TIME.
      * KEC 071096 KEC ADDED CD-ELUNITPER-CD FOR CONVERSION FROM A50.
      * KEC 092796 KEC ADDED BORROWER HOUSING CODE LAYOUT.
      * KEC 111596 KEC REDEFINED 'CD-CODE' FOR CD-POCD1 AND CD-POCD2.
      * JTG 021797 JTG ADDED CD-FCREC, FORM CHARGES (BHFC)
      * JTG 032797 JTG ADDED CD-RF.....FIELDS FOR APPLICATION
      *                 STATUS CODES
      * JTG 050797 JTG CHANGED CD-ELREC TO MAP TO SP-REC COMP FIELDS
      *                 NOT COMP-3
      * BAH 071197 BAH ADDED CD-GLFEEFINCHG FROM A90 FOR WORLD
      * MJD 071497 MJD ADDED CD-CLREC FOR CAN GROUP ID.
      * JTG 071497 JTG ADDED CODES FOR GIFTNET IN CD-FEEREC
      *                    CD-GLFEE-INT-CHARGABLE
      *                    CD-FEE-GIFTNET
      *                    CD-FEE-PRODNO
      *                    CD-FEE-PRICE
      *                    CD-NEW-PRODNO
      * KEC 092198 ADDED CODE TYPE [ 'PR' PRODUCT CODES (REVOLVING) ]
      * KEC 100198 ADDED CODE TYPE [ 'RP' REVOLVING PROGRAM CODES   ]
      *             INCREASED RECORD SIZE BY 14 BYTES          RSZ: 0070
      * KEC 110398 REMOVED CODE TYPE [ 'RP' REVOLVING PROGRAM CODES   ]
      *             RECORD SIZE REMAINED THE SAME              RSZ: 0070
      * JTG 120798 ADDED CODE TYPE 'RO' -  REVOLVING OTHER CHARGE CODES
      * MJD 990125 ----- UPDATED IN FLEXGEN -----
      * MJD 990303 ADDES "BS" REDEFINITION FOR VALID REFNO'S
      * GLF 990403 ADDED "LO" LOAN PROCESSING OFFICE, "RC"
      *            REP CODE, AND "PC" PROCESS CODE - TFC
      * KEC 990510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BAH 990720 CHANGE ELFRMLA-VALID TO INCLUDE J AND K
      * JTG 990729 ADDED CD-RO-NUM TO PROVIDE AN ALPHA KEY RE: CD-RO-CODE
      * KEC 990805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * KEC 990811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * GLB 990818 ADD GL ACCOUNTS FOR REVOLVING OTHER CHARGES
      * GLF 990830 ADD TRW SPECIAL CODES (TS) FOR TFC PR #51
      * KEC 000410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BLV 112700 ADDED CD-EA-GQ-FG TO DESIGNATE EXTRACTION GROUP AS GLOBAL
      *            QUEUING RATHER THAN REGULAR LOCAL QUEUING,  TFC PR# 60
      * BLV 010829 ADDED "FU" REDEFINITION FOR LOAN FOLLOWUP CODE, PR# 1487
      * JTG 020201 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *            ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS   WORLD #288
      * CS  020213 ADDED CD-CY-BOTH-TAX-FG TO CD-CY-REC. USED TO IDENTIFY
      *            IF BOTH CITY & COUNTY TAX SHOULD BE CHARGED   [WORLD PR#288]
      * JTG 020220 CREATED COPY MEMBERS LIBLP/LPCDCT AND LIBLP/LPCDCY
      *            FOR CALCZL.C AND CALCZ3.C                          WORLD #288
      * JTG 020304 REMOVED COPY MEMBERS LIBLP/LPCDCT AND LIBLP/LPCDCY
      *            FOR CALCZL.C AND CALCZ3.C                          WORLD #288
      *
      * KEC 020617 {PR#01823} REGIONAL ACCEPTANCE <A15> [KEVIN MULLEN]
      *            ADDED CD-FEE-MAXAMTPIC 9(5)V99 COMP-3.
      * BAH 020625 ADDED TYPES OF "LS" AND "CH" FOR REPO REASON AND CHARGE
      *            OFF (P&L) REASON, REGACC PR# 1775
      * JTG 021010 ADDED NEW CODE FILE TYPE 'BR' - BATCH REFERENCE PAYMENT CODES
      *                                                             REGACC #0006
      * JTG 021114 ADDED CD-BR-LC-FG                                REGACC #0006
      * BAH 030424 ADDED CD-ALT-GLFEENO FOR LENDMARK PR# 2048
      * CS  031107 ADDED CD-COMM-GLFEENO CD-COMM-PERCENT (GC)
      * JTG 040330 ADDED LOGIC FOR POSTING BATCH PAYMENTS TO ACCOUNT'S
      *            WITH 'LN-OTBAL'                                 CENTRIX #2253
      * CS  040805 ADDED NEW CODE TYPE 'TC' TRANSACTION CODE REF CODES
      *                                        [LENDMARK PR#2353]
      *
      * KEC 041117 {PR#02407} LENDMARK <A15> [KEVIN MULLEN]
      *            ADDED NEW CODE TYPE OF "AS".
      *
      * KEC 050103 {PR#02407} LENDMARK <A15> [KEVIN MULLEN]
      *            CHANGED NEW CODE TYPE OF "AS" FROM X(2) TO X(6).
      *
      * JTG 050608 ADDED CHANGES FOR REPORTING AND TAKING FEE CODE EARNINGS
      *            CREATED CD-FEE-EARNINGS-FG                     LENDMARK #2542
      *
      * BAH 050914 ADDED "DF" - DEFEREMENT REASON CODES, LENDMARK PR# 2568
      * JTG 050927 ADDED NEW CODE TYPE "UW" UNWIND SALES FINANCE VOID
      *            LN-POCD-UNWIND "*U" A LN-POCD-NONLOAN
      *                  AND LN-UNWIND-REASON-CODE                  REGACC #0105
      * BAH 051027 ADDED NEW CODE TYPE "FZ" FROZEN REASON CODE REGACC PR# 114
      * BLF 051107 ADDED CD-BR-MULTIPLE-REFCDS, REGACC PR# 107
      * BLF 060320 ADDED CD-BR-ACH-FG, LENDMARK PR# 2711
      * BAH 060501 ADDED CD-GROUP FOR COLLATERAL CODES, TO GROUP THEM;
      *            LENDMARK PR# 2777
      *  CS 060531 ADD EVENT CODE PR# 2503 SECURITY
      * BLF 060908 ADDED NEW CODE TYPE "PA", PAYROLL CODES FOR TIME SHEET
      *            PROCESSING, WORLD PR# 488	
      * BLF 070215 ADDED CD-BR-PAYOFF-FG, WILL COMPUTE PAYOFF AMT FOR
      *            BT RECORDS, REGACC PR# 160
      *  CS 070417 ADDED CD-BR-POST-SS-TRCD  TO POST 'SS' SALE OF SECURITY
      *                                                REGACC PR#168
      * MJD 070815 ADDED CD-ID-REC                     REGENCY PR#3032
      * BLM 080930 RENAMED CD-BR-ACH-FG TO CD-BR-COLLECT-LC, WASN'T USING
      *            THE ACH FLAG??  WORLD NEEDS TO HAVE SOME INS CLAIM PMTS
      *            LIKE A&H POST PMT BUT DON'T APPLY TO LATE CHARGES
      *            OWING, WORLD PR# 603
      * BLM 081009 ADDED CD-CN-GROUP-ID, REGACC PR# 220
      *
      * KEC 081223 {PR#00000} PARADATA <A15> [JAY CISZEWSKI]
      *            HAD TO RENAME THE 78 LEVELS 'SET-CD-LR-...' TO
      *            'CD---LR-...'.
      *
      *  CS 090923 ADDED CD-ACTIVITY-REQUIRED TO RESULT (CD-AC-RE-REC). IF
      *            CD-ACTIVITY-REQUIRED = "Y", DONT ALLOW A SPACE AS THE
      *            ACTIVITY   PR#255 REGACC
      * BLM 110127 ADDED NEW TYPE "JT" FOR JOB TYPE DESCRIPTIONS, WORLD PR# 739
      * BAH 110411 ADDED NEW TYPE "PS" FOR PAYMENT RESCHEDULE, USED THIS CODE
      *            TO MATCH PAYMENT POSTING CODE OF "PS", REGACC PR# 290
      * BAH 120904 ADDED CD-TITLE-HOLD-DAYSPIC 9(2) FOR PAYOFF CODE ONLY
      *            REGACC PR# 319
      * BAH 130524 ADDED CD-CN-PHONE AND CD-CN-PHONE-EXT, NEWPORT PR# 4272
      *  CS 150819 ADD CD-BRANCH-COMM-AMOUNT EXCEL PR#4821
      *  CS 150922 CHANGED CD-BRANCH-COMM-AMOUNT TO COMP3 PR#4821
      *
      * KEC 2016.0303 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         - INCREASE CD-REC; CD-SIZE = 250; CD1-KEY = 20
      *         - ADDED CD-LTOUCH-DATE.
      *         - CHANGED CD-REC THAT EACH CODE TYPE HAS ITS OWN
      *           REDEFINITION (CD-??-REC) TO OMIT CONFUSION.
      *           FOR CONSISTENCY, EACH REDEFINITION (CD-??-REC)
      *           WILL HAVE THE FOLLOWING:
      *            - KEY (20 BYTES);
      *            - LTOUCH-DATE (5 BYTES);
      *            - DESC (35 BYTES);
      *            - UNIQUE FIELDS PERTAINING TO CODE TYPE (190 BYTES).
      *         - CHANGED COMP-6 TO BE COMP-3.
      *         - DUE TO BUG FOUND, CREATED CD-AT-REC FOR TYPE "AT" AND
      *           SPLIT OUT CD-AT-REC FIELDS FROM CD-AC-RE-REC FIELDS.
      *         - CHANGED CD-AC-RE-REC TO BE CD-RE-REC, AS WELL AS
      *           CHANGED ITS FIELD TO HAVE A CD-RE- PREFIX.
      *         - CODE TYPE EL, CHANGED COMP TO COMP-3 WHICH WILL NEED
      *           TO MATCH TO SP-LC-INFO FIELDS.
      *         - CODE TYPE RC, REMOVED HASH ON CD-RC-CODE.
      *         - CODE TYPE RL (RELATION CODES) NO LONGER IN USE.
      *
      * KEC 2016.0803 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         PER BARB/CINDY, INCREASE CD-GC-COMM-PERCENT A BYTE
      *         DUE TO A RECENT WORLD NEED. [PIC 999V99     COMP-3.]
      * BAH 2017.1117 FIXED CD-EL-REC FIELDS SIZES (ELREAD.CBL)
      *
      *=============================[ A15 & A30 ABOVE; A32 & A34 BELOW ]
      * KEC 2018-1120 A32 & A34 DEVELOPMENT.
      *         THESE ACTIONS WERE DONE TO THE 47 LAYOUTS OF CDFILE
      *         FROM THE A30 LAYOUT:
      *          'JOINED' TO USE THE STANDARD KEY (CD-TYPE OF 2,
      *           CD-CODE OF 8, CD-NUMBER OF 8) OF THE CDFILE;
      *          'REMOVED' LAYOUTS BECAUSE WORLD DOES NOT USE;
      *          'MOVED' TO BE A NEW FILE BECAUSE THE KEY DID NOT FIT
      *           THE STANDARD KEY OF THE CDFILE; MOVED TO
      *           LIBLP/LP01CDB (CDBFILE; CN & GC).
      *
      *         TYPE  DESC                                      ACTION
      *         ----  ----------------------------------------  -------
      *          AC  ACTION                                     JOINED 
      *          AS  ADVERTISING SOURCE                         REMOVED
      *          AT  ACTIVITY                                   JOINED
      *          BR  BATCH (PAYMENT) REFERENCE                  JOINED
      *          BS  REFERENCE  (LP-REFNO)                      JOINED
      *          BW  BORROWER HOUSING                           JOINED
      *          CH  CHARGE OFF (P&L) REASON                    JOINED
      *          CL  CAN LOAN GROUP ID                          JOINED
      *          CN  COLLECTOR ID                               MOVED
      *          CO  COLLATERAL                                 JOINED
      *          CT  COUNTY TAX PERCENTS (KENTUCKY)             JOINED
      *          CY  CITY   TAX PERCENTS (KENTUCKY)             JOINED
      *          DF  DEFERMENT REASON                           JOINED
      *          EA  EXTRACTION/ACTION GROUP ID                 JOINED
      *          EL  EXTENDED LATE CHARGE INFO                  JOINED
      *          FC  FORM CHARGES                               JOINED
      *          FU  FOLLOW-UP                                  JOINED
      *          FZ  FROZEN REASON                              JOINED
      *          GC  FEE                                        MOVED
      *          ID  ID TYPE (KNOW YOUR CUSTOMER SCREENS)       JOINED
      *          JT  JOB TYPE                                   JOINED
      *          LO  LPO  (TFC)                                 JOINED
      *          LS  REPO REASON                                JOINED
      *          LV  GROUP LEVELS                               JOINED
      *          PA  PAYROLL (TIME SHEET PROCESSING)            JOINED
      *          PC  PROCESS (TFC)                              JOINED
      *          PH  PHONE NUMBER DESCRIPTIONS                  JOINED
      *          PL  POOL ID                                    JOINED
      *          PO  PAYOFF                                     JOINED
      *          PR  PRODUCTS (REVOLVING)                       REMOVED
      *          PS  PAYMENT RESCHEDULE                         JOINED
      *          PU  PURPOSE                                    JOINED
      *          PX  P&L                                        JOINED
      *          RC  REP (TFC)                                  JOINED
      *          RE  COLLECTION RESULT                          JOINED
      *          RF  TURN DOWN (REFUSAL CODES/LOAN APPS)        REMOVED
      *          RL  RELATION                                   REMOVED
      *          RO  REVOLVING OTHER CHARGE                     REMOVED
      *          SR  SOURCE                                     JOINED
      *          TC  TRAN CODE REFERENCE PAYMENTS               JOINED
      *          TS  TRW SPECIAL                                JOINED
      *          UW  UNWIND SALES FINANCE VOID                  JOINED
      *          XL  COLLATERAL LOCATION (REPO) CHREP4          JOINED
      *
      *         NOTE: THE CD-TYPE OF "{" FOR ACTION CODES IN A30 WAS
      *               CHANGED TO "AC".
      *
      * BAH 2020-0210 ADDED NEW TYPE "OR"; BORROWER ORIGIN (4) #1421
      * BAH 2020-0323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * JKC 2021-1101 CHANGED CD-ELUNITPER-CD FROM PIC 9 TO PIC X.
      *  BAH 20230600 ADDED FILLER
      ******************************************************************
       78  CD-SIZE                             VALUE 390.
       01  CD-REC.
           03  CD1-KEY.
               05  CD-TYPE                   PIC X(2).
               05  CD-CODE                   PIC X(8).
               05  CD-CODE-CT        REDEFINES CD-CODE.
                   07  CD-CT-STATE           PIC X(2).
                   07  CD-CT-COUNTY          PIC X(3).
                   07  CD-CT-FILLER          PIC X(3).
               05  CD-CODE-CY        REDEFINES CD-CODE.
                   07  CD-CY-STATE           PIC X(2).
                   07  CD-CY-CITY            PIC X(3).
                   07  CD-CY-FILLER          PIC X(3).
               05  CD-CODE-EL        REDEFINES CD-CODE.
                   07  CD-EL-CODE            PIC 9(2).
                   07  CD-EL-FILLER          PIC X(6).
               05  CD-CODE-LV        REDEFINES CD-CODE.
                   07  CD-LV-LEVEL           PIC 9(1).
                   07  CD-LV-FILLER          PIC X(7).
               05  CD-CODE-PL        REDEFINES CD-CODE.
                   07  CD-PL-POOLID          PIC 9(5).
                   07  CD-PL-FILLER          PIC X(3).

      $XFD DATE=YYYYMMDD
           03  CD-LTOUCH-DATE                PIC 9(08)      COMP-3.
           03  CD-DESC                       PIC X(35).

      *-----------------------------------------------------{ ACTIVITY }
           03  CD-AT-ACTIONCD                PIC X(04).
           03  CD-AT-MEMO-REQUIRED           PIC X(01).
           03  CD-AT-SUPERVISOR-ONLY         PIC X(01).
           03  CD-AT-RESULT-REQUIRED         PIC X(01).

      *------------------------------------{ BATCH (PAYMENT) REFERENCE }
      * CD-BR-FILE-TYPE  VALID;
      * S  - STANDARD FORMAT
      * LC - LATE CHARGE ACCESS OPTION
      * B  - BANKRUPT FILE FORMAT
      * C  - CASHLESS DEBIT CARD UMC PURCHASE
           03  CD-BR-FILE-TYPE               PIC XX.
           03  CD-BR-FILE-NAME               PIC X(6).
           03  CD-BR-PAYOFF-FG               PIC X.
           03  CD-BR-POST-SS-TRCD            PIC X.
           03  CD-BR-GL-ACCOUNTS.
               05  CD-BR-GL-BRANCH           PIC 9(4).
               05  CD-BR-GL-ACCT             PIC 9(7).
           03  CD-BR-ALLOT-OPTION            PIC X.
           03  CD-BR-LBOX-OPTION             PIC X.
           03  CD-BR-LC-FG                   PIC X.
           03  CD-BR-OT-GL-ACCOUNTS.
               05  CD-BR-OT-GL-BRANCH        PIC 9(4).
               05  CD-BR-OT-GL-ACCT          PIC 9(7).
           03  CD-BR-MULTIPLE-REFCDS         PIC X.
           03  CD-BR-COLLECT-LC              PIC X.

      *---------------------------------------------------{ COLLATERAL }
           03  CD-CO-GROUP                   PIC X(01).
           03  CD-CO-SECURED                 PIC X(01).
           03  CD-CO-TRW                     PIC X(02).

      *----------------------{ COUNTY INSURANCE TAX RATES FOR KENTUCKY }
      *    01 = CL DEC           05 = AH      09 = O2
      *    02 = CL DEC JOINT     06 = PP      10 = O3
      *    03 = CL LEV           07 = PP2     11 = O4
      *    04 = CL LEV JOINT     08 = O1      12 = O5
      *-----------------------------------------------------------------
           03  CD-CT-INSTBL                    OCCURS 12.
               05  CD-CT-INSTAXFRMLA         PIC X.
               05  CD-CT-INSTAXAMT           PIC 99V99      COMP-3.
           03  CD-CT-BOTH-TAX-FG             PIC X.

      *------------------------{ CITY INSURANCE TAX RATES FOR KENTUCKY }
      *    01 = CL DEC           05 = AH      09 = O2
      *    02 = CL DEC JOINT     06 = PP      10 = O3
      *    03 = CL LEV           07 = PP2     11 = O4
      *    04 = CL LEV JOINT     08 = O1      12 = O5
      *-----------------------------------------------------------------
           03  CD-CY-INSTBL                    OCCURS 12.
               05  CD-CY-INSTAXFRMLA         PIC X.
               05  CD-CY-INSTAXAMT           PIC 99V99      COMP-3.
           03  CD-CY-BOTH-TAX-FG             PIC X.

      *-----------------------------------{ EXTRACTION/ACTION GROUP ID }
           03  CD-EA-CQ-FG                   PIC X(1).
           03  CD-EA-GQ-FG                   PIC X(1).

      *------------------------------------{ EXTENDED LATE CHARGE INFO }
      *    LATE CHARGE FIELDS                  (22 BYTES)
      *
      *    NOTE:  CD-EL-INFO AREA MAPS TO THE SP-REC FIELD SP-LC-INFO
      *           (FIRST 22 BYTES; NOT INCLUDING SP-LC-CODE WHICH IS
      *            THE LAST 2 BYTES).
      *           IF CD-EL-INFO CHANGES YOU  ***MUST*** CHANGE
      *           THE SP-LC-INFO FIELDS TO MATCH.
      *-----------------------------------------------------------------
           03  CD-EL-INFO.
               05  CD-ELGRACE                PIC 9(2).
               05  CD-ELGRACECD              PIC X(1).
                   88 CD-ELGRACECD-VALID       VALUE " " "S" "W".
               05  CD-ELTYPE                 PIC X(2).
                   88  CD-ELTYPE-VALID         VALUE " " "A" THRU "O"
                                                     "Q".
               05  CD-ELRATE                 PIC 9(4)V9(4)  COMP-3.
               05  CD-ELFRMLA                PIC X(2).
                   88  CD-ELFRMLA-VALID        VALUE " " "A" THRU "N".
               05  CD-ELMINCHG               PIC 9(2)V99    COMP-3.
               05  CD-ELMAXAMT               PIC 9(4)V99    COMP-3.
               05  CD-ELDELFAC               PIC 9(3)       COMP-3.
                   88  CD-ELDELFAC-VALID       VALUE 0 THRU 100.
               05  CD-ELYRTYPE               PIC 9(4)       COMP-3.
                   88  CD-ELYRTYPE-VALID       VALUE 358 360 365 367.
           03  CD-ELUNITPER-CD               PIC X(1).

      *-------------------------------------------------------{ PAYOFF }
           03  CD-PO-TITLE-HOLD-DAYS         PIC 9(02).

      *--------------------------------------------{ COLLECTION RESULT }
           03  CD-RE-ACTIONCD                PIC X(04).
           03  CD-RE-MEMO-REQUIRED           PIC X(01).
           03  CD-RE-SUPERVISOR-ONLY         PIC X(01).
           03  CD-RE-ACTIVITY-REQUIRED       PIC X(01).
           03  CD-RE-RESCHEDULE-REQ          PIC X(01).
           03  CD-RE-RESCHEDULE-TIME         PIC 9(03).
           03  CD-RE-WORKED-ACCOUNT          PIC X(01).

      *--------------------------------------------{ FORM CHARGES }
           03  CD-FC-FEEAMT                  PIC S9(7)V99 COMP-3.

      *--------------------------------------{ TRANSACTION REFERENCE CODES }
           03  CD-TC-REFNO                   PIC X(05) OCCURS 10.

      *----------------------------------{ PAYMENT RESCHEDULE REASON CODES }
           03  CD-PS-TDR-FLAG                PIC X(01).

           03  FILLER                        PIC X(97).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01CD.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01CD_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01CD_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - CODE DESCRIPTION MASTER FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0430 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  CD1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  CD1-CURSOR-STAT-GOOD              VALUE "00".
           88  CD1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{NOT GREATER CURSOR FOR START-NOT-GREATER & READ-PREVIOUS}
       01  CD1-CURSOR-NG-STAT           PIC X(2) VALUE SPACES.
           88  CD1-CURSOR-NG-STAT-GOOD           VALUE "00".
           88  CD1-CURSOR-NG-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  CD1-RETURN-CODE               PIC S9(4)   COMP-5.

       01  QCD1-WHERE-BEG-KEY.
           03  QCD1-WBEG-TYPE            PIC X(2).
           03  QCD1-WBEG-CODE            PIC X(8).
 
       01  QCD1-WHERE-END-KEY.
           03  QCD1-WEND-TYPE            PIC X(2).
           03  QCD1-WEND-CODE            PIC X(8).
 
       01  QCD-REC.
           03  QCD-TYPE                   PIC X(2).
           03  QCD-CODE                   PIC X(8).
           03  QCD-LTOUCH-DATE            PIC X(10).
           03  QCD-DESC                   PIC X(35).
           03  QCD-AT-ACTIONCD            PIC X(04).
           03  QCD-AT-MEMO-REQUIRED       PIC X(01).
           03  QCD-AT-SUPERVISOR-ONLY     PIC X(01).
           03  QCD-AT-RESULT-REQUIRED     PIC X(01).
           03  QCD-BR-FILE-TYPE           PIC XX.
           03  QCD-BR-FILE-NAME           PIC X(6).
           03  QCD-BR-PAYOFF-FG           PIC X.
           03  QCD-BR-POST-SS-TRCD        PIC X.
           03  QCD-BR-GL-BRANCH           PIC 9(4).
           03  QCD-BR-GL-ACCT             PIC 9(7).
           03  QCD-BR-ALLOT-OPTION        PIC X.
           03  QCD-BR-LBOX-OPTION         PIC X.
           03  QCD-BR-LC-FG               PIC X.
           03  QCD-BR-OT-GL-BRANCH        PIC 9(4).
           03  QCD-BR-OT-GL-ACCT          PIC 9(7).
           03  QCD-BR-MULTIPLE-REFCDS     PIC X.
           03  QCD-BR-COLLECT-LC          PIC X.
           03  QCD-CO-GROUP               PIC X(01).
           03  QCD-CO-SECURED             PIC X(01).
           03  QCD-CO-TRW                 PIC X(02).
           03  QCD-CT-INSTAXFRMLA-1       PIC X.
           03  QCD-CT-INSTAXAMT-1         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-2       PIC X.
           03  QCD-CT-INSTAXAMT-2         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-3       PIC X.
           03  QCD-CT-INSTAXAMT-3         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-4       PIC X.
           03  QCD-CT-INSTAXAMT-4         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-5       PIC X.
           03  QCD-CT-INSTAXAMT-5         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-6       PIC X.
           03  QCD-CT-INSTAXAMT-6         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-7       PIC X.
           03  QCD-CT-INSTAXAMT-7         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-8       PIC X.
           03  QCD-CT-INSTAXAMT-8         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-9       PIC X.
           03  QCD-CT-INSTAXAMT-9         PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-10      PIC X.
           03  QCD-CT-INSTAXAMT-10        PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-11      PIC X.
           03  QCD-CT-INSTAXAMT-11        PIC 99V99.
           03  QCD-CT-INSTAXFRMLA-12      PIC X.
           03  QCD-CT-INSTAXAMT-12        PIC 99V99.
           03  QCD-CT-BOTH-TAX-FG         PIC X.
           03  QCD-CY-INSTAXFRMLA-1       PIC X.
           03  QCD-CY-INSTAXAMT-1         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-2       PIC X.
           03  QCD-CY-INSTAXAMT-2         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-3       PIC X.
           03  QCD-CY-INSTAXAMT-3         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-4       PIC X.
           03  QCD-CY-INSTAXAMT-4         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-5       PIC X.
           03  QCD-CY-INSTAXAMT-5         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-6       PIC X.
           03  QCD-CY-INSTAXAMT-6         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-7       PIC X.
           03  QCD-CY-INSTAXAMT-7         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-8       PIC X.
           03  QCD-CY-INSTAXAMT-8         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-9       PIC X.
           03  QCD-CY-INSTAXAMT-9         PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-10      PIC X.
           03  QCD-CY-INSTAXAMT-10        PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-11      PIC X.
           03  QCD-CY-INSTAXAMT-11        PIC 99V99.
           03  QCD-CY-INSTAXFRMLA-12      PIC X.
           03  QCD-CY-INSTAXAMT-12        PIC 99V99.
           03  QCD-CY-BOTH-TAX-FG         PIC X.
           03  QCD-EA-CQ-FG               PIC X(1).
           03  QCD-EA-GQ-FG               PIC X(1).
           03  QCD-ELGRACE                PIC 9(2).
           03  QCD-ELGRACECD              PIC X(1).
           03  QCD-ELTYPE                 PIC X(2).
           03  QCD-ELRATE                 PIC 9(4)V9(4).
           03  QCD-ELFRMLA                PIC X(2).
           03  QCD-ELMINCHG               PIC 9(2)V99.
           03  QCD-ELMAXAMT               PIC 9(4)V99.
           03  QCD-ELDELFAC               PIC 9(3).
           03  QCD-ELYRTYPE               PIC 9(4).
           03  QCD-ELUNITPER-CD           PIC X(1).
           03  QCD-PO-TITLE-HOLD-DAYS     PIC 9(02).
           03  QCD-RE-ACTIONCD            PIC X(04).
           03  QCD-RE-MEMO-REQUIRED       PIC X(01).
           03  QCD-RE-SUPERVISOR-ONLY     PIC X(01).
           03  QCD-RE-ACTIVITY-REQUIRED   PIC X(01).
           03  QCD-RE-RESCHEDULE-REQ      PIC X(01).
           03  QCD-RE-RESCHEDULE-TIME     PIC 9(03).
           03  QCD-RE-WORKED-ACCOUNT      PIC X(01).
           03  QCD-FC-FEEAMT              PIC S9(7)V99.
           03  QCD-TC-REFNO-1             PIC X(05).
           03  QCD-TC-REFNO-2             PIC X(05).
           03  QCD-TC-REFNO-3             PIC X(05).
           03  QCD-TC-REFNO-4             PIC X(05).
           03  QCD-TC-REFNO-5             PIC X(05).
           03  QCD-TC-REFNO-6             PIC X(05).
           03  QCD-TC-REFNO-7             PIC X(05).
           03  QCD-TC-REFNO-8             PIC X(05).
           03  QCD-TC-REFNO-9             PIC X(05).
           03  QCD-TC-REFNO-10            PIC X(05).
           03  QCD-PS-TDR-FLAG            PIC X(01).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01CD_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSCD.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSCD
      *********************************************************
      *    LIBLP/LPWSCD: CDFILE PATH WORKERS
      *    /USR/DATA/XX/LP/CDFILE
      ******************************************************************
       01  CD-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  CD-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES CD-PATH.
           03  CD-PATH-BEG           PIC X(13).
           03  CD-PATH-FILE          PIC X(22).
           03  FILLER                REDEFINES CD-PATH-FILE.
               05  FILLER            PIC X(03).
               05  CD-PATH-SQL       PIC X(19).

       01  CD-ALL-PATH.
           03  CD-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES CD-ALL-BASE.
               05  CD-ALL-BASE-USR   PIC X(05).
               05  CD-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  CD-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/LP/CDFILE".
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSCD.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LN
      ******************************************************************
      *
      *   DESCRIPTION: LOAN MASTER FILE
      *
      *   RECORD SIZE: 2800 BYTES, RECORD SIZE AFFECTS LP01WK!
      *
      *   LN1-KEY - LN-OWNBR, LN-ACCTNO
      *   LN3-KEY - LN-OWNBR, LN-CLASS, LN-ACCTNO
      *   LN4-KEY - LN-OWNBR, LN-SSNO(1)
      *   LN5-KEY - LN-OWNBR, LN-SSNO(2)
      *
      ******************************************************************
      *   I M P O R T A N T - - - - - - - -
      *       REMEMBER TO CHANGE:
      *       LPFDPD
      *       (AND ALL PLACES FIELDS ARE INITIALIZED)
      ******************************************************************
      * REV:
      *  JTG 061995 ADDED LN-O3INS-DLPROC
      *  JTG 062195 ADDED CODES FOR CALCULATION OF O1 INSURANCE
      *  JTG 070995 ADDED LN-INSPREM-DLADJ, ADJUSTMENT WHEN DEALER
      *                   WROTE OUR INS. PREMIUMS WRONG
      *  JTG 071995 ADDED LN-PRLNAMT & LN-PRPDUE-DAYS
      *  JTG 072095 ADDED LN-PLAMT, CURBAL AT TIME OF P&L
      *  JTG 082495 ADDED LN-MTD-PRIN, LN-MTD-LC, LN-MTD-INT,
      *                   LN-MTD-OT, LN-MTD-EX
      *  KEC 083095 ADDED LN-BNKRPT-CHAPTER
      *  JTG 092295 ADDED LN-BMO-CON-STATUS LN-BMO-REC-STATUS
      *  JTG 032996 CHANGED LN-PROCEEDS TO BE SIGNED S9(7)V99 COMP-3
      *  JTG 111296 CHANGED LN-INSTBL (LEVEL'S 9 & 10) TO FILLER
      *  KEC 012397 ADDED LN-APPNO: APPLICATION NUMBER(TIED TO MA-APPNO)
      *  BAH 071197 ADDED LN-INSFINCHG AND LN-FEEFINCHG FOR WORLD FROM A90
      *  MJD 080197 CHANGED LN-CAN-LOAN-NO TO PIC XX (WAS PIC 99 COMP-3)
      *  JTG 081297 ADDED LN-GIFTNET AND LN-GIFTNET-OUR-PO FOR WORLD A90
      *                   LN-GIFTNET-EXTR, LN-SHIP-SAME-FG
      *  JTG 082097 CHANGED LN-CONPROFILE & LN-RECPROFILE TO SIXTY MONTH TABLES
      *             ADDED LN-PROC-DISBURSED
      *             ADDED LN-PY-YYYYMM-RECDEL & LN-MTD-PAYS-RECDEL
      *             ADDED LN-AD-D-INS-COVR
      *  BAH 091297 CHANGED LN-SPREFUNDATE TO LN-TRW-1ST-30
      *  JTG 112097 EXPANDED BY 230 BYTES
      *  BAH 010898 ADDED LN-TRW-STATUS FOR CUSTOMERS TO FORCE A CREDIT BUREAU
      *             STATUS, PR# 520
      *   CS 031998 ADDED LN-ORIGIN (FEDERATED #646) AND LN-FOLLOWUPDATE(FUTURE)
      *  JTG 050498 CREATED LN-TOT-PARTIAL-CHGOFF, MERCURY TRCD = 'PX', #E175
      *  JTG 060398 ADDED LN-PO-TRCD TO HOLD THE TRCD USED TO PAYOFF THIS LOAN
      *  BAH 062498 CHANGED LN-TILLNO TO ALPHANUMERIC FOR MORE DRAWERS
      *  JTG 071598 ADDED LN-PRDLDISC-UNEARN TO HOLD CARRY OVER DISCOUNT
      *             UNEARN ON RENEWALS
      *  BAH 081098 ADDED LN-YTDNOALDEL FOR MERCURY'S NEW EDIT ON ALLOWABLE
      *             DELINQUENCY, #193
      *  JTG 082698 ADDED LN-REVOLVING FLAG, REGENCY FINANCE REVOLVING
      *                   LN-PREV-STMT-DATE
      *                   LN-LAST-STMT-DATE
      *                   LN-RPRINBAL
      *                   LN-AGEING-AMT    OCCURS 8
      *  KEC 091798 ADDED LN-REVOL-CREDIT-LIMIT; REGENCY FINANCE REVOLVE
      *  KEC 093098 ADDED LN-CYCLE-DAY; REGENCY FINANCE REVOLVE
      *  JTG 093098 ALLOWED LN-CURBAL & LN-PURBAL TO GO NEGATIVE; REGENCY REVOL
      *  KEC 100598 ADDED THE FOLLOWING FOR REGENCY FINANCE REVOLVE:
      *                   LN-CHARGE-INTEREST-FG
      *                   LN-CHARGE-LATECHG-FG
      *                   LN-CHARGE-MEMBERSHIP-FG
      *  JTG 101498 REMOVED LN-REVOL-CREDIT-LIMIT WILL USE LN-CREDITLIM
      *  JTG 101598 CHANGED LN-CYCLE-DAY TO LN-CYCLE-DATE REGENCY, REVOL
      *  KEC 102798 ADDED LN-INDEX-ADJUST-FACTOR FOR REGENCY REVOLVING.
      *  JTG 111998 ADDED LN-OTHBAL-TABLE REVOLVING, REGENCY
      *  JTG 112398 ADDED LN-RCURPRIN, LN-RCURINT, LN-RCURLC, LN-RCUROTH
      *             AND REMOVED LN-RPRINBAL
      *  JTG 120198 ADDED LN-RPDUEPRIN, LN-RPDUEINT, LN-RPDUELC, LN-RPDUEOTH
      *  MJD 990126 ----- UPDATED IN FLEXGEN -----
      *  MJD 990201 ADDED LN-ACCT-FROZEN
      *  GLF 990201 ADDED LN-LPO,LN-REP-CD,LN-PROCESS-CD, TFC.
      *  JTG 990208 ADDED 88'S LN-INS-NO-ONE, LN-INS-SINGLE, LN-INS-JOINT
      *  JTG 990301 ADDED LN-ZERO-BAL-CNT, REVOLVING
      *  CS  1999.0301 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  JTG 990326 ADDED LN-LAST-ACCRUAL-DATE, SP-ERNDELQFRMLA = 'C'   TFC #005
      *  KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0520 ADDED LN-TRW-SPECIAL-CODE          (TFC) PR#:00023
      *  JTG 990720 ADDED LN-ACTIVE-FG                     REGENCY REVOLVING #45
      *  KEC 1999.0805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  MJD 990910 CHANGED LN-INSELIGIBLE-O3 TO BE LN-INSELIGIBLE-O1.
      *             AS PER JOHN, IT WAS MISNAMED FROM THE START.
      *  MJD 991005 ADDED LN-PRIOR-RN-FOR10-DATE AND LN-LAST-RN-FOR10-DATE.
      *             (REGMGM PR#942)
      *   CS 991012 ADDED 88 LEVEL BULK-PURCHASE FOR LN-CONVERCD AND 88 LEVEL
      *             CONVERSION-NORMAL
      *  KEC 991018 ADDED LN-CREATION-STATUS FOR CMSI/CSI PROJECT (LI)
      *               88  LN-CREATION-EXTERNAL            VALUE "L".
      *               88  LN-CREATION-INTERNAL            VALUE "I" " ".
      *               88  LN-CREATION-LI-VENDOR           VALUE "L".
      *
      *  MJD 991220 ADDED LN-TOTNODEFACT AND LN-YTDNODEFACT (WORLD PR#216)
      *  BLV 991220 ADDED 88 FOR LN-POCD-TRANSFERRED (BT)
      *  MJD 000119 ADDED LN-TOTNOLCHG (WORLD PR#218)
      *  MJD 000307 ADDED LN-PRIOR-STMT-COUNTER, REPLACES FM-STMT-COUNTERA FOR
      *             PRINTING STATEMENTS. (FM FIELD IS USED FOR OTHER USES IN
      *             DIFFERENT DOCUMENTS) (NEWS/MERC PR#???)
      *  BLV 000310 ADDED LN-WCBC-CREDITLIM, WORLD PR#225
      *  KEC 2000.0410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  MJD 000616 ADDED LN-CONRATE  (REGACC PR#1220)
      *  BLV 000711 REDEFINE LN-REP-CD AS LN-EMP-ID FOR WORLD CLASS BUYING
      *             CLUB PROMOTION
      *  MJD 000911 ADDED LN-LBOX (MFC PR#227)
      *  JTG 001114 ADDED  78  LN-INSTBL-SIZE  VALUE 46 FOR CL/ICUNR*.C PROGRAMS
      *   CS 010120 CHANGED LN-LMO-PRIOR-UNEARNED TO LN-LMO-PRIOR-INTEREST
      *  BLV 010122 ADDED LN-1099-FG, WORLD PR# 250
      *  BLV 010207 REMOVED LN-1099-FG, WORLD PR# 250, NOT PUTTING CHANGE
      *             IN A15
      *  JTG 010227 ADDED LN-EXTRA-PRIN-LFP LN-REMAIN-INT-SINCE-LFP
      *             LN-REMAIN-PRIN-SINCE-LFP  (LFP=LAST-FULL-PAYMENT)
      *             LENDMARK, PR#1045 & PR#1380
      *  BLV 010925 ADDED LN-FOLLOWUP-CD, PR# 1487
      *  BAH 011029 ADDED LN-INTERIM-COUPON FOR REGACC PR# 1632
      *  BAH 011210 ADDED LN-PROMID FOR LAST 3 CHAR OF LOGIN WHO SET THE
      *             PROMISE TO PAY, REGACC PR# 1662
      *  JTG 020117 CHANGED FIELDS FROM S9(7)V99 TO S9(7)V99    LENDMARK PR#J021
      *             CHANGED LN-AMT-PAID-LAST TO PIC9(7)V99
      *  JTG 020123 EXPANDED PAYMNTD FIELDS TO 1,000,000
      *             EXPANDED MTD-PAYS-RECDEL FIELD TO 1,000,000 LENDMARK PR#J021
      *  BAH 020214 ADDED LN-LAST-PYPA-DATE FOR REGACC PR# 1721
      *  BAH 020502 ADDED LN-PROMDAYS-PASTDUE FOR "DAYS PAST DUE AT TIME
      *             PROMISE TAKEN", REGACC PR# 1783
      *  JTG 020530 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *             ADDED LN-MIP-MTD-CLAHPAID, LN-MIP-TOT-CLPAID,
      *                   LN-MIP-TOT-AHPAID,
      *                   LN-MIP-CLPDTH-DATE,   LN-MIP-AHPDTH-DATE
      *                   LN-MIP-FG
      *  BAH 020625 ADDED LN-PLREASON FOR REGACC PR# 1775
      *  BAH 020712 SIGNED LN-TRADEIN, REGACC PR# 1808
      *  KEC 020806 {DR#00009} PARADATA <A15> [KEN]
      *             ADDED LN-RESCISSION AND LN-RESCISSION-DATE.
      *  JTG 020905 ADDED LN-DLCOMM-O3-CMSI LN-DLCOMM-PP-CMSI  REGACC #1846
      *  BAH 030207 ADDED LN-INTERIM-TRW REGACC PR# 16
      *  JTG 040501 ADDED LOGIC TO CAUSE THE UNEARNED LOAN COST TO ROLL TO
      *             THE NEW LOAN AFTER 'RENEWAL'. NOTE: THIS COST IS REFLECTIVE
      *             OF THE DISCOUNT WHEN PURCHASING LOAN PAPER NOT CARRIED AS
      *             SALES PAPER WITH DEALER DISCOUNT.
      *             ADDED SP-LNCOST-FRMLA = 'R'                    REGENCY #2287
      * KEC 040518 {PR#00000} PARADATA <A15> [KEN CISZEWSKI]
      *            ADDED: 05  LN-APPNO-COMP    PIC 9(12)   COMP-6.
      * BAH 050202  REDEFINE LN-CYCLE-DATE WITH LN-BNKRPT-DISMISS-DATE
      *             NEED FOR THE CREDIT BUREAU AND DONT WANT TO READ EVERY
      *             LT B TRAILER FOR EVERY LOAN SEARCHING IF IT COULD BE
      *             A DISMISSAL...PL# 461
      * BAH 050324 ADDED LN-TRW-B-CONSUMER-IND AND LN-TRW-J-CONSUMER-IND FOR
      *            METRO2 OVERRIDE ABILITY, ACC, PR# 2502
      * BAH 050428 ADDED LN-ACH, REGACC PR# 102
      * BAH 050601 CHANGED LN-TRW-1ST-30 TO LN-TRW-DOFD-DATE, DATE OF FIRST
      *            DELINQUENCY
      * BLF 050726 ADDED LN-1099-C-FG, WORLD PR# 411
      * BAH 050818 ADDED LN-TRW-COMPLIANCE-CODE, LIBERAL PR# 2591
      * JTG 050922 ADDED LN-POCD-UNWIND "*U" AND LN-POCD-NONLOAN REGACC #0105
      * BAH 051025 RENAMED LN-NOODDPY-PD-JUNK, NOT USED, DONT KNOW WHAT IT IS !
      * BAH 051025 RENAMED LN-LEDGERCNT AND LN-LPCNT TO FILLER, NOT USED....
      * BAH 051026 ADDED LN-FROZEN-REASON, REGACC PR# 114
      * BAH 061205 ADDED LN-COUPON-STATEMENT, REGACC PR# 158
      *
      * KEC 070406 {PR#00169} REGIONAL ACCEPTANCE <A15> [KEVIN MULLEN]
      *            TOOK LN-ZERO-BAL-CNT  [9(3)] AND REDEFINED IT AS
      *                 LN-NEXIS-CRSCORE [9(3)].
      *            LN-NEXIS-CRSCORE IS FOR CMSI.
      *            LN-ZERO-BAL-CNT IS A REVOLVING FIELD WHICH IS NOT
      *            USED FOR CMSI.
      *
      * KEC 070726 {PR#00000} PARADATA <A15> [KEN CISZEWSKI]
      *            REVISED LN-APPNO TO BETTER IDENTIFY NEW & OLD APPS.
      *
      * BAH 071015 ADDED LN-PART-RECOURSE-DATE REDEFINES LN-FILEDATE
      *           FOR REGACC PR# 184
      * BAH 071017 ADDED LN-GARNISH-EXTR AS REDEFINE OF LN-GIFTNET-EXTR
      *            MODERN PR#3086
      * BLF 071116 REDEFINED LN-CHARGE-MEMBERSHIP-FG (REVOLVING) AS
      *            LN-PARVHELD-PAID-FG, REGACC PR# 185
      *
      * KEC 080529 {PR#00000} PARADATA <A15> [JAY CISZEWSKI]
      *            REDEFINED LN-COLLCD INTO TWO PARTS.
      * BLM 100302 ADDED LN-ESCROW-FG, REGWAN PR# 3506
      * BAH 110301 ADDED LN-IL-GROSS-INCOME REDEFINES LN-MIP-TOT-CLPAID
      *            FOR WORLD "IL" GROSS INCOME PER LOAN PR# 748
      *  CS 111010 ADD " 1" THRU " Z" TO VALUE FOR LN-POCD-POFF, ON LOANS MADE
      *            & PAIDOFF DURING SAME MONTH IT DIDNT GET NEW PREMIUMS IF
      *            THE POFF CODE WAS " S"  WTD
      *  CS 111011 AFTER TALKING TO BARB CHANGED VALUE TO " 1" THRU "ZZ"
      * BAH 140710 ADDED LN-IL-GROSS-INCOME2 REDEFINES LN-MIP-TOT-AHPAID 
      *            FOR WORLD "IL" GROSS INCOME PER LOAN PR# 1002
      * BLM 160615 A30 FILE CHANGES: 8 DIGIT DATES, REMOVE REVOLVING FIELDS,
      *            REMOVE REDEFINES, REMOVE LN2-KEY, CHANGE LN1-KEY TO BE
      *            OWNBR/ACCTNO, CHANGE LN3-KEY TO BE NON-CONTIGUOUS OWNBR/
      *            CLASS/ACCTNO, INCREASE 9(4) AMTS TO BE 9(5), INCREASE
      *            9(6) AMTS TO BE 9(7), CHANGED COMP-6 FIELDS TO BE COMP-3,
      *            INCREASED EARNINGS TABLE FROM 6 TO 10, INCREASE INSURANCE
      *            TABLE FROM 8 TO 10, ADDED LN-PL-TRDATE, LN-PO-TRDATE,
      *            LN-BT-TRDATE, LN-PBI-PBD-FG, LN-BNKRPT-DISCHARGE-DATE,
      *            LN-BNKRPT-REAFFIRM-DATE, LN-METRO2-LAST-PMT-DATE,
      *            LN-LTOUCH-DATE, LN-LTOUCH-TIME,
      *            ADDED UNUSED OF 750.  INCREASED CLASS TO 9(3).
      *            CHANGED LN-APPNO 9(6) TO LN-APP-NUMBER 9(09) COMP-3.
      *            INCREASED FEE TABLE FROM 10 TO 20. 
      *            INCREASED MAINTFEE TO 9(5)V99, SUM-MAINTFEE TO 9(7)V99,
      *            ADDED LN-OLD-ACCT-FORMAT-FG, LN-PAPERLESS-STMT-FG.
      *            CHANGED LN-TILLNO FROM PIC X TO PIC 99.
      *            REMOVED LN-MORELN. REMOVE LN-GIFTNET-EXTR.
      *            CHANGED LN-EMP-ID TO NOT BE A REDEF OF LN-REP-CD.
      *            CHANGED LN-IL-GROSS-INCOME & LN-IL-GROSS-INCOME2 TO 
      *            NOT BE REDEFS OF MIP FIELDS.  ADD LN-O6-REBATE &
      *            LN-O7-REBATE.  ADD 10 FUTURE AMTS.
      *CS 160629 REMOVE LN-ZERO-BAL-CNT AND PUT IN THE LTR(REVOLV TRAILER) IT
      *           TRACKS THE NUMBER OF STATEMENTS TO PRINT IF ZERO BALANCE
      * MJD 160823 ADDED LN-FEECODE-CH1-NUMERIC AND LN-FEECODE-CH2-NUMERIC.
      *            WE NEED TO EXCLUDE LIVE CHECK FEE CODES (START WITH ALPHA)
      *            CODES FROM NONMEMO-FEES WHEN CALCULATING HIGH CREDIT WHEN
      *            LC-CALC-HI-CREDIT = "L"                           61000 #1180
      *  CS 160824 PUT LN-ZERO-BAL-CNT BACK IN LOAN RECORD, ITS CHECKED IN
      *            EOM & ITS BETTER HERE, TOOK OUT OF LIBLP/LP01LTR
      *  CS 160913 CHANGED LN-INSEARN-ORDER TO PIC 99 FROM PIC 9 SINCE THE
      *            TABLE OCCURS 10 TIMES.
      * BLM 161019 REDUCED FILLER FROM 650 TO 640 FOR THE CHANGE ABOVE.
      * BLM 170214 FIX REDEF OF LN-ORIG-1STPYDATE SO DAY IS IN CORRECT
      *            POSITION FOR YYYYMMDD, PD0006
      * BAH 170914 RENAMED LN-PYMMYY-RECDEL TO LN-PY-YYYYMM-RECDEL
      * BAH 171113 CHANGED LN-EARN-ORDER FROM 9 TO 99
      * BAH 180628 REMOVED REDEFINE LN-NUMBER
      * BAH 181130 GLOBAL LNFILE, MOVED LN-OWNBR UNDER LN1-KEY
      * KEC 190219 A32 FFR - REMOVED REDEFINE FOR LN-LC-CODEX; UNUSED
      * BAH 190307 A32 REMOVED LN-FROZEN-REASON1, BECAUSE IT REPLACED A COMP-3
      *            FIELD FROM THE PAST WE WERE TESTING FOR A X'00'. USING A
      *            WORKING STORAGE FIELD NOW
      * BAH 190307 REMOVED THE BREAK OUT OF LN-COLLCD, MADE PIC X(2).
      *  CS 190430 ADD FUTURE FIELDS, KEPT AT 2800 TO MATCH WK-SAVE-REC
      *            WHICH SHOULD ALSO MATCH PD-REC
      * CS 190612 CHANGE LN-INSTBLE-SIZE TO 49 FROM 48
      * BAH 2020-0323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * BAH 2023-0600 ADDED FILLER
      * BAH 2023-0714 REMOVED LN6 AND LN7
      * JKC 2023-0912 ADDED "LN-" PREFIX TO THE FOLLOWING:
      *          LN-BULK-PURCHASE, LN-CONVERSION-NORMAL
      * JKC 2024-0404 ADDED LN-LOS-APP-ID PIC 9(18) COMP-3.
      *
      **************************************************************************
       78  LN-SIZE                     VALUE 2800.
       78  LN-INSTBL-SIZE              VALUE 49.
       01  LN-REC.
           03  LN1-KEY.
               05  LN-OWNBR        PIC 9(4).
               05  LN-ACCTNO       PIC 9(8).
           03  LN-CLASS            PIC 9(3).
           03  LN-SUBCLASS         PIC 99.
           03  LN-LAWCODE          PIC 99.
      *----------------------------------------------------
           03  LN-BWTABLEX.
               05  LN-SSNO1        PIC 9(9).
               05  LN-MAKERCD1     PIC X.
               05  LN-SSNO2        PIC 9(9).
               05  LN-MAKERCD2     PIC X.
               05  LN-SSNO3        PIC 9(9).
               05  LN-MAKERCD3     PIC X.
               05  LN-SSNO4        PIC 9(9).
               05  LN-MAKERCD4     PIC X.
           03  LN-BWTABLE          REDEFINES LN-BWTABLEX.
               05  LN-BORRTBL      OCCURS 4 TIMES.
                   07  LN-SSNO     PIC 9(9).
                   07  LN-MAKERCD  PIC X.
      *----------------------------------------------------
      *    LOAN STATUS CODES
      *----------------------------------------------------
           03  LN-ORGST            PIC XX.
           03  LN-ORGBR            PIC 9(4)   COMP-3.
           03  LN-OWNST            PIC XX.
           03  LN-SPRCLASS         PIC 9(3).
           03  LN-CONVERCD         PIC X.
               88  LN-BULK-PURCHASE                  VALUE "B".
               88  LN-CONVERSION-NORMAL              VALUE "Y".

      ********************************************************
           03  LN-MIDSTREAM        PIC X.
      *
      *    SP - NORMAL PURCHASE:
      *
      *    Y  - MIDSTREAM PURCHASE:
      *           TFR TO PURCHASE (TP)
      *           BULK PURCHASE   (FUTURE)
      *
      *         AT THE TIME THE ACCOUNT WAS PURCHASED,
      *         THE ORIGINAL PRINCIPAL BALANCE
      *         HAD BEEN PREVIOUSLY REDUCED:
      *
      *         LN-LNAMT NOT = LN-ORIGPURAMT
      *         LN-CURBAL    = LN-PURBAL
      *
      *    P  - PARTIAL PURCHASE:  (BIG APPLE)
      *
      *         AT THE TIME THE ACCOUNT WAS PURCHASED,
      *         ONLY A PORTION OF THE RECEIVABLE WAS BOUGHT
      *
      *         LN-LNAMT  NOT = LN-ORIGPURAMT
      *         LN-CURBAL NOT = LN-PURBAL
      ********************************************************
           03  LN-PURCD            PIC XXX.
           03  LN-SRCD             PIC XX.
           03  LN-COLLCD           PIC X(2).
           03  LN-COLLID           PIC X(20).
           03  LN-POCD             PIC XX.
               88  LN-POCD-NONLOAN       VALUE "**" "*I" "*R" "*U".
               88  LN-POCD-OPEN          VALUE "  ".
               88  LN-POCD-POFF          VALUE " 1" THRU "ZZ".
               88  LN-POCD-INRESCISSION  VALUE "*I".
               88  LN-POCD-RESCIND       VALUE "*R".
               88  LN-POCD-PB-RESC       VALUE "*P".
               88  LN-POCD-UNWIND        VALUE "*U".
               88  LN-POCD-VOID          VALUE "**".
               88  LN-POCD-TRANSFERRED   VALUE "BT".
           03  LN-PLCD             PIC X.
           03  LN-PLTYPE           PIC X.
           03  LN-CONFIDENTCD      PIC X.
           03  LN-ALLOTCD          PIC X.
           03  LN-RECASTCD         PIC X.
           03  LN-SKIP-TRW         PIC X.
           03  LN-STATUSFG         PIC X.
           03  LN-SMALLOAN         PIC X.
           03  LN-SALEFIN          PIC X.
           03  LN-SERVACCT         PIC X.
           03  LN-LOANTYPE         PIC X.
           03  LN-ADDON-FG         PIC X.
           03  LN-PAY-SCHLD-FG     PIC X.
           03  LN-LC-CODE          PIC 99.
           03  LN-CAN-LOAN-NO      PIC XX.
           03  LN-STATFLAGS        PIC X(20).
           03  LN-STATUSFLAGS      REDEFINES LN-STATFLAGS
                                   OCCURS 20 TIMES
                                   INDEXED BY STFG.
               05  LN-STATFG       PIC X.
      $XFD DATE=YYYYMMDD
           03  LN-ENTDATE          PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LOANDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PURDATE          PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-INTDATE          PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-CASHDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-FILEDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-RESCISSION-DATE  PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PART-RECOURSE-DATE PIC 9(8)    COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-ORIG-1STPYDATE      PIC 9(8)      COMP-3.
      *--------------------------------------------------------------
      * FOR NORMAL LOANS:
      *     THIS FIELD WILL ALSO HOLD THE ORIG-1STPAY DATE PLUS
      *     THE CURRENT PAY DAY (LN-1STPYDA)
      *
      * FOR REVOLVING LOANS:
      *     AT ORIGINAL REVOLVING LOAN BOOKING THIS FIELD WILL HOLD
      *        THE ORIG-1STPAY DATE
      *     AS THE ACCOUNT CYCLES THE DAY PORTION OF THIS FIELD WILL
      *        CHANGE TO THE LAST STATEMENT'S DUE DAY
      *--------------------------------------------------------------
      $XFD DATE=YYYYMMDD
           03  LN-1STPYDATE        PIC 9(8).
           03  LN-1STPYDATEX       REDEFINES LN-1STPYDATE.
               05  LN-1STPY-YYYYMM PIC 9(6).
               05  LN-1STPYDA      PIC 99.
      $XFD DATE=YYYYMMDD
           03  LN-JDDATE           PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PLDATE           PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PL-TRDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-ACCELDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-REDUDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-POFFDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PO-TRDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LEGALDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-BNKRPTDATE       PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-BNKRPT-DISMISS-DATE PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-BNKRPT-DISCHARGE-DATE PIC 9(8) COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-BNKRPT-REAFFIRM-DATE  PIC 9(8) COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-DEBTAIDATE       PIC 9(8)      COMP-3.
      * REPOSESSION DATES:
      $XFD DATE=YYYYMMDD
           03  LN-REPODATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-REDEEMDATE       PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-SOLDDATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-INS-CONFIRM-DATE PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PRIOR-RN-FOR10-DATE   PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LAST-RN-FOR10-DATE    PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-TRW-DOFD-DATE         PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LAST-PYPA-DATE   PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-BT-TRDATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
      * LN-METRO2-LAST-PMT-DATE IS NOT BEING USED ANYWHERE
           03  LN-METRO2-LAST-PMT-DATE PIC 9(8)  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-FOLLOWUP-DATE    PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LAST-ACCRUAL-DATE PIC 9(8)     COMP-3.
      *----------------------------------------------------
      *    RATE INFORMATION
      *----------------------------------------------------
           03  LN-APRATE           PIC 999V999   COMP-3.
           03  LN-EFFRATE          PIC 999V999   COMP-3.
           03  LN-SMPRATE          PIC 999V999   COMP-3.
           03  LN-YLDRATE          PIC 999V999   COMP-3.
           03  LN-OVRDRATE         PIC 999V999   COMP-3.
           03  LN-ENDORATE         PIC 999V999   COMP-3.
           03  LN-JDRATE           PIC 999V999   COMP-3.
           03  LN-ACCRATE          PIC 999V999   COMP-3.
           03  LN-REDURATE         PIC 999V999   COMP-3.
           03  LN-CONRATE          PIC 999V999  COMP-3.
           03  LN-SERVPER          PIC 9(3)V99   COMP-3.
      *----------------------------------------------------
      *    LOAN DISCLOSURE INFORMATION
      *----------------------------------------------------
           03  LN-SELLPR           PIC 9(7)V99   COMP-3.
           03  LN-DOWNPY           PIC 9(7)V99   COMP-3.
           03  LN-TRADEIN          PIC S9(7)V99  COMP-3.
           03  LN-LNAMT            PIC 9(7)V99   COMP-3.
           03  LN-FINCHG           PIC 9(7)V99   COMP-3.
           03  LN-INTCHG           PIC 9(7)V99   COMP-3.
           03  LN-SERCHG           PIC 9(5)V99   COMP-3.
           03  LN-EXTCHG           PIC 9(5)V99   COMP-3.
           03  LN-MAINTFEE         PIC 9(5)V99   COMP-3.
           03  LN-POINTS           PIC 99V99     COMP-3.
           03  LN-PROCEEDS         PIC S9(7)V99   COMP-3.
      * LOANS ORIGINAL TERM AND REVOLVING ACCOUNTS DRAW PERIOD:
           03  LN-ORGTERM          PIC 9(3)      COMP-3.
           03  LN-1STPYAMT         PIC 9(7)V99   COMP-3.
           03  LN-NOREGPY          PIC 9(3)      COMP-3.
           03  LN-REGPYAMT         PIC 9(7)V99   COMP-3.
           03  LN-LASTPYAMT        PIC S9(7)V99  COMP-3.
           03  LN-PROCASH          PIC S9(7)V99  COMP-3.
      * HOLDS A "Y" WHEN P&L'S ARE POSTED FOR AN EXTRACTION (RMSEXT)
           03  LN-TILLNO           PIC 9(2).
      * HOLDS SPECIFIC AMOUNTS FOR EACH STATE IF NEEDED:
      * MISSISSIPPI--------------------------------------------
      * Y -  PRORATA REFUND ADJUSTMENT OCCURED ON THIS ACCOUNT
      *      AFTER NORMAL PAYOFF
      * A -  PRORATA REFUND ADJUSTMENT WAS GIVEN FOR AN ACCOUNT
      *--------------------------------------------------------

      * STATE-WORKER ALSO USED BY "SE" (SHIFT P&L EXPENSE)
      *              TO HOLD AMOUNT OD P&L EXPENSE SHIFTED
      * GEORGIA------------------------------------------------
      * STATE-WORKER HOLDS TO 8% PORTION OF THE SERVICE CHARGE
      * 4% PORTION = LN-SERCHG - LN-STATE-WORKER
      *--------------------------------------------------------
           03  LN-STATE-FLAG       PIC X.
           03  LN-STATE-WORKER     PIC S9(7)V99 COMP-3.
           03  LN-STATE-WORKER2    PIC S9(5)V99 COMP-3.
      *----------------------------------------------------
      *    FEE INFORMATION
      *----------------------------------------------------
           03  LN-FEETBL           OCCURS 20 TIMES.
               05  LN-FEECODE      PIC XX.
               05  LN-FEEAMT       PIC 9(5)V99   COMP-3.
               05  LN-FEEOURS      PIC X.
               05  LN-FEEFINCHG    PIC X.
      *--------------------------------------------------------
      *    INSURANCE INFORMATION
      *
      *    NOTE:
      *         IF LN-ADDON-FG = "Y"
      *            ALL LEVELS CONTAIN THE MOST RECENT
      *            INSURANCE ADDON INFO.
      *
      *    LEVEL: #1  CREDIT LIFE      #6  OTH INS 3
      *           #2  A&H              #7  OTH INS 4
      *           #3  PER. PROPERTY    #8  OTH INS 5
      *           #4  OTHER INS 1
      *           #5  OTHER INS 2
      *
      *                                          O1    O1    O1
      *                              PP    PP2         PP    PP2
      *            LL    DL    AH    AH    AH    AH    AH    AH
      *          -------------------------------------------------
      *    LL    |  B  |     |  F  |  L  |  W  |  O  |  3  |  4  |
      *          -------------------------------------------------
      *    DL    |     |  C  |  G  |  M  |  X  |  P  |  6  |  7  |
      *          -------------------------------------------------
      *    NO CL |     |     |  D  |  K  |  V  |  Q  |  9  |  0  |
      *          -------------------------------------------------
      *
      *                  O1          O1    O1
      *            PP    PP    PP2   PP2
      *          -------------------------------
      *    LL    |  H  |  U  |  S  |  2  |  A  |
      *          -------------------------------
      *    DL    |  J  |  Y  |  T  |  5  |  I  |
      *          -------------------------------
      *    NO CL |  E  |  Z  |  R  |  8  |  1  |
      *          -------------------------------
      *
      *--------------------------------------------------------
           03  LN-INSCODES.
               05  LN-INSURED      PIC X.
                   88  LN-INS-NO-ONE       VALUE "N".
                   88  LN-INS-SINGLE       VALUE "M" "S".
                   88  LN-INS-JOINT        VALUE "J".
               05  LN-INSTYPES     PIC X.
                   88  LN-INSTYPES-VALID   VALUE "A" THRU "Z"
                                                 "0" "1" "2" "3" "4"
                                                 "5" "6" "7" "8" "9".
                   88  LN-INSTYPES-DL      VALUE "C"
                                                 "G" "I" "J" "M" "P"
                                                 "T" "X" "Y" "5" "6"
                                                 "7".
                   88  LN-INSTYPES-LL      VALUE "B"
                                                 "A" "F" "H" "L" "O"
                                                 "S" "U" "W" "2" "3"
                                                 "4".
                   88  LN-INSTYPES-AH      VALUE "D"
                                                 "F" "G" "K" "L" "M"
                                                 "O" "P" "Q" "V" "W"
                                                 "X" "3" "4" "6" "7"
                                                 "9" "0".
                   88  LN-INSTYPES-PP      VALUE "E"
                                                 "H" "J" "K" "L" "M"
                                                 "U" "Y" "Z" "3" "6"
                                                 "9".
                   88  LN-INSTYPES-PP2     VALUE "R"
                                                 "S" "T" "V" "W" "X"
                                                 "2" "4" "5" "7" "8"
                                                 "0".
                   88  LN-INSTYPES-O1      VALUE "1"
                                                 "A" "I" "O" "P" "Q"
                                                 "U" "Y" "Z" "2" "3"
                                                 "4" "5" "6" "7" "8"
                                                 "9" "0".
               05  LN-INSELIGIBLE  PIC X.
                   88  LN-INSELIGIBLE-VALID  VALUE "A" THRU "Z"
                                                   "0" "1" "2" "3" "4"
                                                   "5" "6" "7" "8" "9".
                   88  LN-INSELIGIBLE-DL     VALUE "C"
                                                   "G" "I" "J" "M" "P"
                                                   "T" "X" "Y" "5" "6"
                                                   "7".
                   88  LN-INSELIGIBLE-LL     VALUE "B"
                                                   "A" "F" "H" "L" "O"
                                                   "S" "U" "W" "2" "3"
                                                   "4".
                   88  LN-INSELIGIBLE-AH     VALUE "D"
                                                   "F" "G" "K" "L" "M"
                                                   "O" "P" "Q" "V" "W"
                                                   "X" "3" "4" "6" "7"
                                                   "9" "0".
                   88  LN-INSELIGIBLE-PP     VALUE "E"
                                                   "H" "J" "K" "L" "M"
                                                   "U" "Y" "Z" "3" "6"
                                                   "9".
                   88  LN-INSELIGIBLE-PP2    VALUE "R"
                                                   "S" "T" "V" "W" "X"
                                                   "2" "4" "5" "7" "8"
                                                   "0".
                   88  LN-INSELIGIBLE-O1     VALUE "1"
                                                   "A" "I" "O" "P" "Q"
                                                   "U" "Y" "Z" "2" "3"
                                                   "4" "5" "6" "7" "8"
                                                   "9" "0".
      *********************************************************************
      *    LEVEL: #1  CREDIT LIFE      #6  OTH INS 3
      *           #2  A&H              #7  OTH INS 4
      *           #3  PER. PROPERTY    #8  OTH INS 5
      *           #4  OTHER INS 1      #9  OTH INS 6
      *           #5  OTHER INS 2     #10  OTH INS 7
      *********************************************************************
           03  LN-INSTBL              OCCURS 10 TIMES.
               05  LN-INSCOMP         PIC 99.
               05  LN-INSOURS         PIC X.
      $XFD DATE=YYYYMMDD
               05  LN-INSEFF-DATE     PIC 9(8)      COMP-3.
      * I CAN ALMOST GUARANTEE YOU WILL NEVER FIND A TERM IN THIS ONCE
      * IT IS A LOAN! IT IS USED IN CONVERSIONS AND LOAN INPUT
      * LNLIST ALWAYS DISPLAYS THE DATE, NEVER A TERM    BAH 2019-0325
               05  LN-INSTRM          REDEFINES LN-INSEFF-DATE
                                      PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
               05  LN-INSEXP-DATE     PIC 9(8)      COMP-3.
               05  LN-INSPREM         PIC 9(5)V99   COMP-3.
               05  LN-INSCOVR         PIC 9(7)V99   COMP-3.
               05  LN-INSCOMM         PIC 9(5)V99   COMP-3.
               05  LN-INSANTICERN     PIC S9(7)V99  COMP-3.
               05  LN-INSANTICADJ     PIC S9(7)V99  COMP-3.
               05  LN-INSUFERN        PIC S9(7)V99  COMP-3.
               05  LN-INSACCERN       PIC S9(7)V99  COMP-3.
               05  LN-INSEARN-ORDER   PIC 99.
               05  LN-INSFINCHG       PIC X.
      * THIS WILL CONVERT AS MMYY UNTIL WE GO CHANGE IT! 6/17/2016 BAH
           03  LN-PY-YYYYMM-RECDEL       PIC 9(6)      COMP-3.
           03  LN-MTD-PAYS-RECDEL     PIC S9(7)V99  COMP-3.
           03  LN-GARNISH-EXTR        PIC X.
           03  LN-SHIP-SAME-FG        PIC X.
           03  LN-AD-D-INS-COVR       PIC 9(7)      COMP-3.
           03  LN-TOT-PARTIAL-CHGOFF  PIC S9(7)V99  COMP-3.
           03  LN-LPO                 PIC X(4).
           03  LN-REP-CD              PIC X(8).
           03  LN-EMP-ID              PIC 9(8)      COMP-3.
           03  LN-PROCESS-CD          PIC X.
           03  LN-WCBC-CREDITLIM      PIC S9(5)     COMP-3.
           03  LN-FOLLOWUP-CD         PIC X(4).
      * FIELDS FOR MIP INSURANCE
           03  LN-MIP-FG              PIC X.
           03  LN-MIP-MTD-CLAHPAID    PIC S9(5)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-MIP-CLPDTH-DATE          PIC 9(8)      COMP-3.
           03  LN-MIP-TOT-CLPAID      PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-MIP-AHPDTH-DATE          PIC 9(8)      COMP-3.
           03  LN-MIP-TOT-AHPAID      PIC S9(7)V99  COMP-3.
           03  LN-IL-GROSS-INCOME     PIC S9(7)V99  COMP-3.
           03  LN-IL-GROSS-INCOME2    PIC S9(7)V99  COMP-3.
           03  LN-RESCISSION          PIC X(1).
           03  LN-INTERIM-TRW         PIC X(1).
      *----------------------------------------------------
      *    SALES FINANCE PURCHASE INFORMATION
      *----------------------------------------------------
           03  LN-DLNO             PIC 9(4)V99   COMP-3.
           03  LN-DLPOOL           PIC 9(5)      COMP-3.
           03  LN-DLRECOURSE       PIC X.
           03  LN-DLPARTRCAMT      PIC 9(7)V99   COMP-3.
           03  LN-ORIGPURAMT       PIC 9(7)V99   COMP-3.
           03  LN-PURBAL           PIC S9(7)V99  COMP-3.
           03  LN-DLRVPRIN         OCCURS 3
                                   PIC 9(7)V99   COMP-3.
           03  LN-DLRVCHGS         OCCURS 3
                                   PIC 9(7)V99   COMP-3.
           03  LN-DLPARVHELD       PIC 9(7)V99   COMP-3.
           03  LN-DLPARVPAID       PIC 9(7)V99   COMP-3.
           03  LN-DLDISC           PIC 9(7)V99   COMP-3.
      *---------------------------------------------------------------------
      *    CURRENT LOAN INFORMATION
      *---------------------------------------------------------------------
      $XFD DATE=YYYYMMDD
           03  LN-LCPDTH-DATE           PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-INTPDTH-DATE          PIC 9(8)      COMP-3.
           03  LN-CURBAL           PIC S9(7)V99  COMP-3.
           03  LN-INTBAL           PIC S9(7)V99  COMP-3.
           03  LN-LCBAL            PIC S9(7)V99  COMP-3.
           03  LN-OTHBAL           PIC S9(7)V99  COMP-3.
           03  LN-OT2BAL           PIC S9(7)V99  COMP-3.
      * LN-LCPAID CAN BE A DATE IN TRIPLE UCC STATES, MMDDYY
      * COULD NOT IDENTIFY HOW TO SPLIT THIS OUT VIA CONVERSION SO LEAVING
      * IT LIKE THIS, MUST STAY AS MMDDYY, USED AS DATE IN DEFI01.CBL
      * LCAP-F LCAP-H LCAP-L LCAP-M LCAP-P LCAP-S
           03  LN-LCPAID           PIC S9(7)V99  COMP-3.
           03  LN-LCPARTIALS       PIC S9(7)V99  COMP-3.
      * STATEMENT COUNTER CONTAINS SEQNO OF LAST PRINTED PAYMENT RECORD.
           03  LN-STMT-COUNTER     PIC 9(5)      COMP-3.
           03  LN-PRIOR-STMT-COUNTER PIC 9(5)     COMP-3.
           03  LN-FROZEN-REASON    PIC X(2).
           03  LN-COUPON-STATEMENT PIC X.
           03  LN-MONTHEND-BAL     PIC 9(7)V99   COMP-3.
      *-------------------------------------------------------
      *    LOAN EARNINGS ANTICIPATED INFORMATION:
      *
      *    LN-ANTICERN - NET ANTICERN = ORIGINAL AMOUNT AT
      *                  BOOKING OR PURCHASE - ANTICADJ
      *                  NOTE:
      *                       WHEN ACCOUNTS ARE TRANSFERED
      *                       TO SERVICE, THIS FIGURE IS
      *                       ADJUSTED DOWN TO MATCH ACCERN,
      *                       REFLECTING NO UNEARNED ON BOOKS.
      *                  NOTE:
      *                       IF SALES FINANCE AND PARTICIPATION
      *                       EXISTS WHERE BY THE EXPENSE IS
      *                       REFLECTED IN A DEFLATED UNEARNED,
      *                       THE FIELD WILL BE DEFALTED BY THE
      *                       PORTION DEALER IS PARTICIPATING IN.
      *
      *    LN-ANTICADJ - ADJUSTMENTS TO ANTICERN
      *                  1. THIS WILL REFLECT THE AMOUNT OF THE REBATE
      *                     NOTE:
      *                           IF SALES FINANCE AND PARTICIPATION
      *                           EXISTS WHERE BY THE ANTICIPATED
      *                           CHARGE IS CARRIED ADJUSTED, THIS
      *                           ADJUSTMENT WILL REFLECT THE FINANCE
      *                           COMPANY'S PORTION OF THE REBATE
      *
      *    LN-UFERN    - THAT PORTION OF ANTICERN TAKEN INTO
      *                  INCOME AT BOOKING OR PURCHASE
      *
      *    LN-ACCERN   - TOTAL INCOME (INCLUDING UFERN) TAKEN
      *                  FROM NET-ANTICERN (ANTICERN)
      *
      *    LN-ERNDELQ-STOP - FOR CERTAIN FORMULA'S, WHEN THIS FLAG = "Y"
      *                      ACCRUAL EARNINGS ARE STOPPED.
      *
      *    SO:
      *       GROSS ANTICERN = LN-ANTICERN + LN-ANTICADJ
      *       NET ANTICERN   = LN-ANTICERN
      *       UNEARNED       = LN-ANTICERN - LN-ACCERN
      *       TRUE ANTICERN  = LN-ANTICERN - LN-UFERN
      *
      *    ANTICTBL ELEMENTS:
      *       LEVEL 1 - INTEREST CHARGES
      *         "   2 - 1ST PAY EXTENSION CHARGES
      *         "   3 - SERVICE CHARGE
      *         "   4 - MAINTENANCE FEES OR OTHER FEES
      *         "   5 - DEALER DISCOUNTS
      *         "   6 - OTHER
      *
      *    LN-EARN-ORDER: IDENTIFIES WHERE TO HOLD THIS LEVELS
      *                   EARNINGS IN THE LOAN PAYMENT RECORDS
      *
      *              1 -  LP-EARN1       4 -  LXE-EARN(1)
      *              2 -  LP-EARN2       5 -  LXE-EARN(2)
      *              3 -  LP-EARN3       6 -  LXE-EARN(3)
      *-------------------------------------------------------
           03  LN-ANTICTERM        PIC 9(3)      COMP-3.
           03  LN-ANTICTBL         OCCURS 10 TIMES.
               05  LN-ANTICERN     PIC S9(7)V99  COMP-3.
               05  LN-ANTICADJ     PIC S9(7)V99  COMP-3.
               05  LN-UFERN        PIC S9(7)V99  COMP-3.
               05  LN-ACCERN       PIC S9(7)V99  COMP-3.
               05  LN-EARN-ORDER   PIC 99.
           03  LN-LMO-PRIOR-INTEREST PIC S9(7)V99  COMP-3.
           03  LN-PRIOR-UNEARNED   PIC S9(7)V99  COMP-3.
           03  LN-ERNDELQ-STOP     PIC X.
           03  LN-NONACRERN        PIC S9(7)V99  COMP-3.
           03  LN-PRIOR-NONACRERN  PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-ERN-IB-PDTH-DATE      PIC 9(8)      COMP-3.
           03  LN-ERN-IB-PRINBAL   PIC S9(7)V99  COMP-3.
           03  LN-ERN-IB-INTOWE    PIC S9(7)V99  COMP-3.
      *----------------------------------------------------
      *    LOAN TOTALS
      *----------------------------------------------------
      * TOTAL INCOME SINCE THE ACCOUNT WAS BOOKED ON TO SYSTEM:
      * ALL LN-ACCERN, LN-TOTSERACCT AND THOSE PORTIONS OF
      * LN-TOTINT, LN-TOTLCHG AND LN-TOTDEF WHICH WERE
      * EARNED SINCE BOOKING AS A OWNED ACCOUNT:,
           03  LN-TOTERN           PIC S9(7)V99  COMP-3.
      * TOTAL MONIES COLLECTED FORM OTHER CHARGES,
      * SINCE BOOKING ACCOUNT, BOTH NORMAL/MIDSTREAM
      * PURCHASE AND SERVICING:
           03  LN-TOTOTH           PIC S9(7)V99  COMP-3.
      * TOTAL INTEREST CHARGES COLLECTED FROM LOAN INCEPTION:
           03  LN-TOTINT           PIC S9(7)V99  COMP-3.
      * TOTAL LATE CHARGES COLLECTED FROM LOAN INCEPTION:
           03  LN-TOTLCHG          PIC S9(7)V99  COMP-3.
      * TOTAL DEFERMENT CHARGES COLLECTED FROM LOAN INCEPTION:
           03  LN-TOTDEF           PIC S9(7)V99  COMP-3.
      * TOTAL INCOME DURING SERVICE ACCOUNT STATUS:
           03  LN-TOTSERACCT       PIC S9(7)V99  COMP-3.
           03  LN-LCWAIVERS        PIC S9(5)V99  COMP-3.
           03  LN-INTWAIVERS       PIC S9(5)V99  COMP-3.
           03  LN-TOTPAYMNTD       PIC S9(7)V99  COMP-3.
           03  LN-TOTEXCPAYMNTD    PIC S9(7)V99  COMP-3.
           03  LN-TOTNODEF         PIC S99       COMP-3.
           03  LN-YTDNODEF         PIC S99       COMP-3.
           03  LN-TOTNODEFACT      PIC S99      COMP-3.
           03  LN-YTDNODEFACT      PIC S99      COMP-3.
      * TOTAL ALLOWABLE (DEFERMENTS) DELINQUENCY,
      * THESE DEFERMENTS ARE NOT INCLUDED IN TOTNODEF AND YTDNODEF:
           03  LN-TOTNOALDEL       PIC S99       COMP-3.
           03  LN-YTDNOALDEL       PIC S99       COMP-3.
           03  LN-YTDINTPD         PIC S9(7)V99  COMP-3.
           03  LN-LYRINTPD         PIC S9(7)V99  COMP-3.
           03  LN-TOTINTPD         PIC S9(7)V99  COMP-3.
           03  LN-RECASTINT        PIC 9(7)V99   COMP-3.
           03  LN-RECASTPRIN       PIC 9(7)V99   COMP-3.
      *----------------------------------------------------
      *    REBATE INFORMATION
      *----------------------------------------------------
           03  LN-REBATE-TAB.
               05  LN-CL-REBATE    PIC X.
               05  LN-AH-REBATE    PIC X.
               05  LN-PP-REBATE    PIC X.
               05  LN-INT-REBATE   PIC X.
               05  LN-SC-REBATE    PIC X.
               05  LN-MF-REBATE    PIC X.
               05  LN-DF-REBATE    PIC X.
               05  LN-EX-REBATE    PIC X.
               05  LN-O1-REBATE    PIC X.
               05  LN-O2-REBATE    PIC X.
               05  LN-O3-REBATE    PIC X.
               05  LN-O4-REBATE    PIC X.
               05  LN-O5-REBATE    PIC X.
               05  LN-O6-REBATE    PIC X.
               05  LN-O7-REBATE    PIC X.
      *-REBATES FOR EXPANDED UNEARNED TABLE
               05  LN-UN-O7-REB    PIC X.
               05  LN-UN-O8-REB    PIC X.
               05  LN-UN-O9-REB    PIC X.
               05  LN-UN-O10-REB   PIC X.
           03  LN-REBATE-TABX     REDEFINES LN-REBATE-TAB.
               05  LN-REBATE       PIC X OCCURS 19.

           03  LN-PLREASON         PIC XX.
      *----------------------------------------------------
      *    COLLECTION INFORMATION
      *----------------------------------------------------
           03  LN-COLLECTOR        PIC X(3).
           03  LN-ACTIONCD         PIC X(4).
           03  LN-ACTIONCD2        PIC X(4).
           03  LN-ATCODE           PIC X(3).
           03  LN-RECODE           PIC X(3).
           03  LN-ESCROW-FG        PIC X.
           03  LN-PROMDAYS-PASTDUE PIC S9(3)     COMP-3.
           03  LN-PROMID           PIC X(3).
      $XFD DATE=YYYYMMDD
           03  LN-PROMDATE         PIC 9(8)      COMP-3.
           03  LN-PROMAMT          PIC 9(7)V99   COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-PROMDATE2        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-DATE-PAID-LAST   PIC 9(8)      COMP-3.
           03  LN-AMT-PAID-LAST    PIC 9(7)V99   COMP-3.
           03  LN-LASTCFORMNO      PIC 9(5)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LASTCFORMDATE    PIC 9(8)      COMP-3.
      * NO. OF TIMES EXTRACTED:
           03  LN-DELCNT           PIC 99.
      * NO. OF DELINQUENT FORMS SENT:
           03  LN-DELCNT2          PIC 99.
           03  LN-CREDITLIM        PIC 9(7)      COMP-3.
           03  LN-CRSCORE          PIC S9(3)     COMP-3.
      *----------------------------------------------------
      *    SOLICIT INFORMATION
      *----------------------------------------------------
           03  LN-LASTSFORMNO       PIC 9(5)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LASTSFORMDATE     PIC 9(8)      COMP-3.
      * NO. OF SOLICITATION FORMS SENT:
           03  LN-SOLCNT           PIC 99.
           03  LN-MESSAGE          PIC X(30).
      *    THIS FIELD IS SET MANUALLY IN THE INQUIRIES, ONLY IF BRANCH
      *    FLAG ALLOWS.  THE EXTRACTION UPDATE WILL COMPARE THE EXTRACTION
      *    DATE(TODAY), AFTER INCREMENTED BY # OF DAYS, TO THE SECOND
      *    PROMISE DATE, IF FIRST IS LESS, THEY STAY THE SAME, IF FIRST
      *    IS AFTER SECOND, MOVE SECOND TO FIRST, AND 0 SECOND.
      *----------------------------------------------------
      *    PRIOR LOAN INFORMATION
      *----------------------------------------------------
           03  LN-OLDACCTNO        PIC 9(8)      COMP-3.
           03  LN-PRLNNO           PIC 9(8)      COMP-3.
           03  LN-PRBAL            PIC S9(7)V99  COMP-3.
           03  LN-PRINTDUE         PIC S9(7)V99  COMP-3.
           03  LN-PRFINCHGRB       PIC S9(7)V99  COMP-3.
           03  LN-PRINSRB          PIC S9(7)V99  COMP-3.
           03  LN-PRPOCD           PIC XX.
      $XFD DATE=YYYYMMDD
           03  LN-PRPODATE         PIC 9(8)      COMP-3.
           03  LN-PRDELINQAMT      PIC S9(7)V99  COMP-3.
           03  LN-PRLNAMT          PIC 9(7)V99    COMP-3.
           03  LN-PRPDUE-DAYS      PIC S9(5)      COMP-3.
      *  JTG 040501 ADDED LOGIC TO CAUSE THE UNEARNED LOAN COST TO ROLL TO
      *             THE NEW LOAN AFTER 'RENEWAL'. NOTE: THIS COST IS REFLECTIVE
      *             OF THE DISCOUNT WHEN PURCHASING LOAN PAPER NOT CARRIED AS
      *             SALES PAPER WITH DEALER DISCOUNT.
      *             ADDED SP-LNCOST-FRMLA = 'R'                    REGENCY #2287
      *       NOTE: LN-PRDLDISC-UNEARN WILL HOLD THE COST (DISCOUNT)
      *             FOR DIRECT LOANS, EVEN THOUGH IT IS NOT TIED TO A DEALER.
           03  LN-PRDLDISC-UNEARN  PIC S9(7)V99  COMP-3.
           03  LN-PRCONPROFILE     PIC 9(12)     COMP-3.
      *----------------------------------------------------
      *    LOAN ADDON INSURANCE CONSOLIDATED INFORMATION
      * NOTE:
      *      LN-SUM-MAINTFEE = TOTAL CONTRACT CHARGE
      *----------------------------------------------------
           03  LN-SUM-ORIGPURAMT   PIC 9(7)V99   COMP-3.
           03  LN-SUM-LNAMT        PIC 9(7)V99   COMP-3.
           03  LN-SUM-FINCHG       PIC 9(7)V99   COMP-3.
           03  LN-SUM-INTCHG       PIC 9(7)V99   COMP-3.
           03  LN-SUM-ORGTERM      PIC 9(3)      COMP-3.
           03  LN-SUM-REGPYAMT     PIC 9(7)V99   COMP-3.
           03  LN-SUM-EXTCHG       PIC 9(5)V99   COMP-3.
           03  LN-SUM-SERCHG       PIC 9(5)V99   COMP-3.
           03  LN-SUM-MAINTFEE     PIC 9(7)V99   COMP-3.
      *----------------------------------------------------
      *    UNIT PERIOD INFORMATION
      *----------------------------------------------------
           03  LN-UNITPER-INFO.
               05  LN-UNITPER-CD    PIC X.
                   88  LN-UNITPER-CD-DAYS    VALUE "D" "S" "W" "B".
                   88  LN-UNITPER-CD-MONTHS  VALUE "M" "Y".
               05  LN-UNITPER-FREQ  PIC 999        COMP-3.
           03  LN-DAYS-IN-UNITPER   PIC 9(3)       COMP-3.
           03  LN-UNITPER-PER-YEAR  PIC 9(3)V9(12) COMP-3.
      *---------------------------------------------------
      *    LN-REPOCD =         ' '    ACCOUNT WAS NEVER IN REPO
      *    --> IN REPO STATUS  'X'    REPO IS ONHAND
      *    --> IN REPO STATUS  'S'    REPO WAS SOLD
      *    <-- OUT OF REPO     'V'    REPO REDEEMED
      *---------------------------------------------------
           03  LN-REPOCD            PIC X.
               88  LN-IS-REPO-AR     VALUE "X" "S".
               88  LN-REPO-ONHAND    VALUE "X".
               88  LN-REPO-REDEEMED  VALUE "V".
               88  LN-REPO-SOLD      VALUE "S".
           03  LN-BR-TFR-FG         PIC X.
           03  LN-O3INS-DLPROC      PIC 9(7)V99    COMP-3.
           03  LN-INSPREM-DLADJ     PIC S9(5)V99   COMP-3.
           03  LN-PLAMT             PIC 9(7)V99    COMP-3.
      * PLAMT = CURBAL AT TIME OF P&L:
      * MONEYS APPLIED TO PRINCIPAL:
           03  LN-MTD-PRIN          PIC S9(7)V99   COMP-3.
      * MONEYS APPLIED TO LATE CHARGES:
           03  LN-MTD-LC            PIC S9(5)V99   COMP-3.
      * MONEYS APPLIED TO INTEREST:
           03  LN-MTD-INT           PIC S9(5)V99   COMP-3.
      * MONEYS APPLIED TO OTH & OT2:
           03  LN-MTD-OT            PIC S9(5)V99   COMP-3.
      * MONEYS APPLIED RE: EXCEPTION PAYMENTS:
           03  LN-MTD-EX            PIC S9(7)V99   COMP-3.
      * BANKRUPTCY CHAPTER NUMBER:
           03  LN-BNKRPT-CHAPTER    PIC 9(2).
      *----------------------------------------------------------
      * CONTRACTUAL & RECENCY STATUS AT BEGINNING OF MONTH:
      * VALUES:
      *        9  -  NEW LOAN               3  -  90
      *        Y  -  POTENTIAL 30           4  - 120
      *        M  -  MISSPAY                5  - 150
      *        0  -  CURRENT                6  - 180
      *        1  -  30                     7  - 210+
      *        2  -  60
      *----------------------------------------------------------
           03  LN-BMO-CON-STATUS    PIC X.
           03  LN-BMO-REC-STATUS    PIC X.
      * LN-APP-NUMBER IS OLD A15; CAN BE REUSED FOR FUTURE USE!!!
      * DID NOT REMOVED DUE TO SQL DATABASE HASSLE!!!
           03  LN-APP-NUMBER        PIC 9(09)     COMP-3.
      * LN-GIFTNET IS USED FOR WORLD DUAL LOAN OVERRIDE
           03  LN-GIFTNET           PIC X.
           03  LN-GIFTNET-OUR-PO    PIC 9(7)      COMP-3.
           03  LN-PROC-DISBURSED    PIC X.
      * THIS FILLER IS STILL PD-NOODDPY AND USED !!
           03  LN-NOODDPY           PIC X.
      * SIXTY MONTH PROFILES:
           03  LN-CONPROFILE        OCCURS 5
                                    PIC 9(12)     COMP-3.
           03  LN-RECPROFILE        OCCURS 5
                                    PIC 9(12)     COMP-3.
           03  LN-TRW-STATUS        PIC XX.

           03  LN-ORIGIN            PIC X(4).
           03  LN-PO-TRCD           PIC XX.
           03  LN-NEXIS-CRSCORE      PIC 9(3)      COMP-3.
           03  LN-TRW-B-CONSUMER-IND PIC X(2).
           03  LN-PARVHELD-PAID-FG   PIC X.
      *-----------------------------------------------------------------
           03  LN-ACCT-FROZEN        PIC X.
           03  LN-TRW-SPECIAL-CODE   PIC X(2).
      *-----------------------------------------------------------------
      *    LN-CREATION-STATUS:  USED TO KNOW IF CREATED BY A OUTSIDE
      *                         VENDOR (EXTERNAL) OR BY THE LOAN MANAGER
      *                         (INTERNAL).
      *-----------------------------------------------------------------
           03  LN-CREATION-STATUS    PIC X(1).
               88  LN-CREATION-EXTERNAL  VALUE "L".
               88  LN-CREATION-INTERNAL  VALUE "I" " ".
               88  LN-CREATION-LI-VENDOR VALUE "L".
           03  LN-TOTNOLCHG          PIC S9(3)    COMP-3.
           03  LN-LBOX               PIC X(1).
      *-----------------------------------------------------------------
      *    THE FOLLOWING LFP FIELDS ARE USED FOR CALCULATION OF
      *    AMORTIZATION INTEREST RE: REAL ESTATE
      *    WHERE LFP == (L)AST (F)ULL (P)AYMENT
      *-----------------------------------------------------------------
           03  LN-EXTRA-PRIN-LFP               PIC S9(7)V99 COMP-3.
           03  LN-REMAIN-INT-SINCE-LFP         PIC S9(7)V99 COMP-3.
           03  LN-REMAIN-PRIN-SINCE-LFP        PIC S9(7)V99 COMP-3.
      *-----------------------------------------------------------------
           03  LN-INTERIM-COUPON               PIC X.
           03  LN-DLCOMM-O3-CMSI               PIC 9(5)V99 COMP-3.
           03  LN-DLCOMM-PP-CMSI               PIC 9(5)V99 COMP-3.
           03  LN-TRW-J-CONSUMER-IND           PIC X(2).
           03  LN-ACH                          PIC X.
           03  LN-1099-C-FG                    PIC X.
           03  LN-TRW-COMPLIANCE-CODE          PIC XX.
               88  LN-TRW-COMPLIANCE-VALID     VALUE "XA" THRU "XH" "XJ"
                                                     "XR".
           03  LN-UNWIND-REASON-CODE           PIC X(2).
      * NEW FIELDS 
           03  LN-PBI-PBD-FG                   PIC X.
           03  LN-OLD-ACCT-FORMAT-FG           PIC X.
           03  LN-APPROVED-BY-USER             PIC X(10).
           03  LN-APPROVED-BY-CODE             PIC X(3).
      $XFD DATE=YYYYMMDD
           03  LN-APPROVED-BY-DATE             PIC 9(8)     COMP-3.
           03  LN-APPROVED-BY-TIME             PIC 9(6)     COMP-3.
      $XFD DATE=YYYYMMDD
           03  LN-LTOUCH-DATE                  PIC 9(8)     COMP-3.
           03  LN-LTOUCH-TIME                  PIC 9(6)     COMP-3.
      * NEXUS APP ID
           03  LN-LOS-APP-ID                   PIC 9(18)    COMP-3.

           03  FILLER                          PIC X(690).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LN_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LN_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN MASTER FILE
      *
      *=================================================================
      * REV:
      * JKC 2021-0430 ***NEW***
      * JKC 2023-0713 ADDED LN1-RETURN-CODE THRU LN7-RETURN-CODE.
      * BAH 20230714 COMMENT OUT LN6 AND LN7
      * JKC 20240404 ADDED QLN-LOS-APP-ID PIC 9(18).
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  LN1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LN1-CURSOR-STAT-GOOD              VALUE "00".
           88  LN1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  LN3-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LN3-CURSOR-STAT-GOOD              VALUE "00".
           88  LN3-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  LN4-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LN4-CURSOR-STAT-GOOD              VALUE "00".
           88  LN4-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  LN5-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  LN5-CURSOR-STAT-GOOD              VALUE "00".
           88  LN5-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".


      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  LN1-CURSOR-GR-STAT        PIC X(2)    VALUE SPACES.
           88  LN1-CURSOR-GR-STAT-GOOD           VALUE "00".
           88  LN1-CURSOR-GR-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  LN3-CURSOR-GR-STAT        PIC X(2)    VALUE SPACES.
           88  LN3-CURSOR-GR-STAT-GOOD           VALUE "00".
           88  LN3-CURSOR-GR-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

      *- - -{NOT GREATER CURSOR FOR START-NOT-GREATER & READ-PREVIOUS}
       01  LN4-CURSOR-NG-STAT        PIC X(2)    VALUE SPACES.
           88  LN4-CURSOR-NG-STAT-GOOD           VALUE "00".
           88  LN4-CURSOR-NG-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       01  LN5-CURSOR-NG-STAT        PIC X(2)    VALUE SPACES.
           88  LN5-CURSOR-NG-STAT-GOOD           VALUE "00".
           88  LN5-CURSOR-NG-STAT-BAD            VALUE "  " THRU "//"
                                                       "01" THRU "~~".


       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LN1-RETURN-CODE           PIC S9(4)   COMP-5.
       01  LN3-RETURN-CODE           PIC S9(4)   COMP-5.
       01  LN4-RETURN-CODE           PIC S9(4)   COMP-5.
       01  LN5-RETURN-CODE           PIC S9(4)   COMP-5.

       01  QLN1-WHERE-BEG-KEY.
           03  QLN1-WBEG-OWNBR                       PIC 9(4).
           03  QLN1-WBEG-ACCTNO                      PIC 9(8).

       01  QLN1-WHERE-END-KEY.
           03  QLN1-WEND-OWNBR                       PIC 9(4).
           03  QLN1-WEND-ACCTNO                      PIC 9(8).

       01  QLN3-WHERE-BEG-KEY.
           03  QLN3-WBEG-OWNBR                       PIC 9(4).
           03  QLN3-WBEG-CLASS                       PIC 9(3).
           03  QLN3-WBEG-ACCTNO                      PIC 9(8).

       01  QLN3-WHERE-END-KEY.
           03  QLN3-WEND-OWNBR                       PIC 9(4).
           03  QLN3-WEND-CLASS                       PIC 9(3).
           03  QLN3-WEND-ACCTNO                      PIC 9(8).

       01  QLN4-WHERE-BEG-KEY.
           03  QLN4-WBEG-OWNBR                       PIC 9(4).
           03  QLN4-WBEG-SSNO1                       PIC 9(9).

       01  QLN4-WHERE-END-KEY.
           03  QLN4-WEND-OWNBR                       PIC 9(4).
           03  QLN4-WEND-SSNO1                       PIC 9(9).

       01  QLN5-WHERE-BEG-KEY.
           03  QLN5-WBEG-OWNBR                       PIC 9(4).
           03  QLN5-WBEG-SSNO2                       PIC 9(9).

       01  QLN5-WHERE-END-KEY.
           03  QLN5-WEND-OWNBR                       PIC 9(4).
           03  QLN5-WEND-SSNO2                       PIC 9(9).


       01  QLN-REC.
           03  QLN-OWNBR                             PIC 9(4).
           03  QLN-ACCTNO                            PIC 9(8).
           03  QLN-CLASS                             PIC 9(3).
           03  QLN-SUBCLASS                          PIC 99.
           03  QLN-LAWCODE                           PIC 99.
           03  QLN-SSNO1                             PIC 9(9).
           03  QLN-MAKERCD1                          PIC X.
           03  QLN-SSNO2                             PIC 9(9).
           03  QLN-MAKERCD2                          PIC X.
           03  QLN-SSNO3                             PIC 9(9).
           03  QLN-MAKERCD3                          PIC X.
           03  QLN-SSNO4                             PIC 9(9).
           03  QLN-MAKERCD4                          PIC X.
           03  QLN-ORGST                             PIC XX.
           03  QLN-ORGBR                             PIC 9(4).
           03  QLN-OWNST                             PIC XX.
           03  QLN-SPRCLASS                          PIC 9(3).
           03  QLN-CONVERCD                          PIC X.
           03  QLN-MIDSTREAM                         PIC X.
           03  QLN-PURCD                             PIC XXX.
           03  QLN-SRCD                              PIC XX.
           03  QLN-COLLCD                            PIC X(2).
           03  QLN-COLLID                            PIC X(20).
           03  QLN-POCD                              PIC XX.
           03  QLN-PLCD                              PIC X.
           03  QLN-PLTYPE                            PIC X.
           03  QLN-CONFIDENTCD                       PIC X.
           03  QLN-ALLOTCD                           PIC X.
           03  QLN-RECASTCD                          PIC X.
           03  QLN-SKIP-TRW                          PIC X.
           03  QLN-STATUSFG                          PIC X.
           03  QLN-SMALLOAN                          PIC X.
           03  QLN-SALEFIN                           PIC X.
           03  QLN-SERVACCT                          PIC X.
           03  QLN-LOANTYPE                          PIC X.
           03  QLN-ADDON-FG                          PIC X.
           03  QLN-PAY-SCHLD-FG                      PIC X.
           03  QLN-LC-CODE                           PIC 99.
           03  QLN-CAN-LOAN-NO                       PIC XX.
           03  QLN-STATFLAGS                         PIC X(20).
           03  QLN-ENTDATE                           PIC X(10).
           03  QLN-LOANDATE                          PIC X(10).
           03  QLN-PURDATE                           PIC X(10).
           03  QLN-INTDATE                           PIC X(10).
           03  QLN-CASHDATE                          PIC X(10).
           03  QLN-FILEDATE                          PIC X(10).
           03  QLN-RESCISSION-DATE                   PIC X(10).
           03  QLN-PART-RECOURSE-DATE                PIC X(10).
           03  QLN-ORIG-1STPYDATE                    PIC X(10).
           03  QLN-1STPYDATE                         PIC X(10).
           03  QLN-JDDATE                            PIC X(10).
           03  QLN-PLDATE                            PIC X(10).
           03  QLN-PL-TRDATE                         PIC X(10).
           03  QLN-ACCELDATE                         PIC X(10).
           03  QLN-REDUDATE                          PIC X(10).
           03  QLN-POFFDATE                          PIC X(10).
           03  QLN-PO-TRDATE                         PIC X(10).
           03  QLN-LEGALDATE                         PIC X(10).
           03  QLN-BNKRPTDATE                        PIC X(10).
           03  QLN-BNKRPT-DISMISS-DATE               PIC X(10).
           03  QLN-BNKRPT-DISCHARGE-DATE             PIC X(10).
           03  QLN-BNKRPT-REAFFIRM-DATE              PIC X(10).
           03  QLN-DEBTAIDATE                        PIC X(10).
           03  QLN-REPODATE                          PIC X(10).
           03  QLN-REDEEMDATE                        PIC X(10).
           03  QLN-SOLDDATE                          PIC X(10).
           03  QLN-INS-CONFIRM-DATE                  PIC X(10).
           03  QLN-PRIOR-RN-FOR10-DATE               PIC X(10).
           03  QLN-LAST-RN-FOR10-DATE                PIC X(10).
           03  QLN-TRW-DOFD-DATE                     PIC X(10).
           03  QLN-LAST-PYPA-DATE                    PIC X(10).
           03  QLN-BT-TRDATE                         PIC X(10).
           03  QLN-METRO2-LAST-PMT-DATE              PIC X(10).
           03  QLN-FOLLOWUP-DATE                     PIC X(10).
           03  QLN-LAST-ACCRUAL-DATE                 PIC X(10).
           03  QLN-APRATE                            PIC 999V999.
           03  QLN-EFFRATE                           PIC 999V999.
           03  QLN-SMPRATE                           PIC 999V999.
           03  QLN-YLDRATE                           PIC 999V999.
           03  QLN-OVRDRATE                          PIC 999V999.
           03  QLN-ENDORATE                          PIC 999V999.
           03  QLN-JDRATE                            PIC 999V999.
           03  QLN-ACCRATE                           PIC 999V999.
           03  QLN-REDURATE                          PIC 999V999.
           03  QLN-CONRATE                           PIC 999V999.
           03  QLN-SERVPER                           PIC 9(3)V99.
           03  QLN-SELLPR                            PIC 9(7)V99.
           03  QLN-DOWNPY                            PIC 9(7)V99.
           03  QLN-TRADEIN                           PIC S9(7)V99.
           03  QLN-LNAMT                             PIC 9(7)V99.
           03  QLN-FINCHG                            PIC 9(7)V99.
           03  QLN-INTCHG                            PIC 9(7)V99.
           03  QLN-SERCHG                            PIC 9(5)V99.
           03  QLN-EXTCHG                            PIC 9(5)V99.
           03  QLN-MAINTFEE                          PIC 9(5)V99.
           03  QLN-POINTS                            PIC 99V99.
           03  QLN-PROCEEDS                          PIC S9(7)V99.
           03  QLN-ORGTERM                           PIC 9(3).
           03  QLN-1STPYAMT                          PIC 9(7)V99.
           03  QLN-NOREGPY                           PIC 9(3).
           03  QLN-REGPYAMT                          PIC 9(7)V99 .
           03  QLN-LASTPYAMT                         PIC S9(7)V99.
           03  QLN-PROCASH                           PIC S9(7)V99.
           03  QLN-TILLNO                            PIC 9(2).
           03  QLN-STATE-FLAG                        PIC X.
           03  QLN-STATE-WORKER                      PIC S9(7)V99.
           03  QLN-STATE-WORKER2                     PIC S9(5)V99.
           03  QLN-FEECODE-1                         PIC XX.
           03  QLN-FEEAMT-1                          PIC 9(5)V99.
           03  QLN-FEEOURS-1                         PIC X.
           03  QLN-FEEFINCHG-1                       PIC X.
           03  QLN-FEECODE-2                         PIC XX.
           03  QLN-FEEAMT-2                          PIC 9(5)V99.
           03  QLN-FEEOURS-2                         PIC X.
           03  QLN-FEEFINCHG-2                       PIC X.
           03  QLN-FEECODE-3                         PIC XX.
           03  QLN-FEEAMT-3                          PIC 9(5)V99.
           03  QLN-FEEOURS-3                         PIC X.
           03  QLN-FEEFINCHG-3                       PIC X.
           03  QLN-FEECODE-4                         PIC XX.
           03  QLN-FEEAMT-4                          PIC 9(5)V99.
           03  QLN-FEEOURS-4                         PIC X.
           03  QLN-FEEFINCHG-4                       PIC X.
           03  QLN-FEECODE-5                         PIC XX.
           03  QLN-FEEAMT-5                          PIC 9(5)V99.
           03  QLN-FEEOURS-5                         PIC X.
           03  QLN-FEEFINCHG-5                       PIC X.
           03  QLN-FEECODE-6                         PIC XX.
           03  QLN-FEEAMT-6                          PIC 9(5)V99.
           03  QLN-FEEOURS-6                         PIC X.
           03  QLN-FEEFINCHG-6                       PIC X.
           03  QLN-FEECODE-7                         PIC XX.
           03  QLN-FEEAMT-7                          PIC 9(5)V99.
           03  QLN-FEEOURS-7                         PIC X.
           03  QLN-FEEFINCHG-7                       PIC X.
           03  QLN-FEECODE-8                         PIC XX.
           03  QLN-FEEAMT-8                          PIC 9(5)V99.
           03  QLN-FEEOURS-8                         PIC X.
           03  QLN-FEEFINCHG-8                       PIC X.
           03  QLN-FEECODE-9                         PIC XX.
           03  QLN-FEEAMT-9                          PIC 9(5)V99.
           03  QLN-FEEOURS-9                         PIC X.
           03  QLN-FEEFINCHG-9                       PIC X.
           03  QLN-FEECODE-10                        PIC XX.
           03  QLN-FEEAMT-10                         PIC 9(5)V99.
           03  QLN-FEEOURS-10                        PIC X.
           03  QLN-FEEFINCHG-10                      PIC X.
           03  QLN-FEECODE-11                        PIC XX.
           03  QLN-FEEAMT-11                         PIC 9(5)V99.
           03  QLN-FEEOURS-11                        PIC X.
           03  QLN-FEEFINCHG-11                      PIC X.
           03  QLN-FEECODE-12                        PIC XX.
           03  QLN-FEEAMT-12                         PIC 9(5)V99.
           03  QLN-FEEOURS-12                        PIC X.
           03  QLN-FEEFINCHG-12                      PIC X.
           03  QLN-FEECODE-13                        PIC XX.
           03  QLN-FEEAMT-13                         PIC 9(5)V99.
           03  QLN-FEEOURS-13                        PIC X.
           03  QLN-FEEFINCHG-13                      PIC X.
           03  QLN-FEECODE-14                        PIC XX.
           03  QLN-FEEAMT-14                         PIC 9(5)V99.
           03  QLN-FEEOURS-14                        PIC X.
           03  QLN-FEEFINCHG-14                      PIC X.
           03  QLN-FEECODE-15                        PIC XX.
           03  QLN-FEEAMT-15                         PIC 9(5)V99.
           03  QLN-FEEOURS-15                        PIC X.
           03  QLN-FEEFINCHG-15                      PIC X.
           03  QLN-FEECODE-16                        PIC XX.
           03  QLN-FEEAMT-16                         PIC 9(5)V99.
           03  QLN-FEEOURS-16                        PIC X.
           03  QLN-FEEFINCHG-16                      PIC X.
           03  QLN-FEECODE-17                        PIC XX.
           03  QLN-FEEAMT-17                         PIC 9(5)V99.
           03  QLN-FEEOURS-17                        PIC X.
           03  QLN-FEEFINCHG-17                      PIC X.
           03  QLN-FEECODE-18                        PIC XX.
           03  QLN-FEEAMT-18                         PIC 9(5)V99.
           03  QLN-FEEOURS-18                        PIC X.
           03  QLN-FEEFINCHG-18                      PIC X.
           03  QLN-FEECODE-19                        PIC XX.
           03  QLN-FEEAMT-19                         PIC 9(5)V99.
           03  QLN-FEEOURS-19                        PIC X.
           03  QLN-FEEFINCHG-19                      PIC X.
           03  QLN-FEECODE-20                        PIC XX.
           03  QLN-FEEAMT-20                         PIC 9(5)V99.
           03  QLN-FEEOURS-20                        PIC X.
           03  QLN-FEEFINCHG-20                      PIC X.
           03  QLN-INSURED                           PIC X.
           03  QLN-INSTYPES                          PIC X.
           03  QLN-INSELIGIBLE                       PIC X.
           03  QLN-INSCOMP-1                         PIC 99.
           03  QLN-INSOURS-1                         PIC X.
           03  QLN-INSEFF-DATE-1                     PIC X(10).
           03  QLN-INSEXP-DATE-1                     PIC X(10).
           03  QLN-INSPREM-1                         PIC 9(5)V99.
           03  QLN-INSCOVR-1                         PIC 9(7)V99.
           03  QLN-INSCOMM-1                         PIC 9(5)V99.
           03  QLN-INSANTICERN-1                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-1                     PIC S9(7)V99.
           03  QLN-INSUFERN-1                        PIC S9(7)V99.
           03  QLN-INSACCERN-1                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-1                   PIC 99.
           03  QLN-INSFINCHG-1                       PIC X.
           03  QLN-INSCOMP-2                         PIC 99.
           03  QLN-INSOURS-2                         PIC X.
           03  QLN-INSEFF-DATE-2                     PIC X(10).
           03  QLN-INSEXP-DATE-2                     PIC X(10).
           03  QLN-INSPREM-2                         PIC 9(5)V99.
           03  QLN-INSCOVR-2                         PIC 9(7)V99.
           03  QLN-INSCOMM-2                         PIC 9(5)V99.
           03  QLN-INSANTICERN-2                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-2                     PIC S9(7)V99.
           03  QLN-INSUFERN-2                        PIC S9(7)V99.
           03  QLN-INSACCERN-2                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-2                   PIC 99.
           03  QLN-INSFINCHG-2                       PIC X.
           03  QLN-INSCOMP-3                         PIC 99.
           03  QLN-INSOURS-3                         PIC X.
           03  QLN-INSEFF-DATE-3                     PIC X(10).
           03  QLN-INSEXP-DATE-3                     PIC X(10).
           03  QLN-INSPREM-3                         PIC 9(5)V99.
           03  QLN-INSCOVR-3                         PIC 9(7)V99.
           03  QLN-INSCOMM-3                         PIC 9(5)V99.
           03  QLN-INSANTICERN-3                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-3                     PIC S9(7)V99.
           03  QLN-INSUFERN-3                        PIC S9(7)V99.
           03  QLN-INSACCERN-3                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-3                   PIC 99.
           03  QLN-INSFINCHG-3                       PIC X.
           03  QLN-INSCOMP-4                         PIC 99.
           03  QLN-INSOURS-4                         PIC X.
           03  QLN-INSEFF-DATE-4                     PIC X(10).
           03  QLN-INSEXP-DATE-4                     PIC X(10).
           03  QLN-INSPREM-4                         PIC 9(5)V99.
           03  QLN-INSCOVR-4                         PIC 9(7)V99.
           03  QLN-INSCOMM-4                         PIC 9(5)V99.
           03  QLN-INSANTICERN-4                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-4                     PIC S9(7)V99.
           03  QLN-INSUFERN-4                        PIC S9(7)V99.
           03  QLN-INSACCERN-4                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-4                   PIC 99.
           03  QLN-INSFINCHG-4                       PIC X.
           03  QLN-INSCOMP-5                         PIC 99.
           03  QLN-INSOURS-5                         PIC X.
           03  QLN-INSEFF-DATE-5                     PIC X(10).
           03  QLN-INSEXP-DATE-5                     PIC X(10).
           03  QLN-INSPREM-5                         PIC 9(5)V99.
           03  QLN-INSCOVR-5                         PIC 9(7)V99.
           03  QLN-INSCOMM-5                         PIC 9(5)V99.
           03  QLN-INSANTICERN-5                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-5                     PIC S9(7)V99.
           03  QLN-INSUFERN-5                        PIC S9(7)V99.
           03  QLN-INSACCERN-5                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-5                   PIC 99.
           03  QLN-INSFINCHG-5                       PIC X.
           03  QLN-INSCOMP-6                         PIC 99.
           03  QLN-INSOURS-6                         PIC X.
           03  QLN-INSEFF-DATE-6                     PIC X(10).
           03  QLN-INSEXP-DATE-6                     PIC X(10).
           03  QLN-INSPREM-6                         PIC 9(5)V99.
           03  QLN-INSCOVR-6                         PIC 9(7)V99.
           03  QLN-INSCOMM-6                         PIC 9(5)V99.
           03  QLN-INSANTICERN-6                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-6                     PIC S9(7)V99.
           03  QLN-INSUFERN-6                        PIC S9(7)V99.
           03  QLN-INSACCERN-6                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-6                   PIC 99.
           03  QLN-INSFINCHG-6                       PIC X.
           03  QLN-INSCOMP-7                         PIC 99.
           03  QLN-INSOURS-7                         PIC X.
           03  QLN-INSEFF-DATE-7                     PIC X(10).
           03  QLN-INSEXP-DATE-7                     PIC X(10).
           03  QLN-INSPREM-7                         PIC 9(5)V99.
           03  QLN-INSCOVR-7                         PIC 9(7)V99.
           03  QLN-INSCOMM-7                         PIC 9(5)V99.
           03  QLN-INSANTICERN-7                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-7                     PIC S9(7)V99.
           03  QLN-INSUFERN-7                        PIC S9(7)V99.
           03  QLN-INSACCERN-7                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-7                   PIC 99.
           03  QLN-INSFINCHG-7                       PIC X.
           03  QLN-INSCOMP-8                         PIC 99.
           03  QLN-INSOURS-8                         PIC X.
           03  QLN-INSEFF-DATE-8                     PIC X(10).
           03  QLN-INSEXP-DATE-8                     PIC X(10).
           03  QLN-INSPREM-8                         PIC 9(5)V99.
           03  QLN-INSCOVR-8                         PIC 9(7)V99.
           03  QLN-INSCOMM-8                         PIC 9(5)V99.
           03  QLN-INSANTICERN-8                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-8                     PIC S9(7)V99.
           03  QLN-INSUFERN-8                        PIC S9(7)V99.
           03  QLN-INSACCERN-8                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-8                   PIC 99.
           03  QLN-INSFINCHG-8                       PIC X.
           03  QLN-INSCOMP-9                         PIC 99.
           03  QLN-INSOURS-9                         PIC X.
           03  QLN-INSEFF-DATE-9                     PIC X(10).
           03  QLN-INSEXP-DATE-9                     PIC X(10).
           03  QLN-INSPREM-9                         PIC 9(5)V99.
           03  QLN-INSCOVR-9                         PIC 9(7)V99.
           03  QLN-INSCOMM-9                         PIC 9(5)V99.
           03  QLN-INSANTICERN-9                     PIC S9(7)V99.
           03  QLN-INSANTICADJ-9                     PIC S9(7)V99.
           03  QLN-INSUFERN-9                        PIC S9(7)V99.
           03  QLN-INSACCERN-9                       PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-9                   PIC 99.
           03  QLN-INSFINCHG-9                       PIC X.
           03  QLN-INSCOMP-10                        PIC 99.
           03  QLN-INSOURS-10                        PIC X.
           03  QLN-INSEFF-DATE-10                    PIC X(10).
           03  QLN-INSEXP-DATE-10                    PIC X(10).
           03  QLN-INSPREM-10                        PIC 9(5)V99.
           03  QLN-INSCOVR-10                        PIC 9(7)V99.
           03  QLN-INSCOMM-10                        PIC 9(5)V99.
           03  QLN-INSANTICERN-10                    PIC S9(7)V99.
           03  QLN-INSANTICADJ-10                    PIC S9(7)V99.
           03  QLN-INSUFERN-10                       PIC S9(7)V99.
           03  QLN-INSACCERN-10                      PIC S9(7)V99.
           03  QLN-INSEARN-ORDER-10                  PIC 99.
           03  QLN-INSFINCHG-10                      PIC X.
           03  QLN-PY-YYYYMM-RECDEL                  PIC 9(6).
           03  QLN-MTD-PAYS-RECDEL                   PIC S9(7)V99.
           03  QLN-GARNISH-EXTR                      PIC X.
           03  QLN-SHIP-SAME-FG                      PIC X.
           03  QLN-AD-D-INS-COVR                     PIC 9(7).
           03  QLN-TOT-PARTIAL-CHGOFF                PIC S9(7)V99.
           03  QLN-LPO                               PIC X(4).
           03  QLN-REP-CD                            PIC X(8).
           03  QLN-EMP-ID                            PIC 9(8).
           03  QLN-PROCESS-CD                        PIC X.
           03  QLN-WCBC-CREDITLIM                    PIC S9(5).
           03  QLN-FOLLOWUP-CD                       PIC X(4).
           03  QLN-MIP-FG                            PIC X.
           03  QLN-MIP-MTD-CLAHPAID                  PIC S9(5)V99.
           03  QLN-MIP-CLPDTH-DATE                   PIC X(10).
           03  QLN-MIP-TOT-CLPAID                    PIC S9(7)V99.
           03  QLN-MIP-AHPDTH-DATE                   PIC X(10).
           03  QLN-MIP-TOT-AHPAID                    PIC S9(7)V99.
           03  QLN-IL-GROSS-INCOME                   PIC S9(7)V99.
           03  QLN-IL-GROSS-INCOME2                  PIC S9(7)V99.
           03  QLN-RESCISSION                        PIC X(1).
           03  QLN-INTERIM-TRW                       PIC X(1).
           03  QLN-DLNO                              PIC 9(4)V99.
           03  QLN-DLPOOL                            PIC 9(5).
           03  QLN-DLRECOURSE                        PIC X.
           03  QLN-DLPARTRCAMT                       PIC 9(7)V99.
           03  QLN-ORIGPURAMT                        PIC 9(7)V99.
           03  QLN-PURBAL                            PIC S9(7)V99.
           03  QLN-DLRVPRIN-1                        PIC 9(7)V99.
           03  QLN-DLRVPRIN-2                        PIC 9(7)V99.
           03  QLN-DLRVPRIN-3                        PIC 9(7)V99.
           03  QLN-DLRVCHGS-1                        PIC 9(7)V99.
           03  QLN-DLRVCHGS-2                        PIC 9(7)V99.
           03  QLN-DLRVCHGS-3                        PIC 9(7)V99.
           03  QLN-DLPARVHELD                        PIC 9(7)V99.
           03  QLN-DLPARVPAID                        PIC 9(7)V99.
           03  QLN-DLDISC                            PIC 9(7)V99.
           03  QLN-LCPDTH-DATE                       PIC X(10).
           03  QLN-INTPDTH-DATE                      PIC X(10).
           03  QLN-CURBAL                            PIC S9(7)V99.
           03  QLN-INTBAL                            PIC S9(7)V99.
           03  QLN-LCBAL                             PIC S9(7)V99.
           03  QLN-OTHBAL                            PIC S9(7)V99.
           03  QLN-OT2BAL                            PIC S9(7)V99.
           03  QLN-LCPAID                            PIC S9(7)V99.
           03  QLN-LCPARTIALS                        PIC S9(7)V99.
           03  QLN-STMT-COUNTER                      PIC 9(5).
           03  QLN-PRIOR-STMT-COUNTER                PIC 9(5).
           03  QLN-FROZEN-REASON                     PIC X(2).
           03  QLN-COUPON-STATEMENT                  PIC X.
           03  QLN-MONTHEND-BAL                      PIC 9(7)V99.
           03  QLN-ANTICTERM                         PIC 9(3).
           03  QLN-ANTICERN-1                        PIC S9(7)V99.
           03  QLN-ANTICADJ-1                        PIC S9(7)V99.
           03  QLN-UFERN-1                           PIC S9(7)V99.
           03  QLN-ACCERN-1                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-1                      PIC 99.
           03  QLN-ANTICERN-2                        PIC S9(7)V99.
           03  QLN-ANTICADJ-2                        PIC S9(7)V99.
           03  QLN-UFERN-2                           PIC S9(7)V99.
           03  QLN-ACCERN-2                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-2                      PIC 99.
           03  QLN-ANTICERN-3                        PIC S9(7)V99.
           03  QLN-ANTICADJ-3                        PIC S9(7)V99.
           03  QLN-UFERN-3                           PIC S9(7)V99.
           03  QLN-ACCERN-3                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-3                      PIC 99.
           03  QLN-ANTICERN-4                        PIC S9(7)V99.
           03  QLN-ANTICADJ-4                        PIC S9(7)V99.
           03  QLN-UFERN-4                           PIC S9(7)V99.
           03  QLN-ACCERN-4                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-4                      PIC 99.
           03  QLN-ANTICERN-5                        PIC S9(7)V99.
           03  QLN-ANTICADJ-5                        PIC S9(7)V99.
           03  QLN-UFERN-5                           PIC S9(7)V99.
           03  QLN-ACCERN-5                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-5                      PIC 99.
           03  QLN-ANTICERN-6                        PIC S9(7)V99.
           03  QLN-ANTICADJ-6                        PIC S9(7)V99.
           03  QLN-UFERN-6                           PIC S9(7)V99.
           03  QLN-ACCERN-6                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-6                      PIC 99.
           03  QLN-ANTICERN-7                        PIC S9(7)V99.
           03  QLN-ANTICADJ-7                        PIC S9(7)V99.
           03  QLN-UFERN-7                           PIC S9(7)V99.
           03  QLN-ACCERN-7                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-7                      PIC 99.
           03  QLN-ANTICERN-8                        PIC S9(7)V99.
           03  QLN-ANTICADJ-8                        PIC S9(7)V99.
           03  QLN-UFERN-8                           PIC S9(7)V99.
           03  QLN-ACCERN-8                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-8                      PIC 99.
           03  QLN-ANTICERN-9                        PIC S9(7)V99.
           03  QLN-ANTICADJ-9                        PIC S9(7)V99.
           03  QLN-UFERN-9                           PIC S9(7)V99.
           03  QLN-ACCERN-9                          PIC S9(7)V99.
           03  QLN-EARN-ORDER-9                      PIC 99.
           03  QLN-ANTICERN-10                       PIC S9(7)V99.
           03  QLN-ANTICADJ-10                       PIC S9(7)V99.
           03  QLN-UFERN-10                          PIC S9(7)V99.
           03  QLN-ACCERN-10                         PIC S9(7)V99.
           03  QLN-EARN-ORDER-10                     PIC 99.
           03  QLN-LMO-PRIOR-INTEREST                PIC S9(7)V99.
           03  QLN-PRIOR-UNEARNED                    PIC S9(7)V99.
           03  QLN-ERNDELQ-STOP                      PIC X.
           03  QLN-NONACRERN                         PIC S9(7)V99.
           03  QLN-PRIOR-NONACRERN                   PIC S9(7)V99.
           03  QLN-ERN-IB-PDTH-DATE                  PIC X(10).
           03  QLN-ERN-IB-PRINBAL                    PIC S9(7)V99.
           03  QLN-ERN-IB-INTOWE                     PIC S9(7)V99.
           03  QLN-TOTERN                            PIC S9(7)V99.
           03  QLN-TOTOTH                            PIC S9(7)V99.
           03  QLN-TOTINT                            PIC S9(7)V99.
           03  QLN-TOTLCHG                           PIC S9(7)V99.
           03  QLN-TOTDEF                            PIC S9(7)V99.
           03  QLN-TOTSERACCT                        PIC S9(7)V99.
           03  QLN-LCWAIVERS                         PIC S9(5)V99.
           03  QLN-INTWAIVERS                        PIC S9(5)V99.
           03  QLN-TOTPAYMNTD                        PIC S9(7)V99.
           03  QLN-TOTEXCPAYMNTD                     PIC S9(7)V99.
           03  QLN-TOTNODEF                          PIC S99.
           03  QLN-YTDNODEF                          PIC S99.
           03  QLN-TOTNODEFACT                       PIC S99.
           03  QLN-YTDNODEFACT                       PIC S99.
           03  QLN-TOTNOALDEL                        PIC S99.
           03  QLN-YTDNOALDEL                        PIC S99.
           03  QLN-YTDINTPD                          PIC S9(7)V99.
           03  QLN-LYRINTPD                          PIC S9(7)V99.
           03  QLN-TOTINTPD                          PIC S9(7)V99.
           03  QLN-RECASTINT                         PIC 9(7)V99.
           03  QLN-RECASTPRIN                        PIC 9(7)V99.
           03  QLN-CL-REBATE                         PIC X.
           03  QLN-AH-REBATE                         PIC X.
           03  QLN-PP-REBATE                         PIC X.
           03  QLN-INT-REBATE                        PIC X.
           03  QLN-SC-REBATE                         PIC X.
           03  QLN-MF-REBATE                         PIC X.
           03  QLN-DF-REBATE                         PIC X.
           03  QLN-EX-REBATE                         PIC X.
           03  QLN-O1-REBATE                         PIC X.
           03  QLN-O2-REBATE                         PIC X.
           03  QLN-O3-REBATE                         PIC X.
           03  QLN-O4-REBATE                         PIC X.
           03  QLN-O5-REBATE                         PIC X.
           03  QLN-O6-REBATE                         PIC X.
           03  QLN-O7-REBATE                         PIC X.
           03  QLN-UN-O7-REB                         PIC X.
           03  QLN-UN-O8-REB                         PIC X.
           03  QLN-UN-O9-REB                         PIC X.
           03  QLN-UN-O10-REB                        PIC X.
           03  QLN-PLREASON                          PIC XX.
           03  QLN-COLLECTOR                         PIC X(3).
           03  QLN-ACTIONCD                          PIC X(4).
           03  QLN-ACTIONCD2                         PIC X(4).
           03  QLN-ATCODE                            PIC X(3).
           03  QLN-RECODE                            PIC X(3).
           03  QLN-ESCROW-FG                         PIC X.
           03  QLN-PROMDAYS-PASTDUE                  PIC S9(3).
           03  QLN-PROMID                            PIC X(3).
           03  QLN-PROMDATE                          PIC X(10).
           03  QLN-PROMAMT                           PIC 9(7)V99.
           03  QLN-PROMDATE2                         PIC X(10).
           03  QLN-DATE-PAID-LAST                    PIC X(10).
           03  QLN-AMT-PAID-LAST                     PIC 9(7)V99.
           03  QLN-LASTCFORMNO                       PIC 9(5).
           03  QLN-LASTCFORMDATE                     PIC X(10).
           03  QLN-DELCNT                            PIC 99.
           03  QLN-DELCNT2                           PIC 99.
           03  QLN-CREDITLIM                         PIC 9(7).
           03  QLN-CRSCORE                           PIC S9(3).
           03  QLN-LASTSFORMNO                       PIC 9(5).
           03  QLN-LASTSFORMDATE                     PIC X(10).
           03  QLN-SOLCNT                            PIC 99.
           03  QLN-MESSAGE                           PIC X(30).
           03  QLN-OLDACCTNO                         PIC 9(8).
           03  QLN-PRLNNO                            PIC 9(8).
           03  QLN-PRBAL                             PIC S9(7)V99.
           03  QLN-PRINTDUE                          PIC S9(7)V99.
           03  QLN-PRFINCHGRB                        PIC S9(7)V99.
           03  QLN-PRINSRB                           PIC S9(7)V99.
           03  QLN-PRPOCD                            PIC XX.
           03  QLN-PRPODATE                          PIC X(10).
           03  QLN-PRDELINQAMT                       PIC S9(7)V99.
           03  QLN-PRLNAMT                           PIC 9(7)V99.
           03  QLN-PRPDUE-DAYS                       PIC S9(5).
           03  QLN-PRDLDISC-UNEARN                   PIC S9(7)V99.
           03  QLN-PRCONPROFILE                      PIC 9(12).
           03  QLN-SUM-ORIGPURAMT                    PIC 9(7)V99.
           03  QLN-SUM-LNAMT                         PIC 9(7)V99.
           03  QLN-SUM-FINCHG                        PIC 9(7)V99.
           03  QLN-SUM-INTCHG                        PIC 9(7)V99.
           03  QLN-SUM-ORGTERM                       PIC 9(3).
           03  QLN-SUM-REGPYAMT                      PIC 9(7)V99.
           03  QLN-SUM-EXTCHG                        PIC 9(5)V99.
           03  QLN-SUM-SERCHG                        PIC 9(5)V99.
           03  QLN-SUM-MAINTFEE                      PIC 9(7)V99.
           03  QLN-UNITPER-CD                        PIC X.
           03  QLN-UNITPER-FREQ                      PIC 999.
           03  QLN-DAYS-IN-UNITPER                   PIC 9(3).
           03  QLN-UNITPER-PER-YEAR                  PIC 9(3)V9(12).
           03  QLN-REPOCD                            PIC X.
           03  QLN-BR-TFR-FG                         PIC X.
           03  QLN-O3INS-DLPROC                      PIC 9(7)V99.
           03  QLN-INSPREM-DLADJ                     PIC S9(5)V99.
           03  QLN-PLAMT                             PIC 9(7)V99.
           03  QLN-MTD-PRIN                          PIC S9(7)V99.
           03  QLN-MTD-LC                            PIC S9(5)V99.
           03  QLN-MTD-INT                           PIC S9(5)V99.
           03  QLN-MTD-OT                            PIC S9(5)V99.
           03  QLN-MTD-EX                            PIC S9(7)V99.
           03  QLN-BNKRPT-CHAPTER                    PIC 9(2).
           03  QLN-BMO-CON-STATUS                    PIC X.
           03  QLN-BMO-REC-STATUS                    PIC X.
           03  QLN-APP-NUMBER                        PIC 9(09).
           03  QLN-GIFTNET                           PIC X.
           03  QLN-GIFTNET-OUR-PO                    PIC 9(7).
           03  QLN-PROC-DISBURSED                    PIC X.
           03  QLN-NOODDPY                           PIC X.
           03  QLN-CONPROFILE-1                      PIC 9(12).
           03  QLN-CONPROFILE-2                      PIC 9(12).
           03  QLN-CONPROFILE-3                      PIC 9(12).
           03  QLN-CONPROFILE-4                      PIC 9(12).
           03  QLN-CONPROFILE-5                      PIC 9(12).
           03  QLN-RECPROFILE-1                      PIC 9(12).
           03  QLN-RECPROFILE-2                      PIC 9(12).
           03  QLN-RECPROFILE-3                      PIC 9(12).
           03  QLN-RECPROFILE-4                      PIC 9(12).
           03  QLN-RECPROFILE-5                      PIC 9(12).
           03  QLN-TRW-STATUS                        PIC XX.
           03  QLN-ORIGIN                            PIC X(4).
           03  QLN-PO-TRCD                           PIC XX.
           03  QLN-NEXIS-CRSCORE                     PIC 9(3).
           03  QLN-TRW-B-CONSUMER-IND                PIC X(2).
           03  QLN-PARVHELD-PAID-FG                  PIC X.
           03  QLN-ACCT-FROZEN                       PIC X.
           03  QLN-TRW-SPECIAL-CODE                  PIC X(2).
           03  QLN-CREATION-STATUS                   PIC X(1).
           03  QLN-TOTNOLCHG                         PIC S9(3).
           03  QLN-LBOX                              PIC X(1).
           03  QLN-EXTRA-PRIN-LFP                    PIC S9(7)V99.
           03  QLN-REMAIN-INT-SINCE-LFP              PIC S9(7)V99.
           03  QLN-REMAIN-PRIN-SINCE-LFP             PIC S9(7)V99.
           03  QLN-INTERIM-COUPON                    PIC X.
           03  QLN-DLCOMM-O3-CMSI                    PIC 9(5)V99.
           03  QLN-DLCOMM-PP-CMSI                    PIC 9(5)V99.
           03  QLN-TRW-J-CONSUMER-IND                PIC X(2).
           03  QLN-ACH                               PIC X.
           03  QLN-1099-C-FG                         PIC X.
           03  QLN-TRW-COMPLIANCE-CODE               PIC XX.
           03  QLN-UNWIND-REASON-CODE                PIC X(2).
           03  QLN-PBI-PBD-FG                        PIC X.
           03  QLN-OLD-ACCT-FORMAT-FG                PIC X.
           03  QLN-APPROVED-BY-USER                  PIC X(10).
           03  QLN-APPROVED-BY-CODE                  PIC X(3).
           03  QLN-APPROVED-BY-DATE                  PIC X(10).
           03  QLN-APPROVED-BY-TIME                  PIC 9(6).
           03  QLN-LTOUCH-DATE                       PIC X(10).
           03  QLN-LTOUCH-TIME                       PIC 9(6).
           03  QLN-LOS-APP-ID                        PIC 9(18).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LN_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLN.CPY                           *
      *================================================================*
      ******************************************************************
      *
      * IDENTIFICATION: LIBLP/LPWSLN_SQL.CPY
      * DESCRIPTION   : FILE & SQL PATH WORKERS (LNFILE)
      *
      * LN-PATH = /USR/DATA/R#/XX####/LP/LNFILE
      *           |----BEG----||-MID-||-----FILE----|
      *                                  |---SQL----|
      *
      *=================================================================
      * REV:
      * JKC 2021-0128 ***NEW***
      * BAH 2024.0130 ADDED HOLD-LN-REC
      *
      ******************************************************************
       01  LN-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  LN-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES LN-PATH.
           03  LN-PATH-BEG           PIC X(13).
           03  LN-PATH-OWNST         PIC X(02).
           03  LN-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  LN-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LN-PATH-FILE.
               05  FILLER            PIC X(03).
               05  LN-PATH-SQL       PIC X(12).

       01  LN-ALL-PATH.
           03  LN-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES LN-ALL-BASE.
               05  LN-ALL-BASE-USR   PIC X(05).
               05  LN-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  LN-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(01)   VALUE "/".
           03  LN-ALL-DATA           PIC X(06).
           03  FILLER                PIC X(10)   VALUE "/LP/LNFILE".

       01  LN-BI-FG                  PIC X     VALUE " ".
       01  LN-BASE-ARCHIVE           PIC X(04) VALUE " ".

      *=================================================================
      * IDEAS: PRE-COMPILE EXEC SQL WORKERS (QLN-REC) AND PUT CODE INTO
      *        END OF LIBLP/LPWSLN.CPY
      *=================================================================
       01  HOLD-LN-REC               PIC X(LN-SIZE).
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LTI.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LT
      ******************************************************************
      *    INSURANCE LOAN TRAILER FILE 
      *
      *     CREATED BY ADDON INSURANCE
      *
      *       STORES A RECORD FOR EACH TYPE OF ADDON INSURANCE
      *
      *    LTI1-KEY = LTI-BRNO, LTI-ACCTNO, LTI-SEQNO
      *
      *
      *  BAH 06/19/2015 CREATED NEW FROM LP01LT
      *  BAH 02/18/2019 REMOVED LTI-INSTRM
      *   CS 190507 ADD FUTURE FIELDS
      *  BAH 20200324 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * AMM 20210429 REMOVED FUTURE FIELDS, RESIZED FILE
      *  BAH 20230600 ADDED FILLER
      **************************************************************************
       78  LTI-SIZE                      VALUE 370.
       01  LTI-REC.
           03  LTI1-KEY.
               05  LTI-BRNO           PIC 9(4).
               05  LTI-ACCTNO         PIC 9(8).
      * THIS MAY BE THE LP-LT-SEQNO FOR WHICH ADDON INSURANCE RECORD TO GET
               05  LTI-SEQNO          PIC 999.

      $XFD DATE=YYYYMMDD
           03  LTI-LTOUCH-DATE        PIC 9(8)     COMP-3.

           03  LTI-INS-TYPE           PIC 99.
               88  LTI-INS-TYPE-CL    VALUE 01.
               88  LTI-INS-TYPE-AH    VALUE 02.
               88  LTI-INS-TYPE-PP    VALUE 03.
               88  LTI-INS-TYPE-O1    VALUE 04.

      $XFD DATE=YYYYMMDD
           03  LTI-ORIG-1STPYDATE     PIC 9(8)      COMP-3.
           03  LTI-PRIOR-NODEF        PIC 9(3).

           03  LTI-FEES               OCCURS 2 TIMES.
               05  LTI-INSFEECD       PIC XX.
               05  LTI-INSFEE         PIC S9(7)V99   COMP-3.

           03  LTI-TRCD               PIC X(2).

           03  LTI-INSCOMP            PIC 99.
           03  LTI-INSOURS            PIC X.
      $XFD DATE=YYYYMMDD
           03  LTI-INSEFF-DATE        PIC 9(8)      COMP-3.
      $XFD DATE=YYYYMMDD
           03  LTI-INSEXP-DATE        PIC 9(8)      COMP-3.
           03  LTI-INSPREM            PIC S9(7)V99  COMP-3.
           03  LTI-INSCOVR            PIC S9(7)V99  COMP-3.
           03  LTI-INSCOMM            PIC S9(7)V99  COMP-3.

           03  LTI-ANTICTERM          PIC 9(3).
      * 1 INSURANCE INTEREST (USED IN ACCRUAL PROGRAMS)
      * 2 NOT USED
      * 3 LTI-ANTICERN(3) HOLDS ORIGINAL ADDON FINCHG
           03  LTI-ANTICTBL          OCCURS 3 TIMES.
               05  LTI-ANTICERN       PIC S9(7)V99  COMP-3.
               05  LTI-ANTICADJ       PIC S9(7)V99  COMP-3.
               05  LTI-UFERN          PIC S9(7)V99  COMP-3.
               05  LTI-ACCERN         PIC S9(7)V99  COMP-3.

           03  LTI-INT-REBATE         PIC X.
           03  LTI-INS-PAYMNT-INCR    PIC S9(7)V99  COMP-3.
           03  LTI-INS-TOT-ADDON      PIC S9(7)V99  COMP-3.
           03  LTI-INT-LAST-EARNED    PIC S9(7)V99  COMP-3.
           03  LTI-INS-REBATE         PIC X.
               88  LTI-INS-REBATE-VALID     VALUE " " "Y" "R".
           03  LTI-RB-WORKER          PIC S9(7)V99  COMP-3.
      $XFD DATE=YYYYMMDD
           03  LTI-ANTIC-START-DATE   PIC 9(8)      COMP-3.
           03  LTI-CANCEL-REASON-CD   PIC X(3).

           03  FILLER                 PIC X(203).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LTI.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LTI_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LTI_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN TRAILER FILE - INSURANCE
      *
      *=================================================================
      * REV:
      * BLM 2021-0504 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  LTI1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  LTI1-CURSOR-STAT-GOOD             VALUE "00".
           88  LTI1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LTI1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLTI1-WHERE-BEG-KEY.
           03  QLTI1-WBEG-BRNO             PIC 9(04).
           03  QLTI1-WBEG-ACCTNO           PIC 9(08).
           03  QLTI1-WBEG-SEQNO            PIC 9(03).

       01  QLTI1-WHERE-END-KEY.
           03  QLTI1-WEND-BRNO             PIC 9(04).
           03  QLTI1-WEND-ACCTNO           PIC 9(08).
           03  QLTI1-WEND-SEQNO            PIC 9(03).

       01  QLTI-REC.
           03  QLTI-BRNO           PIC 9(4).
           03  QLTI-ACCTNO         PIC 9(8).
           03  QLTI-SEQNO          PIC 999.
           03  QLTI-LTOUCH-DATE    PIC X(10).
           03  QLTI-INS-TYPE           PIC 99.
           03  QLTI-ORIG-1STPYDATE     PIC X(10).
           03  QLTI-PRIOR-NODEF        PIC 9(3).
           03  QLTI-INSFEECD-1         PIC XX.
           03  QLTI-INSFEE-1           PIC S9(7)V99.
           03  QLTI-INSFEECD-2         PIC XX.
           03  QLTI-INSFEE-2           PIC S9(7)V99.
           03  QLTI-TRCD               PIC X(2).
           03  QLTI-INSCOMP            PIC 99.
           03  QLTI-INSOURS            PIC X.
           03  QLTI-INSEFF-DATE        PIC X(10).
           03  QLTI-INSEXP-DATE        PIC X(10).
           03  QLTI-INSPREM            PIC S9(7)V99.
           03  QLTI-INSCOVR            PIC S9(7)V99.
           03  QLTI-INSCOMM            PIC S9(7)V99.
           03  QLTI-ANTICTERM          PIC 9(3).
           03  QLTI-ANTICERN-1       PIC S9(7)V99.
           03  QLTI-ANTICADJ-1       PIC S9(7)V99.
           03  QLTI-UFERN-1          PIC S9(7)V99.
           03  QLTI-ACCERN-1         PIC S9(7)V99.
           03  QLTI-ANTICERN-2       PIC S9(7)V99.
           03  QLTI-ANTICADJ-2       PIC S9(7)V99.
           03  QLTI-UFERN-2          PIC S9(7)V99.
           03  QLTI-ACCERN-2         PIC S9(7)V99.
           03  QLTI-ANTICERN-3       PIC S9(7)V99.
           03  QLTI-ANTICADJ-3       PIC S9(7)V99.
           03  QLTI-UFERN-3          PIC S9(7)V99.
           03  QLTI-ACCERN-3         PIC S9(7)V99.
           03  QLTI-INT-REBATE         PIC X.
           03  QLTI-INS-PAYMNT-INCR    PIC S9(7)V99.
           03  QLTI-INS-TOT-ADDON      PIC S9(7)V99.
           03  QLTI-INT-LAST-EARNED    PIC S9(7)V99.
           03  QLTI-INS-REBATE         PIC X.
           03  QLTI-RB-WORKER          PIC S9(7)V99.
           03  QLTI-ANTIC-START-DATE   PIC X(10).
           03  QLTI-CANCEL-REASON-CD   PIC X(3).

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LTI_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLTI.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLTI
      *********************************************************
      *        LIBLP/LPWSLTI: INSURANCE ADDON PATH WORKERS
      *        /USR/DATA/XX/XX####/LP/LTIFILE
      *********************************************************
       01  LTI-PATH-OVERRIDE   PIC X(01)  VALUE SPACES.
       01  LTI-PATH            PIC X(35)  VALUE SPACES.
       01  FILLER                    REDEFINES LTI-PATH.
           03  LTI-PATH-BEG           PIC X(13).
           03  LTI-PATH-OWNST         PIC X(02).
           03  LTI-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  LTI-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LTI-PATH-FILE.
               05  FILLER            PIC X(03).
               05  LTI-PATH-SQL       PIC X(12).


       01  LTI-ALL-PATH.
           03  LTI-ALL-BASE           PIC X(09).
           03  FILLER REDEFINES LTI-ALL-BASE.
               05  LTI-ALL-BASE-USR   PIC X(05).
               05  LTI-ALL-BASE-DIR   PIC X(04).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LTI-ALL-MACHINE        PIC X(02).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LTI-ALL-DATA           PIC X(06).
           03  FILLER                 PIC X(11)  VALUE "/LP/LTIFILE".

       01  LTISUB                    PIC 9(3).
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLTI.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LTP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LT
      ******************************************************************
      *    LOAN PAYMENT SCHEDULE TRAILER FILE 
      *
      *  LTP1-KEY - BRNO, ACCTNO, SEQNO
      *
      *  BAH 06/19/2015 CREATED NEW FROM LP01LT
      *   CS 160614 CS CHANGED LTP-PAY-SCHLD-TBL FROM OCCURS 17 TIMES
      *                TO OCCURS 41 TO HANDLE 40 YEARS OF ESCROW, NEED THE
      *                41 TO COVER THE 1ST YEAR WHICH COULD OCCUPY 2 LEVELS
      *                IF THERE IS AN ODD PAY, RECORD SIZE FROM 250 TO 450
      *   CS 190507 REMOVED FILLER AT END OF REC
      *  BAH 20230600 ADDED FILLER
      **************************************************************************
       78  LTP-SIZE                      VALUE 450.
       01  LTP-REC.
           03  LTP1-KEY.
               05  LTP-BRNO              PIC 9(4).
               05  LTP-ACCTNO            PIC 9(8).
               05  LTP-SEQNO             PIC 999.

      $XFD DATE=YYYYMMDD
           03  LTP-LTOUCH-DATE           PIC 9(8)     COMP-3.

      * 8 X 17 = 136
           03  LTP-PAY-SCHLD-AREA.
               05  LTP-PAY-SCHLD-TBL      OCCURS 41 TIMES.
                   07  LTP-SCHLD-TERM     PIC 9(4)    COMP-3.
                   07  LTP-SCHLD-PAYMNT   PIC 9(6)V99 COMP-3.

           03  FILLER                 PIC X(102).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LTP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01LTP_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01LTP_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - LOAN TRAILER FILE - PAYMENT SCHEDULE
      *
      *=================================================================
      * REV:
      * BLM 2021-0504 ***NEW***
      *
      ******************************************************************
      *- - -{STANDARD CURSOR FOR START & READ-NEXT}
       01  LTP1-CURSOR-STAT             PIC X(2) VALUE SPACES.
           88  LTP1-CURSOR-STAT-GOOD             VALUE "00".
           88  LTP1-CURSOR-STAT-BAD              VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  LTP1-RETURN-CODE                PIC S9(4)   COMP-5.

       01  QLTP1-WHERE-BEG-KEY.
           03  QLTP1-WBEG-BRANCH           PIC 9(04).
           03  QLTP1-WBEG-ACCTNO           PIC 9(08).
           03  QLTP1-WBEG-SEQNO            PIC 9(03).
 
       01  QLTP1-WHERE-END-KEY.
           03  QLTP1-WEND-BRANCH             PIC 9(04).
           03  QLTP1-WEND-ACCTNO           PIC 9(08).
           03  QLTP1-WEND-SEQNO            PIC 9(03).
 
       01  QLTP-REC.
           03  QLTP-BRNO              PIC 9(4).
           03  QLTP-ACCTNO            PIC 9(8).
           03  QLTP-SEQNO             PIC 999.
           03  QLTP-LTOUCH-DATE       PIC X(10).
           03  QLTP-SCHLD-TERM-1     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-1   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-2     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-2   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-3     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-3   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-4     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-4   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-5     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-5   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-6     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-6   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-7     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-7   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-8     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-8   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-9     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-9   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-10    PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-10  PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-11     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-11   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-12     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-12   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-13     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-13   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-14     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-14   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-15     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-15   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-16     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-16   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-17     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-17   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-18     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-18   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-19     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-19   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-20     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-20   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-21     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-21   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-22     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-22   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-23     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-23   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-24     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-24   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-25     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-25   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-26     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-26   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-27     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-27   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-28     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-28   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-29     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-29   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-30     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-30   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-31     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-31   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-32     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-32   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-33     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-33   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-34     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-34   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-35     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-35   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-36     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-36   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-37     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-37   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-38     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-38   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-39     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-39   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-40     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-40   PIC 9(6)V99.
           03  QLTP-SCHLD-TERM-41     PIC 9(4).
           03  QLTP-SCHLD-PAYMNT-41   PIC 9(6)V99.
       
       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBLP\LP01LTP_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWSLTP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWSLTP
      *********************************************************
      *        LIBLP/LPWSLTP: PAYMENT SCHEDULE PATH WORKERS
      *        /USR/DATA/XX/XX####/LP/LTPFILE
      *********************************************************
       01  LTP-PATH-OVERRIDE   PIC X(01)  VALUE SPACES.
       01  LTP-PATH            PIC X(35)  VALUE SPACES.
       01  FILLER                    REDEFINES LTP-PATH.
           03  LTP-PATH-BEG           PIC X(13).
           03  LTP-PATH-OWNST         PIC X(02).
           03  LTP-PATH-OWNBR         PIC 9(04).
           03  FILLER                PIC X(01).
           03  LTP-PATH-FILE          PIC X(15).
           03  FILLER                REDEFINES LTP-PATH-FILE.
               05  FILLER            PIC X(03).
               05  LTP-PATH-SQL       PIC X(12).

       01  LTP-ALL-PATH.
           03  LTP-ALL-BASE           PIC X(09).
           03  FILLER REDEFINES LTP-ALL-BASE.
               05  LTP-ALL-BASE-USR   PIC X(05).
               05  LTP-ALL-BASE-DIR   PIC X(04).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LTP-ALL-MACHINE        PIC X(02).
           03  FILLER                 PIC X(01)  VALUE "/".
           03  LTP-ALL-DATA           PIC X(06).
           03  FILLER                 PIC X(11)  VALUE "/LP/LTPFILE".

       01  LTPSUB                    PIC 9(3).
      *================================================================*
      * END COPYBOOK: LIBLP\LPWSLTP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGL\GL01GI.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGL/GL01GI
      ******************************************************************
      *              (GL)  GI INTERFACE RECORD
      *
      *    GI1-KEY =  GI-BRANCH, GI-CLASS
      *
      *  NOTE:
      *       IF THIS RECORD CHANGES,
      *       CHANGE UNSUB AND ERSUB IN LPEOD5.C!!!!!!!!
      *       ALSO, FIX WORK RECORD IN SP/GICOPY.C!!!
      * REV:
      *  JTG 051995 ADDED GI-REPO-AR, GI-REPO-INT
      *  JTG 111095 ADDED GI-ACR-INT-AR, IB ACCRUED INT INCOME
      *  BAH 011696 ADDED GI-LN-APPROVAL-LIMIT, E022
      *  JTG 111296 ADDED GI-CONV-OFFSET (ACCOUNT CONVERSIONS)
      *  JTG 111197 DEFINED 78'S FOR GI-SIZE 750 AND GI-ACCT-IX-MAX 103
      *  JTG 043098 ADDED GI-PARTIAL-PLEXP (PARTIAL CHARGEOFF), MERCURY #E175
      *             AND SET GI-ACCT-IX-MAX TO 104
      *  BAH 062998 RENAMED GI-EREXTCHG TO GI-ERADDON AND CHANGED
      *                     GI-UNEXTCHG TO GI-UNADDON
      *  JTG 111998 ADDED REVOLVING OTHBAL PAYMENT GL TABLE
      *  MJD 990126 ----- UPDATED IN FLEXGEN -----
      *  KEC 990315 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 990510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 990805 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 990811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  KEC 000410 >>>>>>>> 'A10-TO-A15' CONVERSION UPDATED <<<<<<<<
      *  MJD 000929 ADDED GI-PAYLBOX (MFC PR#237)
      *  MJD 001113 ADDED GI-PENALTY-INT (NEWS PR#1264)
      *  JTG 010605 ADDED GP-TRUE-NEXT-BATCH           (MERC PR#243/251)
      *             GI-PAYTPAY
      *             GI-PAYTCOLL
      *             GI-PAYWESTU
      *  JTG 010614 ADDED NEW TRCD "OP" FOR AUTOMATIC OT/AP COMBINATION
      *             ADDED NEW TRCD "RE" FOR REPO EXENSE ADDON,   REGACC PR#1478
      *             GI-REPO-ADDON-EXP
      *  JTG 010814 CHANGED GI-PAYWESTU TO GI-PAYMGRAM           MERCURY PR#258
      *  GLB 020507 ADDED GI-ACH-BANK; REGACC PR#1797
      *  JTG 040517 ADDED GL CONTROL FIELDS FOR:
      *                 - UNEARNED INTEREST REPO
      *                 - UNEARNED ADDON INTEREST REPO
      *             THE UNEARNED WILL MOVE TO THESE ACCOUNTS POSTING A 'SX'
      *             AND REVERSING A 'SV'
      *             THE UNEARNED WILL MOVE (BACK) FROM THESE ACCOUNTS POSTING
      *             A 'SV' AND REVERSING A 'SX'    
      *                                                            REGACC #0049
      * 160122 CS  ADD 250 FILLER
      * 160129 CS  ADDED GI-UNO4, GI-UNO5, MOVED GI-UNITREPO TO END OF GI-UNOT
      *            TABLE. ADD GI-UN1,GI-UN2,GI-UN3,GI-UN4 TO UNEARNED CHARGES
      *            ADDED GI-UNO6, GI-UNO7(UNEARN INSURANCE) AND MOVED GI-UNINT
      *            REPO, GI-UNADDONINTREPO.  ADDED GI-EARN1,GI-EARN2,GI-EARN3
      *            GI-EARN4(NEW EARNINGS COMPONENTS) 
      * 160119 CS  INCREASED GI-CLASS TO 9(3).
      * 160204 CS  FOR THE MOMENT LEFT THE GI-ACCOUNT TABLE INTACT FOR THE 
      *            CLEAR
      * 190321 BAH RENAMED GI-ACCT TO GI-BR-ACCOUNT
      * 190514  CS ADD FUTURE FIELDS, FIXED WK-REC IN SP/GICOY
      * 20190701 BAH REMOVED GI-OTHBAL-* REVOLVING FIELDS
      * BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * BAH 20210427 REMOVED FUTURE FIELDS
      * JKC 20210427 GI-BR-ACCOUNT TO USE 'OCCURS 121' INSTEAD OF
      *              'OCCURS GI-ACCT-IX-MAX'; WAS THE ONLY 01 COPY
      *              MEMBER USING A 78 IN AN OCCURS; THIS CHANGE
      *              MAKES IT MORE CONSISTENT WITH OTHER LAYOUTS.
      *  20230600 BAH ADDED FILLER
      ******************************************************************
       78  GI-SIZE                VALUE  990.
       01  GI-REC.
           03  GI1-KEY.
               05  GI-BRANCH      PIC 9(4).
               05  GI-CLASS       PIC 999.
      $XFD DATE=YYYYMMDD
           03  GI-LTOUCH-DATE     PIC 9(8) COMP-3.

           03  GI-ACCOUNTS.       
      *----BANK AND CASH---------------------------
               05  GI-CASH        PIC 9(11) COMP-3.
               05  GI-BANK        PIC 9(11) COMP-3.
               05  GI-NSF         PIC 9(11) COMP-3.
      *----RECEIVABLES----------------------------- 4
               05  GI-AR          PIC 9(11) COMP-3.
               05  GI-PL          OCCURS 5
                                  PIC 9(11) COMP-3.
               05  GI-DLINSREB    PIC 9(11) COMP-3.
               05  GI-ACR-INT-AR-AR  PIC 9(11) COMP-3.
      *----INTER BRANCH---------------------------- 12
               05  GI-OTHBR-REC   PIC 9(11) COMP-3.
               05  GI-OTHBR-PAY   PIC 9(11) COMP-3.
      *----UNEARNED CHARGES------------------------- 14
               05  GI-UNEARN-CHG-TBL. 
                   07  GI-UNINTCHG           PIC 9(11) COMP-3.
                   07  GI-UNADDON            PIC 9(11) COMP-3.
                   07  GI-UNSERCHG           PIC 9(11) COMP-3.
                   07  GI-UNMAINTFEE         PIC 9(11) COMP-3.
                   07  GI-UNDLDISC           PIC 9(11) COMP-3.
                   07  GI-UNOTHER            PIC 9(11) COMP-3.
                   07  GI-UN7                PIC 9(11) COMP-3.
                   07  GI-UN8                PIC 9(11) COMP-3.
                   07  GI-UN9                PIC 9(11) COMP-3.
                   07  GI-UN10               PIC 9(11) COMP-3.

               05  GI-UNEARN-CHG-TBLX  REDEFINES GI-UNEARN-CHG-TBL.
                   07  GI-UNEARN         OCCURS 10
                                         PIC 9(11) COMP-3.

               05  GI-UNCL1              PIC 9(11) COMP-3.
               05  GI-UNCL2              PIC 9(11) COMP-3.
               05  GI-UNAH               PIC 9(11) COMP-3.
               05  GI-UNPP               PIC 9(11) COMP-3.
               05  GI-UNOT-TBL.
                   07  GI-UNO1           PIC 9(11) COMP-3.
                   07  GI-UNO2           PIC 9(11) COMP-3.
                   07  GI-UNO3           PIC 9(11) COMP-3.
                   07  GI-UNO4           PIC 9(11) COMP-3.
                   07  GI-UNO5           PIC 9(11) COMP-3.
                   07  GI-UNO6           PIC 9(11) COMP-3.
                   07  GI-UNO7           PIC 9(11) COMP-3.
               05  GI-UNOT-TBLX   REDEFINES GI-UNOT-TBL.
                   07  GI-UNOT           OCCURS 7
                                         PIC 9(11) COMP-3.
 
               05  GI-UNINTREPO      PIC 9(11) COMP-3.
               05  GI-UNADDONINTREPO PIC 9(11) COMP-3.


      *----EXPENSES-------------------------------- 37
               05  GI-PLEXP       OCCURS 5
                                  PIC 9(11) COMP-3.
               05  GI-DLPARVEX    PIC 9(11) COMP-3.
      *----OFFSETS--------(SEE BELOW)-------------- 43
               05  GI-PLOFFSET    OCCURS 5
                                  PIC 9(11) COMP-3.
               05  GI-SERVOFF     PIC 9(11) COMP-3.
      *----PAYABLES-------------------------------- 49
               05  GI-PAYCL1      PIC 9(11) COMP-3.
               05  GI-PAYCL2      PIC 9(11) COMP-3.
               05  GI-PAYAH       PIC 9(11) COMP-3.
               05  GI-PAYPP       PIC 9(11) COMP-3.
               05  GI-PAYOT-TBL.
                   07  GI-PAYO1   PIC 9(11) COMP-3.
                   07  GI-PAYO2   PIC 9(11) COMP-3.
                   07  GI-PAYO3   PIC 9(11) COMP-3.
                   07  GI-PAYO4   PIC 9(11) COMP-3.
                   07  GI-PAYO5   PIC 9(11) COMP-3.
                   07  GI-PAYO6   PIC 9(11) COMP-3.
                   07  GI-PAYO7   PIC 9(11) COMP-3.
               05  GI-PAYOT-TBLX  REDEFINES GI-PAYOT-TBL.
                   07  GI-PAYOT   OCCURS 7
                                  PIC 9(11) COMP-3.
               05  GI-DLPAYABLE        PIC 9(11) COMP-3.
      *----RESERVES---------------------------------------- 61
               05  GI-DLRVPRINX.
                   07  GI-DLRVPRIN-1  PIC 9(11) COMP-3.
                   07  GI-DLRVPRIN-2  PIC 9(11) COMP-3.
                   07  GI-DLRVPRIN-3  PIC 9(11) COMP-3.
               05  GI-DLRVPRINX-TBL  REDEFINES GI-DLRVPRINX.
                   07  GI-DLRVPRIN    OCCURS 3
                                      PIC 9(11) COMP-3.
               05  GI-DLRVCHGSX.
                   07  GI-DLRVCHGS-1  PIC 9(11) COMP-3.
                   07  GI-DLRVCHGS-2  PIC 9(11) COMP-3.
                   07  GI-DLRVCHGS-3  PIC 9(11) COMP-3.
               05  GI-DLRVCHGSX-TBL  REDEFINES GI-DLRVCHGSX.
                   07  GI-DLRVCHGS    OCCURS 3
                                      PIC 9(11) COMP-3.
      *---------------------------------------------------- 67
               05  GI-DLPARV          PIC 9(11) COMP-3.
               05  GI-PAYALLOT        PIC 9(11) COMP-3.
               05  GI-DIRECT-PAY      PIC 9(11) COMP-3.
      *------------INCOME---------------------------------- 70
               05  GI-EARN-CHG-TBL. 
                   07  GI-ERINTCHG    PIC 9(11) COMP-3.
                   07  GI-ERADDON     PIC 9(11) COMP-3.
                   07  GI-ERSERCHG    PIC 9(11) COMP-3.
                   07  GI-ERMAINTFEE  PIC 9(11) COMP-3.
                   07  GI-ERDLDISC    PIC 9(11) COMP-3.
                   07  GI-EROTHER     PIC 9(11) COMP-3.
                   07  GI-EARN7       PIC 9(11) COMP-3.
                   07  GI-EARN8       PIC 9(11) COMP-3.
                   07  GI-EARN9       PIC 9(11) COMP-3.
                   07  GI-EARN10      PIC 9(11) COMP-3.
               05  GI-EARN-CHG-TBLX REDEFINES GI-EARN-CHG-TBL.
                   07  GI-EARN    OCCURS 10 PIC 9(11) COMP-3.

               05  GI-LATECHG     PIC 9(11) COMP-3.
               05  GI-INTEREST    PIC 9(11) COMP-3.
               05  GI-DEFERMENTS  PIC 9(11) COMP-3.
               05  GI-SAPRINCIPAL PIC 9(11) COMP-3.
      *---------------------------------------------------- 84
               05  GI-PLINT       OCCURS 5
                                  PIC 9(11) COMP-3.
               05  GI-PLREC       OCCURS 5
                                  PIC 9(11) COMP-3.
      *---------------------------------------------------- 94
               05  GI-CL1             PIC 9(11) COMP-3.
               05  GI-CL2             PIC 9(11) COMP-3.
               05  GI-AH              PIC 9(11) COMP-3.
               05  GI-PP              PIC 9(11) COMP-3.
               05  GI-O1              PIC 9(11) COMP-3.
               05  GI-O2              PIC 9(11) COMP-3.
               05  GI-O3              PIC 9(11) COMP-3.
               05  GI-O4              PIC 9(11) COMP-3.
               05  GI-O5              PIC 9(11) COMP-3.
               05  GI-O6              PIC 9(11) COMP-3.
               05  GI-O7              PIC 9(11) COMP-3.
      *---------------------------        ----------------- 105 
      * NOTE:
      *       GI-PLNEW-AR WAS INTENDED FOR ADDITIONAL NEED
      *       FOR EACH LEVEL (PL/P2/P3/P4/P5).
      *       THE FIRST LEVEL IS NOT NEEDED/USED.
      *       THE SECOND & THIRD LEVELS ARE USED AS INTENDED.
      *       THE FOURTH & FIFTH LEVELS ARE NOT AS INTENDED;
      *       THEY WERE USED BY JOHN GENTILE IN 2002-0916 FOR
      *       REGACC PR#1846 WHICH ARE TRIGGERED BY USING
      *       GP-DLCOMM-CMSI-FG = "Y".
      *
      *       GI-PLNEW-AR(1) IS NOT USED; ON P2
      *       GI-PLNEW-AR(2) IS TRCD "SE" ON P2
      *       GI-PLNEW-AR(3) IS TRCD "SE" ON P3
      *       GI-PLNEW-AR(4) IS DLCOMM-PP-CMSI  GAP
      *       GI-PLNEW-AR(5) IS DLCOMM-O3-CMSI  WARRANTY
      *
               05  GI-PLNEW-AR    OCCURS 5
                                  PIC 9(11) COMP-3.
      *-------------------------------------------- 110
               05  GI-REPO-AR     PIC 9(11) COMP-3.
               05  GI-REPO-INT    PIC 9(11) COMP-3.
               05  GI-ACR-INT-AR  PIC 9(11) COMP-3.
      *----OFFSETS--------(SEE ABOVE)-------------- 113
               05  GI-CONV-OFFSET PIC 9(11) COMP-3.
      *----PL EXPENSE-----(SEE ABOVE)-------------- 114
               05  GI-PARTIAL-PLEXP PIC 9(11) COMP-3.

      *-------------------------------------------- 115
               05  GI-PAYLBOX             PIC 9(11)   COMP-3.
               05  GI-PENALTY-INT         PIC 9(11)   COMP-3.
               05  GI-PAYTPAY             PIC 9(11)   COMP-3.
               05  GI-PAYTCOLL            PIC 9(11)   COMP-3.
               05  GI-PAYMGRAM            PIC 9(11)   COMP-3.
               05  GI-REPO-ADDON-EXP      PIC 9(11)   COMP-3.   
               05  GI-ACH-BANK            PIC 9(11)   COMP-3.
      *--------------------------------------------------
       78  GI-ACCT-IX-MAX         VALUE 121.
           03  GI-ACCTS REDEFINES GI-ACCOUNTS.
               05  GI-BR-ACCOUNT          OCCURS 121
                                          PIC 9(11)   COMP-3.
            
           03  GI-LN-APPROVAL-LIMIT       PIC 9(7)    COMP-3.

           03  FILLER                     PIC X(248).
      *================================================================*
      * END COPYBOOK: LIBGL\GL01GI.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGL\GL01GI_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGL/GL01GI_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - G/L GENERAL INTERFACE FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0430 ***NEW***
      * JKC 2023-1201 ADDED GI1-ROW-COUNT
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  GI1-CURSOR-STAT              PIC X(2) VALUE SPACES.
           88  GI1-CURSOR-STAT-GOOD              VALUE "00".
           88  GI1-CURSOR-STAT-BAD               VALUE "  " THRU "//"
                                                       "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  GI1-RETURN-CODE                PIC S9(4)   COMP-5.
       01  GI1-ROW-COUNT                  PIC 9(5).

       01  QGI1-WHERE-BEG-KEY.
           03  QGI1-WBEG-BRANCH           PIC 9(04).
           03  QGI1-WBEG-CLASS            PIC 9(03).
 
       01  QGI1-WHERE-END-KEY.
           03  QGI1-WEND-BRANCH           PIC 9(04).
           03  QGI1-WEND-CLASS            PIC 9(03).
 
       01  QGI-REC.
           03  QGI-BRANCH          PIC 9(4).
           03  QGI-CLASS           PIC 999.
           03  QGI-LTOUCH-DATE     PIC X(10).
           03  QGI-CASH            PIC 9(11).
           03  QGI-BANK            PIC 9(11).
           03  QGI-NSF             PIC 9(11).
           03  QGI-AR              PIC 9(11).
           03  QGI-PL-1            PIC 9(11).
           03  QGI-PL-2            PIC 9(11).
           03  QGI-PL-3            PIC 9(11).
           03  QGI-PL-4            PIC 9(11).
           03  QGI-PL-5            PIC 9(11).
           03  QGI-DLINSREB        PIC 9(11).
           03  QGI-ACR-INT-AR-AR   PIC 9(11).
           03  QGI-OTHBR-REC       PIC 9(11).
           03  QGI-OTHBR-PAY       PIC 9(11).
           03  QGI-UNINTCHG        PIC 9(11).
           03  QGI-UNADDON         PIC 9(11).
           03  QGI-UNSERCHG        PIC 9(11).
           03  QGI-UNMAINTFEE      PIC 9(11).
           03  QGI-UNDLDISC        PIC 9(11).
           03  QGI-UNOTHER         PIC 9(11).
           03  QGI-UN7             PIC 9(11).
           03  QGI-UN8             PIC 9(11).
           03  QGI-UN9             PIC 9(11).
           03  QGI-UN10            PIC 9(11).
           03  QGI-UNCL1           PIC 9(11).
           03  QGI-UNCL2           PIC 9(11).
           03  QGI-UNAH            PIC 9(11).
           03  QGI-UNPP            PIC 9(11).
           03  QGI-UNO1            PIC 9(11).
           03  QGI-UNO2            PIC 9(11).
           03  QGI-UNO3            PIC 9(11).
           03  QGI-UNO4            PIC 9(11).
           03  QGI-UNO5            PIC 9(11).
           03  QGI-UNO6            PIC 9(11).
           03  QGI-UNO7            PIC 9(11).
           03  QGI-UNINTREPO       PIC 9(11).
           03  QGI-UNADDONINTREPO  PIC 9(11).
           03  QGI-PLEXP-1         PIC 9(11).
           03  QGI-PLEXP-2         PIC 9(11).
           03  QGI-PLEXP-3         PIC 9(11).
           03  QGI-PLEXP-4         PIC 9(11).
           03  QGI-PLEXP-5         PIC 9(11).
           03  QGI-DLPARVEX        PIC 9(11).
           03  QGI-PLOFFSET-1      PIC 9(11).
           03  QGI-PLOFFSET-2      PIC 9(11).
           03  QGI-PLOFFSET-3      PIC 9(11).
           03  QGI-PLOFFSET-4      PIC 9(11).
           03  QGI-PLOFFSET-5      PIC 9(11).
           03  QGI-SERVOFF         PIC 9(11).
           03  QGI-PAYCL1          PIC 9(11).
           03  QGI-PAYCL2          PIC 9(11).
           03  QGI-PAYAH           PIC 9(11).
           03  QGI-PAYPP           PIC 9(11).
           03  QGI-PAYO1           PIC 9(11).
           03  QGI-PAYO2           PIC 9(11).
           03  QGI-PAYO3           PIC 9(11).
           03  QGI-PAYO4           PIC 9(11).
           03  QGI-PAYO5           PIC 9(11).
           03  QGI-PAYO6           PIC 9(11).
           03  QGI-PAYO7           PIC 9(11).
           03  QGI-DLPAYABLE       PIC 9(11).
           03  QGI-DLRVPRIN-1      PIC 9(11).
           03  QGI-DLRVPRIN-2      PIC 9(11).
           03  QGI-DLRVPRIN-3      PIC 9(11).
           03  QGI-DLRVCHGS-1      PIC 9(11).
           03  QGI-DLRVCHGS-2      PIC 9(11).
           03  QGI-DLRVCHGS-3      PIC 9(11).
           03  QGI-DLPARV          PIC 9(11).
           03  QGI-PAYALLOT        PIC 9(11).
           03  QGI-DIRECT-PAY      PIC 9(11).
           03  QGI-ERINTCHG        PIC 9(11).
           03  QGI-ERADDON         PIC 9(11).
           03  QGI-ERSERCHG        PIC 9(11).
           03  QGI-ERMAINTFEE      PIC 9(11).
           03  QGI-ERDLDISC        PIC 9(11).
           03  QGI-EROTHER         PIC 9(11).
           03  QGI-EARN7           PIC 9(11).
           03  QGI-EARN8           PIC 9(11).
           03  QGI-EARN9           PIC 9(11).
           03  QGI-EARN10          PIC 9(11).
           03  QGI-LATECHG         PIC 9(11).
           03  QGI-INTEREST        PIC 9(11).
           03  QGI-DEFERMENTS      PIC 9(11).
           03  QGI-SAPRINCIPAL     PIC 9(11).
           03  QGI-PLINT-1         PIC 9(11).
           03  QGI-PLINT-2         PIC 9(11).
           03  QGI-PLINT-3         PIC 9(11).
           03  QGI-PLINT-4         PIC 9(11).
           03  QGI-PLINT-5         PIC 9(11).
           03  QGI-PLREC-1         PIC 9(11).
           03  QGI-PLREC-2         PIC 9(11).
           03  QGI-PLREC-3         PIC 9(11).
           03  QGI-PLREC-4         PIC 9(11).
           03  QGI-PLREC-5         PIC 9(11).
           03  QGI-CL1             PIC 9(11).
           03  QGI-CL2             PIC 9(11).
           03  QGI-AH              PIC 9(11).
           03  QGI-PP              PIC 9(11).
           03  QGI-O1              PIC 9(11).
           03  QGI-O2              PIC 9(11).
           03  QGI-O3              PIC 9(11).
           03  QGI-O4              PIC 9(11).
           03  QGI-O5              PIC 9(11).
           03  QGI-O6              PIC 9(11).
           03  QGI-O7              PIC 9(11).
           03  QGI-PLNEW-AR-1      PIC 9(11).
           03  QGI-PLNEW-AR-2      PIC 9(11).
           03  QGI-PLNEW-AR-3      PIC 9(11).
           03  QGI-PLNEW-AR-4      PIC 9(11).
           03  QGI-PLNEW-AR-5      PIC 9(11).
           03  QGI-REPO-AR         PIC 9(11).
           03  QGI-REPO-INT        PIC 9(11).
           03  QGI-ACR-INT-AR      PIC 9(11).
           03  QGI-CONV-OFFSET     PIC 9(11).
           03  QGI-PARTIAL-PLEXP   PIC 9(11).
           03  QGI-PAYLBOX             PIC 9(11).
           03  QGI-PENALTY-INT         PIC 9(11).
           03  QGI-PAYTPAY             PIC 9(11).
           03  QGI-PAYTCOLL            PIC 9(11).
           03  QGI-PAYMGRAM            PIC 9(11).
           03  QGI-REPO-ADDON-EXP      PIC 9(11).
           03  QGI-ACH-BANK            PIC 9(11).
           03  QGI-LN-APPROVAL-LIMIT   PIC 9(7).


       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBGL\GL01GI_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGL\GLWSGI.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGL/GLWSGI
      *********************************************************
      *        LIBGL/GLWSGI: GIFILE PATH WORKERS
      *        /USR/DATA/XX/GL/GIFILE
      *********************************************************
       01  GI-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  GI-PATH                   PIC X(35)   VALUE SPACES.
       01  FILLER                    REDEFINES GI-PATH.
           03  GI-PATH-BEG           PIC X(13).
           03  GI-PATH-FILE          PIC X(22).
           03  FILLER                REDEFINES GI-PATH-FILE.
               05  FILLER            PIC X(03).
               05  GI-PATH-SQL       PIC X(19).


       01  GI-ALL-PATH.
           03  GI-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES GI-ALL-BASE.
               05  GI-ALL-BASE-USR   PIC X(05).
               05  GI-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  GI-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/GL/GIFILE".
      *================================================================*
      * END COPYBOOK: LIBGL\GLWSGI.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01RC.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01RC
      ******************************************************************
      *
      *            ( GLOBAL RECAP (DAILY) FILE )          
      *
      *  RC1-KEY - RC-BRNO, RC-TRANS-DATE
      *  RC2-KEY - RC-STATUS, RC-BRNO, RC-TRANS-DATE
      *
      * NOTE:
      *   RC-TRANS-DATE - IS THE TRANSACTION DATE POSTED FOR (CCYYMMDD)
      *
      *=================================================================
      * REV:
      *  BLL 062195 ADDED RC-STATUS OF M1 (CHECKS EXTRACTED)
      *  BLL 090595 ADDED RC-STATUS OF G1 (EOM EARNINGS DONE),
      *             RC-EARNINGS-DATE, EARNINGS-TIME, LAST-ACCRUE
      *  JTG 112197 EXPANDED RECORD BY 25 BYTES 135 --> 160
      * KEC 1999.0510 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * KEC 1999.0811 >>>>>>>> 'A60-TO-A15' CONVERSION UPDATED <<<<<<<<
      * BLL 050920 ADDED RC-BANK-BAL, CLOSING BRANCH BANK BALANCE AS OF
      *            END OF DAY, WORLD PR# 433
      * BLF 051215 ADDED REDEF OF RC-TRANS-DATE TO GET MM, DD, YYY
      * KEC 2015.1119 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED RC-SIZE; RC-REC SIZE = 250
      *         ADDED RC-LTOUCH-DATE;
      *         CHANGED DATE FORMAT NOW CCYYMMDD;
      *         CHANGED RC-TRANS-DATE FORMAT FROM YYYMMDD TO CCYYMMDD.
      * BLM 160915 ADDED RC-CHECK-DEPOSIT FOR SCANNED CHECKS,
      *            WORLD PR# 1188
      * BAH 190218 REMOVED REDEFINE OF RC-TRANS-DATE.
      * BAH 190305 REMOVED FILLER IN MIDDLE OF REC
      *  CS 190410 ADD FUTURE FIELDS, RC-FUTURE-DATES, RC-FUTURE-ALPHAS 
      *            RC-FUTURE-AMOUNTS, RC-FUTURE-FLAGS, RC-FUTURE-NUMERICS
      * BAH 20200323 CLEANED UP FUTURE FIELDS, REMOVED GROUP LEVELS
      * BAH 20210427 REMOVED FUTURE FIELDS
      *  20230600 BAH ADDED FILLER
      ******************************************************************
       78  RC-SIZE                                VALUE 300.
       01  RC-REC.
           03  RC2-KEY.
               05  RC-STATUS                  PIC XX.
                   88 RC-STATUS-VALID             VALUE
                      "A1" "B1" "C1" "D1" "G1"
                      "H1" "I1" "J1" "K1" "K2"
                      "M1".
                   88 RC-OPEN                     VALUE "A1".
                   88 RC-INPROCESS                VALUE "B1".
                   88 RC-UPDATED                  VALUE "C1".
                   88 RC-EOD-BATCH-DONE           VALUE "D1".
                   88 RC-EOM-EARNINGS-DONE        VALUE "G1".
                   88 RC-EOM1-BATCH-DONE          VALUE "H1".
                   88 RC-EOM-UPDATE-DONE          VALUE "I1".
                   88 RC-EOM2-BATCH-DONE          VALUE "J1".
                   88 RC-BANK-DEPOSIT             VALUE "K1".
                   88 RC-DEPOSIT-TRANSMITTED      VALUE "K2".
                   88 RC-CHECKS-EXTRACTED         VALUE "M1".
               05  RC1-KEY.
                   07  RC-BRNO                PIC 9(4).
      $XFD DATE=YYYYMMDD
                   07  RC-TRANS-DATE          PIC 9(8).

      $XFD DATE=YYYYMMDD
           03  RC-LTOUCH-DATE              PIC 9(08)      COMP-3.

           03  RC-FLAGS.
               05  RC-RECAP-FG             PIC X.
                   88 RC-RECAP-SUCESSFUL       VALUE "Y".

               05  RC-GL-FG                PIC X.
                   88 RC-GL-IN-BALANCE         VALUE "Y".

               05  RC-EOD-BATCH-FG         PIC X.
                   88 RC-EOD-BATCH-SUCESSFUL   VALUE "Y".

               05  RC-NIGHTLY-FUNDS-FG     PIC X.
                   88 RC-WENT-TO-DEPOSIT-FILE  VALUE "D".
                   88 RC-TRANS-SUCCESSFUL      VALUE "Y".

               05  RC-EOM1-BATCH-FG        PIC X.
                   88 RC-EOM1-BATCH-SUCESSFUL  VALUE "Y".
               05  RC-EOM-UPDATE-FG        PIC X.
                   88 RC-EOM-UPDATE-SUCESSFUL  VALUE "Y".
               05  RC-EOM2-BATCH-FG        PIC X.
                   88 RC-EOM2-BATCH-SUCESSFUL  VALUE "Y".

               05  RC-BS-P2P3-INBAL-FG     PIC X.
                   88 RC-BS-P2P3-INBAL         VALUE "Y".

           03  RC-DEPOSIT                  PIC S9(7)V99   COMP-3.
           03  RC-OVER-SHORT               PIC S9(7)V99   COMP-3.
           03  RC-CHECKS                   PIC S9(7)V99   COMP-3.

           03  RC-OPENED-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-OPENED-DATE          PIC 9(8)       COMP-3.
               05  RC-OPENED-TIME          PIC 9(6)       COMP-3.
               05  RC-OP-USERID            PIC X(10).

           03  RC-CLOSED-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-CLOSED-DATE          PIC 9(8)       COMP-3.
               05  RC-CLOSED-TIME          PIC 9(6)       COMP-3.
               05  RC-CL-USERID            PIC X(10).

           03  RC-UPDATED-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-UPDATED-DATE         PIC 9(8)       COMP-3.
               05  RC-UPDATED-TIME         PIC 9(6)       COMP-3.
               05  RC-UPDATED-USERID       PIC X(10).

           03  RC-EOD-BATCH-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-EOD-BATCH-DATE       PIC 9(8)       COMP-3.
               05  RC-EOD-BATCH-TIME       PIC 9(6)       COMP-3.

           03  RC-NIGHTLY-FUNDS-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-FUNDS-DATE           PIC 9(8)       COMP-3.
               05  RC-FUNDS-TIME           PIC 9(6)       COMP-3.

           03  RC-EOM1-BATCH-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-EARNINGS-DATE        PIC 9(8)       COMP-3.
               05  RC-EARNINGS-TIME        PIC 9(6)       COMP-3.

           03  RC-EOM-UPDATED-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-EOM-UPDATED-DATE     PIC 9(8)       COMP-3.
               05  RC-EOM-UPDATED-TIME     PIC 9(6)       COMP-3.

           03  RC-EOM2-BATCH-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-EOM2-BATCH-DATE      PIC 9(8)       COMP-3.
               05  RC-EOM2-BATCH-TIME      PIC 9(6)       COMP-3.

           03  RC-CHECKS-EXTRACTED-INFO.
      $XFD DATE=YYYYMMDD
               05  RC-CHECK-DATE           PIC 9(8)       COMP-3.
               05  RC-CHECK-TIME           PIC 9(6)       COMP-3.

           03  RC-LAST-ACCRUE              PIC 9(4)       COMP-3.
           03  RC-ERROR-MSG                PIC X(15).
           03  RC-BANK-BAL                 PIC S9(9)V99   COMP-3.
           03  RC-CHECK-DEPOSIT            PIC S9(7)V99   COMP-3.

           03  FILLER                      PIC X(118).
      *================================================================*
      * END COPYBOOK: LIBGB\GB01RC.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GB01RC_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GB01RC_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL - GLOBAL RECAP DAILY FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0503 ***NEW***
      *
      ******************************************************************
      *- - -{GREATER CURSOR FOR START-GREATER & READ-NEXT}
       01  RC1-CURSOR-STAT              PIC X(2)  VALUE SPACES.
           88  RC1-CURSOR-STAT-GOOD               VALUE "00".
           88  RC1-CURSOR-STAT-BAD                VALUE "  " THRU "//"
                                                        "01" THRU "~~".
       01  RC1-CURSOR-NG-STAT           PIC X(2)  VALUE SPACES.
           88  RC1-CURSOR-NG-STAT-GOOD            VALUE "00".
           88  RC1-CURSOR-NG-STAT-BAD             VALUE "  " THRU "//"
                                                        "01" THRU "~~".
       01  RC2-CURSOR-STAT              PIC X(2)  VALUE SPACES.
           88  RC2-CURSOR-STAT-GOOD               VALUE "00".
           88  RC2-CURSOR-STAT-BAD                VALUE "  " THRU "//"
                                                        "01" THRU "~~".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.

       01  RC1-RETURN-CODE              PIC S9(4)   COMP-5.
       01  RC2-RETURN-CODE              PIC S9(4)   COMP-5.

       01  QRC1-WHERE-BEG-KEY.
           03  QRC1-WBEG-BRNO           PIC 9(04).
           03  QRC1-WBEG-TRANS-DATE     PIC X(10).

       01  QRC1-WHERE-END-KEY.
           03  QRC1-WEND-BRNO           PIC 9(04).
           03  QRC1-WEND-TRANS-DATE     PIC X(10).

       01  QRC2-WHERE-BEG-KEY.
           03  QRC2-WBEG-STATUS         PIC X(02).
           03  QRC2-WBEG-BRNO           PIC 9(04).
           03  QRC2-WBEG-TRANS-DATE     PIC X(10).

       01  QRC2-WHERE-END-KEY.
           03  QRC2-WEND-STATUS         PIC X(02).
           03  QRC2-WEND-BRNO           PIC 9(04).
           03  QRC2-WEND-TRANS-DATE     PIC X(10).

       01  QRC-REC.
           03  QRC-STATUS              PIC XX.
           03  QRC-BRNO                PIC 9(4).
           03  QRC-TRANS-DATE          PIC X(10).
           03  QRC-LTOUCH-DATE         PIC X(10).
           03  QRC-RECAP-FG             PIC X.
           03  QRC-GL-FG                PIC X.
           03  QRC-EOD-BATCH-FG         PIC X.
           03  QRC-NIGHTLY-FUNDS-FG     PIC X.
           03  QRC-EOM1-BATCH-FG        PIC X.
           03  QRC-EOM-UPDATE-FG        PIC X.
           03  QRC-EOM2-BATCH-FG        PIC X.
           03  QRC-BS-P2P3-INBAL-FG     PIC X.
           03  QRC-DEPOSIT              PIC S9(7)V99.
           03  QRC-OVER-SHORT           PIC S9(7)V99.
           03  QRC-CHECKS               PIC S9(7)V99.
           03  QRC-OPENED-DATE          PIC X(10).
           03  QRC-OPENED-TIME          PIC 9(6).
           03  QRC-OP-USERID            PIC X(10).
           03  QRC-CLOSED-DATE          PIC X(10).
           03  QRC-CLOSED-TIME          PIC 9(6).
           03  QRC-CL-USERID            PIC X(10).
           03  QRC-UPDATED-DATE         PIC X(10).
           03  QRC-UPDATED-TIME         PIC 9(6).
           03  QRC-UPDATED-USERID       PIC X(10).
           03  QRC-EOD-BATCH-DATE       PIC X(10).
           03  QRC-EOD-BATCH-TIME       PIC 9(6).
           03  QRC-FUNDS-DATE           PIC X(10).
           03  QRC-FUNDS-TIME           PIC 9(6).
           03  QRC-EARNINGS-DATE        PIC X(10).
           03  QRC-EARNINGS-TIME        PIC 9(6).
           03  QRC-EOM-UPDATED-DATE     PIC X(10).
           03  QRC-EOM-UPDATED-TIME     PIC 9(6).
           03  QRC-EOM2-BATCH-DATE      PIC X(10).
           03  QRC-EOM2-BATCH-TIME      PIC 9(6).
           03  QRC-CHECK-DATE           PIC X(10).
           03  QRC-CHECK-TIME           PIC 9(6).
           03  QRC-LAST-ACCRUE          PIC 9(4).
           03  QRC-ERROR-MSG            PIC X(15).
           03  QRC-BANK-BAL             PIC S9(9)V99.
           03  QRC-CHECK-DEPOSIT        PIC S9(7)V99.

       EXEC SQL END DECLARE SECTION END-EXEC.
      *================================================================*
      * END COPYBOOK: LIBGB\GB01RC_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBWSRC.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBWSRC
      *********************************************************
      *    LIBLP/LPWSSP: RCFILE PATH WORKERS
      *    /USR/DATA/XX/GB/RCFILE
      ******************************************************************
       01  RC-PATH-OVERRIDE          PIC X(01)   VALUE SPACES.

       01  RC-PATH                   PIC X(35)   VALUE SPACES.

       01  FILLER                    REDEFINES RC-PATH.
           03  RC-PATH-BEG           PIC X(13).
           03  RC-PATH-FILE          PIC X(22).
           03  FILLER                REDEFINES RC-PATH-FILE.
               05  FILLER            PIC X(03).
               05  RC-PATH-SQL       PIC X(19).

       01  RC-ALL-PATH.
           03  RC-ALL-BASE           PIC X(09).
           03  FILLER                REDEFINES RC-ALL-BASE.
               05  RC-ALL-BASE-USR   PIC X(05).
               05  RC-ALL-BASE-DIR   PIC X(04).
           03  FILLER                PIC X(01)   VALUE "/".
           03  RC-ALL-MACHINE        PIC X(02).
           03  FILLER                PIC X(23)   VALUE "/GB/RCFILE".

       01  RCSUB                     PIC 9(2).
      *================================================================*
      * END COPYBOOK: LIBGB\GBWSRC.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LP01BP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LP01BP
      *******************************************************
      *    BATCH PAYMENT RECORD
      *                  (220  BYTES)
      *
      *    FILE NAME:
      *              B      - BATCH PAYMENT FILE
      *              9999   - BRANCH NO
      *              MMDD   - DATE BATCH ESTABLISHED
      *              999    - BATCH NO
      *              REFCD  - BATCH REFCD       (OPTIONAL)
      *
      *         WHEN THE FILE IS CREATED FROM MAGNETIC
      *         TAPE THE BATCH NO AND DATE ARE SET TO ZERO
      *
      *    WHEN BP-LNNO = 0, IT IS A HEADER RECORD.
      *            TYPE = "M", IT WAS CREATED FROM MAG TAPE
      *                 = "I", IT WAS INPUT
      *
      *  MJD 000403 ADDED BP-SIGN (TFC PR#78)   1 : PRE ALLOTMENT DEBIT
      *                                         2 : ONE TIME ONLY DEBIT
      *                                         3 : RECURRING DEBIT
      *  MJD 000418 ADDED BP-SIGN = 4           4 : MELLON BANK LOCK BOX
      *             (MERC PR#227)
      *  JTG 010604 ADDED GP-TRUE-NEXT-BATCH           (MERC PR#243/251)
      *                   BP-SIGN = 5           5 : TRUE PAY
      *                   BP-SIGN = 6           6 : TRUE COLLECT
      *                   BP-SIGN = 7           7 : MAIL GRAM
      *  BLF 051107 ADDED BP-REFCD AND ADDED TO FILLER TO EXPAND RECORD SIZE
      *             FROM 24 TO 50 BYTES, REGACC PR# 107
      *  BLF 060314 ADDED BP-PAYDATE, LENDMARK PR# 2711, NOT SURE IF I WILL
      *             USE HERE, BUT SEEMS LIKE WE SHOULD HAVE ALWAYS HAD THIS
      *             SINCE MOST INPUT (BTFILES) CONTAIN THE REAL PAYMENT DATE;
      *             FOR NOW WILL CHECK IN LONPW9, IF 0 OR 202020 OR 020202
      *             WILL FORCE TRANS-DATE TO BP-PAYDATE.
      *  BLF 070411 ADDED BP-SALES-AMT, BP-AUCTION-FEES, BP-AUCTION-NAME,
      *             REGACC PR# 168 (POST SS IN BATCH)
      *   CS 070418 REMOVED BP-SALES-AMT, CAN CALCULATE. ADDED 50 BYTES TO
      *             HANDLE THE AUCTION NAME PR#168 REGACC
      *  BLM 080605 FOR WORLD CLAIMS, ADDED BP-CLAIM-NUMBER, BP-PMT-TYPE,
      *             WILL PRINT ON EXCEPTION REPORT, UPDATED BY SP/LOTSBP,
      *             PRINTED BY LONPW9, WORLD PR# 573
      *   CS 081024 ADDED 2 FLAGS FOR POSTING 'DF' BP-IGNORE-DEFPOL & BP-
      *             ALLOW-ZERO-DF PR#219 REGACC
      *  BLM 120423 ADD BP-CREATE-ACH-FG TO INDICATE RECORD WAS CREATED BY
      *             EPEXTR & WILL CREATE ACH RECORD IN ACHEXT TO TRANSMIT
      *             TO BANK.  NEED TO STOP CREATION OF "OV" TRANSACTION
      *             FOR THESE RECORDS, CITIZENS
      *  BLM 160426 ADD BP-BNKRPT-CASE-NO & BP-BNKRPT-STATUS, WORLD PR# 1151
      *  BLM 160622 ADD BP-SEQNO FOR DUPLICAT BATCH PMTS TO THE SAME LOAN,
      *             PD0003
      *  BLM 160728 ADD BP-ALLOW-NEGATIVE, REGACC PR# 382
      *  BLM 161024 FIX BP-HEAD-REC REDEF, FILLER NEEDED EXPANDING BECAUSE
      *             OF BP-SEQNO, PD0003
      * CS 20201008 ADD BP-FROZEN-OVERRIDE, WHEN SET TO "Y", WILL OVERRIDE
      *             LN-ACCT-FROZEN = "Y" PR#1465
      *  BLM 220323 ADD BP-PL-REASON, WORLD PR# 1548
      *  BAH 2023.1011 COMMENTED BP-CREATE-ACH-FG AS UNUSED
      **************************************************************************
       78  BP-SIZE                 VALUE 220.
       01  BP-REC.
           03  BP1-KEY.
               05  BP-LNNO         PIC 9(8).
               05  BP-SEQNO        PIC 99.
           03  BP-SSNO             PIC 9(9)     COMP-3.
           03  BP-TRCD             PIC XX.
           03  BP-TRAMT            PIC S9(7)V99 COMP-3.
           03  BP-UPDFG            PIC X.
           03  BP-DUAL-LN          PIC X.
      *    -------------------------------------------------------------
      *    BP-SIGN IS A TFC OPTION  0 : (DEFAULT) STD. ALLOTMENT
      *                             1 : PRE ALLOTMENT DEBIT (PREEZ)
      *                             2 : ONE TIME ONLY DEBIT (OTOEZ)
      *                             3 : RECURRING DEBIT     (RECEZ)
      *                             4 : MELLON BANK LOCK BOX PAYMENTS
      *                             5 : TRUE PAY
      *                             6 : TRUE COLLECT
      *                             7 : MAIL GRAM
      *    -------------------------------------------------------------
           03  BP-SIGN             PIC 9.
           03  BP-REFCD            PIC X(5).
           03  BP-PAYDATE          PIC 9(8)     COMP-3.
           03  BP-AUCTION-FEES     PIC S9(7)V99 COMP-3.
           03  BP-AUCTION-NAME     PIC X(30).
           03  BP-WORLD-CLAIM-FIELDS.
                05  BP-CLAIM-NUMBER PIC 9(8)    COMP-3.
                05  BP-PMT-TYPE    PIC X(10).
           03  BP-IGNORE-DEFPOL    PIC X.
           03  BP-ALLOW-ZERO-DF    PIC X.
      * BP-CREATE-ACH-FG NOT USED ANYMORE 2023.1011
           03  BP-CREATE-ACH-FG    PIC X.
           03  BP-BNKRPT-CASE-NO   PIC X(9).
           03  BP-BNKRPT-STATUS    PIC X.
           03  BP-ALLOW-NEGATIVE   PIC X.
           03  BP-FROZEN-OVERRIDE  PIC X.
           03  BP-PL-REASON        PIC XX.
           03  FILLER              PIC X(118).
      *--------------------------------------------------------
       01  BP-HEAD-REC.
           03  FILLER              PIC X(10).
           03  BP-TYPE             PIC X.
           03  BP-TOTAL-COUNT      PIC S9(7)    COMP-3.
           03  BP-TOTAL-AMOUNT     PIC S9(9)V99 COMP-3.
           03  FILLER              PIC X(199).
      *================================================================*
      * END COPYBOOK: LIBLP\LP01BP.CPY                                *
      *================================================================*

       01  WK-IFN              PIC X(2)     VALUE "WK".
       01  LOG-PATH.
           03  LOG-SPOOL-DIR      PIC X(32).
           03  LOG-PATHNAME       PIC X(10) VALUE "/0000LOG".

       01  RETURN-STATUS         PIC 9(6) VALUE 0.

       01  HOLD-LN-TOTPAYMNTD              PIC S9(7)V99 COMP-3.
       01  HOLD-PROG-BUF-BRANCH            PIC 9(4)    COMP.
       01  HOLD-BP-PAYOFF-NONCASH          PIC X VALUE " ".
       01  HOLD-LBOX-PAYOFF-NONCASH        PIC X VALUE " ".
       01  HOLD-BP-ALLOW-PMT-ACCT-OTHBAL   PIC X VALUE " ".
       01  HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL PIC X VALUE " ".
       01  HOLD-CD-BR-POST-SS-TRCD         PIC X VALUE " ".
       01  WK-KEY              PIC 9(2)     VALUE 0.
       01  POSTING-ERRCD       PIC XX       VALUE " ".
       01  PAYMENT-PROG        PIC X(6)     VALUE SPACES.

       01  TOT-POFF-REBATES    PIC S9(9)V99 COMP.

       01  ORIG-LN-LBOX        PIC X(01)    VALUE " ".
       01  ORIG-LN-ALLOTCD     PIC X(01)    VALUE " ".
       01  ORIG-BP-TRAMT       PIC S9(9)V99 VALUE 0.
       01  ORIG-LN-OT2BAL      PIC S9(9)V99 VALUE 0.

      * EXAMPLE; A0201TST
       01  ORIG-POSTNAME       PIC X(10).

       01  HOLD-EXT-FILPATH.
           03  FILLER                PIC X(13).
           03  HOLD-EXT-FILPATH-DATA PIC X(6).

      *-----------------------------------------------------------------
      * SPOOL DIRECTORY/FILENAME FOR LOG
      * EO/APIMMDDYY/0000LOG
      *-----------------------------------------------------------------
       01  EX-SPOOL.
           03  EX-SPOOL-BASE          PIC X(09).
           03  FILLER                 PIC X(01)   VALUE "/".
           03  EX-SPOOL-MACHINE       PIC X(02).
           03  FILLER                 PIC X(01)   VALUE "/".
           03  EX-SPOOL-DATA-PATH PIC X(6).
           03  FILLER             PIC X(04)  VALUE "/EO/".
           03  EX-SPOOL-PCODE     PIC X(03)  VALUE "API".
           03  EX-SPOOL-DATE      PIC 9(06).
           03  EX-SPOOL-FILE.
               05  FILLER         PIC X(01).
               05  EX-SPOOL-STEP  PIC 9(04).
               05  EX-SPOOL-NAME  PIC X(06).
               05  EX-SPOOL-SUF   PIC X(02).

       01  SAVE-EX-SPOOL-NAME     PIC X(06).
       01  STEP-COUNT             PIC 9999 VALUE 100.

       01  WORK-USERID.
           03  WORK-SECURITY        PIC X.
           03  WORK-BR              PIC 9(4).
           03  WORK-NAME            PIC X(5).

       01  PAYOFF-TRANS-FG      PIC X        VALUE " ".

       01  SUB                 PIC 9(6)      COMP-3 VALUE 0.
       01  SUB1                PIC 9(6)      COMP-3 VALUE 0.
       01  OVPAID-FLAG         PIC X         VALUE " ".
       01  OVPAID-AMT          PIC S9(9)V99.
       01  DISPLAY-OVPAID-AMT  PIC Z(6)9.99-.

       01  TEST-AMT                PIC S9(9)V99  COMP   VALUE 0.
       01  NET-POFF-PRIN           PIC S9(9)V99  COMP   VALUE 0.
       01  WILL-POFF-ACCOUNT       PIC S9(9)V99  COMP   VALUE 0.
       01  VALID-POSTING-NOPOFF    PIC S9(9)V99  COMP   VALUE 0.

       01  DF-TEST             PIC X         VALUE " ".
           88 DF-POSTING                     VALUE "Y".

      * REVERSAL WORKERS
       01  VALID-REVERSAL-FG           PIC X VALUE " ".
       01  REVERSE-AFTER-RESCHED-FG    PIC X VALUE "N".
       01  REV-REFNO           PIC X(5)             VALUE " ".
       01  REV-TRCD            PIC XX.
           88  AD-POSTING      VALUE "AD" "A2" "A3" "A4"
                                     "A5" "A6" "A7" "A8"
                                     "A9".
           88  DF-POSTINGX     VALUE "DF" "D2" "D3" "D4"
                                     "D5" "D6" "D7" "D8"
                                     "D9".
           88  ADDON-POSTING   VALUE "LP" "NP" "ET" "RT" "ST".
           88  REBATE-POSTING  VALUE "RC" "RA" "RP" "R1"
                                     "R2" "R3" "RI" "RS"
                                     "RM" "RD".
       01  HOLD-REV-TRCD      REDEFINES REV-TRCD.
           03 FILLER           PIC X.
           03  TRCD-FTST       PIC X.
           03  TRCD-NODF      REDEFINES TRCD-FTST
                               PIC 9.

       01  CDV-BUF           VALUE " ".
           03  CDV-CD        PIC X(2) OCCURS 83.
       01  CDV-SUB           PIC 9(6) COMP-3.
           88 CDV-NO-MATCH   VALUE 0.
           88 CDV-MATCH      VALUE 1 THRU 100.
       01  CDV-17            PIC X(40) VALUE
           "OTWOAPJDPLP2P3P4P5PIPWTSTPSPACO2W2Z2BKBD".

      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPBP_CMD.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPBP.CMD
      **********************************************************************
      *
      *   LPBP - COMMANDS
      *
      *=================================================================
      * REV:
      * JTG 010607 ADDED LIST5-CMD
      *            GP-TRUE-NEXT-BATCH           (MERC PR#243/251)
      * JTG 021016 ADDED LIST-REF-CMD.
      *            ADDED NEW CODE FILE TYPE 'BR' - BATCH PAYMENT REFERENCE CODES
      *            BATCH PAYMENT REVISIONS                          REGACC #0006
      * JTG 021104 ADDED LIST2-REF-CMD. AND DEV-NULL ' 2>DEV/NULL '
      *            BATCH PAYMENT REVISIONS                          REGACC #0006
      * BAH 140519 MOVED FROM _CMD, USE C$TOLOWER WHEN NEEDED!!
      *
      * KEC 2017.0912 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          COPIED LIBLP/LPBP.CPY TO THE SV AS A .NO THEN RENAME IT
      *          TO BE LIBLP/LPBP_CMD.CPY THEN FIXED IT FOR WHAT NEEDED
      *          TO BE LOWERCASE.
      *
      **********************************************************************
       01  DEV-NULL       PIC X(12) VALUE " 2>/dev/null".
       01  CUT-CMD        PIC X(11) VALUE "cut -c17-80".
       01  CUT-LOCAL-CMD  PIC X(11) VALUE "cut -c24-80".

      * ALSO USED IN SP/BPBKBR TO ENSURE THAT NO B??0000000 EXIST
      * BEFORE CREATING NEW ONES
       01  LIST-PATH      PIC X(14) VALUE "/usr/tmp/batch".

      * CALLED FROM BPBKBR
      *  "/$REL/SH/ec /$REL/SH/bplist.sh ".
       01  LIST-CMD.
           03  FILLER               PIC X    VALUE "/".
           03  LIST-REL             PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST-EC              PIC X(3) VALUE "ec ".
           03  FILLER               PIC X    VALUE "/".
           03  LIST-REL2            PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST-SHELL           PIC X(10) VALUE "bplist.sh ".
           03  LIST-DATA            PIC X(18).


      *  "/$REL/SH/ec /$REL/SH/bplist_ref.sh ".
       01  LIST-REF-CMD.
           03  FILLER               PIC X    VALUE "/".
           03  LIST-REF-REL         PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST-REF-EC          PIC X(3) VALUE "ec ".
           03  FILLER               PIC X    VALUE "/".
           03  LIST-REF-REL2        PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST-REF-SHELL       PIC X(14) VALUE "bplist_ref.sh ".
           03  LIST-REF-REFCD       PIC X(5).
           03  FILLER               PIC X     VALUE " ".
           03  LIST-REF-DATA        PIC X(11).
           03  FILLER               PIC X     VALUE " ".
           03  LIST-REF-DATE        PIC X(4).

      * "/$REL/SH/ec /$REL/SH/bplist2_ref.sh ".
       01  LIST2-REF-CMD.
           03  FILLER               PIC X    VALUE "/".
           03  LIST2-REF-REL        PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST2-REF-EC         PIC X(3) VALUE "ec ".
           03  FILLER               PIC X    VALUE "/".
           03  LIST2-REF-REL2       PIC X(7).
           03  FILLER               PIC X(4) VALUE "/SH/".
           03  LIST2-REF-SHELL      PIC X(15) VALUE "bplist2_ref.sh ".
           03  LIST2-REF-BRNO       PIC 9(4).
           03  FILLER               PIC X.
           03  LIST2-REF-DATE       PIC 9(4).
           03  FILLER               PIC X     VALUE " ".
           03  LIST2-REF-BATCH      PIC 9(3).


      * USED IN LP/LONPL0 & SP/AUTOCL TO SEE THAT ALL BATCHES HAVE BEEN
      * UPDATED
       01  BPEOD-PATH.
           03  FILLER        PIC X(14) VALUE
               "/usr/tmp/bpeod".
           03  BPEOD-PATH-BR PIC 9(4).

      *  "/$REL/SH/ec /$REL/SH/bpeod.sh ".
       01  BPEOD-CMD.
           03  FILLER            PIC X    VALUE "/".
           03  BPEOD-REL         PIC X(7).
           03  FILLER            PIC X(4) VALUE "/SH/".
           03  BPEOD-EC          PIC X(3) VALUE "ec ".
           03  FILLER            PIC X    VALUE "/".
           03  BPEOD-REL2        PIC X(7).
           03  FILLER            PIC X(4) VALUE "/SH/".
           03  BPEOD-SHELL       PIC X(9) VALUE "bpeod.sh ".
           03  BPEOD-BR          PIC 9(4).
           03  FILLER            PIC XX    VALUE SPACES.
           03  BPEOD-MO          PIC 99.
           03  FILLER            PIC XX    VALUE SPACES.
           03  BPEOD-DA          PIC 99.
           03  FILLER            PIC XX    VALUE SPACES.
           03  BPEOD-DATA        PIC X(18).


      *  "/$REL/SH/ec /$REL/SH/bplist2.sh ".
      *01  LIST2-CMD.
      *    03  FILLER               PIC X    VALUE "/".
      *    03  LIST2-REF-REL        PIC X(7).
      *    03  FILLER               PIC X(4) VALUE "/SH/".
      *    03  LIST2-REF-EC         PIC X(3) VALUE "ec ".
      *    03  FILLER               PIC X    VALUE "/".
      *    03  LIST2-REF-REL2       PIC X(7).
      *    03  FILLER               PIC X(4) VALUE "/SH/".
      *    03  LIST2-REF-SHELL      PIC X(11) VALUE "bplist2.sh ".
      *    03  LIST2-DATE  PIC 9(4).

      *  "/$REL/SH/ec /$REL/SH/bplist5.sh ".
      *01  LIST5-CMD.
      *    03  FILLER               PIC X    VALUE "/".
      *    03  LIST5-REF-REL        PIC X(7).
      *    03  FILLER               PIC X(4) VALUE "/SH/".
      *    03  LIST5-REF-EC         PIC X(3) VALUE "ec ".
      *    03  FILLER               PIC X    VALUE "/".
      *    03  LIST5-REF-REL2       PIC X(7).
      *    03  FILLER               PIC X(4) VALUE "/SH/".
      *    03  LIST5-REF-SHELL      PIC X(11) VALUE "bplist5.sh ".
      *    03  LIST5-DATE  PIC 9(4).
      *================================================================*
      * END COPYBOOK: LIBLP\LPBP_CMD.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPBPPATH.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPBPPATH
      **************************************************************************
      *        LPBPPATH
      *    BATCH PAYMENT PATH
      *
      * JTG 021011 ADDED NEW CODE FILE TYPE 'BR' - BATCH PAYMENT REFERENCE CODES
      *            BATCH PAYMENT REVISIONS                          REGACC #0006
      * JTG 021213 ADDED BP-WK-GB-FILE-NAME       PIC X(5) VALUE "BTFIL".
      *            BATCH PAYMENT REVISIONS                          REGACC #0006
      **************************************************************************
       01  BP-PATH-OVERRIDE          PIC X(01) VALUE SPACES.
       01  BP-PATH                   PIC X(40) VALUE " ".
       01  BP-ALL-PATH.
           03  BP-ALL-BASE           PIC X(09) VALUE SPACES.
           03  FILLER                PIC X    VALUE "/".
           03  BP-ALL-MACHINE        PIC XX.
           03  FILLER                PIC X    VALUE "/".
           03  BP-ALL-DATA           PIC X(6).
           03  FILLER                PIC X(5) VALUE "/ED/B".
           03  BP-ALL-SUBPATH.
               05  BP-ALL-BRANCH         PIC 9(4).
               05  BP-ALL-DATE           PIC 9(4).
               05  BP-ALL-BATCH-NO       PIC 999.
               05  BP-ALL-REFCD          PIC X(5).
           03  BP-ALL-SUBPATHX       REDEFINES BP-ALL-SUBPATH.
               05  BP-ALL-BRANCHX     PIC X(4).
               05  BP-ALL-DATEX       PIC X(4).
               05  BP-ALL-BATCH-NOX   PIC XXX.
               05  BP-ALL-REFCDX      PIC X(5).

      *=================================================================
      *    /USR/DATA/R#/ED/++FIL####&&&  (#### = MMDD) (&&& = BATCH)
      *=================================================================
       78  BP-WK-BT-PATH                     VALUE "BTFIL".
       78  BP-WK-LB-PATH                     VALUE "LBFIL".

       01  BP-WK-GB-PATH-OVERRIDE         PIC X(01)  VALUE SPACES.
       01  BP-WK-GB-PATH.
           03  BP-WK-GB-FILENAME.
               05  BP-WK-GB-BASE          PIC X(09).
               05  FILLER                 REDEFINES BP-WK-GB-BASE.
                   07  BP-WK-GB-BASE-USR  PIC X(05).
                   07  BP-WK-GB-BASE-DIR  PIC X(04).
               05  FILLER                 PIC X(01)  VALUE "/".
               05  BP-WK-GB-MACHINE       PIC X(02).
               05  FILLER                 PIC X(04)  VALUE "/ED/".
               05  BP-WK-GB-FILE-NAME     PIC X(05)  VALUE "BTFIL".
           03  BP-WK-GB-SUBPATH.
               05  BP-WK-GB-DATE          PIC 9(04).
               05  BP-WK-GB-BATCH-NO      PIC 9(03).
           03  BP-WK-GB-SUBPATHX          REDEFINES BP-WK-GB-SUBPATH.
               05  BP-WK-GB-DATEX         PIC X(04).
               05  BP-WK-GB-BATCH-NOX     PIC X(03).
      *================================================================*
      * END COPYBOOK: LIBLP\LPBPPATH.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWKPATH.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWKPATH
      ******************************************
      *  PATH OF LONP WORK AND TRNASACTION FILES
      ******************************************
       01  TEMP-PATH.
      * /USR/TMP/
           03  FILLER                PIC X    VALUE "/".
      * USR
           03  FILLER                PIC X(3) VALUE X'757372'.
           03  FILLER                PIC X    VALUE "/".
      * TMP
           03  FILLER                PIC X(3) VALUE X'746D70'.
           03  FILLER                PIC X    VALUE "/".
           03  TEMP-PID              PIC X(7).


      *================================================================*
      * END COPYBOOK: LIBLP\LPWKPATH.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPIBPCW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPIBPCW
      ************************************************
      *    (INTEREST BEARING OR PRECOMPUTE)
      *       ACCOUNT STATUS TEST WORKERS
      * REV: JTG 051089 CHANGED WORKERS TO COMP
      ************************************************
       01  IBPC-WORKERS.
           03  IBPC-DATE           PIC 9(8)    COMP.
           03  IBPC-FG             PIC X.
           03  IBPC-STAT           PIC X.
           03  IBPC-STAT-2         PIC X.
           03  IBPC-EXPIRED-FLAG   PIC X.
      *================================================================*
      * END COPYBOOK: LIBLP\LPIBPCW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPRATEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPRATEW
      **************************************************************************
      *    SET RATE FOR IB CALC WORKERS
      * REV:
      *  SLC 890125 ADDED LPINDUW.
      *  SLC 891005 ADDED INDU-MAX-ACCRUE FOR I/B ACCRUE REPORT
      *  JTG 000107 INDU-LIST & INDU-COMM RE: SP-RBREDUC = 9999.04
      *             WISCONSIN IB REAL ESTATE PREPAY PENALTY, WISCONSIN #1031
      *  JTG 020722 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *   CS 100609 ADDED INDU-ASSESS-PENALTY-16. IF SP-RBSOPT1 16, AND ACCOUNT
      *             HAD INTEREST TO EXPIRDATE & THEN EXPIRED INTEREST, THE
      *             INTEREST-DUE-CALCULATION CALCULATED A PENALTY TWICE
      *                                                     REGENCY PL#689
      *  BAH 161025 EXPANDED ALL DATES TO 9(8)
      *  BAH 2024.0412 REMOVED RATE-INT-DATE, INDU-SUB, INDU-LIST
      **************************************************************************
       01  RATE-WORKERS.
           03  RATE-DATE       PIC 9(8)     COMP  VALUE 0.
           03  RATE-MAKERCD    PIC X              VALUE " ".
           03  RATE-EXP-INT    PIC S9(5)V99 COMP.
           03  RATE-LPTRCD     PIC XX VALUE "  ".
           03  RATE-EXPR-TAB.
               05  RATE-EXPR-TAB-BREAK PIC 9(8)
                                       OCCURS 5 TIMES.
           03  RATE-EXPR-BREAK PIC 9(6)V99.
           03  RATE-MONTH-DAY-BREAK REDEFINES RATE-EXPR-BREAK.
               05  RATE-EXPR-MONTHS    PIC 9(6).
               05  RATE-EXPR-DAYS      PIC 99.
      *-------------------------------------------------------------------------
      *   INTEREST-DUE WORKERS
      * REV:
      *  JTG 880331 ADDED INDU-LPTRCD FOR SPECIAL REFUND
      *             CONDITIONS
      *  JTG 900125 ADDED INDU-DAYS AS OUTPUT FIELD
      *  JTG 910309 ADDED INDU-WK FOR DATER
      *  JTG 000105 ADDED SP-RBREDUC = 9999.04 WISCONSIN IB REAL ESTATE
      *             PREPAY PENALTY, WISCONSIN #1031
      *             INDU-LIST, INDU-BUF AND INDU-PENALTY
      *  JTG 020722 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *-------------------------------------------------------------------------
       01  INDU-INTEREST        PIC S9(5)V99   COMP VALUE 0.
       01  INDU-DAYS            PIC S9(5)      COMP VALUE 0.
       01  INDU-WORKER          PIC S9(6)V9(7) COMP VALUE 0.
       01  INDU-CURBAL          PIC S9(7)V99   COMP VALUE 0.
       01  INDU-RATE            PIC 999V999    COMP VALUE 0.
       01  INDU-AMOUNT          PIC S9(7)V99   COMP VALUE 0.
       01  INDU-ALL-INSPREM     PIC S9(7)V99   COMP VALUE 0.
       01  INDU-DATE-1          PIC 9(8)       COMP VALUE 0.
       01  INDU-DATE-2          PIC 9(8)       COMP VALUE 0.
       01  INDU-LPTRCD          PIC XX              VALUE " ".
       01  INDU-YEARTYPE        PIC 9(4)       COMP VALUE 0.
       01  INDU-INTMETHOD       PIC X               VALUE " ".
       01  INDU-INTEREST-2      PIC S9(5)V99   COMP VALUE 0.
       01  INDU-MAX-ACCRUE      PIC 9          COMP VALUE 0.
       01  INDU-WK              PIC 999        COMP VALUE 0.
       01  INDU-ASSESS-PENALTY  PIC X            VALUE " ".
       01  HOLD-INDU-PENALTY    PIC S9(5)V99    COMP VALUE 0.
       01  INDU-BUF.
           03  INDU-PENALTY     PIC S9(5)V99   VALUE 0.

       01  INDU-COMMON.
           03  INDU-COMMON-RTNCD       PIC X.
           03  INDU-COMMON-REBATE      PIC S9(7)V99 COMP-3.
           03  INDU-COMMON-AREA        PIC X(40).
      * USED FOR WISCONSIN REDUCTION CODE:
           03  INDU-A02               REDEFINES INDU-COMMON-AREA.
               05  INDU-A02-PENALTY    PIC S9(7)V99 COMP-3.
               05  INDU-A02-PAYDATE    PIC 9(8)     COMP-3.
               05  FILLER              PIC X(30).
      * USED FOR MISSISSIPPI REDUCTION CODE:
           03  INDU-A01               REDEFINES INDU-COMMON-AREA.
               05  INDU-A01-ELAPSED-MO PIC S9(3)    COMP-3.
               05  INDU-A01-PENALTY    PIC S9(5)V99 COMP-3.
               05  INDU-A01-PAYDATE    PIC 9(8)     COMP-3.
               05  FILLER              PIC X(29).
      *================================================================*
      * END COPYBOOK: LIBLP\LPRATEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPXDTEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPXDTEW
      *--------------------------------------------
      *   EXPIRATION-DATE CALCULATION WORKERS
      *
      *   REV: 032188 JTG REMOVED XDTE-DATE-WORK
      *--------------------------------------------
       01  XDTE-DATE        PIC 9(8)  COMP VALUE 0.
      *================================================================*
      * END COPYBOOK: LIBLP\LPXDTEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCASW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCASW
      *----------------------------------------------------
      *    LATE-CHARGE ASSESS WORKERS
      *
      *  REV:
      *   JTG 051089 CHANGED WORKERS TO COMP.
      *   JTG 120590 ADDED LCAS-ELAPSED-DAYS FOR LCFRMLA A
      *   JTG 071696 ADDED LCAS-LCGRACE
      *   JTG 122398 ADDED LCAS-GRACE-DATE
      *   BAH 2022.0121 REMOVED REDEFINES OF LCAS-1STPYDATE & LCAS-LCPDTH-DATE
      *----------------------------------------------------
      * IN:
       01  LCAS-PAYDATE       PIC 9(8)  COMP.
       01  LCAS-1STPYDATE     PIC 9(8).
       01  LCAS-LCPDTH-DATE   PIC 9(8).

      * OUT:
       01  LCAS-ASSESS            PIC X.
       01  LCAS-ELAPSED-DAYS      PIC S9(5) COMP.
       01  LCAS-GRACE-DATE        PIC 9(8)  COMP.

      * WORKERS:
       01  LCAS-WORKERS.
           03  LCAS-WKDATE        PIC 9(8).
           03  FILLER            REDEFINES LCAS-WKDATE.
               05  FILLER         PIC 9(4).
               05  LCAS-WKMMDD    PIC 9(4).
           03  LCAS-HOLIDAY-FLAG  PIC 9   COMP VALUE 1.
           03  LCAS-SUB           PIC 99  COMP.
           03  LCAS-LCGRACE       PIC 999 COMP.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLCASW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPSCHDW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPSCHDW
      *----------------------------------------------
      *            LPSCHDW
      *    EXPANDED PAYMENT SCHEDULE.
      *
      * REV:
      *----------------------------------------------
       01  SCHD-TERM                 PIC 999     COMP.
       01  SCHD-PAYMENT-TABLE.
           03  SCHD-AMT              OCCURS 360
                                     PIC 9(6)V99 COMP.
       01  SCHD-SUB                  PIC 999     COMP.
       01  SCHD-SUB2                 PIC 999     COMP.
       01  SCHD-SUB3                 PIC 999     COMP.
      *================================================================*
      * END COPYBOOK: LIBLP\LPSCHDW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\SPPDTHW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/SPPDTHW

      *-----------------------------------------------------------------------
      *    SPPDTHW      PAID-THRU CALCULATION WORKERS
      * REV:
      *  JTG 040590 ADDED PDTH-ALDEL-FG
      *  JTG 080790 ADDED PDTH, PDTH-WORKER, PDTH-CNT FOR ADDON
      *  JTG 090690 ADDED PDTH-CUR-SCHD-PAY
      *  JTG 070292 ADDED PDTH-NXT-SCHD-PAY, PDTH-NXT-SCHD-DATE
      *  JTG 041593 ADDED PDTH-WK-DA & PDTH-DDYY FOR UNIT PERIODS
      *  JTG 052495 ADDED PDTH-CREDIT, RE: MERCURY SP-CONTR-CREDIT
      *  JTG 082995 ADDED PDTH-DEF-FG
      *  JTG 011196 EXPANDED PDTH-PAYMENTS TO 9(5)
      *  JTG 041596 ADDED PDTH-CUR-SCHD-DATE
      *  JTG 990124 ADDED COPY STATEMENT FOR LIBLP/RVPMTDUE/W
      *  JTG 021111 ADDED PDTH-AMT-TO-ADVANCE                     REGACC #0008
      *  MJD 090219 TESTING CHANGES FOR A NEW BANKRULE (PDTH-E-XXX FIELDS)
      *  BLM 170309 CHANGED PDTH-WK-DATE TO BE CCYYMMDD, CHANGED PDTH-DATE
      *             TO BE CCYYMM, PD0006
      *  BAH 170317 CHANGED PDTH-DATE BACK TO JUST MMYY, WE WONT EVER NEED
      *             IT TO COME OUT AS MMCCYY
      *  BAH 2024.0321 REMOVED PDTH-CREDIT, NOT USED
      *-----------------------------------------------------------------------
      * INPUT:
       01  PDTH-DATE-WORK        PIC 9(8).
       01  PDTH-DATE-WK         REDEFINES PDTH-DATE-WORK.
           03  PDTH-WK-CCYY      PIC 9(4).
           03  FILLER REDEFINES PDTH-WK-CCYY.
               05  PDTH-WK-CC    PIC 99.
               05  PDTH-WK-YY    PIC 99.
           03  PDTH-WK-MM        PIC 99.
           03  PDTH-WK-DD        PIC 99.
       01  PDTH-ALDEL-FG         PIC X       VALUE " ".
       01  PDTH-DEF-FG           PIC X       VALUE " ".

      * OUTPUT:
       01  PDTH-DATE             PIC 9(4).
       01  PDTH-DATE-RED        REDEFINES PDTH-DATE.
           03  PDTH-MM           PIC 99.
           03  PDTH-YY           PIC 9(2).
           03  PDTH-DDYY        REDEFINES PDTH-YY
                                 PIC 9(2).

       01  PDTH-DATE-FULL        PIC 9(8)     COMP.
       01  PDTH-LCPDTHRU         PIC 9V9(12)  COMP.
       01  PDTH-CUR-SCHD-DATE    PIC 9(8)     COMP.
       01  PDTH-CUR-SCHD-PAY     PIC S9(7)V99 COMP.

       01  PDTH-NXT-SCHD-DATE    PIC 9(8)     COMP.
       01  PDTH-NXT-SCHD-PAY     PIC S9(7)V99 COMP.

       01  PDTH-E-1STPYAMT     PIC S9(7)V99 COMP.
       01  PDTH-E-REGPYAMT     PIC S9(7)V99 COMP.
       01  PDTH-E-LASTPYAMT    PIC S9(7)V99 COMP.
       01  PDTH-E-OPTION       PIC X VALUE SPACE.

       01  PDTH-PAYMENTS         PIC 99999V9(12).
       01  PDTH-PY              REDEFINES PDTH-PAYMENTS.
           03  PDTH-PAYS         PIC 99999.
           03  PDTH-REMAIN       PIC V9(12).
       01  PDTH-AMT-TO-ADVANCE   PIC S9(7)V99 COMP.

      * WORKERS:
       01  PDTH-PAYMNTD          PIC S9(7)V99 COMP.
       01  PDTH-MONTHS           PIC S9(3)    COMP.
       01  PDTH-YEARS            PIC 99       COMP.
       01  PDTH-WORKER           PIC S9(7)V99 COMP.
       01  PDTH-CNT              PIC S9(3)    COMP.
       01  PDTH                  PIC S9(3)    COMP.

      *================================================================*
      * END COPYBOOK: LIBGB\SPPDTHW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCHGW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCHGW
      *-------------------------------------------------------------------------
      *          (LIBLP/LPLCHGW)
      *
      *   LATE-CHARGE CALCULATION WORKERS
      * REV:
      *  JTG 051089 CHANGED WORKERS TO COMP
      *  SLC 091390 ADDED LCHG-CURPAY.
      *  GLF 030399 ADDED LCHG-DAYS-AFTER-DUE
      *  JTG 990929 EXPANDED LCHG-LCPDTH-DATE TO 9(6)   REGENCY #245 BUG
      *  BAH 170314 ADJUSTED REDEFINE OF LCHG-LCPDTH-DATE FOR CENTURY
      *-------------------------------------------------------------------------
       01  LCHG-CHARGE            PIC S9(7)V99 COMP VALUE 0.
       01  LCHG-LATE              PIC S9(7)V99 COMP VALUE 0.
       01  LCHG-WORK              PIC  9(7)V99      VALUE 0.
       01  FILLER                REDEFINES LCHG-WORK.
           03  LCHG-TRUNC         PIC  9(7).
           03  LCHG-DEC           PIC  9(2).

       01  LCHG-LCPDTH-DATE       PIC  9(8).
       01  FILLER                REDEFINES LCHG-LCPDTH-DATE.
           03  LCHG-LCPDCC        PIC  9(2).
           03  LCHG-LCPDYY        PIC  9(2).
           03  LCHG-LCPDMM        PIC  9(2).
           03  LCHG-LCPDDD        PIC  9(2).
       01  LCHG-CURPAY            PIC S9(7)V99 COMP VALUE 0.
       01  LCHG-DAYS-AFTER-DUE    PIC S9(4)    COMP VALUE 0.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLCHGW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCAPW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCAPW
      *-------------------------------------------------------------------------
      *    LATE-CHARGE APPLY WORKER
      *  REV:
      *   JTG 051089 CHANGED WORKERS TO COMP
      *   JTG 051889 ADDED LCAP-TOTPAYMNTD FOR GENERIC CONTRACTUAL
      *   JTG 062190 ADDED LCAP-PRIOR-1STPY (PACESETTER F,H,I)
      *   JTG 072490 ADDED LCAP-APLC FOR LATE CHG'S APPLIED
      *   SLC 090690 ADDED LCAP, LCAP-WORKER, LCAP-CNT FOR ADDON.
      *   JTG 071596 EXPANDED LCAP-LCPDTH-DATE TO 9(6) TO INCLUDE LCAP-LCPDDD
      *   JTG 060898 ADDED LCAP-HOLDER AS A WORKER FOR LCAP-I-L
      *   JTG 000111 ADDED LCAP-NOLCHG  WORLD #218
      *              TO TRACK THE NUMBER OF LATE CHARGES ASSESSED
      *   JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *              LCAP-POFF-LPTRCD, RE: SP-RBSPOPT1() = 19, WORLD #233
      *   JTG 010209 ADDED LCAP-TRAMT-PLUS-AP, IDEAL PR#315 LCAP-E
      *   JTG 010801 ADDED LCAP-APPLIED-TOWARD-SHORTAGE IDEAL PR#1509
      *   JTG 021115 ADDED LCAP-BATCH-REFCD LCAP-BATCH-REFCD-LC-FG
      *              ADDED NEW CODE FILE TYPE 'BR'-BATCH PAYMENT REFERENCE CODES
      *              BATCH PAYMENT REVISIONS                        REGACC #0006
      *   BLM 100330 ADDED LCAP-ESCROW-AMT, REGWAN PR# 3506
      *   BLM 170309 FIX LCAP-1STPYDATE,LCAP-LCPDTH-DATE AND LCAP-CURDATE
      *              FOR CCYYMMDD FORMAT, PD0006
      *   BAH 2024.0409 REMOVED LCAP-AMOUNT-LEFT-TO-APPLY,
      *                 LCAP-AMT-TO-ADVANCE-LCPDTH , LCAP-AMOUNT-PAID-BEFORE,
      *                 LCAP-DAYS-LATE, LCAP-NUMBER-OF-PMTS,
      *                 LCAP-MUST-APPLY-TO-ASSESS, LCAP-CHARGES-TOWARDS-PMTS,
      *                 LCAP-DO-WE-USE-PARTIALS
      *-------------------------------------------------------------------------
       01  LCAP-WORKERS.
      * INPUT FIELDS:
           03  LCAP-TRAMT                PIC S9(7)V99    COMP.
           03  LCAP-PAYDATE              PIC 9(8)        COMP VALUE 0.
           03  LCAP-1STPYDATE            PIC 9(8).
           03  LCAP-1STPYDATEX          REDEFINES LCAP-1STPYDATE.
               05  LCAP-1STPYDATE-CC     PIC 99.
               05  LCAP-1STPYDATE-YY     PIC 99.
               05  LCAP-1STPYDATE-MM     PIC 99.
               05  LCAP-1STPYDATE-DD     PIC 99.
           03  LCAP-LPTRCD               PIC XX          VALUE SPACES.
           03  LCAP-LPAPINT              PIC S9(6)V99    COMP VALUE 0.
           03  LCAP-LPAPLC               PIC S9(5)V99    COMP VALUE 0.
           03  LCAP-POFF-LPTRCD          PIC XX          VALUE SPACES.
           03  LCAP-BATCH-REFCD          PIC X(5)        VALUE SPACES.
           03  LCAP-BATCH-REFCD-LC-FG    PIC X           VALUE SPACES.
           03  LCAP-ESCROW-AMT           PIC S9(7)V99    COMP VALUE 0.

      * OUTPUT FIELDS:
           03  LCAP-OWE                  PIC S9(7)V99 VALUE 0 COMP.
           03  LCAP-APP                  PIC S9(7)V99 VALUE 0 COMP.
           03  LCAP-LCPDTH-DATE          PIC 9(8).
           03  LCAP-LCX                  REDEFINES LCAP-LCPDTH-DATE.
               05  LCAP-LCPDCC           PIC 99.
               05  LCAP-LCPDYY           PIC 99.
               05  LCAP-LCPDMM           PIC 99.
               05  LCAP-LCPDDD           PIC 99.
           03  LCAP-LCPAID               PIC S9(7)V99 VALUE 0 COMP.
           03  LCAP-PARTIALS             PIC S9(7)V99 VALUE 0 COMP.
           03  LCAP-NOLCHG               PIC S999     VALUE 0 COMP.

      * WORKERS:
           03  LCAP-HOLDER                 PIC S9(7)V99    COMP.
           03  LCAP-DELFAC                 PIC S9(7)V99    COMP.
           03  LCAP-WRK                    PIC S9(7)V99    COMP.
           03  LCAP-WRK2                   PIC S9(7)V99    COMP.
           03  LCAP-AMTNEEDED              PIC S9(7)V99    COMP.
           03  LCAP-TOTPAYMNTD             PIC S9(7)V99    COMP.
           03  LCAP-PAYMNTD                PIC S9(7)V99    COMP.
           03  LCAP-UNPAID-PORTION         PIC S9(7)V99    COMP.
           03  LCAP-PDTH-PAYMENTS          PIC 999         COMP.
           03  LCAP-TRAMT-PLUS-AP          PIC S9(7)V99    COMP.

           03  LCAP-LST-CURDATE            PIC 9(8)        COMP.
           03  LCAP-LST-CURDUE             PIC S9(7)V99    COMP.

           03  LCAP-CURDUE                 PIC S9(7)V99    COMP.
           03  LCAP-CURPMT                 PIC S9(7)V99    COMP.
           03  LCAP-CURDATE                PIC 9(8).
           03  LCAP-CURDATEX              REDEFINES LCAP-CURDATE.
               05  LCAP-CURDATE-CC         PIC 99.
               05  LCAP-CURDATE-YY         PIC 99.
               05  LCAP-CURDATE-MM         PIC 99.
               05  LCAP-CURDATE-DD         PIC 99.

           03  LCAP-PRIOR-1STPY            PIC X.

           03  LCAP-AL-OK                  PIC X.

           03  LCAP-WORKER                  PIC S9(7)V99 COMP.
           03  LCAP-CNT                     PIC S9(3)    COMP.
           03  LCAP                         PIC S999     COMP.

           03  LCAP-PAYMENTS                PIC 9999V9(12).
           03  LCAP-PY                     REDEFINES LCAP-PAYMENTS.
               05  LCAP-PAYS                PIC 9999.
               05  LCAP-REMAIN              PIC V9(12).
           03  LCAP-CUR-SCHD-PAY            PIC S9(7)V99 COMP.
           03  LCAP-PMT-NO                  PIC 999 COMP.
           03  LCAP-APPLIED-TOWARD-SHORTAGE PIC S9(7)V99 COMP.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLCAPW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPMDTEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPMDTEW
      *--------------------------------------------------------
      *            (LPMDTEW)
      *   MATURITY-DATE CALCULATION WORKERS
      *
      *  REV:
      *   032188 JTG ADDED MDTE-FLAG REMOVED MDTE-DATE-WORK
      *   051089 JTG CHANGED WORKERS TO COMP
      *   080990 JTG ADDED MDTE-ORGTERM-FG RE: ADDON INS.
      *   050218 BAH ADDED MDTE-DC-FLAG FOR DUE DATE CHANGES TO NOT AFFECT
      *              MATURITY DATE...LENDMARK PL# 463
      *--------------------------------------------------------
       01  MDTE-DATE       PIC 9(8)  COMP   VALUE 0.
       01  MDTE-FLAG       PIC X            VALUE " ".
       01  MDTE-ORGTERM-FG PIC X            VALUE " ".
       01  MDTE-DC-FLAG    PIC X            VALUE " ".
      *================================================================*
      * END COPYBOOK: LIBLP\LPMDTEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPITRMW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPITRMW
      *--------------------------------------------
      *    INSURANCE EXPIRATION TEST & TERM WORKERS
      * REV: JTG 051089 CHANGED FIELDS TO COMP
      *--------------------------------------------
       01  ITRM-WORKERS.
      * INPUT FIELDS:
           03  ITRM-SUB           PIC 9      COMP.
           03  ITRM-TODAY         PIC 9(8)   COMP VALUE 0.

      * OUTPUT FIELDS:
           03  ITRM-INSTERM       PIC 9(4)   COMP.
           03  ITRM-INEFFECT-FG   PIC X.

      * WORKERS:
           03  ITRM-SUB1          PIC 99     COMP.
      *================================================================*
      * END COPYBOOK: LIBLP\LPITRMW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DATERW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/DATERW
      *****************************************************************
      *      (DATERW)   DATE ROUTINE WORKERS
      *
      * REV:
      *  JTG 030295 REMOVED JULIAN-YY & JULIAN-DD
      *  MJD 103097 ADDED 88 LEVELS SYSDATE-??-NUMDATE.
      *  JTG 080398 CHANGED 'DATE-IS-..' TO 'SYS-IS..'
      *  KEC 100898 ADDED WORKERS FOR "YEAR 2000" ROUTINES.
      *  JTG 121698 ADDE DATER-REVOLVING FOR DISPLAY OF 'R' REVOLVING
      *  MJD 990224 ADDED DATE-MMDDYYYY FOR Y2K CONVERSION
      *  KEC 990330 ADDED SOME MORE DATE CONVERSION WORKERS
      *  KEC 000204 ADDED SOME MORE DATE CONVERSION WORKERS
      *              DATE-ONE DATE-TWO   (MMYY/MMYYYY/YYMM/YYYMM/YYYYMM)
      *  JTG 061122 CHANGED THE INITIAL VALUE OF ELAPSED-YRTYPE VALUE '0'
      *             TO ELAPSED-YRTYPE VALUE 365
      * MJD 130130 REPLACED "C" CALLS WITH VERYAND COBOL VERSIONS OF
      *            PARADATA DATE ROUTINES.   THIS IS AN INTERNAL
      *            CHANGE, THE WAY IN WHICH WE CALL AND USE THE
      *            DATE ROUTINES REMAINS UNCHANGED. DATE WORKERS
      *            FOR THESE ROUTINES HAVE BEEN ADDED TO THIS WORKER.
      * MJD 130213 ADDED DATER-HOLD-NDTE-DATE.  TIMALL REUSES NDTE DATE
      *            EVEN THOUGH IT IS NOT AN INPUT FOR IT BECAUSE IT CALLS
      *            NEWDATE.  THIS CAUSES ISSUES BECAUSE THE CALLING
      *            PROGRAM HAS ALREADY SET NDTE-DATE AND DOES NOT EXPECT IT
      *            TO CHANGE WHEN CALLING TIMALL.  TO FIX THIS I SAVE
      *            NDTE-DATE AND RESTORE IT AFTER THE CALL.
      * MJD 130219 CHANGED THE PIC FOR CJWS-MOD-JUL FROM S(2) TO S(4).
      *            THE CALCULATION WAS OVERFLOWING AND RETURING ERRANT RESULTS.
      * MJD 120313 ADDED NOT-YEAR.  NEEDED FOR A CHANGE VERYANT MADE TO CORRECT
      *            A PROBLEM WITH ELAPSED TIME AND LEAP YEARS.
      * MJD 130509 ADDED WS-JUL-WK TO REPLACE JULIAN-DATE FOR INTERNAL
      *            CALCULATIONS. EDWIN (VERYANT) WAS USING JULIAN-DATE FROM
      *            BUFFER AND WE DO NOT WANT TO CHANGE THE VALUE UNLESS
      *            IT IS ACTUALLY PART OF THE INPUT/OUTPUT OF THE ROUTINE
      *            CALLED.
      * MJD 100413 ADDED WS-DATE1-YYYY AND WS-DATE2-YYYY.  NEEDED FOR ELAPSED
      *            CALCS THAT SPAN A CENTURY DATE.
      *            EXPANDED WS-NDTE-YY-S, WS-UP-WORK TO 4 DIGITS
      * MJD 140507 ADDED WS-NDTE-MM-VALID AND WS-NDTE-DD-VALID.
      *            NEEDED TO TEST VALID MON AND DAY ON TSTDAT.
      * MJD 151023 ADAPTING ROUTINE TO WORK WITH CCYYMMDD FORMATTED DATE TYPES.
      * MJD 170207 COMMENTED OUT WS-DATE1-YYYY AND WS-DATE2-YYYY
      *            IT HAS BEEN REPLACED WITH WS-DATE1-CCYY AND WS-DATE2-CCYY
      * BLM 170309 BROUGHT OVER FROM A39 (CAME FROM DATER8W WITH A FEW
      *            TWEAKS), PD0006
      * MJD 170505 EXPANDED ELAPSED-???? FIELDS TO MATCH INTERNAL
      *            WORKERS AND ADDED TWO BYTED TO DAYS/UNITPER FOR
      *            GOOD MEASURE.   INTERNAL WORKERS WERE EXPANDED FOR
      *            8 DIGIT DATES BUT EXTERNAL BUFFER WAS NOT LARGE ENOUGH
      *            TO HANDLE EXPANDED RANGE IN WHICH WE CAN NOW CALCULATE
      *            ELAPSED-TIME. EXPANDED WS-HOLD-MOS WORKER FROM 9(3) TO 9(7)
      *            THIS IS ONLY USED WITH 362 YEARTYPES
      * BAH 20190625 REMOVED DATER-REVOLVING, PT0153
      * BLM 20210830 CHANGE SEVERAL DATE WORKERS TO BE 9(8) INSTEAD OF
      *              GROUP (ALPHA) FIELDS.  GROUP ITEMS DID NOT PASS
      *              COMPARISON TO 0.  WS-NDTE, WS-DATE1, WS-DATE2, 
      *              WS-DATE1W, WS-DATE2W, WS-DATEX, WS-CJUL-OUT,
      *              CJUL-OUT, ND-WS-NDTE, CALL-DATE
      * JKC 20240113 COMMENT OUT JULIAN-BEG, JULIAN-END, JULIAN-CC;
      *              THEY ARE NOW EXTERNAL FIELDS POPULATED IN
      *              GB/SETENV SO TO WE CAN MORE EASILY CHANGE
      *              'SLIDING CENTURY WINDOW' IN THE FUTURE.
      * BAH 2024.0808 UNCOMMENTED NOT-YEAR FOR LEAP YEAR FIX S35Q-105
      *****************************************************************
      *----------------------------------------------------------------
      *    COBOL BUFFER USED IN 'C' ROUTINES
      *----------------------------------------------------------------
       01  DATER-STAT                  PIC XX    VALUE "11".
       01  DATER-BUFFER.
           03  DATER-VECTOR            PIC XX    VALUE "13".
           03  DATER-ACTION-CODE       PIC X     VALUE " ".
      * DO NOT CLEAR JULIAN-DATE ANYWHERE!!! CODE MUST STAY LIKE A15
      * THERE ARE ROUTINES THAT EXPECT BACK SPACES OR COMPILED DEFAULT
      * LIKE REBATE/SELECT-SP-ELAPSED-TIMTBL, WAS NOT GETTING ANY REBATES
           03  JULIAN-DATE             PIC  9(5).
           03  NUM-DATE                PIC  9(8)  VALUE 0.
           03  FILLER                 REDEFINES NUM-DATE.
               05 NUM-CCYY               PIC 9(4).
               05 NUM-CCYYX REDEFINES NUM-CCYY.
                  07  NUM-CC              PIC  9(2).  
                  07  NUM-YR              PIC  9(2).
               05  NUM-MO              PIC  9(2).
               05  NUM-DA              PIC  9(2).
           03  SYS-DATE                PIC  9(8)  VALUE 0.
           03  FILLER                 REDEFINES SYS-DATE.
               05 S-CCYY               PIC 9(4).
               05 S-CCYYX REDEFINES S-CCYY.
                  07  S-CC                PIC  9(2).
                  07  S-YY                PIC  9(2).
               05  S-MM                PIC  9(2).
               05  S-DD                PIC  9(2).
           03  NDTE-DATE               PIC  9(8)  VALUE 0.
           03  NDTE-DATE-WORK         REDEFINES NDTE-DATE
                                       PIC  9(8).
           03  FILLER                 REDEFINES NDTE-DATE.
               05 NDTE-CCYY            PIC 9(4).
               05 NDTE-CCYYX REDEFINES NDTE-CCYY.
                  07  NDTE-CC             PIC  9(2).
                  07  NDTE-YY             PIC  9(2).
               05  NDTE-MM             PIC  9(2).
               05  NDTE-DD             PIC  9(2).
           03  NDTE-HOLD               PIC S9(5) LEADING SEPARATE
                                                          VALUE 0.
           03  DATER-UNITPER-INFO.
               05  DATER-UNITPER-CD    PIC X              VALUE "M".
               05  DATER-UNITPER-FREQ  PIC  9(3)          VALUE 1.
           03  ELAPSED-YRTYPE          PIC  9(3)          VALUE 365.
           03  ELAPSED-MONTHS          PIC S9(7) COMP-3   VALUE 0.
           03  ELAPSED-DAYS            PIC S9(9) COMP-3   VALUE 0.
           03  ELAPSED-REM             PIC S9(7) COMP-3   VALUE 0.
           03  ELAPSED-UNITPER         PIC S9(9) COMP-3   VALUE 0.
           03  ELAPSED-UNITPER-REM     PIC S9(7) COMP-3   VALUE 0.

           03  ELAPSED-RESULTS         PIC X              VALUE " ".
               88  SYS-IS-EQ                              VALUE "E".
               88  SYS-IS-GE                              VALUE "E" "G".
               88  SYS-IS-GR                              VALUE "G".
               88  SYS-IS-GT                              VALUE "G".
               88  SYS-IS-LE                              VALUE "L" "E".
               88  SYS-IS-LT                              VALUE "L".
               88  SYS-IS-NE                              VALUE "L" "G".
               88  SYSDATE-EQ-NUMDATE                     VALUE "E".
               88  SYSDATE-GE-NUMDATE                     VALUE "E" "G".
               88  SYSDATE-GR-NUMDATE                     VALUE "G".
               88  SYSDATE-GT-NUMDATE                     VALUE "G".
               88  SYSDATE-LE-NUMDATE                     VALUE "L" "E".
               88  SYSDATE-LT-NUMDATE                     VALUE "L".
               88  SYSDATE-NE-NUMDATE                     VALUE "L" "G".

           03  DAY--OF-WEEK            PIC  9             VALUE 0.
               88  DAY-IS-SUN          VALUE 1.
               88  DAY-IS-MON          VALUE 2.
               88  DAY-IS-TUE          VALUE 3.
               88  DAY-IS-WED          VALUE 4.
               88  DAY-IS-THU          VALUE 5.
               88  DAY-IS-FRI          VALUE 6.
               88  DAY-IS-SAT          VALUE 7.
      *----------------------------------------------------------------
           03  SYS-FG                  PIC X(1).
           03  NUM-FG                  PIC X(1).
           03  NDTE-FG                  PIC X(1).

      *----------------------------------------------------------------
      *  GENERAL WORKERS FOR VERYANT COBOL VERSION OF DATER CALCULATION
      *----------------------------------------------------------------
      *COPY "LIBGB/DATERDYTOM.CPY".
      ************************************************
      *  VERYANT
      *
      *  DYTOM TABLE TO BE USED ON DATER ROUTINES
      *
      ************************************************
       01 WS-DYTOM.
          05 DYTOM-VALUES.
             10 FILLER     PIC 9(3) VALUE 0.
             10 FILLER     PIC 9(3) VALUE 31.
             10 FILLER     PIC 9(3) VALUE 59.
             10 FILLER     PIC 9(3) VALUE 90.
             10 FILLER     PIC 9(3) VALUE 120.
             10 FILLER     PIC 9(3) VALUE 151.
             10 FILLER     PIC 9(3) VALUE 181.
             10 FILLER     PIC 9(3) VALUE 212.
             10 FILLER     PIC 9(3) VALUE 243.
             10 FILLER     PIC 9(3) VALUE 273.
             10 FILLER     PIC 9(3) VALUE 304.
             10 FILLER     PIC 9(3) VALUE 334.
             10 FILLER     PIC 9(3) VALUE 365.
          05 FILLER REDEFINES DYTOM-VALUES.
             10 DYTOM OCCURS 13 TIMES PIC 9(3).
      ***************************************
      *
      * VERYANT
      * INCLUDE ALL COPYBOOSKS FOR COBOL
      * DATER RELATED ROUTINES
      *
      ***************************************
      *COPY "LIBGB/DATERJUL.CPY".
      *************************************************
      *
      *  VERYANT
      *  PARAMETERS FOR THE JUL ROUTINE
      *
      *************************************************
       01 P-JUL.
          05 P-DATE-IN     PIC 9(8).
          05 P-JULIAN-DATE PIC 9(7).

      *COPY "LIBGB/DATERCJUL.CPY".
      *************************************************
      *
      *  VERYANT
      *  PARAMETERS FOR THE CJUL ROUTINE
      *
      *************************************************
       01 P-CJUL.
          05 P-CJUL-JULIAN-DATE  PIC 9(7).
          05 P-CJUL-DATE-OUT     PIC 9(8).

      *----------------------------------------------------------------
      *  WORKERS FOR VERYANT COBOL VERSION OF DATER CALCULATION
      *----------------------------------------------------------------
       77 SV-DATER-ACTION-CODE PIC X.
       77 WS-MOD               PIC S9(2).
       77 WS-MOD-7             PIC S9(2).
       77 WS-MOD-2             PIC S9(2).
       77 WS-MOD-4             PIC S9(2).
       77 WS-MOD-12            PIC S9(2).
       77 WS-DIV-RESULT        PIC S9(4).
       77 WS-DIV-TMP           PIC S9(7).
      *77 WS-UP-WORK           PIC S9(3).
       77 WS-UP-WORK           PIC S9(4).
       77 WS-HOLD-DD           PIC S9(3).
       77 WS-HOLD-MOS          PIC S9(7).
       77 WS-JUL-WK            PIC 9(5).
       77 WS-JUL               PIC 9(9).
       77 WS-JUL-1             PIC 9(9).
       77 WS-JUL-2             PIC 9(9).
       77 WS-TMP-JUL-1         PIC 9(9).
       77 WS-TMP-JUL-2         PIC 9(9).
       77 WS-JUL-TMP           PIC 9(9).
       77 WS-HOLDJUL           PIC 9(9).
       77 WS-TIM-RESULTS       PIC X.
       77 SV-NUM-DATE          PIC 9(8).
       77 SV-SYS-DATE          PIC 9(8).
       77 WS-HOLDDATE          PIC 9(8).

       77 WS-XMONTHS           PIC S9(7).
       77 WS-XDAYS             PIC S9(9).
       77 WS-XREM              PIC S9(7).
       77 WS-XUNITPER          PIC S9(9).
       77 WS-XUNITPER-REM      PIC S9(7).
       77 WS-XUNITPER-FREQ     PIC S9(7).
       77 WS-XSIGN             PIC S9 VALUE 1.
       77 WS-XUNITPER-CODE     PIC X.

       77 WS-WORK              PIC S9(7).
       77 WS-TMP-WORK          PIC S9(7).

       01 DATER-HOLD-NDTE-DATE PIC  9(8)  VALUE 0.
       01 WS-NDTE-SIGN.
          05 WS-NDTE-MM-S      PIC S9(2).
          05 WS-NDTE-DD-S      PIC S9(2).
      *   05 WS-NDTE-YY-S      PIC S9(3).
          05 WS-NDTE-CCYY-S    PIC S9(5).

      * USED FOR C-DATE-TEST
       01 WS-NDTE              PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-NDTE.
          03  WS-NDTE-CCYY     PIC 9(4).
          03  FILLER REDEFINES WS-NDTE-CCYY.
              05 WS-NDTE-CC        PIC 9(2).
              05 WS-NDTE-YY        PIC 9(2).
          03 WS-NDTE-MM        PIC 9(2).
          88 WS-NDTE-MM-VALID  VALUE 1 THRU 12.
          03 WS-NDTE-DD        PIC 9(2).
          88 WS-NDTE-DD-VALID  VALUE 1 THRU 31.


       01 WS-DATE1             PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-DATE1.
          05 WS-DATE1-CCYY     PIC 9(4).
          05 WS-DATE1-CCYYX REDEFINES WS-DATE1-CCYY.
             07 WS-DATE1-CC       PIC 9(2).
             07 WS-DATE1-YY       PIC 9(2).
          05 WS-DATE1-MM       PIC 9(2).
          05 WS-DATE1-DD       PIC 9(2).

       01 WS-DATE2             PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-DATE2.
          05 WS-DATE2-CCYY     PIC 9(4).
          05 WS-DATE2-CCYYX REDEFINES WS-DATE2-CCYY.
             07 WS-DATE2-CC       PIC 9(2).
             07 WS-DATE2-YY       PIC 9(2).
          05 WS-DATE2-MM       PIC 9(2).
          05 WS-DATE2-DD       PIC 9(2).

       01 WS-DATE1W            PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-DATE1W.
          05 WS-DATE1W-CCYY    PIC 9(4).
          05 WS-DATE1W-CCYYX REDEFINES WS-DATE1W-CCYY.
             07 WS-DATE1W-CC   PIC 9(2).
             07 WS-DATE1W-YY   PIC 9(2).
          05 WS-DATE1W-MM      PIC 9(2).
          05 WS-DATE1W-DD      PIC 9(2).

       01 WS-DATE2W            PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-DATE2W.
          05 WS-DATE2W-CCYY    PIC 9(4).
          05 WS-DATE2W-CCYYX REDEFINES WS-DATE2W-CCYY.
             07 WS-DATE2W-CC   PIC 9(2).
             07 WS-DATE2W-YY   PIC 9(2).
          05 WS-DATE2W-MM      PIC 9(2).
          05 WS-DATE2W-DD      PIC 9(2).

       01 WS-DATEX             PIC 9(8) VALUE 0.
       01 FILLER REDEFINES WS-DATEX.
          05 WS-DATEX-CCYY     PIC 9(4).
          05 WS-DATEX-CCYYX REDEFINES WS-DATEX-CCYY.
             07 WS-DATEX-CC       PIC 9(2).
             07 WS-DATEX-YY       PIC 9(2).
          05 WS-DATEX-MM       PIC 9(2).
          05 WS-DATEX-DD       PIC 9(2).

       77 NOT-YEAR             PIC 9(3).
       77 TA-YRTYPE            PIC 9(3).
      *----------------------------------------------------------------
      *  WORKERS FOR VERYANT COBOL VERSION OF JUL CALCULATION
      *----------------------------------------------------------------
       77 JWS-EXTRA-DAY     PIC 9.
       77 JWS-MOD-JUL       PIC S9(2).
       77 JWS-DIV-RESULT    PIC S9(4).
       77 JWS-JUL-IN-CCYY   PIC 9(4).
       77 J-WS-JULIAN-DATE  PIC 9(7).
       01 JJUL-IN.
          05 JJUL-IN-CCYY PIC 9(4).
          05 FILLER REDEFINES JJUL-IN-CCYY.
             07 JJUL-IN-CC  PIC 9(2).
             07 JJUL-IN-YY  PIC 9(2).
          05 JJUL-IN-MM  PIC 9(2).
          05 JJUL-IN-DD  PIC 9(2).
      *----------------------------------------------------------------
      *  WORKERS FOR VERYANT COBOL VERSION OF CJUL CALCULATION
      *----------------------------------------------------------------
       77 CJWS-MOD-JUL       PIC S9(4).
       77 CJWS-DIV-RESULT    PIC S9(4).
       77 CJWS-JUL-BY4       PIC 9(9).
       77 CJWS-WORK          PIC 9.
       77 CJWS-MM            PIC 9(2).
       01 WS-CJUL-OUT        PIC 9(12) VALUE 0.
       01 FILLER REDEFINES WS-CJUL-OUT.
          05 WS-CJUL-OUT-CCYY PIC 9(4).
          05 FILLER REDEFINES WS-CJUL-OUT-CCYY.
             07 WS-CJUL-OUT-CC  PIC 9(2).
             07 WS-CJUL-OUT-YY  PIC 9(2).
          05 WS-CJUL-OUT-MM  PIC 9(4).
          05 WS-CJUL-OUT-DD  PIC 9(4).

       01 CJUL-IN         PIC 9(9).
       01 CJUL-OUT        PIC 9(8) VALUE 0.
       01 FILLER REDEFINES CJUL-OUT.
          05 CJUL-OUT-CC  PIC 9(2).
          05 CJUL-OUT-YY  PIC 9(2).
          05 CJUL-OUT-MM  PIC 9(2).
          05 CJUL-OUT-DD  PIC 9(2).
      *----------------------------------------------------------------
      *  WORKERS FOR VERYANT COBOL VERSION OF NEWDATE CALCULATION
      *----------------------------------------------------------------
       01 ND-WS-NDTE          PIC 9(8) VALUE 0.
       01 FILLER REDEFINES ND-WS-NDTE.
          05 ND-WS-NDTE-CCYY  PIC 9(4).
      *   05 ND-WS-NDTE-YY    PIC 9(2).
          05 ND-WS-NDTE-MM    PIC 9(2).
          05 ND-WS-NDTE-DD    PIC 9(2).
       77 ND-WS-DIV-RESULT    PIC S9(4).
       77 ND-WS-MOD-4         PIC S9(2).

       01  ALP-DATE-EDIT           PIC 99/99/99.
       01  UNITPER-MASK-DATE      REDEFINES ALP-DATE-EDIT.
           03  FILLER              PIC X(5).
           03  DATER-UNITPER-IT    PIC X.
           03  FILLER              PIC XX.

       01  ELAPSED-MMREM-FG        PIC X.
       01  ELAPSED-COUNT           PIC  9     COMP.
       01  CALL-DATE               PIC 9(8) VALUE ZEROS.
       01  FILLER REDEFINES CALL-DATE.
           03  CALL-CC             PIC  99.
           03  CALL-YY             PIC  99.
           03  CALL-MM             PIC  99.
           03  CALL-DD             PIC  99.
       01  ALP-DATE.
           03  ALP-MO              PIC  99.
           03  FILLER              PIC X      VALUE "/".
           03  ALP-DA              PIC  99.
           03  FILLER              PIC X      VALUE "/".
           03  ALP-YR              PIC  99.
       01  DTE-HOLD                PIC  99999 COMP.

       01  HOLD-UNITPER-INFO       PIC X(4).

      * 20151110 ADDED FOR DATE CONVERSION SECTIONS.
       01  CONVERT-DATE            PIC 9(8).
       01  CONVERT-DATEX REDEFINES CONVERT-DATE.
           03  CONVERT-DATE-CC     PIC 9(2).
           03  CONVERT-DATE-YY     PIC 9(2).
           03  CONVERT-DATE-MM     PIC 9(2).
           03  CONVERT-DATE-DD     PIC 9(2).

      ************************************************************
      *01  JULIAN-BEG              PIC 9(8)   COMP  VALUE 19500101.
      *01  JULIAN-END              PIC 9(8)   COMP  VALUE 20491231.
      *01  JULIAN-CC               PIC 9(2)   COMP  VALUE 50.
       01  JULIAN-WORKER           PIC 9(4)   COMP  VALUE 0.
       01  JULIAN-WORKER2          PIC 9(4)   COMP  VALUE 0.
       01  JULIAN-WK               PIC 9            VALUE 0.

       01  LEAP-YEAR-CCYY          PIC 9(4).
       01  LEAP-YEAR-FG            PIC X(1) VALUE "F".
       88  LEAP-YEAR-TRUE          VALUE "T".
       88  LEAP-YEAR-FALSE         VALUE "F".

      *=================================================================
      *    YEAR 2000 FORMAT --- 'MMDDYYYY' OR 'YYYYMMDD'
      *=================================================================
       01  DATE-MMDDYY                           PIC 9(06) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-MMDDYY.
           03  DATE-MMDDYY-MM                    PIC 9(02).
           03  DATE-MMDDYY-DD                    PIC 9(02).
           03  DATE-MMDDYY-YY                    PIC 9(02).

       01  DATE-MMDDYYYY                         PIC 9(08) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-MMDDYYYY.
           03  DATE-MMDDYYYY-MM                  PIC 9(02).
           03  DATE-MMDDYYYY-DD                  PIC 9(02).
           03  DATE-MMDDYYYY-YYYY                PIC 9(04).
           03  DATE-MMDDYYYY-CCYY      REDEFINES DATE-MMDDYYYY-YYYY.
               05  DATE-MMDDYYYY-CC              PIC 9(02).
               05  DATE-MMDDYYYY-YY              PIC 9(02).

       01  DATE-DDMMYYYY                         PIC 9(08) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-DDMMYYYY.
           03  DATE-DDMMYYYY-DD                  PIC 9(02).
           03  DATE-DDMMYYYY-MM                  PIC 9(02).
           03  DATE-DDMMYYYY-YYYY                PIC 9(04).
           03  DATE-DDMMYYYY-CCYY      REDEFINES DATE-DDMMYYYY-YYYY.
               05  DATE-DDMMYYYY-CC              PIC 9(02).
               05  DATE-DDMMYYYY-YY              PIC 9(02).

       01  DATE-MMSDDSYY                         PIC X(08) VALUE SPACES.
       01  FILLER                      REDEFINES DATE-MMSDDSYY.
           03  DATE-MMSDDSYY-MM                  PIC 9(02).
           03  DATE-MMSDDSYY-S1                  PIC X(01).
           03  DATE-MMSDDSYY-DD                  PIC 9(02).
           03  DATE-MMSDDSYY-S2                  PIC X(01).
           03  DATE-MMSDDSYY-YY                  PIC 9(02).

       01  DATE-MMSDDSYYYY                       PIC X(10) VALUE SPACES.
       01  FILLER                      REDEFINES DATE-MMSDDSYYYY.
           03  DATE-MMSDDSYYYY-MM                PIC 9(02).
           03  DATE-MMSDDSYYYY-S1                PIC X(01).
           03  DATE-MMSDDSYYYY-DD                PIC 9(02).
           03  DATE-MMSDDSYYYY-S2                PIC X(01).
           03  DATE-MMSDDSYYYY-YYYY              PIC 9(04).
           03  DATE-MMSDDSYYYY-CCYY    REDEFINES DATE-MMSDDSYYYY-YYYY.
               05  DATE-MMSDDSYYYY-CC            PIC 9(02).
               05  DATE-MMSDDSYYYY-YY            PIC 9(02).

       01  DATE-MMSYY                            PIC X(05) VALUE SPACES.
       01  FILLER                      REDEFINES DATE-MMSYY.
           03  DATE-MMSYY-MM                     PIC 9(02).
           03  DATE-MMSYY-S1                     PIC X(01).
           03  DATE-MMSYY-YY                     PIC 9(02).

       01  DATE-MMSYYYY                          PIC X(07) VALUE SPACES.
       01  FILLER                      REDEFINES DATE-MMSYYYY.
           03  DATE-MMSYYYY-MM                   PIC 9(02).
           03  DATE-MMSYYYY-S1                   PIC X(01).
           03  DATE-MMSYYYY-YYYY                 PIC 9(04).
           03  DATE-MMSYYYY-CCYY        REDEFINES DATE-MMSYYYY-YYYY.
               05  DATE-MMSYYYY-CC               PIC 9(02).
               05  DATE-MMSYYYY-YY               PIC 9(02).

       01  DATE-MMYY                             PIC 9(04) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-MMYY.
           03  DATE-MMYY-MM                      PIC 9(02).
           03  DATE-MMYY-YY                      PIC 9(02).

       01  DATE-MMYYY                            PIC 9(05) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-MMYYY.
           03  DATE-MMYYY-MM                     PIC 9(02).
           03  DATE-MMYYY-YYY                    PIC 9(03).

       01  DATE-MMYYYY                           PIC 9(06) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-MMYYYY.
           03  DATE-MMYYYY-MM                    PIC 9(02).
           03  DATE-MMYYYY-YYYY                  PIC 9(04).
           03  DATE-MMYYYY-CCYY        REDEFINES DATE-MMYYYY-YYYY.
               05  DATE-MMYYYY-CC                PIC 9(02).
               05  DATE-MMYYYY-YY                PIC 9(02).

       01  DATE-YYMM                             PIC 9(04) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-YYMM.
           03  DATE-YYMM-YY                      PIC 9(02).
           03  DATE-YYMM-MM                      PIC 9(02).

       01  DATE-YYMMDD                           PIC 9(06) VALUE ZEROES.
       01  DATE-YYMMDD-ALP                       REDEFINES DATE-YYMMDD.
           03  DATE-YYMMDD-YY                    PIC 9(02).
           03  DATE-YYMMDD-MM                    PIC 9(02).
           03  DATE-YYMMDD-DD                    PIC 9(02).

       01  DATE-DDMMYY                           PIC 9(06) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-DDMMYY.
           03  DATE-DDMMYY-DD                    PIC 9(02).
           03  DATE-DDMMYY-MM                    PIC 9(02).
           03  DATE-DDMMYY-YY                    PIC 9(02).

       01  DATE-YYYMM                            PIC 9(05) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-YYYMM.
           03  DATE-YYYMM-YYY                    PIC 9(03).
           03  DATE-YYYMM-MM                     PIC 9(02).

       01  DATE-YYYMMDD                          PIC 9(07) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-YYYMMDD.
           03  DATE-YYYMMDD-YYY                  PIC 9(03).
           03  DATE-YYYMMDD-MM                   PIC 9(02).
           03  DATE-YYYMMDD-DD                   PIC 9(02).

       01  DATE-YYYYMM                           PIC 9(06) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-YYYYMM.
           03  DATE-YYYYMM-YYYY                  PIC 9(04).
           03  DATE-YYYYMM-CCYY        REDEFINES DATE-YYYYMM-YYYY.
               05  DATE-YYYYMM-CC                PIC 9(02).
               05  DATE-YYYYMM-YY                PIC 9(02).
           03  DATE-YYYYMM-MM                    PIC 9(02).

       01  DATE-YYYYMMDD                         PIC 9(08) VALUE ZEROES.
       01  FILLER                      REDEFINES DATE-YYYYMMDD.
           03  DATE-YYYYMMDD-YYYY                PIC 9(04).
           03  DATE-YYYYMMDD-CCYY      REDEFINES DATE-YYYYMMDD-YYYY.
               05  DATE-YYYYMMDD-CC              PIC 9(02).
               05  DATE-YYYYMMDD-YY              PIC 9(02).
           03  DATE-YYYYMMDD-MM                  PIC 9(02).
           03  DATE-YYYYMMDD-DD                  PIC 9(02).


      *-----------------------------------------------------{ DATE-ONE }
       01  DATE-ONE                                           PIC 9(08).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-MMDDYY-RDF                       REDEFINES DATE-ONE.
           03  DATE-ONE-MMDDYY                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-ONE-MMDDYY.
               05  DATE-ONE-MMDDYY-MM                         PIC 9(02).
               05  DATE-ONE-MMDDYY-DD                         PIC 9(02).
               05  DATE-ONE-MMDDYY-YY                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-MMDDYYYY-RDF                     REDEFINES DATE-ONE.
           03  DATE-ONE-MMDDYYYY                              PIC 9(08).
           03  FILLER                                REDEFINES
                                                      DATE-ONE-MMDDYYYY.
               05  DATE-ONE-MMDDYYYY-MM                       PIC 9(02).
               05  DATE-ONE-MMDDYYYY-DD                       PIC 9(02).
               05  DATE-ONE-MMDDYYYY-YYYY                     PIC 9(04).
               05  DATE-ONE-MMDDYYYY-CCYY            REDEFINES
                                                 DATE-ONE-MMDDYYYY-YYYY.
                   07  DATE-ONE-MMDDYYYY-CC                   PIC 9(02).
                   07  DATE-ONE-MMDDYYYY-YY                   PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-MMYY-RDF                         REDEFINES DATE-ONE.
           03  DATE-ONE-MMYY                                  PIC 9(04).
           03  FILLER                                REDEFINES
                                                          DATE-ONE-MMYY.
               05  DATE-ONE-MMYY-MM                           PIC 9(02).
               05  DATE-ONE-MMYY-YY                           PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-MMYYY-RDF                        REDEFINES DATE-ONE.
           03  DATE-ONE-MMYYY                                 PIC 9(05).
           03  FILLER                                REDEFINES
                                                         DATE-ONE-MMYYY.
               05  DATE-ONE-MMYYY-MM                          PIC 9(02).
               05  DATE-ONE-MMYYY-YYY                         PIC 9(03).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-MMYYYY-RDF                       REDEFINES DATE-ONE.
           03  DATE-ONE-MMYYYY                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-ONE-MMYYYY.
               05  DATE-ONE-MMYYYY-MM                         PIC 9(02).
               05  DATE-ONE-MMYYYY-YYYY                       PIC 9(04).
               05  DATE-ONE-MMYYYY-CCYY              REDEFINES
                                                   DATE-ONE-MMYYYY-YYYY.
                   07  DATE-ONE-MMYYYY-CC                     PIC 9(02).
                   07  DATE-ONE-MMYYYY-YY                     PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYMM-RDF                         REDEFINES DATE-ONE.
           03  DATE-ONE-YYMM                                  PIC 9(04).
           03  FILLER                                REDEFINES
                                                          DATE-ONE-YYMM.
               05  DATE-ONE-YYMM-YY                           PIC 9(02).
               05  DATE-ONE-YYMM-MM                           PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYMMDD-RDF                       REDEFINES DATE-ONE.
           03  DATE-ONE-YYMMDD                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-ONE-YYMMDD.
               05  DATE-ONE-YYMMDD-YY                         PIC 9(02).
               05  DATE-ONE-YYMMDD-MM                         PIC 9(02).
               05  DATE-ONE-YYMMDD-DD                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYYMM-RDF                        REDEFINES DATE-ONE.
           03  DATE-ONE-YYYMM                                 PIC 9(05).
           03  FILLER                                REDEFINES
                                                         DATE-ONE-YYYMM.
               05  DATE-ONE-YYYMM-YYY                         PIC 9(03).
               05  DATE-ONE-YYYMM-MM                          PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYYMMDD-RDF                      REDEFINES DATE-ONE.
           03  DATE-ONE-YYYMMDD                               PIC 9(07).
           03  FILLER                                REDEFINES
                                                       DATE-ONE-YYYMMDD.
               05  DATE-ONE-YYYMMDD-YYY                       PIC 9(03).
               05  DATE-ONE-YYYMMDD-MM                        PIC 9(02).
               05  DATE-ONE-YYYMMDD-DD                        PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYYYMM-RDF                       REDEFINES DATE-ONE.
           03  DATE-ONE-YYYYMM                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-ONE-YYYYMM.
               05  DATE-ONE-YYYYMM-YYYY                       PIC 9(04).
               05  DATE-ONE-YYYYMM-CCYY              REDEFINES
                                                   DATE-ONE-YYYYMM-YYYY.
                   07  DATE-ONE-YYYYMM-CC                     PIC 9(02).
                   07  DATE-ONE-YYYYMM-YY                     PIC 9(02).
               05  DATE-ONE-YYYYMM-MM                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-ONE-YYYYMMDD-RDF                     REDEFINES DATE-ONE.
           03  DATE-ONE-YYYYMMDD                              PIC 9(08).
           03  FILLER                                REDEFINES
                                                      DATE-ONE-YYYYMMDD.
               05  DATE-ONE-YYYYMMDD-YYYY                     PIC 9(04).
               05  DATE-ONE-YYYYMMDD-CCYY            REDEFINES
                                                 DATE-ONE-YYYYMMDD-YYYY.
                   07  DATE-ONE-YYYYMMDD-CC                   PIC 9(02).
                   07  DATE-ONE-YYYYMMDD-YY                   PIC 9(02).
               05  DATE-ONE-YYYYMMDD-MM                       PIC 9(02).
               05  DATE-ONE-YYYYMMDD-DD                       PIC 9(02).

      *-----------------------------------------------------{ DATE-TWO }
       01  DATE-TWO                                           PIC 9(08).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-MMDDYY-RDF                       REDEFINES DATE-TWO.
           03  DATE-TWO-MMDDYY                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-TWO-MMDDYY.
               05  DATE-TWO-MMDDYY-MM                         PIC 9(02).
               05  DATE-TWO-MMDDYY-DD                         PIC 9(02).
               05  DATE-TWO-MMDDYY-YY                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-MMDDYYYY-RDF                     REDEFINES DATE-TWO.
           03  DATE-TWO-MMDDYYYY                              PIC 9(08).
           03  FILLER                                REDEFINES
                                                      DATE-TWO-MMDDYYYY.
               05  DATE-TWO-MMDDYYYY-MM                       PIC 9(02).
               05  DATE-TWO-MMDDYYYY-DD                       PIC 9(02).
               05  DATE-TWO-MMDDYYYY-YYYY                     PIC 9(04).
               05  DATE-TWO-MMDDYYYY-CCYY            REDEFINES
                                                 DATE-TWO-MMDDYYYY-YYYY.
                   07  DATE-TWO-MMDDYYYY-CC                   PIC 9(02).
                   07  DATE-TWO-MMDDYYYY-YY                   PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-MMYY-RDF                         REDEFINES DATE-TWO.
           03  DATE-TWO-MMYY                                  PIC 9(04).
           03  FILLER                                REDEFINES
                                                          DATE-TWO-MMYY.
               05  DATE-TWO-MMYY-MM                           PIC 9(02).
               05  DATE-TWO-MMYY-YY                           PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-MMYYY-RDF                        REDEFINES DATE-TWO.
           03  DATE-TWO-MMYYY                                 PIC 9(05).
           03  FILLER                                REDEFINES
                                                         DATE-TWO-MMYYY.
               05  DATE-TWO-MMYYY-MM                          PIC 9(02).
               05  DATE-TWO-MMYYY-YYY                         PIC 9(03).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-MMYYYY-RDF                       REDEFINES DATE-TWO.
           03  DATE-TWO-MMYYYY                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-TWO-MMYYYY.
               05  DATE-TWO-MMYYYY-MM                         PIC 9(02).
               05  DATE-TWO-MMYYYY-YYYY                       PIC 9(04).
               05  DATE-TWO-MMYYYY-CCYY              REDEFINES
                                                   DATE-TWO-MMYYYY-YYYY.
                   07  DATE-TWO-MMYYYY-CC                     PIC 9(02).
                   07  DATE-TWO-MMYYYY-YY                     PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYMM-RDF                         REDEFINES DATE-TWO.
           03  DATE-TWO-YYMM                                  PIC 9(04).
           03  FILLER                                REDEFINES
                                                          DATE-TWO-YYMM.
               05  DATE-TWO-YYMM-YY                           PIC 9(02).
               05  DATE-TWO-YYMM-MM                           PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYMMDD-RDF                       REDEFINES DATE-TWO.
           03  DATE-TWO-YYMMDD                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-TWO-YYMMDD.
               05  DATE-TWO-YYMMDD-YY                         PIC 9(02).
               05  DATE-TWO-YYMMDD-MM                         PIC 9(02).
               05  DATE-TWO-YYMMDD-DD                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYYMM-RDF                        REDEFINES DATE-TWO.
           03  DATE-TWO-YYYMM                                 PIC 9(05).
           03  FILLER                                REDEFINES
                                                         DATE-TWO-YYYMM.
               05  DATE-TWO-YYYMM-YYY                         PIC 9(03).
               05  DATE-TWO-YYYMM-MM                          PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYYMMDD-RDF                      REDEFINES DATE-TWO.
           03  DATE-TWO-YYYMMDD                               PIC 9(07).
           03  FILLER                                REDEFINES
                                                       DATE-TWO-YYYMMDD.
               05  DATE-TWO-YYYMMDD-YYY                       PIC 9(03).
               05  DATE-TWO-YYYMMDD-MM                        PIC 9(02).
               05  DATE-TWO-YYYMMDD-DD                        PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYYYMM-RDF                       REDEFINES DATE-TWO.
           03  DATE-TWO-YYYYMM                                PIC 9(06).
           03  FILLER                                REDEFINES
                                                        DATE-TWO-YYYYMM.
               05  DATE-TWO-YYYYMM-YYYY                       PIC 9(04).
               05  DATE-TWO-YYYYMM-CCYY              REDEFINES
                                                   DATE-TWO-YYYYMM-YYYY.
                   07  DATE-TWO-YYYYMM-CC                     PIC 9(02).
                   07  DATE-TWO-YYYYMM-YY                     PIC 9(02).
               05  DATE-TWO-YYYYMM-MM                         PIC 9(02).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  DATE-TWO-YYYYMMDD-RDF                     REDEFINES DATE-TWO.
           03  DATE-TWO-YYYYMMDD                              PIC 9(08).
           03  FILLER                                REDEFINES
                                                      DATE-TWO-YYYYMMDD.
               05  DATE-TWO-YYYYMMDD-YYYY                     PIC 9(04).
               05  DATE-TWO-YYYYMMDD-CCYY            REDEFINES
                                                 DATE-TWO-YYYYMMDD-YYYY.
                   07  DATE-TWO-YYYYMMDD-CC                   PIC 9(02).
                   07  DATE-TWO-YYYYMMDD-YY                   PIC 9(02).
               05  DATE-TWO-YYYYMMDD-MM                       PIC 9(02).
               05  DATE-TWO-YYYYMMDD-DD                       PIC 9(02).

      *================================================================*
      * END COPYBOOK: LIBGB\DATERW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\SETCTBLW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/SETCTBLW

      ***************************************************************
      *                      SETCTBLW
      *          SET INDEX INTO SPR RATE TABLES WORKERS
      *
      * REV :
      ***************************************************************
      * INPUT FIELDS:
       01  CTBL-TERM                PIC S9(3)    COMP.
       01  CTBL-INT-CHARGEABLE      PIC S9(7)V99 COMP.

       01  CTBL-WORKER              PIC 9.
      * OUTPUT FIELDS:
       01  CTBL-INDEX               PIC 9.
      *================================================================*
      * END COPYBOOK: LIBLP\SETCTBLW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\TIMEWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/TIMEWK
      ******************************************************************
      *                (TIMEWK)
      *    TIME DISPLAY WORKERS
      *
      *=================================================================
      * REV:
      * JTG 020594 ADDED TIME-MILITARY-FG
      * BLV 000911 CHANGED TIME-ZONE-FACTOR FROM S9 TO S99
      *
      * JKC 2020-1026 ADDED TIMER_LNK.CPY; USED FOR GB/TIMER.CBL
      *
      * SMR 2024-0401 ADDED TIMER-BEG-DATE TO BE USED FOR CALCULATING
      *          THE ELAPSED TIME IF THE END TIME CROSS OVER TO A NEW
      *          DAY.
      *
      ******************************************************************
       01  TIME-NOW.
           03  CUR-HH          PIC 99.
           03  CUR-MM          PIC 99.
           03  CUR-SS          PIC 99.
           03  CUR-HD          PIC 99.
       01  TIME-NOW2           REDEFINES TIME-NOW.
           03  H-AND-M         PIC 9(4).
           03  FILLER          PIC 9(4).
       01  TIME-NOW3           REDEFINES TIME-NOW.
           03  HH-MM-SS        PIC 9(6).
           03  FILLER          PIC 9(2).
       01  TIME-EDIT.
           03  T-HH            PIC 99.
           03  T-COL           PIC X.
           03  T-MM            PIC 99.
           03  T-SPACE         PIC X.
           03  T-AMPM          PIC XX.
       01  TIME-MILITARY-FG    PIC X    VALUE " ".
       01  SIGNED-HH           PIC S99.
       01  TIME-ZONE-FACTOR    PIC S99.

      * ****NOTE**** ****NOTE**** ****NOTE**** ****NOTE**** ****NOTE****
      * TIMER-LINK-BUF IS AN EXACT COPY IN LIBGB/PRU_LNK.CPY
      * TIMER-LINK-BUF IS AN EXACT COPY IN LIBGB/TIMER_LNK.CPY
      * ANY CHANGE HERE MUST BE MADE IN THE OTHER COPY MEMBERS!!!!!
      * ****NOTE**** ****NOTE**** ****NOTE**** ****NOTE**** ****NOTE****
       01  TIMER-LINK-BUF.
           03  TIMER-STAT                  PIC X(02).
           03  TIMER-BEG-DATE              PIC 9(08).
           03  TIMER-DAYSEC-BEG            PIC 99V9(7).
           03  TIMER-DAYSEC-END            PIC 99V9(7).
           03  TIMER-DAYSEC-ELAPSED        PIC 99V9(7).
           03  TIMER-BEG-EDIT.
               05  TIMER-BEG-HHMMSS        PIC 99/99/99.
               05  FILLER                  PIC X(01).
               05  TIMER-BEG-AMPM          PIC X(02).
           03  TIMER-END-EDIT.
               05  TIMER-END-HHMMSS        PIC 99/99/99.
               05  FILLER                  PIC X(01).
               05  TIMER-END-AMPM          PIC X(02).
           03  TIMER-ELAPSED-EDIT          PIC 99/99/99/99.
           03  TIMER-TYPE                  PIC X(1).
               88  TIMER-TYPE-EXCEL        VALUE "E".
               88  TIMER-TYPE-REPORT       VALUE "R".
               88  TIMER-TYPE-UTILITY      VALUE "U".
               88  TIMER-TYPE-VALID        VALUE "E" "R" "U".

      *================================================================*
      * END COPYBOOK: LIBGB\TIMEWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\REBATEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/REBATEW

      **************************************************************************
      *    REBATE CALCULATION WORKERS
      *
      * REV:
      *  022388 JTG ADDED REB-DEDCHG FIELD
      *  042888 BAW ADDED REB-AHSUB, REB-HUNDREDS
      *             AND REB-MANYDECIMALS FOR FORMULA 8
      *  042988 JPN ADDED REB-LPTRCD, REB-HALF-ORGTERM
      *  062188 JTG INCREASED PERCISION ON MPRATE
      *  102188 JTG ADDED FORM-PATH FOR ALLOWING CALLS
      *             FROM WITHIN REBATE ROUTINE.
      *  121388 JTG ADDED WORKER FOR IOWA
      *  011789 JTG CHANGE ELAPSED-REM TO S9(5)V9(10)
      *  022889 JTG CHANGE CALL WORKERS TENNESSEE DEF REB
      *  041989 JTG ADDED WORKERS FOR FRMLA - F (IDEAL)
      *  051089 JTG CJANGED WORKERS TO COMP
      *  072789 JTG ADDED REB-INSSUB FOR IDEAL (MA)
      *  100489 JTG ADDED REB-SWING FOR IDEAL FORMULA F
      *  102489 JTG ADDED REB-STATEWK FOR (GA) FRMLA H
      *                   REB-STATEWK2
      *  021690 JTG ADDED REB-DEFSUB = 10
      *  042690 JTG ADDED REB-TRIGGER-DATE (SP-RBEARLY = 8) PACESETTER
      *  052990 JTG ADDED CALL WORKERS INDIANA DEF REB
      *  080990 JTG ADDED FIELDS FOR ADDON INS.
      *  121090 SLC ADDED REB-RECAST.
      *  012191 JTG ADDED REB-WORK2 RE: MULLEN ADDONS.
      *  052191 JTG ADDED REB-HOLD-ORGTERM (PACESETTER) SP-RBEARLY = 8
      *  123091 JTG ADDED REB-PRES-VALUE (EDDIE GOLDSTICKER) SP-ERNFRMLA = 11
      *  071392 JTG ADDED B01-FRMLA & B01-PAY-SCHLD-FG
      *                   FOR TENNEESSEE DEFERMENT REBATE
      *                   (COLONIAL, TN) ADDON/PAYMENT SCHEDULES
      *  082092 JTG ADDED REB-DONT-STOP & B01-DONT-STOP (COLONIAL, TN)
      *  082292 JTG ADDED REB-LN-PAYFREQ, REB-LN-APRATE, REB-LN-ORGTERM,
      *                   REB-LN-1STPYAMT, REB-LN-REGPYAMT
      *  090192 BAH CHANGED REB-DONT-STOP TO REB-DEF-STOP
      *             ONLY STOP IN INQUIRIES AND POST
      *  090292 JTG ADDED FIELDS FOR SP-RBFRMLA = 'T'
      *  012293 JTG ADDED REB-UPR-WHOLE FOR TIME FINANCE (CA)
      *                    TO BE USED WITH REFUND FORMULA 'L'
      *  090193 JTG MOVED REB-REMTERM TO AN OUTPUT FIELD
      *  021095 JTG ADDED FIELDS FOR SP-RBFRMLA = 'S' TIME LOAN, CA CL REFUND
      *  112495 JTG ADDED REBT02, FOR SP-RBEARLY = 13, MERCURY 'NV'
      *             PP REFUND ACTION 8
      *  010995 JTG ADDED REBF-ADJ, 360/350 ADJUSTMENT FACTOR RE: RBFRMLA = 'F'
      *  021497 BAH ADDED A01-PAYDATE FOR REBA01
      *  051997 JTG ADDED REB-SP1-KEY, RE: 'ADDONSPR'
      *  092697 JTG ADDED REB-LN-LASTPYAMT/REB-LN-SMPRATE FOR ACTUARIAL ADDON RB
      *  021098 JTG ADDED REB-EARN-FULL-MONTH TFC, MERCURY #637
      *  022699 BAH ADDED REB-HALF-ORGTERM-DEC FOR 9999.04 (WORLD, #201)
      *
      *  000523 KEC {PR#00000} MERCURY FINANCE [CINDY SHAFFER];
      *              ADDED 'B02-DEF-STOP' FOR THE PURPOSE OF NOT
      *              ALLOWING THE 'SEND-MESS' WITHIN CL/REBB02.C FROM
      *              HAPPENING SO THAT MERCURY CAN HAVE THEIR CUSTOMER
      *              STATEMENTS TO WORK (NOT STOPPING IN BATCH).
      *  JTG 020219 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *            ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *            ADDED INS-TAX                                  WORLD #288
      *  JTG 020402 CHANGED INS-TAX TO INS-TAX-RB                 WORLD #288
      *  JTG 020930 ADDED NEW SHORT RATE FORMULA SP-RBEARLY = 24 (PP)    TFC #96
      *  JTG 030305 ALLOW RBFRMLA '8' TO WORK FOR 'AH' & 'ALL COMPUTABLE INS'
      *                                                         PACESETTER #2012
      *  JTG 030710 NEW INTEREST REFUND FORMULA (0 9) STATE OF TEXAS BASED
      *             ON DAILY INTEREST USING 365 DAYS AND SIMPLE      EXCEL #2111
      *  JTG 040608 ADDED NEW SP-RBFRMLA (0 C) SHORT RATE FORMULA   MULLEN #2302
      *  JTG 040917 ADDED NEW FIELDS FOR SP-RBFRMLA (0 D)
      *             RULE 78THS USING DAYS IN TERM AND ELAPSED DAYS INSTEAD
      *             OF UNIT PERIODS IN TERM AND ELAPSE UNIT PERIODS
      *             ADDED 'REB-LN-INSEFF' & 'REB-LN-INSEXP'
      *             ALSO ADDED SP-RBSPOPT2 = 11 NEW ROUNDING OPTION TO
      *             TAKE COMPUTED REBATE AND ROUNDED UP OR DOWN TO
      *             WHOLE DOLLARS ADDED 'REB-REBATE-CENTS'          REGACC #0074
      *  JTG 041102 ADDED ALAMAMA REFUND FRMLA ACTUARIAL (0 E)      WORLD  #J050
      *   CS 050520 ADDED REBTX-STEP, REBTX-RATE-BAL, REBTX-RATE-AMT
      *             NEW SP-RBFRMLA2 = "H" [REGIONAL MGMT PR#2527]
      *  JTG 050708 ADDED REB-LN-INT-REBATE REB-LN-SC-REBATE REB-LN-MF-REBATE
      *             REB-LN-DF-REBATE
      *             ADDED NEW FORMULAS FOR MEXICO
      *             SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  CS  060203 ADDED FOR PEOPLES... NO ROUND TO WHOLE DOLLAR PEOPLE #2670
      *             REBX-DAILY-COST-NO-ROUND,REBX-EARNED-COST-NO-ROUND
      *             REBX-PRO-RATA-REFUND-NO-ROUND,REBX-SHORT-RATE-REFUND-NO-ROUN
      *  JTG 071030 NEW INSURANCE REFUND FORMULA (0 I) FOR CPI POLICYS
      *             WHICH ARE ALWAYS 1 (ONE) YEAR TERMS          CITIZENS #3097
      *  BAH 150914 ADDED REB-SP-CONTRFRMLA TO HOLD ORIGINAL SPR VALUE, ADDONS
      *             READ THEIR OWN SPR THEN READ THE ORIGINAL AND THE
      *             SP-CONTRFRMLA COULD HAVE BEEN CHANGED IN CRNO, AMACC PL#901
      *  MJD 160122 ADDED REB-EP54-AMT. THIS IS THE AMOUNT OF THE SERVICE CHARGE
      *             THAT IS THE GEORGIA 4% CLOSING FEE EARLY PROVISION CALCED 
      *             CALCULATED IN REBATE-EP54                       REGMGT #4915
      *  MJD 160511 ADDED REB-LT-ADDON-FG,,REB-TEST-LT-TYPE AND 
      *             REB-HOLD-LNORIG1STPAY,REB-HOLD-LT-REC             71105#0918
      *   CS 160909 CHANGED REB-SP1-KEY FROM PIC X(8) TO PIC X(9)
      *  BAH 161025 CHANGED ALL DATES TO 9(8)
      *
      * KEC 2017.0307 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          CHANGED, WITHIN REB-B01, B01-FRMLA FROM 1 TO 2 BYTES
      *          SO THAT B01-FRMLA MATCHES SP-RBFRMLA.
      *
      * KEC 2017.0519 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          CHANGED REB-HOLD-LTI-REC FROM BEING HARDCODED
      *          [PIC X(400)] TO USE LTI-SIZE.  AFTER CHECKING,
      *          ALL PROGRAMS THAT DO NOT USE LIBGB/REBATE (WHICH USES
      *          LTI-REC) DOES USE LIBLP/LPRATE (ALSO USES LTI-REC)
      *          AND USES THE LTI-FILE (FS/FD/WS) OR HAS THE LAYOUT
      *          (LP01LTI).
      *
      * BAH 2018.07.02 REMOVED REB-SP-FLAG, REB-SP1-KEY, REB-SP-CONTRFRMLA
      *                CREATE ADDONSPRW FOR THESE FIELDS, ONLY USED IN
      *                FIND-ADDON-SPR, WHICH IS A COPY MEMBER ADDONSPR
      * BAH 2024.0321 REMOVED REBF-ADJ, REBP1, REBN-1, REBPV, REBTX-CALC-INT-X,
      *               REBTX-NEW-INT,
      **************************************************************************
      * INPUT FIELDS:
       01  REB-PAYDATE            PIC 9(8)     COMP    VALUE 0.
       01  REB-ORGTERM            PIC S9(5)    COMP    VALUE 0.
       01  REB-SUB                PIC 99       COMP    VALUE 0.
       01  REB-TOTCHG             PIC S9(6)V99 COMP    VALUE 0.
       01  REB-LPTRCD             PIC XX               VALUE " ".
       01  REB-SKIPDEF-FG         PIC X                VALUE " ".
       01  REB-ADDON-FG           PIC X                VALUE " ".
       01  REB-RECAST             PIC X                VALUE " ".
       01  REB-DEF-STOP           PIC X                VALUE " ".
       01  REB-EARN-FULL-MONTH    PIC X                VALUE " ".

      * INPUT FIELDS FOR ADDON INSURANCE:
       01  REB-LN-PURDATE         PIC 9(8)     COMP    VALUE 0.
       01  REB-LN-LOANDATE        PIC 9(8)     COMP    VALUE 0.
       01  REB-LN-INTDATE         PIC 9(8)     COMP    VALUE 0.
       01  REB-LN-ORIG-1STPYDATE     PIC 9(8)     COMP    VALUE 0.
       01  REB-LN-TOTNODEF        PIC S9(3)    COMP    VALUE 0.
       01  REB-LN-INSCOVR         PIC 9(6)V99  COMP    VALUE 0.
       01  REB-LN-SALEFIN         PIC X                VALUE " ".
       01  REB-LN-INSEFF          PIC 9(8)     COMP    VALUE 0.
       01  REB-LN-INSEXP          PIC 9(8)     COMP    VALUE 0.

       01  REB-LN-APRATE          PIC 9(3)V9(3) COMP   VALUE 0.
       01  REB-LN-SMPRATE         PIC 9(3)V9(3) COMP   VALUE 0.
       01  REB-LN-ORGTERM         PIC 9(3)      COMP   VALUE 0.
       01  REB-LN-1STPYAMT        PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-REGPYAMT        PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-LASTPYAMT       PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-INT-REBATE      PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-SC-REBATE       PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-MF-REBATE       PIC 9(6)V99   COMP   VALUE 0.
       01  REB-LN-DF-REBATE       PIC 9(6)V99   COMP   VALUE 0.

      * OUTPUT WORKERS:
       01  REB-REBATE             PIC S9(7)V99.
       01  FILLER                REDEFINES REB-REBATE.
           03  REB-REBATE-WHOLE   PIC S9(7).
           03  REB-REBATE-CENTS   PIC 99.
       01  REB-PRES-VALUE         PIC S9(7)V99    COMP.
       01  REB-REMTERM            PIC S9(5)       COMP.
       01  REB-MS-PENALTY         PIC S9(5)V99    COMP.
       01  INS-TAX-RB             PIC S9(7)V99    COMP.
       01  REB-EP54-AMT           PIC S9(7)V99    COMP.

      * INTERNAL WORKERS:
       01  REB-REFDATE            PIC 9(8)        COMP.
       01  REB-TRIGGER-DATE       PIC 9(8)        COMP.
       01  REB-HOLD-RBDTE         PIC X           VALUE " ".
       01  REB-DEDCHG             PIC S9(5)V99    COMP.
       01  REB-MPRATE             PIC 9(3)V9(10)  COMP.
       01  REB-FACTOR             PIC 9(3)V9(10)  COMP.
       01  REB-PRATE              PIC 9(3)V9(10)  COMP.
       01  REB-BAL                PIC S9(6)V9(9)  COMP.
       01  REB-INT                PIC 9(6)V99     COMP.
       01  REB-SUMORG             PIC S9(8)V9(8)  COMP.
       01  REB-SUMREM             PIC S9(8)V9(8)  COMP.
       01  REB-HOLD-ORGTERM       PIC S9(5)       COMP.
       01  REB-ELAPSED-MONTHS     PIC S9(5)       COMP.
       01  REB-ELAPSED-REM        PIC S9(5)V9(10) COMP.
       01  REB-ELAPSED-DAYS       PIC S9(5)       COMP.
       01  REB-SWING              PIC X           VALUE " ".
       01  REB-EARN-FOR-1MON      PIC S9(5)V99    COMP.
       01  REB-PRORATA-30DAY-PCT  PIC 9V999       COMP.
       01  REB-UNUSED-EXTDAYS     PIC S9(5)       COMP.
       01  REB-TOTAL-EXTDAYS      PIC S9(5)       COMP.
       01  REB-INTSUB             PIC 99          COMP VALUE 7.
       01  REB-DEFSUB             PIC 99          COMP VALUE 10.
       01  REB-AHSUB              PIC 9           COMP VALUE 5.
       01  REB-INSSUB             PIC 99          COMP VALUE 0.
       01  REB-SUB2               PIC 99          COMP.
           88  PODATE-B4-1STPYDATE                     VALUE 1.
       01  REB-HUNDREDS           PIC 9(5)V99     COMP.
       01  REB-MANYDECIMALS       PIC 9(5)V9(4)   COMP.
       01  REB-HALF-ORGTERM       PIC S9(5)       COMP.
       01  REB-HALF-ORGTERM-DEC   PIC S9(5)V99    COMP.
       01  REB-WORKER             PIC S9(7)V99    COMP.
       01  REB-WORK2              PIC S9(7)V99    COMP.
       01  REB-STATEWK            PIC S9(7)V99    COMP.
       01  REB-STATEWK2           PIC S9(7)V99    COMP.

       01  REBWK1                 PIC S999V9(15)  COMP.
       01  REBWK2                 PIC S999V9(15)  COMP.
       01  REBAN-M-1              PIC S999V9(15)  COMP.
       01  REBAN-M-1-T            PIC S999V9(15)  COMP.
       01  REBF                   PIC S9V9(15)    COMP.
       01  REBN                   PIC S999        COMP.
       01  REBM                   PIC S999        COMP.
       01  REBR                   PIC S999        COMP.
       01  REBN-M                 PIC S999        COMP.
       01  REBAN                  PIC S999V9(15)  COMP.
       01  REBAN-M                PIC S999V9(15)  COMP.
       01  REBAN-MPLUSR           PIC S999V9(15)  COMP.
       01  REBM-1                 PIC S999        COMP.
       01  REBM-T                 PIC S999        COMP.
       01  REBT                   PIC S999        COMP.
       01  REBP                   PIC S9(6)V99    COMP.
       01  REBI1                  PIC S999V9(15)  COMP.
       01  REBJ                   PIC S999V9(15)  COMP.
       01  REBJ1                  PIC S999V9(15)  COMP.
       01  REBI                   PIC S999V9(15)  COMP.
       01  REB-RCF1               REDEFINES REBI
                                  PIC S999V9(15)  COMP.
       01  REBADJ                 PIC S999V9(15)  COMP.
       01  REB-RCF                REDEFINES REBADJ
                                  PIC S999V9(15)  COMP.
       01  REBPW                  PIC S999V9(15)  COMP.
       01  REB-WFAC               REDEFINES REBPW
                                  PIC S999V9(15)  COMP.

       01  REB-UPR                PIC S9(7)V9999  COMP.
       01  REB-UPR-WHOLE          PIC S9(7)       COMP.

       01  REB-A--P-J             PIC S99999V9(13) COMP.
       01  REB-A--P-I             PIC S99999V9(13) COMP.
       01  REB-WK                 PIC S9(6)V9(11)  COMP.

       01  REBTX-CALC-INT-TOT     PIC S9(6)V99     COMP.
       01  REBTX-CALC-INT         PIC S9(6)V99     COMP.
       01  REBTX-AMTFIN           PIC S9(6)V99     COMP.
       01  REBTX-PYAMT            PIC S9(6)V99     COMP.
       01  REBTX-SERCHG-SLICE     PIC S9(6)V9(3)   COMP.
       01  REBTX-FROM-DATE        PIC 9(8)         COMP.
       01  REBTX-TO-DATE          PIC 9(8)         COMP.
       01  REBTX-RATE-BAL         PIC S9(6)V99     COMP.
       01  REBTX-RATE-AMT         PIC S9(6)V99     COMP.
       01  REBTX-STEP             PIC 9.     
      *----------------------------------------------------------
      * FIELDS USED IN 'LIBLP/ADDONSPR'
      *01  REB-SP-FLAG            PIC X           VALUE " ".
      *01  REB-SP1-KEY            PIC X(9).
      *01  REB-SP-CONTRFRMLA      PIC X           VALUE " ".
       
      * FIELDS USED FOR SP-RBDTE = "D"
       01  REB-LTI-ADDON-FG       PIC X.
       88  REB-LTI-ADDON-NOT-FOUND VALUE "N".
       01  REB-TEST-LTI-TYPE      PIC 99 COMP-3.
       01  REB-HOLD-LNORIG1STPAY  PIC 9(8) COMP-3.
       01  REB-HOLD-LTI-REC       PIC X(LTI-SIZE).

      ***********************************************************************
      *    A R E A  FOR PROGRAM WORKERS THAT GET REDEFINED TO GIVE
      *    NAMES THAT MAKE SENSE FOR THE ROUTINE.
      *
      *   'REBX' FIELDS ARE PREFIXED WITH REBX TO REFLECT THEY ARE REDEFINED
      ***********************************************************************
       01  REBX-REDEFINED-FIELDS.
           03  REBX-DAYS-IN-TERM         PIC S9(5)    COMP.
           03  REBX-DAYS-IN-FORCE        PIC S9(5)    COMP.
           03  REBX-DAYS-REMAINING       PIC S9(5)    COMP.
           03  REBX-EARNED-COST          PIC S9(7)    COMP.
           03  REBX-SHORT-RATE-REFUND    PIC S9(7)    COMP.

           03  REBX-INS-POLICY-FEE       PIC S9(7)V99 COMP.
           03  REBX-NET-CONTRACT-COST    PIC S9(7)V99 COMP.
           03  REBX-DAILY-COST           PIC S9(7)V99 COMP.
           03  REBX-PRO-RATA-REFUND      PIC S9(7)V99 COMP.
      *USED BY PEOPLE NO ROUND TO WHOLE DOLLARS
           03  REBX-DAILY-COST-NO-ROUND  PIC S9(7)V9(7) COMP.
           03  REBX-EARNED-COST-NO-ROUND PIC S9(7)V9(7) COMP.
           03  REBX-PRO-RATA-REFUND-NO-ROUND PIC S9(7)V9(7) COMP.
           03  REBX-SHORT-RATE-REFUND-NO-ROUND    PIC S9(7)V99.
      *    03  REBX-UNUSED
      *-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --

      * FIELDS USED FOR CALLING SUBPROGRAMS:
       01  REB-FORM-PATH.
           03  FILLER                 PIC X(6)     VALUE "CL/REB".
           03  REB-FORM-PROG-TYPE     PIC X.
           03  REB-FORM-PROG-NO       PIC 99.
       01  REB-CANCEL-FG              PIC X        VALUE "Y".
       01  REB-COMMON.
           03  REB-COMMON-RTNCD       PIC X        VALUE SPACES.
           03  REB-COMMON-REBATE      PIC S9(7)V99 COMP-3 VALUE 0.
           03  REB-COMMON-AREA        PIC X(40)    VALUE SPACES.
           03  FILLER REDEFINES REB-COMMON-AREA.
               05  REB-COMMON-PAYDATE PIC 9(8).
               05  FILLER             PIC X(32).

      * USED FOR MISSISSIPPI REDUCTION CODE:
           03  REB-A01                REDEFINES REB-COMMON-AREA.
               05  A01-ELAPSED-MO     PIC S9(3)    COMP-3.
               05  A01-MS-PENALTY     PIC S9(5)V99 COMP-3.
               05  A01-PAYDATE        PIC 9(8)     COMP-3.
               05  FILLER             PIC X(29).
      * USED FOR TENNESSEE DEFERMENT REBATE FORMULA:
           03  REB-B01                REDEFINES REB-COMMON-AREA.
               05  B01-PAYDATE        PIC 9(8)     COMP-3.
               05  B01-FRMLA          PIC X(2).
               05  B01-PAY-SCHLD-FG   PIC X.
               05  B01-DEF-STOP       PIC X.
               05  FILLER             PIC X(31).
      * USED FOR INDIANA DEFERMENT REBATE FORMULA:
           03  REB-B02                REDEFINES REB-COMMON-AREA.
               05  B02-PAYDATE        PIC 9(8)     COMP-3.
               05  B02-DEF-STOP       PIC X.
               05  FILLER             PIC X(34).
      * USED FOR SP-RBFRMLA = 'T', TABLE REFUND FORMULA:
           03  REB-T01                REDEFINES REB-COMMON-AREA.
               05  T01-TBL-NO         PIC 99.
               05  T01-ORGTERM        PIC 9(3).
               05  T01-ELAPSED-DAYS   PIC S9(4).
               05  T01-ELAPSED-MONTHS PIC S9(4).
               05  T01-REFUND-RATE    PIC 999V9.
               05  FILLER             PIC X(23).
      * USED FOR SP-RBRBEARLY = 13 TABLE REFUND FORMULA
      * MERCURY 'NV', PER PROPERTY REFUND ACTION 8:
           03  REB-T02                REDEFINES REB-COMMON-AREA.
               05  T02-ELAPSED-DAYS   PIC S9(5).
               05  T02-INSTERM        PIC 9(5).
               05  FILLER             PIC X(30).

      * NEW SHORT RATE FORMULA SP-RBEARLY = 24 (PP)    TFC #96
           03  REB-T04                REDEFINES REB-COMMON-AREA.
               05  T04-ELAPSED-DAYS   PIC S9(5).
               05  FILLER             PIC X(35).

           03  REB-IRREBT             REDEFINES REB-COMMON-AREA.
               05  IRREBT-REMTERM     PIC S9(5).
               05  IRREBT-INSSUB      PIC 99.
               05  IRREBT-MANYDECIMALS PIC 9(5)V9(4).
               05  FILLER             PIC X(23).
      *================================================================*
      * END COPYBOOK: LIBGB\REBATEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPOFFW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPOFFW
      *-------------------------------------------------------------------------
      *             (LPPOFFW)
      *       PAYOFF ROUTINE WORKERS
      *
      * NOTE:
      *       THIS COPY MEMBER IS USED AS AN ARGUMENT IN A NUMBER OF CALLS.
      *       SO IF NEW FIELDS ARE ADDED, PUT THEM IN THE FILLER AREAS.
      *
      * REV:
      *  JTG 051089 CHANGED WORKERS TO COMP.
      *  BAH 090192 ADDED POFF-DEF-STOP-MESS FOR
      *             COLONIAL DEFERMENTS MESSAGE
      *  BAH 120392 ADDED POFF-RECAST-MESS FOR COSMO
      *             RECASTING TO ONLY DISPLAY MESSAGES
      *             WHEN TRULY RECASTING, NOT IN REPORTS
      *  JTG 022593 ADDED POFF-LPTRCD TO REFLECT PAYOFF TYPE
      *  MJD 051597 ADDED POFF-INT-REB-TBL. REFLECTS INTEREST REBATED FOR
      *             EACH INSURANCE TYPE.
      *  MJD 052097 ADDED A LEVEL TO POFF-INT-REB-TBL FOR FEES.
      *  JTG 060397 ADDED A LEVEL TO POFF-REBATE FOR 'O3' REBATE + 'O4'&'O5'
      *  JTG 061897 ADDED POFF-INSEFF-TEST & POFF-INSEXP-TEST TO BE USED
      *             BY LONPG7.C TO ISOLATE ADDON RECORDS PART OF CANCEL
      *             ADDED POFF-RTNCD WHICH IS TESTED IN LIBLP/LPPOF2 RE:LONPG7.C
      *  JTG 010598 ADDED POFF-RECAST-FG RE: IDEAL A48 TO A60
      *  JTG 072898 ADDED POFF-O2DUE RE: RENEWAL O2 MONIES MERCURY #192
      *  MJD 000119 ADDED POFF-NOLCHG (WORLD PR#218)
      *             NOT YET USED. MUST BE ENABLED BEFORE WORLD GOES TO A15
      *  JTG 020219 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *             ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *             ADDED LOGIC FOR INS-TAX                       WORLD #288
      *  JTG 020328 ADDED FILLER AREAS FOR FUTURE ADDITIONS TO THIS COPY
      *             MEMBER. THIS COPY MEMBER IS USED IN A NUMBER OF CALLS
      *             AND IS PASSED.                                WORLD #288
      *  JTG 020402 CHANGED POFF-INS-TAX TO POFF-INS-TAX-RB       WORLD #288
      *  JTG 020801 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *  JTG 021220 ADDED POFF-LCAP-BATCH-REFCD POFF-LCAP-BATCH-REFCD-LC-FG
      *             ADDED NEW CODE FILE TYPE 'BR'-BATCH PAYMENT REFERENCE CODES
      *             BATCH PAYMENT REVISIONS                        REGACC #0006
      * MJD 160223 ADDED POFF-LXR-REB-AMT FOR GA EARLY PROVISION  REGMGT PR#4915
      *             THIS IS THE AMOUNT OF THE SERVICE CHARGE THAT
      *             IS THE GEORGIA 4% CLOSING FEE EARLY PROVISION CALCULATED 
      *             IN REBATE-EP54 (LIBGB/REBATE).
      *             THIS IS INCLUDED IN THE SERVICE CHARGE 
      *             REBATE BUT NEEDS TO BE BROKEN OUT ON CERTAIN CONTRACTS. 
      *             IT WILL BE STORED HERE IF NOT = 0
      *-------------------------------------------------------------------------
       01  POFF-WORKERS.

      * INPUT FIELDS:
           03  POFF-PAYDATE                PIC 9(8) COMP-3.
           03  POFF-MAKERCD                PIC X.
           03  POFF-LONPFA-UPD-FG          PIC X.
           03  POFF-DEF-STOP               PIC X.
           03  POFF-LPTRCD                 PIC XX.

           03  POFF-INSEFF-TEST            PIC 9(8) COMP-3 VALUE 0.
           03  POFF-INSEXP-TEST            PIC 9(8) COMP-3 VALUE 0.
           03  POFF-RECAST-FG              PIC X           VALUE " ".
           03  POFF-LCAP-BATCH-REFCD       PIC X(5)        VALUE " ".
           03  POFF-LCAP-BATCH-REFCD-LC-FG PIC X           VALUE " ".
           03  FILLER                      PIC X(25).

      * OUTPUT FIELDS:
           03  POFF-REBATE          OCCURS 13
                                     PIC S9(7)V99   COMP-3.
           03  POFF-INS-TAX-RB      OCCURS 8
                                     PIC S9(7)V99   COMP-3.
           03  POFF-OTDUE            PIC S9(7)V99   COMP-3.
           03  POFF-O2DUE            PIC S9(7)V99   COMP-3.
           03  POFF-LCDUE            PIC S9(7)V99   COMP-3.
           03  POFF-INTDUE           PIC S9(7)V99   COMP-3.
           03  POFF-NETDUE           PIC S9(7)V99   COMP-3 VALUE 0.
           03  POFF-PARTIALS         PIC S9(7)V99   COMP-3.
           03  POFF-LCPAID           PIC S9(7)V99   COMP-3.
           03  POFF-ADDON-INT-EARNED PIC S9(7)V99   COMP-3.
           03  POFF-ADDON-INT-REBATE PIC S9(7)V99   COMP-3.
           03  POFF-INT-REB-TABLE.
               05  POFF-INT-REB-TBL OCCURS 9
                                     PIC S9(7)V99   COMP-3.
           03  POFF-INT-REB-TBLX    REDEFINES POFF-INT-REB-TABLE.
               05  POFF-CL-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-AH-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-PP-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-O1-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-O2-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-O3-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-O4-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-O5-INT-REB   PIC S9(7)V99   COMP-3.
               05  POFF-FEES-INT-REB PIC S9(7)V99   COMP-3.
           03  POFF-NOLCHG                PIC S9(3)      COMP-3.
           03  POFF-LXM-MIP-CLPAID        PIC S9(7)V99   COMP-3.
           03  POFF-LXM-MIP-CLPDTH-DATE   PIC 9(8)       COMP-3.
           03  POFF-LXM-MIP-AHPAID        PIC S9(7)V99   COMP-3.
           03  POFF-LXM-MIP-AHPDTH-DATE   PIC 9(8)       COMP-3.
           03  POFF-LXR-REB-AMT           PIC S9(7)V99   COMP-3.
           03  FILLER                     PIC X(25).

      * WORKERS:
           03  POFF-SUB              PIC S99.
           03  POFF-ONE              PIC S9.
           03  POFF-SP-DISFRMLA      PIC X.
           03  POFF-RTNCD            PIC X.
           03  POFF-CLPREM-CHG-FG    PIC X.
           03  POFF-AHPREM-CHG-FG    PIC X.

      * FIELDS USED FOR CALLING SUBPROGRAMS:
           03  POFF-FORM-PATH.
               05  POFF-FORM-PROG          PIC X(8).
               05  POFF-FORM-PROG-NO       PIC X.
           03  POFF-COMMON.
               05  POFF-COMMON-RTNCD       PIC X.
               05  POFF-COMMON-INTADJ      PIC S9(7)V99 COMP.
               05  POFF-COMMON-AREA.
                   07  POFF-COMMON-PAYDATE PIC 9(8)     COMP.
                   07  POFF-ORIG-INTDUE    PIC S9(7)V99 COMP.
                   07  POFF-RECAST-MESS    PIC X.
                   07  FILLER              PIC X(6).
           03  FILLER                      PIC X(28).
      *================================================================*
      * END COPYBOOK: LIBLP\LPPOFFW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\ADDONSPRW.CPY                           *
      *================================================================*
      ***************************************************************
      *  FIND ADDON SPR WORKERS
      * REV:
      *  2018.07.02 BAH CREATED TO REMOVE THESE WORKERS FROM REBATEW
      ***************************************************************
       01  ADDONSPR-SUB                PIC 99          VALUE 0.
       01  ADDONSPR-SP-FLAG            PIC X           VALUE SPACES.
       01  ADDONSPR-SP1-KEY            PIC X(9)        VALUE SPACES.
       01  ADDONSPR-SP-CONTRFRMLA      PIC X           VALUE SPACES.
      *================================================================*
      * END COPYBOOK: LIBLP\ADDONSPRW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\AGEINGW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/AGEINGW
      **************************************************************************
      *    AGEING          AGEING CALCULATION WORKERS
      * REV:
      *  JTG 051189 CHANGED WORKERS TO COMP
      *  JTG 040490 ADDED RDSUB, RECDEL, CSUB-ALDEL-FG
      *             AGEING-HOLD-SUB & AGEING-HOLD-AGEING
      *  JTG 062194 ADDED RDPOT30, CPOT30
      *  SLC 051895 ADDED AGEING-TOTPAYMNTD-SV
      *  JTG 072295 REDEFINED AGEING-DATE RE: MO/DA/YR
      *             ADDED CPOTCHGOFF & RDPOTCHGOFF
      *  MJD 071596 ADDED AGEING-HOLD-REMAIN FOR SP-BANKUNITPER-CD = "A"
      *  JTG 082897 ADDED AGEING-PERCENT-FACTOR FOR SP-BANKUNITPER-CD = "D"
      *  JTG 092297 ADDED AGEING-HOLD-REMAIN2 FOR SP-BANKUNITPER-CD = 'D'
      *  JTG 092497 ADDED AGEING-SKIP-CON-REC-FG WORLD A90
      *  JTG 022498 ADDED AGEING-NO-TOBE-PAID, AGEING-NO-PAID, AGEING-WK-DATE
      *             CHANGED SP-BANKUNITPER-CD = 'A' & 'D', INSTANT AUTO
      *             TO DETERMINE EXACT PAYMENT REQUIREMENT FOR A GIVEN
      *             MONTH. EX. WEEKLY, JUL 5 PAYMENTS, AUG 4 PAYMENTS
      *  JTG 990311 ADDED OUTPUT OF TFC 'CTFC-NM' TABLE INDEX
      *  MJD 110525 ADDED AGEING-SUB-WORKER/REMAIN FOR SP-BANKRULE = "F" #752
      *  BLM 170309 CHANGED AGEING-DATE TO BE YYYYMMDD, PD0006
      **************************************************************************
       01  AGEING-WORKERS.
      * YYYYMMDD
           03  AGEING-DATE            PIC 9(8).
      * FIELDS FOR COMPUTE-RECDEL:
           03  RDSUB                  PIC S9(6)      COMP.
           03  RECDEL                 PIC S9(5)      COMP.
           03  RDPOT30                PIC X          VALUE " ".
           03  RDPOTCHGOFF            PIC X          VALUE " ".
      * FIELDS FOR COMPUTE RECENCY:
           03  RSUB                   PIC S9(6)      COMP.
           03  RECENCY                PIC S9(5)      COMP.
      * FIELDS FOR COMPUTE-CONTRACTUAL:
           03  CSUB                   PIC S9(6)      COMP.
           03  CONTRACTUAL            PIC S9(5)      COMP.
           03  CPOT30                 PIC X          VALUE " ".
           03  CPOTCHGOFF             PIC X          VALUE " ".
           03  CSUB-ALDEL-FG          PIC X          VALUE " ".
           03  CTFC-NM                PIC S9(6)      COMP.
      * FIELDS FOR COMPUTE-PAID-AHEAD:
           03  PSUB                   PIC S9(6)      COMP.
      * AGEING WORK FIELDS:
           03  AGEING-HOLD            PIC S9(5)      COMP.
           03  AGEING-WORK            PIC S9(7)V9(9) COMP.
           03  AGEING-TOTPAYMNTD-SV   PIC S9(7)V99   COMP.
           03  AGEING-HOLD-REMAIN     PIC V9(12)     COMP.
           03  AGEING-PERCENT-FACTOR  PIC 9(3)V9(3)  COMP.
           03  AGEING-HOLD-CONTPDTH   PIC 9(4)       COMP.
           03  AGEING-NO-TOBE-PAID    PIC S9(4)      COMP.
           03  AGEING-NO-PAID         PIC S9(4)      COMP.
           03  AGEING-WK-DATE         PIC 9(8)       COMP.
           03  AGEING-SUB-WORKER      PIC S9(6)     COMP.
           03  AGEING-SUB-REMAIN      PIC 9(6)      COMP.
       01  AGEING-E-1STPYAMT     PIC S9(7)V99 COMP.
       01  AGEING-E-REGPYAMT     PIC S9(7)V99 COMP.
       01  AGEING-E-LASTPYAMT    PIC S9(7)V99 COMP.
      *================================================================*
      * END COPYBOOK: LIBGB\AGEINGW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPUPWKW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPUPWKW
      ***************************************************************
      *    LPUPWKW
      *    ESTABLISHED LOAN RELATED UNIT PERIOD WORKERS
      * REV:
      ***************************************************************
       01  UPWK-WORK-AREA.
           03  UPWK-OUTPUT-AREA.
               05  UPWK-UNITPER-WK         PIC 9(3)V9(13)  COMP-3.
               05  UPWK-UNITPER-CONTR-WK   PIC 9(4)V9(12)  COMP-3.
               05  UPWK-LC-GRACE-FAC       PIC 9(3)V9(13)  COMP-3.
               05  UPWK-LC-MIN-FAC         PIC 9(3)V9(13)  COMP-3.
               05  UPWK-LC-MAX-FAC         PIC 9(3)V9(13)  COMP-3.
               05  UPWK-LC-PER-FAC         PIC 9(3)V9(13)  COMP-3.
               05  UPWK-ERRCD              PIC XX.
               05  UPWK-UNITPER-PER-YEAR   PIC 9(3)V9(9)   COMP-3.
               05  UPWK-DAYS-IN-UNITPER    PIC 9(3)        COMP-3.

           03  UPWK-INPUT-AREA.
               05  UPWK-UNITPER-CD         PIC X.
               05  UPWK-UNITPER-FREQ       PIC 9(3)        COMP-3.
      *================================================================*
      * END COPYBOOK: LIBLP\LPUPWKW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPCEPPW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPCEPPW
      *---------------------------------------------------
      *    CONTRACTUAL ELPASED PAY PERIODS CALCULATION
      *
      *       NOTE: DON'T REMOVE INITIAL VALUE FROM
      *             CEPP-NOCAP-FG & CEPP-INCDEF-FG
      *             AND CEPP-INCALDEL-FG WITHOUT CHANGING
      *             LPCEPP.IN.C LOGIC.
      * REV:
      *  JTG 051089 CHANGED WORKER TO COMP
      *  JTG 040990 ADDED CEPP-INCALDEL-FG FOR PACESETTER
      *  JTG 071696 ADDED CEPP-UNITPER-REM (CAC, FL)
      *  BLM 170309 CHANGE CEPP1-DATE & CEPP2-DATE TO BE
      *             CCYYMMDD, PR # PD0006
      *---------------------------------------------------
       01  CEPP-DATE-WORKERS.
           03  CEPP1-DATE         PIC 9(8).
           03  FILLER            REDEFINES CEPP1-DATE.
               05  CEPP1-CC       PIC 99.
               05  CEPP1-YR       PIC 99.
               05  CEPP1-MO       PIC 99.
               05  CEPP1-DA       PIC 99.
           03  CEPP2-DATE         PIC 9(8).
           03  FILLER            REDEFINES CEPP2-DATE.
               05  CEPP2-CC       PIC 99.
               05  CEPP2-YR       PIC 99.
               05  CEPP2-MO       PIC 99.
               05  CEPP2-DA       PIC 99.
           03  CEPP-PERIODS       PIC S9(5)   COMP.
           03  CEPP-UNITPER-REM   PIC S9(3)   COMP.
           03  CEPP-MAKERCD       PIC X.
           03  CEPP-NOCAP-FG      PIC X       VALUE " ".
           03  CEPP-INCDEF-FG     PIC X       VALUE " ".
           03  CEPP-INCALDEL-FG   PIC X       VALUE " ".
      *================================================================*
      * END COPYBOOK: LIBLP\LPCEPPW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAMTSW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAMTSW
      *******************************************************************
      *    LOAN CALCULATION WORKERS      (LPAMTSW)
      *REV:
      * JTG 051089 CHANGED WORKERS TO COMP
      * JTG 020896 CHANGED LPAMTS-INSUR TO NONMEMO-INS
      *                    LPAMTS-FEES  TO NONMEMO-FEES
      * JTG 073197 ADDED TOTAL-INSFINCHG, TOTAL-FEEFINCHG, WORLD A90
      * BAH 022398 ADDED INSUR-OURS , FEES-OURS, FFG DISC FRMLA PR# 653
      * JTG 990727 ADDED CREDIT-LIMIT FOR LIBWI/LNAPPROVAL RE: REVOLVING
      * JTG 020219 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *            ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *            ADDED TOTAL-INS-TAX                                WORLD #288
      *  JTG 020620 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *            ADDED TOTAL-INSPREM-NONMEMO FOR LPAPRS MUST HAVE NON MEMOS
      *  MJD 160823 ADDED GET-LIVECHECK-FEES TO CALCULATE THE AMOUNT OF FEES
      *             FROM LIVE CHECKS THAT NEED TO BE INCLUDED IN
      *             HIGH-CREDIT/LN-CREDITLIM                          61000/1180
      **************************************************************************
       01  AMT-WORKERS.
           03  TOTAL-REPAY      PIC S9(7)V99    COMP.
           03  TOTAL-NOTE       PIC S9(7)V99    COMP.
           03  PRINCIPLE        PIC S9(7)V99    COMP.
           03  ADJ-PRINCIPAL    PIC S9(7)V99    COMP.
           03  CASH-ADVANCE     PIC S9(7)V99    COMP.
           03  SPCASH-ADVANCE   PIC S9(7)V99    COMP.
           03  FINANCED-AMOUNT  PIC S9(7)V99    COMP.
           03  DISCLOSED-FINAMT PIC S9(7)V99    COMP.
           03  HIGH-CREDIT      PIC 9(6)        COMP.
           03  CREDIT-LIMIT     PIC 9(6)        COMP.
           03  INT-CHARGEABLE   PIC S9(7)V99    COMP.
           03  NONMEMO-INS      PIC S9(7)V99    COMP.
           03  NONMEMO-FEES     PIC S9(7)V99    COMP.
           03  LPAMTS-SUB       PIC S9(5)       COMP.
           03  TOTAL-INSPREM-NONMEMO PIC S9(7)V99 COMP.
           03  TOTAL-INSFINCHG  PIC S9(7)V99    COMP.
           03  TOTAL-INS-TAX    PIC S9(7)V99    COMP.
           03  TOTAL-FEEFINCHG  PIC S9(7)V99    COMP.
           03  INSUR-OURS       PIC S9(7)V99    COMP.
           03  FEES-OURS        PIC S9(7)V99    COMP.
           03  LIVE-CHECK-FEES  PIC S9(7)V99    COMP.

       01  LPAMTSW-FEECODE      PIC XX.
       01  LPAMTSW-FEECODEX REDEFINES LPAMTSW-FEECODE.
           03  LPAMTSW-FEECODE-CH1  PIC X.
               88  LPAMTSW-FEECODE-CH1-NUMERIC
                              VALUE '1' '2' '3' '4' '5'
                                    '6' '7' '8' '9' '0'.
           03  FILLER               PIC X.
      *================================================================*
      * END COPYBOOK: LIBLP\LPAMTSW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPDUEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPDUEW
      *--------------------------------------------------------
      *    PAST DUE DAYS WORKERS
      * REV:
      *  JTG 051089 CHANGED FIELDS TO WORKERS
      *  JTG 040495 ADDED PDUE-1STPYDA, RE: PROBLEMS WITH FEB
      *  BAH 170313 FIX REDEFINES OF PDUE-1STPYDATE
      *--------------------------------------------------------
       01  PDUE-WORKERS.
      * CCYYMMDD
           03  PDUE-1STPYDATE     PIC 9(8).
           03  FILLER REDEFINES PDUE-1STPYDATE.
               05  FILLER         PIC 99.
               05  FILLER         PIC 99.
               05  FILLER         PIC 99.
               05  PDUE-1STPYDA   PIC 99.
           03  PDUE-TODAY-DATE    PIC 9(8)    COMP.
           03  PDUE-DAYS          PIC S9(5)   COMP.
      *================================================================*
      * END COPYBOOK: LIBLP\LPPDUEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\DEFPOLW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/DEFPOLW
      *--------------------------------------------------------
      *          (LIBLP/DEFPOLW)
      *    DEFERMENT POLICY TEST WORKERS
      * REV:
      *--------------------------------------------------------
      * INPUT:
       01  DEFPOL-TRCD         PIC XX.
       01  DEFPOL-DATE         PIC 9(8) COMP.
      * OUTPUT:
       01  DEFPOL-MAXIMUM      PIC X.
      * WORKERS:
       01  DEFPOL-WORKER.
           03  FILLER          PIC X.
           03  DEFPOL-FTST     PIC X.
           03  DEFPOL-NODF    REDEFINES DEFPOL-FTST
                               PIC 9.
           03  DEFPOL-LP-REC   PIC X(LP-SIZE).
      *================================================================*
      * END COPYBOOK: LIBLP\DEFPOLW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAPRSW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAPRSW
      **************************************************************************
      *                     (LPAPRSW)
      *    CALCULATION WORKERS FOR
      *    EQUIVELANT SIMPLE AND EFFECTIVE INTEREST RATE
      *
      *REV:
      * JTG 062288 ADDED INTCHGABLE AND REGPYAMT
      * JTG 051089 CHANGED WORKERS TO COMP
      * JTG 080889 ADDED APRS-CTBL
      * JTG 043093 REMOVED APRS-DISFRMLA
      * JTG 060493 ADDED APRS-ODDPYAMT-ADJ, APRS-LASTPYAMT-ADJ
      * JTG 100998 REMOVED APRS-ODDPYAMT-ADJ AND CHANGED  APRS-LASTPYAMT-ADJ
      *            TO APRS-PYAMT-ADJ
      * JTG 030430 CREATED FORMULA 12 LIKE 2 BUT SPREADS EXTENSION CHARGE
      *            OVER PAYMENTS  88  SP-PYEXFRMLA-SAME2-SPREAD VALUE 12.
      *             ADDED APRS-SPREAD APRS-REM                   CITIZENS #2006
      **************************************************************************
      * INPUT AREA:

      * OUTPUT AREA:
       01  APRS-SMPRATE           PIC S999V999    COMP.
       01  APRS-EFFRATE           PIC S999V999    COMP.
       01  APRS-CTBL              PIC 9.
      * THESE FIELDS USED ON ACTUARIAL REBATE:
       01  APRS-INTCHGABLE        PIC S9(7)V99    COMP.
       01  APRS-REGPYAMT          PIC S9(6)V9(9)  COMP.

      * WORK AREA:
       01  APRS-PYAMT-ADJ         PIC S9(6)V99    COMP.
       01  APRS-SPREAD            PIC 9(6)V99     COMP.
       01  APRS-REM               PIC 9(6)V99     COMP.

      *================================================================*
      * END COPYBOOK: LIBLP\LPAPRSW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAPRZW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAPRZW
      **************************************************************************
      *    LPAPRZW
      *    APR CALCULATION WORKERS
      * REV:
      *  JTG 041690 ADDED APR-METHOD FOR U.S. RULE
      *                 VALUES: A - ACTUARIAL
      *                         U - U.S. RULE
      *  JTG 060590 ADDED APR-SPAY-FG (PACESETER) SINGLE PAYS
      *  JTG 120691 ADDED UNITPERIOD FIELDS
      *  JTG 121291 ADDED APR-LASTPYAMT APR-DISFRMLA
      *  JTG 052193 CHANGED APR-NOREGPY TO APR-ORGTERM
      *             REMOVED APR-NOODDPY
      *  JTG 100998 ALLOWED  APR-FINANCED, APR-REGPYAMT, APR-1STPYAMT
      *             AND APR-1ST-PAYMENT TO BE NEGATIVE TO HANDLE SMALL
      *             PAYMENT STREAMS THAT ARE ADJUSTED BY NON INTEREST CHARGEABLE
      *             SERVICE CHARGES/INSURANCE, CAUSING THEM TO GO NEGATIVE
      **************************************************************************
       77  APR-STAT                      PIC XX VALUE "11".
       01  APR-WORK-AREA.
           05  APR-ID-AREA.
               10  APR-C-PROG-ID         PIC XX VALUE "12".
           05  APR-OUTPUT-AREA.
               10  APR-APR               PIC S9(3)V9(4) COMP-3.
           05  APR-INPUT-AREA.
               10  APR-UNITPER-CD        PIC X.
               10  APR-UNITPER-FREQ      PIC 999        COMP-3.
               10  APR-FINANCED          PIC S9(8)V99   COMP-3.
               10  APR-REGPYAMT          PIC S9(6)V99   COMP-3.
               10  APR-1STPYAMT          PIC S9(6)V99   COMP-3.
               10  APR-LASTPYAMT         PIC S9(6)V99   COMP-3 VALUE 0.
               10  APR-ORGTERM           PIC 9(4)       COMP-3.
               10  APR-JUNK              PIC 9(4)       COMP-3.
               10  APR-INTDATE           PIC 9(8)       COMP-3.
               10  APR-1STPYDATE         PIC 9(8)       COMP-3.
               10  APR-DISFRMLA          PIC X          VALUE "A".
           05  APR-INTERMEDIATE-WORK-AREA.
               10  APR-1ST-PAYMENT       PIC S9(6)V99   COMP-3.
               10  APR-PVTERM            PIC 9(4)       COMP-3.
               10  APR-UNITPER-PER-YEAR  PIC 9(3)V9(7)  COMP-3.
               10  APR-FULL-UNITPER      PIC 9(3)       COMP-3.
               10  APR-FRACT-UNITPER     PIC V9(9)      COMP-3.
               10  APR-DELTA             PIC V99        COMP-3
                                                        VALUE .1.
               10  APR-METHOD            PIC X.
           05  APR-WORKERS.
               10  APR-DAYS-IN-UNITPER   PIC 9(3)       COMP-3.
               10  REUBEN-FRACTERM       PIC 9V9(9)     COMP-3.
               10  APR-EXTCHG            PIC 9(4)V99    COMP-3.
      * HERE FOR LONPZ3.C TESTING ON SINGLE PAYS:
       01  APR-SPAY-FG                   PIC X.
       01  APR-PAYFREQ                   PIC 9.

      * WORKERS FOR
      * VERYANT COBOL VERSION OR APRZ
       77 APRZ-WS-F0                  USAGE DOUBLE.
       77 APRZ-WS-F1                  USAGE DOUBLE.
       77 APRZ-WS-ADJ                 USAGE DOUBLE.
       77 APRZ-WS-R                   USAGE DOUBLE.
       77 APRZ-WS-CNTR                PIC 9(3).

       01 APRZ-APR-FIN-VARS.
          05 APRZ-WS-APRW             USAGE DOUBLE.
          05 APRZ-WS-APRW-DIV         USAGE DOUBLE.
          05 APRZ-WS-AF-R             USAGE DOUBLE.
          05 APRZ-WS-I                USAGE DOUBLE.
          05 APRZ-WS-I1               USAGE DOUBLE.
          05 APRZ-WS-REG-ANN          USAGE DOUBLE.
          05 APRZ-WS-LAST-FAC         USAGE DOUBLE.

       01 APRZ-WS-VARS.
          05 APRZ-WS-APR              USAGE DOUBLE.
          05 APRZ-WS-FINANCED         USAGE DOUBLE.
          05 APRZ-WS-REGPYAMT         USAGE DOUBLE.
          05 APRZ-WS-FSTPYAMT         USAGE DOUBLE.
          05 APRZ-WS-LASTPYAMT        USAGE DOUBLE.
          05 APRZ-WS-REG-TERM         USAGE DOUBLE.
          05 APRZ-WS-LAST-TERM        USAGE DOUBLE.
          05 APRZ-WS-UNITPER-PER-YEAR USAGE DOUBLE.
          05 APRZ-WS-FULL-UNITPER     USAGE DOUBLE.
          05 APRZ-WS-FRACT-UNITPER    USAGE DOUBLE.
          05 APRZ-WS-DELTA            USAGE DOUBLE.
          05 APRZ-WS-METHOD           PIC X.
      *================================================================*
      * END COPYBOOK: LIBLP\LPAPRZW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPUPERW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPUPERW
      **************************************************************************
      *    LPUPERW
      *    UNIT PERIOD WORKERS (APR RELATED)
      *
      * REV:
      *  JTG 060504 CHANGED LOGIC FOR SINGLE PAYS LOANS > 11 MONTHS
      *             TO YIELD REMAINING DAYS FROM UPER-INTDATE PLUS
      *             FULL UNIT PERIODS TO UPER-1STPYDATE
      *             ADDED NEW LOAN CALCULATION FOR RICHARD        LENDMARK #2709
      *             INCREASED UPER-UNITPER-PER-YEAR TO 9(3)V9(15)
      *             AND UPER-FRACT-UNITPER TO V9(18)
      **************************************************************************
       01  UPER-WORK-AREA.
           03  UPER-OUTPUT-AREA.
               05  UPER-UNITPER-PER-YEAR   PIC 9(3)V9(15)  COMP-3.
               05  UPER-DAYS-IN-UNITPER    PIC 9(3)       COMP-3.
               05  UPER-FULL-UNITPER       PIC 9(3)       COMP-3.
               05  UPER-FRACT-UNITPER      PIC V9(18)      COMP-3.
               05  UPER-ERRCD              PIC XX.
           03  UPER-INPUT-AREA.
               05  UPER-UNITPER-CD         PIC X.
               05  UPER-UNITPER-FREQ       PIC 9(3)       COMP-3.
               05  UPER-INTDATE            PIC 9(8)       COMP-3.
               05  UPER-1STPYDATE          PIC 9(8)       COMP-3.
               05  UPER-TERM               PIC 9(3)       COMP-3.
           03  UPER-WORKERS.
               05  UPER-REUBEN             PIC 9V9(9)     COMP-3.
               05  UPER-SINGLE-PAY-CD      PIC X.
               05  UPER-SINGLE-PAY-FREQ    PIC 9(3)       COMP-3.
      *================================================================*
      * END COPYBOOK: LIBLP\LPUPERW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\POSTDATEW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/POSTDATEW
      ****************************************************
      *                (LIBLP/POSTDATEW)
      *    POSTTIME, POSTDATE, AND USERID WORKERS.
      * REV:
      * BLV 000114 ADD REDEF OF POSTUSER FOR BRANCH
      * BAH 170313 MADE POST-DATE CCYYMMDD, NOT 00MMDDYY
      ****************************************************
       01  POST-USERID         PIC X(10).
       01  POST-USERIDX REDEFINES POST-USERID.
           03  FILLER          PIC X.
           03  POST-USERID-BR  PIC 9(4).
           03  FILLER          PIC X(5).

       01  POST-TIMEX.
           03  POST-TIME       PIC 9(6).
           03  FILLER          PIC 99.

       01  POST-DATE           PIC  9(8)  VALUE 0.
       01  FILLER            REDEFINES POST-DATE.
           05  POST-CC         PIC  9(2).
           05  POST-YY         PIC  9(2).
           05  POST-MM         PIC  9(2).
           05  POST-DD         PIC  9(2).
      *================================================================*
      * END COPYBOOK: LIBLP\POSTDATEW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GETENVW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GETENVW
      ******************************************************
      *    GETENVW: WORKERS TO RETRIEVE ENVIROMENT VARIABLES
      *
      *    LIMIT NAME AND VALUE TO 19 BYTES
      ******************************************************
       01  GETENV-BUF    PIC X(20).
      *================================================================*
      * END COPYBOOK: LIBGB\GETENVW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\ACCESSW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/ACCESSW
      ******************************************************
      *    ACCESSW:  WORKERS FOR TESTING EXISTENCE OF FILES
      *
      *    LIMIT COMPLETE PATH TO 40 BYTES
      * 120103 ADDED ACCESS-STAT,ACCESS-FILE-INFO FOR USE OF ACU C$FILEINFO
      * 120524 CHANGED TO USE LONGER BUF (SAME AS LACCESSW)
      * 120614 THIS WAS NEVER PUT IN USE FOR A15, IT IS NOW ... CHANGE FOR
      *        PLATFORM CHANGE
      * 121017 ADDED ACCESS-SOURCE & ACCESS-TARGET.
      ******************************************************
      *01  ACCESS-BUF    PIC X(41).

       01  ACCESS-BUF    PIC X(128).
      *NOTE IN LACCESSW SAYS LIMIT COMPLETE PATH TO 127*

       01  ACCESS-STAT                     PIC 99.
       01  ACCESS-FILE-INFO.
          03  ACCESS-SIZE                  PIC X(8) COMP-X.
          03  ACCESS-FILE-DATE             PIC 9(8) COMP-X.
          03  ACCESS-FILE-TIME             PIC 9(8) COMP-X.

      *================================================================*
      * END COPYBOOK: LIBGB\ACCESSW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DACCESSW.CPY                           *
      *================================================================*
      * REV:
      *  130424 BAH ADDED DIR-ACCESS-SOURCE AND TARGET
      *  140519 BLM CHANGED COMMAND TO DO LS -LD INSTEAD OF CALLING SHELL
      **********************************************************************
      * LIBGB/DACCESSW: WORKERS FOR DACCESS, CHECK IF DIRECTORY EXISTS
      **********************************************************************
       01  CK-DIR-EXISTS-CMD.
           03  CK-DIR-LS      PIC X(7)  VALUE "LS -LD ".
           03  DIR-ACCESS-BUF PIC X(40).
           03  FILLER         PIC X(4)  VALUE " 1>/".
           03  CK-DIR-DEVNULL PIC X(8).

       01  DIR-ACCESS-SOURCE           PIC X(40).
       01  DIR-ACCESS-TARGET           PIC X(40).
      *================================================================*
      * END COPYBOOK: LIBGB\DACCESSW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\SYSTEMW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/SYSTEMW
      ******************************************************************
      *
      *    SYSTEMW:  WORKERS FOR EXECUTING SYSTEM COMMANDS
      *
      *=================================================================
      ***
      *** LIBGB/CSYSTEM.CPY & LIBGB/CSYSTEMW.CPY WERE COPY MEMBERS THAT
      *** USED C$SYSTEM. WERE CREATED BY BARB & CINDY BACK IN 2013 WHEN
      *** CREATING A30 FROM A15. CHANGES WERE DONE FOR VERYANT BUT WERE
      *** REVERSED LATER.  THERE WERE SOME DISPLAY ISSUES DEPENDING ON
      *** ITS USAGE.
      *** LIBGB/CSYSTEM.CPY & LIBGB/CSYSTEMW.CPY WERE MOVED TO THE
      *** SV DIRECTORY AS A .NO SINCE THEY WERE NOT USED.
      *** THERE ARE HARDCODED C$SYSTEM IN GB/QUEPRU, GB/PREPRU AND
      *** GB/POSPRU DUE TO GARBAGE:
      ***   "THIS MUST STAY C$SYSTEM OR GARBAGE PRINTS, NO IDEA WHY"
      *** FOR MORE INFO, LOOK IN THE SHARED DRIVE FOR BARB'S DOC:
      ***   == PROJECT DOCUMENTS==/2).PROJECT DEVELOPMENT/2).SYSTEM CALL
      ***   SYSTEM CALL.DOCX 
      ***                                        UPDATE BY JAY 2017-0919
      ***
      *=================================================================
      * REV:
      * JTG 010596 CHANGED LENGTH OF BUFFER TO 90 TO STOP OVERRUN
      *            OF NULL CHARACTER INTO NEXT FIELD OF COBOL PROGRAM
      *            WHEN PID'S ARE LONGER THAN 5 CHARACTERS
      * JTG 021213 ADDED SYSTEM-STAT PIC 9(3) FOR ACU CALL "SYSTEM"
      * BLM 130325 REVISED ROUTINE FOR A30, CHANGED TO CALL "C$SYSTEM"
      *            & PIPE ERRORS TO /DEV/NULL, TRASH SYSTEM-STAT
      *
      * KEC 2017.0925 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          ADDED RM-CMD FOR USE IN ALL PROGRAMS.
      *
      ******************************************************************
       01  CAT-CMD                     PIC X(3)   VALUE X'636174'.
       01  CP-CMD                      PIC X(2)   VALUE X'6370'.
       01  EC-CMD                      PIC X(2)   VALUE X'6563'.
       01  LS-CMD                      PIC X(2)   VALUE X'6C73'.
       01  MKDIR-CMD                   PIC X(5)   VALUE X'6D6B646972'.
       01  MV-CMD                      PIC X(2)   VALUE X'6D76'.
       01  RM-CMD                      PIC X(2)   VALUE X'726D'.

      * 2>/DEV/NULL
       01  DEV-NULL-CMD.
           03  FILLER        PIC X(4) VALUE " 2>/".
           03  SYSTEM-DEVNULL.
               05  FILLER    PIC X(3) VALUE X'646576'.
               05  FILLER    PIC X    VALUE "/".
               05  FILLER    PIC X(4) VALUE X'6E756C6C'.

       01  SYSTEM-BUFFER.
           03  SYSTEM-BUF            VALUE " ".
               05  SYSTEM-COMMAND    PIC X(257).
           03  SYSTEM-BUFX REDEFINES SYSTEM-BUF.
               05  S-C1              PIC X(60).
               05  S-C2              PIC X(60).
               05  S-C3              PIC X(60).
               05  S-C4              PIC X(64).
      * 2>/DEV/NULL
               05  SYSTEM-DEV-NULL   PIC X(12).
               05  FILLER            PIC X.
           03  RM-BUF                REDEFINES SYSTEM-BUF.
               05  FILLER            PIC X(4).
               05  RM-FILE           PIC X(253).
           03  MKDIR-BUF             REDEFINES SYSTEM-BUF.
               05  FILLER            PIC X(6).
               05  MKDIR-FILE        PIC X(251).
           03  CAT-BUF               REDEFINES SYSTEM-BUF.
               05  FILLER            PIC X(4).
               05  CAT-FILE          PIC X(253).
           03  MV-BUF                REDEFINES SYSTEM-BUF.
               05  FILLER            PIC X(4).
               05  MV-FILE1          PIC X(40).
               05  FILLER            PIC X.
               05  MV-FILE2          PIC X(40).
               05  FILLER            PIC X(172).

      *================================================================*
      * END COPYBOOK: LIBGB\SYSTEMW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\CONNECTW_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/CONNECTW_SQL.CPY
      ******************************************************************
      *
      * IDENTIFICATION: LIBGB/CONNECTW_SQL
      * DESCRIPTION   : SQL SERVER CONNECTION WORKERS
      *
      *=================================================================
      * REV:
      * JKC 2021-0115 ***NEW***
      * JKC 2021-0223 CLEANING UP THE CODE.
      * JKC 2021-0324 ADDED SQL-DATE-YYYY-MM-DD AND SQL-DATE-YYYYMMDD.
      * JKC 2021-0430 CHANGES MADE WHILE WORKING ON DECLARE ROUTINES.
      * JKC 2021-0511 CHANGED NAME FROM SQLCONNECTW TO CONNECTW_SQL
      * JKC 2021-0525 UPDATED FROM XPC/IOCONN.PRE FOR LATEST CHANGES.
      * JKC 2021-0817 UPDATED FROM XPC/IOCONN.PRE FOR LATEST CHANGES.
      * JKC 2022-0209 DID SOME CLEANUP OF UNNEED CODE THAT WAS USED
      *               FOR A TWO-STEP COMPILE PROCESS; WE USE A ONE-STEP
      *               COMPILE GOING FORWARD AT THIS POINT.
      * JKC 2022-0622 MOVED THIS FROM LIBIO TO LIBGB; LIBIO WAS REMOVED
      * JKC 2022-0805 CHANGED SQL-GP-KEY TO BE SQL-CONNECT-VERIFY;
      *               MOVED SQL-CONNECT-WORKERS WITHIN
      *               'EXEC SQL BEGIN DECLARE SECTION END-EXEC.'
      * JKC 2022-0805 ADDED SQL-TEXT-SIZE.
      * JKC 2022-1003 ADDED SQL-TEXT-SIZE.
      * JKC 2022-1010 ADDED SQL-TEXT-S3.
      * JKC 2023-0815 ADDED SQL-TEXT-ASCII; HAS ALL HEX VALUES OF
      *          ALL CHARACTERS (ALPHA, NUMBERS, SPECIAL); THERE WAS AN
      *          ISSUE IN THE TEXT INCREMENT ROUTINE WHERE A "60+" WAS
      *          BEING INCREMENTED TO "60 " WHICH RESETS FROM THE START
      *          GIVING BAD RESULTS IN SCAN WINDOW; NEEDED TO ALLOW THE
      *          USE OF SPECIAL CHARACTERS TO INCREMENT OR DECREMENT.
      * MB  2023-1129 ADDED SQL-UPDATE-CONN-USE-SW.
      * JKC 2024-0716 ADDED SQL-ERROR-DISPLAY; NEEDED FOR SUPPRESSING
      *          ERROR MESSAGE WINDOW DISPLAYING WHEN EXECUTING VIA
      *          BATCH (EOEXEC/EOCRON); CANNOT USE EXT-ROUTE-BUF SINCE
      *          NOT ALL PROGRAMS THAT USE CONNECT_SQL DOES NOT HAVE
      *          CONAME_EXT WHICH IS NEEDED; S35Q-88
      *
      ******************************************************************
       EXEC SQL INCLUDE SQLCA END-EXEC.
       EXEC SQL INCLUDE SQLDA END-EXEC.
       EXEC SQL BEGIN DECLARE SECTION END-EXEC.
       01  SQL-CONNECT-WORKERS.
           03  SQL-CONNECT-SERVER          PIC X(30).
           03  SQL-CONNECT-USERID          PIC X(30).
           03  SQL-CONNECT-PSWD            PIC X(30).
           03  SQL-CONNECT-VERIFY          PIC 99.
      *??? 03  SQL-CONNECT-DATABASE        PIC X(20).
      *??? 03  SQL-CONNECT-OWNER           PIC X(20).
      *??? 03  SQL-CONNECT-PRE-FILE        PIC X(20).
       EXEC SQL END DECLARE SECTION END-EXEC.

       01  SQL-UPDATE-CONN-OPEN-SW         PIC X     VALUE "N".
       01  SQL-UPDATE-CONN-USE-SW          PIC X     VALUE '0'.

       01  SQL-DATE-WORKERS.
           03  SQL-DATE-YYYYMMDD                     PIC 9(8).
           03  FILLER REDEFINES SQL-DATE-YYYYMMDD.
               05  SQL-DATE-YYYYMMDD-YYYY            PIC 9(4).
               05  SQL-DATE-YYYYMMDD-MM              PIC 9(2).
               05  SQL-DATE-YYYYMMDD-DD              PIC 9(2).

           03  SQL-DATE-YYYY-MM-DD                   PIC X(10).
           03  SQL-DATE-YYYY-MM-DD-NUM REDEFINES SQL-DATE-YYYY-MM-DD
                                                     PIC 9999/99/99.
           03  FILLER REDEFINES SQL-DATE-YYYY-MM-DD.
               05  SQL-DATE-YYYY-MM-DD-YYYY          PIC 9(4).
               05  FILLER                            PIC X(1).
               05  SQL-DATE-YYYY-MM-DD-MM            PIC 9(2).
               05  FILLER                            PIC X(1).
               05  SQL-DATE-YYYY-MM-DD-DD            PIC 9(2).


       01  SQL-ERROR-BUF.
           03  SQL-ERROR-01                          PIC X(70).
           03  SQL-ERROR-02                          PIC X(70).
           03  SQL-ERROR-03                          PIC X(70).
           03  SQL-ERROR-04                          PIC X(70).
           03  SQL-ERROR-05                          PIC X(70).
           03  FILLER REDEFINES SQL-ERROR-05.
               05  SQL-ERROR-05-SQLCODEX             PIC X(6).
               05  SQL-ERROR-05-SQLCODE              PIC Z(8)9-.
               05  FILLER                            PIC X(3).
               05  SQL-ERROR-05-SQLSTATEX            PIC X(7).
               05  SQL-ERROR-05-SQLSTATE             PIC X(5).
               05  FILLER                            PIC X(3).
               05  SQL-ERROR-05-SQLERRMLX            PIC X(7).
               05  SQL-ERROR-05-SQLERRML             PIC 9(4)-.
               05  FILLER                            PIC X(3).
               05  SQL-ERROR-05-SQLERRPLX            PIC X(7).
               05  SQL-ERROR-05-SQLERRPL             PIC 9(4)-.
           03  SQL-ERROR-06                          PIC X(70).
           03  FILLER REDEFINES SQL-ERROR-06.
               05  SQL-ERROR-06-KEYX                 PIC X(6).
               05  SQL-ERROR-06-KEY                  PIC X(64).
           03  SQL-ERROR-07                          PIC X(70).
           03  SQL-ERROR-08                          PIC X(70).
       01  SQL-DEBUG-BUF REDEFINES SQL-ERROR-BUF.
           03  SQL-DEBUG-01                          PIC X(70).
           03  FILLER REDEFINES SQL-DEBUG-01.
               05  SQL-DEBUG-01-SQLCODEX             PIC X(7).
               05  SQL-DEBUG-01-SQLCODE              PIC 9(9)-.
               05  FILLER                            PIC X(3).
               05  SQL-DEBUG-01-SQLCABCX             PIC X(7).
               05  SQL-DEBUG-01-SQLCABC              PIC 9(9)-.
               05  FILLER                            PIC X(12).
               05  SQL-DEBUG-01-SQLCAIDX             PIC X(6).
               05  SQL-DEBUG-01-SQLCAID              PIC X(8).
           03  SQL-DEBUG-02                          PIC X(70).
           03  FILLER REDEFINES SQL-DEBUG-02.
               05  SQL-DEBUG-02-SQLSTATEX            PIC X(7).
               05  SQL-DEBUG-02-SQLSTATE             PIC X(5).
               05  FILLER                            PIC X(8).
               05  SQL-DEBUG-02-SQLERRMLX            PIC X(7).
               05  SQL-DEBUG-02-SQLERRML             PIC 9(4)-.
               05  FILLER                            PIC X(3).
               05  SQL-DEBUG-02-SQLERRPLX            PIC X(7).
               05  SQL-DEBUG-02-SQLERRPL             PIC 9(4)-.
               05  FILLER                            PIC X(2).
               05  SQL-DEBUG-02-SQLWARNX             PIC X(6).
               05  SQL-DEBUG-02-SQLWARN0             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN1             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN2             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN3             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN4             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN5             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN6             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN7             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN8             PIC X(1).
               05  SQL-DEBUG-02-SQLWARN9             PIC X(1).
               05  SQL-DEBUG-02-SQLWARNA             PIC X(1).
           03  SQL-DEBUG-03                          PIC X(70).
           03  FILLER REDEFINES SQL-DEBUG-03.
               05  SQL-DEBUG-03-SQLERRDX             PIC X(7).
               05  SQL-DEBUG-03-SQLERRD-1            PIC 9(9)-.
               05  FILLER                            PIC X(1).
               05  SQL-DEBUG-03-SQLERRD-2            PIC 9(9)-.
               05  FILLER                            PIC X(1).
               05  SQL-DEBUG-03-SQLERRD-3            PIC 9(9)-.
           03  SQL-DEBUG-04                          PIC X(70).
           03  FILLER REDEFINES SQL-DEBUG-04.
               05  SQL-DEBUG-04-SQLERRDX             PIC X(7).
               05  SQL-DEBUG-04-SQLERRD-4            PIC 9(9)-.
               05  FILLER                            PIC X(1).
               05  SQL-DEBUG-04-SQLERRD-5            PIC 9(9)-.
               05  FILLER                            PIC X(1).
               05  SQL-DEBUG-04-SQLERRD-6            PIC 9(9)-.
           03  SQL-DEBUG-05                          PIC X(70).
           03  SQL-DEBUG-06                          PIC X(70).
           03  SQL-DEBUG-07                          PIC X(70).
           03  SQL-DEBUG-08                          PIC X(70).

       01  SQL-ERROR-DISPLAY           PIC X(1)      VALUE "Y".

      *=================================================================
       77  SQL-TEXT-LAST               PIC 9(02)     VALUE ZEROES.
       77  SQL-TEXT-S1                 PIC S9(2)     VALUE ZEROES.
       77  SQL-TEXT-S2                 PIC S9(2)     VALUE ZEROES.
       77  SQL-TEXT-S3                 PIC S9(2)     VALUE ZEROES.
       77  SQL-TEXT-S4                 PIC S9(2)     VALUE ZEROES.
       77  SQL-TEXT-SIZE               PIC 9(02)     VALUE ZEROES.
       78  SQL-TEXT-ASCII-MAX                        VALUE 95.
       78  SQL-TEXT-MAX                              VALUE 35.

       01  SQL-TEXT-WORKERS.
           03  SQL-TEXT                PIC X(35).
           03  SQL-TEXT9               REDEFINES SQL-TEXT
                                       PIC 9(01) OCCURS SQL-TEXT-MAX.
           03  SQL-TEXTX               REDEFINES SQL-TEXT
                                       PIC X(01) OCCURS SQL-TEXT-MAX.
           03  SQL-TEXT-ASCII.
               05  FILLER              PIC X(1) VALUE X"20".  *> SP
               05  FILLER              PIC X(1) VALUE X"21".  *> !
               05  FILLER              PIC X(1) VALUE X"22".  *> "
               05  FILLER              PIC X(1) VALUE X"23".  *> #
               05  FILLER              PIC X(1) VALUE X"24".  *> $
               05  FILLER              PIC X(1) VALUE X"25".  *> %
               05  FILLER              PIC X(1) VALUE X"26".  *> &
               05  FILLER              PIC X(1) VALUE X"27".  *> '
               05  FILLER              PIC X(1) VALUE X"28".  *> (
               05  FILLER              PIC X(1) VALUE X"29".  *> )
               05  FILLER              PIC X(1) VALUE X"2A".  *> *
               05  FILLER              PIC X(1) VALUE X"2B".  *> +
               05  FILLER              PIC X(1) VALUE X"2C".  *> ,
               05  FILLER              PIC X(1) VALUE X"2D".  *> -
               05  FILLER              PIC X(1) VALUE X"2E".  *> .
               05  FILLER              PIC X(1) VALUE X"2F".  *> /
               05  FILLER              PIC X(1) VALUE X"30".  *> 0
               05  FILLER              PIC X(1) VALUE X"31".  *> 1
               05  FILLER              PIC X(1) VALUE X"32".  *> 2
               05  FILLER              PIC X(1) VALUE X"33".  *> 3
               05  FILLER              PIC X(1) VALUE X"34".  *> 4
               05  FILLER              PIC X(1) VALUE X"35".  *> 5
               05  FILLER              PIC X(1) VALUE X"36".  *> 6
               05  FILLER              PIC X(1) VALUE X"37".  *> 7
               05  FILLER              PIC X(1) VALUE X"38".  *> 8
               05  FILLER              PIC X(1) VALUE X"39".  *> 9
               05  FILLER              PIC X(1) VALUE X"3A".  *> :
               05  FILLER              PIC X(1) VALUE X"3B".  *> ;
               05  FILLER              PIC X(1) VALUE X"3C".  *> <
               05  FILLER              PIC X(1) VALUE X"3D".  *> =
               05  FILLER              PIC X(1) VALUE X"3E".  *> >
               05  FILLER              PIC X(1) VALUE X"3F".  *> ?
               05  FILLER              PIC X(1) VALUE X"40".  *> @
               05  FILLER              PIC X(1) VALUE X"41".  *> A (UP)
               05  FILLER              PIC X(1) VALUE X"42".  *> B (UP)
               05  FILLER              PIC X(1) VALUE X"43".  *> C (UP)
               05  FILLER              PIC X(1) VALUE X"44".  *> D (UP)
               05  FILLER              PIC X(1) VALUE X"45".  *> E (UP)
               05  FILLER              PIC X(1) VALUE X"46".  *> F (UP)
               05  FILLER              PIC X(1) VALUE X"47".  *> G (UP)
               05  FILLER              PIC X(1) VALUE X"48".  *> H (UP)
               05  FILLER              PIC X(1) VALUE X"49".  *> I (UP)
               05  FILLER              PIC X(1) VALUE X"4A".  *> J (UP)
               05  FILLER              PIC X(1) VALUE X"4B".  *> K (UP)
               05  FILLER              PIC X(1) VALUE X"4C".  *> L (UP)
               05  FILLER              PIC X(1) VALUE X"4D".  *> M (UP)
               05  FILLER              PIC X(1) VALUE X"4E".  *> N (UP)
               05  FILLER              PIC X(1) VALUE X"4F".  *> O (UP)
               05  FILLER              PIC X(1) VALUE X"50".  *> P (UP)
               05  FILLER              PIC X(1) VALUE X"51".  *> Q (UP)
               05  FILLER              PIC X(1) VALUE X"52".  *> R (UP)
               05  FILLER              PIC X(1) VALUE X"53".  *> S (UP)
               05  FILLER              PIC X(1) VALUE X"54".  *> T (UP)
               05  FILLER              PIC X(1) VALUE X"55".  *> U (UP)
               05  FILLER              PIC X(1) VALUE X"56".  *> V (UP)
               05  FILLER              PIC X(1) VALUE X"57".  *> W (UP)
               05  FILLER              PIC X(1) VALUE X"58".  *> X (UP)
               05  FILLER              PIC X(1) VALUE X"59".  *> Y (UP)
               05  FILLER              PIC X(1) VALUE X"5A".  *> Z (UP)
               05  FILLER              PIC X(1) VALUE X"5B".  *> [
               05  FILLER              PIC X(1) VALUE X"5C".  *> \
               05  FILLER              PIC X(1) VALUE X"5D".  *> ]
               05  FILLER              PIC X(1) VALUE X"5E".  *> ^
               05  FILLER              PIC X(1) VALUE X"5F".  *> _
               05  FILLER              PIC X(1) VALUE X"60".  *> `
               05  FILLER              PIC X(1) VALUE X"61".  *> A (LOW)
               05  FILLER              PIC X(1) VALUE X"62".  *> B (LOW)
               05  FILLER              PIC X(1) VALUE X"63".  *> C (LOW)
               05  FILLER              PIC X(1) VALUE X"64".  *> D (LOW)
               05  FILLER              PIC X(1) VALUE X"65".  *> E (LOW)
               05  FILLER              PIC X(1) VALUE X"66".  *> F (LOW)
               05  FILLER              PIC X(1) VALUE X"67".  *> G (LOW)
               05  FILLER              PIC X(1) VALUE X"68".  *> H (LOW)
               05  FILLER              PIC X(1) VALUE X"69".  *> I (LOW)
               05  FILLER              PIC X(1) VALUE X"6A".  *> J (LOW)
               05  FILLER              PIC X(1) VALUE X"6B".  *> K (LOW)
               05  FILLER              PIC X(1) VALUE X"6C".  *> L (LOW)
               05  FILLER              PIC X(1) VALUE X"6D".  *> M (LOW)
               05  FILLER              PIC X(1) VALUE X"6E".  *> N (LOW)
               05  FILLER              PIC X(1) VALUE X"6F".  *> O (LOW)
               05  FILLER              PIC X(1) VALUE X"70".  *> P (LOW)
               05  FILLER              PIC X(1) VALUE X"71".  *> Q (LOW)
               05  FILLER              PIC X(1) VALUE X"72".  *> R (LOW)
               05  FILLER              PIC X(1) VALUE X"73".  *> S (LOW)
               05  FILLER              PIC X(1) VALUE X"74".  *> T (LOW)
               05  FILLER              PIC X(1) VALUE X"75".  *> U (LOW)
               05  FILLER              PIC X(1) VALUE X"76".  *> V (LOW)
               05  FILLER              PIC X(1) VALUE X"77".  *> W (LOW)
               05  FILLER              PIC X(1) VALUE X"78".  *> X (LOW)
               05  FILLER              PIC X(1) VALUE X"79".  *> Y (LOW)
               05  FILLER              PIC X(1) VALUE X"7A".  *> Z (LOW)
               05  FILLER              PIC X(1) VALUE X"7B".  *> {
               05  FILLER              PIC X(1) VALUE X"7C".  *> |
               05  FILLER              PIC X(1) VALUE X"7D".  *> }
               05  FILLER              PIC X(1) VALUE X"7E".  *> ~
           03  SQL-TEXT-ASCIIX         REDEFINES SQL-TEXT-ASCII
                                       PIC X(01)
                                       OCCURS SQL-TEXT-ASCII-MAX.
           03  SQL-TEXT-AFTER          PIC X(01)     VALUE SPACES.
           03  SQL-TEXT-BEFORE         PIC X(01)     VALUE SPACES.
           03  SQL-TEXT-CURRENT        PIC X(01)     VALUE SPACES.

      *================================================================*
      * END COPYBOOK: LIBGB\CONNECTW_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\FILEWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/FILEWK
      **************************************************************************
      *
      *  IDENTIFICATION:  LIBGB/FILEWK
      *
      *  DESCRIPTION   :  FILE ERROR WORKERS
      *
      *-----------------------------------------------------------------
      *  REV:
      *  JTG 072996 ADDED SAVE-KEY2 AND CHANGED SAVE-KEY1 TO PIC 9(10)
      *  JTG 092496 ADDED E-KEYX-SSNO  E-KEYX-ACCTNO E-KEYX-OWNBR
      *             TO ALLOW DISPLAY OF BI1-KEY
      *  KEC 112796 ADDED E-KEYX-RX-ACCTNO.
      *  KEC 072298 ADDED '88' LEVELS FOR STAT  (STAT-VALID).
      *  MJD 102998 ADDED E-KEYX-NT-ACCTNO.
      *  JTG 121198 ADDED E-KEYX RT-FIELDS FOR RT2-KEY
      *  KEC 082699 ADDED '88' LEVELS FOR IO-FG (IO-GOOD/IO-BAD)
      *             ADDED '88' LEVELS FOR STAT  (STAT-GOOD/STAT-BAD)
      *             THIS WAS DONE PER THE 'DEVELOPMENT' MEETING (082599)
      *  KEC 083099 ADDED '88' LEVELS FOR IO-FG
      *                                  (IO-ALREADY-OPEN/IO-LOCKED)
      *  KEC 090799 ADDED '88' LEVELS FOR STAT FOR FUNCTION KEYS.
      *  JTG 000508 ADDED LOGIC FOR SECOND ERROR MESSAGE TO INFORM
      *             OPERATOR TO STOP AND CALL SUPPORT          PARADATA #1171
      *  BLV 000619 CHANGED FILLER OF 6 IN ERROR-MSG-STAT TO BE PIGGY-BACK-FLAG,
      *             WHICH GETS USED BY LONPMC & DECLARE
      *  BLV 021022 CHANGED FILLER OF 1 IN ERROR-MSG-STAT TO BE ERROR-LOCK-FG,
      *             WILL TRY TO USE IN DECLARE TO RETURN TO A PROGRAM WITH
      *             A FILE STATUS OF 8 (TO GIVE THE PROGRAM CONTROL) INSTEAD
      *             OF FORCING THE "RECORD LOCKED" WINDOW
      *  KEC 030523 ADDED THE FOLLOWING FIELDS.  ADDED 'LOCAL-FILE-*'
      *             TO MAKE A EASY ROUTINE TO LOAD LOCAL FILE PATHS.
      *             ALSO THE '78' LEVELS TO SET STAT.
      *               01  LOCAL-FILE-DATA-PATH   PIC X(06) VALUE SPACES.
      *               01  LOCAL-FILE-MACHINE     PIC X(02) VALUE SPACES.
      *               01  LOCAL-FILE-STAT        PIC X(02) VALUE SPACES.
      *               78  SET-STAT-GOOD                    VALUE "00".
      *               78  SET-STAT-BAD                     VALUE "XX".
      *  KEC 041118  ADDED THE FOLLOWING FIELDS.  ADDED 'LOCAL-FILE-*'
      *               78  IO---BAD                         VALUE 9.
      *               78  IO---GOOD                        VALUE 0.
      *               78  STAT---GOOD                      VALUE "00".
      *               78  STAT---BAD                       VALUE "XX".
      *  KEC 050817 ADDED THE FOLLOWING FIELDS:
      *               01  EXECUTION-STAT PIC X(02) VALUE SPACES.
      *                   88  EXECUTION-STAT-GOOD  VALUE "00".
      *                   88  EXECUTION-STAT-BAD   VALUE "  " THRU "//"
      *                                                  "01" THRU "~~".
      * BLM 110706 BROUGHT FROM A15, ADDED BACK A FEW ITEMS USED BY NEW
      *            ROUTINES
      * BLM 111213 ADD SYSTEM-STAT (ACU'S SYSTEM CALL NEEDED NUMERIC STAT,
      *            FILE-INFO (REPLACING ACCESS-CALL WITH C$FILEINFO
      * KEC 121017 ADDED FILPATH-WORKERS & EXT-FILPATH-EXTERNAL.
      * BAH 121219 REMOVED SYSTEM-STAT FROM HERE, BELONGS IN SYSTEMW
      * BLM 131009 REMOVED STAT-F1-KEY, ETC
      * BLM 140416 ADDED VIX-SUFFIX & IDX-SUFFIX FOR USE IN LIBGB/RMFILE
      * KEC 151124 ADDED A REDEFINES FILPATH-DATA TO BREAKDOWN THE
      *            STATE & BRANCH...IT MATCHES THE EXTERNAL FIELD
      *            IN CONAME_EXT.
      * BLM 161216 INCREASE SIZE OF ERRMSG-HEAD
      * BAH 190207 ADDED IO-MULTI-FG FOR USE WITH FILES THAT HAVE BEEN
      *            SPLIT SO WE CAN IDENTIFY WHICH FILE HAD BAD I/O
      * JKC 2020-0217 ADDED WORKERS TO GET ACU4GL ERRORS IN ORDER TO
      *               DISPLAY THEM; THERE IS MORE DETAILS FROM ACU4GL.
      * JKC 2020-1023 MOVED '01  SENDMESS-BUF' TO BE A REDEFINES OF
      *              '01  ERRMSG-BUF.' TO SAVE ON SPACE.
      * BAH 2022-0412 REMOVED IO-INVALID AND IO-VALID, LET'S PLEASE STAY
      *                WITH ONE OPTION, IO-BAD AND IO-GOOD. DONT NEED SO
      *                MANY OPTIONS TO LOOK FOR!
      * JKC 2024-0304 REMOVED ACU4GL ERROR DISPLAY LOGIC
      * BAH 2024-0308 REMOVED E-FILEY, SENDMESS-BUF, ERROR-MSG, ERROR-MISC-HEAD,
      *               ERROR-MISC-MSG1, MSG2, MSG3, EXECUTION-STAT,
      *               RELATIVE-RECORD-TERMINATOR, SAVE-KEY, SAVE-KEY2,
      *               FILE-INFO
      ******************************************************************
       01  E-FILE                                    VALUE SPACES.
           03  E-LFN                       PIC X(02).
           03  E-NAME                      PIC X(09).
           03  FILLER                      PIC X(40).

       01  TMMSG-MESS                  PIC X(61).
       01  ERRMSG-BUF.
           03  ERRMSG-HEAD             PIC X(61).
           03  ERRMSG-MSG1             PIC X(61).
           03  ERRMSG-MSG2             PIC X(61).
           03  ERRMSG-MSG3             PIC X(61).
           03  ERRMSG-STAT             PIC X(02).

      *-----------------------------------------------------------------
       01  ERROR-MSG-HEAD.
           03  E-MSG                       PIC X(15).
           03  THIS                        REDEFINES E-MSG.
               05  E-MSG4                  PIC X(04).
               05  FILLER                  PIC X(11).
           03  FILLER                      PIC X(01) VALUE SPACES.

       01  ERROR-MSG-PATH.
           03  FILLER                      PIC X(05) VALUE "FILE=".
           03  E-FILEX                     PIC X(55).
           03  FILLER                      PIC X(01) VALUE SPACES.

       01  ERROR-MSG-KEY.
           03  FILLER                      PIC X(05) VALUE " KEY=".
           03  E-KEYX                      PIC X(55).
           03  FILLER                      PIC X(01) VALUE SPACES.

      
      * PIGGY-BACK-FLAG REALLY NOT USED BUT THIS 01 LEVEL IS MOVED TO
      *       OTHER BUFFERS AT PIC X(61) SO I DIDNT WANT TO REMOVE IT
      * ERROR-LOCK-FG IS ONLY CHECKED IN DECLARE BUT NEVER SET ANYWHERE
      *       AGAIN, DONT WANT TO REMOVE FOR BUFFER SIZE
       01  ERROR-MSG-STAT.
           03  FILLER                      PIC X(05) VALUE "STAT=".
           03  E-STATUS-ERROR.
               05  E-CODE                  PIC X(02).
               05  FILLER                  PIC X(01).
               05  E-SUBCODE               PIC X(02).
           03  PIGGY-BACK-FLAG             PIC X(06) VALUE SPACES.
           03  FILLER                      PIC X(09) VALUE "PROGRAM= ".
           03  E-PROG                      PIC X(35).
           03  ERROR-LOCK-FG               PIC X(01) VALUE SPACES.


       01  EXTENDED-FILE-STAT.
           03  FILE-STAT                   PIC X(02).
           03  FILE-STAT9                  REDEFINES FILE-STAT
                                           PIC 9(04) COMP.
           03  SECONDARY-FILE-STAT         PIC X(02).

       01  FILE-STAT-DISP                            VALUE SPACES.
           03  FILE-STATD1                 PIC X(02).
           03  FILE-STATC                  PIC X(01).
           03  FILE-STATD2                 PIC X(02).

      *------------------------------------------------------{ FILPATH }
      *    /USR/DATA/R1/XX####
      *    BASE    = /USR/DATA OR /USR/BEOM OR /USR/TEST ETC.
      *    MACHINE = R1 OR R2 OR SH
      *    DATA    = XX#### STATE & BRNO
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    EXT-FILPATH-WORKERS USE IS EXTERNAL FOR ALL PROGRAMS.
      *    FILPATH-WORKERS     USE IS INTERNAL TO A GIVEN PROGRAM.
      *
      *    FILPATH-WORKERS ARE USED IN THE 'LOAD' IO OPERATIONS FOR
      *    MAJORITY OF IO COPY MEMBERS.  IN A FILE'S LOAD ROUTINE,
      *    THE USE OF THE 'OVERRIDE OPTION' (??-PATH-OVERRIDE)
      *    WILL DETERMINE WHICH FIELDS TO USE WHEN LOADING THE PATH.
      *
      *    THE 'YES OVERRIDE OPTION' (??-PATH-OVERRIDE = "Y") WILL
      *    CAUSE THE LOAD ROUTINE TO *NOT* CHANGE THE PATH; THE PATH
      *    WAS HARDCODED WITHIN A GIVEN PROGRAM PRIOR TO LOAD/OPEN.
      *
      *    THE 'DEFAULT OVERRIDE OPTION' (??-PATH-OVERRIDE = SPACES)
      *    WILL USE THE EXTERNAL FILPATH WORKERS (EXT-FILPATH).
      *
      *    THE 'BRANCH OVERRIDE OPTION' (??-PATH-OVERRIDE = "B") WILL
      *    USE THE FILPATH-WORKERS.  WHEN USING THIS OPTION THE GIVEN
      *    PROGRAM MUST SET THE FILPATH-WORKERS AFTER THE READ OF THE
      *    BR FILE (READ-BR-FILE OR READ-BR-FILE-NEXT) AND BEFORE THE
      *    USE OF LOAD/OPEN ROUTINES:
      *
      *    MOVE EXT-FILPATH-BASE           TO FILPATH-BASE.
      *    MOVE BR-MACHINE                 TO FILPATH-MACHINE.
      *    MOVE BR-DATA-PATH               TO FILPATH-DATA.
      *
      *    ***NOTE*** FILPATH-BASE COULD BE SET TO THE ARCHIVE
      *    DIRECTORY (/USR/ARCH) INSTEAD OF EXT-FILPATH-BASE
      *    IN SOME CASES.
      *
      *LOAD-??-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
      *    IF ( ??-PATH-OVERRIDE = "Y" ) 
      *       NEXT SENTENCE
      *    ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
      *    IF ( ??-PATH-OVERRIDE = SPACES ) 
      *       MOVE EXT-FILPATH-BASE        TO ??-ALL-BASE
      *       MOVE EXT-FILPATH-MACHINE     TO ??-ALL-MACHINE
      *       MOVE EXT-FILPATH-DATA        TO ??-ALL-DATA
      *       MOVE ??-ALL-PATH             TO ??-PATH
      *    ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
      *    IF ( ??-PATH-OVERRIDE = "B" ) 
      *       MOVE FILPATH-BASE            TO ??-ALL-BASE
      *       MOVE FILPATH-MACHINE         TO ??-ALL-MACHINE
      *       MOVE FILPATH-DATA            TO ??-ALL-DATA
      *       MOVE ??-ALL-PATH             TO ??-PATH.
      *
      *-----------------------------------------------------------------
       01  FILPATH-WORKERS.
           03  FILPATH-BASE            PIC X(09)     VALUE SPACES.
           03  FILLER                  REDEFINES FILPATH-BASE.
               05  FILPATH-BASE-USR    PIC X(05).
               05  FILPATH-BASE-DIR    PIC X(04).
           03  FILPATH-MACHINE         PIC X(02)     VALUE SPACES.
           03  FILPATH-DATA            PIC X(06)     VALUE SPACES.
           03  FILLER                  REDEFINES FILPATH-DATA.
               05  FILPATH-STATE       PIC X(02).
               05  FILPATH-BRANCH      PIC 9(04).
               05  FILLER              REDEFINES FILPATH-BRANCH.
                   07  FILPATH-BRNO    PIC 9(04).
               05  FILLER              REDEFINES FILPATH-BRANCH.
                   07  FILPATH-BRANCH1 PIC 9(01).
                   07  FILPATH-BRANCH2 PIC 9(03).

      * USED FOR FILES THAT WERE BROKE INTO MULTIPE FILES LIKE BY AND SP
       01  IO-MULTI-FG                     PIC X  VALUE SPACES.

       01  IO-FG                           PIC 9(01) VALUE ZEROES.
           88  IO-ALREADY-OPEN                 VALUE 7.
           88  IO-BAD                          VALUE 1 THRU 9.
           88  IO-GOOD                         VALUE 0.
           88  IO-LOCKED                       VALUE 8.
       01  IO-STATUS                       PIC 9(01) VALUE ZEROES.
           88 IO-AT-END                        VALUE 9.
           88 IO-NOT-AT-END                    VALUE 0.
           88 IO-INVALID-KEY                   VALUE 9.
           88 IO-NOT-INVALID-KEY               VALUE 0.

      *01  LOCAL-FILE-DATA-PATH            PIC X(06) VALUE SPACES.
      *01  LOCAL-FILE-MACHINE              PIC X(02) VALUE SPACES.
      *01  LOCAL-FILE-STAT                 PIC X(02) VALUE SPACES.
      *    88  LOCAL-FILE-STAT-GOOD            VALUE "00".
      *    88  LOCAL-FILE-STAT-BAD             VALUE "  " THRU "//"
      *                                              "01" THRU "~~".

       01  LOCK-STATUS-93-RETRIES          PIC 9(01) VALUE ZEROES.
       01  LOCK-STATUS-99-RETRIES          PIC 9(02) VALUE ZEROES.
       01  VIX-SUFFIX                      PIC X(4)  VALUE X"2E766978".
       01  IDX-SUFFIX                      PIC X(4)  VALUE X"2E696478".

       78  STAT---GOOD                         VALUE "00".
       78  STAT---BAD                          VALUE "XX".
       01  STAT                            PIC X(02) VALUE SPACES.
           88  STAT-VALID                      VALUE "00".
           88  STAT-GOOD                       VALUE "00".
           88  STAT-BAD                        VALUE "  " THRU "//"
                                                     "01" THRU "~~".

      *- - - - - - - - - - - - - - - - - - - - - - - -{ FUNCTION KEYS  }
      *    88  STAT-F1-KEY                     VALUE "10".
      *    88  STAT-F2-KEY                     VALUE "12".
      *    88  STAT-F3-KEY                     VALUE "16".
      *    88  STAT-F4-KEY                     VALUE "18".
      *    88  STAT-F5-KEY                     VALUE "1:".
      *    88  STAT-F6-KEY                     VALUE "1<".
      *    88  STAT-F7-KEY                     VALUE "1>".
      *    88  STAT-F8-KEY                     VALUE "1 ".
      *    88  STAT-F9-KEY                     VALUE "1(".
      *    88  STAT-F10-KEY                    VALUE "1)".
      *    88  STAT-F11-KEY                    VALUE "1!".
      *    88  STAT-F12-KEY                    VALUE "1#".
      *    88  STAT-DOWN-KEY                   VALUE "1D".
      *    88  STAT-ENTER-KEY                  VALUE "00".
      *    88  STAT-HOME-KEY                   VALUE "1H".
      *    88  STAT-LEFT-KEY                   VALUE "1L".
      *    88  STAT-PAGE-UP-KEY                VALUE "1P".
      *    88  STAT-PAGE-DOWN-KEY              VALUE "1N".
      *    88  STAT-RIGHT-KEY                  VALUE "1R".
      *    88  STAT-UP-KEY                     VALUE "1U".

       01  STAT-99 REDEFINES STAT          PIC 9(02).

       01  WINDOWS-OPEN                    PIC 9(01) VALUE ZEROES.

       COPY "LIBCL/ERRLOGW.CPY".

      ******************************************************************
      *
      *                      ***** N O T E *****
      *
      *-----------------------------------------------------------------
      *   WHEN MODIFYING FILEWK, DO NOT CHANGE THE POSITION OF 'MESS'.
      *   (IT MUST BE THE LAST DATA-NAME SO THAT IT MAY BE REDEFINED.)
      ******************************************************************
       01  MESS                            PIC X(61) VALUE SPACES.
      *================================================================*
      * END COPYBOOK: LIBGB\FILEWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\MESSWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/MESSWK
      ******************************************************************
      * REV:
      ******************************************************************

       01  MESS-X REDEFINES MESS.
           03  MESS-X-SUB   PIC 99.
           03  FILLER       PIC X.
           03  MESS-X-MON-1 PIC Z(9).99-.
           03  MESS-X-ALPH-1 REDEFINES MESS-X-MON-1 PIC X(13).
           03  FILLER       PIC X.
           03  MESS-X-MON-2 PIC Z(9).99-.
           03  MESS-X-ALPH-2 REDEFINES MESS-X-MON-2 PIC X(13).
           03  FILLER       PIC X.
           03  MESS-X-MON-3 PIC Z(9).99-.
           03  MESS-X-ALPH-3 REDEFINES MESS-X-MON-3 PIC X(13).
           03  FILLER       PIC X.
           03  MESS-X-MON-4 PIC Z(9).99-.
           03  MESS-X-ALPH-4 REDEFINES MESS-X-MON-4 PIC X(13).

       01  MESS-X REDEFINES MESS.
           03  FILLER       PIC XXX.
           03  MESS-X-DEC-1 PIC Z(9).9(8)-.
           03  FILLER       PIC X.
           03  MESS-X-DEC-2 PIC Z(9).9(8)-.
           03  FILLER       PIC X.
           03  MESS-X-DEC-3 PIC Z(9).9(8)-.

       01  MESS-X REDEFINES MESS.
           03  FILLER       PIC XXX.
           03  MESS-X-NUM-1 PIC Z(8)9-.
           03  FILLER       PIC X(4).
           03  MESS-X-NUM-2 PIC Z(8)9-.
           03  FILLER       PIC X(4).
           03  MESS-X-NUM-3 PIC Z(8)9-.
           03  FILLER       PIC X(4).
           03  MESS-X-NUM-4 PIC Z(8)9-.

       01  MESS-X REDEFINES MESS.
           03  MESS-MESS    PIC X(30).
           03  MESS-X-MON-5 PIC Z(9).99-.

       01  MESS-X REDEFINES MESS.
           03  MESS-GL-SUB  PIC 99.
           03  FILLER       PIC XX.
           03  MESS-GL-SUB2 PIC 99.
           03  FILLER       PIC XX.
           03  MESS-GL-ACCT PIC 9(10).

      *================================================================*
      * END COPYBOOK: LIBGB\MESSWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\MKTEMPW_CMD.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/MKTEMPW
      **********************************************************
      *  LIMIT COMPLETE PATH TO 34 BYTES
      *  MKTEMP-STAR MAY BE USED IN
      *  REMOVING INDEXED TEMPS (FILE*)
      *  CREATED WITH MKTEMP-DEFAULT
      *  NOTE:
      *       DO NOT CHANGE THE CASE OF MKTEMP-DEFAULT
      *  REV:
      *  BLM 081020 ADDED DATA-MKTEMP-BUF FOR CREATING TMP FILES
      *             SOMEWHERE OTHER THAN /usr/tmp.  ON BIG
      *             SYSTEMS TMP FILES ON RAID IMPROVES I/O SPEED
      *             ON TMP FILES DRAMATICALLY.  THIS OPTION
      *             WILL ONLY BE IMPLEMENTED IN CERTAIN PROGRAMS
      *             FOR CERTAIN CUSTOMERS; TMP FILES WILL REMAIN
      *             IN /usr/tmp if /usr/data/r1/WK DIRECTORY
      *             DOESN'T EXIST
      *  BLM 120327 ADDED MKTEMP-TMP, PEOPLES PR# 769
      *  JKC 130430 FIXED FOR FULL PATHS IN A30
      *  BLM 140417 ADDED MKTEMP-SAVE-FORM-PATH
      *  JKC 230710 MOVED THIS TO BE MKTEMP_CMD.CPY SINCE THIS
      *             HAS LOWERCASE CHARACTERS;
      *             REMOVED THE FOLLOWING SINCE NOT USED:
      *               DATA-MKTEMP-BUF
      *               MKTEMP-TMP
      *               MKTEMP-SAVE-FORM-PATH
      *
      **********************************************************
       01  MKTEMP-DEFAULT             PIC X(15) VALUE "/usr/tmp/XXXXXX".
       01  MKTEMP-BUF.
           03  FILLER                 PIC X(15).
           03  MKTEMP-STAR            PIC X.
           03  FILLER                 PIC X(19).
       01  FILLER                     REDEFINES MKTEMP-BUF.
           03  FILLER                 PIC X(09).
           03  MKTEMP-NAME            PIC X(26).
       01  MKTEMP-BUF-RED             REDEFINES MKTEMP-BUF.
           03  FILLER                 PIC X(9).
           03  PROCESS-ID-BUF         PIC X(7).
           03  FILLER                 PIC X(19).
       01  MKTEMP-SAVE-FORM-PATH      PIC X(22).
      *================================================================*
      * END COPYBOOK: LIBGB\MKTEMPW_CMD.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GETPRW.CPY                           *
      *================================================================*
      ****************************************
      *A30 CONVERSION  STARTED
      *   GETPRW - PRINTER CONTROL WORKERS
      *   BEFORE MODIFICATION, SEE GB/TSTPRU
      *   GB/QUEUE, LIBGB/MKTEMPW, H_CMD.C
      ****************************************
      *01  PRU-POP-UP-WINDOW   PIC X(10).
       01  PRU-PATH            VALUE " ".
           03  PRU-CMD.
               05  PRU-LP      PIC X(3).
                   88  QUEUE-PIGGYBACK     VALUE "PRU" "DEV".
                   88  QUEUE-PRINTER       VALUE "   ".
                   88  QUEUE-TERMINAL      VALUE "VDU".
                   88  QUEUE-VIEW          VALUE "HLD".
               05  PRU-DASHD   PIC X(2).
               05  PRU-DEST    PIC X(10).
               05  FILLER      PIC X.
               05  PRU-DASHS   PIC X(2).
               05  FILLER      PIC X.
               05  PRU-DASHN   PIC X(2).
               05  PRU-COPIES  PIC 9(1).
               05  FILLER      PIC X(1).
      * USER FIELD NOT USED ON 3B2
               05  PRU-DASHA   PIC X(2).
               05  PRU-USER    PIC X(11).
           03  PRU-FILE.
               05  PRU-DIR     PIC X(17).
               05  PRU-PROG    PIC X(6).
               05  PRU-X       PIC X(6).
               05  FILLER      PIC X(25).
      *================================================================*
      * END COPYBOOK: LIBGB\GETPRW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\RBACTW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/RBACTW
      **************************************************************************
      *    REBATE CALCULATION WORKERS FOR RBACT FORMULA 'F' AND '0 6'
      *
      *REV:
      * JTG 091196 ADDED  RBACT-ELAPSED-UNITPER RBACT-ELAPSED-UNITPER-REM
      * JTG 021098 ADDED RBACT-EARN-FULL-MONTH, TFC #637
      *            RE: SP-EARNACCRL-FG() = 'B'
      * JTG 000104 ADDED RBACT-PENALTY-FG RE: SP-RBREDUC = 9999.04 WISCONSIN IB
      *            REAL ESTATE PREPAY PENALTY, WISCONSIN #1031
      * JTG 011026 CHANGED RBACT-APRATE TO RBACT-RATE FOR NEW REFUND FORMULA
      *            " 0  6 "                                      REGENCY PR#1631
      * BAH 161026 CHANGED RBDATE, REFDATE, INTDATE AND ORIG-1STPAY TO 9(8)
      **************************************************************************
      * INPUT FIELDS:
       01  RBACT-RBDATE           PIC 9(8)      COMP    VALUE 0.
       01  RBACT-REFDATE          PIC 9(8)      COMP    VALUE 0.
       01  RBACT-ORGTERM          PIC S9(5)     COMP    VALUE 0.
       01  RBACT-TOTCHG           PIC S9(6)V99  COMP    VALUE 0.
       01  RBACT-SKIPDEF-FG       PIC X                 VALUE " ".
       01  RBACT-EARN-FULL-MONTH  PIC X                 VALUE " ".
       01  RBACT-INTDATE          PIC 9(8)      COMP    VALUE 0.
       01  RBACT-ORIG-1STPAY      PIC 9(8)      COMP    VALUE 0.
       01  RBACT-TOTNODEF         PIC S9(3)     COMP    VALUE 0.
       01  RBACT-RATE             PIC 9(3)V9(3) COMP-3  VALUE 0.
       01  RBACT-REGPYAMT         PIC 9(6)V99   COMP-3  VALUE 0.
       01  RBACT-1STPYAMT         PIC 9(6)V99   COMP-3  VALUE 0.
       01  RBACT-LASTPYAMT        PIC S9(6)V99  COMP-3  VALUE 0.
       01  RBACT-UNITPER-CD       PIC X.
       01  RBACT-UNITPER-FREQ     PIC 999       COMP-3.
       01  RBACT-PENALTY-FG       PIC X.

      * OUTPUT WORKERS:
       01  RBACT-REBATE           PIC S9(7)V99    COMP-3.
       01  RBACT-PRES-VALUE       PIC S9(7)V99    COMP-3.

      * INTERNAL WORKERS:
       01  RBACT-ELAPSED-MONTHS      PIC S9(5)       COMP.
       01  RBACT-ELAPSED-REM         PIC S9(5)V9(10) COMP.
       01  RBACT-ELAPSED-DAYS        PIC S9(5)       COMP.
       01  RBACT-ELAPSED-UNITPER     PIC S9(5)       COMP.
       01  RBACT-ELAPSED-UNITPER-REM PIC S9(5)V9(10) COMP.
       01  RBACT-SUB                 PIC 99          COMP  VALUE 0.
       01  RBACT-SUB2                PIC 99          COMP  VALUE 0.
       01  RBACTF                    PIC S9V9(15)    COMP.
       01  RBACTF-ADJ                PIC S9V9(15)    COMP.
       01  RBACTT                    PIC S999        COMP.
       01  RBACTFP                   PIC S9(6)V99    COMP.
       01  RBACTRP                   PIC S9(6)V99    COMP.
       01  RBACTRP-A--N              PIC S999V9(15)  COMP.
       01  RBACTRP-N                 PIC S999        COMP.
       01  RBACTI                    PIC S999V9(15)  COMP.
       01  RBACTADJ                  PIC S999V9(15)  COMP.
       01  RBACTPV                   PIC S9(7)V99    COMP.
       01  RBACTLP-FAC               PIC S999V9(15)  COMP.
       01  RBACTLP-N                 PIC S999        COMP.
       01  RBACTLP                   PIC S9(6)V99    COMP.
       01  RBACT-FACTOR              PIC S9(3)V9(10) COMP.
      *================================================================*
      * END COPYBOOK: LIBGB\RBACTW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GPENVW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GPENVW
      ********************************************************
      *                    (GPENVW)
      *   GLOBAL PARAMETER RECORD ENVIRONMENT
      ********************************************************
       COPY "LIBGB/GB01GP.CPY".
      *================================================================*
      * END COPYBOOK: LIBGB\GPENVW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPEDPATH.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPEDPATH
      ******************************************************************
      *   EOD SPOOL AND FLAG PATHS
      *   NOTE, OPEN-PATH IS USED IN NOTES PAYABLE BUT
      *   NOT FROM THIS COPY MEMBER DUE TO CONFLICTS
      ******************************************************************
       01  ED-PATH                PIC X(20) VALUE " ".

      *=================================================================
      *    /USR/DATA/R#/DP/OP####D######
      *                      ^     ^
      *                      BRNO MMDDYY
      *=================================================================
       01  OPEN-PATH-OVERRIDE           PIC X(01)     VALUE SPACES.
       01  OPEN-PATH                    PIC X(50)     VALUE SPACES.
       01  OPEN-PATH-FORMAT.
           03  OPEN-PATH-BASE           PIC X(09).
           03  FILLER                   REDEFINES OPEN-PATH-BASE.
               05  OPEN-PATH-BASE-USR   PIC X(05).
               05  OPEN-PATH-BASE-DIR   PIC X(04).
           03  FILLER                   PIC X(01)   VALUE "/".
           03  OPEN-PATH-MACHINE        PIC X(02).
           03  FILLER                   PIC X(06)   VALUE "/DP/OP".
           03  OPEN-PATH-BRNO           PIC 9(04).
           03  OPEN-BR                  REDEFINES OPEN-PATH-BRNO
                                        PIC 9(04).
           03  FILLER                   PIC X(01)   VALUE "D".
           03  OPEN-PATH-TRDATE         PIC 9(06).
           03  OPEN-TRANS-DATE          REDEFINES OPEN-PATH-TRDATE
                                        PIC 9(06).
           03  FILLER                   PIC X(14).
      *================================================================*
      * END COPYBOOK: LIBLP\LPEDPATH.CPY                                *
      *================================================================*

      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\CONAME_EXT.CPY                           *
      *================================================================*
      ***************************************************************
      * 7/26/12  CONVERSION TO A30 COMPLETED
      *          NOTE- VERIFIED UP TO DATE.  DID NOT INCLUDE
      *             GEC-NON-MONTHLY-CAN-LOANS, BUT I COULDN'T FIND THIS
      *             FLAG BEING USED, SO I DIDN'T BRING IT OVER (FLAG
      *             ADDED BY JOHN, PR# J043
      *
      *                    (CONAME.EXT)
      *
      *   GLOBAL ENVIRONMENT CONAME BUFFER
      *
      * REV:
      *  MJD 000526 CONVERTED FOR A311
      *  MJD 120601 CHANGED CONAME BUF TO BE EXTERNAL.
      *             REMOVED "VALUE"'S FROM EXTERNAL WORKERS.  NOT ALLOWED.
      *  BLM 120723 ADDED CONAME-USER-GROUP AS PART OF CONAME-USER-NM
      *  MJD 121016 CHANGED CONAME.EXT-CONAME-BUF TO BE EXT-CONAME-BUF
      *             ADDED EXT- PREFIX TO ALL FIELDS COINTAINED IN THE BUFFER.
      *  KEC 121019 ADDED EXT-FILPATH.
      *  MJD 121029 ADDED EXT-MENU-OPTION-FG.   THIS WILL BE USED IN PLACES
      *             WHERE THE MENU WOULD SET A NON-DISPLAY OPTION FOR
      *             THE PROGRAM.  I.E. BYINQ TO DETERMINE SNAPSHOT/REAL-TIME.
      *  MJD 121214 ADDED HANDLE FOR MAIN TCLP INITIAL WINDOW.
      *  BAH 130109 ADDED BICREA-CALLED-FROM 
      *  MJD 130123 RENAMED 1 CHAR FILLER IN USER-ID WITH
      *             EXT-CONAME-USER-PROFILE-CD.
      *  BLM 131212 REDEFINE EXT-CONAME-SYSDATE TO HAVE
      *             EXT-CONAME-SYSDATE-MM, DD, YY
      *  BAH 140409 REMOVED FILLER OF 10 IN FRONT OF EXT-CONAME-BRANCH-NAME
      *              WAS CENTERING IT AND LOSING FIRST COUPLE CHARACTERS
      *              EXAMPLE: DISPLAYING "ARADATA", LOSING THE P
      *  MJD 140502 ADDED EXT-WIN WORKERS FOR WINDOW OFFSET AND SIZE IN VERYANT
      *  BAH 140512 ADDED EXT-SPANISH-FORMS FOR WORLD
      *  MJD ADDED MORE EXTRNAL WORKERS FOR WINDOWS.
      *      LABEL-OFFET THROUGH WCOLOR-005
      *  MJD 150121 ADDED NAMES TO FILLER LINES UNDER EXT-TERM-ATTRIBUTES
      *  BLM 150408 ADDED REDEFINITION OF EXT-FIL-PATH TO INCLUDE:
      *    EXT-FILPATH-LOCAL, EXAMPLE:     /USR/DATA/R1/SC0001/
      *    EXT-FILPATH-GLOBAL, EXAMPLE:    /USR/DATA/R1/
      *    ALSO ADDED EXT-FILPATH-SLASH2 (AFTER BRANCH)
      *
      * KEC 2015.1124 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED A REDEFINES ON EXT-FILPATH-BRANCH FOR
      *         THE FIELD NAME EXT-FILPATH-BRNO.
      *
      * KEC 2016.0502 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *         INCREASE EXT-MISC-LINK-BUF TO 12 BYTES DUE TO
      *          EXT-LAMENU-APP-NUMBER NEEDING MORE.
      *         EXT-LAMENU-APPNO CHANGED TO EXT-LAMENU-APP-NUMBER.
      *
      * KEC 2018-0822 LOAN APP MODULE REMOVAL FROM A30 [LARM30];
      *         LEAVING EXT-LAMENU-APP-NUMBER HERE IN CASE
      *         NEEDED IN THE FUTURE.
      *
      * KEC 2018-0926 ADDED EXT-RELEASE FOR A32 & A34 (4GL).
      *
      * KEC 2019-1105 THE A15-TO-A34 UPGRADE (UP1534) FOR WORLD MAY TAKE
      *               LONGER THAN ONE WEEKEND.  SO NEED A WAY TO
      *               DETERMINE WHAT IS A VISION FILE AND SQL TABLE.
      *               ADDED EXT-IO-FILE-TYPE AND ITS SUBORDINATE
      *               FIELDS WHICH WILL BE USED IN EACH FILE'S
      *               IO ROUTINE LOAD PARAGRAPHS TO BUILD THE
      *               SELECT PATH (??-SELECT-PATH).
      * BAH 2020-0610 ADDED A FIELD FOR TESTING SQL DATABASE VALUE FOR
      *               A ZERO 0 (NULL) DATE, SETENV WILL SET TO 19000101
      *
      * JKC 2020-0612 COMMENTED OUT THE FOLLOWING SINCE A GREP SHOWED
      *         THEY WERE NOT USED, WHILE MOVING EXT-MENU-OPTION-FG OUT
      *         OF THE GROUP LEVEL OF EXT-TERM-ATTRIBUTES (NOT SURE
      *         WHY IT IS THERE SINCE IT IS NOT A TERM ITEM):
      *            EXT-CONAME-AUTO-INS-EARN
      *            EXT-CONAME-EXTRACT-AUTO-UPD
      *            EXT-CONAME-BRGIFTNET
      *            EXT-TERM-ATTRIBUTES
      *            EXT-TERM-NAME
      *            EXT-TERM-ATTR-REVERSE
      *            EXT-TERM-HAS-REVERSE
      *            EXT-TERM-ATTR-BLINK
      *            EXT-TERM-HAS-BLINK
      *            EXT-TERM-ATTR-UNDERLINE
      *            EXT-TERM-HAS-UNDERLINE
      *            EXT-TERM-ATTR-DUAL-INTENSITY
      *            EXT-TERM-HAS-DUAL-INTENSITY
      *            EXT-TERM-ATTR-132-MODE
      *            EXT-TERM-HAS-132-MODE
      *            EXT-TERM-ATTR-COLOR
      *            EXT-TERM-HAS-COLOR
      *            EXT-TERM-ATTR-LINE-DRAW
      *            EXT-TERM-HAS-LINE-DRAW
      *            EXT-TERM-LINES
      *            EXT-TERM-COLUMNS
      *            EXT-TERM-ATTR-PIGGY
      *            EXT-TERM-HAS-PIGGY
      *            EXT-TERM-ATTR-VIS-ATTRIB
      *            EXT-TERM-HAS-VIS-ATTRIB
      *            EXT-TERM-ATTR-GUI
      *            EXT-TERM-HAS-GUI
      *            EXT-TERM-USABLE-SCRN-HEIGHT
      *            EXT-TERM-USABLE-SCRN-WIDTH
      *            EXT-TERM-PHYS-SCRN-HEIGHT
      *            EXT-TERM-PHYS-SCRN-WIDTH
      *            EXT-MISC-LINK-BUF
      *            EXT-LAMENU-APP-NUMBER
      *            EXT-LAMENU-CALLING-STAT
      *            EXT-RELEASE
      *            EXT-RELEASE-VISION
      * BAH 2020-0623 ADDED A4GL-WHERE-CONSTRAINT
      * JKC 2020-1023 CHANGED '01  PARADATA.';
      *               ADDED '03  PARADATA-REL-VERSION' WHICH WILL BE
      *               POPULATED BY REL ENVIRONMENT VARIABLE.
      * JKC 2020-1026 ADDED PARADATA-REL-VER-EXT.
      * JKC 2021-0114 ADDED ACUSQL CONNECTION VARIABLES:
      *               + EXT-ACUSQL-ODBC-NAME
      *               + EXT-ACUSQL-LOGIN
      *               + EXT-ACUSQL-PSWD
      *
      * JKC 2021-0726 ADDED EXT-SQL-CONNECT-STAT FOR CHECKING IF 
      *               CONNECTION TO SQL SERVER HAS ALREADY BEEN MADE;
      *               USED TO ONLY CONNECT ONE-TIME INSTEAD OF MULTIPLE
      *               TIMES IN EVERY PROGRAM.
      *
      * JKC 2021-0726 ADDED EXT-ACUSQL-CONNECT-STAT FOR CHECKING IF 
      * JKC 2021-0727 ADDED MORE ACUSQL CONNECTION VARIABLES:
      *               + EXT-ACUSQL-CONNECT-STAT
      *               - EXT-SQL-CONNECT-STAT
      *
      * BAH 2022-0314 REMOVED EXT-SPANISH-FORMS AND ALL MX FORMS
      * BAH 2022-0627 RENAMED EXT-ACUSQL-ODBC-NAME TO DSN-NAME
      * JKC 2022-0120 ADDED EXT-IO-AUFILE
      * BAH 2023-0504 REMOVED EXT-CONMAE-A50-CPCORP
      * JKC 2023-0901 ADDED EXT-TCLP-ACUMEM-WORKERS
      * JKC 2023-1114 ADDED EXT-ACUSQL-AUTOCOMMIT
      * JKC 2023-1127 REMOVED EXT-IO-FILE-TYPE AND ITS SUBORDINATES.
      *               FIELDS WHICH WILL BE USED IN EACH FILE'S
      *               IO ROUTINE LOAD PARAGRAPHS TO BUILD THE
      *               SELECT PATH (??-SELECT-PATH); NO LONGER NEEDED
      *               SINCE EVERYTHING WILL BE SQL WITH NO VISION.
      * JKC 2023-1212 ADDED EXT-ACUSQL-SERVER-WORKERS;
      *               + EXT-ACUSQL-DB-NAME
      *               + EXT-ACUSQL-SERVER-NAME
      *               + EXT-ACUSQL-VERSION
      * JKC 2023-1220 ADDED EXT-JULIAN-DATE-WORKERS;
      *               + EXT-JULIAN-BEG
      *               + EXT-JULIAN-END
      *               + EXT-JULIAN-CC
      * JKC 2024-0124 ADDED EXT-TCLP-TRACE-WORKERS;
      *               + EXT-TCLP-TRACE
      * JKC 2024-0131 ADDED MORE EXT-TCLP-TRACE-WORKERS
      *          + EXT-TCLP-TRACE-FORM-PATH
      *          + EXT-TCLP-TRACE-MESS
      *          + EXT-TCLP-TRACE-SKIP-YN
      * JKC 2024-0131 ADDED MORE EXT-TCLP-TRACE-WORKERS
      *          + EXT-TCLP-TRACE-LEVEL
      * JKC 2024-0404 CHANGED THE FOLLOWING:
      *          + EXT-FILLER-FUTURE-USE   PIC X(300).
      *          - EXT-WINDOW-CELL-HEIGHT           PIC 99.
      *          - EXT-WINDOW-CELL-WIDTH            PIC 99.
      *          - VDU-FIELD-PROMPT.
      *          - VDU-WIN-L-OFFSET
      *          - VDU-WIN-C-OFFSET
      *          - VDU-WIN-W-MOD
      *          - VDU-WIN-H-MOD
      *          - VDU-WCTRL-TCLP
      *          - VDU-WCTRL-FWIN
      *          - VDU-WCTRL-SCAN
      *          - VDU-WCTRL-EOINIT
      *          - EXT-WCTRL-005
      *          - VDU-WCOLOR-TCLP
      *          - VDU-WCOLOR-FWIN
      *          - VDU-WCOLOR-SCAN
      *          - VDU-WCOLOR-EOINIT
      *          - EXT-WCOLOR-005
      *          - VDU-LABEL-OFFSET
      *          - EXT-ACUSQL-AUTOCOMMIT  PIC X(01) EXTERNAL.
      *
      * JKC 2024-0501 ADDED EXT-API-WORKERS, EXT-API-SCREEN-DISABLE,
      *         EXT-API-MESS FOR FUTURE USE OF API PROGRAMS.
      *
      ******************************************************************

      ************************************************I***************
      * USED IN CONAME.XFER TO DISPLAY SYSDATE, COMPANY NAME AND
      * THE LOAN MANAGER ON MENUS
      ************************************************I***************
       01  NAM-LST              PIC X(15)     VALUE "SYSDATE CONAME.".
       01  PARA-LST             PIC X(9)      VALUE "PARADATA.".
       01  PARADATA-REL-VER-EXT PIC X(03)     EXTERNAL.
       01  PARADATA.
           03  FILLER PIC X(31) VALUE "THE LOAN MANAGER FINANCE SYSTEM".
           03  FILLER PIC X(02) VALUE " (".
           03  PARADATA-REL-VERSION
                      PIC X(03) VALUE "A##".
           03  FILLER PIC X(06) VALUE ")     ".

      ************************************************I***************

      * REMOVED FROM EOBUF
       01  EXT-ROUTE-BUF      PIC XX        EXTERNAL.


       01  EXT-CONAME-BUF                   EXTERNAL.
           03  EXT-CONAME-DAILY-PASSWORD       PIC 9(4).
           03  EXT-CONAME-RPT-LINES            PIC 99.
      * THIS COMES FROM ENV VARIABLE POSTNAME, IF SPACES, THEN LOGNAME
           03  EXT-CONAME-USER-ID.
               05  EXT-CONAME-USER-PROFILE-CD  PIC X.
               05  EXT-CONAME-USER-LOC         PIC 9(4).
               05  EXT-CONAME-USER-NM.
                   07  EXT-CONAME-USER-GROUP   PIC X(3).
                   07  FILLER                  PIC X(2).
               05  EXT-CONAME-USER-FILLER      PIC X(19).

           03  EXT-CONAME-NAM-DATA.
               05  EXT-CONAME-SYSDATE          PIC X(8).
               05  FILLER REDEFINES EXT-CONAME-SYSDATE.
                   07  EXT-CONAME-SYSDATE-MM   PIC 99.
                   07  FILLER                  PIC X.
                   07  EXT-CONAME-SYSDATE-DD   PIC 99.
                   07  FILLER                  PIC X.
                   07  EXT-CONAME-SYSDATE-YY   PIC 99.
      * USED IN CONAME-XFER AT THE GROUP 03 LEVEL
               05  EXT-CONAME-CONAME1.
                   07  EXT-CONAME-BRANCH-NAME  PIC X(40).

      * USED BY CONAM2.C
           03  EXT-CONAME-CONAME               PIC X(40).

           03  EXT-CONAME-BRNO-BUF             PIC ZZZZ.
           03  EXT-CONAME-NEW-COLL-INQUIRY     PIC X.
      *USED FOR CL/CLMENU NOT TO READ THE BRFILE
           03  EXT-CONAME-CAN-LOANS-FG         PIC X.
      *USED FOR CL/WIMENU NOT TO READ THE BRFILE
           03  EXT-CONAME-BALLOON-LOANS-FG     PIC X.
           03  EXT-MENU-OPTION-FG             PIC XX.

      *=================================================================
      *    EXT-FILPATH -- USED TO SET FULL FILE PATHS (SH/GLOBAL/LOCAL).
      *    GB/SETENV SETS THIS TO "FIL", PUTS FRONT "/" IN IT.
      *    EXAMPLE: /US2/DATA/R1/SC0001/GB
      *=================================================================
       01  EXT-FILPATH-EXTERNAL                EXTERNAL.
           03  EXT-FILPATH                     PIC X(35).
           03  FILLER                          REDEFINES EXT-FILPATH.
               05  EXT-FILPATH-SLASH           PIC X(01).
               05  EXT-FILPATH-FIL             PIC X(34).
           03  FILLER                          REDEFINES EXT-FILPATH.
               05  EXT-FILPATH-BASE            PIC X(09).
               05  EXT-FILPATH-BASEX REDEFINES EXT-FILPATH-BASE.
                   07  FILLER                  PIC X.
                   07  EXT-FILPATH-DIR1    PIC X(3).
                   07  FILLER              PIC X.
                   07  EXT-FILPATH-DIR2    PIC X(4).
               05  FILLER                      PIC X(01).
               05  EXT-FILPATH-MACHINE         PIC X(02).
               05  FILLER                      PIC X(01).
               05  EXT-FILPATH-DATA            PIC X(06).
               05  EXT-FILPATH-DATAX REDEFINES EXT-FILPATH-DATA.
                   07  EXT-FILPATH-STATE       PIC XX.
                   07  EXT-FILPATH-BRANCH      PIC 9999.
                   07  FILLER REDEFINES EXT-FILPATH-BRANCH.
                       09  EXT-FILPATH-BRNO    PIC 9999.
                   07  FILLER REDEFINES EXT-FILPATH-BRANCH.
                       09  EXT-FILPATH-BRANCH1 PIC 9.
                       09  EXT-FILPATH-BRANCH2 PIC 9(3).
               05  EXT-FILPATH-SLASH2          PIC X(01).
               05  FILLER                      PIC X(15).
           03  FILLER                          REDEFINES EXT-FILPATH.
      * EXT-FILPATH-LOCAL EXAMPLE:  /USR/DATA/R1/SC0001/
      * EXT-FILPATH-GLOBAL EXAMPLE: /USR/DATA/R1/
               05  EXT-FILPATH-LOCAL.
                   07  EXT-FILPATH-GLOBAL      PIC X(13).
                   07  FILLER                  PIC X(7).
               05  EXT-FILPATH-FILENAME        PIC X(15).

      *=================================================================
      * EXT-RELEASE -- USING ENVIRONMENT "REL" TO GET RELEASE
      * VERSION. USED FOR DETERMINING IF USING:
      * - VISION FILES [ A32 & A33; LOCAL-TO-GLOBAL; ]
      * - SQL DATABASE [ A34; GLOBAL TABLES; 4GL ]
      * PRIMARY USE IS FOR THE FILE SELECT (FS) COPY MEMBERS; FOR THE
      * 'SELECT XX-FILE ASSIGN TO XX-SELECT-PATH' WHERE THE PATH
      * VARIABLE IS SET WITHIN THE IO COPY MEMBERS.
      *=================================================================
      *01  EXT-RELEASE                         PIC X(03) EXTERNAL.
      *    88  EXT-RELEASE-VISION                  VALUE "A32" "A92".

      *=================================================================
      * ACUSQL CONNECTION VARIABLES -- USED TO FOR CONNECTING TO THE
      * SQL SERVER VIA ACUSQL; POPULATED VIA GB/SETENV
      *=================================================================
       01  EXT-ACUSQL-CONNECT-WORKERS      EXTERNAL.
           03  EXT-ACUSQL-DSN-NAME         PIC X(30).
           03  EXT-ACUSQL-LOGIN            PIC X(30).
           03  EXT-ACUSQL-PSWD             PIC X(30).
           03  EXT-ACUSQL-CONNECT-STAT     PIC X(02).
               88  EXT-ACUSQL-CONNECT-STAT-GOOD    VALUE "00".
               88  EXT-ACUSQL-CONNECT-STAT-BAD     VALUE "  " THRU "//"
                                                         "01" THRU "~~".
       01  EXT-ACUSQL-SERVER-WORKERS       EXTERNAL.
           03  EXT-ACUSQL-DB-NAME          PIC X(50).
           03  EXT-ACUSQL-SERVER-NAME      PIC X(50).
           03  EXT-ACUSQL-VERSION          PIC X(100).

      *=================================================================
       01  EXT-JULIAN-DATE-WORKERS         EXTERNAL.
           03  EXT-JULIAN-BEG              PIC 9(8)   COMP.
           03  EXT-JULIAN-END              PIC 9(8)   COMP.
           03  EXT-JULIAN-CC               PIC 9(2)   COMP.

      *=================================================================
       01 TCLP-WINDOW-HANDLES                  EXTERNAL.
          03 TCLP-MAIN-WINDOW-HANDLE           PIC X(10).

       01  EXT-TCLP-ACUMEM-WORKERS             EXTERNAL.
           03  EXT-TCLP-ACUMEM                 PIC X(01).
               88  EXT-TCLP-ACUMEM-DISABLED    VALUE "0".
               88  EXT-TCLP-ACUMEM-CREATE      VALUE "1".
               88  EXT-TCLP-ACUMEM-UPDATE      VALUE "2".
               88  EXT-TCLP-ACUMEM-VALID       VALUE "0" "1" "2".
           03  EXT-TCLP-ACUMEM-PID             PIC X(10).

       01  EXT-TCLP-TRACE-WORKERS              EXTERNAL.
           03  EXT-TCLP-TRACE                  PIC X(01).
               88  EXT-TCLP-TRACE-DISABLE      VALUE "N".
               88  EXT-TCLP-TRACE-BRANCH       VALUE "B".
               88  EXT-TCLP-TRACE-UPDATE       VALUE "B" "Y".
               88  EXT-TCLP-TRACE-VALID        VALUE "N" "B" "Y".

           03  EXT-TCLP-TRACE-FORM-PATH            PIC X(22).
           03  FILLER REDEFINES EXT-TCLP-TRACE-FORM-PATH.
               05  FILLER                          PIC X(1).
               05  EXT-TCLP-TRACE-FORM-REL         PIC X(7).
               05  FILLER            REDEFINES EXT-TCLP-TRACE-FORM-REL.
                   07  FILLER                      PIC X(4).
                   07  EXT-TCLP-TRACE-LOGUID-REL   PIC X(3).
               05  FILLER                          PIC X(1).
               05  EXT-TCLP-TRACE-FORM-OBJ         PIC X(2).
               05  FILLER                          PIC X(1).
               05  EXT-TCLP-TRACE-FORM-NAM.
                   07  EXT-TCLP-TRACE-FORM-DIRX    PIC X(2).
                   07  FILLER                      PIC X(1).
                   07  EXT-TCLP-TRACE-FORM-PROGX   PIC X(6).
               05  FILLER                          PIC X(1).

           03  EXT-TCLP-TRACE-LEVEL            PIC 9(02).
           03  EXT-TCLP-TRACE-MESS             PIC X(61).
           03  EXT-TCLP-TRACE-SKIP-YN          PIC X(1).


      *=================================================================
      * FOR API PROGRAMS:
      * + NEED SCREEN INTERACTIONS DISABLED (Y)
      * + NEED TO PASS SEND-MESS MESSAGES FROM CALLING PROGRAMS
      *   BACK TO KNOW WHAT TYPE OF ERRORS OCCURED.
      *=================================================================
       01  EXT-API-WORKERS                     EXTERNAL.
           03  EXT-API-SCREEN-DISABLE          PIC X(1).
           03  EXT-API-MESS                    PIC X(61).
           03  FILLER                          PIC X(100).

      * HAD TO ADD AS EXTERNAL, SORRY!
      * ONLY NEEDS TO BE FILLED IN FROM LNCRE2, BULKG2, BULKT2
      * NEEDED AS EXTERNAL CAUSE BICREA IS CALLED FROM LOAN I/O ROUTINES
      * SO I WOULD HAVE HAD TO ADD A NEW FIELD IN A TON OF PROGRAMS
       01  BICREA-CALLED-FROM                  PIC X(6) EXTERNAL.

       01  EXT-F12-OPEN                     PIC X(01) EXTERNAL.

      *=================================================================
      * THIS AREA IS FOR FUTURE USE WHEN NEEDING A NEW EXTERNAL.
      * CANNOT ADD A NEW EXTERNAL FIELD WITHOUT DOING A GLOBAL
      * RECOMPILE.  SO TAKE BYTES NEEDED FROM FILLER IN
      * EXT-FILLER-FUTURE-USE.
      *=================================================================
       01  EXT-FILLER-FUTURE-USE           PIC X(300) EXTERNAL.
      *01  FILLER REDEFINES EXT-FILLER-FUTURE-USE.
      *    03  EXT-??????                  PIC X(1).
      *    03  FILLER                      PIC X(299).
      *================================================================*
      * END COPYBOOK: LIBGB\CONAME_EXT.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\PRU_LNK.CPY                           *
      *================================================================*
      ******************************************************************
      *
      * PRINT LINK WORKERS
      *
      *=================================================================
      * REV:
      * BAH 130424 MADE 00 ONLY VALID PRINTER PRU-VALID
      * BAH 130606 ADDED P-CALLING-DIR AND P-CALLING-PROG FOR HELP
      *
      * JKC 2020-1026 ADDED P-TIMER-LINK-BUF.  USED FOR GB/TIMER.CBL
      *
      * SMR 2024-0401 ADDED P-TIMER-BEG-DATE TO BE USED FOR CALCULATING
      *          THE ELAPSED TIME IF THE END TIME CROSS OVER TO A NEW
      *          DAY.
      *
      ******************************************************************
       01  PRU-LINK.
      * PRINT FILE OPTIONS
      *--------?-POS: SCREEN POSITIONS FOR PRINT FIELDS.  [000000 = NON-DISP]
           03  Q-POS          PIC 9(6).
           88  Q-NONDISP                    VALUE ZEROS.
           88  Q-POS-VALID  VALUE 001001 THRU 001079 002001 THRU 002079
                                  003001 THRU 003079 004001 THRU 004079
                                  005001 THRU 005079 006001 THRU 006079
                                  007001 THRU 007079 008001 THRU 008079
                                  009001 THRU 009079 010001 THRU 010079
                                  011001 THRU 011079 012001 THRU 012079
                                  013001 THRU 013079 014001 THRU 014079
                                  015001 THRU 015079 016001 THRU 016079
                                  017001 THRU 017079 018001 THRU 018079
                                  019001 THRU 019079 020001 THRU 020079
                                  021001 THRU 021079 022001 THRU 022079
                                  023001 THRU 023079 000000.
           03  Q-POSITION REDEFINES Q-POS.
               05  Q-LINE     PIC 9(03).
               88  Q-LINE-VALID             VALUE 1 THRU 23.
               05  Q-COL      PIC 9(03).
               88  Q-COL-VALID              VALUE 1 THRU 79.
           03  Q-BUF          PIC X.
           88  Q-BUF-VALID                  VALUE "P" "V" "N".

           03  C-POS          PIC 9(6).
           88  C-NONDISP                         VALUE ZEROS.
           88  C-POS-VALID  VALUE 001001 THRU 001079 002001 THRU 002079
                                  003001 THRU 003079 004001 THRU 004079
                                  005001 THRU 005079 006001 THRU 006079
                                  007001 THRU 007079 008001 THRU 008079
                                  009001 THRU 009079 010001 THRU 010079
                                  011001 THRU 011079 012001 THRU 012079
                                  013001 THRU 013079 014001 THRU 014079
                                  015001 THRU 015079 016001 THRU 016079
                                  017001 THRU 017079 018001 THRU 018079
                                  019001 THRU 019079 020001 THRU 020079
                                  021001 THRU 021079 022001 THRU 022079
                                  023001 THRU 023079 000000.
           03  C-POSITION REDEFINES C-POS.
               05  C-LINE     PIC 9(03).
               88  C-LINE-VALID             VALUE 1 THRU 23.
               05  C-COL      PIC 9(03).
               88  C-COL-VALID              VALUE 1 THRU 79.
           03  C-BUF          PIC X(1).
           88  C-BUF-VALID                  VALUE "0" "1" "2" "3" "4"
                                                  "5" "6" "7" "8" "9".

           03  P-POS          PIC 9(6).
           88  P-NONDISP                    VALUE ZEROS.
           88  P-POS-VALID  VALUE 001001 THRU 001078 002001 THRU 002078
                                  003001 THRU 003078 004001 THRU 004078
                                  005001 THRU 005078 006001 THRU 006078
                                  007001 THRU 007078 008001 THRU 008078
                                  009001 THRU 009078 010001 THRU 010078
                                  011001 THRU 011078 012001 THRU 012078
                                  013001 THRU 013078 014001 THRU 014078
                                  015001 THRU 015078 016001 THRU 016078
                                  017001 THRU 017078 018001 THRU 018078
                                  019001 THRU 019078 020001 THRU 020078
                                  021001 THRU 021078 022001 THRU 022078
                                  023001 THRU 023079 000000.
           03  P-POSITION REDEFINES P-POS.
               05  P-LINE     PIC 9(03).
               88  P-LINE-VALID             VALUE 1 THRU 23.
               05  P-COL      PIC 9(03).
               88  P-COL-VALID              VALUE 1 THRU 79.
           03  P-BUF          VALUE SPACES.
               05  PRU          PIC 99.
               88  PRU-VALID              VALUE 00.

      * NEEDED CALLING PROGRAMS DIR AND PROG FOR HELP FILES
           03  P-CALLING-DIR    PIC XX.
           03  P-CALLING-PROG   PIC X(6).

      *=================================================================
      * P-TIMER-LINK-BUF IS AN EXACT COPY IN LIBGB/TIMER_LNK.CPY
      * P-TIMER-LINK-BUF IS AN EXACT COPY IN LIBGB/TIMEWK.CPY
      * ANY CHANGE HERE MUST BE MADE IN THE OTHER COPY MEMBERS!!!!!
      *=================================================================
           03  P-TIMER-TYPE-SET             PIC X(1).
               88  P-TIMER-TYPE-SET-VALID   VALUE "E" "R" "U".

           03  P-TIMER-LINK-BUF.
               05  P-TIMER-STAT             PIC X(02).
               05  P-TIMER-BEG-DATE         PIC 9(08).
               05  P-TIMER-DAYSEC-BEG       PIC 99V9(7).
               05  P-TIMER-DAYSEC-END       PIC 99V9(7).
               05  P-TIMER-DAYSEC-ELAPSED   PIC 99V9(7).
               05  P-TIMER-BEG-EDIT.
                   07  P-TIMER-BEG-HHMMSS   PIC 99/99/99.
                   07  FILLER               PIC X(01).
                   07  P-TIMER-BEG-AMPM     PIC X(02).
               05  P-TIMER-END-EDIT.
                   07  P-TIMER-END-HHMMSS   PIC 99/99/99.
                   07  FILLER               PIC X(01).
                   07  P-TIMER-END-AMPM     PIC X(02).
               05  P-TIMER-ELAPSED-EDIT     PIC 99/99/99/99.
               05  P-TIMER-TYPE             PIC X(1).
                   88  P-TIMER-TYPE-EXCEL   VALUE "E".
                   88  P-TIMER-TYPE-REPORT  VALUE "R".
                   88  P-TIMER-TYPE-UTILITY VALUE "U".
                   88  P-TIMER-TYPE-VALID   VALUE "E" "R" "U".

      *================================================================*
      * END COPYBOOK: LIBGB\PRU_LNK.CPY                                *
      *================================================================*
       01  BT-REC.
           03  BT-BRANCH             PIC 9(04).
           03  BT-ACCTNO             PIC 9(06).
           03  BT-AMT                PIC 9(08)V9(02).
           03  FILLER REDEFINES BT-AMT.
               05  BT-SIGN           PIC X.
               05  BT-AMT2           PIC 9(07)V9(02).
           03  BT-SIGNED-AMT REDEFINES BT-AMT
                                     PIC S9(08)V9(02).
           03  BT-REFCD              PIC X(05).
           03  BT-PAYDATE            PIC 9(06).
           03  BT-TRCD               PIC X(2).


       01  FORM-PATH.
           03  FILLER         PIC X.
           03  FORM-REL       PIC X(7).
           03  FILLER REDEFINES FORM-REL.
               05  FILLER     PIC X(4).
               05  LOGUID-REL PIC X(3).
           03  FILLER         PIC X.
           03  FORM-OBJ       PIC XX.
           03  FILLER         PIC X.
           03  FORM-NAM.
               05  FORM-DIRX  PIC XX.
               05  FILLER     PIC X.
               05  FORM-PROGX PIC X(6).
           03  FILLER         PIC X.
       01  FORM-PATHNAME     PIC X(22).
       01  EXIT-PATHNAME     PIC X(22).
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLOANW.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLOANW
      ******************************************************************
      *            (LPLOANW)                   SIZE = 356
      *     C O M M O N  LONP  M E M O R Y
      *
      *=================================================================
      * REV:
      *  JTG 021106 BATCH PAYMENT REVISIONS ADDED BATCH-REFCD       REGACC #0006
      *  JTG 021114 BATCH PAYMENT REVISIONS ADDED BATCH-REFCD-LC-FG REGACC #0006
      *  JTG 021121 BATCH PAYMENT REVISIONS ADDED BATCH-REFCD-FILE-TYPE
      *                                                             REGACC #0006
      *  BLM 120725 CHANGED FILLER UNDER USERID TO USER-LETTER1, REGACC PR# 316
      *  BAH 130417 ADDED PRLOAN-RESTRICTED FOR LONPC0 TO PASS LONPC2
      *  BAH 130418 ADDED GN-GIFTNET-INFO
      *
      * KEC 2016.0427 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *          IN A15, LOAN APP NUMBER (MA-APPNO) WAS STORED IN
      *           LOAN-KEY.
      *          IN A30, LOAN APP NUMBER (MA-APP-NUMBER) IS STORED IN
      *           LOAN-KEY BUT WAS INCREASED TO 9 BYTES ALONG WITH
      *           ADDING REDEFINES FOR APPLICATION-KEY.  COULD NOT
      *           USE BORROWER-KEY SINCE PROGRAMS WERE ALREADY USING
      *           LOAN-KEY FOR LOAN APPLICATIONS.
      * BAH 160818 REDEFINED LOAN-KEY FOR CHECK WRITING, USED TO USE THE
      *            LN-SEQNO TO DETERMINE TYPE OF CHECK AND TO FIND IT IN 
      *            THE FM-FILE AND CX-FILE BY USING LN-ACCTNO/LN-SEQNO, SO
      *            NOW IT WILL USE LOAN-KEY REDEF.
      * BLM 170213 CHANGE TRANS-DATE TO BE CCYYMMDD, PD0006
      * KEC 180823 LOAN APP MODULE REMOVAL FROM A30 [LARM30]
      * BAH 2024.0409 REMOVED GN-GIFTNET-INFO 
      ******************************************************************
       01  PROG-BUF.
           03  ERRCD                      PIC X(1).
           03  NEW-PROG-FORM.
               05  NEW-PROG.
                   07  FILLER             PIC X.
                   07  NEW-PROG-SUB       PIC X.
               05  NEW-FORM               PIC X(1).
           03  OLD-PROG-FORM.
               05  OLD-PROG               PIC X(2).
               05  OLD-FORM               PIC X(1).
           03  ROUTE-CD                   PIC X(1).

           03  TRANS-DATE                 PIC 9(8).
           03  FILLER                     REDEFINES TRANS-DATE.
               05  TRANS-DATE-YYYYMM      PIC 9(6).
               05  FILLER REDEFINES TRANS-DATE-YYYYMM.
                   07  TRANS-CC           PIC 99.
                   07  TRANS-YEAR         PIC 99.
                   07  TRANS-MONTH        PIC 99.
               05  TRANS-DAY              PIC 99.

           03  BRANCH                     PIC 9(4).

           03  LOAN-KEY                   PIC 9(9).
           03  LOAN-KEYX               REDEFINES LOAN-KEY.
               05  LOAN-KEY-SEQNO         PIC 9(7).
               05  LOAN-KEY-TYPE          PIC 99.

           03  BORROWER-KEY               PIC 9(9).
           03  LPLOAN-CONAME              PIC X(20).
           03  LPLOAN-SYSDATE             PIC X(8).
           03  LPLOAN-USERID.
               05  LPLOAN-USER-LETTER1    PIC X.
               05  LPLOAN-USER-BRANCH     PIC 9(4).
               05  LPLOAN-USER-NAME       PIC X(5).
           03  USER-PID                   PIC X(7).
           03  BATCH                      PIC 999.
           03  TRANS-CODES                PIC 99.
           03  NEW-SUB-MENU-FORM          PIC XXX.
           03  BATCH-REFCD                PIC X(5).
           03  BATCH-REFCD-LC-FG          PIC X.
           03  BATCH-REFCD-FILE-TYPE      PIC X(2).
           03  PRLOAN-RESTRICTED          PIC X.

           03  ADDON-LN-ACCTNO         PIC 9(8) COMP.
           03  LPLOAN-CALLED-FROM      PIC X(6).
      * ADDED THIS FOR LNCREA TO CALL LONPB2
           03  LPLOAN-RETURN-ERR-BUF   PIC X(55).

           03  FILLER                  PIC X(50).
      *================================================================*
      * END COPYBOOK: LIBLP\LPLOANW.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPFBUF.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPFBUF
      ********************************************************************
      *                   (LIBLP/LPPFBUF)
      *    LONPF'N'      INTERPROGRAM MEMORY BUFFER
      *    WHEN ADDING TO A NEW PROGRAM, UPDATE THIS HEADER
      *    USED IN LONPF1,
      *
      *
      * REV:
      *  JTG 050289 ADDED BP-TRCD FOR BATCH PAYMENTS
      *  SLC 051289 ADDED HOLD-NEW-1ST-DUE FOR "DC".
      *  JTG 051589 ADDED HOLD-DL-PARVHELD-CODE + MORE FILLER
      *  JTG 102489 ADDED HOLD-PRDELINQAMT
      *  JTG 081090 ADDED ADDON-INT-REBATE & ADDON-INT-EARNED
      *             FOR MULLEN
      *  JTG 073192 ADDED INTERRUPT-FG
      *  BAH 030293 REMOVED PRINT-RECEIPT
      *  JTG 071995 ADDED HOLD-PRPDUE-DAYS
      *  SLC 072195 ADDED CONV-REV-FLAG FOR REVERSING CONVERTED TRANSACTIONS.
      *  JTG 081695 ADDED CONV-AMT-PAID-LAST CONV-DATE-PAID-LAST
      *                   CONV-LCPDTH-DATE CONV-INTPDTH
      *  JTG 042996 ADDED HOLD-AFPDLLP RAC----AFP ACCOUNTS)
      *  JTG 101196 ADDED HOLD-EARNINGS-IB-OWING
      *                   HOLD-EARNINGS-IB-ERNINT
      *                   HOLD-EARNINGS-IB
      *               FOR SP-ERNFRMLA 15/16 REAL INTEREST BEARING METHOD
      *                                      - INSTANT AUTO, KY
      *                                      - FAIRCO, FL
      *  JTG 060397 EXPANDED THE FOLLOWING FOR 03,04,05
      *             03  REB-AMOUNT        OCCURS 10  -> 13
      *             03  U-INSOURS         OCCURS 5   -> 8
      *             03  INS-RB-TBL        OCCURS 5   -> 8
      *  BAH 100997 CHANGED REB-AMOUNT FROM S9(5)V99 TO S9(7)V99 FOR LARGE
      *             REBATES OF INTEREST, STORAGE SIZE STILL 4 BYTES..
      *  BAH 021798 EXPANDED HOLD-LP1-SEQNO FROM 9(3) TO 9(4).
      *  JTG 110598 EXPANDED BUFFER TO 500 BYTES FOR REVOLVING AND
      *             ADDED HOLD-RADDON FIELDS AND ADDED "UP5"
      *  JTG 120198 ADDED HOLD-APOTH-AMT FIELDS FOR REVOLVING PAYMENTS
      *             AND EXPANDED TO 720 BYTES
      *  MJD 990201 ADDED 12 BYTES TO FILLER, SIZE WAS 708, SCREEN
      *             BUFFERS WERE 720.
      *  JTG 990701 ADDED HOLD-PAYEE HOLD-REASON REVOLVING ADVANCE
      *  JTG 991123 ADDED HOLD-ONESTEP-RN-BUF FOR ONE STEP RENEWALS
      *  JTG 001121 ADDED HOLD-OVPAID-CHECK  (AMOUNT TO PAY RE: OVERPAID PAYOFF)
      *  BAH 010619 ADDED HOLD-REPO-AUCTION-EXP FOR "SS", REGACC PR# 1478
      *  JTG 011004 ADDED HOLD-LXZ(FIELDS) FOR UPDATE LX-Z RECORD
      *             ADDED NEW RATE TYPE 'Z' AMORTIZED WHERE RUNTIME COMPUTES
      *             INTEREST ON A 30 DAY METHOD (REAL ESTATE) AND LOAN CALCS
      *             ARE DONE SIMPLE, REMOVED TIE TO CTBL, FORCING TESTS ON (1)
      *                                             LENDMARK PR#1045 & PR#1380
      *  JTG 020308 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *             ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *             ADDED HOLD-INS-TAX-RB() OCCURS 8 S9(7)V99 REFUNDS WORLD #288
      *  JTG 020603 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *             ADDED HOLD-LXM-MIP-CLPAID HOLD-LXM-MIP-CLPDTH
      *                   HOLD-LXM-MIP-AHPAID HOLD-LXM-MIP-AHPDTH
      *  BAH 020626 ADDED HOLD-PLREASON FOR REGACC , PR# 1775
      *  CS  020809 REDEFINED HOLD-RADDON-FIELDS TO HOLD TYPE 'PU' THAT ARE
      *             SPECIAL REVOLVING PROGRAMS (HOLD-PU-RVPROG OCCURS 4)
      *             [PR# 1877 LENDMARK]
      *  CS  020819 ADDED ANOTHER TABLE FOR REVLVING PROGRAMS TO HOLD NEW
      *             PRGRAMS
      *  CS  020820 CHANGED TO INCORPORATE ORIGINAL CALCULATED DEFAULTS &
      *             USER INPUTS IN THE SAME TABLE
      *  CS  030409 ADDED HOLD-NFE-CK-NUMBER CASHCO PR# 2034.
      *  JTG 050316 ADDED LOGIC TO SET 'LP-REFNO' IN THE PAYMENT RECORD TO
      *             THE VALUE THE CUSTOMER TYPED WHEN REVERSING. WILL CHANGE
      *             LONPF2.C TO SET 'TP-REFNO' TO THE VALUE OF LP-REFNO
      *             BEFORE LP-REFNO WAS ALTERED TO VALUE CUSTOMER TYPED.
      *                                                            CENTRIX #2466
      *   CS 070411 ADDED HOLD-REPO-AUCTION-NAME REGACC PR#168
      *   CS 120806 ADD HOLD-PRIOR-DF-CODE, HOLD-PRIOR-DF-POSTDATE PR#318
      *                                                     REGACC
      *  BAH 121114 ADDED PATH-BUF TO THIS TO PASS BETWEEN PROGRAMS
      *  BAH 130107 ADDED TP-BUF TO THIS TO PASS BETWEEN PROGRAMS
      *   CS 130429 ADDED HOLD-TDR1, HOLD-TDR2, HOLD-TDR2-ERR PR#338
      *   CS 151207 CHANGED HOLD-LP1-SEQ TO 9(5) A30 ONLY
      *   CS 151208 CHANGED HOLD1-KEY-DOWN, HOLD2-KEY-UP TO X(13) FROM X(12)
      *             TO ACCOMODATE LP-SEQNO IS NOW 9(5)
      *   CS 160302 ADD HOLD-ALT-PREPAY-FG, SET TO "Y" WHEN THE CUSTOMER IS
      *             PREPAID BY SP-ALT-PREPAY-MONTHS WORLD 1140
      *  BLM 160429 ADDED HOLD-BNKRPT-CASE-NO, HOLD-BNKRPT-STATUS,
      *             WORLD PR# 1151
      *  MJD 160613 ADDED HOLD-LXR-REB-AMT: AMOUNT OF THE SERVICE CHARGE THAT
      *             IS THE GEORGIA 4% CLOSING FEE EARLY PROVISION CALCULATED 
      *             IN REBATE-EP54 IN LIBGB/REBATE                  REGMGT #4915
      *  BAH 160701 CHANGED DATES TO 9(8)
      *  BLM 160728 CHANGED HOLD-SP1-KEY FROM 8 TO 9
      *  BAH 170417 REMOVED CONV-INTPDTH, NOT USED ANYWHERE
      *  BAH 181219 GLOBAL LPFILE, HOLD1-KEY-DOWN, HOLD2-KEY-UP, 
      *             HOLD-LP1-KEY FROM 13 TO 17
      * BAH 20190627 REMOVED REVOLVING HOLD-RADDON* HOLD-PU* HOLD-AP*, PT0153
      * BAH 20190701 REMOVED U-INSOURS,AVAILABLE-CREDIT FROM LPPFBUF
      * BAH 20201029 CHANGED HOLD-PARTIALS AND HOLD-LCPAID FROM S9(5) TO S9(7)
      * BAH 20240410 REMOVED HOLD-TDR1, HOLD-TDR2, HOLD-TDR2-ERR,
      *              HOLD-NFE-CK-NUMBER
      **************************************************************************
       01  UPDATE-BUF.
           03  ENTRY-FLAG                PIC 9.
           03  BYPASS-AMT-ENT-FG         PIC 9.
           03  FULL-DISPLAY              PIC X.
           03  REV-REBATE                PIC X.
           03  MAKER-CD                  PIC X.
           03  PD1-EXISTS                PIC X.
           03  FULL-PAGE-FG              PIC X.
           03  ENTER-AMT-FG              PIC X.
           03  INTERRUPT-FG              PIC X.
      * HOLD-DISPLAY-ERN HOLDS LC-DISPLAY-ERN, SO JUST READ THE LCFILE
           03  HOLD-DISPLAY-ERN          PIC X.
           03  HOLD-POCD                 PIC XX.
           03  HOLD1-KEY-DOWN            PIC X(17).
           03  HOLD2-KEY-UP              PIC X(17).
           03  HOLD-LP-REFNO             PIC X(5).
           03  FILLER                   REDEFINES HOLD-LP-REFNO.
               05  FILLER                PIC X.
               05  HOLD-LP-REFNO-BA      PIC 9(4).
           03  HOLD-SP1-KEY              PIC X(9).
           03  HOLD-LP1-KEY.
               05  HOLD-LP1-BRNO         PIC 9(4).
               05  HOLD-LP1-ACCTNO       PIC 9(8).
               05  HOLD-LP1-SEQNO        PIC 9(5).

           03  HOLD-PARTIALS             PIC S9(7)V99 COMP.
           03  HOLD-LCPAID               PIC S9(7)V99 COMP.
           03  HOLD-DLRVCHGS-ADJ      OCCURS 3
                                         PIC S9(5)V99 COMP.
           03  HOLD-DLPARVHELD-ADJ       PIC S9(5)V99 COMP.
           03  HOLD-DLPARVPAID-ADJ       PIC S9(5)V99 COMP.
           03  HOLD-LN-ACCERN         OCCURS 6
                                         PIC S9(7)V99 COMP.
           03  HOLD-LN-TOTINT            PIC S9(7)V99 COMP.
           03  HOLD-LN-TOTERN            PIC S9(7)V99 COMP.
           03  HOLD-LN-TOTDFMNTS         PIC S9(7)V99 COMP.
           03  HOLD-LN-TOTLCHG           PIC S9(7)V99 COMP.
           03  HOLD-LN-TOTSERACCT        PIC S9(6)V99 COMP.
           03  HOLD-LN-JDRATE            PIC 999V999  COMP.
           03  HOLD-NEW-1ST-DUE          PIC 9(8)     COMP.

      *-------------------------------------------------------
      *                REB-AMOUNT()
      *        1 -  CL             8 -  N/A
      *        2 -  AH             9 -  O1
      *        3 -  PP            10 -  O2
      *        4 -  INT           11 -  O3
      *        5 -  SC            12 -  O4
      *        6 -  MF            13 -  O5
      *        7 -  DF
      *-------------------------------------------------------
           03  REB-AMOUNT               OCCURS 13
                                         PIC S9(7)V99 COMP.

      *-------------------------------------------------------
      *                   INS-RB-TBL()
      *
      *        1 -  CL             5 -  O2
      *        2 -  AH             6 -  O3
      *        3 -  PP             7 -  O4
      *        4 -  O1             8 -  O5
      *-------------------------------------------------------
           03  INS-RB-TBL           OCCURS 8
                                         PIC X.
      *-------------------------------------------------------

           03  HOLD-BP-TRCD              PIC XX.
           03  HOLD-DL-RVCHGS-CODE      OCCURS 3
                                         PIC X.
           03  HOLD-DL-PARVHELD-CODE     PIC X.
           03  HOLD-DL-PARVPAID-CODE     PIC X.
           03  HOLD-PRDELINQAMT          PIC S9(7)V99 COMP.
           03  ADDON-INT-REBATE          PIC S9(6)V99 COMP.
           03  ADDON-INT-EARNED          PIC S9(6)V99 COMP.
           03  MAX-DEFER-FG              PIC X.
           03  HOLD-PRPDUE-DAYS          PIC S9(5)    COMP.
           03  CONV-REV-FLAG             PIC X.
           03  CONV-AMT-PAID-LAST        PIC 9(6)V99  COMP.
           03  CONV-DATE-PAID-LAST       PIC 9(8)     COMP.
           03  CONV-LCPDTH-DATE          PIC 9(8)     COMP.
           03  HOLD-AFPDLLP              PIC S9(6)V99 COMP.
           03  HOLD-EARNINGS-IB-OWING    PIC S9(6)V99 COMP.
           03  HOLD-EARNINGS-IB-ERNINT   PIC S9(6)V99 COMP.
           03  HOLD-EARNINGS-IB          PIC S9(6)V99 COMP.
      *-----------------------------------------------------------------
           03  HOLD-ONESTEP-RN-BUF.
               05  HOLD-ONESTEP-RN-FG    PIC X.
           03  HOLD-OVPAID-CHECK         PIC S9(7)V99 COMP.
           03  HOLD-REPO-AUCTION-EXP     PIC S9(7)V99 COMP.

      *-------------------------------------------------------
      *                HOLD-INS-TAX-RB()
      *        1 -  CL             5 -  O2
      *        2 -  AH             6 -  O3
      *        3 -  PP             7 -  O4
      *        4 -  O1             8 -  O5
      *-------------------------------------------------------
           03  HOLD-INS-TAX-RB          OCCURS 8
                                         PIC S9(7)V99 COMP.

           03  HOLD-PLREASON             PIC XX.
           03  HOLD-REV-LP-REFNO         PIC X(5).
           03  HOLD-PRIOR-DF-CODE        PIC X(2).
           03  HOLD-PRIOR-DF-POSTDATE    PIC 9(8)     COMP.
           03  HOLD-BNKRPT-CASE-NO       PIC X(9).
           03  HOLD-BNKRPT-STATUS        PIC X.
           03  HOLD-LXR-REB-AMT          PIC S9(7)V99 COMP.

      *-----------------------------------------------------------------
      *    WORKERS FOR MONTHLY INSURANCE PREMIUM PAYMENT INFO
      *-----------------------------------------------------------------
           03  HOLD-LXM-MIP-CLPAID       PIC S9(7)V99 COMP.
           03  HOLD-LXM-MIP-CLPDTH       PIC 9(8)     COMP.
           03  HOLD-LXM-MIP-AHPAID       PIC S9(7)V99 COMP.
           03  HOLD-LXM-MIP-AHPDTH       PIC 9(8)     COMP.

      *-----------------------------------------------------------------
      *    WORKERS FOR AMORTIZED INTEREST (Z) PAYMENT INFO
      *-----------------------------------------------------------------
           03  HOLD-LXZ-POST-REGPY       PIC S9(7)V99 COMP.
           03  HOLD-LXZ-POST-EXTRA-PRIN  PIC S9(7)V99 COMP.
           03  HOLD-LXZ-POST-OTH         PIC S9(7)V99 COMP.
           03  HOLD-LXZ-POST-LCHG        PIC S9(7)V99 COMP.

           03  HOLD-LXZ-PDUE-APINT       PIC S9(7)V99 COMP.
           03  HOLD-LXZ-PDUE-APPRIN      PIC S9(7)V99 COMP.
           03  HOLD-LXZ-CUR-APINT        PIC S9(7)V99 COMP.
           03  HOLD-LXZ-CUR-APPRIN       PIC S9(7)V99 COMP.

           03  HOLD-REPO-AUCTION-NAME        PIC X(30).
           03  HOLD-ALT-PREPAY-FG            PIC X. 

      * THESE WERE PART OF PATH-BUF AND WERE XFER/FLDVAL IN LONPF'S AND
      * INTERBRANCH
      * LP/INBRTR MOVES POSTING BRANCHES DATA PATH INTO HERE
           03  PATH-MACHINE                  PIC X(2).
           03  PATH-DATA                     PIC X(6).
           03  PATH-DATAX REDEFINES PATH-DATA.
               05  PATH-STATE                PIC XX.
               05  PATH-BRANCH               PIC 9(4).
      * ADDED FROM LONPFA, LONPFB AND LONPF2 FLDVAL
           03  MS-PENALTY                    PIC S9(5)V99.

           03  TP-BUF.
               05  HOLD-LN-DLRVPRIN    OCCURS 3
                                       PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-ANTIC-DISC  PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-ANTIC-INT   PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-ANTIC-SC    PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-ANTIC-MF    PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-PROCEEDS    PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-PARTRCAMT   PIC S9(7)V99  VALUE 0.
               05  HOLD-LN-RECOURSE    PIC X         VALUE " ".
               05  HOLD-CKNO           PIC 9(6)      VALUE 0.
               05  HOLD-CKCODE         PIC X         VALUE " ".
               05  HOLD-FREE1          PIC X(70)     VALUE " ".
               05  HOLD-FREE2          PIC X(70)     VALUE " ".

           03  TS-BUF.
               05  HOLD-NEW-DLNO       PIC S9(4)V99 VALUE +0.

           03  ADDON-PRIOR-NODEF       PIC S9(3)     VALUE 0.
      *================================================================*
      * END COPYBOOK: LIBLP\LPPFBUF.CPY                                *
      *================================================================*

       01  INPUT-STRING              PIC X(33).
       01  REPAY-TRANS-ID            PIC 9(10).


       PROCEDURE DIVISION 
             CHAINING INPUT-STRING REPAY-TRANS-ID.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
              WK-FILE OP-FILE LOG-FILE.
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DECLARE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/DECLARE
      * 7/26/12  CONVERSION TO A30 COMPLETED
      ***********************************************************************
      * REV:
      *  JTG 000508 ADDED LOGIC FOR SECOND ERROR MESSAGE TO INFORM
      *             OPERATOR TO STOP AND CALL SUPPORT          PARADATA #1171
      *  BLV 000619 SET PIGGY-BACK-FLAG & EXIT IF COMING FROM LONPMC - SO
      *             LONPMC CAN HANDLE FILE ERRORS WITHOUT LOCKING UP
      *  BLV 021023 ADD CHECK ON FILE-STAT 99, IF ERROR-LOCK-FG = "Y"
      *             DON'T LOOP THROUGH 10 TIMES & GIVE RECORD LOCKED WINDOW.
      *             THIS IS FOR SPECIAL SITUATIONS IN WHICH YOU WANT TO
      *             HANDLE THE LOCKING IN YOUR PROGRAM.  FOR EXAMPLE, YOU
      *             JUST WANT TO GIVE A MESSAGE THAT THE RECORD IS BUSY &
      *             TO SELECT ANOTHER INSTEAD OF TRYING 10 TIMES & STAYING
      *             IN THE RECORD LOCKED LOOP.  TO USE THIS, YOU MUST CHANGE
      *             THE IO-ROUTINE - WHERE IS LOOPS TO THE READ ON AN IO-FG
      *             OF 8, CHANGE TO DO THIS ONLY "IF ERROR-LOCK-FG NOT = Y".
      *             THEN ON THE READ IN QUESTION, YOU MUST MOVE "Y" TO THE
      *             FLAG BEFORE THE READ AND BE SURE TO SET IT BACK TO "N"
      *             OR BLANK AFTER THE READ.  I'M TRYING THIS IN GL/JRENT...
      *  BLF 051012 ADDED - MOVE "E" TO ERRCD - IN FILE-ERRORS-TERMINATE
      *             RIGHT BEFORE PERFORM OF CLOSE-FILES.  WHEN YOU WERE
      *             GETTING A BAD ERROR IN LONPF2, FOR EXAMPLE, AN OPEN
      *             ERROR OF 98, AFTER LOGGING ERROR IN LG & DISPLAYING
      *             ERROR WINDOW, THE LONP WOULD JUST SEND YOU BACK INTO
      *             LONPF2 AGAIN.  THIS WAS BECAUSE ERRCD WAS STILL A
      *             "P" AND PROGRAM DIDN'T CHANGE.  SO YOU GO BACK INTO
      *             LONPF2 & IT SAYS "LOAN HAS BEEN CHANGED, RE-INPUT
      *             CHANGES" WHICH ENCOURAGES USERS TO KEEP POSTING
      *             OVER & OVER & MAKING A MESS!!!  BETH & I TESTED,
      *             IT EVEN PERFORMED THIS WAY IN A60, NOT SURE WHEN
      *             IT STOPPED GOING TO "ERROR IN LOAN PROCESSING".
      *  BLF 051013 IF FILE STATUS IS 98 & USER IS IN LOAN PROCESSING,
      *             MOVE "Z" TO ERRCD, WHICH WILL CAUSE LONP TO LOG
      *             USER OFF
      *  BLM 120726 BROUGHT DECLARE OVER FROM A15 & REDID ALL CHANGES FOR
      *             NEW RELEASE
      *  MJD 130117 COMMENTED OUT CALL-TMMSG AND CALL-TMRSP PARAGRAPHS.
      *             THEY WILL INSTEAD BE PUT INTO COPYBOOKS.
      *  BAH 130312 CHANGED CALL SUSP TO CALL "C$SLEEP"
      *  BAH 130320 UNCOMMENTED ALARM, SHOULD WORK USING DISPLAY BEEP
      *  BLM 130530 FIXED RESET-MESS, WILL RESET LIST OF FIELDS IN MESS
      *             TO SPACES.
      *  BLM 130605 REMOVED RESET-MESS, PUT IN LIBGB/SCREEN
      *  BLM 131031 STARRED OFF TMRSP
      *  BLM 140507 CHANGED TO DISPLAY MESSAGE BOX FOR SEND-MESS INSTEAD OF
      *             CALLING GB/SENDME, VERYANT
      *  BAH 140521 COMMENTED OUT ALARM, CAUSING SCREEN SHIFTS
      *   CS 140826 GOT AN ERROR READING THE SPR & GOT THE NORMAL MESSAGE
      *             EXCEPT THE KEY, I ADDED MOVE ERROR-MSG-KEY TO ERRMSG3-MSG3
      *  BLM 161216 REMOVE MESSAGE ON FILE STAT 93 IF LONPR0, WILL NOW
      *             DISPLAY MESSAGE IN THAT PROGRAM
      *  BLM 161220 REMOVE REFERENCE TO TEST-FORM-1ST4, JUST REFERENCE AS
      *             POSTITION (16:4) OF FORM-PATHNAME
      * BAH 190207 ADDED IO-MULTI-FG FOR USE WITH FILES THAT HAVE BEEN
      *            SPLIT SO WE CAN IDENTIFY WHICH FILE HAD BAD I/O
      *
      * JKC 2020-0217 ADDED LOGIC TO GET ACU4GL ERRORS IN ORDER TO
      *               DISPLAY THEM; MORE DETAILS FROM ACU4GL.
      * BAH 2020-0911 WAS DISPLAYING READ ERROR, STAT = 99 WITH THE PROGRAM
      *               NAME, CHANGED TO DISPLAY "RECORD LOCKED BY ANOTHER USER"
      *               AND THE KEY, LIKE A15 DID.
      *
      * JKC 2021-0512 ADDED SQL-IO-VALIDATION ROUTINE
      * JKC 2022-0222 IN SQL-IO-VALIDATION ROUTINE ADDED A CHECK TO SEE
      *               IF THE SQL CONNECTION (EXT-ACUSQL-CONNECT-STAT)
      *               IS OPEN (GOOD) THEN `PERFORM CLOSE-FILES`;
      *               NEED TO ONLY CLOSE FILES/TABLES WHEN THERE IS
      *               AN SQL CONNECTION OTHERWISE YOU CAN GET INTO
      *               AN INIFITE LOOP DUE TO THE SQL-DISCONNECT IN
      *               SQL-ERROR WHICH THEN YOU CANNOT CLOSE CURSORS
      *               IF THE CONNECTION HAS BEEN CLOSED.
      *
      * JKC 2023-0901 ADDED CALL TO CL/ACUMEM FOR OTIS MEMORY USAGE LOG
      * JKC 2023-0929 ADDED COUNT-IT PARAGRAPH FOR SQL ROW COUNT IO
      * JKC 2023-1201 ADDED CHECK OF "ROW " IN SQL-IO-VALIDATION
      * JKC 2024-0124 ADDED OTIS TRACE LOGGING LOGIC
      * JKC 2024-0304 REMOVED ACU4GL ERROR DISPLAY LOGIC
      *
      * JKC 2024-0501 ADDED USE OF EXT-API-SCREEN-DISABLE AND
      *         EXT-API-MESS FOR SUPPRESS SCREEN INTERACTIONS FOR
      *         USE IN API PROGRAMS WITHOUT SCREENS.
      *
      ***********************************************************************
       CHECK-ERROR-TYPE.
           IF E-MSG4 = "STAR"
              GO TO END-DECLARE.

           MOVE SPACES TO IO-MULTI-FG.
           MOVE 9      TO IO-FG.

           IF FILE-STAT = "93"
              IF LOCK-STATUS-93-RETRIES NOT = ZERO
                 MOVE 8 TO IO-FG
                 PERFORM SUSPEND
                 SUBTRACT 1 FROM LOCK-STATUS-93-RETRIES
                 GO TO END-DECLARE
              ELSE
                 IF FORM-PROGX = "LONPA0"
                    MOVE "  WARNING"    TO ERRMSG-HEAD
                    MOVE "      SOMEONE IN YOUR BRANCH IS "
                                        TO ERRMSG-MSG1
                    MOVE "      CURRENTLY UPDATING THIS DAY!"
                                        TO ERRMSG-MSG2
                    MOVE SPACES         TO ERRMSG-MSG3
                    PERFORM CALL-ERRMSG
                    PERFORM CLOSE-FILES
                    GO TO EXIT-PROG
              ELSE
                 IF FORM-PROGX = "LONPR0"
                    GO TO END-DECLARE
                 ELSE
                    MOVE FILE-STAT TO E-STATUS-ERROR
                    MOVE "FILE(S) EXCLUSIVELY RESERVED" TO MESS
                    MOVE E-FILE TO E-FILEX
                    MOVE FORM-PATHNAME TO E-PROG
                    MOVE ERROR-MSG-HEAD TO ERRMSG-HEAD
                    MOVE ERROR-MSG-STAT TO ERRMSG-MSG1
                    MOVE ERROR-MSG-PATH TO ERRMSG-MSG2
                    MOVE SPACES         TO ERRMSG-MSG3
                    PERFORM CALL-ERRMSG
                    PERFORM CLOSE-FILES
                    GO TO EXIT-PROG.
           IF FILE-STAT = "99"
              MOVE 8 TO IO-FG
              IF ERROR-LOCK-FG = "Y"
                 GO TO END-DECLARE
              END-IF
              PERFORM SUSPEND
              ADD 1 TO LOCK-STATUS-99-RETRIES
              IF LOCK-STATUS-99-RETRIES = 10
                 MOVE 0 TO LOCK-STATUS-99-RETRIES
                 MOVE FILE-STAT TO E-STATUS-ERROR
                 MOVE E-FILE TO E-FILEX
                 MOVE FORM-PATHNAME  TO E-PROG
                 MOVE ERROR-MSG-HEAD TO ERRMSG-HEAD
                 MOVE "RECORD LOCKED BY ANOTHER USER" TO ERRMSG-MSG1
                 MOVE ERROR-MSG-PATH TO ERRMSG-MSG2
                 MOVE ERROR-MSG-KEY  TO ERRMSG-MSG3
                 PERFORM CALL-ERRMSG.

           CALL "C$RERR" USING EXTENDED-FILE-STAT.
           MOVE FILE-STAT TO FILE-STAT-DISP.
           IF SECONDARY-FILE-STAT NOT = SPACES
              MOVE "," TO FILE-STATC
              MOVE SECONDARY-FILE-STAT TO FILE-STATD2.
           MOVE FILE-STAT-DISP TO E-STATUS-ERROR.
           IF FILE-STAT = "41"
              MOVE 7 TO IO-FG.
       CHECK-IO9.
           IF IO-FG NOT = 9
              GO TO END-DECLARE.
           IF E-MSG4 = "OPEN" OR E-MSG4 = "REWR" OR
              E-MSG4 = "DELE" OR FILE-STAT = "30"
              GO TO FILE-ERRORS.
           GO TO END-DECLARE.
       OPEN-IT.
           MOVE "OPEN ERROR" TO E-MSG.
           MOVE SPACES TO E-KEYX.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       COUNT-IT.
           MOVE "ROW COUNT ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       READ-IT.
           MOVE "READ ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       WRITE-IT.
           MOVE "WRITE ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       REWRITE-IT.
           MOVE "REWRITE ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       DELETE-IT.
           MOVE "DELETE ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       START-IT.
           MOVE "START ERROR" TO E-MSG.
           IF IO-FG NOT = 8 MOVE 0 TO LOCK-STATUS-99-RETRIES.
           MOVE 0 TO IO-FG IO-STATUS.
       CLOSE-IT.
           MOVE "CLOSE ERROR" TO E-MSG.
       FORM-IT.
           MOVE "FORM ERROR" TO E-MSG.
           MOVE STAT TO E-STATUS-ERROR.
           MOVE SPACES TO E-KEYX.
       SUSPEND.
      *    CALL SUSP.
           CALL "C$SLEEP" USING 1.
       ALARM.
      *    DISPLAY OMITTED WITH BEEP.
       FILE-ERRORS.
           MOVE E-FILE TO E-FILEX ERRLOGW-FILE.
           MOVE FORM-PATHNAME TO E-PROG ERRLOGW-PROGX.
           MOVE E-MSG TO ERRLOGW-TYPE.
           MOVE E-CODE TO ERRLOGW-CODE.
           MOVE E-SUBCODE TO ERRLOGW-SUBCODE.
           MOVE E-KEYX TO ERRLOGW-KEY.
           MOVE "E" TO ERRLOGW-ACTION.
           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "CL/ERRLOG" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ERRLOGW-AREA EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           MOVE FORM-PATHNAME TO FORM-PATH.
           IF PIGGY-BACK-FLAG = "PIGGY"
              MOVE "SNDERR" TO PIGGY-BACK-FLAG
              GO TO FILE-ERRORS-TERMINATE.
           PERFORM ALARM.
           IF E-MSG4 = "OPEN" OR "WRIT" OR "REWR"
              MOVE "**** STOP ****"       TO ERRMSG-HEAD
              STRING "                    CALL HOME "
                     "OFFICE OR SUPPORT             "
                     DELIMITED BY SIZE INTO ERRMSG-MSG1
              STRING "AN ERROR HAS OCCURRED         "
                     "                DO NOT PROCEED"
                     DELIMITED BY SIZE INTO ERRMSG-MSG2
              MOVE "PRESS ENTER TO CONTINUE" TO ERRMSG-MSG3
              PERFORM CALL-ERRMSG.
           MOVE SPACES TO MESS.
      * THIS MUST STAY LIKE THIS, E-MSG HAS "OPEN ERROR" OR WHATEVER
      * IN IT, IT MUST GET MOVED AS BELOW
           MOVE ERROR-MSG-HEAD TO ERRMSG-HEAD.
           MOVE ERROR-MSG-STAT TO ERRMSG-MSG1.
           MOVE ERROR-MSG-PATH TO ERRMSG-MSG2.
      *    MOVE SPACES         TO ERRMSG-MSG3.
           MOVE ERROR-MSG-KEY  TO ERRMSG-MSG3.
           PERFORM CALL-ERRMSG.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES TO MESS.
       FILE-ERRORS-TERMINATE.
      *    A30, STARRED OFF, 7/26/12, BLM:
      *    IF WINDOWS-OPEN > ZERO
      *       CALL DELWIN
      *       SUBTRACT 1 FROM WINDOWS-OPEN
      *       GO TO FILE-ERRORS-TERMINATE.
           MOVE "E" TO ERRCD.
           IF FILE-STAT = "98"
              IF (FORM-PATHNAME(16:4) = "LONP" OR "XONP")
                 MOVE "Z" TO ERRCD.
           PERFORM CLOSE-FILES.
           GO TO EXIT-PROG.
       SEND-MESS.
           IF ( EXT-API-SCREEN-DISABLE = "Y" )
              MOVE MESS TO EXT-API-MESS
           ELSE
              PERFORM ALARM
              DISPLAY MESSAGE BOX MESS.
       COPY "LIBGB/TMMSG.CPY".
       COPY "LIBGB/ERRMSG.CPY".

       SQL-IO-VALIDATION.

      * GOOD
           IF ( E-MSG4  = "OPEN" ) AND 
              ( SQLCODE = 1      )
              EXIT PARAGRAPH
           ELSE
      * GOOD
           IF ( SQLCODE = 0      ) 
              EXIT PARAGRAPH.

           MOVE 9 TO IO-FG.

      * EOF OR ROW NOT FOUND
           IF (( E-MSG4  = "READ" )  OR
               ( E-MSG4  = "ROW " )) AND
              (  SQLCODE = 100     )
              EXIT PARAGRAPH.

      * DUPLICATE ROW
           IF ( E-MSG4   = "WRIT"  ) AND   
      * LIKE VISION "22,00"
              ( SQLSTATE = "23000" )
              MOVE "22"    TO FILE-STAT
              MOVE "00"    TO SECONDARY-FILE-STAT
              MOVE "22,00" TO FILE-STAT-DISP
                              E-STATUS-ERROR
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE E-FILE        TO E-FILEX ERRLOGW-FILE.
           MOVE FORM-PATHNAME TO E-PROG ERRLOGW-PROGX.
           MOVE E-MSG         TO ERRLOGW-TYPE.
           MOVE E-CODE        TO ERRLOGW-CODE.
           MOVE E-SUBCODE     TO ERRLOGW-SUBCODE.
           MOVE E-KEYX        TO ERRLOGW-KEY.
           MOVE "E"           TO ERRLOGW-ACTION.
           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "CL/ERRSQL"   TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ERRLOGW-AREA
                                 SQLCA EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           MOVE FORM-PATHNAME TO FORM-PATH.

           MOVE "E" TO ERRCD.
           IF FILE-STAT = "98"
              IF (FORM-PATHNAME(16:4) = "LONP" OR "XONP")
                 MOVE "Z" TO ERRCD.

      * DEFINED IN LIBGB/CONNECT_SQL.CPY
           PERFORM SQL-ERROR. 

      * ONLY CLOSE FILES/TABLES WHEN THERE IS AN SQL CONNECTION
      * OTHERWISE YOU CAN GET INTO AN INIFITE LOOP DUE TO THE
      * SQL-DISCONNECT IN SQL-ERROR WHICH THEN YOU CANNOT CLOSE CURSORS
      * IF THE CONNECTION HAS BEEN CLOSED.
      * NOTE: THIS WORKS FOR TABLES; NOT SURE WHAT HAPPENS WITH VISION
      *       WORK FILES, IMPORT & EXPORT EXTRACTION FILES; BELIEVE
      *       THEY SHOULD WORK FINE IF GOING RIGHT BACK INTO THE
      *       PROGRAM (THEORY IS THE CLOSING OF A PROGRAM WILL CLOSE
      *       THE FILES).                           BAH & JKC 2022-0214

      * CLOSE VISION FILES
           IF ( EXT-ACUSQL-CONNECT-STAT-GOOD )
              PERFORM CLOSE-FILES. 

      * FORCE EXIT OF PROGRAM
           GO TO EXIT-PROG.

       CLOSE-FILES.

      * OTIS MEMORY USAGE LOG
           IF ( EXT-TCLP-ACUMEM-UPDATE )
              CALL "ACUMEM" USING FORM-PATHNAME 
              CANCEL "ACUMEM".

      * OTIS TRACE USAGE LOG
           IF ( EXT-TCLP-TRACE-UPDATE ) 
              MOVE "PROGRAM FINISH (LIBGB/DECLARE)"
                TO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

           MOVE "CLOSE ERROR" TO E-MSG.
      *================================================================*
      * END COPYBOOK: LIBGB\DECLARE.CPY                                *
      *================================================================*
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-LTP1-FILE.
           PERFORM CLOSE-LTI1-FILE.
           PERFORM CLOSE-LP1-FILE.
           PERFORM CLOSE-LN1-FILE.
           PERFORM CLOSE-LXE1-FILE.
           PERFORM CLOSE-LXG1-FILE.
           PERFORM CLOSE-LP1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-GI1-FILE.
           PERFORM CLOSE-RC2-FILE.
           PERFORM CLOSE-BR-FILE.
           PERFORM CLOSE-GB-FILE.
           CLOSE WK-FILE OP-FILE LOG-FILE.
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DECLAR2.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/DECLAR2
      ******************************************************************
      * REV:
      * JKC 210702 ADDED SQL-DISCONNECT BEFORE 'STOP RUN'; WE FOUND THAT
      *            THE USE OF SQL-DISCONNECT WHEN EXITING THE
      *            APPLICATION IS ONLY NEEDED; DOING A SQL-DISCONNECT
      *            WHEN EXITING A PROGRAM WILL CAUSE ALL CURSORS TO BE
      *            CLOSED FROM THE CALLING PROGRAM WHICH EFFECTS IT 
      *            WHEN CONTINUING WITH A READ-NEXT.
      *
      * JKC 230907 COMMENTED OUT DECLARE-STOP PARAGRAPH; SEARCH FOUND
      *            NO 'PERFORM' OR 'GO TO' FOR IT, AND THERE WAS
      *            FALL-THRU LOGIC THAT IT COULD FLOW INTO IT.
      *
      ******************************************************************
      *DECLARE-STOP.
      * NEED TO BE LAST BEFORE 'STOP RUN'
      *    PERFORM SQL-DISCONNECT.
      *    STOP RUN.
       END-DECLARE.
           EXIT.
       END DECLARATIVES.
      *================================================================*
      * END COPYBOOK: LIBGB\DECLAR2.CPY                                *
      *================================================================*

      ******************************************************************
      *
      *  PROGRAM CONTROL
      *
      ******************************************************************
       MAIN-PROGRAM SECTION.

      D    STOP MESS.

      * NEED TO GET EXTERNAL VARIABLES SET
           MOVE "CO" TO FORM-OBJ.
           MOVE "GB/SETENV" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATHNAME EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           PERFORM SQL-CONNECT.

           MOVE FORM-PATHNAME TO FORM-PATH.

           MOVE 99 TO RETURN-STATUS.

           PERFORM GET-GPENV.

           MOVE EXT-FILPATH TO HOLD-EXT-FILPATH.
           ACCEPT ORIG-POSTNAME FROM ENVIRONMENT "POSTNAME".

      * THIS COULD CHANGE TO USE THE BP-REC WITH MORE FIELDS. I USED SIMPLEST TO
      * START OFF WITH. LOOK AT WHAT IS IN BATPAY.SH IN SH DIRECTORY

           MOVE INPUT-STRING TO BT-REC.

           MOVE BT-ACCTNO    TO BP-LNNO.
           MOVE 0            TO BP-SSNO.
           MOVE BT-AMT       TO BP-TRAMT.
           MOVE BT-REFCD     TO BP-REFCD.
           MOVE BT-PAYDATE   TO DATE-MMDDYY
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO BP-PAYDATE.
           MOVE BT-TRCD      TO BP-TRCD.

           PERFORM INITIALIZATION.
           IF ERRCD NOT = " "
              GO TO END-PROGRAM.

           MOVE BT-BRANCH TO BR-NO.
           PERFORM READ-BR-FILE.
           IF IO-FG = 9
              MOVE 2                TO RETURN-STATUS
              MOVE "BRANCH &&&& NOT ON FILE, ABORTED" TO LOG-MSG
              INSPECT LOG-MSG REPLACING FIRST "&&&&" BY BT-BRANCH
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           PERFORM OPEN-CD1-FILE.
           MOVE "BR"      TO CD-TYPE.
           MOVE BP-REFCD  TO CD-CODE.
           PERFORM READ-CD1-FILE.
           IF (IO-BAD) OR (CD-BR-FILE-TYPE = "LC" OR "C")
              MOVE 3                TO RETURN-STATUS
              MOVE "REF CODE &&&&& NOT ON FILE, ABORTED" TO LOG-MSG
              INSPECT LOG-MSG REPLACING FIRST "&&&&&" BY BP-REFCD
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           IF CD-BR-PAYOFF-FG = "Y"
              MOVE "N" TO HOLD-BP-ALLOW-PMT-ACCT-OTHBAL
                          HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL
              MOVE "Y" TO HOLD-BP-PAYOFF-NONCASH
                          HOLD-LBOX-PAYOFF-NONCASH
           ELSE
              MOVE BR-BP-ALLOW-PMT-ACCT-OTHBAL TO
                                    HOLD-BP-ALLOW-PMT-ACCT-OTHBAL
              MOVE BR-LBOX-ALLOW-PMT-ACCT-OTHBAL TO
                                    HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL
              MOVE BR-BP-PAYOFF-NONCASH TO
                                    HOLD-BP-PAYOFF-NONCASH
              MOVE BR-LBOX-PAYOFF-NONCASH TO
                                    HOLD-LBOX-PAYOFF-NONCASH.

           MOVE CD-BR-LC-FG TO BATCH-REFCD-LC-FG.

      * ONLY PROCESS FILES FOR THE MACHINE YOU ARE ON

           IF BR-MACHINE NOT = EXT-FILPATH-MACHINE
              MOVE 4                TO RETURN-STATUS
              MOVE "BRANCH NOT ON THIS MACHINE, ABORTED" TO LOG-MSG
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           MOVE EXT-FILPATH-BASE           TO FILPATH-BASE.
           MOVE BR-MACHINE                 TO FILPATH-MACHINE.
           MOVE BR-DATA-PATH               TO FILPATH-DATA.

           MOVE "B"                        TO BW-PATH-OVERRIDE
                                              LN-PATH-OVERRIDE
                                              BP-PATH-OVERRIDE
                                              GB-PATH-OVERRIDE
                                              LP-PATH-OVERRIDE
                                              LXE-PATH-OVERRIDE
                                              LXG-PATH-OVERRIDE.


      * NEED FOR LCAS ROUTINES (REPLACES GLOBRD)
           PERFORM OPEN-GB-FILE.
           MOVE GB-PATH-OWNBR TO GB-BRNO.
           MOVE 1             TO GB-NO.
           PERFORM READ-GB-FILE.
           PERFORM CLOSE-GB-FILE.
           IF IO-BAD
              MOVE 5                       TO RETURN-STATUS
              MOVE "GLOBAL REC MISSING FOR &&&&, ABORTED" TO LOG-MSG
              INSPECT LOG-MSG REPLACING FIRST "&&&&" BY BT-BRANCH
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           PERFORM OPEN-LN1-FILE.
           PERFORM OPEN-BW1-FILE.

      * CHANGE THE EXTERNAL FILPATH TO THAT OF THE CURRENT BRANCH.

           MOVE BR-MACHINE            TO EXT-FILPATH-MACHINE.
           MOVE BR-DATA-PATH          TO EXT-FILPATH-DATA.
           SET ENVIRONMENT "FIL"      TO EXT-FILPATH-FIL.
           MOVE ORIG-POSTNAME         TO WORK-USERID.
           MOVE BR-NO                 TO WORK-BR.
           SET ENVIRONMENT "POSTNAME" TO WORK-USERID.
           MOVE BR-NO                 TO BRANCH.

      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * WARNING * WARNING * WARNING * WARNING * WARNING * WARNING * WARNING *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                     *
      * FROM THIS POINT FORWARD THE USER HAS BE PLACED, LOGICALLY, INTO     *
      * THE BRANCH FOR WHICH HE/SHE IS POSTING FOR.                         *
      *                                                                     *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * WARNING * WARNING * WARNING * WARNING * WARNING * WARNING * WARNING *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

      * TEST RC-STATUS FOR OPEN DAY

           MOVE "A1"       TO RC-STATUS.
           MOVE BR-NO      TO RC-BRNO.
           MOVE TRANS-DATE TO RC-TRANS-DATE.

           PERFORM OPEN-RC2-FILE.
           PERFORM READ-RC2-FILE.
           PERFORM CLOSE-RC2-FILE.
           IF IO-FG NOT = 0
              MOVE 6                       TO RETURN-STATUS
              MOVE "DAY NOT OPEN, ABORTED" TO LOG-MSG
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

      * DAY IS OPEN, RESERVE OP FILE SO THE DAY CANNOT BE CLOSED.

           MOVE TRANS-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE BR-NO       TO OPEN-PATH-BRNO.
           MOVE DATE-MMDDYY TO OPEN-PATH-TRDATE.
           PERFORM LOAD-OPEN-FILE.
           MOVE OPEN-PATH TO ACCESS-BUF.
           PERFORM ACCESS-CALL.
           IF STAT NOT = "00"
              MOVE "COULD NOT OPEN DAY" TO LOG-MSG
              MOVE 7                       TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           PERFORM OPEN-OP-FILE.

           IF (BP-PAYDATE = 20202020 OR BP-PAYDATE = 02020202
                 OR BP-PAYDATE = 0)
              MOVE TRANS-DATE TO BP-PAYDATE.

           MOVE " "      TO OVPAID-FLAG.
           MOVE 0        TO OVPAID-AMT HOLD-OVPAID-CHECK.
           MOVE BP-TRAMT TO ORIG-BP-TRAMT.
           MOVE " "      TO POSTING-ERRCD.

           IF (BR-AUTO-PL-REF-AC = "Y" OR "2" OR "3")
              IF (BP-TRCD = "PL" OR "P2" OR "P3")
                 MOVE "AUTO ACCELERATE FG:REJECT" TO LOG-MSG
                 MOVE 8                           TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * DONT ALLOW THE BACKDATE TO A PRIOR MONTH FOR PL TYPE TRANSACTION
           IF BP-TRCD =  "PL" OR "P2" OR "P3"
              MOVE BP-PAYDATE TO NUM-DATE
              MOVE TRANS-DATE TO SYS-DATE
              IF NOT (NUM-MO = S-MM AND NUM-CCYY = S-CCYY)
                 MOVE 9                              TO RETURN-STATUS
                 MOVE "BACK DATE IN PRIOR MO, ABORTED" TO LOG-MSG
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           MOVE BR-NO   TO LN-OWNBR.
           MOVE BP-LNNO TO LN-ACCTNO.
           PERFORM READ-LN1-FILE.
           IF IO-FG NOT = 0
              MOVE 10                             TO RETURN-STATUS
              MOVE "ACCOUNT NOT ON FILE, ABORTED" TO LOG-MSG
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           IF LN-ESCROW-FG = "Y"
              MOVE "ACCOUNT HAS ESCROW"  TO LOG-MSG
              MOVE 11                    TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           IF BP-TRCD = "RV"
              PERFORM VALIDATE-REVERSAL
              IF VALID-REVERSAL-FG NOT = "Y"
                 GO TO END-ROUTINE.

           IF LN-BNKRPTDATE NOT = 0
              IF BP-TRCD = "BK"
                 MOVE "BK: ACCT ALREADY BANKRUPT" TO LOG-MSG
                 MOVE 12                          TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           IF LN-BNKRPTDATE = 0
              IF BP-TRCD = "BD"
                 MOVE "BD: ACCT NOT BANKRPT STAT" TO LOG-MSG
                 MOVE 13                          TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           IF BP-TRCD =  "PL" OR "P2" OR "P3"
              IF LN-PLCD = "P"
                 MOVE "ACCT ALREADY ACTIVE P&L" TO LOG-MSG
                 MOVE 14                        TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           IF BP-TRCD = "RE"
               IF GP-REPO-CODE NOT = "A"
                  MOVE "MUST HAVE REPO OPTIONS TURNED ON" TO
                                                          LOG-MSG
                  MOVE 15                            TO RETURN-STATUS
                  PERFORM CREATE-LOG
                  GO TO END-ROUTINE.

           IF BP-TRCD = "RE"
               IF NOT (LN-REPOCD = "X" OR "S")
                  MOVE "RE: ACCT NOT REPO STATUS!" TO LOG-MSG
                  MOVE 16                          TO RETURN-STATUS
                  PERFORM CREATE-LOG
                  GO TO END-ROUTINE.

           IF BP-TRCD = "RE"
              MOVE BP-PAYDATE TO IBPC-DATE
              PERFORM IBPC-TEST
              IF NOT (IBPC-FG = "I" OR LN-LOANTYPE = "I")
                 MOVE "RE: ACCT NOT INTEREST BEARING!" TO LOG-MSG
                 MOVE 17                             TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * "R" REJECT

           IF HOLD-CD-BR-POST-SS-TRCD = "R"
               IF LN-REPOCD = "X"
                  MOVE "REPO BATCH RECORD"   TO LOG-MSG
                  MOVE 18                    TO RETURN-STATUS
                  PERFORM CREATE-LOG
                  GO TO END-ROUTINE.

           IF HOLD-CD-BR-POST-SS-TRCD = "Y"
               IF LN-REPOCD NOT = "X"
                  MOVE "NON REPO BATCH RECORD!"  TO LOG-MSG
                  MOVE 19                        TO RETURN-STATUS
                  PERFORM CREATE-LOG
                  GO TO END-ROUTINE.

      * SAVE ORIG VALUES

           MOVE LN-LBOX    TO ORIG-LN-LBOX.
           MOVE LN-ALLOTCD TO ORIG-LN-ALLOTCD.
           MOVE LN-OT2BAL  TO ORIG-LN-OT2BAL.

      * SETUP LBOX/ALLOTCD HERE FOR CORRECT LATE CHARGE CALCULATIONS

           MOVE "N"        TO LN-LBOX.
           MOVE "Y"        TO LN-ALLOTCD.

      * CLEAR HOLD-BP-TRCD HERE:
      *  - IF AN EXCEPTION CAUSING A NON CASH TRASACTION REQUIREMENT
      *       IS FOUND AND BR-????-PAYOFF-NONCASH = "Y", THAN "99"
      *       WILL BE PUT INTO HOLD-BP-TRCD TO INDICATE A CALL TO
      *       LONPFA.C SHOULD BE DONE AND NOT A CALL TO LONPFC.C

           MOVE " " TO HOLD-BP-TRCD.

           MOVE BP-REFCD TO LP-REFNO.

      * ADDED ABILITY TO SEND NEGATIVES, IF 1ST BYTE OF AMT  IS "-",
      * BUT BP-ALLOW-NEGATIVE FLAG MUST ALSO BE Y, NEEDED FOR RE'S
      * (REGACC PR#382). ERROR IF NEG BUT FLAG NOT SET:

           IF BP-TRAMT < 0
              IF BP-ALLOW-NEGATIVE NOT = "Y"
                 MOVE "NEGATIVE BUT FLAG NOT SET" TO LOG-MSG
                 MOVE 20                          TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST FOR PAYMENT AMOUNT = 0.00

           IF NOT (CD-BR-FILE-TYPE = "B" OR "P")
              IF BP-ALLOW-NEGATIVE NOT = "Y"
                 IF BP-TRAMT NOT > 0
                    IF (BP-TRCD = "DF" OR "D2" OR "D3" OR "D4"
                               OR "D5" OR "D6" OR "D7" OR "D8" OR "D9")
                        IF BP-ALLOW-ZERO-DF NOT = "Y"
                           MOVE "PAYMENT MUST BE > 0" TO LOG-MSG
                           MOVE 21                    TO RETURN-STATUS
                           PERFORM CREATE-LOG
                           GO TO END-ROUTINE
                        END-IF
                    ELSE
                        MOVE "PAYMENT MUST BE > 0" TO LOG-MSG
                        MOVE 21                    TO RETURN-STATUS
                        PERFORM CREATE-LOG
                        GO TO END-ROUTINE.

           IF HOLD-CD-BR-POST-SS-TRCD = "Y"
              IF BP-AUCTION-FEES = ZEROS
                 MOVE "MISSING AUCTION FEES" TO LOG-MSG
                 MOVE 22                     TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF ODD PAYMENTS ARE NOT ALLOWED:
      * CHECK BR-BP-ODDPAY (NOT LBOX) IF ALLOTMENT

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-ODDPAY NOT = "Y"  )
              )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-ODDPAY NOT = "Y")
              )
              IF LN-1STPYAMT NOT = 0
                 IF LN-TOTPAYMNTD = 0
                    IF BP-TRAMT NOT = LN-1STPYAMT
                       MOVE "IRREGULAR PAYMENT AMOUNT" TO LOG-MSG
                       MOVE 23                       TO RETURN-STATUS
                       PERFORM CREATE-LOG
                       GO TO END-ROUTINE
                    ELSE
                       NEXT SENTENCE
                 ELSE
                    IF BP-TRAMT NOT = LN-REGPYAMT
                       MOVE "IRREGULAR PAYMENT AMOUNT" TO LOG-MSG
                       MOVE 23                         TO RETURN-STATUS
                       PERFORM CREATE-LOG
                       GO TO END-ROUTINE
                    ELSE
                       NEXT SENTENCE
              ELSE
                 IF BP-TRAMT NOT = LN-REGPYAMT
                    MOVE "IRREGULAR PAYMENT AMOUNT" TO LOG-MSG
                    MOVE 23                         TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.
    
      * WHEN BR-BP/LBOX-ALLOW-PMT-ACCT-OTHBAL = "Y", ALLOW THE BATCH
      * PAYMENT TO BE APPLIED TO THE ACCOUNT BUT NOT TO OTHER BALANCE

      * WHEN CD-BR-OT-GL-ACCT NOT = 0, ALLOW POSTING TO ACCOUNTS WITH
      * LN-OTHBAL, OTHERWISE, TEST IF OTHER CHARGES EXIST 

           IF ( CD-BR-OT-GL-ACCOUNTS = " " ) OR
              ( CD-BR-OT-GL-ACCT = 0       )
              IF LN-OTHBAL NOT = 0
                 IF ( ( CD-BR-ALLOT-OPTION = "Y"              ) AND
                      ( HOLD-BP-ALLOW-PMT-ACCT-OTHBAL NOT = "Y" )
                    )
                    OR
                    (
                      ( CD-BR-LBOX-OPTION = "Y"                 ) AND
                      ( HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL NOT = "Y" )
                    )
                    MOVE "LOAN HAS OTHER CHARGES" TO LOG-MSG
                    MOVE 24                       TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.


           IF LN-OT2BAL NOT = 0
              IF ( ( CD-BR-ALLOT-OPTION = "Y"              ) AND
                   ( HOLD-BP-ALLOW-PMT-ACCT-OTHBAL = "2" )
                 )
                 OR
                 (
                   ( CD-BR-LBOX-OPTION = "Y"                 ) AND
                   ( HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL = "2" )
                 )
                 MOVE "LOAN HAS OTHER 2 CHARGES" TO LOG-MSG
                 MOVE 25                         TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF ACCOUNT BELONGS TO POSTING BRANCH:

           IF LN-OWNBR NOT = BR-NO
              MOVE "ACCOUNT OWNED BY OTHER BR" TO LOG-MSG
              MOVE 26                         TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           IF BP-FROZEN-OVERRIDE NOT = "Y"
              IF LN-ACCT-FROZEN = "Y"
                 MOVE "ACCOUNT IS FROZEN" TO LOG-MSG
                 MOVE 27                  TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF PAYMENT WILL ONLY COVER LC AND INTEREST:
      * CHECK BR-BP-NOPRIN (NOT LBOX) IF ALLOTMENT

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-NOPRIN NOT = "Y"  ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-NOPRIN NOT = "Y") )
                 COMPUTE TEST-AMT = LN-INTBAL + LN-LCBAL
                 IF BP-TRAMT NOT > TEST-AMT
                    MOVE "APPLIES WITH NO PRINCIPAL" TO 
                                                  LOG-MSG
                    MOVE 28                    TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * TEST IF PL ACCOUNTS ARE ALLOWED:

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                ( NOT (BR-BP-PL = "Y" OR "P") ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                ( NOT (BR-LBOX-PL = "Y" OR "P") ) )
                 IF LN-PLDATE NOT = 0
                    MOVE "P&L ACCOUNT " TO LOG-MSG
                    MOVE 29             TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

           IF LN-PLCD = "I"
              MOVE "INACTIVE P&L ACCOUNT " TO LOG-MSG
              MOVE 30                      TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

      * TEST IF JD ACCOUNTS ARE ALLOWED:
      * CHECK BR-BP-JD (NOT LBOX) IF ALLOTMENT

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-JD NOT = "Y"      ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-JD NOT = "Y"    ) )
              IF LN-JDDATE NOT = 0
                 MOVE "JUDGEMENT ACCOUNT " TO LOG-MSG
                 MOVE 31                   TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF ACCOUNTS WITH MESSAGE ARE ALLOWED:
      * CHECK BR-BP-FLASH (NOT LBOX) IF ALLOTMENT

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-FLASH NOT = "Y"   ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-FLASH NOT = "Y" ) )
              IF LN-MESSAGE NOT = " "
                 MOVE "FLASHING MESSAGE  " TO LOG-MSG
                 MOVE 32                   TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF ACCOUNTS WITH ACTION CODE ARE ALLOWED:

           IF ( (CD-BR-ALLOT-OPTION = "Y"  ) AND
                (BR-BP-ACTIONCD NOT = "Y"  ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y"   ) AND
                (BR-LBOX-ACTIONCD NOT = "Y") )
              IF LN-ACTIONCD NOT = " "
                 MOVE "ACTION CODE ON ACCOUNT" TO LOG-MSG
                 MOVE 33                       TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           PERFORM GET-SPR.
           IF IO-FG NOT = 0
              MOVE "INVALID SPR RECORD" TO LOG-MSG
              MOVE 34                   TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

      * REJECT IF THE INTEREST PAID THRU ON AN IB LOAN IS GREATER
      * THAN THE POSTING DATE

           MOVE BP-PAYDATE TO IBPC-DATE.
           PERFORM IBPC-TEST.
           IF (IBPC-FG = "I" OR LN-LOANTYPE = "I")
               IF LN-INTPDTH-DATE > BP-PAYDATE
                  MOVE "INTEREST PAID THRU DATE" TO LOG-MSG
                  MOVE 35                        TO RETURN-STATUS
                  PERFORM CREATE-LOG
                  GO TO END-ROUTINE.

           IF BP-TRCD = "DF" OR "D2" OR "D3" OR "D4" OR "D5"
                             OR "D6" OR "D7" OR "D8" OR "D9"
              MOVE "Y" TO DF-TEST
           ELSE
              MOVE " " TO DF-TEST.

           IF DF-POSTING
              IF BP-TRAMT < SP-DEFMIN OR
                      BP-TRAMT > SP-DEFMAX
                 MOVE "SPR DEFERMENT MIN/MAX" TO LOG-MSG
                 MOVE 36                      TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * ONLY ALLOWING REGIONAL'S SP-DEFFRMLA 0,2,3,96,97,99

           IF DF-POSTING
              IF NOT (SP-DEFFRMLA = 0 OR 2 OR 3 OR 96 OR 97 OR 99)
                 MOVE "DF FRMLA INVALID FOR BATCH" TO LOG-MSG
                 MOVE 37                         TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * NO MULTIPLES WITH 96 OR D7
           IF DF-POSTING
              IF SP-DEFFRMLA = 96 OR 97
                 IF BP-TRCD NOT = "DF"
                    MOVE "MULTIPLE DF'S NOT ALLOWED" TO LOG-MSG
                    MOVE 38                        TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

           IF DF-POSTING
             IF BP-IGNORE-DEFPOL NOT = "Y"
                MOVE BP-TRCD    TO DEFPOL-TRCD
                MOVE TRANS-DATE TO DEFPOL-DATE
                PERFORM VALIDATE-DF-POLICY
                IF DEFPOL-MAXIMUM = "X"
                   MOVE "DEFERMENTS WILL EXCEED ORIGINAL TERM" TO
                                                      LOG-MSG
                   MOVE 39                        TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE
                ELSE
                IF DEFPOL-MAXIMUM = "R"
                   MOVE "MINIMUM MONTHS HAVE NOT ELAPSED" TO 
                                                  LOG-MSG
                   MOVE 40                    TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE
                ELSE
                IF DEFPOL-MAXIMUM = "Y"
                   MOVE "DF NOT ALLOWED" TO LOG-MSG
                   MOVE 41               TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE.

      * TEST IF MAXIMUM CONTRACTUAL IS EXCEEDED:

           MOVE BP-PAYDATE TO AGEING-DATE.
           PERFORM COMPUTE-CONTRACTUAL.
           PERFORM COMPUTE-RECENCY.

            IF BP-TRCD = "PL" OR "P2" OR "P3"
               IF CONTRACTUAL < 30
                   MOVE "CONTRACTUAL < 30" TO LOG-MSG
                   MOVE 42                 TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE.

            IF BP-TRCD = "PL" OR "P2" OR "P3"
               IF RECENCY < 30
                   MOVE "RECENCY < 30" TO LOG-MSG
                   MOVE 43             TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE.

           IF CD-BR-ALLOT-OPTION = "Y"
              IF BR-BP-MAXCON NOT = 999
                IF CONTRACTUAL > BR-BP-MAXCON
                   MOVE "EXCEEDS MAX CONTRACTUAL" TO LOG-MSG
                   MOVE 44                        TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE.

           IF CD-BR-LBOX-OPTION = "Y"
              IF BR-LBOX-MAXCON NOT = 999
                 IF CONTRACTUAL > BR-LBOX-MAXCON
                    MOVE "EXCEEDS MAX CONTRACTUAL" TO LOG-MSG
                    MOVE 44                        TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * TEST IF MAXIMUM RECENCY IS EXCEEDED:

           IF CD-BR-ALLOT-OPTION = "Y"
              IF BR-BP-MAXREC NOT = 999
                IF RECDEL > BR-BP-MAXREC
                   MOVE "EXCEEDS MAX RECENCY" TO LOG-MSG
                   MOVE 45                    TO RETURN-STATUS
                   PERFORM CREATE-LOG
                   GO TO END-ROUTINE.

              IF CD-BR-LBOX-OPTION = "Y"
                 IF BR-LBOX-MAXREC NOT = 999
                    IF RECDEL > BR-LBOX-MAXREC
                       MOVE "EXCEEDS MAX RECENCY" TO LOG-MSG
                       MOVE 45                   TO RETURN-STATUS
                       PERFORM CREATE-LOG
                       GO TO END-ROUTINE.

      * DON'T ALLOW POSTING WHEN LOAN HAS ZERO BALANCE
      * THIS CHECK WAS DOWN AFTER ALL THE PAYOFF STUFF,
      * NOT SURE WHY, I LEFT IT THERE BUT WORLD WANTS TO SEE ZERO
      * BALANCE MESSAGE INSTEAD OF PMT EXCEED PAYOFF MESSAGE, SO
      * YOU CAN LOOK AT EXCEPTION REPORT & SEE PAID OUTS VS.
      * LOANS WITH BALANCE TOO LOW FOR BATCH PMT.  BARB

           IF LN-CURBAL = 0
              IF CD-BR-ALLOT-OPTION = "Y"
                 IF HOLD-BP-PAYOFF-NONCASH NOT = "Y"
                    MOVE "ALREADY ZERO BALANCE" TO LOG-MSG
                     MOVE 46                    TO RETURN-STATUS
                     PERFORM CREATE-LOG
                     GO TO END-ROUTINE.

           IF LN-CURBAL = 0
              IF CD-BR-LBOX-OPTION = "Y"
                 IF HOLD-LBOX-PAYOFF-NONCASH NOT = "Y"
                    MOVE "ALREADY ZERO BALANCE" TO LOG-MSG
                    MOVE 46                     TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

           IF CD-BR-FILE-TYPE = "B" OR "P"
              GO TO SKIP-PAYOFF-CALC.

           IF VALID-REVERSAL-FG = "Y" OR BP-TRCD = "OT"
              GO TO SKIP-PAYOFF-CALC.

      * SET REB-LPTRCD FOR LPPOFF WHICH CALLS REBATE
      * NEED TO KNOW 'PB', 'RN', AND 'SC'
      * FOR SUN FINANCE SPOPT1 = 2:

           MOVE "PO"              TO REB-LPTRCD
                                     POFF-LPTRCD.
           MOVE BP-PAYDATE        TO POFF-PAYDATE.
           MOVE LN-MAKERCD(1)     TO POFF-MAKERCD.
           MOVE BATCH-REFCD       TO POFF-LCAP-BATCH-REFCD.
           MOVE BATCH-REFCD-LC-FG TO POFF-LCAP-BATCH-REFCD-LC-FG.
           PERFORM PAYOFF-LOAN-ROUTINE.

      * COMPILE TOTAL PAYOFF REBATES FOR FURTHER TESTING:

           MOVE 0 TO TOT-POFF-REBATES.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 13
              ADD POFF-REBATE(SUB) TO TOT-POFF-REBATES
           END-PERFORM.

      * DETERMINE NET PAYOFF PRINCIPAL:
           COMPUTE NET-POFF-PRIN =
              LN-CURBAL - LN-OT2BAL + LN-OTHBAL - TOT-POFF-REBATES.

      * DETERMINE AMOUNT THAT WILL PAYOFF ACCOUNT:

           COMPUTE WILL-POFF-ACCOUNT =
              NET-POFF-PRIN + POFF-INTDUE + POFF-LCDUE.

      * DETERMINE TRAMT THAT CAN BE POSTED LEAVING $0.01 IN PRINCIPAL:

           COMPUTE VALID-POSTING-NOPOFF = WILL-POFF-ACCOUNT - 0.01.

      * TEST IF PAYMENT WILL BRING BALANCE BELOW A NET PAYOFF:

           IF BP-TRAMT > POFF-NETDUE
              IF LN-PLDATE NOT = 0
                 IF ( CD-BR-ALLOT-OPTION = "Y" AND
                      BR-BP-PL = "P" )
                    OR
                    ( CD-BR-LBOX-OPTION = "Y" AND
                      BR-LBOX-PL = "P" )
                    MOVE "PAY EXCEEDS PAYOFF AMT" TO LOG-MSG
                    MOVE 47                      TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * TEST IF PAYMENT WILL BRING BALANCE BELOW THE CURRENT LOAN
      * BALANCE

           IF BP-TRAMT > (LN-CURBAL - LN-OT2BAL) - .01
              IF LN-PLDATE NOT = 0
                 IF ( CD-BR-ALLOT-OPTION = "Y" AND
                      BR-BP-PL = "P" )
                    OR
                    ( CD-BR-LBOX-OPTION = "Y" AND
                      BR-LBOX-PL = "P" )
                    MOVE "PAY EXCEEDS PRINCIPAL " TO LOG-MSG
                    MOVE 48                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

           IF BP-TRAMT > POFF-NETDUE
              IF ( (CD-BR-ALLOT-OPTION = "Y"    ) AND
                   (HOLD-BP-PAYOFF-NONCASH = "Y"  ) )
                 OR
                 ( (CD-BR-LBOX-OPTION = "Y"     ) AND
                   (HOLD-LBOX-PAYOFF-NONCASH = "Y") )
                 MOVE "99" TO HOLD-BP-TRCD
              ELSE
                 MOVE "PAY EXCEEDS PAYOFF AMT" TO LOG-MSG
                 MOVE 47                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           IF GP-DONT-COLL-INT-ON-SS = "Y"
              IF BP-TRCD = "SS"
                 IF BP-TRAMT > (LN-CURBAL -  .01)                  
                    MOVE "AMT > BALANCE - .01"   TO LOG-MSG
                    MOVE 49                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * TEST IF PAYMENT WILL PAYOFF LOAN PREMATURLY:
      *
      * N O T E:   THIS TEST IS NOT CORRECT, IT DOESN'T CONSIDER
      *            LN-LASTPYAMT OR PAYMENT SCHEDULES
      * 7/14/08 OK, I UNDERSTAND BP-PAYOFF-NONCASH DOESN'T ALLOW
      *         BATCH PAYOFF IF OTHER CHARGES ON ACCT, OR PAYMENT
      *         EXCEEDS PAYOFF, OR PAYOFF PRIOR TO MATURITY.
      *         DON'T GET WHY THIS FLAG IS CALL GP-PAYOFF-NONCASH.
      *         ANYWAY, WORLD ACCTS WILL BE PAID OFF EARLY WITH
      *         INSURANCE CLAIMS, SO ALLOW EARLY PAYOFF IF BATCH
      *         PMT = PAYOFF.  WORLD PR# 573.  BARB

           MOVE "N" TO PAYOFF-TRANS-FG.
           IF BP-TRAMT = POFF-NETDUE
              MOVE "Y" TO PAYOFF-TRANS-FG
              MOVE "99" TO HOLD-BP-TRCD
              GO TO SKIP-EARLY-PAYOFF-TEST.

           IF BP-TRAMT = POFF-NETDUE
              MOVE "Y" TO PAYOFF-TRANS-FG
              IF BP-TRAMT NOT = LN-REGPYAMT
                 IF ( (CD-BR-ALLOT-OPTION = "Y"    ) AND
                      (HOLD-BP-PAYOFF-NONCASH = "Y"  )
                    )
                    OR
                    ( (CD-BR-LBOX-OPTION = "Y"     ) AND
                      (HOLD-LBOX-PAYOFF-NONCASH = "Y")
                    )
                    MOVE "99" TO HOLD-BP-TRCD
                 ELSE
                    MOVE "ACCT WILL PAYOFF EARLY" TO LOG-MSG
                    MOVE 50                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * WHEN BR-BP/LBOX-ALLOW-PMT-ACCT-OTHBAL = "Y"
      *      THAN ALLOW THE BATCH PAYMENT TO BE APPLIED
      *      TO THE ACCOUNT BUT NOT TO OTHER BALANCE
      *
      * 4/12/07  WE THINK THE CHECK BELOW MAKES SENSE IF THERE IS
      *          AN OTHER BAL ON THE ACCOUNT.  IF THERE IS NO OTHER
      *          BAL, THIS STOPS A PAYOFF FROM POSTING AND GIVE
      *          STUPID CUTOFF MESSAGE.   SO WE WILL ONLY DO THIS
      *          CHECK IF THERE IS AN OTHER BAL.  BARB & CINDY
      *

       SKIP-EARLY-PAYOFF-TEST.
           IF LN-OTHBAL = 0
              GO TO TEST-PAYOFF-ALLOWED.

           IF ( ( CD-BR-ALLOT-OPTION = "Y"          ) AND
                ( HOLD-BP-ALLOW-PMT-ACCT-OTHBAL = "Y" ) )
              OR
              ( ( CD-BR-LBOX-OPTION = "Y"             ) AND
                ( HOLD-LBOX-ALLOW-PMT-ACCT-OTHBAL = "Y" ) )
              IF BP-TRAMT > (VALID-POSTING-NOPOFF - LN-OTHBAL)
                 MOVE "AMT > POFF - .01 WITH OTH" TO LOG-MSG
                 MOVE 51                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF PAYOFF IS ALLOWED:

       TEST-PAYOFF-ALLOWED.
           IF ( (CD-BR-ALLOT-OPTION = "Y"  ) AND
                (BR-BP-NOPAYOFF NOT = "Y"  ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y"   ) AND
                (BR-LBOX-NOPAYOFF NOT = "Y") )
              IF BP-TRAMT = POFF-NETDUE
                 MOVE "ACCOUNT WILL PAYOFF" TO LOG-MSG
                 MOVE 52                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-LC NOT = "Y"      ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-LC NOT = "Y"    ) )
              MOVE BP-PAYDATE TO IBPC-DATE
              PERFORM IBPC-TEST
              IF (IBPC-FG = "P" OR LN-LOANTYPE = "I")
                                        AND (LN-JDDATE = 0)
                                         AND (LN-ACCELDATE = 0)
                 MOVE BP-TRAMT     TO LCAP-TRAMT
                 MOVE BP-PAYDATE   TO LCAP-PAYDATE
                 MOVE LN-1STPYDATE TO LCAP-1STPYDATE
                 MOVE "PY"         TO LCAP-LPTRCD
                 MOVE 0            TO LCAP-LPAPLC LCAP-LPAPINT
                 MOVE CD-CODE      TO LCAP-BATCH-REFCD
                 MOVE CD-BR-LC-FG  TO LCAP-BATCH-REFCD-LC-FG
                 PERFORM LATE-CHARGE-APPLY
                 COMPUTE TEST-AMT  = LCAP-APP + LCAP-OWE - LN-LCBAL
                 IF TEST-AMT NOT = 0
                    MOVE "LATE CHARGE IS REQUIRED" TO LOG-MSG
                    MOVE 53                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * TEST IF PAYMENT WILL ONLY COVER LC AND INTEREST:

           IF ( (CD-BR-ALLOT-OPTION = "Y") AND
                (BR-BP-NOPRIN NOT = "Y"  ) )
              OR
              ( (CD-BR-LBOX-OPTION = "Y" ) AND
                (BR-LBOX-NOPRIN NOT = "Y") )
              COMPUTE TEST-AMT = POFF-INTDUE + POFF-LCDUE
              IF BP-TRAMT NOT > TEST-AMT
                 MOVE "PAY APPLIES WITH NO PRIN" TO LOG-MSG
                 MOVE 28                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 GO TO END-ROUTINE.

      * TEST IF PAYMENT WILL CAUSE NEGATIVE CURRENT BALANCE:
      *
      * WHEN OT2BAL EXISTS, INSURE AT LEAST ($0.01 + LN-OT2BAL)
      * REMAINS IN LN-CURBAL:

           COMPUTE TEST-AMT = BP-TRAMT - POFF-INTDUE - POFF-LCDUE.
           IF LN-OT2BAL NOT = 0
              IF TEST-AMT >= (LN-CURBAL - TOT-POFF-REBATES)
                 IF ( (CD-BR-ALLOT-OPTION = "Y"    ) AND
                      (HOLD-BP-PAYOFF-NONCASH = "Y"  ) )
                    OR
                    ( (CD-BR-LBOX-OPTION = "Y"     ) AND
                      (HOLD-LBOX-PAYOFF-NONCASH = "Y") )
                    MOVE "99" TO HOLD-BP-TRCD
                 ELSE
                    MOVE "PAY EXCEEDS OTHER 2 BAL." TO LOG-MSG
                    MOVE 55                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE
                 END-IF
              END-IF
           ELSE
      * WHEN NO OT2BAL, DON'T LET LN-CURBAL GO NEGATIVE:
              IF TEST-AMT > LN-CURBAL
                 IF ( (CD-BR-ALLOT-OPTION = "Y"    ) AND
                      (HOLD-BP-PAYOFF-NONCASH = "Y"  )
                    )
                    OR
                    ( (CD-BR-LBOX-OPTION = "Y"     ) AND
                      (HOLD-LBOX-PAYOFF-NONCASH = "Y")
                    )
                    MOVE "99" TO HOLD-BP-TRCD
                 ELSE
                    MOVE "PAY EXCEEDS CURBAL" TO LOG-MSG
                    MOVE 56                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

      * 5/4/12:  IF THERE'S AN O2 BALANCE, IF IT'S NOT ENOUGH TO
      *          PAYOFF, BUT MORE THAN (CURBAL - O2BAL), THEN
      *          REJECT TO HANDLE MANUALLY.  FOR EXAMPLE, LN-CURBAL=70,
      *          20 OF THAT IS LN-OT2BAL.  BP-TRAMT = 50, REBATES = 15.
      *          SO TEST-AMT (50) IS LESS THAN CURBAL-REBATES (55),
      *          BUT > OR = THE BALANCE LESS O2 (50).  THE PROBLEM
      *          HERE IS THERE'S NOT ENOUGH TO PAYOFF(WOULD NEED 55),
      *          BUT WOULD NEED TO APPLY SOME OR ALL TO O2 BALANCE,
      *          AND STILL LEAVE AT LEAST 1 CENT IN BALANCE.  BETTER
      *          TO REQUIRE MANUAL POSTING.  PL 771.    BARB & CINDY

           IF LN-OT2BAL NOT = 0
              COMPUTE TEST-AMT = BP-TRAMT - POFF-INTDUE - POFF-LCDUE
              IF TEST-AMT < (LN-CURBAL - TOT-POFF-REBATES)
                 IF TEST-AMT >= (LN-CURBAL - LN-OT2BAL)
                    MOVE "REQUIRES MANUAL Z2" TO LOG-MSG
                    MOVE 57                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                    GO TO END-ROUTINE.

       SKIP-PAYOFF-CALC.

      * DON'T ALLOW POSTING WHEN LOAN HAS ZERO BALANCE

           IF LN-CURBAL = 0
              MOVE "ALREADY ZERO BALANCE" TO LOG-MSG
              MOVE 46                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

      * TEST FOR VALID GENERAL LEDGER INTERFACE RECORD:

           MOVE LN-OWNBR TO GI-BRANCH.
           MOVE LN-CLASS TO GI-CLASS.
           PERFORM READ-GI1-FILE.
           IF IO-FG NOT = 0
              MOVE "MISSING G/L INTERFACE " TO LOG-MSG
              MOVE 58                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.

           MOVE " " TO POSTING-ERRCD.

           IF CD-BR-FILE-TYPE = "B"
              PERFORM BANKRUPT-POSTING
           ELSE
           IF BP-TRCD = "RV"
              PERFORM REVERSAL-POSTING
           ELSE
           IF BP-TRCD = "OT"
              PERFORM OTHER-CHG-POSTING
           ELSE
              IF (BP-TRAMT > VALID-POSTING-NOPOFF) AND
                 (HOLD-BP-TRCD = "99"            )
                 PERFORM PAYOFF-POSTING
              ELSE
                 PERFORM PAYMENT-POSTING.

           IF NOT (POSTING-ERRCD = " " OR "O")
              MOVE "GENERIC POSTING ERROR" TO LOG-MSG
              MOVE 59                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              GO TO END-ROUTINE.
            
           MOVE 0                   TO RETURN-STATUS.

           MOVE "SUCCESSFUL UPDATE" TO LOG-MSG
           PERFORM CREATE-LOG.

           PERFORM CLOSE-OP-FILE.

       END-ROUTINE.
           MOVE TEMP-PATH TO ACCESS-BUF.
           PERFORM REMOVE-WORKFILE.
           PERFORM CLOSE-OP-FILE.

           GO TO END-PROGRAM.

      ************************************
       VALIDATE-REVERSAL SECTION.
      ************************************
           MOVE "Y" TO VALID-REVERSAL-FG.

           PERFORM OPEN-LP1-FILE.

           MOVE LP-PATH-OWNBR TO LP-BRNO
                                 QLP1-WBEG-BRNO
                                 QLP1-WEND-BRNO
           MOVE LN-ACCTNO     TO LP-ACCTNO
                                 QLP1-WBEG-ACCTNO
                                 QLP1-WEND-ACCTNO.
           MOVE ALL "9"       TO LP-SEQNO
                                 QLP1-WEND-SEQNO.
           MOVE ALL "0"       TO QLP1-WBEG-SEQNO.

           PERFORM START-LP1-FILE-NOT-GREATER.
           PERFORM READ-LP1-FILE-PREVIOUS.
           IF (IO-FG NOT = 0) OR (LP-ACCTNO NOT = LN-ACCTNO)
              GO TO INVALID-REVERSAL.

           IF LP-TRCD = "RV" OR LP-REV = "Y"
              GO TO INVALID-REVERSAL.

           IF LP-TRCD NOT = "PA"
              GO TO INVALID-REVERSAL.

           IF LP-PAYDATE NOT = BP-PAYDATE
              OR LP-TRAMT NOT = BP-TRAMT
                 OR LP-REFNO NOT = BP-REFCD
                    GO TO INVALID-REVERSAL.

           MOVE 0      TO LP-TILLNO.

           MOVE LP-REC TO WK-LP-REC.

           GO TO EXIT-VALIDATE-REVERSAL.
       INVALID-REVERSAL.
           MOVE "N" TO VALID-REVERSAL-FG.
           MOVE "NO VALID PMT FOR REVERSAL" TO LOG-MSG.
           MOVE 60                 TO RETURN-STATUS.
           IF LP-PAYDATE NOT = BP-PAYDATE
              MOVE 61                 TO RETURN-STATUS
              MOVE "NO REVERSE: NO DATE MATCH" TO LOG-MSG.
           IF LP-TRAMT NOT = BP-TRAMT
              MOVE 62                 TO RETURN-STATUS
              MOVE "NO REVERSE: NO AMT MATCH"  TO LOG-MSG.
           IF LP-REFNO NOT = BP-REFCD
              MOVE 63                 TO RETURN-STATUS
              MOVE "NO REVERSE:NO REFNO MATCH" TO LOG-MSG.
           IF LP-TRCD = "RV" OR LP-REV = "Y"
              MOVE 64                 TO RETURN-STATUS
              MOVE "NO REVERSE:LAST PMT IS RV" TO LOG-MSG.
           IF LP-TRCD NOT = "PA"
              MOVE 65                 TO RETURN-STATUS
              MOVE "NO REVERSE: NOT A 'PA'   " TO LOG-MSG.
           PERFORM CREATE-LOG.

       EXIT-VALIDATE-REVERSAL.
           PERFORM CLOSE-LP1-FILE.

      ******************************************
       CREATE-LOG SECTION.
      ******************************************
           MOVE LOG-PATH TO ACCESS-BUF.
           PERFORM ACCESS-CALL.
           IF STAT-GOOD
              PERFORM OPEN-LOG-FILE-EXTEND
           ELSE
              PERFORM OPEN-LOG-FILE-OUTPUT.

           IF RETURN-STATUS = 99
              MOVE SPACES     TO LOG-STATUS
           ELSE
           IF RETURN-STATUS = 0
              MOVE "PASS"     TO LOG-STATUS
           ELSE
              MOVE "FAIL"     TO LOG-STATUS.

           MOVE RETURN-STATUS TO LOG-RETURN.
           MOVE TRANS-DATE    TO LOG-DATE.
           PERFORM GET-TIME.
           MOVE TIME-EDIT     TO LOG-TIME.
           MOVE BT-BRANCH     TO LOG-BRNO.
           MOVE BP-LNNO       TO LOG-NUMBER.
           PERFORM WRITE-LOG-FILE.
           PERFORM CLOSE-LOG-FILE.

      ******************************************************************
       PAYMENT-POSTING SECTION.
      ******************************************************************

      * RESTORE LOAN TO ITS ORIG STATE ELSE WILL ERROR OUT OF LONPF2
      * (LN-REC == WK-SAVE-REC)

           MOVE ORIG-LN-LBOX    TO LN-LBOX.
           MOVE ORIG-LN-ALLOTCD TO LN-ALLOTCD.

      * SETUP-LP-RECORD
           PERFORM SETUP-LP-RECORD.
           MOVE BP-TRAMT TO LP-TRAMT.

      * SETUP-LONPF-BUFFER
           MOVE 0 TO HOLD-OVPAID-CHECK.

           IF PAYOFF-TRANS-FG = "Y"
              MOVE "PO" TO HOLD-POCD.

      * AUTOMATIC BATCH TRCD = "PA" FROM BPBKBR.C
      * MANUAL BATCH MAY BE "PA" OR "PY"

           IF HOLD-BP-TRCD = " "
              MOVE BP-TRCD TO HOLD-BP-TRCD LP-TRCD
           ELSE
              MOVE "PA" TO LP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

      * PAYMENT POSTING

           IF (HOLD-BP-TRCD = "RE" OR "O2")
              MOVE "LP/LONPF7" TO FORM-NAM
           ELSE
           IF HOLD-BP-TRCD = "RP"
              MOVE "LP/LONPFB" TO FORM-NAM
           ELSE
           IF (HOLD-BP-TRCD = "PL" OR "P2" OR "P3")
              MOVE "LP/LONPF9" TO FORM-NAM
           ELSE
              MOVE "LP/LONPFC" TO FORM-NAM.

           MOVE FORM-PROGX TO PAYMENT-PROG.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF  UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPFC DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "P"
              IF PAYMENT-PROG = "LONPFC"
                 MOVE "LONPFC: ALT PREPAYMENT    " TO LOG-MSG
                 PERFORM CREATE-LOG
                 MOVE 66                 TO RETURN-STATUS
                 MOVE "E" TO POSTING-ERRCD
                 GO TO PAYMENT-POSTING-EXIT.
           
           IF PAYMENT-PROG = "LONPFB"
              IF NOT (ERRCD = " " OR "P")
                 MOVE "######: PMT NOT APPLIED:&" TO LOG-MSG
                 INSPECT LOG-MSG REPLACING FIRST "######"
                                            BY PAYMENT-PROG
                 INSPECT LOG-MSG REPLACING FIRST "&"
                                            BY ERRCD
                 MOVE 67                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 MOVE "E" TO POSTING-ERRCD
                 GO TO PAYMENT-POSTING-EXIT
              END-IF
           ELSE
              IF ERRCD NOT = " "
                 MOVE "######: PMT NOT APPLIED:& " TO LOG-MSG
                 INSPECT LOG-MSG REPLACING FIRST "######"
                                            BY PAYMENT-PROG
                 INSPECT LOG-MSG REPLACING FIRST "&"
                                            BY ERRCD
                 MOVE 68                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 MOVE "E" TO POSTING-ERRCD
                 GO TO PAYMENT-POSTING-EXIT.

      * PAYMENT UPDATE

           MOVE 0 TO HOLD-PRIOR-DF-POSTDATE.

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO PAYMENT-POSTING-EXIT.

       PAYMENT-POSTING-EXIT.
           EXIT.

      ******************************************************************
       PAYOFF-POSTING SECTION.
      ******************************************************************

      * RESTORE LOAN TO ITS ORIG STATE ELSE WILL ERROR OUT
      * OF LONPF2 (LN-REC == WK-SAVE-REC)

           MOVE ORIG-LN-LBOX    TO LN-LBOX.
           MOVE ORIG-LN-ALLOTCD TO LN-ALLOTCD.
           MOVE 0               TO HOLD-OVPAID-CHECK.

      * NO O2 MONIES

           IF LN-OT2BAL = 0
              IF ( (CD-BR-ALLOT-OPTION = "Y"      ) AND
                   (BR-BP-PAYOFF-OV = "O" OR "M"  ) )
                 OR
                 ( (CD-BR-LBOX-OPTION = "Y"       ) AND
                   (BR-LBOX-PAYOFF-OV = "O" OR "M") )
                 SUBTRACT WILL-POFF-ACCOUNT FROM BP-TRAMT
                                      GIVING HOLD-OVPAID-CHECK
                                             OVPAID-AMT
                 IF OVPAID-AMT NOT = 0
                    MOVE OVPAID-AMT TO DISPLAY-OVPAID-AMT
                    MOVE "OVER PAID = ###########" TO LOG-MSG
                    INSPECT LOG-MSG REPLACING
                          FIRST "###########" BY DISPLAY-OVPAID-AMT
                    MOVE 70                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                 END-IF
                 MOVE WILL-POFF-ACCOUNT TO BP-TRAMT
                 PERFORM POST-PO
                 IF POSTING-ERRCD NOT = " "
                    GO TO PAYOFF-POSTING-EXIT
                 END-IF
              ELSE
                 MOVE 0 TO HOLD-OVPAID-CHECK
                 SUBTRACT WILL-POFF-ACCOUNT FROM BP-TRAMT
                                        GIVING OVPAID-AMT
                 MOVE WILL-POFF-ACCOUNT TO BP-TRAMT
                 IF BP-TRAMT NOT = 0
                    PERFORM POST-PO
                    IF POSTING-ERRCD NOT = " "
                       GO TO PAYOFF-POSTING-EXIT
                    END-IF
                 END-IF
                 IF OVPAID-AMT NOT = 0
                    MOVE OVPAID-AMT TO DISPLAY-OVPAID-AMT
                    MOVE "OVER PAID = ###########" TO LOG-MSG
                    INSPECT LOG-MSG REPLACING
                          FIRST "###########" BY DISPLAY-OVPAID-AMT
                    MOVE "O" TO POSTING-ERRCD
                    MOVE 70                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                 END-IF
              END-IF
           ELSE
      * O2 MONIES EXIST SO EITHER PAYOFF OR REFUND LEAVING $0.01 IN PRIN
              PERFORM POST-Z2
              IF POSTING-ERRCD NOT = " "
                 GO TO PAYOFF-POSTING-EXIT
              END-IF
              SUBTRACT TEST-AMT FROM BP-TRAMT
              PERFORM READ-LN1-FILE
              IF IO-FG NOT = 0
                 MOVE "AFTER Z2, LOAN MISSING" TO LOG-MSG
                 MOVE 71                 TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 MOVE "E" TO POSTING-ERRCD
                 GO TO PAYOFF-POSTING-EXIT
              END-IF
              IF ( (CD-BR-ALLOT-OPTION = "Y"      ) AND
                   (BR-BP-PAYOFF-OV = "O" OR "M"  ) )
                 OR
                 ( (CD-BR-LBOX-OPTION = "Y"       ) AND
                   (BR-LBOX-PAYOFF-OV = "O" OR "M") )
                 IF WILL-POFF-ACCOUNT >= BP-TRAMT
                    MOVE 0 TO HOLD-OVPAID-CHECK
                              OVPAID-AMT
      * REFUNDS + "PY"
                    IF BP-TRAMT > 0
                       PERFORM POST-REFUNDS-PLUS-PY
                    END-IF
                    GO TO PAYOFF-POSTING-EXIT
                 ELSE
                    SUBTRACT WILL-POFF-ACCOUNT FROM BP-TRAMT
                                      GIVING HOLD-OVPAID-CHECK
                                             OVPAID-AMT
                    MOVE OVPAID-AMT TO DISPLAY-OVPAID-AMT
                    MOVE "OVER PAID = ###########" TO LOG-MSG
                    INSPECT LOG-MSG REPLACING
                          FIRST "###########" BY DISPLAY-OVPAID-AMT
                    MOVE 70                 TO RETURN-STATUS
                    PERFORM CREATE-LOG
                 END-IF
                 PERFORM POST-PO
                 IF POSTING-ERRCD NOT = " "
                    GO TO PAYOFF-POSTING-EXIT
                 END-IF
              ELSE
                 MOVE 0 TO HOLD-OVPAID-CHECK
                 IF WILL-POFF-ACCOUNT >= BP-TRAMT
                    MOVE 0 TO OVPAID-AMT
      * REFUNDS + "PY"
                    IF BP-TRAMT > 0
                       PERFORM POST-REFUNDS-PLUS-PY
                    END-IF
                    GO TO PAYOFF-POSTING-EXIT
                 ELSE
                    SUBTRACT WILL-POFF-ACCOUNT FROM BP-TRAMT
                                        GIVING OVPAID-AMT
                    IF OVPAID-AMT NOT = 0
                      MOVE OVPAID-AMT TO DISPLAY-OVPAID-AMT
                      MOVE "OVER PAID = ###########" TO LOG-MSG
                      INSPECT LOG-MSG REPLACING
                           FIRST "###########" BY DISPLAY-OVPAID-AMT
                       MOVE 70                 TO RETURN-STATUS
                       PERFORM CREATE-LOG
                    END-IF
                 END-IF
                 PERFORM POST-PO
              END-IF.

       PAYOFF-POSTING-EXIT.
           EXIT.

      *********************************************************
       POST-PO SECTION.
      *********************************************************

      * SETUP-LP-RECORD

           PERFORM SETUP-LP-RECORD.
           MOVE BP-TRAMT TO LP-TRAMT.
           MOVE "PO"     TO LP-TRCD.

      * SETUP-LONPF-BUFFER

           MOVE "PO" TO HOLD-POCD.

           MOVE "99" TO HOLD-BP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

      * PAYOFF POSTING

           MOVE "LP/LONPFA" TO FORM-NAM.

           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPFC DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD NOT = " "
              MOVE "LONPFA: PMT NOT APPLIED   " TO LOG-MSG
              MOVE 72                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-PO-EXIT.

      * PAYOFF UPDATE

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF  UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-PO-EXIT.

       POST-PO-EXIT.
           EXIT.

      *********************************************************
       POST-Z2 SECTION.
      *********************************************************

      * SETUP-LP-RECORD

           PERFORM SETUP-LP-RECORD.

           MOVE "Z2" TO LP-TRCD.

      * ASSURE THAT $0.01 REMAININGS IN PRINCIPAL

           IF LN-OT2BAL > (BP-TRAMT - VALID-POSTING-NOPOFF)
              COMPUTE TEST-AMT
                      LP-TRAMT
                      LP-APOT2 = BP-TRAMT - VALID-POSTING-NOPOFF
           ELSE
              MOVE LN-OT2BAL TO TEST-AMT
                                LP-TRAMT
                                LP-APOT2.

      * SETUP-LONPF-BUFFER
           MOVE " "  TO HOLD-POCD.
           MOVE "Z2" TO HOLD-BP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

      * Z2 POSTING
           MOVE "LP/LONPFC" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME PROG-BUF
                                           UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPFC DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD NOT = " "
              MOVE "LONPFC: PMT NOT APPLIED   " TO LOG-MSG
              MOVE 73                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-Z2-EXIT.

      * Z2 UPDATE

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-Z2-EXIT.

       POST-Z2-EXIT.
           EXIT.

      *********************************************************
       POST-REFUNDS-PLUS-PY SECTION.
      *********************************************************

           MOVE 0 TO SUB1.
       POST-REFUNDS-PLUS-PY-AGAIN.
           ADD 1 TO SUB1.
           IF SUB1 > 13
              GO TO POST-REFUNDS-PLUS-PY-NOW.

           IF SUB1 = 1
              IF POFF-REBATE(1) NOT = 0
                 MOVE "RC" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "RC" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 2
              IF POFF-REBATE(2) NOT = 0
                 MOVE "RA" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "RA" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 3
              IF POFF-REBATE(3) NOT = 0
                 MOVE "RP" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "RP" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 4
              IF POFF-REBATE(4) NOT = 0
                 MOVE "RI" TO HOLD-BP-TRCD
              ELSE
                 GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 5
              IF POFF-REBATE(5) NOT = 0
                 MOVE "RS" TO HOLD-BP-TRCD
              ELSE
                 GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 6
              IF POFF-REBATE(6) NOT = 0
                 MOVE "RM" TO HOLD-BP-TRCD
              ELSE
                 GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 7
              IF POFF-REBATE(7) NOT = 0
                 MOVE "RD" TO HOLD-BP-TRCD
              ELSE
                 GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 8
              GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 9
              IF POFF-REBATE(9) NOT = 0
                 MOVE "R1" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1 - 5) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "R1" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 10
              IF POFF-REBATE(10) NOT = 0
                 MOVE "R2" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1 - 5) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "R2" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 11
              IF POFF-REBATE(11) NOT = 0
                 MOVE "R3" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1 - 5) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "R3" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 12
              IF POFF-REBATE(12) NOT = 0
                 MOVE "R4" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1 - 5) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "R4" TO HOLD-BP-TRCD
                 ELSE
                 GO TO POST-REFUNDS-PLUS-PY-AGAIN.
           IF SUB1 = 13
              IF POFF-REBATE(13) NOT = 0
                 MOVE "R5" TO HOLD-BP-TRCD
              ELSE
                 IF LN-INSPREM(SUB1 - 5) NOT = 0 AND
                    LN-REBATE(SUB1) = " "
                    MOVE "R5" TO HOLD-BP-TRCD
                 ELSE
                    GO TO POST-REFUNDS-PLUS-PY-AGAIN.

           MOVE " " TO ERRCD.
           PERFORM SETUP-LP-RECORD.
           MOVE POFF-REBATE(SUB1) TO LP-TRAMT LP-APCUR.
           MOVE HOLD-BP-TRCD      TO LP-TRCD.

      * SETUP LONPF BUFFER

      * THIS SET OF 'F9' TRIGGERS LONPFB.C TO DO A REFUND OF INTEREST
      * WITH "PO" IN REB-LPTRCD, LIKE CRNOR2.C

           IF HOLD-BP-TRCD = "RI"
              MOVE "F9" TO HOLD-BP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

           MOVE "LP/LONPFB" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME PROG-BUF
                                          UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPFB DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD NOT = " "
              MOVE "LONPFB: REFUND NOT APPLIED" TO LOG-MSG
              MOVE 67                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-REFUNDS-PLUS-PY-EXIT.

      * UPDATE PROGRAM
           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: REFUND NOT UPDATED" TO LOG-MSG
              MOVE 74                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO POST-REFUNDS-PLUS-PY-EXIT.

      * READ UPDATED LOAN
           PERFORM READ-LN1-FILE.

           GO TO POST-REFUNDS-PLUS-PY-AGAIN.

       POST-REFUNDS-PLUS-PY-NOW.

      * READ UPDATED LOAN (ONE MORE TIME, IN CASE THERE WERE NO REBATES)

           PERFORM READ-LN1-FILE.

      * MUST SET TO " " TO GET DEFAULT BP-TRCD SET:
           MOVE " " TO HOLD-BP-TRCD.

      * MERCURY RE:256X
      * MUST SET ORIG-LN-.... TO LN-..... VALUES SINCE THEY HAVE
      * CHANGED WHEN LONPF2.C WAS CALLED ABOVE AND PAYMENT-POSTING
      * ROUTINE SET THEM TO THE ORIGINAL VALUES WHEN THE LOAN WAS
      * FIRST PROCESSED.

           MOVE LN-LBOX    TO ORIG-LN-LBOX.
           MOVE LN-ALLOTCD TO ORIG-LN-ALLOTCD.

           PERFORM PAYMENT-POSTING.

           MOVE WK-LP-REC TO LP-REC.

       POST-REFUNDS-PLUS-PY-EXIT.
           EXIT.

      ******************************************************************
       OTHER-CHG-POSTING SECTION.
      ******************************************************************
      * RESTORE LOAN TO ITS ORIG STATE ELSE WILL ERROR OUT OF LONPF2
      * (LN-REC == WK-SAVE-REC)

           MOVE ORIG-LN-LBOX    TO LN-LBOX.
           MOVE ORIG-LN-ALLOTCD TO LN-ALLOTCD.

      * SETUP-LP-RECORD
           MOVE "OT"     TO BP-TRCD.
           PERFORM SETUP-LP-RECORD.

      * SETUP-LONPF-BUFFER
           MOVE 0 TO HOLD-OVPAID-CHECK.
           MOVE BP-TRCD TO HOLD-BP-TRCD LP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

      * OTHER CHARGES POSTING
           MOVE "LP/LONPF7" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                 PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF7 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD NOT = " "
              MOVE "LONPF7: 'OT' NOT APPLIED   " TO LOG-MSG
              PERFORM CREATE-LOG
              MOVE 82                            TO RETURN-STATUS
              MOVE "E" TO POSTING-ERRCD
              GO TO OTHER-CHG-POSTING-EXIT.

      * UPDATE

           MOVE 0 TO HOLD-PRIOR-DF-POSTDATE.

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                 PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD
              GO TO OTHER-CHG-POSTING-EXIT.

       OTHER-CHG-POSTING-EXIT.
           EXIT.

      ******************************************************************
       BANKRUPT-POSTING SECTION.
      ******************************************************************

      * RESTORE LOAN TO ITS ORIG STATE ELSE WILL ERROR OUT OF LONPF2
      * (LN-REC == WK-SAVE-REC)

           MOVE ORIG-LN-LBOX    TO LN-LBOX.
           MOVE ORIG-LN-ALLOTCD TO LN-ALLOTCD.

           PERFORM SETUP-LP-RECORD.

           MOVE BP-TRAMT          TO LP-TRAMT.
           MOVE BP-BNKRPT-CASE-NO TO HOLD-BNKRPT-CASE-NO.
           MOVE BP-BNKRPT-STATUS  TO HOLD-BNKRPT-STATUS.
           MOVE LN-OTHBAL         TO LP-OTHBAL.
           MOVE LN-OT2BAL         TO LP-OT2BAL.
           MOVE LN-INTBAL         TO LP-INTBAL.
           MOVE LN-LCBAL          TO LP-LCBAL.
           MOVE LN-CURBAL         TO LP-CURBAL.
           MOVE LP-PAYDATE        TO IBPC-DATE.
           PERFORM IBPC-TEST.
           MOVE IBPC-FG           TO LP-IBPC.
           MOVE LN-CURBAL         TO LP-INTDUE.
           MOVE LN-1STPYDATE      TO PDTH-DATE-WORK.
           PERFORM PAID-THRU-CALCULATION.
           MOVE PDTH-DATE-FULL    TO LP-PDTH-DATE.
           ADD LP-APLC            TO HOLD-LN-TOTERN HOLD-LN-TOTLCHG.
           ADD LP-APINT           TO HOLD-LN-TOTERN HOLD-LN-TOTINT.

      * SETUP-LONPF-BUFFER
           MOVE 0 TO HOLD-OVPAID-CHECK.

      * AUTOMATIC BATCH TRCD = "PA" FROM BPBKBR.C
      * MANUAL BATCH MAY BE "PA" OR "PY"

           MOVE BP-TRCD TO HOLD-BP-TRCD LP-TRCD.

           PERFORM SETUP-LONPF-BUFFER.

      * PAYMENT UPDATE

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                PROG-BUF UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION

           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD.

       BANKRUPT-POSTING-EXIT.
           EXIT.

      ******************************************************************
       REVERSAL-POSTING SECTION.
      ******************************************************************

      * SOME LOGIC FROM SETUP-LONPF-BUFFER:

           MOVE 0   TO ENTRY-FLAG BYPASS-AMT-ENT-FG.
           MOVE "F" TO FULL-DISPLAY.
           MOVE " " TO REV-REBATE FULL-PAGE-FG ENTER-AMT-FG
                       HOLD-DISPLAY-ERN
                       HOLD1-KEY-DOWN HOLD2-KEY-UP.

           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.

           MOVE 0 TO HOLD-PARTIALS
                     HOLD-LCPAID
                     HOLD-DLPARVHELD-ADJ
                     HOLD-AFPDLLP
                     HOLD-OVPAID-CHECK
                     HOLD-REPO-AUCTION-EXP
                     ADDON-INT-REBATE
                     ADDON-INT-EARNED
                     HOLD-PRIOR-DF-POSTDATE.

           MOVE LN-TOTINT     TO HOLD-LN-TOTINT.
           MOVE LN-TOTERN     TO HOLD-LN-TOTERN.
           MOVE LN-TOTDEF     TO HOLD-LN-TOTDFMNTS.
           MOVE LN-TOTLCHG    TO HOLD-LN-TOTLCHG.
           MOVE LN-TOTSERACCT TO HOLD-LN-TOTSERACCT.
           MOVE LN-JDRATE     TO HOLD-LN-JDRATE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 13
              MOVE 0 TO REB-AMOUNT(SUB)
              IF SUB < 7
                 MOVE LN-ACCERN(SUB) TO HOLD-LN-ACCERN(SUB)
              END-IF
              IF SUB < 9
                 MOVE " " TO INS-RB-TBL(SUB)
              END-IF
           END-PERFORM.

      * RESTORE LOAN TO ITS ORIG STATE ELSE WILL ERROR OUT
      * OF LONPF2 (LN-REC == WK-SAVE-REC)
      
           MOVE ORIG-LN-LBOX    TO LN-LBOX.
           MOVE ORIG-LN-ALLOTCD TO LN-ALLOTCD.

           MOVE LX-REC  TO WK-LX-REC.
           MOVE LXE-REC TO WK-LXE-REC.
           MOVE LXG-REC TO WK-LXG-REC.
           PERFORM CLOSE-LP1-FILE.

           PERFORM READ-EARNINGS.

      * GET THE GL FOR THIS REVERSAL
           PERFORM OPEN-LXG1-FILE.
           MOVE LP-BRNO   TO LXG-BRNO.
           MOVE LP-ACCTNO TO LXG-ACCTNO.
           MOVE LP-SEQNO  TO LXG-SEQNO.
           PERFORM READ-LXG1-FILE.
           PERFORM CLOSE-LXG1-FILE.
           IF IO-FG NOT = 0
              MOVE 0 TO LXG-GLNO(1)  LXG-GLNO(2)  LXG-GLNO(3)
                        LXG-GLAMT(1) LXG-GLAMT(2) LXG-GLAMT(3).

       REVERSAL-LP1-FILE.
           MOVE LP-TRCD  TO REV-TRCD.
           MOVE LP-REFNO TO REV-REFNO.

           ADD LN-INTBAL LP-APINT GIVING LP-INTBAL.
           ADD LN-OTHBAL LP-APOTH GIVING LP-OTHBAL.
           ADD LN-LCBAL LP-APLC GIVING LP-LCBAL.

           MOVE LN-CURBAL TO LP-CURBAL.

      * "OTWOAPJDPLPIPWRPTSTPSPBKBD" (NOT).
      *  PA NOT IN LIST SO WILL BE CDV-NO-MATCH
           MOVE CDV-17 TO CDV-BUF.
           PERFORM CDV-VERIFY.

      * THE "DF" HAS THE AMOUNT IN INTDUE SO INTBAL COMES OUT RIGHT:
           IF (CDV-NO-MATCH OR (REV-TRCD = "Z2"))
              IF ( REV-TRCD NOT = "WL" ) AND
                 ( SP-CAL-RATETYPE(1) NOT = "Z" ) AND
                 ( NOT (REV-TRCD = "RE" AND LN-LOANTYPE = "I") )
                   SUBTRACT LP-INTDUE FROM LP-INTBAL.

      * ADDON-POSTING, LP-APINTOWE HOLDS LN-INTPDTH BEFORE ADDON:
           IF (CDV-NO-MATCH OR (REV-TRCD = "Z2"))
              IF NOT ADDON-POSTING
                 SUBTRACT LP-APINTOWE FROM LP-LCBAL.

           MULTIPLY -1 BY
              LP-TRAMT LP-APOTH LP-APINT LP-APLC LP-APCUR
              LP-INTDUE LP-DLPROC LP-EARNED(1) LP-EARNED(2)
              LP-EARNED(3) LXG-GLAMT(1) LXG-GLAMT(2) LXG-GLAMT(3)
              LP-INTPAID LXE-EARN(1) LXE-EARN(2) LXE-EARN(3)
              LXE-EARN(4) LXE-EARN(5) LXE-EARN(6) LXE-EARN(7)
              LXE-WORKER LXE-WORKER2 LP-NOLCHG LP-PREPAY-PENALTY
              LP-PRORATED-INS-REB LP-EXTRA-PRIN-LFP LP-APPLIED-TO-ESCROW.

      * ADDON-POSTING, LP-APINTOWE HOLDS LN-INTPDTH BEFORE ADDON
           IF REV-TRCD NOT = "SP" AND NOT = "DC" AND
                        NOT ADDON-POSTING
              MULTIPLY -1 BY LP-APINTOWE.

           IF REB-AMOUNT(1) NOT = 0
              IF LN-ADDON-FG = "Y"
                 ADD LN-ANTICADJ(1) REB-AMOUNT(1)
                                         GIVING ADDON-INT-REBATE.

      * FOR PC ACCOUNTS, 'RI' MAY HAVE A VALUE:
           MOVE SPACES TO HOLD-DL-RVCHGS-CODE(1)
                          HOLD-DL-RVCHGS-CODE(2)
                          HOLD-DL-RVCHGS-CODE(3)
                          HOLD-DL-PARVHELD-CODE
                          HOLD-DL-PARVPAID-CODE.

           IF LN-SERVACCT NOT = "Y"
              PERFORM CALC-HOLD-LN-ACCERN.

           COMPUTE HOLD-LN-TOTERN =
                LN-TOTERN
                    + LP-EARNED(1) + LP-EARNED(2) + LP-EARNED(3)
                     + LXE-EARN(1) + LXE-EARN(2)  + LXE-EARN(3)
                     + LXE-EARN(4) + LXE-EARN(5)  + LXE-EARN(6)
                     + LXE-EARN(7).

           IF LN-SERVACCT NOT = "Y"
              IF NOT ADDON-POSTING
                  IF REV-TRCD NOT = "WI" AND NOT = "WL"
                     IF REV-TRCD NOT = "RD"
                        ADD LP-APINT LP-APLC TO HOLD-LN-TOTERN
                     ELSE
                        SUBTRACT LP-TRAMT FROM HOLD-LN-TOTERN.

           MOVE LN-TOTDEF TO HOLD-LN-TOTDFMNTS.
           IF DF-POSTING
              IF SP-DEFFRMLA = 97 OR 96 OR 95
                 COMPUTE HOLD-LN-TOTINT = LN-TOTINT + LP-APINT
              ELSE
                 COMPUTE HOLD-LN-TOTDFMNTS = LN-TOTDEF + LP-APINT
              END-IF
           ELSE
              IF REV-TRCD = "RD"
                 COMPUTE HOLD-LN-TOTDFMNTS = LN-TOTDEF - LP-TRAMT
              ELSE
                 IF REB-AMOUNT(7) NOT = 0
                   COMPUTE HOLD-LN-TOTDFMNTS = LN-TOTDEF - REB-AMOUNT(7)
                   SUBTRACT REB-AMOUNT(7) FROM HOLD-LN-TOTERN.

           IF NOT (DF-POSTING AND (SP-DEFFRMLA = 97 OR 96 OR 95))
              MOVE LN-TOTINT TO HOLD-LN-TOTINT.
           MOVE LN-TOTLCHG TO HOLD-LN-TOTLCHG.
           MOVE LN-TOTSERACCT TO HOLD-LN-TOTSERACCT.

      * PACESETTER DEFFRMLA 8 CAN HAVE LATE CHARGES
           IF REV-TRCD NOT = "WL"
              IF REVERSE-AFTER-RESCHED-FG = "N"
                 COMPUTE HOLD-LN-TOTLCHG = LN-TOTLCHG + LP-APLC.

           IF REV-TRCD NOT = "WI" AND
                        NOT DF-POSTING AND
                         NOT ADDON-POSTING
              COMPUTE HOLD-LN-TOTINT = LN-TOTINT + LP-APINT.

      * UCCC LATE CHARGES
      * CAN'T TAKE LATE CHARGE ON MONIES PAID WITHIN GRACE DAYS OF DUE DAY

           IF ( SP-LCFRMLA = "F" OR "H" OR "I" OR "J" OR "K"
                                 OR "L" OR "M" OR "P" OR "S" OR "T")
              IF REV-TRCD = "PY" OR "PA" OR "AL" OR "PE" OR "SS"
                         OR "PO" OR "PB" OR "SC" OR "RN" OR "IN"
                                 OR "RB" OR "RO" OR "PR" OR "PC"
                                 OR "PP" OR "AH" OR "PN" OR "PZ"
                 MOVE LP-LCPARTIALS TO HOLD-PARTIALS
                 MOVE LP-LCPAID TO HOLD-LCPAID.

           IF LN-SERVACCT NOT = "Y"
              GO TO BYPASS-SERVICE.

           ADD LP-EARNED(1) TO HOLD-LN-TOTSERACCT.

      * EARNED INTEREST
           ADD LP-EARNED(2) TO HOLD-LN-TOTSERACCT.
      * EARNED LCHG
           ADD LP-EARNED(3) TO HOLD-LN-TOTSERACCT.

       BYPASS-SERVICE.
           MOVE "RV" TO LP-TRCD.

      * LET REVERSAL 'RV' RECORD HAVE THE LP-PAYDATE OF THE
      * RECORD BEING REVERSED:
           MOVE TRANS-DATE TO LP-TRDATE LP-PAYDATE.

      ***********************************************************
      * LOGIC FROM BEGINNING OF DISPLAY-ENTRY-LINE IN LONPF8:
      ***********************************************************
           SUBTRACT LP-APCUR FROM LP-CURBAL.

      * CANT CHANGE LN-REC IN HERE! LONPF2 WILL EXIT IF LN-REC DOESNT
      * MATCH WK-SAVE-RECORD
           MOVE LN-TOTPAYMNTD TO HOLD-LN-TOTPAYMNTD.

      * UPDATE CONTRACTUAL PAYMENTS TO DATE:
           ADD LP-APCUR TO LN-TOTPAYMNTD
           IF SP-CAL-RATETYPE(1) = "Z"
              SUBTRACT LP-EXTRA-PRIN-LFP FROM LN-TOTPAYMNTD
              ADD LP-EXTRA-PRIN-LFP        TO LN-TOTEXCPAYMNTD.
           IF SP-CONTRFRMLA = "A"
              ADD LP-APLC TO LN-TOTPAYMNTD.
           ADD LP-APINT TO LN-TOTPAYMNTD.

      * COMPUTE PAID THRU DATE
           MOVE LN-1STPYDATE TO PDTH-DATE-WORK.
           PERFORM PAID-THRU-CALCULATION.
           MOVE PDTH-DATE-FULL TO LP-PDTH-DATE.

      * CANT CHANGE LN-REC IN HERE! LONPF2 WILL EXIT IF LN-REC DOESNT
      * MATCH WK-SAVE-RECORD
           MOVE HOLD-LN-TOTPAYMNTD TO LN-TOTPAYMNTD.

           MOVE BP-TRCD TO HOLD-BP-TRCD LP-TRCD.
           MOVE BP-REFCD TO LP-REFNO HOLD-LP-REFNO.

      * PAYMENT UPDATE

           MOVE LN-ACCTNO TO LOAN-KEY.
           MOVE LN-SSNO(1) TO BORROWER-KEY.

       REVERSAL-SAVE-SCREEN.
           MOVE 3 TO WK-KEY.
           PERFORM OPEN-WK-FILE.

           MOVE 0 TO WK-ELE.

      * THIS DOESNT GET DONE IN LONPF8, BUT LONPF1 DOES SET IT, SO IT MUST
      * GET DONE HERE, WITH NO CHANGES MADE TO THE LN-REC IN THIS PROGRAM!
           MOVE LN-REC TO WK-SAVE-RECORD.
           MOVE LP-REC TO WK-LP-REC.
           MOVE LX-REC TO WK-LX-REC.
           MOVE LXE-REC TO WK-LXE-REC.
           MOVE LXG-REC TO WK-LXG-REC.
           PERFORM WRITE-WK-FILE.
           IF IO-FG NOT = 0
              PERFORM REWRITE-WK-FILE.
           PERFORM CLOSE-WK-FILE.

       CALL-LONPF2-FOR-REVERSAL.

           MOVE "LP/LONPF2" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH EXIT-PATHNAME
                                 PROG-BUF  UPDATE-BUF.
           CANCEL FORM-PROGX.

      * TEST PROG-BUF (ERRCD) TO MAKE SURE LONPF2 DID NOT REJECT
      * THE PROPOSED TRANSACTION
      
           IF ERRCD = "E" OR "X" OR "M"
              MOVE "LONPF2: PMT NOT APPLIED  " TO LOG-MSG
              MOVE 69                 TO RETURN-STATUS
              PERFORM CREATE-LOG
              MOVE "E" TO POSTING-ERRCD.

       REVERSAL-RTN-EXIT.
           EXIT.


      **************************************************
       SETUP-LP-RECORD SECTION.
      **************************************************
           PERFORM CLEAR-LP-FILE.

           MOVE LN-STATUSFG    TO LP-STATUSFG.
           MOVE LN-ACCTNO      TO LP-ACCTNO.
           MOVE TRANS-DATE     TO LP-TRDATE.
           MOVE BP-PAYDATE     TO LP-PAYDATE.
           MOVE LN-SSNO(1)     TO LP-SSNO.
           MOVE LN-LCPDTH-DATE TO LP-LCPDTH-DATE.
      * BECAUSE CASH DRAWER IS NEVER REALY UPDATED DURING THE UPDATE
      * OF A "PA",ETC TRANSACTION, WE DECIDED TO DEFAULT THE DRAWER
      * NUMBER TO ZERO RATHER THAN MAKE THE USER ENTER A UNUSED #.
           MOVE 0              TO LP-TILLNO.
           MOVE BATCH-REFCD    TO LP-REFNO.

           IF REPAY-TRANS-ID NUMERIC
              MOVE REPAY-TRANS-ID TO LP-REPAY-TRANS-ID
           ELSE
              MOVE 0              TO LP-REPAY-TRANS-ID.

           PERFORM CLEAR-LXG-FILE.

           MOVE LP-BRNO   TO LXG-BRNO.
           MOVE LP-ACCTNO TO LXG-ACCTNO.

      **************************************************
       SETUP-LONPF-BUFFER SECTION.
      **************************************************
           MOVE 0   TO ENTRY-FLAG BYPASS-AMT-ENT-FG.
           MOVE "F" TO FULL-DISPLAY.
           MOVE " " TO REV-REBATE FULL-PAGE-FG ENTER-AMT-FG
                       HOLD-DISPLAY-ERN
                       HOLD1-KEY-DOWN HOLD2-KEY-UP.

           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.

           MOVE 0 TO HOLD-PARTIALS
                     HOLD-LCPAID
                     HOLD-DLPARVHELD-ADJ
                     HOLD-AFPDLLP
                     HOLD-OVPAID-CHECK
                     HOLD-REPO-AUCTION-EXP
                     ADDON-INT-REBATE
                     ADDON-INT-EARNED
      * ADDED 10/15/2021, WRITE ERROR TRPFILE LONPF2
      * CONVERSION FAILED WHEN CONVERTING DATE (22007) 
                     HOLD-PRIOR-DF-POSTDATE.

           IF BP-TRCD = "SS"
              MOVE BP-AUCTION-FEES TO HOLD-REPO-AUCTION-EXP
              MOVE BP-AUCTION-NAME TO HOLD-REPO-AUCTION-NAME.

           IF BP-TRCD = "PL" OR "P2" OR "P3"
              MOVE BP-PL-REASON TO HOLD-PLREASON.

           MOVE LN-TOTINT     TO HOLD-LN-TOTINT.
           MOVE LN-TOTERN     TO HOLD-LN-TOTERN.
           MOVE LN-TOTDEF     TO HOLD-LN-TOTDFMNTS.
           MOVE LN-TOTLCHG    TO HOLD-LN-TOTLCHG.
           MOVE LN-TOTSERACCT TO HOLD-LN-TOTSERACCT.
           MOVE LN-JDRATE     TO HOLD-LN-JDRATE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 13
              MOVE 0 TO REB-AMOUNT(SUB)
              IF SUB < 7
                 MOVE LN-ACCERN(SUB) TO HOLD-LN-ACCERN(SUB)
              END-IF
              IF SUB < 9
                 MOVE " " TO INS-RB-TBL(SUB)
              END-IF
           END-PERFORM.

           MOVE LN-ACCTNO TO LOAN-KEY.
           MOVE LN-SSNO(1) TO BORROWER-KEY.
           IF BP-TRCD = "OT"
              MOVE BP-TRAMT TO LP-INTDUE.
           PERFORM SAVE-SCREEN.

      ******************************************************************
       INITIALIZATION SECTION.
      ******************************************************************

           MOVE " " TO ERRCD.

           MOVE EXT-CONAME-USER-LOC TO BRANCH HOLD-PROG-BUF-BRANCH.

      *    ACCEPT ORIG-FIL   FROM ENVIRONMENT "FIL".
           ACCEPT TRANS-DATE FROM CENTURY-DATE.

      * WANT DAILY PROCESS PROGRAMS TO THINK YOU ARE IN BATCH AND NOT
      * TO DISPLAY ANYTHING
           MOVE "70" TO EXT-ROUTE-BUF.

      *  CREATE WK-FILE, IF RUNNING FROM EOCRON, WORK FILE IN /USR/TMP
      *  WAS NOT CREATED IN LONPA0
           PERFORM CREATE-WK-FILE.

           MOVE USER-PID TO TEMP-PID.

           MOVE BT-REFCD TO BATCH-REFCD.

      * CREATE SPOOL DIRECTORY AND OPEN SPOOL FILE IN 'EO'
      
      * XXXXXXXXXXXXXXXXXXXXXXXXXX
      * THIS CREATES HAVOC WHEN MULTIPLE USERS TRYING TO CREATE SAME REPORT
      *  EO/APIXXXXXX/0100CUACH AND REPOEX, THE LOG IS OPEN EXTEND
      * HANDLE THIS IN API??
      * XXXXXXXXXXXXXXXXXXXXXXXXXX

           MOVE BATCH-REFCD TO SAVE-EX-SPOOL-NAME.

      * CREATE EO DIRECTORY - HARD CODED RIGHT TO "API"
      * SC9990/EO/APIMMDDYY
           PERFORM CREATE-SPOOL-DIR.
           IF ERRCD NOT = " "
              GO TO END-INIT.

      * AT THIS POINT EX-SPOOL = EO/APIMMDDYY/0100CUACH (BATCH-REFCD)

      *    MOVE EX-SPOOL TO SUMMARY-SPOOL PRU-FILE.
      *    MOVE PRU-FILE TO LOG-SPOOL-DIR.

      * THIS IS TRYING TO CREATE 0100CUACH WHICH WE CAN NOT DO FOR MULTIPLE
      * PROCESSES
      *    PERFORM OPEN-PR-FILE.
      *    IF IO-FG NOT = 0
      *       GO TO END-INIT.
      *    PERFORM CLOSE-PR-FILE.

      * XXXX  MULTIPLE PROCESSES CAN NOT OPEN THIS AT SAME TIME

      * CREATE STEP EO/APIMMDDYY/0100EXCEPT FOR MAIN EXCEPTIONS REPORT
      *    MOVE "EXCEPT" TO SAVE-EX-SPOOL-NAME.
      *    PERFORM CREATE-SPOOL-DIR.
      *    IF ERRCD NOT = " "
      *       GO TO END-INIT.
      *    MOVE EX-SPOOL TO EXCEPT-SPOOL PRU-FILE.
      *    PERFORM OPEN-PR-FILE.
      *    IF IO-FG NOT = 0
      *       GO TO END-INIT.
      *    PERFORM CLOSE-PR-FILE.

      * CREATE STEP EO/APIMMDDYY/0100REPOEX FOR REPO EXCEPTIONS REPORT
      *    MOVE "REPOEX"   TO SAVE-EX-SPOOL-NAME.
      *    PERFORM CREATE-SPOOL-DIR.
      *    IF ERRCD NOT = " "
      *        GO TO END-INIT.
      *    MOVE EX-SPOOL TO REPOEX-SPOOL PRU-FILE.
      *    IF STAT = "00"
      *       PERFORM OPEN-PR-FILE-EXTEND
      *    ELSE
      *       PERFORM OPEN-PR-FILE.
      *    IF IO-FG NOT = 0
      *       GO TO END-INIT.
      *    PERFORM CLOSE-PR-FILE.

      *    MOVE SUMMARY-SPOOL TO PRU-FILE.
      *    PERFORM OPEN-PR-FILE-EXTEND.
      *    IF IO-FG NOT = 0
      *       GO TO END-INIT.

      * THIS SETS UP THE FIRST 32 BYTES OF LOG PATH
           MOVE EX-SPOOL TO LOG-SPOOL-DIR.

      * CREATE STEP EO/APIMMDDYY/0000LOG FOR ERRORS
      *      2023/08/18 01:04 PM 0010 078674 BEGIN SINGLE BATCH PAYMENT POSTING
      * PASS 2023/08/18 01:04 PM 0010 078674 SUCCESSFUL UPDATE
      *      2023/08/18 01:04 PM 0010 033333 BEGIN SINGLE BATCH PAYMENT POSTING
      * FAIL 2023/08/18 01:04 PM 0010 033333 ACCOUNT NOT ON FILE, ABORTED

           MOVE "BEGIN SINGLE BATCH PAYMENT POSTING" TO LOG-MSG.
           PERFORM CREATE-LOG.

           PERFORM OPEN-BR-FILE.
           PERFORM OPEN-GI1-FILE.
           PERFORM OPEN-CD1-FILE.
      * MUST LEAVE SP1-FILE OPEN BECAUSE ADDONSPR READS IT
           PERFORM OPEN-SP1-FILE.

           MOVE BATCH-REFCD TO LP-REFNO.

           MOVE 0 TO HOLD-OVPAID-CHECK.

           GO TO EXIT-INITIALIZE.
       END-INIT.
           MOVE 1 TO ERRCD.
       EXIT-INITIALIZE.
           EXIT.

      ******************************************************************
       SAVE-SCREEN SECTION.
      ******************************************************************
           MOVE 3 TO WK-KEY.
           PERFORM OPEN-WK-FILE.

           MOVE SPACES TO WK-SAVE-RECORD.
           MOVE 0      TO WK-ELE.

           MOVE LN-REC  TO WK-SAVE-RECORD.
           MOVE LP-REC  TO WK-LP-REC.
           MOVE LX-REC  TO WK-LX-REC.
           MOVE LXG-REC TO WK-LXG-REC.

           MOVE 0       TO LXE-EARN(1)
                           LXE-EARN(2)
                           LXE-EARN(3)
                           LXE-EARN(4)
                           LXE-EARN(5)
                           LXE-EARN(6)
                           LXE-EARN(7).
           IF SP-ERNFRMLA(1) = 15 OR SP-ERNFRMLA(5) = 16
              MOVE LN-ERN-IB-INTOWE TO LXE-WORKER
           ELSE
              MOVE 0                TO LXE-WORKER.
           MOVE 0 TO LXE-WORKER2.
           MOVE LXE-REC TO WK-LXE-REC.

           PERFORM WRITE-WK-FILE.
           IF IO-FG NOT = 0
              PERFORM REWRITE-WK-FILE.
       EXIT-SAVE-SCREEN.
           PERFORM CLOSE-WK-FILE.


      ******************************************************************
      *
      *  CREATE SPOOL DIRECTORY IN /XXX/XXXX/R#/EO
      *
      * STORE SPOOL FILE NAME AS /XXX/XXXX/R$/EO/....
      * WE NEED A FULL PATH NAME HERE ELSE DIR WILL CHANGE WHEN WE
      * CHANGE DIRECTORIES TO ANOTHER BRANCH.
      *
      * CHANGED TO ACCESS AS ../../ORIG/R1/EO/STEPBPREF, WITH ORIG
      * BEING ORIG DATA PATH, FULL PATH TOO LONG FOR ACCESS-BUF
      ******************************************************************
       CREATE-SPOOL-DIR SECTION.
           MOVE " " TO ERRCD.
           MOVE EXT-FILPATH-BASE      TO EX-SPOOL-BASE.
           MOVE EXT-FILPATH-MACHINE   TO EX-SPOOL-MACHINE.
           MOVE HOLD-EXT-FILPATH-DATA TO EX-SPOOL-DATA-PATH.
           ACCEPT DATE-YYYYMMDD FROM CENTURY-DATE.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY           TO EX-SPOOL-DATE.
           MOVE " "                   TO EX-SPOOL-FILE.
           MOVE EX-SPOOL              TO DIR-ACCESS-BUF.
           PERFORM DIR-ACCESS-CALL.
           IF STAT NOT = "00"
              CALL "C$MAKEDIR" USING DIR-ACCESS-BUF GIVING STAT-99
              IF STAT NOT = "00"
                 MOVE "CANNOT CREATE SPOOL DIRECTORY" TO LOG-MSG
                 MOVE 78                              TO RETURN-STATUS
                 PERFORM CREATE-LOG
                 MOVE "E" TO ERRCD
                 GO TO EXIT-CREATE-SPOOL-DIR.

           MOVE "/"                TO EX-SPOOL-FILE.
           MOVE SAVE-EX-SPOOL-NAME TO EX-SPOOL-NAME.
           MOVE "   "              TO EX-SPOOL-SUF.

      *****************************************************************
      * THEY ARE ALLOWED TO RUN THIS  MORE THAN ONCE ON THE
      * SAME TRANSACTION DATE, SO CHECK TO SEE IF REPORT EXISTS, IF
      * SO, INCREMENT THE STEP # SO WE DON'T WIPE OUT PRIOR REPORTS
      *****************************************************************
           MOVE 100 TO STEP-COUNT.
       TRY-NEXT-STEP-NO.
           MOVE STEP-COUNT TO EX-SPOOL-STEP.
           MOVE EX-SPOOL TO ACCESS-BUF.
           PERFORM ACCESS-CALL.
           IF STAT = "00"
             IF (EX-SPOOL-NAME = "REPOEX")
                GO TO EXIT-CREATE-SPOOL-DIR
             ELSE
             IF STEP-COUNT < 999
                ADD 1 TO STEP-COUNT
                GO TO TRY-NEXT-STEP-NO.

       EXIT-CREATE-SPOOL-DIR.
           EXIT.

      ******************************************************************
       CREATE-WK-FILE SECTION.
      ******************************************************************

      *  CREATE WK-FILE, IF RUNNING FROM EOCRON, WORK FILE IN /USR/TMP
      *  WAS NOT CREATED IN LONPA0

           MOVE MKTEMP-DEFAULT TO MKTEMP-BUF.
           PERFORM MKTEMP-CALL.

      * WK-FILE FOR LOAN PROCESSING USED PROCESS ID XL(PROCESS ID)

           MOVE PROCESS-ID-BUF TO USER-PID TEMP-PID.
           MOVE 9 TO IO-FG.
           PERFORM OPEN-IT.
           MOVE WK-IFN TO E-FILE.
       OPEN-WK-OUTPUT.
           OPEN OUTPUT WK-FILE.
           IF ( IO-FG = 8 )
              GO TO OPEN-WK-OUTPUT.
           IF ( IO-FG = 7 )
              PERFORM CLOSE-WK-FILE
              GO TO OPEN-WK-OUTPUT.
           PERFORM CLOSE-WK-FILE.

      *********************************
      *   NAME: CDV-VERIFY
      *   DESC: VERIFY LP-TRCD & YIELD SUBSCRIPT
      *   IN  : LP-TRCD, CDV-NN
      *   OUT : CDV-SUB; 0 = NOT_FOUND
      *********************************
       CDV-VERIFY SECTION.
           MOVE 0 TO CDV-SUB.
       CDV-VERIFY-NEXT.
           ADD 1 TO CDV-SUB.
           MOVE CDV-CD(CDV-SUB) TO STAT.
           IF STAT = LP-TRCD
              GO TO CDV-VERIFY-EXIT.
           IF STAT NOT = " "
              GO TO CDV-VERIFY-NEXT.
           MOVE 0 TO CDV-SUB.
       CDV-VERIFY-EXIT.
           EXIT.

      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\TIMEIO.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/TIMEIO
      ******************************************************************
      *              (TIMEIO)
      *   GET/FORMAT CLOCK TIME
      *=================================================================
      * REV:
      * JTG 020594 ADDED TIME-MILITARY-FG
      *
      * JKC 2020-1026 ADDED TIMER-START AND TIMER-STOP SECTIONS.
      *          USED FOR GB/TIMER.CBL.
      *
      ******************************************************************
       GET-TIME SECTION.
           ACCEPT TIME-NOW FROM TIME.
           IF TIME-MILITARY-FG = "Y"
              MOVE " " TO T-AMPM
           ELSE
              IF H-AND-M NOT GREATER THAN 1159
                 MOVE "AM" TO T-AMPM
              ELSE
                 MOVE "PM" TO T-AMPM.
           IF TIME-MILITARY-FG = " "
              IF H-AND-M IS NOT LESS THAN 1300
                 SUBTRACT 1200 FROM H-AND-M.
           IF TIME-MILITARY-FG = " "
              IF CUR-HH = 0
                 MOVE 12 TO CUR-HH.
           MOVE CUR-HH TO T-HH.
           MOVE CUR-MM TO T-MM.
           MOVE ":" TO T-COL.
           MOVE " " TO T-SPACE.

       GET-TIME-EXIT.
           MOVE " " TO TIME-MILITARY-FG.

      ******************************************************************
      *
      *   T I M E R - S T A R T 
      *
      *=================================================================
      * IN  : NOTHING
      * OUT : TIMER-LINK-BUF
      * DESC: USED TO CLEAR ALL TIME FIELDS THEN SET BEG FIELDS.
      ******************************************************************
       TIMER-START SECTION.

           MOVE ZEROES TO TIMER-DAYSEC-BEG.
           MOVE "GB/TIMER" TO FORM-NAM.
           CALL FORM-PROGX USING TIMER-LINK-BUF.
           CANCEL FORM-PROGX.

      ******************************************************************
      *
      *   T I M E R - S T O P
      *
      *=================================================================
      * IN  : TIMER-LINK-BUF
      * OUT : TIMER-LINK-BUF
      * DESC: USED TO SET END FIELD, CALCULATE ELAPSED THEN DISPLAY
      *       RESULTS IF SET BASED ON TYPE.
      ******************************************************************
       TIMER-STOP SECTION.

           MOVE "GB/TIMER" TO FORM-NAM.
           CALL FORM-PROGX USING TIMER-LINK-BUF.
           CANCEL FORM-PROGX.

      *================================================================*
      * END COPYBOOK: LIBGB\TIMEIO.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GPENV.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GPENV
      ******************************************************************
      *                    (GPENV)
      *   GLOBAL PARAMETER RECORD ENVIRONMENT
      *
      *   COPY : GPENVW
      ******************************************************************
      *   DO *NOT* ADD ANY TYPE OF COMP FIELDS TO GP-REC (KEY 1);
      *   SET ENVIRONMENT (GB/SETENV) WILL NOT WORK WITH IT.
      *   LOOK AT THE SHARED DRIVE FOR 'COBOL_SET_ENV_COMP.DOCX 
      *   FOR MORE INFORMATION.                     BH & KC 2017-1004
      ******************************************************************
      * REV:
      ******************************************************************
       GET-GPENV SECTION.
           ACCEPT GP-REC FROM ENVIRONMENT "GPENV".
      *================================================================*
      * END COPYBOOK: LIBGB\GPENV.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DATER.CPY                           *
      *================================================================*
      ****************************************************************
      * COPYMEMBER: LIBGB/DATER
      *
      * DESC: WILL ACCEPT DATES IN THE 8 DIGIT FORMAT IN WITH
      *       EITHER  "00MMDDYY" FORMAT OR "CCYYMMDD" FORMAT
      *
      *  INPUT: SYS-DATE, NUM-DATE AND NDTE-DATE ARE 9(8).
      *
      *  OUTPUT: OUTPUT DATE FORMAT WILL MATCH THAT OF THE INPUT FORMAT.
      *          IF INPUT = "00MMDDYY" THEN OUTPUT WILL BE "00MMDDYY".
      *          IF INPUT = "CCYYMMDD" THEN OUTPUT WILL BE "CCYYMMDD".
      *
      *=================================================================
      * NOTE: THE MOVE OF NUMERIC FIELDS WORKS DIFFERENTLY BETWEEN
      *       COMP AND NON-COMP FIELDS.
      *       IF MOVING A NON-COMP FIELD (SOURCE) TO ANOTHER FIELD
      *       WILL CAUSE THE FOLLOWING:
      *          MOVE SOURCE TO NON-COMP. [RESULT IS SPACES]
      *          MOVE SOURCE TO COMP-3.   [RESULT IS ZEROES]
      *          MOVE SOURCE TO COMP-6.   [RESULT IS ZEROES]
      *       WITHIN A 'MOVE' STATEMENT, THE CONVERSION ROUTINE FOR
      *       COMPRESSION OF THE 'MOVE' DOES A VERIFICATION WHICH MOVES
      *       ZEROES TO NON-NUMERIC FIELDS.  THIS WAS FOUND IN DEBUG
      *       WITHIN CONVERT-MMDDYY-TO-YYYYMMDD SECTION WHICH
      *       DATE-MMDDYY WAS SPACES GIVING A RESULT OF "2000    ".
      *       BETH & JAY DECIDED NOT TO ALTER THE ROUTINE BUT TO ADD A
      *       NUMERIC CHECK IN THE PROGRAM BEFORE CALLING TO
      *       CONVERT-MMDDYY-TO-YYYYMMDD.
      *       SEE BT-PAYDATE IN SP/BPREF AS EXAMPLE.      JAY 2017-1113
      *
      **************************************************************************
      *
      * MJD 130130 REPLACED "C" CALLS WITH VERYAND COBOL VERSIONS OF
      *            PARADATA DATE ROUTINES.   THIS IS AN INTERNAL
      *            CHANGE, THE WAY IN WHICH WE CALL AND USE THE
      *            DATE ROUTINES REMAINS UNCHANGED.
      *            ADDED A FEW INITIALZE  XXXX TO MAKE OUTPUT
      *            MATCH A15.   IN EACH CASE THE FIELD CLEARED WAS NOT
      *            PART OF THE OUTPUT SET FOR THAT FUNCTION. VERYANT
      *            USED THEM INTERNALLY FOR CALCULATIONS.
      * MJD 130212 REMOVED THE INITIALIZE STATEMENTS I ADDED.
      *            WHILE THESE WERE NOT PART OF THE OUTPUT I WAS
      *            AFFECTING OUTSIDE CALCULATIONS THAT USED THEM.
      * MJD 130313 ADDED LOGIC FROM VERYANT TO CORRECT AN ISSUE WITH
      *            ELASED TIME AND LEAP YEARS.
      * BAH 130507 DO NOT CLEAR OR INITIALIZE OR ZERO JULIAN-DATE
      *             REBATE COPY MEMBER EXPECTS BACK SPACES OR COMPILED DEFAULT
      * MJD 130509 ADDED WS-JUL-WK TO REPLACE JULIAN-DATE FOR INTERNAL
      *            CALCULATIONS. EDWIN (VERYANT) WAS USING JULIAN-DATE FROM
      *            BUFFER AND WE DO NOT WANT TO CHANGE THE VALUE UNLESS
      *            IT IS ACTUALLY PART OF THE INPUT/OUTPUT OF THE ROUTINE
      *            CALLED.
      * MJD 130514 IN C-DATE-COMPARE DO NOT CONVERT TO JULIAN
      *            IF NUM-DATE AND/OR SYS-DATE ARE ZERO.
      *            ZERO DATES WERE CAUSING AN INDEX OUT OF BOUNDS ERROR.
      * MJD 131004 ADDED TEST OF 4 DIGIT YEAR WHEN PERFORMING ELAPSED
      *            TIME ROUTINES.  PROBLEMS AROSE WHEN SPANNING CENTURY DATES
      *            NEW CODE USES WS-DATE1-YYYY AND WS-DATE2-YYYY. ADDED NEW
      *            SECTION TO SET THESE DATES: C-SET-WS-DATE-YYYY
      *            EXPANDED WS-NDTE-YY-S TO 4 DIGITS
      *            MADE CORRECTIONS FOR SWING DATE IN INCREMENT-MONTHS
      *  MJD 140124 ADDED LOGIC TO ALTER ELAPSED RESULTS WHEN ZERO DATES
      *             ARE USED TO MATCH RESULTS GENERATEDIN A15 (C-DATE-COMPARE).
      *         IN A15:
      *            IF SYS-DATE = 0
      *              IF NUM-YR < 50 THEN ELAPSED-RESULTS = "L"  FOR ALL MM/DD
      *              IF NUM-YR >= 50 THAN ELAPSED RESULTS = "G" FOR ALL MM/DD
      *              IF NUM-DATE = 123199 THEN ELAPSED RESULTS = "E"
      *              IF NUM-DATE = 0 THEN ELAPSED RESULTS = "E"
      *
      *            IF NUM-DATE = 0
      *              IF SYS-YY < 50 THEN ELAPSED-RESULTS = "G" FOR ALL MM/DD
      *              IF SYS-YY >= 50 THAN ELAPSED RESULTS = "L" FOR ALL MM/DD
      *              IF SYS-DATE = 123199 THEN ELAPSED RESULTS = "E"
      *              IF SYS-DATE = 0 THEN ELAPSED RESULTS = "E"
      *  MJD 140507 ADDED TEST OF VALID MONTH AND DAY TO BEGINNING OF
      *              C-DATE-TEST (TSTDAT)
      *  MJD 141014 REMOVED UNUSED PARA NAMES IN SECTIONS WHERE
      *              "EXIT SECTION" WAS BEING USED.  ATTEMPTING TO
      *              DEBUG A STACK OVERFLOW ERROE.
      *  MJD 141015 MADE ALL PARAGRAPHS SECTIONS.  REMOVED "EXIT SECTION"
      *             AND REPLACED WITH JUST EXIT WHERE NEEDED.
      *  MJD 1500123 CHANGE C-INCR-DAYS TO SV AND RESTORE NUM/SYS-DATE
      *              UPON ENTRY/EXIT
      *  MJD 160614 REMOVED DATER-STAT, NO LONGER NEEDED.
      *  BLM 170201 ADDED CONVERT-YYYYMMDD-TO-MMDDYYYY SECTION:
      *             WAS ADDED TO DATER BUT NOT DATER8
      *  MJD 170202 FIXED BUG IN LEAP-YEAR CALCULATION, REPLACED
      *             ND-WS-NDTE-CCYY WITH LEAP-YEAR-CCYY. FIELD WAS BEING
      *             SET BUT CODE WITHIN THE SECTION WAS MISSED.
      *             PER BARBS REQUEST CHANGED CMPDAT TO PERFORM A
      *             STRAIGHT <,>,= COMPARISON BETWEEN SYS-DATE AND NUM-DATE.
      *  MJD 170207 REMOVED C-SET-WS-DATE-YYYY AND REFERENCES TO WS-DATE1-YYYY
      *             AND WS-DATE2-YYYY AS THEY ARE NO LONGER USED AFTER HAVE
      *             BEEN REPLACED WITH WS-DATE1-CCYY AND WS-DATE2-CCYY.
      *  BLM 170213 ADD CONVERT-ALPDATE-TO-YYYYMMDD
      *  BLM 170309 BROUGHT OVER FROM A39, CAME FROM DATER8 WITH A
      *             FEW TWEAKS, PD0006
      *   CS 170315 ADD BACK CONVERT-MMDDYY-TO-YYYYMM 
      *  BLM 180312 FIXED CONVERT-ALPDATE-TO-YYMMDD, WAS CONVERTING TO
      *             DATE-MMDDYY INSTEAD OF DATE-YYMMDD 
      *
      *  JKC 200612 COMMENTED OUT THE USAGE OF YYYMMDD SINCE NO LONGER
      *             USED; IT WAS A15 FORMAT.
      *
      * JKC 20240113 COMMENT OUT JULIAN-BEG, JULIAN-END, JULIAN-CC;
      *              THEY ARE NOW EXTERNAL FIELDS POPULATED IN
      *              GB/SETENV SO TO WE CAN MORE EASILY CHANGE
      *              'SLIDING CENTURY WINDOW' IN THE FUTURE.
      * BAH 2024.0313 CHANGED 010101 TO 19000101 
      *       MOVE 19000101 TO WS-DATE1 WS-DATE2 WS-DATE1W WS-DATE2W
      * BAH 2024.0808 S35Q-105 ADDED BRIAN'S FIX FOR YEAR TYPE 365/367
      *               INVOLVING LEAP YEARS. WAS NOT MATCHING A15 C-CODE.
      *               ELAPSED DAYS WERE NOT MATCHING CAUSING REBATES TO
      *               BE OFF AND NOT IN FAVOR OF THE CUSTOMER.
      *
      ****************************************************************
      *
      * NOTE:
      * COMMENTED OUT FOR TESTING IN UT/TSTDTR8.CBL
      * PROGRAM USED IT'S OUN DATER-ROUTINE SO IT CAN PERFORM
      * VARIABLE CAPTURES BEFORE AND AFTER FOR WRITING TO DETAIL LINE.
       
      *********************************************************
        DATER-ROUTINE  SECTION.
      *********************************************************
            PERFORM C-DATER-MAIN.

      *********************************************************
       C-DATER-MAIN SECTION.
      *********************************************************
           PERFORM CONVERT-SYS-NUM-NDTE-DATES-IN.
           MOVE DATER-ACTION-CODE TO SV-DATER-ACTION-CODE.

           EVALUATE SV-DATER-ACTION-CODE
           WHEN "E" PERFORM C-ELAPSED-TIME
           WHEN "N"
      *             OK CCYY
                    PERFORM C-CALL-NEWDATE
           WHEN "I"
                    PERFORM C-INCREMENT-PERIODS
           WHEN "C"
      *             OK CCYY
                    MOVE JULIAN-DATE     TO P-CJUL-JULIAN-DATE
                    PERFORM C-CALL-CJUL
                    MOVE P-CJUL-DATE-OUT TO NUM-DATE
           WHEN "J"
      *             OK CCYY
                    MOVE NUM-DATE      TO P-DATE-IN
                    PERFORM C-CALL-JUL
                    MOVE P-JULIAN-DATE TO JULIAN-DATE
           WHEN "W"
      *             OK CCYY
                    PERFORM C-WEEKDAY
           WHEN "D"
      *             OK CCYY
                    PERFORM C-DATE-COMPARE
           WHEN "T"
                    PERFORM C-DATE-TEST
           END-EVALUATE
           MOVE SV-DATER-ACTION-CODE TO DATER-ACTION-CODE
           PERFORM CONVERT-SYS-NUM-NDTE-DATES-OUT.

      *****************************************************************
      *          INCREMENT A DATE BY A NUMBER OF UNIT PERIODS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD UNIT PERIODS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  DATER-UNITPER-CD   = M, D, Y, S, W, B
      *          DATER-UNITPER-FREQ = FREQUENCY OF UNIT PERIODS
      *          NDTE-DATE          = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD          = INCREMENT IN UNIT PERIODS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      * BLM 100208 ADD CONVERT-YYMMDD-TO-YYYYMMDD
      *****************************************************************
       INCREMENT-UNITPER SECTION.
           MOVE "I" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.

      *********************************************************
       INCREMENT-COMMON SECTION.
      *********************************************************
           MOVE 1 TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE HOLD-UNITPER-INFO TO DATER-UNITPER-INFO.

      ****************************************************
      *          INCREMENT A DATE BY A NUMBER OF YEARS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD YEARS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  NDTE-DATE = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD = INCREMENT IN UNIT YEARS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      ****************************************************
       INCREMENT-YEARS SECTION.
           MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO.
           MOVE "Y" TO DATER-UNITPER-CD.
           PERFORM INCREMENT-COMMON.

      ****************************************************
      *          INCREMENT A DATE BY A NUMBER OF MONTHS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD MONTHS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  NDTE-DATE = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD = INCREMENT IN MONTHS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      ****************************************************
       INCREMENT-MONTHS SECTION.
           MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO.
           MOVE "M" TO DATER-UNITPER-CD.
           PERFORM INCREMENT-COMMON.

      ****************************************************
      *          INCREMENT A DATE BY A NUMBER OF WEEKS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD WEEKS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  NDTE-DATE = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD = INCREMENT IN WEEKS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      ****************************************************
       INCREMENT-WEEKS SECTION.
           MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO.
           MOVE "W" TO DATER-UNITPER-CD.
           PERFORM INCREMENT-COMMON.

      ****************************************************
      *          INCREMENT A DATE BY A NUMBER OF DAYS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD DAYS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  NDTE-DATE = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD = INCREMENT IN DAYS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      ****************************************************
       INCREMENT-DAYS SECTION.
           MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO.
           MOVE "D" TO DATER-UNITPER-CD.
           PERFORM INCREMENT-COMMON.

      *******************************************************
      *          INCREMENT A DATE BY A NUMBER OF SEMIMONTHS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD SEMIMONTHS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  NDTE-DATE = YYYYMMDD TO INCREMENT
      *          NDTE-HOLD = INCREMENT IN SEMIMONTHS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      * REV:
      ********************************************************
       INCREMENT-SEMIMONTHS SECTION.
           MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO.
           MOVE "S" TO DATER-UNITPER-CD.
           PERFORM INCREMENT-COMMON.

      ************************************************
      *         NEW DATE CALCULATION
      *
      *   DESC: ADJUST NDTE-DD WHEN INCONSISTENT
      *         WITH NDTE-MM TO LAST DAY IN NDTE-MM.
      *   IN  : NDTE-DATE-WORK
      *   OUT : NDTE-DATE
      * REV:
      ************************************************
       NEW-DATE-CALCULATION SECTION.
           MOVE "N" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.

      ***************************************************
      *         CALENDER TO JULIAN DATE CONVERSION
      *
      *   DESC: COMPUTE JULIAN DATE;
      *         IF NUM-YR < EXT-JULIAN-CC
      *            DATE IS IN YEAR 2000
      *   IN  : NUM-DATE (YYYYMMDD)
      *   OUT : JULIAN-DATE IS THE NO. OF DAYS
      *         SINCE 12/31/1899; IF ERROR = 0
      * REV:
      ***************************************************
       JUL SECTION.
           MOVE "J" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.


      ********************************************************
      *         JULIAN TO CALENDER DATE CONVERSION
      *
      *   DESC: CONVERT JULIAN DATE TO NORMALIZED FORMAT
      *         ADJUST FOR ERRONEOUS JULIAN-DD
      *         MAY BE USED WITH JUL TO INCREMENT DAYS
      *   IN  : JULIAN-DATE IS THE NO. OF DAYS
      *         SINCE 12/31/1899; JULIAN-DD MAY NOT = 0
      *   OUT : NUM-DATE (YYYYMMDD); IF ERROR = 0
      * REV:
      ********************************************************
       CJUL SECTION.
           MOVE "C" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.

      ********************************************************
      *         DETERMINE DAY OF WEEK
      *
      *   DESC: THIS ROUTINE DETERMINES THE DAY OF THE WEEK.
      *
      *   IN  : NUM-DATE (YYYYMMDD)
      *   OUT : DAY--OF-WEEK
      *              DAY-IS-SUN
      *              DAY-IS-MON
      *                  ..
      *                  ..
      *              DAY-IS-SAT
      * REV:
      ********************************************************
       WEEKDAY SECTION.
           MOVE "W" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.

      ********************************************************
      *          COMPARE DATE ROUTINE
      *
      *   DESC : DETERMINE IF SYS-DATE IS < > OR = TO NUM-DATE
      *     IN : NUM-DATE SYS-DATE (BOTH YYYYMMDD)
      *    OUT : ELAPSED-RESULTS   (L, E, G, LE, GE SEE 88'S)
      *             SYS-IS-LT
      *             SYS-IS-GT
      *             SYS-IS-GR
      *             SYS-IS-EQ
      *             SYS-IS-LE
      *             SYS-IS-GE
      * REV:
      * BLV 990512 REMOVED SPECIAL CHECKS FOR ZERO DATES IN
      *            CMPDAT ROUTINE
      ********************************************************
       CMPDAT SECTION.
           MOVE "D" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.

      ***************************************************
      *         CALENDER DATE TEST
      *
      *   DESC: TEST FOR A VALID DATE
      *   IN  : NUM-DATE (YYYYMMDD)
      *   OUT : IF ERROR NUM-DATE = 0
      * REV:
      ***************************************************
       TSTDAT SECTION.
           MOVE "T" TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.


      ********************************************************
      *          ESTABLISH UNITPERIOD LOWERCASE MASK
      *
      *   DESC : ESTABLISH UNIT PERIOD MASK
      *     IN : ALP-DATE-EDIT         DATE 99/99/99
      *          DATER-UNITPER-CD      M, D, Y, S, W
      *          DATER-UNITPER-FREQ    FREQUENCY OF UNIT PERIODS
      *    OUT : ALP-DATE-EDIT         DATE 99/99W99
      *
      *             M - '/'
      *             W - 'W'  IF FREQ = 2  'B'
      *             S - 'S'
      *             Y - 'Y'
      *             D - 'D'
      * REV:
      ********************************************************
       UNITPER-MASK SECTION.
           IF DATER-UNITPER-CD = "M"
              MOVE X"2F" TO DATER-UNITPER-IT
           ELSE
           IF DATER-UNITPER-CD = "W"
              IF DATER-UNITPER-FREQ = 2
                 MOVE X"62" TO DATER-UNITPER-IT
              ELSE
                 MOVE X"77" TO DATER-UNITPER-IT
              END-IF
           ELSE
           IF DATER-UNITPER-CD = "S"
              MOVE X"73" TO DATER-UNITPER-IT
           ELSE
           IF DATER-UNITPER-CD = "Y"
              MOVE X"79" TO DATER-UNITPER-IT
           ELSE
           IF DATER-UNITPER-CD = "D"
              MOVE X"64" TO DATER-UNITPER-IT
           ELSE
           IF DATER-UNITPER-CD = "B"
              MOVE X"62" TO DATER-UNITPER-IT.

      ***********************************************************
      *               (TIMALL MONTHLY ONLY)
      *         DRIVER FOR ALL TIME CALCULATIONS
      *               (360,361,362,358,999,365,367)
      *
      *   DESC: COMPUTE ELAPSED TIME BETWEEN NUM-DATE AND SYS-DATE
      *            - CALCULATIONS ARE DEFAULTED TO:
      *                   DATER-UNITPER-CD    =  M
      *                   DATER-UNITPER-FREQ  =  1
      *            - INPUT DATES NOT ALTERED
      *            - VERIFIES DATES
      *            - 360/361/362/358/999/365/367 YEARTYPE
      *            - OUTPUT MAY BE NEGATIVE
      *   IN     : NUM-DATE               FROM        YYYYMMDD
      *            SYS-DATE               TO          YYYYMMDD
      *            ELAPSED-YRTYPE         360/361/362/358/999/365/367
      *   DEFAULT:
      *            DATER-UNITPER-CD       =  M
      *            DATER-UNITPER-FREQ     =  1
      *   OUT    : ELAPSED-DAYS
      *            ELAPSED-MONTHS
      *            ELAPSED-REM
      *            ELAPSED-RESULT         SYS-IS-LT,GT,EQ,LE,GE,GR
      * REV:
      *  JTG 032487 ADDED LOGIC FOR TIM999.
      *  JTG 101795 ADDED TIM362, MERCURY ALABAMA
      *  JTG 040397 ADDED TIM361, JEFFERSON NJ     NOTE SYSTEM
      * MJD 130213 ADDED DATER-HOLD-NDTE-DATE.  TIMALL REUSES NDTE DATE
      *            EVEN THOUGH IT IS NOT AN INPUT FOR IT BECAUSE IT CALLS
      *            NEWDATE.  THIS CAUSES ISSUES BECAUSE THE CALLING
      *            PROGRAM HAS ALREADY SET NDTE-DATE AND DOES NOT EXPECT IT
      *            TO CHANGE WHEN CALLING TIMALL.  TO FIX THIS I SAVE
      *            NDTE-DATE AND RESTORE IT AFTER THE CALL.
      * MJD 130218 ADDED TEST OF NUM-DATE/SYS-DATE = 0.   VERYANTS
      *            ROUTINES GENERATING SOME ERRORS IF WE PASSED IN BAD DATA.
      *            A15 JUST RETURNED 0'S SO I MIMICKED IT HERE.
      ***********************************************************
       TIMALL SECTION.
           IF ( NUM-DATE = 0 ) OR ( SYS-DATE = 0 )
              MOVE 0 TO ELAPSED-DAYS
                        ELAPSED-MONTHS
                        ELAPSED-REM
              MOVE SPACES TO ELAPSED-RESULTS
           ELSE
              MOVE NDTE-DATE          TO DATER-HOLD-NDTE-DATE
              MOVE DATER-UNITPER-INFO TO HOLD-UNITPER-INFO
              MOVE "M"                TO DATER-UNITPER-CD
              MOVE 1                  TO DATER-UNITPER-FREQ
              MOVE "E"                TO DATER-ACTION-CODE
              PERFORM DATER-ROUTINE
              MOVE HOLD-UNITPER-INFO  TO DATER-UNITPER-INFO
              MOVE DATER-HOLD-NDTE-DATE TO NDTE-DATE.

      ***************************************
       TIM SECTION.
      ***************************************
           MOVE 365 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM999 SECTION.
      ***************************************
           MOVE 999 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM360 SECTION.
      ***************************************
           MOVE 360 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM361 SECTION.
      ***************************************
           MOVE 361 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM362 SECTION.
      ***************************************
           MOVE 362 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM365 SECTION.
      ***************************************
           MOVE 365 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM358 SECTION.
      ***************************************
           MOVE 358 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***************************************
       TIM367 SECTION.
      ***************************************
           MOVE 367 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

      ***********************************************************
      *         TIME IN UNIT PERIODS (TIMUPER) ROUTINE
      *
      *   DESC: COMPUTE ELAPSED DAYS BETWEEN NUM-DATE AND SYS-DATE
      *         - INPUT DATES ARE NOT ALTERED
      *         - OUTPUT MAY BE NEGATIVE
      *
      *   IN  : NUM-DATE                FROM        YYYYMMDD
      *         SYS-DATE                TO          YYYYMMDD
      *         DATER-UNITPER-CD        M, D, Y, S, W, B
      *         DATER-UNITPER-FREQ      FREQUENCY OF UNIT PERIODS
      *   OUT : ELAPSED-UNITPER         ELAPSED UNIT PERIODS
      *         ELAPSED-UNITPER-REM     REMAINING DAYS
      *         ELAPSED-RESULT          SYS-IS-LT,GT,GR,EQ,LE,GE
      *         ELAPSED-DAYS
      *         ELAPSED-MONTHS
      *         ELAPSED-REM
      * REV:
      *  JTG 091693 CHANGED TIMUPER TO SET YRTYPE = 360
      *  JTG 031797 CHANGED TIMUPER BACK TO SET YRTYPE = 999
      *             RELIANCE PROBLEM:
      *                UNITPER-CD   = M
      *                UNITPER-FREQ = 1
      *                  TIMUPER YIELDS....(48M & 17REM) 360
      *                SHOULD BE:
      *                  TIMUPER...........(48M & 15REM) 999
      * MJD 170227 ADDED DATER-HOLD-NDTE-DATE.  TIMUPER REUSES NDTE DATE
      *            EVEN THOUGH IT IS NOT AN INPUT FOR IT BECAUSE IT CALLS
      *            NEWDATE.  THIS CAUSES ISSUES BECAUSE THE CALLING
      *            PROGRAM HAS ALREADY SET NDTE-DATE AND DOES NOT EXPECT IT
      *            TO CHANGE WHEN CALLING TIMUPER.  TO FIX THIS I SAVE
      *            NDTE-DATE AND RESTORE IT AFTER THE CALL.
      *            THIS IS THE SAME FIX AS USED FOR TIMALL ABOVE.
      ***********************************************************
       TIMUPER SECTION.
      *   ELAPSED-YRTYPE IS SET FOR (DUMMY) MONTHLY ELAPSED CALCULATIONS
           MOVE NDTE-DATE TO DATER-HOLD-NDTE-DATE.
           MOVE 999       TO ELAPSED-YRTYPE.
           MOVE "E"       TO DATER-ACTION-CODE.
           PERFORM DATER-ROUTINE.
           MOVE DATER-HOLD-NDTE-DATE TO NDTE-DATE.

      ******************************************************************
      *   DESC:  CONVERT ALPHA DATE FORMAT 'MM/DD/YY' TO 'MMDDYY'
      *   IN  :  ALP-DATE
      *   OUT :  DATE-MMDDYY
      *-----------------------------------------------------------------
      * REV:
      * BAH 020416 ***NEW***
      ******************************************************************
       CONVERT-ALPDATE-TO-MMDDYY SECTION.
           MOVE ALP-MO TO DATE-MMDDYY-MM.
           MOVE ALP-DA TO DATE-MMDDYY-DD.
           MOVE ALP-YR TO DATE-MMDDYY-YY.

      ******************************************************************
      *   DESC:  CONVERT ALPHA DATE FORMAT 'MM/DD/YY' TO 'YYMMDD'
      *   IN  :  ALP-DATE
      *   OUT :  DATE-YYMMDD
      *-----------------------------------------------------------------
      * REV:
      * BAH 11/17/2014 NEW
      ******************************************************************
       CONVERT-ALPDATE-TO-YYMMDD SECTION.
           MOVE ALP-YR TO DATE-YYMMDD-YY.
           MOVE ALP-MO TO DATE-YYMMDD-MM.
           MOVE ALP-DA TO DATE-YYMMDD-DD.

      ******************************************************************
      *   DESC:  CONVERT ALPHA DATE FORMAT 'MM/DD/YY' TO 'CCYYMMDD'
      *   IN  :  ALP-DATE
      *   OUT :  DATE-YYYYMMDD
      *-----------------------------------------------------------------
      * REV:
      * BLM 2/13/2017 NEW
      ******************************************************************
       CONVERT-ALPDATE-TO-YYYYMMDD SECTION.
           MOVE ALP-MO TO DATE-YYYYMMDD-MM.
           MOVE ALP-DA TO DATE-YYYYMMDD-DD.
           MOVE ALP-YR TO DATE-YYYYMMDD-YYYY.
           IF ( DATE-YYYYMMDD NOT = ZEROES )
              IF ( DATE-YYYYMMDD-YYYY < EXT-JULIAN-CC )
                 ADD 2000 TO DATE-YYYYMMDD-YYYY
              ELSE
                 ADD 1900 TO DATE-YYYYMMDD-YYYY.

      ******************************************************************
       CONVERT-YYYYMMDD-TO-ALPDATE SECTION.
      ******************************************************************
           MOVE DATE-YYYYMMDD-MM TO ALP-MO.
           MOVE DATE-YYYYMMDD-DD TO ALP-DA.
           MOVE DATE-YYYYMMDD-YY TO ALP-YR.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'MMSDDSYY'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-MMSDDSYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0425 ***NEW***
      *
      ******************************************************************
       CONVERT-MMDDYY-TO-MMSDDSYY SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-MMSDDSYY-MM.
           MOVE "/"            TO DATE-MMSDDSYY-S1.
           MOVE DATE-MMDDYY-DD TO DATE-MMSDDSYY-DD.
           MOVE "/"            TO DATE-MMSDDSYY-S2.
           MOVE DATE-MMDDYY-YY TO DATE-MMSDDSYY-YY.

       CV-MMDDYY-TO-MMSDDSYY-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'MMSDDSYYYY'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-MMSDDSYYYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0425 ***NEW***
      *
      ******************************************************************
       CONVERT-MMDDYY-TO-MMSDDSY4 SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-MMSDDSYYYY-MM.
           MOVE "/"            TO DATE-MMSDDSYYYY-S1.
           MOVE DATE-MMDDYY-DD TO DATE-MMSDDSYYYY-DD.
           MOVE "/"            TO DATE-MMSDDSYYYY-S2.
           MOVE DATE-MMDDYY-YY TO DATE-MMSDDSYYYY-YYYY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  NOTE: IF DATE-MMDDYY IS SPACES THEN THE FOLLOWING WILL MAKE
      *        DATE-MMSDDSYYYY TO BE "  /  /2000".  MUST ADD NUMERIC
      *        CHECK IN GIVEN PROGRAM PRIOR TO PERFORMING THIS ROUTINE
      *        IF YOU KNOW THAT DATE-MMDDYY COULD BE SPACES/NON-NUMERIC.
      *        SEE THE NOTE AT THE TOP OF LIBGB/DATER FOR MORE INFO.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( DATE-MMSDDSYYYY-MM   NOT = ZEROES ) AND
              ( DATE-MMSDDSYYYY-DD   NOT = ZEROES )
              IF ( DATE-MMSDDSYYYY-YYYY < EXT-JULIAN-CC )
                 ADD 2000 TO DATE-MMSDDSYYYY-YYYY
              ELSE
                 ADD 1900 TO DATE-MMSDDSYYYY-YYYY.

       CV-MMDDYY-TO-MMSDDSY4-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'MMYY'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-MMYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0204 ***NEW***
      *
      ******************************************************************
       CONVERT-MMDDYY-TO-MMYY SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-MMYY-MM.
           MOVE DATE-MMDDYY-YY TO DATE-MMYY-YY.

       CV-MMDDYY-TO-MMYY-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'YYMM'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-YYMM
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0204 ***NEW***
      *
      ******************************************************************
       CONVERT-MMDDYY-TO-YYMM SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-YYMM-MM.
           MOVE DATE-MMDDYY-YY TO DATE-YYMM-YY.

       CV-MMDDYY-TO-YYMM-EXIT.
           EXIT.


      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYYYMMDD' TO 'YYYYMM'
      *   IN  :  DATE-YYYYMMDD
      *   OUT :  DATE-YYYYMM
      ******************************************************************
       CONVERT-YYYYMMDD-TO-YYYYMM SECTION.

           MOVE DATE-YYYYMMDD-MM   TO DATE-YYYYMM-MM.
           MOVE DATE-YYYYMMDD-YYYY TO DATE-YYYYMM-YYYY.

       CV-YYYYMMDD-TO-YYYYMM-EXIT.
           EXIT.

      ******************************************************************
       CONVERT-YYYYMMDD-TO-YYMMDD SECTION.
      ******************************************************************

           MOVE DATE-YYYYMMDD-MM TO DATE-YYMMDD-MM.
           MOVE DATE-YYYYMMDD-DD TO DATE-YYMMDD-DD.
           MOVE DATE-YYYYMMDD-YY TO DATE-YYMMDD-YY.

       CV-YYYYMMDD-TO-YYMMDD-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'YYYYMMDD'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-YYYYMMDD
      *-----------------------------------------------------------------
      * REV:
      * KEC 033099 ***NEW***
      ******************************************************************
       CONVERT-MMDDYY-TO-YYYYMMDD SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-YYYYMMDD-MM.
           MOVE DATE-MMDDYY-DD TO DATE-YYYYMMDD-DD.
           MOVE DATE-MMDDYY-YY TO DATE-YYYYMMDD-YYYY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  NOTE: IF DATE-MMDDYY IS SPACES THEN THE FOLLOWING WILL MAKE
      *        DATE-YYYYMMDD TO BE "2000    ".  MUST ADD NUMERIC CHECK
      *        IN GIVEN PROGRAM PRIOR TO PERFORMING THIS ROUTINE IF
      *        YOU KNOW THAT DATE-MMDDYY COULD BE SPACES/NON-NUMERIC.
      *        SEE THE NOTE AT THE TOP OF LIBGB/DATER FOR MORE INFO.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( DATE-YYYYMMDD NOT = ZEROES )
              IF ( DATE-YYYYMMDD-YYYY < EXT-JULIAN-CC )
                 ADD 2000 TO DATE-YYYYMMDD-YYYY
              ELSE
                 ADD 1900 TO DATE-YYYYMMDD-YYYY.

       CV-MMDDYY-TO-YYYYMMDD-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYY' TO 'YYYYMM'
      *   IN  :  DATE-MMDDYY
      *   OUT :  DATE-YYYYMM
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0204 ***NEW***
      *
      ******************************************************************
       CONVERT-MMDDYY-TO-YYYYMM SECTION.

           MOVE DATE-MMDDYY-MM TO DATE-YYYYMM-MM.
           MOVE DATE-MMDDYY-YY TO DATE-YYYYMM-YYYY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  NOTE: IF DATE-MMDDYY IS SPACES THEN THE FOLLOWING WILL MAKE
      *        DATE-YYYYMM TO BE "2000  ".  MUST ADD NUMERIC CHECK
      *        IN GIVEN PROGRAM PRIOR TO PERFORMING THIS ROUTINE IF
      *        YOU KNOW THAT DATE-MMDDYY COULD BE SPACES/NON-NUMERIC.
      *        SEE THE NOTE AT THE TOP OF LIBGB/DATER FOR MORE INFO.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( DATE-YYYYMM NOT = ZEROES )
              IF ( DATE-YYYYMM-YYYY < EXT-JULIAN-CC )
                 ADD 2000 TO DATE-YYYYMM-YYYY
              ELSE
                 ADD 1900 TO DATE-YYYYMM-YYYY.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMYY' TO 'MMDDYY'
      *   IN  :  DATE-MMYY
      *   OUT :  DATE-MMDDYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0204 ***NEW***
      *
      ******************************************************************
       CONVERT-MMYY-TO-MMDDYY SECTION.

           MOVE DATE-MMYY-MM TO DATE-MMDDYY-MM.
           MOVE ZEROES       TO DATE-MMDDYY-DD.
           MOVE DATE-MMYY-YY TO DATE-MMDDYY-YY.

       CV-MMYY-TO-MMDDYY-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYMMDD' TO 'MMDDYY'
      *   IN  :  DATE-YYMMDD
      *   OUT :  DATE-MMDDYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 033099 ***NEW***
      ******************************************************************
       CONVERT-YYMMDD-TO-MMDDYY SECTION.

           MOVE DATE-YYMMDD-MM TO DATE-MMDDYY-MM.
           MOVE DATE-YYMMDD-DD TO DATE-MMDDYY-DD.
           MOVE DATE-YYMMDD-YY TO DATE-MMDDYY-YY.

       CV-YYMMDD-TO-MMDDYY-EXIT.
           EXIT.


      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYYYMM' TO 'MMDDYY'
      *   IN  :  DATE-YYYYMM
      *   OUT :  DATE-MMDDYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 2000.0204 ***NEW***
      *
      ******************************************************************
       CONVERT-YYYYMM-TO-MMDDYY SECTION.

           MOVE DATE-YYYYMM-MM TO DATE-MMDDYY-MM.
           MOVE ZEROES         TO DATE-MMDDYY-DD.
           MOVE DATE-YYYYMM-YY TO DATE-MMDDYY-YY.

       CV-YYYYMM-TO-MMDDYY-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYYYMMDD' TO 'MMDDYY'
      *   IN  :  DATE-YYYYMMDD
      *   OUT :  DATE-MMDDYY
      *-----------------------------------------------------------------
      * REV:
      * KEC 033099 ***NEW***
      ******************************************************************
       CONVERT-YYYYMMDD-TO-MMDDYY SECTION.

           MOVE DATE-YYYYMMDD-MM TO DATE-MMDDYY-MM.
           MOVE DATE-YYYYMMDD-DD TO DATE-MMDDYY-DD.
           MOVE DATE-YYYYMMDD-YY TO DATE-MMDDYY-YY.

       CV-YYYYMMDD-TO-MMDDYY-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYYYMMDD' TO 'MMDDYYYY'
      *   IN  :  DATE-YYYYMMDD
      *   OUT :  DATE-MMDDYYYY
      *-----------------------------------------------------------------
      * REV:
      *  BAH 10/20/2016  ***NEW***
      ******************************************************************
       CONVERT-YYYYMMDD-TO-MMDDYYYY SECTION.
           MOVE DATE-YYYYMMDD-MM   TO DATE-MMDDYYYY-MM.
           MOVE DATE-YYYYMMDD-DD   TO DATE-MMDDYYYY-DD.
           MOVE DATE-YYYYMMDD-YYYY TO DATE-MMDDYYYY-YYYY.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'YYMMDD' TO 'YYYYMMDD'
      *   IN  :  DATE-YYMMDD
      *   OUT :  DATE-YYYYMMDD
      *-----------------------------------------------------------------
      * REV:
      * BLM 100208 ***NEW***
      ******************************************************************
       CONVERT-YYMMDD-TO-YYYYMMDD SECTION.

           MOVE DATE-YYMMDD-MM TO DATE-YYYYMMDD-MM.
           MOVE DATE-YYMMDD-DD TO DATE-YYYYMMDD-DD.
           MOVE DATE-YYMMDD-YY TO DATE-YYYYMMDD-YYYY.

           IF ( DATE-YYYYMMDD NOT = ZEROES )
              IF ( DATE-YYYYMMDD-YYYY < EXT-JULIAN-CC )
                 ADD 2000 TO DATE-YYYYMMDD-YYYY
              ELSE
                 ADD 1900 TO DATE-YYYYMMDD-YYYY.

       CV-YYMMDD-TO-YYYYMMDD-EXIT.
           EXIT.

      ******************************************************************
      *   DESC:  CONVERT DATE FORMAT 'MMDDYYYY' TO 'YYYYMMDD'
      *   IN  :  DATE-MMDDYYYY
      *   OUT :  DATE-YYYYMMDD
      ******************************************************************
       CONVERT-MMDDYYYY-TO-YYYYMMDD SECTION.

           MOVE DATE-MMDDYYYY-MM TO DATE-YYYYMMDD-MM.
           MOVE DATE-MMDDYYYY-DD TO DATE-YYYYMMDD-DD.
           MOVE DATE-MMDDYYYY-YYYY TO DATE-YYYYMMDD-YYYY.

       CV-MMDDYYYY-TO-YYYYMMDD-EXIT.
           EXIT.

      ***********************************************************
      *
      *   DESC: COMPUTE ELAPSED TIME BETWEEN NUM-DATE AND SYS-DATE
      *            - CALCULATIONS ARE DEFAULTED TO:
      *                   DATER-UNITPER-CD    =  M
      *                   DATER-UNITPER-FREQ  =  1
      *            - INPUT DATES NOT ALTERED
      *            - VERIFIES DATES
      *            - 360/361/362/358/999/365/367 YEARTYPE
      *            - OUTPUT MAY BE NEGATIVE
      *   IN     : NUM-DATE               FROM        MMDDYY
      *            SYS-DATE               TO          MMDDYY
      *            ELAPSED-YRTYPE         360/361/362/358/999/365/367
      *   DEFAULT:
      *            DATER-UNITPER-CD       =  M
      *            DATER-UNITPER-FREQ     =  1
      *   OUT    : ELAPSED-DAYS
      *            ELAPSED-MONTHS
      *            ELAPSED-REM
      *            ELAPSED-RESULT         SYS-IS-LT,GT,EQ,LE,GE,GR
      ***********************************************************
       C-ELAPSED-TIME SECTION.
           MOVE DATER-UNITPER-FREQ TO WS-XUNITPER-FREQ.
           MOVE DATER-UNITPER-CD   TO WS-XUNITPER-CODE.
           MOVE NUM-DATE           TO WS-DATE1 WS-DATE1W.
           MOVE SYS-DATE           TO WS-DATE2 WS-DATE2W.
      *----------------------------------------------------------------------
      *      TEST NUM-DATE AND/OR SYS-DATE = 0
      *      IF SO SET ALL OUTPUT = 0
      *          NOTE:
      *                CDTOI(   YR = 0, YIELDS 100   )
      *----------------------------------------------------------------------*/
           IF WS-DATE1 = 0 OR WS-DATE2 = 0
      *       MOVE 010101 TO WS-DATE1 WS-DATE2 WS-DATE1W WS-DATE2W.
              MOVE 19000101 TO WS-DATE1 WS-DATE2 WS-DATE1W WS-DATE2W.

           MOVE ELAPSED-YRTYPE TO TA-YRTYPE.
      *-----------------------------------------------------
      *       BASED ON YEAR TYPE
      *       DETERMINE:
      *                 ELAPSED MONTHS
      *                 ELAPSED DAYS
      *                 ELAPSED REM
      *                 RESULTS OF COMPARE
      *-----------------------------------------------------*
           PERFORM C-TIMALL
           PERFORM C-TIM-RESULTS
           MOVE WS-TIM-RESULTS TO ELAPSED_RESULTS
           MOVE WS-XMONTHS     TO ELAPSED-MONTHS
           MOVE WS-XDAYS       TO ELAPSED-DAYS
           MOVE WS-XREM        TO ELAPSED-REM
      *-----------------------------------------------------
      *       BASED ON UNIT PERIOD CODE & FREQ
      *       DETERMINE:
      *                 ELAPSED UNIT PERIODS
      *                 ELAPSED REM
      *-----------------------------------------------------*
           MOVE WS-DATE1W TO WS-DATE1
           MOVE WS-DATE2W TO WS-DATE2
           IF WS-XUNITPER-CODE = "Y" OR WS-XUNITPER-CODE = "M"
              MOVE 998 TO TA-YRTYPE
              PERFORM C-TIMALL
           ELSE
              IF WS-XUNITPER-CODE = "S"
                 MOVE 360 TO TA-YRTYPE
                 PERFORM C-TIMALL
              ELSE
                 MOVE 365 TO TA-YRTYPE
                 PERFORM C-TIMALL
              END-IF
           END-IF

           EVALUATE WS-XUNITPER-CODE
           WHEN "M"
                   IF WS-XUNITPER-FREQ = 1
                      MOVE WS-XMONTHS TO WS-XUNITPER
                      MOVE WS-XREM    TO WS-XUNITPER-REM
                   ELSE
                      COMPUTE WS-XDAYS = WS-XREM + (WS-XMONTHS * 30)
                      COMPUTE WS-DIV-TMP = WS-XUNITPER-FREQ * 30
                      DIVIDE  WS-XDAYS BY WS-DIV-TMP
                                         GIVING     WS-XUNITPER
                                         REMAINDER  WS-XUNITPER-REM
                   END-IF
           WHEN "S"
                   COMPUTE WS-XDAYS = (WS-XMONTHS * 30) + WS-XREM
                   COMPUTE WS-DIV-TMP = WS-XUNITPER-FREQ * 15
                   DIVIDE  WS-XDAYS BY WS-DIV-TMP
                                       GIVING     WS-XUNITPER
                                       REMAINDER  WS-XUNITPER-REM
           WHEN "W"
                   COMPUTE WS-DIV-TMP = WS-XUNITPER-FREQ * 7
                   DIVIDE  WS-XDAYS BY WS-DIV-TMP
                                       GIVING     WS-XUNITPER
                                       REMAINDER  WS-XUNITPER-REM
           WHEN "B"
                   COMPUTE WS-DIV-TMP = WS-XUNITPER-FREQ * 14
                   DIVIDE  WS-XDAYS BY WS-DIV-TMP
                                       GIVING     WS-XUNITPER
                                       REMAINDER  WS-XUNITPER-REM
           WHEN "D"
                   DIVIDE  WS-XDAYS BY WS-XUNITPER-FREQ
                                       GIVING     WS-XUNITPER
                                       REMAINDER  WS-XUNITPER-REM
           WHEN "Y"
                   COMPUTE WS-DIV-TMP = WS-XUNITPER-FREQ * 12
                   DIVIDE  WS-XMONTHS  BY WS-DIV-TMP
                                       GIVING     WS-XUNITPER
                                       REMAINDER  WS-XUNITPER-REM
           END-EVALUATE
           MOVE WS-XUNITPER     TO ELAPSED-UNITPER
           MOVE WS-XUNITPER-REM TO ELAPSED-UNITPER-REM

      *    MJD NOT PART OF OUTPUT
      *    INITIALIZE NDTE-DATE
           .

      **********************************************************
      *              (358,360,361,362,365,367,999 & 998 UNITPER)
      *
      *   NAME:  C-TIMALL
      *   DESC:  PERFORMS SELECTED TIME ROUTINE:
      *          358/360/361/362/365/367/999  & 998 UNITPER
      *   IN  :  TA-YRTYPE
      *   OUT :
      *********************************************************
       C-TIMALL SECTION.
           EVALUATE TA-YRTYPE
           WHEN 358 PERFORM C-TIM360-358
           WHEN 360 PERFORM C-TIM360-358
           WHEN 361 PERFORM C-TIM361
           WHEN 362 PERFORM C-TIM362
           WHEN 365 PERFORM C-TIM365-367
           WHEN 367 PERFORM C-TIM365-367
           WHEN 998 PERFORM C-TIM999-998
           WHEN 999 PERFORM C-TIM999-998
           END-EVALUATE
           .

      ***********************************************************
      *         COMPUTE ELAPSED TIME USING 360 OR 358 YRTYPE
      *
      *   NAME: C-TIM360_358
      *   DESC: COMPUTE ELAPSED TIMES BETWEEN DATE1 AND DATE2
      *
      *   IN  : YEAR TYPE
      *   OUT : ELAPSED_MONTHS, ELAPSED_DAYS AND ELAPSED_REM
      ***********************************************************
       C-TIM360-358 SECTION.
           PERFORM C-TIMBEG.
           IF WS-DATE1-DD > 30
              MOVE 30 TO WS-DATE1-DD.
           IF WS-DATE2-DD > 30
              MOVE 30 TO WS-DATE2-DD.

           MOVE WS-DATE2-CCYY TO LEAP-YEAR-CCYY.
           PERFORM C-LEAP-YEAR-TEST.

           IF WS-DATE2-MM = 2 AND WS-DATE2-DD > WS-DATE1-DD
              IF WS-DATE2-DD = 29 AND LEAP-YEAR-TRUE
                 MOVE 30 TO WS-DATE2-DD
              ELSE
                IF WS-DATE2-DD = 28 AND LEAP-YEAR-FALSE
                   MOVE 30 TO WS-DATE2-DD.

           IF WS-DATE2-MM = 2 AND WS-DATE2-DD < WS-DATE1-DD
              IF WS-DATE2-DD = 29 AND LEAP-YEAR-TRUE
                 MOVE 29 TO WS-DATE1-DD
              ELSE
                IF WS-DATE2-DD = 28 AND LEAP-YEAR-FALSE
                   MOVE 28 TO WS-DATE1-DD.

           IF TA-YRTYPE = 358
              MOVE WS-DATE1-CCYY TO LEAP-YEAR-CCYY
              PERFORM C-LEAP-YEAR-TEST
              IF WS-DATE1-MM = 2 AND WS-DATE1-DD > WS-DATE2-DD
                 IF LEAP-YEAR-FALSE
                    ADD 2 TO WS-DATE1-DD
                 ELSE
                    ADD 1 TO WS-DATE1-DD.

           COMPUTE WS-XDAYS = ( (WS-DATE2-CCYY - WS-DATE1-CCYY) * 360 )
                              + ( (WS-DATE2-MM - WS-DATE1-MM) * 30 )
                              + (WS-DATE2-DD - WS-DATE1-DD).
           PERFORM C-TIMEND.

      ******************************************************************
      *         COMPUTE ELAPSED TIME USING 361 YRTYPE
      *   NOTE:
      *         THIS IS A VERSION OF 358 YEAR-TYPE MODIFY FOR NOTES.
      *         IT CAUSES TIME FROM FEB. 28 TO THE (29TH, 30TH OR 31ST)
      *         OF ANOTHER MONTH, TO VIEW FEB. 28 AS THE 30TH.
      *
      *   NAME: C-TIM361
      *   DESC: COMPUTE ELAPSED TIME BETWEEN DATE1 AND DATE2
      *
      *   IN  :
      *   OUT : ELAPSED_MONTHS, ELAPSED_DAYS AND ELAPSED_REM
      ******************************************************************
       C-TIM361 SECTION.
           PERFORM C-TIMBEG.
           IF WS-DATE1-DD > 30
              MOVE 30 TO WS-DATE1-DD.
           IF WS-DATE2-DD > 30
              MOVE 30 TO WS-DATE2-DD.
           IF WS-DATE2-MM = 2 AND WS-DATE2-DD > WS-DATE1-DD
              MOVE WS-DATE2-CCYY TO LEAP-YEAR-CCYY
              PERFORM C-LEAP-YEAR-TEST
              IF LEAP-YEAR-TRUE AND WS-DATE2-DD = 29
                 MOVE 30 TO WS-DATE2-DD
              ELSE
                IF LEAP-YEAR-FALSE AND WS-DATE2-DD = 28
                   MOVE 30 TO WS-DATE2-DD.

           IF WS-DATE2-MM = 2 AND WS-DATE2-DD < WS-DATE1-DD
              MOVE WS-DATE2-CCYY TO LEAP-YEAR-CCYY
              PERFORM C-LEAP-YEAR-TEST
              IF LEAP-YEAR-TRUE AND WS-DATE2-DD = 29
                 MOVE 29 TO WS-DATE1-DD
              ELSE
                IF LEAP-YEAR-FALSE AND WS-DATE2-DD = 28
                   MOVE 28 TO WS-DATE1-DD.

           IF NOT (
              WS-DATE1-MM NOT = 2 OR
              (WS-DATE1-DD < 28 AND WS-DATE1-DD NOT > WS-DATE2-DD) OR
              (WS-DATE1-DD = WS-DATE2-DD AND WS-DATE1-MM = WS-DATE2-MM
               AND WS-DATE1-CCYY = WS-DATE2-CCYY)
                  )
              MOVE WS-DATE1-CCYY TO LEAP-YEAR-CCYY
              PERFORM C-LEAP-YEAR-TEST
              IF LEAP-YEAR-FALSE
                 ADD 2 TO WS-DATE1-DD
              ELSE
                 ADD 1 TO WS-DATE1-DD.

           COMPUTE WS-XDAYS = ((WS-DATE2-CCYY - WS-DATE1-CCYY) * 360)
                            + ((WS-DATE2-MM - WS-DATE1-MM) * 30)
                            + (WS-DATE2-DD - WS-DATE1-DD ).

           PERFORM C-TIMEND.

      ***********************************************************
      *         COMPUTE ELAPSED TIME USING 362 YRTYPE
      *
      *   NAME: C-TIM362
      *   DESC: COMPUTE ELAPSED TIME BETWEEN DATE1 AND DATE2
      *
      *   IN  :
      *   OUT : ELAPSED_MONTHS, ELAPSED_DAYS AND ELAPSED_REM
      ***********************************************************
       C-TIM362 SECTION.
           MOVE WS-DATE2 TO WS-DATEX.
           PERFORM C-TIMBEG.
           COMPUTE WS-XREM    = WS-DATE2-CCYY - WS-DATE1-CCYY.
           COMPUTE WS-XMONTHS = WS-DATE2-MM - WS-DATE1-MM.
           COMPUTE WS-XDAYS   = WS-DATE2-DD - WS-DATE1-DD.

           IF ( WS-XDAYS NOT < 0 )
              COMPUTE WS-XDAYS = (( (WS-XREM * 12) + WS-XMONTHS) * 30 )
                                 + WS-XDAYS
           ELSE
              ADD -1 TO WS-XMONTHS
              COMPUTE WS-HOLD-MOS = (WS-XREM * 12) + WS-XMONTHS
              MOVE -1 TO WS-UP-WORK
              MOVE WS-DATEX-CCYY TO WS-NDTE-CCYY-S
              MOVE WS-DATEX-MM TO WS-NDTE-MM-S
              MOVE WS-DATEX-DD TO WS-NDTE-DD-S
              PERFORM C-INCR-MONTHS
              MOVE WS-NDTE-CCYY-S TO WS-DATEX-CCYY
              MOVE WS-NDTE-MM-S TO WS-DATEX-MM
              MOVE WS-NDTE-DD-S TO WS-DATEX-DD
              MOVE WS-DATE1-DD TO WS-DATEX-DD
              IF WS-DATE1-DD > 28
                 COMPUTE WS-TMP-WORK = DYTOM(WS-DATEX-MM + 1) -
                                       DYTOM(WS-DATEX-MM)
                 MOVE WS-DATEX-CCYY TO LEAP-YEAR-CCYY
                 PERFORM C-LEAP-YEAR-TEST
                 IF LEAP-YEAR-FALSE AND WS-DATEX-MM = 2
                    ADD 1 TO WS-TMP-WORK
                 END-IF
                 IF WS-DATE1-DD > WS-TMP-WORK
                    COMPUTE WS-DATEX-MM = WS-DATE2-MM
                    MOVE 1 TO WS-DATEX-DD
                    MOVE WS-DATE2-CCYY TO WS-DATEX-CCYY
                 END-IF
              END-IF

              MOVE WS-DATE2 TO P-DATE-IN
              PERFORM C-CALL-JUL
              MOVE P-JULIAN-DATE TO WS-TMP-JUL-1

              MOVE WS-DATEX TO P-DATE-IN
              PERFORM C-CALL-JUL
              MOVE P-JULIAN-DATE TO WS-TMP-JUL-2

              COMPUTE WS-XDAYS = WS-TMP-JUL-1 - WS-TMP-JUL-2
              IF WS-XDAYS > 30
                 COMPUTE WS-XDAYS = WS-XDAYS + ((WS-HOLD-MOS - 1) * 30)
              ELSE
                 COMPUTE WS-XDAYS = WS-XDAYS + (WS-HOLD-MOS * 30)
              END-IF
           END-IF.

           PERFORM C-TIMEND.

      ***********************************************************
      *         COMPUTE ELAPSED TIME USING 365 OR 367 YRTYPE
      *
      *   NAME: C-TIM365_367
      *   DESC: COMPUTE ELAPSED TIME BETWEEN DATE1 AND DATE2
      *
      *   IN  :
      *   OUT : ELAPSED_MONTHS, ELAPSED_DAYS AND ELAPSED_REM
      ***********************************************************
       C-TIM365-367 SECTION.
           PERFORM C-TIMBEG.
           COMPUTE WS-XREM    = WS-DATE2-CCYY - WS-DATE1-CCYY.
           COMPUTE WS-XMONTHS = WS-DATE2-MM - WS-DATE1-MM.
           COMPUTE WS-XDAYS   = WS-DATE2-DD - WS-DATE1-DD.
           IF WS-XDAYS < 0
              MOVE WS-DATE2-MM TO WS-DATE1-MM
              MOVE WS-DATE2-CCYY TO WS-DATE1-CCYY
              COMPUTE WS-WORK = DYTOM(WS-DATE2-MM + 1)
                                - DYTOM(WS-DATE2-MM)
              DIVIDE WS-DATE2-YY BY 4 GIVING WS-DIV-RESULT
                                  REMAINDER WS-MOD-4

              MOVE WS-DATE2-CCYY TO LEAP-YEAR-CCYY
              PERFORM C-LEAP-YEAR-TEST

      *****************
      *  BHO - THE ORIGINAL CHECK CLOSELY CORRESPONDS TO THE C CODE,
      *        SO THE LEAP DAY CHECK WOULD TYPICALLY EVALUATE THE
      *        SAME WAY FOR MOST YEARS DIVISIBLE BY 4. 
      *****************
              IF WS-MOD-4 = 0 AND WS-DATE2-MM > 1
                ADD 1 TO WS-WORK
              END-IF
      *****************
      *       IF LEAP-YEAR-TRUE AND WS-DATE2-MM > 1
      *           ADD 1 TO WS-WORK
      *       END-IF

              IF WS-DATE2-DD NOT < WS-WORK
                 MOVE 0 TO WS-XDAYS
              END-IF

              ADD -1 TO WS-XMONTHS
              ADD -1 TO WS-DATE1-MM
              IF WS-DATE1-MM = 0
                 MOVE 12 TO WS-DATE1-MM
                 ADD -1  TO WS-DATE1-CCYY
              END-IF

              COMPUTE WS-WORK = DYTOM(WS-DATE1-MM + 1)
                                - DYTOM(WS-DATE1-MM)

      *****************
      * 2024/08/01
      *  BHO - I RESTORED VERYANT'S CODE FOR THE SECOND SET OF DATE
      *        CALCULATIONS BECAUSE IT APPEARS THAT MIKE (MJD) MAY HAVE
      *        MISUNDERSTOOD WHAT THE C CODE IS DOING. THE C CODE
      *        ISN'T ACTUALLY CHECKING TO SEE IF THE SECOND DATE IS
      *        A LEAP YEAR IN ORDER TO ADD A DAY LIKE MIKE ASSUMED.
      *
      *        IT IS ACTUALLY TESTING THE OPPOSITE TO MAKE SURE 
      *        THAT IT DOESN'T ADD MORE DAYS THAN NECESSARY.
      *        IT'S NOT EASILY APPARENT WHAT THE C CODE IS DOING 
      *        BECAUSE OF THE STYLE IN WHICH IT WAS WITTEN.
      *
      *        THE FOLLOWING COMMENT IS FROM VERYANT...

      ***************
      *
      *  THE FOLLOWING ADJUSTMENT IS TO APPLY THE MODULUS 4 OPERATION
      *  TO THE NEGATED VALUE OF THE DATE1 YEAR
      *  ALTHOUGH IT IS A STRANGE WAY OF EVALUATING THIS EXPRESSION
      *  THIS WILL BE THE ACCURATE CONVERSION OF THE ORIGINAL C EXPRESSION
      *
      ***************
               IF WS-DATE1-YY = ZERO
                   MOVE 1 TO NOT-YEAR
               ELSE
                   MOVE 0 TO NOT-YEAR
               END-IF

               DIVIDE NOT-YEAR    BY 4 GIVING WS-DIV-RESULT
                                       REMAINDER WS-MOD-4

               IF WS-MOD-4 NOT = 0 AND WS-DATE1-MM > 1
                  ADD 1 TO WS-WORK
               END-IF

              IF WS-DATE1-DD NOT < WS-WORK
                  MOVE WS-DATE2-DD TO WS-XDAYS
              ELSE
                  COMPUTE WS-XDAYS = WS-DATE2-DD + WS-WORK
                                                 - WS-DATE1-DD
              END-IF

      *****************
      *  BHO - PRESERVING MIKE'S REASONING BELOW. HIS CODE HAS
      *        BEEN COMMENTED OUT AND REPLACED WITH VERYANT'S
      *        ORIGINAL CODE ABOVE. WANTED SOMEONE TO KNOW WHAT
      *        IT LOOKED LIKE IN CASE THERE'S A BUG IN THE ABOVE.
      ***************
      * MJD 20151118 NOT REALLY SURE WHAT IS GOING ON HERE
      *  EFFECTIVELY IT IS SAYING THAT IF YEAR IS "2000" AND MONTH IS 2 OR LATER
      *    THEN INCREASE WORK BY ONE.  I GET THE LEAR YEAR TEST BECAUSE
      *    THIS IS BASED ON REAL DAYS BUT NOT SURE WHY THE STD LEAP YEAR TEST
      *    STD TEST DID NOT WORK OR WHY IT ONLY LOOKS FOR 2000.
      *    MAY NEED TO REVISIT THIS IN TESTING.
      ***************
      *        IF WS-DATE1-YY = ZERO MOVE 1 TO NOT-YEAR
      *        ELSE                  MOVE 0 TO NOT-YEAR
      *        END-IF
      **       DIVIDE WS-DATE1-YY BY 4 GIVING WS-DIV-RESULT
      *        DIVIDE NOT-YEAR    BY 4 GIVING WS-DIV-RESULT
      *                             REMAINDER WS-MOD-4

      **       IF WS-MOD-4     = 0 AND WS-DATE1-MM > 1
      *        IF WS-MOD-4 NOT = 0 AND WS-DATE1-MM > 1
      *           ADD 1 TO WS-WORK
      *        END-IF
      ***************
      * ADDING LOGIG AS IT APPEAR IN DATER.C
      * REALLY NEED TO LOOK AT THIS IN TESTING!!!!!!
      *       MOVE WS-DATE1-CCYY TO LEAP-YEAR-CCYY
      *       PERFORM C-LEAP-YEAR-TEST
      *       IF LEAP-YEAR-TRUE AND WS-DATE1-MM > 1
      *          ADD 1 TO WS-WORK
      *       END-IF
      ***************

      *       IF WS-DATE1-DD NOT < WS-WORK
      *          MOVE WS-DATE2-DD TO WS-XDAYS
      *       ELSE
      *          COMPUTE WS-XDAYS = WS-DATE2-DD + WS-WORK - WS-DATE1-DD
      *       END-IF

           END-IF
      * C-TIM365-367-COMPUTE (IF WS-XDAYS NOT < 0, LOGIC WILL FALL THRU HERE)
           COMPUTE WS-XDAYS = (WS-XREM * 360) + (WS-XMONTHS * 30)
                              + WS-XDAYS

           PERFORM C-TIMEND.

      ***********************************************************
      * ORIGINAL REMARKS
      *         COMPUTE ELAPSED TIME USING 999 YRTYPE
      *                TRUTH AND LENDING METHOD
      *           AND
      *                 ELAPSED UNIT PERIODS 998 YRTYPE
      *
      *   NAME: TIM999_998
      *   DESC: COMPUTE ELAPSED TIMES BETWEEN DATE1 AND DATE2
      *         BASED ON TRUTH AND LENDING REG. Z
      *
      *         COMPUTE ELAPSED UNIT PERIODS BETWEEN DATE1
      *         AND DATE2
      *
      *   IN  :
      *   OUT : ELAPSED_MONTHS, ELAPSED_DAYS AND ELAPSED_REM
      *         IF 998 ELAPSED_MONTHS = ELAPSED UNIT PERIODS
      * REV:
      *  JTG 050297 CHANGED TO PASS YRTYPE TO C-TIMEND FOR 998
      *             ELAPSED UNIT PERIODS
      *             EXAMPLE:
      *                     NUM-DATE:  030397
      *                     SYS-DATE:  050297
      *      
      *                                     999     998
      *                                     ---     ---
      *                     ELAPSED_MONTHS:   2       1
      *                     ELAPSED_DAYS  :  60      60
      *                     ELAPSED_REM   :   0      30
      ***********************************************************
       C-TIM999-998 SECTION.
           PERFORM C-TIMBEG.
           COMPUTE WS-XMONTHS = (
                           (WS-DATE2-CCYY - WS-DATE1-CCYY) * 12 ) +
                           (  WS-DATE2-MM - WS-DATE1-MM ).

           IF WS-DATE1-DD > WS-DATE2-DD
              ADD -1 TO WS-XMONTHS.

           COMPUTE WS-UP-WORK = 0 - WS-XMONTHS.
           MOVE WS-DATE2-MM TO WS-NDTE-MM-S.
           MOVE WS-DATE2-DD TO WS-NDTE-DD-S.
           MOVE WS-DATE2-CCYY TO WS-NDTE-CCYY-S.
           PERFORM C-INCR-MONTHS.
           MOVE WS-NDTE-CCYY-S TO WS-DATE2-CCYY.
           MOVE WS-NDTE-MM-S TO WS-DATE2-MM.
           MOVE WS-NDTE-DD-S TO WS-DATE2-DD.

           MOVE WS-DATE2 TO P-DATE-IN.
           PERFORM C-CALL-JUL.
           MOVE P-JULIAN-DATE TO WS-JUL-TMP.
           COMPUTE WS-XDAYS = (WS-XMONTHS * 30) + WS-JUL-TMP - WS-JUL-1.

           PERFORM C-TIMEND.

      *********************************************************
      *          INITIAL ROUTINES FOR ALL ELAPSED TIME ROUTINES
      *
      *   NAME:  C-TIMBEG
      *   DESC:  THIS ROUTINE SETS UP THE DATES IN REVERSE
      *          ORDER IF NUMDATE IS AFTER SYSDATE
      *          THIS ROUTINE ALSO CONVERTS DATES TO JULIAN
      *   IN  :
      *   OUT :
      *********************************************************
       C-TIMBEG SECTION.
           MOVE NUM-DATE TO SV-NUM-DATE.
           MOVE SYS-DATE TO SV-SYS-DATE.

           MOVE WS-DATE1 TO P-DATE-IN.
           PERFORM C-CALL-JUL.
           MOVE P-JULIAN-DATE TO WS-JUL-1.

           MOVE WS-DATE2 TO P-DATE-IN.
           PERFORM C-CALL-JUL.
           MOVE P-JULIAN-DATE TO WS-JUL-2.

           IF WS-JUL-1 > WS-JUL-2
              MOVE WS-DATE1 TO WS-HOLDDATE
              MOVE WS-DATE2 TO WS-DATE1
              MOVE WS-HOLDDATE TO WS-DATE2
              MOVE WS-JUL-1    TO WS-HOLDJUL
              MOVE WS-JUL-2    TO WS-JUL-1
              MOVE WS-HOLDJUL  TO WS-JUL-2
              MOVE -1 TO WS-XSIGN
           ELSE
              MOVE  1 TO WS-XSIGN.

           MOVE SV-NUM-DATE TO NUM-DATE.
           MOVE SV-SYS-DATE TO SYS-DATE.

      **********************************************************
      *          END ROUTINES FOR ALL ELAPSED TIME ROUTINE
      *
      *   NAME:  C-TIMEND
      *   DESC:  THIS ROUTINE SETS THE CORRECT SIGN ON ELAPSED
      *   IN  :
      *   OUT :
      * REV:
      *  JTG 050297 CHANGED FOR 998 ELAPSED UNIT PERIODS
      *********************************************************/
       C-TIMEND SECTION.
           COMPUTE WS-XDAYS = WS-XSIGN * WS-XDAYS.
           IF TA-YRTYPE = 998
              COMPUTE WS-XMONTHS = WS-XMONTHS * WS-XSIGN
              COMPUTE WS-XREM    = WS-XDAYS - (WS-XMONTHS * 30)
           ELSE
              DIVIDE WS-XDAYS BY 30 GIVING WS-XMONTHS
                                 REMAINDER WS-XREM.

           IF TA-YRTYPE = 365
              COMPUTE WS-XDAYS = WS-XSIGN * (WS-JUL-2 - WS-JUL-1).

           IF (WS-XSIGN < 0)
              MOVE WS-DATE2    TO WS-HOLDDATE
              MOVE WS-DATE1    TO WS-DATE2
              MOVE WS-HOLDDATE TO WS-DATE1
              MOVE WS-JUL-2    TO WS-HOLDJUL
              MOVE WS-JUL-1    TO WS-JUL-2
              MOVE WS-HOLDJUL  TO WS-JUL-1.

      *****************************************************************
      *          INCREMENT A DATE BY A NUMBER OF UNIT PERIODS
      *
      *   DESC:  INCREMENT NDTE-DATE BY NDTE-HOLD UNIT PERIODS;
      *          CORRECT DAY AND MONTH IF REQUIRED.
      *   IN  :  DATER-UNITPER-CD   = M, D, Y, S, W, B
      *          DATER-UNITPER-FREQ = FREQUENCY OF UNIT PERIODS
      *          NDTE-DATE          = MMDDYY TO INCREMENT
      *          NDTE-HOLD          = INCREMENT IN UNIT PERIODS (+ OR -)
      *   OUT :  NDTE-DATE = INCREMENTED DATE
      *****************************************************************

       C-INCREMENT-PERIODS SECTION.
           MOVE NDTE-MM TO WS-NDTE-MM-S.
           MOVE NDTE-DD TO WS-NDTE-DD-S.
           MOVE NDTE-CCYY TO WS-NDTE-CCYY-S.
           COMPUTE WS-UP-WORK = NDTE-HOLD * DATER-UNITPER-FREQ.

           EVALUATE DATER-UNITPER-CD
           WHEN "M"
                    PERFORM C-INCR-MONTHS
           WHEN "S"
                    PERFORM C-INCR-HALF-MONTHS
           WHEN "W"
                    COMPUTE WS-UP-WORK = WS-UP-WORK * 7
                    PERFORM C-INCR-DAYS
           WHEN "B"
                    COMPUTE WS-UP-WORK = WS-UP-WORK * 14
                    PERFORM C-INCR-DAYS
           WHEN "D"
                    PERFORM C-INCR-DAYS
           WHEN "Y"
                    COMPUTE WS-UP-WORK = WS-UP-WORK * 12
                    PERFORM C-INCR-MONTHS
           END-EVALUATE.

           MOVE WS-NDTE-MM-S TO NDTE-MM.
           MOVE WS-NDTE-DD-S TO NDTE-DD.
           MOVE WS-NDTE-CCYY-S TO NDTE-CCYY.
           MOVE "N" TO DATER-ACTION-CODE.
           PERFORM C-CALL-NEWDATE.

      *********************************************************
      *          INCREMENT DAYS TO A DATE
      *********************************************************
       C-INCR-DAYS SECTION.
           MOVE NUM-DATE TO SV-NUM-DATE.
           MOVE SYS-DATE TO SV-SYS-DATE.
           MOVE NDTE-DATE TO NUM-DATE.
           MOVE NUM-DATE TO P-DATE-IN.
           PERFORM C-CALL-JUL.
           MOVE P-JULIAN-DATE TO WS-JUL-WK.
           ADD WS-UP-WORK TO WS-JUL-WK.

           MOVE WS-JUL-WK       TO P-CJUL-JULIAN-DATE.
           PERFORM C-CALL-CJUL.
           MOVE P-CJUL-DATE-OUT TO NUM-DATE NDTE-DATE.

           MOVE NDTE-CCYY TO WS-NDTE-CCYY-S.
           MOVE NDTE-MM TO WS-NDTE-MM-S.
           MOVE NDTE-DD TO WS-NDTE-DD-S.

           MOVE SV-NUM-DATE TO NUM-DATE.
           MOVE SV-SYS-DATE TO SYS-DATE.

      *********************************************************
      *          INCREMENT DATES BY UNITS OF 1/2 MONTHS
      *          USES C-INCR-MONTHS BASE ROUTINE FOR IT
      *********************************************************
       C-INCR-HALF-MONTHS SECTION.
           MOVE WS-NDTE-DD-S TO WS-HOLD-DD.
           DIVIDE WS-UP-WORK BY 2 GIVING    WS-DIV-RESULT
                                  REMAINDER WS-MOD-2.
           MOVE WS-DIV-RESULT TO WS-UP-WORK.
           IF WS-UP-WORK NOT = 0
              PERFORM C-INCR-MONTHS.

           IF WS-MOD-2 > 0
              IF WS-NDTE-DD-S > 15
                 COMPUTE WS-NDTE-DD-S = WS-HOLD-DD - 15
                 MOVE 1 TO WS-UP-WORK
                 PERFORM C-INCR-MONTHS
              ELSE
                 ADD 15 TO WS-NDTE-DD-S
              END-IF
           ELSE
              IF WS-MOD-2 < 0
                 IF WS-NDTE-DD-S < 16
                    ADD 15 TO WS-NDTE-DD-S
                    MOVE -1 TO WS-UP-WORK
                    PERFORM C-INCR-MONTHS
                 ELSE
                    COMPUTE WS-NDTE-DD-S = WS-HOLD-DD - 15.

      *********************************************************
      *          INCREMENT MONTH ROUTINE
      *
      *          INCREMENTS A DATE BY THE NO.
      *          OF MONTHS FOUND IN INCREMENT.
      *          THE CORRECT LAST DAY OF MONTH IS ADJUSTED.
      *********************************************************
       C-INCR-MONTHS SECTION.

      * CHECK TO SEE HOW MANY YEARS & MONTHS TO ADVANCE

           DIVIDE WS-UP-WORK BY 12 GIVING    WS-DIV-RESULT
                                   REMAINDER WS-MOD-12.
           ADD WS-MOD-12     TO WS-NDTE-MM-S.
           ADD WS-DIV-RESULT TO WS-NDTE-CCYY-S.
           IF WS-NDTE-MM-S < 1
              ADD 12 TO WS-NDTE-MM-S
              ADD -1 TO WS-NDTE-CCYY-S
           ELSE
             IF WS-NDTE-MM-S > 12
                ADD -12 TO WS-NDTE-MM-S
                ADD 1 TO WS-NDTE-CCYY-S.

      * THIS PART WAS IGNORED FROM THE ORIGINAL C CODE NOT TO CHANGE
      * THE YEAR WHEN IT IS LESS THAN 50
      * CHANGED FOR 4 DIGIT YEAR AND CHANGED BACK TO 50
      *   ELSE IT DOES NOT MATCH A15 DON'T KNOW WHY EDWIN LEFT THIS OUT
      *    IF WS-NDTE-YY-S < 50
      *       MOVE 50 TO WS-NDTE-YY-S
      *    END-IF

      * COMMENTING OUT NOW THAT WE ARE USING FULL 8 DIGIT YEARS
      *     IF WS-NDTE-YY-S < 1950
      *        MOVE 50 TO WS-NDTE-YY-S
      *     END-IF

      * THIS PART WAS CHANGED FROM THE ORIGINAL C CODE TO LIMIT
      * THE YEAR RESULT TO 99 INSTEAD OF 149 BECAUSE THE OUTPUT
      * DATE FORMAT HAS 2 DIGITS ONLY
      * CHANGED FOR 4 DIGIT YEAR AND CHANGED BACK TO 49
      *   ELSE IT DOES NOT MATCH A15 NOT SURE WHY EDWIN CHANGED THIS
      *MJD IF WS-NDTE-YY-S > 99

      * COMMENTING OUT NOW THAT WE ARE USING FULL 8 DIGIT YEARS
      *    IF WS-NDTE-YY-S > 2049
      *       MOVE 49 TO WS-NDTE-YY-S
      *    END-IF

      * NOW CALL NEW-DATE
           IF WS-NDTE-DD-S > 99
              MOVE 99 TO NDTE-DD
           ELSE
              MOVE WS-NDTE-DD-S TO NDTE-DD.

           MOVE WS-NDTE-CCYY-S TO NDTE-CCYY.
           MOVE WS-NDTE-MM-S   TO NDTE-MM.
           MOVE "N" TO DATER-ACTION-CODE.
           PERFORM C-CALL-NEWDATE.
           MOVE NDTE-CCYY TO WS-NDTE-CCYY-S.
           MOVE NDTE-MM TO WS-NDTE-MM-S.
           MOVE NDTE-DD TO WS-NDTE-DD-S.

      **********************************************
      *  RETURN NUMBER OF DAY OF THE WEEK FOR A DATE
      *     1 - SUNDAY, 2 - MONDAY, 3 - TUESDAY, ETC.
      **********************************************
       C-WEEKDAY SECTION.
           MOVE NUM-DATE TO P-DATE-IN.
           PERFORM C-CALL-JUL.
           MOVE P-JULIAN-DATE TO WS-JUL-WK.
           COMPUTE WS-JUL = WS-JUL-WK   + 1.
           DIVIDE WS-JUL BY 7 GIVING WS-DIV-RESULT
                              REMAINDER WS-MOD-7.
           COMPUTE DAY--OF-WEEK = WS-MOD-7 + 1.

      **********************************************
      *  COMPARES TWO DATES
      *  DESC COMPARES SYS-DATE TO NUM-DATE
      *  MJD 130514 DO NOT CALL JUL IF DATES ARE ZERO
      *  MJD 140124 ADDED LOGIC TO ALTER ELAPSED RESULTS WHEN ZERO DATES
      *             ARE USED TO MATCH RESULTS GENERATEDIN A15.
      *         IN A15:
      *            IF SYS-DATE = 0
      *              IF NUM-YR < 50 THEN ELAPSED-RESULTS = "L"  FOR ALL MM/DD
      *              IF NUM-YR >= 50 THAN ELAPSED RESULTS = "G" FOR ALL MM/DD
      *              IF NUM-DATE = 123199 THEN ELAPSED RESULTS = "E"
      *
      *            IF NUM-DATE = 0
      *              IF SYS-YY < 50 THEN ELAPSED-RESULTS = "G" FOR ALL MM/DD
      *              IF SYS-YY >= 50 THAN ELAPSED RESULTS = "L" FOR ALL MM/DD
      *              IF SYS-DATE = 123199 THEN ELAPSED RESULTS = "E"
      * MJD 151110 FIXED FOR CCYY NO LONGER NEED SWING DATE TEST.
      **********************************************
       C-DATE-COMPARE SECTION.
      * NEW LOGIC ADDED 2017/02/02
            IF SYS-DATE = NUM-DATE
               MOVE "E" TO ELAPSED-RESULTS
            ELSE
            IF SYS-DATE > NUM-DATE
               MOVE "G" TO ELAPSED-RESULTS
            ELSE
               MOVE "L" TO ELAPSED-RESULTS.

      * OLD LOGIC COMMENTED OUT 2017/02/02
      * ===================================
      *     IF NUM-DATE = 0
      *        MOVE 0 TO WS-JUL-1
      *     ELSE
      *        MOVE NUM-DATE TO P-DATE-IN
      *        PERFORM C-CALL-JUL
      *        MOVE P-JULIAN-DATE TO WS-JUL-1
      *     END-IF.

      *     IF SYS-DATE = 0
      *        MOVE 0 TO WS-JUL-2
      *     ELSE
      *        MOVE SYS-DATE TO P-DATE-IN
      *        PERFORM C-CALL-JUL
      *        MOVE P-JULIAN-DATE TO WS-JUL-2
      *     END-IF.

      *     IF (NUM-DATE = 0 AND SYS-DATE = 0)
      **  NOTE SURE ABOUT THIS 123199 TEST.  LOOKS LIKE IT WAS ADDED TO 
      ** FIX A BUG WITH JULIAN WHERE 0 PASSED BACK SAME # AS 123199.
      **       (NUM-DATE = 0 AND SYS-DATE = 123199) OR
      **       (SYS-DATE = 0 AND NUM-DATE = 123199)
      *           MOVE "E" TO ELAPSED-RESULTS
      *     ELSE
      **       IF NUM-DATE = 0 AND S-YY < 50
      **          MOVE "G" TO ELAPSED-RESULTS
      **    ELSE
      **       IF NUM-DATE = 0 AND S-YY >= 50
      **          MOVE "L" TO ELAPSED-RESULTS
      **    ELSE
      **       IF SYS-DATE = 0 AND NUM-YR < 50
      **          MOVE "L" TO ELAPSED-RESULTS
      **    ELSE
      **       IF SYS-DATE = 0 AND NUM-YR >= 50
      **          MOVE "G" TO ELAPSED-RESULTS
      **    ELSE
      *        PERFORM C-TIM-RESULTS
      *        MOVE WS-TIM-RESULTS TO ELAPSED-RESULTS.
      * ===================================

      ***********************************************************
      *         DETERMINE THE RESULTS OF A DATE COMPARE
      *
      *   NAME: TIM_RESULTS
      *   DESC: DETERMINE IF DATE2 IS <, >, OR = TO DATE1
      *
      *   IN  : WS-JUL-1 AND WS-JUL-2
      *   OUT : WS-TIM-RESULTS
      ***********************************************************
       C-TIM-RESULTS SECTION.
           MOVE "L" TO WS-TIM-RESULTS.
           IF WS-JUL-2 > WS-JUL-1
              MOVE "G" TO WS-TIM-RESULTS
           ELSE
           IF WS-JUL-2 = WS-JUL-1
              MOVE "E" TO WS-TIM-RESULTS.

      ***********************************************************
      *   NAME: C-DATE-TEST
      *   DESC: IF A DATE IS VALID, RETURNS THE SAME
      *         DATE WHEN VALID, OR 0 WHEN NOT VALID
      *   IN  : NUM-DATE (CCYYMMDD)
      *   OUT : NUM-DATE (CCYYMMDD)
      *
      * MJD 141015 MADE SECTION
      ***********************************************************
       C-DATE-TEST SECTION.
           MOVE NUM-DATE TO WS-NDTE.
           IF (NOT WS-NDTE-MM-VALID) OR (NOT WS-NDTE-DD-VALID)
              MOVE 0 TO NUM-DATE
           ELSE
              MOVE NUM-DATE TO P-DATE-IN
              PERFORM C-CALL-JUL
              MOVE P-JULIAN-DATE TO WS-JUL-WK

              MOVE 0 TO NUM-DATE

              MOVE WS-JUL-WK       TO P-CJUL-JULIAN-DATE
              PERFORM C-CALL-CJUL
              MOVE P-CJUL-DATE-OUT TO NUM-DATE

              IF WS-NDTE NOT = NUM-DATE
                 MOVE 0 TO NUM-DATE
                 ELSE
                 MOVE WS-NDTE TO NUM-DATE
              END-IF
           END-IF.

      *********************************************************************
      *  NAME: C-CALL-JUL
      *  DESC: CONVERT GREGORIAN CALANDER DATE TO A JULIAN DATE
      *  IN  : DATE IN CCYYMMDD FORMAT
      *  OUT : JULIAN DATE FOR NUMBER OF DAYS SINCE 12/31/1899
      *********************************************************************
       C-CALL-JUL SECTION.
           MOVE P-DATE-IN TO JJUL-IN.
           COMPUTE JWS-JUL-IN-CCYY = JJUL-IN-CCYY - 1900.

           MOVE JJUL-IN-CCYY TO LEAP-YEAR-CCYY.
           PERFORM C-LEAP-YEAR-TEST.

           IF JJUL-IN-MM > 2 AND LEAP-YEAR-TRUE
              MOVE 1 TO JWS-EXTRA-DAY
           ELSE
              MOVE 0 TO JWS-EXTRA-DAY.

           COMPUTE P-JULIAN-DATE = ( (JWS-JUL-IN-CCYY - 1) * 1461 / 4 )
                                + DYTOM(JJUL-IN-MM) + JJUL-IN-DD +
                                JWS-EXTRA-DAY.

      *********************************************************************
      *  NAME: C-CALL-CJUL
      *  DESC: CONVERT JULIAN DATE TO A GREGORIAN CALANDER DATE
      *  IN  : JULIAN DATE FOR NUMBER OF DAYS SINCE 12/31/1899
      *  OUT : DATE IN CCYYMMDD FORMAT
      *********************************************************************
       C-CALL-CJUL SECTION.
           MOVE P-CJUL-JULIAN-DATE TO CJUL-IN.
           COMPUTE CJWS-JUL-BY4 = CJUL-IN * 4.
           DIVIDE CJWS-JUL-BY4 BY 1461 GIVING    CJWS-DIV-RESULT
                                     REMAINDER CJWS-MOD-JUL.
           IF CJWS-MOD-JUL NOT = 0
              MOVE 1 TO CJWS-MOD-JUL.

           COMPUTE WS-CJUL-OUT-CCYY = (CJUL-IN * 4 / 1461) +
                                                          CJWS-MOD-JUL.
           COMPUTE WS-CJUL-OUT-DD ROUNDED = CJUL-IN -
                                  ( (WS-CJUL-OUT-CCYY - 1) * 1461 / 4 ).
           IF WS-CJUL-OUT-DD <
              ( CJUL-IN - ( (WS-CJUL-OUT-CCYY - 1) * 1461 / 4 ) )
              ADD 1 TO WS-CJUL-OUT-DD.

           DIVIDE WS-CJUL-OUT-CCYY BY 4 GIVING    CJWS-DIV-RESULT
                                      REMAINDER CJWS-MOD-JUL.
           IF CJWS-MOD-JUL NOT > 0 AND WS-CJUL-OUT-DD NOT < 60
              MOVE 1 TO CJWS-WORK
           ELSE
              MOVE 0 TO CJWS-WORK.

           COMPUTE WS-CJUL-OUT-DD = WS-CJUL-OUT-DD - CJWS-WORK.
           MOVE 13 TO CJWS-MM.
           PERFORM UNTIL (DYTOM(CJWS-MM) < WS-CJUL-OUT-DD)
                                            OR (CJWS-MM = 1)
              ADD -1 TO CJWS-MM
           END-PERFORM.

           IF WS-CJUL-OUT-DD = 59
              ADD CJWS-WORK TO WS-CJUL-OUT-DD.

           SUBTRACT DYTOM(CJWS-MM) FROM WS-CJUL-OUT-DD.
           MOVE CJWS-MM TO WS-CJUL-OUT-MM.
           ADD 1900     TO WS-CJUL-OUT-CCYY.
           MOVE WS-CJUL-OUT-MM TO CJUL-OUT-MM.
           MOVE WS-CJUL-OUT-DD TO CJUL-OUT-DD.
           MOVE WS-CJUL-OUT-YY TO CJUL-OUT-YY.
           MOVE WS-CJUL-OUT-CC TO CJUL-OUT-CC.
           MOVE CJUL-OUT TO P-CJUL-DATE-OUT.

      *********************************************************************
      *  NAME: C-CALL-NEWDATE
      *  DESC: THIS ROUTINE RETURNS A VALID DATE,
      *        THE DAY IS ADJUSTED BACK TO THE LAST VALID
      *        DAY OF THAT MONTH.
      *   IN  : NDTE-DATE-WORK (CCYYMMDD)
      *   OUT : NDTE-DATE (CCYYMMDD)
      *
      * MJD UPDATED FOR 4 DIGIT YEAR.
      *********************************************************************
       C-CALL-NEWDATE SECTION.
           MOVE NDTE-DATE-WORK TO ND-WS-NDTE.
           MOVE ND-WS-NDTE-CCYY TO LEAP-YEAR-CCYY.
           PERFORM C-LEAP-YEAR-TEST.
           IF (ND-WS-NDTE-MM > 0 AND ND-WS-NDTE-MM < 13) AND
              (ND-WS-NDTE-DD >
                   ( DYTOM(ND-WS-NDTE-MM + 1) - DYTOM(ND-WS-NDTE-MM) ) )
              IF ND-WS-NDTE-MM NOT = 2
                 COMPUTE ND-WS-NDTE-DD = DYTOM(ND-WS-NDTE-MM + 1)
                                     - DYTOM(ND-WS-NDTE-MM)
              ELSE
                 IF LEAP-YEAR-TRUE
                    MOVE 29 TO ND-WS-NDTE-DD
                 ELSE
                    MOVE 28 TO ND-WS-NDTE-DD
                 END-IF
              END-IF
           END-IF.
           MOVE ND-WS-NDTE TO NDTE-DATE.

      * COMMENTED OUT MJD 2017/02/07
      * IT WAS ALREADY COMMENTED OUT EVERYWHERE IT WAS CALLED.
      * IT IS NOT NBEEDED WHEN USING 8 DIGIT YEAR IN CCYYMMDD FORMAT.
      * C-SET-WS-DATE-YYYY SECTION.
      *     IF WS-DATE1-YY NOT < EXT-JULIAN-CC
      *        ADD 1900 WS-DATE1-YY GIVING WS-DATE1-YYYY
      *     ELSE
      *        ADD 2000 WS-DATE1-YY GIVING WS-DATE1-YYYY.

      *     IF WS-DATE2-YY NOT < EXT-JULIAN-CC
      *        ADD 1900 WS-DATE2-YY GIVING WS-DATE2-YYYY
      *     ELSE
      *        ADD 2000 WS-DATE2-YY GIVING WS-DATE2-YYYY.

      * NOT NEEDED W/ 8 DIGIT YEAR
      *C-ADJ-WS-NDTE-YY-S SECTION.
      *    IF WS-NDTE-YY-S NOT < EXT-JULIAN-CC
      *       ADD 1900 TO  WS-NDTE-YY-S
      *    ELSE
      *       ADD 2000 TO WS-NDTE-YY-S.

      ***************************************************************
      * NAME: C-LEAP-YEAR-TEST
      * DESC: TEST A GIVEN YEAR YEAR TO DETERMINE IF IT A LEAP YEAR
      * IN  : LEAP-YEAR-CCYY
      * OUT : LEAP-YEAR-TRUE / LEAP-YEAR-FALSE
      *
      *
      * TO DETERMINE WHETHER A YEAR IS A LEAP YEAR, FOLLOW THESE STEPS:
      * 1. IF THE YEAR IS EVENLY DIVISIBLE BY 4, GO TO STEP 2.
      *           OTHERWISE, GO TO STEP 5.
      * 2. IF THE YEAR IS EVENLY DIVISIBLE BY 100, GO TO STEP 3.
      *           OTHERWISE, GO TO STEP 4.
      * 3. IF THE YEAR IS EVENLY DIVISIBLE BY 400, GO TO STEP 4.
      *           OTHERWISE, GO TO STEP 5.
      * 4. THE YEAR IS A LEAP YEAR (IT HAS 366 DAYS).
      * 5. THE YEAR IS NOT A LEAP YEAR (IT HAS 365 DAYS).
      ***************************************************************
       C-LEAP-YEAR-TEST SECTION.
           MOVE "F" TO LEAP-YEAR-FG.
           DIVIDE LEAP-YEAR-CCYY BY 4
                  GIVING ND-WS-DIV-RESULT REMAINDER ND-WS-MOD-4.
           IF ND-WS-MOD-4 NOT = 0
              MOVE "F" TO LEAP-YEAR-FG
           ELSE
              DIVIDE LEAP-YEAR-CCYY BY 100
                     GIVING ND-WS-DIV-RESULT REMAINDER ND-WS-MOD-4
              IF ND-WS-MOD-4 NOT = 0
                     MOVE "T" TO LEAP-YEAR-FG
              ELSE
                 DIVIDE LEAP-YEAR-CCYY BY 400
                     GIVING ND-WS-DIV-RESULT REMAINDER ND-WS-MOD-4
                 IF ND-WS-MOD-4 NOT = 0
                        MOVE "F" TO LEAP-YEAR-FG
                 ELSE
                        MOVE "T" TO LEAP-YEAR-FG
                 END-IF
              END-IF
           END-IF.

      ***************************************************************
      * NAME: CONVERT-00MMDDYY-TO-CCYYMMDD
      * DESC: CONVERT A DATE IN THE FORMATE OF 00MMDDYY TO CCYYMMDD
      * IN  : CONVERT-DATE (00MMDDYY WHERE CONVERT-DATE NOT = 0)
      * OUT : CONVERT-DATE (CCYYMMDD)
      ***************************************************************
       CONVERT-00MMDDYY-TO-CCYYMMDD SECTION.
           IF CONVERT-DATE-CC = 00 AND CONVERT-DATE NOT = 0
              MOVE CONVERT-DATE-DD TO CONVERT-DATE-CC
              MOVE CONVERT-DATE-MM TO CONVERT-DATE-DD
              MOVE CONVERT-DATE-YY TO CONVERT-DATE-MM
              MOVE CONVERT-DATE-CC TO CONVERT-DATE-YY
              IF CONVERT-DATE-YY < EXT-JULIAN-CC
                 MOVE 20 TO CONVERT-DATE-CC
              ELSE
                 MOVE 19 TO CONVERT-DATE-CC
              END-IF
           END-IF.

      ***************************************************************
      * NAME: CONVERT-CCYYMMDD-TO-00MMDDYY
      * DESC: CONVERT A DATE IN THE FORMATE OF CCYYMMDD TO 00MMDDYY
      * IN  : CONVERT-DATE (CCYYMMDD)
      * OUT : CONVERT-DATE (00MMDDYY)
      ***************************************************************
       CONVERT-CCYYMMDD-TO-00MMDDYY SECTION.
           MOVE CONVERT-DATE-YY TO CONVERT-DATE-CC.
           MOVE CONVERT-DATE-MM TO CONVERT-DATE-YY.
           MOVE CONVERT-DATE-DD TO CONVERT-DATE-MM.
           MOVE CONVERT-DATE-CC TO CONVERT-DATE-DD.
           MOVE 00              TO CONVERT-DATE-CC.
     

      ***************************************************************
      * NAME: CONVERT-SYS-NUM-NDTE-DATES-IN
      * DESC: CONVERT SYS/NUM/NDTE-DATE DATE FROM 00MMDDYY TO CCYYMMDD
      *       USED STRICTLY FOR TESTING WHILE INCEMENTALLY CHANING DATE
      *       FIELDS AND FORMATS.
      *       ALLOWS INTERNAL USAGE OF CCYYMMDD WHILE EXTERNAL FORMAT
      *       CAN BE CCYYMMDD OR 00MMDDYY
      * IN  : SYS-DATE (00MMDDYY)
      *       NUM-DATE (00MMDDYY)
      *       NDTE-DATE (00MMDDYY)
      * OUT : SYS-DATE (CCYYMMDD)
      *       NUM-DATE (CCYYMMDD)
      *       NDTE-DATE (CCYYMMDD)
      ***************************************************************
       CONVERT-SYS-NUM-NDTE-DATES-IN SECTION.
           MOVE "N" TO SYS-FG NUM-FG NDTE-FG.
           IF S-CC = 0 AND SYS-DATE NOT = 0
              MOVE SYS-DATE TO CONVERT-DATE
              PERFORM CONVERT-00MMDDYY-TO-CCYYMMDD
              MOVE CONVERT-DATE TO SYS-DATE
              MOVE "Y" TO SYS-FG.

           IF NUM-CC = 0 AND NUM-DATE NOT = 0
              MOVE NUM-DATE TO CONVERT-DATE
              PERFORM CONVERT-00MMDDYY-TO-CCYYMMDD
              MOVE CONVERT-DATE TO NUM-DATE
              MOVE "Y" TO NUM-FG.

           IF NDTE-CC = 0 AND NDTE-DATE NOT = 0
              MOVE NDTE-DATE TO CONVERT-DATE
              PERFORM CONVERT-00MMDDYY-TO-CCYYMMDD
              MOVE CONVERT-DATE TO NDTE-DATE
              MOVE "Y" TO NDTE-FG.

      ***************************************************************
      * NAME: CONVERT-SYS-NUM-NDTE-DATES-OUT
      * DESC: CONVERT SYS/NUM/NDTE-DATE DATE FROM 00MMDDYY TO CCYYMMDD
      *       USED STRICTLY FOR TESTING WHILE INCEMENTALLY CHANING DATE
      *       FIELDS AND FORMATS.
      *       ALLOWS INTERNAL USAGE OF CCYYMMDD WHILE EXTERNAL FORMAT
      *       CAN BE CCYYMMDD OR 00MMDDYY
      * IN  : SYS-DATE (CCYYMMDD)
      *       NUM-DATE (CCYYMMDD)
      *       NDTE-DATE (CCYYMMDD)
      * OUT : SYS-DATE (00MMDDYY)
      *       NUM-DATE (00MMDDYY)
      *       NDTE-DATE (00MMDDYY)
      ***************************************************************
       CONVERT-SYS-NUM-NDTE-DATES-OUT SECTION.
           IF SYS-FG = "Y"
              MOVE SYS-DATE TO CONVERT-DATE
              PERFORM CONVERT-CCYYMMDD-TO-00MMDDYY
              MOVE CONVERT-DATE TO SYS-DATE.

           IF NUM-FG = "Y"
              MOVE NUM-DATE TO CONVERT-DATE
              PERFORM CONVERT-CCYYMMDD-TO-00MMDDYY
              MOVE CONVERT-DATE TO NUM-DATE.

           IF NDTE-FG = "Y"
              MOVE NDTE-DATE TO CONVERT-DATE
              PERFORM CONVERT-CCYYMMDD-TO-00MMDDYY
              MOVE CONVERT-DATE TO NDTE-DATE.
      *================================================================*
      * END COPYBOOK: LIBGB\DATER.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\DEFPOL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/DEFPOL
      ******************************************************************
      *          DEFERMENT POLICY VIOLATION TEST
      *
      *    NAME: DEFPOL
      *    DESC: THIS ROUTINE TEST FOR DEFERMENT POLICY VIOLATIONS
      *
      *    IN  : DEFPOL-TRCD        TRANS CODE, EX. 'DF', 'D2'
      *          DEFPOL-DATE        DATE OF DEFERMENT TEST
      *
      *    OUT : DEFPOL-MAXIMUM     ' '  - DEFERMENT WITHIN POLICY
      *                             'Y'  - DEFERMENT AGAINST POLICY
      *                             'X'  - DEFERMENT EXCEEDS LOAN TERM
      *                             '1'  - DEFERMENT WITHIN 1ST XMONTHS
      *                             'D'  - DEFERMENT MONTHS BETWEEN
      *                             '2'  - DEFERMENT D2-D9 MONTHS BETWEEN
      *                             'R'  - LR DOES NOT EXIST
      *    COPY: DEFPOLW
      *  REV:
      * JTG 111197 ADDED BR-NODEF-1ST-X-MONTHS OPTION MERCURY
      * MJD 991220 ADDED SP-DEFPOLCD = "B" (WORLD PR#216)
      * BAH 070201 ADDED BR-MIN-MONTHS-DEF FOR REGACC PR# 162
      * BAH 070503 CHANGED 365 TO 360 FOR ABOVE REGACC TEST, PL# 588
      *  CS 070808 ADDED TEST IF BR-MIN-MONTHS-DEF NOT NUMERIC, SKIP READING
      *            FOR THE LR. MULLEN
      *  CS 080408 ADDED TESTS FOR BR-MIN-MONTHS-D2, IF A MULTIPLE(D2-D9)
      *            IS POSTED, MUST WAIT BR-MIN-MONTHS-D2 TO POST ANOTHER
      *            DF TRANSACTION REGACC PR#202
      *  CS 080408 REGACC WANTS THE FLAG BR-NODEF-1ST-X-MONTHS TO BE
      *            PAYS PAID RATHER THAN ELAPSED TIME REGACC PR#202
      *  CS 120806 ADDED DEFPOL-MAXIMUM "1","2","D"  REGACC PR#3189
      *            "1", ATTEMPTING DF IN VIOLATION OF 1ST XMONTHS
      *            "D", MONTHS BETWEEN 'DF' & CURRENT DEFERMENT/S VIOLATION
      *            "2", MONTHS BETWEEN 'D2' AND CURRENT DEFERMENT/S VIOLATION
      *            "D" AND "2" COME FROM THE 'LR', IF NO 'LR' SETS 'R'
      * BAH 131017 ADDED SP-DEFPOLCD "C" FOR HONOR, PR# 4382
      * BAH 151021 REMOVE B2FILE, PD0003
      * BAH 20190709 REMOVED GP-LR-TRAILER-TRIAD, PT0151 
      * BAH 20220803 HARD CODED START
      ******************************************************************
       VALIDATE-DF-POLICY  SECTION.

           MOVE " " TO DEFPOL-MAXIMUM.
           MOVE DEFPOL-TRCD TO DEFPOL-WORKER.
           IF DEFPOL-FTST = "F"
              MOVE "1" TO DEFPOL-FTST.


      *    IF GP-I-AM-REGACC
      *       IF BR-NODEF-1ST-X-MONTHS NOT = 0
      *          MOVE LN-1STPYDATE TO PDTH-DATE-WORK
      *          PERFORM PAID-THRU-CALCULATION
      *          MOVE LN-1STPYDATE TO NDTE-DATE
      *          MOVE -1 TO NDTE-HOLD
      *          PERFORM INCREMENT-MONTHS
      *          MOVE NDTE-DATE      TO NUM-DATE
      *          MOVE PDTH-DATE-FULL TO SYS-DATE
      *          PERFORM TIM360
      *          IF ELAPSED-MONTHS <  BR-NODEF-1ST-X-MONTHS
      *             MOVE "1" TO DEFPOL-MAXIMUM
      *             GO TO VALIDATE-DF-POLICY-EXIT.

           IF BR-NODEF-1ST-X-MONTHS NUMERIC
              IF BR-NODEF-1ST-X-MONTHS NOT = 0
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE DEFPOL-DATE TO SYS-DATE
                 PERFORM TIM360
                 IF ELAPSED-DAYS <= (BR-NODEF-1ST-X-MONTHS * 30)
                    MOVE "Y" TO DEFPOL-MAXIMUM.

      *    IF GP-I-AM-REGACC
      *       IF DEFPOL-MAXIMUM NOT = SPACES
      *          GO TO VALIDATE-DF-POLICY-EXIT.

           IF SP-DEFPOLCD = " " OR "C"
              IF (LN-YTDNODEF + DEFPOL-NODF) > SP-DEFPOLMX(1)
                     OR (LN-TOTNODEF + DEFPOL-NODF) > SP-DEFPOLMX(2)
                 MOVE "Y" TO DEFPOL-MAXIMUM.

           IF SP-DEFPOLCD = "A"
              IF LN-SUM-ORGTERM NOT > SP-DEFPOLMX(3)
                 IF (LN-TOTNODEF + DEFPOL-NODF) > SP-DEFPOLMX(1)
                    MOVE "Y" TO DEFPOL-MAXIMUM
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF (LN-TOTNODEF + DEFPOL-NODF) > SP-DEFPOLMX(2)
                    MOVE "Y" TO DEFPOL-MAXIMUM.

           IF SP-DEFPOLCD = "B"
              IF ((LN-YTDNODEFACT + 1) > SP-DEFPOLMX(1)) OR
                 ((LN-TOTNODEFACT + 1) > SP-DEFPOLMX(2))
                    MOVE "Y" TO DEFPOL-MAXIMUM.

           IF (LN-TOTNODEF + DEFPOL-NODF) > LN-SUM-ORGTERM
              MOVE "X" TO DEFPOL-MAXIMUM.

      * CHECK MINIMUM MONTHS BETWEEN DEFERMENTS FINDING LAST TRUE DEFERMENT
      * BY READING LP
           IF SP-DEFPOLCD = "C"
              PERFORM DEFPOL-MINIMUM-MONTHS-BETWEEN.

       VALIDATE-DF-POLICY-EXIT.
           EXIT.


      ***********************************
      * HONOR PR# 4382  SP-DEFPOLCD "C"
      * THIS ROUTINE CAN BE USED BY ANYONE.
      ***********************************
       DEFPOL-MINIMUM-MONTHS-BETWEEN SECTION.
      ***********************************

      * SAVE EXISTING LP-REC
           MOVE LP-REC TO DEFPOL-LP-REC.

           IF BR-MIN-MONTHS-DEF NOT NUMERIC OR
                   BR-MIN-MONTHS-DEF = 0 OR 99
              GO TO DEFPOL-MINIMUM-MONTHS-BETWEEN-EXIT.

           PERFORM OPEN-LP1-FILE.

           MOVE LP-PATH-OWNBR TO LP-BRNO
                                 QLP1-WBEG-BRNO
                                 QLP1-WEND-BRNO.
           MOVE LN-ACCTNO     TO LP-ACCTNO
                                 QLP1-WBEG-ACCTNO
                                 QLP1-WEND-ACCTNO.
           MOVE 99999         TO LP-SEQNO
                                 QLP1-WEND-SEQNO.
           MOVE ALL "0"       TO QLP1-WBEG-SEQNO.

           PERFORM START-LP1-FILE-NOT-GREATER.
       DEFPOL-MINIMUM-MONTHS-NEXT.
           PERFORM READ-LP1-FILE-PREVIOUS.
           IF IO-FG NOT = 0
              GO TO DEFPOL-MINIMUM-MONTHS-BETWEEN-EXIT.

           IF (LP-BRNO NOT = LN-OWNBR) OR (LP-ACCTNO NOT = LN-ACCTNO)
              GO TO DEFPOL-MINIMUM-MONTHS-BETWEEN-EXIT.

           IF LP-TRCD = "RV" OR LP-REV = "Y"
              GO TO DEFPOL-MINIMUM-MONTHS-NEXT.
           IF NOT (LP-TRCD = "DF" OR "D2" OR "D3" OR "D4" OR "D5" OR
                        "D6" OR "D7" OR "D8" OR "D9")
              GO TO DEFPOL-MINIMUM-MONTHS-NEXT.

      * FOUND LAST DEFERMENT, CHECK IF WITHIN MINIMUM MONTHS
           MOVE LP-TRDATE TO NUM-DATE.
      * DEFPOL-DATE = TRANS-DATE
           MOVE DEFPOL-DATE TO SYS-DATE.
           PERFORM TIM360.

           IF ELAPSED-MONTHS < BR-MIN-MONTHS-DEF
              MOVE "D" TO DEFPOL-MAXIMUM
              GO TO DEFPOL-MINIMUM-MONTHS-BETWEEN-EXIT.

       DEFPOL-MINIMUM-MONTHS-BETWEEN-EXIT.
      * RESTORE EXISTING LP-REC
           MOVE DEFPOL-LP-REC TO LP-REC.
      *================================================================*
      * END COPYBOOK: LIBLP\DEFPOL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\SETCTBL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/SETCTBL

      **************************************************************************
      *          SET INDEX INTO SPR RATE TABLES
      *
      *   NAME:  SETCTBL
      *   DESC:  THIS ROUTINE WILL DETERMINE THE INDEX (1 OR 2)
      *          INTO THE SP-CAL-TABLE
      *
      *   IN  :  CTBL-INT-CHARGEABLE
      *          CTBL-TERM
      *
      *   OUT :  CTBL-INDEX              INDEX
      *   COPY:  SETCTBLW
      * REV:
      *  JTG 100598 MADE NOTE THAT THIS WORKS FOR SP-CAL-BREAK-ON-FLATAMT
      *  JTG 000626 ADDED LOGIC FOR TENNESSEE RATE TYPE 'M' FLAT MONTHLY CHARGE
      *             #1225
      *  BAH 090601 ADDED IF SP-CAL-NORATES(1) = 0, DONT SET THE INDEX, GO
      *             TO EXIT, CAUSING DROP TO $ SIGN ON BAD SPR'S, REGMGM
      *  BAH 090612 CHANGED THE SET CSTP TO SP-CAL-NORATES(1) TO USE A WORKER
      *             INBETWEEN, IT DIDNT LIKE THE S9 COMP FIELD, FOUND THIS
      *             WHILE TESTING REGRDN
      **************************************************************************
       SETCTBL SECTION.
           SET CTBL-INDEX TO 1.

           IF SP-CAL-NORATES(1) = 0
              GO TO SETCTBL-EXIT.

           IF NOT SP-CAL-FLAT-MONTHLY(1)
              MOVE SP-CAL-NORATES(1) TO CTBL-WORKER
              SET CSTP TO CTBL-WORKER
      *      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *      TERM BREAK TEST:
      *      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
              IF SP-CAL-BREAK-ON-TERM(1)
                 IF SP-CAL-BREAK(1 CSTP) NOT = 0
                             AND CTBL-TERM > SP-CAL-BREAK(1 CSTP)
                    SET CTBL-INDEX TO 2
                 END-IF
              ELSE
      *      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *         AMOUNT AND FLAT AMOUNT BREAK TEST:
      *      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
                 IF SP-CAL-BREAK(1 CSTP) NOT = 0
                       AND CTBL-INT-CHARGEABLE > SP-CAL-BREAK(1 CSTP)
                    SET CTBL-INDEX TO 2.

       SETCTBL-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\SETCTBL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPIBPC.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPIBPC
      **************************************************************
      *         INTEREST BEARING OR PRECOMPUTE
      *               ACCOUNT STATUS TEST
      *
      *   NAME: LPIBPC
      *   DESC: THIS ROUTINE DETERMINES IF THE ACCOUNT
      *         SHOULD BE PROCESSED AS INTEREST BEARING
      *         OR PRECOMPUTE, BASED ON THE ACCOUNT'S
      *         CURRENT STATUS AND PAYMENT DATE.
      *
      *   IN : IBPC-DATE   (DATE OF PAYMENT)
      *   OUT: IBPC-FG     "I" - INTEREST BEARING
      *                    "P" - PRECOMPUTE
      *
      *        IBPC-STAT   CONTAINS "E" IF THE LOAN EXPIRED BEFORE
      *        IBPC-STAT-2 GOING INTO JUDGEMENT OR ACCELERATION OR
      *                    RATE CHANGE/REDUCTION OR IF LN-STATUSFG = " ".
      *                    IBPC-STAT-2 CONTAINS LN-STATUSFG.
      *
      *           OR
      *
      *        IBPC-STAT   IF THE LOAN EXPIRED AFTER THE EVENT IN
      *        IBPC-STAT-2 LN-STATUSFG, THE VALUE IN IBPC-STAT WILL BE
      *                    LN-STATUSFG AND IBPC-STAT-2 WILL CONTAIN "E".
      *
      *           OR
      *
      *        IBPC-STAT   IF THE LOAN WILL EXPIRE AFTER THE EVENT IN
      *        IBPC-STAT-2 LN-STATUSFG, THE VALUE IN IBPC-STAT WILL BE
      *                    LN-STATUSFG AND IBPC-STAT-2 WILL CONTAIN " ".
      *
      *
      *        IBPC-EXPIRED-FLAG
      *                    CONTAINS "E" IF TODAY IS PAST EXPIRATION
      *                    AND THE LAST PAYMENT OCCURRED BEFORE
      *                    EXPERATION.
      *                    IF PREVIOUSLY IBPC = "I":
      *                      AN "E" WOULD IMPLY THE PAYMENT MAY REQUIRE
      *                      TWO DIFFERENT RATES. THE RATES WOULD BE THE
      *                      RATE PREVAILING BEFORE EXPIRATION, AND
      *                      THE RATE IN EFFECT AFTER EXPERATION.
      *
      *                    IF PREVIOUSLY IBPC = "P":
      *                      AN "E" WOULD IMPLY THAT LATE CHARGES MAY
      *                      BE DUE AND ANTICIPATED INCOME NEEDS
      *                      TO BE EARNED.
      *                         NOTE: IBPC WILL BE SET TO "I".
      *
      *
      *
      *   USED: LN-LOANTYPE, LN-JDRATE, LN-INTREDU
      *         LN-LSTPAYMNT
      *   COPY TIM, TIMW, LPIBPCW, LPXDTE, LPXDTEW
      *        LPNDTE, LPNDTEW, LPMDTE, LPMDTEW
      * REV:
      *  042888 SLC ADDED THE EXPERATION, JUDGEMENT,
      *             ACCELERATION, AND RATE CHANGE/REDUCTION LOGIC.
      *             ADDED IBPC-EXPIRED-FLAG LOGIC.
      *  051989 JTG CORRECTED CHECK-PREV-STATUS TO INSURE
      *             CORRECT SETTING OF "P" RE: TRISTATE
      *  041097 JTG MADE SP-EXPR-FRMLA 'B' VALID AND ADDED
      *             88  SP-EXPR-FRMLA-ORIG         VALID "B".
      *             88  SP-EXPR-FRMLA-USE-EXPIRED  VALID "A" "B".
      **************************************************************************
       IBPC-TEST SECTION.

           MOVE " " TO IBPC-STAT IBPC-STAT-2 IBPC-EXPIRED-FLAG.
      * FIND THE EXPIRATION DATE.
           PERFORM EXPIRATION-DATE-CALCULATION.

      * NOW FOR THE COMPARISON!
           MOVE XDTE-DATE TO NUM-DATE.
           MOVE IBPC-DATE TO SYS-DATE.
           PERFORM TIM.

      * IF PAYDATE AFTER EXPIRATION,
      * SET THE STAT FLAGS TO 'E':
           MOVE LN-DATE-PAID-LAST TO NUM-DATE.
           IF LN-DATE-PAID-LAST = 0
              MOVE LN-INTDATE TO NUM-DATE.
           IF ELAPSED-DAYS > 0
              MOVE "E" TO IBPC-STAT IBPC-STAT-2
              IF ELAPSED-DAYS > 0
                 MOVE XDTE-DATE TO SYS-DATE
                 PERFORM TIM
      * IF LAST PAYMENT MADE BEFORE EXPIRATION,
      * AND EXPIRATION FORMULA INDICATES NOT TO CONTINUE AS WAS,
      * AND IF ACCOUNT STATUS CHANGED, ACCOUNT WILL USE
      * EXPIRED SITUATION,
      * THAN SET EXPIRED FLAG TO 'E':
                 IF ELAPSED-DAYS > 0
                  IF NOT SP-EXPR-FRMLA-CONT
                         AND (
                              (LN-STATUSFG = " ")
                                 OR (LN-STATUSFG = "J"
                                        AND SP-JUDGFRMLA NOT = " ")
                                 OR (LN-STATUSFG = "A"
                                        AND SP-ACC-FRMLA NOT = " ")
                                 OR (LN-STATUSFG = "R"
                                       AND SP-EXPR-REDU-FRMLA NOT = " ")
                             )
                    MOVE "E" TO IBPC-EXPIRED-FLAG.

           IF IBPC-STAT = "E"
              IF LN-STATUSFG = "J"
                 MOVE LN-JDDATE TO NUM-DATE
                 MOVE XDTE-DATE TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS NOT < 0
                    MOVE "J" TO IBPC-STAT
                 ELSE
                    MOVE "J" TO IBPC-STAT-2
              ELSE
              IF LN-STATUSFG = "A"
                 MOVE LN-ACCELDATE TO NUM-DATE
                 MOVE XDTE-DATE TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS NOT < 0
                    MOVE "A" TO IBPC-STAT
                 ELSE
                    MOVE "A" TO IBPC-STAT-2
              ELSE
              IF LN-STATUSFG = "R"
                 MOVE LN-REDUDATE TO NUM-DATE
                 MOVE XDTE-DATE TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS NOT < 0
                    MOVE "R" TO IBPC-STAT
                 ELSE
                    MOVE "R" TO IBPC-STAT-2
              ELSE
                 MOVE " " TO IBPC-STAT-2
           ELSE
              MOVE LN-STATUSFG TO IBPC-STAT
              MOVE " " TO IBPC-STAT-2.

      * IF INTEREST BEARING (WILL REMAIN SO):
           IF LN-LOANTYPE = "I"
              MOVE "I" TO IBPC-FG
              GO TO IBPC-TEST-EXIT.

      * PRECOMPUTE TEST CONDITIONS:
           MOVE "P" TO IBPC-FG.

      * NOW THAT WE KNOW WHAT IT IS, SET THE FLAG TO 'I' IF NECESSARY.

      * WHEN NO STATUS CHANGE HAS OCCURED ON THE ACCOUNT AND
      * THE ACCOUNT EXPIRED TEST FOR CONTINUED P/C:
           IF IBPC-STAT = "E" AND IBPC-STAT-2 = " "
                 IF SP-EXPR-FRMLA-CONT
                    NEXT SENTENCE
                 ELSE
                    MOVE "I" TO IBPC-FG
           ELSE
      * IF THE ACCOUNT WAS BEFORE OR AFTER EXPIRATION
      * EITHER ACCELERATED OR RATE CHANGED/REDUCED, STATUS IS I/B:
           IF LN-ACCELDATE NOT = 0 OR LN-REDUDATE NOT = 0
              MOVE "I" TO IBPC-FG
           ELSE
      * IF ACCOUNT IS JUDGEMENT AND NOT EXPIRED, TEST
      * LN-JDRATE FOR IB/PC STATUS:
           IF IBPC-STAT = "J" AND IBPC-STAT-2 = " "
              IF LN-JDRATE NOT = 999.999
                 MOVE "I" TO IBPC-FG
              ELSE
                 NEXT SENTENCE
           ELSE
      * IF EXPIRED FIRST AND THAN JUDGEMENT, TEST
      * LN-JDRATE FOR IB/PC STATUS:
           IF IBPC-STAT = "E" AND IBPC-STAT-2 = "J"
              IF SP-EXPR-FRMLA-CONT AND LN-JDRATE = 999.999
                 NEXT SENTENCE
              ELSE
                 MOVE "I" TO IBPC-FG
           ELSE
      *  IF ACCOUNT WAS PREVIOUSLY IN JUDGEMENT AND NOW EXPIRED:
      *  - IF JUDGEMENT WAS I/B STAY I/B:
      *  - IF JUDGEMENT WAS P/C;
      *       IF JUDGEMENT FORMULA SAYS CONTINUE P/C, STAY P/C.
      *       ELSE IF EXPIRED FORMULA SAYS CONTINUE P/C, STAY P/C.
      *            ELSE GO TO I/B:
           IF IBPC-STAT = "J" AND IBPC-STAT-2 = "E"
              IF LN-JDRATE NOT = 999.999
                 MOVE "I" TO IBPC-FG
              ELSE
              IF SP-JUDGFRMLA = " "
                 NEXT SENTENCE
              ELSE
              IF SP-EXPR-FRMLA-CONT
                 NEXT SENTENCE
              ELSE
                 MOVE "I" TO IBPC-FG.

      *  IF THERE IS A TWO RATE SITUATION ACROSS EXPIRATION CHECK TO
      *  SEE IF THE ACCOUNT WAS P/C ASOF THE LAST PAYMENT. IF IT WAS
      *  SET THE IBPC-FG TO "P".

           IF IBPC-EXPIRED-FLAG = "E"
              PERFORM CHECK-PREV-STATUS.

       IBPC-TEST-EXIT.
           EXIT.

       CHECK-PREV-STATUS SECTION.
       CHECK-PREV.

      *    IF LN-LOANTYPE = "P" AND
      *       ((LN-STATUSFG = " ") OR
      *       (LN-ACCELDATE = 0 AND LN-REDUDATE = 0) OR
      *       (LN-STATUSFG = "J" AND SP-JUDGFRMLA = 999.999))
      *       MOVE "P" TO IBPC-FG.

           IF LN-LOANTYPE = "P" AND
              ((LN-STATUSFG = " ") OR
              (LN-ACCELDATE = 0 AND LN-REDUDATE = 0
                                     AND LN-STATUSFG = " ") OR
              (LN-STATUSFG = "J" AND LN-JDRATE = 999.999
                         AND LN-ACCELDATE = 0 AND LN-REDUDATE = 0))
              MOVE "P" TO IBPC-FG.

       CHECK-PREV-STATUS-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPIBPC.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPRATE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPRATE
      **************************************************************
      *         SET INTEREST RATE AND INTEREST START DATE
      *                  (FOR IB ACCOUNTS)
      *
      *   NAME: LPRATE            (SET-PY-RATE             )
      *         WITH LPINDU LOGIC (INTEREST-DUE-CALCULATION)
      *   DESC: THIS ROUTINE IS USED TO DETERMINE
      *         THE INTEREST START DATE FOR CALCULATION,
      *         THE INTEREST BEARING RATE TO BE USED
      *         AND A CODE TO IDENTIFY IT'S MAKEUP.
      *         IT'S MAKEUP.
      *   IN  : RATE-DATE      (DATE OF PAYMENT)
      *         RATE-MAKERCD   LN-MAKERCD(X)
      *         RATE-LPTRCD    CURRENT TRANSACTION CODE.
      *   OUT :
      *   USED: LN-APRATE, LN-JDCD, LN-JDRATE, LN-INTREDU
      *         LN-ENDORATE, LN-OV, LPIBPC, LPIBPCW
      *         LN-INTPDTH-DATE, LN-INTDATE, LN-JDDATE
      *   COPY TIM, TIMW, LPRATEW, LPIBPC, LPIBPCW
      *
      * REV :
      *  042988 SLC ADDED THE REDUCTION, ACCELERATION,
      *             JUDGEMENT, AND EXPIRATION LOGIC.
      *             LPRATE NOW CALLS LPIBPC, LNINDU.
      *  012489 JTG SET IBPC-DATE FROM RATE-DATE
      *  012589 SLC LPINDU IS NOW PART OF THIS COPYFILE!
      *  110789 SLC COMPARE IS NOW DONE ON SP-MAX-IB-ACR-DAYS, NOT
      *             SP-IBINTACRFRMLA.
      *  051890 BAH REPLACES LN-DATE-PAID-LAST WITH LN-INTPDTH-DATE
      *             (INTERST ASSESSED THRU DATE 9(6)).
      *  111992 JTG ADDED LOGIC FOR SP-RBSPOPT1 = 9, WAGNER NC
      *  060495 SLC INDU-CURBAL (LN-CURBAL - LN-OT2BAL)
      *  111296 JTG CHANGED LN-INSTBL (LEVEL'S 9 & 10) TO FILLER
      *  012297 JTG ADDED SP-EXPR-FRMLA-ORIG TO USE THE LESSOR RATE
      *             (BETWEEN LN-OVRDRATE & EXPIRED RATES) ON ACCOUNTS
      *             NOT IN JUDGEMENT, ACCELERATED OR REDUCED
      *             --ADVANCED MORTGAGE, JUDY BRANIFF
      *  050697 JTG ADDED USE OF SETCTBL COPY MEMBER
      *  042798  CS ADDED RENEWAL CODES "RB" AND "RO"
      *  000107 JTG ADDED SP-RBREDUC = 9999.04 WISCONSIN IB REAL ESTATE
      *             PREPAY PENALTY, WISCONSIN #1031
      *  000225 MJD ADDED SP-RBREDUC = 9999.05 NEW SOUTH FLAT $75.00
      *             PREPAY PENALTY, (NEWS PR#1101)
      *  000406 GLB ADDED SP-RBREDUC = 9999.06 CAROLINA FINANCE(71252),
      *             NORTH CAROLINA 10% OR $25.00 (WHICHEVER IS < )
      *             PREPAY PENALTY, (CAROLINA PR#1149)
      *  000804 BAH NEW SOUTH, RBREDUC = 9999.03, WAS NOT STORING THE
      *             PENALTY IN INDU-PENALTY, IT WAS ADDING IT DIRECTLY
      *             INTO INDU-INTEREST,,,FAX FROM KEVIN
      *  JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *             SP-RBSPOPT1() = 19, WORLD #233
      *  JTG 000914 CORRECTED BUG IN PASS TO SETCTBL, ROUTINE WAS PASSING
      *             LN-LNAMT INSTEAD OF INTEREST CHARGEABLE  WORLD #J011
      *  JTG 020722 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *  BAH 020828 ALLOWED RBREDUC(7) = 9999.01 TO WORK FOR IB'S, ADD PENALTY
      *             TO INDU-INTEREST, PIKCO PR# 1900
      *  JTG 021025 ALLOW WORLD TO ENTER 999.998 IN SP-ACC-RATE(1)
      *             AND IF DETECTED HERE SKIP USAGE OF ACCELERATION RATE
      *             TABLE AND FORCE LN-SMPRATE RE: LN-ACCRATE 999.998 WORLD     
      *  BAH 021216 PIKCO CHANGE (020828) CALCULATED A PENALTY ON EVERY
      *             PAYMENT !! NEEDS TO CHECK FOR "PO" AND "PA" ONLY
      *  BAH 040615 SP-RBSPOPT1(7) = 8, NEEDED TO INCLUDE LN-INTBAL BEFORE
      *             TESTING THE MINRET AMOUNT, PACESETTER PL# 446
      *
      *  JTG 041021 ADDED NEW LOGIC WHEN TESTING FOR INDU-MAX-ACCRUE = 1,
      *             THAT INDICATES THE ACCRUAL WANTS TO ESTABLISH
      *             THE MAXIMUM INTEREST TO ACCRUAL (W-MAX). THE ACCRUAL
      *             INCREMENTS LN-INTPDTH-DATE WITH SP-MAX-IB-ACR-DAYS
      *             TO ESTABLISH RATE-DATE FOR DETERMINING (W-MAX),
      *             THIS IS INCORRECT WHEN ACCOUNTS HAD STATUS CHANGE
      *             DONE AFTER LN-INTPDTH-DATE, EXAMPLE "JD" WHICH MAKES THE
      *             JUDGEMENT DATE THE NEW ASSESS FROM DATE THAT SHOULD
      *             BE INCREMENTED WITH SP-MAX-IB-ACR-DAYS.                           *                                                             REGWAN #0450
      *   CS 050518 ADD SP-EXPR-FRMLA 'C'   FINANCIAL MGT [PR#484]
      *             [HAVE QUESTIONS WAITING FOR JUDY R TO RESPOND]
      *   CS 050614 FIXED SP-EXPR-FRMLA 'C', IF REDUCTION FORMULA WAS TO
      *             CONTINUE REDUCED RATE WAS STILL PERFORMING EXPIRED RATES
      *  MJD 060906 ADDED LOGIC TO USE THE CORRECT INTEREST ASSESSED THROUGH
      *             DATE WHEN THE LOAN IS EXPIRED AND IN JUDGMENT,
      *             ACCELERATED OR REDUCTION STATUS.  THE DATE USED SHOULD
      *             BE THE DATE OF THE JUDGMENT, ACCELERATION OR REDUCTION IF
      *             THAT DATE IS GREATER THEN THE INTEREST PAID THROUGH DATE.
      *                                                             REGENCY #531
      *  MJD 061227 ADDED LOGIC FOR OHIO PREPAYMENT PENALTY (RBSPOPT1 = 25)
      *                                                            REGENCY #2878
      *  MJD 081210 TESTING LOGIC FOR MAKING MFEE'S WORK WITH IB
      *   CS 100609 ADDED INDU-ASSESS-PENALTY-16, ACCOUNTS THAT HAD AN INTEREST
      *             CALCULATION FROM LN-INTPDTH-DATE TO EXPIR DATE & THEN EXPIRED
      *             INT CALC THRU PAY DATE BOTH GO THRU INTEREST-DUE-CALCULATION
      *             AT END OF INTEREST-DUE-CALCUATION IT CALCULATES PENALTY &
      *             WAS CALCULATED TWICE RBSPOPT1 = 16  REGENCY PL689
      *   CS 100610 ABOVE ALSO HAPPENS WITH SP-RBREDUC(7) = 9999.03 USED THE
      *             FLAG INDU-ASSESS-PENALTY TO STOP MULTIPLE ASSESSMENTS OF
      *             PENALTY.  THIS SHOULD BE OK SINCE ONLY ONE PENALTY CAN BE
      *             ASSESSED & THEN IT EXITS THE PENALTY SECTION.  EVEN IF THE
      *             SPR IS SET UP WITH BOTH, IT WILL NEVER HIT BOTH PENALTY
      *             LOGIC. APPLIES TO SPECIAL OPTION1 = 16, 21, AND 25
      *             REDUCTION AMOUNTS 9999.03,9999.01 REGENCY PL#689
      *             ALSO ADDED HOLD-INDU-PENALTY
      *  MJD 120321 ADDED SP-OPT-CAL-CHGABLE = "3" THIS WILL USE PROCEEDS,
      *             SVC CHG, AND ALL INSURANCES EXCEPT FOR O3
      *   CS 120730 IF SP-LC-INT-ON-REPO-NON-PL = 'N' FORCE 0 TO LATE CHARGE
      *             RATE, AND 0 TO LATE CHARGE MINIMUM, WE WANT TO ADVANCE
      *             LCPDTH DATE EVEN THOUGH NOT COLLECTING OR ASSESSING THEM
      *                                                 REGACC PR#314
      *  BAH 160921 ADDED LT-REC ON THE CALL OF REBA01, LINKAGE ERROR AT
      *             CUSTOMER REBA01 WAS CHANGED 6 YEARS AGO! FIRST METRO #949
      *  BAH 180702 CHANGED A01 PASSING FIELDS TO BE IN LPRATEW SO REBATE 
      *             COPY MEMBERS DO NOT NEED TO BE IN HERE!
      *  CS 211123 AT THE BEGINNING OF SET-PY-RATE, SET INDU-ASSESS-PENALTY
      *            TO SPACES.
      *  BAH 2022.0131 ADDED CANCEL FORM-PROGX AFTER REBA02
      **************************************************************************
       SET-PY-RATE SECTION.
           MOVE SP-INTMETHOD TO INDU-INTMETHOD.
           MOVE SP-YEARTYPE TO INDU-YEARTYPE.
           MOVE 0 TO RATE-EXP-INT
                     INDU-INTEREST
                     INDU-INTEREST-2.
      *ADDED THIS, WHEN RUN IN EXTRACTIONS, AC1DAY, LNAGIB
      *FLAG WAS NOT GETTING RESET EVERY TIME
           MOVE SPACES TO INDU-ASSESS-PENALTY.

           IF SP-LC-INT-ON-REPO-NON-PL = "N"
              IF LN-REPOCD = "X" OR "S"
                IF LN-PLDATE = ZEROS
                  MOVE 0 TO INDU-INTEREST
                  GO TO SET-PY-RATE-EXIT.

      *------------------------------------------------
      *    999.999 - DEFAULT TO SPR RATES:
      *------------------------------------------------
           MOVE 999.999 TO INDU-RATE.

      *------------------------------------------------
      *    GET IBPC STATUS OF ACCOUNT
      *------------------------------------------------
           MOVE RATE-DATE TO IBPC-DATE.
           PERFORM IBPC-TEST.

      *------------------------------------------------
      *    SKIP PC ACCOUNTS THAT HAVE NOT EXPIRED
      *------------------------------------------------
           IF IBPC-FG = "P" AND IBPC-EXPIRED-FLAG = " "
              GO TO SET-PY-RATE-EXIT.

      *------------------------------------------------
      *    SETUP RATE FOR INTEREST CALCULATION
      *------------------------------------------------

      * IF JUDGEMENT SET RATE IF NOT (999.999):
      * APPLIES TO ACCELERATED, RATE CHANGED/REDUCED
      * AND EXPIRED LOANS THAT HAVE BECOME JUDGEMENTS.
           IF (IBPC-STAT = "J" AND IBPC-STAT-2 = " ") OR
              (IBPC-STAT-2 = "J" AND SP-EXPR-FRMLA NOT = "C")
              PERFORM LPRATE-JUDGEMENT
           ELSE
      * TEST FOR ACCOUNT IN EXPIRATION AND NO STATUS SET:
           IF SP-EXPR-FRMLA-USE-EXPIRED
                 AND (
                       (IBPC-STAT = "E" AND IBPC-STAT-2 = " ")
                       OR (IBPC-STAT = "J" AND IBPC-STAT-2 = "E"
                                            AND SP-JUDGFRMLA = "A")
                        OR
                             (IBPC-STAT = "A" AND IBPC-STAT-2 = "E"
                                             AND SP-ACC-FRMLA = "A")
                         OR
                              (IBPC-STAT = "R" AND IBPC-STAT-2 = "E"
                                        AND SP-EXPR-REDU-FRMLA = "A")

                         OR (IBPC-STAT = "E" AND IBPC-STAT-2 = "J")
                               AND (SP-EXPR-FRMLA = "C"
                                            AND SP-JUDGFRMLA = "A")


                     )
              PERFORM LPRATE-USE-EXPIRED-RATES
              GO TO SET-PY-RATE-EXIT
           ELSE
           IF IBPC-STAT = "J" AND IBPC-STAT-2 = "E"
              PERFORM LPRATE-JUDGEMENT
           ELSE
           IF IBPC-STAT = "A" AND IBPC-STAT-2 = "E"
              PERFORM LPRATE-ACCELERATION
           ELSE
           IF IBPC-STAT = "R" AND IBPC-STAT-2 = "E"
              MOVE LN-REDURATE TO INDU-RATE
           ELSE
           IF (IBPC-STAT = "A" AND IBPC-STAT-2 = " ")
                                      OR IBPC-STAT-2 = "A"
              PERFORM LPRATE-ACCELERATION
           ELSE
           IF (IBPC-STAT = "R" AND IBPC-STAT-2 = " ")
                                      OR IBPC-STAT-2 = "R"
              MOVE LN-REDURATE TO INDU-RATE
           ELSE
           IF IBPC-STAT = "E"
              MOVE LN-OVRDRATE TO INDU-RATE
           ELSE
           IF RATE-MAKERCD = "E"
              IF LN-ENDORATE NOT = 999.999
                 MOVE LN-ENDORATE TO INDU-RATE
              ELSE
              IF LN-OVRDRATE NOT = 999.999
                 MOVE LN-OVRDRATE TO INDU-RATE
              ELSE
                 NEXT SENTENCE
           ELSE
              IF LN-OVRDRATE NOT = 999.999
                 MOVE LN-OVRDRATE TO INDU-RATE.

      * SETUP (INDU-DATE-1) INTEREST START DATE:
           PERFORM LPRATE-SET-INTPDTH-DATE.

           IF (IBPC-STAT = "J" AND IBPC-STAT-2 = " ")
                 OR (IBPC-STAT-2 = "J")
                  OR (IBPC-STAT = "J"
                        AND IBPC-STAT-2 = "E"
                         AND (SP-JUDGFRMLA = " "
                                 OR (SP-JUDGFRMLA = "A"
                                         AND SP-EXPR-FRMLA-CONT)
                             )
                     )
              MOVE INDU-DATE-1 TO NUM-DATE
              MOVE LN-JDDATE   TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-JDDATE TO INDU-DATE-1.

           IF (IBPC-STAT = "A" AND IBPC-STAT-2 = " ")
                 OR (IBPC-STAT-2 = "A")
                  OR (IBPC-STAT = "A"
                          AND IBPC-STAT-2 = "E"
                           AND (SP-ACC-FRMLA = " "
                                   OR (SP-ACC-FRMLA = "A"
                                           AND SP-EXPR-FRMLA-CONT)
                               )
                     )
              MOVE INDU-DATE-1  TO NUM-DATE
              MOVE LN-ACCELDATE TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-ACCELDATE TO INDU-DATE-1.

           IF (IBPC-STAT = "R" AND IBPC-STAT-2 = " ")
                 OR (IBPC-STAT-2 = "R")
                  OR (IBPC-STAT = "R"
                        AND IBPC-STAT-2 = "E"
                         AND (SP-EXPR-REDU-FRMLA = " "
                                 OR (SP-EXPR-REDU-FRMLA = "A"
                                         AND SP-EXPR-FRMLA-CONT)
                             )
                     )
              MOVE INDU-DATE-1 TO NUM-DATE
              MOVE LN-REDUDATE TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-REDUDATE TO INDU-DATE-1.

           MOVE RATE-LPTRCD TO INDU-LPTRCD.
           COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEW LOGIC TESTING FOR INDU-MAX-ACCRUE = 1, WHICH INDICATES
      *    THE ACCRUAL LP/AC1ERN WANTS TO ESTABLISH (W-MAX) THE MAXIMUM
      *    INTEREST TO ACCRUAL PER SP-MAX-IB-ACR-DAYS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( INDU-MAX-ACCRUE = 1 AND SP-MAX-IB-ACR-DAYS NOT = 0 )
              IF ( SP-MAX-IB-ACR-DAYS NOT = 999 )
                 MOVE INDU-DATE-1        TO NDTE-DATE
                 MOVE SP-MAX-IB-ACR-DAYS TO NDTE-HOLD
                 PERFORM INCREMENT-DAYS
                 MOVE NDTE-DATE TO RATE-DATE.

           MOVE RATE-DATE TO INDU-DATE-2.
           PERFORM INTEREST-DUE-CALCULATION.

       SET-PY-RATE-EXIT.
           EXIT.

      ************************************************
      *    USE EXPIRED RATES
      ************************************************
       LPRATE-USE-EXPIRED-RATES SECTION.
           PERFORM LPRATE-SET-INTPDTH-DATE.
           IF IBPC-EXPIRED-FLAG = " "
              MOVE 0 TO RATE-EXP-INT
              PERFORM LPRATE-PREPARE-PMT-2
           ELSE
           IF IBPC-EXPIRED-FLAG = "E" AND IBPC-FG = "P"
              MOVE XDTE-DATE TO INDU-DATE-1
              MOVE 0 TO RATE-EXP-INT
              COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL
              MOVE RATE-LPTRCD TO INDU-LPTRCD
              PERFORM LPRATE-PREPARE-PMT-2
           ELSE
           IF LN-STATUSFG = "J" AND IBPC-EXPIRED-FLAG = "E"
              MOVE INDU-DATE-1 TO NUM-DATE
              MOVE LN-JDDATE   TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-JDDATE TO INDU-DATE-1
              END-IF
              PERFORM LPRATE-JUDGEMENT
              PERFORM LPRATE-CALC-IT
           ELSE
           IF LN-STATUSFG = "A" AND IBPC-EXPIRED-FLAG = "E"
              MOVE INDU-DATE-1  TO NUM-DATE
              MOVE LN-ACCELDATE TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-ACCELDATE TO INDU-DATE-1
              END-IF
              PERFORM LPRATE-ACCELERATION
              PERFORM LPRATE-CALC-IT
           ELSE
           IF LN-STATUSFG = "R" AND IBPC-EXPIRED-FLAG = "E"
              MOVE INDU-DATE-1 TO NUM-DATE
              MOVE LN-REDUDATE TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE LN-REDUDATE TO INDU-DATE-1
              END-IF
              MOVE LN-REDURATE TO INDU-RATE
              PERFORM LPRATE-CALC-IT
           ELSE
           IF LN-STATUSFG = " " AND IBPC-EXPIRED-FLAG = "E"
              MOVE LN-OVRDRATE TO INDU-RATE
              PERFORM LPRATE-CALC-IT.


      ************************************************
      *    CALC IT ROUTINE
      ************************************************
       LPRATE-CALC-IT SECTION.
           PERFORM LPRATE-PREPARE-PMT-1.
           PERFORM INTEREST-DUE-CALCULATION.
           PERFORM LPRATE-PREPARE-PMT-2.

      ************************************************
      *    PREPARE-PMT-1 ROUTINE
      ************************************************
       LPRATE-PREPARE-PMT-1 SECTION.
           MOVE XDTE-DATE TO INDU-DATE-2.
           COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL.
           MOVE RATE-LPTRCD TO INDU-LPTRCD.
           IF LN-STATUSFG = " " OR LN-STATUSFG = "R" AND
              INDU-RATE NOT = 999.997
              MOVE SP-INTMETHOD TO INDU-INTMETHOD
              MOVE SP-YEARTYPE  TO INDU-YEARTYPE
           ELSE
           IF LN-STATUSFG = " " AND INDU-RATE = 999.997
              MOVE SP-ACC-INTMETH TO INDU-INTMETHOD
              MOVE SP-ACC-YRTYPE  TO INDU-YEARTYPE.

      ************************************************
      *    PREPARE-PMT-2 ROUTINE
      ************************************************
       LPRATE-PREPARE-PMT-2 SECTION.
           MOVE INDU-INTEREST TO RATE-EXP-INT INDU-INTEREST-2.
           PERFORM LPRATE-SET-INTPDTH-DATE.
           MOVE INDU-DATE-1 TO NUM-DATE.
           MOVE XDTE-DATE TO SYS-DATE.
           IF SYS-DATE > NUM-DATE
              MOVE XDTE-DATE TO INDU-DATE-1.
           COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL.
           MOVE RATE-LPTRCD TO INDU-LPTRCD.
           PERFORM LPRATE-EXPIRED-INT.
           IF (IBPC-STAT = "J" OR IBPC-STAT = "N") AND
              (IBPC-STAT-2 = "E" AND SP-EXPR-FRMLA NOT = "C")
              MOVE " " TO IBPC-STAT-2
              MOVE INDU-INTEREST-2 TO RATE-EXP-INT
              MOVE INDU-INTEREST TO INDU-INTEREST-2
              MOVE 0 TO INDU-INTEREST
              PERFORM LPRATE-COMPARE-RATES
              PERFORM INTEREST-DUE-CALCULATION
              IF (INDU-INTEREST-2 < INDU-INTEREST + RATE-EXP-INT)
                 MOVE INDU-INTEREST-2 TO INDU-INTEREST
              ELSE
                 ADD RATE-EXP-INT TO INDU-INTEREST.

      ************************************************
      *    COMPARE RATES ROUTINE
      ************************************************
       LPRATE-COMPARE-RATES SECTION.
           PERFORM LPRATE-SET-INTPDTH-DATE.
           MOVE INDU-DATE-1 TO NUM-DATE.
           MOVE XDTE-DATE TO SYS-DATE.
           IF SYS-DATE > NUM-DATE
              MOVE XDTE-DATE TO INDU-DATE-1.
           COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL.
           MOVE RATE-LPTRCD TO INDU-LPTRCD.
           IF IBPC-STAT = "J"
              PERFORM LPRATE-JUDGEMENT
           ELSE
           IF IBPC-STAT = "R"
              MOVE LN-REDURATE TO INDU-RATE.

      ************************************************
      *    EXPIRED INTEREST ROUTINE
      *
      * THIS ROUTINE WALKS THRU THE SP-EXPR-RATETBL(5)
      *  DETERMINING WHICH RATE TO CHARGE AND FOR
      *  HOW LONG, COMPUTING INTEREST DUE FOR EACH
      *  BREAK.
      ************************************************
       LPRATE-EXPIRED-INT SECTION.
           MOVE 0 TO RATE-EXPR-TAB-BREAK(1) RATE-EXPR-TAB-BREAK(2)
                     RATE-EXPR-TAB-BREAK(3) RATE-EXPR-TAB-BREAK(4)
                     RATE-EXPR-TAB-BREAK(5).
           MOVE XDTE-DATE TO NDTE-DATE.
           SET EXPR TO 1.
           PERFORM LPRATE-CALC-BREAK-DATES
              UNTIL EXPR > 5 OR SP-EXPR-BREAK(EXPR) = 0.
           MOVE RATE-LPTRCD TO INDU-LPTRCD.
           SET EXPR TO 0.
       LPRATE-EXPIRED-INT-LOOP.
           SET EXPR UP BY 1.
           COMPUTE INDU-CURBAL = LN-CURBAL - LN-OT2BAL.
           MOVE SP-EXPR-YRTYPE(EXPR) TO INDU-YEARTYPE.
           MOVE SP-EXPR-INTMETH(EXPR) TO INDU-INTMETHOD.
           IF SP-EXPR-RATE(EXPR) = 999.999
              MOVE LN-OVRDRATE TO INDU-RATE
           ELSE
           IF ( SP-EXPR-FRMLA = "C"              ) AND
              ( SP-EXPR-RATE(EXPR) NOT > 999.995 ) AND
              ( LN-SMPRATE < SP-EXPR-RATE(EXPR)  )
                 MOVE LN-SMPRATE   TO INDU-RATE
                 MOVE SP-INTMETHOD TO INDU-INTMETHOD
                 MOVE SP-YEARTYPE  TO INDU-YEARTYPE
            ELSE
      *JTG HELP FOR JUDY, ADVANCE MORTGAGE 012297:
              MOVE SP-EXPR-RATE(EXPR) TO INDU-RATE
              IF INDU-RATE NOT > 999.995
                 IF SP-EXPR-FRMLA-ORIG
      *                  --ACCOUNT IS/HAS EXPIRED AND IS NOT
      *                    ACCELERATED/JUDGEMENT/REDUCED
                         AND IBPC-STAT = "E"
                          AND IBPC-STAT-2 = " "
                    IF LN-OVRDRATE < INDU-RATE
                       MOVE LN-OVRDRATE TO INDU-RATE
                       MOVE SP-INTMETHOD TO INDU-INTMETHOD
                       MOVE SP-YEARTYPE TO INDU-YEARTYPE.
      *JTG HELP FOR JUDY, ADVANCE MORTGAGE 012297:

           PERFORM LPRATE-FIND-THRU-DATE.
           PERFORM INTEREST-DUE-CALCULATION.
           ADD INDU-INTEREST TO RATE-EXP-INT.
           MOVE INDU-DATE-2 TO INDU-DATE-1.
           IF EXPR < 5
                AND (SP-EXPR-BREAK(EXPR) NOT = 0
                         AND RATE-EXPR-TAB-BREAK(EXPR) NOT = 0
                    )
              GO TO LPRATE-EXPIRED-INT-LOOP.
           MOVE RATE-EXP-INT TO INDU-INTEREST.

      ************************************************
      *    CALC BREAK DATES ROUTINE
      *
      * THIS ROUTINE CONVERTS ALL SP-EXPR-BREAK'S
      *  INTO DATES, BASED ON MONTHS AND DAYS FROM
      *  EXPIRATION.
      ************************************************
       LPRATE-CALC-BREAK-DATES SECTION.
      * SET SPR EXPR BREAK MONTHS & DAYS(.99 MONTHS):
           MOVE SP-EXPR-BREAK(EXPR) TO RATE-EXPR-BREAK.
           IF RATE-EXPR-BREAK > 360
              MOVE EXT-JULIAN-END TO NDTE-DATE
           ELSE
              MOVE XDTE-DATE TO NDTE-DATE
              MOVE RATE-EXPR-MONTHS TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              COMPUTE NDTE-HOLD ROUNDED = RATE-EXPR-DAYS * 0.30
              PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE TO RATE-EXPR-TAB-BREAK(EXPR).
           SET EXPR UP BY 1.

      ************************************************
      *    FIND THRU DATES ROUTINE
      ************************************************
       LPRATE-FIND-THRU-DATE SECTION.
           MOVE RATE-EXPR-TAB-BREAK(EXPR) TO NUM-DATE.
           MOVE RATE-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS < 0
                   OR RATE-EXPR-TAB-BREAK(EXPR) = 0
              MOVE RATE-DATE TO INDU-DATE-2
              MOVE 0 TO RATE-EXPR-TAB-BREAK(EXPR)
           ELSE
              MOVE INDU-DATE-1 TO NUM-DATE
              MOVE RATE-EXPR-TAB-BREAK(EXPR) TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-DAYS NOT > 0
                 MOVE INDU-DATE-1 TO INDU-DATE-2
              ELSE
                 MOVE RATE-EXPR-TAB-BREAK(EXPR) TO INDU-DATE-2.

      ************************************************
      *    JUDGEMENT ROUTINE
      ************************************************
       LPRATE-JUDGEMENT SECTION.
      * 999.999 - ORIGINAL LOAN CONTRACTED RATE/METHOD:
           IF LN-JDRATE = 999.999
              MOVE LN-OVRDRATE TO INDU-RATE
              MOVE SP-INTMETHOD TO INDU-INTMETHOD
              MOVE SP-YEARTYPE TO INDU-YEARTYPE
           ELSE
           IF LN-JDRATE < 999.999
              MOVE LN-JDRATE TO INDU-RATE
      * 999.998 - EQUIVALENT SIMPLE INTEREST RATE:
      * 999.996 - A.P.R. RATE:
              IF LN-JDRATE = 999.998 OR 999.996
                 MOVE SP-INTMETHOD TO INDU-INTMETHOD
                 MOVE SP-YEARTYPE TO INDU-YEARTYPE
              ELSE
      * 999.997 - ACCELERATION RATES:
              IF LN-JDRATE = 999.997
                 MOVE SP-ACC-INTMETH TO INDU-INTMETHOD
                 MOVE SP-ACC-YRTYPE TO INDU-YEARTYPE
              ELSE
      * > 999.996 - JUST SOME JUDGEMENT RATE:
              IF LN-JDRATE < 999.996
                 MOVE SP-JUDGINTMETH TO INDU-INTMETHOD
                 MOVE SP-JUDGYRTYPE TO INDU-YEARTYPE.

      ************************************************
      *    ACCELERATION ROUTINE
      ************************************************
       LPRATE-ACCELERATION SECTION.
           IF LN-ACCRATE = 999.998
              MOVE 999.998      TO INDU-RATE
              MOVE SP-INTMETHOD TO INDU-INTMETHOD
              MOVE SP-YEARTYPE  TO INDU-YEARTYPE
           ELSE
           IF LN-ACCRATE = 999.996
              MOVE 999.996      TO INDU-RATE
              MOVE SP-INTMETHOD TO INDU-INTMETHOD
              MOVE SP-YEARTYPE  TO INDU-YEARTYPE
           ELSE
      * ALLOW WORLD TO ENTER 999.998 IN SP-ACC-RATE(1)
      * AND IF DETECTED HERE SKIP USAGE OF ACCELERATION RATE
      * TABLE AND FORCE LN-SMPRATE RE: LN-ACCRATE 999.998 WORLD #306
              IF ( LN-ACCRATE     = 999.997 ) AND
                 ( SP-ACC-RATE(1) = 999.998 )
                 MOVE 999.998      TO INDU-RATE
                 MOVE SP-INTMETHOD TO INDU-INTMETHOD
                 MOVE SP-YEARTYPE  TO INDU-YEARTYPE
              ELSE
      * DEFAULT OF EITHER 999.997 OR (0 TO 999.995)
                 MOVE SP-ACC-INTMETH TO INDU-INTMETHOD
                 MOVE SP-ACC-YRTYPE  TO INDU-YEARTYPE
                 MOVE LN-ACCRATE     TO INDU-RATE.

      ************************************************
      *    SET INTEREST PDTH (ASSESS FROM DATE)
      ************************************************
       LPRATE-SET-INTPDTH-DATE SECTION.
           MOVE LN-INTDATE TO INDU-DATE-1.
           IF LN-INTPDTH-DATE NOT = 0
              MOVE LN-INTPDTH-DATE TO INDU-DATE-1
           ELSE
              IF (LN-DATE-PAID-LAST NOT = 0)
                       AND (LN-DATE-PAID-LAST NOT = LN-LOANDATE)
                 MOVE LN-DATE-PAID-LAST TO INDU-DATE-1.

      *************************************************************************
      *   NAME:  LPINDU - INTEREST DUE CALCULATION
      *   DESC:  COMPUTE INTEREST DUE AT GIVEN PAY DATE
      *   IN  :  INDU-DATE-1  (LN-INTDATE OR LAST INTEREST ACCESS)
      *          INDU-DATE-2  (LP-PAYDATE)
      *          INDU-CURBAL (LN-CURBAL - LN-OT2BAL)
      *          INDU-RATE   (LN-EXPRRATE, LN-ENDORATE, ETC)
      *          INDU-LPTRCD (PAYMENT TRANSACTION CODE)
      *          INDU-YEARTYPE (YEAR TYPE BASED ON RATE BEING USED)
      *          INDU-INTMETHOD (INTEREST METHOD BASED ON RATE USED)
      *   OUT :  INDU-INTEREST
      *          INDU-DAYS
      *          INDU-PENALTY
      *   USED:
      * REV :
      *  092287 JTG REMOVED COMMA'S  ALSO CHANGED
      *             LOGIC FOR SELECTING RATE TABLE
      *             TO MAKE IT BETTER READ.
      *  092287 JTG MODIFIED TO ALLOW A SPACE IN
      *             BREAKTYPE IF SINGLE RATE TABLES.
      *  033188 JTG ADDED LOGIC FOR SPECIAL REFUND
      *             CONDITIONS
      *  041888 SLC CHANGED 99.9999 TO 999.999 TO MAKE
      *             COMPATABLE WITH NEW RATE DEFINITION.
      *             ADDED THE FOLLOWING OPTIONS:
      *             IF INDU-RATE = 999.998 USE LN-SMPRATE
      *             IF INDU-RATE = 999.997 USE ACCELERATION
      *             TABLE FROM SPR.
      *  050288 SLC YEARTYPE AND INT METH NOW PASSED TO INDU.
      *  032789 JTG CHANGED HOLLLYWODD FINANCE PO MAX
      *             60 INT. CALC ON RENEWAL TO TEST
      *             SPECIAL OPT 1 AND NOT RECAST CODE.
      *  080189 JTG ADDED LOGIC FOR SP-RBSPOPT1 = 5 SPRING (NJ)
      *  081089 JTG ADDED LOGIC FOR SP-RBSPOPT2 = 2 SPRING (NJ)
      *  100589 SLC ADDED SPECIAL OPTION TO CALC INTEREST BASE ON
      *             MAX NUMBER OF DAYS TO ACCRUE FOR IB ACCRUE REPORT
      *  012690 JTG ADDED OUTPUT OF INDU-DAYS
      *  053190 JTG ADDED SP-RBSPOPT1 = 8, PACESETTER
      *  083190 BAH ADDED REDUCTION OF SERVICE CHARGE FOR
      *             CHARGEABLE CODES 'I' AND 'P'
      *  031491 JTG ADDED REDUCTION OF INSURANCE PREMIUMS FOR
      *             CHARGEABLE CODES 'S' AND 'P'
      *  JTG 062995 ADDED SP-OPT-CAL-CHGABLE, MERCURY MI SERCHG
      *  JTG 092095 STOPPED REDUCTION OF CURRENT BALANCE ON 'PC' TYPE
      *             ACCOUNTS, WHEN THE SPR INTEREST CHARGABLE CODE
      *             EXCLUDED 'SERCHG AND /OR INSURANCE PREMIUMS'
      *  JTG 112795 ADDED SP-RBREDUC = 9999.02, 'NV' MERCURY ACTION SPRDER = 09
      *  JTG 120297 CHANGED TO ESTABLISH NO LIMIT ON SP-MAX-IB-ACR-DAYS
      *             CBC CAPITAL SINGLE PAY LOAN 12 MONTHS
      *  JTG 011698 PUT THE CODE IN FOR LOGIC THAT SHOULD HAVE BEEN ADDED
      *             BACK ON 092095, FOR STOPPING REDUCTION OF CURRENT BALANCE
      *             ON 'PC' TYPE ACCOUNTS, WHEN THE SPR INTEREST CHARGABLE CODE
      *             EXCLUDED 'SERCHG AND /OR INSURANCE PREMIUMS'
      *  JTG 990216 ADDED INTEREST-DUE-PENALTY-OH, SPECIAL OPTION #1 (16).
      *  JTG 991202 ADDED SP-RBREDUC = 9999.03, 'GA' NEW SOUTH PREPAY PENALTY
      *  JTG 000104 ADDED SP-RBREDUC = 9999.04 WISCONSIN IB REAL ESTATE
      *             PREPAY PENALTY, WISCONSIN #1031
      *             PLUS XFER OF PENALTY TO MSPENALTY IN LONPF SCREEN
      *  JTG 000124 ADDED SP-CAL-MAX-AT-ESTIMATE INSTANT AUTO #1047
      *  000225 MJD ADDED SP-RBREDUC = 9999.05 NEW SOUTH FLAT $75.00
      *             PREPAY PENALTY, (NEWS PR#1101)
      *  000804 BAH NEW SOUTH, RBREDUC = 9999.03, WAS NOT STORING THE
      *             PENALTY IN INDU-PENALTY, IT WAS ADDING IT DIRECTLY
      *             INTO INDU-INTEREST,,,FAX FROM KEVIN
      *  JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *             SP-RBSPOPT1() = 19, WORLD #233
      *  JTG 000914 CORRECTED BUG IN PASS TO SETCTBL, ROUTINE WAS PASSING
      *             LN-LNAMT INSTEAD OF INTEREST CHARGEABLE  WORLD #J011
      *  BAH 010108 ADDED CLEAR OF INDU-PENALTY, NEEDED TO BE SURE IT WAS
      *             0 CAUSE IT WILL SUBTRACT THIS FROM NO-DEFERMENT IN
      *             SPINQ0 CAUSE IT CALLS CRNORC WITH "PO" WITH CREATES
      *             AN INTEREST PENALTY INCLUDED IN THE NO-DEFERMENT
      *             LENDMARK (KEVIN)
      * JTG 020722 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *  BAH 020828 ALLOWED RBREDUC(7) = 9999.01 TO WORK FOR IB'S, ADD PENALTY
      *             TO INDU-INTEREST, PIKCO PR# 1900
      *  BAH 021216 CHANGE ABOVE CALCULATED A PENALTY ON EVERY PAYMENT !!
      *             NEEDS TO CHECK FOR "PO" AND "PA" ONLY
      *  BAH 040623 ADDED RBSPOPT1 = 21, THRIFT INVESTMENT PR# 2334
      *  BAH 160921 ADDED LT-REC ON THE CALL OF REBA01, LINKAGE ERROR AT
      *             CUSTOMER REBA01 WAS CHANGED 6 YEARS AGO! FIRST METRO #949
      *  BAH 180702 CHANGED A01 PASSING FIELDS TO BE IN LPRATEW SO REBATE 
      *             COPY MEMBERS DO NOT NEED TO BE IN HERE!
      *   CS 211105 CHANGED INTEREST-DUE CALCULATION IF ELAPSED-YRTYPE IS 0
      **************************************************************************
       INTEREST-DUE-CALCULATION SECTION.
           MOVE 0 TO INDU-INTEREST INDU-WORKER 
                     INDU-AMOUNT   INDU-DAYS   INDU-PENALTY
                     INDU-ALL-INSPREM.
           MOVE INDU-DATE-1 TO NUM-DATE.
           MOVE INDU-DATE-2 TO SYS-DATE.
           MOVE INDU-YEARTYPE TO ELAPSED-YRTYPE.
           IF ELAPSED-YRTYPE = 0
              MOVE 0 TO ELAPSED-DAYS
           ELSE
              PERFORM TIMALL.
           PERFORM INTEREST-DUE-SPECIAL-OPTIONS.
           IF ELAPSED-DAYS NOT > 0
              GO TO INTEREST-DUE-EXIT.

           PERFORM SELECT-SPR-TABLE.
           IF LN-LOANTYPE = "I"
              IF SP-OPT-CAL-CHGABLE NOT = " "
                 IF SP-OPT-CAL-PROCEEDS OR SP-OPT-CAL-PRO-INS
                    SUBTRACT LN-SERCHG FROM INDU-CURBAL
                 END-IF
              ELSE
              IF SP-CAL-PROCEEDS(CTBL) OR SP-CAL-PRO-INS(CTBL)
                 SUBTRACT LN-SERCHG FROM INDU-CURBAL.

           IF LN-LOANTYPE = "I"
              IF SP-OPT-CAL-CHGABLE NOT = " "
                 IF SP-OPT-CAL-PROCEEDS OR SP-OPT-CAL-PRO-SC
                    PERFORM INDU-GET-ALL-INSPREM
                    SUBTRACT INDU-ALL-INSPREM FROM INDU-CURBAL
                 END-IF
              ELSE
              IF SP-CAL-PROCEEDS(CTBL) OR SP-CAL-PRO-SC(CTBL)
                 PERFORM INDU-GET-ALL-INSPREM
                 SUBTRACT INDU-ALL-INSPREM FROM INDU-CURBAL.

      * IF CHGABLE CODE 3 THEN INCLUDE PROCEEDS, SVC CHG, AND ALL INSURANCES
      *    EXCEPT FOR OTHER 3

           IF LN-LOANTYPE = "I"
              IF SP-OPT-CAL-CHGABLE NOT = " "
                 IF SP-OPT-CAL-PRO-INS-SC-NO-O3
                     IF LN-INSOURS(6) NOT = "M"
                        SUBTRACT LN-INSPREM(6) FROM INDU-CURBAL.


      ******************************************************
      *  NEEDED NOW THAT WE ARE GOING TO ALLOW MAINT FEE'S
      *    ON IB LOANS.
      *       VALID CODES FOR LN-MF-REBATE:
      *             SP - NO REBATE OR CANCEL
      *             C - CANCEL
      *             Y - REBATE NO CANCEL
      *             R - REBATE AFTER CANCEL
      ******************************************************
           IF LN-LOANTYPE = "I"
              IF NOT (LN-MF-REBATE = "Y" OR "R")
                 COMPUTE INDU-CURBAL = INDU-CURBAL -
                                          (LN-MAINTFEE * LN-ORGTERM).

           IF INDU-CURBAL < 0
              MOVE 0 TO INDU-CURBAL.

           IF INDU-RATE = 999.999
              GO TO VALIDATE-SPR-TABLE
           ELSE
           IF INDU-RATE = 999.998
              MOVE LN-SMPRATE TO INDU-RATE
           ELSE
           IF INDU-RATE = 999.996
              MOVE LN-APRATE TO INDU-RATE
           ELSE
           IF INDU-RATE = 999.997
              SET ASTP TO 0
              GO TO ACCEL-INT-LOOP.

           COMPUTE INDU-WORKER ROUNDED =
                   (INDU-RATE / 100) * INDU-CURBAL.

           GO TO INTEREST-DUE-FINAL.

      ********************************
      *    VALIDATE SELECTED TABLE
      ********************************
       VALIDATE-SPR-TABLE.
           IF NOT (SP-CAL-SIMPLE(CTBL))
              GO TO INTEREST-DUE-EXIT.
           IF NOT (SP-CAL-TBFRMLA-VALID(CTBL))
              GO TO INTEREST-DUE-EXIT.
           IF SP-CAL-BREAK-ON-TERM(CTBL)
              GO TO INTEREST-DUE-EXIT.

      ********************************
      *    INTEREST DUE LOOPS
      *    USING SP-CAL TABLES
      ********************************
           SET CSTP TO 0.
       INTEREST-DUE-LOOP.
           IF INDU-CURBAL = 0
              GO TO INTEREST-DUE-FINAL.
           SET CSTP UP BY 1.
           IF CSTP > SP-CAL-NORATES(CTBL)
              GO TO INTEREST-DUE-FINAL.
           IF SP-CAL-BREAK(CTBL CSTP) = 0
              MOVE INDU-CURBAL TO INDU-AMOUNT
           ELSE
              IF CSTP = 1
                 MOVE SP-CAL-BREAK(CTBL CSTP) TO INDU-AMOUNT
              ELSE
                 SUBTRACT SP-CAL-BREAK(CTBL CSTP - 1) FROM
                             SP-CAL-BREAK(CTBL CSTP)
                                GIVING INDU-AMOUNT.
           IF INDU-CURBAL > INDU-AMOUNT
              SUBTRACT INDU-AMOUNT FROM INDU-CURBAL
           ELSE
              MOVE INDU-CURBAL TO INDU-AMOUNT
              MOVE 0 TO INDU-CURBAL.
           COMPUTE INDU-WORKER ROUNDED = INDU-WORKER +
              (SP-CAL-RATE(CTBL CSTP) / 100) * INDU-AMOUNT.
           GO TO INTEREST-DUE-LOOP.

      ********************************
      *    INTEREST DUE LOOPS
      *    USING SP-ACC TABLE
      ********************************
       ACCEL-INT-LOOP.
           IF INDU-CURBAL = 0
              GO TO INTEREST-DUE-FINAL.
           SET ASTP UP BY 1.
           IF ASTP > 5
              GO TO INTEREST-DUE-FINAL.
           IF SP-ACC-RATE(ASTP) = 0 AND SP-ACC-BREAK(ASTP) = 0
              GO TO INTEREST-DUE-FINAL.
           IF SP-ACC-BREAK(ASTP) = 0
              MOVE INDU-CURBAL TO INDU-AMOUNT
           ELSE
              IF ASTP = 1
                 MOVE SP-ACC-BREAK(ASTP) TO INDU-AMOUNT
              ELSE
                 SUBTRACT SP-ACC-BREAK(ASTP - 1) FROM
                           SP-ACC-BREAK(ASTP) GIVING INDU-AMOUNT.
           IF INDU-CURBAL > INDU-AMOUNT
              SUBTRACT INDU-AMOUNT FROM INDU-CURBAL
           ELSE
              MOVE INDU-CURBAL TO INDU-AMOUNT
              MOVE 0 TO INDU-CURBAL.
           COMPUTE INDU-WORKER ROUNDED =
             INDU-WORKER + (SP-ACC-RATE(ASTP) / 100) * INDU-AMOUNT.
           GO TO ACCEL-INT-LOOP.

      ******************************************
      * AT THIS POINT INDU-WORKER HOLDS THE
      * CALCULATED ANNUAL CHARGE, WHICH MUST BE
      * CONVERTED TO A DAILY CHARGE.
      * THE DAILY CHARGE IS COMPUTED BASED ON
      * THE VALUE OF INDU-INTMETHOD:
      *           "O" - ORDINARY INTEREST (360)
      *           "E" - EXACT    INTEREST (365)
      ******************************************
       INTEREST-DUE-FINAL.
           MOVE 360          TO INDU-WK.
           IF INDU-INTMETHOD = "E"
              MOVE 365       TO INDU-WK.
           MOVE ELAPSED-DAYS TO INDU-DAYS.
           COMPUTE INDU-INTEREST ROUNDED =
              (INDU-WORKER / INDU-WK) * ELAPSED-DAYS.
       INTEREST-DUE-EXIT.
           PERFORM INTEREST-DUE-PENALTY.
           PERFORM INTEREST-DUE-MINIMUM.
           PERFORM INTEREST-DUE-MAXIMUM.
           MOVE SPACES TO INDU-LPTRCD.

      **************************************************
       INTEREST-DUE-PENALTY SECTION.
      **************************************************

      * SPRING FINANCE PRE-PAYOFF PENALTY:
      * IF PAYOFF IS PRIOR TO MATURITY TAKE PENALTY:
      
           IF SP-RBSPOPT1(7) NOT = 5
              GO TO INTEREST-DUE-PENALTY-21.

           IF INDU-LPTRCD NOT = "PO"
              GO TO INTEREST-DUE-PENALTY-EXIT.

           PERFORM MATURITY-DATE-CALCULATION.
           MOVE INDU-DATE-2 TO NUM-DATE.
           MOVE MDTE-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS NOT > 0
              GO TO INTEREST-DUE-PENALTY-EXIT.

           PERFORM LOAN-CALCULATIONS.
           IF FINANCED-AMOUNT < 2000.01
              ADD 20.00 TO INDU-INTEREST
           ELSE
              IF FINANCED-AMOUNT < 5000.01
                 COMPUTE INDU-INTEREST ROUNDED =
                     INDU-INTEREST + FINANCED-AMOUNT * .01
              ELSE
                 ADD 100.00 TO INDU-INTEREST.
           GO TO INTEREST-DUE-PENALTY-EXIT.

       INTEREST-DUE-PENALTY-21.

      * THRIFT INVESTMENT CORP.

           IF SP-RBSPOPT1(7) NOT = 21
              GO TO INTEREST-DUE-PENALTY-MS.

           IF INDU-LPTRCD NOT = "PO"
              GO TO INTEREST-DUE-PENALTY-EXIT.

      * IF PREPAID WITHIN 12 MONTHS AFTER THE FIRST PAYMENT IS
      * IS DUE, YOU CAN CHARGE A PRE-PAYMENT PENALTY.

           MOVE LN-ORIG-1STPYDATE TO NUM-DATE.
           MOVE INDU-DATE-2 TO SYS-DATE
           PERFORM TIM365
           IF ELAPSED-MONTHS NOT < 12
              GO TO INTEREST-DUE-PENALTY-EXIT.

           IF INDU-ASSESS-PENALTY = "N"
              MOVE SPACES TO INDU-ASSESS-PENALTY
              GO TO NO-PENALTY-21.

           PERFORM LOAN-CALCULATIONS.
           IF FINANCED-AMOUNT < 2000.01
              ADD 20.00 TO INDU-INTEREST
           ELSE
              IF FINANCED-AMOUNT < 5000.01
                 COMPUTE INDU-INTEREST ROUNDED =
                     INDU-INTEREST + FINANCED-AMOUNT * .01
              ELSE
                 ADD 100.00 TO INDU-INTEREST.

           MOVE "N" TO INDU-ASSESS-PENALTY.

       NO-PENALTY-21.
           GO TO INTEREST-DUE-PENALTY-EXIT.

       INTEREST-DUE-PENALTY-MS.
           IF SP-RBREDUC(7) NOT = 9999.01
              GO TO INTEREST-DUE-PENALTY-NV.

      * 07/02/2018 MOVED A01-MS-PENALTY OUT OF REBATEW AND INTO LPRATEW AS
      *            INDU-A01-PENALTY, REMOVED CLEAR OF REB-MS-PENALTY
      *    MOVE 0 TO INDU-PENALTY A01-MS-PENALTY REB-MS-PENALTY.

           MOVE 0 TO INDU-PENALTY INDU-A01-PENALTY.

           IF NOT (INDU-LPTRCD = "PO" OR "PA")
              GO TO INTEREST-DUE-PENALTY-NV.

           IF INDU-ASSESS-PENALTY = "N"
              MOVE SPACES TO INDU-ASSESS-PENALTY
              GO TO NO-PENALTY-MS.

      * TEST IF WITHIN 5 YEARS
           MOVE LN-LOANDATE TO NUM-DATE
           MOVE INDU-DATE-2 TO SYS-DATE
           PERFORM TIM360
           IF ELAPSED-MONTHS < 0 OR > 60
              GO TO INTEREST-DUE-PENALTY-NV.

           IF ELAPSED-REM > 0
              ADD 1 TO ELAPSED-MONTHS.

           MOVE ELAPSED-MONTHS TO INDU-A01-ELAPSED-MO.
           MOVE INDU-DATE-2    TO INDU-A01-PAYDATE.
           MOVE 0              TO INDU-COMMON-REBATE.
           MOVE "CL/REBA01"    TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH INDU-COMMON LN-REC LTI-REC.
           CANCEL FORM-PROGX.

           MOVE INDU-A01-PENALTY TO INDU-PENALTY.

           COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                         + INDU-PENALTY.

           MOVE "N" TO INDU-ASSESS-PENALTY.

       NO-PENALTY-MS.
           GO TO INTEREST-DUE-PENALTY-EXIT.

      * NEVADA PRE-PAYOFF PENALTY, MERCURY ACTION SPRDER = 09:
      * IF PAYOFF IS PRIOR TO MATURITY TAKE $25.00 PENALTY:
      
       INTEREST-DUE-PENALTY-NV.
           IF SP-RBREDUC(7) NOT = 9999.02
              GO TO INTEREST-DUE-PENALTY-OH.

           IF INDU-LPTRCD = "PO"
              PERFORM MATURITY-DATE-CALCULATION
              MOVE MDTE-DATE TO NUM-DATE
              MOVE INDU-DATE-2 TO SYS-DATE
              IF SYS-DATE < NUM-DATE
                 ADD 25.00 TO INDU-INTEREST.
           GO TO INTEREST-DUE-PENALTY-EXIT.

      * OHIO PRE-PAYOFF PENALTY, REGENCY:
      *    IF PREPAID WITHIN 5 YEARS AND NOT RENEWED
      *       CHARGE PENALTY OF 1% OF AMOUNT FINANCED
      
       INTEREST-DUE-PENALTY-OH.
           IF SP-RBSPOPT1(7) NOT = 16
              GO TO INTEREST-DUE-PENALTY-GA.

           IF INDU-LPTRCD = "PO"
              IF INDU-ASSESS-PENALTY = "N"
                MOVE SPACES TO INDU-ASSESS-PENALTY
                GO TO NO-PENALTY-OH.

           IF INDU-LPTRCD = "PO"
                MOVE LN-LOANDATE TO NUM-DATE
                MOVE INDU-DATE-2 TO SYS-DATE
                PERFORM TIM360
                IF ELAPSED-DAYS NOT > 1800
                  PERFORM LOAN-CALCULATIONS
                  COMPUTE INDU-INTEREST ROUNDED =
                      INDU-INTEREST + ( FINANCED-AMOUNT * 0.01 )
                MOVE "N"   TO INDU-ASSESS-PENALTY.
       NO-PENALTY-OH.
           GO TO INTEREST-DUE-PENALTY-EXIT.

      * GEORGIA PRE-PAYOFF PENALTY, NEW SOUTH (REAL ESTATE)
      * IF PAYOFF IS PRIOR TO 4TH YEAR TAKE PENALTY:
      
       INTEREST-DUE-PENALTY-GA.
           IF SP-RBREDUC(7) NOT = 9999.03
              GO TO INTEREST-DUE-PENALTY-WI.

           IF INDU-LPTRCD = "PO"
              IF INDU-ASSESS-PENALTY = "N"
                 MOVE SPACES TO INDU-ASSESS-PENALTY
                 MOVE HOLD-INDU-PENALTY TO INDU-PENALTY
                 MOVE 0 TO HOLD-INDU-PENALTY
                 GO TO NO-PENALTY-GA.

           MOVE 0 TO INDU-PENALTY HOLD-INDU-PENALTY.
           IF INDU-LPTRCD = "PO"
              MOVE LN-LOANDATE TO NUM-DATE
              MOVE INDU-DATE-2 TO SYS-DATE
              PERFORM TIM360
              IF ELAPSED-MONTHS < 12
                 COMPUTE INDU-PENALTY ROUNDED =
                                      (INDU-CURBAL * 0.05)
              ELSE
              IF ELAPSED-MONTHS < 24
                 COMPUTE INDU-PENALTY ROUNDED =
                                      (INDU-CURBAL * 0.04)
              ELSE
              IF ELAPSED-MONTHS < 36
                 COMPUTE INDU-PENALTY ROUNDED =
                                      (INDU-CURBAL * 0.02).

           COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                         + INDU-PENALTY.

           MOVE "N" TO INDU-ASSESS-PENALTY.
           MOVE INDU-PENALTY TO HOLD-INDU-PENALTY.
       NO-PENALTY-GA.
           GO TO INTEREST-DUE-PENALTY-EXIT.

      * WISCONSIN PRE-PAYOFF PENALTY, WISCONSIN FINANCE (IB REAL ESTATE)
      * IF PAYOFF IS PRIOR TO 4TH YEAR TAKE PENALTY:
      
       INTEREST-DUE-PENALTY-WI.
           IF SP-RBREDUC(7) NOT = 9999.04
              GO TO INTEREST-DUE-PENALTY-NEWS.

           IF INDU-LPTRCD = "PO"
      * CALL SUBPROGRAM TO DETERMINE PENALTY:
              MOVE "X"         TO INDU-COMMON-RTNCD
              MOVE 0           TO INDU-A02-PENALTY
              MOVE INDU-DATE-2 TO INDU-A02-PAYDATE
              MOVE "CL/REBA02" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH INDU-COMMON LN-REC SP-REC
              CANCEL FORM-PROGX
              IF INDU-COMMON-RTNCD = " "
                 COMPUTE INDU-INTEREST ROUNDED =
                      INDU-INTEREST + INDU-A02-PENALTY
                 MOVE INDU-A02-PENALTY TO INDU-PENALTY.

           GO TO INTEREST-DUE-PENALTY-EXIT.

      * NEW SOUTH PRE-PAYOFF PENALTY, WISCONSIN FINANCE  ($75.00 FLAT)
      * IF PAYOFF OS PAID OFF ANY TIME PRIOR TO THE LAST THREE MONTHS OF
      *    THE LOAN
      *
      * NOTE: IN CALCULATING THE 3 MONTHS, THE LOANS ORIGINAL MATURITY DATE
      *       IS USED WITHOUT REGARD FOR DEFERMENTS OR ADDONS.
      
       INTEREST-DUE-PENALTY-NEWS.
           IF SP-RBREDUC(7) NOT = 9999.05
              GO TO INTEREST-DUE-PENALTY-NC.

           IF INDU-LPTRCD = "PO"
      * CALCULATE ORIGINAL MATURITY DATE
              MOVE "Y" TO MDTE-FLAG
                          MDTE-ORGTERM-FG
              PERFORM MATURITY-DATE-CALCULATION
      * CALCULATE DATE 3 MONTHS PRIOR TO MATURITY DATE
              MOVE MDTE-DATE TO NDTE-DATE
              MOVE -3        TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
      * TEST PAYOFF DATE < MATURITY - 3 MONTHS
      *   IF PAYOFF OCCURS MORE THAN 3 MONTHS FROM MATURITY
      *   THEN ADD A FLAT RATE OF $75.00 AS A PREPAYMENT PENALTY
              MOVE NDTE-DATE TO NUM-DATE
              MOVE RATE-DATE TO SYS-DATE
              IF SYS-DATE NOT > NUM-DATE
                 MOVE 75.00 TO INDU-PENALTY
                 COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                               + INDU-PENALTY.

           GO TO INTEREST-DUE-PENALTY-EXIT.

      * NORTH CAROLINA, PRE-PAYOFF PENALTY, CAROLINA FINANCE  (10% OR $25.00)
      * IF PAID OFF ANY TIME PRIOR TO MATURITY OF THE LOAN
      *
      * NOTE: THE LOANS ORIGINAL MATURITY DATE
      *       IS USED WITHOUT REGARD FOR DEFERMENTS OR ADDONS.
      
       INTEREST-DUE-PENALTY-NC.
           IF SP-RBREDUC(7) NOT = 9999.06
              GO TO INTEREST-DUE-PENALTY-25.

      * CALCULATE ORIGINAL MATURITY DATE
      
           IF INDU-LPTRCD = "PO"
              MOVE "Y" TO MDTE-FLAG
                          MDTE-ORGTERM-FG
              PERFORM MATURITY-DATE-CALCULATION
              MOVE MDTE-DATE TO NUM-DATE
              MOVE INDU-DATE-2 TO SYS-DATE
              IF SYS-DATE < NUM-DATE
                 COMPUTE INDU-PENALTY ROUNDED =
                    (INDU-CURBAL * .10)
                 IF INDU-PENALTY > 25.00
                    MOVE 25.00 TO INDU-PENALTY
                 END-IF
                 COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                               + INDU-PENALTY.

           GO TO INTEREST-DUE-PENALTY-EXIT.


      * OHIO STATE PREPAYMENT PENALTY (EFF 01-JAN-2007)
      *
      * IF ORIG PRIN <= 75K
      *    PENALTY IS 1% OF LOAN NET BAL IF PAID < 5 YEARS FROM LOAN DATE
      * IF ORIG PRIN  > 75K
      *    IF PAID <=1 YEAR FROM LOAN DATE
      *       PENALTY IS 2% OF LOAN NET BAL
      *    IF PAID > 1  AND <= 2 YEARS FROM LOAN DATE
      *       PENALTY IS 1% OF LOAN NET BAL
      *    IF PAID > 2 YEARS FROM LOAN DATE
      *       NO PENALTY
      *
      * NOTES:
      *    PENALTY IS NOT CHARGED ON RENEWALS.
      *    PENALTY IS ADDED TO THE INTEREST DUE ON PAYOFF.
      
       INTEREST-DUE-PENALTY-25.
           IF SP-RBSPOPT1(7) NOT = 25
              GO TO INTEREST-DUE-PENALTY-EXIT.

           IF INDU-LPTRCD = "PO"
              IF INDU-ASSESS-PENALTY ="N"
                 MOVE SPACES TO INDU-ASSESS-PENALTY
                 GO TO NO-PENALTY-25.

           IF INDU-LPTRCD = "PO"
              PERFORM LOAN-CALCULATIONS
              IF FINANCED-AMOUNT <= 75000
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE RATE-DATE TO SYS-DATE
                 PERFORM TIM360
                 IF ELAPSED-DAYS NOT > 1800
                    COMPUTE INDU-PENALTY = ( LN-CURBAL * 0.01 )
                    COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                                  + INDU-PENALTY
                 END-IF
              ELSE
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE RATE-DATE TO SYS-DATE
                 PERFORM TIM360
                 IF ELAPSED-DAYS NOT > 360
                    COMPUTE INDU-PENALTY = ( LN-CURBAL * 0.02 )
                    COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                                  + INDU-PENALTY
                 ELSE IF ELAPSED-DAYS > 360 AND NOT > 720
                    COMPUTE INDU-PENALTY = ( LN-CURBAL * 0.01 )
                    COMPUTE INDU-INTEREST ROUNDED = INDU-INTEREST
                                                  + INDU-PENALTY
                 ELSE
                    MOVE 0 TO INDU-PENALTY.

           MOVE "N" TO INDU-ASSESS-PENALTY.

       NO-PENALTY-25.
           GO TO INTEREST-DUE-PENALTY-EXIT.

       INTEREST-DUE-PENALTY-EXIT.
           EXIT.

      ****************************************************
       INTEREST-DUE-SPECIAL-OPTIONS SECTION.
      ****************************************************
           IF INDU-LPTRCD = "PB" OR "RN" OR "RB" OR "RO"
              IF SP-RBSPOPT1(7) = 1 OR 19
                 IF ELAPSED-DAYS > 60
                    MOVE 60 TO ELAPSED-DAYS
                 ELSE
                    NEXT SENTENCE
              ELSE
              IF SP-RBSPOPT1(7) = 9
                 IF ELAPSED-DAYS > 90
                    MOVE 90 TO ELAPSED-DAYS.

      * SPRING FINANCE:
           IF SP-RBSPOPT2(7) = 2
              IF INDU-LPTRCD = "PB" OR "RN" OR "SC" OR "PO"
                                  OR "RB" OR "RO"
                 ADD 1 TO ELAPSED-DAYS.

      * CALCULATE MAX ACCRUED INT FOR IB ACCRUAL REPORT
      * NOTE: 999 = NO MAXIMUM
           IF ( INDU-MAX-ACCRUE = 1 AND SP-MAX-IB-ACR-DAYS NOT = 0 )
              IF ( SP-MAX-IB-ACR-DAYS NOT = 999 )
                 IF ( ELAPSED-DAYS > SP-MAX-IB-ACR-DAYS )
                    MOVE SP-MAX-IB-ACR-DAYS TO ELAPSED-DAYS.

      **************************************************
       INTEREST-DUE-MINIMUM SECTION.
      **************************************************
      * PACESETTER FINANCE:
           IF SP-RBSPOPT1(7) = 8
              IF INDU-LPTRCD = "PB" OR "RN" OR "SC" OR "PO"
                                  OR "RB" OR "RO"
                 ADD INDU-INTEREST LN-TOTINT LN-INTBAL GIVING
                                                     INDU-AMOUNT
                 IF INDU-AMOUNT < SP-RBMINRET(7)
                    COMPUTE INDU-INTEREST = INDU-INTEREST +
                       (SP-RBMINRET(7) - INDU-AMOUNT).

      **************************************************
       INTEREST-DUE-MAXIMUM SECTION.
      **************************************************
      * INSTANT AUTO #1047:
           IF SP-CAL-MAX-AT-ESTIMATE = "Y"
              IF (INDU-INTEREST + LN-TOTINT) > LN-INTCHG
                 COMPUTE INDU-INTEREST = LN-INTCHG - LN-TOTINT.

      *********************************
      *    SET THE PROPER RATE TABLE
      *    CTBL = 1 OR 2
      *********************************
       SELECT-SPR-TABLE SECTION.
           PERFORM LOAN-CALCULATIONS.
           MOVE INT-CHARGEABLE TO CTBL-INT-CHARGEABLE.
           MOVE LN-ORGTERM     TO CTBL-TERM.
           PERFORM SETCTBL.
           MOVE CTBL-INDEX TO CTBL.

      ******************************************************
      *    GET ALL INSURANCE PREMIUMS
      ******************************************************
       INDU-GET-ALL-INSPREM SECTION.
           MOVE 0 TO INDU-ALL-INSPREM.
           IF LN-INSOURS(1) NOT = "M"
              ADD LN-INSPREM(1) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(2) NOT = "M"
              ADD LN-INSPREM(2) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(3) NOT = "M"
              ADD LN-INSPREM(3) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(4) NOT = "M"
              ADD LN-INSPREM(4) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(5) NOT = "M"
              ADD LN-INSPREM(5) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(6) NOT = "M"
              ADD LN-INSPREM(6) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(7) NOT = "M"
              ADD LN-INSPREM(7) TO INDU-ALL-INSPREM.
           IF LN-INSOURS(8) NOT = "M"
              ADD LN-INSPREM(8) TO INDU-ALL-INSPREM.
       INDU-GET-ALL-INSPREM-EXIT.
           EXIT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPRATE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPXDTE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPXDTE
      **************************************************************
      *         EXPIRATION DATE CALCULATION
      *
      *   NAME: LPXDTE
      *   DESC: COMPUTES THE EXPIRATION DATE OF THE LOAN.
      *   IN  :
      *   OUT : XDTE-DATE
      *   USED: SP-EXREDFAC, SP-EXPD-FRMLA
      *   COPY: LPXDTEW, LPNDTE, LPNDTEW, LPMDTE, LPMDTEW.
      *
      * REV:
      *  JTG 032188 ADDED LOGIC FOR OPTIONAL EXPIRATION
      *             DATES VIA. SP-EXPD-FRMLA
      *  SLC 042888 TOOK OUT OPTION FOR SP-EXPD-FRMLA = "B".
      *             ADDED LOGIC TO INCLUDE EXP. DAYS.
      *  JTG 071896 CHANGED TO WORK WITH NEW DATE ROUTINES
      *  BAH 050218 ADDED SP-EXPD-FRMLA = "B", LENDMARK PL# 463
      *             DONT ALLOW DUE DATE CHANGES TO AFFECT MATURITY
      **************************************************************
       EXPIRATION-DATE-CALCULATION SECTION.
           IF SP-EXPD-FRMLA = "A" OR "B"
              MOVE "Y" TO MDTE-FLAG.
           IF SP-EXPD-FRMLA = "B"
              MOVE "Y" TO MDTE-DC-FLAG.

           PERFORM MATURITY-DATE-CALCULATION.
           MOVE MDTE-DATE TO NDTE-DATE.
           MOVE SP-EXPD-MONTHS TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.

           IF SP-EXPD-DAYS NOT = 0
              MOVE SP-EXPD-DAYS TO NDTE-HOLD
              PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE TO XDTE-DATE.
      *================================================================*
      * END COPYBOOK: LIBLP\LPXDTE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCAS.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCAS
      **********************************************************************
      *         LATE CHARGE ASSESS ROUTINE
      *
      *   NAME: LPLCAS
      *   DESC: THIS ROUTINE TESTS, BASED ON THE PAYDATE,
      *         IF LATE CHARGES SHOULD BE ASSESSED. IT
      *         CONSIDERS GRACE DAYS AND CURRENT LATE
      *         CHARGE PAID THRU.
      *   IN  : LCAS-PAYDATE       (LP-PAYDATE)
      *         LCAS-1STPYDATE     (LN-1STPYDATE)
      *         LCAS-LCPDTH-DATE        (LN-LCPDTH)
      *   OUT : LCAS-ASSESS        ("Y" OR " ")
      *         LCAS-ELAPSED-DAYS
      *         LCAS-GRACE-DATE
      *   USED: LN-ORGTERM, LN-DEFMNTS
      *   COPY: LPMDTEW, LPNDTE, LPNDTEW, TIMALL, JUL, CJUL.
      * REV:
      *  SLC 090889 EXTENDED LAST GRACE DAY TO NEXT BUSINESS DAY
      *             IF IT FALLS ON SATURDAY, SUNDAY, OR A HOLIDAY
      *             FROM THE HOLIDAY TABLE IN THE GLOBAL.
      *  SLC 121289 ADDED ON OVERFLOW CHECK WHEN CALLING GLOBRD.
      *  JTG 120590 ADDED OUTPUT OF LCAS-ELAPSED-DAYS
      *  JTG 060592 ADDED LOGIC FOR LN-LC-CODE (ROSE SHANIS)
      *  JTG 080795 CORRECTED FOR HOLIDAY/WEEKEND TEST NEVER ENDING LOOP
      *  JTG 071696 ADDED LOGIC FOR UNIT PERIODS
      *  JTG 103096 CHANGED TEST ON LN-LC-CODEX TO TEST FOR "00", WHICH
      *             SHOULD ELIMINATE UNNECESSARY IO ON EL-FILE
      *  JTG 030497 CHANGED TO CORRECT, DUE DAY = 30TH & LCPDTH = 02289X
      *             CAUSING NEXT DUE TO BE 032897 AND NOT 033097
      *  JTG 122198 ADDED LOGIC TO RETURN LCAS-GRACE-DATE, REGENCY REVOLVING
      *  JTG 990121 CORRECTED LOGIC TO RETURN LCAS-GRACE-DATE, REGENCY REVOLVING
      * KEC 190219 A32 FFR - REMOVED REDEFINE FOR LN-LC-CODEX; UNUSED
      * BAH 20220818 REMOVED CALL TO GLOBRD, EACH PROGRAM WILL READ GBFILE NOW
      **************************************************************************
      *******************************************
       LATE-ASSESS-ROUTINE SECTION.
      *******************************************
           MOVE " " TO LCAS-ASSESS.
           MOVE 0 TO LCAS-ELAPSED-DAYS
                     LCAS-GRACE-DATE.

           IF LCAS-1STPYDATE = 0
                      OR LCAS-PAYDATE = 0
              GO TO LATE-ASSESS-EXIT.

           IF SP-LCUNITPER-CD = "A"
              MOVE LN-UNITPER-CD TO UPWK-UNITPER-CD
              MOVE LN-UNITPER-FREQ TO UPWK-UNITPER-FREQ
              PERFORM UPWK-LC-CALC
              COMPUTE LCAS-LCGRACE =
                   SP-LCGRACE * UPWK-LC-GRACE-FAC * .01
           ELSE
              MOVE SP-LCGRACE TO LCAS-LCGRACE.

           IF ( LN-LC-CODE NOT = ZEROES )
              PERFORM LATE-CHARGE-TEST-ELREAD.

      * SETUP NEXT PAYMENT DUE DATE:
           MOVE LCAS-LCPDTH-DATE TO NDTE-DATE
                               NUM-DATE.

      * ADDED TO CORRECTED DUE DAY = 30, LCPDTH = 02289X
           IF (LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1)
              IF (NDTE-DD < LN-1STPYDA)
                 MOVE LN-1STPYDA TO NDTE-DD.
      * ADDED TO CORRECTED DUE DAY = 30, LCPDTH = 02289X

           MOVE 1 TO NDTE-HOLD.
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
      * WHEN SEMI MONTHLY WITH FIRST PAYDATE OF 14TH OR 15TH,
      *      THE INCREMENT OF LCPDTH WILL GO TO 02/28/YY OR 02/29/YY
      *      WHEN LCPDTH WAS INCREMENTED FROM 02/14/YY OR 02/15/YY.
      *      NOW TO DETERMINE INTERNALLY IF THE PAYMENT IS LATE
      *      WE NEED TO SET LCPDTH BACK TO 03/14 OR 03/15
           IF LN-UNITPER-CD = "S"
              IF LN-1STPYDA = 14 OR 15
                 IF (NUM-DA = 28 OR 29) AND NDTE-MM = 03
                    MOVE LN-1STPYDA TO NDTE-DD.

      * TEST IF PAYDATE IS OVER GRACE PERIOD:
           MOVE NDTE-DATE TO NUM-DATE.
           MOVE LCAS-PAYDATE TO SYS-DATE.
           MOVE SP-LCYRTYPE TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           MOVE ELAPSED-DAYS TO LCAS-ELAPSED-DAYS.

      * THIS ROUTINE REQUIRES NDTE-DATE IN AND RETURNS NUM-DATE:
           PERFORM LCAS-GET-GRACE-DATE.

           IF LN-CURBAL NOT = 0
              IF LCAS-ELAPSED-DAYS > LCAS-LCGRACE
                 MOVE LCAS-PAYDATE TO SYS-DATE
                 IF SYS-DATE > NUM-DATE
                    MOVE "Y" TO LCAS-ASSESS.

       LATE-ASSESS-EXIT.
           EXIT.

      *******************************************
       LCAS-GET-GRACE-DATE SECTION.
      *******************************************
           PERFORM LCAS-FIND-LAST-GRACE-DAY.
           MOVE 1 TO LCAS-HOLIDAY-FLAG.
           PERFORM LCAS-CHECK-EXTENDING-GRACE
               UNTIL LCAS-HOLIDAY-FLAG = 0.
           MOVE NUM-DATE TO LCAS-GRACE-DATE.

      *******************************************
       LCAS-FIND-LAST-GRACE-DAY SECTION.
      *******************************************
           MOVE NUM-MO TO ALP-MO.
           MOVE NUM-YR TO ALP-YR.

           MOVE LCAS-LCGRACE TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE TO NUM-DATE.
           PERFORM LCAS-ADJUST-FOR-MONTH-END.

       LCAS-FIND-LAST-GRACE-DAY-EXIT.
           EXIT.

      *******************************************
       LCAS-ADJUST-FOR-MONTH-END SECTION.
      *******************************************
           DIVIDE ALP-YR BY 4 GIVING LCAS-HOLIDAY-FLAG
                                           REMAINDER LCAS-SUB.
           MOVE 0 TO NDTE-HOLD.
           IF ALP-MO NOT = NDTE-MM
              IF (SP-LCYRTYPE = 358 OR 360)
                      AND (ALP-MO = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12)
                 MOVE 1 TO NDTE-HOLD
              ELSE
                 IF SP-LCYRTYPE = 360 AND ALP-MO = 2
                    IF LCAS-SUB NOT = 0
                       MOVE -2 TO NDTE-HOLD
                    ELSE
                       MOVE -1 TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.

      ********************************************
       LCAS-CHECK-EXTENDING-GRACE SECTION.
      ********************************************
           MOVE 0 TO LCAS-HOLIDAY-FLAG.
           IF SP-LCGRACECD = "S" OR "W"
              MOVE 1 TO LCAS-SUB
              PERFORM LCAS-CHECK-HOLIDAY
                 UNTIL LCAS-SUB > 16
                        OR GB-HOLIDAY(LCAS-SUB) = 0
              PERFORM LCAS-CHECK-DAY.

      ********************************************
       LCAS-CHECK-HOLIDAY SECTION.
      ********************************************
           MOVE NDTE-DATE TO LCAS-WKDATE.
           IF GB-HOLIDAY(LCAS-SUB) = LCAS-WKMMDD
              MOVE 1 TO LCAS-HOLIDAY-FLAG
              MOVE 1 TO NDTE-HOLD
              PERFORM INCREMENT-DAYS.
           ADD 1 TO LCAS-SUB.

      **************************************
       LCAS-CHECK-DAY SECTION.
      **************************************

      * CHECK FOR SATURDAY OR SUNDAY:

           MOVE NDTE-DATE TO NUM-DATE.
           PERFORM WEEKDAY.
           IF (SP-LCGRACECD = "W"
                          AND DAY-IS-SAT)
              MOVE 1 TO LCAS-HOLIDAY-FLAG
              MOVE 2 TO NDTE-HOLD
              PERFORM INCREMENT-DAYS
           ELSE
              IF (SP-LCGRACECD = "W" OR "S")
                                      AND DAY-IS-SUN
                 MOVE 1 TO LCAS-HOLIDAY-FLAG
                 MOVE 1 TO NDTE-HOLD
                 PERFORM INCREMENT-DAYS.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLCAS.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\SPPDTH.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/SPPDTH
      ************************************************************************
      *         CONTRACTUAL PAID THRU CALCULATION
      *
      *   NAME: SPPDTH
      *   DESC: ROUTINE COMPUTES CONTRACTUAL PAID THRU
      *         TAKING INTO ACCOUNT ODD PAYMENT DUE,
      *         AND OPTIONAL PAYMENT SCHEDULE,
      *         AND DEFERMENTS + ALLOWABLE DELINQUENCY.
      *
      *      N O T E:
      *              IF PDTH-DEF-FG NOT = " " THE ROUTINE WILL
      *                 N O T  INCLUDE LN-TOTNODEF IN THE CALCULATION.
      *
      *              IF PDTH-ALDEL-FG NOT = " " THE ROUTINE WILL
      *                 N O T  INCLUDE LN-TOTNOALDEL IN THE CALCULATION.
      *
      *
      *   IN  : PDTH-DATE-WORK      LN-1STPYDATE
      *         PDTH-DEF-FG         ---> OPTIONAL
      *         PDTH-ALDEL-FG       ---> OPTIONAL
      *   OUT : PDTH-DATE           (MMYY) OR (MMDD)
      *         PDTH-LCPDTHRU
      *         PDTH-DATE-FULL      (MMDDYY)
      *         PDTH-PAYS           NO OF FULL PAYMENTS MADE
      *         PDTH-REMAIN         DECIMAL PORTION OF NO. OF PAYMENTS MADE
      *         PDTH-AMT-TO-ADVANCE THE AMOUNT NEEDED TO ADVANCE PDTH
      *
      *         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *         S E E  EXAMPLE THAT FOLLOWS
      *         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *         PDTH-CUR-SCHD-PAY   RETURNS NEXT SCHEDULED PAYMENT AMOUNT
      *                             AND IF PAYMENT IS PARTIALLY PAID,
      *                             IT IS RETURNED
      *         PDTH-CUR-SCHD-DATE  RETURNS PDTH-CUR-SCHD-PAY PAYMENT DUE DATE
      *
      *         PDTH-NXT-SCHD-PAY   RETURNS NEXT SCHEDULED PAYMENT AMOUNT
      *                             AND IF PAYMENT IS PARTIALLY PAID,
      *                             IT IS SKIPPED
      *         PDTH-NXT-SCHD-DATE  RETURNS PDTH-NXT-SCHD-PAY DUE DATE
      *         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *         LOAN DATE      :  06/01/03
      *         FIRST PAY DATE :  07/01/03
      *         LOAN AMOUNT    :              $1200.00
      *         FINANCE CHARGE :                200.00
      *         PROCEEDS       :               1000.00
      *                                        -------
      *         SCHEDULE OF PAY:  07/01/03      160.00
      *                           08/01/03      170.00
      *                           09/01/03      180.00
      *                           10/01/03      190.00
      *                           11/01/03      200.00
      *                           12/01/03      300.00
      *                                        -------
      *                           TOTAL PAYS   1200.00
      *
      *         LN-TOTPAYMNTD     :  $150.00**
      *
      *         SP-CONTPDTH %     :  100%                 93%
      *   NEEDED TO ADVANCE PDTH  :  $160.00 @ 100%       $148.80 @ 93%
      *
      *         PDTH-DATE-FULL    :  06/01/03             07/01/03
      *
      *         PDTH-CUR-SCHD-PAY :  $160.00              $160.00
      *         PDTH-CUR-SCHD-DATE:  07/01/03             08/01/03
      *
      *         PDTH-NXT-SCHD-PAY :  $170.00              $170.00
      *         PDTH-NXT-SCHD-DATE:  08/01/03             08/01/03
      *
      *
      *   COPY: SPPDTHW, LPNDTE, LPNDTEW, INCRMM
      * REV :
      *  JTG 040590 ALLOWED LN-TOTNOALDEL TO BE INCLUDED IN CALCULATING
      *             PAID THRU
      *  JTG 080690 ADDED LOGIC FOR ADDON INSURANCE
      *  SLC 090690 ADDED PDTH-CUR-SCHD-PAY CURRENT SCHEDULED PAYMENT.
      *  BAH 040991 IF PAYMNTD > ODD, PAID THRU WAS NOT ADVANCING
      *  BAH 021992 IF PAYMNTD = 1STPYAMT, 1STPYAMT STILL GETTING SET
      *             IN PDTH-CUR-SCHD-PAY
      *  JTG 070292 CHANGED TO SET PDTH-NXT-SCHD-PAY,
      *                            PDTH-NXT-SCHD-DATE, RE: DEFERMENT TN ADDONS
      *  JTG 072192 ALLOWED RETURN OF PDTH-PAYS AND PDTH-REMAIN
      *  JTG 100992 CORRECTED SET NDTE-HOLD
      *  JTG 030293 CHANGED PAID-THRU-CALC-ADDON SECTION
      *                              AND PAID-THRU-ADDON-SUM SECTION
      *             TO WORK FOR LT-SCHLD-TERM OCCURING 17 TIMES
      *  JTG 032892 ADDED LOGIC FOR UNIT PERIODS
      *  JTG 052493 ADDED LOGIC FOR BALLOONS
      *  JTG 092993 FIXED PROBLEM WITH NORMAL ROUTINE RETURNING PDTH-PAYMENTS
      *  JTG 090294 FIXED PROBLEM WITH NORMAL ROUTINE, WHEN ACCOUNT HAS PAID
      *             MORE THAN THE 1ST AND REG PAYMENTS, RETURNING PDTH-PAYMENTS
      *  JTG 092394 FIXED PROBLEM WITH NORMAL ROUTINE, WHEN ACCOUNT HAS PAID
      *             MORE THAN THE 1ST AND REG PAYMENTS, RETURNING PDTH-PAID THRU
      *             WHICH GOT SCREWED UP RE: FIX ON 090294
      *  JTG 082995 ADDED LOGIC FOR PDTH-DEF-FG, MERCURY SP-ERNFRMLA 61
      *  JTG 041596 ADDED PDTH-CUR-SCHD-DATE
      *  BAH 052797 DISPLAY ACCTNO BEFORE IO-ERROR ON GET-LT-P-REC
      *  JTG 101598 MODIFIED TO WORK FOR REVOLVING ACCOUNTS, REGENCY REVOL
      *  JTG 990124 ADDED COPY STATEMENT FOR LIBLP/RVPMTDUE/W
      *  JTG 000329 ADDED GP-PDTH-GT-SCHED-PAY CHANGED PAID-THRU-CALC-NORMAL
      *             TO NOT EXCEED NO. OF SCHEDULED PAYMENTS      MERCURY #J001
      *  JTG 021111 ADDED PDTH-AMT-TO-ADVANCE                     REGACC #0008
      *  JTG 040517 CORRECTED CALCULATION OF PDTH-AMT-TO-ADVANCE.
      *             WHEN SP-CONTPDTH = 100% (WHICH INDICATES A FULL PAYMENT
      *             MUST BE RECEIVED), DON'T NEED TO ADD 0.01
      *             SINCE PDTH-CUR-SCHD-PAY * (100/100 - PDTH-REMAIN)
      *             YIELDS THE AMOUNT TO PAY A FULL PAYMENT
      *                                                   REGACC LENDMARK #J008
      *  MJD 090219 TESTING CHANGES FOR A NEW BANKRULE ******************
      *  BAH 160113 SPLIT OUT LTFILE, LTPFILE, RENAMED LT- TO LTP-, PD0003
      *  BLM 160615 FIXED PAID-THRU-CALCULATION-REVOL TO CALL GETLTR SINCE
      *             REVOLVING FIELDS ARE IN LTRFILE, NOT LNFILE, PD0003
      * KEC 2016.1116 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED LTR-SEQNO TO LTR1-KEY.
      * BLM 170309 FIX FOR NEW FORMATS OF PDTH-WK-DATE (CCYYMMDD), 
      *            PDTH-DATE(CCYYMM), PD0006
      * BAH 170317 CHANGED PDTH-DATE (CCYYMM) BACK TO YYMM
      * BAH 190211 REMOVED REVOLVING
      * BAH 2024.0321 REMOVED PDTH-CREDIT, NOT USED
      **************************************************************************
       PAID-THRU-CALCULATION SECTION.
           MOVE 0 TO PDTH-DATE           PDTH-DATE-FULL
                     PDTH-LCPDTHRU       PDTH-PAYMENTS
                     PDTH-AMT-TO-ADVANCE
                     PDTH-CUR-SCHD-PAY   PDTH-CUR-SCHD-DATE
                     PDTH-NXT-SCHD-PAY   PDTH-NXT-SCHD-DATE
                     NDTE-HOLD.

           MOVE LN-TOTPAYMNTD TO PDTH-PAYMNTD.

           IF LN-PAY-SCHLD-FG = "Y"
              PERFORM PAID-THRU-CALC-ADDON
           ELSE
              IF PDTH-E-OPTION = "E"
                 PERFORM PAID-THRU-CALC-NORMAL-E
              ELSE
                 PERFORM PAID-THRU-CALC-NORMAL.

           IF PDTH-DEF-FG = " "
              ADD LN-TOTNODEF   TO NDTE-HOLD.
           IF PDTH-ALDEL-FG = " "
              ADD LN-TOTNOALDEL TO NDTE-HOLD.
           COMPUTE NDTE-HOLD ROUNDED = NDTE-HOLD - 1 + PDTH-PAYS.

           COMPUTE PDTH-LCPDTHRU ROUNDED = SP-CONTPDTH / 100.
           IF PDTH-REMAIN > PDTH-LCPDTHRU
              ADD 1 TO NDTE-HOLD.
           MOVE PDTH-DATE-WORK  TO NDTE-DATE.
           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE       TO PDTH-DATE-FULL.

      * DETERMINE AMOUNT NEEDED TO ADVANCE PDTH
      
           IF PDTH-REMAIN > PDTH-LCPDTHRU
              COMPUTE PDTH-AMT-TO-ADVANCE =
                 (1 - PDTH-REMAIN) * PDTH-CUR-SCHD-PAY
                    + PDTH-NXT-SCHD-PAY * SP-CONTPDTH / 100
              ADD 0.01 TO PDTH-AMT-TO-ADVANCE
           ELSE
              COMPUTE PDTH-AMT-TO-ADVANCE =
                 PDTH-CUR-SCHD-PAY
                     * (SP-CONTPDTH / 100 - PDTH-REMAIN)
              IF SP-CONTPDTH < 100
                 ADD 0.01 TO PDTH-AMT-TO-ADVANCE.
    
           MOVE NDTE-MM         TO PDTH-MM.
           IF LN-UNITPER-CD-DAYS
              MOVE NDTE-DD      TO PDTH-DDYY
           ELSE
              MOVE NDTE-YY      TO PDTH-YY.

           MOVE 1               TO NDTE-HOLD.
           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE       TO PDTH-CUR-SCHD-DATE
                                   PDTH-NXT-SCHD-DATE.
           IF PDTH-REMAIN NOT > PDTH-LCPDTHRU
              IF PDTH-REMAIN > 0
                 MOVE 1               TO NDTE-HOLD
                 MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD
                 MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
                 PERFORM INCREMENT-UNITPER
                 MOVE NDTE-DATE       TO PDTH-NXT-SCHD-DATE.

       PAID-THRU-CALCULATION-EXIT.
           MOVE " " TO PDTH-DEF-FG
                       PDTH-ALDEL-FG
                       PDTH-E-OPTION.

      *---------------------------------------------------------
      *  EXAMPLE:
      *                       TERM = 1     TERM = 2     TERM = 6
      *                     -----------  -----------  -----------
      *   LN-1STPYAMT    :  $100.00      $100.00      $100.00
      *   LN-REGPYAMT    :  $100.00 X 0  $120.00 X 0  $120.00 X 4
      *   LN-LASTPYAMT   :  $  0.00      $120.00      $130.00
      *                      ------       ------       ------
      *      TOTAL REPAY :  $100.00      $220.00      $710.00
      *---------------------------------------------------------
       PAID-THRU-CALC-NORMAL SECTION.
           IF PDTH-PAYMNTD < LN-1STPYAMT
              COMPUTE PDTH-PAYMENTS ROUNDED =
                               PDTH-PAYMNTD / LN-1STPYAMT
              MOVE LN-1STPYAMT TO PDTH-CUR-SCHD-PAY
              MOVE LN-REGPYAMT TO PDTH-NXT-SCHD-PAY
              GO TO PAID-THRU-CALC-NORMAL-EXIT.

           SUBTRACT LN-1STPYAMT FROM PDTH-PAYMNTD.
           MOVE 1 TO PDTH-PAYMENTS.

           IF LN-NOREGPY = 0
              COMPUTE PDTH-PAYMENTS ROUNDED =
                  PDTH-PAYMENTS + PDTH-PAYMNTD / LN-REGPYAMT
              MOVE LN-REGPYAMT TO PDTH-CUR-SCHD-PAY
                                  PDTH-NXT-SCHD-PAY
           ELSE
           IF PDTH-PAYMNTD >= (LN-NOREGPY * LN-REGPYAMT)
              IF GP-PDTH-GT-SCHED-PAY = "Y"
                 COMPUTE PDTH-PAYMENTS = PDTH-PAYMENTS + LN-NOREGPY
                 IF (PDTH-PAYMNTD - (LN-NOREGPY * LN-REGPYAMT))
                                                 >= LN-LASTPYAMT
                    ADD 1 TO PDTH-PAYMENTS
                 ELSE
                    COMPUTE PDTH-PAYMENTS ROUNDED = PDTH-PAYMENTS
                        + (PDTH-PAYMNTD - (LN-NOREGPY * LN-REGPYAMT))
                                   / LN-LASTPYAMT
                 END-IF
              ELSE
                 COMPUTE PDTH-PAYMENTS ROUNDED =
                     PDTH-PAYMENTS + LN-NOREGPY
                       + (PDTH-PAYMNTD - (LN-NOREGPY * LN-REGPYAMT))
                                                / LN-LASTPYAMT
              END-IF
              MOVE LN-LASTPYAMT TO PDTH-CUR-SCHD-PAY
                                   PDTH-NXT-SCHD-PAY
           ELSE
              COMPUTE PDTH-PAYMENTS ROUNDED =
                 PDTH-PAYMENTS + PDTH-PAYMNTD / LN-REGPYAMT
              MOVE LN-REGPYAMT TO PDTH-CUR-SCHD-PAY
              IF PDTH-PAYMENTS > LN-NOREGPY
                 MOVE LN-LASTPYAMT TO PDTH-NXT-SCHD-PAY
              ELSE
                 MOVE LN-REGPYAMT  TO PDTH-NXT-SCHD-PAY.

       PAID-THRU-CALC-NORMAL-EXIT.
           EXIT.

       PAID-THRU-CALC-NORMAL-E SECTION.
           COMPUTE PDTH-E-1STPYAMT ROUNDED =
                        ((LN-1STPYAMT * SP-BANKRULE-RATE)/100).
           COMPUTE PDTH-E-REGPYAMT ROUNDED =
                        ((LN-REGPYAMT * SP-BANKRULE-RATE)/100).
           COMPUTE PDTH-E-LASTPYAMT ROUNDED =
                        ((LN-LASTPYAMT * SP-BANKRULE-RATE)/100).

           IF PDTH-PAYMNTD < PDTH-E-1STPYAMT
              COMPUTE PDTH-PAYMENTS ROUNDED =
                               PDTH-PAYMNTD / PDTH-E-1STPYAMT
              MOVE PDTH-E-1STPYAMT TO PDTH-CUR-SCHD-PAY
              MOVE PDTH-E-REGPYAMT TO PDTH-NXT-SCHD-PAY
              GO TO PAID-THRU-CALC-NORMAL-E-EXIT.

           SUBTRACT PDTH-E-1STPYAMT FROM PDTH-PAYMNTD.
           MOVE 1 TO PDTH-PAYMENTS.

           IF LN-NOREGPY = 0
              COMPUTE PDTH-PAYMENTS ROUNDED =
                  PDTH-PAYMENTS + PDTH-PAYMNTD / PDTH-E-REGPYAMT
              MOVE PDTH-E-REGPYAMT TO PDTH-CUR-SCHD-PAY
                                  PDTH-NXT-SCHD-PAY
           ELSE
           IF PDTH-PAYMNTD >= (LN-NOREGPY * PDTH-E-REGPYAMT)
              IF GP-PDTH-GT-SCHED-PAY = "Y"
                 COMPUTE PDTH-PAYMENTS = PDTH-PAYMENTS + LN-NOREGPY
                 IF (PDTH-PAYMNTD - (LN-NOREGPY * PDTH-E-REGPYAMT))
                                                 >= PDTH-E-LASTPYAMT
                    ADD 1 TO PDTH-PAYMENTS
                 ELSE
                    COMPUTE PDTH-PAYMENTS ROUNDED = PDTH-PAYMENTS
                        + (PDTH-PAYMNTD
                        - (LN-NOREGPY * PDTH-E-REGPYAMT))
                                   / PDTH-E-LASTPYAMT
                 END-IF
              ELSE
                 COMPUTE PDTH-PAYMENTS ROUNDED =
                     PDTH-PAYMENTS + LN-NOREGPY
                       + (PDTH-PAYMNTD
                       - (LN-NOREGPY * PDTH-E-REGPYAMT))
                                                / PDTH-E-LASTPYAMT
              END-IF
              MOVE PDTH-E-LASTPYAMT TO PDTH-CUR-SCHD-PAY
                                   PDTH-NXT-SCHD-PAY
           ELSE
              COMPUTE PDTH-PAYMENTS ROUNDED =
                 PDTH-PAYMENTS + PDTH-PAYMNTD / PDTH-E-REGPYAMT
              MOVE LN-REGPYAMT TO PDTH-CUR-SCHD-PAY
              IF PDTH-PAYMENTS > LN-NOREGPY
                 MOVE PDTH-E-LASTPYAMT TO PDTH-NXT-SCHD-PAY
              ELSE
                 MOVE PDTH-E-REGPYAMT  TO PDTH-NXT-SCHD-PAY.

       PAID-THRU-CALC-NORMAL-E-EXIT.
           EXIT.
      *---------------------------------------------------------
      *    PAID THRU CALCULATION  (ADDON'S)
      *---------------------------------------------------------
      *
      * PAID THRU IS CAPPED AT MATURITY ON PAYMENT SCHEDULES !!
      *
      *---------------------------------------------------------
       PAID-THRU-CALC-ADDON SECTION.
           PERFORM GET-LT-P-REC.
           IF IO-FG = 9
              STRING LN1-KEY,"-","MISSING PAYMENT SCHEDULE"
                 DELIMITED BY "  " INTO MESS
              PERFORM SEND-MESS
              GO TO IO-ERROR
           ELSE
              MOVE LTP-SCHLD-PAYMNT(1) TO PDTH-CUR-SCHD-PAY
                                          PDTH-NXT-SCHD-PAY
              MOVE 1 TO PDTH
              PERFORM PAID-THRU-ADDON-SUM
                 UNTIL PDTH > 17 OR PDTH-PAYMNTD = 0.
           MOVE NDTE-HOLD TO PDTH-PAYS.
           MOVE 0 TO NDTE-HOLD.

       PAID-THRU-ADDON-SUM SECTION.
           IF LTP-SCHLD-TERM(PDTH) = 0
              MOVE 17 TO PDTH
              GO TO PAID-THRU-ADDON-SUM-EXIT.

           MOVE LTP-SCHLD-PAYMNT(PDTH) TO PDTH-CUR-SCHD-PAY
                                          PDTH-NXT-SCHD-PAY
           COMPUTE PDTH-WORKER =
              LTP-SCHLD-PAYMNT(PDTH) * LTP-SCHLD-TERM(PDTH).
           IF PDTH-PAYMNTD > PDTH-WORKER
              ADD LTP-SCHLD-TERM(PDTH) TO NDTE-HOLD
              SUBTRACT PDTH-WORKER FROM PDTH-PAYMNTD
              GO TO PAID-THRU-ADDON-SUM-EXIT.

           MOVE 0 TO PDTH-CNT.
       PAID-THRU-ADDON-NEXT.
           IF PDTH-CNT < LTP-SCHLD-TERM(PDTH)
              IF PDTH-PAYMNTD > LTP-SCHLD-PAYMNT(PDTH)
                 SUBTRACT LTP-SCHLD-PAYMNT(PDTH) FROM PDTH-PAYMNTD
                 ADD 1 TO NDTE-HOLD PDTH-CNT
                 GO TO PAID-THRU-ADDON-NEXT
              ELSE
                 COMPUTE PDTH-PAYMENTS ROUNDED =
                    PDTH-PAYMNTD / LTP-SCHLD-PAYMNT(PDTH)
                 ADD PDTH-PAYS TO NDTE-HOLD
                 MOVE 0 TO PDTH-PAYMNTD
                 IF PDTH-REMAIN = 0 AND
                    LTP-SCHLD-TERM(PDTH) = (PDTH-CNT + 1)
                    MOVE LTP-SCHLD-PAYMNT(PDTH + 1) TO PDTH-CUR-SCHD-PAY
                                                      PDTH-NXT-SCHD-PAY
                 ELSE
                    IF LTP-SCHLD-TERM(PDTH) = (PDTH-CNT + 1)
                       MOVE LTP-SCHLD-PAYMNT(PDTH + 1) TO
                                                      PDTH-NXT-SCHD-PAY
                    ELSE
                       NEXT SENTENCE
           ELSE
              MOVE 0 TO PDTH-PAYMNTD.

       PAID-THRU-ADDON-SUM-EXIT.
           ADD 1 TO PDTH.

      *================================================================*
      * END COPYBOOK: LIBGB\SPPDTH.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCHG.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCHG
      ***********************************************************************
      *   NAME: LPLCHG - LATE CHARGE CALCULATION
      *   DESC: THIS ROUTINE DETERMINES HOW MUCH
      *         TO CHARGE WHEN A LATE CHARGE IS
      *         ASSESED FOR A DELINQ.PAYMENT.
      *   IN  : LCHG-LATE (WHEN LCTYPE = C),
      *                   ITH DOLLARS LATE
      *         LCHG-LCPDTH-DATE (ADDED 070187 AMW)
      *         LCHG-CURPAY  CURRENT PAYMENT DUE IF USING PMT SCHD
      *                      OR SP-LCTYPE = 'M'.
      *         LCHG-DAYS-AFTER-DUE (ADDED 030399 GLF)
      *   OUT : LCHG-CHARGE
      *   USED: LN-REGPYAMT, SP-LCFRMLA, SP-LCTYPE
      *         SP-LCRATE, SP-LCMINCHG, SP-LCMAXAMT, LN-MAINTFEE
      *         LN-1STPYDA LN-1STPYDATE
      *   COPY: LPLCHGW
      *
      * REV:
      *  051286 JTG REDUCED REGPYAMT BY MAINT-FEES
      *  072286 JTG OPENED FORMULA "C" TO THIS ROUTINE
      *  052987 JTG OPENED FORMULA "D" TO THIS ROUTINE
      *  063087 AMW ADD LCTYPE OF E,F,G,H,I.
      *  090689 JTG ADDED LCTYPE 'J'
      *  061290 JTG ADDED LCTYPE 'K' AND 'L' (PACESETTER)
      *  091390 SLC ADDED LCHG-CURPAY, WHICH IS CURRENT PAYMENT IF
      *             LOAN HAS A PAY SCHD RECORD.
      *  060592 JTG ADDED LOGIC FOR LN-LC-CODE (ROSE SHANIS)
      *  062092 JTG ADDED LOGIC FOR LCTYPE 'M' (COLONIAL TN)
      *  080495 KEC REMOVED SP-LC-CODE FROM CALL "CL/ELREAD" USING
      *  111595 BAH ADDED SP-LCTYPE 'N' (MERCURY, TN)
      *  020296 BAH ADDED SP-LCTYPE 'O' (EAST TENNESSEE)
      *  103096 JTG CHANGED TEST ON LN-LC-CODEX TO TEST FOR "00", WHICH
      *             SHOULD ELIMINATE UNNECESSARY IO ON EL-FILE
      *  050797 JTG CHANGED CALL TO ELREAD TO PASS SP-LCUNITPER-CD
      *  122198 JTG ADDED SP-LCTYPE = 'P'  OHIO PRIOR 07/12/96, REGENCY #002
      *  030399 GLF ADDED LOGIC FOR LCHG-DAYS-AFTER-DUE 'Q' (MULLEN)
      *  040331 BAH ADDED SP-LC-ON-JUDGEMENTS FOR RIVERSIDE, PR# 2272, STATE
      *             LAW SAYS NO LATE CHARGES ON JUDGEMENT ACCOUNTS
      *  JTG 050512 ADDED LOGIC TO LET SP-LCUNITPER-CD = "A" WORK
      *             WHEN SP-LCTYPE = 'C', 'K', 'M' OR 'O'       CREATIVE #491
      *  BLM 100219 CHANGED THIS SETTING OF LCHG-WORK TO NOT INCLUDE ESCROW,
      *             CHANGED THIS LOGIC (OLD):
      *
      *    IF SP-LCTYPE = "A" OR "E" OR "F"
      *       IF LN-PAY-SCHLD-FG = "Y"
      *          SUBTRACT LN-MAINTFEE FROM LCHG-CURPAY GIVING LCHG-WORK
      *       ELSE
      *          SUBTRACT LN-MAINTFEE FROM LN-REGPYAMT GIVING LCHG-WORK.
      *                     TO THIS LOGIC (NEW):
      *
      *    IF SP-LCTYPE = "A" OR "E" OR "F"
      *       IF (LN-PAY-SCHLD-FG = "Y" AND LN-ESCROW-FG NOT = "Y" AND
      *                                     LN-ESCROW-FG NOT = "I")
      *          SUBTRACT LN-MAINTFEE FROM LCHG-CURPAY GIVING LCHG-WORK
      *       ELSE
      *          SUBTRACT LN-MAINTFEE FROM LN-REGPYAMT GIVING LCHG-WORK.
      * KEC 190219 REMOVED REDEFINE FOR LN-LC-CODEX; UNUSED
      *            REMOVED REDEFINE FOR SP-LC-CODEX; UNUSED
      ***********************************************************************
       LATE-CHARGE-CALCULATION SECTION.
           MOVE 0 TO LCHG-CHARGE.

           IF ( LN-LC-CODE NOT = ZEROES )
              PERFORM LATE-CHARGE-TEST-ELREAD.

           IF SP-LCFRMLA = "A" OR " "
              GO TO LATE-CHARGE-CALC-EXIT.

      * RIVERSIDE PR# 2272 3/31/04
           IF SP-LC-ON-JUDGEMENTS = "N"
              IF LN-JDDATE NOT = 0
                 GO TO LATE-CHARGE-CALC-EXIT.

           MOVE LN-UNITPER-CD TO UPWK-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO UPWK-UNITPER-FREQ.
           PERFORM UPWK-LC-CALC.

      ***************************************************
      *    "B" HAS THE FIXED LATE CHARGE IN SP-LCRATE
      ***************************************************
           IF SP-LCTYPE = "B"
              MOVE SP-LCRATE TO LCHG-CHARGE
              GO TO LATE-CHARGE-CALC-END.

      ***************************************************
      *    "A", "E", AND "F" USE REGULAR PAYMENT AMOUNT
      ***************************************************
           IF SP-LCTYPE = "A" OR "E" OR "F"
              IF (LN-PAY-SCHLD-FG = "Y" AND LN-ESCROW-FG NOT = "Y" AND
                                            LN-ESCROW-FG NOT = "I")
                 SUBTRACT LN-MAINTFEE FROM LCHG-CURPAY GIVING LCHG-WORK
              ELSE
                 SUBTRACT LN-MAINTFEE FROM LN-REGPYAMT GIVING LCHG-WORK.

      *****************************************************************
      *    "G", "H", AND "I" USE PROPER PAYMENT AMOUNT (ODD OR REGULAR)
      *****************************************************************
           IF SP-LCTYPE = "G" OR "H" OR "I"
              MOVE LN-REGPYAMT TO LCHG-WORK
              IF LN-1STPYAMT NOT = 0
                 MOVE LCHG-LCPDTH-DATE TO NDTE-DATE
                 SUBTRACT LN-TOTNODEF FROM 0 GIVING NDTE-HOLD
                 PERFORM INCREMENT-UNITPER
                 MOVE LN-1STPYDATE TO NUM-DATE
                 MOVE NDTE-DATE    TO SYS-DATE
                 IF SYS-DATE < NUM-DATE
                    MOVE LN-1STPYAMT TO LCHG-WORK.

      *****************************
      *    "E" AND "H" TRUNCATE
      *****************************
           IF SP-LCTYPE = "E" OR "H"
              MOVE 0 TO LCHG-DEC.

      *****************************
      *    "F" AND "I" ROUND UP
      *****************************
           IF SP-LCTYPE = "F" OR "I"
              IF LCHG-DEC > 0
                 MOVE 0 TO LCHG-DEC
                 ADD 1 TO LCHG-TRUNC.

      ***********************************************************
      *    CALCULATE LATE CHARGE FOR A,E,F,G,H,I  LC-TYPES
      ***********************************************************
           IF SP-LCTYPE = "A" OR "E" OR "F" OR "G" OR "H" OR "I"
              COMPUTE LCHG-CHARGE ROUNDED =
                       (LCHG-WORK * SP-LCRATE * 0.01
                                 * UPWK-LC-PER-FAC * 0.01)
              GO TO LATE-CHARGE-CALC-END.

      ************************************************************************
      *    "Q" FLAT CHARGE     MULLEN #804
      *  NOTE:
      *        CHARGE $15.00 IF PAYMENT IS MADE 5 DAYS PAST SPR GRACE PERIOD
      *        CHARGE $10.00 IF PAYMENT IS MADE PAST GRACE PERIOD
      ************************************************************************
           IF SP-LCTYPE = "Q"
              IF ( LCHG-DAYS-AFTER-DUE - SP-LCGRACE ) > 4
                 MOVE 15.00 TO LCHG-CHARGE
              ELSE
                 MOVE 10.00 TO LCHG-CHARGE.

      ***********************************************************
      *    CALCULATE LATE CHARGE FOR P  REGENCY, OHIO PRIOR TO
      *    0712/96 LC-TYPES #002
      ***********************************************************
           IF SP-LCTYPE = "P"
              IF LN-ORGTERM NOT = 0
                 COMPUTE LCHG-CHARGE ROUNDED =
                  ( LN-ANTICERN(1) - LN-UFERN(1) )
                         * (
                             2 / ( LN-ORGTERM * (LN-ORGTERM + 1) )
                           )
              GO TO LATE-CHARGE-CALC-END.

      ***********************************************************
      *    CALCULATE LATE CHARGE FOR C, J, K, L, M & N LC-TYPES
      * CALCULATED ON AMOUNT DELINQUENT
      ***********************************************************
           IF NOT (SP-LCTYPE = "C" OR "J" OR "K" OR "L")
              IF NOT (SP-LCTYPE = "M" OR "N" OR "O")
                 GO TO LATE-CHARGE-CALC-EXIT.

           IF SP-LCTYPE = "K" OR "L"
              IF LCHG-LATE > LN-REGPYAMT
                 MOVE LN-REGPYAMT TO LCHG-LATE.

           IF SP-LCTYPE = "M"
              SUBTRACT LN-MAINTFEE FROM LCHG-CURPAY
                                          GIVING LCHG-WORK
              IF LCHG-LATE > LCHG-WORK
                 MOVE LCHG-WORK TO LCHG-LATE.

           IF SP-LCTYPE = "O"
              IF LCHG-LATE > (LN-REGPYAMT - LN-MAINTFEE)
                 COMPUTE LCHG-LATE = LN-REGPYAMT - LN-MAINTFEE.

      * A FIXED PERCENT OF AMOUNT THAT IS DELINQUENT LESS MAINTFEE
      * TRUNCATED TO WHOLE DOLLARS
           IF SP-LCTYPE = "N"
              COMPUTE LCHG-TRUNC = LCHG-LATE - LN-MAINTFEE
              COMPUTE LCHG-CHARGE ROUNDED =
                            LCHG-TRUNC * SP-LCRATE /100.

           IF SP-LCTYPE = "C" OR "K" OR "M" OR "O"
              COMPUTE LCHG-CHARGE ROUNDED =
                   LCHG-LATE * SP-LCRATE * 0.01
                             * UPWK-LC-PER-FAC * 0.01.

           IF SP-LCTYPE = "J" OR "L"
              MOVE LCHG-LATE TO LCHG-TRUNC
              COMPUTE LCHG-CHARGE ROUNDED =
                            LCHG-TRUNC * SP-LCRATE / 100.

      ********************************************************
      *    COMPARE LATE CHARGE AGAINST MINIMUM AND MAXIMUM
      ********************************************************
       LATE-CHARGE-CALC-END.
           IF SP-LCUNITPER-CD NOT = "A"
              GO TO LATE-CHARGE-CALC-NORMAL-END.

           MULTIPLY .01 BY UPWK-LC-MIN-FAC.
           MULTIPLY .01 BY UPWK-LC-MAX-FAC.
           IF LCHG-CHARGE < (SP-LCMINCHG * UPWK-LC-MIN-FAC)
              MULTIPLY SP-LCMINCHG BY UPWK-LC-MIN-FAC
                                      GIVING LCHG-CHARGE.
           IF LCHG-CHARGE > (SP-LCMAXAMT * UPWK-LC-MAX-FAC)
              MULTIPLY SP-LCMAXAMT BY UPWK-LC-MAX-FAC
                                      GIVING LCHG-CHARGE.
           GO TO LATE-CHARGE-CALC-EXIT.

       LATE-CHARGE-CALC-NORMAL-END.
           IF LCHG-CHARGE < SP-LCMINCHG
              MOVE SP-LCMINCHG TO LCHG-CHARGE.
           IF LCHG-CHARGE > SP-LCMAXAMT
              MOVE SP-LCMAXAMT TO LCHG-CHARGE.

       LATE-CHARGE-CALC-EXIT.
           EXIT.

      ****************************************************************
      *  NOTE:
      *        IF ELREAD.C DETECTS AN INVALID CODE
      *        DUE TO THE OPTION NOT BEENING PURCHASED
      *        AND FX/ELCLR.C NOT HAVING BEEN RUN,
      *
      *        THE SPR FIELDS:
      *          SP-LC-INFO & SP-LCUNITPER-CD  ARE NOT CHANGED
      *        AND
      *          SP-LC-CODE WILL BE SET TO 0 CAUSING NO LATE CHARGES
      *
      ****************************************************************
       LATE-CHARGE-TEST-ELREAD SECTION.
           IF LN-LC-CODE NOT = SP-LC-CODE
              MOVE LN-LC-CODE TO SP-LC-CODE
              MOVE "CL/ELREAD" TO FORM-NAM
              CALL FORM-PROGX USING SP-LC-INFO SP-LCUNITPER-CD
              CANCEL FORM-PROGX.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLCHG.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLCAP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLCAP
      ******************************************************************
      *          LATE CHARGE APPLY ROUTINE
      *
      *   NAME:  LPLCAP
      *   DESC:  PROVIDED WITH 1ST PAYDATE AND A CURRENT PAYMENT
      *          AND TRANSACTION DATE, DETERMINE HOW MUCH
      *          REPRESENTS LATE CHG (LCAP-APP) OR DEFICENCY TO
      *          COVER LATE CHG (LCAP-OWE), AND PROVIDE AN UPDATED
      *          LATE CHG PAID THRU DATE (LCAP-LPPDTH).
      *
      *          WHEN LCAP-LPTRCD = "AL", ALL POSSIBLE LATE CHARGES
      *          ARE ASSESSED, THUS A LCAP-TRAMT LARGE ENOUGH TO
      *          CONSUME ALL LATE CHARGES DUE IS DEFAULTED.
      *
      *   IN  :  LCAP-TRAMT              (LP-TRAMT)
      *          LCAP-1STPYDATE          (LN-1STPYDATE)
      *          LCAP-PAYDATE            (LP-PAYDATE)
      *          LCAP-LPTRCD             (LP-TRCD)  ** ONLY NEED FOR "AL" **
      *          LCAP-LPAPLC             (LP-APLC)
      *          LCAP-LPAPINT            (LP-APINT)
      *          LCAP-POFF-LPTRCD        (POFF-LPTRCD) ONLY NEED FOR PAYOFFS
      *          LCAP-BATCH-REFCD        (SET FOR BATCH REFCD PAYMENTS)
      *          LCAP-BATCH-REFCD-LC-FG  (SET FOR BATCH REFCD PAYMENTS)
      *
      *   OUT :  LCAP-OWE
      *          LCAP-APP
      *          LCAP-LCPDTH-DATE
      *          LCAP-PARTIALS
      *          LCAP-LCPAID
      *          LCAP-NOLCHG
      *
      *   USED:  LN-TOTPAYMNTD, LN-LCPAID, LN-REGPYAMT, LN-1STPYAMT,
      *          LN-TOTNODEF, LN-LCPDTH-DATE, LN-PARTIALS
      *          SP-LCFRMLA, SP-YEARTYPE
      *   COPY:  LPLCAPW, SPPDTHW, LPLCAS, LPLCASW, INCRMM, DATEWK
      *          LPNDTEW, LPNDTE, LPLCHGW, LPLCHG, LPMDTEW, LPMDTE
      *          JULW, TIMW, JUL
      * REV :
      *  010787 JTG ADDED ROUTINE (LATE-CHARGE-AL-CHECK)
      *             TO STOP ADVANCING PAID THRU AT MMYY
      *             LESS THAN ACCESSMENT DATE.
      *  060287 JTG ADDED LOGIC FOR FORMULA "D"
      *  101287 AMW ADDED GENERIC ROUTINE FOR "E"
      *  112487 JTG CORRECTED BUG IN "D", FOR "AL" TRCD
      *  121687 JTG ADDED LOGIC TO TEST ALLOTMENT
      *              CONDITIONS FOR NO LATE CHARGES
      *  122187 JTG REMOVED FORCED 0% TO SP-LCDELFAC
      *  012588 JTG CORRECTED FORMULA E TO NOT TAKE LATE
      *             CHARGES UNTIL CONTRACTUAL DOLLARS
      *             CATCHES UP WITH LPPDTH.
      *             ALSO; CORRECTED ROUTINE TO EVALULATE
      *             WHETHER PAYMENT IS LATE TO USE STATE
      *             PARAMETER LATE CHARGE YEARTYPE
      *             SP-LCYRTYPE.
      *  022588 JTG CORRECTED BUG IN COMPUTATION OF
      *             PAID THRU PAYMENTS.
      *  052088 BAW ADDED LCAP-LPTRCD FOR "AL" INSTEAD OF
      *             CHANGING THE VALUE OF LCAP-LPTRCD
      *             ADDED LCAP-LPAPLC FOR INPUT
      *  053188 JTG ADDED LOGIC FOR FORMULA "G"
      *  061588 JTG CORRECTED FORMULA "F" TO NOT USE
      *             LP-TRAMT, BUT LCAP-TRAMT.
      *  081188 JTG CORRECTED BUG FOR FORMULA "E", IN
      *             COMPUTATION OF LCAP-PDTH-PAYMENTS
      *  040389 JTG CORRECTED BUG IN FORMULA "D" & "G", WHEN
      *             LATE CHARGES ARE PAID AHEAD OF PDTH
      *             AMOUNT NEEDED SHOULD BE FULL PAYMENT
      *  051889 JTG CHANGED ROUTINES FOR CONTRACTUAL PAYMENTS
      *             TOWARD PDTH TO BE INDEPENDENT OF LC FORMULA
      *             CONTRACTUAL REQUIREMENTS
      *  042390 BAH ADDED LCAP-WRK2 TO REPLACE ALL (X+Y) > Z TYPE IF'S
      *  051790 BAH REPLACE LCPAID WITH TOTLCHG FOR LCFRMLA'S "B" "G"
      *  061290 JTG ADDED LOGIC FOR LCFRMLA = "H" & "I"
      *  072490 JTG ADDED REQUIREMENT TO SEND AMOUNTS APPLIED TO INTEREST
      *             AND AMOUNTS APPLIED TO LATE CHARGES
      *  080190 JTG CORRECTED "I", DON'T USE AMT-NEEDED IF PAID THRU
      *             IS PRIOR TO CURRENT PERIOD
      *  091390 SLC ADDED LOGIC FOR MULLEN LATE CHARGES USING
      *             THE PAYMENT SCHEDULES. FORMULA D ONLY!!
      *  120590 JTG CORRECTED LCAP-A FOR USING ELAPSED-DAYS FROM LPLCAS
      *  121290 JTG FIXED LCAP-I-L, RE: FULL LATE CHG FOR WHOLE DUE PERIODS
      *  121890 JTG CORRECTED ALL FORMULAS TO CONSIDER INTEREST OWING
      *  050892 JTG ALLOWED LCAP-G TO WORK WITH PAY SCHEDULE
      *  060592 JTG ADDED LOGIC FOR LN-LC-CODE (ROSE SHANIS)
      *  061992 JTG ADDED MORE SETS OF LCHG-CURPAY FOR SP-LCTYPE = "M"
      *                    SP-LCFRMLA 'D' OR 'G' ONLY
      *  071092 JTG CORRECTED LCAP-G RE: LATE CHARGES PAID IN EXCESS
      *             OF SCHEDULED PAYMENT, CAUSING NO ASSESS
      *  100692 JTG ADDED LOGIC FOR FORMULA "J" AND "K"
      *             NOTE:
      *                   "B" == "J" (USES LCPAID)
      *                   "G" == "K" (USES LCPAID)
      *  020393 JTG CHANGED TO WORK FOR LT-PAY-SCHLD-TBL (17)
      *  030393 JTG CORRECTED LCAP-B-J TO ADVANCE LCPDTH ON WHEN
      *             THE AMOUNT NEEDED IS RECEIVED
      *  040893 JTG ADDED MORE SETS OF LCHG-CURPAY FOR SP-LCTYPE = "M"
      *                     FOR SP-LCFRMLA 'B' OR 'J'
      *  070695 JTG ADDED SP-LCFRMLA 'L', ALMOST 'I', MERCURY 'UCCC'
      *  082595 JTG ADDED SP-LCFRMLA 'M', MERCURY 'LA'
      *  112995 JTG ADDED SP-LCFRMLA 'N', MERCURY 'NV'
      *  071696 JTG ADDED LOGIC FOR UNIT PERIODS
      *  080696 BAH FIXED BUG USING ELAPSED-MONTHS INSTEAD OF ELAPSED-UNITPER
      *  103096 JTG CHANGED TEST ON LN-LC-CODEX TO TEST FOR "00", WHICH
      *             SHOULD ELIMINATE UNNECESSARY IO ON EL-FILE
      *  112297 JFF ADDED LOGIC FOR SCHEDULE PAYMENTS IN LCAP-I-L
      *  120696 JTG CORRECTED BUG LCAP-I, LCAP-I-CURRENT-PERIOD-NEWCUR
      *             INDEX OUT OF BOUNDS
      *  022597 JTG CORRECTED LCAP-I-L, ASSESSING LATE CHARGES ON
      *             CURRECT ACCOUNTS
      *  041097 JTG CHG TO TEST SP-EXPR-FRMLA-CONT & NOT SP-EXPR-FRMLA = " "
      *  050997 JTG ADDED LOGIC TO LCAP-F FOR PAYMENT SCHEDULES
      *  053097 JTG FIXED LCAP-E, WAS ADVANCING LCPDTH 1 TO MANY TIMES
      *  071597 JTG CORRECTED LCAP-F RE: PAYMENT SCHEDULES, ADVANCE
      *  060898 JTG CORRECTED LCAP-I-L TO STOP ADVANCING LCPDTH UNNECESSARLY
      *             RE: WORLD #JG001
      *  101498 BAH CORRECTED GENERIC-LCAP-BYPASS-CHG, LCAP-LCPDTH-DATE WAS
      *             NOT FORCING 1STPYDA INTO LCPDTH, SEE COMMENTS BELOW.
      *  101498 BAH CORRECTED LCAP-A-C ROUTINE, WAS MOVING 4 DIGIT PDTH-DATE
      *             TO LCAP-LCPDTH-DATE INSTEAD OF PDTH-DATE-FULL, REGENCY (PA)
      *  101598 JTG ADDED LOGIC FOR LCFRMLA = 'R', REVOLVING REGENCY
      *             WHICH BE COMPUTED IN LONPFC.C AND RVSTUP.C
      *  030399 GLF ADDED SET OF LCHG-DAYS-AFTER-DUE, MULLEN #804
      *  990323 JTG ADDED LOGIC FOR BR-LATECHG-ON-ALLOTMENTS, TFC #018
      *  990402 JTG CORRECTED LATE CHARGE ASSESS FOR 'B' & 'J'
      *  990402 JTG REMOVED ATTEMPT TO CORRECTED LATE CHARGE ASSESS FOR 'B'&'J'
      *  990422 JTG CHANGED TO ASSESS A LATE CHARGE EVEN IF ACCOUNT
      *             IS PAID AHEAD EX. LN-AGEING-AMT(1) < 0
      *  JTG 990423 CHANGED TO ASSESS A LATE CHARGE ON CURRENT CHARGES
      *             AND PAST DUE CHARGES
      *  JTG 990812 ADDED LOGIC FOR SP-LCFRMLA = J TO NOT CONSIDER PREVIOUS
      *             PAID LATE CHARGES                                    KEARNEY
      *  JTG 990826 ADDED SCCS-COPY-ROUTINE
      *  JTG 990930 CHANGED LCAP-F TO SET PMT-TO-DATE TEMP TO INCLUDE APPLIED
      *             TO INTEREST, CITIZENS FINANCE:
      *  991102 JTG CHANGED LOGIC TO TEST ALLOTMENT CONDITIONS FOR NO LATE
      *             CHARGE AND ALLOW A LATE CHARGE ON PAYMENTS OTHER THAN 'PA'
      *             CFSC - CINDY
      *  991103 JTG CHANGED LCAP-G-K TO TRULY MAKE LCFRMLA 'K' NOT CONSIDER
      *             PRIOR LATE CHARGES PAID VIA LCPAID, CITIZENS (TN) - JUDY
      *  JTG 991217 CHANGED LOGIC FOR LCFRMLA = 'R', REVOLVING REGENCY
      *             TO ONLY TEST MONTH AND YEAR, SINCE PAYMENT DUE DAY CAN
      *             CHANGE MONTH TO MONTH, WHEN SEEING IF LATE CHARGE WAS
      *             ASSESED SINCE LAST STATEMENT
      *  JTG 000111 ADDED LCAP-NOLCHG  WORLD #218
      *             TO TRACK THE NUMBER OF LATE CHARGES ASSESSED
      *  JTG 000203 CORRECTED LOGIC FOR SP-LCFRMLA = J TO NOT CONSIDER PREVIOUS
      *             PAID LATE CHARGES AND TO CORRECTLY CONSIDER INTESEST PAID
      *             FROM OWING (IB ACCOUNTS)     KEARNEY, REGENCY BR:121 #500157
      *  JTG 000724 ADDED LOGIC FOR LCFRMLA = "H"  RE: TOTAL MONIES REGMGM #1262
      *  JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *             SP-RBSPOPT1() = 19, WORLD #233
      *  JTG 000829 CORRECTED LCAP-G-K BUG, TO MAKE LCFRMLA 'K' CONSIDER THE SPR
      *             LATE CHARGE DELINQUENCY FACTOR%    REGENCY #294  (TN) - DIRK
      *  MJD 000911 ADDED TEST OF FOR LOCK BOX ACCOUNTS (MFC PR#227)
      *  JTG 001006 CHANGED LCAP-I-L TO NOT SET LCAP-CURDUE AMOUNT WHEN IT
      *             IS LESS THAN THE DELINQUENCY FACTOR, THIS WILL ALLOW
      *             THE NEXT PAYMENT IF POSTED TO LATE TO TAKE A LATE CHARGE
      *             ACE FINANCIAL PR#297
      *  JTG 001009 CHANGED LCAP-M TO NOT SET LCAP-CURDUE AMOUNT WHEN IT
      *             IS LESS THAN THE DELINQUENCY FACTOR, THIS WILL ALLOW
      *             THE NEXT PAYMENT IF POSTED TO LATE TO TAKE A LATE CHARGE
      *             ACE FINANCIAL PR#297
      *  JTG 010130 ADDED LOGIC TO ALLOW TEST FOR LOCK BOX OR ALLOTMENT ACCOUNTS
      *             THAT WERE POSTED IN LONPW5.C OR LONPW6.C AS "PO"
      *                                                           MERCURY PR#239
      *  JTG 010209 CHANGED NAME "GENERIC-LCAP" TO "LCAP-E"
      *             ADDED LCAP-TRAMT-PLUS-AP, IDEAL PR#315 LCAP-E
      *  JTG 010212 REWRITE LCAP-E LOGIC BY TAKING LCAP-B-J AND LETTING IT
      *             WORK FOR TOTAL MONIES,    IDEAL PR#315
      *  JTG 010212 MODIFIED LCAP-B-J, LCAP-E AND LCAP-N ROUTINES TO TEST 'AL'
      *             AND STOP ASSESSING WHEN THERE IS NO ASSESSMENT
      *  JTG 010326 MODIFIED LCAP-A-C ROUTINE TO TEST 'AL' AND STOP
      *             ASSESSING WHEN THERE IS NO ASSESSMENT
      *  JTG 010625 CREATED LCAP-X (BAD LOGIC) BY PUTTING BACK THE OLD LOGIC
      *             FOR LCAP-E                                     IDEAL PR#1509
      *  JTG 010627 ADDED LOGIC IN EXIT ROUTINE OF ALL FORMULAS TO ASSURE
      *             LCAP-LCPDTH-DATE HAD A VALID DAY IF ACCOUNT IS MONTHLY
      *                                                            IDEAL PR#1509
      *  JTG 010629 REMOVED LCAP-X (BAD LOGIC) AND ADDED LCAP-E-X  IDEAL PR#1509
      *             AND CHANGED TO SUBTRACT LCHG-CHARGE FROM LCAP-AMTNEEDED
      *  JTG 010731 CHANGED LCAP-E-X FOR ANOTHER ATTEMPT TO MAKE 'X'
      *             WORK LIKE DIANE AT IDEAL WANTS. AFTER A FULL
      *             PAYMENT IS SATISFIED AND THE NEXT PAYMENT IS LATE AND
      *             DUE A LATE CHARGE, IF THERE IS NOT ENOUGH MONIES TO APPLY
      *             TOWARDS THE FULL LATE CHARGE TAKE IT ANYWAY FROM MONIES
      *             APPLIED TO SATISFY THE PREVIOUS SHORTAGE       IDEAL PR#1509
      *  JTG 020404 INSURED THAT ACCELERATED ACCOUNTS WILL NOT COMPUTE/TAKE
      *             LATE CHARGES
      *             RE: ALLOWED IB TYPE LOANS TO ACCELERATE JIM R. (ALL) PR#1582
      *  JTG-CS     WHEN SEMI MONTHLY WITH FIRST PAYDATE OF 14TH OR 15TH,
      *      020913 LCPDTH WILL GO TO 02/28/YY OR 02/29/YY WHEN LCPDTH
      *             WAS UPDATED FROM 02/14/YY OR 02/15/YY. THE FOLLOWING
      *             LOGIC RE-ESTABLISHES CYCLES BACK TO THE 14TH OR 15TH.
      *  JTG 021219 ADDED NEW CODE FILE TYPE 'BR' -BATCH PAYMENT REFERENCE CODES
      *             BATCH PAYMENT REVISIONS                         REGACC #0006
      *  BAH 030507 ADDED NEW BRANCH FLAG TO STOP ASSESSING LATE CHARGES FOR
      *             THE ENTIRE BRANCH..THEY MUST SET IT = "N", OTHERWISE IT
      *             WILL CONTINUE TO CHARGE LATE CHARGES...MODERN PR# 2036
      *  JTG 030528 ADDED SP-LCFRMLA = 'P' LIKE 'I'                  PACE #408
      *  JTG 030519 ADDED LOGIC TO LCAP-B-J TO CORRECTLY HANDLE
      *             IB ACCOUNTS WHERE MONEY IS APPLIED TO INTEREST  REGENCY #403
      *  BAH 030620 ADDED TEST FOR GP-I-AM-MODERN TO THE BR-ASSESS-LATE-CHGS
      *             RE USED A BR FLAG THAT MUST OF HAD A "N" IN IT...
      *  BAH 030814 LCAP-A-C WAS MISSING MOVE TO LCHG-LATE FOR FORMULA C,
      *             CAUSING NO LATE CHARGE BUT EVERYTHING ADVANCED AND ACTED
      *             AS IF IT TOOK A LATE CHARGE, BUT IT DIDNT CAUSE THIS FIELD
      *             WAS 0, DAVID (BAY FINANCE)
      *  040401 BAH ADDED SP-LC-ON-JUDGEMENTS FOR RIVERSIDE, PR# 2272, STATE
      *             LAW SAYS NO LATE CHARGES ON JUDGEMENT ACCOUNTS
      *  040405 BAH PACESETTER "I" WAS STILL USING 4 DIGIT PDTH....CHANGED
      *             PDTH-DATE TO PDTH-DATE-FULL
      *  040708 JTG CORRECTED LIBLP/LPLCAP, LCAP-A-C TO NOT GO INTO A
      *             NEVER ENDING LOOP WHEN OERATOR POSTS A PAYMENT
      *             IN EXCESS OF LOAN'S BALANCE                    REGENCY #J047
      *  051206JG&CS ACCOUNTS WITH LCPDTH OF 2/28 DID NOT ADVANCE LCPDTH
      *             CORRECTLY IF 1STPYDA > 28 FOR MARCH.  ON SEMI MONTHLY WITH
      *             DUE DATES OF 14 OR 15 OR 30, IT CHANGED THE CYCLE DATES
      *             CAUSING LATE CHARGES ON SUBSEQUENT PMTS PR#502 TRITON
      *  100211CS   FIXED LCAP-CALC-PDTH-ADDON SECTION.  WAS MOVING PDTH-DATE-
      *             FULL TO NDTE-DATE, INCREMENTING UNITPER, AND THEN MOVING
      *             IN THE FIRST PAY DAY. THIS WAS CAUSING A PROBLEM BECAUSE
      *             IT CAUSED PDTH-DATE-FULL IN FEB IF FIRST DUE DAY WAS 29,
      *             30,OR 31, BECAUSE IT MADE PDTH-DATE-FULL = 02/31/09.  THIS
      *             LATER GOT TESTED IN LCAP-B-J & BECAUSE LCAP-LCPDTH-DATE WAS 2/28
      *             THEY WERE NOT EQUAL & LCPDTH WAS NOT ADVANCED PR#675
      *  100309 BLM BARB & CINDY, FIX FORMULA E & X FOR PAYMENT SCHEDULES.
      *             IN LCAP-E-X-PMT IT WAS MOVING REGPAY TO LCAP-AMTNEEDED
      *             INSTEAD OF SCHEDULED AMOUNT, REGWAN PR# 3506
      *  100309 BLM BARB & CINDY, FIX FORMULA B & J FOR PAYMENT SCHEDULES.
      *             IT WAS MOVING REGPAY TO LCAP-AMTNEEDED
      *             INSTEAD OF SCHEDULED AMOUNT, REGWAN PR# 3506
      *  100309  CS  WHEN WE FIXED B/J/E/X TO WORK WITH PAYMENT SCHEDULES WE
      *              MISSED AN ADD TO LCAP-PMT-NO AFTER SATISFYING ANY SHORTAGE       *              FROM PRIOR PAYMENTS. RAN IN TO THIS WHEN WE WERE ON THE
      *              LAST PAYMENT IN A LEVEL OF SCHEDULE WITH A SHORTAGE, IT
      *              COVERED THE SHORTAGE, BUT THEN STILL THOUGHT YOU WERE ON
      *              THE SAME PAYMENT.  ADDED THIS TEST IN LPCAP-B-J-PMT, LCAP-
      *              E-X-PMT: IF LCAP-AMTNEEDED < LCAP-TRAMT, AFTER SUBTRACT
      *              OF LCAP-AMTNEEDED, IF LN-PAY-SCHLD-FG = "Y", ADD 1 TO
      *              LCAP-PMT-NO. REGWAN PR# 3506
      *  100330 BLM  BARB & CINDY, WHEN CHECKING TO SEE IF TRAMT IS ENOUGH TO
      *              COVER LATE-CHARGE (LCHG-CHARGE), NEED TO SUBTRACT ESCROW
      *              AMT FROM TRAMT IF ACCOUNT HAS ESCROW.  WE ADD ESCROW AMT
      *              BACK IN TO LCAP-TRAMT TO MAKE SURE IT COMPUTES AMT
      *              NEEDED CORRECTLY, BUT FOR EXAMPLE, IF THE ENTIRE TRAMT
      *              IS PUT TO ESCROW, THERE IS NOTHING LEFT TO APPLY TO
      *              LATE CHARGE AND IT WILL GO NEGATIVE!  REGWAN PR# 3506
      *  100813CS    FIXED LCAP-I-L-NOASSESS NOT TO INCLUDE LCAP-LPAPINT IN
      *              COMPUTE OF LCAP-WRK, SEE EXPLANATION AT TOP OF LCAP-I-L-
      *              NO-ASSESS  PL694
      *  110105CS    ATTEMPT TO FIX "H" TO USE SP-DELFAC. THIS CODE IS SUPPOSED
      *              TO ACT LIKE 'F' BUT KEVIN/JIM SAID IT NEEDED TO CONSIDER.        *              ORIG SAVE AS LPLCAP.110105  REGACC #279
      *  110215 MJD  ADDED LOGIC FOR SP-LCFRMLA = "S"  SIMILAR TO "F" WORLD #723
      *                ******** CHANGES STILL IN PROGRESS *******
      *  120730  CS  IF SP-LC-INT-ON-REPO-NON-PL = "N", DONT ASSESS LATE CHG
      *                                                   REGACC PR#314
      *  160113 BAH SPLIT OUT LTFILE, LTPFILE, RENAMED LT- LTP- PD0003
      *  160615 BLM FIX LCAP-R TO CALL GETLTR SINCE REVOLVING FIELDS ARE IN
      *             LTRFILE, NOT LNFILE, PD0003
      * KEC 2016.1116 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED LTR-SEQNO TO LTR1-KEY.
      * BLM 170309 CHANGE COMPARE OF PDTH-WK-YR TO USE PDTH-WK-CCYY, PD0006
      * BAH 170403 LCAP-LCPAID CAN BE A DATE AND MUST STAY MMDDYY BECAUSE
      *            WE CAN NOT DECIPHER WHICH ONES ARE DATES AND WHICH ARE AMTS
      *            WHEN UPGRADING THE LOAN FILE AND PAYMENT FILE! SO WE CANT
      *            CHANGE THE WAY THE DATE WAS FORMATTED IN A15
      * KEC 20190219 REMOVED REDEFINE FOR LN-LC-CODEX; UNUSED
      * BAH 20190625 REMOVED LN-REVOLVING, PT0153 LCFRMLA "R"
      * BAH 20220121 COMMENTED OUT INDIVIDUAL MOVES OF LCAP-CURDATE-MM,-YY
      *              ADDED MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
      *              CINDY FOUND WHILE TESTING
      * BAH 20230328 ADDED SP-LCFRMLA "T" FOR "WI" #1597
      **************************************************************************
       LATE-CHARGE-APPLY SECTION.
           MOVE 0 TO LCAP-APP
                     LCAP-OWE
                     LCAP-NOLCHG.
           MOVE LN-LCPARTIALS TO LCAP-PARTIALS.
           MOVE LN-LCPDTH-DATE     TO LCAP-LCPDTH-DATE.

      * INSURED THAT ACCOUNTS THAT ARE ACCELERATED WILL NOT COMPUTE
      * LATE CHARGES
           IF LN-ACCELDATE NOT = 0
              GO TO LCAP-APP-EXIT.

      * RIVERSIDE PR# 2272 4/04/04
           IF SP-LC-ON-JUDGEMENTS = "N"
              IF LN-JDDATE NOT = 0
                 GO TO LCAP-APP-EXIT.

      * REGACC
           IF SP-LC-INT-ON-REPO-NON-PL = "N"
             IF LN-REPOCD = "X" OR "S"
                IF LN-PLDATE = ZEROS
                   MOVE 0 TO SP-LCRATE
                   MOVE 0 TO SP-LCMINCHG.

      * NEW FLAG TO STOP LATE CHARGES IN AN ENTIRE BRANCH (LEGAL)
      *    IF BR-ASSESS-LATE-CHGS = "N" AND GP-I-AM-MODERN
      *       GO TO LCAP-APP-EXIT.

           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.

           IF ( LN-LC-CODE NOT = ZEROES )
              PERFORM LATE-CHARGE-TEST-ELREAD.

           IF SP-LCFRMLA = "B" OR "G" OR "N"
              MOVE LN-TOTLCHG TO LCAP-LCPAID
           ELSE
              MOVE LN-LCPAID  TO LCAP-LCPAID.

           IF LCAP-1STPYDATE = 0 OR SP-LCFRMLA = " "
              GO TO LCAP-APP-EXIT.

      * ESTABLISH CORRECT PAYMENTS TO DATE FOR SPECIFIC ROUTINE:

           IF SP-LCFRMLA = "A" OR "C" OR "D" OR "E"
                               OR "H" OR "N" OR "X" OR "T"
              IF SP-CONTRFRMLA = " "
                 ADD LN-TOTPAYMNTD LN-TOTLCHG GIVING LCAP-TOTPAYMNTD
              ELSE
                 MOVE LN-TOTPAYMNTD TO LCAP-TOTPAYMNTD
           ELSE
              IF SP-LCFRMLA = "B" OR "F" OR "G" OR "I"
                                  OR "J" OR "K" OR "L"
                                  OR "M" OR "P" OR "S"
                 IF SP-CONTRFRMLA = "A"
                    SUBTRACT LN-TOTLCHG FROM LN-TOTPAYMNTD
                                           GIVING LCAP-TOTPAYMNTD
                 ELSE
                    MOVE LN-TOTPAYMNTD TO LCAP-TOTPAYMNTD.

      * ASSESS ALL POSSIBLE LATE CHARGES:
           IF LCAP-LPTRCD = "AL"
              MOVE 9999999.99 TO LCAP-TRAMT.

      * RECALCULATE PAID THRU DATE, AMT NEEDED TO COMPLETE ONE FULL PAYMENT
      * (WITH OR W/O REGARD TO LATE CHGS PAID, DEPENDING ON THE CONTENT
      * OF LCAP-TOTPAYMNTD FOR SPECIFIC LCFRMLA)
      *
           MOVE LCAP-TOTPAYMNTD TO PDTH-PAYMNTD LCAP-PAYMNTD.
           MOVE LCAP-LCPDTH-DATE     TO LCHG-LCPDTH-DATE.
           IF LN-PAY-SCHLD-FG = "Y"
              PERFORM LCAP-CALC-PDTH-ADDON
           ELSE
              PERFORM LCAP-CALC-PDTH.

      * AMOUNT THAT NEEDS TO BE LATE IN ORDER TO ASSESS LC:
      
           MOVE 0 TO LCAP-PMT-NO.
           IF LN-PAY-SCHLD-FG = "Y"
              PERFORM UNPACK-PAYMENT-SCHEDULE
              MOVE LN-LCPDTH-DATE TO NUM-DATE
              MOVE LN-1STPYDATE TO SYS-DATE
              PERFORM TIMUPER
              COMPUTE LCAP-PMT-NO = (ELAPSED-UNITPER * (-1)) + 2 -
                      LN-TOTNODEF - LN-TOTNOALDEL
              IF LCAP-PMT-NO = 0
                 MOVE 1 TO LCAP-PMT-NO
                 MOVE SCHD-AMT(1) TO LCAP-WRK
                                     LCHG-CURPAY
              ELSE
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-WRK
                                               LCHG-CURPAY
                 IF LN-ESCROW-FG = "Y"
                    MOVE LN-REGPYAMT TO LCAP-WRK
                                        LCHG-CURPAY
                 END-IF
           ELSE
              MOVE LN-REGPYAMT TO LCAP-WRK
                                  LCHG-CURPAY
              IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                 MOVE LN-1STPYAMT TO LCAP-WRK.

           COMPUTE LCAP-DELFAC ROUNDED = LCAP-WRK * (SP-LCDELFAC / 100).
           IF LCAP-DELFAC = 0
              MOVE .01 TO LCAP-DELFAC.

           PERFORM MATURITY-DATE-CALCULATION.

      * DETERMINE AMT NEEDED TO COMPLETE A FULL PAYMENT:
      
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              MOVE LCAP-REMAIN TO PDTH-REMAIN
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
              IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                 MOVE LN-1STPYAMT TO LCAP-AMTNEEDED.
           COMPUTE LCAP-AMTNEEDED ROUNDED =
                             (1 - PDTH-REMAIN) * LCAP-AMTNEEDED.

      * SELECT APPROPRIATE LCFRMLA
      
           IF SP-LCFRMLA = "A" OR "C"
              PERFORM LCAP-A-C
           ELSE
           IF SP-LCFRMLA = "B" OR "J"
              PERFORM LCAP-B-J
           ELSE
           IF SP-LCFRMLA = "D"
              PERFORM LCAP-D
           ELSE
           IF SP-LCFRMLA = "E" OR "X"
              PERFORM LCAP-E-X
           ELSE
           IF SP-LCFRMLA = "F"
              PERFORM LCAP-F
           ELSE
           IF SP-LCFRMLA = "G" OR "K"
              PERFORM LCAP-G-K
           ELSE
           IF SP-LCFRMLA = "H"
              PERFORM LCAP-H
           ELSE
           IF SP-LCFRMLA = "I" OR "L"
              PERFORM LCAP-I-L
           ELSE
           IF SP-LCFRMLA = "M"
              PERFORM LCAP-M
           ELSE
           IF SP-LCFRMLA = "N"
              PERFORM LCAP-N
           ELSE
           IF SP-LCFRMLA = "P"
              PERFORM LCAP-P
           ELSE
           IF SP-LCFRMLA = "S" OR "T"
              PERFORM LCAP-S.

       LCAP-APP-EXIT.
           IF LCAP-LPTRCD = "AL"
              ADD LCAP-APP TO LCAP-OWE
              MOVE 0 TO LCAP-APP.

      * ASSURE LATE CHARGE PAID THRU HAS VALID DAY:

           PERFORM LCAP-ASSURE-LCPDTH.

      ************************************************
      *   SP-LCFRMLA = A OR C
      ************************************************
       LCAP-A-C SECTION.

      * SET PMT-TO-DATE TEMP; ALSO SET LCAP-LCPAID AS TEMP
      * FOR LN-CURBAL (LCPAID IS NOT USED FOR THIS ROUTINE)

           ADD LCAP-TOTPAYMNTD LCAP-LPAPLC LCAP-LPAPINT
                                            GIVING LCAP-PAYMNTD.
           MOVE LN-CURBAL TO LCAP-LCPAID.
           MOVE "Y" TO LCAP-AL-OK.

       LCAP-A-C-BEGIN.

      * PAYMENT CONSUMED ?
           IF LCAP-TRAMT = 0
              GO TO LCAP-A-C-EXIT.

      * LOAN BALANCE 0 ? (THIS IMPLIES ASSESSMENT AFTER MATURITY)
           IF SP-EXPR-FRMLA-CONT
              IF LCAP-LCPAID NOT > 0 OR
                 LCAP-AL-OK = "N"
                 GO TO LCAP-A-C-EXIT.

      * PAST MATURITY ?
           PERFORM LCAP-MDTE-CHK.
           IF NOT SP-EXPR-FRMLA-CONT
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-A-C-EXIT.

      * LCAP-LPTRCD = AL, IF WHERE LCPDTH IS PAID WILL NOT CAUSE
      *                      AN ASSESSMENT, EXIT
           IF LCAP-LPTRCD = "AL"
              PERFORM LCAP-ASSESS-CHK
              IF LCAS-ASSESS NOT = "Y"
                 GO TO LCAP-A-C-EXIT.

      * CHECK FOR PARTIALS
           IF LCAP-TRAMT < LCAP-AMTNEEDED
              MOVE LCAP-TRAMT TO LCAP-WRK
           ELSE
              MOVE LCAP-AMTNEEDED TO LCAP-WRK.

      * TEST FOR OVER LOAN BALANCE:
           IF LCAP-WRK > LCAP-LCPAID
              GO TO LCAP-A-AL-OK-TEST.

           PERFORM LCAP-ASSESS-CHK.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-A-C-PMT.

           IF SP-LCFRMLA = "C"
              IF LCAP-AMTNEEDED NOT = LCAP-WRK
                 MOVE 0 TO LCAP-PARTIALS
                           LCHG-CHARGE
                 GO TO LCAP-A-C-PMT
              ELSE
      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J"
      * SINCE LATE CHARGE IS BASED ON % OF DELINQUENT AMOUNT
                 MOVE LCAP-AMTNEEDED TO LCHG-LATE
                 MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE
                 PERFORM LCAP-CALC-TEST
                 MOVE 0 TO LCAP-PARTIALS
                 GO TO LCAP-A-ACCUM.

      * FOR FORMULA "A" CALCULATE LCHG:
      * ALSO IF ON ALLOTMENT OR LOCK BOX PLAN OR POSTING WITH A BATCH REFCD
      * TEST IF LATE CHARGES SHOULD BE CHARGED:

           IF ( ( LCAP-BATCH-REFCD NOT = " "        ) AND
                ( LCAP-BATCH-REFCD NOT = LOW-VALUES ) AND
                ( LCAP-BATCH-REFCD-LC-FG NOT = "Y"  ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( ( LCAP-BATCH-REFCD = " "          ) OR
                  ( LCAP-BATCH-REFCD = LOW-VALUES   )
                )
               AND
                ( LN-ALLOTCD = "Y"                   ) AND
                ( BR-LATECHG-ON-ALLOTMENTS NOT = "Y" ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( ( LCAP-BATCH-REFCD = " "          ) OR
                  ( LCAP-BATCH-REFCD = LOW-VALUES   )
                )
               AND
                ( LN-LBOX = "Y"                ) AND
                ( BR-LATECHG-ON-LBOX NOT = "Y" ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( LCAP-POFF-LPTRCD = "PB" OR "RN" OR
                                     "SC" OR "RB" OR "RO" ) AND
                ( SP-RBSPOPT1(7) = 19                     ) AND
                ( LCAP-NOLCHG    = 2                      )
              )
              MOVE 0 TO LCHG-CHARGE
           ELSE
              COMPUTE LCHG-CHARGE ROUNDED =
                 ((SP-LCRATE / 100) / 30)
                        * LCAS-ELAPSED-DAYS * LCAP-WRK
              IF LCAP-AMTNEEDED = LCAP-WRK
                 COMPUTE LCAP-WRK2 = LCHG-CHARGE + LCAP-PARTIALS
                 IF LCAP-WRK2 < SP-LCMINCHG
                    SUBTRACT LCAP-PARTIALS FROM SP-LCMINCHG
                    GIVING LCHG-CHARGE.

           IF LCHG-CHARGE > SP-LCMAXAMT
              MOVE SP-LCMAXAMT TO LCHG-CHARGE.

           IF LCAP-AMTNEEDED = LCAP-WRK
              MOVE 0 TO LCAP-PARTIALS
              ADD 1 TO LCAP-NOLCHG
           ELSE
              ADD LCHG-CHARGE TO LCAP-PARTIALS.

       LCAP-A-ACCUM.
           ADD LCHG-CHARGE TO LCAP-PAYMNTD
                              LCAP-APP.
           SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT
                                     LCAP-WRK.

       LCAP-A-C-PMT.

      * TEST FOR ASSESS AND 0 CURBAL REACHED:
           IF LCAP-LPTRCD = "AL"
              IF LCAP-LCPAID = 0
                 MOVE LCAP-PAYDATE TO LCAP-LCPDTH-DATE
                 GO TO LCAP-A-C-EXIT.

      * REDUCE LOAN BALANCE TEMP STORED IN LCAP-LCPAID
      * USED WHEN LATE CHARGES ARE ASSESSED BEYOND MATURITY. SEE ABOVE
           SUBTRACT LCAP-WRK FROM LCAP-LCPAID
                                  LCAP-TRAMT.
           ADD LCAP-WRK TO LCAP-PAYMNTD.
           MOVE LCAP-PAYMNTD TO PDTH-PAYMNTD.

      * COMPUTE LCPDTH BASED ON TOTAL PMTS (PMTS + LATE CHGS)
           PERFORM LCAP-CALC-PDTH.

      * IF LCPDTH AS COMPUTED WILL ADVANCE, UPDATE.
      * (THIS IS TO PROVIDE FOR CODES SUCH AS "AL" WHICH
      * ADVANCE LCPDTH AS IF ACTUAL PMTS WERE MADE, EVEN
      * THOUGH LCAP-TOTPAYMNTD WILL ONLY INCLUDE THE LATE CHARGE)

           MOVE LCAP-LCPDTH-DATE    TO NUM-DATE.
           MOVE 1                   TO NUM-DA.
           MOVE PDTH-DATE-FULL      TO SYS-DATE.
           MOVE 1                   TO S-DD.
           PERFORM TIM365.
           IF ELAPSED-DAYS > 0
              PERFORM LCAP-A-AL-OK-TEST
              IF LCAP-AL-OK = "Y"
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE.

           MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
           GO TO LCAP-A-C-BEGIN.

      * IF SP-LCFRMLA = "A" WE MUST NOT ADVANCE LATE CHARGE PAID THRU
      * TO THE MONTH & YEAR OF THE "AL" DATE, IF THE ACCESS DATE IS
      * PRIOR TO THE NORMAL PAY DAY OF THAT MONTH.
      
       LCAP-A-AL-OK-TEST.
           MOVE "Y" TO LCAP-AL-OK.
           IF LCAP-LPTRCD = "AL"
              IF SP-LCFRMLA = "A"
                 MOVE LCAP-PAYDATE TO NUM-DATE
                 IF PDTH-WK-CCYY = NUM-CCYY
                    IF PDTH-WK-MM = NUM-MO
                       MOVE LCAP-1STPYDATE TO SYS-DATE
                       IF NUM-DA < S-DD
                          MOVE "N" TO LCAP-AL-OK.
       LCAP-A-C-EXIT.
           EXIT.

      ***********************************************
      *  SP-LCFRMLA = B OR J:
      *     "B" == "J" WHICH USES LCPAID
      ***********************************************
       LCAP-B-J SECTION.

      * TEST FOR PRIOR PAYMENT SHORTAGES:

           IF LCAP-LCPDTH-DATE NOT = PDTH-DATE-FULL
              IF (LCAP-TRAMT + LCAP-LPAPLC + LCAP-LPAPINT)
                                                > LCAP-AMTNEEDED
                 GO TO LCAP-B-J-PMT
              ELSE
                 GO TO LCAP-B-J-EXIT.

       LCAP-B-J-DATE-CHK.

      * VERIFY DATES FOR ASSESSMENT
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-B-J-EXIT.

           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              IF LCAP-LPTRCD = "AL"
                 GO TO LCAP-B-J-EXIT
              ELSE
                 GO TO LCAP-B-J-RETRY.

      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J",
      * WHERE LATE CHG IS BASED ON % OF LATE PMT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE    TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF TRAMT INSUFFICIENT TO COVER CHARGE, OWING IS FOUND:
           IF LN-ESCROW-FG = "Y"
              IF (LCAP-TRAMT - LCAP-ESCROW-AMT) < LCHG-CHARGE
                 COMPUTE LCAP-OWE = LCHG-CHARGE
                                  - (LCAP-TRAMT - LCAP-ESCROW-AMT)
                 COMPUTE LCAP-APP = LCAP-APP
                                  + (LCAP-TRAMT - LCAP-ESCROW-AMT)
                 PERFORM LCAP-UPD-LCPD
                 GO TO LCAP-B-J-EXIT
              END-IF
           ELSE
              IF LCAP-TRAMT < LCHG-CHARGE
                 SUBTRACT LCAP-TRAMT FROM LCHG-CHARGE GIVING LCAP-OWE
                 ADD LCAP-TRAMT TO LCAP-APP
                 PERFORM LCAP-UPD-LCPD
                 GO TO LCAP-B-J-EXIT.

      * OTHERWISE, TAKE LATE CHARGE AND (ATTEMPT) PMT RECEIPT:
           ADD LCHG-CHARGE TO LCAP-APP
                              LCAP-LCPAID.
           SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.
           PERFORM LCAP-UPD-LCPD.
           IF (LCAP-TRAMT + LCAP-LPAPLC + LCAP-LPAPINT)
                                           NOT > LCAP-AMTNEEDED
              GO TO LCAP-B-J-EXIT.

      * REDUCE TRANSACTION AMOUNT BY PAYMENT:
       LCAP-B-J-PMT.
           IF LCAP-AMTNEEDED >= LCAP-TRAMT
              SUBTRACT LCAP-TRAMT FROM LCAP-AMTNEEDED
              MOVE 0 TO LCAP-TRAMT
           ELSE
              SUBTRACT LCAP-AMTNEEDED FROM LCAP-TRAMT
              MOVE 0 TO LCAP-AMTNEEDED
              IF LN-PAY-SCHLD-FG = "Y"
                 ADD 1 TO LCAP-PMT-NO.
   
           IF LCAP-AMTNEEDED >= LCAP-LPAPINT
              SUBTRACT LCAP-LPAPINT FROM LCAP-AMTNEEDED
              MOVE 0 TO LCAP-LPAPINT
           ELSE
              SUBTRACT LCAP-AMTNEEDED FROM LCAP-LPAPINT
              MOVE 0 TO LCAP-AMTNEEDED.
   
           IF LCAP-AMTNEEDED >= LCAP-LPAPLC
              SUBTRACT LCAP-LPAPLC FROM LCAP-AMTNEEDED
              MOVE 0 TO LCAP-LPAPLC
           ELSE
              SUBTRACT LCAP-AMTNEEDED FROM LCAP-LPAPLC
              MOVE 0 TO LCAP-AMTNEEDED.
   
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                                  LCHG-CURPAY.
           GO TO LCAP-B-J-DATE-CHK.

       LCAP-B-J-RETRY.
           IF (LCAP-TRAMT + LCAP-LPAPLC + LCAP-LPAPINT)
                                                > LCAP-AMTNEEDED
              PERFORM LCAP-UPD-LCPD
              GO TO LCAP-B-J-PMT.

      * TEST TO SEE IF THE SHORTAGE IS NOT GREATER
      * THAN THE DELINQUINCY FACTOR, SETUP IN STATE PARAMETERS.
           COMPUTE LCAP-WRK2 =
                   LCAP-AMTNEEDED - LCAP-TRAMT
                                  - LCAP-LCPAID
                                  - LCAP-LPAPLC
                                  - LCAP-LPAPINT.

           IF LCAP-WRK2 < LCAP-DELFAC
              PERFORM LCAP-UPD-LCPD.

       LCAP-B-J-EXIT.
           EXIT.

      *************************************************
      *   SP-LCFRML = D
      *
      *   NOTE: THIS IS THE SAME AS FORMULA "G",
      *         EXCEPT CONTRACTUAL USES MONIES TOWARDS
      *         PRINCIPAL AND LATE CHARGES.
      *************************************************
       LCAP-D SECTION.
           ADD LCAP-LPAPLC LCAP-LPAPINT LCAP-TOTPAYMNTD
                           GIVING LCAP-PAYMNTD.

       LCAP-D-BEGIN.

      * PAST MATURITY ?
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-D-EXIT.

      * ? ASSESSING LATE CHARGES (AL)
      * STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT UP TODATE,
      * LCAP-LCPDTH-DATE >= PAYMENT DATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-D-EXIT.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-D-NOASSESS.

      * TEST FOR SHORTAGE NOT GREATER
      * THAN THE DELINQUINCY FACTOR IN (SPR'S):
           IF LCAP-LCPDTH-DATE = PDTH-DATE-FULL
              IF LCAP-AMTNEEDED < LCAP-DELFAC
                 GO TO LCAP-D-ADVANCE.

      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J"
      * SINCE LATE CHARGE IS BASED ON % OF DELINQUENT AMOUNT.
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE + LCHG-CHARGE
                                               - LCAP-TRAMT
              ADD LCAP-TRAMT TO LCAP-APP
                                LCAP-PAYMNTD
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
                                 LCAP-PAYMNTD
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-D-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
              COMPUTE LCAP-DELFAC ROUNDED =
                        SCHD-AMT(LCAP-PMT-NO) * (SP-LCDELFAC / 100)
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                                  LCHG-CURPAY.
           GO TO LCAP-D-BEGIN.

      * NO ASSESSMENT REQUIRED, ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU
      * IF IT WILL ADVANCE LCPDTH ONLY, SINCE
      * ADVANCEMENT OF LCPDTH COULD HAVED OCCURED
      * VIA TIME.
       LCAP-D-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE.

      * ? PAST MATURITY
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE MDTE-DATE TO LCAP-LCPDTH-DATE.

       LCAP-D-EXIT.
           EXIT.

      ***********************************************
      *  SP-LCFRMLA = E AND X
      ***********************************************
       LCAP-E-X SECTION.

           ADD LCAP-LPAPINT LCAP-LPAPLC LCAP-TRAMT
                                    GIVING LCAP-TRAMT-PLUS-AP.
           MOVE 0 TO LCAP-APPLIED-TOWARD-SHORTAGE.

      * TEST FOR PRIOR PAYMENT SHORTAGES:
           IF LCAP-LCPDTH-DATE NOT = PDTH-DATE-FULL
              IF LCAP-TRAMT-PLUS-AP > LCAP-AMTNEEDED
                 GO TO LCAP-E-X-PMT
              ELSE
                 GO TO LCAP-E-X-EXIT.

       LCAP-E-X-DATE-CHK.

      * VERIFY DATES FOR ASSESSMENT
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-E-X-EXIT.

           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              IF LCAP-LPTRCD = "AL"
                 GO TO LCAP-E-X-EXIT
              ELSE
                 GO TO LCAP-E-X-RETRY.

      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J",
      * WHERE LATE CHG IS BASED ON % OF LATE PMT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE    TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF TRAMT INSUFFICIENT TO COVER CHARGE,
      * IF 'E' PARTIAL OWING IS FOUND
      * IF 'X' FULL LATE CHARGE IS PUT INTO OWING UNLESS
      *        ENOUGH MONIE WAS PAID TOWARDS THE PRIOR PAYMENT
      *        SHORTAGE TO COVER CHARGE
      
           IF LCAP-TRAMT < LCHG-CHARGE
              IF SP-LCFRMLA = "E"
                 SUBTRACT LCAP-TRAMT FROM LCHG-CHARGE GIVING LCAP-OWE
                 ADD LCAP-TRAMT TO LCAP-APP
              ELSE
                 IF LCHG-CHARGE <= LCAP-APPLIED-TOWARD-SHORTAGE
                    ADD  LCHG-CHARGE TO LCAP-APP
                 ELSE
                    MOVE LCHG-CHARGE TO LCAP-OWE
                 END-IF
              END-IF
              PERFORM LCAP-UPD-LCPD
              GO TO LCAP-E-X-EXIT.

      * OTHERWISE, TAKE LATE CHARGE AND (ATTEMPT) PMT RECEIPT:
           ADD LCHG-CHARGE TO LCAP-APP.
           SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT
                                     LCAP-TRAMT-PLUS-AP
                                     LCAP-AMTNEEDED.
           PERFORM LCAP-UPD-LCPD.
           IF LCAP-TRAMT-PLUS-AP <= LCAP-AMTNEEDED
              GO TO LCAP-E-X-EXIT.

      * REDUCE TRANSACTION AMOUNT BY PAYMENT:
       LCAP-E-X-PMT.
           SUBTRACT LCAP-AMTNEEDED FROM LCAP-TRAMT-PLUS-AP.
           IF LCAP-AMTNEEDED <= LCAP-TRAMT
              SUBTRACT LCAP-AMTNEEDED FROM LCAP-TRAMT
              ADD LCAP-AMTNEEDED TO LCAP-APPLIED-TOWARD-SHORTAGE
              IF LN-PAY-SCHLD-FG = "Y"
                 ADD 1 TO LCAP-PMT-NO.

           IF LN-PAY-SCHLD-FG = "Y"
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                                  LCHG-CURPAY.
           GO TO LCAP-E-X-DATE-CHK.

       LCAP-E-X-RETRY.
           IF LCAP-TRAMT-PLUS-AP > LCAP-AMTNEEDED
              PERFORM LCAP-UPD-LCPD
              GO TO LCAP-E-X-PMT.

      * TEST TO SEE IF THE SHORTAGE IS NOT GREATER
      * THAN THE DELINQUINCY FACTOR, SETUP IN STATE PARAMETERS.
           COMPUTE LCAP-WRK2 =
                  LCAP-AMTNEEDED - LCAP-TRAMT-PLUS-AP.

           IF LCAP-WRK2 < LCAP-DELFAC
              PERFORM LCAP-UPD-LCPD.

       LCAP-E-X-EXIT.
           EXIT.

      ***************************************************************
      *   SP-LCFRML = F    LOUISIANA LATE CHARGE FORMULA
      *                    LIKE 'H' EXCEPT PRINCIPAL ONLY
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE [MMDD.YY] AT EXIT)
      ***************************************************************
       LCAP-F SECTION.
      * SET PMT-TO-DATE TEMP TO INCLUDE APPLIED TO INTEREST, CITIZENS FINANCE:
           ADD LCAP-TOTPAYMNTD LCAP-LPAPINT GIVING LCAP-PAYMNTD.

           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

      * SEE IF CONTRACTUAL PAID THRU IS LESS THAN LCPDTH,
      * IF SO SET AMTNEEDED TO REGULAR PAYMENT:
           MOVE PDTH-DATE-FULL TO SYS-DATE.
           PERFORM LCAP-LCPDTH-DATE-TEST.
           IF ELAPSED-DAYS < 0
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              ELSE
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-F-CURRENT-PERIOD.

       LCAP-F-BEGIN.
      * TEST IF LATE CHARGE PAID THRU (LCAP-LCPDTH) IS
      * ON OR AFTER MATURITY, IF SO EXIT:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-F-EXIT.

      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT UP TODATE,
      * WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH) IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-F-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE
                           LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-F-NOASSESS.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 IF LCAP-LST-CURDUE < LCAP-DELFAC
                    GO TO LCAP-F-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = 'C', LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-F-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
           GO TO LCAP-F-BEGIN.

      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
       LCAP-F-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE.

      * ? PAST MATURITY,
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-F-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-F-CURRENT-PERIOD SECTION.
           MOVE 0 TO LCAP-CURDUE.
           MOVE LCAP-PAYDATE TO LCAP-CURDATE.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *    SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *    LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      *
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-F-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:
              IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
                 GO TO LCAP-F-CURRENT-PERIOD-NEWCUR.
              MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
              IF LCAP-TRAMT < LCAP-LST-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                           GIVING LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.
              MOVE 0 TO LCAP-LST-CURDATE
                        LCAP-LST-CURDUE.
              GO TO LCAP-F-CURRENT-PERIOD-EXIT.

       LCAP-F-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-1STPYDATE TO NUM-DATE
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-MONTHS < 0
                 MOVE 0 TO ELAPSED-MONTHS
              END-IF
              ADD 1 ELAPSED-MONTHS GIVING LCAP
              MOVE SCHD-AMT(LCAP) TO LCAP-CURDUE
           ELSE
              MOVE LN-REGPYAMT TO LCAP-CURDUE
              IF LN-1STPYAMT NOT = 0
                 IF LCAP-CURDATE = LCAP-1STPYDATE
                    MOVE LN-1STPYAMT TO LCAP-CURDUE.

              IF LCAP-TRAMT < LCAP-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.

       LCAP-F-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.

      ***************************************************************
      *   SP-LCFRML = H    LOUISIANA LATE CHARGE FORMULA
      *                    LIKE 'F' EXCEPT TOTAL MONIES
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE [MMDD.YY] AT EXIT)
      ***************************************************************
       LCAP-H SECTION.
      * SET PMT-TO-DATE TEMP TO INCLUDE APPLIED TO INTEREST, CITIZENS FINANCE:
           ADD LCAP-TOTPAYMNTD LCAP-LPAPINT GIVING LCAP-PAYMNTD.

           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

      * SEE IF CONTRACTUAL PAID THRU IS LESS THAN LCPDTH,
      * IF SO SET AMTNEEDED TO REGULAR PAYMENT:
           MOVE PDTH-DATE-FULL TO SYS-DATE.
           PERFORM LCAP-LCPDTH-DATE-TEST.
           IF ELAPSED-DAYS < 0
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              ELSE
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-H-CURRENT-PERIOD.

       LCAP-H-BEGIN.
      * TEST IF LATE CHARGE PAID THRU (LCAP-LCPDTH) IS
      * ON OR AFTER MATURITY, IF SO EXIT:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-H-EXIT.

      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT
      * UP TODATE, WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH)
      * IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-H-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE
                           LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-H-NOASSESS.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 IF LCAP-LST-CURDUE < LCAP-DELFAC
                    GO TO LCAP-H-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = 'C', LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-H-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
           GO TO LCAP-H-BEGIN.

      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
       LCAP-H-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
      *1262
              ADD LCAP-APP TO PDTH-PAYMNTD LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT < 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE
                 IF LCAP-UNPAID-PORTION NOT = 0
                     AND LCAP-UNPAID-PORTION < LCAP-DELFAC
                     PERFORM LCAP-UPD-LCPD.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE.

      * ? PAST MATURITY,
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-H-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-H-CURRENT-PERIOD SECTION.
           MOVE 0 TO LCAP-CURDUE.
           MOVE LCAP-PAYDATE TO LCAP-CURDATE.
      * IF INTEREST COLLECT SHOULD COUNT TOWARDS LCAP-PARTIALS
           ADD LCAP-LPAPLC LCAP-LPAPINT TO LCAP-TRAMT.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *    SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *    LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      *
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-H-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:

              IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
                 GO TO LCAP-H-CURRENT-PERIOD-NEWCUR.
              MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
              IF LCAP-TRAMT < LCAP-LST-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                           GIVING LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.
              MOVE 0 TO LCAP-LST-CURDATE
                        LCAP-LST-CURDUE.
              GO TO LCAP-H-CURRENT-PERIOD-EXIT.

       LCAP-H-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-1STPYDATE TO NUM-DATE
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-MONTHS < 0
                 MOVE 0 TO ELAPSED-MONTHS
              END-IF
              ADD 1 ELAPSED-MONTHS GIVING LCAP
              MOVE SCHD-AMT(LCAP) TO LCAP-CURDUE
           ELSE
              MOVE LN-REGPYAMT TO LCAP-CURDUE
              IF LN-1STPYAMT NOT = 0
                 IF LCAP-CURDATE = LCAP-1STPYDATE
                    MOVE LN-1STPYAMT TO LCAP-CURDUE.

              IF LCAP-TRAMT < LCAP-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.

       LCAP-H-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.
      * RESET LCAP-TRAMT ADDED AT TOP OF LCAP-H-CURRENT
           SUBTRACT LCAP-LPAPLC LCAP-LPAPINT FROM LCAP-TRAMT.


      **************************************************************
      *   SP-LCFRML = I & L   INDIANA   LATE CHARGE FORMULA (PRIN ONLY)
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE [MMDD.YY] AT EXIT)
      **************************************************************
       LCAP-I-L SECTION.
           MOVE LCAP-TOTPAYMNTD TO LCAP-PAYMNTD.
           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

           ADD LN-TOTLCHG LCAP-LPAPLC LCAP-LPAPINT GIVING LCAP-WRK.
           IF SP-LCFRMLA = "L"
              IF LCAP-WRK < LCAP-AMTNEEDED
                 SUBTRACT LCAP-WRK FROM LCAP-AMTNEEDED
              ELSE
                 NEXT SENTENCE
           ELSE
              IF LCAP-AMTNEEDED NOT = LCAP-UNPAID-PORTION
                 SUBTRACT LCAP-WRK FROM LCAP-AMTNEEDED.

      * SEE IF CONTRACTUAL PAID THRU IS LESS THAN LCPDTH,
      * IF SO SET AMTNEEDED TO REGULAR PAYMENT:

           MOVE LCAP-TOTPAYMNTD TO LCAP-WRK.
      
           COMPUTE PDTH-PAYMNTD
                   LCAP-TOTPAYMNTD = LCAP-TOTPAYMNTD + LN-TOTLCHG.

           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-PAYMNTD TO LCAP-HOLDER
              MOVE PDTH-PAYMNTD TO LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE LCAP-HOLDER TO LCAP-PAYMNTD
           ELSE
              PERFORM LCAP-PICK-PDTH-CALC.

           IF LN-PAY-SCHLD-FG = "Y"
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-WRK2
              COMPUTE LCAP-WRK2 ROUNDED = LCAP-REMAIN * LCAP-WRK2
           ELSE
              MOVE LN-REGPYAMT TO LCAP-WRK2
              IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                 MOVE LN-1STPYAMT TO LCAP-WRK2
              END-IF
              COMPUTE LCAP-WRK2 ROUNDED =
                      PDTH-REMAIN * LCAP-WRK2.

           IF LCAP-WRK2 < LN-TOTLCHG
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              ELSE
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                 IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                    MOVE LN-1STPYAMT TO LCAP-AMTNEEDED
                    IF SP-LCFRMLA = "L"
                       SUBTRACT LCAP-WRK2 FROM LCAP-AMTNEEDED
                    ELSE
                       NEXT SENTENCE
                 ELSE
                    IF SP-LCFRMLA = "L"
                       SUBTRACT LCAP-WRK2 FROM LCAP-AMTNEEDED.
           MOVE LCAP-WRK TO LCAP-TOTPAYMNTD.

           IF LCAP-LST-CURDATE = 0
                    OR (LCAP-LST-CURDATE NOT = 0
                               AND LCAP-LST-CURDUE = 0)
              MOVE PDTH-DATE-FULL TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS < 0
                 IF LN-PAY-SCHLD-FG = "Y"
                    MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                 ELSE
                    MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-I-L-CURRENT-PERIOD.

       LCAP-I-L-BEGIN.
      * TEST IF LATE CHARGE PAID THRU (LCAP-LCPDTH) IS
      * ON OR AFTER MATURITY, IF SO EXIT:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-I-L-EXIT.

      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT UP TODATE,
      * WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH) IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-I-L-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE
                           LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-I-L-NOASSESS.

      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDATE TO NUM-DATE
                 MOVE PDTH-DATE-FULL   TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS < 0
                    MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 ELSE
                    IF LCAP-AMTNEEDED > LCAP-LST-CURDUE
                       MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
           IF LCAP-AMTNEEDED < LCAP-DELFAC
              GO TO LCAP-I-L-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = "C" OR "J", LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-I-L-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

           GO TO LCAP-I-L-BEGIN.

      *******************************************************
      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
      *******************************************************
       LCAP-I-L-NOASSESS.

           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD.

      *08/13/15 PR#694
      *MULLEN REPORTED ACCOUNT THAT WAS PAID AHEAD DID NOT ADVANCE
      *LATE CHARGE PAID THRU, CAUSING THE NEXT ON TIME PAYMENT TO
      *ASSESS A LATE CHARGE. THE ACCOUNT WAS PAID AHEAD BUT THE PAYMENT WENT
      *TO INTEREST-OWING. WHEN I WAIVED THE INTEREST-DUE, THE ACCOUNT ADVANCED
      *LCPDTH SO I ADDED SUBTRACT OF LCAP-LPAPINT(INT-OWE)FROM LCAP-WRK. I
      *AM NOT QUITE SURE WHY WE ADD LN-TOTLCHG,LCAP-LPAPLC,LCAP-APP
      *LCAP-LPAPINT TO THIS WORKER. I DO REMEMBER PACESETTER DID NOT WANT
      *AN ACCT TO BE PAST DUE BECAUSE OF PAID LATE CHGS BUT ALSO DID NOT
      *WANT HIM TO BE PAID AHEAD IF HE DID PAY THEM BUT I SEE NO REASON THAT
      *COLLECTED INTEREST OWING SHOULD BE INCLUDED IN THIS WORKER.
      *
      *IN MULLEN'S EXAMPLE LCAP-WRK WAS 30.00(LN-TOTLCHG) + 408.92(INT
      *OWE, WHEN IT COMPUTED PDTH-PAYMENTS IT WAS > 1, SO IT SUBTRACTED
      *A REGPYAMT FROM PAYMENTS TO DATE.
      *
      *HERE IS THE ACCOUNT
      *          TRCD   AMT   INT       PDTH  LCPD       INT/LC OWE
      * 03/28/10  D2                    05/10  05/10        789.73
      * 05/28/10  PY   408.92 408.92    06/10  05/10        868.96
      *WHEN I WAIVED THE INTEREST OWING
      *          TRCD   AMT   INT       PDTH  LCPD       INT/LC OWE
      * 03/28/10  D2                    05/10  05/10        789.73
      * 05/28/10  PY   408.92           06/10  06/10        868.96
      *
      *PAYMENTS TO DATE WAS THE SAME AMOUNT IN BOTH EXAMPLES, BUT DID NOT
      *ADVANCE LCPDTH WITH INTEREST OWING COLLECTED.

           IF LCAP-LPTRCD NOT = "AL"
              IF SP-LCFRMLA = "I" OR "L"
                 ADD LN-TOTLCHG LCAP-LPAPLC LCAP-APP LCAP-LPAPINT
                                                    GIVING LCAP-WRK
                 ADD LCAP-WRK TO PDTH-PAYMNTD

      *PL#694 SEE ABOVE
                 SUBTRACT LCAP-LPAPINT FROM LCAP-WRK

                 COMPUTE PDTH-PAYMENTS = LCAP-WRK / LN-REGPYAMT
                 IF PDTH-PAYMENTS > 1
                    COMPUTE PDTH-PAYMNTD =
                       PDTH-PAYMNTD - ( PDTH-PAYS * LN-REGPYAMT).

           IF LCAP-LPTRCD NOT = "AL"
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE LCAP-PAYMNTD TO LCAP-HOLDER
                 MOVE PDTH-PAYMNTD TO LCAP-PAYMNTD
                 PERFORM LCAP-PICK-PDTH-CALC
                 MOVE LCAP-HOLDER TO LCAP-PAYMNTD
              ELSE
                 PERFORM LCAP-PICK-PDTH-CALC
              END-IF
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT < 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE
                 IF LCAP-UNPAID-PORTION NOT = 0
                          AND LCAP-UNPAID-PORTION < LCAP-DELFAC
                    PERFORM LCAP-UPD-LCPD.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    IF ELAPSED-DAYS > 0
                       MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE
                    ELSE
                       PERFORM LCAP-UPD-LCPD.

      * ? PAST MATURITY,
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
       LCAP-I-L-MATURITY-TEST.
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-I-L-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE (MMDDYY) TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-I-L-CURRENT-PERIOD SECTION.
           MOVE " " TO LCAP-PRIOR-1STPY.
           MOVE 0 TO LCAP-CURDUE.
           ADD LCAP-LPAPLC LCAP-LPAPINT TO LCAP-TRAMT.

      * IF PAYMENT IS BEFORE 1ST PAYMENT IS DUE,
      * FORCE CURRENT DUE DATE TO 1 MONTH PRIOR TO
      * FIRST PAYMENT DUE DATE:
           MOVE LCAP-PAYDATE TO LCAP-CURDATE
                                NUM-DATE.
           MOVE LCAP-1STPYDATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS > 0
              MOVE "Y" TO LCAP-PRIOR-1STPY
              MOVE LCAP-1STPYDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-CURDATE
              GO TO LCAP-I-L-CURRENT-PERIOD-SETDUE.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *  SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *  LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-I-L-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:
       LCAP-I-L-CURRENT-PERIOD-SETDUE.
           IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
              GO TO LCAP-I-L-CURRENT-PERIOD-NEWCUR.
           MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
           IF LCAP-TRAMT < LCAP-LST-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                        GIVING LCAP-CURDUE
           ELSE
              MOVE 0 TO LCAP-CURDUE.
           MOVE 0 TO LCAP-LST-CURDATE
                     LCAP-LST-CURDUE.
           GO TO LCAP-I-L-CURRENT-PERIOD-EXIT.

       LCAP-I-L-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-1STPYDATE TO NUM-DATE
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-MONTHS < 0
                 MOVE 0 TO ELAPSED-MONTHS
              END-IF
              ADD 1 ELAPSED-MONTHS GIVING LCAP
              MOVE SCHD-AMT(LCAP) TO LCAP-CURDUE
           ELSE
              MOVE LN-REGPYAMT TO LCAP-CURDUE
              IF LN-1STPYAMT NOT = 0
                 IF LCAP-CURDATE = LCAP-1STPYDATE
                    MOVE LN-1STPYAMT TO LCAP-CURDUE.

           IF LCAP-TRAMT < LCAP-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
              IF LCAP-CURDUE < LCAP-DELFAC
                 MOVE 0 TO LCAP-CURDUE
              END-IF
           ELSE
              MOVE 0 TO LCAP-CURDUE.

       LCAP-I-L-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.

           SUBTRACT LCAP-LPAPLC LCAP-LPAPINT FROM LCAP-TRAMT.

      ***********************************************
      *   SP-LCFRML = G AND K
      *
      *   NOTE: THIS IS THE SAME AS FORMULA "D",
      *         EXCEPT USING PRINCIPLE ONLY AS
      *         CONTRACTUAL MONIES.
      ***********************************************
       LCAP-G-K SECTION.

           ADD LCAP-TOTPAYMNTD LCAP-LPAPINT GIVING LCAP-PAYMNTD.

       LCAP-G-K-BEGIN.

      * PAST MATURITY ?
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-G-K-EXIT.

      * ? ASSESSING LATE CHARGES (AL)
      * STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT
      * UP TODATE, LCAP-LCPDTH-DATE >= PAYMENT DATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-G-K-EXIT.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-G-K-NOASSESS.

      * TEST FOR SHORTAGE NOT GREATER
      * THAN THE DELINQUINCY FACTOR IN (SPR'S):
           IF LCAP-LCPDTH-DATE = PDTH-DATE-FULL
              IF LCAP-AMTNEEDED < LCHG-CURPAY
                 MOVE LCAP-AMTNEEDED TO LCAP-WRK2
                 IF SP-LCFRMLA = "G"
                    SUBTRACT LCAP-LCPAID FROM LCAP-WRK2
                 END-IF
                 IF LCAP-WRK2 < LCAP-DELFAC
                    GO TO LCAP-G-K-ADVANCE.

      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J"
      * SINCE LATE CHARGE IS BASED ON % OF DELINQUENT AMOUNT.
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE + LCHG-CHARGE
                                               - LCAP-TRAMT
              ADD LCAP-TRAMT TO LCAP-APP
                                LCAP-LCPAID
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
                                 LCAP-LCPAID
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-G-K-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
              COMPUTE LCAP-DELFAC ROUNDED =
                 SCHD-AMT(LCAP-PMT-NO) * (SP-LCDELFAC / 100)
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                                  LCHG-CURPAY.
           GO TO LCAP-G-K-BEGIN.

      * NO ASSESSMENT REQUIRED, ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU
      * IF IT WILL ADVANCE LCPDTH ONLY, SINCE
      * ADVANCEMENT OF LCPDTH COULD HAVED OCCURED
      * VIA TIME.
       LCAP-G-K-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE.

      * ? PAST MATURITY
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-G-K-EXIT.
           EXIT.

      **************************************************************
      *   SP-LCFRML = M   LA LATE CHARGE FORMULA
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE (MMDD.YY) AT EXIT)
      **************************************************************
       LCAP-M SECTION.
           MOVE LCAP-TOTPAYMNTD TO LCAP-PAYMNTD.
           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

           ADD LN-TOTLCHG LCAP-LPAPLC LCAP-LPAPINT GIVING LCAP-WRK.
           IF LCAP-WRK < LCAP-AMTNEEDED
              SUBTRACT LCAP-WRK FROM LCAP-AMTNEEDED.

      * SEE IF CONTRACTUAL PAID THRU IS LESS THAN LCPDTH,
      * IF SO SET AMTNEEDED TO REGULAR PAYMENT:
           MOVE LCAP-TOTPAYMNTD TO LCAP-WRK.
           COMPUTE PDTH-PAYMNTD LCAP-TOTPAYMNTD =
                             LCAP-TOTPAYMNTD + LN-TOTLCHG.
           PERFORM LCAP-CALC-PDTH.

           MOVE LN-REGPYAMT TO LCAP-UNPAID-PORTION.
           IF LCAP-TOTPAYMNTD < LN-1STPYAMT
              MOVE LN-1STPYAMT TO LCAP-UNPAID-PORTION.
           COMPUTE LCAP-UNPAID-PORTION ROUNDED =
              PDTH-REMAIN * LCAP-UNPAID-PORTION.

           IF LCAP-UNPAID-PORTION < LN-TOTLCHG
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
              IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                 MOVE LN-1STPYAMT TO LCAP-AMTNEEDED
              END-IF
              SUBTRACT LCAP-UNPAID-PORTION FROM LCAP-AMTNEEDED.
           MOVE LCAP-WRK TO LCAP-TOTPAYMNTD.

           IF LCAP-LST-CURDATE = 0
                     OR (LCAP-LST-CURDATE NOT = 0
                               AND LCAP-LST-CURDUE = 0)
              MOVE PDTH-DATE-FULL TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS < 0
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-M-CURRENT-PERIOD.

       LCAP-M-BEGIN.
      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT
      * UP TODATE, WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH)
      * IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-M-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE
                           LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-M-NOASSESS.

      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDATE TO NUM-DATE
                 MOVE PDTH-DATE-FULL   TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS < 0
                    MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 ELSE
                    IF LCAP-AMTNEEDED > LCAP-LST-CURDUE
                       MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
           IF LCAP-AMTNEEDED < LCAP-DELFAC
              GO TO LCAP-M-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = "C" OR "J", LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-M-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
           GO TO LCAP-M-BEGIN.

      *******************************************************
      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
      *******************************************************
       LCAP-M-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD.

           IF LCAP-LPTRCD NOT = "AL"
              ADD LN-TOTLCHG LCAP-LPAPLC LCAP-APP LCAP-LPAPINT
                                                 GIVING LCAP-WRK
              ADD LCAP-WRK TO PDTH-PAYMNTD
              COMPUTE PDTH-PAYMENTS = LCAP-WRK / LN-REGPYAMT
              IF PDTH-PAYMENTS > 1
                 COMPUTE PDTH-PAYMNTD =
                    PDTH-PAYMNTD - ( PDTH-PAYS * LN-REGPYAMT).

           IF LCAP-LPTRCD NOT = "AL"
              PERFORM LCAP-CALC-PDTH
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT < 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE
                 IF LCAP-UNPAID-PORTION NOT = 0
                          AND LCAP-UNPAID-PORTION < LCAP-DELFAC
                    PERFORM LCAP-UPD-LCPD.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    IF ELAPSED-DAYS > 0
                       MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE
                    ELSE
                       PERFORM LCAP-UPD-LCPD.

       LCAP-M-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE (MMDDYY) TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-M-CURRENT-PERIOD SECTION.
           MOVE " " TO LCAP-PRIOR-1STPY.
           MOVE 0   TO LCAP-CURDUE.
           ADD LCAP-LPAPLC LCAP-LPAPINT TO LCAP-TRAMT.

      * IF PAYMENT IS BEFORE 1ST PAYMENT IS DUE,
      * FORCE CURRENT DUE DATE TO 1 MONTH PRIOR TO
      * FIRST PAYMENT DUE DATE:
           MOVE LCAP-PAYDATE TO LCAP-CURDATE
                                NUM-DATE.
           MOVE LCAP-1STPYDATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS > 0
              MOVE "Y" TO LCAP-PRIOR-1STPY
              MOVE LCAP-1STPYDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-CURDATE
              GO TO LCAP-M-CURRENT-PERIOD-SETDUE.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *  SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *  LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-M-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:
       LCAP-M-CURRENT-PERIOD-SETDUE.
           IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
              GO TO LCAP-M-CURRENT-PERIOD-NEWCUR.
           MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
           IF LCAP-TRAMT < LCAP-LST-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                        GIVING LCAP-CURDUE
           ELSE
              MOVE 0 TO LCAP-CURDUE.
           MOVE 0 TO LCAP-LST-CURDATE
                     LCAP-LST-CURDUE.
           GO TO LCAP-M-CURRENT-PERIOD-EXIT.

       LCAP-M-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           MOVE LN-REGPYAMT TO LCAP-CURDUE.
           IF LN-1STPYAMT NOT = 0
              IF LCAP-CURDATE = LCAP-1STPYDATE
                 MOVE LN-1STPYAMT TO LCAP-CURDUE.

           IF LCAP-TRAMT < LCAP-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
              IF LCAP-CURDUE < LCAP-DELFAC
                 MOVE 0 TO LCAP-CURDUE
              END-IF
           ELSE
              MOVE 0 TO LCAP-CURDUE.

       LCAP-M-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.

           SUBTRACT LCAP-LPAPLC LCAP-LPAPINT FROM LCAP-TRAMT.

      ***********************************************
      *  SP-LCFRMLA = N   (MERCURY, NV)
      ***********************************************
       LCAP-N SECTION.

      * SETUP LATE CHARGES PAID INCLUSIVE OF
      * ANY SHORTAGES PAID TODAY.

       LCAP-N-DATE-CHK.

      * VERIFY DATES FOR ASSESSMENT
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-N-EXIT.

      * FOR THIS CODE, STOP ASSESSING WHEN LATE CHARGES
      * ARE BROUGHT UP TODATE
           IF LCAP-LPTRCD = "AL"
              PERFORM LCAP-ASSESS-CHK
              IF LCAS-ASSESS NOT = "Y"
                 GO TO LCAP-N-EXIT.
           PERFORM LCAP-ASSESS-CHK.
           IF (LCAS-ASSESS NOT = "Y")
                     OR (LCAP-TRAMT < LCAP-AMTNEEDED)
              GO TO LCAP-N-RETRY.

      * LCHG-LATE INITIALIZED FOR SP-LCTYPE = "C" OR "J",
      * WHERE LATE CHG IS BASED ON % OF LATE PMT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF TRAMT INSUFFICIENT TO COVER CHARGE, OWING IS FOUND:
           IF LCAP-TRAMT < LCHG-CHARGE
              SUBTRACT LCAP-TRAMT FROM LCHG-CHARGE GIVING LCAP-OWE
              ADD LCAP-TRAMT TO LCAP-APP
              PERFORM LCAP-UPD-LCPD
              GO TO LCAP-N-EXIT.

      * OTHERWISE, TAKE LATE CHARGE AND (ATTEMPT) PMT RECEIPT:
           ADD LCHG-CHARGE TO LCAP-APP.
           PERFORM LCAP-UPD-LCPD.

      * REDUCE TRANSACTION AMOUNT BY PAYMENT:
       LCAP-N-PMT.
           SUBTRACT LCAP-AMTNEEDED FROM LCAP-TRAMT.
           MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                               LCHG-CURPAY.
           GO TO LCAP-N-DATE-CHK.

       LCAP-N-RETRY.
           IF LCAP-TRAMT > LCAP-AMTNEEDED
              PERFORM LCAP-UPD-LCPD
              GO TO LCAP-N-PMT.

      * TEST TO SEE IF THE SHORTAGE IS NOT GREATER
      * THAN THE DELINQUINCY FACTOR, SETUP IN STATE PARAMETERS.
      *
           COMPUTE LCAP-WRK2 = LCAP-AMTNEEDED - LCAP-TRAMT.
           IF LCAP-WRK2 < LCAP-DELFAC
              PERFORM LCAP-UPD-LCPD.

       LCAP-N-EXIT.
           EXIT.

      **************************************************************
      *   SP-LCFRML = P    INDIANA   LATE CHARGE FORMULA (PRIN ONLY)
      *                    PACESETTERS
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE AT EXIT)
      **************************************************************
       LCAP-P SECTION.
           MOVE LCAP-TOTPAYMNTD TO LCAP-PAYMNTD.
           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

           ADD LN-TOTLCHG LCAP-LPAPLC LCAP-LPAPINT GIVING LCAP-WRK.
           IF LCAP-AMTNEEDED NOT = LCAP-UNPAID-PORTION
              SUBTRACT LCAP-WRK FROM LCAP-AMTNEEDED.

      *-----------------------------------------------------------
      * DETERMINE PAID THRU & AMD AMT-NEEDED, BASED ON
      *    LCAP-TOTPAYMNTD & LN-TOTLCHG.
      * IF REMAINING PORTION OF PAYMENT IS LESS THAN TOTAL LATE
      *    CHARGES PAID, SET FULL PAYMENT AS AMTNEEDED.
      *-----------------------------------------------------------
      * SAVE LCAP-TOTPAYMNTD:
           MOVE LCAP-TOTPAYMNTD TO LCAP-WRK.
           COMPUTE PDTH-PAYMNTD
                   LCAP-PAYMNTD
                   LCAP-TOTPAYMNTD = LCAP-TOTPAYMNTD + LN-TOTLCHG.
           PERFORM LCAP-PICK-PDTH-CALC.

           IF LN-PAY-SCHLD-FG = "Y"
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-WRK2
              COMPUTE LCAP-WRK2 ROUNDED = LCAP-REMAIN * LCAP-WRK2
           ELSE
              MOVE LN-REGPYAMT TO LCAP-WRK2
              IF LCAP-TOTPAYMNTD < LN-1STPYAMT
                 MOVE LN-1STPYAMT TO LCAP-WRK2
              END-IF
              COMPUTE LCAP-WRK2 ROUNDED =
                           PDTH-REMAIN * LCAP-WRK2.

           IF LCAP-WRK2 < LN-TOTLCHG
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              ELSE
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
      * RESTORE LCAP-TOTPAYMNTD:
           MOVE LCAP-WRK TO LCAP-TOTPAYMNTD.

      * IF LCAP-LST-CURDATE = 0 (121290 JTG)
      * IF NO LAST CURRENT DATE OR NO CURRENT DUE AND LATE
      * CHARGE PDTH AHEAD OF PAID THRU MOVE REGPAY OR SCHEDULE AMT TO
      * AMTNEEDED.
      
           IF LCAP-LST-CURDATE = 0 OR
               (LCAP-LST-CURDATE NOT = 0 AND LCAP-LST-CURDUE = 0)
              MOVE PDTH-DATE-FULL TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS < 0
                 IF LN-PAY-SCHLD-FG = "Y"
                    MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                 ELSE
                    MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-P-CURRENT-PERIOD.

       LCAP-P-BEGIN.
      * TEST IF LATE CHARGE PAID THRU (LCAP-LCPDTH) IS
      * ON OR AFTER MATURITY, IF SO EXIT:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-P-EXIT.

      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT
      * UP TODATE, WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH)
      * IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-P-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-P-NOASSESS.

      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDATE TO NUM-DATE
                 MOVE PDTH-DATE-FULL TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS < 0
                    MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 ELSE
                    IF LCAP-AMTNEEDED > LCAP-LST-CURDUE
                       MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
           IF LCAP-AMTNEEDED < LCAP-DELFAC
              GO TO LCAP-P-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = "C" OR "J", LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-P-ADVANCE.
      *UPDATE LATE CHARGE PAID THRU
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED
                                  LCHG-CURPAY.
           GO TO LCAP-P-BEGIN.

      *******************************************************
      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
      *******************************************************
       LCAP-P-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
              IF SP-LCFRMLA = "H"
                 ADD LCAP-APP TO PDTH-PAYMNTD
                                 LCAP-PAYMNTD.

      * IF LATE CHARGES, INTEREST TOTAL MORE THAN PAYMENT
      * RECOMPUTE PDTH PAYMENTS.
      * ??????? ON WHAT TO DO IF PAYMENT SCHEDULES:
           IF LCAP-LPTRCD NOT = "AL"
              IF SP-LCFRMLA = "P"
                 ADD LN-TOTLCHG LCAP-LPAPLC LCAP-APP LCAP-LPAPINT
                                                 GIVING LCAP-WRK
                 ADD LCAP-WRK TO PDTH-PAYMNTD
                                 LCAP-PAYMNTD
                 COMPUTE PDTH-PAYMENTS = LCAP-WRK / LN-REGPYAMT
                 IF PDTH-PAYMENTS > 1
                    COMPUTE PDTH-PAYMNTD
                            LCAP-PAYMNTD = PDTH-PAYMNTD
                                   - ( PDTH-PAYS * LN-REGPYAMT).

      * CALCULATE PAID THRU, IF SAME AS LATE CHARGE PAID
      * MOVE PDTH TO LATE PAID THRU, IF UNPAID LESS THAN DELFAC
      * UPDATE LATE CHARGE PAID THRU
           IF LCAP-LPTRCD NOT = "AL"
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT < 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE
                 IF LCAP-UNPAID-PORTION NOT = 0
                          AND LCAP-UNPAID-PORTION < LCAP-DELFAC
                    PERFORM LCAP-UPD-LCPD.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    IF ELAPSED-DAYS > 0
                       MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE
                    ELSE
                       PERFORM LCAP-UPD-LCPD.

      * ? PAST MATURITY,
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
       LCAP-P-MATURITY-TEST.
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-P-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE (MMDDYY) TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-P-CURRENT-PERIOD SECTION.
           MOVE " " TO LCAP-PRIOR-1STPY.
           MOVE 0 TO LCAP-CURDUE.
           ADD LCAP-LPAPLC LCAP-LPAPINT TO LCAP-TRAMT.

      * IF PAYMENT IS BEFORE 1ST PAYMENT IS DUE,
      * FORCE CURRENT DUE DATE TO 1 MONTH PRIOR TO
      * FIRST PAYMENT DUE DATE:
           MOVE LCAP-PAYDATE TO LCAP-CURDATE NUM-DATE.
           MOVE LCAP-1STPYDATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS > 0
              MOVE "Y" TO LCAP-PRIOR-1STPY
              MOVE LCAP-1STPYDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-CURDATE
              GO TO LCAP-P-CURRENT-PERIOD-SETDUE.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *  SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *  LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE    TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE  TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE    TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-P-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:
       LCAP-P-CURRENT-PERIOD-SETDUE.
           IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
              GO TO LCAP-P-CURRENT-PERIOD-NEWCUR.
           MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
           IF LCAP-TRAMT < LCAP-LST-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                        GIVING LCAP-CURDUE
           ELSE
              MOVE 0 TO LCAP-CURDUE.
           MOVE 0 TO LCAP-LST-CURDATE LCAP-LST-CURDUE.
           GO TO LCAP-P-CURRENT-PERIOD-EXIT.

       LCAP-P-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-1STPYDATE TO NUM-DATE
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM TIM360
              IF ELAPSED-MONTHS < 0
                 MOVE 0 TO ELAPSED-MONTHS
              END-IF
              ADD 1 ELAPSED-MONTHS GIVING LCAP
              MOVE SCHD-AMT(LCAP) TO LCAP-CURDUE
           ELSE
              MOVE LN-REGPYAMT TO LCAP-CURDUE
              IF LN-1STPYAMT NOT = 0
                 IF LCAP-CURDATE = LCAP-1STPYDATE
                    MOVE LN-1STPYAMT TO LCAP-CURDUE.

           IF LCAP-TRAMT < LCAP-CURDUE
              SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
           ELSE
              MOVE 0 TO LCAP-CURDUE.

       LCAP-P-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.

           SUBTRACT LCAP-LPAPLC LCAP-LPAPINT FROM LCAP-TRAMT.

      ***************************************************************
      *   SP-LCFRML = S    WISCONSIN LATE CHARGE FORMULA
      *                    WORKS LIKE "F" BUT WILL NOT TAKE
      *                    A LC AFTER MATURITY.
      *               T   WISCONSIN LATE CHARGE FORMULA
      *                   SAME AS 'S' BUT WITH TOTAL MONEY
      *
      *   NOTE:
      *        LCAP-PARTIALS (HOLDS LCAP-CURDUE AT EXIT)
      *        LCAP-LCPAID   (HOLDS LCAP-CURDATE [MMDD.YY] AT EXIT)
      ***************************************************************
       LCAP-S SECTION.
      * SET PMT-TO-DATE TEMP TO INCLUDE APPLIED TO INTEREST, CITIZENS FINANCE:
           ADD LCAP-TOTPAYMNTD LCAP-LPAPINT GIVING LCAP-PAYMNTD.

           MOVE LCAP-PARTIALS TO LCAP-LST-CURDUE.
      * REARRANGE LAST PAYDATE (MMDD.YY) INTO (MMDDYY):
           MULTIPLY LCAP-LCPAID BY 100 GIVING DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LCAP-CURDATE
                                 LCAP-LST-CURDATE.

      * SEE IF CONTRACTUAL PAID THRU IS LESS THAN LCPDTH,
      * IF SO SET AMTNEEDED TO REGULAR PAYMENT:
           MOVE PDTH-DATE-FULL TO SYS-DATE.
           PERFORM LCAP-LCPDTH-DATE-TEST.
           IF ELAPSED-DAYS < 0
              IF LN-PAY-SCHLD-FG = "Y"
                 MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
              ELSE
                 MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.

      * SETUP CURRENT PAYMENT AND LAST CURRENT PAYMENT,
      * SEE IF CURRENT PAYMENT IS ON TIME:
           PERFORM LCAP-S-CURRENT-PERIOD.

       LCAP-S-BEGIN.
      * TEST IF LATE CHARGE PAID THRU (LCAP-LCPDTH) IS
      * ON OR AFTER MATURITY, IF SO EXIT:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              GO TO LCAP-S-EXIT.

      * IS PAYMENT ON OF AFTER MATURITY+GRACE?
      *    IS THE LCPDTH GREATER THEN THE 2ND TO LST PAYDATE?
      *       IS THE PAYMENT MADE AFTER THE GRACE PERIOD?
      *          THEN ADVANCE LCPDTH TO MAT DATE AND DO NOT CHARGE LC
      
           MOVE MDTE-DATE TO NDTE-DATE.
           MOVE SP-LCGRACE TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           IF LCAP-PAYDATE > NDTE-DATE
              MOVE MDTE-DATE TO NDTE-DATE
              MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
              MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-UNITPER
              IF LCAP-LCPDTH-DATE NOT < NDTE-DATE
                 MOVE MDTE-DATE TO LCAP-LCPDTH-DATE
                 GO TO LCAP-S-EXIT.

      * ASSESSING LATE CHARGES? (AL)
      * IF SO, STOP ASSESSING WHEN LATE CHARGES ARE BROUGHT
      * UP TODATE, WHEN LATE CHARGE PAID THRU (LCAP-LCPDTH)
      * IS ON OR AFTER PAYDATE:
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS NOT > 0
                 GO TO LCAP-S-EXIT
              ELSE
                 MOVE 0 TO LCAP-CURDATE
                           LCAP-CURDUE.

      * DOES PAYMENT AND LCPDTH INDICATE AN ASSESSMENT ?
           PERFORM LCAP-ASSESS-CHK.
           IF LCAS-ASSESS NOT = "Y"
              GO TO LCAP-S-NOASSESS.

      * TEST FOR AMTNEEDED LESS THAN THE DELINQUINCY FACTOR
      * IN (SPR'S), IF SO ASSESS NO LATE CHARGE:
      * TEST FOR LAST CURRENT PAYMENT:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS = 0
                 MOVE LCAP-LST-CURDUE TO LCAP-AMTNEEDED
                 IF LCAP-LST-CURDUE < LCAP-DELFAC
                    GO TO LCAP-S-ADVANCE.

      * DETERMINE THE AMOUNT OF THE LATE CHARGE:
      * IF SP-LCTYPE = 'C', LCHG-LATE IS INITIALIZED,
      * SINCE LATE CHARGE IS BASED ON % OF AMOUNT DELINQUENT:
           MOVE LCAP-AMTNEEDED TO LCHG-LATE.
           MOVE LCAP-LCPDTH-DATE TO LCHG-LCPDTH-DATE.
           PERFORM LCAP-CALC-TEST.

      * IF LCAP-TRAMT IS NOT ENOUGH TO COVER CHARGE, USE OWING:
           IF LCAP-TRAMT < LCHG-CHARGE
              COMPUTE LCAP-OWE = LCAP-OWE +
                                  (LCHG-CHARGE - LCAP-TRAMT)
              ADD LCAP-TRAMT TO LCAP-APP
              MOVE 0 TO LCAP-TRAMT
           ELSE
              ADD LCHG-CHARGE TO LCAP-APP
              SUBTRACT LCHG-CHARGE FROM LCAP-TRAMT.

       LCAP-S-ADVANCE.
           PERFORM LCAP-UPD-LCPD.
           IF LN-PAY-SCHLD-FG = "Y"
              ADD 1 TO LCAP-PMT-NO
              MOVE SCHD-AMT(LCAP-PMT-NO) TO LCAP-AMTNEEDED
                                            LCHG-CURPAY
           ELSE
              MOVE LN-REGPYAMT TO LCAP-AMTNEEDED.
           GO TO LCAP-S-BEGIN.

      * NO ASSESSMENT IS REQUIRED; ADVANCE LCAP-LCPDTH-DATE
      * TO WHERE PAYMENTS TODATE ARE PAID THRU, ONLY
      * IF IT WILL ADVANCE LCPDTH, SINCE LCPDTH COULD
      * HAVE ADVANCED BEYOND PAID THRU VIA TIME.
       LCAP-S-NOASSESS.
           IF LCAP-LPTRCD NOT = "AL"
              ADD LCAP-TRAMT LCAP-PAYMNTD GIVING PDTH-PAYMNTD
                                                 LCAP-PAYMNTD
              PERFORM LCAP-PICK-PDTH-CALC
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 MOVE PDTH-DATE-FULL TO LCAP-LCPDTH-DATE.

      * INSURE THAT LCPDTH ADVANCES TO CURRENT PAYMENT DATE
      * IF  CURRENT  PAYMENT IS NOT DELIQUENT:
           IF LCAP-CURDATE NOT = 0
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS > 0
                 IF LCAP-CURDUE < LCAP-DELFAC
                    MOVE LCAP-CURDATE TO LCAP-LCPDTH-DATE.

      * ? PAST MATURITY,
      * IF SO FORCE LCAP-LCPDTH-DATE TO MATURITY:
           PERFORM LCAP-MDTE-CHK.
           IF ELAPSED-DAYS NOT > 0
              MOVE SYS-DATE TO LCAP-LCPDTH-DATE.

       LCAP-S-EXIT.
           MOVE LCAP-CURDUE TO LCAP-PARTIALS.
      * REARRANGE DATE TO (MMDD.YY):
           MOVE LCAP-CURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MULTIPLY DATE-MMDDYY BY 0.01 GIVING LCAP-LCPAID.

      ***********************************************
      *    TEST CURRENT PAYMENT ON TIME
      *
      *    IF SO, ESTABLISH WHETHER ITS A NEW PERIOD
      *    OR LAST PAYMENT PERIOD AND SETUP AMOUNTS
      *    DELIQUENT FOR LAST OR BOTH PERIODS.
      ***********************************************
       LCAP-S-CURRENT-PERIOD SECTION.
           MOVE 0 TO LCAP-CURDUE.
           MOVE LCAP-PAYDATE TO LCAP-CURDATE.

      * IF TODAY IS ON OR AFTER PAYMENT DUE DATE OF THIS MONTH,
      *    SET UP THIS MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      * IF THE PAYMENT CAME IN BEFORE THIS MONTHS DUE DATE, SET UP
      *    LAST MONTHS DUE DATE TO SEE IF THE PAYMENT WAS ON TIME:
      *
           IF LCAP-CURDATE-DD NOT < LCAP-1STPYDATE-DD
              MOVE -1 TO NDTE-HOLD
           ELSE
              MOVE -2 TO NDTE-HOLD.

           MOVE LCAP-1STPYDATE-DD TO LCAP-CURDATE-DD.
           MOVE LCAP-CURDATE TO NDTE-DATE.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * TEST TO SEE IF THE PAYMENT WAS MADE ON TIME:
           MOVE LCAP-CURDATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
           IF LCAS-ASSESS = "Y"
              MOVE 0 TO LCAP-CURDATE
              GO TO LCAP-S-CURRENT-PERIOD-EXIT.

      * PAYMENT WAS ON TIME, SO SET IT UP AS CURRENT PAYMENT:
           MOVE LCAP-CURDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO LCAP-CURDATE.

      * IF CURRENT PAYDATE IS THE SAME AS LAST CURRENT PAYDATE,
      * SET CURRENT PAYMENT DATE TO LAST CURRENT PAYMENT DATE,
      * MAKE CURRENT DUE EQUAL TO REDUCED LAST CURRENT DUE:
              IF LCAP-CURDATE NOT = LCAP-LST-CURDATE
                 GO TO LCAP-S-CURRENT-PERIOD-NEWCUR.
              MOVE LCAP-LST-CURDATE TO LCAP-CURDATE.
              IF LCAP-TRAMT < LCAP-LST-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-LST-CURDUE
                                           GIVING LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.
              MOVE 0 TO LCAP-LST-CURDATE
                        LCAP-LST-CURDUE.
              GO TO LCAP-S-CURRENT-PERIOD-EXIT.

       LCAP-S-CURRENT-PERIOD-NEWCUR.
      * SET UP AMOUNT LATE CHARGES CAN STILL BE CALCULATED ON:
           IF LN-PAY-SCHLD-FG = "Y"
              MOVE LCAP-1STPYDATE TO NUM-DATE
              MOVE LCAP-CURDATE TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-MONTHS < 0
                 MOVE 0 TO ELAPSED-MONTHS
              END-IF
              ADD 1 ELAPSED-MONTHS GIVING LCAP
              MOVE SCHD-AMT(LCAP) TO LCAP-CURDUE
           ELSE
              MOVE LN-REGPYAMT TO LCAP-CURDUE
              IF LN-1STPYAMT NOT = 0
                 IF LCAP-CURDATE = LCAP-1STPYDATE
                    MOVE LN-1STPYAMT TO LCAP-CURDUE.

              IF LCAP-TRAMT < LCAP-CURDUE
                 SUBTRACT LCAP-TRAMT FROM LCAP-CURDUE
              ELSE
                 MOVE 0 TO LCAP-CURDUE.

       LCAP-S-CURRENT-PERIOD-EXIT.
      * SET LAST CURRENT DATE BACK ONE MONTH TO ALLOW
      * COMPARISON WITH LCPDTH:
           IF LCAP-LST-CURDATE NOT = 0
              MOVE LCAP-LST-CURDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO LCAP-LST-CURDATE.


      *********************************************************
      *
      *   SHARED LATE CHARGE SECTIONS
      *
      *********************************************************
       LCAP-CALC-PDTH SECTION.
           MOVE LCAP-1STPYDATE TO PDTH-DATE-FULL.
           MOVE 0 TO NDTE-HOLD
                     LCAP-PDTH-PAYMENTS.
           MOVE PDTH-PAYMNTD TO LCAP-UNPAID-PORTION.

           IF LN-1STPYAMT NOT = 0
              IF PDTH-PAYMNTD > LN-1STPYAMT
                 SUBTRACT LN-1STPYAMT FROM PDTH-PAYMNTD
                                           LCAP-UNPAID-PORTION
                 MOVE 1 TO NDTE-HOLD
              ELSE
                 COMPUTE PDTH-PAYMENTS ROUNDED =
                                    PDTH-PAYMNTD / LN-1STPYAMT
                 GO TO LCAP-COMPUTE-PAYS.

           IF LN-REGPYAMT NOT = 0
              COMPUTE PDTH-PAYMENTS ROUNDED =
                                    PDTH-PAYMNTD / LN-REGPYAMT
              MOVE PDTH-PAYMENTS TO LCAP-PDTH-PAYMENTS
              COMPUTE LCAP-UNPAID-PORTION = LCAP-UNPAID-PORTION
                           - (LCAP-PDTH-PAYMENTS * LN-REGPYAMT)
              ADD NDTE-HOLD TO LCAP-PDTH-PAYMENTS.

       LCAP-COMPUTE-PAYS.
           COMPUTE NDTE-HOLD ROUNDED =
              NDTE-HOLD + LN-TOTNODEF + LN-TOTNOALDEL
                                             - 1 + PDTH-PAYS.

      * UPDATE PDTH-DATE BY ADDING # OF FULL
      * PAYMENTS MADE TO 1STPYDATE IN PDTH-DATE-WORK:
      *
           MOVE PDTH-DATE-FULL TO NDTE-DATE.
      * CHANGED TO CORRECT CYCLE OF DUE ON 30TH RE: FEB
           IF LN-UNITPER-CD = "M"
              MOVE LN-1STPYDA TO NDTE-DD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE TO PDTH-DATE-FULL.

      * TEST FOR ADJUSTMENT IN AMOUNT NEEDED,
      * IF LATE CHARGES ARE PAID AHEAD OF PDTH:
      *
           IF SP-LCFRMLA = "D" OR "G" OR "K"
              MOVE PDTH-DATE-FULL TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS < 0
                 MOVE 0 TO PDTH-REMAIN.

           IF NOT (SP-LCFRMLA = "F" OR "I" OR "L" OR "M"
                                    OR "P" OR "H" OR "S")
              GO TO LCAP-CALC-PDTH-EXIT.

      * DETERMINE AMT NEEDED TO COMPLETE A FULL PMT:
           MOVE LN-REGPYAMT TO LCAP-UNPAID-PORTION.
           IF LCAP-TOTPAYMNTD < LN-1STPYAMT
              MOVE LN-1STPYAMT TO LCAP-UNPAID-PORTION.
           COMPUTE LCAP-UNPAID-PORTION ROUNDED =
              (1 - PDTH-REMAIN) * LCAP-UNPAID-PORTION.

       LCAP-CALC-PDTH-EXIT.
           EXIT.

      *****************************************************
      *    CALCULATE PATH WITH ADDONS
      *****************************************************
       LCAP-CALC-PDTH-ADDON SECTION.
           MOVE 0 TO LCAP-PAYMENTS.
           MOVE LCAP-1STPYDATE TO PDTH-DATE-FULL.
           PERFORM GET-LT-P-REC.
           IF IO-FG = 9
              GO TO IO-ERROR
           ELSE
              MOVE 0 TO NDTE-HOLD
              MOVE 1 TO LCAP
              MOVE LTP-SCHLD-PAYMNT(1) TO LCAP-CUR-SCHD-PAY
              PERFORM LCAP-PAID-THRU-ADDON-SUM
                 UNTIL LCAP > 17
                          OR LCAP-PAYMNTD = 0.

           COMPUTE NDTE-HOLD ROUNDED =
              NDTE-HOLD + LN-TOTNODEF + LN-TOTNOALDEL - 1.

      * UPDATE PDTH-DATE BY ADDING # OF FULL
      * PAYMENTS MADE TO 1STPYDATE IN PDTH-DATE-WORK:
      *
           MOVE PDTH-DATE-FULL TO NDTE-DATE.
      * CHANGED TO CORRECT CYCLE OF DUE ON 30 RE: FEB
           IF LN-UNITPER-CD = "M"
              MOVE LN-1STPYDA TO NDTE-DD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE TO PDTH-DATE-FULL.

      * TEST FOR ADJUSTMENT IN AMOUNT NEEDED,
      * IF LATE CHARGES ARE PAID AHEAD OF PDTH:
      
           IF SP-LCFRMLA = "D" OR "G" OR "K"
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
              IF ELAPSED-DAYS < 0
                 MOVE 0 TO PDTH-REMAIN.

           IF LCAP-REMAIN = 0
              MOVE LCAP-CUR-SCHD-PAY TO LCAP-UNPAID-PORTION
           ELSE
              COMPUTE LCAP-UNPAID-PORTION ROUNDED =
                  LCAP-CUR-SCHD-PAY * (1 - LCAP-REMAIN).

      *************************************************
       LCAP-PAID-THRU-ADDON-SUM SECTION.
      *************************************************
           IF LTP-SCHLD-TERM(LCAP) = 0
              MOVE 17 TO LCAP
              GO TO LCAP-PAID-THRU-ADDON-SUM-EXIT.

           COMPUTE LCAP-WORKER =
                     LTP-SCHLD-PAYMNT(LCAP) * LTP-SCHLD-TERM(LCAP).
           MOVE LTP-SCHLD-PAYMNT(LCAP) TO LCAP-CUR-SCHD-PAY.
           IF LCAP-PAYMNTD > LCAP-WORKER
              ADD LTP-SCHLD-TERM(LCAP) TO NDTE-HOLD
              SUBTRACT LCAP-WORKER FROM LCAP-PAYMNTD
              GO TO LCAP-PAID-THRU-ADDON-SUM-EXIT.

           MOVE 0 TO LCAP-CNT.
       LCAP-PAID-THRU-ADDON-NEXT.
           IF LCAP-CNT < LTP-SCHLD-TERM(LCAP)
              IF LCAP-PAYMNTD > LTP-SCHLD-PAYMNT(LCAP)
                 SUBTRACT LTP-SCHLD-PAYMNT(LCAP) FROM LCAP-PAYMNTD
                 ADD 1 TO NDTE-HOLD
                          LCAP-CNT
                 GO TO LCAP-PAID-THRU-ADDON-NEXT
              ELSE
                 COMPUTE LCAP-PAYMENTS ROUNDED =
                            LCAP-PAYMNTD / LTP-SCHLD-PAYMNT(LCAP)
                 IF LCAP-PAYMNTD = LTP-SCHLD-PAYMNT(LCAP)
                            AND LTP-SCHLD-TERM(LCAP) = (LCAP-CNT + 1)
                    MOVE LTP-SCHLD-PAYMNT(LCAP + 1) TO LCAP-CUR-SCHD-PAY
                    ADD 1 TO NDTE-HOLD
                             LCAP-CNT
                    MOVE 0 TO LCAP-PAYMNTD
                 ELSE
                 IF LCAP-PAYMNTD = LTP-SCHLD-PAYMNT(LCAP)
                    ADD 1 TO NDTE-HOLD
                             LCAP-CNT
                 END-IF
                    MOVE 0 TO LCAP-PAYMNTD
           ELSE
              MOVE 0 TO LCAP-PAYMNTD.

       LCAP-PAID-THRU-ADDON-SUM-EXIT.
           ADD 1 TO LCAP.

      *********************************************************
      * ADVANCE LCAP-LCPDTH-DATE BY ONE PAYMENT FREQUENCY:
      *********************************************************
       LCAP-UPD-LCPD SECTION.
           MOVE LCAP-LCPDTH-DATE TO NDTE-DATE NUM-DATE.

      * CHANGED TO CORRECT CYCLE OF DUE ON 30 RE: FEB
           IF LN-UNITPER-CD = "M"
              MOVE LN-1STPYDA TO NDTE-DD.
           MOVE 1 TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.

      * NOTE: WHEN SEMI MONTHLY WITH FIRST PAYDATE OF 14TH OR 15TH,
      *       THE INCREMENT OF LCPDTH WILL GO TO 02/28/YY OR 02/29/YY
      *       WHEN LCPDTH WAS INCREMENTED FROM 02/14/YY OR 02/15/YY.
      *       THE FOLLOWING LOGIC RE-ESTABLISHES CYCLES BACK TO
      *       THE 14TH OR 15TH.
      *12/06/05 ADDED TESTS ON DUE DATE OF 29 OR 30 OR 31. WAS NOT SETTING
      *         LCPDTH CORRECT IN THE FOLLOWING EXAMPLE:
      *         1STPYDA = 30, LCPDTH 2/28, PDTHRU 2/15, CYCLE DATES 15/30
      *         POSTING A 'PY' ADVANCED 1 UNITPER TO 3/13 SHOULD BE 3/15
      *         TO CORRECT: NUM-DATE HOLDS LCPDTH PRIOR TO INCREMENT UNITPER
      *         NDTE-DATE IS LCPDTH AFTER INCREMENT. NUM-DATE IS 2/28, NDTE
      *         DATE IS 3/13... GETS # OF DAYS BETWEEN THE 28TH OR 29 & 1ST
      *         PYDA & ADDS THEM TO THE CALCULATED LCPDTH(3/13 + 2) TO RESET
      *         CYCLE.
           IF LN-UNITPER-CD = "S"
              IF (LN-1STPYDA = 14 OR 15)
                 IF (NUM-DA = 28 OR 29) AND NDTE-MM = 03
                    MOVE LN-1STPYDA TO NDTE-DD
                 END-IF
              ELSE
              IF (LN-1STPYDA = 29 OR 30 OR 31)
                 IF (NUM-DA = 28 OR 29) AND NDTE-MM = 03
                    SUBTRACT NUM-DA FROM LN-1STPYDA GIVING NDTE-HOLD
                    PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE TO LCAP-LCPDTH-DATE.


      ****************************************************
      * ASSURE LATE CHARGE PAID THRU HAS VALID DAY:
      ****************************************************
       LCAP-ASSURE-LCPDTH SECTION.
           IF LN-UNITPER-CD = "M" AND LN-1STPYDA > 28
              MOVE LCAP-LCPDTH-DATE TO NDTE-DATE
              MOVE LN-1STPYDA  TO NDTE-DD
              PERFORM NEW-DATE-CALCULATION
              MOVE NDTE-DATE   TO LCAP-LCPDTH-DATE.

      ****************************************************
      * COMPARE LCAP-LCPDTH-DATE (UPDATED) WITH MATURITY DATE:
      ****************************************************
       LCAP-MDTE-CHK SECTION.
           MOVE MDTE-DATE TO SYS-DATE.
           PERFORM LCAP-LCPDTH-DATE-TEST.

      ****************************************************
      * FOR THIS CODE, STOP ASSESSING WHEN LATE CHARGES
      * ARE BROUGHT UP TO DATE (DETERMINED BY LCAP-PAYDATE):
      * IF NOT AL, ELAPSED SET TO 1 FOR UNIFORM EXIT CHECK
      ****************************************************
       LCAP-AL-CHECK SECTION.
           IF LCAP-LPTRCD = "AL"
              MOVE LCAP-PAYDATE TO SYS-DATE
              PERFORM LCAP-LCPDTH-DATE-TEST
           ELSE
              MOVE 1 TO ELAPSED-DAYS.

      ****************************************************
      * DOES LCAP-LCPDTH-DATE INDICATE A LATE CHARGE?
      ****************************************************
       LCAP-ASSESS-CHK SECTION.
           MOVE LCAP-LCPDTH-DATE TO LCAS-LCPDTH-DATE.
           MOVE LCAP-1STPYDATE TO LCAS-1STPYDATE.
           MOVE LCAP-PAYDATE TO LCAS-PAYDATE.
           PERFORM LATE-ASSESS-ROUTINE.
      * ADDED SET OF LCHG-DAYS-AFTER-DUE PER MULLEN #804 LCTYPE = 'Q'
           MOVE LCAS-ELAPSED-DAYS TO LCHG-DAYS-AFTER-DUE.

      ****************************************************
      * TEST ELAPSED AGAINST LCAP-LCPDTH-DATE:
      ****************************************************
       LCAP-LCPDTH-DATE-TEST SECTION.
           MOVE LCAP-LCPDTH-DATE TO NUM-DATE.
           PERFORM TIM365.

      ****************************************************
      * TEST IF THE ACCOUNT IS ON AN ALLOTMENT PLAN
      *         OR POSTING WITH A BATCH REFCD
      * AND SHOULD LATE CHARGES SHOULD NOT BE CHARGED:
      ****************************************************
       LCAP-CALC-TEST SECTION.
           IF ( ( LCAP-BATCH-REFCD NOT = " "        ) AND
                ( LCAP-BATCH-REFCD NOT = LOW-VALUES ) AND
                ( LCAP-BATCH-REFCD-LC-FG NOT = "Y"  ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( ( LCAP-BATCH-REFCD = " "          ) OR
                  ( LCAP-BATCH-REFCD = LOW-VALUES   )
                )
               AND
                ( LN-ALLOTCD = "Y"                   ) AND
                ( BR-LATECHG-ON-ALLOTMENTS NOT = "Y" ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( ( LCAP-BATCH-REFCD = " "          ) OR
                  ( LCAP-BATCH-REFCD = LOW-VALUES   )
                )
               AND
                ( LN-LBOX = "Y"                ) AND
                ( BR-LATECHG-ON-LBOX NOT = "Y" ) AND
                ( ( LCAP-LPTRCD = "PA" ) OR
                  ( LCAP-POFF-LPTRCD = "PO" AND LCAP-LPTRCD = "AL" )
                )
              )
             OR
              ( ( LCAP-POFF-LPTRCD = "PB" OR "RN" OR
                                     "SC" OR "RB" OR "RO" ) AND
                ( SP-RBSPOPT1(7) = 19                     ) AND
                ( LCAP-NOLCHG    = 2                      )
              )
              MOVE 0 TO LCHG-CHARGE
           ELSE
              PERFORM LATE-CHARGE-CALCULATION
              ADD 1 TO LCAP-NOLCHG.

      ****************************************************
      * DETERMINE WHICH PAID THRU CALCULATION TO PERFORM
      ****************************************************
       LCAP-PICK-PDTH-CALC SECTION.
           IF LN-PAY-SCHLD-FG = "Y"
              PERFORM LCAP-CALC-PDTH-ADDON
           ELSE
              PERFORM LCAP-CALC-PDTH.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLCAP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPMDTE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPMDTE
      ********************************************************************
      *         MATURITY DATE CALCULATION
      *
      *   NAME: LPMDTE
      *   DESC: COMPUTES THE MATURITY DATE OF THE LOAN.
      *
      *         N O T E:
      *                 REMEMBER TO CHANGE LPMDTEPD
      *
      *   IN  : MDTE-FLAG
      *         MDTE-ORGTERM-FG
      *
      *         IF MDTE-FLAG         ' '   - UPDATED MATURITY  IS RETURNED
      *                              'Y'   - ORIGINAL MATURITY IS RETURNED
      *                                         (NO DEFERMENTS ADDDED IN)
      *
      *         IF MDTE-ORGTERM-FG   'Y'   - THE LOANS ORIGINAL TERM
      *                                      IS USED IN THE CALCULATIONS
      *                                      INSTEAD OF THE EXTENDED
      *                                      ADDON TERM
      *
      *         IF MDTE-DC-FLAG      ' '   - DUE DATE CHANGES AFFECT MATURITY
      *                                       (USES LN-1STPYDATE)
      *                              'Y'   - DUE DATE CHANGES HAVE NO AFFECT
      *                                       (USED LN-ORIG-1STPYDATE)
      *                 SET TO 'Y' USING SP-EXPD-FRMLA "B"
      *
      *      NOTE:
      *           MDTE-FLAG, MDTE-ORGTERM-FG, AND MDTE-DC-FLAG ARE
      *           CLEARED TO SPACES, UPON EXIT.
      *
      *   OUT : MDTE-DATE
      *   USED: LN-ORGTERM, LN-DEFMNTS, LN-1STPYDATE, LN-SUM-ORGTERM,
      *                                 LN-ORIG-1STPYDATE
      *   COPY: LPMDTEW, LPNDTE, LPNDTEW, INCRMM.
      *
      * REV :
      *  JTG 032188 ADDED LOGIC FOR COMPUTATION OF UPDATED MATURITY
      *             OR ORIGINAL MATURITY
      *  JTG 080990 ADDED USAGE OF LN-SUM-ORGTERM
      *  JTG 071896 ADDED LOGIC FOR UNIT PERIODS
      *  BAH 050218 ADDED MDTE-DC-FLAG SO DUE DATE CHANGES DONT AFFECT
      *             MATURITY DATE BY USING LN-ORIG-1STPYDATE, LENDMARK PL# 463
      ********************************************************************
       MATURITY-DATE-CALCULATION SECTION.

           MOVE LN-1STPYDATE TO NDTE-DATE.

      * SO DUE DATE CHANGES DONT AFFECT MATURITY, LENDMARK PL# 463
           IF MDTE-DC-FLAG = "Y"
              MOVE LN-ORIG-1STPYDATE TO NDTE-DATE.

           MOVE 0 TO NDTE-HOLD.
           IF MDTE-FLAG = " "
              MOVE LN-TOTNODEF TO NDTE-HOLD.

           IF MDTE-ORGTERM-FG = "Y"
              COMPUTE NDTE-HOLD = NDTE-HOLD + (LN-ORGTERM - 1)
           ELSE
              COMPUTE NDTE-HOLD = NDTE-HOLD + (LN-SUM-ORGTERM - 1).
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE TO MDTE-DATE.
           MOVE " " TO MDTE-FLAG
                       MDTE-ORGTERM-FG
                       MDTE-DC-FLAG.
      *================================================================*
      * END COPYBOOK: LIBLP\LPMDTE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPITRM.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPITRM
      *************************************************************
      *          INSURANCE TERM CALCULATION
      *                     AND
      *      TEST FOR THE INSURANCE IN EFFECT TODAY
      *
      *   NAME:  LPITRM
      *   DESC:  THIS ROUTINE COMPUTES THE TERM OF THE INSURANCE
      *          FROM THE EFFDATE THRU EXPDATE.
      *          ALSO DETERMINES IF THE INSURANCE IS INEFFECT TODAY.
      *
      *   IN  :  ITRM-SUB         - LN-INSURANCE LEVEL
      *          ITRM-TODAY       - TODAYS DATE
      *             NOTE: IF ITRM-TODAY = 0
      *                   INSURANCE INEFFECT IS NOT TESTED.
      *
      *   OUT :  ITRM-INSTERM     - TERM OF INSURANCE
      *          ITRM-INEFFECT-FG - "Y" INSURANCE INEFFECT
      *
      *   USED:  LN-INSEFF-DATE(ITRM-SUB), LN-INSEXP-DATE(ITRM-SUB)
      *          LN-REBATE(ITRM-SUB1)
      *   COPY:  LPITRMW
      * REV:
      *  JTG 082890 CHANGED TO TEST PREMIUM NOT COVERAGE
      *  BAH 012792 INSURANCE EXPIRES AT 12:01AM THE DAY OF EXPIRATION!
      *  JTG 071295 CHANGED TO CALCULATE ON ALL INSURANCES
      *  JTG 071696 CHANGED TO WORK WITH UNIT PERIODS
      *  BAH 110397 CHANGED TO USE TIM360(LIKE A48) FOR "M" MONTHLY ACCOUNTS,
      *             BECAUSE 10/31/97 TERM 18, 1STPYDATE 11/30/97, MDTE
      *             4/30/99 WAS CAUSING INSURANCE TERM OF 17....
      *  BAH 990720 ADDED SP-RBSPOPT2 = 8, INSURANCE ORGTERM SWING ON 16 DAYS
      *             FOR REGACC, PR# 911
      ******************************************************************
       INS-TERM-CALCULATION SECTION.
           MOVE 0 TO ITRM-INSTERM.
           MOVE SPACES TO ITRM-INEFFECT-FG.

           IF ITRM-SUB = 0
            OR ITRM-SUB > 10
             OR LN-INSCOMP(ITRM-SUB) = 0
               OR LN-INSCOVR(ITRM-SUB) = 0
                  GO TO ITRM-EXIT.
      *******************************************
      * SETUP SPR SUBSCRIPT
      *******************************************
           IF ITRM-SUB = 1
              IF LN-INSURED = "J"
                 MOVE 2 TO ITRM-SUB1
              ELSE
                 MOVE 1 TO ITRM-SUB1
              END-IF
              IF LN-INSTYPES-LL
                 ADD 2 TO ITRM-SUB1
              END-IF
           ELSE
      * A&H
              IF ITRM-SUB = 2
                 MOVE 5 TO ITRM-SUB1
              ELSE
      * PROPERTY
                 IF ITRM-SUB = 3
                    MOVE 6 TO ITRM-SUB1
                 ELSE
      * OTHER 1
                    IF ITRM-SUB = 4
                       MOVE 12 TO ITRM-SUB1
                    ELSE
      * OTHER 2
                       IF ITRM-SUB = 5
                          MOVE 13 TO ITRM-SUB1
                       ELSE
      * OTHER 3
                          MOVE 14 TO ITRM-SUB1.


      *******************************************
      *    COMPUTE INSURED TERM:
      *******************************************
           MOVE LN-INSEFF-DATE(ITRM-SUB) TO NUM-DATE.
           MOVE LN-INSEXP-DATE(ITRM-SUB) TO SYS-DATE.
           IF LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1
              PERFORM TIM360
              MOVE ELAPSED-MONTHS TO ITRM-INSTERM
           ELSE
              MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
              MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
              PERFORM TIMUPER
              MOVE ELAPSED-UNITPER TO ITRM-INSTERM.
      *******************************************
      * TEST FOR SPECIAL SWING DAYS OPTION
      *******************************************
           IF SP-RBSPOPT2(ITRM-SUB1) = 8
              IF ELAPSED-REM NOT < SP-RBDAYS(ITRM-SUB1 2)
                 ADD 1 TO ELAPSED-MONTHS ITRM-INSTERM.

      *******************************************
      *    TEST FOR INEFFECT TODAY:
      *******************************************
      * SET LN-REBATE-TAB SUBSCRIPT:
      *    1- CL    9- O1  12- O4  15- O7
      *    2- AH   10- O2  13- O5
      *    3- PP   11- O3  14- O6

           IF ITRM-TODAY = 0
              GO TO ITRM-EXIT.
           MOVE ITRM-SUB TO ITRM-SUB1.
           IF ITRM-SUB1 > 3
              ADD 5 TO ITRM-SUB1.

           IF LN-REBATE(ITRM-SUB1) = " "
              IF LN-INSEXP-DATE(ITRM-SUB) > ITRM-TODAY
                 MOVE "Y" TO ITRM-INEFFECT-FG.

       ITRM-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPITRM.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAMTS.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAMTS
      ********************************************************************
      *          LOAN CALCULATIONS   (DUPLICATE OF LPDAMTS)
      *
      *   NAME:  LPAMTS
      *          N O T E: LPDAMTS NEEDS TO BE CHANGED IF
      *                   THIS ROUTINE CHANGES.
      *
      *   DESC:  GENERALIZED LOAN CALCULATIONS USING LN-RECORD
      *
      *   IN  :  SPR MUST BE READ FOR INT-CHARGEABLE
      *   OUT :  TOTAL-REPAY      - TOTAL REPAYABLE
      *          TOTAL-NOTE       - TOTAL REPAYABE LESS EXTCHG
      *                                        LESS MAINT.FEES
      *          PRINCIPLE        - LOAN AMOUNT
      *          ADJ-PRINCIPAL    - TOTAL-NOTE - INTEREST CHARGE
      *          CASH-ADVANCE     - TOTAL-NOTE - INTCHG - SERCHG
      *                                        - ALL INSPREMS
      *          SPCASH-ADVANCE   - CASH-ADVANCE + SERCHG
      *          FINANCED-AMOUNT  - AMOUNT APR IS COMPUTED ON
      *          DISCLOSED-FINAMT - AMOUNT DISCLOSED AS FINANCED
      *          INT-CHARGEABLE   - AMOUNT INTEREST IS CALC'D ON
      *          TOTAL-INSPREM-NONMEMO - TOTAL INS PREMIUMS THAT ARE NON MEMO
      *          TOTAL-INSFINCHG  - TOTAL INS PREMIUMS THAT ARE FINANCE CHARGES
      *          TOTAL-FEEFINCHG  - TOTAL FEES THAT ARE FINANCE CHARGES
      *          TOTAL-INS-TAX    - TOTAL FEES THAT ARE INSURANCE SALES TAX
      *          HIGH-CREDIT      - CASH-ADVANCE - ALL FEES
      *          CREDIT-LIMIT     - LOANS SET CREDIT-LIMIT RE: REVOLVING
      *          NONMEMO-INS      - NON MEMO INSURANCES
      *          NONMEMO-FEES     - NON MEMO FEES
      *          INSUR-OURS       - OUR INSURANCES
      *          FEES-OURS        - OUR FEES
      *          LIVE-CHECK-FEES  - FEES ON LIVE CHECK LOAN
      *
      * REV:
      *  071586 JTG ADDED CASH ADVANCE ROUTINE
      *  090586 JTG ADDED FINANCED-AMOUNT ROUTINE
      *  030287 JTG ADDED DISCLOSED-FINAMT ROUTINE
      *  062987 JTG CHANGED P.C. FINANCED-AMOUNT TO USE
      *             TOTAL-REPAY INSTEAD OF LN-LNAMT
      *  030888 BAW ADDED ADJ-PRINCIPAL
      *  102688 SLC NOW CALCULATES HIGH CREDIT.
      *  081689 BAH ADDED INT-CHARGEABLE
      *  041392 JTG CORRECTED (IB) INT-CHARGEABLE
      *  033195 JTG REMOVED REF: NOODDPY
      *  061995 JTG CHANGED TO ADD A 10 INSURANCES
      *  020896 JTG CHANGED TO PERFORM VARYING LOGIC TO GET NON MEMO FEE
      *             AND NON MEMO INSURANCE
      *  111296 JTG CHANGED LN-INSTBL (LEVEL'S 9 & 10) TO FILLER
      *  073197 JTG ADDED LOGIC FOR TOTAL-FEEFINCHG AND TOTAL-INSFINCHG
      *  022398 BAH ADDED INSUR-OURS AND FEES-OURS FOR DISC FRMLA (5)
      *  JTG 990727 ADDED CREDIT-LIMIT FOR LIBWI/LNAPPROVAL RE: REVOLVING
      *  JTG 020620 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *             ADDED TOTAL-INSPREM-NONMEMO FOR LPAPRS WHICH
      *             MUST EXCLUDE MEMO INSURANCE PREMIUMS
      *  MJD 090905 IF MFFRMLA-05 THEN LOOK AT ANTICERN(4)
      *             INSTEAD OF LN-MAINTFEE * TERM.
      *             MAINT FEE MAY BE LAGER THEN LN-MAINTFEE
      *             FIELD AND GET TRUNCATED.                        WORLD #651
      *  MJD 160823 ADDED GET-LIVECHECK-FEES TO CALCULATE THE AMOUNT OF FEES
      *             FROM LIVE CHECKS THAT NEED TO BE INCLUDED IN
      *             HIGH-CREDIT/LN-CREDITLIM                          61000/1180
      *  BAH 190318 ADDED LPAMTSW-FEECODE-CH1, MOVED IT FROM LN-REC REDEFINE
      *  BAH 20221121 DONT ALLOW CASH-ADVANCE, SPCASH-ADVANCE OR HIGH-CREDIT TO
      *               RESULT IN NEGATIVE, CINDY FOUND IN TESTING
      **************************************************************************
       LOAN-CALCULATIONS SECTION.
           MOVE LN-CREDITLIM TO CREDIT-LIMIT.
           COMPUTE TOTAL-REPAY = LN-1STPYAMT
                     + LN-NOREGPY * LN-REGPYAMT + LN-LASTPYAMT.
           IF SP-MFFRMLA-05
              COMPUTE TOTAL-NOTE = TOTAL-REPAY - LN-EXTCHG
                                 - LN-ANTICERN(4)
           ELSE
              COMPUTE TOTAL-NOTE = TOTAL-REPAY - LN-EXTCHG
                                 - LN-ORGTERM * LN-MAINTFEE.
           COMPUTE ADJ-PRINCIPAL = TOTAL-NOTE - LN-INTCHG.

           MOVE 0 TO TOTAL-INSFINCHG TOTAL-FEEFINCHG TOTAL-INS-TAX
                     TOTAL-INSPREM-NONMEMO.
           PERFORM VARYING LPAMTS-SUB FROM 1 BY 1
                                UNTIL LPAMTS-SUB > 10
              IF ( (LPAMTS-SUB) < 9                  ) AND
                 ( LN-INSOURS(LPAMTS-SUB) NOT = "M"  )
                 ADD LN-INSPREM(LPAMTS-SUB) TO TOTAL-INSPREM-NONMEMO
                 IF LN-INSFINCHG(LPAMTS-SUB) = "Y"
                    ADD LN-INSPREM(LPAMTS-SUB) TO TOTAL-INSFINCHG
                 END-IF
              END-IF
              IF LN-FEEOURS(LPAMTS-SUB) NOT = "M"
                 IF LN-FEEFINCHG(LPAMTS-SUB) = "Y"
                    ADD LN-FEEAMT(LPAMTS-SUB) TO TOTAL-FEEFINCHG
                 END-IF
                 IF BR-FORCE-VALID-CITY-COUNTY = "Y"
                    IF LN-FEECODE(LPAMTS-SUB) = "TC" OR "TA" OR "TP"
                                             OR "T1" OR "T2" OR "T3"
                       ADD LN-FEEAMT(LPAMTS-SUB) TO TOTAL-INS-TAX
                    END-IF
                 END-IF
              END-IF
           END-PERFORM.

           IF LN-LOANTYPE = "I"
              COMPUTE PRINCIPLE = TOTAL-NOTE - LN-INTCHG
              MOVE PRINCIPLE TO FINANCED-AMOUNT INT-CHARGEABLE
              SUBTRACT TOTAL-INSFINCHG TOTAL-FEEFINCHG
                                         FROM FINANCED-AMOUNT
              SUBTRACT LN-SERCHG FROM FINANCED-AMOUNT
                                         GIVING DISCLOSED-FINAMT
           ELSE
              MOVE TOTAL-REPAY TO PRINCIPLE
              IF SP-MFFRMLA-05
                 COMPUTE FINANCED-AMOUNT =
                      TOTAL-REPAY - LN-INTCHG - LN-SERCHG - LN-EXTCHG
                         - LN-ANTICERN(4)
                          - TOTAL-INSFINCHG - TOTAL-FEEFINCHG
              ELSE
                 COMPUTE FINANCED-AMOUNT =
                      TOTAL-REPAY - LN-INTCHG - LN-SERCHG - LN-EXTCHG
                         - (LN-MAINTFEE * LN-ORGTERM)
                          - TOTAL-INSFINCHG - TOTAL-FEEFINCHG
              END-IF
              MOVE FINANCED-AMOUNT TO DISCLOSED-FINAMT
              COMPUTE INT-CHARGEABLE = TOTAL-NOTE - LN-INTCHG.

      * GET NON MEMO FEES AND NON MEMO INSURANCES:
      * GET OUR FEES AND OUR INSURANCES:
           MOVE 0 TO NONMEMO-INS NONMEMO-FEES
                     LIVE-CHECK-FEES.
           MOVE 0 TO INSUR-OURS FEES-OURS.
           PERFORM VARYING LPAMTS-SUB FROM 1 BY 1
                                   UNTIL LPAMTS-SUB > 10
              IF LPAMTS-SUB < 9
                 IF LN-INSOURS(LPAMTS-SUB) NOT = "M"
                    ADD LN-INSPREM(LPAMTS-SUB) TO NONMEMO-INS
                    IF LN-INSOURS(LPAMTS-SUB) = "Y"
                       ADD LN-INSPREM(LPAMTS-SUB) TO INSUR-OURS
                    END-IF
                 END-IF
              END-IF
              IF LN-FEEOURS(LPAMTS-SUB) NOT = "M"
                 ADD LN-FEEAMT(LPAMTS-SUB) TO NONMEMO-FEES
                 MOVE LN-FEECODE(LPAMTS-SUB) TO LPAMTSW-FEECODE
                 IF NOT (LPAMTSW-FEECODE-CH1-NUMERIC)
                    ADD LN-FEEAMT(LPAMTS-SUB) TO LIVE-CHECK-FEES
                 END-IF
                 IF LN-FEEOURS(LPAMTS-SUB) = "Y"
                    ADD LN-FEEAMT(LPAMTS-SUB) TO FEES-OURS
                 END-IF
              END-IF
           END-PERFORM.

           IF (LN-INTCHG + LN-SERCHG + NONMEMO-INS) > TOTAL-NOTE
              MOVE 0 TO CASH-ADVANCE
                        SPCASH-ADVANCE
           ELSE
              COMPUTE CASH-ADVANCE = TOTAL-NOTE - LN-INTCHG
                                   - LN-SERCHG - NONMEMO-INS
              COMPUTE SPCASH-ADVANCE = CASH-ADVANCE + LN-SERCHG.

           IF LIVE-CHECK-FEES NOT = 0
              MOVE "CL/LCFLD" TO FORM-NAM
              MOVE "LC-CALC-HI-CREDIT" TO MESS
              CALL FORM-PROGX USING FORM-PATH STAT LN-CLASS MESS
              CANCEL FORM-PROGX
              IF STAT = "00"
                 IF MESS = "L"
                    SUBTRACT LIVE-CHECK-FEES FROM NONMEMO-FEES.

           IF NONMEMO-FEES > CASH-ADVANCE
              MOVE 0 TO HIGH-CREDIT
           ELSE
              COMPUTE HIGH-CREDIT = CASH-ADVANCE - NONMEMO-FEES.

           IF SP-CAL-CHGABLE(1) = "P" OR "I"
              SUBTRACT LN-SERCHG FROM INT-CHARGEABLE.

           IF SP-CAL-CHGABLE(1) = "P" OR "S"
              SUBTRACT NONMEMO-INS FROM INT-CHARGEABLE.

      *================================================================*
      * END COPYBOOK: LIBLP\LPAMTS.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\REBATE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/REBATE
      ***************************************************************
      * ADDON NOTES: SHOULD EST. REB-LN-EXTCHG. REB-LN-SERCHG?
      *              REB-LN-INTCHG?
      *
      * NOTE : EARLY PROVISIONS DO NOT WORK WITH ADDONS!!!
      *          SEE CINDY'S NOTE FROM 10/12/2023
      *
      *
      *          ---REBATE CALCULATIONS
      *
      *   NAME:  REBATE
      *   DESC:  GENERALIZED REBATE CALCULATIONS
      *
      *   W A R N I N G:
      *            THIS PROGRAM CALLS A SUB PROGRAM AND REQUIRES
      *            THAT THE PROGRAM CONTAINING THIS COPY MEMBER
      *            HAVE THE STATEMENT:
      *
      *       =======>  MOVE FORM-PATHNAME TO FORM-PATH <=======
      *
      *---------------------------------------------------------
      *    N O T E:
      *
      *  ------> REB-REMTERM IS NOW AN OUTPUT FIELD, SO
      *          INSURE ITS INTEGRITY AFTER IT IS USED
      *          TO CALCULATED THE REFUND.
      *
      *         NEW FORMULAS DEALING WITH MULTIPLE CHARGE REBATES
      *         EX. INTEREST + SERVICE CHARGE.....DEFERMENTS
      *         MUST REVIEW EARNINGS VERY CARFULLY SINCE
      *         EARNINGS ARE REFLECTED IN COMPONET FORMAT.
      *           (LPEADJ)
      *---------------------------------------------------------
      *
      *   IN  :  REB-PAYDATE    - DATE OF PAYOFF
      *          REB-ORGTERM    - ORIGINAL TERM TO REBATE ON
      *          REB-SUB        - INS/INT TABLE LEVEL IN SP-FILE
      *          REB-TOTCHG     - PREMIUM/INTEREST TO REBATE
      *          REB-LPTRCD     - CURRENT TRANSACTION CODE
      *                           NEEDED FOR SP-RBSPOPT1 = 2
      *                             WITH  TRCD PB, RN, AND SC
      *                           NEEDED FOR SP-RBSPOPT2 = 2
      *                             WITH  TRCD PB AND RN
      *          REB-STATEWK    - INPUT WORK FIELD
      *                           ALWAYS CLEARED AT REBATE-EXIT.
      *                           NEEDED FOR RBFRMLA 'H' (GA)
      *                           INITIALIZED IN LPPOFF TO AMOUNT
      *                           OF INTEREST REBATE
      *          REB-RECAST     - Y - ALLOW RECASTING.
      *          REB-DEF-STOP   - SET TO 'Y' IN LONPFB AND LONPFA
      *                           TO IDENTIFY REBATE IS CALL FROM
      *                           A POSTING ROUTINE
      *   OUT :  REB-REBATE     - REBATE AMT; NEVER < 0
      *          REB-SUB        - = 0 SIGNALS ERROR
      *          REB-PRES-VALUE - USED ONLY BY LPCERN ERNFRMLA = 11
      *          REB-REMTERM    - REMAINING TERM USED IN CALCULATIONS
      *   USED:
      *   COPY:  REBATEW, LPNDTE, LPNDTEW, JUL, JULW
      *          TIMALL, TIM365, TIM360, LPAMTSW, LPAMTS
      *          TIMW, DATEWK, INCRMM
      * REV:
      *  052086 JTG MODIFIED 78THS ANTIC. TO TEST
      *            OVRDRATE 1ST.
      *  061886 JTG ADDED LOGIC FOR SP-RBDEFER CODE
      *  061886 JTG ADDED LOGIC TO FIX SP-RBDET CODES FOR SP-RBFRMLA 3
      *  061886 JTG ADDED LOGIC TO TEST FOR PRIOR TO REFDATE.
      *  112586 JTG ADDED TEST FOR SP-RBDEFER( ) = 2
      *             AND IF SO TO NOT CONSIDER DEFERMENTS
      *             IN THE COMPUTATION OF REBATE.
      *  082487 AMW ADDED REBATE FORMULA 7 FOR ACTUARIAL
      *             SECURITY OF AMERICA
      *  082887 AMW ADDED 'X' LOGIC FOR SP-RBDTE
      *             TO USE INTDATE/PURDATE
      *  120187 JTG MODIFIED ACTUARIAL REBATE FORMULA 2
      *             TO REBATE IN FULL IF PAYOFF PRIOR TO START DATE.
      *             ALSO, ADDED NEW FLAG REB-SKIPDEF-FG SO
      *             EARNINGS ROUTINES COULD DO AN ACTUARIAL
      *             -REBATE WITHOUT DEFERMENTS CONSIDERED
      *  021988 JPN ADDED ROUTINES FOR EARLY REBATE FORMULAS 1 AND 2.
      *  022388 JTG ADDED LOGIC FOR NEW DEDUCT FROM CHARGE CODE, 9999.01
      *  042888 BAW ADDED LOGIC FOR FORMULA 8
      *  042988 JPN ADDED LOGIC FOR SP-RBSPOPT1=2 SP-DEDCHG=9999.02
      *  051688 JPN ADDED LOGIC FOR FORMULA 'A'
      *  062188 JTG ADDED LOGIC FOR FORMULA 'B' AND 'C'
      *  090788 JTG OPENED UP FOR 13 REBATE LEVELS
      *  092188 JTG CHANGED TO PERFORM (COMPUTE INSURANCE TERM)
      *  110188 JTG ADDED LOGIC FOR SP-RBREDUC = 9999.01
      *             AND LOGIC TO CALL SUB PROGRAMS
      *             ADDED LOGIC FOR SP-RBEARLY = 3
      *             ADDED LOGIC FOR SP-RBSPOPT1 = 3
      *  121388 JTG ADDED LOGIC FOR SP-RBMINRET 9999.01 IOWA
      *  011788 JTG ADDED LOGIC FOR FORMULA 'D' IOWA
      *  021089 JTG DISABLED SP-RBDEFER FOR FORMULA 'D' IOWA
      *                 AND  SP-RBNOMON FOR FORMULA 'D'
      *  022889 JTG ADDDED TENNESSEE DEFERMENT REBATE LOGIC
      *  030389 JTG CORRECTED FORMULA "D" WHEN COMPUTED
      *             -REBATE WAS GREATER THAN LN-INTCHG
      *  030689 JTG ADDED SP-RBSPOPT2 = 1, HOLLYWOOD (FL)
      *  041089 JTG ADDED LOGIC FOR SP-RBSPOPT1 = 4
      *  041989 JTG ADDED LOGIC FOR SP-RBFRMLA = F
      *  071289 SLC CORRECTED FORMULA "F" WHEN COMPUTED
      *             -REBATE WAS GREATER THAN LN-INTCHG
      *  072089 JTG CHANGE LOGIC TO USE LN-ORIG-1STPYDATE
      *             AND NOT LN-1STPYDATE
      *  072789 JTG ADDED REBATE FORMULA "G" FOR
      *             IDEAL (MA) AH REBATE
      *  080189 JTG ADDED SP-RBSPOPT1 = 5 FOR SPRING FINANCE
      *  081189 JTG ALLOWED FORMULA F TO USE SWING RULE
      *  090189 JTG ADDED SP-RBSPOPT2 = 3 (GEORGIA)
      *  091489 JTG CHANGED SP-RBSPOPT1 = 5 TO BE A REBATE
      *             REDUCTION AND NOT A DEDUCT FROM CHARGE
      *  092889 JTG FIXED FRMLA 'F', SWING 0 ELAPSED-REM NOT TO TAKE
      *             EXTRA MONTH ELAPSED
      *  100489 JTG FURTHER FIXED SWING RULE TO WORK
      *  102489 JTG ADDED RBFRMLA = H AND I, SERCHG (GA)
      *  110889 JTG ADDED LOGIC FOR SP-RBEARLY = 4 OR 5 (GA)
      *  121589 JTG FIXED BUG FRMLA F (2ND FROM LAST PAY PERIOD)
      *  010890 SLC ADDED RBFRMLA = J, FOR MURDOCK.
      *  011890 JTG ADDED LOGIC FOR SP-RBMIN(7) = 999.01 (GA)
      *  021690 JTG ALLOWED SP-RBDEF FOR DEFERMENT REBATES
      *  041790 JTG LET ACTUARIAL-F TREAT SINGLE PAY LOANS
      *             AS IF NOT COMPOUNDING TAKES PLACE
      *  042690 JTG ADDED LOGIC FOR SP-RBEARLY = 7 & 8, PACESETTER
      *  051090 JTG ALLOWED USRULE, FOR ACTUARIAL-F
      *  052990 JTG ADDED RBFRMLA = K (PACESETTER DEFERMENT)
      *  080990 JTG CHANGED ROUTINE TO WORK FOR ADDONS
      *  090690 BAH ADDED RBFRMLA = M (MULLEN DEFERMENT)
      *  113090 JTG TOOK OUT LOGIC FRO DATE-ROUTINE (D-DATE)
      *  21090 SLC ADDED REB-RECAST TO INDICATE IF WE ARE TO RECAST.
      *             ALSO ADDED CALL TO REBC01 (RECAST).
      *  011091 JTG CHANGED SPOPT2 = 5 FROM 30 TO 15 DAYS
      *  011591 JTG CHANGED TEST ON REB-ADDON-FG = "N"
      *                   TO ONLY LOOK AT ACCOUNTS WITH ADDONS
      *  011791 JTG FURTHER CORRECTION FOR ABOVE CHANGE
      *  011891 JTG STOPPED SP-RBMINRET TEST ON ADDON RECORDS
      *  011591 JTG CHANGED TEST ON REB-ADDON-FG = "N"
      *                   AND NO CHANGE IN FINCHG OCCURED
      *  032791 JTG CORRECTED SP-RBMINRET TEST ON ADDON RECORDS
      *  052191 JTG CHANGED SP-RBEARLY = 8 (PACESETTER) 78 CALC
      *  090391 JTG ADDED SP-RBFRMLA = "N", PACESETTER
      *             CORRECTED PROBLEM FOR AM. THRIFT SINCE THEY
      *             BOTH USE SP-RBEARLY = 8
      *  100491 JTG CORRECTED TRISTATE FORMULA 'D'
      *  110191 JTG CORRECTED MISSISSIPPI INT REBATE
      *             EXTCHG ADDED INTO REB-TOTCHG TWICE
      *  123091 JTG ADDED REB-PRES-VALUE (EDDIE GOLDSTICKER)
      *  041592 JTG CHANGED TO PRORATA REFUND IF 'PB' OR 'RN'
      *             RE: SP-RBSPOPT = 7 (MULLEN)
      *  071392 JTG ADDED SP-RBFRMLA = 'O' & SET OF B01-FRMLA,
      *             TENN DEF REBATE, COLONIAL
      *  071792 JTG ADDED SP-RBFRMLA = 'P' UVALDE TX (AH)
      *  082092 JTG SET B01-DEF-STOP FROM REB-DEF-STOP
      *              FOR COLONIAL, TN DEFERMENT REBATE ROUTINE
      *  110692 JTG CORRECTED PRORATA REFUND IF 'PB' OR 'RN'
      *             RE: SP-RBSPOPT = 7 (MULLEN)
      *  122192 JTG ADDED SP-RBFRMLA = 'Q', VIRGINIA INS. ACTUARIAL
      *  011893 JTG SET B01-DEF-STOP FROM REB-DEF-STOP
      *              FOR CALIFORNIA, DEFERMENT REBATE ROUTINE
      *  012293 JTG ADDED SP-RBSPOPT1 = 10 FOR TIME FINANCE (CA)
      *                   TO BE USED WITH REFUND FORMULA 'L'
      *  021993 JTG ADDED SP-RBDEDCHG = 9999.03 FOR HOME CREDIT
      *  071993 JTG ADDED SP-RBSPOPT1 = 11 FOR MULLEN FINANCE (CA)
      *                   TO BE USED WITH REFUND FORMULA 'L'
      *  090193 JTG INCLUDED REM-REMTERM IN OUTPUT
      *  100793 BAH ADDED SP-RBEARLY = 99, FLAT CANCEL IF WITHIN
      *                                    3 DAYS, WORLD, TN
      *  082294 JTG CHANGED LOGIC FOR SP-RBREDUC = 9999.01 TO TEST
      *             SPECIFICLY FOR 'PB" OR "RN" OR "SC", SO CALLED
      *             PAYOFF WILL WORK
      *  113094 JTG ADDED SP-RBFRMLA = 'R' FOR TIME LOAN, CA AH REFUND
      *  021095 JTG ADDED SP-RBFRMLA = 'S' FOR TIME LOAN, CA CL REFUND
      *  051995 SLC ADDED SP-RBFRMLA = 'U' FOR AH REFUND FOR MERC.
      *  061095 JTG ADDED SP-RBEARLY = 9, FULL REFUND PRIOR TO START
      *             DATE (1ST - 30) MERCURY
      *  061595 JTG ADDED TEST ON BR-NOT-OURS-REFUND, MERCURY
      *  062795 JTG ADDED SP-RBEARLY = 10 (MERCURY) 1/30 78THS BF 1ST
      *  070295 SLC ADDED SP-RBFRMLA = 'V' AND 'W' FOR DEFER REFUND FOR MERC.
      *  070595 JTG CHANGED REBATE-FIND-INS-RATE TO TEST FOR INTERPOLATION
      *             OR NEXT HIGH
      *  092695 BAH ADDED SP-RBEARLY = 11 "MS" (MERCURY), FULL REFUND PRIOR
      *             TO FIRST PAY DATE, REFUNDISPRO RATA TO THE DAY
      *  101695 JTG ADDED SP-RBFRMLA = 'X', MERCURY 'WI' DEFERMENT REFUND
      *  101795 BAH ADDED SP-RBMIN(6) = 999.02, MERCURY 'OK' PP #L022
      *  111095 BAH ADDED SP-RBEARLY = 12 "AL" (MERCURY), PREPAID WITHIN 90
      *             DAYS BY COMPANY, PRO RATA TO THE DAY (SPREAR=1).
      *  111595 BAH ADDED SP-SPOPT1 = 12, MERCURY 'AL' INTEREST REFUND FORMULA
      *             ACTION SPRR78 = 13 RULE OF 78/PRIOR TO 1STPYDATE
      *  111695 BAH ADDED SP-RBFRMLA = "Y", MERCURY 'SC' DEF REFUND FORMULA
      *  111695 BAH ADDED SP-RBFRMLA = "Z", MERCURY 'AZ' DEF REFUND FORMULA
      *  112095 JTG CORRECTED SP-RBEARLY = 11, SO TRCD'S OTHER THAN
      *             'PO, PB, RN, SC' WOULD WORK
      *  112195 JTG ADDED SP-RBEARLY = 13, MERCURY NEVADA ACTION SPFRC=8
      *             FOR CUSTOMER PAYOFF
      *  111295 JTG ADDED SP-RBOPT1 = 13, ACTUARIAL 'F' NEAREST
      *             DUE DATE OPTION MERCURY ARIZONA ACTION 24
      *  112495 JTG ADDED SP-RBEARLY = 13 MERCURY 'NV' PP REFUND ACTION 8
      *  112795 JTG ADDED SP-RBREDUC = 9999.02, 'NV' MERCURY SPRDER = 09
      *  122195 BAH CHANGED FRMLA "U" TO USE IR RATE TABLE (MERCURY-CA)
      *             CALLS CL/IRREBT TO GET THE RATE
      *  011096 JTG ADDED SP-RBFRMLA2 = 1, MERCURY 'AZ' FIRE REFUND (PP)
      *  021296 JTG ADDED SP-RBSPOPT1 = 15, MERCURY 'OREGON' RULE OF
      *             ANTICIPATION
      *  050796 JTG CORRECTED REBATE-ACTUARIAL-F, SP-RBSPOPT1-FIRST-30,
      *             TO SET INTDATE TO NO LESS THAN ORIGINAL INTDATE
      *  051496 JF  INTEGRATED LIBGB/RBACT INTO REBATE-ACTUARIAL-F
      *  060596 JTG CORRECTED BUG IN ACTUARIAL-F WHICH DIDN'T PASS
      *             REB-TOTCHG TO RBACT-TOTCHG
      *  082996 BAH ADDED RBEARLY = 14, SUN, LA FOR ALABAMA
      *  020397 JTG CORRECTED RBFRMLA = 'V' & 'W' TO CORRECTLY COMPUTE
      *             DEFERMENT REFUND WHEN PAYOFF IS AFTER ORIGINAL LOAN
      *             MATURITY, REBATE-MERC-DAILY-PRORATA
      *  020497 JTG SP-RBEARLY = 10, CHANGED TO TEST FOR PAYDATE PRIOR
      *             TO INTEREST START DATE AND SET FULL REFUND
      *  021197 BAH SP-RBEARLY = 15, ALABAMA, SAME AS "MS" 12, EXCEPT 120 DAYS
      *             #L043
      *  021497 BAH ADDED A01-PAYDATE TO PERFORM REBATES INSIDE OF REBA01
      *  051397 JTG ADDED RBEARLY = 16, SUN, ALABAMA, JUST LIKE "MS" 3,
      *             EXCEPT 120 DAYS, PR#443
      *  051397 JTG ADDED SP-RBEARLY = 17, CLAY FINANCIAL SINGLE PAY LOANS ONLY
      *  062597 BAH ADDED SP-RBEARLY 18, 19 AND 20 FOR WORLD, A90-9,10 AND 11
      *  072997 MJD ADDED EARLY PROVISION FOR ACQUISITION CHARGES. REQ#163
      *  092697 JTG CHANGED TO ALLOW ADDON INTEREST REBATE TO WORK RBFRMLA = F
      *  100197 JTG ADDED LOGIC FOR SP-RBMINRET 9999.02 SC, WORLD
      *  020898 JTG CHANGED TO PASS REB-SKIPDEF-FG TO RBACT-SKIPDEF-FG
      *             IN REBATE-ACTUARIAL-F
      *  021098 JTG ADDED TEST OF REB-EARN-FULL-MONTH, TFC #637
      *             RE: SP-EARNACCRL-FG() = 'B'
      *  042798  CS ADDED TEST OF RENEWAL CODES "RB" AND "RO"
      *  102198 BAH ADDED SP-RBEARLY 22 FOR FREEDOM, AL #775, WITHIN 90 DAYS
      *             DO PRORATA, OTHERWISE, NO REFUND
      *  122198 JTG ADDED SP-RBSPOPT1 = 16 OHIO PREPAY PENALTY, REGENCY #001
      *  021299 BAH REMOVED THE CLEARING OF REB-MS-PENALTY ON THE FIRST
      *             LINE OF CODE, DOING A "PO", THE "RS" WIPED OUT THE
      *             PENALTY COMPUTED IN THE "RI", LOANS INC.
      *  021799 BAH ADDED DECIMAL TO REB-HALF-ORGTERM FOR DEDCHG 9999.02
      *  022699 BAH ADDED REB-HALF-ORGTERM-DEC AND DEDCHG 9999.04, AND PUT
      *             9999.02 BACK TO HOW IT WAS PRIOR TO 2/17/99 CHANGE
      *  JTG 990519 ADDED SP-RBFRMLA2 = '3', MEAN RULE 78THS       REGACC   #N/A
      *  BAH 990603 ADDED SP-RBEARLY = 23, WORLD (MO) #206
      *  BAH 990603 ADDED SP-RBSPOPT1 = 17, REGACC PR#875
      *  BAH 991021 ADDED SP-RBDEDCHG = 9999.05, HOME CREDIT, EXACTLY LIKE
      *             9999.03 EXCEPT $30.00 INSTEAD OF $25.00 PR#987
      *  JTG 000104 ADDED SET OF RBACT-PENALTY-FG RE: SP-RBREDUC = 9999.04
      *             WISCONSIN IB REAL ESTATE PREPAY PENALTY, WISCONSIN #1031
      *  JTG 000119 ADDED SP-RBFRMLA2 '4', TN PROPERTY REDUND (SHORT RATE
      *             METHOD) CONSUMER FINANCIAL #1062
      *  JTG 000317 CHANGED LOGIC FOR EP10 TO CARRY INITIAL CALC OF DAILY FACTOR
      *             TO MORE DECIMALS THAN 2 RE: WORLD BR 588 #01-006564
      *             WRITTEN UP BY AUDITORS
      *  JTG 000322 ALLOWED LOGIC FOR EP10 TO WORK FOR SERVICE CHARGE REFUNDS
      *             ALSO, RE: WORLD BR 588 #01-006564 WRITTEN UP BY AUDITORS
      *  BAH 000407 ADDED RBSPOPT1 = 18 MULLEN PR# 1118, IF REPO, RENEWED OR
      *             <= 60 DAYS, REBATE PRORATA
      *  KEC 000523 {PR#00000} MERCURY FINANCE [CINDY SHAFFER];
      *              ADDED 'B02-DEF-STOP' FOR THE PURPOSE OF NOT
      *              ALLOWING THE 'SEND-MESS' WITHIN CL/REBB02.C FROM
      *              HAPPENING SO THAT MERCURY CAN HAVE THEIR CUSTOMER
      *              STATEMENTS TO WORK (NOT STOPPING IN BATCH).
      *  JTG 000626 CORRECTED LOGIC FOR EP10 TO CARRY INITIAL CALC OF DAILY
      *             FACTOR TO MORE DECIMALS THAN 2 RE: WORLD BR 588 #01-006564
      *             WRITTEN UP BY AUDITORS, NO SERCHG REFUND FOR LOANS <= $100
      *  BAH 010413 ADDED SPOPT2 = 9 FOR FULL REFUND UP TO "SAME AS CASH" DATE
      *             LENDMARK PR# 1443
      *  JTG 010503 NEW CODE 'B' FOR SP-RBUNITPER-CD(OCCURS 16) PAACO PR#1466
      *  JTG 010706 ADDED SET OF REB-EARN-FULL-MONTH             REGENCY PR#1456
      *             RE: SP-ERNACCRL-FG() 'C'
      *  BAH 010910 ADDED RBSPOPT2 = 10, FULL REFUND WITHIN 60 DAYS, REGACC
      *             PR# 1550
      *  BAH 010928 RBREDUC = 9999.01, "MS" STATE BANK DEPT SAID WHENEVER
      *             THERE ARE REMAINING DAYS, BUMP INTO THE NEXT MONTH,
      *             WHICH COULD CAUSE A DIFFERENT PERCENT !!, PL# 334 LOANS
      *  JTG 011026 CHANGED RBACT-APRATE TO RBACT-RATE FOR NEW REFUND FORMULA
      *             '0 6'  AND CHANGED TO SET REB-LN-SMPRATE    REGENCY PR#1631
      *  JTG 011102 NEW DEFERMENT REFUND SP-RBFRMLA2 = 5 SMALL LOANS
      *                                                           CITIZENS #1622
      *  JTG 011107 PLUS NEW SP-RBFRMLA (0 7) CL & AH REFUNDS     MULLEN PR#1641
      *  JTG 020219 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *             ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *             ADDED LOGIC FOR INS-TAX                           WORLD #288
      *  JTG 020402 CHANGED INS-TAX TO INS-TAX-RB                     WORLD #288
      *  JTG 020930 ADDED NEW SHORT RATE FORMULA SP-RBEARLY = 24 (PP)    TFC #96
      *  JTG 030305 ALLOW RBFRMLA "8" TO WORK FOR A&H AND ALL INSURANCES
      *                                                               PACE #2012
      *  JTG 030513 ADDED SP-RBFRMLA2 (0 8) WISCONSIN CPI REFUND FORMULA
      *                                                           CITIZENS #2065
      *  JTG 030709 NEW INTEREST REFUND FORMULA (0 9) STATE OF TEXAS BASED
      *             ON DAILY INTEREST USING 365 DAYS AND SIMPLE      EXCEL #2111
      *  JTG 030717 CORRECTED INTEREST REFUND FORMULA (0 9) STATE OF TEXAS BASED
      *             ON DAILY INTEREST USING 365 DAYS AND SIMPLE
      *             STOPPED AMTFIN FROM GOING NEGITIVE               EXCEL #2111
      *  JTG 030728 NEW INSURANCE REFUND 2ND FORMULAS:
      *             (0 A) MEAN OF PRORATA & RULE 78
      *             (0 B) RULE 78 FOR NET + 1                        WORLD #326
      *  JTG 040603 MODIFY SP-RBSPOPT2 = 8, DO NOT SWING IF INS. COMPANY
      *             = 75, AND ROUND REFUND TO WHOLE DOLLARS         REGACC #0054
      *  JTG 040608 ADDED NEW SP-RBFRMLA (0 C) SHORT RATE FORMULA   MULLEN #2302
      *  BAH 040623 ADDED RBSPOPT1 = 21, THRIFT INVESTMENT PR# 2334
      *  JTG 040624 CHANGED 'REBATE-RBEARLY-21' TO CONSIDER A DEDUCT FROM CHARGE
      *             FOR COLORADO SERVICE CHARGE                       WORLD #353
      *  BAH 040630 REMOVED THE REGACC #0054 CHANGE DONE ON 040603 BY JTG
      *  JTG 040917 ADDED NEW FIELDS FOR SP-RBFRMLA (0 D)
      *             RULE 78THS USING DAYS IN TERM AND ELAPSED DAYS INSTEAD
      *             OF UNIT PERIODS IN TERM AND ELAPSE UNIT PERIODS
      *             ADDED REB-LN-INSEFF & REB-LN-INSEXP
      *             ALSO ADDED SP-RBSPOPT2 = 11 NEW ROUNDING OPTION TO
      *             TAKE COMPUTED REBATE AND ROUNDED UP OR DOWN TO
      *             WHOLE DOLLARS   ADDED 'REB-REBATE-CENTS'        REGACC #0074
      *  JTG 041102 ADDED ALAMAMA REFUND FRMLA ACTUARIAL (0 E)      WORLD  #J050
      *  JTG 041201 ALLOWED FORMULA (0 D) TO TEST FOR SWING OF 1 MONTH
      *             VIA ADD DAYS SP-RBDAYS(REB-SUB,1) FOR PRIOR TO
      *             FIRST PAYMENT                             REGACC #0074 #0454
      *  JTG 041220 ALLOWED FORMULA (0 D) TO TEST FOR SWING OF 1 MONTH
      *             VIA ADD DAYS SP-RBDAYS(REB-SUB,1) FOR PRIOR TO
      *             FIRST PAYMENT, THAN DO A FULL FULL REFUND REGACC #0074 #0454
      *             WHEN SPR FIELD SP-RBDAYS(REB-SUB,1) IS CODED FOR SWING
      *             AND ELAPSED DAYS PRIOR TO 1ST PAYMENT
      *             IS LESS THAN OR EQUAL TO SP-RBDAYS(REB-SUB,1) (NO SWING)
      *             FORCE A FLAT CANCEL, FULL REFUND
      *             NOTE: IF A SWING TAKES PLACE REB-ELAPSED-MONTHS WILL = 1
      *
      *             ---- TO  N O T  CAUSE A SWING LIKE IN THE FOLLOWING EX:
      *                  SPR 1STPAY YEAR TYPE SHOULD BE '360' NOT '365' ETC
      *
      *                                                360      365
      *                                 ------  ---      ---
      *                EFFECTIVE     08/29/04  DAYS     29       30
      *                REBATE DATE   09/28/04  MONTHS    0        1
      *                                        REM      29        0
      *                                               NO SWING  WILL SWING
      *                                                       REGACC #0074 #0454
      *  JTG 050210 CORRECTED LOGIC FOR REBATES AFTER INSURANCE EXPIRATION
      *             WHICH WAS CAUSING NEGATIVE DAYS-IN-FORCE AND
      *             YIELDED A POSITIVE REFUND   ---- WRONG -----
      *             FORMULA (0 D)                             REGACC #0074 #0454
      *  CS  050323 CHANGED REBATE-TX-INTEREST 'RI' TO 1ST PAYMENT DUE DATE
      *             WE WERE COMPUTING DAILY INTEREST FOR ELAPSED DAYS & THEN
      *             MULTIPLY BY -1 (?).  WHEN COMPUTING THE REBATE...
      *             (1.50 + LN-INTCHG + LN-EXTCHG - CALCULATED INTEREST) CALC
      *             INTEREST IS NEGATIVE SO IT ENDED UP ADDING TO REB-REBATE
      *FOR EX:      LOAN DATE   11/13/01
      *             1ST DUE     12/20/01
      *             'RI' DATE   12/20/01
      *             INTEREST    437.38
      *             EXTCHG         8.03
      *             CALCULATED INT  38.87
      *    WAS:
      *         (1.50) + 437.38 + 8.03 - (-38.87) SO REBATE 485.78 IS > INTCHG
      *    IT NOW DOES:
      *             (1.50) + 437.38 + 8.03 - 38.87 ( CALC INTEREST)= 408.04
      *                                                   DAVE SINCLAIR
      *  BAH 050405 ADDED SP-RBSPOPT1 = 22, SUN "LA" PR# 2504
      *             IF PAID BY "PB" OR "RN" REFUND RULE OF 78TH'S, IF PAID
      *             OFF WITH "PO", NO REFUND
      *  JTG 050418 NEW REFUND FORMULA '0 F' TRUE DAILY PRORATA REFUND FORMULA
      *             FOR STATE OF COLORADO                            WORLD #0401
      *  BAH 050518 STORE THE PENALTY IN REB-MS-PENALTY FOR THRIFT, MESSING
      *             UP DEFERMENT AMOUNT WITHOUT IT..., PL# 493
      *   CS 050523 NEW REBATE FORUMULA 2 (SP-RBFRMLA2 = H) SAME AS TEXAS 0 9
      *             EXCEPT USES THE SPLIT RATE TABLE ON PG 4 OF SPR #2527 REGMGT
      *             HARD CODED TO USE THE 1ST SPR TABLE(PG 4) PER JOHN WHEN
      *             I ASKED HIM HOW TO GET THE RIGHT TABLE
      *  JTG 050519 ADDED NEW FORMULAS FOR MEXICO
      *             SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  JTG 050708 ADDED REB-LN-INT-REBATE REB-LN-SC-REBATE REB-LN-MF-REBATE
      *             REB-LN-DF-REBATE
      *             ADDED NEW FORMULAS FOR MEXICO
      *             SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  JTG 050818 CHANGED SP-RBFRMLA2 (G) TO USE THE LN-ANTICERN(4)
      *             MAINTENANCE FEE ANTICIPATED INSTEAD OF THE STORED
      *             LN-MAINTFEE * LN-ORGTERM
      *             ADDED NEW FORMULAS FOR MEXICO
      *             SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  BAH 050913 ALLOW SP-RBFRMLA2 (0 F) TO WORK WITH INSURANCES, PFSC
      *                SECURITY PR# 2600, LIBERAL PR# 2559
      *  CS  060203 ADD SP-RBSPOPT1 23 DONT ROUND TO WHOLE DOLLARS WHEN REFUND        *             IS REBATE-SHORT-RATE-0C [PEOPLE 2670]
      *  BAH 060213 WHEN THE CLEAR OF REB-MS-PENALTY WAS REMOVED FROM THE FIRST
      *             LINE(2/12/99), AND THE REFUND WAS 0, FULLY EARNED ALREADY,
      *             YOU WOULDNT GET INTO THE RBREDUC SECTION TO CLEAR THE
      *             PENALTY, SO IT WAS COMING OUT WITH JUNK LIKE 989762.88 IN
      *             IT ON MANUAL REBATES, SO I MOVED IT BACK UP TOP BUT ONLY
      *             CLEAR IT ON "RI"....LOANS INC PL# 529
      *   CS 060216 ADD SP-RBSPOPT1 = 24 USED IN CONJUNCTION WITH SP-RBFRMLA 0F
      *             REFUNDS 100% IF REFUNDED WITHIN 30 DAYS USES A 360 YR TYPE
      *                                                        PEOPLES 2680
      *   CS 060622 EARLY PROVISION 10 NEEDS TO WORK WITH ADDONS... IT WAS
      *             REBATING BACK ENTIRE LN-INTCHG IF REFUNDED WITH 10 DAYS
      *             & WASNT LOOKING AT THE ODDON CHARGE PR#534 CENTRAL ILL
      *             USE LT-ANTICERN(1)
      *   CS 060630 ADDED LT TO REBATE-CALL-SUBPROG SECTION CENTILL PR#534
      *  MJD 061207 ADDED SP-RBSPOPT1 = 25 OHIO PREPAY PENALTY, REGENCY #2878
      *  BAH 070814 ADDED SP-RBSPOPT1 = 26 TO USE APR INSTEAD OF SMPRATE
      *             ONLY IN RBFRMLA 'Q', LENDMARK PR# 3026
      *  JTG 071030 NEW INSURANCE REFUND FORMULA (0 I) FOR CPI POLICYS
      *             WHICH ARE ALWAYS 1 (ONE) YEAR TERMS          CITIZENS #3097
      *  MJD 080111 NEW INSURANCE REBATE FORMULA (0 J) FOR MX CL WORLD #563
      *   CS 080529 CHANGED  TEST FOR REBATE 78'S WITH FIRST PAY EXTENSION.
      *             WAS ADDING LN-EXTCHG TO REB-TOTCHG FOR ADDONS, THE LOAN
      *             EXT CHARGE SHOULD NOT AFFECT THE ADDON-REBATE SO...
      *             CHANGED TO :
      *             IF REB-ADDON-FG NOT = "Y"
      *                ADD LN-EXTCHG TO REB-TOTCHG.
      *             THIS WAS ALSO CAUSING CANCELS OF ADDON INTEREST > THAN
      *             ORIGINAL CHARGE
      *   CS 080603 DONT PERFORM EARLY PROVISION 10 (EP10) WHEN REFUNDING
      *             AN ADDON PR#630  CENTRAL ILL
      *  BAH 080910 ADDED RBFRMLA2 "K" FOR MULLEN PR# 3250
      *   CS 100304 ADDED RBFRMLA2 "L" FOR UNITED PR#3548, ACTS LIKE 0 9 EXCEPT
      *  BAH 100415 ADDED RBSPOPT2 12, FULL REFUND WITHIN 3 DAYS,
      *                                                         REGMGM PR# 3570
      *   CS 100805 CHANGED REBATE-ACTUARIAL-7-B IF REBATE-FRMLA 'B', TO COMPUTE
      *             THE RATE TO AMORTIZE THE LOAN USING UNITPER-PER-YEAR INSTEAD
      *             OF A MONTHLY RATE.  FOR THIS TO HAPPEN, SP-ORGST MUST BE
      *             'MX', MUST BE INTEREST REFUND, SP-RBUNITPER-CD = 'B'
      *                                                  WORLD PL#692
      *  100810 BAH ADDED SP-RBEARLY 25 FOR REGMGM, AL, WITHIN 90 DAYS DO
      *             PRORATA, OTHERWISE, DO SPR REFUND TABLE REGMGM PR# 3614
      *  BAH 100908 ADDED RBFRMLA2 "M" FOR WORLD TX ANTICIPATED PR# 711
      *             JUST LIKE RBFRMLA 8 WITHOUT TRUNCATING SPR RATE
      *   CS 110106 ADDED SP-RBEARLY 26 FOR WORLD, IL, IF PAID OFF BY "PO"
      *             WITHIN 60 DAYS, COMPUTE PRO-RATA REFUND, THIS IS THE SAME
      *             AS SP-RBEARLY 21 EXCEPT THAT IS ONLY CALCULATES A REFUND
      *             IF A 'PO'. ONLY FOR SERVICE CHARGE  WORLD PR#733
      *  110907  CS ADDED SP-RBEARLY = 98, FLAT CANCEL IF WITHIN 10 DAYS, IF
      *             > 10 DAYS, NO REFUND, DONT PUT A REBATE FORMULA IN SPR
      *             COMPONENT  REGMGM PR#3865
      *  110908  CS PER DAVID, FORCE 365 AS YEAR TYPE WITH SP-RBEARLY =98
      *                                                      REGMGM PR#3865
      *  111031 BAH ADDED SP-RBSPOPT2 = 13 FOR COLTN, PR# 3900
      *  120223 MJD ADDED REBATE FORMULA (0 N) FOR INDIANA,
      *             RULE OF ANTICIPATION LIFE                      CFSC #3795
      *  120502 MJD ADDED REBATE FORMULA (0 O) FOR TEXAS,
      *             RULE OF ANTICIPATION LIFE                      REGMGT #3938
      *  120517 MJD INSURANCE REBATE FORMULA 0-N TO USE A CONSTANTS
      *             RATE OF 3.7% AS THE STATE DISCOUNT RATE FOR THE
      *             CALCULATION OD LIFE INSURANCE REFUNDS.  AS PER RICHARD
      *             RODRIGUEZ AT ASSURANT.                         CFSC #4037
      *  120821 MJD CORRECTED RBFRMLA "O" (3938) TO ALWAYS USE FIXED
      *             RATE OF .035 RATHER THAN CALC BASED ON SPR DONE PER EMAIL
      *             FROM JIM R.
      *  130709 MJD ADDED EARLY PROVISION AND REBATE FOR GA 4% CLOSING FEE (54)
      *             THIS EARLY PROVISION IS ONLY UTILIZED BY SCFRMLA 54 AND
      *             RBFRMLA "I".                                    WORLD PR#920
      *             MODIFIED RBFRMLA "I" TO CALCULATE EARLY PROVISION AND
      *             THEN CALCULTE REBATE BASED ON THE REMAINING AMOUNT OF SERCHG
      *             4% CLOSING FEE STORED IN LN-POINTS              WORLD PR#876
      *  130913 BAH INSURANCE REBATE FORMULA 0-P TO USE A CONSTANT RATE OF
      *             1.42% AS THE STATE DISCOUNT RATE FOR THE CALCULATION OF
      *             LIFE INSURANCE REFUNDS.                      CFSC PR# 4367
      *  140117 MJD ADDED LOGIC FOR MX VYBA PREPAYMENT PENALTY      WORLD PR#954
      *  141010 MJD ADDED LOGIC FOR MX VYBA PREPYMNT PENALTY "PB"  WORLD PR#1030
      *  150611 BAH BOGUS JUNK CODE (:Q:F) SOMEHOW INSERTED IN THE
      *             REBATE-TX-INTEREST SECTION, ALONG WITH AN EXTRA GO TO
      *             STATEMENT WHICH CAUSED REBATE FORMULA 0 9 TO NOT WORK
      *                                                        SUPPORT PL#885
      *  160122 MJD WITHIN REBATE-EP54 CHANGED TO USE REB-EP54-AMT INSTEAD OF
      *             REB-WORK2 AS THE WORKER.  THIS VALUE NEED TO BE PART OF
      *             THE REBATE AND PASSED BACK TO BE STORED AND USED AT A
      *              LATER DATE.    REGMGT #4915
      *  160421 BAH CHANGED RBFRMLA2 "K" TO ALWAYS USE INSURANCE EFFECTE DATE
      *             AND INSURANCE TERM, NOT LOANDATE AND ORGTERM.
      *                                                  MULLEN/KSTREET PR#5049
      *  160511 MJD ADDED SP-RBDTE = "D"                             71105#0918
      *  CS 191204 ADD SP-RBEARLY 27 INDIANA EARLY PROVISION, NO REFUND OF
      *            EXTENSION CHARGE, FIRST MONTH INTEREST REBATED PRORATA 78'S
      *                                         WORLD PR#1406
      *            UNUSED DAYS FROM PAYDATE TO REFDATE(USED DAYS) COUNTED
      *            BY 365 YEAR TYPE AND SUBTRACTED FROM 30 TO GIVE US THE
      *            UNEARED PORTION OF THE SLICE OF EARNINGS
      *  2020.01.28 BAH ADDED SP-RBEARLY = 28, "IL" #1417
      *  2021.02.16 BAH CHANGE SPOPT1 = 3, IF B4 FIRST PAY, DO NOT INCLUDE THE
      *                 EXTENSION CHG IN THE REBATE CALC, IT SHOULD BE FULLY
      *                 REBATED INSTEAD. #1489
      *  2021.03.12 BAH SPOPT1 = 3, WAS INCLUDING "ON" THE FIRST PAY, SHOULD
      *                 ONLY BE PRIOR TO FIRST PAY. #1489A
      *  2021.0420 CS SP-RBFRMLA =0, SP-RBFRMLA2 = "H", PROBLEMS WITH INDEX
      *            OUT OF BALANCE IN REBATE-CALC-INT-0H. IT TESTS IF REBTX-
      *            STEP > 5, GO TO END BUT IF WAS = 5, IT ADDED 1 AND 
      *            CONTINUED TO TRY AND PROCESS RESULTING IN BAD REFUNDS, ERRORS
      *            ON INDEX THAT YOU DIDNT SEE UNLESS YOU WERE IN DEBUG. CHANGED
      *            INCREMENT OF REBTX-STEP TO HAPPEN PRIOR TO TEST AGAINST
      *            > 5.
      *  2021.0617 BAH ADDED SP-RBEARLY = 97, "TN" COMBINES RBEARLY 99 WITH
      *                AN EARLY PROVISION FOR NEW CLOSING FEE FROM SCFRMLA 60
      *                                                         #1500
      *  2021.0924 CS MOVED PERFORM OF EP11 BELOW THE SELECT-SP-ELAPSED-TIMTBL
      *               EP11 NEEDS TO KNOW IF PRIOR TO FIRST PAYMENT DUE DATE,
      *               (POFF-B4-1STPYDATE) WHICH IS REB-SUB2
      *               AS EP11 NEEDS TO KNOW IF PRIOR TO FIRST PAYMENT DUE DATE
      *               AS EP11 NEEDS TO KNOW IF PRIOR TO FIRST PAYMENT DUE DATE
      *  2022.0103 CS REMOVED BELOW, IT WILL NEVER HIT IT.  SP-RBFRMLA = "0" AND
      *               SP-RBFRMLA2 = "5", IS TESTED AS A DEFERMENT FORMULA AND 
      *               EXITS REBATE. YOU CANNOT ENTER ANYTHING OTHER THAN A 0 IN
      *               SP-RBFRMLA TO GET TO SP-RBFRMLA2. LOOKS LIKE WAS JUST
      *               COPIED FROM SP-RBFRMLA = "0" AND SP-RBFRMLA2 = "4"
      *               *** REMOVED*** WI SMALL LOAN DEFERMENT REFUND #1622
      *               IF SP-RBFRMLA2(REB-SUB) = "5"
      *                   PERFORM TN-PP-SHORT-RATE
      *  BAH 2023.0801 ADDED SP-RBFRMLA2 "Q" FOR "AL" CLOSING FEE #1619
      *   CS 2023.1012 IF WORLD DECIDES TO USE ADDONS, THE EARLY PROVISIONS
      *                NEED WORKED ON.  FOR EXAMPLE: RBEARLY(7) =19
      *                A REBATE IS CALCULATED ON THE ADDON PORTION AND SETS
      *                REB-SUB TO 0 WHICH IS A TRIGGER TO EXIT REBATE.
      *                PROBLEM WITH THAT IS WHEN YOU GET BACK TO FAPOFF:
      *                WITHIN PAYOFF-INT-ADDONS-NEXT, AFTER THE PERFORM OF
      *                ADDONRB-GET-IT-REBATE....
      *                    IF REB-SUB NOT = 0    ITS 0
      *                        MULTIPLY POFF-ONE BY REB-REBATE
      *                        ADD REB-REBATE TO POFF-ADDON-INT-REBATE
      *                    ELSE
      *                        MOVE 0 TO REB-REBATE. <----------
      *      IN THE CASE OF SP-RBEARLY(7) = 16 A NEW CALCULATION WOULD NEED
      *      TO BE ADDEDED IF REB-ADDON-FG = "Y" (SET IN FAPOFF) AS THIS
      *      RBEARLY FORMULA IS USING THE LN-LNAMT,LN-INTCHG,LN-EXTCHG BUT
      *      IS USING THE ELAPSED-DAYS FOR THE TIME PERIOD THE ADDON WAS IN
      *      EFFECT.
      **************************************************************************
       REBATE SECTION.
           MOVE 0 TO REB-REBATE REB-PRES-VALUE INS-TAX-RB REB-EP54-AMT.

      * ONLY CLEAR FOR INTEREST REBATE, OTHERWISE PAYOFF WILL WIPE IT OUT
      * WITH OTHER REBATES
           IF REB-SUB = 7
              MOVE 0 TO REB-MS-PENALTY.

           IF SP-RBFRMLA(REB-SUB) = "9" OR
              ( SP-RBFRMLA(REB-SUB) = " " AND
                SP-RBEARLY(REB-SUB) NOT = 99 AND NOT = 98 AND NOT = 97 )
              GO TO REBATE-EXIT.

      *    -------------------------------------------------------------
      *    EARLY PROVISION FOR ACQUISITION CHARGES
      *    -------------------------------------------------------------
           IF SP-RBEARLY(REB-SUB) = 21
              PERFORM REBATE-RBEARLY-21
              GO TO REBATE-EXIT.

           IF SP-RBEARLY(REB-SUB) = 26
              PERFORM REBATE-RBEARLY-26
              GO TO REBATE-EXIT.

           IF BR-NOT-OURS-REFUND NOT = "Y"
      *          TEST CL:
              IF (REB-SUB > 0 AND < 5) AND
                 (LN-INSOURS(1) = "N")
                 GO TO REBATE-EXIT
              ELSE
      *          TEST AH:
              IF ( REB-SUB = 5         ) AND
                 ( LN-INSOURS(2) = "N" )
                 GO TO REBATE-EXIT
              ELSE
      *          TEST PP/PP2:
              IF ( REB-SUB = 6 OR 11   ) AND
                 ( LN-INSOURS(3) = "N" )
                 GO TO REBATE-EXIT
              ELSE
      *          TEST O1 TO O7:
              IF ( REB-SUB > 10 AND < 19         ) AND
                 ( LN-INSOURS(REB-SUB - 8) = "N" )
                 GO TO REBATE-EXIT.

      * ---------------------------------------------------------
      * TEST FOR WINCONSIN DEFERMENT FORMULA 'X:
      * WHEN PAYOFF IS PRIOR TO ORIGINAL MATURITY
      * REFUND ALL DEFERMENT CHARGES:
      * ---------------------------------------------------------
              IF REB-SUB = 10
                 IF SP-RBFRMLA(REB-SUB) = "X"
      * REBATE ON ALL RENEWALS AND PAYOFF QUOTES 1/4/96 BAH
      *             IF REB-LPTRCD = "PO"
                       MOVE "Y" TO MDTE-FLAG
                       PERFORM MATURITY-DATE-CALCULATION
                       IF MDTE-DATE > REB-PAYDATE
                          MOVE LN-TOTDEF TO REB-REBATE
                          GO TO REBATE-EXIT.

      * IF SP-DBDTE = "D" AND ADDON-FG = "Y" CHECK TO SEE IF THE INS IN
      * QUESTION IS AN ADDON OR WAS PART OF THE ORIGINAL LOAN. THE
      * ADDON-FG IS A GENERAL FLAG AND NOT INSURANCE SPECIFIC, IF THE
      * INSURANCE IN QUESTION WAS NOT AN ADDON THEN DO NOT TREAT IT LIKE
      * ON REGARDLESS OF WHETHER OR NOT OTHER INSURANCES WERE ADDON
      * ON/ADJUSTED/CANCELLED.
      * THE TEST FOR SUB 1 AND 2 = D SEEMS WEIRD BUT THERE IS NO POINT
      * IN SEARCHING LT IF THERE IS NO POSSIBILITY OF EITHER BEING "D"
      * IF PAYOFF LPPOFF ALREADY SETS UP THE REB-LN FIELDS, WE JUST DO
      * NOT WANT TO USE THEM ID THE INS IN QUESTION REALLY IS NOT AN ADDON.
      *  ALSO IF IT IS A PAYOFF, THE REB-LN-ORIG-1STPYDATE IS ALREADY
      * CHANGED TO INS EFF DATE BY THE TIME IT GETS HERE.
      *                                                  71105#0918
           IF (REB-ADDON-FG = "Y") AND
                 ((SP-RBDTE(REB-SUB, 1) = "D") OR
                  (SP-RBDTE(REB-SUB, 2) = "D"))
      *  DO ANY LOAN INS TRAILERS EXIST FOR THIS INSURANCE?
              PERFORM REBATE-CHECK-ADDON-TRAILER
              IF REB-LTI-ADDON-NOT-FOUND
      * WANT TO TEST USING LN-ORIG-1STPYDATE THIS INS IS NOT AN ADDON.
                 MOVE REB-LN-ORIG-1STPYDATE TO REB-HOLD-LNORIG1STPAY
                 MOVE LN-ORIG-1STPYDATE TO REB-LN-ORIG-1STPYDATE
      * SETUP REB-SUB2
                 PERFORM SELECT-SP-ELAPSED-TIMTBL
                 IF JULIAN-DATE = 0
                    GO TO REBATE-EXIT
                 ELSE
      * IF CONDITIONS ARE MET CONTINUE AS THOUGH ADDON-FG = "N"
                    IF SP-RBDTE(REB-SUB, REB-SUB2) = "D"
                       MOVE "N" TO REB-ADDON-FG
                    END-IF
                 END-IF
                 MOVE REB-HOLD-LNORIG1STPAY TO REB-LN-ORIG-1STPYDATE
              END-IF
           END-IF.

      *^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      * THIS SECTION OF CODE IS FOR ESTABLISHMENT OF ORIG LOAN FIELDS.
      *  NOTE: WHEN REB-ADDON-FG = "Y", IT IS ASSUMED THAT THESE FIELDS
      *        HAVE BEEN PRESET TO THE CORRECT VALUES FOR THE ADDON.
      *

           IF REB-ADDON-FG NOT = "Y"
              MOVE LN-ORIG-1STPYDATE TO REB-LN-ORIG-1STPYDATE
              MOVE LN-PURDATE     TO REB-LN-PURDATE
              MOVE LN-LOANDATE    TO REB-LN-LOANDATE
              MOVE LN-INTDATE     TO REB-LN-INTDATE
              MOVE LN-APRATE      TO REB-LN-APRATE
              MOVE LN-TOTNODEF    TO REB-LN-TOTNODEF
              IF REB-SUB < 5
                 MOVE LN-INSCOVR(1) TO REB-LN-INSCOVR
                 MOVE LN-INSEFF-DATE(1)  TO REB-LN-INSEFF
                 MOVE LN-INSEXP-DATE(1)  TO REB-LN-INSEXP
              ELSE
                IF REB-SUB = 6
                   MOVE LN-INSCOVR(3) TO REB-LN-INSCOVR
                   MOVE LN-INSEFF-DATE(3)  TO REB-LN-INSEFF
                   MOVE LN-INSEXP-DATE(3)  TO REB-LN-INSEXP
                ELSE
                  IF REB-SUB > 11 AND < 17
                     MOVE LN-INSCOVR(REB-SUB - 8) TO REB-LN-INSCOVR
                     MOVE LN-INSEFF-DATE(REB-SUB - 8)  TO REB-LN-INSEFF
                     MOVE LN-INSEXP-DATE(REB-SUB - 8)  TO REB-LN-INSEXP
                  ELSE
                     MOVE LN-INSCOVR(2) TO REB-LN-INSCOVR
                     MOVE LN-INSEFF-DATE(2)  TO REB-LN-INSEFF
                     MOVE LN-INSEXP-DATE(2)  TO REB-LN-INSEXP
                  END-IF
                END-IF
              END-IF
              MOVE LN-SALEFIN     TO REB-LN-SALEFIN

              MOVE LN-SMPRATE     TO REB-LN-SMPRATE
              MOVE LN-ORGTERM     TO REB-LN-ORGTERM
              MOVE LN-1STPYAMT    TO REB-LN-1STPYAMT
              MOVE LN-REGPYAMT    TO REB-LN-REGPYAMT
              MOVE LN-LASTPYAMT   TO REB-LN-LASTPYAMT.

           IF REB-SUB = 7 AND LN-CONVERCD = "X"
              IF LN-ADDON-FG NOT = "Y"
                      AND LN-FINCHG = LN-SUM-FINCHG
                 MOVE LN-ANTICERN(1) TO REB-TOTCHG
              ELSE
                 MOVE LN-OLDACCTNO TO REB-LN-PURDATE
                                      REB-LN-INTDATE
                                      REB-LN-LOANDATE
                                      NDTE-DATE
                 MOVE LN-PRLNNO TO REB-ORGTERM
                 MOVE 1 TO NDTE-HOLD
                 PERFORM INCREMENT-MONTHS
                 MOVE NDTE-DATE TO REB-LN-ORIG-1STPYDATE
                 COMPUTE REB-TOTCHG =
                    LN-ANTICERN(1) + LN-ANTICADJ(1) - LN-UFERN(1).

      *
      ***********   SET UNIT PERIOD INFO   **************************
            MOVE LN-UNITPER-CD      TO UPER-UNITPER-CD.
            MOVE LN-UNITPER-FREQ    TO UPER-UNITPER-FREQ.
            MOVE REB-LN-INTDATE     TO UPER-INTDATE.
            MOVE REB-LN-ORIG-1STPYDATE TO UPER-1STPYDATE.
            MOVE REB-ORGTERM        TO UPER-TERM.
            PERFORM UPER-CALCULATION.
      *^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      * IF SP-RBUNITPER-CD(REB-SUB) = "A"
      *    IF OTHER THAN MONTHLY PAY CODE OR PAYFREQ CONVERT BACK TO MONTHLY

            IF SP-RBUNITPER-CD(REB-SUB) = "A"
               IF NOT (
                       LN-UNITPER-CD = "M"
                           AND LN-UNITPER-FREQ = 1
                      )
                  COMPUTE REB-ORGTERM =
                       REB-ORGTERM / UPER-UNITPER-PER-YEAR * 12
                  IF REB-LN-TOTNODEF NOT = 0
                     MOVE LN-UNITPER-CD   TO UPWK-UNITPER-CD
                     MOVE LN-UNITPER-FREQ TO UPWK-UNITPER-FREQ
                     PERFORM UPWK-DEF-CALC
                     DIVIDE UPWK-UNITPER-WK INTO REB-LN-TOTNODEF.

      *^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      * IF SP-RBUNITPER-CD(REB-SUB) = "B"
      *    IF OTHER THAN MONTHLY PAY CODE OR PAYFREQ
      *       COMPUTATION OF ELAPSED-MONTHS, ETC WILL BE DONE ON
      *       UNIT PERIOD BASES
      *^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

      * TEST FOR TENN, CALIF, INDIANA, S. CAROLINA DEFERMENT REBATE:
           IF SP-RBFRMLA(REB-SUB) = "E" OR "O" OR "K"
                                 OR "M" OR "Y" OR "Z"
              PERFORM REBATE-DEFERMENT-EOKMYZ05
              GO TO REBATE-EXIT.

      * TEST FOR WISCONSIN DEFERMENT REBATE:
           IF SP-RBFRMLA(REB-SUB)  = "0" AND
              SP-RBFRMLA2(REB-SUB) = "5"
              PERFORM LOAN-CALCULATIONS
              IF (FINANCED-AMOUNT > 4999.99) OR
                 (LN-ORGTERM      > 36     )
                 MOVE LN-TOTDEF TO REB-REBATE
              ELSE
                 PERFORM REBATE-DEFERMENT-EOKMYZ05
              END-IF
              GO TO REBATE-EXIT.

      * TEST FOR REBATE 78THS WITH 1ST PAYMENT EXTENDED:
           IF SP-RBFRMLA(REB-SUB) = "3" OR "N"
              IF SP-RBEARLY(REB-SUB) NOT = 7
                 IF SP-RBSPOPT1(REB-SUB) NOT = 3
                    IF REB-ADDON-FG NOT = "Y"
                       ADD LN-EXTCHG TO REB-TOTCHG.

      * TEST FOR REBATE '0 9' THAT WILL INCLUDE 1ST PAYMENT EXTENSION: 'EXCEL'
           IF SP-RBFRMLA2(REB-SUB) = "9" OR
               SP-RBFRMLA2(REB-SUB) = "G"
              ADD LN-EXTCHG TO REB-TOTCHG.

      * TEST FOR REBATE 78THS W/1ST PMT EXT + DEFERMENTS:
           IF SP-RBFRMLA(REB-SUB) = "A"
              ADD LN-EXTCHG LN-TOTDEF TO REB-TOTCHG.

      * TEST FOR ACTUARIAL REBATE W/1ST PMT EXT + SERVICE CHGI
      * BUT NOT IF CALCULATED FOR EARNINGS LPCERN OR LPAERN:
           IF REB-SKIPDEF-FG NOT = "Y"
              IF SP-RBFRMLA(REB-SUB) = "D" OR "F"
                 ADD LN-EXTCHG LN-SERCHG TO REB-TOTCHG.

      * TEST FOR EARLY PAYOFF EXCEPTIONS:
           IF SP-RBEARLY(REB-SUB) NOT = 0
      *    TEST FOR MISSISSIPPI COMPANY PAYOFF PRORATA REBATE:
      *    TEST FOR ALABAMA COMPANY PAYOFF PRORATA REBATE( 90DAYS):
      *    TEST FOR ALABAMA COMPANY PAYOFF PRORATA REBATE(120DAYS):
              IF SP-RBEARLY(REB-SUB) = 3 OR 12 OR 15 OR 16
                 PERFORM REBATE-EP3
                 IF REB-SUB = 0
                    GO TO REBATE-EXIT
                 ELSE
                    NEXT SENTENCE
              ELSE
      * WORLD SOUTH CAROLINA COMPANY PAYOFF PRORATA INTEREST REBATE:
              IF SP-RBEARLY(REB-SUB) = 19
                 PERFORM REBATE-EP19
                 IF REB-SUB = 0
                    GO TO REBATE-EXIT
                 ELSE
                    NEXT SENTENCE
              ELSE
      * WORLD SOUTH CAROLINA SERVICE CHARGE REBATE:
              IF SP-RBEARLY(REB-SUB) = 20
                 PERFORM REBATE-EP20
                 IF REB-SUB = 0
                    GO TO REBATE-EXIT
                 ELSE
                    NEXT SENTENCE
              ELSE
      * TEST FOR ALABAMA PRIOR TO 90 DAY REBATE (SUN) :
              IF SP-RBEARLY(REB-SUB) = 14
                 PERFORM REBATE-EP14
                 GO TO REBATE-EXIT
              ELSE
      * TEST FOR ALABAMA PRIOR TO 90 DAY REBATE (FREEDOM) :
              IF SP-RBEARLY(REB-SUB) = 22
                 PERFORM REBATE-EP22
                 GO TO REBATE-EXIT
              ELSE
      * REGMGM ALABAMA, LIKE 22 EXCEPT AFTER 90 DAYS, USE SPR TABLE
              IF SP-RBEARLY(REB-SUB) = 25
                 PERFORM REBATE-EP22
                 IF REB-SUB = 0
                    GO TO REBATE-EXIT
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF SP-RBEARLY(REB-SUB) = 99
                    MOVE REB-SUB TO REB-SUB2
                    PERFORM REBATE-EARLY-99
                    IF REB-SUB2 = 0
                      GO TO REBATE-EXIT
                    ELSE
                      NEXT SENTENCE
                 ELSE
                  IF SP-RBEARLY(REB-SUB) = 97
                    MOVE REB-SUB TO REB-SUB2
                    PERFORM REBATE-EARLY-97
                    IF REB-SUB2 = 0
                      GO TO REBATE-EXIT
                    ELSE
                      NEXT SENTENCE
                  ELSE
                  IF SP-RBEARLY(REB-SUB) = 98
                     MOVE REB-SUB TO REB-SUB2
                     PERFORM REBATE-EARLY-98
                     IF REB-SUB2 = 0
                       GO TO REBATE-EXIT.



      * IF ON OR BEFORE START DATE, FULL REFUND (MERCURY),
      * WHERE START DATE IS 1 MONTH FROM 1ST PAY DATE:
           IF SP-RBEARLY(REB-SUB) = 9
              MOVE REB-PAYDATE TO NUM-DATE
              MOVE LN-ORIG-1STPYDATE TO SYS-DATE
              PERFORM TIM360
              IF ELAPSED-MONTHS > 0
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.

      * REBATE FORMULA2 "Q" "AL" CLOSING FEE
      *  THEY ALSO USE RBEARLY 99 FOR A FULL REFUND OF SERVICE CHARGE SO
      *  THIS CHECK MUST STAY BELOW TESTING FOR THAT.
      * IF RBFRMLA2 = "Q", AND IT ISNT WITHIN THE EARLY PROVISION OF 99,
      *  THEN YOU ARE ONLY REFUNDING THE CLOSING FEE (LN-POINTS)
           IF SP-RBFRMLA2(REB-SUB) = "Q"
              MOVE LN-POINTS TO REB-TOTCHG.

      *************************************************************
      *NORMAL:
      *  ESTABLISH REB-SUB2 PER REBATE DONE [BEFORE (1)]
      *  OR [ON OR AFTER (2)] 1STPAYDATE:
      *MISSISSIPPI OPT1=4:
      *  ESTABLISH REB-SUB2 PER REBATE DONE [ON OR BEFORE (2)]
      *  OR [AFTER (2)] 1STPAYDATE:
      *************************************************************
           PERFORM SELECT-SP-ELAPSED-TIMTBL.
           IF JULIAN-DATE = 0
              GO TO REBATE-EXIT.

      *THIS WAS BEING PERFORMED ABOVE THE SELECT-SP-ELAPSED-TIMTBL.
      *IT NEEDS TO COME AFTER THAT AS WE NEED TO KNOW IF PAYING PRIOR TO
      *1ST PAYMENT DUE(POFF-B4-1STPYDATE) WHICH IS SET IN 
      *SELECT-SP-ELAPSED-TIMTBL
      * TEST FOR MERCURY MISSISSIPPI PRORATA REBATE:
           IF SP-RBEARLY(REB-SUB) = 11
              PERFORM REBATE-EP11
              IF REB-SUB = 0
                 GO TO REBATE-EXIT.

      *   TEST FOR CLAY FINANCIAL, SINGLE PAY 78TH:
           IF SP-RBEARLY(REB-SUB) = 17
              PERFORM REBATE-EP17
              IF REB-SUB = 0
                 GO TO REBATE-EXIT.

      *  TEST FOR MISSISSIPPI 90 DAY RULE;
      *  AND FOR MERCURY ALABAMA INTEREST REFUND
      * IF SO WHEN PAYOFF IS ON OR BEFORE 1ST PAYDATE
      * INCLUDE 1ST PAY EXTENSION CHARGE:
           IF PODATE-B4-1STPYDATE
              IF SP-RBSPOPT1(REB-SUB) = 4 OR 12
                 ADD LN-EXTCHG TO REB-TOTCHG.

      * GET REBATE REFERENCE DATE:
           PERFORM REBATE-REFDATE.
           IF REB-REFDATE = 0
              MOVE 0 TO REB-SUB
              GO TO REBATE-EXIT.


      * CALCULATE ELAPSED TIME FROM REF THRU PAYDATE:
           PERFORM CALC-ELAPSED-REF-THRU-PODATE.
           IF JULIAN-DATE = 0
              MOVE 0 TO REB-SUB
              GO TO REBATE-EXIT.

      * TEST TO SEE IF PAYOFF IS PRIOR TO REF-DATE:
           IF REB-ELAPSED-DAYS NOT > 0
              IF NOT (REB-HOLD-RBDTE = "C" OR "D")
                            OR SP-RBEARLY(REB-SUB) = 7
                 MOVE 0 TO REB-ELAPSED-REM
                           REB-ELAPSED-MONTHS
              ELSE
                 IF REB-PAYDATE NOT = REB-LN-INTDATE
                    MOVE 0 TO REB-ELAPSED-MONTHS
                    MOVE 1 TO REB-ELAPSED-REM.

      * TEST FOR HOME CREDIT (NC), IF ELAPSED DAYS < 31
      * FULL REFUND:
           IF SP-RBDEDCHG(REB-SUB) = 9999.03 OR 9999.05
              IF REB-ELAPSED-DAYS < 31
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.

           IF SP-RBSPOPT2(REB-SUB) = 12
              IF REB-ELAPSED-DAYS NOT > 3
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.
           IF SP-RBSPOPT2(REB-SUB) = 4
              IF REB-ELAPSED-DAYS NOT > 10
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.
           IF SP-RBSPOPT2(REB-SUB) = 5
              IF REB-ELAPSED-DAYS NOT > 15
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.
      * TEST FOR LIBERAL/ARROW FULL REFUND IF PAYOFF WITHIN 30 DAYS:
           IF SP-RBSPOPT2(REB-SUB) = 6
              IF REB-ELAPSED-DAYS NOT > 30
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.
           IF SP-RBSPOPT2(REB-SUB) = 10
              IF REB-ELAPSED-DAYS NOT > 60
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.

      * LENDMARK * FULL REFUND UP TO "SAME AS CASH" DATE
           IF SP-RBSPOPT2(REB-SUB) = 9
              IF REB-PAYDATE NOT > LN-CASHDATE
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.

      * PEOPLES * FULL REFUND IF PAID WITHIN 30 DAYS
      *         * USES 360 YEAR IN TIME CALCULATIONS
           IF SP-RBSPOPT1(REB-SUB) = 24
              IF ELAPSED-DAYS NOT > 30
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-EXIT.

           PERFORM REBATE-TEST-SWING.

           PERFORM REBATE-DEDUCT-CHARGE.

           IF SP-RBEARLY(REB-SUB) = 2
              IF PODATE-B4-1STPYDATE
                 PERFORM REBATE-EP2
                 GO TO REBATE-EXIT.

      * PR1406 "IN"
           IF SP-RBEARLY(REB-SUB) = 27
              IF LN-EXTCHG NOT = 0
                 IF PODATE-B4-1STPYDATE
                    PERFORM REBATE-EP27
                    GO TO REBATE-EXIT.


           IF SP-RBEARLY(REB-SUB) = 18
              IF (LN-LNAMT - LN-INTCHG - LN-SERCHG - LN-EXTCHG)
                                                         < 100.01
                 MOVE 0 TO REB-REBATE
                 GO TO REBATE-EXIT
              ELSE
                 IF PODATE-B4-1STPYDATE
                    PERFORM REBATE-EP18
                    GO TO REBATE-EXIT.

           IF SP-RBEARLY(REB-SUB) = 10
              IF REB-SUB = 7
                 IF REB-ADDON-FG = "Y"
                    MOVE LTI-ANTICERN(1)   TO REB-TOTCHG
                 ELSE
                    MOVE LN-INTCHG TO REB-TOTCHG
                 END-IF
              END-IF
              IF REB-SUB = 8
                 IF (LN-LNAMT - LN-INTCHG - LN-SERCHG - LN-EXTCHG)
                                                         < 100.01
                    MOVE 0 TO REB-REBATE
                    GO TO REBATE-EXIT
                 END-IF
              END-IF
              IF PODATE-B4-1STPYDATE
                 IF REB-ADDON-FG NOT = "Y"
                 PERFORM REBATE-EP10
                 GO TO REBATE-EXIT.

      * WORLD MISSOURI 6/03/1999 23
      * WORLD ILLINOIS 1/28/2020 28
           IF SP-RBEARLY(REB-SUB) = 23 OR 28
              MOVE LN-INTCHG TO REB-TOTCHG
              IF PODATE-B4-1STPYDATE
                 PERFORM REBATE-EP23-28
                 GO TO REBATE-EXIT.


      * TEST FOR MERCURY NEVADA PRORATA REBATE:
           IF SP-RBEARLY(REB-SUB) = 13
              PERFORM REBATE-EP13
              IF REB-SUB = 0
                 GO TO REBATE-EXIT.

      * TEST FOR TFC PHYSICAL DAMAGE COVERAGE SHORT RATE REBATE:
           IF SP-RBEARLY(REB-SUB) = 24
              PERFORM REBATE-EP24
              IF REB-SUB = 0
                 GO TO REBATE-EXIT.


      * INTSUB IS INT LEVEL OF INS/INT ARRAY; MUST COME LAST
           IF REB-SUB < 1 OR > 18 OR REB-PAYDATE = 0
              MOVE 0 TO REB-SUB
              GO TO REBATE-EXIT.

           IF REB-TOTCHG NOT > 0 OR SP-RBFRMLA(REB-SUB) = " "
              GO TO REBATE-EXIT.
           IF REB-ADDON-FG = "Y" AND REB-SUB = 7
              NEXT SENTENCE
           ELSE
              IF REB-DEDCHG > REB-TOTCHG
                 GO TO REBATE-EXIT.

      * TEST FOR ACTUARIAL-IB-REBATE:
           IF SP-RBFRMLA(REB-SUB) = "6"
              PERFORM REBATE-ACTUARIAL-IB
              PERFORM REBATE-ADJUST-REB-REBATE
              GO TO REBATE-EXIT.

      * SKIP THIS TEST FOR (0 I)
           IF NOT ( SP-RBFRMLA(REB-SUB)  = "0" AND
                    SP-RBFRMLA2(REB-SUB) = "I"
                  )
      * BELOW THIS FLOOR CONSIDERED FULLY EARNED
              IF REB-REMTERM < SP-RBNOMON(REB-SUB)
                 IF NOT (SP-RBFRMLA(REB-SUB) = "D" OR "F")
                    GO TO REBATE-EXIT.

           IF REB-RECAST = "Y" AND SP-RBRECAST(REB-SUB) = 1
              MOVE "C" TO REB-FORM-PROG-TYPE
              MOVE 01 TO REB-FORM-PROG-NO
              PERFORM REBATE-CALL-SUBPROG
              IF REB-COMMON-RTNCD = " "
                 MOVE REB-COMMON-REBATE TO REB-REBATE
                 GO TO REBATE-END-ADJ
              ELSE
                 MOVE 0 TO REB-REBATE REB-SUB
                 GO TO REBATE-EXIT.

      * CHOOSE REBATE METHOD:
           IF SP-RBSPOPT2(REB-SUB) = 1
              IF REB-LPTRCD = "PB" OR "RN" OR "SC"
                                OR "RB" OR "RO"
                 PERFORM REBATE-PRORATA
                 GO TO REBATE-END-ADJ.

           IF SP-RBSPOPT2(REB-SUB) = 3
              IF REB-LPTRCD = "RI"
                 PERFORM REBATE-PRORATA
                 GO TO REBATE-END-ADJ.

      * WDT 1-18-96
           IF SP-RBSPOPT2(REB-SUB) = 7
              IF REB-LPTRCD = "PB" OR "RN" OR "RB" OR "RO"
                 PERFORM REBATE-ACTUARIAL-F-06
                 GO TO REBATE-END-ADJ.

      * COLTN 10/31/2011 PR# 3900
      *  IF RENEWAL, USE FMLA "F", IF PAYOFF WITHIN 24 MONTHS, USE SPR,
      *   OTHERWISE USE "F"
           IF SP-RBSPOPT2(REB-SUB) = 13
              IF REB-LPTRCD = "PB" OR "RN" OR "RB" OR "RO" OR "SC"
                 PERFORM REBATE-ACTUARIAL-F-06
                 GO TO REBATE-END-ADJ
              ELSE
              IF REB-LPTRCD = "PO"
      * IF PAYOFF WITHIN 24 MONTHS, FALL THRU HERE AND USE SPR
      * IF PAYOFF > 24 MONTHS, USE FORMULA "F"
                 IF REB-ELAPSED-MONTHS > 24
                    PERFORM REBATE-ACTUARIAL-F-06
                    GO TO REBATE-END-ADJ.

      * SUN, LA IF PAID BY "PB" OR "RN" REFUND RULE OF 78TH'S, IF PAID
      *         OFF WITH "PO", NO REFUND
           IF SP-RBSPOPT1(REB-SUB) = 22
               IF REB-LPTRCD = "PO"
                 MOVE 0 TO REB-REBATE
                 GO TO REBATE-END-ADJ.

      * MULLEN, CA IF REPO REBATE PRORATA, EXACT DAILY:
           IF SP-RBSPOPT1(REB-SUB) = 7
              IF (LN-REPOCD = "X" OR "S")
                         OR (REB-LPTRCD = "PB" OR "RN"
                             OR "RB" OR "RO")
                 PERFORM REBATE-PRORATA-EXACT
                 GO TO REBATE-END-ADJ.

      * MULLEN, CA IF REPO, RENEWED OR <= 60 DAYS, REBATE PRORATA,
      *            EXACT DAILY:
           IF SP-RBSPOPT1(REB-SUB) = 18
              IF (LN-REPOCD = "X" OR "S") OR
                   (REB-LPTRCD = "PB" OR "RN" OR "RB" OR "RO") OR
                     (REB-ELAPSED-DAYS NOT > 60)
                 PERFORM REBATE-PRORATA-EXACT
                 GO TO REBATE-END-ADJ.

      * REGIONAL ACCPT, IF REPO, REBATE PRORATA, MONTHLY:
           IF SP-RBSPOPT1(REB-SUB) = 17
              IF (LN-REPOCD = "X" OR "S")
                 PERFORM REBATE-PRORATA
                 GO TO REBATE-END-ADJ.

      **** BEGINNING OF RBFRMLA PERFORMS: ***

           IF SP-RBFRMLA(REB-SUB) = "1" OR SP-RBFRMLA2(REB-SUB) = "Q"
              PERFORM REBATE-78
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "2"
              PERFORM REBATE-ACTUARIAL-2
           ELSE
      * EXT. CHARGE HAS ALREADY BEEN ADDED IN:
           IF SP-RBFRMLA(REB-SUB) = "3" OR "N"
              PERFORM REBATE-78
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "4"
              PERFORM REBATE-ANTICIPATED
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "5"
              PERFORM REBATE-PRORATA
           ELSE
      * ACTUARIAL USING WHOLE MONTHS ONLY:
           IF SP-RBFRMLA(REB-SUB) = "7" OR "B"
              PERFORM REBATE-ACTUARIAL-7-B
           ELSE
      * INSURANCE ANTICIPATED:
           IF SP-RBFRMLA(REB-SUB) = "8"
              PERFORM REBATE-INS-ANTICIPATED
           ELSE
      * NOTE:  EXT. CHARGE AND DEFERMENTS HAVE ALREADY
      *        BEEN ADDED IN IF SP-RBFRMLA(REB-SUB) = "A"
           IF SP-RBFRMLA(REB-SUB) = "A"
              PERFORM REBATE-78
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "C"
              PERFORM REBATE-ACTUARIAL-C
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "D"
              PERFORM REBATE-ACTUARIAL-D
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "F"
              PERFORM REBATE-ACTUARIAL-F-06
           ELSE
      * MASS. A&H ANTICIPATED (IDEAL):
           IF SP-RBFRMLA(REB-SUB) = "G"
              PERFORM REBATE-MA-AH-ANTICIPATED
           ELSE
      * "H" (GA) SERCHG REBATE (ROGER WILLIAMS)
      * "I" (GA)   "      "    (JOE DOUGLAS SR):
           IF SP-RBFRMLA(REB-SUB) = "H" OR "I"
              PERFORM REBATE-GA-SC
           ELSE
      * MULLEN, CA INSURANCE:
           IF SP-RBFRMLA(REB-SUB) = "J"
              PERFORM REBATE-PRORATA-EXACT
           ELSE
      * MULLEN, CA A&H ANTICIPATED:
           IF SP-RBFRMLA(REB-SUB) = "L"
              PERFORM REBATE-CA-AH-ANTICIPATED
           ELSE
      * UVALDE, TX A&H ANTICIPATED:
           IF SP-RBFRMLA(REB-SUB) = "P"
              PERFORM REBATE-TX-ANTICIPATED
           ELSE
      * INSURANCE ACTUARIAL (VA) USING WHOLE MONTHS ONLY:
           IF SP-RBFRMLA(REB-SUB) = "Q"
              PERFORM REBATE-ACTUARIAL-Q
           ELSE
      * TIME LOAN, CA A&H ANTICIPATED:
           IF SP-RBFRMLA(REB-SUB) = "R"
              PERFORM REBATE-CA-ANTICIPATED
           ELSE
      * TIME LOAN, CA 'CL' ANTICIPATED REFUND:
           IF SP-RBFRMLA(REB-SUB) = "S"
              PERFORM REBATE-CA-CL-ANTICIPATED
           ELSE
      * LIBERAL NJ TABLE FORMULA:
           IF SP-RBFRMLA(REB-SUB) = "T"
              PERFORM REBATE-TABLE-FORMULA
           ELSE
      * MERCURY A&H ANTICIPATED :
           IF SP-RBFRMLA(REB-SUB) = "U"
              PERFORM REBATE-MERC-AH-ANTIC
           ELSE
      * MERCURY DAILY PRORATA REFUND OF DEFERMENT CHARGES
           IF SP-RBFRMLA(REB-SUB) = "V" OR "W"
              PERFORM REBATE-MERC-DAILY-PRORATA
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "0"
      *************************************************
      *    SP-RBFRMLA2 FORMULAS   (SP-RBFRMLA ='0')
      *************************************************
      * MERCURY DAILY PRORATA REFUND 'AZ' (RP)
              IF SP-RBFRMLA2(REB-SUB) = "1"
                 PERFORM REBATE-MERC-TO-THE-DAY
              ELSE
      * MULLEN CA, CL NET PAYOFF BALBOA INSURANCE
              IF SP-RBFRMLA2(REB-SUB) = "2"
                 PERFORM REBATE-NET-POFF-MULL
              ELSE
      * MEAN RULE 78THS, REGACC #NA
              IF SP-RBFRMLA2(REB-SUB) = "3"
                 PERFORM RULE-78THS-MEAN
              ELSE
      * TN SHORT RATE, CONSUMERS #1062
              IF SP-RBFRMLA2(REB-SUB) = "4"
                 PERFORM TN-PP-SHORT-RATE
              ELSE
      * TN ACTUARIAL REFUND LIKE 'F' USING EQUIVALENT SIMPLE RATE
              IF SP-RBFRMLA2(REB-SUB) = "6"
                 PERFORM REBATE-ACTUARIAL-F-06
              ELSE
      * CA 'CL' TRUNCATED NET AND 'AH' 14 DAY NON RETRO PROTECTIVE LIFE
              IF SP-RBFRMLA2(REB-SUB) = "7"
                 PERFORM REBATE-MULLEN-CL-AH-07
              ELSE
      * WI CPI REFUND FORMULA
              IF SP-RBFRMLA2(REB-SUB) = "8"
                 PERFORM REBATE-WI-CPI
              ELSE
      * TX INTEREST REFUND FORMULA .....EXCEL
              IF SP-RBFRMLA2(REB-SUB) = "9"
                 PERFORM REBATE-TX-INTEREST
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "L"
                 PERFORM REBATE-TX-INT-UNITED
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "H"
                 PERFORM REBATE-TX-INT-0H
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "I"
                 PERFORM REBATE-TRIST-CPI-0I
              ELSE
      * MEAN OF PRORATE & RULE 78THS ...WORLD
              IF SP-RBFRMLA2(REB-SUB) = "A"
                 PERFORM REBATE-MEAN-OF-PRORATA-78
              ELSE
      * RULE 78THS FOR NET + 1 LIFE REFUND
              IF SP-RBFRMLA2(REB-SUB) = "B"
                 PERFORM REBATE-78-NET-1
              ELSE
      * CA COLLATERAL PROTECTION INSURANCE (SHORT RATE REBATE)
              IF SP-RBFRMLA2(REB-SUB) = "C" OR "K"
                 PERFORM REBATE-SHORT-RATE-0C
              ELSE
      * RULE 78THS USING DAYS IN TERM .........REGACC
              IF SP-RBFRMLA2(REB-SUB) = "D"
                 PERFORM REBATE-78-DAYS-0D
              ELSE
      * ACTUARIAL NET PAYOFF REBATE   .........WORLD
              IF SP-RBFRMLA2(REB-SUB) = "E"
                 PERFORM REBATE-ACTUARIAL-0E
              ELSE
      * TRUE DAILY PRORATE REBATE     .........WORLD
              IF SP-RBFRMLA2(REB-SUB) = "F"
                 PERFORM REBATE-TRUE-PRORATA-0F
              ELSE
      * MF REBATE SAME PROPORTION AS INT & SCHG  ....MEXICO WORLD
              IF SP-RBFRMLA2(REB-SUB) = "G"
                 PERFORM REBATE-SAME-PROP-INT-SC-0G
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "J"
                 PERFORM REBATE-MX-CL-ANTICIPATED
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "M"
                 PERFORM REBATE-INS-ANTICIPATED
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "N" OR "P"
                 PERFORM REBATE-ANTICIPATED-N-P
              ELSE
              IF SP-RBFRMLA2(REB-SUB) = "O"
                 PERFORM REBATE-ANTICIPATED-O.

       REBATE-END-ADJ.
           PERFORM REBATE-ADJUST-REB-REBATE.

       REBATE-EXIT.
           IF BR-FORCE-VALID-CITY-COUNTY = "Y"
      *      CREDIT LIFE SALES TAX:
              IF REB-SUB < 5
                 COMPUTE INS-TAX-RB ROUNDED =
                    LN-FEEAMT(5) * REB-REBATE / REB-TOTCHG
                 ADD INS-TAX-RB TO REB-REBATE
              ELSE
      *      A&H SALES TAX:
              IF REB-SUB = 5
                 COMPUTE INS-TAX-RB ROUNDED =
                    LN-FEEAMT(6) * REB-REBATE / REB-TOTCHG
                 ADD INS-TAX-RB TO REB-REBATE
              ELSE
      *      PP & PP2 SALES TAX:
              IF REB-SUB = 6 OR 11
                 COMPUTE INS-TAX-RB ROUNDED =
                    LN-FEEAMT(7) * REB-REBATE / REB-TOTCHG
                 ADD INS-TAX-RB TO REB-REBATE
              ELSE
      *      O1 OR O2 OR O3 OR O4 OR O5 SALES TAX:
              IF REB-SUB > 11 AND < 17
                 COMPUTE INS-TAX-RB ROUNDED =
                    LN-FEEAMT(REB-SUB - 4) * REB-REBATE / REB-TOTCHG
                 ADD INS-TAX-RB TO REB-REBATE.

           MOVE 0 TO REB-STATEWK.
           MOVE SPACES TO REB-SKIPDEF-FG
                          REB-ADDON-FG.


      *********************************
      *    RULE OF 78'S ROUTINE   (1)
      *********************************
       REBATE-78 SECTION.
            IF SP-RBEARLY(REB-SUB) NOT = 4
               PERFORM REBATE-78-ROUTINE
               GO TO REBATE-78-EXIT.

      * TEST FOR GEORGIA NORMAL REBATE FOR INTEREST:
            IF NOT (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                    OR "RB" OR "RO")
               PERFORM REBATE-78-ROUTINE
               GO TO REBATE-78-EXIT.

      * TEST FOR GEORGIA RENEWAL PRORATION:
            PERFORM REBATE-78-ROUTINE.
            MOVE REB-REBATE TO REB-STATEWK.
            SUBTRACT 1 FROM REB-REMTERM.
            PERFORM REBATE-78-ROUTINE.

            COMPUTE REB-REBATE ROUNDED = REB-REBATE +
                (REB-STATEWK - REB-REBATE ) / 30 * REB-ELAPSED-REM.
            GO TO REBATE-78-EXIT.


       REBATE-78-EXIT.
           EXIT.

      ******************************************
      *    ACTUARIAL REBATE ROUTINE  2
      ******************************************
       REBATE-ACTUARIAL-2 SECTION.
           MOVE 0 TO REB-REBATE.
           IF REB-LN-APRATE = 0
              GO TO REBATE-ACTUARIAL-2-EXIT.

      * TEST FOR INCREASE OF REMAINING TERM BY DEFERMENTS:
           IF REB-SKIPDEF-FG = " "
              ADD REB-LN-TOTNODEF TO REB-REMTERM.

      * SET FULL REBATE IF NO TIME ELAPSED:
           IF REB-REMTERM > REB-ORGTERM
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO REBATE-ACTUARIAL-2-EXIT.

      * TEST FOR PAST MATURITY:
           IF REB-REMTERM < 0
              GO TO REBATE-ACTUARIAL-2-EXIT.

      * APR PER PMT INTERVAL:
           COMPUTE REB-PRATE =
              (REB-LN-APRATE / 100) / 12.

      * COMPOUND INTEREST FACTOR:
           COMPUTE REB-FACTOR ROUNDED =
              1 / ((1 + REB-PRATE) ** REB-REMTERM).

      * COMPUTE BALANCE OWING EXCLUDING PARTIAL MONTHS:
           COMPUTE REB-BAL ROUNDED =
              REB-LN-REGPYAMT * ((1 - REB-FACTOR) / REB-PRATE).

      * INTEREST FOR PARTIAL MONTHS (SP-YEARTYPE OK HERE):
           MOVE 360 TO ELAPSED-YRTYPE.
           IF SP-RBYRTYPE(REB-SUB REB-SUB2) = 365
              MOVE 365 TO ELAPSED-YRTYPE.
           IF REB-ELAPSED-REM NOT = 0
              COMPUTE REB-BAL ROUNDED = REB-BAL *
                 (1 + REB-ELAPSED-REM * (REB-PRATE * 12)
                                           / ELAPSED-YRTYPE).
      * COMPUTE REBATE AMOUNT:
           COMPUTE REB-REBATE =
                       (REB-LN-REGPYAMT * REB-REMTERM) - REB-BAL.

           IF SP-RBSPOPT1(REB-SUB) = 20
      * (A) 10 % OF AMT FINANCED. IF > $75, THEN $75, IF < $75,
      *     THEN 10% AMT FINANCED.
              PERFORM LOAN-CALCULATIONS
              COMPUTE REB-WORKER ROUNDED = FINANCED-AMOUNT *
                                            .10
              IF REB-WORKER > 75.00
                 MOVE 75.00 TO REB-WORKER
              END-IF
      * (B) COMPUTE INTEREST EARNED
      * (C) TAKE THE LARGER FIGURE
              IF REB-WORKER > (REB-TOTCHG - REB-REBATE)
                 COMPUTE REB-REBATE = REB-TOTCHG - REB-WORKER.


       REBATE-ACTUARIAL-2-EXIT.
           EXIT.

      *********************************
      *   ANTICIPATED 78 REBATE  (4)
      *********************************
       REBATE-ANTICIPATED SECTION.
      * UNIT CHARGE
           IF LN-OVRDRATE = 999.999
              MOVE SP-CAL-RATE(1,1) TO REB-PRATE
           ELSE
              MOVE LN-OVRDRATE TO REB-PRATE.
           COMPUTE REB-SUMORG =
                         (REB-PRATE * REB-LN-REGPYAMT) / 12.
           PERFORM REBATE-78-REBATE.
       REBATE-ANTICIPATED-EXIT.
           EXIT.

      *********************************
      *    PRO RATA REBATE METHOD  (5)
      *********************************
       REBATE-PRORATA SECTION.
           IF ( NOT (SP-RBEARLY(REB-SUB) = 5 OR 6) )
            OR
              ( ( SP-RBEARLY(REB-SUB) = 5 OR 6 ) AND
                               ( REB-ELAPSED-REM =  0 ) )
              PERFORM REBATE-PRORATA-ROUTINE
              GO TO REBATE-PRORATA-EXIT.

           IF SP-RBEARLY(REB-SUB) = 5
              PERFORM REBATE-PRORATA-GA-SWING
           ELSE
              PERFORM REBATE-PRORATA-GA-NO-SWING.
           GO TO REBATE-PRORATA-EXIT.

      * GEORGIA PRORATA / RULE 78 SLICE W/SWING FOR MAINT. FEES:
       REBATE-PRORATA-GA-SWING.
           PERFORM REBATE-PRORATA-ROUTINE.
           MOVE REB-REBATE TO REB-STATEWK.
           MOVE REB-TOTCHG TO REB-STATEWK2.
           MOVE LN-MAINTFEE TO REB-TOTCHG.
           PERFORM REBATE-78.
           MOVE REB-STATEWK2 TO REB-TOTCHG.
           COMPUTE REB-REBATE = REB-STATEWK
                          + (LN-MAINTFEE - REB-REBATE).

      * GEORGIA PRORATA / RULE 78 SLICE W/NO SWING FOR MAINT. FEES:
       REBATE-PRORATA-GA-NO-SWING.
           PERFORM REBATE-PRORATA-ROUTINE.
           IF REB-ELAPSED-REM NOT = 30
              COMPUTE REB-REBATE ROUNDED = REB-REBATE -
                  ( LN-MAINTFEE - (30 - REB-ELAPSED-REM)
                          * (30 - REB-ELAPSED-REM + 1)
                                        / 930 * LN-MAINTFEE ).

       REBATE-PRORATA-ROUTINE.
           IF REB-ORGTERM NOT = 0
              COMPUTE REB-REBATE ROUNDED =
                  (REB-TOTCHG - REB-DEDCHG) *
                         (REB-REMTERM / REB-ORGTERM).


       REBATE-PRORATA-EXIT.
           EXIT.

      *********************************
      *    ACTUARIAL (IB)     (6)
      *
      *    (INTEREST BEARING METHOD)
      *********************************
       REBATE-ACTUARIAL-IB SECTION.
           PERFORM LOAN-CALCULATIONS.
           IF PRINCIPLE < TOTAL-NOTE
              COMPUTE REB-REBATE ROUNDED =
                   (TOTAL-NOTE - PRINCIPLE - LN-TOTINT)
                   / (TOTAL-NOTE - PRINCIPLE) * REB-TOTCHG.
       REBATE-ACTUARIAL-IB-EXIT.
           EXIT.

      ****************************************************************
      *    SECURITY OF AMERICA   ACTUARIAL  (7 OR B)
      *
      *    NOTE:
      *          7 - USES A.P.R.
      *          B - USES EQUIVALENT SIMPLE RATE
      *
      *        1
      *    ------------   + IT - 1
      *     (1 + I)**T
      *   --------------------------  *  REB-TOTCHG
      *        1
      *    ------------   + IN - 1
      *     (1 + I)**N
      *
      * WHERE:   T = REMAINING TERM OF INSURANCE, IN MONTHS
      *          N = ORIGINAL TERM OF INSURANCE, IN MONTHS
      *          I = APR OR SMP RATE OF LOAN DIVIDED BY 1200
      ****************************************************************
       REBATE-ACTUARIAL-7-B SECTION.
           IF SP-RBFRMLA(REB-SUB) = "7"
              MOVE REB-LN-APRATE TO REB-MPRATE
           ELSE
              MOVE LN-SMPRATE TO REB-MPRATE.

           COMPUTE REB-MPRATE ROUNDED = REB-MPRATE / 1200.

      *MEXICO SEMI-MONTHLY ACTUARIAL REBATE USING UNIT PERIODS PER YEAR
      *TO DETERMINE RATE INSTEAD OF A MONTHLY RATE USING FORMULA 'B'
           IF SP-ORGST = "MX"
              IF REB-SUB = 7
                 IF SP-RBUNITPER-CD(REB-SUB) = "B"
                    IF SP-RBFRMLA(REB-SUB) = "B"
                       MOVE LN-SMPRATE TO REB-MPRATE
                        COMPUTE REB-MPRATE = REB-MPRATE * .01
                                 / UPER-UNITPER-PER-YEAR.


           COMPUTE REB-REBATE ROUNDED =
                 (1 / ((1 + REB-MPRATE) ** REB-REMTERM) +
                               (REB-MPRATE * REB-REMTERM) - 1
                 )
                 /
                 (1 / ((1 + REB-MPRATE) ** REB-ORGTERM) +
                             (REB-MPRATE * REB-ORGTERM) - 1
                 )
                 * REB-TOTCHG.

      ****************************************************************
      *    INSURANCE REFUND   ACTUARIAL  (Q)
      *        VIRGINIA
      *
      ****************************************************************
       REBATE-ACTUARIAL-Q SECTION.
           IF SP-RBSPOPT1(REB-SUB) = 26
              COMPUTE REBI ROUNDED = LN-APRATE / 1200
           ELSE
              COMPUTE REBI ROUNDED = LN-SMPRATE / 1200.
           COMPUTE REB-REBATE ROUNDED =
               REB-TOTCHG
               *
               ( REB-REMTERM
                  -
                    (
                     (1 - 1 / (1 + REBI) ** (LN-ORGTERM
                                              - REB-ORGTERM
                                                + REB-REMTERM)
                     ) / REBI
                    )
                  +
                    (
                     (1 - 1 / (1 + REBI) ** (LN-ORGTERM
                                              - REB-ORGTERM)
                     ) / REBI
                    )
               )
               /
               ( REB-ORGTERM
                  -
                    (
                     (1 - 1 / (1 + REBI) ** (LN-ORGTERM)) / REBI
                    )
                  +
                    (
                     (1 - 1 / (1 + REBI) ** (LN-ORGTERM
                                              - REB-ORGTERM)
                     ) / REBI
                    )
               ).

      *****************************************************
      *    INSURANCE ANTICIPATED
      *      PACESETTER "TX" (8)
      *      WORLD "TX"      RBFRMLA2 = "M"   JUST LIKE 8 EXCEPT DOES
      *                                       NOT TRUNCATE RATE FROM TABLE
      *
      *    THIS ROUTINE CALCULATES TO INSURANCE  PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT.
      *****************************************************
       REBATE-INS-ANTICIPATED SECTION.
           MOVE REB-SUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

      *    CREDIT LIFE
           IF REB-SUB < 5
              MOVE 1 TO ITRM-SUB
           ELSE
      *       A&H & PP
              IF REB-SUB < 7
                 SUBTRACT 3 FROM REB-SUB GIVING ITRM-SUB
              ELSE
      *          O1, O2, O3, O4, O5
                 SUBTRACT 8 FROM REB-SUB GIVING ITRM-SUB.

           PERFORM INS-TERM-CALCULATION.

      * DO NOT TRUNCATE THE RATE FROM THE SPR TABLE !
           IF SP-RBFRMLA2(REB-SUB) = "M"
              COMPUTE REB-REBATE ROUNDED =
                  REB-LN-INSCOVR / ITRM-INSTERM
                      * REB-REMTERM * REB-MANYDECIMALS / 100
           ELSE
              COMPUTE REB-REBATE ROUNDED =
                  REB-LN-INSCOVR / ITRM-INSTERM
                      * REB-REMTERM * REB-HUNDREDS / 100.

       REBATE-INS-ANTICIPATED-EXIT.
           EXIT.

      *****************************************************
      *    INSURANCE ANTICIPATED
      *      CFSC - ASSURANT - STATE OF IN
      *
      * N - DISCOUNT RATE .037
      * P - DISCOUNT RATE .0142
      *
      *    THIS ROUTINE CALCULATES TO INSURANCE  PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT.
      *
      *****************************************************
       REBATE-ANTICIPATED-N-P SECTION.

      *--->MOVE REB-SUB TO REB-INSSUB.
      *--->PERFORM REBATE-FIND-INS-RATE.

           COMPUTE REBM = ITRM-INSTERM - REB-ELAPSED-MONTHS.
           COMPUTE REBR = LN-ORGTERM - ITRM-INSTERM.

           IF SP-RBFRMLA2(REB-SUB) = "P"
              COMPUTE REBJ = (( 1 + 0.0142)**(1/12)) - 1
           ELSE
              COMPUTE REBJ = (( 1 + 0.037)**(1/12)) - 1.
           COMPUTE REBWK1 = 1 / (( 1 + REBJ ) ** ITRM-INSTERM).
           COMPUTE REBWK2 = 1 / (( 1 + REBJ ) ** REBM).
           COMPUTE REBAN-M-1 = (1 - (1/(1+REBJ)) ** ITRM-INSTERM) / REBJ.
           COMPUTE REBAN-M-1-T = (1 - (1/(1+REBJ))** REBM) / REBJ.

           COMPUTE REB-REBATE ROUNDED =
                REB-TOTCHG *
                ((REBM - (REBR * REBWK2) - REBAN-M-1-T) /
                 (LN-ORGTERM - (REBR * REBWK1)  - REBAN-M-1)).

       REBATE-ANTICIPATED-N-EXIT.
           EXIT.

      **********************************************************************
      *    "O": RULE OF ANTICIPATION FOR LIFE REFUND - STATE OF TEXAS
      *
      *      GROSS LIFE COVERAGE, SINGLE PREMIUM PER $100 PER YEAR STATES,
      *                               WITH DISCOUNT
      *
      * DEFINITIONS:
      *
      * DS-RATE= .035   FIXED
      * OP     = ORIGINAL PREMIUM (REB-TOTCHG)
      * M      = ORIG INS TERM IN MONTHS (ITRM-INSTERM)
      * T      = ELAPSED MONTHS FROM INCEPTION TO REFUND (REB-ELAPSED-MONTHS)
      * DSRATE = DISCOUNT RATE (REB-MANYDECIMALS)
      *
      *                      1 + (DSRATE * M)/24     (M-T)*(M-T)
      * REFUND = ORIG PREM * --------------------- * -----------
      *                      1 + (DSRATE * M-T)/24     (M * M)
      *
      **********************************************************************
       REBATE-ANTICIPATED-O SECTION.

           MOVE REB-SUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

           COMPUTE REBM = ITRM-INSTERM - REB-ELAPSED-MONTHS.

           COMPUTE REBWK1 = (1 + (.035 * ITRM-INSTERM)/24)/
                            (1 + (.035 * REBM)/24).

           COMPUTE REBWK2 = (REBM*REBM)/(ITRM-INSTERM*ITRM-INSTERM).

           COMPUTE REB-REBATE ROUNDED = REB-TOTCHG * REBWK1 * REBWK2.

       REBATE-ANTICIPATED-O-EXIT.
           EXIT.

      ******************************************
      *    ACTUARIAL REBATE ROUTINE   C
      ******************************************
      * ROUTINE IS EXCLUSIVELY FOR INTEREST:

       REBATE-ACTUARIAL-C SECTION.
           MOVE 0 TO REB-REBATE.

      * GET EQUIVALENT SIMPLE NUMBERS:
           PERFORM APRS-RATE.
           IF APRS-SMPRATE = 0
              GO TO REBATE-ACTUARIAL-C-EXIT.

      * TEST FOR INCREASE OF REMAINING TERM BY DEFERMENTS:
           IF REB-SKIPDEF-FG = " "
              ADD REB-LN-TOTNODEF TO REB-REMTERM.

      * SET FULL REBATE IF NO TIME HAS ELAPSED:
           IF REB-REMTERM > REB-ORGTERM
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO REBATE-ACTUARIAL-C-EXIT.

      * TEST FOR PAST MATURITY:
           IF REB-REMTERM < 0
              GO TO REBATE-ACTUARIAL-C-EXIT.

      * APR PER PMT INTERVAL:
           COMPUTE REB-PRATE = (APRS-SMPRATE / 100) / 12.

      * COMPOUND INTEREST FACTOR:
           COMPUTE REB-FACTOR ROUNDED =
              1 / (1 + REB-PRATE) ** REB-REMTERM.


      * COMPUTE BALANCE OWING EXCLUDING PARTIAL MONTHS:
           COMPUTE REB-BAL ROUNDED =
                  APRS-REGPYAMT * ((1 - REB-FACTOR) / REB-PRATE).

      * INTEREST FOR PARTIAL MONTHS (SP-YEARTYPE OK HERE):
           MOVE 360 TO ELAPSED-YRTYPE.
           IF SP-RBYRTYPE(REB-SUB REB-SUB2) = 365
              MOVE 365 TO ELAPSED-YRTYPE.
           IF REB-ELAPSED-REM NOT = 0
              COMPUTE REB-BAL ROUNDED = REB-BAL *
                 (1 + REB-ELAPSED-REM * (REB-PRATE * 12)
                                           / ELAPSED-YRTYPE).

      * COMPUTE REBATE AMOUNT:
           COMPUTE REB-REBATE =
                       (APRS-REGPYAMT * REB-REMTERM) - REB-BAL.
       REBATE-ACTUARIAL-C-EXIT.
           EXIT.

      ******************************************
      *    ACTUARIAL REBATE ROUTINE  D
      *               IOWA
      ******************************************
       REBATE-ACTUARIAL-D SECTION.
           MOVE 0 TO REB-REBATE.
           IF REB-LN-APRATE = 0
              GO TO REBATE-ACTUARIAL-D-EXIT.

      * TEST FOR INCREASE OF REMAINING TERM BY DEFERMENTS:
           IF REB-SKIPDEF-FG = " "
              ADD REB-LN-TOTNODEF TO REB-REMTERM.

      * SET FULL REBATE IF NO TIME ELAPSED:
           IF REB-REMTERM > REB-ORGTERM
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO REBATE-ACTUARIAL-D-EXIT.

      * TEST FOR PAST MATURITY:
           IF REB-REMTERM < 0
              GO TO REBATE-ACTUARIAL-D-EXIT.

      * SET ELAPSED-YRTYPE:
           MOVE 360 TO ELAPSED-YRTYPE.
           IF SP-RBYRTYPE(REB-SUB REB-SUB2) = 365
              MOVE 365 TO ELAPSED-YRTYPE.

      * DETERMINE NO OF DAYS BASED ON PAYDATE THRU NEXT PAY:
           IF REB-ELAPSED-REM NOT = 0
              MOVE REB-LN-INTDATE TO NUM-DATE
              MOVE REB-PAYDATE TO NDTE-DATE
              IF NDTE-DD < NUM-DA
                 MOVE NUM-DA TO NDTE-DD
              ELSE
                 MOVE NUM-DA TO NDTE-DD
                 MOVE 1 TO NDTE-HOLD
                 PERFORM INCREMENT-MONTHS.
           IF REB-ELAPSED-REM NOT = 0
              MOVE REB-PAYDATE TO NUM-DATE
              MOVE NDTE-DATE TO SYS-DATE
              PERFORM TIMALL
              COMPUTE REB-ELAPSED-REM =
                       (ELAPSED-YRTYPE / 12) - ELAPSED-DAYS.

      * APR PER PMT INTERVAL:
           COMPUTE REB-PRATE = (REB-LN-APRATE / 100) / 12.

      * COMPOUND INTEREST FACTOR:
           COMPUTE REB-FACTOR ROUNDED =
              1 / ((1 + REB-PRATE) ** REB-REMTERM).

      * COMPUTE BALANCE OWING EXCLUDING PARTIAL MONTHS:
           COMPUTE REB-BAL ROUNDED =
              REB-LN-REGPYAMT * ((1 - REB-FACTOR) / REB-PRATE).

      * INTEREST FOR PARTIAL MONTHS (SP-YEARTYPE OK HERE):
           IF REB-ELAPSED-REM NOT = 0
              COMPUTE REB-BAL ROUNDED = REB-BAL *
                 (1 + REB-ELAPSED-REM * (REB-PRATE * 12)
                                           / ELAPSED-YRTYPE).
      * COMPUTE REBATE AMOUNT:
           COMPUTE REB-REBATE =
                       (REB-LN-REGPYAMT * REB-REMTERM) - REB-BAL.
       REBATE-ACTUARIAL-D-EXIT.
           EXIT.

      ****************************************************************
      *    DEFERMENT REBATE ROUTINE  E   (01)
      *              TENNESSEE
      *    DEFERMENT REBATE ROUTINE  O   (01)
      *              TENNESSEE                   (WITH PAY SCHEDULES)
      *    DEFERMENT REBATE ROUTINE  K   (02)
      *              INDIANA
      *    DEFERMENT REBATE ROUTINE  M   (03)
      *              CALIFORNIA
      *    DEFERMENT REBATE ROUTINE  Y   (04)
      *              S. CAROLINA                 (MERCURY)
      *    DEFERMENT REBATE ROUTINE  Z   (05)
      *              ARIZONA                     (MERCURY)
      *    DEFERMENT REBATE ROUTINE  0 5 (06)
      *              WISCONSIN                   (CITIZENS)
      ****************************************************************
       REBATE-DEFERMENT-EOKMYZ05 SECTION.
           IF REB-LN-TOTNODEF = 0
              GO TO REBATE-DEFERMENT-EOKMYZ05-EXIT.

      * CALL SUBPROGRAM TO DETERMINE REDUCTION:
           MOVE "B" TO REB-FORM-PROG-TYPE.
           IF SP-RBFRMLA(REB-SUB) = "E" OR "O"
              MOVE 01 TO REB-FORM-PROG-NO
              MOVE SP-RBFRMLA(REB-SUB) TO B01-FRMLA
              MOVE LN-PAY-SCHLD-FG TO B01-PAY-SCHLD-FG
              MOVE REB-DEF-STOP TO B01-DEF-STOP
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "K"
              MOVE 02 TO REB-FORM-PROG-NO
              MOVE REB-DEF-STOP TO B02-DEF-STOP
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "M"
              MOVE 03 TO REB-FORM-PROG-NO
              MOVE REB-DEF-STOP TO B01-DEF-STOP
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "Y"
              MOVE 04 TO REB-FORM-PROG-NO
           ELSE
           IF SP-RBFRMLA(REB-SUB) = "Z"
              MOVE 05 TO REB-FORM-PROG-NO
           ELSE
           IF SP-RBFRMLA(REB-SUB)  = "0" AND
              SP-RBFRMLA2(REB-SUB) = "5"
              MOVE 06 TO REB-FORM-PROG-NO.

           MOVE REB-PAYDATE TO B01-PAYDATE.
           PERFORM REBATE-CALL-SUBPROG.
           IF REB-COMMON-RTNCD = " " OR "E"
              MOVE REB-COMMON-REBATE TO REB-REBATE.

       REBATE-DEFERMENT-EOKMYZ05-EXIT.
           EXIT.

      *********************************************************************
      *    ACTUARIAL REBATE ROUTINE  F-06
      *    LOGIC FOR RBFRMLA = 'F' AND '0 6'
      *
      *         TRUE ACTUARIAL REBATING ROUTINE:
      *
      * THIS ROUTINES USING THE APR OR ESR RATE
      * AND TAKES INTO ACCOUNT 1ST PAYMENT EXTENSION DAYS (+ OR - NO LIMIT)
      * 1ST PAYMENT CHARGES (ODD 1ST PAYMENTS)
      *********************************************************************
       REBATE-ACTUARIAL-F-06 SECTION.
           MOVE REB-LN-ORIG-1STPYDATE  TO RBACT-ORIG-1STPAY.
           MOVE REB-LN-INTDATE      TO RBACT-INTDATE.
           IF SP-RBFRMLA(REB-SUB) = "F"
              MOVE REB-LN-APRATE    TO RBACT-RATE
           ELSE
              MOVE REB-LN-SMPRATE   TO RBACT-RATE.
           MOVE REB-LN-TOTNODEF     TO RBACT-TOTNODEF.
           MOVE REB-LN-ORGTERM      TO RBACT-ORGTERM.
           MOVE REB-LN-1STPYAMT     TO RBACT-1STPYAMT.
           MOVE REB-LN-REGPYAMT     TO RBACT-REGPYAMT.
           MOVE REB-LN-LASTPYAMT    TO RBACT-LASTPYAMT.
           MOVE LN-UNITPER-CD       TO RBACT-UNITPER-CD.
           MOVE LN-UNITPER-FREQ     TO RBACT-UNITPER-FREQ.
           MOVE REB-TOTCHG          TO RBACT-TOTCHG.
           MOVE REB-PAYDATE         TO RBACT-RBDATE.
           MOVE REB-ELAPSED-MONTHS  TO RBACT-ELAPSED-MONTHS.
           MOVE REB-ELAPSED-REM     TO RBACT-ELAPSED-REM.
           MOVE REB-ELAPSED-DAYS    TO RBACT-ELAPSED-DAYS.
           MOVE REB-SKIPDEF-FG      TO RBACT-SKIPDEF-FG.
           MOVE REB-EARN-FULL-MONTH TO RBACT-EARN-FULL-MONTH.
           MOVE REB-SUB             TO RBACT-SUB.
           MOVE REB-SUB2            TO RBACT-SUB2.
           MOVE " "                 TO RBACT-PENALTY-FG.

           PERFORM RBACT-ACTUARIAL.

           MOVE RBACT-REBATE     TO REB-REBATE.
           MOVE RBACT-PRES-VALUE TO REB-PRES-VALUE.

       REBATE-ACTUARIAL-F-EXIT.
           EXIT.

      ***************************************************
      *      O L D    R O U T I N E
      *
      *    ACTUARIAL REBATE ROUTINE  F
      *
      *         TRUE ACTUARIAL REBATING ROUTINE:
      *
      * THIS ROUTINE USINGS THE APR AND TAKES INTO ACCOUNT
      * 1ST PAYMENT EXTENSION DAYS (+ OR - NO LIMIT)
      * 1ST PAYMENT CHARGES (ODD 1ST PAYMENTS)
      * DEFERMENTS HAVE NO IMPACT ON CALCULATIONS
      ***************************************************
      *REBATE-ACTUARIAL-F SECTION.
      *    IF REB-LN-APRATE = 0
      *       GO TO REBATE-ACTUARIAL-F-EXIT.

      ********************************************************
      *    DETERMINE IF FIRST PAYMENT EXTENSIONS
      *    ARE NOT CHARGED INTEREST AND DISCLOSURE IS
      *    IS DONE FOR SALES FINANCE VIA: 'B', IF SO SET
      *    INTEREST DATE , ONE MONTH PRIOR TO ORIG 1ST PAY
      *    AND ESTABLISH REBF-ADJ FOR DAILY INTEREST
      ********************************************************
      *    MOVE 1 TO REBF-ADJ.
      *    IF SP-RBSPOPT1-FIRST-30(REB-SUB)
      *       MOVE REB-LN-ORIG-1STPYDATE TO NDTE-DATE
      *       MOVE -1 TO NDTE-HOLD
      *       PERFORM INCREMENT-MONTHS
      *       MOVE REB-LN-INTDATE TO NUM-DATE
      *       MOVE NDTE-DATE TO SYS-DATE
      *       PERFORM CMPDAT
      *       IF SYS-IS-GT
      *          MOVE NDTE-DATE TO REB-LN-INTDATE
      *       END-IF
      *       IF SP-INTMETHOD = "E"
      *          COMPUTE REBF-ADJ ROUNDED = 360 / 365.

      ***************************************************
      *    DETERMINE IF PAYDATE IS BEFORE INTDATE,
      *    IF SO FULL REBATE
      ***************************************************
      *    MOVE REB-LN-INTDATE TO NUM-DATE.
      *    MOVE REB-PAYDATE TO SYS-DATE.
      *    PERFORM CMPDAT.
      *    IF SYS-IS-LE
      *       MOVE REB-TOTCHG TO REB-REBATE
      *       GO TO REBATE-ACTUARIAL-F-EXIT.

      ***************************************************
      *    TEST FOR SWING RULE
      ***************************************************
      *    MOVE REB-PAYDATE TO REB-REFDATE.
      *    IF REB-ELAPSED-REM = 0
      *       MOVE REB-LN-INTDATE TO NDTE-DATE
      *       MOVE REB-ELAPSED-MONTHS TO NDTE-HOLD
      *       PERFORM INCREMENT-MONTHS
      *       MOVE NDTE-DATE TO REB-REFDATE.

      ***************************************************
      *    DETERMINE ELAPSED TIME REMAINING BETWEEN
      *    PAYDATE AND ORIGINAL MATURITY:
      ***************************************************
      *    MOVE REB-LN-ORIG-1STPYDATE TO NDTE-DATE.
      *    SUBTRACT 1 FROM REB-LN-ORGTERM GIVING NDTE-HOLD.
      *    IF REB-SKIPDEF-FG = " "
      *       IF SP-RBDEFER(REB-SUB) = 1
      *          ADD REB-LN-TOTNODEF TO NDTE-HOLD.
      *    PERFORM INCREMENT-MONTHS.
      *    MOVE REB-REFDATE TO NUM-DATE.
      *    MOVE NDTE-DATE TO SYS-DATE.
      *    MOVE 999 TO ELAPSED-YRTYPE.
      *    PERFORM TIMALL.
      *    IF ELAPSED-DAYS NOT > 0
      *       GO TO REBATE-ACTUARIAL-F-EXIT.

      ***************************************************
      *    SET FRACTIONAL PERIOD FROM PAYDATE TO NEXT
      *    PAYMENT DUE DATE:
      ***************************************************
      *    COMPUTE REBF = ELAPSED-REM / 30 * REBF-ADJ.

      ***************************************************
      *    SET WHOLE PERIOD(S) FROM PAYDATE TO NEXT
      *    PAYMENT DUE DATE:
      ***************************************************
      *    IF ELAPSED-MONTHS NOT < REB-LN-ORGTERM
      *       COMPUTE REBT = ELAPSED-MONTHS
      *                      - REB-LN-ORGTERM + 1
      *    ELSE
      *       IF REBF = 0
      *          MOVE 1 TO REBT
      *       ELSE
      *          MOVE 0 TO REBT.

      ***************************************************
      *    DETERMINE 1ST PAYMENT REQUIREMENTS:
      ***************************************************
      * ESTABLISH 1ST PAY AMOUNT:
      *    IF REB-LN-ORGTERM = 1
      *       IF REB-LN-1STPYAMT NOT = 0
      *          MOVE REB-LN-1STPYAMT TO REBP1
      *       ELSE
      *          MOVE REB-LN-REGPYAMT TO REBP1.

      *    IF REB-LN-ORGTERM NOT = 1
      *       IF REB-SUB2 = 2
      * ON OR AFTER 1ST PAYDATE:
      *          MOVE REB-LN-REGPYAMT TO REBP1
      *       ELSE
      * BEFORE 1ST PAYDATE:
      *          IF REB-LN-1STPYAMT NOT = 0
      *             MOVE REB-LN-1STPYAMT TO REBP1
      *          ELSE
      *             MOVE REB-LN-REGPYAMT TO REBP1.

      ***************************************************
      *    ESTABLISH ANNUITY PAYMENT AMT AND TERM:
      ***************************************************
      *    IF REB-LN-ORGTERM = 1
      *       MOVE 0 TO REBN-1 REBP
      *    ELSE
      *       IF ELAPSED-MONTHS > 0
      *          MOVE REB-LN-REGPYAMT TO REBP
      *          SUBTRACT REBT FROM ELAPSED-MONTHS
      *                                  GIVING REBN-1
      *       ELSE
      *          MOVE 0 TO REBN-1 REBP.

      *******************************************************
      *    DETERMINE IF SWING TO NEAREST DUE DATE REQUIRED
      *    (MERCURY ARIZONA ACTION 24)
      *******************************************************
      *    IF SP-RBSPOPT1(REB-SUB) = 13
      *       MOVE REB-PAYDATE TO NUM-DATE
      *       MOVE REB-LN-ORIG-1STPYDATE TO SYS-DATE
      *       PERFORM CMPDAT
      *       IF SYS-IS-GE
      *          MOVE REB-LN-INTDATE TO NUM-DATE
      *          PERFORM TIM365
      *          COMPUTE REB-FACTOR ROUNDED =
      *             (REBF + REBT) * 30 / ELAPSED-DAYS
      *          IF REB-FACTOR NOT = 0
      *             IF REB-FACTOR > 0.5
      *                MOVE 0 TO REBF
      *                MOVE 1 TO REBT
      *             ELSE
      *                MOVE 0 TO REBF
      *                          REBT
      *          ELSE
      *             NEXT SENTENCE
      *       ELSE
      *          IF REBF NOT = 0
      *             IF REBF > 0.5
      *                MOVE 0 TO REBF
      *                MOVE 1 TO REBT
      *             ELSE
      *                MOVE 0 TO REBF
      *                          REBT.

      ***************************************************
      *    COMPUTE INT. RATE PER PMT/COMPOUND INTERVAL:
      ***************************************************
      *    COMPUTE REBI ROUNDED =
      *       (REB-LN-APRATE / 100) / 12.

      ***************************************************
      *    COMPUTE ADJUSTMENT FACTOR TO 1ST DUE PAYMENT:
      ***************************************************
      * SINGLE PAY LOANS AND US RULE:
      *    IF REB-LN-ORGTERM < 2 OR SP-DISFRMLA = "C"
      *       COMPUTE REBADJ ROUNDED =
      *          1 / (1 + (REBT + REBF) * REBI)
      *    ELSE
      * ACTUARIAL:
      *       COMPUTE REBADJ ROUNDED =
      *          1 / ((1 + REBF * REBI) * (1 + REBI) ** REBT).

      ***************************************************
      *    COMPUTE PRESENT WORTH OF $1.00 PER PERIOD:
      ***************************************************
      *    COMPUTE REBPW ROUNDED =
      *       (1 - 1 / (1 + REBI) ** REBN-1) / REBI.

      ***************************************************
      *    COMPUTE PRESENT VALUE OF REMAINING PAYMENTS
      *    AT THE TIME OF REBATE:
      ***************************************************
      *    COMPUTE REBPV ROUNDED =
      *       REBADJ * (REBP1 + REBP * REBPW).
      *    MOVE REBPV TO REB-PRES-VALUE.

      ***************************************************
      * COMPUTE REBATE AMOUNT:
      ***************************************************
      *    COMPUTE REB-REBATE ROUNDED =
      *       (REBP1 + REBP * REBN-1) - REBPV.
      *REBATE-ACTUARIAL-F-EXIT.
      *    EXIT.

      *****************************************************
      *    MASS. A & H ANTICIPATED     (G)
      *
      *    THIS ROUTINE CALCULATES THE INSURANCE PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT.
      *****************************************************
       REBATE-MA-AH-ANTICIPATED SECTION.
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

           COMPUTE REB-REBATE ROUNDED = REB-LN-REGPYAMT *
                          REB-HUNDREDS * REB-REMTERM / 100.

       REBATE-MA-AH-ANTICIPATED-EXIT.
           EXIT.

      *****************************************************
      *                     (GA)
      *    SERCHG REBATE FRMLA   H -   ROGER WILLIAMS
      *                          I -   JOE DOUGLAS SR
      *
      *    THIS ROUTINE CALCULATES THE SERVICE CHARGE
      *    REBATE, INSURING INTEREST AND SERVICE CHG
      *    EARNINGS DON'T EXCEED 5% PER MONTH.
      *****************************************************
       REBATE-GA-SC SECTION.
      * COMPUTE ORIGINAL BALANCE:
           IF SP-RBFRMLA(REB-SUB) = "H"
              COMPUTE REB-REBATE = LN-LNAMT - LN-INTCHG
                        - LN-SERCHG - (LN-MAINTFEE * REB-LN-ORGTERM)
           ELSE
              COMPUTE REB-REBATE = LN-LNAMT
                         - (LN-MAINTFEE * REB-LN-ORGTERM).

      * IF SCFRMLA 54 DO NOT INCLUDE 4% CLOSING FEE WHEN CALCULATING
      *  REBATE FOR REMAINING PART OF THE SC.
           IF SP-RBFRMLA(REB-SUB) = "I" AND SP-SCFRMLA = 54
              SUBTRACT LN-POINTS FROM REB-REBATE.

      * COMPUTE MONTHLY PAYMENT:
           COMPUTE REB-WORKER = REB-LN-REGPYAMT - LN-MAINTFEE.

      * COMPUTE MAXIMUM EARNINGS (INT + SER):
           COMPUTE REB-REBATE ROUNDED = .05 *
             ( (REB-ELAPSED-MONTHS * REB-REBATE) -
                (REB-ELAPSED-MONTHS - 1) * REB-ELAPSED-MONTHS / 2
                    * REB-WORKER).

      * COMPUTE REBATE OF SERCHG TAKING MAXIMUM (SC) INCOME:
           IF LN-ANTICADJ(1) NOT = 0
              MOVE LN-ANTICADJ(1) TO REB-STATEWK.

           COMPUTE REB-REBATE = (LN-SERCHG - LN-POINTS)
                    - ( REB-REBATE - (LN-INTCHG - REB-STATEWK) ).

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.

      *  IF SERVICE CHARGE FORMULA 54 - GA 4% CLOSING FEE,
      *  ADD IN THE AMOUNT OF REBATE CALCULATED BY THE EARLY PROVISION.
           IF SP-RBFRMLA(REB-SUB) = "I" AND SP-SCFRMLA = 54
              PERFORM REBATE-EP54
      *       ADD REB-WORK2 TO REB-REBATE
              ADD REB-EP54-AMT TO REB-REBATE.

       REBATE-GA-SC-EXIT.
           EXIT.

      *****************************************************
      *    CALIFORNIA A & H ANTICIPATED     (L)
      *    MULLEN FINANCE
      *
      *****************************************************
       REBATE-CA-AH-ANTICIPATED SECTION.
           IF REB-ELAPSED-DAYS < 11
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO REBATE-CA-AH-ANTICIPATED-EXIT.
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

      * COMPUTE NEW COVERAGE ON REMAINING TERM:
           IF SP-RBSPOPT1(REB-SUB) = 11
              COMPUTE REB-BAL ROUNDED =
                 REB-TOTCHG * REB-REMTERM * REB-HUNDREDS
                       / REB-ORGTERM
              MOVE REB-REMTERM TO REB-WORKER
              MOVE REB-ORGTERM TO REB-REMTERM
              PERFORM REBATE-FIND-INS-RATE
              MOVE REB-WORKER TO REB-REMTERM
              COMPUTE REB-UPR ROUNDED =
                            REB-BAL / REB-HUNDREDS
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 10
              COMPUTE REB-UPR ROUNDED =
                           (REB-LN-INSCOVR / REB-ORGTERM)
                                   * REB-REMTERM / 100
              COMPUTE REB-UPR = REB-UPR * REB-HUNDREDS
           ELSE
              COMPUTE REB-UPR-WHOLE ROUNDED =
                           (REB-LN-INSCOVR / REB-ORGTERM)
                                   * REB-REMTERM / 100 + 0.99
              MOVE REB-UPR-WHOLE TO REB-UPR
              COMPUTE REB-UPR = REB-UPR * REB-HUNDREDS.

           COMPUTE REB-WFAC = (.0000045573 * (REB-ORGTERM ** 2))
                            + (-.001125 * REB-ORGTERM) + .099375.

      * COMPUTE REFUND CHARGE FACTOR:
           IF REB-ORGTERM < 14
              MOVE 0 TO REB-RCF.

           IF REB-ORGTERM > 13 AND < 49
              COMPUTE REB-RCF1 ROUNDED =
                 (1 - (REB-ORGTERM - REB-REMTERM - 1) /
                                              (REB-ORGTERM - 13))
              IF REB-RCF1 < 0
                 MOVE 0 TO REB-RCF
              ELSE
                 COMPUTE REB-RCF ROUNDED = REB-WFAC * REB-RCF1.

           IF REB-ORGTERM > 48
              COMPUTE REB-RCF1 ROUNDED =
                 1 - (REB-ORGTERM - REB-REMTERM - 1) / 35
              IF REB-RCF1 < 0
                 MOVE 0 TO REB-RCF
              ELSE
                 COMPUTE REB-RCF ROUNDED = REB-WFAC * REB-RCF1.


           COMPUTE REB-REBATE ROUNDED =
                                   REB-UPR * (1 - REB-RCF).

       REBATE-CA-AH-ANTICIPATED-EXIT.
           EXIT.

      ***********************************************
      *    PRO RATA, EXACT DAYS REBATE METHOD  (J)
      ***********************************************
       REBATE-PRORATA-EXACT SECTION.
           IF REB-ORGTERM NOT = 0
              COMPUTE REB-REBATE ROUNDED =
                  (REB-TOTCHG - REB-DEDCHG)
                  * ( REB-REMTERM / REB-ORGTERM
                           - REB-ELAPSED-REM
                               / (REB-ORGTERM * 30.41666667)
                    ).

      *****************************************************
      *    TEXAS A & H ANTICIPATED     (P)
      *    UVALDE FINANCE
      *
      *****************************************************
       REBATE-TX-ANTICIPATED SECTION.
           COMPUTE REB-REBATE ROUNDED =
              (REB-TOTCHG - REB-DEDCHG) / 2
               * (
                  (REB-REMTERM * (REB-REMTERM + 1))
                   / (REB-ORGTERM * (REB-ORGTERM + 1))
                      + (REB-REMTERM / REB-ORGTERM)
                 ).

      *****************************************************
      *    CALIFORNIA A & H ANTICIPATED     (R)
      *      NREW FORMULA EFFECTIVE: 05-14-94
      *
      *    THIS ROUTINE CALCULATES TO INSURANCE PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT.
      *****************************************************
       REBATE-CA-ANTICIPATED SECTION.
           MOVE 2 TO ITRM-SUB.
           PERFORM INS-TERM-CALCULATION.

           MOVE REB-REMTERM TO REB-WORKER.
           MOVE ITRM-INSTERM TO REB-REMTERM.
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.
           MOVE REB-WORKER TO REB-REMTERM.

           COMPUTE REBF ROUNDED =
               REB-TOTCHG / (ITRM-INSTERM * REB-MANYDECIMALS).

           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

           COMPUTE REB-REBATE ROUNDED =
               REBF * REB-REMTERM * REB-MANYDECIMALS.

       REBATE-CA-ANTICIPATED-EXIT.
           EXIT.

      *****************************************************
      *    CALIFORNIA 'CL' ANTICIPATED     (S)
      *    COSMO
      *
      *****************************************************
       REBATE-CA-CL-ANTICIPATED SECTION.
           MOVE LN-ORGTERM TO REBN.
           MOVE REB-ORGTERM TO REBM.
           SUBTRACT 1 FROM REBM GIVING REBM-1.
           SUBTRACT REB-REMTERM FROM REB-ORGTERM GIVING REBT.
           SUBTRACT REBT FROM REBM GIVING REBM-T.

      ***************************************************
      *    COMPUTE INT. RATE PER PMT/COMPOUND INTERVAL:
      ***************************************************
           COMPUTE REBI ROUNDED = REB-LN-APRATE / 1200.
           ADD 1 REBI GIVING REBI1.
      ***************************************************
      *    COMPUTE CA DISCOUNT RATE PER PMT/COMPOUND INTERVAL:
      ***************************************************
           COMPUTE REBJ ROUNDED = 4.2 / 1200.
           ADD 1 REBJ GIVING REBJ1.

      ***************************************************
      *    COMPUTE ANNUITY FACTOR  (M - 1)
      ***************************************************
           COMPUTE REBAN-M-1 ROUNDED =
              (1 - 1 / REBJ1 ** REBM-1) / REBJ.

      ***************************************************
      *    COMPUTE ANNUITY FACTOR  (M - 1 -T)
      ***************************************************
           COMPUTE REBAN-M-1-T ROUNDED =
              (1 - 1 / REBJ1 ** (REBM-T - 1)) / REBJ.

      * COMPUTE REBATE AMOUNT:
           COMPUTE REBWK1 ROUNDED =
               REBJ1 * (REBI1 ** REBM-T - REBJ1 ** REBM-T)
                   / (
                       REBI1 ** (REBN - REBT) * REBJ1 ** REBM-T
                                                  * (REBI - REBJ)
                     ).
           COMPUTE REBWK2 ROUNDED =
               REBJ1 * ( REBI1 ** REBM - REBJ1 ** REBM)
                   / (
                       REBI1 ** REBN * REBJ1 ** REBM
                                         * (REBI - REBJ)
                     ).
           COMPUTE REB-REBATE ROUNDED =
               REB-TOTCHG * ( 1 + REBAN-M-1-T - REBWK1)
                                     / ( 1 + REBAN-M-1 - REBWK2).

       REBATE-CA-CL-ANTICIPATED-EXIT.
           EXIT.

      ******************************************
      *    REBATE TABLE FORMULA (T)
      *              ADDONS
      ******************************************
       REBATE-TABLE-FORMULA SECTION.
           IF SP-RBSPOPT1(REB-SUB) = 0
              GO TO REBATE-TABLE-FORMULA-EXIT.
      * CALL SUBPROGRAM TO DETERMINE REDUCTION:
           MOVE "T" TO REB-FORM-PROG-TYPE.
           MOVE 01 TO REB-FORM-PROG-NO.
           MOVE SP-RBSPOPT1(REB-SUB) TO T01-TBL-NO.
           MOVE REB-ORGTERM TO T01-ORGTERM.
           MOVE REB-ELAPSED-MONTHS TO T01-ELAPSED-MONTHS.
           MOVE REB-ELAPSED-DAYS TO T01-ELAPSED-DAYS.
           MOVE 100 TO T01-REFUND-RATE.
           PERFORM REBATE-CALL-SUBPROG.
           COMPUTE REB-REBATE ROUNDED =
                  REB-TOTCHG * T01-REFUND-RATE / 100.

       REBATE-TABLE-FORMULA-EXIT.
           EXIT.

      *******************************************************************
      *                     FORMULA (0, 2)
      *    MULLEN'S CALIFORNIA CL NET PAYOFF   BALBOA LIFE & CASUALTY
      *******************************************************************
       REBATE-NET-POFF-MULL  SECTION.
           COMPUTE REBJ ROUNDED = 4.2 / 1200.
      * SET LOAN TERM
           SUBTRACT REB-ELAPSED-MONTHS FROM REB-LN-ORGTERM
                                                 GIVING REBN.
           IF REBN NOT > 1
              GO TO REBATE-NET-POFF-MULL-EXIT.

      * SET INSURANCE REMAINING TERM
           MOVE REB-REMTERM TO REBP.

           COMPUTE REB-A--P-J ROUNDED =
                  (1 - 1 / (1 + REBJ) ** REBP) / REBJ.

           COMPUTE REBI ROUNDED = LN-SMPRATE / 1200.
           COMPUTE REB-A--P-I ROUNDED =
               (1 - 1 / (1 + REBI) ** REBP) / REBI.

           COMPUTE REB-WK ROUNDED =
              ( 1 / REBI * (1 + REBJ)
                     * (REB-A--P-J
                           + (REBJ * REB-A--P-J - REBI * REB-A--P-I)
                              / (1 + REBI) ** (REBN - REBP)
                              / (REBI - REBJ)
                       )
              ).

           COMPUTE REB-REBATE ROUNDED =
                 REB-LN-REGPYAMT * SP-INSRATE(REB-SUB 1)
                                           * .001 * REB-WK.
       REBATE-NET-POFF-MULL-EXIT.
           EXIT.

      *******************************************************************
      *                     FORMULA (0, 3)
      *    MEAN RULE OF 78THS REFUND (MEAN)                  REGACC #
      *******************************************************************
       RULE-78THS-MEAN  SECTION.

           IF REB-ORGTERM = REB-REMTERM
              COMPUTE REB-REBATE = REB-TOTCHG - REB-DEDCHG
           ELSE
              COMPUTE REB-SUMREM =
                   REB-REMTERM * (REB-REMTERM + REB-LN-ORGTERM + 2)
              COMPUTE REB-SUMORG =
                   (REB-LN-ORGTERM + 1) * REB-LN-ORGTERM  * 2
              IF REB-SUMORG = 0
                 MOVE 0 TO REB-REBATE
              ELSE
                 COMPUTE REB-REBATE ROUNDED =
                     (REB-TOTCHG - REB-DEDCHG)
                              * REB-SUMREM / REB-SUMORG.
       EXIT-RULE-78THS-MEAN.
           EXIT.

      *******************************************************************
      *                     FORMULA (0, 4)
      *    SHORT RATE 'TN' PP REFUND METHOD            TN, CONSUMER #1067
      *******************************************************************
       TN-PP-SHORT-RATE  SECTION.
           IF REB-ELAPSED-DAYS <= 0
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO EXIT-TN-PP-SHORT-RATE.

           IF REB-LPTRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
              PERFORM REBATE-PRORATA-ROUTINE
              GO TO EXIT-TN-PP-SHORT-RATE.

      * COMPUTE TERM OF POLICY IN YEARS (T):
           COMPUTE REBJ ROUNDED = REB-ORGTERM / 12.

      * COMPUTE EARNED PREMIUM FACTOR (E):
           COMPUTE REB-WK ROUNDED =
              (REB-ELAPSED-DAYS / (REBJ * 365)) * 100.

      * DETERMINE INITIAL POLICY WRITING EXPENSE (I):
           IF REB-ELAPSED-DAYS <= (22 * REBJ)
              COMPUTE REB-UPR ROUNDED =
                  0.226 * (REB-ELAPSED-DAYS / REBJ) + 5
           ELSE
           IF REB-ELAPSED-DAYS <= (182 * REBJ)
              MOVE 10.1195 TO REB-UPR
           ELSE
              COMPUTE REB-UPR ROUNDED =
                   -0.054 * (REB-ELAPSED-DAYS / REBJ) + 20.1006.

      * COMPUTE REFUND = TOTCHG - (TOTCHG * REFUND PERCENT(E + I)):
           COMPUTE REB-REBATE ROUNDED =
               REB-TOTCHG - (REB-TOTCHG * (REB-WK + REB-UPR) * 0.01).

       EXIT-TN-PP-SHORT-RATE.
           EXIT.

      *****************************************************
      *                     (U)
      *    MERC. A & H ANTICIPATED
      *          AND 'CL' FOR OREGON RE: SP-RBSBOPT1 = '15'
      *
      *    THIS ROUTINE CALCULATES THE INSURANCE PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT. BASED ON
      *    TOTAL NOTE.
      *****************************************************
       REBATE-MERC-AH-ANTIC SECTION.
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.
           PERFORM LOAN-CALCULATIONS.

           COMPUTE REB-REBATE ROUNDED = (TOTAL-NOTE / LN-ORGTERM) *
                          REB-MANYDECIMALS * REB-REMTERM / 100.
      * OREGON OPTION:
           IF SP-RBSPOPT1(REB-SUB) = 15
              COMPUTE REB-WORKER ROUNDED = REB-TOTCHG * 0.9
              COMPUTE REB-WORK2 ROUNDED = REB-TOTCHG - 75.00
              IF REB-WORK2 > REB-WORKER
                 MOVE REB-WORK2 TO REB-WORKER
              END-IF
              IF REB-WORKER < REB-REBATE
                 MOVE REB-WORKER TO REB-REBATE.

       REBATE-MERC-AH-ANTIC-EXIT.
           EXIT.

      *****************************************************
      *                     (0 7)
      *    MULLEN 'CL' AND 'AH' REFUNDS PROTECTIVE LIFE
      *           TRUNCATED NET LIFE COVERAGE
      *           NON RETRO 14 DAY AH COVERAGE
      *
      *****************************************************
       REBATE-MULLEN-CL-AH-07 SECTION.
           IF REB-SUB < 5
              PERFORM REBATE-MULLEN-CL-07
           ELSE
              PERFORM REBATE-MULLEN-AH-07.

       REBATE-MULLEN-CL-AH-07-EXIT.
           EXIT.

      *****************************************************
      *                     (0 7)
      *    MULLEN 'CL' REFUND PROTECTIVE LIFE
      *           TRUNCATED NET LIFE COVERAGE
      *****************************************************
       REBATE-MULLEN-CL-07 SECTION.

      *   GET CREDIT LIFE MOB RATE:
           IF LN-INSTYPES-DL
              IF LN-INS-SINGLE
                 MOVE SP-INSRATE(1 1) TO REB-MANYDECIMALS
              ELSE
              IF LN-INS-JOINT
                 MOVE SP-INSRATE(2 1) TO REB-MANYDECIMALS
              ELSE
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-MULLEN-CL-07-EXIT.
           IF LN-INSTYPES-LL
              IF LN-INS-SINGLE
                 MOVE SP-INSRATE(3 1) TO REB-MANYDECIMALS
              ELSE
              IF LN-INS-JOINT
                 MOVE SP-INSRATE(4 1) TO REB-MANYDECIMALS
              ELSE
                 MOVE REB-TOTCHG TO REB-REBATE
                 GO TO REBATE-MULLEN-CL-07-EXIT.

           COMPUTE REBI ROUNDED = REB-LN-APRATE / 1200.
           COMPUTE REB-A--P-I ROUNDED =
              (1 - (1 / (1 + REBI) **
                 (REB-LN-ORGTERM - (REB-ORGTERM - REB-REMTERM)))
              ) / REBI.
           COMPUTE REB-A--P-J ROUNDED =
              (1 - (1 / (1 + 0.0035) ** REB-REMTERM)) / 0.0035.
           COMPUTE REB-WK ROUNDED =
              (1 - (1 / (1 + REBI) ** (REB-LN-ORGTERM - REB-ORGTERM))
              ) / REBI.
           COMPUTE REB-WK ROUNDED =
              REB-A--P-J - REB-A--P-I + REB-WK
                - 0.0035 * REB-A--P-J * REB-WK.
           COMPUTE REB-WK ROUNDED =
              REB-MANYDECIMALS * .001
                 * (1.0035 * REB-WK) / (REBI - 0.0035).

           COMPUTE REB-REBATE ROUNDED = REB-LN-REGPYAMT * REB-WK.

       REBATE-MULLEN-CL-07-EXIT.
           EXIT.

      ***********************************************************
      *                     (0 7)
      *    MULLEN 'AH' REFUND PROTECTIVE LIFE
      *           NON RETRO 14 DAY AH COVERAGE
      *
      *    REFUND = PREMIUM * REMAIN-TERM / ORIG-TERM
      *                * REMAIN-TERM-RATE / ORIG-TERM-RATE - 10
      ***********************************************************
       REBATE-MULLEN-AH-07 SECTION.

      *   GET SINGLE PREMIUM AH RATE FOR INITIAL COVERED TERM:
      *   WILL STORE IN REB-WK UNTIL CALCULATION IS DONE
      *   AND WILL USE ITRM-INSTERM IN CALCULATION
           MOVE REB-REMTERM TO REB-WORK2.
           MOVE 2 TO ITRM-SUB.
           PERFORM INS-TERM-CALCULATION.
           MOVE ITRM-INSTERM TO REB-REMTERM.
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.
           MOVE REB-MANYDECIMALS TO REB-WK.
           MOVE REB-WORK2 TO REB-REMTERM.

      *   GET SINGLE PREMIUM AH RATE FOR REMAINING TERM:
           MOVE REB-AHSUB TO REB-INSSUB.
           PERFORM REBATE-FIND-INS-RATE.

      *   DETERMINE AH REFUND:
           COMPUTE REB-REBATE ROUNDED =
              REB-TOTCHG * REB-REMTERM / ITRM-INSTERM
               * REB-MANYDECIMALS / REB-WK - 10.

       REBATE-MULLEN-AH-07-EXIT.
           EXIT.

      *****************************************************
      *                     (0 C)  NEWPORT  90%
      *                     (0 K)  MULLEN   95% AND USES INSEFF DATE
      *     COLLATERAL PROTECTION INSURANCE
      *     SHORT RATE REBATE CANCELLATION FORMULA
      *
      *****************************************************
       REBATE-SHORT-RATE-0C SECTION.

      * "K" NEEDS TO WORK FOR INSURANCES WRITTEN FOR DIFFERENT TERMS
           IF SP-RBFRMLA2(REB-SUB) = "K"
              MOVE REB-LN-INSEFF TO NDTE-DATE
              MOVE REB-ORGTERM   TO NDTE-HOLD
           ELSE
              MOVE REB-LN-LOANDATE TO NDTE-DATE
              MOVE REB-LN-ORGTERM  TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.

      *   DETERMINE DAYS IN TERM:
           MOVE NDTE-DATE       TO SYS-DATE.
           IF SP-RBFRMLA2(REB-SUB) = "K"
              MOVE REB-LN-INSEFF TO NUM-DATE
           ELSE
              MOVE REB-LN-LOANDATE TO NUM-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS    TO REBX-DAYS-IN-TERM.

           IF REB-SUB < 5
              MOVE 1 TO REB-INSSUB
           ELSE
           IF REB-SUB = 5
              MOVE 2 TO REB-INSSUB
           ELSE
           IF REB-SUB = 6 OR 11
              MOVE 3 TO REB-INSSUB
           ELSE
           IF REB-SUB > 10 AND < 17
              SUBTRACT 6 FROM REB-SUB GIVING REB-INSSUB.

      *   DETERMINE DAYS IN FORCE:
           IF SP-RBFRMLA2(REB-SUB) = "K"
              MOVE REB-LN-INSEFF TO NUM-DATE
           ELSE
              MOVE REB-LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS    TO REBX-DAYS-IN-FORCE.

      * POLICY FEE IS NOT INCLUDED IN LN-INSPREM OR REB-TOTCHG
      * NET CONTRACT COST:
           MOVE REB-TOTCHG TO REBX-NET-CONTRACT-COST.

      * DETERMINE DAILY COST:
           IF SP-RBSPOPT1(REB-SUB) = 23
              COMPUTE REBX-DAILY-COST-NO-ROUND ROUNDED =
                 REBX-NET-CONTRACT-COST / REBX-DAYS-IN-TERM
           ELSE
              COMPUTE REBX-DAILY-COST ROUNDED =
                  REBX-NET-CONTRACT-COST / REBX-DAYS-IN-TERM.

      * DETERMINE EARNED COST:

           IF SP-RBSPOPT1(REB-SUB) = 23
              COMPUTE REBX-EARNED-COST-NO-ROUND ROUNDED =
               REBX-DAYS-IN-FORCE * REBX-DAILY-COST-NO-ROUND
           ELSE
              COMPUTE REBX-EARNED-COST ROUNDED =
               REBX-DAYS-IN-FORCE * REBX-DAILY-COST.

      * DETERMINE PRO-RATA REFUND:
           IF SP-RBSPOPT1(REB-SUB) = 23
              COMPUTE REBX-PRO-RATA-REFUND-NO-ROUND ROUNDED =
                REBX-NET-CONTRACT-COST - REBX-EARNED-COST-NO-ROUND
           ELSE
              COMPUTE REBX-PRO-RATA-REFUND =
                REBX-NET-CONTRACT-COST - REBX-EARNED-COST.

      * DETERMINE SHORT RATE REFUND 90% OF PRORATA:
           IF SP-RBFRMLA2(REB-SUB) = "K"
              IF SP-RBSPOPT1(REB-SUB) = 23
                 COMPUTE REBX-SHORT-RATE-REFUND-NO-ROUND ROUNDED =
                  REBX-PRO-RATA-REFUND-NO-ROUND * 0.95
              ELSE
                 COMPUTE REBX-SHORT-RATE-REFUND ROUNDED =
                  REBX-PRO-RATA-REFUND * 0.95
           ELSE
              IF SP-RBSPOPT1(REB-SUB) = 23
                 COMPUTE REBX-SHORT-RATE-REFUND-NO-ROUND ROUNDED =
                  REBX-PRO-RATA-REFUND-NO-ROUND * 0.90
              ELSE
                 COMPUTE REBX-SHORT-RATE-REFUND ROUNDED =
                  REBX-PRO-RATA-REFUND * 0.90.

           IF SP-RBSPOPT1(REB-SUB) = 23
              MOVE REBX-SHORT-RATE-REFUND-NO-ROUND TO REB-REBATE
           ELSE
              MOVE REBX-SHORT-RATE-REFUND TO REB-REBATE.

       REBATE-SHORT-RATE-0C-EXIT.
           EXIT.

      ****************************************************************
      *                     (0 D)
      *    REGIONAL ACCEPTANCE
      *    RULE 78THS USING DAYS IN TERM AND ELAPSED DAYS
      *    INSTEAD OF UNIT PERIODS IN TERM AND ELAPSED UNIT PERIODS
      *
      ****************************************************************
       REBATE-78-DAYS-0D SECTION.

      *   WHEN SPR FIELD SP-RBDAYS(REB-SUB,1) IS CODED FOR SWING
      *   AND ELAPSED DAYS PRIOR TO 1ST PAYMENT
      *   IS LESS THAN OR EQUAL TO SP-RBDAYS(REB-SUB,1) (NO SWING)
      *   FORCE A FLAT CANCEL, FULL REFUND
      *   NOTE: IF A SWING TAKES PLACE REB-ELAPSED-MONTHS WILL = 1
      *
      *          ---- TO  N O T  CAUSE A SWING LIKE IN THE FOLLOWING EX:
      *                   SPR 1STPAY YEAR TYPE SHOULD BE '360' NOT '365' ETC
      *
      *                                         360      365
      *                                 ------  ---      ---
      *         EFFECTIVE     08/29/04  DAYS     29       30
      *         REBATE DATE   09/28/04  MONTHS    0        1
      *                                 REM      29        0
      *                                        NO SWING  WILL SWING

           IF REB-SWING = "Y" AND REB-ELAPSED-MONTHS = 0
              MOVE REB-TOTCHG TO REB-REBATE
              GO TO REBATE-78-DAYS-0D-EXIT
           ELSE
      * DETERMINE DAYS IN IN FORCE
              MOVE REB-PAYDATE   TO NUM-DATE
              MOVE REB-LN-INSEXP TO SYS-DATE
              PERFORM TIM365
              MOVE ELAPSED-DAYS TO REBX-DAYS-IN-FORCE
              IF REBX-DAYS-IN-FORCE < 0
                 MOVE 0 TO REB-REBATE
                 GO TO REBATE-78-DAYS-0D-EXIT
              END-IF
      * DETERMINE DAYS IN INSURANCE TERM
              MOVE REB-LN-INSEFF TO NUM-DATE
              MOVE REB-LN-INSEXP TO SYS-DATE
              PERFORM TIM365
              MOVE ELAPSED-DAYS TO REBX-DAYS-IN-TERM.

      * DETERMINE RULE 78 REBATE:
           COMPUTE REB-REBATE ROUNDED = REB-TOTCHG
              * (REBX-DAYS-IN-FORCE * (REBX-DAYS-IN-FORCE + 1))
              / (REBX-DAYS-IN-TERM * (REBX-DAYS-IN-TERM + 1)).

       REBATE-78-DAYS-0D-EXIT.
           EXIT.

      ****************************************************************
      *                     (0 E)
      *    WORLD
      *    ALABAMA ACTUARIAL REFUND FORMULA
      *    SINGLE PREMIUM RATE MEMORANDUM
      *
      ****************************************************************
       REBATE-ACTUARIAL-0E SECTION.

           MOVE LN-ORGTERM   TO REBN.
           MOVE REB-ORGTERM  TO REBM.
           MOVE REB-REMTERM  TO REBR.
           SUBTRACT REBM FROM REBN GIVING REBN-M.

      * COMPUTE MONTHLY RATE OF INTEREST:
           COMPUTE REBI ROUNDED = REB-LN-APRATE / 1200.

      * COMPUTE ANNUITY FACTORS:
           COMPUTE REBAN ROUNDED =
               (1 - 1 / (1 + REBI) ** REBN) / REBI.

           COMPUTE REBAN-M ROUNDED =
               (1 - 1 / (1 + REBI) ** (REBN - REBM)) / REBI.

           COMPUTE REBAN-MPLUSR ROUNDED =
               (1 - 1 / (1 + REBI) ** (REBN - REBM + REBR)) / REBI.

      * COMPUTE REBATE:
           COMPUTE REB-REBATE ROUNDED =
               REB-TOTCHG *
                 ( ((REBR - REBAN-MPLUSR + REBAN-M) / REBI) + REBR )
                 /
                 ( ((REBM - REBAN + REBAN-M) / REBI ) + REBM ).

       REBATE-ACTUARIAL-0E-EXIT.
           EXIT.

      ****************************************************************
      *                     (0 F)
      *    WORLD
      *    COLORADO TRUE DAILY PRORATA REFUND FORMULA
      *
      ****************************************************************
       REBATE-TRUE-PRORATA-0F SECTION.
           PERFORM MATURITY-DATE-CALCULATION.



      * DETERMINE DAYS IN LOAN TERM:
           IF REB-SUB = 7 OR 8 OR 9 OR 10
              MOVE REB-LN-LOANDATE TO NUM-DATE
              MOVE MDTE-DATE       TO SYS-DATE
           ELSE
      * INSURANCES
              MOVE REB-LN-INSEFF TO NUM-DATE
              MOVE REB-LN-INSEXP TO SYS-DATE MDTE-DATE.

           IF SP-RBSPOPT1(REB-SUB) = 24
               PERFORM TIM360
           ELSE
               PERFORM TIM365.
           MOVE ELAPSED-DAYS    TO REB-WORKER.

      * DETERMINE DAYS REMAINING FROM PAYDATE TO MATURITY:
           MOVE REB-PAYDATE     TO NUM-DATE.
           MOVE MDTE-DATE       TO SYS-DATE.

           IF SP-RBSPOPT1(REB-SUB) = 24
              PERFORM TIM360
           ELSE
              PERFORM TIM365.

      * COMPUTE REBATE:
           COMPUTE REB-REBATE ROUNDED =
               REB-TOTCHG * ELAPSED-DAYS / REB-WORKER.

       REBATE-TRUE-PRORATA-0F-EXIT.
           EXIT.

      ****************************************************************
      *                     (0 G)
      *    WORLD
      *    MEXICO MAINTENANCE FEE REFUND
      *
      *    THE REFUND IS IN THE SAME PROPORTION OF THE INTEREST & SERVICE
      *    CHARGE REFUNDS
      *
      ****************************************************************
       REBATE-SAME-PROP-INT-SC-0G SECTION.

      * COMPUTE REBATE:
           COMPUTE REB-REBATE ROUNDED =
               (REB-LN-INT-REBATE + REB-LN-SC-REBATE)
               * LN-ANTICERN(4) / (LN-INTCHG + LN-SERCHG).

       RB-SAME-PROP-INT-SC-0G-EXIT.
           EXIT.

      *****************************************************
      *    MEXICO CL ANTICIPATED     (0, J)
      *
      *    THIS ROUTINE CALCULATES THE INSURANCE PREMIUM
      *    TO COVER THE REMAINING TERM ON THE COVERAGE
      *    REMAINING, AND REBATES THAT AMOUNT.
      *****************************************************
       REBATE-MX-CL-ANTICIPATED SECTION.
           IF LN-INSTYPES-DL
              IF LN-INS-SINGLE
                 COMPUTE REB-REBATE ROUNDED =
                         ((SP-INSRATE(1 1) / 12 * REB-REMTERM) / 100) *
                                   REB-REMTERM * REB-LN-REGPYAMT
              ELSE
                 COMPUTE REB-REBATE ROUNDED =
                         ((SP-INSRATE(2 1) / 12 * REB-REMTERM) / 100) *
                                   REB-REMTERM * REB-LN-REGPYAMT.

       REBATE-MX-CL-ANTICIPATED-EXIT.
           EXIT.
      *****************************************************
      *    MERC. DAILY PRORATA         (V) & (W)
      *
      *****************************************************
       REBATE-MERC-DAILY-PRORATA SECTION.

           IF SP-RBFRMLA(REB-SUB) = "W"
              MOVE REB-LN-ORIG-1STPYDATE TO NDTE-DATE
              MOVE -1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO SYS-DATE
           ELSE
              MOVE REB-LN-LOANDATE TO NDTE-DATE.
           MOVE REB-LN-ORGTERM TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO NUM-DATE.
           IF SP-RBFRMLA(REB-SUB) = "W"
              MOVE SYS-DATE TO NDTE-DATE
           ELSE
              MOVE REB-LN-LOANDATE TO NDTE-DATE.
           COMPUTE NDTE-HOLD = REB-LN-ORGTERM + REB-LN-TOTNODEF.
           PERFORM INCREMENT-MONTHS.
           MOVE REB-PAYDATE TO SYS-DATE.
           MOVE 360 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS <= 0
              COMPUTE REB-REMTERM = (ELAPSED-DAYS * -1) *
                                     REB-LN-TOTNODEF
              COMPUTE ELAPSED-DAYS = ((REB-LN-TOTNODEF *
                                     (REB-LN-TOTNODEF + 1)) / 2) * 30
              COMPUTE REB-REBATE =
                   (REB-REMTERM + ELAPSED-DAYS)
                         * REB-LN-APRATE * REB-LN-REGPYAMT / 36000
           ELSE
              MOVE NDTE-DATE TO NUM-DATE
              MOVE REB-PAYDATE TO SYS-DATE
              MOVE 360 TO ELAPSED-YRTYPE
              PERFORM TIMALL
              IF ELAPSED-DAYS <= 0
                 COMPUTE ELAPSED-DAYS = (ELAPSED-DAYS * -1)
                 MOVE 0 TO REB-WORKER
                 PERFORM UNTIL ELAPSED-DAYS < 0
                    ADD ELAPSED-DAYS TO REB-WORKER
                    SUBTRACT 30 FROM ELAPSED-DAYS
                 END-PERFORM
      *JTG020397 DIVIDE ELAPSED-DAYS BY 30 GIVING REB-REMTERM
      *CORRECTED COMPUTE ELAPSED-DAYS = ELAPSED-DAYS *
      *SLC ERROR      (REB-REMTERM + 1)
                 COMPUTE REB-REBATE =
                     REB-WORKER * REB-LN-APRATE * REB-LN-REGPYAMT
                                    / 36000.

           IF REB-REBATE > REB-TOTCHG
              MOVE REB-TOTCHG TO REB-REBATE.

       REBATE-MERC-DAILY-PRORATA-EXIT.
           EXIT.


      ************************************************
      *               (RBFRMLA2 = 1)
      *    PRO RATA, TO THE DAY REBATE METHOD
      *    MECURY ACTION: FORMULA 9
      ************************************************
       REBATE-MERC-TO-THE-DAY SECTION.
           IF REB-ORGTERM NOT = 0
              MOVE REB-LN-LOANDATE TO NUM-DATE
              MOVE LN-INSEXP-DATE(3) TO SYS-DATE
              PERFORM TIM365
              COMPUTE REB-REBATE ROUNDED =
                  (REB-TOTCHG - REB-DEDCHG)
                        - (REB-TOTCHG - REB-DEDCHG)
                                * REB-ELAPSED-DAYS / ELAPSED-DAYS.

      *********************************
      *    REBATE REF DATE ROUTINE
      *********************************
       REBATE-REFDATE SECTION.
      * = 0 SIGNALS ERROR FOR SP-RBDATE / DATE CALC:
           MOVE 0 TO REB-REFDATE.
           MOVE SP-RBDTE(REB-SUB REB-SUB2) TO REB-HOLD-RBDTE.

      * WHEN NON MONTHLY PAPER AMD SP-RBUNITPER-CD = 'B'
      
           IF SP-RBUNITPER-CD(REB-SUB) = "B" AND
              (NOT (LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1 ))
              MOVE LN-UNITPER-CD       TO DATER-UNITPER-CD
              MOVE LN-UNITPER-FREQ     TO DATER-UNITPER-FREQ
              MOVE REB-LN-ORIG-1STPYDATE  TO NDTE-DATE
              MOVE -1                  TO NDTE-HOLD
              PERFORM INCREMENT-UNITPER
              MOVE NDTE-DATE           TO REB-REFDATE
              GO TO REBATE-REFDATE-EXIT.

           IF SP-RBEARLY(REB-SUB) = 1
              PERFORM REBATE-EP1.

           IF REB-HOLD-RBDTE = "A"
              MOVE REB-LN-LOANDATE TO REB-REFDATE.
           IF REB-HOLD-RBDTE = "B"
              MOVE REB-LN-INTDATE  TO REB-REFDATE.

      * LOGIC FOR EARNINGS CALCULATIONS:
      * WHEN 'X' USE REB-LN-INTDATE UNLESS SALES FIN. USE PURCHDATE
           IF REB-HOLD-RBDTE = "X"
              IF REB-LN-SALEFIN = "Y"
                 MOVE REB-LN-PURDATE TO REB-REFDATE
              ELSE
                 MOVE REB-LN-INTDATE TO REB-REFDATE.

           IF NOT (REB-HOLD-RBDTE = "C" OR "D")
              GO TO REBATE-REFDATE-EXIT.

      * ONE PMT INTERVAL PRIOR TO (TRIGGER) FIRST PMT DATE:
           MOVE REB-TRIGGER-DATE TO NDTE-DATE.
           MULTIPLY -1 BY 1 GIVING NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO REB-REFDATE.
       REBATE-REFDATE-EXIT.
           EXIT.

      ***************************
      * 78'S FOR ORIGINAL TERM:
      ***************************
       REBATE-78-SUMORG SECTION.
           IF (SP-RBFRMLA(REB-SUB) = "N")
               COMPUTE REB-SUMORG =
                    (REB-HOLD-ORGTERM * (REB-HOLD-ORGTERM + 1)) / 2
               COMPUTE REB-SUMORG = REB-SUMORG +
                    (REB-ORGTERM - REB-HOLD-ORGTERM) * REB-HOLD-ORGTERM
           ELSE
               COMPUTE REB-SUMORG =
                      (REB-ORGTERM * (REB-ORGTERM + 1)) / 2.

      ***************************
      * 78'S ROUTINE
      ***************************
       REBATE-78-ROUTINE SECTION.
           IF REB-ORGTERM = REB-REMTERM
              COMPUTE REB-REBATE = REB-TOTCHG - REB-DEDCHG
           ELSE
              PERFORM REBATE-78-SUMORG
              IF REB-SUMORG NOT = 0
                 COMPUTE REB-SUMORG ROUNDED =
                              (REB-TOTCHG - REB-DEDCHG) / REB-SUMORG
                 PERFORM REBATE-78-REBATE
              ELSE
                 PERFORM REBATE-78-REBATE.

      ******************************************
      * UNIT CHARGE * 78'S FOR REMAINING TERM
      ******************************************
       REBATE-78-REBATE SECTION.
           IF SP-RBFRMLA(REB-SUB) = "N"
                         AND (REB-REMTERM > REB-HOLD-ORGTERM)
              COMPUTE REB-SUMREM =
                  (REB-HOLD-ORGTERM * (REB-HOLD-ORGTERM + 1)) / 2
              COMPUTE REB-SUMREM = REB-SUMREM +
                  (REB-REMTERM - REB-HOLD-ORGTERM) * REB-HOLD-ORGTERM
           ELSE
              COMPUTE REB-SUMREM =
                  (REB-REMTERM * (REB-REMTERM + 1)) / 2.
           COMPUTE REB-REBATE ROUNDED = REB-SUMORG * REB-SUMREM.

      *****************************************************************
      *                  ESTABLISH REB-SUB2
      * DETERMINE WHICH ADD DAYS, START DATE, YRTYPE APPLIES:
      *
      * NORMAL:
      *   WHEN REBATE IS DONE BEFORE TRIGGER DATE, REBSUB2 = (1)
      *   AND ON OR AFTER TRIGGER DATE, REBSUB2 = (2):
      * MISSISSIPPI OPT1 (4):
      * INDIANA:
      *   WHEN REBATE IS DONE ON OR BEFORE TRIGGER DATE, REBSUB2  = (1)
      *   AND AFTER TRIGGER DATE, REBSUB2 = (2):
      *
      *   NOTE:
      *        IF SP-RBEARLY() NOT = 8
      *           TRIGGER-DATE = 1STPAYDATE
      *        ELSE
      *           TRIGGER-DATE = 1 MONTH AFTER INTDATE
      *****************************************************************
       SELECT-SP-ELAPSED-TIMTBL SECTION.
           PERFORM REBATE-TRIGGER-DATE.
           MOVE REB-PAYDATE TO NUM-DATE.
           MOVE REB-TRIGGER-DATE TO SYS-DATE.
           MOVE 365 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.

           IF (NOT (SP-RBSPOPT1(REB-SUB) = 4)) AND
                                  (SP-RBEARLY(REB-SUB) NOT = 8)
              MOVE 1 TO REB-SUB2
           ELSE
              MOVE 0 TO REB-SUB2.

           IF JULIAN-DATE = 0
              MOVE 0 TO REB-SUB
           ELSE
              IF ELAPSED-DAYS NOT < REB-SUB2
                 MOVE 1 TO REB-SUB2
              ELSE
                 MOVE 2 TO REB-SUB2.

      * EXAMPLE FOR MS OPTION1 = 3
      * ON FIRST PAYDATE, WILL MOVE 1 TO REB-SUB2, THEN NEXT IF, ELAPSED
      * IS 0, SO IS 0 >= 1 ? NO, SO MOVE 2 TO REB-SUB2 WHICH IS NOT
      * CONSIDERED PODATE-B4-1STPYDATE AND THAT IS WHAT THEY WANT!

      * AFTER FIRST PAYDATE, WILL MOVE 1 TO REB-SUB2, THEN NEXT IF, ELAPSED
      * IS -1, SO IS -1 >= 1 ? NO, SO MOVE 2 TO REB-SUB2 WHICH IS NOT
      * CONSIDERED PODATE-B4-1STPYDATE AND THAT IS WHAT THEY WANT!

      * PRIOR FIRST PAYDATE, WILL MOVE 1 TO REB-SUB2, THEN NEXT IF, ELAPSED
      * IS 3, SO IS 3 >= 1 ? YES, SO MOVE 1 TO REB-SUB2 WHICH IS
      * CONSIDERED PODATE-B4-1STPYDATE AND THAT IS WHAT THEY WANT!

      ***************************************************
      *    DETERMINE TRIGGER DATE FOR CALC OF REB-SUB2
      *      AND IF SP-RBEARLY(8), CHANGE REB-ORGTERM
      ***************************************************
       REBATE-TRIGGER-DATE SECTION.
           MOVE REB-LN-ORIG-1STPYDATE TO REB-TRIGGER-DATE.

           IF SP-RBEARLY(REB-SUB) = 8
              MOVE REB-ORGTERM TO REB-HOLD-ORGTERM
              MOVE REB-LN-INTDATE TO NDTE-DATE
              MOVE 1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO REB-TRIGGER-DATE
              IF REB-SUB = 7 OR 8 OR 9
                 PERFORM REBATE-GET-EXTDAYS
                 IF REB-TOTAL-EXTDAYS NOT < 30
                    COMPUTE REB-ORGTERM = REB-ORGTERM +
                                          (REB-TOTAL-EXTDAYS / 30).

      ****************************************************
      * FIND ELAPSED DD MM & REM ON REFERENCE THRU PAYOFF
      ****************************************************
       CALC-ELAPSED-REF-THRU-PODATE SECTION.
           MOVE REB-PAYDATE TO SYS-DATE.
      * TEST FOR MISSISSIPPI REBATE 20 OR 90 DAY OPTION,
      * IF SO ADD 20 OR 90 DAYS TO PAYDATE:
           IF SP-RBSPOPT1(REB-SUB) = 3
              MOVE 20 TO REB-ELAPSED-REM
           ELSE
              IF SP-RBSPOPT1(REB-SUB) = 4
                 MOVE 90 TO REB-ELAPSED-REM.
           IF SP-RBSPOPT1(REB-SUB) = 3 OR 4
              MOVE REB-PAYDATE TO NUM-DATE
              PERFORM JUL
              ADD REB-ELAPSED-REM TO JULIAN-DATE
              PERFORM CJUL
              MOVE NUM-DATE TO SYS-DATE.
           MOVE REB-REFDATE TO NUM-DATE.

      * WHEN SP-RBUNITPER-CD(REB-SUB) = "B"
      *    IF OTHER THAN MONTHLY PAY CODE OR PAYFREQ
      *       COMPUTATION OF ELAPSED-MONTHS, ETC WILL BE DONE ON
      *       UNIT PERIOD BASES

           IF SP-RBUNITPER-CD(REB-SUB) = "B" AND
              (NOT (LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1 ))
              MOVE LN-UNITPER-CD       TO DATER-UNITPER-CD
              MOVE LN-UNITPER-FREQ     TO DATER-UNITPER-FREQ
              PERFORM TIMUPER
              MOVE ELAPSED-UNITPER     TO REB-ELAPSED-MONTHS
              MOVE ELAPSED-UNITPER-REM TO REB-ELAPSED-REM
              MOVE ELAPSED-DAYS        TO REB-ELAPSED-DAYS
           ELSE
              MOVE SP-RBYRTYPE(REB-SUB, REB-SUB2) TO ELAPSED-YRTYPE
              PERFORM TIMALL
              MOVE ELAPSED-MONTHS TO REB-ELAPSED-MONTHS
              MOVE ELAPSED-REM    TO REB-ELAPSED-REM
              MOVE ELAPSED-DAYS   TO REB-ELAPSED-DAYS.

      ********************************************
      *    APPLICATION OF 'SWING RULE':
      *    ESTABLISH REM-TERM
      *    ADJUST TERM BY DEFERMENTS
      ********************************************
       REBATE-TEST-SWING SECTION.
           MOVE " " TO REB-SWING.
           IF (NOT
                  ( SP-RBSPOPT1(REB-SUB) = 7
                          AND ( (LN-REPOCD = "X" OR "S")
                                   OR (REB-LPTRCD = "PB" OR "RN"
                                       OR "RB" OR "RO")
                              )
                  ) OR
                  ( SP-RBSPOPT1(REB-SUB) = 18
                          AND ( (LN-REPOCD = "X" OR "S") OR
                                 (REB-LPTRCD = "PB" OR "RN" OR
                                               "RB" OR "RO") OR
                                  (REB-ELAPSED-DAYS NOT > 60)
                              )
                  )
              )
              IF (
                   (SP-RBDAYS(REB-SUB REB-SUB2) NOT = 0) AND
                                     (SP-RBEARLY(REB-SUB) NOT = 4)
                 )
               OR
                 (
                   (SP-RBEARLY(REB-SUB) = 4) AND
                         (NOT (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                                OR "RB" OR "RO"))
                 )
               OR
                 (
                   (REB-EARN-FULL-MONTH = "B" OR "C")
                 )
                 MOVE "Y" TO REB-SWING
                 IF (REB-ELAPSED-REM NOT < SP-RBDAYS(REB-SUB REB-SUB2))
                           OR (REB-EARN-FULL-MONTH = "B" OR "C")
                    ADD 1 TO REB-ELAPSED-MONTHS
                    IF SP-RBEARLY(REB-SUB) NOT = 5
                       MOVE 0 TO REB-ELAPSED-REM
                    END-IF
                 ELSE
                    MOVE 0 TO REB-ELAPSED-REM.

      * SETUP REMAINING TERM:
           COMPUTE REB-REMTERM = REB-ORGTERM - REB-ELAPSED-MONTHS.

      * ADJUST TERMS BASED ON SP-RBDEFER CODE:
      * DEFERMENTS NOT CONSIDERED FOR INSURANCE:
           IF REB-SUB = REB-INTSUB
            OR (REB-SUB = REB-DEFSUB AND SP-RBFRMLA(REB-SUB) =
                1 OR "V" OR "W")
              IF SP-RBFRMLA(REB-SUB) NOT = "2"
                                  AND NOT = "C"
                                   AND NOT = "D"
                                    AND NOT = "F"
                                     AND NOT = "H"
                                      AND NOT = "I"
                                       AND NOT = "J"
                 IF SP-RBDEFER(REB-SUB) NOT = 2
                    ADD REB-LN-TOTNODEF TO REB-REMTERM
                    IF SP-RBDEFER(REB-SUB) = 0
                       ADD REB-LN-TOTNODEF TO REB-ORGTERM.

      *************************************************
      * REBATE AFTER REDUCTION AND %AGE COULD BE < 0
      *************************************************
       REBATE-ADJUST-REB-REBATE SECTION.
      * TEST FOR EARLY PROV 7, PRORATA EXTENSION CHARGE:
           IF SP-RBEARLY(REB-SUB) = 7
              IF LN-EXTCHG NOT = 0
                 IF PODATE-B4-1STPYDATE
                    PERFORM REBATE-EP7
      * ADD BACK EXTCHG FOR MIN REB TEST:
                    ADD LN-EXTCHG TO REB-TOTCHG.

      * TEST FOR MISSISSIPPI 20 DAY RULE;
      *  IF PREPAYMENT OCCURS BEFORE THE FIRST PAYMENT DATE, FULLY
      *  REBATE THE EXTENSION CHARGE, USED TO INCLUDE IT IN CALC
           IF SP-RBSPOPT1(REB-SUB) = 3
              IF PODATE-B4-1STPYDATE
                 ADD LN-EXTCHG TO REB-REBATE.

      * REDUCE COMPUTED REBATE BY REDUCTION AMOUNT:
           IF SP-RBREDUC(REB-SUB) > 9999
              PERFORM REBATE-SPEC-RBREDUC
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 5
              PERFORM REBATE-RBREDUC-NJ
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 16
              PERFORM REBATE-RBREDUC-OH
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 25
              PERFORM REBATE-RBREDUC-OH-25
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 21
              PERFORM REBATE-RBREDUC-NJ-21
           ELSE
           IF SP-RBSPOPT1(REB-SUB) = 28
              PERFORM REBATE-RBREDUC-VYBA-28
           ELSE
              COMPUTE REB-REBATE ROUNDED =
                          REB-REBATE - SP-RBREDUC(REB-SUB).

      * TAKE A PERCENT OF COMPUTED REBATE:
           COMPUTE REB-REBATE ROUNDED =
                         REB-REBATE * (SP-RBPCT(REB-SUB) / 100).

      * WE MUST EARN AT LEAST RBMINRET
           MOVE SP-RBMINRET(REB-SUB) TO REB-WORKER.
      * TEST FOR IOWA MINIMUM RETENTION:
           IF REB-WORKER = 9999.01
              IF REB-LPTRCD = "PB" OR "RN" OR "SC"
                                OR "RB" OR "RO"
                 MOVE 0 TO REB-WORKER
              ELSE
                 ADD LN-SERCHG TO REB-TOTCHG
                 PERFORM LOAN-CALCULATIONS
                 IF DISCLOSED-FINAMT > 75.00
                    MOVE 7.50 TO REB-WORKER
                 ELSE
                    MOVE 5.00 TO REB-WORKER
                 END-IF
              END-IF
           ELSE
      * TEST FOR SC, WORLD MINIMUM RETENTION:
           IF REB-WORKER = 9999.02
              IF REB-LPTRCD = "PB" OR "RN" OR "SC"
                                 OR "RB" OR "RO"
                 MOVE 0 TO REB-WORKER
              ELSE
                 MOVE 15.00 TO REB-WORKER.

           IF REB-ADDON-FG = "Y" AND REB-SUB = 7
              GO TO REBATE-ADJUST-REB-REBATE-FLOOR.

           COMPUTE REB-WORK2 = REB-TOTCHG - REB-REBATE.
           IF REB-ADDON-FG NOT = "Y" AND REB-SUB = 7
              IF LN-ADDON-FG = "Y"
                 IF LN-CONVERCD = "X"
                    COMPUTE REB-WORK2 = LN-ANTICERN(1) - REB-REBATE.

           IF REB-WORK2 < REB-WORKER
              COMPUTE REB-REBATE =
                        REB-WORK2 + REB-REBATE - REB-WORKER.

       REBATE-ADJUST-REB-REBATE-FLOOR.
      * NEXT STMT NECESSARY, AS < SP-RBMIN CHECK IS CONDITIONAL
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.

      * NO NEED TO REBATE WHEN BELOW THIS FLOOR
           IF SP-RBSPOPT1(REB-SUB) = 2 AND
              (REB-LPTRCD = "PB" OR "RN" OR "SC"
                              OR "RB" OR "RO")
              NEXT SENTENCE
           ELSE
              IF SP-RBMIN(REB-SUB) NOT = 999.01
                 IF SP-RBMIN(REB-SUB) NOT = 999.02
                    IF REB-REBATE < SP-RBMIN(REB-SUB)
                       MOVE 0 TO REB-REBATE
                    ELSE
                       NEXT SENTENCE
                 ELSE
      * 999.02 MERCURY "OK" PERSONAL PROPERTY
      * IF RENEWED, MINIMUM IS $1.00, IF PAID OUT, MINIMUM IS $5.00
                    IF (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                        OR "RB" OR "RO")
                       IF REB-REBATE < 1.00
                          MOVE 0 TO REB-REBATE
                       ELSE
                          NEXT SENTENCE
                    ELSE
                       IF REB-REBATE < 5.00
                          MOVE 0 TO REB-REBATE.

      * SPECIAL OPTION 2 = 11:
      * THE FINAL REFUND IS ROUNDED UP OR DOWN TO WHOLE DOLLARS
           IF SP-RBSPOPT2(REB-SUB) = 11
              IF REB-REBATE-CENTS < 51
                 MOVE 0 TO REB-REBATE-CENTS
              ELSE
                 COMPUTE REB-UPR-WHOLE ROUNDED = REB-REBATE + 0.50
                 MOVE REB-UPR-WHOLE TO REB-REBATE.

      **************************************
      *   SPECIAL REBATE REDUCTION ROUTINES
      **************************************
       REBATE-SPEC-RBREDUC SECTION.
           IF SP-RBREDUC(REB-SUB) NOT = 9999.01
              GO TO REBATE-SPEC-RBREDUC-NV.

           MOVE 0 TO A01-MS-PENALTY REB-MS-PENALTY.
           MOVE "A" TO REB-FORM-PROG-TYPE.
      * MISSISSIPPI ROUTINE:

      * TEST FOR NORMAL PAYOFF:
      *    IF REB-LPTRCD NOT = "PO"
           IF REB-LPTRCD = "PB" OR "RN" OR "SC"
                              OR "RB" OR "RO"
              GO TO REBATE-SPEC-RBREDUC-EXIT.

      * TEST FOR PAYOFF WITHIN 1ST 5 YEARS:
           MOVE 360 TO ELAPSED-YRTYPE.
           MOVE REB-LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
           IF ELAPSED-MONTHS < 0 OR > 60
              GO TO REBATE-SPEC-RBREDUC-EXIT.

      * CALL SUBPROGRAM TO DETERMINE REDUCTION:
           MOVE 01 TO REB-FORM-PROG-NO.
      * 9/13/01 MS STATE BANKING DEPT SAID WHENEVER THERE ARE REMAINING
      *         DAYS, YOU SHOULD BUMP INTO THE NEXT MONTH, WHICH COULD
      *         CAUSE A DIFFERENT PERCENT !!
      * EXAMPLE:  IF 36 MONTHS AND 5 DAYS, THIS USED TO CHARGE 3%, BUT
      *           IT SHOULD CHARGE 2% BECAUSE YOU ARE INTO THE 4TH YR.
           IF ELAPSED-REM > 0
              ADD 1 TO ELAPSED-MONTHS.
           MOVE ELAPSED-MONTHS TO A01-ELAPSED-MO.
           MOVE REB-PAYDATE TO A01-PAYDATE.
           MOVE REB-REBATE TO REB-COMMON-REBATE.
           PERFORM REBATE-CALL-SUBPROG.
           IF REB-SUB = 0 OR REB-COMMON-RTNCD NOT = " "
              GO TO REBATE-SPEC-RBREDUC-EXIT.
           MOVE REB-COMMON-REBATE TO REB-REBATE.
           MOVE A01-MS-PENALTY TO REB-MS-PENALTY.

           GO TO REBATE-SPEC-RBREDUC-EXIT.

      * ------------------------------------------------------
      * NEVADA ROUTINE:  9999.02 MERCURY ACTION SPRDER = 9
      * TEST FOR CUSTOMER PAYOFF PRIOR TO ORIGINAL MATURITY
      *      IF SO DEDUCT $25.00 FROM REBATE:
      * ------------------------------------------------------
       REBATE-SPEC-RBREDUC-NV.
           IF SP-RBREDUC(REB-SUB) NOT = 9999.02
              GO TO REBATE-SPEC-RBREDUC-EXIT.

           IF NOT (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                   OR "RB" OR "RO")
              MOVE "Y" TO MDTE-ORGTERM-FG
                          MDTE-FLAG
              PERFORM MATURITY-DATE-CALCULATION
              IF REB-PAYDATE < MDTE-DATE
                 SUBTRACT 25.00 FROM REB-REBATE
                 IF REB-REBATE < 0
                    MOVE 0 TO REB-REBATE.

       REBATE-SPEC-RBREDUC-EXIT.
           EXIT.

      *****************************************************
      *    SPRING FINANCE (NJ) PRE-PAYOFF PENALTY
      *
      *    IF PAYOFF(PO) IS PRIOR TO MATURITY TAKE PENALTY
      *****************************************************
       REBATE-RBREDUC-NJ SECTION.

           MOVE 0 TO REB-MS-PENALTY.

           IF REB-LPTRCD NOT = "PO"
              GO TO REBATE-RBREDUC-NJ-EXIT.

           PERFORM MATURITY-DATE-CALCULATION.
           MOVE REB-PAYDATE TO NUM-DATE.
           MOVE MDTE-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS NOT > 0
              GO TO REBATE-RBREDUC-NJ-EXIT.

           PERFORM LOAN-CALCULATIONS.
           IF FINANCED-AMOUNT < 2000.01
              MOVE 20.00 TO REB-MS-PENALTY
              SUBTRACT 20.00 FROM REB-REBATE
           ELSE
              IF FINANCED-AMOUNT < 5000.01
                 COMPUTE REB-MS-PENALTY ROUNDED =
                                 (FINANCED-AMOUNT * .01)
                 COMPUTE REB-REBATE ROUNDED =
                     REB-REBATE - FINANCED-AMOUNT * .01
              ELSE
                 MOVE 100.00 TO REB-MS-PENALTY
                 SUBTRACT 100.00 FROM REB-REBATE.

       REBATE-RBREDUC-NJ-EXIT.
           EXIT.

      *****************************************************
      *    THRIFT INVESTMENT CORP (NJ) PREPAID PENALTY
      *
      * IF PREPAID WITHIN 12 MONTHS AFTER THE FIRST PAY IS
      * IS DUE, YOU CAN CHARGE A PRE-PAYMENT PENALTY.
      *****************************************************
       REBATE-RBREDUC-NJ-21 SECTION.

           MOVE 0 TO REB-MS-PENALTY.

           IF REB-LPTRCD NOT = "PO"
              GO TO REBATE-RBREDUC-NJ-21-EXIT.

           MOVE LN-ORIG-1STPYDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF ELAPSED-MONTHS NOT < 12
              GO TO REBATE-RBREDUC-NJ-21-EXIT.

      *    0 - 2000 = $20.00
      * 2000 - 5000 = 1% OF AMTFIN
      * 5000 - ?    = $100.00

           PERFORM LOAN-CALCULATIONS.
           IF FINANCED-AMOUNT < 2000.01
              SUBTRACT 20.00 FROM REB-REBATE
              MOVE 20.00 TO REB-MS-PENALTY
           ELSE
              IF FINANCED-AMOUNT < 5000.01
                 COMPUTE REB-MS-PENALTY ROUNDED =
                                             (FINANCED-AMOUNT * .01)
                 COMPUTE REB-REBATE ROUNDED =
                     REB-REBATE - FINANCED-AMOUNT * .01
              ELSE
                 MOVE 100.00 TO REB-MS-PENALTY
                 SUBTRACT 100.00 FROM REB-REBATE.

       REBATE-RBREDUC-NJ-21-EXIT.
           EXIT.

      ********************************************************************
      *    REGENCY FINANCE (OH RBSPOPT1 = 25) PRE-PAYOFF PENALTY
      *
      *    IF PAYOFF IS WITH IN 5 YEARS (360 * 5 = 1800 DAYS) OF LOAN DATE
      *       REDUCE COMPUTED REBATE BY 1% OF ORIGINAL PRINCIPAL
      ********************************************************************
       REBATE-RBREDUC-OH SECTION.

           MOVE 0 TO REB-MS-PENALTY.
           IF REB-LPTRCD = "PO"
              MOVE LN-LOANDATE TO NUM-DATE
              MOVE REB-PAYDATE TO SYS-DATE
              PERFORM TIM360
              IF ELAPSED-DAYS NOT > 1800
                 PERFORM LOAN-CALCULATIONS
                 COMPUTE REB-MS-PENALTY =
                                 ( FINANCED-AMOUNT * 0.01 )
                 COMPUTE REB-REBATE =
                    REB-REBATE - ( FINANCED-AMOUNT * 0.01 )
                 IF REB-REBATE < 0
                    MOVE 0 TO REB-REBATE.

      ********************************************************************
      *    REGENCY FINANCE (OH RBSPOPT1 = 25) PRE-PAYOFF PENALTY
      *
      *    IF THE ORIGINAL PRINCIPLE AMOUNT IS $75,000 OR LESS
      *       IF PAYOFF IS WITH IN 5 YEARS (360 * 5 = 1800 DAYS) OF LOAN DATE
      *          REDUCE COMPUTED REBATE BY 1% OF THE LOANS NET BALANCE.
      *
      *    IF THE ORIGINAL PRINCIPLE AMOUNT IS OVER $75,000
      *       IF PAYOFF IS WITHIN 1 YEAR  (360 * 1 = 360  DAYS) OF LOAN DATE
      *          REDUCE COMPUTED REBATE BY 2% OF THE LOANS NET BALANCE.
      *       IF PAYOFF IS 1 - 2 YEARS (360 TO 720 DAYS) OF LOAN DATE
      *          REDUCE COMPUTED REBATE BY 1% OF THE LOANS NET BALANCE.
      *       IF PAYOFF IS OVER 5 YEARS (360 * 5 = 1800 DAYS) OF LOAN DATE
      *          THERE IS NO PENALTY.
      ********************************************************************
       REBATE-RBREDUC-OH-25 SECTION.

           MOVE 0 TO REB-MS-PENALTY.
           IF REB-LPTRCD = "PO"
              PERFORM LOAN-CALCULATIONS
              IF FINANCED-AMOUNT <= 75000
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE REB-PAYDATE TO SYS-DATE
                 PERFORM TIM360
                 IF ELAPSED-DAYS NOT > 1800
                    COMPUTE REB-MS-PENALTY = ( LN-CURBAL * 0.01 )
                    COMPUTE REB-REBATE = REB-REBATE - REB-MS-PENALTY
                    IF REB-REBATE < 0
                       MOVE 0 TO REB-REBATE
                    END-IF
                 END-IF
              ELSE
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE REB-PAYDATE TO SYS-DATE
                 PERFORM TIM360
                 IF ELAPSED-DAYS NOT > 360
                    COMPUTE REB-MS-PENALTY = ( LN-CURBAL * 0.02 )
                    COMPUTE REB-REBATE = REB-REBATE - REB-MS-PENALTY
                    IF REB-REBATE < 0
                       MOVE 0 TO REB-REBATE
                    END-IF
                 ELSE IF ELAPSED-DAYS > 360 AND NOT > 720
                    COMPUTE REB-MS-PENALTY = ( LN-CURBAL * 0.01 )
                    COMPUTE REB-REBATE = REB-REBATE - REB-MS-PENALTY
                    IF REB-REBATE < 0
                       MOVE 0 TO REB-REBATE
                    END-IF
                 ELSE
                    MOVE 0 TO REB-MS-PENALTY.

      ******************************************************************
      * PREPAYMENT PENALTY FOR MX VYBA LOANS (WORLD PR#0954)
      *
      * THE FOLLOWING DESCRIPTION IS COPIED DIRECTLY FROM THE REQEST:
      * -------------------------------------------------------------
      *  THE CALCULATION WOULD BE THE AMOUNT FINANCED TIMES THE EFFECTIVE
      *  RATE, DIVIDED BY 365 TIMES THE NUMBER OF DAYS FROM DATE OF LOAN
      *  UNTIL FIRST PAY DATE, OR PAYOFF DATE, WHICHEVER IS EARLIER.
      *
      *  SO, IF THE LOAN PAYS OFF BEFORE THE FIRST PAY DATE, IT WILL BE FOR
      *  THE NUMBER OF DAYS LOAN WAS OPEN.  IF IT IS AFTER THE FIRST PAY
      *  DATE BUT IS IN THE FIRST 12 MONTHS, IT WILL BE THE INTEREST THAT
      *  SHOULD HAVE BEEN CHARGED FOR THE EXTENDED FIRST PAY DATE.
      *
      *  EXAMPLE, DATE OF LOAN 09/01/13.  DATE OF FIRST PAYMENT 11/07/13.
      *  AMOUNT FINANCED $20,000. RATE IS EFFECTIVE 75%.
      *
      *  CUSTOMER PAYS OFF ON 10/25/13.  THIS IS PRIOR TO THE FIRST PAY DATE,
      *  SO THE CHARGE WILL BE FOR ONLY THE NUMBER OF DAYS FROM DATE OF
      *  LOAN TO PAYOFF DATE, WHICH ON A 365 DAY YEAR TYPE IS 54 DAYS.
      *  SO WE WILL TAKE $20,000.00 TIMES .75 DIVIDED BY 365 TIMES 54,
      *  OR 20000 X .75 = 15000/365=41.09589 X 54 = $2,219.18 EARLY
      *  PAYOFF PENALTY.
      *
      *  CUSTOMER PAYS OFF ON 12/25/13.  THIS IS AFTER THE FIRST PAY DATE,
      *  SO THE CHARGE WILL BE FOR ONLY THE NUMBER OF DAYS FROM DATE OF
      *  LOAN TO THE FIRST PAY DATE, WHICH ON A 365 DAY YEAR TYPE IS 67 DAYS.
      *  SO WE WILL TAKE $20,000.00 TIMES .75 DIVIDED BY 365 TIMES 67,
      *  OR 20000 X .75 = 15000/365=41.09589 X 67 = $2,753.42 EARLY PAYOFF
      *  PENALTY. THE EARLY PAYOFF AMOUNT IS SUBTRACTED FROM THE NORMAL
      *  REFUND AMOUNT, THUS INCREASING THE PAYOFF BY THE AMOUNT OF THE
      *  EARLY PENALTY.
      *
      *  CUSTOMER PAYS OFF ON 11/24/14 NO PENALTY SINCE IT IS MORE THAN 12
      *  MONTHS FROM DATE OF LOAN.
      *
      ******************************************************************
       REBATE-RBREDUC-VYBA-28 SECTION.
           MOVE 0 TO REB-MS-PENALTY.
           IF REB-LPTRCD = "PO" OR "PB"
              IF REB-PAYDATE < LN-ORIG-1STPYDATE
                 PERFORM LOAN-CALCULATIONS
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE REB-PAYDATE TO SYS-DATE
                 PERFORM TIM365
                 COMPUTE REB-MS-PENALTY ROUNDED =
                     ( FINANCED-AMOUNT * LN-EFFRATE * ELAPSED-DAYS ) /
                            (365 * 100)
              ELSE
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE REB-PAYDATE TO SYS-DATE
                 PERFORM TIM365
                 IF ELAPSED-MONTHS NOT < 12
                    GO TO REBATE-RBEARLY-VYBA-28-EXIT
                 END-IF
                 MOVE LN-LOANDATE TO NUM-DATE
                 MOVE LN-ORIG-1STPYDATE TO SYS-DATE
                 PERFORM TIM365
                 PERFORM LOAN-CALCULATIONS
                 COMPUTE REB-MS-PENALTY ROUNDED =
                     ( FINANCED-AMOUNT * LN-EFFRATE * ELAPSED-DAYS ) /
                            (365 * 100)
              ELSE
                 MOVE 0 TO REB-MS-PENALTY.

           COMPUTE REB-REBATE = REB-REBATE - REB-MS-PENALTY
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE
           END-IF.

       REBATE-RBEARLY-VYBA-28-EXIT.
           EXIT.

      *********************************************
      *   ROUTINE TO CALL SUBPROGRAM:
      *
      *   MOVE FIELDS TO PASS TO REB-COMMON
      *   MOVE PROGRAM NAME TO REB-FORM-PROG
      *   IF NO CANCEL OF SUBPROG IS REQUESTED
      *      MOVE " " TO REB-CANCEL-FG.
      *********************************************
       REBATE-CALL-SUBPROG SECTION.
           MOVE REB-FORM-PATH TO FORM-NAM.
       REBATE-CALL-SUBPROG-RETRY.
           IF REB-RECAST = "Y" AND SP-RBRECAST(REB-SUB) = 1
              MOVE REB-PAYDATE TO REB-COMMON-PAYDATE
              CALL FORM-PROGX USING FORM-PATH REB-COMMON LN-REC SP-REC
                                                         LTI-REC
                  ON OVERFLOW
                  GO TO REBATE-CALL-SUBPROG-RETRY
           ELSE
              CALL FORM-PROGX USING FORM-PATH REB-COMMON LN-REC LTI-REC
                  ON OVERFLOW
                  GO TO REBATE-CALL-SUBPROG-RETRY.

           IF REB-CANCEL-FG = "Y"
              CANCEL FORM-PROGX.
           MOVE "Y" TO REB-CANCEL-FG.

      *********************************
      *   EARLY PROVISION ROUTINES
      *********************************
       REBATE-EP1 SECTION.
           IF LN-EXTCHG = 0
              MOVE "B" TO REB-HOLD-RBDTE
           ELSE
              IF REB-HOLD-RBDTE = "D"
                 MOVE "D" TO REB-HOLD-RBDTE
              ELSE
                 MOVE "C" TO REB-HOLD-RBDTE.
      * ^^^^^^^^^^
      * THE ABOVE LOGIS IS CONFUSING TO ME, PRIOR TO ADDING "D" THE ELSE
      * JUST SET THE VALUE TO "C" TO USE A LATER DATE DUE TO EXTENSION.
      * FROM THIS POINT FORWARD 'C' AND 'D' ARE THE SAME SO THE ONLY ONE
      * AFFECTED IS 'A' WHICH WILL CONTINUE TO BE FORCED TO A 'C AS IT
      * DID BEFORE.

       REBATE-EP2 SECTION.
           COMPUTE REB-EARN-FOR-1MON ROUNDED =
                         (REB-ORGTERM * LN-INTCHG) /
                             (REB-ORGTERM * (REB-ORGTERM + 1) / 2).
           IF REB-REBATE NOT < 0
              COMPUTE REB-REBATE = LN-INTCHG - REB-EARN-FOR-1MON
              MOVE REB-PAYDATE TO NUM-DATE
              MOVE REB-LN-ORIG-1STPYDATE TO SYS-DATE
              MOVE SP-RBYRTYPE(REB-SUB,REB-SUB2) TO ELAPSED-YRTYPE
              PERFORM TIMALL
              IF ELAPSED-DAYS > 30
                 SUBTRACT 30 FROM ELAPSED-DAYS GIVING
                                                 REB-UNUSED-EXTDAYS
                 PERFORM REBATE-EP2-REBATE-EXTCHG
                 GO TO REBATE-EP2-EXIT
              ELSE
                 PERFORM REBATE-EP2-REBATE-CHG
                 GO TO REBATE-EP2-EXIT.

       REBATE-EP2-REBATE-CHG.
           IF REB-REBATE NOT < 0
              IF ELAPSED-DAYS > 0
                 COMPUTE REB-PRORATA-30DAY-PCT =
                                         (ELAPSED-DAYS / 30) + .0009
                 COMPUTE REB-REBATE ROUNDED = REB-REBATE +
                           REB-EARN-FOR-1MON * REB-PRORATA-30DAY-PCT.

       REBATE-EP2-REBATE-EXTCHG.
           PERFORM REBATE-GET-EXTDAYS.
           IF REB-TOTAL-EXTDAYS > 0
              COMPUTE REB-REBATE ROUNDED = LN-INTCHG +
                       REB-UNUSED-EXTDAYS / REB-TOTAL-EXTDAYS *
                                                           LN-EXTCHG.

       REBATE-EP2-EXIT.
           EXIT.

      *****************************************************
      *    EARN EXTENSION CHARGE PRORATA
      *****************************************************
       REBATE-EP7 SECTION.
           MOVE 0 TO REB-EARN-FOR-1MON.
           PERFORM REBATE-GET-EXTDAYS.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM.
           IF REB-TOTAL-EXTDAYS > 0
              COMPUTE REB-EARN-FOR-1MON ROUNDED = LN-EXTCHG -
                 (LN-EXTCHG / REB-TOTAL-EXTDAYS) * ELAPSED-DAYS
              IF REB-EARN-FOR-1MON < 0
                 MOVE 0 TO REB-EARN-FOR-1MON.
           ADD REB-EARN-FOR-1MON TO REB-REBATE.

      **************************************************************************
      *    1/30TH 78THS IF BF 1STPYDATE
      * REV:
      *  JTG 020497 CHANGED TO TEST FOR PAYDATE PRIOR TO
      *             INTEREST START DATE AND SET FULL REFUND
      *  JTG 000317 CHANGED TO CARRY INITIAL CALC OF DAILY FACTOR
      *             TO MORE DECIMALS THAN 2 RE: WORLD BR 588 #01-006564
      *             WRITTEN UP BY AUDITORS
      *  JTG 000322 ALLOWED LOGIC FOR EP10 TO WORK FOR SERVICE CHARGE REFUNDS
      *             ALSO, RE: WORLD BR 588 #01-006564 WRITTEN UP BY AUDITORS
      **************************************************************************
       REBATE-EP10 SECTION.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF REB-SUB = 7
              IF ELAPSED-DAYS < 0
                 IF REB-ADDON-FG = "Y"
                    MOVE LTI-ANTICERN(1)        TO REB-REBATE
                 ELSE
                    ADD LN-INTCHG LN-EXTCHG GIVING REB-REBATE
              ELSE
                 IF REB-ADDON-FG = "Y"
                    COMPUTE REB-WK ROUNDED =
                    ( LTI-ANTICERN(1)
                        - (LTI-ANTICERN(1)
                             * (REB-ORGTERM - 1) * (REB-ORGTERM)
                                / (REB-ORGTERM * (REB-ORGTERM + 1))
                          )
                    ) / 30
                 COMPUTE REB-REBATE ROUNDED =
                     LTI-ANTICERN(1)  - ELAPSED-DAYS * REB-WK
              ELSE
                 COMPUTE REB-WK ROUNDED =
                    ( LN-INTCHG
                        - (LN-INTCHG
                                * (REB-ORGTERM - 1) * (REB-ORGTERM)
                                   / (REB-ORGTERM * (REB-ORGTERM + 1))
                          )
                    ) / 30
                 COMPUTE REB-REBATE ROUNDED =
                     LN-INTCHG + LN-EXTCHG - ELAPSED-DAYS * REB-WK
              END-IF
             END-IF
           ELSE
           IF REB-SUB = 8
              IF ELAPSED-DAYS < 0
                 MOVE LN-SERCHG TO REB-REBATE
              ELSE
                 COMPUTE REB-WK ROUNDED =
                    ( LN-SERCHG
                        - (LN-SERCHG
                                * (REB-ORGTERM - 1) * (REB-ORGTERM)
                                   / (REB-ORGTERM * (REB-ORGTERM + 1))
                          )
                    ) / 30
                 COMPUTE REB-REBATE ROUNDED =
                   LN-SERCHG - ELAPSED-DAYS * REB-WK.

      *****************************************************
      * MISSOURI
      * 23-  IF BEFORE 1STPYDATE, REFUND THE DIFF BETWEEN THE
      *       ORIG INTCHG AND INT PRECOMPUTED ON THE ACTUAL
      *       UNPAID PRINCIPAL BALANCE 1/360TH OF THE EFFRATE
      *       FOR EACH DAY FROM LOANDATE TO POFFDATE
      * ILLINOIS
      * 28-  IF BEFORE 1STPYDATE, REFUND THE DIFF BETWEEN THE
      *       (ORIG INTCHG + ORIG EXTCHG) AND INT PRECOMPUTED
      *       ON THE ACTUAL UNPAID PRINCIPAL BALANCE 1/360TH
      *       OF THE EFFRATE FOR EACH DAY FROM LOANDATE TO POFFDATE
      *****************************************************
       REBATE-EP23-28 SECTION.

           MOVE REB-LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIM365.
           IF ELAPSED-DAYS < 0
              ADD LN-INTCHG LN-EXTCHG GIVING REB-REBATE
           ELSE
              PERFORM LOAN-CALCULATIONS
              IF SP-RBEARLY(REB-SUB) = 23
                 COMPUTE REB-REBATE ROUNDED = LN-INTCHG -
                 ( DISCLOSED-FINAMT * (LN-EFFRATE / 36000)
                    * ELAPSED-DAYS )
              ELSE
                 COMPUTE REB-REBATE ROUNDED =
                        (LN-INTCHG + LN-EXTCHG) -
                 ( DISCLOSED-FINAMT * (LN-EFFRATE / 36000)
                        * ELAPSED-DAYS ).


      ******************************************************
      *    INDIANA EARLY PROVISION 27
      *    EXTENSION CHARGE IS NEVER REFUNDED
      *    1ST MONTH IS PRORATED, 30 DAYS EARNS THE ENTIRE
      *    MONTHS EARNINGS EVEN IF 31 DAYS IN THE PERIOD
      *                                     PR#1406
      *****************************************************
       REBATE-EP27 SECTION.
      * IF PAYDATE PRIOR TO 30DAY PRIOR DATE REFUND ALL INTEREST
           IF REB-PAYDATE < REB-REFDATE
               MOVE REB-TOTCHG TO REB-REBATE
               GO TO REBATE-EP27-EXIT.

      * SLICE FOR THE FIRST MONTH
           COMPUTE REB-EARN-FOR-1MON ROUNDED =
                    (REB-ORGTERM * LN-INTCHG) /
                        (REB-ORGTERM * (REB-ORGTERM + 1) / 2).

      * THIS WILL GIVE US REBATE IF 30 DAYS IS USED
           IF REB-REBATE NOT < 0
              COMPUTE REB-REBATE = LN-INTCHG - REB-EARN-FOR-1MON.

      * THIS WILL GIVE US ACTUAL USED DAYS USING 365 YEAR TYPE
              MOVE REB-REFDATE TO NUM-DATE.
              MOVE REB-PAYDATE TO SYS-DATE.
              MOVE 365  TO ELAPSED-YRTYPE.
              PERFORM TIMALL.

      * WHAT WE ARE REALLY COMPUTING IS REMAINING DAYS IN THE
      * BEGINNING START POINT OF 30 DAYS.
              COMPUTE ELAPSED-DAYS = 30 - ELAPSED-DAYS.

              IF ELAPSED-DAYS > 30
                  MOVE 30 TO ELAPSED-DAYS.

              PERFORM REBATE-EP27-REBATE-CHG.

              GO TO REBATE-EP27-EXIT.

       REBATE-EP27-REBATE-CHG.
           IF REB-REBATE NOT < 0
              IF ELAPSED-DAYS > 0
                 COMPUTE REB-PRORATA-30DAY-PCT =
                                         (ELAPSED-DAYS / 30) + .0009
                 COMPUTE REB-REBATE ROUNDED = REB-REBATE +
                          REB-EARN-FOR-1MON * REB-PRORATA-30DAY-PCT.
       REBATE-EP27-EXIT.
           EXIT.

      *******************************************************
      * TENNEESSEE EARLY REFUND WITHIN 3 DAYS - AND -
      * EARLY PROVISION FOR THE 5% CLOSING FEE PORTION THAT
      * IS STORED IN LN-POINTS AND ALSO INCLUDED IN LN-SERCHG
      *******************************************************
       REBATE-EARLY-97 SECTION.

      * TEST FOR PAYOFF WITHIN 1ST 3 DAYS; INCLUDES SERCHG & CLOSING FEE
           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE    TO SYS-DATE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS < 4
              MOVE REB-TOTCHG TO REB-REBATE
              MOVE 0 TO REB-SUB2
              GO TO REBATE-EARLY-97-EXIT.

      * EARLY PROVISION FOR THE CLOSING FEE PORTION (LN-POINTS).
      * USING A DAILY PRO-RATA FORMULA DURING THE FIRST 90 DAYS OF
      * THE LOAN, USING 365 YEAR TYPE, SUBJECT TO $25 MINIMUM RET.

      * TOOK CODE FROM SCFRMLA 54 SAME LOGIC
           MOVE 0 TO REB-EP54-AMT.

      * GET ELAPSED DAYS FROM LOAN DATE TO REFUND DATE.
           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIMALL.
           MOVE ELAPSED-DAYS TO REBX-DAYS-REMAINING.

           IF ELAPSED-DAYS > 90
              MOVE 0 TO REB-SUB2
              GO TO REBATE-EARLY-97-EXIT.

      * DETERMINE DAYS IN ORG TERM:
      *    MOVE "Y" TO MDTE-FLAG
      *                MDTE-ORGTERM-FG.
      *    PERFORM MATURITY-DATE-CALCULATION.
      *    MOVE MDTE-DATE      TO SYS-DATE.
      *    MOVE REB-LN-INTDATE TO NUM-DATE.
      *    PERFORM TIM365.
      *    MOVE ELAPSED-DAYS TO REBX-DAYS-IN-TERM.
 
      * THEY WANT DAYS IN TERM FORCED TO THE 90 DAYS
           MOVE 90 TO REBX-DAYS-IN-TERM.

      * COMPUTE EARNED FOR PRORATA:
           COMPUTE REB-EP54-AMT ROUNDED =
                  (REBX-DAYS-REMAINING * LN-POINTS)/
                        REBX-DAYS-IN-TERM

           IF REB-EP54-AMT < 0
              MOVE 0 TO REB-EP54-AMT.

      * TEST FOR MINIMUM EARNED OF $25.00
           IF REB-EP54-AMT < 25.00
              MOVE 25.00 TO REB-EP54-AMT.

      * COMPUTE REBATE:
           COMPUTE REB-EP54-AMT ROUNDED =  LN-POINTS - REB-EP54-AMT.

           IF REB-EP54-AMT < 0
              MOVE 0 TO REB-EP54-AMT.

           ADD REB-EP54-AMT TO REB-REBATE.
      * THIS SIGNALS TO EXIT AFTER PERFORMING THIS SECTION. NOTHING
      * ELSE REBATES WHEN THIS PROVISION IS BEING USED.
           MOVE 0 TO REB-SUB2.

       REBATE-EARLY-97-EXIT.
           EXIT.

      ********************************************
      * TENNEESSEE EARLY REFUND WITHIN 3 DAYS
      ********************************************
       REBATE-EARLY-99 SECTION.

      * TEST FOR PAYOFF WITHIN 1ST 3 DAYS:
           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS < 4
              MOVE REB-TOTCHG TO REB-REBATE
              MOVE 0 TO REB-SUB2.

       REBATE-EARLY-99-EXIT.
           EXIT.

      *****************************************************
      * REGIONAL MGMT FULL CANCEL IF PAIDOFF WITHIN 10 DAYS
      *****************************************************
       REBATE-EARLY-98 SECTION.
      * TEST FOR PAYOFF WITHIN 1ST 10 DAYS:
      *    MOVE SP-RBYRTYPE(REB-SUB,1) TO ELAPSED-YRTYPE.
           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS < 11
              MOVE REB-TOTCHG TO REB-REBATE
              MOVE 0 TO REB-SUB2.

       REBATE-EARLY-98-EXIT.
           EXIT.





      *****************************************************************
      * MISSISSIPPI COMPANY PAYOFF WITHIN 90 DAYS - 3
      * ALABAMA COMPANY PAYOFF WITHIN 120 DAYS - 16  (SAME AS 3)
      *
      * ALABAMA COMPANY PAYOFF WITHIN 90 DAYS - 12
      * ALABAMA COMPANY PAYOFF WITHIN 120 DAYS - 15
      *    IF PREPAID WITHIN 90 DAYS BY COMPANY PAYOFF, REFUND PRORATA
      *    TO THE DAY. A 365-DAY YEAR IS USED TO COMPUTE THE 90DAY TEST
      *    AND SP-YEARTYPE IS USED TO COMPUTE THE REBATE. (SPREAR=1)
      *****************************************************************
       REBATE-EP3 SECTION.
      * TEST FOR COMPANY PAYOFF:
           IF NOT (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                   OR "RB" OR "RO")
              GO TO REBATE-EP3-EXIT.

      * TEST FOR PAYOFF WITHIN 1ST 90 DAYS:
           MOVE 367 TO ELAPSED-YRTYPE.
      * MERCURY - "AL"
           IF SP-RBEARLY(REB-SUB) = 12 OR 15
              MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
           IF SP-RBEARLY(REB-SUB) = 15 OR 16
              IF ELAPSED-DAYS > 120
                 GO TO REBATE-EP3-EXIT
              ELSE
                 NEXT SENTENCE
           ELSE
              IF ELAPSED-DAYS > 90
                 GO TO REBATE-EP3-EXIT.

           IF SP-RBEARLY(REB-SUB) = 12 OR 15
              MOVE REB-LN-INTDATE TO NDTE-DATE
              MOVE REB-LN-ORGTERM TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE REB-LN-LOANDATE TO NUM-DATE
              MOVE NDTE-DATE TO SYS-DATE
              MOVE SP-YEARTYPE TO ELAPSED-YRTYPE
              PERFORM TIMALL
              MOVE ELAPSED-DAYS TO REB-ELAPSED-DAYS
              MOVE REB-LN-INTDATE TO NUM-DATE
              MOVE REB-PAYDATE TO SYS-DATE
              MOVE SP-YEARTYPE TO ELAPSED-YRTYPE
              PERFORM TIMALL
      * ACTION TRUNCATES TO 3 DECIMALS
              COMPUTE REB-PRORATA-30DAY-PCT ROUNDED =
                   (REB-ELAPSED-DAYS - ELAPSED-DAYS) / REB-ELAPSED-DAYS
              COMPUTE REB-REBATE ROUNDED = REB-PRORATA-30DAY-PCT
                                         *  REB-TOTCHG
           ELSE
              COMPUTE REB-REBATE ROUNDED =
                (LN-INTCHG + LN-EXTCHG) - (LN-EFFRATE / 360 / 100 *
                (LN-LNAMT - LN-INTCHG - LN-EXTCHG) * ELAPSED-DAYS).

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP3-EXIT.
           EXIT.

      ********************************************
      * MERCURY MISSISSIPPI EARLY REFUND PROVISION
      * IF PREPAID WITHIN 90 DAYS FROM DATE INT STARTS
      * BY COMPANY PAYOFF OR BY THE CUSTOMER BEFORE THE FIRST
      * PAYMENT COMES DUE, REFUND IS PRO RATA TO THE DAY
      * BASED ON THE FOLLOWING FORMULA:
      *   1.   APR
      *        ---   X  AF  X D = EA
      *        360
      *
      *   2. FC - EA = R
      *
      *      APR = WITHOUT SERVICE CHARGE
      *      AF  = TOTAL NOTE - INTCHG - EXTCHG
      *      D   = NUMBER OF DAYS LOAN IN EFFECT
      *      EA  = EARNED AMOUNT
      *      FC  = ORIGINAL FINANCE CHARGE + EXTCHG
      *      R   = REFUND
      ********************************************
       REBATE-EP11 SECTION.
      * TEST FOR COMPANY PAYOFF WITHIN 90 DAYS FROM DATE INT STARTS
           IF (REB-LPTRCD = "PB" OR "RN" OR "SC"
                               OR "RB" OR "RO")
              MOVE 367 TO ELAPSED-YRTYPE
              MOVE REB-LN-INTDATE TO NUM-DATE
              MOVE REB-PAYDATE TO SYS-DATE
              PERFORM TIMALL
              IF ELAPSED-DAYS > 90
                 GO TO REBATE-EP11-EXIT
              ELSE
                 NEXT SENTENCE
           ELSE
      * TEST FOR CUSTOMER PAYOFF BEFORE THE FIRST PAYMENT COMES DUE
              IF REB-SUB NOT = 7
                 GO TO REBATE-EP11-EXIT
              ELSE
                 IF NOT PODATE-B4-1STPYDATE
                    GO TO REBATE-EP11-EXIT
                 ELSE
                    MOVE 367 TO ELAPSED-YRTYPE
                    MOVE REB-LN-INTDATE TO NUM-DATE
                    MOVE REB-PAYDATE TO SYS-DATE
                    PERFORM TIMALL.

           COMPUTE REB-REBATE ROUNDED =
              (LN-INTCHG + LN-EXTCHG) - (LN-EFFRATE / 360 / 100 *
              (LN-LNAMT - LN-INTCHG - LN-EXTCHG) * ELAPSED-DAYS).

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP11-EXIT.
           EXIT.

      *******************************************************
      * MERCURY, NEVADA EARLY REFUND PROVISION
      * WHEN PAYOFF IN DONE BY CUSTOMER REFUND IS
      * BASED ON THE ACTION DATA SHORT RATE TABLE:
      *******************************************************
       REBATE-EP13 SECTION.
           IF REB-LPTRCD = "PB" OR "RN" OR "SC"
                              OR "RB" OR "RO"
              GO TO REBATE-EP13-EXIT.

           MOVE "T" TO REB-FORM-PROG-TYPE.
           MOVE 02 TO REB-FORM-PROG-NO.
           MOVE REB-REFDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS TO T02-ELAPSED-DAYS.
           MOVE 3 TO ITRM-SUB.
           PERFORM INS-TERM-CALCULATION.
           MOVE ITRM-INSTERM TO T02-INSTERM.
           PERFORM REBATE-CALL-SUBPROG.
           IF REB-COMMON-RTNCD = " "
              MOVE REB-COMMON-REBATE TO REB-REBATE
           ELSE
              MOVE 0 TO REB-REBATE REB-SUB.

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP13-EXIT.
           EXIT.

      ********************************************
      * ALABAMA ANY PAYOFF WITHIN 90 DAYS (14)
      ********************************************
       REBATE-EP14 SECTION.

           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
      * SUN - "AL", AFTER 90 DAYS, SERVICE CHARGE IS FULLY EARNED
      * AND NO REBATES ARE DONE
           IF ELAPSED-DAYS > 90
              MOVE 0 TO REB-REBATE
              GO TO REBATE-EP14-EXIT.

           MOVE REB-LN-INTDATE TO NDTE-DATE.
           MOVE REB-LN-ORGTERM TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE REB-LN-LOANDATE TO NUM-DATE.
           MOVE NDTE-DATE TO SYS-DATE.
           MOVE SP-YEARTYPE TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           MOVE ELAPSED-DAYS TO REB-ELAPSED-DAYS.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           MOVE SP-YEARTYPE TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           COMPUTE REB-PRORATA-30DAY-PCT ROUNDED =
                (REB-ELAPSED-DAYS - ELAPSED-DAYS) / REB-ELAPSED-DAYS.
           COMPUTE REB-REBATE ROUNDED = REB-PRORATA-30DAY-PCT
                                      *  REB-TOTCHG.

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.

           IF REB-REBATE < SP-RBMIN(REB-SUB)
              MOVE 0 TO REB-REBATE.

       REBATE-EP14-EXIT.
           EXIT.

      *****************************************************************
      * CLAY FINANCIAL SINGLE PAY LOANS ONLY
      *    IF PREPAID BEFORE 1ST AND ONLY DUE DATE, REBATE
      *       IS RULE OF 78THS, WITH NO OF MONTHS TO 1ST
      *       PAYMENT EQUAL TO ORIGINAL TERM
      *
      *  NOTE: THIS WILL NOT WORK WITH REBATE FORMULA 'N'
      *****************************************************************
       REBATE-EP17 SECTION.
      * TEST FOR COMPANY PAYOFF:
           IF REB-LN-ORGTERM NOT = 1
              GO TO REBATE-EP17-EXIT.

           MOVE REB-LN-INTDATE TO NUM-DATE
                                  REB-REFDATE.
           MOVE REB-LN-ORIG-1STPYDATE TO SYS-DATE.
           PERFORM TIM360.
           MOVE ELAPSED-MONTHS TO REB-LN-ORGTERM
                                  REB-ORGTERM.

           PERFORM CALC-ELAPSED-REF-THRU-PODATE.
           IF JULIAN-DATE = 0
              MOVE 0 TO REB-SUB
              GO TO REBATE-EP17-EXIT.

           PERFORM REBATE-TEST-SWING.
           PERFORM REBATE-DEDUCT-CHARGE.

           PERFORM REBATE-78.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP17-EXIT.
           EXIT.

      * TEXAS SERVICE CHARGE EARLY PROVISION:
       REBATE-EP18 SECTION.
           COMPUTE REB-EARN-FOR-1MON ROUNDED =
                         (REB-ORGTERM * LN-SERCHG) /
                             (REB-ORGTERM * (REB-ORGTERM + 1) / 2).
           IF REB-REBATE NOT < 0
              COMPUTE REB-REBATE = LN-SERCHG - REB-EARN-FOR-1MON
              MOVE REB-PAYDATE TO NUM-DATE
              MOVE REB-LN-ORIG-1STPYDATE TO SYS-DATE
              MOVE SP-RBYRTYPE(REB-SUB,REB-SUB2) TO ELAPSED-YRTYPE
              PERFORM TIMALL
              IF ELAPSED-DAYS > 30
                 MOVE LN-SERCHG TO REB-REBATE
                 GO TO REBATE-EP18-EXIT
              ELSE
                 PERFORM REBATE-EP18-REBATE-CHG
                 GO TO REBATE-EP18-EXIT.

       REBATE-EP18-REBATE-CHG.
           IF REB-REBATE NOT < 0
              IF ELAPSED-DAYS > 0
                 COMPUTE REB-PRORATA-30DAY-PCT =
                                         (ELAPSED-DAYS / 30) + .0009
                 COMPUTE REB-REBATE ROUNDED = REB-REBATE +
                           REB-EARN-FOR-1MON * REB-PRORATA-30DAY-PCT.

       REBATE-EP18-EXIT.
           EXIT.
      *************************************************
      * SOUTH CAROLINA COMPANY PAYOFF WITHIN 90 DAYS
      * INTEREST CHARGE REFUND
      *************************************************
       REBATE-EP19 SECTION.
      * TEST FOR COMPANY PAYOFF:
           IF NOT (REB-LPTRCD = "PB" OR "RN" OR "SC"
                                   OR "RB" OR "RO")
              GO TO REBATE-EP19-EXIT.

      * TEST FOR PAYOFF WITHIN 1ST 90 DAYS:
           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS > 90
              GO TO REBATE-EP19-EXIT.

           COMPUTE REB-REBATE ROUNDED =
              REB-TOTCHG
                - REB-TOTCHG / (REB-ORGTERM * 30) * ELAPSED-DAYS.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP19-EXIT.
           EXIT.

      *************************************************
      * SOUTH CAROLINA SERVICE CHARGE REFUND,
      * IF CASH ADVANCE < $150.01, NO REFUND
      *************************************************
       REBATE-EP20 SECTION.
           PERFORM LOAN-CALCULATIONS.
           IF CASH-ADVANCE < 150.01
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.

       REBATE-EP20-EXIT.
           EXIT.

      ********************************************
      * FREEDOM, AL ANY PAYOFF WITHIN 90 DAYS IS PRO RATA
      *             AFTER 90 DAYS, NO REBATE.
      * REGMGM, AL (25) ANY PAYOFF WITHIN 90 DAYS IS PRO RATA
      *             AFTER 90 DAYS, USE SPR TABLE FORMULA'S
      ********************************************
       REBATE-EP22 SECTION.

           MOVE 365 TO ELAPSED-YRTYPE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.
      * AFTER 90 DAYS, SERVICE CHARGE IS FULLY EARNED, NO REBATE
           IF ELAPSED-DAYS > 90
              MOVE 0 TO REB-REBATE
              GO TO REBATE-EP22-EXIT.

      * EARNED
           COMPUTE REB-REBATE ROUNDED =
                            ( ELAPSED-DAYS * REB-TOTCHG / 90 ).

      * MUST EARN AT LEAST THE RBMINRET ($25.00)
      * REBATE
           IF REB-REBATE <  SP-RBMINRET(REB-SUB)
              COMPUTE REB-REBATE = REB-TOTCHG - SP-RBMINRET(REB-SUB)
           ELSE
               COMPUTE REB-REBATE = REB-TOTCHG - REB-REBATE.

           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.

           IF REB-REBATE < SP-RBMIN(REB-SUB)
              MOVE 0 TO REB-REBATE.

      * TRIGGER THAT YOU WERE < 90 DAYS AND ALREADY COMPUTED
           MOVE 0 TO REB-SUB.

       REBATE-EP22-EXIT.
           EXIT.

      *******************************************************
      *    TFC SHORT RATE CANCELLATION TABLE REFUND
      *         CL/REBT04.C                               #96
      *******************************************************
       REBATE-EP24 SECTION.
           MOVE "T" TO REB-FORM-PROG-TYPE.
           MOVE 04  TO REB-FORM-PROG-NO.
           MOVE REB-REFDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS TO T04-ELAPSED-DAYS.
           PERFORM REBATE-CALL-SUBPROG.
           IF REB-COMMON-RTNCD = " "
              MOVE REB-COMMON-REBATE TO REB-REBATE
           ELSE
              MOVE 0 TO REB-REBATE REB-SUB.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           MOVE 0 TO REB-SUB.
   
       REBATE-EP24-EXIT.
           EXIT.

      ********************************************
      * GEORGIA 4% CLOSING FEE EARLY PROVISION
      *
      * NOTE: THE AMOUNT OF THE CLOSING FEE IS STORED IN THE
      *       LN-POINTS FIELD AND ALSO INCLUDED IN THE SERVICE CHARGE
      *
      *  ***
      *  ** THIS EARLY PROVISION IS NOT STAND ALONE, IT IS CALLED FROM
      *  **  REBATE FORMULA "I" WHEN SERVICE CHARGE FORMULA = "54"
      *  ***
      *
      * REBATE AMOUNT IS PASSED BACK IN THE REB-WORK2 FIELD AND WILL BE
      *  ADDED TO REB-REBATE IN THE CALLING SECTION.
      *
      * IF THE LOAN PAYS  OFF IN THE FIRST 90 DAYS FROM DATE OF LOAN,
      * THE CUSTOMER IS ENTITLED TO A DAILY PRORATA REFUND OF THE CLOSING
      * FEE WITH A MINIMUM RETENTION OF $25.00.  THEREFORE, IF THE SERVICE
      * CHARGE IS GREATER THAN $25.00, MEANING $25.01 OR GREATER, THEN
      * THE CUSTOMER IS ENTITLED TO A REFUND OF THE DAILY PRORATA AMOUNT
      * GREATER THAN $25.00.  IF THE SERVICE CHARGE IS $25.00 OR LESS,
      * NO REFUND IS REQUIRED.
      *
      * SCENARIO ONE
      *    LOAN AMOUNT: $1250, CLOSING FEE OF $50
      *    LOAN TERM: 12 MONTHS, 360 DAYS
      *    LOAN PAID IN FULL ON 90TH DAY
      *
      *    $1250 X 4% = $50, $50 / 360 = .13888, .13888 X 90 = 12.4999,
      *    $12.50 IS EARNED,
      *    $37.50 IS UNEARNED,
      *    THE LENDER MAY RETAIN $25.00,
      *    THE REFUND TO THE BORROWER IS $25.00
      *
      * SCENARIO TWO
      *    LOAN AMOUNT: $1250, CLOSING FEE OF $50
      *    LOAN TERM: 4 MONTHS, 120 DAYS
      *    LOAN PAID IN FULL ON 90TH DAY

      *    $1250 X 4% = $50, $50 / 120 = .41666 X 90 = 37.4994,
      *    $37.50 IS EARNED,
      *    $12.50 IS UNEARNED,
      *    THE LENDER MAY RETAIN $37.50,
      *    THE REFUND OR CREDIT TO THE BORROWER IS $12.50
      *
      * SCENARIO THREE
      *    LOAN AMOUNT: $500, CLOSING FEE OF $20
      *    LOAN TERM: 6 MONTHS, 180 DAYS
      *    LOAN PAID IN FULL ON 90TH DAY

      *    $500 X 4% = $20, $20 / 180 = .11111 X 90 = 9.99999,
      *    $10.00 IS EARNED,
      *    $10.00 IS UNEARNED,
      *    THE LENDER MAY RETAIN $20.00,
      *    THE REFUND TO THE BORROWER IS $00.00
      *
      * SCENARIO FOUR
      *    LOAN AMOUNT: $1000, CLOSING FEE OF $40
      *    LOAN TERM: 6 MONTHS, 180 DAYS
      *    LOAN PAID IN FULL ON 90TH DAY

      *    $1000 X 4% = $40, $40 / 180 = .22222 X 90 = 19.99999,
      *    $20.00 IS EARNED,
      *    $20.00 IS UNEARNED,
      *    THE LENDER MAY RETAIN $25.00,
      *    THE REFUND OR CREDIT TO THE BORROWER IS $15.00
      ********************************************
       REBATE-EP54 SECTION.
           MOVE 0 TO REB-EP54-AMT.

           IF SP-SCFRMLA NOT = 54
              GO TO REBATE-EP54-EXIT.

      * GET ELAPSED DAYS FROM LOAN DATE TO REFUND DATE.
           MOVE 360 TO ELAPSED-YRTYPE
           MOVE REB-LN-LOANDATE TO NUM-DATE
           MOVE REB-PAYDATE TO SYS-DATE
           PERFORM TIMALL
           MOVE ELAPSED-DAYS TO REBX-DAYS-REMAINING

      * IF COMPANY PAYOFF AND ELAPSED > 90, NO EARLY PROVISION
           IF (REB-LPTRCD = "PB" OR "RN" OR "SC"
                               OR "RB" OR "RO")
              PERFORM TIMALL
              IF ELAPSED-DAYS > 90
                 GO TO REBATE-EP54-EXIT
              END-IF
           ELSE
      * IF
              IF REB-SUB NOT = 8
                 GO TO REBATE-EP54-EXIT
              ELSE
      * IF CUSTOMER PAYOFF AND ELAPSED > 90, NO EARLY PROVISION
                 IF ELAPSED-DAYS > 90
                    GO TO REBATE-EP54-EXIT.

      * DETERMINE DAYS IN ORG TERM:
           MOVE "Y" TO MDTE-FLAG
                       MDTE-ORGTERM-FG.
           PERFORM MATURITY-DATE-CALCULATION.
           MOVE MDTE-DATE TO SYS-DATE.
           MOVE REB-LN-INTDATE TO NUM-DATE.
           PERFORM TIM360.
           MOVE ELAPSED-DAYS TO REBX-DAYS-IN-TERM.

      * COMPUTE EARNED:
           COMPUTE REB-EP54-AMT ROUNDED =
                  (REBX-DAYS-REMAINING * LN-POINTS)/
                        REBX-DAYS-IN-TERM

           IF REB-EP54-AMT < 0
              MOVE 0 TO REB-EP54-AMT
           END-IF.

      * TEST FOR MINIMUM EARNED OF $25.00
           IF REB-EP54-AMT < 25.00
              MOVE 25.00 TO REB-EP54-AMT
           END-IF.

      * COMPUTE REBATE:
           COMPUTE REB-EP54-AMT ROUNDED =  LN-POINTS - REB-EP54-AMT.

           IF REB-EP54-AMT < 0
              MOVE 0 TO REB-EP54-AMT
           END-IF.

       REBATE-EP54-EXIT.
           EXIT.


      ***********************************************
      *              ( 0 8 )
      *    WISCONSIN CPI INSURANCE REFUND FORMULA
      ***********************************************
       REBATE-WI-CPI SECTION.
    
           COMPUTE REB-UPR-WHOLE ROUNDED =
                REB-TOTCHG * (365 - REB-ELAPSED-DAYS) / 366.
           MOVE REB-UPR-WHOLE TO REB-REBATE.
    
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
    
       REBATE-WI-CPI-EXIT.
           EXIT.

      ***********************************************
      *              ( 0 9 )
      *    TEXAS INTEREST REFUND FORMULA
      ***********************************************
       REBATE-TX-INTEREST SECTION.
           MOVE 0 TO REBTX-CALC-INT-TOT.
    
      * IF REBATE DATE IS >= MATURITY, FORCE A ZERO REBATE:
           PERFORM MATURITY-DATE-CALCULATION.
           IF REB-PAYDATE NOT < MDTE-DATE
              MOVE 0 TO REB-REBATE
              GO TO REBATE-TX-INTEREST-EXIT.
    
           PERFORM LOAN-CALCULATIONS.
           MOVE DISCLOSED-FINAMT TO REBTX-AMTFIN.
    
           COMPUTE REBI ROUNDED = REB-LN-SMPRATE * 0.01.
           COMPUTE REBTX-SERCHG-SLICE ROUNDED =
                          LN-SERCHG / REB-LN-ORGTERM.
    
      * SEE IF REBATE DATE IS ON OR PRIOR TO 1STPAY,
      * IF SO DETERMINE INTEREST THRU REBATE DATE
      
           IF REB-PAYDATE NOT > REB-LN-ORIG-1STPYDATE
              MOVE REB-LN-INTDATE  TO NUM-DATE
              MOVE REB-PAYDATE     TO SYS-DATE
              PERFORM TIM365
      * WHY ARE WE MULTIPLYING THE INTEREST BY -1, THIS ALWAYS YIELDS
      * A ZERO REBATE
      *       COMPUTE REBTX-CALC-INT ROUNDED =
      *           REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS * -1
              COMPUTE REBTX-CALC-INT ROUNDED =
                  REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS
              ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT
              GO TO REBATE-TX-INTEREST-END.
    
           MOVE REB-LN-1STPYAMT    TO REBTX-PYAMT.
           MOVE REB-LN-INTDATE     TO REBTX-FROM-DATE.
           MOVE REB-LN-ORIG-1STPYDATE TO REBTX-TO-DATE.
    
       REBATE-TX-INTEREST-LOOP.
           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REBTX-TO-DATE   TO SYS-DATE.
           PERFORM TIM365.
           COMPUTE REBTX-CALC-INT ROUNDED =
               REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS.
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.
           COMPUTE REBTX-AMTFIN =
              REBTX-AMTFIN - REBTX-PYAMT
               + REBTX-CALC-INT + REBTX-SERCHG-SLICE.
           IF REBTX-AMTFIN < 0
              MOVE 0 TO REBTX-AMTFIN.
    
           MOVE REBTX-TO-DATE   TO REBTX-FROM-DATE
                                   NDTE-DATE.
           MOVE 1               TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE       TO REBTX-TO-DATE.
           MOVE REB-LN-REGPYAMT TO REBTX-PYAMT.
    
           IF REB-PAYDATE > REBTX-TO-DATE
              GO TO REBATE-TX-INTEREST-LOOP.
    
           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIM365.
           COMPUTE REBTX-CALC-INT ROUNDED =
               REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS.
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.
    
       REBATE-TX-INTEREST-END.
           COMPUTE REB-REBATE =
              1.50 + LN-INTCHG + LN-EXTCHG - REBTX-CALC-INT-TOT.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           IF REB-REBATE > (LN-INTCHG + LN-EXTCHG)
              COMPUTE REB-REBATE = LN-INTCHG + LN-EXTCHG.
    
       REBATE-TX-INTEREST-EXIT.
           EXIT.


      ***********************************************
      *              ( 0 L )
      *    TEXAS INTEREST REFUND FORMULA FOR UNITED
      ***********************************************
       REBATE-TX-INT-UNITED SECTION.
           MOVE 0 TO REBTX-CALC-INT-TOT.

      * IF REBATE DATE IS >= MATURITY, FORCE A ZERO REBATE:
           PERFORM MATURITY-DATE-CALCULATION.
           IF REB-PAYDATE NOT < MDTE-DATE
              MOVE 0 TO REB-REBATE
              GO TO REBATE-TX-INT-UNITED-EXIT.

           PERFORM LOAN-CALCULATIONS.
           MOVE DISCLOSED-FINAMT TO REBTX-AMTFIN.

           COMPUTE REBI ROUNDED = REB-LN-APRATE * 0.01.
           COMPUTE REBTX-SERCHG-SLICE ROUNDED =
                          LN-SERCHG / REB-LN-ORGTERM.

      * SEE IF REBATE DATE IS ON OR PRIOR TO 1STPAY,
      * IF SO DETERMINE INTEREST THRU REBATE DATE
      
           IF REB-PAYDATE NOT > REB-LN-ORIG-1STPYDATE
              MOVE REB-LN-INTDATE  TO NUM-DATE
              MOVE REB-PAYDATE     TO SYS-DATE
              PERFORM TIM365
      * WHY ARE WE MULTIPLYING THE INTEREST BY -1, THIS ALWAYS YIELDS
      * A ZERO REBATE
      *       COMPUTE REBTX-CALC-INT ROUNDED =
      *           REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS * -1
              COMPUTE REBTX-CALC-INT ROUNDED =
                  REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS

              ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT
              GO TO REBATE-TX-INT-UNITED-END.

           MOVE REB-LN-1STPYAMT    TO REBTX-PYAMT.
           MOVE REB-LN-INTDATE     TO REBTX-FROM-DATE.
           MOVE REB-LN-ORIG-1STPYDATE TO REBTX-TO-DATE.

       REBATE-TX-INT-UNITED-LOOP.
           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REBTX-TO-DATE   TO SYS-DATE.
           PERFORM TIM365.
           COMPUTE REBTX-CALC-INT ROUNDED =
               REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS.
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.
           COMPUTE REBTX-AMTFIN =
              REBTX-AMTFIN - REBTX-PYAMT
               + REBTX-CALC-INT + REBTX-SERCHG-SLICE.
           IF REBTX-AMTFIN < 0
              MOVE 0 TO REBTX-AMTFIN.

           MOVE REBTX-TO-DATE   TO REBTX-FROM-DATE
                                   NDTE-DATE.
           MOVE 1               TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE       TO REBTX-TO-DATE.
           MOVE REB-LN-REGPYAMT TO REBTX-PYAMT.

           IF REB-PAYDATE > REBTX-TO-DATE
              GO TO REBATE-TX-INT-UNITED-LOOP.

           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIM365.
           COMPUTE REBTX-CALC-INT ROUNDED =
               REBTX-AMTFIN * REBI / 365 * ELAPSED-DAYS.
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.

       REBATE-TX-INT-UNITED-END.
           COMPUTE REB-REBATE =
              1.50 + LN-INTCHG + LN-EXTCHG - REBTX-CALC-INT-TOT.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           IF REB-REBATE > (LN-INTCHG + LN-EXTCHG)
              COMPUTE REB-REBATE = LN-INTCHG + LN-EXTCHG.

       REBATE-TX-INT-UNITED-EXIT.
           EXIT.



      *******************************************
      *          ( 0 H )
      *TEXAS INTEREST REFUND FORMULA
      *******************************************
       REBATE-TX-INT-0H SECTION.
           MOVE 0 TO REBTX-CALC-INT-TOT.

      *IF REBATE DATE IS >= MATURITY, FORCE A ZERO REBATE:
           PERFORM MATURITY-DATE-CALCULATION.
           IF REB-PAYDATE NOT < MDTE-DATE
              MOVE 0 TO REB-REBATE
              GO TO REBATE-TX-INT-0H-EXIT.

           PERFORM LOAN-CALCULATIONS.
           MOVE DISCLOSED-FINAMT TO REBTX-AMTFIN.

           COMPUTE REBTX-SERCHG-SLICE ROUNDED =
                         LN-SERCHG / REB-LN-ORGTERM.

      * SEE IF REBATE DATE IS ON OR PRIOR TO 1STPAY,
      * IF SO DETERMINE INTEREST THRU REBATE DATE
      
           IF REB-PAYDATE NOT > REB-LN-ORIG-1STPYDATE
              MOVE REB-LN-INTDATE  TO NUM-DATE
              MOVE REB-PAYDATE     TO SYS-DATE
              PERFORM TIM365
              PERFORM REBTX-CALC-INT-0H
              ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT
              GO TO REBATE-TX-INT-0H-END.


           MOVE REB-LN-1STPYAMT    TO REBTX-PYAMT.
           MOVE REB-LN-INTDATE     TO REBTX-FROM-DATE.
           MOVE REB-LN-ORIG-1STPYDATE TO REBTX-TO-DATE.

       REBATE-TX-INT-0H-LOOP.
           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REBTX-TO-DATE   TO SYS-DATE.
           PERFORM TIM365.
           PERFORM REBTX-CALC-INT-0H
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.
           COMPUTE REBTX-AMTFIN =
              REBTX-AMTFIN - REBTX-PYAMT
               + REBTX-CALC-INT + REBTX-SERCHG-SLICE.

           IF REBTX-AMTFIN < 0
              MOVE 0 TO REBTX-AMTFIN.

           MOVE REBTX-TO-DATE   TO REBTX-FROM-DATE
                                  NDTE-DATE.
           MOVE 1               TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE       TO REBTX-TO-DATE.
           MOVE REB-LN-REGPYAMT TO REBTX-PYAMT.

           IF REB-PAYDATE > REBTX-TO-DATE
              GO TO  REBATE-TX-INT-0H-LOOP.

           MOVE REBTX-FROM-DATE TO NUM-DATE.
           MOVE REB-PAYDATE     TO SYS-DATE.
           PERFORM TIM365.
           PERFORM REBTX-CALC-INT-0H.
           ADD REBTX-CALC-INT TO REBTX-CALC-INT-TOT.


       REBATE-TX-INT-0H-END.
      *    MOVE REBTX-CALC-INT-TOT TO
      *                    REBTX-CALC-INT-X.
      *    MOVE REBTX-CALC-INT-X TO MESS.
      *    PERFORM SEND-MESS.
           COMPUTE REB-REBATE =
              1.50 + LN-INTCHG + LN-EXTCHG - REBTX-CALC-INT-TOT.
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
           IF REB-REBATE > (LN-INTCHG + LN-EXTCHG)
              COMPUTE REB-REBATE = LN-INTCHG + LN-EXTCHG.
           GO TO REBATE-TX-INT-0H-EXIT.

       REBATE-TX-INT-0H-EXIT.
           EXIT.

       REBTX-CALC-INT-0H SECTION.
           MOVE ZEROS TO REBTX-STEP.
           MOVE ZEROS TO REBTX-CALC-INT.
           MOVE ZEROS TO REBTX-RATE-AMT.
           MOVE REBTX-AMTFIN TO REBTX-RATE-BAL.
       REBTX-CALC-INT-0H-LOOP.
           IF REBTX-RATE-BAL = ZEROS
              GO TO REBTX-CALC-INT-0H-END.

           ADD 1 TO REBTX-STEP.

           IF REBTX-STEP > 5
              GO TO REBTX-CALC-INT-0H-END.


           IF SP-CAL-BREAK(1,REBTX-STEP) = ZEROS
              MOVE REBTX-RATE-BAL TO REBTX-RATE-AMT
           ELSE
           IF REBTX-STEP = 1
              MOVE SP-CAL-BREAK(1,REBTX-STEP) TO REBTX-RATE-AMT
           ELSE
              SUBTRACT SP-CAL-BREAK(1,REBTX-STEP - 1) FROM
                        SP-CAL-BREAK(1,REBTX-STEP) GIVING
                                              REBTX-RATE-AMT.
           IF REBTX-RATE-BAL > REBTX-RATE-AMT
              SUBTRACT REBTX-RATE-AMT FROM REBTX-RATE-BAL
           ELSE
              MOVE REBTX-RATE-BAL TO REBTX-RATE-AMT
              MOVE ZERO TO REBTX-RATE-BAL.

           COMPUTE REBTX-CALC-INT = REBTX-CALC-INT +
              REBTX-RATE-AMT *
                 (SP-CAL-RATE(1,REBTX-STEP) * .01).


      *    COMPUTE REBTX-NEW-INT ROUNDED =
      *          REBTX-RATE-AMT *
      *          (SP-CAL-RATE(1,REBTX-STEP) * .01).
      *    COMPUTE REBTX-CALC-INT = REBTX-CALC-INT + REBTX-NEW-INT.


      *    MOVE REBTX-CALC-INT TO REBTX-CALC-INT-X.
      *    MOVE REBTX-CALC-INT-X TO MESS.
      *    PERFORM SEND-MESS.

           GO TO REBTX-CALC-INT-0H-LOOP.

       REBTX-CALC-INT-0H-END.
           COMPUTE REBTX-CALC-INT =
                   REBTX-CALC-INT / 365 * ELAPSED-DAYS.

       REBTX-CALC-INT-0H-EXIT.
           EXIT.

      ****************************************************************
      *                     (0 I)
      *    CITIZENS FINANCE COMPANY
      *    FORMULA FOR TRIST CPI SINGLE PAYMENT LOANS
      *
      ****************************************************************
       REBATE-TRIST-CPI-0I SECTION.

      * REBATE = ORIGINAL PREMIUM / DAYS IN TERM * DAYS REMAINING

      * DETERMINE DAYS IN INSURANCE TERM:
           MOVE REB-LN-INSEFF TO NUM-DATE.
           MOVE REB-LN-INSEXP TO SYS-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS TO REBX-DAYS-IN-TERM.

      * DETERMINE DAYS REMAINING:
           MOVE REB-PAYDATE   TO NUM-DATE.
           MOVE REB-LN-INSEXP TO SYS-DATE.
           PERFORM TIM365.
           MOVE ELAPSED-DAYS TO REBX-DAYS-REMAINING.

           IF REBX-DAYS-REMAINING < 0
              MOVE 0 TO REB-REBATE
              GO TO REBATE-TRIST-CPI-0I-EXIT.

      * DETERMINE REBATE:
           COMPUTE REB-REBATE =
              REB-TOTCHG / REBX-DAYS-IN-TERM.

           COMPUTE REB-REBATE = REB-REBATE * REBX-DAYS-REMAINING.

      * ROUND REFUND TO THE NEAREST DOLLAR:
           IF REB-REBATE-CENTS > 49
              MOVE 0 TO REB-REBATE-CENTS
              ADD 1 TO REB-REBATE-WHOLE
           ELSE
              MOVE 0 TO REB-REBATE-CENTS.

       REBATE-TRIST-CPI-0I-EXIT.
           EXIT.

      ***********************************************
      *              ( 0 A )
      *    MEAN OF PRORATA AND RULE 78THS
      ***********************************************
       REBATE-MEAN-OF-PRORATA-78 SECTION.
   
           COMPUTE REB-REBATE ROUNDED = REB-TOTCHG
                * ( (REB-ORGTERM - REB-ELAPSED-MONTHS)
                    * (2 * REB-ORGTERM - REB-ELAPSED-MONTHS + 2)
                  )
                  / ((2 * REB-ORGTERM) * (REB-ORGTERM + 1))
   
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
   
       REBATE-MEAN-OF-PRORATA-78-EXIT.
           EXIT.

      ***********************************************
      *              ( 0 B )
      *    RULE 78THS FOR NET + 1 LIFE REFUND
      ***********************************************
       REBATE-78-NET-1 SECTION.
   
           COMPUTE REB-REBATE ROUNDED = REB-TOTCHG
                * ( (REB-ORGTERM - REB-ELAPSED-MONTHS)
                    * (REB-ORGTERM - REB-ELAPSED-MONTHS + 1)
                    + (REB-ORGTERM - REB-ELAPSED-MONTHS)
                  )
                  / (REB-ORGTERM * (REB-ORGTERM + 1) + REB-ORGTERM)
   
           IF REB-REBATE < 0
              MOVE 0 TO REB-REBATE.
   
       REBATE-78-NET-1-EXIT.
           EXIT.

      ***********************************************
      *    GET EXTENSION DAYS
      ***********************************************
       REBATE-GET-EXTDAYS SECTION.
           MOVE SP-PYEXYEARTP TO ELAPSED-YRTYPE.
           MOVE REB-LN-ORIG-1STPYDATE TO SYS-DATE.
           IF SP-PYEXFMDATE-LOAN-DT
              MOVE REB-LN-LOANDATE TO NUM-DATE
           ELSE
              MOVE REB-LN-INTDATE TO NUM-DATE.
           PERFORM TIMALL.
           SUBTRACT 30 FROM ELAPSED-DAYS GIVING REB-TOTAL-EXTDAYS.

      ***********************************************************
      *    FIND INSURANCE RATE FROM SPR RATE TABLE
      *              USING INTERPOLATION / OR NEXT HIGH
      *                       (A&H)
      *
      *    IN  - REB-INSSUB       = SPR INSURANCE LEVEL
      *    OUT - REB-HUNDREDS
      *                AND        = RATE FOR REMAINING INS. TERM
      *          REB-MANYDECIMALS
      * REV:
      *  JTG 113094 CHANGED TO PASS RATE BACK WITH 4 DECIMALS
      *             SP-RBFRMLA = 'R' FOR TIME LOAN, CA AH REFUND
      *  JTG 070595 CHANGED TO USE INTERPOLATION OR NEXT HIGH
      *             RE: SPR
      *  JTG 071295 CHANGED TO HANDLE 7 OTHER INSURANCES
      ***********************************************************
       REBATE-FIND-INS-RATE SECTION.
           MOVE 0 TO REB-HUNDREDS.
           SET ISTP TO 1.

           IF SP-INS-RATE-FILE(REB-INSSUB)
              GO TO REBATE-FIND-INS-TABLE.

           IF NOT SP-TABLE-ROUND-UP(REB-INSSUB)
              GO TO REBATE-FIND-INS-RATE-INTERPO.
      *--------------------------------------
      *    FIND INSURANCE RE: NEXT HIGH
      *--------------------------------------
           SEARCH SP-INSRATETBL
                  END GO TO REBATE-FIND-INS-RATE-EXIT
             WHEN SP-INSTERM (REB-INSSUB,ISTP) NOT < REB-REMTERM
                  NEXT SENTENCE.

             MOVE SP-INSRATE(REB-INSSUB ISTP) TO REB-HUNDREDS
                                                 REB-MANYDECIMALS.
             GO TO REBATE-FIND-INS-RATE-EXIT.

      *--------------------------------------
      *    FIND INSURANCE RE: INTERPOLATION
      *--------------------------------------
       REBATE-FIND-INS-RATE-INTERPO.
           SEARCH SP-INSRATETBL
                 END GO TO REBATE-FIND-INS-RATE-EXIT
              WHEN SP-INSTERM(REB-INSSUB ISTP) = REB-REMTERM
                 MOVE SP-INSRATE(REB-INSSUB ISTP) TO REB-HUNDREDS
                                                     REB-MANYDECIMALS
              WHEN SP-INSTERM(REB-INSSUB ISTP) > REB-REMTERM
                 PERFORM REBATE-FIND-INS-RATE-COMPUTE.
           GO TO REBATE-FIND-INS-RATE-EXIT.

       REBATE-FIND-INS-TABLE.

           MOVE REB-REMTERM TO IRREBT-REMTERM.
           MOVE REB-INSSUB TO IRREBT-INSSUB.
           MOVE 0 TO IRREBT-MANYDECIMALS.
           MOVE "CL/IRREBT" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH REB-COMMON LN-REC SP-REC.
           CANCEL FORM-PROGX.

           MOVE IRREBT-MANYDECIMALS TO REB-MANYDECIMALS REB-HUNDREDS.
           GO TO REBATE-FIND-INS-RATE-EXIT.

       REBATE-FIND-INS-RATE-COMPUTE.
           IF ISTP = 1
              COMPUTE REB-MANYDECIMALS ROUNDED =
                 SP-INSRATE(REB-INSSUB 1) / SP-INSTERM(REB-INSSUB 1)
                                                      * REB-REMTERM
           ELSE
              COMPUTE REB-MANYDECIMALS ROUNDED =
                 (SP-INSRATE(REB-INSSUB ISTP) -
                                  SP-INSRATE(REB-INSSUB ISTP - 1)) /
                 (SP-INSTERM(REB-INSSUB ISTP) -
                                  SP-INSTERM(REB-INSSUB ISTP - 1)) *
                 (REB-REMTERM - SP-INSTERM(REB-INSSUB ISTP - 1))
                                + SP-INSRATE(REB-INSSUB ISTP - 1).
           MOVE REB-MANYDECIMALS TO REB-HUNDREDS.

       REBATE-FIND-INS-RATE-EXIT.
           EXIT.

       REBATE-DEDUCT-CHARGE SECTION.
           IF REB-ADDON-FG = "Y" AND REB-SUB = 7
              MOVE 0 TO REB-DEDCHG
              GO TO REBATE-DEDUCT-CHARGE-EXIT.

           MOVE SP-RBDEDCHG(REB-SUB) TO REB-DEDCHG.

           IF REB-DEDCHG = 9999.01
              COMPUTE REB-DEDCHG ROUNDED =
                            (LN-CURBAL - LN-OT2BAL) * 0.1
              IF REB-DEDCHG > 25.00
                 MOVE 25.00 TO REB-DEDCHG
              ELSE
                 MOVE 0 TO REB-DEDCHG
           ELSE
              IF REB-DEDCHG = 9999.02
                 COMPUTE REB-HALF-ORGTERM = REB-ORGTERM / 2
                 IF REB-REMTERM NOT < REB-HALF-ORGTERM
                    MOVE 25.00 TO REB-DEDCHG
                 ELSE
                    MOVE 0 TO REB-DEDCHG
              ELSE
                 IF REB-DEDCHG = 9999.03
                    MOVE 25.00 TO REB-DEDCHG
                 ELSE
      * 9999.04  IF MORE THAN HALF THE TERM HAS ELAPSED, THE REBATE SHALL
      *          BE COMPUTED WITHOUT DEDUCTING THE PRECHARGE. (WORLD)
      * JUST LIKE 9999.02 EXCEPT NEEDS A DECIMAL ON HALF-ORGTERM
      * 2/17/99 ADDED DECIMAL TO REB-HALF-ORGTERM-DEC FOR THE FOLLOWING EXAMPLE
      * TERM = 9     REMAINING = 4  ELAPSED = 5  HALF = 4.5
      * WITHOUT THE DECIMAL, THIS EXAMPLE TOOK THE 25.00 AND SHOULDN'T
      * TERM = 8     REMAINING = 4  ELAPSED = 4  HALF = 4
      * THIS EXAMPLE TAKES THE 25.00 LIKE IT SHOULD
                   IF REB-DEDCHG = 9999.04
                      COMPUTE REB-HALF-ORGTERM-DEC = REB-ORGTERM / 2
                      IF REB-REMTERM NOT < REB-HALF-ORGTERM-DEC
                         MOVE 25.00 TO REB-DEDCHG
                      ELSE
                         MOVE 0 TO REB-DEDCHG
                   ELSE
                      IF REB-DEDCHG = 9999.05
                         MOVE 30.00 TO REB-DEDCHG.


       REBATE-DEDUCT-CHARGE-EXIT.
           EXIT.

      ******************************************************************
      * EARLY PROVISION FOR ACQUISITION CHARGES - OKLAHOMA    (REQ #163)
      *
      *   1/60TH FOR EACH DAY FROM DATE OF PREPAYMENT TO THE SIXTIETH
      *   DAY OF LOAN (PRO RATA)
      ******************************************************************
       REBATE-RBEARLY-21 SECTION.
           MOVE LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF ELAPSED-DAYS < 60
      *       ----------------------------------------------------------
      *       REBATE = UNELAPSED DAYS
      *                * ( SERVICE CHARGE - DEDUCT PRECHARGE ) / 60
      *       ----------------------------------------------------------
              PERFORM REBATE-DEDUCT-CHARGE
              COMPUTE REB-REBATE ROUNDED =
                      ( 60 - ELAPSED-DAYS )
                        * ( REB-TOTCHG - REB-DEDCHG ) / 60
           ELSE
      *       ----------------------------------------------------------
      *       IF MORE THAN 60 DAYS HAVE ELAPSED THEN THERE IS NO REFUND
      *       ----------------------------------------------------------
              MOVE 0 TO REB-REBATE.

       REBATE-RBEARLY-21-EXIT.
           EXIT.

      ******************************************************************
      * EARLY PROVISION FOR SERVICE CHARGE ILLINOIS WORLD PR#733
      *
      *   1/60TH FOR EACH DAY FROM DATE OF PREPAYMENT TO THE SIXTIETH
      *   DAY OF LOAN (PRO RATA)
      ******************************************************************
       REBATE-RBEARLY-26 SECTION.
           MOVE LN-LOANDATE TO NUM-DATE.
           MOVE REB-PAYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF REB-LPTRCD = "PO"
              IF ELAPSED-DAYS < 60
      *       ----------------------------------------------------------
      *       REBATE = UNELAPSED DAYS
      *                * ( SERVICE CHARGE - DEDUCT PRECHARGE ) / 60
      *       ----------------------------------------------------------
                   PERFORM REBATE-DEDUCT-CHARGE
                   COMPUTE REB-REBATE ROUNDED =
                        ( 60 - ELAPSED-DAYS )
                         * ( REB-TOTCHG - REB-DEDCHG ) / 60
              ELSE
      *       ----------------------------------------------------------
      *       IF MORE THAN 60 DAYS HAVE ELAPSED THEN THERE IS NO REFUND
      *       ----------------------------------------------------------
                   MOVE 0 TO REB-REBATE
           ELSE
               MOVE 0 TO REB-REBATE.

       REBATE-RBEARLY-26-EXIT.
           EXIT.

      ********************************************************************
      * CHECK TO SEE IF THE THE INSURANCE IN QUESTION WAS PUT ON AS AN
      * ADDON OR AS PART OF THE ORIGINAL LOAN.
      * IF NO LT INS RECORDS EXIST THEN IT WAS PUT ON WITH THE LOAN ELSE IT
      * WAS ADDED, ADJUSTED, CANCELLED AFTER THE LOAN WAS BOOKED.
      * 71105#0918
      ********************************************************************
       REBATE-CHECK-ADDON-TRAILER SECTION.
      * OTHER PARTS OF REBATE EXPECT LT-REC TO BE INTACT, SAVE HERE TO NOT
      * DISRUPT OTHER USES.
           MOVE LTI-REC TO REB-HOLD-LTI-REC.
           PERFORM OPEN-LTI1-FILE.
           MOVE 0 TO LTI-SEQNO.
           MOVE "N" TO REB-LTI-ADDON-FG.
           EVALUATE REB-SUB
      * CL
               WHEN 1 MOVE 1 TO REB-TEST-LTI-TYPE
               WHEN 2 MOVE 1 TO REB-TEST-LTI-TYPE
               WHEN 3 MOVE 1 TO REB-TEST-LTI-TYPE
               WHEN 4 MOVE 1 TO REB-TEST-LTI-TYPE
      * AH
               WHEN 5 MOVE 2 TO REB-TEST-LTI-TYPE
      * PP
               WHEN 6 MOVE 3 TO REB-TEST-LTI-TYPE
               WHEN 11 MOVE 3 TO REB-TEST-LTI-TYPE
      * 01-05
               WHEN 12 MOVE 4 TO REB-TEST-LTI-TYPE
               WHEN 13 MOVE 5 TO REB-TEST-LTI-TYPE
               WHEN 14 MOVE 6 TO REB-TEST-LTI-TYPE
               WHEN 15 MOVE 7 TO REB-TEST-LTI-TYPE
               WHEN 16 MOVE 8 TO REB-TEST-LTI-TYPE
               WHEN OTHER GO TO REBATE-CHECK-ADDON-TRAILER-EXIT
           END-EVALUATE.
       REBATE-CHECK-ADDON-TRAILER-NEXT.
           MOVE LN-ACCTNO TO LTI-ACCTNO.
           ADD 1 TO LTI-SEQNO.
           PERFORM READ-LTI1-FILE.
           IF IO-BAD
              GO TO REBATE-CHECK-ADDON-TRAILER-EXIT
           ELSE
              IF LTI-INS-TYPE = REB-TEST-LTI-TYPE
                 MOVE "Y" TO REB-LTI-ADDON-FG
              END-IF
              GO TO REBATE-CHECK-ADDON-TRAILER-NEXT
           END-IF.
       REBATE-CHECK-ADDON-TRAILER-EXIT.
           PERFORM CLOSE-LTI1-FILE.
           MOVE REB-HOLD-LTI-REC TO LTI-REC.

      *-----------------------------------------------------------------------
      *    DUMMY SECTION TO INCLUDE IN COPY MEMBERS THAT NEED TO BE
      *    REFLECTED IN 'WHAT' COMMANDS FOR SUPPORT
      *-----------------------------------------------------------------------
       SCCS-COPY-ROUTINE SECTION. MOVE
           "@(#)./LIBGB/REBATE.CPY S35 >"
              TO MESS.

      *-----------------------------------------------------------------------
      *================================================================*
      * END COPYBOOK: LIBGB\REBATE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPOFF.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPOFF
      ***************************************************************
      *         COMPUTE PAYOFF FIGURES FOR A LOAN
      *                (AS OF A CURRENT DATE)
      *
      *   NAME: LPPOFF
      *   DESC: THIS ROUTINE IS USED TO COMPUTE THE
      *         PAYOFF FIGURES FOR LOAN PAYOFF. IT WILL
      *         YIELD THE FOLLOWING FIGURES:
      *
      *         -----------------------------------------------
      *         REMEMBER TO CHANGE FAPOFF ALSO
      *
      *         NOTE:
      *              THIS ROUTINE IS FOR ANY PROGRAM
      *              E X E C P T  LONPFA.C
      *         -----------------------------------------------
      *         ROUTINE   A U T O  C O P I E S   'LIBLP/MIPPO'
      *         -----------------------------------------------
      *
      *   IN  : POFF-PAYDATE                 DATE OF PAYMENT
      *         POFF-MAKERCD                 LN-MAKERCD(X)
      *         POFF-LPTRCD                  TO REFLECT THE TYPE OF PAYOFF
      *         POFF-LONPFA-UPD-FG           (NOT REQUIRED FOR THIS COPY MEMBER
      *                                       SEE LIBLP/FAPOFF)
      *         POFF-DEF-STOP           SET TO 'Y' WHEN STOPS ARE
      *                                      NECESSARY ON DEFERMENTS
      *         POFF-RECAST-FG               TO ALLOW SP-RBRECAST() = 1 TO
      *                                      PERFORM A RECAST OF INTEREST REFUND
      *                                      DEFAULT VALUE " "
      *         POFF-LCAP-BATCH-REFCD        SET FROM ROUTINES THAT POST BATCH
      *                                      PAYMENTS
      *         POFF-LCAP-BATCH-REFCD-LC-FG  SET FROM ROUTINES THAT POST BATCH
      *                                      PAYMENTS
      *
      *   OUT : POFF-REBATE(1)          CL REBATE
      *                    (2)          AH REBATE
      *                    (3)          PP REBATE
      *                    (4)          INT REBATE
      *                    (5)          SRV REBATE
      *                    (6)          FEE REBATE
      *                    (7)          DEF REBATE
      *                    (8)          N/A REBATE
      *                    (9)          OT1 REBATE
      *                    (10)         OT2 REBATE
      *                    (11)         OT3 REBATE
      *                    ----
      *                    (12)         OT4 REBATE
      *                    (13)         OT5 REBATE
      *         POFF-INS-TAX-RB(1)      CL REBATE INS TAX
      *                        (2)      AH REBATE INS TAX
      *                        (3)      PP REBATE INS TAX
      *                        (4)      O1 REBATE INS TAX
      *                        (5)      O2 REBATE INS TAX
      *                        (6)      O3 REBATE INS TAX
      *                        ----
      *                        (7)      O4 REBATE INS TAX
      *                        (8)      O5 REBATE INS TAX
      *         POFF-INT-REB-TBL(1)     CL ADDON INTEREST REBATE.
      *                         (2)     AH ADDON INTEREST REBATE.
      *                         (3)     PP ADDON INTEREST REBATE.
      *                         (4)     O1 ADDON INTEREST REBATE.
      *                         (5)     O2 ADDON INTEREST REBATE.
      *                         (6)     O3 ADDON INTEREST REBATE.
      *                         (7)     O4 ADDON INTEREST REBATE.
      *                         (8)     O5 ADDON INTEREST REBATE.
      *         POFF-OTDUE              OTHER CHARGES DUE
      *         POFF-LCDUE              LATE CHARGES DUE
      *         POFF-INTDUE             INTEREST DUE
      *         POFF-NETDUE             NET PAYOFF AMOUNT DUE
      *         POFF-PARTIALS           (FROM LPLCAP)
      *         POFF-LCPAID             (FROM LPLCAP)
      *  NOT USED YET
      *         POFF-NOLCHG             (FROM LPLCAP)
      *         POFF-ADDON-INT-EARNED   FOR LONPFA.C
      *         POFF-ADDON-INT-REBATE   FOR LONPFA.C
      *         POFF-LXM-MIP-CLPAID
      *         POFF-LXM-MIP-AHPAID
      *         POFF-LXM-MIP-CLPDTH-DATE
      *         POFF-LXM-MIP-AHPDTH-DATE
      *   USED:
      *   COPY: LPPOF2, DATERW, DATER, LPRATEW, REBATE, REBATEW
      *         LPLCAP, LPLCAPW, LPINDU, LPINDUW, LPIBPC, LPIBPCW
      *         LPAPRSW, LPAPRS, ADDONSPR, LPMDTEW, LPMDTE,
      *         LPITRMW, LPITRM, LPAMTSW, LPAMTS, LPAPRZW, LPAPRZ,
      *         LPUPERW, LPUPER, LPLCASW, LPLCAS, LPLCHGW, LPLCHG,
      *         SETCTBLW, SETCTBL, LPUPWKW, LPUPWK, RBCATW, RBCAT,
      *         SPPDTHW, SPPDTH, LPXDTE2, LPXDTE, LPSCHDW, LPSCHD,
      *
      * REV :
      *  040188 JTG ADDED MOVE OF LPTRCD TO INDU-LPTRCD
      *  052088 JTG ADDED POFF-PARTIALS & POFF-LCPAID
      *             FOR LONPFA.C TO PASS TO LONPF2.C.
      *  083188 SLC ADDED POFF-REBATE 9 - 10.
      *  103188 JTG CORRECTED LOGIC FOR 9 - 10
      *             CHANGED TO SKIP ROUITNE IF CURBAL = 0
      *  030389 JTG OPENED UP LOGIC FOR DEFERMENT REBATES
      *             TO BE INCLUDED IN PAYOFF
      *  102489 JTG PASSED INT REBATE TO REBATE ROUTINE FOR SERCHG
      *  011890 JTG ADDED TEST FOR SP-RBMIN(7) = 999.01 (GA)
      *  022090 SLC FIXED TEST FOR GEORGIA MIN REBATE ON INTEREST
      *             WAS NOT ADDING REBATE TO NET DUE BEFORE 0'ING IT
      *  032990 BAH FIXED TEST FOR RBCOMCD 'A' MINIMUM 1.00 WAS
      *             NOT ADDING REBATE TO NET DUE BEFORE 0'ING IT
      *  072590 JTG SET LCAP-LPAPLC AND LCAP-LPAPINT
      *  012991 JTG OPENED UP ABILITY FOR CL,AH,PP WRITTEN AFTER BOOKING
      *  072391 SLC NOW SETS INTEREST IF PRECOMP IN CASE THERE IS
      *             SOMETHING IN INTBAL. WAS CAUSING PAYOFF TO LEAVE
      *             SOMETHING IN CURBAL.
      *  072591 JTG CHANGED TO WORK WITHOUT LOGIC FOR LONPFA.C
      *  070192 JTG CHANGED TO USE LT-ANTIC-START-DATE AND NOT
      *             LT-INSEFF FOR INTEREST ADDON REBATES
      *  082292 JTG MODIFIED TO SET REB-LN(FIELDS) FOR ADDON
      *                 INTEREST ACTUARIAL REFUND
      *  083192 JTG STOPPED ADDON INT. REBATE FROM EXCEEDING ORG CHG
      *  100992 JTG CORRECTED TO SET REB-LN(FIELDS) FOR ADDON
      *                 INTEREST ACTUARIAL REFUND
      *  071896 JTG ADDED LOGIC FOR UNIT PERIODS
      *  051597 MJD ADDED POFF-INT-REB-TABLE. MOVED PAYOFF-INT-ADDONS
      *             TO LPPOF2 SO THAT IT CAN BE CALLED FROM LONPG7.C.
      *  052097 JTG ADDED 'LIBLP/ADDONSPR' TO GET CORRECT SPR RE: INS RB
      *  060397 JTG ADDED LOGIC FOR 'O3' REBATE (R3)
      *  061897 JTG CHANGED TO CLEAR POFF-INSEFF-TEST & POFF-INSEXP-TEST
      *  111197 BAH FIXED BUG REGARDING REB-SUB2 WHEN GETTING ADDON SPR'S
      *  010598 JTG MOVE OF POFF-RECAST-FG TO REB-RECAST RE: IDEAL A48 TO A60
      *  042798  CS ADDED TEST OF "RB" AND "RO"
      *  072898 JTG ADDED POFF-O2DUE RE: RENEWAL O2 MONIES MERCURY #192
      *  050198 MJD ADDED LOGIC FOR "RB" AND "RO" TRANSACTION/SOURCE CODES
      *  082698 JTG ALLOWED REFUND OF SERVICE CHARGE ON IB LOAN TYPES
      *  990826 JTG ADDED SCCS-COPY-ROUTINE
      *  MJD 000119 ADDED POFF-TOTNOLCHG (WORLD PR#218)
      *             NOT YET USED. MUST BE ENABLED BEFORE WORLD GOES TO A15
      *  BAH 000124 ADDED SP-RBCOMCD "B" FOR REGENCY PR# 1048 TO TEST CL&AH
      *             MINIMUM OF $10.00 FOR "PA"
      *  JTG 000822 ADDED LOGIC FOR KENTUCKY 60 DAY NO CHARGE LAW, ADDED
      *             SP-RBSPOPT1() = 19, WORLD #233
      *  JTG 010919 ADDED LOGIC FOR PAYOFF ON SP-CAL-RATETYPE(Z)LENDMARK PR#1045
      *  JTG 020307 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *             ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS
      *             ADDED  FOR POFF-INS-TAX OCCURS 8              WORLD #288
      *  JTG 020402 CHANGED POFF-INS-TAX TO POFF-INS-TAX-RB       WORLD #288
      *  JTG 020801 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *  JTG 020927 SET THE FOLLOWING FIELDS FOR ADDON ACCOUNTS    MULLEN  #
      *             JGMULL  MOVE LN-LASTPYAMT  TO REB-LN-LASTPYAMT
      *             JGMULL  MOVE LN-APRATE     TO REB-LN-APRATE
      *             JGMULL  MOVE LN-SMPRATE    TO REB-LN-SMPRATE
      *  JTG 021220 ADDED POFF-LCAP-BATCH-REFCD POFF-LCAP-BATCH-REFCD-LC-FG
      *             ADDED NEW CODE FILE TYPE 'BR'-BATCH PAYMENT REFERENCE CODES
      *             BATCH PAYMENT REVISIONS                        REGACC #0006
      *  JTG 030129 ADDED LOGIC FOR REBATES ON ACCOUNTS CONVERTED FOR
      *             ALABAMA WITH ADDON INSURANCE THAT WAS NOT CONVERTED
      *             AS AN ADDON. THE LOGIC IS DEFAULTING TO LOAN DATE
      *             AND NOT INSURANCE EFFECTIVE DATE                    WORLD
      *  JTG 030305 ALLOW RBFRMLA '8' TO WORK FOR 'AH' & 'ALL COMPUTABLE INS'
      *                                                         PACESETTER #2012
      *  JTG 040913 ADDED NEW FIELDS FOR SP-RBFRMLA (0 D)
      *             RULE 78THS USING DAYS IN TERM AND ELAPSED DAYS INSTEAD
      *             OF UNIT PERIODS IN TERM AND ELAPSE UNIT PERIODS REGACC #0074
      *  BAH 050714 CALCULATE MIP MONTHLY INSURANCE ON RENEWALS, REGWAN PL# 499
      *  JTG 050714 ADDED NEW FORMULAS FOR MEXICO
      *             SP-MFFRMLA-05 SP-RBFRMLA2 (G) SP-ERNFRMLA (24)   WORLD #0408
      *  JTG 070426 REMOVED ADDED LOGIC FOR REBATES ON ACCOUNTS CONVERTED FOR
      *             ALABAMA WITH ADDON INSURANCE THAT WAS NOT CONVERTED
      *             AS AN ADDON. THE LOGIC IS DEFAULTING TO LOAN DATE
      *             AND NOT INSURANCE EFFECTIVE DATE            WORLD JWR BARB
      * MJD 080623 ADDED LOGIC FOR MEXICO:
      *             IF MFFRMLA "5" AND RBFRMLA "0G" THEN USE
      *             MFFEE AMOUNT ON PAGE 6 OF LOAN MAINT.   SOME LOANS
      *             COULD CAUSE MONTHLY MAINT FEE TO BE 0 (ZERO) DUE
      *             TO TRUNCATION OF SIG DIGITS (I.E. 300.00 BECOMES 00.00).
      * MJD 091016 ADDED LOGIC TO ALLOW CALCULATION OF MFEE REBATES ON IB
      *             ACCOUNTS.                                   WORLD PR#590
      * BAH 110307 ADDED SP-RBCOMCD "C" FOR REGENCY PR# 3743 TO TEST CL&AH
      *             MINIMUM OF $5.00
      * BAH 130115 ADDED SP-RBSPOPT1 27 FOR "CA" EARLY MULLEN PR# 4182
      * MJD 160223 ADDED LOGIC TO UPDATE POFF-LXR-REB-AMT FOR GA EARLY PROVISION
      *                                                           REGMGT PR#4915
      * BAH 2018.07.02 ADDED ADDONSPRW AND SET ADDONSPR-SUB, DONT SHARE
      *                REBATEW WORKERS ANYMORE!
      * BAH 0517.2023 DISABLED CALIFORNIA IB RECASTING FORMULA 2 (RCASTC) KM
      **************************************************************************
       PAYOFF-LOAN-ROUTINE SECTION.
           MOVE 0 TO POFF-REBATE(1)  POFF-REBATE(2)
                     POFF-REBATE(3)  POFF-REBATE(4)
                     POFF-REBATE(5)  POFF-REBATE(6)
                     POFF-REBATE(7)  POFF-REBATE(8)
                     POFF-REBATE(9)  POFF-REBATE(10)
                     POFF-REBATE(11) POFF-REBATE(12)
                     POFF-REBATE(13)
                     POFF-INS-TAX-RB(1) POFF-INS-TAX-RB(2)
                     POFF-INS-TAX-RB(3) POFF-INS-TAX-RB(4)
                     POFF-INS-TAX-RB(5) POFF-INS-TAX-RB(6)
                     POFF-INS-TAX-RB(7) POFF-INS-TAX-RB(8)
                     POFF-O2DUE
                     POFF-OTDUE     POFF-LCDUE
                     POFF-INTDUE    POFF-NETDUE
                     POFF-PARTIALS  POFF-LCPAID.
           MOVE 0 TO POFF-ADDON-INT-EARNED
                     POFF-ADDON-INT-REBATE.
           MOVE 0 TO POFF-INT-REB-TBL(1)  POFF-INT-REB-TBL(5)
                     POFF-INT-REB-TBL(2)  POFF-INT-REB-TBL(6)
                     POFF-INT-REB-TBL(3)  POFF-INT-REB-TBL(7)
                     POFF-INT-REB-TBL(4)  POFF-INT-REB-TBL(8).
           MOVE 0 TO POFF-LXM-MIP-CLPAID
                     POFF-LXM-MIP-AHPAID
                     POFF-LXM-MIP-CLPDTH-DATE
                     POFF-LXM-MIP-AHPDTH-DATE
                     POFF-LXR-REB-AMT.

           MOVE POFF-RECAST-FG TO REB-RECAST.
           MOVE SPACES TO POFF-COMMON-RTNCD POFF-COMMON-AREA.
           MOVE 0 TO POFF-COMMON-INTADJ.

           IF LN-CURBAL = 0
              GO TO PAYOFF-EXIT.

      *******************************************************
      *    CLEAR REBATE WORKERS FOR MEXICO SP-RBFRMLA2 0G
      *******************************************************

      ************************************************
      *    COMPUTE LATE CHARGES AND INTEREST OWING:
      ************************************************
           MOVE 0 TO REB-LN-INT-REBATE
                     REB-LN-SC-REBATE
                     REB-LN-MF-REBATE
                     REB-LN-DF-REBATE.

      * SET IB-PC FLAG:
           MOVE POFF-PAYDATE TO IBPC-DATE.
           PERFORM IBPC-TEST.

      * NOTE: LN-OT2BAL IS INCLUDED IN LN-CURBAL.
           MOVE LN-OT2BAL TO POFF-O2DUE.
           MOVE LN-OTHBAL TO POFF-OTDUE.
           ADD LN-CURBAL LN-OTHBAL LN-INTBAL LN-LCBAL
                                         GIVING POFF-NETDUE.

      * DETERMINE IF MIP INSURANCE PREMIUMS ARE DUE
      
           IF LN-MIP-FG = "Y"
              IF POFF-LPTRCD = "PO" OR "PB" OR "RN" OR "SC" OR
                               "RB" OR "RO"
                 PERFORM DETERMINE-MIP-REQUIRED
                 ADD POFF-LXM-MIP-CLPAID
                     POFF-LXM-MIP-AHPAID TO POFF-NETDUE.

      * COMPUTE INTEREST DUE IF IB:
           IF IBPC-FG = "I" AND LN-LOANTYPE = "P"
              MOVE LN-LCBAL TO POFF-LCDUE
              PERFORM PAYOFF-SET-INT-CHARGES
           ELSE
      * COMPUTE LATE CHARGES IF P/C AND NOT EXPIRING:
           IF IBPC-FG = "P" AND IBPC-EXPIRED-FLAG = " "
              PERFORM PAYOFF-SET-INT-CHARGES
              PERFORM PAYOFF-SET-LATE-CHARGES.

      * COMPUTE LATE CHARGES AND INTEREST IF P/C AND EXPIRING:
           IF (IBPC-FG = "P" AND IBPC-EXPIRED-FLAG = "E") OR
              (LN-LOANTYPE = "I")
              PERFORM PAYOFF-SET-LATE-CHARGES
              PERFORM PAYOFF-SET-INT-CHARGES.

      *********************************************
      *    COMPUTE FINANCE CHARGE REBATES:
      *********************************************

      * COMPUTE INTEREST REBATE IF (PC):

           IF IBPC-FG = "P"
              IF LN-INT-REBATE = " " OR = "C"
                 MOVE 7 TO REB-SUB
                 MOVE LN-INTCHG  TO REB-TOTCHG
                 MOVE LN-ORGTERM TO REB-ORGTERM
                 PERFORM PAYOFF-GET-REBATE
                 MOVE REB-REBATE TO POFF-REBATE(4)
                                    REB-LN-INT-REBATE
                 IF LN-ADDON-FG = "Y"
                    MOVE 0 TO POFF-INSEFF-TEST
                              POFF-INSEXP-TEST
                    PERFORM PAYOFF-INT-ADDONS
                    ADD POFF-ADDON-INT-REBATE TO POFF-REBATE(4)
                    SUBTRACT POFF-ADDON-INT-REBATE FROM POFF-NETDUE.

      * COMPUTE SERVICE REBATE IF (PC):

           PERFORM PAYOFF-SERCHG-REBATE.

      * TEST FOR GEORGIA MIN REBATE ON INTEREST:
           IF SP-RBMIN(7) = 999.01
              IF POFF-REBATE(5) = 0
                 IF POFF-REBATE(4) < 1.00
                    ADD POFF-REBATE(4) TO POFF-NETDUE
                    MOVE 0 TO POFF-REBATE(4).

      * COMPUTE MAINT FEE REBATE IF (PC):
      * ADDED LOGIC FOR MEXICO: IF MFFRMLA "5" AND RBFRMLA "0G" THEN USE
      *       MFFEE AMOUNT ON PAGE 6 OF LOAN MAINT.   SOME LOANS
      *       COULD CAUSE MONTHLY MAINT FEE TO BE 0 (ZERO) DUE
      *       TO TRUNCATION OF SIG DIGITS (I.E. 300.00 BECOMES 00.00).
           IF IBPC-FG = "P" OR
                        (IBPC-FG = "I" AND GP-ALLOW-MF-ON-IB = "Y")
              IF SP-MFFRMLA-05 AND
                    SP-RBFRMLA(9)  = "0" AND
                       SP-RBFRMLA2(9)  = "G" AND
                          LN-ANTICERN(4) NOT = 0
                 IF LN-MF-REBATE = " " OR = "C"
                    MOVE 9 TO REB-SUB
                    COMPUTE REB-TOTCHG = LN-ANTICERN(4) * LN-ORGTERM
                    MOVE LN-ORGTERM TO REB-ORGTERM
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE TO POFF-REBATE(6)
                 END-IF
              ELSE
              IF LN-MAINTFEE NOT = 0
                 IF LN-MF-REBATE = " " OR = "C"
                    MOVE 9 TO REB-SUB
                    COMPUTE REB-TOTCHG = LN-MAINTFEE * LN-ORGTERM
                    MOVE LN-ORGTERM TO REB-ORGTERM
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE TO POFF-REBATE(6).

      * COMPUTE DEFERMENT REBATE IF (PC):
           IF IBPC-FG = "P"
              IF LN-TOTDEF NOT = 0
                 IF LN-DF-REBATE = " " OR = "C"
                    MOVE 10 TO REB-SUB
                    MOVE LN-TOTDEF TO REB-TOTCHG
                    MOVE LN-ORGTERM TO REB-ORGTERM
                    MOVE POFF-DEF-STOP TO REB-DEF-STOP
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE TO POFF-REBATE(7).

      *********************************************
      *    COMPUTE INSURANCE REBATES:
      *********************************************

      * CLEAR ITRM-TODAY SO INSURANCE INEFFECT WON'T
      * BE CALCULATED IN LPITRM.
           MOVE 0 TO ITRM-TODAY.

           IF LN-INSURED = "N"
              GO TO PAYOFF-OTHER-INS.

      * COMPUTE CREDIT LIFE REBATE:
           IF LN-CL-REBATE NOT = "Y"
              IF LN-INSPREM(1) NOT = 0
                 IF LN-INSOURS(1) NOT = "M"
                    PERFORM PAYOFF-SET-CL-REBSUB
                    MOVE LN-INSPREM(1) TO REB-TOTCHG
                    MOVE 1 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 1 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(1)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(1).

      * COMPUTE ACCIDENT HEALTH REBATE:
           IF LN-AH-REBATE NOT = "Y"
              IF LN-INSPREM(2) NOT = 0
                 IF LN-INSOURS(2) NOT = "M"
                    MOVE 5 TO REB-SUB
                    MOVE LN-INSPREM(2) TO REB-TOTCHG
                    MOVE 2 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 2 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(2)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(2).


      * TEST REBATE COMBINED CL/AH CODE:
           IF SP-RBCOMCD NOT = "A" AND NOT = "B" AND NOT = "C"
              GO TO PAYOFF-PP-INSURANCE.

      * TEST FOR SP-RBSPOPT1 = 2 FOR REBATE TO THE PENNY:
           PERFORM PAYOFF-SET-CL-REBSUB.
           IF SP-RBSPOPT1(REB-SUB) = 2 OR SP-RBSPOPT1(5) = 2
              IF POFF-LPTRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
                 GO TO PAYOFF-PP-INSURANCE.

           IF SP-RBCOMCD = "A"
              IF (POFF-REBATE(1) + POFF-REBATE(2)) < 1.00
                 ADD POFF-REBATE(1) POFF-REBATE(2) TO POFF-NETDUE
                 MOVE 0 TO POFF-REBATE(1) POFF-REBATE(2).
           IF SP-RBCOMCD = "B"
              IF (POFF-REBATE(1) + POFF-REBATE(2)) < 10.00
                 ADD POFF-REBATE(1) POFF-REBATE(2) TO POFF-NETDUE
                 MOVE 0 TO POFF-REBATE(1) POFF-REBATE(2).
           IF SP-RBCOMCD = "C"
              IF (POFF-REBATE(1) + POFF-REBATE(2)) < 5.00
                 ADD POFF-REBATE(1) POFF-REBATE(2) TO POFF-NETDUE
                 MOVE 0 TO POFF-REBATE(1) POFF-REBATE(2).

        PAYOFF-PP-INSURANCE.
      * COMPUTE PERSONNEL PROPERTY REBATE:
           IF LN-PP-REBATE NOT = "Y"
              IF LN-INSPREM(3) NOT = 0
                 IF LN-INSOURS(3) NOT = "M"
                    MOVE 6 TO REB-SUB
                    MOVE LN-INSPREM(3) TO REB-TOTCHG
                    MOVE 3 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 3 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(3)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(3).

       PAYOFF-OTHER-INS.
      * COMPUTE OTHER 1 INSURANCE REBATE:
           IF LN-O1-REBATE NOT = "Y"
              IF LN-INSPREM(4) NOT = 0
                 IF LN-INSOURS(4) NOT = "M"
                    MOVE 12 TO REB-SUB
                    MOVE LN-INSPREM(4) TO REB-TOTCHG
                    MOVE 4 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 4 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(9)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(4).


      * COMPUTE OTHER 2 INSURANCE REBATE:
           IF LN-O2-REBATE NOT = "Y"
              IF LN-INSPREM(5) NOT = 0
                 IF LN-INSOURS(5) NOT = "M"
                    MOVE 13 TO REB-SUB
                    MOVE LN-INSPREM(5) TO REB-TOTCHG
                    MOVE 5 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 5 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(10)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(5).

      * COMPUTE OTHER 3 INSURANCE REBATE:
           IF LN-O3-REBATE NOT = "Y"
              IF LN-INSPREM(6) NOT = 0
                 IF LN-INSOURS(6) NOT = "M"
                    MOVE 14 TO REB-SUB
                    MOVE LN-INSPREM(6) TO REB-TOTCHG
                    MOVE 6 TO ITRM-SUB
                    PERFORM INS-TERM-CALCULATION
                    MOVE ITRM-INSTERM TO REB-ORGTERM
                    IF LN-ADDON-FG = "Y"
                       MOVE 6 TO POFF-SUB
                       PERFORM PAYOFF-SET-ADDON-INS
                    END-IF
                    PERFORM PAYOFF-GET-REBATE
                    MOVE REB-REBATE  TO POFF-REBATE(11)
                    MOVE INS-TAX-RB TO POFF-INS-TAX-RB(6).

       PAYOFF-EXIT.
           EXIT.

      ****************************************
      *    SETUP FOR INSURANCE ADDON REFUND
      ****************************************
       PAYOFF-SET-ADDON-INS SECTION.
           MOVE LN-INSEFF-DATE(POFF-SUB) TO REB-LN-LOANDATE
                                       REB-LN-PURDATE
                                       REB-LN-INTDATE
                                       REB-LN-INSEFF
                                       NDTE-DATE.
           MOVE LN-INSEXP-DATE(POFF-SUB) TO REB-LN-INSEXP.

           MOVE 1           TO NDTE-HOLD.
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE            TO REB-LN-ORIG-1STPYDATE.
           MOVE REB-ORGTERM          TO REB-LN-ORGTERM.
           MOVE LN-REGPYAMT          TO REB-LN-REGPYAMT.
           MOVE LN-LASTPYAMT         TO REB-LN-LASTPYAMT.
           MOVE LN-APRATE            TO REB-LN-APRATE.
           MOVE LN-SMPRATE           TO REB-LN-SMPRATE.
           MOVE 0                    TO REB-LN-TOTNODEF.
           MOVE LN-INSCOVR(POFF-SUB) TO REB-LN-INSCOVR.
           MOVE "N"                  TO REB-LN-SALEFIN.
           MOVE "Y"                  TO REB-ADDON-FG.

      ****************************************
      *    SET REB-SUB FOR CREDIT LIFE REBATE
      ****************************************
       PAYOFF-SET-CL-REBSUB SECTION.
      * TEST FOR SINGLE OR JOINT LIFE:
           IF LN-INSURED = "J"
              MOVE 2 TO REB-SUB
            ELSE
              MOVE 1 TO REB-SUB.
      * TEST FOR LEVEL LIFE:
           IF LN-INSTYPES-LL
              ADD 2 TO REB-SUB.

      **************************************************
      *    GET ALL LATE CHARGES DUE THRU PAYOFF DATE:
      **************************************************
       PAYOFF-SET-LATE-CHARGES SECTION.
           MOVE POFF-PAYDATE                TO LCAP-PAYDATE.
           MOVE LN-1STPYDATE                TO LCAP-1STPYDATE.
           MOVE "AL"                        TO LCAP-LPTRCD.
           MOVE POFF-LPTRCD                 TO LCAP-POFF-LPTRCD.
           MOVE POFF-LCAP-BATCH-REFCD       TO LCAP-BATCH-REFCD.
           MOVE POFF-LCAP-BATCH-REFCD-LC-FG TO LCAP-BATCH-REFCD-LC-FG.
           MOVE 0                           TO LCAP-LPAPLC
                                               LCAP-LPAPINT.
           PERFORM LATE-CHARGE-APPLY.
           MOVE LCAP-PARTIALS               TO POFF-PARTIALS.
           MOVE LCAP-LCPAID                 TO POFF-LCPAID.
           ADD LN-LCBAL LCAP-OWE GIVING POFF-LCDUE.
           ADD LCAP-OWE                     TO POFF-NETDUE.

      ****************************************************
      *    GET ALL INTEREST CHARGES DUE THRU PAYOFF DATE:
      *    NOTE:
      *          NEW FIELDS SHOULD HAVE BEEN CREATED FOR
      *          THE LINK BETWEEN CL/LFPPO.C AND LPPOFF
      *          BUT THIS WOULD FORSE A RECOMPILE, SO
      *          POFF-O5-INT-REB WAS USED. JTG 010925
      ****************************************************
       PAYOFF-SET-INT-CHARGES SECTION.
           IF SP-CAL-RATETYPE(1) = "Z"
              MOVE "CL/LFPPO" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH
                                   POFF-WORKERS
                                   LN-REC
                                   SP-REC
              CANCEL FORM-PROGX
              MOVE POFF-INTDUE     TO INDU-INTEREST
              MOVE POFF-O5-INT-REB TO INDU-PENALTY
              MOVE 0               TO POFF-O5-INT-REB
           ELSE
              MOVE POFF-PAYDATE TO RATE-DATE IBPC-DATE
              MOVE POFF-MAKERCD TO RATE-MAKERCD
              MOVE POFF-LPTRCD TO RATE-LPTRCD
              PERFORM SET-PY-RATE.

      * WORLD DOES NOT USE. COMMENTED 5/17/2023
      *    TEST FOR CALIFORNIA RECAST:
      *    IF SP-RBRECAST(7) = 2
      *       IF LN-OVRDRATE NOT = 999.999
      *          MOVE LN-ORIG-1STPYDATE TO NDTE-DATE
      *          MOVE 2 TO NDTE-HOLD
      *          MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
      *          MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
      *          PERFORM INCREMENT-UNITPER
      *          IF POFF-PAYDATE NOT > NDTE-DATE
      *             MOVE "C" TO POFF-FORM-PROG-NO
      *             ADD LN-INTBAL INDU-INTEREST
      *                             GIVING POFF-ORIG-INTDUE
      *             PERFORM POFF-CALL-SUBPROG
      *             IF POFF-COMMON-RTNCD = " "
      *                SUBTRACT POFF-COMMON-INTADJ
      *                                  FROM INDU-INTEREST.

      * CALIFORNIA "CA" STATE LAW  1/15/2013 MULLEN & COSMO
      * WHEN AN ACCOUNT IS PAID IN FULL (REGARDLESS OF THE PAYOFF METHOD)
      * ON OR BEFORE THE 3RD INSTALLMENT DUE DATE (CURRENT 1ST PAY DUE DATE
      * PLUS 2 MONTHS) BASED ON A 360 DAY YEAR TYPE, AS FOLLOWS:

           IF SP-RBSPOPT1(7) = 27
              PERFORM CALIFORNIA-SPECIAL-OPTION.

           ADD LN-INTBAL INDU-INTEREST GIVING POFF-INTDUE.
           ADD INDU-INTEREST TO POFF-NETDUE.

      **********************************
      *    GET THE REBATE:
      **********************************
       PAYOFF-GET-REBATE SECTION.
           MOVE POFF-PAYDATE TO REB-PAYDATE.
           MOVE POFF-LPTRCD TO REB-LPTRCD.

           MOVE 0 TO REB-SUB2.
      * CL:
           IF REB-SUB < 5
              MOVE 1 TO REB-SUB2
           ELSE
      * AH&PP:
           IF REB-SUB < 7
              SUBTRACT 3 FROM REB-SUB GIVING REB-SUB2
           ELSE
      * O1 & O2 & O3:
           IF REB-SUB = 12 OR 13 OR 14 OR 15 OR 16
              SUBTRACT 8 FROM REB-SUB GIVING REB-SUB2.

           IF REB-SUB2 NOT = 0
              MOVE REB-SUB2 TO ADDONSPR-SUB
              PERFORM FIND-ADDON-SPR
              PERFORM REBATE
              PERFORM FIND-ADDON-SPR-RESTORE
           ELSE
              PERFORM REBATE.

           IF REB-SUB = 8
              MOVE REB-EP54-AMT TO POFF-LXR-REB-AMT
           END-IF.
           
           SUBTRACT REB-REBATE FROM POFF-NETDUE.

      **********************************
      *    CALCULATE SERCHG REBATE:
      **********************************
       PAYOFF-SERCHG-REBATE SECTION.

      * ALLOW REFUND OF SERVICE CHARGE ON IB LOAN TYPES
      
            IF ( LN-SERCHG = 0             ) OR
               ( LN-SC-REBATE = "R" OR "Y" )
               GO TO PAYOFF-SERCHG-REBATE-EXIT.

           MOVE 8 TO REB-SUB.
           MOVE LN-SERCHG TO REB-TOTCHG.
           MOVE LN-ORGTERM TO REB-ORGTERM.
           IF LN-INT-REBATE = " " OR "C"
              MOVE POFF-REBATE(4) TO REB-STATEWK
           ELSE
              MOVE LN-ANTICADJ(1) TO REB-STATEWK.
           PERFORM PAYOFF-GET-REBATE.
           MOVE REB-REBATE TO POFF-REBATE(5)
                              REB-LN-SC-REBATE.

           MOVE REB-EP54-AMT TO POFF-LXR-REB-AMT.

       PAYOFF-SERCHG-REBATE-EXIT.
           EXIT.

      * CALIFORNIA "CA" STATE LAW  1/15/2013 MULLEN & COSMO
      * WHEN AN ACCOUNT IS PAID IN FULL (REGARDLESS OF THE PAYOFF METHOD)
      * ON OR BEFORE THE 3RD INSTALLMENT DUE DATE (CURRENT 1ST PAY DUE DATE
      * PLUS 2 MONTHS) BASED ON A 360 DAY YEAR TYPE, AS FOLLOWS:

      ********************************************
       CALIFORNIA-SPECIAL-OPTION SECTION.
      ********************************************

           MOVE LN-ORIG-1STPYDATE TO NDTE-DATE
           MOVE 2 TO NDTE-HOLD
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
           PERFORM INCREMENT-UNITPER
      * IF NOT WITHIN 3RD INSTALLMENT, EXIT OUT
           IF POFF-PAYDATE > NDTE-DATE
              GO TO EXIT-CALIFORNIA-SPECIAL-OPTION.

      * WITHIN 3RD INSTALLMENT, NOW CALCULATE ELAPSED DAYS SINCE LAST
      * PAYMENT/LOANDATE (IF NO PAYMENTS)

           MOVE 360 TO ELAPSED-YRTYPE.
           MOVE LN-DATE-PAID-LAST TO NUM-DATE.
           IF LN-DATE-PAID-LAST = 0
              MOVE LN-LOANDATE TO NUM-DATE.
           MOVE POFF-PAYDATE TO SYS-DATE.
           PERFORM TIMALL.

           IF LN-CURBAL > 0
      * 1 TO 225.00
              IF LN-CURBAL < 225.01
                 COMPUTE INDU-INTEREST ROUNDED =
                  ( LN-CURBAL * ELAPSED-DAYS ) / 1200
              ELSE
      * 225.01 TO 900.00
              IF LN-CURBAL < 900.01
                 COMPUTE INDU-INTEREST ROUNDED =
                  ( (56.25 + LN-CURBAL) * ELAPSED-DAYS ) / 1500
              ELSE
      * 900.01 TO 1650.00
              IF LN-CURBAL < 1650.01
                 COMPUTE INDU-INTEREST ROUNDED =
                  ( (375.00 + LN-CURBAL) * ELAPSED-DAYS ) / 2000
              ELSE
      * 1650.01 TO 2499.99
                 COMPUTE INDU-INTEREST ROUNDED =
                  ( (1387.50 + LN-CURBAL) * ELAPSED-DAYS ) / 3000.

       EXIT-CALIFORNIA-SPECIAL-OPTION.
           EXIT.

      *********************************************
      *   ROUTINE TO CALL SUBPROGRAM:
      *
      *   MOVE FIELDS TO PASS TO POFF-COMMON
      *   MOVE PROGRAM NAME TO POFF-FORM-PROG
      *********************************************
      *POFF-CALL-SUBPROG SECTION.
      *    MOVE POFF-FORM-PATH TO FORM-NAM.

      *POFF-CALL-SUBPROG-RETRY.
      *    MOVE POFF-PAYDATE TO POFF-COMMON-PAYDATE.
      *    CALL FORM-PROGX USING FORM-PATH POFF-COMMON LN-REC SP-REC
      *         ON OVERFLOW
      *         GO TO POFF-CALL-SUBPROG-RETRY.

      *    CANCEL FORM-PROGX.

       COPY "LIBLP/MIPPO.CPY".

      *-----------------------------------------------------------------------
      *    DUMMY SECTION TO INCLUDE IN COPY MEMBERS THAT NEED TO BE
      *    REFLECTED IN 'WHAT' COMMANDS FOR SUPPORT
      *-----------------------------------------------------------------------
       SCCS-COPY-ROUTINE SECTION. MOVE
           "@(#)./LIBLP/LPPOFF.CPY S35 >"
              TO MESS.
      *================================================================*
      * END COPYBOOK: LIBLP\LPPOFF.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPOF2.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPOF2
      ************************************************************************
      *         COMPUTE ADDON INTEREST REBATE FIGURES FOR A LOAN
      *                (AS OF A CURRENT DATE)
      *
      *   NAME: LPPOF2
      *   DESC: THIS ROUTINE IS USED TO COMPUTE THE
      *         REBATE FIGURES FOR LOAN ADDON CANCEL/PAYOFF. IT WILL
      *         YIELD THE FOLLOWING FIGURES:
      *
      *         ROUTINE AUTO COPIES 'LIBLP/ADDONRB'
      *         ------------------------------------------
      *
      *   IN  : POFF-PAYDATE            DATE OF PAYMENT
      *         POFF-LPTRCD             TO REFLECT THE TYPE OF PAYOFF
      *
      *         ----------------        THESE FIELDS ARE USED BY LONPG7.C
      *                                 TO DETERMINE WHICH ADDON RECORDS
      *                                 TO INCLUDE IN THE COMPUTATION OF
      *                                 THE INTEREST REFUND FOR A CANCEL
      *         POFF-INSEFF-TEST
      *         POFF-INSEXP-TEST
      *                                 SET THEM TO - ZERO - OTHERWISE
      *         ----------------
      *
      *   OUT : POFF-INT-REB-TBL(1)     CL ADDON INTEREST REBATE.
      *                         (2)     AH ADDON INTEREST REBATE.
      *                         (3)     PP ADDON INTEREST REBATE.
      *                         (4)     O1 ADDON INTEREST REBATE.
      *                         (5)     O2 ADDON INTEREST REBATE.
      *                         (6)     O3 ADDON INTEREST REBATE.
      *                         (7)     O4 ADDON INTEREST REBATE.
      *                         (8)     O5 ADDON INTEREST REBATE.
      *
      *   USED:
      *   COPY:
      *
      *REV :
      * MJD 052097 ADDED LEVEL TO POFF-INT-ADDON-TBL FOR FEES.
      * JTG 061897 ADDED LOGIC TO TEST FOR ONLY ADDON RECORDS THAT
      *            ARE PART OF THE CANCEL
      * JTG 092697 CHANGED TO PERFORM 'LIBLP/ADDONRB' COMMON LOGIC
      *            TO COMPUTE APR RATE FOR ACTUARIAL REBATE FORMULAS
      * JTG 030212 ADDONS CANCELLED VIA ADDON MODULE DO INCORRECT ADDITIONAL
      *            REFUND ON THE 'LT' INTEREST
      *
      *            CHANGED VALUES OF LT-INS-REBATE FLAG SUCH THAT WHEN:
      *              LT-INS-REBATE = " "  NO REFUND OR CANCEL OCCURED
      *                            = "Y"  INS. WAS CANCELLED VIA ADDON POSTING
      *                            = "R"  INS. WAS REBATED   VIA TRANS POSTING
      *                                                               MULL #382
      *  160113 BAH SPLIT OUT LTFILE, LTIFILE, RENAMED LT- LTI- PD0003
      *  100102  CS GLOBAL LTIFILE
      ************************************************************************
       PAYOFF-INT-ADDONS SECTION.
           PERFORM OPEN-LTI1-FILE.

           MOVE LTI-PATH-OWNBR  TO LTI-BRNO
                                   QLTI1-WBEG-BRNO
                                   QLTI1-WEND-BRNO.
           MOVE LN-ACCTNO       TO LTI-ACCTNO
                                   QLTI1-WBEG-ACCTNO
                                   QLTI1-WEND-ACCTNO.
           MOVE 0               TO LTI-SEQNO
                                   QLTI1-WBEG-SEQNO.
           MOVE ALL "9"         TO QLTI1-WEND-SEQNO.

           PERFORM START-LTI1-FILE.
       PAYOFF-INT-ADDONS-NEXT.
           PERFORM READ-LTI1-FILE-NEXT.
           IF IO-FG NOT = 0 OR (LTI-BRNO NOT = LTI-PATH-OWNBR)
              GO TO END-PAYOFF-INT-ADDONS.

           IF LTI-ACCTNO NOT = LN-ACCTNO
              GO TO END-PAYOFF-INT-ADDONS.

      * THIS LOGIC IS USED BY LONPG7.C
      *----------------------------------------------------------------
           IF NOT (POFF-INSEFF-TEST = 0 AND POFF-INSEXP-TEST = 0)
              IF NOT ( LTI-INSEFF-DATE = POFF-INSEFF-TEST AND
                       LTI-INSEXP-DATE = POFF-INSEXP-TEST
                     )
                 GO TO PAYOFF-INT-ADDONS-NEXT
              END-IF
              IF LTI-INS-REBATE NOT = " "
                 GO TO PAYOFF-INT-ADDONS-NEXT
              END-IF
              PERFORM PAYOFF-INT-ADDONS-GET-LP-REC
              IF POFF-RTNCD = "Y"
                 GO TO PAYOFF-INT-ADDONS-NEXT.
      *----------------------------------------------------------------

      * COMMON LOGIC TO COMPUTE ADDON INTEREST REFUND:
           PERFORM ADDONRB-GET-INT-REBATE.

           IF REB-SUB NOT = 0
              MULTIPLY POFF-ONE BY REB-REBATE
              ADD REB-REBATE TO POFF-ADDON-INT-REBATE
           ELSE
              MOVE 0 TO REB-REBATE.
           IF LTI-INS-TYPE = 0
              ADD REB-REBATE TO POFF-INT-REB-TBL(9)
           ELSE
              ADD REB-REBATE TO POFF-INT-REB-TBL(LTI-INS-TYPE).
           GO TO PAYOFF-INT-ADDONS-NEXT.

       END-PAYOFF-INT-ADDONS.
           PERFORM CLOSE-LTI1-FILE.

       COPY "LIBLP/ADDONRB.CPY".

      ****************************************************
      *         PAYOFF-INT-ADDONS-GET-LP-REC
      *
      *    DUMMY SECTION USED BY LONPG7.C
      *    IT MUST BE THE LAST LINE OF THIS COPY MEMBER
      *    TO ALLOW LONPG7.C TO PLACE ITS LOGIC TO READ
      *    PAYMENT RECORDS.
      ****************************************************
       PAYOFF-INT-ADDONS-GET-LP-REC SECTION.

      *================================================================*
      * END COPYBOOK: LIBLP\LPPOF2.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\AGEING.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/AGEING
      *************************************************************************
      *   NAME:  AGEING - COMPUTE-RECENCY
      *   DESC:  GIVEN AGEING DATE (MMDDYY) COMPUTE
      *          RECENCY DAYS AND TABLE SUBSCRIPT
      *          FROM LAST PMT, OR LOAN DATE, IF NO
      *          PAYMENTS HAVE BEEN MADE
      *   IN  :  AGEING-DATE
      *   OUT :  RSUB
      *          RECENCY
      *          RDSUB
      *          RECDEL
      *          RDPOT30        ' ' = N/A
      *                         'Y' = POTENTIAL 30
      *          RDPOTCHGOFF    ' ' = N/A
      *                         'Y' = POTENTIAL CHARGE OFF
      *                         'M' = MISSED CHARGE OFF
      *   USED:  LN-LOANDATE, LN-DATE-PAID-LAST
      *-----------------------------------------------
      *
      *   RSUB
      *   RDSUB     INTERNAL          EXTERNAL
      *   -----     ------------      ------------
      *     1   -   CUR               30
      *     2   -    30               60
      *     3   -    60               90
      *     4   -    90              120
      *     5   -   120              150
      *     6   -   150              180
      *     7   -   180              210+
      *     8   -   210+             N/A
      *     9   -   N/A              POTENTIAL 30
      *    10   -   POTENTIAL 30     CURRENT
      *-----------------------------------------------
      * REV :
      *  JTG 072195 ADDED LOGIC FOR SP-RDPOT30-CD = 'A'
      *                             SP-RDPOTCHGOFF-CD = 'A'
      *  MJD 071595 ADDED A50 LOGIC FOR SP-BANKUNITPER-CD = "A".
      *  BLV 041097 IF SP PAY FREQ CODE = "A" (INSTANT), FORCE 100%
      *             TO PDTHRU % FOR COMPUTING PD THRU FOR AGEING; TO FIX:
      *             AGEING-HOLD-REMAIN > 50%  CAUSE PDTHRU% IS <100, SO
      *             90 ACCT IS AGED AS 60; 60 IS AGED AS 30, ETC.
      *  JTG 091597 ADDED LOGIC FOR NEW STAT/AGEING BUCKETS
      *  JTG 091697 ADDED LOGIC FOR 'D' WORLD A90, SP-BANKRULE & SP-TRWBANKRULE
      *  JTG 990419 ADDED SP-RECFRMLA-CALENDAR-DUEDAY  "D"         FROM REL: A50
      *                   SP-RECFRMLA-PERCNT-PMT       "P"         MERCURY  #183
      *  MJD 090427 ADDED SP-BANKRULE "E"                  (BARNETT) 71284 #3189
      *  MJD 110823 ADDED SP-BANKRULE "F" MX NON MONTHLY   (WORLD) #752
      *  MJD 120402 FIXED BAD 'IF' STATEMENT FOR BANKRULE "D" AND "F"
      *  BLM 160615 FOR BANKRULE R & S, CALL GETLTR SINCE REVOLVING FIELDS 
      *             ARE NOW IN LTRFILE, NOT LNFILE, PD0003
      * KEC 2016.1116 ADDED LTR-SEQNO TO LTR1-KEY.
      * BLM 2017.0208 FIX LOGIC USING LN-PY-YYYYMM-RECDEL FOR 8 DIGIT DATES
      * BAH 2017.0914 RENAMED LN-PYMMYY-RECDEL TO LN-PY-YYYYMM-RECDEL AND FIXED
      *               LOGIC TO USE IT CORRECTLY
      * BAH 2019.0626 REMOVED BANKRULE "R" AND "S" REVOLVING
      *************************************************************************
       COMPUTE-RECENCY SECTION.

      * NOTE:
      *  WHEN SP-BANKRULE = 'D':
      *    -  RECENCY-ROUTINE IS COMPUTED IN COMPUTE-CONTRACTUAL
      *
      *    -  AFTER A MONTHEND:
      *     [ RECENCY CURRENT # & $ ]  =  [ CONTRACTUAL CURRENT # & $ ]
      
           IF SP-BANKRULE = "D"
              PERFORM COMPUTE-CONTRACTUAL
              GO TO COMPUTE-RECENCY-EXIT
           ELSE
              IF SP-BANKRULE = "F"
                 PERFORM COMPUTE-CONTRACTUAL
                 GO TO COMPUTE-RECENCY-EXIT
              ELSE
                 PERFORM RECENCY-ROUTINE.

           PERFORM COMPUTE-RECENCY-SET-EXTERNAL.

       COMPUTE-RECENCY-EXIT.
           EXIT.

      **************************************************
       COMPUTE-RECENCY-SET-EXTERNAL SECTION.
      **************************************************

      * SET EXTERNAL INDEXES FROM INTERNAL:
      
           IF RSUB = 1
              MOVE 10 TO RSUB
           ELSE
              SUBTRACT 1 FROM RSUB.

           IF RDSUB = 1
              MOVE 10 TO RDSUB
           ELSE
              SUBTRACT 1 FROM RDSUB.

      ************************************************************
       RECENCY-ROUTINE SECTION.
      ************************************************************
           MOVE 0 TO RECENCY
                     RECDEL.
           MOVE 1 TO RSUB
                     RDSUB.
           MOVE " " TO RDPOT30
                       RDPOTCHGOFF.

           IF LN-CURBAL = 0
              GO TO RECENCY-ROUTINE-EXIT.

           IF LN-DATE-PAID-LAST = 0
              MOVE LN-LOANDATE       TO NUM-DATE
           ELSE
              MOVE LN-DATE-PAID-LAST TO NUM-DATE.
           MOVE AGEING-DATE          TO SYS-DATE.

           PERFORM COMPUTE-TRUE-RECENCY.
           IF SP-RECFRMLA = " " AND
              (SP-BANKRULE NOT = "D") AND (SP-BANKRULE NOT = "F")
                  MOVE RECENCY TO RECDEL
                  MOVE RSUB TO RDSUB
           ELSE
              PERFORM COMPUTE-RECENCY-DELINQ.

       RECENCY-ROUTINE-EXIT.
           EXIT.

      ****************************************************************
       COMPUTE-TRUE-RECENCY SECTION.
      ****************************************************************
           PERFORM TIM.
           IF ELAPSED-DAYS < 0
              MOVE 0 TO ELAPSED-DAYS.
           MOVE ELAPSED-DAYS TO RECENCY.
           COMPUTE RSUB = (ELAPSED-DAYS / 30) + 1.

           IF RSUB > 8
              MOVE 8 TO RSUB.

      *************************************************************************
      *    RECENCY / DELINQUENCY
      * REV :
      *  JTG 072195 ADDED LOGIC FOR SP-RDPOT30-CD = 'A'
      *                             SP-RDPOTCHGOFF-CD = 'A'
      *  JTG 091597 ADDED LOGIC FOR NEW STAT/AGEING BUCKETS
      *  JTG 091697 ADDED LOGIC FOR 'D' WORLD A90, SP-BANKRULE & SP-TRWBANKRULE
      *  JTG 990419 ADDED SP-RECFRMLA-CALENDAR-DUEDAY  "D"         FROM REL: A50
      *                   SP-RECFRMLA-PERCNT-PMT       "P"         MERCURY  #183
      *************************************************************************
       COMPUTE-RECENCY-DELINQ SECTION.
           IF (SP-BANKRULE = "D")
              PERFORM COMPUTE-RECENCY-DELINQ-D
           ELSE
           IF (SP-BANKRULE = "F")
              PERFORM COMPUTE-RECENCY-DELINQ-F
           ELSE
              IF SP-RECFRMLA-PERCNT-PMT
                 IF SP-RECPDTH = 0
                    MOVE .01 TO AGEING-WORK
                 ELSE
                    COMPUTE AGEING-WORK ROUNDED =
                         LN-REGPYAMT * SP-RECPDTH * .01
                 END-IF
                 IF LN-MTD-PAYS-RECDEL >= AGEING-WORK
                    MOVE 1 TO RDSUB
                 ELSE
                    IF LN-PY-YYYYMM-RECDEL NOT = 0
                       MOVE LN-PY-YYYYMM-RECDEL TO DATE-YYYYMM
                       MOVE DATE-YYYYMM-MM      TO NUM-MO
                       MOVE DATE-YYYYMM-CC      TO NUM-CC
                       MOVE DATE-YYYYMM-YY      TO NUM-YR
                    ELSE
                       MOVE LN-LOANDATE TO NUM-DATE
                    END-IF
                    MOVE AGEING-DATE    TO SYS-DATE
                    MOVE 5              TO NUM-DA S-DD
                    PERFORM TIM360
                    MOVE ELAPSED-MONTHS TO RDSUB
                 END-IF
              ELSE
                 IF SP-RECFRMLA-CALENDAR-DUEDAY
                    IF S-DD < LN-1STPYDA
                       MOVE 5 TO NUM-DA
                       MOVE 4 TO S-DD
                    ELSE
                       MOVE 5 TO NUM-DA S-DD
                    END-IF
                 ELSE
                    MOVE 5 TO NUM-DA S-DD
                 END-IF
                 PERFORM TIM360
                 MOVE ELAPSED-MONTHS TO RDSUB.

      ****************************************************************
      * TEST FOR POTENTIAL 30'S, SET RDPOT30
      ****************************************************************
      
      * CURRENTLY RDPOT30 IS ONLY SET IN COMPUTE-RECENCY-DELINQ-D,
      * IF WORLD SP-BANKRULE = 'D'
      
           IF SP-BANKRULE = "F"
              IF RDSUB > 2
                 DIVIDE RDSUB BY 2 GIVING AGEING-SUB-WORKER
                                   REMAINDER AGEING-SUB-REMAIN
                 IF AGEING-SUB-REMAIN NOT = 0
                    ADD 1 TO AGEING-SUB-WORKER
                 END-IF
                 MOVE AGEING-SUB-WORKER TO RDSUB.

      ****************************************************************
      *    TEST FOR POTENTIAL CHARGE OFF'S
      ****************************************************************

      * MERCURY POTENTIAL CHARGE OFF'S CODE = 'A'

           IF SP-RDPOTCHGOFF-CD = "A"
              IF RDSUB > 5
                 IF LN-PLCD = " "
                    IF RDSUB = 6
                       MOVE "Y" TO RDPOTCHGOFF
                    ELSE
                    IF RDSUB > 6
                       MOVE "M" TO RDPOTCHGOFF.

           IF ELAPSED-MONTHS < 1
              MOVE 1 TO RDSUB.

           COMPUTE RECDEL = RDSUB * 30 - 30.

           IF RDSUB > 8
              MOVE 8 TO RDSUB
           ELSE
              IF RDPOT30 = "Y"
                 MOVE 10 TO RDSUB.

       COMPUTE-RECENCY-DELINQ-EXIT.
           EXIT.

      *****************************************************************
      * RECENCY/DELINQUENCY WORLD FORMULA 'D':
      *
      * REV:
      *  111293 JTG CORRECTED LOGIC FOR LN-1STPYDA PAST 25TH
      *  120493 JTG MODIFIED TO CONFORM TO CHARLIE WALTERS DEFINITION
      *****************************************************************
       COMPUTE-RECENCY-DELINQ-D SECTION.

      * N O T E:
      *     MUST HAVE COMPUTED CONTRACTUAL BEFORE THIS ROUTINE
      *     WILL WORK!
      *
      *     RECENCY IS CALLED FROM COMPUTE-CONTRACTUAL-D.
      
      * TEST FOR CURRENT ACCOUNT:
           IF CSUB = 1
              MOVE 1 TO RDSUB
              IF LN-MTD-PAYS-RECDEL NOT < LN-REGPYAMT
                 GO TO COMPUTE-RECENCY-DELINQ-D-EXIT
              ELSE
                 MOVE CPOT30 TO RDPOT30
                 GO TO COMPUTE-RECENCY-DELINQ-D-EXIT.

      * ACCOUNT IS PAST DUE:
           IF LN-MTD-PAYS-RECDEL NOT < LN-REGPYAMT
              MOVE 1 TO RDSUB
              GO TO COMPUTE-RECENCY-DELINQ-D-EXIT.

           MOVE AGEING-DATE TO NDTE-DATE.
           MOVE 35          TO NDTE-DD.
           MOVE -1          TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO SYS-DATE.

           IF LN-PY-YYYYMM-RECDEL NOT = 0
              MOVE LN-PY-YYYYMM-RECDEL TO DATE-YYYYMM
              MOVE DATE-YYYYMM-MM     TO NDTE-MM
              MOVE DATE-YYYYMM-CC     TO NDTE-CC
              MOVE DATE-YYYYMM-YY     TO NDTE-YY
              MOVE S-DD               TO NDTE-DD
           ELSE
              MOVE LN-1STPYDATE TO NDTE-DATE.

           MOVE -1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO NUM-DATE.

           PERFORM TIM360.
           IF ELAPSED-MONTHS = 1
              MOVE "Y" TO RDPOT30.
           MOVE ELAPSED-MONTHS TO RDSUB.
           IF RDSUB < 1
              MOVE 1 TO RDSUB.

           IF RDSUB > CSUB
              MOVE CSUB TO RDSUB.

       COMPUTE-RECENCY-DELINQ-D-EXIT.
           EXIT.

      *****************************************************************
      * RECENCY/DELINQUENCY WORLD FORMULA 'F':
      *
      * REV:
      *  111293 JTG CORRECTED LOGIC FOR LN-1STPYDA PAST 25TH
      *  120493 JTG MODIFIED TO CONFORM TO CHARLIE WALTERS DEFINITION
      *****************************************************************
       COMPUTE-RECENCY-DELINQ-F SECTION.

      *  N O T E:
      *      MUST HAVE COMPUTED CONTRACTUAL BEFORE THIS ROUTINE
      *      WILL WORK!!!!!!!!!!!!!!
      *
      *      RECENCY IS CALLED FROM COMPUTE-CONTRACTUAL-F.
      

      * ATTEMPTING LOGIC TO DETERMINE HOW MANY CONTRACTUAL PAYMENTS
      * IN THE MONTH (1ST MONTH MAY ON KLY HAVE ON E DUE) WHEN COMPUTING
      * RECENCY.  AS PER JIM, REGARDLESS WE WILL ALWAYS REQUIRE TWO
      * TO BE CONTRACTUALLY RECENT.  LEFT LOGIC HERE AS A BASE
      * IN CASE IT COMES UP AGAIN OR WE NEED TO MAKE WORK FOR
      * OTHER PAY FREQUENCIES
      *--->MOVE LN-1STPYDATE TO NUM-DATE.
      *    MOVE AGEING-DATE TO SYS-DATE.
      *    MOVE 1 TO NUM-DA S-DD.
      *    PERFORM CMPDAT.
      *    IF SYS-IS-EQ
      *       MOVE 1 TO AGEING-SUB-WORKER
      *--->ELSE
              MOVE 2 TO AGEING-SUB-WORKER.

      * TEST FOR CURRENT ACCOUNT:
           IF CSUB = 1
              MOVE 1 TO RDSUB
              IF  LN-MTD-PAYS-RECDEL NOT < (LN-REGPYAMT *
                                            AGEING-SUB-WORKER)
                 GO TO COMPUTE-RECENCY-DELINQ-F-EXIT
              ELSE
                 MOVE CPOT30 TO RDPOT30
                 GO TO COMPUTE-RECENCY-DELINQ-F-EXIT.

      * ACCOUNT IS PAST DUE:
           IF LN-MTD-PAYS-RECDEL NOT < (LN-REGPYAMT * AGEING-SUB-WORKER)
              MOVE 1 TO RDSUB
              GO TO COMPUTE-RECENCY-DELINQ-F-EXIT.

           MOVE AGEING-DATE TO NDTE-DATE.
           MOVE 35          TO NDTE-DD.
           MOVE -1          TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO SYS-DATE.

           IF LN-PY-YYYYMM-RECDEL NOT = 0
              MOVE LN-PY-YYYYMM-RECDEL TO DATE-YYYYMM
              MOVE DATE-YYYYMM-MM     TO NDTE-MM
              MOVE DATE-YYYYMM-CC     TO NDTE-CC
              MOVE DATE-YYYYMM-YY     TO NDTE-YY
              MOVE S-DD               TO NDTE-DD
           ELSE
              MOVE LN-1STPYDATE TO NDTE-DATE.

           MOVE NDTE-DATE TO NUM-DATE.

           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM TIMUPER.
           IF ELAPSED-UNITPER = 1 OR 2
              MOVE "Y" TO RDPOT30.
           MOVE ELAPSED-UNITPER TO RDSUB.
           IF RDSUB < 1
              MOVE 1 TO RDSUB.

           IF RDSUB > CSUB
              MOVE CSUB TO RDSUB.
           IF RDSUB = 1 OR 2
              MOVE "Y" TO RDPOT30.

       COMPUTE-RECENCY-DELINQ-F-EXIT.
           EXIT.

      *************************************************************************
      *   NAME:  AGEING - COMPUTE-CONTRACTUAL
      *   DESC:  GIVEN AGEING DATE (MMDDYY) COMPUTE
      *          CONTRACTUAL DAYS AND TABLE SUBSCRIPT
      *
      *   IN  :  AGEING-DATE
      *   OUT :  CSUB
      *          CONTRACTUAL
      *          CPOT30          ' ' = N/A
      *                          'Y' = POTENTIAL 30
      *                          'M' = MISSPAY  (MISSED PAYMENT)
      *          CPOTCHGOFF      ' ' = N/A
      *                          'Y' = POTENTIAL CHARGE OFF
      *                          'M' = MISSED CHARGE OFF
      *          CTFC-NM          TFC NON MONTHLY PAPER AGEING TABLE POINTER
      *   USED:
      *------------------------------------------------------------------------
      *
      *   CSUB      INTERNAL          EXTERNAL
      *   -----     ------------      ------------
      *     1   -   CUR               30
      *     2   -    30               60
      *     3   -    60               90
      *     4   -    90              120
      *     5   -   120              150
      *     6   -   150              180
      *     7   -   180              210+
      *     8   -   210+             MISSPAY
      *     9   -   MISSPAY          POTENTIAL 30
      *    10   -   POTENTIAL 30     CURRENT
      *-----------------------------------------------
      * REV:
      *  JTG 050986 SET CEPP-NOCAP-FG SO ELAPSED PERIODS WOULD
      *             NOT BE CAPPED THRU MATURITY.
      *  JTG 052386 ADDED TEST ON SP-BANKRULE
      *             FOR HORRIGAN (CONTRACTUAL).
      *  JTG 060586 FIXED BUG BY ADDING 1 TO AGEING-HOLD
      *  JTG 103086 OPENED UP BANKRULE "B"
      *  JTG 041087 OPENED UP BANKRULE "C"
      *  JTG 040590 ADDED SET OF PDTH-ALDEL-FG WHICH IS PASSED
      *             BY COMPUTE-RECDEL
      *  JTG 051791 CHANGED ELAPSED PAY PERIOD CALC FOR PAID THRU
      *             TO NOT CAP ON MATURITY, SINCE AD'S ALLOW DELINQ
      *             EXTEND ACCOUNTS PAID THRU'S PAST MATURITY
      *  JTG 051895 ADDED MERCURY $2.00 SP-CONTR-CREDIT
      *              AND SP-CONTR-CREDIT-MIN-DEL-PER LOGIC
      *  JTG 072195 ADDED LOGIC FOR SP-CPOT30-CD = 'A'
      *                             SP-CPOTCHGOFF-CD = 'A'
      *  JTG 080696 CHANGED SO SP-BANKUNITPER-CD = "A"
      *             WOULD YIELD POTENTIAL'S
      *  JTG 121396 ADDED SP-BANKUNITPER-CD = 'B'
      *                   SP-TRWBANKUNITPER-CD = 'B'  (FL AUTO)
      *  MJD 121396 ADDED SP-BANKUNITPER-CD = 'C'
      *                   SP-TRWBANKUNITPER-CD = 'C'  (FL AUTO)
      *  JTG 121396 CHANGED SP-BANKUNITPER-CD = 'B' AND 'C'
      *             TO USE PDTH-CUR-SCHD-DATE
      *  JTG 042997 FIXED FOR BANKRULE 'A' & 'C'
      *             CHANGED FIND ELAPSED PERIODS THRU PAIDTHRU:
      *             WHEN DUE DATE IS EX. 30TH AND PAIDTHRU MONTH
      *             IS FEBURARY PDTH = 022897 AND WHEN TODAY IS
      *             EX. 043097 ELAPSED PAY PERIODS IS OFF BY 1
      *  JTG 080697 FIXED FOR BANKRULE 'B'
      *             WHEN DUE DATE IS EX. 30TH AND PAIDTHRU MONTH
      *             IS FEBURARY PDTH = 022897 AND WHEN TODAY IS
      *             EX. 043097 ELAPSED PAY PERIODS IS OFF BY 1
      *  JTG 082897 ADDED SP-BANKUNITPER-CD = 'D'
      *                   SP-TRWBANKUNITPER-CD = 'D'  (INSTANT AUTO)
      *                   NOTE: SAME AS 'A' EXCEPT 80% AND NOT 50%
      *  JTG 090897 CORRECTED SP-BANKUNITPER-CD = 'D', VIA 1.99 - .80
      *  JTG 091597 ADDED LOGIC FOR NEW STAT/AGEING BUCKETS
      *  JTG 112597 PUT BACK OLD LOGIC FOR SP-BANKUNITPER-CD 'A'
      *             PER KEVIN MULLEN, RE: INSTANT
      *  JTG 121897 CHANGED SP-BANKRULE (C) TO PROVIDE A BEGINNING OF
      *             THE MONTH AGEING ROUTINE FOR NON MONTHLY ACCOUNTS
      *  JTG 022498 CHANGED SP-BANKUNITPER-CD = 'A' & 'D', INSTANT AUTO
      *             TO DETERMINE EXACT PAYMENT REQUIREMENT FOR A GIVEN
      *             MONTH. EX. WEEKLY, JUL 5 PAYMENTS, AUG 4 PAYMENTS
      *  JTG 042998 CHANGED SP-BANKRULE (A) TO PROVIDE A BEGINNING OF
      *             THE MONTH AGEING ROUTINE FOR NON MONTHLY ACCOUNTS
      *  JTG 101598 ADDED LOGIC FOR REVOLVING SP-BANKRULE = 'R', REGENCY
      *  JTG 990309 ADDED SP-CPOTCHGOFF-CD-VALID 'B', REGENCY
      *  JTG 990311 ADDED SP-BANKUNITPER-CD & SP-TRWBANKUNITPER-CD = 'E' TFC
      *             AND ADDED OUTPUT OF TFC CTFC-NM TABLE INDEX
      *  JTG 990325 CORRECTED SP-BANKUNITPER-CD & SP-TRWBANKUNITPER-CD = 'E' TFC
      *  JTG 990331 CHANGED CALCULATION OF CONTRACTUAL FOR NON MONTHLY ACCOUNTS
      *             TO BE BASED ON THE NUMBER OF PAY PERIODS FROM
      *             ( PAID THRU + 1 PAY PERIOD ) TO AGEING DATE  [ CTFC-NM ]
      *  JTG 990625 ADDED LOGIC FOR REVOLVING SP-BANKRULE = 'S', REGENCY
      *             NOTE: 'R' WILL BECOME 'S' AND NEW LOGIC PUT INTO 'R' LOGIC
      *  JTG 990914 CORRECTED TO MAKE ACCOUNTS CURRENT AFTER CYCLE AND BEFORE
      *             MONTH END WHEN ONLY ONE AGEING BUCKET EXISTS
      *  BLV 000311 CORRECTED TFC NON-MONTHLY POTS TO INCLUDE ONLY 2 - 5 WEEKS
      *             PAST DUE (WERE INCLUDING 0 - 1 WEEK PAST DUE), TFC PR# 69
      *  BLV 000508 ADDED LOGIC FOR SP-CPOTCHGOFF CODE OF "C", 120+ TO BE
      *             CONSIDERED POTENTIAL CHARGE-OFFS, MERC PR# 230
      **************************************************************************
       COMPUTE-CONTRACTUAL SECTION.

           MOVE 0   TO CONTRACTUAL.
           MOVE 1   TO CSUB.
           MOVE 1   TO CTFC-NM.
           MOVE " " TO CPOT30
                       CPOTCHGOFF.

           IF LN-CURBAL = 0
              IF SP-BANKRULE = "D"
                 MOVE 1 TO RSUB
                           RDSUB
                 MOVE 0 TO RECENCY
                           RECDEL
                 MOVE " " TO RDPOT30
                             RDPOTCHGOFF
              END-IF
              IF SP-BANKRULE = "F"
                 MOVE 1 TO RSUB
                           RDSUB
                 MOVE 0 TO RECENCY
                           RECDEL
                 MOVE " " TO RDPOT30
                             RDPOTCHGOFF
              END-IF
              GO TO COMPUTE-CONTRACTUAL-EXIT.

      *********************************************************************
      *    SP-BANKRULE = D   (WORLD)
      *
      *    -  AFTER A MONTHEND:
      *     [ RECENCY CURRENT # & $ ]  =  [ CONTRACTUAL CURRENT # & $ ]
      *********************************************************************

           IF SP-BANKRULE = "D"
              PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
              MOVE LN-1STPYDATE   TO CEPP1-DATE
              MOVE PDTH-DATE-FULL TO CEPP2-DATE
              MOVE "X"            TO CEPP-NOCAP-FG
              MOVE 1              TO CEPP1-DA
                                     CEPP2-DA
              PERFORM CONTRACTUAL-ELAPSED-PAYPER
              MOVE CEPP-PERIODS TO AGEING-HOLD
              PERFORM COMPUTE-CONTRACTUAL-D
              GO TO COMPUTE-CONTRACTUAL-POT-CHGOFF.

      *********************************************************************
      *    SP-BANKRULE = F   (WORLD MX NON MONTHLY)
      *
      *    -  AFTER A MONTHEND:
      *     [ RECENCY CURRENT # & $ ]  =  [ CONTRACTUAL CURRENT # & $ ]
      *********************************************************************
           IF SP-BANKRULE = "F"
              PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
              MOVE LN-1STPYDATE   TO CEPP1-DATE
              MOVE PDTH-DATE-FULL TO CEPP2-DATE
              MOVE "X"            TO CEPP-NOCAP-FG
              PERFORM CONTRACTUAL-ELAPSED-PAYPER
              MOVE CEPP-PERIODS TO AGEING-HOLD
              PERFORM COMPUTE-CONTRACTUAL-F
              GO TO COMPUTE-CONTRACTUAL-POT-CHGOFF.

      *********************************************************************
      *    SP-BANKUNITPER-CD = E   (TFC)
      *
      *    CONTRACTUAL IS BASED ON THE NUMBER OF PAY PERIODS
      *    FROM ( PAID THRU + 1 PAY PERIOD ) TO AGEING DATE  [ CTFC-NM ]
      *
      *     0 -  1  CURRENT        14 - 17   90
      *     2 -  5  POT            18 - 21  120
      *     6 -  9  30             22 - 25  150
      *    10 - 13  60             26 - 29  180
      *                            30 - ..  210+
      *********************************************************************
           IF (LN-UNITPER-CD NOT = "M") AND (SP-BANKUNITPER-CD = "E")
                IF LN-CURBAL <= 0
                   MOVE 0 TO CSUB
                             CTFC-NM
                ELSE
                   PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
                   MOVE PDTH-DATE-FULL TO NDTE-DATE
                   MOVE 1              TO NDTE-HOLD
                   PERFORM INCREMENT-UNITPER
                   MOVE NDTE-DATE   TO NUM-DATE
                   MOVE AGEING-DATE TO SYS-DATE
                   PERFORM TIM365
                   IF ELAPSED-DAYS <= 0
                      MOVE 0 TO CSUB
                                CTFC-NM
                   ELSE
                      COMPUTE CTFC-NM = ELAPSED-DAYS / 7
                      IF CTFC-NM = 0 OR 1
                         MOVE 0 TO CSUB
                      ELSE
                         IF CTFC-NM > 30
                            MOVE 30 TO CTFC-NM
                         END-IF
                         COMPUTE CSUB = (CTFC-NM + 2) / 4
                      END-IF
                   END-IF
                END-IF
                GO TO COMPUTE-CONTRACTUAL-POT30.

      *****************************************************************
      * SP-BANKRULE = A OR C  AND  OTHER THAN MONTHLY UNIT PERIODS
      *
      *****************************************************************
           IF NOT (SP-BANKUNITPER-CD = "A" OR "D" OR "E")
              IF SP-BANKRULE = "A" OR "C"
                 IF LN-UNITPER-CD NOT = "M"
                    PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
                    MOVE PDTH-CUR-SCHD-DATE TO NUM-DATE
                    MOVE AGEING-DATE        TO SYS-DATE
                    MOVE 7                  TO NUM-DA
                                               S-DD
                    PERFORM TIM360
                    IF ELAPSED-MONTHS < 0
                       MOVE -1 TO ELAPSED-MONTHS
                    END-IF
                    MOVE ELAPSED-MONTHS TO CSUB
                    IF SP-BANKRULE = "C"
                       ADD 1 TO CSUB
                    END-IF
                    GO TO COMPUTE-CONTRACTUAL-POT30.

      *************************************************************
      *    SP-BANKUNITPER-CD = A & D  (INSTANT AUTO)
      *          A == 50% FACTOR
      *          D == 80% FACTOR
      *************************************************************

           IF SP-BANKUNITPER-CD = "A" OR "D"
              IF LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1
                 MOVE SP-CONTPDTH TO AGEING-HOLD-CONTPDTH
                 MOVE 100 TO SP-CONTPDTH
                 PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
                 MOVE AGEING-HOLD-CONTPDTH TO SP-CONTPDTH
              ELSE
                 PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
              END-IF
              PERFORM COMPUTE-CONTR-UNITP-A-D
              GO TO COMPUTE-CONTRACTUAL-POT30.

      *************************************************************
      *    SP-BANKUNITPER-CD = B   (FL AUTO)
      *
      *    CONTRACTUAL IS BASED ON PASTDUE MONTHS
      *************************************************************
           IF SP-BANKUNITPER-CD = "B"
              IF LN-UNITPER-CD NOT = "M"
                 PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
                 MOVE PDTH-CUR-SCHD-DATE TO NUM-DATE
                 MOVE AGEING-DATE        TO SYS-DATE
                 PERFORM TIM360
                 COMPUTE CSUB = ELAPSED-MONTHS + 1
                 GO TO COMPUTE-CONTRACTUAL-POT30.

      *************************************************************
      *    SP-BANKUNITPER-CD = C   (FL AUTO)
      *
      *    CONTRACTUAL IS BASED ON TRUE PASTDUE DAYS
      *************************************************************
           IF SP-BANKUNITPER-CD = "C"
              IF LN-UNITPER-CD NOT = "M"
                 PERFORM COMPUTE-CONTRACTUAL-GET-PDTH
                 MOVE PDTH-CUR-SCHD-DATE TO NUM-DATE
                 MOVE AGEING-DATE        TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS < 0
                    MOVE 0 TO CSUB
                 ELSE
                    COMPUTE CSUB = ELAPSED-DAYS / 30 + 1
                 END-IF
                 GO TO COMPUTE-CONTRACTUAL-POT30.

      * FIND ELAPSED PERIODS THRU TODAY:

           PERFORM COMPUTE-CONTRACTUAL-PAYS-TODAY.

      * GET PAIDTHRU:

           PERFORM COMPUTE-CONTRACTUAL-GET-PDTH.

      * FIND ELAPSED PERIODS THRU PAIDTHRU:

           MOVE LN-1STPYDATE TO CEPP1-DATE.
           MOVE PDTH-DATE-FULL TO CEPP2-DATE.
           MOVE "X" TO CEPP-NOCAP-FG.

      *JTG 080697 WHEN DUE DATE IS EX. 30TH AND PAIDTHRU MONTH
      *           IS FEBURARY PDTH = 022897 AND WHEN TODAY IS
      *           EX. 043097 ELAPSED PAY PERIODS IS OFF BY 1

           IF SP-BANKRULE = "B" OR "E"
              MOVE CEPP2-DA TO CEPP1-DA.

      *JTG 042997 WHEN DUE DATE IS EX. 30TH AND PAIDTHRU MONTH
      *           IS FEBURARY PDTH = 022897 AND WHEN TODAY IS
      *           EX. 043097 ELAPSED PAY PERIODS IS OFF BY 1

           IF SP-BANKRULE = "A" OR "C"
              MOVE 1 TO CEPP1-DA
                        CEPP2-DA.

           PERFORM CONTRACTUAL-ELAPSED-PAYPER.

      * COMPUTE CSUB:

           IF NOT (SP-BANKRULE = "B" OR "C" OR "E")
              ADD 1 TO CEPP-PERIODS.
           COMPUTE CSUB = AGEING-HOLD - CEPP-PERIODS.

      *    TEST FOR POTENTIAL 30'S AND MISSPAY'S
      
       COMPUTE-CONTRACTUAL-POT30.

      *************************************************************
      *   MERCURY POTENTIAL 30 CODE = 'A'
      *      ALL CURRENT ACCOUNTS THAT ARE NOT PAID AHEAD
      *      ARE CONSIDERED POTENTIAL 30
      *************************************************************

           IF SP-CPOT30-CD = "A"
      * CURRENT PAID AHEAD'S ARE NOT POTENTIAL 30:
              IF CSUB = 1
                 MOVE "Y" TO CPOT30.

      * TEST FOR POTENTIAL CHARGE OFF'S
      
       COMPUTE-CONTRACTUAL-POT-CHGOFF.

           IF SP-BANKRULE = "F"
              IF CSUB > 2
                 DIVIDE CSUB BY 2 GIVING AGEING-SUB-WORKER
                                  REMAINDER AGEING-SUB-REMAIN
                 IF AGEING-SUB-REMAIN NOT = 0
                    ADD 1 TO AGEING-SUB-WORKER
                 END-IF
                 MOVE AGEING-SUB-WORKER TO CSUB.

      *****************************************************
      *  POTENTIAL CHARGE OFF'S CODE = 'A'
      *    ALL ACCOUNTS THAT ARE 150 DAYS OR MORE
      *    (USED TO BE MERCURY'S CODE)
      *****************************************************

           IF SP-CPOTCHGOFF-CD = "A"
              IF CSUB > 5
                 IF LN-PLCD = " "
                    IF CSUB > 6
                       MOVE "M" TO CPOTCHGOFF
                    ELSE
                       MOVE "Y" TO CPOTCHGOFF
                    END-IF
                 END-IF
              END-IF
           ELSE
      * REGENCY POTENTIAL CHARGE OFF'S CODE = 'B'
      * ALL ACCOUNTS THAT ARE 180 DAYS OR MORE
           IF SP-CPOTCHGOFF-CD = "B"
              IF CSUB > 6
                 IF LN-PLCD = " "
                    IF CSUB > 7
                       MOVE "M" TO CPOTCHGOFF
                    ELSE
                       MOVE "Y" TO CPOTCHGOFF
                    END-IF
                 END-IF
              END-IF
      * MERCURY POTENTIAL CHARGE OFF'S CODE = 'C'
      * ALL ACCOUNTS THAT ARE 120 DAYS OR MORE
           ELSE
           IF SP-CPOTCHGOFF-CD = "C"
              IF CSUB > 4
                 IF LN-PLCD = " "
                    IF CSUB > 5
                       MOVE "M" TO CPOTCHGOFF
                    ELSE
                       MOVE "Y" TO CPOTCHGOFF.

       COMPUTE-CONTRACTUAL-CONTINUE.
           IF CSUB < 1
              MOVE 1 TO CSUB.

           COMPUTE CONTRACTUAL = (CSUB * 30) - 30.

           IF CSUB > 8
              MOVE 8 TO CSUB
           ELSE
           IF CPOT30 = "M"
              MOVE 9 TO CSUB
           ELSE
           IF CPOT30 = "Y"
              MOVE 10 TO CSUB.

       COMPUTE-CONTRACTUAL-EXIT.
           MOVE " " TO CSUB-ALDEL-FG.

      * SET EXTERNAL INDEXES FROM INTERNAL:
      
           IF CSUB = 1
              MOVE 10 TO CSUB
           ELSE
              SUBTRACT 1 FROM CSUB.

      ************************************************
      *    COMPUTE CONTRACURAL PAYS THRU TODAY
      ************************************************
       COMPUTE-CONTRACTUAL-PAYS-TODAY SECTION.
           MOVE LN-1STPYDATE TO CEPP1-DATE.
           MOVE AGEING-DATE  TO CEPP2-DATE.
           MOVE "X"          TO CEPP-NOCAP-FG.
           IF SP-BANKRULE = "A" OR "C"
              MOVE 1         TO CEPP1-DA
                                CEPP2-DA.
           PERFORM CONTRACTUAL-ELAPSED-PAYPER.
           MOVE CEPP-PERIODS TO AGEING-HOLD.

      ************************************************
      *    GET PAIDTHRU
      ************************************************
       COMPUTE-CONTRACTUAL-GET-PDTH SECTION.
           MOVE LN-TOTPAYMNTD TO AGEING-TOTPAYMNTD-SV.
           IF SP-BANKRULE = "E"
              COMPUTE AGEING-E-1STPYAMT ROUNDED =
                        (LN-1STPYAMT * SP-BANKRULE-RATE)/100
              COMPUTE AGEING-E-REGPYAMT ROUNDED =
                        (LN-REGPYAMT * SP-BANKRULE-RATE)/100
              COMPUTE AGEING-E-LASTPYAMT ROUNDED =
                        (LN-LASTPYAMT * SP-BANKRULE-RATE)/100
              MOVE "E" TO PDTH-E-OPTION
           ELSE
             MOVE LN-1STPYAMT  TO AGEING-E-1STPYAMT
             MOVE LN-REGPYAMT  TO AGEING-E-REGPYAMT
             MOVE LN-LASTPYAMT TO AGEING-E-LASTPYAMT.

           IF SP-CONTR-CREDIT-CD NOT = " "
      * CREDIT IS BASED ON TOTAL PAYS MADE:
              IF SP-CONTR-CREDIT-CD = "A"
                 COMPUTE AGEING-WORK =
                    ( LN-TOTPAYMNTD /
                           (AGEING-E-REGPYAMT - SP-CONTR-CREDIT)
                            - LN-TOTPAYMNTD / AGEING-E-REGPYAMT
                    ) * AGEING-E-REGPYAMT
                 COMPUTE LN-TOTPAYMNTD =
                                LN-TOTPAYMNTD + AGEING-WORK
                                 + SP-CONTR-CREDIT-MIN-DEL-PER
                                 * AGEING-E-REGPYAMT * .01
              ELSE
      * CREDIT IS BASED ON ELAPSED PAY PERIODS:
              IF SP-CONTR-CREDIT-CD = "B"
                 COMPUTE LN-TOTPAYMNTD =
                     LN-TOTPAYMNTD + CEPP-PERIODS * SP-CONTR-CREDIT
                     + SP-CONTR-CREDIT-MIN-DEL-PER
                     * LN-REGPYAMT * .01.

           MOVE LN-1STPYDATE  TO PDTH-DATE-WORK.
           MOVE CSUB-ALDEL-FG TO PDTH-ALDEL-FG.
           PERFORM PAID-THRU-CALCULATION.
           MOVE PDTH-REMAIN   TO AGEING-HOLD-REMAIN.

           MOVE AGEING-TOTPAYMNTD-SV TO LN-TOTPAYMNTD.


      *******************************************************
      *    CONTRACTUAL FOR SP-BANKUNITPER-CD = 'A' OR 'D'
      *
      *          A == 50% FACTOR
      *          D == 80% FACTOR
      *
      *  NOTE:
      *       THIS FORMULA DEFAULTS TO SP-BANKRULE C
      *******************************************************
       COMPUTE-CONTR-UNITP-A-D SECTION.
           IF SP-BANKUNITPER-CD = "A"
              MOVE 0.50 TO AGEING-PERCENT-FACTOR
           ELSE
              MOVE 0.80 TO AGEING-PERCENT-FACTOR.

           IF LN-UNITPER-CD = "M" AND LN-UNITPER-FREQ = 1
              MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD
              MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
              MOVE PDTH-DATE-FULL  TO NUM-DATE
              MOVE AGEING-DATE     TO SYS-DATE
              MOVE 1               TO NUM-DA S-DD
              PERFORM TIMUPER
              IF AGEING-HOLD-REMAIN NOT < AGEING-PERCENT-FACTOR
                 SUBTRACT 1 FROM ELAPSED-UNITPER
              END-IF
              MOVE ELAPSED-UNITPER TO CSUB
              GO TO COMPUTE-CONTR-UNITP-A-D-EXIT.

      ********************************************************
      *    NON MONTHLY ACCOUNT LOGIC
      ********************************************************

      * SEE IF ACCOUNT IS NOT DUE THIS MONTH:

           MOVE AGEING-DATE        TO NUM-DATE.
           MOVE PDTH-CUR-SCHD-DATE TO SYS-DATE.
           MOVE 1                  TO NUM-DA S-DD.
           IF SYS-DATE > NUM-DATE
              MOVE 0 TO CSUB
              GO TO COMPUTE-CONTR-UNITP-A-D-EXIT.

           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.

           MOVE LN-1STPYDATE TO NDTE-DATE.
           MOVE -1           TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE    TO AGEING-WK-DATE.

      * GET NO. OF PAY PERIODS IN CURRENT PAID THRU MONTH
      * PRIOR TO AND INCLUDING PAID THRU:
      
           MOVE PDTH-DATE-FULL TO NUM-DATE
                                  NDTE-DATE.
           MOVE 0              TO AGEING-NO-PAID.
           MOVE -1             TO NDTE-HOLD.
           PERFORM UNTIL ( (NUM-MO NOT = NDTE-MM)
                                OR (NDTE-DATE = AGEING-WK-DATE)
                         )
               IF NDTE-DATE NOT = AGEING-WK-DATE
                  ADD 1 TO AGEING-NO-PAID
               END-IF
               PERFORM INCREMENT-UNITPER
           END-PERFORM.

      * GET NO. OF PAY PERIODS IN CURRENT PAID THRU MONTH
      * THAT HAVEN BEEN PAID:
      
           MOVE PDTH-DATE-FULL TO NUM-DATE
                                  NDTE-DATE.
           MOVE +1             TO NDTE-HOLD.
           MOVE -1             TO AGEING-NO-TOBE-PAID.
           PERFORM UNTIL (NUM-MO NOT = NDTE-MM)
               PERFORM INCREMENT-UNITPER
               ADD 1 TO AGEING-NO-TOBE-PAID
           END-PERFORM.

      * TEST IF PAID THRU MONTH HAS NO PAYMENT REQUIREMENTS
      
           COMPUTE AGEING-WORK = AGEING-NO-PAID + AGEING-NO-TOBE-PAID.
           IF AGEING-WORK = 0
              MOVE PDTH-DATE-FULL TO NDTE-DATE
              MOVE 1 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE TO PDTH-DATE-FULL
           ELSE
      * TEST AGAINST AGEING-PERCENT TO SEE IF MONTH SHOULD BE BUMPED
              IF ( (AGEING-NO-PAID + AGEING-HOLD-REMAIN)
                                              / AGEING-WORK )
                               NOT < AGEING-PERCENT-FACTOR
                 MOVE PDTH-DATE-FULL TO NDTE-DATE
                 MOVE 1 TO NDTE-HOLD
                 PERFORM INCREMENT-MONTHS
                 MOVE NDTE-DATE TO PDTH-DATE-FULL.

      * DETERMINE CONTRACTUAL AGE
      
           MOVE PDTH-DATE-FULL TO NUM-DATE.
           MOVE AGEING-DATE    TO SYS-DATE.
           MOVE 1              TO NUM-DA S-DD.
           PERFORM TIM360.
           ADD 1 ELAPSED-MONTHS GIVING CSUB.

       COMPUTE-CONTR-UNITP-A-D-EXIT.
           EXIT.

      ********************************************************************
      *   AGEING - COMPUTE-CONTRACTUAL WORLD FORMULA D
      *
      *          CPOT30         'Y' OR 'M' OR ' '
      *
      *                          Y  - POTENTIAL (1 TO 29 DAYS PAST DUE
      *                                            AND RECENCY POTENTIAL)
      *                          M  - MISS PAY (1 TO 29 DAYS PAST DUE
      *                                              AND RECENCY CURRENT)
      *                          SP - CURRENT OR CONTRACTUALLY DELINQUENT
      * NOTE:
      *    MISPAYS ARE:
      *       ACCOUNTS THAT ARE 1-29 DAYS PAST DUE AND RECENCY CURRENT,
      *                         BUT NOT RECENCY <P> OR MORE.
      *    -  AFTER A MONTHEND:
      *     [ RECENCY CURRENT # & $ ]  =  [ CONTRACTUAL CURRENT # & $ ]
      ********************************************************************
       COMPUTE-CONTRACTUAL-D SECTION.

           MOVE "X" TO CEPP-NOCAP-FG.

           MOVE AGEING-DATE TO NDTE-DATE.
           MOVE 35          TO NDTE-DD.
           MOVE -1          TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE   TO CEPP2-DATE.

           PERFORM CONTRACTUAL-ELAPSED-PAYPER.
           COMPUTE CSUB = CEPP-PERIODS - AGEING-HOLD.
           IF CSUB = 1
              MOVE "Y" TO CPOT30.

           IF CSUB < 1
              MOVE 1 TO CSUB.

           PERFORM RECENCY-ROUTINE.

      * TEST FOR MISPAYS:

           IF CSUB NOT = 1 OR CPOT30 = "Y"
              GO TO COMPUTE-CONTRACTUAL-D-EXIT.

           IF RDSUB NOT = 1 OR RDPOT30 = "Y"
              GO TO COMPUTE-CONTRACTUAL-D-EXIT.

           MOVE AGEING-DATE  TO PDUE-TODAY-DATE.
           MOVE LN-1STPYDATE TO PDUE-1STPYDATE.
           PERFORM PAST-DUE-DAYS-CALCULATION.
           IF PDUE-DAYS > 0
              MOVE "M" TO CPOT30.

       COMPUTE-CONTRACTUAL-D-EXIT.
           PERFORM COMPUTE-RECENCY-SET-EXTERNAL.
           MOVE " " TO CSUB-ALDEL-FG.

      ********************************************************************
      *   AGEING - COMPUTE-CONTRACTUAL WORLD FORMULA F (MX NON MONTHLY)
      *
      *          CPOT30         'Y' OR 'M' OR ' '
      *
      *                          Y  - POTENTIAL (1 TO 29 DAYS PAST DUE
      *                                            AND RECENCY POTENTIAL)
      *                          M  - MISS PAY (1 TO 29 DAYS PAST DUE
      *                                              AND RECENCY CURRENT)
      *                          SP - CURRENT OR CONTRACTUALLY DELINQUENT
      * NOTE:
      *    MISPAYS ARE:
      *       ACCOUNTS THAT ARE 1-29 DAYS PAST DUE AND RECENCY CURRENT,
      *                         BUT NOT RECENCY <P> OR MORE.
      *    -  AFTER A MONTHEND:
      *     [ RECENCY CURRENT # & $ ]  =  [ CONTRACTUAL CURRENT # & $ ]
      ********************************************************************
       COMPUTE-CONTRACTUAL-F SECTION.

           MOVE "X" TO CEPP-NOCAP-FG.

           MOVE AGEING-DATE TO NDTE-DATE.
           MOVE 35          TO NDTE-DD.
           MOVE -1          TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE   TO CEPP2-DATE.

           PERFORM CONTRACTUAL-ELAPSED-PAYPER.
           COMPUTE CSUB = CEPP-PERIODS - AGEING-HOLD.
           IF CSUB = 1 OR 2
              MOVE "Y" TO CPOT30.

           IF CSUB < 1
              MOVE 1 TO CSUB.

           PERFORM RECENCY-ROUTINE.

      * TEST FOR MISPAYS:

           IF CSUB NOT = 1
                    OR CPOT30 = "Y"
              GO TO COMPUTE-CONTRACTUAL-F-EXIT.

           IF RDSUB NOT = 1
                     OR RDPOT30 = "Y"
              GO TO COMPUTE-CONTRACTUAL-F-EXIT.

           MOVE AGEING-DATE  TO PDUE-TODAY-DATE.
           MOVE LN-1STPYDATE TO PDUE-1STPYDATE.
           PERFORM PAST-DUE-DAYS-CALCULATION.
           IF PDUE-DAYS > 0
              MOVE "M" TO CPOT30.

       COMPUTE-CONTRACTUAL-F-EXIT.
           PERFORM COMPUTE-RECENCY-SET-EXTERNAL.
           MOVE " " TO CSUB-ALDEL-FG.

      *************************************************************************
      *   NAME:  AGEING - COMPUTE-PAID-AHEAD
      *   DESC:  COMPUTES PAID AHEAD WHICH IDENTIFIES THOSE ACCOUNTS
      *          THAT ARE CONTRACTUALLY CURRENT FOR EACH RECENCY BUCKET
      *
      *   IN  :  RSUB, CSUB
      *   OUT :  PSUB
      *
      *       N O T E:
      *                PSUB MUST BE > 0 TO BE VALID
      *-----------------------------------------------
      *
      *   PSUB      INTERNAL & EXTERNAL
      *   -----     -------------------
      *     1   -    30
      *     2   -    60
      *     3   -    90
      *     4   -   120
      *     5   -   150
      *     6   -   180
      *     7   -   210+
      *     8   -   N/A
      *     9   -   POTENTIAL 30
      *    10   -   CURRENT
      *-----------------------------------------------
      * REV:
      *  JTG 010787 TOOK OUT CHECK ON RSUB > 1 TO ALLOW PAID AHEADS
      *             TO APPEAR FOR RECENCY CURRENT ACCOUNTS
      *  JTG 091597 ADDED LOGIC TO TEST FOR MISSPAY & POTS WHICH ARE CURRENT
      *  BLV 091897 USE RDSUB, NOT RSUB
      *************************************************************************
       COMPUTE-PAID-AHEAD SECTION.
           MOVE 0 TO PSUB.
           IF CSUB = 8 OR 9 OR 10
              MOVE RDSUB TO PSUB.

      *================================================================*
      * END COPYBOOK: LIBGB\AGEING.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPUPWK.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPUPWK
      *****************************************************************
      *         CALCULATE DEFERMENT ADJUSTMENT FOR UNIT PERIODS
      *         FROM ESTABLISHED LOAN RECORD
      *
      *   NAME: LPUPWK
      *   DESC: DETERMINE AJUSTMENT FOR DEFERMENT USAGE
      *
      *   IN  : UPWK-UNITPER-CD         (LN-UNITPER-CD)
      *         UPWK-UNITPER-FREQ       (LN-UNITPER-FREQ)
      *
      *   OUT : UPWK-UNITPER-WK
      *         UPWK-ERRCD
      *
      *   COPY:
      * REV:
      *  071696 UNCOMMENTED CODE TO WORK WITH WEEKLY (A50 CONV)
      *****************************************************************
       UPWK-DEF-CALC SECTION.
           MOVE " " TO UPWK-ERRCD.

      *M   MOVE 1 TO UPWK-UNITPER-WK.
      *MTHE ABOVE LINE IS TEMPORARY RE: STARED OUT LINES:
           IF SP-DEFUNITPER-CD NOT = "A"
              MOVE 1 TO UPWK-UNITPER-WK
              GO TO UPWK-DEF-CALC-EXIT.

           IF UPWK-UNITPER-FREQ NOT = 1
              PERFORM UPWK-CALC-DEF-WK
           ELSE
           IF UPWK-UNITPER-CD = "M"
              MOVE 1 TO UPWK-UNITPER-WK
           ELSE
           IF UPWK-UNITPER-CD = "W"
              MOVE 4 TO UPWK-UNITPER-WK
           ELSE
           IF UPWK-UNITPER-CD = "B" OR "S"
              MOVE 2 TO UPWK-UNITPER-WK
           ELSE
              PERFORM UPWK-CALC-DEF-WK.

       UPWK-DEF-CALC-EXIT.
           EXIT.

      *****************************************************************
      *    CALCULATE UNIT PERIOD WORKER FOR DEFERMENTS
      *****************************************************************
       UPWK-CALC-DEF-WK SECTION.
           PERFORM UPWK-GET-UPER-INFO.
           IF UPWK-ERRCD = " "
              COMPUTE UPWK-UNITPER-WK =
                             UPWK-UNITPER-PER-YEAR / 12.

      ************************************************************************
      *         CALCULATE CONTRACTUAL ADJUSTMENT FOR UNIT PERIODS
      *         FROM ESTABLISHED LOAN RECORD
      *
      *   NAME: LPUPWK
      *   DESC: DETERMINE AJUSTMENT FOR CONTRACTUAL USAGE
      *
      *   IN  : UPWK-UNITPER-CD         (LN-UNITPER-CD)
      *         UPWK-UNITPER-FREQ       (LN-UNITPER-FREQ)
      *
      *   OUT : UPWK-UNITPER-WK
      *         UPWK-ERRCD
      *
      *   COPY:
      * REV:
      *  MLD 071696 UNCOMMENTED CODE TO WORK WITH WEEKLY (A50 CONV)
      *  JTG 071696 ADDED SP-BANKUNITPER-CD & SP-TRWBANKUNITPER-CD = "B"
      *             (FL AUTO)
      *  JTG 090897 CORRECTED TEST ON SP-BANKUNITPER-CD TO INCLUDE 'C' & 'D'
      ************************************************************************
       UPWK-CONTR-CALC SECTION.
           MOVE " " TO UPWK-ERRCD.

      *M   MOVE 1 TO UPWK-UNITPER-CONTR-WK.
      *MTHE ABOVE LINE IS TEMPORARY RE: STARED OUT LINES:
      *    IF NOT (SP-BANKUNITPER-CD = "A" OR "B")
           IF NOT (SP-BANKUNITPER-CD = "A" OR "B" OR "C" OR "D")
              MOVE 1 TO UPWK-UNITPER-CONTR-WK
              GO TO UPWK-CONTR-CALC-EXIT.

           IF UPWK-UNITPER-FREQ NOT = 1
              PERFORM UPWK-CALC-CONTR-WK
           ELSE
           IF UPWK-UNITPER-CD = "M"
              MOVE 1 TO UPWK-UNITPER-CONTR-WK
           ELSE
           IF UPWK-UNITPER-CD = "W"
              MOVE 4 TO UPWK-UNITPER-CONTR-WK
           ELSE
           IF UPWK-UNITPER-CD = "B" OR "S"
              MOVE 2 TO UPWK-UNITPER-CONTR-WK
           ELSE
              PERFORM UPWK-CALC-CONTR-WK.

       UPWK-CONTR-CALC-EXIT.
           EXIT.

      *****************************************************************
      *    CALCULATE UNIT PERIOD WORKER FOR CONTRACTUAL
      *****************************************************************
       UPWK-CALC-CONTR-WK SECTION.
           PERFORM UPWK-GET-UPER-INFO.
           IF UPWK-ERRCD = " "
              COMPUTE UPWK-UNITPER-CONTR-WK =
                             UPWK-UNITPER-PER-YEAR / 12.

      *****************************************************************
      *         CALCULATE DEFERMENT ADJUSTMENT FOR UNIT PERIODS
      *         FROM ESTABLISHED LOAN RECORD
      *
      *   NAME: LPUPWK
      *   DESC: DETERMINE AJUSTMENT FOR LATE CHARGE USAGE
      *
      *   IN  : UPWK-UNITPER-CD         (LN-UNITPER-CD)
      *         UPWK-UNITPER-FREQ       (LN-UNITPER-FREQ)
      *
      *   OUT : UPWK-UNITPER-WK
      *         UPWK-ERRCD
      *
      *   COPY:
      * REV:
      *  071696 UNCOMMENTED CODE TO WORK WITH WEEKLY (A50 CONV)
      *****************************************************************
       UPWK-LC-CALC SECTION.
           MOVE " " TO UPWK-ERRCD.

           MOVE 100 TO UPWK-LC-PER-FAC
                       UPWK-LC-MIN-FAC
                       UPWK-LC-MAX-FAC
                       UPWK-LC-GRACE-FAC.

           IF SP-LCUNITPER-CD NOT = "A"
              GO TO UPWK-LC-CALC-EXIT.

           IF NOT (UPWK-UNITPER-CD = "M"
                             AND UPWK-UNITPER-FREQ = 1)
              IF UPWK-UNITPER-FREQ NOT = 1
                 PERFORM UPWK-CALC-LC-WK
              ELSE
              IF UPWK-UNITPER-CD = "W"
                 MOVE 20.0 TO UPWK-LC-PER-FAC
                              UPWK-LC-MIN-FAC
                              UPWK-LC-MAX-FAC
                 MOVE 30.0 TO UPWK-LC-GRACE-FAC
              ELSE
              IF UPWK-UNITPER-CD = "B" OR "S"
                 MOVE 50.0 TO UPWK-LC-PER-FAC
                              UPWK-LC-MIN-FAC
                              UPWK-LC-MAX-FAC
                              UPWK-LC-GRACE-FAC
              ELSE
                 PERFORM UPWK-CALC-LC-WK.

       UPWK-LC-CALC-EXIT.
           EXIT.

      *****************************************************************
      *    CALCULATE UNIT PERIOD WORKERS FOR LATE CHARGES
      *****************************************************************
       UPWK-CALC-LC-WK SECTION.
           PERFORM UPWK-GET-UPER-INFO.
           IF UPWK-ERRCD = " "
              COMPUTE UPWK-LC-PER-FAC
                      UPWK-LC-MAX-FAC
                      UPWK-LC-GRACE-FAC = 12 / UPWK-UNITPER-PER-YEAR.


      *****************************************************************
      *         GET INFORMATION ON UNIT PERIODS
      *         FROM ESTABLISHED LOAN RECORD
      *
      *   NAME: LPUPWK
      *   DESC: DETERMINE NO. OF UNIT PERIODS PER YEAR
      *                   NO. OF DAYS IN THE UNIT PERIOD
      *
      *   IN  : UPWK-UNITPER-CD         (LN-UNITPER-CD)
      *         UPWK-UNITPER-FREQ       (LN-UNITPER-FREQ)
      *
      *   OUT : UPWK-UNITPER-PER-YEAR
      *         UPWK-DAYS-IN-UNITPER
      *         UPWK-ERRCD
      *
      *   COPY:
      * REV:
      *  071696 UNCOMMENTED CODE TO WORK WITH WEEKLY (A50 CONV)
      *****************************************************************
       UPWK-GET-UPER-INFO SECTION.
           MOVE " " TO UPWK-ERRCD.

           IF (UPWK-UNITPER-FREQ = 0)
                 OR (NOT
                        (UPWK-UNITPER-CD = "M" OR "S" OR "W"
                                                 OR "B" OR "D" OR "Y")
                    )
              MOVE "E" TO UPWK-ERRCD
              GO TO UPWK-GET-UPER-INFO-EXIT.

           IF UPWK-UNITPER-CD = "M"
              COMPUTE UPWK-UNITPER-PER-YEAR = 12 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 30 * UPWK-UNITPER-FREQ
           ELSE
           IF UPWK-UNITPER-CD = "S"
              COMPUTE UPWK-UNITPER-PER-YEAR = 24 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 15 * UPWK-UNITPER-FREQ
           ELSE
           IF UPWK-UNITPER-CD = "W"
              COMPUTE UPWK-UNITPER-PER-YEAR = 52 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 7 * UPWK-UNITPER-FREQ
           ELSE
           IF UPWK-UNITPER-CD = "B"
              COMPUTE UPWK-UNITPER-PER-YEAR = 26 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 14 * UPWK-UNITPER-FREQ
           ELSE
           IF UPWK-UNITPER-CD = "D"
              COMPUTE UPWK-UNITPER-PER-YEAR = 365 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 1 * UPWK-UNITPER-FREQ
           ELSE
           IF UPWK-UNITPER-CD = "Y"
              COMPUTE UPWK-UNITPER-PER-YEAR = 1 / UPWK-UNITPER-FREQ
              COMPUTE UPWK-DAYS-IN-UNITPER = 365 * UPWK-UNITPER-FREQ.

       UPWK-GET-UPER-INFO-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPUPWK.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPSCHD.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPSCHD
      *********************************************************
      *          UNPACK LOAN PAYMENT SCHEDULE
      *
      *   NAME:  LPSCHD
      *
      *   DESC:  EXPANDS (LT) LOAN PAYMENT SCHEDULE INTO
      *          A (SCHD) PER PAYMENT TABLE.
      *
      *   IN  :  LT-PAY-SCHLD-TBL (1 - 17)
      *   OUT :  SCHD-AMT (1 - 360)
      *
      *   USED:  SCHD-SUB, SCHD-SUB2 FOR TABLE INDICES.
      *          SCHD-SUB3 FOR A COUNTER.
      * REV:
      *  JTG 030293 REVISED TO HANDLE LT-PAY-SCHLD-TBL (17)
      *  BAH 160113 SPLIT OUT LTFILE, LTPFILE, PD0003
      *********************************************************
       UNPACK-PAYMENT-SCHEDULE SECTION.
           MOVE LOW-VALUES TO SCHD-PAYMENT-TABLE.
           MOVE 1 TO SCHD-SUB SCHD-SUB2.
           PERFORM UNPACK-LT
              UNTIL SCHD-SUB > 17 OR
                    LTP-SCHLD-TERM(SCHD-SUB) = 0.

       EXIT-UNPACK-PAYMENT-SCHEDULE.
           EXIT.

       UNPACK-LT SECTION.
           MOVE 0 TO SCHD-SUB3.
           PERFORM MOVE-PAYMENT
              UNTIL SCHD-SUB3 = LTP-SCHLD-TERM(SCHD-SUB).
           ADD 1 TO SCHD-SUB.

       EXIT-UNPACK-LT.
           EXIT.

       MOVE-PAYMENT SECTION.
           MOVE LTP-SCHLD-PAYMNT(SCHD-SUB) TO SCHD-AMT(SCHD-SUB2).
           ADD 1 TO SCHD-SUB2 SCHD-SUB3.

       EXIT-MOVE-PAYMENT.
           EXIT.

      *********************************************************
      *          PACK LOAN PAYMENT SCHEDULE
      *
      *   NAME:  LPSCHD
      *
      *   DESC:  REDUCES (SCHD) FROM EXPANDED TO FIT
      *          BACK IN THE LTFILE.
      *
      *   IN  :  SCHD-AMT (1 - 360)
      *   OUT :  LT-PAY-SCHLD-TBL (1 - 17)
      *          SCHD-TERM
      *
      *   USED:  SCHD-SUB, SCHD-SUB2 FOR TABLE INDICES.
      *          SCHD-SUB3 FOR A COUNTER.
      *********************************************************
       PACK-PAYMENT-SCHEDULE SECTION.
           MOVE LOW-VALUES TO LTP-PAY-SCHLD-AREA.

           MOVE 0 TO SCHD-SUB3 SCHD-TERM.
           MOVE 1 TO SCHD-SUB SCHD-SUB2.
           PERFORM PACK-LT
              UNTIL SCHD-SUB > 360 OR
                    SCHD-AMT(SCHD-SUB) = 0.

       EXIT-PACK-PAYMENT-SCHEDULE.
           EXIT.

       PACK-LT SECTION.
           ADD 1 TO SCHD-SUB.
           PERFORM ADVANCE-SCHED
              UNTIL SCHD-AMT(SCHD-SUB) NOT =
                    SCHD-AMT(SCHD-SUB - 1).
           PERFORM MOVE-TO-LT.

       EXIT-PACK-LT.
           EXIT.

       MOVE-TO-LT SECTION.
           COMPUTE LTP-SCHLD-TERM(SCHD-SUB2) = SCHD-SUB - SCHD-SUB3 - 1.
           ADD LTP-SCHLD-TERM(SCHD-SUB2) TO SCHD-TERM.
           MOVE SCHD-AMT(SCHD-SUB - 1) TO LTP-SCHLD-PAYMNT(SCHD-SUB2).
           COMPUTE SCHD-SUB3  = SCHD-SUB - 1.
           ADD 1 TO SCHD-SUB2.

       EXIT-MOVE-TO-LT.
           EXIT.

       ADVANCE-SCHED SECTION.
           ADD 1 TO SCHD-SUB.

       EXIT-ADVANCE-SCHED.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPSCHD.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPCEPP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPCEPP
      **********************************************************
      *         COMPUTE CONTRACTUAL ELAPSED PAY PERIODS
      *
      *   NAME: LPCEPP
      *   DESC: THIS ROUTINE RETURNS THE NUMBER OF
      *         ELAPSED (CONTRACTUAL) PAY PERIODS
      *         AND THE REMAINING PORTION, IF ANY, IN DAYS.
      *
      *         DEFERRED AND ALLOWABLE DELINQUENT PERIODS
      *         ARE NOT CONSIDERED BY DEFAULT.
      *
      *         CALCULATIONS ARE CAPPED AT MATURITY
      *         BY DEFAULT.
      *
      *         NOTE:
      *               IF CEPP-INCDEF-FG HAS A VALUE
      *               OTHER THAN SPACES, DEFERRED
      *               PERIODS WILL BE CONSIDERED.
      *
      *               IF CEPP-INCALDEL-FG HAS A VALUE
      *               OTHER THAN SPACES, ALLOWABLE
      *               DELINQUENT PERIODS WILL BE CONSIDERED.
      *
      *               IF CEPP-NOCAP-FG HAS A VALUE
      *               OTHER THAN SPACES, ELAPSED
      *               PERIODS WILL NOT BE CAPPED
      *               AT ORIGINAL TERM.
      *
      *   IN  : CEPP1-DATE     (LN-1STPYDATE)
      *         CEPP2-DATE     (TODAYS DATE)
      *   OUT : CEPP-PERIODS
      *         CEPP-UNITPER-REM
      *
      *         N O T E:
      *                  CEPP1-DATE AND CEPP2-DATE NOT ALTERED
      *   USED:
      *   COPY: LPCEPPW
      * REV:
      *  031286 JTG STOPPED ALTERATION OF CEPPX-DATES.
      *  050986 JTG ADDED TEST ON CEPP-NOCAP-FG
      *             SO CONTRACTUAL AGEING DONE BY
      *             AGEING.IN.C WOULD COMPUTE CORRECTLY.
      *  052386 JTG ADDED LINE TO CLEAR CEPP-NOCAP-FG
      *  101686 JTG CHANGED TIME FROM 365 TO 360
      *             TO YIELD TRUE MONTHLY INTERVALS
      *  020287 JTG ADDED THE OPTION OF INCLUDING
      *             DEFERMENTS IN THE CALCULATION.
      *  040590 JTG INCLUDED LN-TOTNOALDEL IN CALCULATION
      *             WITH OPTIONAL DEFERMENTS FOR PACESETTER
      *  071696 JTG ADDED LOGIC FOR UNIT PERIODS
      *             ADDED RETURN OF CEPP-UNITPER-REM (CAC) FL
      *  090696 JTG CORRECTED BUG YIELDING 1 ELAPSED PAY PERIOD
      *             WHEN TODAY IS PRIOR TO FIRST PAY DUE DATE
      **********************************************************
       CONTRACTUAL-ELAPSED-PAYPER SECTION.
           MOVE 0 TO CEPP-PERIODS
                     CEPP-UNITPER-REM.

      * SEE IF TODAY IS PRIOR TO FIRST PAY DATE:
           MOVE CEPP1-DATE TO NUM-DATE.
           MOVE CEPP2-DATE TO SYS-DATE.
           IF SYS-DATE < NUM-DATE
              GO TO CONTRAL-ELAPSED-PAYPER-EXIT.

           IF CEPP-NOCAP-FG = " "
              PERFORM MATURITY-DATE-CALCULATION
              MOVE MDTE-DATE TO NUM-DATE
              MOVE CEPP2-DATE TO SYS-DATE
              IF SYS-DATE > NUM-DATE
                 MOVE MDTE-DATE TO SYS-DATE
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE CEPP2-DATE TO SYS-DATE.

           MOVE CEPP1-DATE TO NUM-DATE.
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM TIMUPER.
           IF ELAPSED-DAYS < 0
              GO TO CONTRAL-ELAPSED-PAYPER-EXIT.

           MOVE ELAPSED-UNITPER-REM TO CEPP-UNITPER-REM.

           IF CEPP-INCDEF-FG = " "
              SUBTRACT LN-TOTNODEF FROM ELAPSED-UNITPER.

           IF CEPP-INCALDEL-FG = " "
              SUBTRACT LN-TOTNOALDEL FROM ELAPSED-UNITPER.

           ADD 1 ELAPSED-UNITPER GIVING CEPP-PERIODS.

           IF CEPP-PERIODS < 0
              MOVE 0 TO CEPP-PERIODS
                        CEPP-UNITPER-REM.

       CONTRAL-ELAPSED-PAYPER-EXIT.
           MOVE " " TO CEPP-NOCAP-FG
                         CEPP-INCDEF-FG
                           CEPP-INCALDEL-FG.


      *================================================================*
      * END COPYBOOK: LIBLP\LPCEPP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAPRS.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAPRS
      ***********************************************************************
      *   COMPUTE EQUIVALENT SIMPLE INTEREST RATE
      *
      *   NAME: LPAPRS
      *   DESC: THIS ROUTINE COMPUTES THE EQUIVALENT SIMPLE
      *         INTEREST RATE FOR A LOAN. THIS RATE IS
      *         SOMETIMES REFERRED TO AS THE STATE APR.
      *         APPROXIMATE APR TO 3 DECIMALS ACCURACY
      *
      *         SP-CAL-CHGABLE = FORMULA FOR DETERMINING THE
      *                          INTEREST CHARGABLE
      *         SP-PYEXFRMLA   = FORMULA FOR COMPUTING THE 1ST
      *                          PAYMENT EXTENSION CHARGE
      *         SP-CAL-RATETYPE= METHOD TO COMPUTE INTEREST
      *
      *   OUT : APRS-SMPRATE     - 2 DECIMAL APPROX ACCURACY.
      *         APRS-EFFRATE     - 2 DECIMAL APPROX ACCURACY.
      *         APRS-INTCHGABLE  - AMOUNT INTEREST WAS CHARGED ON.
      *         APRS-REGPYAMT    - PAYMENT TO COVER INTCHGABLE
      *                            AND INTEREST OVER TERM OF
      *                            LOAN.
      *         APRS-CTBL        - SPR CAL TABLE INDEX
      *
      *   COPY: LPAPRSW, LPAPRZ, LPAPR
      *
      * REV:
      *  JTG 062288 ADDED OUTPUT FOR INTCHGABLE AND REGPYAMT
      *  JTG 110388 FIXED BUG RE: INTCHGABLE INCLUDING EXTCHG
      *  JTG 080889 CHANGED TO RETURN INDEX TO RATE TABLE
      *  JTG 090391 CORRECTED ROUNDING PROBLEM FOR EFF RATE
      *             WHEN ZERO FINCHG
      *  JTG 011792 ADDED UNITPER LOGIC
      *  JTG 043093 SET APR-DISFRMLA AND NOT SP-DISFRMLA
      *  JTG 052493 MODIFIED FOR BALLOONS
      *  JTG 061093 ADDED LOGIC FOR SP-PYEXTFRMLA = 9
      *  JTG 062995 ADDED REF. TO ALL 10 INSURANCES
      *  JTG 040896 CORRECTED SINGLE PAYS AND BALLOONS
      *  JTG 043096 FIXED BUG IN USE OF UPER-FRACT-UNITPER
      *  JTG 111296 CHANGED LN-INSTBL (LEVEL'S 9 & 10) TO FILLER
      *  JTG 050697 ADDED USE OF SETCTBL COPY MEMBER
      *  JTG 101497 FIXED BUG WHEN ACCOUNT HAS MAINTENANCE FEES, CITIZENS
      *  JTG 093098 FIXED TO IS INSURE THAT WHEN THEIR IS NO ODD LAST PAY
      *             THAT THE RECOMPUTED APR-REGPYAMT IS ALSO USED
      *             FOR APR-LASTPYAMT
      *  JTG 100998 CORRECTED LOGIC TO CORRECTLY HANDLE BALLOONS
      *  JTG 122398 FIXED MISSING SET OF APRS-REGPYAMT FOR REFUND ROUTINES
      *  JTG 000619 ADDED LOGIC FOR TENNESSEE RATE TYPE 'M' FLAT MONTHLY CHARGE
      *             #1225
      *  JTG 000710 CORRECTED LOGIC WHEN CALCULATING EFFECTIVE RATES IN
      *             EAA-CALC-ADDON & EAA-CALC-DISCOUNT
      *  JTG 000914 CORRECTED BUG IN PASS TO SETCTBL, ROUTINE WAS PASSING
      *             LN-LNAMT INSTEAD OF INTEREST CHARGEABLE     WORLD #J011
      *  JTG 010228 ADDED NEW RATE TYPE 'Z' AMORTIZED WHERE RUNTIME COMPUTES
      *             INTEREST ON A 30 DAY METHOD (REAL ESTATE) AND LOAN CALCS
      *             ARE DONE SIMPLE                   LENDMARK PR#1045 & PR#1380
      *  JTG 020219 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *             ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS  WORLD #288
      *  JTG 020620 CHANGED FOR (MIP) MONTHLY INSURANCE PREMIUMS   REGENCY #1801
      *             USED NEW FIELD TOTAL-INSPREM-NONMEMO FROM LPAPRS
      *  JTG 030430 CREATED FORMULA 12 LIKE 2 BUT SPREADS EXTENSION CHARGE
      *             OVER PAYMENTS  88  SP-PYEXFRMLA-SAME2-SPREAD VALUE 12.
      *             ADDED APRS-SPREAD APRS-REM                    CITIZENS #2006
      *  JTG 031112 CHANGED LP-CALCZ3 AND LIBLP/LPAPRS LOGIC TO COMPUTE
      *             SIMPLE RATE FOR SINGLE PAY LOANS UNDER U.S.RULE
      *             DISCLOSURE METHOD 'C'                         LENDMARK #J036
      *  JTG 060728 CORRECTED PROBLEM WITH LN-EFFRATE AND LN-OVRRATE GOING
      *             AWAY AFTER LOAN BOOKING  LITIGANT LOANS       LENDMARK #J053
      *  MJD 091006 CORRECTED TO CORRECTLY CALCULATE APR WHEN MEXICO VAT
      *             TAX IS USED.  IT MAY BE TO LARGE FOR LN-MAINTFEE SO USE
      *             LN-ANTICERN(4) AND DO NOT REMOVE IT FROM PAYMENT AMOUNTS
      *             WHEN CALCULATING APR                          WORLD #0651
      *  MJD 100901  CORRECTED SIMPLE INT CALCULATION.  IF MFFRMLA-05
      *              THEN USE ANTICERN(4) INSTEAD OF MAINTFEE TO
      *              PREVENT TRUNCATION OF MONTHLY AMOUNTS IN THE CALCULATIONS.
      **************************************************************************
       APRS-RATE SECTION.
           PERFORM APRS-GET-RATE-TABLE.
           PERFORM APRS-GET-SIMPLE-RATE.
           PERFORM APRS-GET-EFFRATE.

      *******************************************
      *    DETERMINE RATE TABLE TO USE
      *******************************************
       APRS-GET-RATE-TABLE SECTION.
           PERFORM LOAN-CALCULATIONS.
           MOVE INT-CHARGEABLE TO CTBL-INT-CHARGEABLE.
           MOVE LN-ORGTERM     TO CTBL-TERM.
           PERFORM SETCTBL.
           MOVE CTBL-INDEX TO CTBL
                              APRS-CTBL.

      *******************************************
      *    COMPUTE THE SIMPLE INTEREST RATE
      *******************************************
       APRS-GET-SIMPLE-RATE SECTION.
           MOVE LN-UNITPER-CD   TO APR-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO APR-UNITPER-FREQ.
           MOVE LN-INTDATE      TO APR-INTDATE.
           MOVE LN-1STPYDATE    TO APR-1STPYDATE.

      * COMPUTE TRUE INTEREST CHARGABLE:
           MOVE 0 TO APRS-PYAMT-ADJ.
           IF SP-CAL-CHGABLE(CTBL) = "P" OR "S"
              SUBTRACT TOTAL-INSPREM-NONMEMO
                       TOTAL-INS-TAX
                       FROM APRS-PYAMT-ADJ.
           IF SP-CAL-CHGABLE(CTBL) = "P" OR "I"
              SUBTRACT LN-SERCHG FROM APRS-PYAMT-ADJ.

      *----------------------------------------------------------------------
      * IF MEXICO VAT TAX THEN USE LN-ANTICERN(4), THE LN-MAINTFEE FIELD IS
      * TO SMALL AND THE NUMBER THERE MAY BE TRUNCATED        (WORLD #651)
      *----------------------------------------------------------------------
           IF SP-MFFRMLA-05
              COMPUTE APR-FINANCED =
                   LN-LNAMT - LN-ANTICERN(4) + APRS-PYAMT-ADJ
           ELSE
              COMPUTE APR-FINANCED =
                   LN-LNAMT - (LN-MAINTFEE * LN-ORGTERM)
                            + APRS-PYAMT-ADJ.

           IF LN-LOANTYPE = "P"
              SUBTRACT LN-INTCHG LN-EXTCHG FROM APR-FINANCED.

      * SET INTEREST CHARGABLE AMOUNT:
           MOVE APR-FINANCED TO APRS-INTCHGABLE.

           MOVE LN-ORGTERM TO APR-ORGTERM.

      * DERIVE PAYMENT AMOUNTS FROM TRUE INTEREST CHARGABLE:

           COMPUTE APRS-PYAMT-ADJ =
                   APRS-PYAMT-ADJ / LN-ORGTERM.

           MOVE LN-1STPYAMT   TO APR-1STPYAMT.
           MOVE LN-REGPYAMT   TO APR-REGPYAMT.
           MOVE LN-LASTPYAMT  TO APR-LASTPYAMT.

      *----------------------------------------------------------------------
      * REESTABLISH PAYMENTS PRIOR TO SPREAD OF LN-EXTCHG
      * PER SP-PYEXFRMLA-SAME2-SPREAD (12)
      *----------------------------------------------------------------------
           IF SP-PYEXFRMLA-SAME2-SPREAD
              DIVIDE LN-ORGTERM INTO LN-EXTCHG
                           GIVING APRS-SPREAD
                           REMAINDER APRS-REM
              ADD LN-EXTCHG TO APR-1STPYAMT
              SUBTRACT APRS-SPREAD FROM APR-1STPYAMT
                                        APR-REGPYAMT
              IF LN-ORGTERM NOT = 1
                 SUBTRACT APRS-SPREAD APRS-REM FROM APR-LASTPYAMT.
      *----------------------------------------------------------------------

      *----------------------------------------------------------------------
      *  IF MAINT FORMULA 5 THEM USE LN-ANTICERN(4),
      *  LN-MAINTFEE MAY BE TRUNCATED
      *----------------------------------------------------------------------
           IF SP-MFFRMLA-05
              COMPUTE APR-1STPYAMT =
                            APR-1STPYAMT - LN-EXTCHG
                                         - (LN-ANTICERN(4) / LN-ORGTERM)
                                         + APRS-PYAMT-ADJ
              COMPUTE APR-REGPYAMT
                      APRS-REGPYAMT =
                            APR-REGPYAMT - (LN-ANTICERN(4) / LN-ORGTERM)
                                        + APRS-PYAMT-ADJ
              IF LN-ORGTERM NOT = 1
                 COMPUTE APR-LASTPYAMT =
                     APR-LASTPYAMT - (LN-ANTICERN(4) / LN-ORGTERM)
                                         + APRS-PYAMT-ADJ
              END-IF
           ELSE
              COMPUTE APR-1STPYAMT =
                            APR-1STPYAMT - LN-EXTCHG - LN-MAINTFEE
                                         + APRS-PYAMT-ADJ
              COMPUTE APR-REGPYAMT
                      APRS-REGPYAMT =
                            APR-REGPYAMT - LN-MAINTFEE
                                        + APRS-PYAMT-ADJ
              IF LN-ORGTERM NOT = 1
                 COMPUTE APR-LASTPYAMT =
                     APR-LASTPYAMT - LN-MAINTFEE
                                         + APRS-PYAMT-ADJ.

      *----------------------------------------------------------------------
      * IF 1ST PAYMENT EXTENTION CHARGE FORMULA '1' INDICATING SPREAD
      *        OF 1ST PAYMENT EXTENTION PERIOD CHARGE OVER ALL PAYMENTS
      *          OR WHEN APR-1STPYAMT NOT = APR-REGPYAMT WHICH COULD OCCUR
      *             IN SALES FINANCE INPUT WHICH ALLOWES SETUP OF PAYMENT
      *             STREAM WITH NO RHYME OR REASON
      *    GET TRUE REGZ CALCULATION
      * ELSE
      *    GET REVISED APR FOR EVEN PAYMENT SCHEDULE AND EVEN PAYMENT AMOUNT
      *----------------------------------------------------------------------
           IF (SP-PYEXFRMLA-REG-INCR) OR
              (APR-1STPYAMT NOT = APR-REGPYAMT)
              IF SP-DISFRMLA-USRULE
                 MOVE "C" TO APR-DISFRMLA
              ELSE
                 MOVE "A" TO APR-DISFRMLA
              END-IF
           ELSE
              MOVE "X" TO APR-DISFRMLA.
      *----------------------------------------------------------------------

           PERFORM APR-REGZ.
           COMPUTE APRS-SMPRATE ROUNDED = APR-APR.

      *******************************************
      *    COMPUTE EFFECTIVE RATE
      *******************************************
       APRS-GET-EFFRATE SECTION.
           MOVE 0 TO APRS-EFFRATE.
           IF SP-CAL-RATETYPE(CTBL) = "S" OR "M" OR "Z" OR "G"
              MOVE APRS-SMPRATE TO APRS-EFFRATE
           ELSE
           IF SP-CAL-RATETYPE(CTBL) = "A"
              PERFORM APRS-EFFRATE-ADDON
           ELSE
           IF SP-CAL-RATETYPE(CTBL) = "D"
              PERFORM APRS-EFFRATE-DISCOUNT.

       APRS-GET-EFFRATE-EXIT.
           EXIT.

      *-------------------------------------------------
      *    COMPUTE EFFECTIVE DISCOUNT RATE
      *-------------------------------------------------
       APRS-EFFRATE-DISCOUNT SECTION.
           IF SP-PYEXFRMLA-REG-INCR
              COMPUTE APRS-EFFRATE ROUNDED =
                  (
                    ((1 - APR-FINANCED / (APR-FINANCED + LN-INTCHG)))
                         * (UPER-UNITPER-PER-YEAR
                               / (LN-ORGTERM + UPER-FULL-UNITPER - 1
                                     + UPER-FRACT-UNITPER
                                 )
                           )
                  ) * 100
           ELSE
              COMPUTE APRS-EFFRATE ROUNDED =
                  (
                    ((1 - APR-FINANCED / (APR-FINANCED + LN-INTCHG)))
                         * (UPER-UNITPER-PER-YEAR / LN-ORGTERM)
                  ) * 100.

      *----------------------------------------------
      *    COMPUTE EFFECTIVE ADDON RATE
      *----------------------------------------------
       APRS-EFFRATE-ADDON SECTION.
           IF SP-PYEXFRMLA-REG-INCR
              COMPUTE APRS-EFFRATE ROUNDED =
                  (
                    (((APR-FINANCED + LN-INTCHG) / APR-FINANCED) - 1)
                         * (UPER-UNITPER-PER-YEAR
                               / (LN-ORGTERM + UPER-FULL-UNITPER - 1
                                     + UPER-FRACT-UNITPER)
                           )
                  ) * 100
           ELSE
              COMPUTE APRS-EFFRATE ROUNDED =
                  (
                    (((APR-FINANCED + LN-INTCHG) / APR-FINANCED) - 1)
                         * (UPER-UNITPER-PER-YEAR / LN-ORGTERM)
                  ) * 100.

      *================================================================*
      * END COPYBOOK: LIBLP\LPAPRS.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPAPRZ.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPAPRZ
      *****************************************************************
      *         COMPUTE APPROXIMATE APR TO 4 DECIMALS
      *         FEDERAL RESERVE REGULATION Z METHOD
      *
      *   NAME: LPAPRZ
      *   DESC: APPROXIMATE APR TO 4 DECIMALS ACCURACY
      *   IN  : APR-FINANCED        AMOUNT FINANCED
      *         APR-INTDATE         INTEREST START DATE
      *         APR-1STPYDATE       FIRST PAYMENT DATE
      *         APR-ORGTERM         TOTAL NO OF PAYMENTS
      *         APR-1STPYAMT        AMOUNT OF 1ST PAYMENT
      *         APR-REGPYAMT        AMOUNT OF REGULAR PAYMENT STREAM
      *         APR-LASTPYAMT       THE AMOUNT OF THE LAST PAYMENT
      *         APR-UNITPER-CD      PAYMENT PERIOD CODE   EX. 'M' MONTHLY
      *         APR-UNITPER-FREQ    FREQUENCY OF PAYMENTS EX. 2 = EVERY 2 WEEKS
      *         APR-DISFRMLA        DISCLOSURE FORMULA:
      *                               'A' - ACTUARIAL
      *                               'B' - SALE FINANCE RATE CHARTS
      *                               'C' - U.S. RULE
      *                               'X' - FRONT END CALCULATOR
      *                                     SAME AS 'B' BUT ALLOWS
      *                                     ODD LAST PAYMENT
      *
      *   OUT : APR-APR             999.9999 DECIMAL APPROX APR
      *   COPY:
      * REV :
      *  JTG 022190 CORRECTED SET OF APR-FRACT-UNITPER WHEN ELAPSED-DAYS
      *                   BECAME LESS THAN 0
      *  JTG 041690 ADDED SET OF APR-METHOD FOR U.S. RULE
      *  JTG 060590 ADDED ALTERNATIVE SINGLE PAY DISCLOSURE METHOD
      *                   SP-DISFRMLA-SPAY-FG
      *  JTG 121291 ADDED BALLOON PAYMENT INFORMATIOM APR-LASTPYAMT
      *  JTG 042997 CHANGED FOR SINGLE PAY LOANS
      *  JTG 032498 CHANGED TO ALLOW SINGLE PAYS COMPUTE BY U.S.RULE
      *****************************************************************
       APR-REGZ SECTION.
           MOVE 0 TO APR-APR.
           IF (APR-ORGTERM = 0)
            OR (APR-UNITPER-FREQ = 0)
             OR (NOT
                 (APR-UNITPER-CD = "M" OR "S" OR "W"
                                        OR "D" OR "Y" OR "B")
                )
              OR (APR-1STPYAMT = 0)
               OR (APR-FINANCED = 0)
                OR (NOT (APR-DISFRMLA = "A" OR "B" OR "C" OR "X") )
                 OR (APR-LASTPYAMT NOT NUMERIC)
                    GO TO APR-REGZ-EXIT.

      * TERM USED IN PRESENT VALUE COMPUTATIONS:
           MOVE APR-ORGTERM TO APR-PVTERM.

      * SETUP UNIT PERIOD INFORMATION:
           MOVE APR-PVTERM TO UPER-TERM.
           MOVE APR-UNITPER-CD TO UPER-UNITPER-CD.
           MOVE APR-UNITPER-FREQ TO UPER-UNITPER-FREQ.
           MOVE APR-INTDATE TO UPER-INTDATE.
           MOVE APR-1STPYDATE TO UPER-1STPYDATE.
           PERFORM UPER-CALCULATION.
           IF UPER-ERRCD NOT = " "
              GO TO APR-REGZ-EXIT.
           MOVE UPER-UNITPER-PER-YEAR TO APR-UNITPER-PER-YEAR.
           MOVE UPER-FULL-UNITPER TO APR-FULL-UNITPER.
           MOVE UPER-FRACT-UNITPER TO APR-FRACT-UNITPER.

      *--------------------------------------------------------------
      *    IF SINGLE PAY LOAN,
      *       CLEAR APR-LASTPYAMT TO ZERO
      *--------------------------------------------------------------
           IF APR-PVTERM = 1
              MOVE 0 TO APR-LASTPYAMT
      *--------------------------------------------------------------
      *    IF NOT SINGLE PAY LOAN,
      *       IF DISCLOSURE FORMULA = "B"
      *          - FORCE FIRST PAYMENT DATE TO BE 1 MONTH FROM
      *            INTEREST START DATE
      *          - REMOVE EXTENSION CHARGES FROM 1ST PAYMENT AMOUNT
      *          - MAKE LAST PAYMENT = REGULAR PAYMENT AMOUNT
      *       IF DISCLOSURE FORMULA = "X"
      *          - FORCE FIRST PAYMENT DATE TO BE 1 MONTH FROM
      *            INTEREST START DATE
      *          - REMOVE EXTENSION CHARGES FROM 1ST PAYMENT AMOUNT
      *          - KEEP ODD LAST PAYMENT
      *--------------------------------------------------------------
           ELSE
              IF APR-DISFRMLA = "B" OR "X"
                 MOVE 1 TO APR-FULL-UNITPER
                 MOVE 0 TO APR-FRACT-UNITPER
                 IF APR-PVTERM = 2
                    MOVE APR-LASTPYAMT TO APR-1STPYAMT
                 ELSE
                    MOVE APR-REGPYAMT TO APR-1STPYAMT
                    IF APR-DISFRMLA = "B"
                       MOVE APR-REGPYAMT TO APR-LASTPYAMT.

      * SET UP THE FIRST PAYMENT
           MOVE APR-1STPYAMT TO APR-1ST-PAYMENT.

      *--------------------------------------------------------
      * SET UP APR-METHOD ACTUARIAL VS U.S. RULE:
      * NOTE:
      *      'B' AND 'X' ARE DEFAULTING TO U.S. RULE,
      *       SINCE IT DOESN'T REQUIRE A POWER RAISE ON
      *       WHOLE MONTHS IN FIRST PAY PERIOD.
      *--------------------------------------------------------
      *    IF APR-DISFRMLA = "A" OR APR-PVTERM = 1  SINGLE PAY TEST JTG
           IF APR-DISFRMLA = "A"
              MOVE "A" TO APR-METHOD
           ELSE
              MOVE "U" TO APR-METHOD.

      ******************************************************************
      *
      *  HERE IS THE CALL TO THE "C" PROGRAM. IT WORKS EXACTLY LIKE
      *  THE COBOL THAT IT REPLACES EXCEPT THAT IT USES FLOATING POINT
      *  NUMBERS. THE FLOATING POINT USAGE ALLOW IT TO CALCULATE RATES
      *  OF INTEREST UP TO AND INCLUDING 999.9999% AT 30 YEARS.
      *
      ******************************************************************
           MOVE "11" TO APR-STAT.
      *    CALL CMD USING APR-STAT APR-WORK-AREA.
           PERFORM APRZ-APR-MAIN.

       APR-REGZ-EXIT.
           EXIT.

       APRZ-APR-MAIN SECTION.
           PERFORM APRZ-APR-GET-ARGS
           PERFORM APRZ-APR-PROCESS
           EXIT SECTION.

       APRZ-APR-GET-ARGS.
           MOVE ZERO                 TO APRZ-WS-APR
           MOVE APR-FINANCED         TO APRZ-WS-FINANCED
           MOVE APR-REGPYAMT         TO APRZ-WS-REGPYAMT
           MOVE APR-1STPYAMT         TO APRZ-WS-FSTPYAMT
           MOVE APR-LASTPYAMT        TO APRZ-WS-LASTPYAMT
           MOVE APR-PVTERM           TO APRZ-WS-REG-TERM
           MOVE ZERO                 TO APRZ-WS-LAST-TERM
           MOVE APR-UNITPER-PER-YEAR TO APRZ-WS-UNITPER-PER-YEAR
           MOVE APR-FULL-UNITPER     TO APRZ-WS-FULL-UNITPER
           MOVE APR-FRACT-UNITPER    TO APRZ-WS-FRACT-UNITPER
           MOVE APR-DELTA            TO APRZ-WS-DELTA
           MOVE APR-METHOD           TO APRZ-WS-METHOD

           MOVE 1 TO APRZ-WS-ADJ
           MOVE 1 TO APRZ-WS-R
           .

       APRZ-APR-PROCESS.
           IF APRZ-WS-REG-TERM = 1
              MOVE ZERO TO APRZ-WS-REG-TERM
              MOVE ZERO TO APRZ-WS-LAST-TERM
           ELSE
             IF APRZ-WS-LASTPYAMT = ZERO
                SUBTRACT 1 FROM APRZ-WS-REG-TERM
                MOVE ZERO TO APRZ-WS-LAST-TERM
             ELSE
                SUBTRACT 1 FROM APRZ-WS-REG-TERM
                MOVE APRZ-WS-REG-TERM TO APRZ-WS-LAST-TERM
                SUBTRACT 1 FROM APRZ-WS-REG-TERM
             END-IF
           END-IF

           PERFORM VARYING APRZ-WS-CNTR FROM 0 BY 1
                   UNTIL APRZ-WS-CNTR > 49 OR
                         FUNCTION ABS(APRZ-WS-ADJ) NOT > 0.0001

             MOVE APRZ-WS-R TO APRZ-WS-AF-R
             PERFORM APRZ-APR-FIN
             MOVE APRZ-WS-APRW TO APRZ-WS-F0

             COMPUTE APRZ-WS-AF-R = APRZ-WS-R + APRZ-WS-DELTA
             PERFORM APRZ-APR-FIN
             MOVE APRZ-WS-APRW TO APRZ-WS-F1

             COMPUTE APRZ-WS-ADJ = APRZ-WS-DELTA *
                              (APRZ-WS-FINANCED - APRZ-WS-F0 ) /
                              (APRZ-WS-F1 - APRZ-WS-F0)
             COMPUTE APRZ-WS-R = APRZ-WS-R + APRZ-WS-ADJ

           END-PERFORM

           IF APRZ-WS-R < ZERO OR APRZ-WS-CNTR > 50
              MOVE ZERO TO APRZ-WS-APR
           ELSE
              IF APRZ-WS-R > 999.9999
                 MOVE 999.9999 TO APRZ-WS-APR
              ELSE
                 MOVE APRZ-WS-R TO APRZ-WS-APR
              END-IF
           END-IF
           COMPUTE APRZ-WS-APR =
                        FUNCTION INTEGER ( (APRZ-WS-APR * 10000) + 0.5 )



           COMPUTE APR-APR = APRZ-WS-APR / 10000
           .

       APRZ-APR-FIN.
           MOVE ZERO TO APRZ-WS-APRW
           MOVE ZERO TO APRZ-WS-I APRZ-WS-I1
                        APRZ-WS-REG-ANN APRZ-WS-LAST-FAC

           COMPUTE APRZ-WS-I  = APRZ-WS-AF-R /
                                  ( APRZ-WS-UNITPER-PER-YEAR * 100)
           COMPUTE APRZ-WS-I1 = 1 + APRZ-WS-I
           IF APRZ-WS-I NOT = ZERO
              COMPUTE APRZ-WS-REG-ANN = (1 -
                                  (APRZ-WS-I1 ** (-APRZ-WS-REG-TERM)) )
                                   / APRZ-WS-I
           ELSE
              MOVE APRZ-WS-REG-TERM TO APRZ-WS-REG-ANN
           END-IF
           IF APRZ-WS-LAST-TERM NOT = ZERO
              COMPUTE APRZ-WS-LAST-FAC = APRZ-WS-I1 ** APRZ-WS-LAST-TERM
           ELSE
              MOVE 1 TO APRZ-WS-LAST-FAC
           END-IF

           IF APRZ-WS-METHOD = "U"
              COMPUTE APRZ-WS-APRW-DIV = 1 +
                      ( (APRZ-WS-FRACT-UNITPER + APRZ-WS-FULL-UNITPER )
                         * APRZ-WS-I )
           ELSE
              COMPUTE APRZ-WS-APRW-DIV = ( 1 +
                      ( APRZ-WS-FRACT-UNITPER * APRZ-WS-I ) ) *
                      ( APRZ-WS-I1 ** APRZ-WS-FULL-UNITPER )
           END-IF
           COMPUTE APRZ-WS-APRW = ( APRZ-WS-FSTPYAMT +
                                (APRZ-WS-REGPYAMT * APRZ-WS-REG-ANN)
                             + (APRZ-WS-LASTPYAMT / APRZ-WS-LAST-FAC) )
                             / APRZ-WS-APRW-DIV
           .

      *================================================================*
      * END COPYBOOK: LIBLP\LPAPRZ.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPUPER.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPUPER

      **************************************************************************
      *         CALCULATE INFORMATION ON UNIT PERIODS
      *         FEDERAL RESERVE REGULATION Z METHOD
      *
      *   NAME: LPUPER
      *   DESC: DETERMINE NO. OF UNIT PERIODS PER YEAR
      *                   NO. OF DAYS IN THE UNIT PERIOD
      *                   NO. OF FULL AND FRACTIONAL UNIT PERIODS
      *                       BETWEEN INTDATE AND 1STPYDATE
      *   IN  : UPER-UNITPER-CD
      *         UPER-UNITPER-FREQ
      *         UPER-INTDATE
      *         UPER-1STPYDATE
      *         UPER-TERM
      *
      *   OUT : UPER-UNITPER-PER-YEAR
      *         UPER-DAYS-IN-UNITPER
      *         UPER-FULL-UNITPER              EX. 1   MONTHS
      *         UPER-FRACT-UNITPER                 0.5 MONTHS
      *         UPER-ERRCD
      *
      *         UPER-SINGLE-PAY-CD
      *         UPER-SINGLE-PAY-FREQ
      *
      *         NOTE:
      *         ----> FOR SINGLE PAY LOANS, UPER-SINGLE-PAY-CD AND
      *               UPER-SINGLE-PAY-FREQ (MUST)(MUST) BE USED AT
      *               LOAN CREATE TO OVERRIDE THE NORMAL UNITPER-CD
      *               AND UNITPER-FREQ.
      *
      *               THIS WILL ALLOW FOR DATE ROUTINES TO YIELD
      *               CORRECT ELAPSED UNIT PERIODS AND/OR INCREMENT
      *               UNIT PERIODS TO INCREMENT CORRECTLY.
      *   COPY:
      * REV :
      *  JTG 042397 CORRECTED LOGIC FOR SINGLE PAY > 12 MONTHS AND
      *             REM NOT = 0, WAS MULTIPLYING BY 30 INSTEAD OF 360
      *  JTG 991214 PERFORMED TIMUPER, REGMGM
      *             TESTED ELAPSED-UNITPER-REM FOR SINGLE PAY LOANS WHEN
      *             TERM IS LESS THAN A FULL YEAR
      *             RE: 120199 TO 123199 WHICH YIELDS 1 MONTH 0 REM
      *                 AND 0 ELAPSED-UNITPER 30 ELAPSED-UNITPER-REM
      *  JTG 991217 FOR SINGLE PAY LOANS WITH A TERM IS LESS THAN A FULL
      *             YEAR SET REGZ OPTION TO ALWAYS USE CALCULATION OF
      *             NO OF UNIT PERIODS PER YEAR = 365 / DAYS IN TERM
      *  BAH 000105 CHANGED TEST ON FREQ = 0 TO ALSO TEST TERM NOT = 1,
      *             BECAUSE OF THE FOLLOWING SITUATION AT FUTURE, VA
      *             LOANDATE = 12/22/99   TERM = 1  WHEN CURSER STOPS AT
      *             1STPYDATE OF 01/22/00, UP ARROW AND CHANGE INTEREST START
      *             TO 01/22/00, NOW ELASPED DAYS IS 0, DEFAULTS SINGLE PAY
      *             TO "D" AND 0, THEN THEY CHANGE 1STPYDATE TO 01/30/00, AND
      *             IT WOULD NOT RECALC BECAUSE OF THE FREQ = 0 "IF"..
      *  JTG 060504 CHANGED LOGIC FOR SINGLE PAYS LOANS > 11 MONTHS
      *             TO YIELD REMAINING DAYS FROM UPER-INTDATE PLUS
      *             FULL UNIT PERIODS TO UPER-1STPYDATE
      *             ADDED NEW LOAN CALCULATION FOR RICHARD        LENDMARK #2709
      **************************************************************************
       UPER-CALCULATION SECTION.
           MOVE " " TO UPER-ERRCD.
           MOVE 0 TO UPER-UNITPER-PER-YEAR
                     UPER-DAYS-IN-UNITPER
                     UPER-FULL-UNITPER
                     UPER-FRACT-UNITPER.
           IF (UPER-UNITPER-FREQ = 0 AND UPER-TERM NOT = 1)
            OR (NOT
                 (UPER-UNITPER-CD = "M" OR "S" OR "W"
                                          OR "D" OR "Y" OR "B")
               )
             OR UPER-TERM = 0
                MOVE "E" TO UPER-ERRCD
                GO TO UPER-CALCULATE-EXIT.

           IF UPER-TERM = 1
              PERFORM UPER-SINGLE-PAYS
           ELSE
           IF UPER-UNITPER-CD = "M"
              COMPUTE UPER-UNITPER-PER-YEAR = 12 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 30 * UPER-UNITPER-FREQ
              PERFORM UPER-MONTHLY-UNIT-PERIODS
           ELSE
           IF UPER-UNITPER-CD = "S"
              COMPUTE UPER-UNITPER-PER-YEAR = 24 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 15 * UPER-UNITPER-FREQ
              PERFORM UPER-SEMI-MONTHLY-UNIT-PERIODS
           ELSE
           IF UPER-UNITPER-CD = "W"
              COMPUTE UPER-UNITPER-PER-YEAR = 52 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 7 * UPER-UNITPER-FREQ
              PERFORM UPER-WEEKLY-UNIT-PERIODS
           ELSE
           IF UPER-UNITPER-CD = "B"
              COMPUTE UPER-UNITPER-PER-YEAR = 26 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 14 * UPER-UNITPER-FREQ
              PERFORM UPER-WEEKLY-UNIT-PERIODS
           ELSE
           IF UPER-UNITPER-CD = "D"
              COMPUTE UPER-UNITPER-PER-YEAR = 365 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 1 * UPER-UNITPER-FREQ
              PERFORM UPER-DAILY-UNIT-PERIODS
           ELSE
           IF UPER-UNITPER-CD = "Y"
              COMPUTE UPER-UNITPER-PER-YEAR = 1 / UPER-UNITPER-FREQ
              COMPUTE UPER-DAYS-IN-UNITPER = 365 * UPER-UNITPER-FREQ
              PERFORM UPER-YEARLY-UNIT-PERIODS.

       UPER-CALCULATE-EXIT.
           EXIT.

      ***********************************************
      *    SINGLE PAY LOANS
      ***********************************************
       UPER-SINGLE-PAYS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           MOVE 999            TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           IF ELAPSED-MONTHS < 0
              MOVE "E" TO UPER-ERRCD
              GO TO UPER-SINGLE-PAYS-EXIT.

      * ELAPSED TIME GREATER THAN ONE YEAR:
           IF ELAPSED-MONTHS > 11
              MOVE 1   TO UPER-UNITPER-PER-YEAR
              MOVE 365 TO UPER-DAYS-IN-UNITPER
              MOVE "D" TO UPER-SINGLE-PAY-CD
              MOVE 365 TO UPER-SINGLE-PAY-FREQ
              COMPUTE UPER-FULL-UNITPER = ELAPSED-MONTHS / 12
              MOVE UPER-INTDATE   TO NDTE-DATE
              COMPUTE NDTE-HOLD = UPER-FULL-UNITPER * 12
              PERFORM INCREMENT-MONTHS
              MOVE NDTE-DATE      TO NUM-DATE
              MOVE UPER-1STPYDATE TO SYS-DATE
              PERFORM TIM365
              COMPUTE UPER-FRACT-UNITPER = ELAPSED-DAYS / 365
           ELSE
      * ELAPSED TIME LESS THAN ONE YEAR:
      * JTG 991217 FOR SINGLE PAY LOANS WITH A TERM IS LESS THAN A FULL
      *            YEAR SET REGZ OPTION TO ALWAYS USE CALCULATION OF
      *            NO OF UNIT PERIODS PER YEAR = 365 / DAYS IN TERM
              MOVE 1 TO UPER-FULL-UNITPER
              MOVE 0 TO UPER-FRACT-UNITPER
      *  JTG 991214 PERFORMED TIMUPER, REGMGM
      *             TESTED ELAPSED-UNITPER-REM FOR SINGLE PAY LOANS WHEN
      *             TERM IS LESS THAN A FULL YEAR
      *             RE: 120199 TO 123199 WHICH YIELDS 1 MONTH 0 REM
      *                 AND 0 ELAPSED-UNITPER 30 ELAPSED-UNITPER-REM
      *       PERFORM TIMUPER
      *       IF ELAPSED-UNITPER-REM = 0
      *          MOVE "M" TO UPER-SINGLE-PAY-CD
      *          MOVE ELAPSED-MONTHS TO UPER-SINGLE-PAY-FREQ
      *          COMPUTE UPER-UNITPER-PER-YEAR = 12 / ELAPSED-MONTHS
      *          COMPUTE UPER-DAYS-IN-UNITPER = 30 * ELAPSED-MONTHS
      *       ELSE
                 MOVE UPER-INTDATE   TO NUM-DATE
                 MOVE UPER-1STPYDATE TO SYS-DATE
                 PERFORM TIM365
                 MOVE "D"            TO UPER-SINGLE-PAY-CD
                 MOVE ELAPSED-DAYS   TO UPER-SINGLE-PAY-FREQ
                 COMPUTE UPER-UNITPER-PER-YEAR = 365 / ELAPSED-DAYS
                 COMPUTE UPER-DAYS-IN-UNITPER = ELAPSED-DAYS.

       UPER-SINGLE-PAYS-EXIT.
           EXIT.

      ***********************************************
      *    MONTHLY UNIT PERIODS
      ***********************************************
       UPER-MONTHLY-UNIT-PERIODS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           PERFORM TIM360.
           IF ELAPSED-MONTHS < 0
              MOVE "E" TO UPER-ERRCD
              GO TO UPER-MONTHLY-UNIT-PERIODS-EXIT.
           COMPUTE UPER-FULL-UNITPER =
                     ELAPSED-MONTHS / UPER-UNITPER-FREQ.

           MOVE UPER-1STPYDATE TO NDTE-DATE.
           COMPUTE NDTE-HOLD =
                     UPER-FULL-UNITPER * UPER-UNITPER-FREQ * -1.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE      TO SYS-DATE.
           PERFORM TIM365.
           MOVE ZERO TO UPER-REUBEN.
           IF ELAPSED-DAYS > 0
              IF ELAPSED-DAYS < UPER-DAYS-IN-UNITPER
                 COMPUTE UPER-REUBEN ROUNDED =
                          ELAPSED-DAYS / UPER-DAYS-IN-UNITPER
              ELSE
                 ADD 1 TO UPER-FULL-UNITPER.
           MOVE UPER-REUBEN TO UPER-FRACT-UNITPER.

       UPER-MONTHLY-UNIT-PERIODS-EXIT.
           EXIT.

      ***********************************************
      *    SEMI MONTHLY UNIT PERIODS
      ***********************************************
       UPER-SEMI-MONTHLY-UNIT-PERIODS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           PERFORM TIM360.
           IF ELAPSED-DAYS < 0
              MOVE "E" TO UPER-ERRCD
           ELSE
              COMPUTE UPER-FULL-UNITPER =
                          ELAPSED-MONTHS * 30 + ELAPSED-REM
              COMPUTE UPER-FRACT-UNITPER ROUNDED =
                          UPER-FULL-UNITPER / UPER-DAYS-IN-UNITPER
              COMPUTE UPER-FULL-UNITPER =
                          UPER-FULL-UNITPER / UPER-DAYS-IN-UNITPER.

      ***********************************************
      *    WEEKLY UNIT PERIODS
      ***********************************************
       UPER-WEEKLY-UNIT-PERIODS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF ELAPSED-DAYS < 0
              MOVE "E" TO UPER-ERRCD
           ELSE
              COMPUTE UPER-FRACT-UNITPER ROUNDED =
                          ELAPSED-DAYS / UPER-DAYS-IN-UNITPER
              COMPUTE UPER-FULL-UNITPER =
                          ELAPSED-DAYS / UPER-DAYS-IN-UNITPER.

      ***********************************************
      *    DAILY UNIT PERIODS
      ***********************************************
       UPER-DAILY-UNIT-PERIODS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           PERFORM TIM365.
           IF ELAPSED-DAYS < 0
              MOVE "E" TO UPER-ERRCD
           ELSE
              COMPUTE UPER-FRACT-UNITPER ROUNDED =
                          ELAPSED-DAYS / UPER-DAYS-IN-UNITPER
              COMPUTE UPER-FULL-UNITPER =
                          ELAPSED-DAYS / UPER-DAYS-IN-UNITPER.

      ***********************************************
      *    YEARLY UNIT PERIODS
      ***********************************************
       UPER-YEARLY-UNIT-PERIODS SECTION.
           MOVE UPER-INTDATE   TO NUM-DATE.
           MOVE UPER-1STPYDATE TO SYS-DATE.
           MOVE 999 TO ELAPSED-YRTYPE.
           PERFORM TIMALL.
           IF ELAPSED-DAYS < 0
              MOVE "E" TO UPER-ERRCD
              GO TO UPER-YEARLY-UNIT-PERIODS-EXIT.

           IF ELAPSED-REM = 0
              COMPUTE UPER-FRACT-UNITPER ROUNDED =
                          ELAPSED-MONTHS / (12 * UPER-UNITPER-FREQ)
              COMPUTE UPER-FULL-UNITPER =
                          ELAPSED-MONTHS / (12 * UPER-UNITPER-FREQ)
              GO TO UPER-YEARLY-UNIT-PERIODS-EXIT.

           IF ELAPSED-REM NOT = 0
              COMPUTE UPER-FULL-UNITPER =
                          ELAPSED-MONTHS / (12 * UPER-UNITPER-FREQ).
           MOVE UPER-1STPYDATE TO NDTE-DATE.
           COMPUTE NDTE-HOLD = UPER-FULL-UNITPER
                                          * UPER-UNITPER-FREQ * -12.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO SYS-DATE.
           PERFORM TIM365.
           MOVE 0 TO UPER-FRACT-UNITPER.
           IF ELAPSED-DAYS > 0
              IF ELAPSED-DAYS < UPER-DAYS-IN-UNITPER
                 COMPUTE UPER-FRACT-UNITPER ROUNDED =
                                    ELAPSED-DAYS / UPER-DAYS-IN-UNITPER
              ELSE
                 ADD 1 TO UPER-FULL-UNITPER.

       UPER-YEARLY-UNIT-PERIODS-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPUPER.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPPDUE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPPDUE
      ***********************************************************************
      *          PAST DUE DAYS CALCULATION
      *
      *    NAME: LPPDUE
      *    DESC: ROUTINE COMPUTES DAYS PAST DUE FROM
      *          PAID THRU DATE
      *    IN  : PDUE-TODAY-DATE        (TODAYS DATE)
      *          PDUE-1STPYDATE    (LN-1STPYDATE)
      *    OUT : PDUE-DAYS
      *    USED: LN-CURBAL, LN-PAYFREQ
      *    COPY: LPPDUEW, LPMDTEW, LPMDTE, SPPDTHW, SPPDTH
      * REV:
      *  050986 JTG TOOK OUT CHECK ON PAST MATURITY
      *             WHICH CAUSED INPROPER VIEW OF
      *             PAST DUE DAYS EVEN THOUGH ALL
      *             PAYMENTS BECOME DUE THEN.
      *  041289 SLC ADDED CODE TO ADJUST THE DUE DATE
      *             TO AVOID MONTHEND PROBLEMS.
      *  041693 JTG ADDED LOGIC FOR UNIT PERIODS
      *  040495 JTG CORRECT LOGIC FOR FEB OVER 28TH
      *  JTG 030307 PUT BACK LOGIC FOR TESTING MATURITY:
      *             WHEN PAID-THRU IS EQUAL TO MATURITY AND THE ACCOUNT
      *             STILL HAS A BALANCE, COUNT PAST DUE DAYS FROM MATURITY
      *             AND NOT FROM NEXT DUE DATE                  CREATIVE #398
      *  JTG 030313 CORRECTED CHANGE DONE ON 030307 TO EXAMINE
      *             WHEN GP-PDTH-GT-SCHED-PAY = 'Y'
      *             PAID THRU IS CAPPED AT THE NUMBER OF SCHEDULED PAYS
      *             SO SEE IF PAID-THRU IS AT THE CAP (MATURITY)
      *             AND COUNT PAST DUE DAYS FROM MATURITY
      *             NOT FROM MATURITY + 1 PAY FREQUENCY         CREATIVE #398
      *   CS 130327 PAST DUE DAYS WERE DISPLAYING AS 1 ON 3/14 WHEN
      *             PDTH-DATE-FULL 2/28 & INCREMENT-UNITPER INCREMENTED TO
      *             3/13 (1STPYDA 30) SHOULD BE 3/15. FORCED IF PAID THRU
      *             2/28 SUBTRACT NDTE-DD (28) FROM LN-1STPYDA =2, ADD 2 TO
      *             THE INCORRECT 3/13/ DATE YIELDING 3/15 AND PDUE-DAYS SHOULD
      *             BE 0   SOAUTO PL#793
      *   CS 160318 FIXED BUG IN ABOVE, THIS TEST AND SUBTRACT
      *             (SUBTRACT NDTE-DD FROM LN-1STPYDA) SHOULD ONLY BE DONE
      *             WHEN LN-1STPYDA > 28 #922
      ***********************************************************************
       PAST-DUE-DAYS-CALCULATION SECTION.
           MOVE 0 TO PDUE-DAYS.

      * TEST IF ACCOUNT CLOSED:
           IF LN-CURBAL = 0
              GO TO PAST-DUE-DAYS-EXIT.

      * WHEN GP-PDTH-GT-SCHED-PAY = 'Y'
      *   PAID THRU IS CAPPED AT THE NUMBER OF SCHEDULED PAYS
      *   SO SEE IF PAID-THRU IS AT THE CAP (MATURITY)
      *   AND COUNT PAST DUE DAYS FROM MATURITY
      
           IF GP-PDTH-GT-SCHED-PAY = "Y"
              MOVE LN-1STPYDATE TO PDTH-DATE-WORK
              PERFORM PAID-THRU-CALCULATION
              PERFORM MATURITY-DATE-CALCULATION
              MOVE MDTE-DATE      TO NUM-DATE
              MOVE PDTH-DATE-FULL TO SYS-DATE
              IF SYS-DATE NOT < NUM-DATE
                 GO TO PAST-DUE-DAYS-COMPUTE.

      * SETUP NEXT PAYMENT DUE AND
      * COUNT PAST DUE DAYS FROM NEXT PAYMENT DUE DATE:

           MOVE PDUE-1STPYDATE TO PDTH-DATE-WORK.
           PERFORM PAID-THRU-CALCULATION.
           MOVE PDTH-DATE-FULL TO NDTE-DATE.

           IF LN-UNITPER-CD = "M"
              MOVE PDUE-1STPYDA TO NDTE-DD.

           MOVE 1 TO NDTE-HOLD.
           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE TO NUM-DATE.

      * PAST DUE DAYS WERE DISPLAYING AS 1 ON 3/14 WHEN PDTH-DATE-FULL 2/28
      * & INCREMENT-UNITPER INCREMENTED TO 3/13 (1STPYDA 30) SHOULD BE 3/15.
      * FORCED IF PAID THRU 2/28 SUBTRACT NDTE-DD (28) FROM LN-1STPYDA =2,
      * ADD 2 TO THE INCORRECT 3/13/ DATE. PDUE-DAYS SHOULD BE 0

           IF LN-UNITPER-CD = "S"
              MOVE PDTH-DATE-FULL TO NDTE-DATE
              IF (NDTE-DD = 28 OR NDTE-DD = 29) AND NDTE-MM = 2
              IF LN-1STPYDA > NDTE-DD
                 SUBTRACT NDTE-DD FROM LN-1STPYDA GIVING NDTE-HOLD
                 MOVE NUM-DATE TO NDTE-DATE
                 PERFORM INCREMENT-DAYS
                 MOVE NDTE-DATE TO NUM-DATE.

       PAST-DUE-DAYS-COMPUTE.
           MOVE PDUE-TODAY-DATE      TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS > 0
              MOVE ELAPSED-DAYS TO PDUE-DAYS.

       PAST-DUE-DAYS-EXIT.
           EXIT.
      *================================================================*
      * END COPYBOOK: LIBLP\LPPDUE.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\RBACT.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/RBACT
      **************************************************************************
      *         COMPUTE ACTUARIAL REBATE
      *
      *   NAME: RBACT
      *   DESC: COMPUTE TRUE ACTUARIAL REBATE
      *   IN  : RBACT-RBDATE          REFUND DATE
      *         RBACT-INTDATE         INTEREST START DATE
      *         RBACT-ORIG-1STPAY     ORIGINAL FIRST PAYMENT DUE DATE
      *         RBACT-ORGTERM         TOTAL NO OF PAYMENTS
      *         RBACT-1STPYAMT        AMOUNT OF 1ST PAYMENT
      *         RBACT-REGPYAMT        AMOUNT OF REGULAR PAYMENT STREAM
      *         RBACT-LASTPYAMT       THE AMOUNT OF THE LAST PAYMENT
      *         RBACT-TOTCHG          THE FINANCE CHARGE
      *         RBACT-TOTNODEF        TOTAL NO. OF DEFERMENTS
      *         RBACT-RATE            ANNUAL PERCENTAGE RATE (APR) OR
      *                               EQUIVALENT SIMPLE RATE (ESR)
      *         RBACT-UNITPER-CD      PAYMENT PERIOD CODE   EX. 'M' MONTHLY
      *         RBACT-UNITPER-FREQ    FREQUENCY OF PAYMENTS
      *                                               EX. 2 = EVERY 2 WEEKS
      *         RBACT-ELAPSED-DAYS    PASSED FROM REBATE
      *         RBACT-ELAPSED-MONTHS  PASSED FROM REBATE
      *         RBACT-ELAPSED-REM     PASSED FROM REBATE
      *
      *         RBACT-SKIPDEF-FG      SET FROM LPAERN ACCRUAL ROUTINES
      *                                 NOTE: CLEARED TO SPACES AT EXIT
      *         RBACT-EARN-FULL-MONTH SET FROM LPAERN ACCRUAL ROUTINES
      *                                 NOTE: CLEARED TO SPACES AT EXIT
      *
      *      ----> THE FOLLOWING TWO INPUT FIELDS ARE USED BY LIBGB/REBATE
      *            TO DETERMINE, IF A SWING IS REQUIRED:
      *
      *         RBACT-SUB             REB-SUB
      *         RBACT-SUB2            REB-SUB2
      *
      *   OUT : RBACT-REBATE
      *         RBACT-PRES-VALUE
      *   COPY:
      * REV :
      *  JTG 091196 CORRECTED BUG CAUSED BY SP-RBSPOPT1()=13, WHICH WIPED OUT
      *             ELAPSED-UNITPER & ELAPSED-UNITPER-REM
      *             CREATED & SET RBACT-ELAPSED-UNITPER
      *                                    & RBACT-ELAPSED-UNITPER-REM
      *  JTG 021098 ADDED TEST FOR RBACT-SKIPDEF-FG
      *             ADDED TEST FOR RBACT-EARN-FULL-MONTH, TFC #637
      *             RE: SP-EARNACCRL-FG() = 'B'
      *  JTG 042398 CORRECTED TEST FOR RBACT-EARN-FULL-MONTH, TFC #637
      *             RE: SP-EARNACCRL-FG() = 'B'
      *             THE TEST FOR REBATE DATE = INTEREST DATE CAUSED THE
      *             ROUTINE TO EXIT WITH ZERO VALUE IN RBACT-PRES-VALUE
      *             WHICH IS WRONG. THE RBACT-VALUE SHOULD BE EQUAL TO
      *             THE AMOUNT FINANCED. THIS BUG IMPACTED SP-ERNFRMLA = 11
      *             CAUSING NEGATIVE INCOME FOR DEALER DISCOUNT.
      *  JTG 990324 CHANGED TEST FOR RBACT-EARN-FULL-MONTH, TFC #637
      *             TO TAKE ONE MONTH ON NON MONTHLY
      *  JTG 990831 CHANGED TO USE 360 DAYS FOR RBACT-EARN-FULL-MONTH = "Y"
      *             TFC #50
      *  JTG 990924 CORRECTED TO USE 360 DAYS FOR RBACT-EARN-FULL-MONTH = "Y"
      *             ONLY ON MONTHLY ACCOUNTS    TFC #50
      *  JTG 991122 MODIFIED LOGIC (TEST FOR SWING) TO ALSO TEST FOR
      *             SP-RBDAYS NOT = 0 , MERCURY
      *  JTG 000104 MOVED FROM LIBLP TO LIBGB
      *  JTG 000104 ADDED RBACT-PENALTY-FG ADDED SP-RBREDUC = 9999.04 WISCONSIN
      *             IB REAL ESTATE PREPAY PENALTY, WISCONSIN #1031
      *  JTG 000309 CORRECTED (MERCURY ARIZONA ACTION 24) SP-RBSPOPT1() = 13
      *             PER AUDIT ON BR: AZ0192 #323025, UNDER SECTION R20-4-508
      *             PAYMENTS MADE ON OR BEFORE THE 15TH DAYS FOLLOWING A PAYMENT
      *             DUE DATE WILL BE REFUNDED AS OF THE PRECEDING INSTALLMENT
      *             DATE AND ANY PAYMENT MADE ON OR AFTER THE 16TH WILL BE
      *             REFUNDED AS OF THE SUCEEDING PAYMENT DUE DATE
      *  JTG 010316 CHANGED TO TEST ENVIRONMENT VARIABLE 'FORCE_ACCRUAL'
      *             AND FORCE ACCRUAL OF 032801 REGENCY PR#320
      *  JTG 010402 STARRED OUT CHANGE TO TEST ENVIRONMENT VARIABLE
      *             'FORCE_ACCRUAL' AND FORCE ACCRUAL OF 032801 REGENCY PR#320
      *  JTG 010705 ADDED SET OF REB-EARN-FULL-MONTH,           REGENCY PR#1456
      *             RE: SP-ERNACCRL-FG() 'C'
      *  JTG 011026 CHANGED RBACT-APRATE TO RBACT-RATE FOR NEW REFUND FORMULA
      *             '0  6'                                      REGENCY PR#1631
      **************************************************************************
       RBACT-ACTUARIAL SECTION.
           MOVE 0 TO RBACT-REBATE
                     RBACT-PRES-VALUE.
           IF RBACT-RATE = 0  OR RBACT-RBDATE = 0
              GO TO RBACT-ACTUARIAL-EXIT.

      ***********   SET UNIT PERIOD INFO   **************************
           MOVE RBACT-UNITPER-CD TO UPER-UNITPER-CD.
           MOVE RBACT-UNITPER-FREQ TO UPER-UNITPER-FREQ.
           MOVE RBACT-INTDATE TO UPER-INTDATE.
           MOVE RBACT-ORIG-1STPAY TO UPER-1STPYDATE.
           MOVE RBACT-ORGTERM TO UPER-TERM.
           PERFORM UPER-CALCULATION.

           MOVE UPER-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE UPER-UNITPER-FREQ TO DATER-UNITPER-FREQ.

      ********************************************************
      *    DETERMINE IF FIRST PAYMENT EXTENTIONS
      *    ARE NOT CHARGED INTEREST AND DISCLOSURE IS
      *    IS DONE FOR SALES FINANCE VIA: 'B', IF SO SET
      *    INTEREST DATE , ONE MONTH PRIOR TO ORIG 1ST PAY
      *    AND ESTABLISH RBACTF-ADJ FOR DAILY INTEREST
      ********************************************************
           MOVE 1 TO RBACTF-ADJ.
           IF RBACT-PENALTY-FG NOT = "Y"
              IF SP-RBSPOPT1-FIRST-30(RBACT-SUB)
                 MOVE RBACT-ORIG-1STPAY TO NDTE-DATE
                 MOVE -1 TO NDTE-HOLD
                 PERFORM INCREMENT-UNITPER
                 MOVE RBACT-INTDATE TO NUM-DATE
                 MOVE NDTE-DATE     TO SYS-DATE
                 IF SYS-DATE > NUM-DATE
                    MOVE NDTE-DATE TO RBACT-INTDATE
                 END-IF
                 IF SP-INTMETHOD = "E"
                    COMPUTE RBACTF-ADJ ROUNDED =
                        UPER-UNITPER-PER-YEAR
                                * UPER-DAYS-IN-UNITPER / 365.

      **************************************************************************
      *    DETERMINE:
      *       IF REBATE DATE IS BEFORE INTDATE,
      *          FULL REBATE
      **************************************************************************
           MOVE RBACT-INTDATE TO NUM-DATE.
           MOVE RBACT-RBDATE  TO SYS-DATE.
           IF RBACT-RBDATE < RBACT-INTDATE
              MOVE RBACT-TOTCHG TO RBACT-REBATE
              GO TO RBACT-ACTUARIAL-EXIT.

      ***************************************************
      *    TEST FOR SWING RULE
      ***************************************************
           MOVE RBACT-RBDATE TO RBACT-REFDATE.
           IF RBACT-PENALTY-FG NOT = "Y"
              IF ( ( RBACT-UNITPER-CD = "M"                  ) AND
                   ( RBACT-UNITPER-FREQ = 1                  ) AND
                   ( SP-RBDAYS(RBACT-SUB RBACT-SUB2) NOT = 0 )
                 )
                OR
                 ( RBACT-EARN-FULL-MONTH = "B" OR "C")
                 IF RBACT-ELAPSED-REM = 0
                    MOVE RBACT-INTDATE        TO NDTE-DATE
                    MOVE RBACT-ELAPSED-MONTHS TO NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                    MOVE NDTE-DATE TO RBACT-REFDATE.

      *    -------------------------------------------------------------
      *            IF ENVIRONMENT VARIABLE SET THEN CHECK IF
      *                LOAN INTDATE IS 28TH OR 29TH
      *                IF SO FORCE ACCRUAL TO 032801
      *                (REGENCY #PR#320, JTG 010316)
      *    -------------------------------------------------------------
      *            MOVE "FORCE_ACCRUAL" TO GETENV-BUF
      *            PERFORM GETENV-CALL
      *            IF STAT = "00"
      *               IF RBACT-REFDATE = 022801
      *                  MOVE LN-INTDATE TO NUM-DATE
      *                  IF NUM-DA = 28
      *                     MOVE 032801 TO RBACT-REFDATE
      *                  ELSE
      *                  IF NUM-DA = 29
      *                     MOVE 032901 TO RBACT-REFDATE.

      ***************************************************
      *    DETERMINE ELAPSED TIME REMAINING BETWEEN
      *    REFERENCE (REBATE) DATE AND ORIGINAL MATURITY
      ***************************************************
           MOVE RBACT-ORIG-1STPAY TO NDTE-DATE.
           SUBTRACT 1 FROM RBACT-ORGTERM GIVING NDTE-HOLD.
           IF RBACT-PENALTY-FG NOT = "Y"
              IF RBACT-SKIPDEF-FG = " "
                 IF SP-RBDEFER(RBACT-SUB) = 1
                    ADD RBACT-TOTNODEF TO NDTE-HOLD.
           PERFORM INCREMENT-UNITPER.
           MOVE RBACT-REFDATE TO NUM-DATE.
           MOVE NDTE-DATE TO SYS-DATE.

      * TFC APPROVED 8/25/1999 JTG #50
      * TFC CORRECTED TO ONLY DO TIM360 IF MONTHLY
      * JTG 010705 ADDED SET OF REB-EARN-FULL-MONTH, REGENCY PR#1456
      *            RE: SP-ERNACCRL-FG() 'C'
      * NOTE:
      *       SP-ERNACCRL-FG() 'B' AND 'C' ARE IDENTICAL EXCEPT FOR
      *       THE FOLLOWING IF, WHERE 'B' DOES ELAPSED MONTHS 360

           IF (RBACT-EARN-FULL-MONTH = "B"    ) AND
              (RBACT-UNITPER-CD = "M"         ) AND
              (RBACT-UNITPER-FREQ = 1         ) AND
              (RBACT-PENALTY-FG NOT = "Y"     )
              PERFORM TIM360
              MOVE ELAPSED-MONTHS      TO RBACT-ELAPSED-UNITPER
              MOVE ELAPSED-REM         TO RBACT-ELAPSED-UNITPER-REM
           ELSE
              PERFORM TIMUPER
              MOVE ELAPSED-UNITPER     TO RBACT-ELAPSED-UNITPER
              MOVE ELAPSED-UNITPER-REM TO RBACT-ELAPSED-UNITPER-REM.
           IF SYS-IS-LE
              GO TO RBACT-ACTUARIAL-EXIT.
      * TFC APPROVED 8/25/1999 JTG #50
      * JTG 010705 ADDED SET OF REB-EARN-FULL-MONTH, REGENCY PR#1456

      ***************************************************
      *    SET FRACTIONAL PERIOD FROM REBATE DATE TO NEXT
      *    PAYMENT DUE DATE
      ***************************************************
           COMPUTE RBACTF ROUNDED =
              RBACT-ELAPSED-UNITPER-REM
                   / UPER-DAYS-IN-UNITPER * RBACTF-ADJ.

      ***************************************************
      *    SET WHOLE PERIOD(S) FROM REBATE DATE TO NEXT
      *    PAYMENT DUE DATE
      ***************************************************
           IF RBACT-ELAPSED-UNITPER NOT < RBACT-ORGTERM
              COMPUTE RBACTT =
                   RBACT-ELAPSED-UNITPER - RBACT-ORGTERM + 1
           ELSE
              IF RBACTF = 0
                 MOVE 1 TO RBACTT
              ELSE
                 MOVE 0 TO RBACTT.

      *******************************************************
      *    DETERMINE IF SWING TO NEAREST DUE DATE REQUIRED
      *    (MERCURY ARIZONA ACTION 24)
      *******************************************************
           IF RBACT-PENALTY-FG NOT = "Y"
              IF SP-RBSPOPT1(RBACT-SUB) = 13
                 MOVE RBACT-ORIG-1STPAY TO NUM-DATE
                 MOVE RBACT-RBDATE      TO SYS-DATE
                 IF RBACT-ORIG-1STPAY < RBACT-RBDATE
                    MOVE RBACT-ORIG-1STPAY TO NUM-DATE
                 ELSE
                    MOVE RBACT-INTDATE     TO NUM-DATE
                 END-IF
                 MOVE RBACT-RBDATE      TO NDTE-DATE
                 IF NDTE-DD < NUM-DA
                    MOVE NUM-DA         TO NDTE-DD
                    MOVE -1             TO NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                 ELSE
                    MOVE NUM-DA         TO NDTE-DD
                 END-IF
                 MOVE NDTE-DATE         TO NUM-DATE
                 MOVE RBACT-RBDATE      TO SYS-DATE
                 PERFORM TIM365
                 IF ELAPSED-DAYS <= 15
                    MOVE 0 TO RBACTF
                    MOVE 1 TO RBACTT
                 ELSE
                    MOVE 0 TO RBACTF
                              RBACTT.

      ***************************************************
      *    COMPUTE INT. RATE PER PMT/COMPOUND INTERVAL:
      ***************************************************
           COMPUTE RBACTI ROUNDED =
              RBACT-RATE * 0.01 / UPER-UNITPER-PER-YEAR.

      ************************************************************
      *    COMPUTE 1ST PAYMENT REQUIREMENTS AND ADJUSTMENT FACTOR
      ************************************************************
      * SINGLE PAY LOANS AND US RULE:
           IF RBACT-ORGTERM < 2 OR SP-DISFRMLA = "C"
              COMPUTE RBACTADJ ROUNDED =
                 1 / (1 + (RBACTT + RBACTF) * RBACTI)
           ELSE
      * ACTUARIAL:
              COMPUTE RBACTADJ ROUNDED =
                 1 / ((1 + RBACTF * RBACTI) * (1 + RBACTI) ** RBACTT).

           MOVE RBACT-1STPYAMT TO RBACTFP.
           IF RBACT-ELAPSED-UNITPER > RBACT-ORGTERM
              MOVE RBACT-ORGTERM TO RBACT-ELAPSED-UNITPER
           ELSE
              IF RBACT-ELAPSED-UNITPER < (RBACT-ORGTERM - 1)
                 MOVE RBACT-REGPYAMT TO RBACTFP
              ELSE
                 IF RBACT-ELAPSED-UNITPER = (RBACT-ORGTERM - 1)
                    IF RBACT-ELAPSED-UNITPER-REM = 0
                       MOVE RBACT-REGPYAMT TO RBACTFP.

      ***********************************************************
      *    COMPUTE REGULAR PAYMENT REQUIREMENTS & ANNUITY FACTOR
      ***********************************************************
           IF RBACT-ORGTERM < 3
              MOVE 0 TO RBACTRP-A--N
                        RBACTRP-N
           ELSE
              MOVE RBACT-REGPYAMT TO RBACTRP
              IF RBACT-ELAPSED-UNITPER-REM = 0
                            OR RBACT-ELAPSED-UNITPER = RBACT-ORGTERM
                 SUBTRACT 2 FROM RBACT-ELAPSED-UNITPER GIVING RBACTRP-N
              ELSE
                 SUBTRACT 1 FROM RBACT-ELAPSED-UNITPER GIVING RBACTRP-N
              END-IF

              IF RBACTRP-N < 0
                 MOVE 0 TO RBACTRP-N
              END-IF

              COMPUTE RBACTRP-A--N ROUNDED =
                     (1 - 1 / (1 + RBACTI) ** RBACTRP-N) / RBACTI.

      ***************************************************
      *    COMPUTE LAST PAYMENT REQUIREMENTS & FACTOR
      ***************************************************
           IF RBACT-ORGTERM < 2
              MOVE 0 TO RBACTLP
              GO TO RBACT-ACTUARIAL-PV.

           MOVE RBACT-LASTPYAMT TO RBACTLP.
           IF RBACT-ELAPSED-UNITPER < 1
              MOVE 0 TO RBACTLP-N
                        RBACTFP
           ELSE
           IF RBACT-ELAPSED-UNITPER = 1
              IF RBACT-ELAPSED-UNITPER-REM = 0
                 MOVE 0 TO RBACTLP-N
                           RBACTFP
              ELSE
                 MOVE 1 TO RBACTLP-N
           ELSE
              IF RBACT-ELAPSED-UNITPER-REM = 0
                            OR RBACT-ELAPSED-UNITPER = RBACT-ORGTERM
                 SUBTRACT 1 FROM RBACT-ELAPSED-UNITPER GIVING RBACTLP-N
              ELSE
                 MOVE RBACT-ELAPSED-UNITPER TO RBACTLP-N.

           COMPUTE RBACTLP-FAC ROUNDED =
                      1 / ((1 + RBACTI) ** RBACTLP-N).

      ***************************************************
      *    COMPUTE PRESENT VALUE OF REMAINING PAYMENTS
      *         AT THE TIME OF REBATE
      ***************************************************
       RBACT-ACTUARIAL-PV.
           COMPUTE RBACTPV ROUNDED =
              RBACTADJ * (RBACTFP + RBACTRP * RBACTRP-A--N
                               + RBACTLP * RBACTLP-FAC
                       ).
           MOVE RBACTPV TO RBACT-PRES-VALUE.

      ***************************************************
      *    COMPUTE REBATE AMOUNT
      ***************************************************
           COMPUTE RBACT-REBATE ROUNDED =
              (RBACTFP + RBACTRP * RBACTRP-N + RBACTLP)
                                       - RBACTPV.

       RBACT-ACTUARIAL-EXIT.
           MOVE " " TO RBACT-SKIPDEF-FG
                       RBACT-EARN-FULL-MONTH.

      *-----------------------------------------------------------------------
      *    DUMMY SECTION TO INCLUDE IN COPY MEMBERS THAT NEED TO BE
      *    REFLECTED IN 'WHAT' COMMANDS FOR SUPPORT
      *-----------------------------------------------------------------------
       SCCS-COPY-ROUTINE SECTION. MOVE
           "@(#)./LIBGB/RBACT.CPY A32 >"
              TO MESS.

      *-----------------------------------------------------------------------
      *================================================================*
      * END COPYBOOK: LIBGB\RBACT.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\ADDONSPR.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/ADDONSPR
      *********************************************************************
      *               (LIBLP/ADDONSPR)
      *    FIND SPR ADDON INSURANCE WAS WRITTEN UNDER
      *
      ****** IMPORTANT NOTE ***************************************
      *
      *     SP1-FILE MUST BE OPEN BEFORE PERFORMING THIS ROUTINE
      *
      ****** IMPORTANT NOTE ***************************************
      *
      *   NAME: ADDONSPR
      *
      *   DESC: FIND-ADDON-SPR SECTION:
      *             THIS WILL FIND THE CORRECT SPR RECORD TO BE
      *             USED FOR REFUND OF ADDON INSURACE
      *
      *         FIND-ADDON-SPR-RESTORE SECTION:
      *             WILL RESTORE LOANS ORIGINAL SPR RECORD
      *
      *   IN  : MOVE THE INDEX OF INSURANCE TO ADDONSPR-SUB
      *          (WAS USING REB-SUB2)
      *                       EX.
      *                           FOR A&H ADDONSPR-SUB = 2
      *                               O2  ADDONSPR-SUB = 5
      *   OUT :
      *   COPY: ADDONSPRW
      *
      * REV:
      * BLV 020325 REMOVED CLOSES ON SP-FILE, CAUSED CLOSE ERRORS OF 47
      *            ON SPFILE IN CUSTMT; SP WILL GET CLOSED BY
      *            DECLARATIVES BEFORE PROGRAMS EXIT
      * BAH 150914 ADDED REB-SP-CONTRFRMLA TO HOLD ORIGINAL SPR VALUE, ADDONS
      *            READ THEIR OWN SPR THEN READ THE ORIGINAL AND THE
      *            SP-CONTRFRMLA COULD HAVE BEEN CHANGED IN CRNO, AMACC PL#901
      * BAH 2018.07.02 CREATE ADDONSPRW COPY MEMBER FOR OWN WORKERS, REMOVE
      *                THE REB- FIELDS AND USE ADDONSPR-
      * BAH 2019.03.01 REMOVED THE OPEN-SP1-FILE, MAKE SURE EACH PROGRAM
      *                HAS SP1-FILE OPEN. TOO MANY OPEN AND CLOSES WAS
      *                CAUSING SLOW SPEEDS
      *********************************************************************
       FIND-ADDON-SPR SECTION.

           IF ( LN-ADDON-FG NOT = "Y" ) OR ( ADDONSPR-SUB < 1 OR > 8 )
              MOVE " " TO ADDONSPR-SP1-KEY
              GO TO FIND-ADDON-SPR-EXIT.

           MOVE SP1-KEY       TO ADDONSPR-SP1-KEY.
           MOVE " "           TO ADDONSPR-SP-FLAG.
      * SAVE ORIGINAL SP-CONTRFRMLA, CRNO COULD HAVE CHANGED IT AND WHEN
      * YOU RESTORE THE ORIGINAL SPR IN HERE, YOU LOSE THAT CHANGE! SHOULD
      * REALLY BE SAVING THE RECORD INSTEAD OF REREADING IT.
           MOVE SP-CONTRFRMLA TO ADDONSPR-SP-CONTRFRMLA.

           PERFORM UNTIL ADDONSPR-SP-FLAG = "Y"
              IF SP-EXPDATE = 0
                 MOVE "Y" TO ADDONSPR-SP-FLAG
              ELSE
                 IF SP-EXPDATE NOT > LN-INSEFF-DATE(ADDONSPR-SUB)
                    IF SP-LAWCODE < 99
                       ADD 1 TO SP-LAWCODE
                    ELSE
                       MOVE ADDONSPR-SP1-KEY TO SP1-KEY
                       GO TO FIND-ADDON-SPR-EXIT
                    END-IF
                    PERFORM START-SP1-FILE
                    PERFORM READ-SP1-FILE-NEXT
                    IF IO-FG = 9
                       MOVE "Y" TO ADDONSPR-SP-FLAG
                       MOVE " " TO SP1-KEY
                       PERFORM FIND-ADDON-SPR-RESTORE
                    END-IF
                 ELSE
                    MOVE "Y" TO ADDONSPR-SP-FLAG
                 END-IF
              END-IF
           END-PERFORM.

       FIND-ADDON-SPR-EXIT.
           EXIT.

      ********************************************************
      *    TEST FOR RESTORE OF LOANS SPR RECORD
      ********************************************************
       FIND-ADDON-SPR-RESTORE SECTION.
           IF LN-ADDON-FG = "Y"
              IF ADDONSPR-SP1-KEY NOT = " "
                 IF SP1-KEY NOT = ADDONSPR-SP1-KEY
                    MOVE ADDONSPR-SP1-KEY TO SP1-KEY
                    PERFORM READ-SP1-FILE
                    IF IO-FG = 9
                       GO TO IO-ERROR
                    ELSE
      * IF YOU FIND THE ORIGINAL SPR, MAKE SURE THE SAVED CONTRFRMLA
      * IS RESTORED, CRNO COULD HAVE CHANGED IT SO WE HAVE TO SAVE IT
                       MOVE ADDONSPR-SP-CONTRFRMLA TO SP-CONTRFRMLA.
      *================================================================*
      * END COPYBOOK: LIBLP\ADDONSPR.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLPCL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLPCL
      ******************************************************************
      *
      * DESCRIPTION: LOAN PAYMENT FILE CLEAR ROUTINE
      *
      * ***NOTE*** : ANY CHANGES TO THE CLEAR ROUTINE NEEDS TO BE DONE
      *              TO THE CLEAR ROUTINE FROM THE MP-REC [LIBLP/LPMPCL]
      *
      *=================================================================
      * REV:
      * 021898 BAH ADDED LP-PREPAY-PENALTY LP-PRORATED-INS-REB
      * BAH 062598 CHANGED LP-TILLNO TO ALPHA, REMOVED THE MOVE 0
      *  CS 081998 ADDED LP-POSTING-BR
      * MJD 000119 ADDED LP-NOLCHG (WORLD PR#218)
      * JTG 010227 ADDED LP-EXTRA-PRIN-LFP LP-REMAIN-INT-SINCE-LFP
      *            LP-REMAIN-PRIN-SINCE-LFP  (LFP=LAST-FULL-PAYMENT)
      *            LENDMARK, PR#1045 & PR#1380
      * BLM 100305 ADDED LP-APPLIED-TO-ESCROW, REGWAN PR# 3506
      *  CS 151208 ADD LP-ADDON-INTPDTH, LP-BRNO(DISPLAY ONLY)
      *  CS 160201 ADD LP-FROMCL, LP-TOCL USED IN CLASS TRANSFER
      *
      * KEC 2017.0120 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED NOTE OF NEEDING TO UPDATE THE CLEAR ROUTINE
      *         FOR THE MP-REC [LIBLP/LPMPCL] IF ADDING TO HERE.
      *  CS 190502 CLEAR FUTURE FIELDS
      * BAH 20190628 REMOVED LP-RT-SEQNO REVOLVING
      * BAH 20210427 REMOVED FUTURE FIELDS
      * JKC 20220803 RESTORED MOVING ZEROES TO LP-TILLNO DUE TO GETTING
      *         SQL ERROR "NUMERIC VALUE OUT OF RANGE".
      * BAH 20240212 ADDED LP-REPAY-TRANS-ID #1641
      * BAH 2025.0501 WAS MISSING LP-ESCROW-PREPAID S35Q-205
      ******************************************************************
       CLEAR-LP-FILE SECTION.

           MOVE SPACES TO LP-REC.

           MOVE 0 TO LP-TRDATE LP-PAYDATE
                     LP-TRAMT LP-APOTH LP-APOT2 LP-APINT LP-APLC
                     LP-APCUR LP-OTHBAL LP-OT2BAL LP-INTBAL
                     LP-LCBAL LP-CURBAL LP-INTDUE LP-DLPROC LP-DLNO
                     LP-EARNED(1) LP-EARNED(2) LP-EARNED(3)
                     LP-INTPAID LP-SSNO LP-PDTH-DATE LP-LCPDTH-DATE
                     LP-APINTOWE LP-REVSEQNO
                     LP-NEWSTAT-RATE
                     LP-POSTDATE LP-POSTTIME
                     LP-DLRVCHGS-ADJ(1) LP-DLRVCHGS-ADJ(2)
                     LP-DLRVCHGS-ADJ(3)
                     LP-DLPARVHELD-ADJ LP-DLPARVPAID-ADJ
                     LP-POSTING-BR LP-NOLCHG
                     LP-EXTRA-PRIN-LFP LP-REMAIN-INT-SINCE-LFP
                     LP-REMAIN-PRIN-SINCE-LFP LP-APPLIED-TO-ESCROW 
                     LP-ADDON-INTPDTH-DATE
      *NEW LP FIELDS
                     LP-INTPDTH-DATE LP-PRIOR-POOLID LP-LT-SEQNO
                     LP-NEW1ST-PYDATE LP-DEF-DUEDATE
                     LP-ADDON-ORIG-REGPY LP-OLD1ST-PYDATE
                     LP-DEF-TERM LP-LCPARTIALS
                     LP-LCPAID LP-PREPAY-PENALTY  
                     LP-PRORATED-INS-REB LP-ADDON-LAST-PYAMT 
                     LP-FROMCL LP-TOCL LP-BRNO LP-LTOUCH-DATE
                     LP-TILLNO LP-REPAY-TRANS-ID LP-ESCROW-PREPAID.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLPCL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLXGCL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLXGCL
      **************************************************************************
      *    LPLXCL    LOAN PAYMENT TRAILER G/L CLEAR
      *
      * REV:
      *  04/09/2021 BAH NEW
      *  BAH 20210427 REMOVED FUTURE FIELDS
      **************************************************************************
       CLEAR-LXG-FILE SECTION.
           MOVE SPACES TO LXG-REC.

           MOVE 0 TO LXG-BRNO LXG-ACCTNO LXG-SEQNO.

           MOVE 0 TO LXG-LTOUCH-DATE.

           PERFORM VARYING LXG-SUB FROM 1 BY 1 UNTIL LXG-SUB > 3
              MOVE 0 TO LXG-GLNO(LXG-SUB)
                        LXG-GLAMT(LXG-SUB)
           END-PERFORM.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLXGCL.CPY                                *
      *================================================================*

      ******************************************************************
       MISC-ROUTINES SECTION.
      ******************************************************************
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\ACCESS.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/ACCESS
      *****************************************************
      *         VERIFY ACCESS TO A FILE
      *
      *   NAME: ACCESS
      *   DESC: THIS ROUTINE WILL TEST FOR THE EXISTENCE
      *         OF SOME FILE.
      *   IN  : PLACE PATH NAME OF FILE INTO ACCESS-BUF.
      *   OUT : STAT = "00" CONFIRMS EXISTENCE
      *   COPY: ACCESSW
      *   REV :
      *  120103 CLS CHANGED TO USE ACU C$FILEINFO
      *  120614 CLS ABOVE CHANGE WAS NOT PUT IN A15, IT IS NOW & ALSO A
      *             LONGER ACCESSW BUF OF 127
      *  120621  CS PUT BACK THE ORIGINAL 'C' CALL. C$FILEINFO DID NOT WORK IF
      *             IF ACCESS-CALL WAS TESTING FOR A DIRECTORY  VERYANT
      *  121017 KEC ADDED CHECK OF ACCESS-SOURCE & ACCESS-TARGET.
      *  130319  CS PUT BACK TO USE ACU CALL C$FILEINFO
      *  121017 KEC FIXED THE USE OF FILPATH-DATA INSTEAD OF
      *             EXT-FILPATH-DATA WHEN SETTING ACCESS-T-L-DATA.
      *****************************************************
       ACCESS-CALL.
           CALL "C$FILEINFO" USING ACCESS-BUF ACCESS-FILE-INFO
                                   GIVING ACCESS-STAT.
           IF ACCESS-STAT = 0
              MOVE "00" TO STAT
           ELSE
              MOVE "01" TO STAT.
      *================================================================*
      * END COPYBOOK: LIBGB\ACCESS.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\DACCESS.CPY                           *
      *================================================================*
      ****************************************************************
      * COPY MEMBER LIBGB/DACCESS: CHECK TO SEE IF A DIRECTORY EXISTS
      * BLM 140501 CHANGE C$SYSTEM TO SYSTEM, VERYANT
      * BLM 140519 CHANGE TO NOT CALL SHELL, JUST DO SYSTEM CALL WITH
      *            "LS -LD" & CHECK STATUS.
      * BLM 140522 CHANGE CALL "SYSTEM" TO PERFORM SYSTEM-CALL; NEW
      *             "LS -LD" WAS CAUSING OUTPUT TO SCREEN
      ****************************************************************
       DIR-ACCESS-CALL.
           MOVE DIR-ACCESS-BUF                 TO DIR-ACCESS-SOURCE.
           MOVE SPACES                         TO DIR-ACCESS-TARGET.

           CALL "C$TOLOWER" USING CK-DIR-LS, VALUE 7.
           MOVE SYSTEM-DEVNULL TO CK-DIR-DEVNULL.
           MOVE CK-DIR-EXISTS-CMD TO SYSTEM-BUF.
           PERFORM SYSTEM-CALL.
      *================================================================*
      * END COPYBOOK: LIBGB\DACCESS.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\MKTEMP.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/MKTEMP
      *****************************************
      *  PLACE PATH PREFIX IN MKTEMP-BUF.
      *  UNIQUE PATH APPEARS IN MKTEMP-BUF.
      *  NOTE THAT CALL DOES NOT CREATE FILE
      *  (RETURNS UNIQUE PATH FOR OPEN OUTPUT)
      *
      * REV:
      * MJD 130404 CHANGED TO CALL GB/MKTEMP.C THE VERYANT CONVERTED VERSION
      *            OF PFS C ROUTINE.
      *
      *            ADDED IF STAT = "05" TO BE ABLE TO RUN EITHER IN DEBUG
      *            FOR TESTING.
      * BLM 140417 SAVE & RESTORE FORM-PATH, SO CORRECT PROGRAM WILL
      *            GET CANCELED
      *****************************************
       MKTEMP-CALL.
           MOVE "05" TO STAT.
           MOVE FORM-PATH TO MKTEMP-SAVE-FORM-PATH.
           MOVE "GB/MKTEMP" TO FORM-NAM.
           CALL FORM-PROGX USING STAT MKTEMP-BUF.
           CANCEL FORM-PROGX.
           MOVE MKTEMP-SAVE-FORM-PATH TO FORM-PATH.
      *================================================================*
      * END COPYBOOK: LIBGB\MKTEMP.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\SYSTEM.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/SYSTEM
      ******************************************************************
      *         EXECUTE A SYSTEM COMMAND
      *
      *   NAME: SYSTEM
      *   DESC: THIS ROUTINE ALLOWS FOR ANY SYSTEM COMMAND
      *         TO BE EXECUTED.
      *   IN  : PLACE COMMAND INTO SYSTEM-BUF.
      *   OUT : ..COMMAND IS EXECUTED..
      *   COPY: SYSTEMW
      *
      *=================================================================
      ***
      *** LIBGB/CSYSTEM.CPY & LIBGB/CSYSTEMW.CPY WERE COPY MEMBERS THAT
      *** USED C$SYSTEM. WERE CREATED BY BARB & CINDY BACK IN 2013 WHEN
      *** CREATING A30 FROM A15. CHANGES WERE DONE FOR VERYANT BUT WERE
      *** REVERSED LATER.  THERE WERE SOME DISPLAY ISSUES DEPENDING ON
      *** ITS USAGE.
      *** LIBGB/CSYSTEM.CPY & LIBGB/CSYSTEMW.CPY WERE MOVED TO THE
      *** SV DIRECTORY AS A .NO SINCE THEY WERE NOT USED.
      *** THERE ARE HARDCODED C$SYSTEM IN GB/QUEPRU, GB/PREPRU AND
      *** GB/POSPRU DUE TO GARBAGE:
      ***   "THIS MUST STAY C$SYSTEM OR GARBAGE PRINTS, NO IDEA WHY"
      *** FOR MORE INFO, LOOK IN THE SHARED DRIVE FOR BARB'S DOC:
      ***   == PROJECT DOCUMENTS==/2).PROJECT DEVELOPMENT/2).SYSTEM CALL
      ***   SYSTEM CALL.DOCX 
      ***                                        UPDATE BY JAY 2017-0919
      ***
      *=================================================================
      *   REV :
      *   BLM 130325 CHANGED FROM C ROUTINE TO CALL C$SYSTEM
      *   BLM 140430 CHANGED FROM C$SYSTEM TO SYSTEM, ALSO CHANGED
      *              PROPERITES FILE TO HAVE ISCOCOL.SYSTEM.EXEC=C,
      *              THIS WILL ALLOW FUNCTION OF SYSTEM CALLS THAT
      *              USE <, >, |, IN VERYANT
      *   BLM 140503 REMOVE "2" FROM CALL, THIS ARGUMENT WAS FROM
      *              C$SYSTEM
      ******************************************************************
       SYSTEM-CALL.
      *    MOVE "00" TO STAT.
      *    CALL CMD USING STAT SYSTEM-BUF.
           MOVE DEV-NULL-CMD TO SYSTEM-DEV-NULL.
           CALL "SYSTEM" USING SYSTEM-BUFFER GIVING STAT-99.
      *================================================================*
      * END COPYBOOK: LIBGB\SYSTEM.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GETENV.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GETENV
      *****************************************************
      *         GET THE VALUE OF A SYSTEM VARIABLE
      *
      *   NAME: GETENV
      *   DESC: THIS ROUTINE ALLOWS FOR RETRIEVING ANY SYSTEM
      *         ENVIROMENT VARIABLE.
      *   IN  : PLACE ENVIROMENT VARIABLE NAME INTO
      *         GETENV-BUF
      *   OUT : ..VALUE OF ENVIROMENT VARIABE
      *   COPY: GETENVW
      *   REV :
      *****************************************************
       GETENV-CALL.
      *    MOVE "02" TO STAT.
      *    CALL CMD USING STAT GETENV-BUF.
      *    MOVE GETENV-BUF TO GETENV-NAME.
           ACCEPT GETENV-BUF FROM ENVIRONMENT GETENV-BUF.
           IF GETENV-BUF = " "
              MOVE "XX" TO STAT
           ELSE
              MOVE "00" TO STAT.
      *================================================================*
      * END COPYBOOK: LIBGB\GETENV.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\RMFILE.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/RMFILE
      * REV  BLM 140416 CHANGE FROM SYSTEM CALL TO CBL_DELETE_FILE; USE
      *                 ADDITIONAL CALLS TO REMOVE .IDX OR .VIX IF NEEDED
       REMOVE-WORKFILE.
           PERFORM ACCESS-CALL.
           IF STAT = "00"
             CALL "CBL_DELETE_FILE" USING ACCESS-BUF GIVING STAT-99
             INSPECT ACCESS-BUF REPLACING FIRST "    " BY IDX-SUFFIX
             PERFORM ACCESS-CALL
             IF STAT = "00"
                CALL "CBL_DELETE_FILE" USING ACCESS-BUF GIVING STAT-99
             END-IF
             INSPECT ACCESS-BUF REPLACING FIRST IDX-SUFFIX BY VIX-SUFFIX
             PERFORM ACCESS-CALL
             IF STAT = "00"
                CALL "CBL_DELETE_FILE" USING ACCESS-BUF GIVING STAT-99.
      *================================================================*
      * END COPYBOOK: LIBGB\RMFILE.CPY                                *
      *================================================================*
       GET-SPR.
           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.
           PERFORM READ-SP1-FILE.
           MOVE SP1-KEY TO HOLD-SP1-KEY.
       CALC-HOLD-LN-ACCERN.
           MOVE LN-EARN-ORDER(1) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(1) = LN-ACCERN(1) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(1) = LN-ACCERN(1) + LP-EARNED(SUB).

           MOVE LN-EARN-ORDER(2) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(2) = LN-ACCERN(2) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(2) = LN-ACCERN(2) + LP-EARNED(SUB).

           MOVE LN-EARN-ORDER(3) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(3) = LN-ACCERN(3) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(3) = LN-ACCERN(3) + LP-EARNED(SUB).

           MOVE LN-EARN-ORDER(4) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(4) = LN-ACCERN(4) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(4) = LN-ACCERN(4) + LP-EARNED(SUB).

           MOVE LN-EARN-ORDER(5) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(5) = LN-ACCERN(5) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(5) = LN-ACCERN(5) + LP-EARNED(SUB).

           MOVE LN-EARN-ORDER(6) TO SUB.
           IF SUB > 3
              COMPUTE HOLD-LN-ACCERN(6) = LN-ACCERN(6) +
                                          LXE-EARN(SUB - 3)
           ELSE
             COMPUTE HOLD-LN-ACCERN(6) = LN-ACCERN(6) + LP-EARNED(SUB).

       READ-EARNINGS.
      * GET THE LXE-EARN'S FOR THIS REVERSAL
           PERFORM OPEN-LXE1-FILE.
           MOVE LP-BRNO   TO LXE-BRNO.
           MOVE LP-ACCTNO TO LXE-ACCTNO.
           MOVE LP-SEQNO  TO LXE-SEQNO.
           PERFORM READ-LXE1-FILE.
           PERFORM CLOSE-LXE1-FILE.
           IF IO-FG NOT = 0
              MOVE 0 TO LXE-EARN(1) LXE-EARN(2) LXE-EARN(3)
                        LXE-EARN(4) LXE-EARN(5) LXE-EARN(6)
                        LXE-EARN(7) LXE-WORKER LXE-WORKER2.
           IF REV-REBATE NOT = "Y"
              MOVE LXE-REC TO WK-LXE-REC.


      ******************************************************************
       IO-ROUTINES SECTION.
      ******************************************************************
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\CONNECT_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/CONNECT_SQL.CPY
      ******************************************************************
      *
      * IDENTIFICATION: LIBGB/CONNECT_SQL
      * DESCRIPTION   : SQL SERVER CONNECTION ROUTINES
      *
      * NEEDED COPYS  : LIBGB/FILEWK
      *                 LIBGB/DECLARE   -OR-
      *                 LIBGB/DECLAREOD -OR-
      *                 LIBGB/DECLRP
      *
      *=================================================================
      * REV:
      * JKC 2021-0115 ***NEW***
      * JKC 2021-0223 CLEANING UP SOME OF THE CODE.
      * JKC 2021-0324 ADDED SQL-GET-DATE & SQL-SET-DATE.
      * JKC 2021-0430 CHANGES MADE WHILE WORKING ON DECLARE ROUTINES.
      * JKC 2021-0511 CHANGED NAME FROM SQLCONNECT TO CONNECT_SQL
      * JKC 2021-0714 ADDED DISPLAY OF PROGRAM NAME IN SQL-ERROR;
      *               FORM-PATHNAME(16:6)
      * JKC 2020-0726 ADDED EXT-SQL-CONNECT-STAT FOR CHECKING IF 
      *               CONNECTION TO SQL SERVER HAS ALREADY BEEN MADE;
      *               USED TO ONLY CONNECT ONE-TIME INSTEAD OF MULTIPLE
      *               TIMES IN EVERY PROGRAM.
      *
      * JKC 2021-0816 CHANGED SQL-GET-DATE AND SQL-SET-DATE TO CHECK
      *               FOR ZERO DATES & '1900-01-01'.
      *
      * JKC 2021-0817 UPDATED FROM XPC/IOCONN.PRE FOR LATEST CHANGES.
      * JKC 2021-0927 CHANGED SQL-ERROR SECTION TO ALWAYS DISPLAY
      *               E-KEYX NO MATTER WHAT IO TYPE (E-MSG4).
      *
      * JKC 2022-0209 MADE CHANGE TO SET SQL CONNECTION FIELDS AT THE
      *               START OF THE 'SQL-CONNECT' PARAGRAPH FOR POTENTIAL
      *               FUTURE USE OF HAVING MULTIPLE CONNECTIONS.
      *               DID SOME CLEANUP OF UNNEED CODE THAT WAS USED
      *               FOR A TWO-STEP COMPILE PROCESS; WE USE A ONE-STEP
      *               COMPILE GOING FORWARD AT THIS POINT.
      *
      * JKC 2022-0214 MADE CHANGE TO SQL-DISCONNECT TO 
      *               `MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT`
      *               DUE TO ISSUE FOUND WITH CLOSING CURSORS VIA
      *               SQL-ERROR;
      *               IN SQL-IO-VALIDATION ROUTINE ADDED A CHECK TO SEE
      *               IF THE SQL CONNECTION (EXT-ACUSQL-CONNECT-STAT)
      *               IS OPEN (GOOD) THEN `PERFORM CLOSE-FILES`;
      *               NEED TO ONLY CLOSE FILES/TABLES WHEN THERE IS
      *               AN SQL CONNECTION OTHERWISE YOU CAN GET INTO
      *               AN INIFITE LOOP DUE TO THE SQL-DISCONNECT IN
      *               SQL-ERROR WHICH THEN YOU CANNOT CLOSE CURSORS
      *               IF THE CONNECTION HAS BEEN CLOSED.
      *
      * JKC 2022-0622 MOVED THIS FROM LIBIO TO LIBGB; LIBIO WAS REMOVED
      * BAH 2022.0627 RENAMED EXT-ACUSQL-ODBC-NAME TO EXT-ACUSQL-DSN-NAME

      * JKC 2022-0804 REMOVED `SQL-CONNECT-VERIFY' PARAGRAPH; REPLACED
      *          IT WITH `SELECT 1 INTO :QGP-KEY`.
      *
      * JKC 2022-0805 CHANGED :QGP-KEY TO BE :SQL-CONNECT-VERIFY.
      * JKC 2022-0912 ADDED SQL-TEXT-DECREMENT AND SQL-TEXT-INCREMENT
      *          ROUTINES; USED IN CERTAIN IO START PARAGRAPH;
      *          NEEDED FOR SQL WHERE CONSTRAINTS SO TO GET THE
      *          START PARAGRAPHS TO ACT LIKE THE VISION FILES.
      * JKC 2022-0913 ADDED SQL-DATE-DECREMENT AND SQL-DATE-INCREMENT
      *          ROUTINES; USED IN CERTAIN IO START PARAGRAPH;
      *          NEEDED FOR SQL WHERE CONSTRAINTS SO TO GET THE
      *          START PARAGRAPHS TO ACT LIKE THE VISION FILES.
      * JKC 2022-1013 CHANGE SQL-TEXT-INCREMENT ROUTINE; ADDED
      *          SQL-TEXT-INCREMENT-ALPHA.
      *
      * JKC 2023-0815 ADDED SQL-TEXT-ASCII; HAS ALL HEX VALUES OF
      *          ALL CHARACTERS (ALPHA, NUMBERS, SPECIAL); THERE WAS AN
      *          ISSUE IN THE TEXT INCREMENT ROUTINE WHERE A "60+" WAS
      *          BEING INCREMENTED TO "60 " WHICH RESETS FROM THE START
      *          GIVING BAD RESULTS IN SCAN WINDOW; NEEDED TO ALLOW THE
      *          USE OF SPECIAL CHARACTERS TO INCREMENT OR DECREMENT.
      *
      * JKC 2023-0815 FIXED ONE ISSUE IN SQL-TEXT-INCREMENT SO THAT
      *          IT INCREMENTS A TEXT WHEN THE LAST CHARACTER IS NOT
      *          IN THE POSITION OF THE MAX SIZE; "M  " NOW WILL BE
      *          "N  " INSTEAD OF "M! ".
      *
      * JKC 2023-1006 FIXED SQL-TEXT-INCREMENT FOR PROPERLY INCREMENT
      *          THE LAST NON-SPACE CHARACTER IF IT IS NOT THAT
      *          LAST CHARACTER OF THE SIZE OF THE TEXT FIELD.
      *
      * MB  2023-1129 ADDED SQL-SWAP-UPDATE-CONNECTION - USED TO
      *          SET/SWAP CONNECTION (CURRENTLY BETWEEN C1 AND
      *          UDDATE_CONNECT)
      *
      * JKC 2024-0123 CHANGED THE DISPLAY OF THE ERROR WINDOW FOR
      *          THE PROGRAM TO NOT USE THE FULL PATH WITHIN
      *          E-PROG BUT SUBSTRING IT TO BE E-PROG(16:7)
      *
      * JKC 2024-0124 ADDED OTIS TRACE LOGGING LOGIC
      *
      * JKC 2024-0501 ADDED USE OF EXT-API-SCREEN-DISABLE AND
      *         EXT-API-MESS FOR SUPPRESS SCREEN INTERACTIONS FOR
      *         USE IN API PROGRAMS WITHOUT SCREENS.
      *
      * JKC 2024-0716 ADDED SQL-ERROR-DISPLAY; NEEDED FOR SUPPRESSING
      *          ERROR MESSAGE WINDOW DISPLAYING WHEN EXECUTING VIA
      *          BATCH (EOEXEC/EOCRON); CANNOT USE EXT-ROUTE-BUF SINCE
      *          NOT ALL PROGRAMS THAT USE CONNECT_SQL DOES NOT HAVE
      *          CONAME_EXT WHICH IS NEEDED; S35Q-88
      *
      ******************************************************************
      *
      *    S Q L - C O N N E C T
      *
      *=================================================================
      * IN  : EXT-ACUSQL-CONNECT-WORKERS
      * OUT : SQL-CONNECT-WORKERS
      *       IO-FG    [0 = GOOD; 9 = BAD]
      * DESC: MAKE CONNECTION TO THE SQL SERVER:
      *       1. CHECK CONNECTION STATUS
      *          A. BAD THEN MAKE CONNECTION
      *          B. GOOD THEN CONTINUE
      *       2. VERIFY CONNECTION
      *          A. BAD THEN CONTINUE
      *          B. GOOD THEN EXIT PARAGRAPH
      *       3. MAKE CONNECTION
      *       4. VERIFY CONNECTIONSTATUS
      *          A. BAD THEN ERROR PROCEDURE
      *          B. GOOD THEN EXIT PARAGRAPH
      ******************************************************************
       SQL-CONNECT.

           IF ( EXT-TCLP-TRACE-UPDATE )
              MOVE "PROGRAM START (LIBGB/CONNECT_SQL)"
                TO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEED TO SET THE SQL CONNECTION FIELDS RIGHT AWAY;
      *    IF WE MAKE MULTIPLE CONNNECTIONS FOR EACH/SEPERATE TABLES
      *    THEN THESE SQL CONNECTION FIELDS NEED TO BE SET SO THAT
      *    THEY CAN BE USED FOR EACH IO ROUTINE NEEDED;
      *    SQL CONNECTION FIELDS WERE ONLY BEING POPULATED WHEN
      *    GOING INTO 'SQL-CONNECT-MAKE' WHICH MAY NOT BE DONE IF
      *    THE CONNECT STAT WAS GOOD.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE EXT-ACUSQL-DSN-NAME  TO SQL-CONNECT-SERVER.
           MOVE EXT-ACUSQL-LOGIN     TO SQL-CONNECT-USERID.
           MOVE EXT-ACUSQL-PSWD      TO SQL-CONNECT-PSWD.
      *??? MOVE "WAAZA34SQL-DEV'     TO SQL-CONNECT-SERVER
      *??? MOVE "DB_OWNER"    	     TO SQL-CONNECT-OWNER
      *??? MOVE "OTIS"               TO SQL-CONNECT-DATABASE

           IF ( EXT-ACUSQL-CONNECT-STAT-BAD )
              PERFORM SQL-CONNECT-MAKE
              IF ( SQLCODE < 0 )
                 PERFORM SQL-CONNECT-ERROR
                 EXIT PARAGRAPH.

      * VERIFY SQL SERVER CONNECTION EXISTS
           EXEC SQL
                SELECT 1 INTO :SQL-CONNECT-VERIFY
           END-EXEC.

           IF ( SQLCODE = 0 )
              PERFORM SQL-CONNECT-WHENEVER
              MOVE STAT---GOOD TO EXT-ACUSQL-CONNECT-STAT
              EXIT PARAGRAPH.

           PERFORM SQL-CONNECT-MAKE.

           IF ( SQLCODE < 0 )
              PERFORM SQL-CONNECT-ERROR
              MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT
              EXIT PARAGRAPH.

           PERFORM SQL-CONNECT-WHENEVER.
           MOVE STAT---GOOD TO EXT-ACUSQL-CONNECT-STAT.


      ******************************************************************
      *
      *    S Q L - O P E N - U P D A T E - C O N N E C T I O N
      *
      *=================================================================
      * IN  : SQL-UPDATE-CONN-OPEN-SW
      * OUT : SQL-UPDATE-CONN-OPEN-SW
      * DESC: USED TO SWITCH CONNECTION FOR DOING UPDATES
      ******************************************************************
       SQL-OPEN-UPDATE-CONNECTION.

           IF SQL-UPDATE-CONN-OPEN-SW = "N"
              EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS UPDATE_CONNECT
                   USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
              END-EXEC
              MOVE "Y" TO SQL-UPDATE-CONN-OPEN-SW
              EXEC SQL SET CONNECTION C1 END-EXEC.

      ******************************************************************
      *
      *    S Q L - C L O S E - U P D A T E - C O N N E C T I O N
      *
      *=================================================================
      * IN  : SQL-UPDATE-CONN-OPEN-SW
      * OUT : SQL-UPDATE-CONN-OPEN-SW
      * DESC: USED TO SWITCH CONNECTION FOR DOING NON-UPDATES
      ******************************************************************
       SQL-CLOSE-UPDATE-CONNECTION.

           IF SQL-UPDATE-CONN-OPEN-SW = "Y"
              EXEC SQL SET CONNECTION UPDATE_CONNECT END-EXEC
              EXEC SQL COMMIT END-EXEC
              EXEC SQL DISCONNECT UPDATE_CONNECT END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE "N" TO SQL-UPDATE-CONN-OPEN-SW.

      ******************************************************************
      *
      *    S Q L - C L O S E - U P D A T E - C O N N E C T I O N
      *
      *=================================================================
      * IN  : SQL-UPDATE-CONN-OPEN-SW
      * OUT : NOTHING
      * DESC: USED TO SWITCH CONNECTION BETWEEN CONNECTION 1 & 2
      ******************************************************************
       SQL-SWAP-UPDATE-CONNECTION.

           IF SQL-UPDATE-CONN-USE-SW = "1"
              EXEC SQL SET CONNECTION C1 END-EXEC.

           IF SQL-UPDATE-CONN-USE-SW = "2"
              EXEC SQL SET CONNECTION UPDATE_CONNECT END-EXEC.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - E R R O R
      *
      *=================================================================
      * IN  : SQLCA WORKERS
      * OUT : NONE
      * DESC: PROCESS ERROR FOR SQL SERVER CONNECTION
      ******************************************************************
       SQL-CONNECT-ERROR.

           MOVE "CONNECTION"            TO E-MSG.
           MOVE "SQL SERVER CONNECTION" TO E-FILE.
           PERFORM SQL-ERROR.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - M A K E
      *
      *=================================================================
      * IN  : SQL-CONNECT-WORKERS
      * OUT : SQLCA WORKERS
      * DESC: MAKE CONNECTION TO THE SQL SERVER
      ******************************************************************
       SQL-CONNECT-MAKE.

           EXEC SQL
                CONNECT TO :SQL-CONNECT-SERVER AS C1
                      USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - W H E N E V E R
      *
      *=================================================================
      * IN  : NONE
      * OUT : NONE
      * DESC: DECLARE PROCEDURE FOR SQL ERRORS WHEN THEY OCCUR
      *       GPFILE SINCE IT SHOULD BE QUICK WITH ONLY HAVING ONE ROW.
      * NOTE: WHENEVER SQLERROR DOES NOT CATCH ALL ERRORS (LIKE A
      *          CASTING ERROR) SO WE STILL DO THE SQL-IO-VALIDATION
      *          AFTER EACH EXEC SQL IN ALL IO COPY MEMBERS!!!
      ******************************************************************
       SQL-CONNECT-WHENEVER.

           EXEC SQL WHENEVER SQLERROR
              PERFORM SQL-IO-VALIDATION
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - D I S C O N N E C T
      *
      *=================================================================
      * IN  : NOTHING
      * OUT : SQL-CONNECT-WORKERS
      * DESC: MAKE CONNECTION TO THE SQL SERVER
      *=================================================================
      * ***NOTE*** NEED TO HAVE SQL-DISCONNECT IN LIBGB/CONNECT_SQL AND
      *            LIBGB/DISCONNECT_SQL
      ******************************************************************
       SQL-DISCONNECT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEED TO HAVE WHENEVER SQLERROR NOT CALL TO SQL-IO-VALIDATION
      *    FOR CLOSING THE CONNECTION. THE USE IN LIBGB/DISCONNECT_SQL
      *    WILL NOT HAVE SQL-IO-VALIDATION SO NEED TO SHUT IT OFF
      *    (CONTINUE) AND DISCONNECT THEN PUT BACK.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           
           EXEC SQL WHENEVER SQLERROR CONTINUE END-EXEC.

           EXEC SQL COMMIT END-EXEC.
           EXEC SQL DISCONNECT ALL END-EXEC.

      * NO NEED TO CHECK SINCE EXITING APPLICATION VIA 'STOP RUN'
      *    IF ( SQLCODE < 0 )   
      *       PERFORM SQL-ERROR. 

      * NEED THE FOLLOWING FOR LIBGB/CONNECT_SQL
      * NEED TO COMMENT OUT THE FOLLOWING FOR LIBGB/DISCONNECT_SQL
      
           MOVE SPACES     TO SQL-CONNECT-WORKERS.
           MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT.

      * DECLARE PROCEDURE FOR SQL ERRORS WHEN THEY OCCUR
      * NOTE: WHENEVER SQLERROR DOES NOT CATCH ALL ERRORS (LIKE A
      *       CASTING ERROR) SO WE STILL DO THE SQL-IO-VALIDATION
      *       AFTER EACH EXEC SQL IN ALL IO COPY MEMBERS!!!
           
           EXEC SQL WHENEVER SQLERROR
              PERFORM SQL-IO-VALIDATION
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - D E B U G
      *
      *=================================================================
      * IN  : SQLCA
      * OUT : NOTHING
      * DESC: DISPLAY MESSAGE BOX OF SQLCA SETTINGS FOR DEBUG
      ******************************************************************
       SQL-DEBUG.

           MOVE SPACES                TO SQL-DEBUG-BUF
           MOVE "CODE : "             TO SQL-DEBUG-01-SQLCODEX
           MOVE SQLCODE               TO SQL-DEBUG-01-SQLCODE
           MOVE "CABC : "             TO SQL-DEBUG-01-SQLCABCX
           MOVE SQLCABC               TO SQL-DEBUG-01-SQLCABC
           MOVE "CAID: "              TO SQL-DEBUG-01-SQLCAIDX
           MOVE SQLCAID               TO SQL-DEBUG-01-SQLCAID
           MOVE "STATE: "             TO SQL-DEBUG-02-SQLSTATEX
           MOVE SQLSTATE              TO SQL-DEBUG-02-SQLSTATE
           MOVE "ERRML: "             TO SQL-DEBUG-02-SQLERRMLX
           MOVE SQLERRML              TO SQL-DEBUG-02-SQLERRML
           MOVE "ERRPL: "             TO SQL-DEBUG-02-SQLERRPLX
           MOVE SQLERRPL              TO SQL-DEBUG-02-SQLERRPL
           MOVE "WARN: "              TO SQL-DEBUG-02-SQLWARNX
           MOVE SQLWARN0              TO SQL-DEBUG-02-SQLWARN0
           MOVE SQLWARN1              TO SQL-DEBUG-02-SQLWARN1
           MOVE SQLWARN2              TO SQL-DEBUG-02-SQLWARN2
           MOVE SQLWARN3              TO SQL-DEBUG-02-SQLWARN3
           MOVE SQLWARN4              TO SQL-DEBUG-02-SQLWARN4
           MOVE SQLWARN5              TO SQL-DEBUG-02-SQLWARN5
           MOVE SQLWARN6              TO SQL-DEBUG-02-SQLWARN6
           MOVE SQLWARN7              TO SQL-DEBUG-02-SQLWARN7
           MOVE SQLWARN8              TO SQL-DEBUG-02-SQLWARN8
           MOVE SQLWARN9              TO SQL-DEBUG-02-SQLWARN9
           MOVE SQLWARNA              TO SQL-DEBUG-02-SQLWARNA
           MOVE "ERRD : "             TO SQL-DEBUG-03-SQLERRDX
           MOVE SQLERRD(1)            TO SQL-DEBUG-03-SQLERRD-1
           MOVE SQLERRD(2)            TO SQL-DEBUG-03-SQLERRD-2
           MOVE SQLERRD(3)            TO SQL-DEBUG-03-SQLERRD-3
           MOVE SQLERRD(4)            TO SQL-DEBUG-04-SQLERRD-4
           MOVE SQLERRD(5)            TO SQL-DEBUG-04-SQLERRD-5
           MOVE SQLERRD(6)            TO SQL-DEBUG-04-SQLERRD-6
           STRING "------------------------------",
                  "[ ERRMC ]",
                  "-------------------------------"
                  DELIMITED BY SIZE INTO SQL-DEBUG-05
           MOVE SQLERRMC              TO SQL-DEBUG-06
           STRING "------------------------------",
                  "[ ERRPC ]",
                  "-------------------------------"
                  DELIMITED BY SIZE INTO SQL-DEBUG-07
           MOVE SQLERRPC              TO SQL-DEBUG-08.

           IF ( EXT-API-SCREEN-DISABLE NOT = "Y" )
              DISPLAY MESSAGE BOX SQL-DEBUG-01, X"0A"
                                  SQL-DEBUG-02, X"0A"
                                  SQL-DEBUG-03, X"0A"
                                  SQL-DEBUG-04, X"0A"
                                  SQL-DEBUG-05, X"0A"
                                  SQL-DEBUG-06, X"0A"
                                  SQL-DEBUG-07, X"0A"
                                  SQL-DEBUG-08.

      ******************************************************************
      *
      *    S Q L - E R R O R
      *
      *=================================================================
      * IN  : E-MSG
      *       E-KEY
      *       SQLCA
      *       SQL-CONNECT-WORKERS
      * OUT : IO-FG   [0=GOOD; BAD!=0]
      * DESC: DISPLAY MESSAGE BOX OF SQL SERVER CONNECTION ERROR;
      *       DISCONNECT FROM SERVER
      ******************************************************************
       SQL-ERROR.

           IF ( EXT-TCLP-TRACE-UPDATE )
              STRING "ERROR: E-MSG, " | FILE = ", E-FILE
                     DELIMITED BY "  " INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME MESS
              CANCEL "TRACE"

              STRING "ERROR: KEY = ", E-KEYX
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE"

              STRING "ERROR: STATE = ", SQLSTATE
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE"

              STRING "ERROR: ", SQLERRMC
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES TO SQL-ERROR-BUF.

           STRING "STOP!!!  ",
                  "CALL HOME OFFICE FOR IT SUPPORT IMMEDIATELY!!!"
                  DELIMITED BY SIZE INTO SQL-ERROR-01.

           STRING "STOP!!!  ",
                  "AN ERROR HAS OCCURED --- DO NOT PROCEED!!!"
                  DELIMITED BY SIZE INTO SQL-ERROR-02.

           STRING E-MSG, " --- FILE: ", E-FILE,
                  " --- PROGRAM: ", E-PROG(16:7)
                  DELIMITED BY "  " INTO SQL-ERROR-04.

           MOVE "CODE: "  TO SQL-ERROR-05-SQLCODEX.
           MOVE SQLCODE   TO SQL-ERROR-05-SQLCODE.
           MOVE "STATE: " TO SQL-ERROR-05-SQLSTATEX.
           MOVE SQLSTATE  TO SQL-ERROR-05-SQLSTATE.
           MOVE "ERRML: " TO SQL-ERROR-05-SQLERRMLX.
           MOVE SQLERRML  TO SQL-ERROR-05-SQLERRML.
           MOVE "ERRPC: " TO SQL-ERROR-05-SQLERRPLX.
           MOVE SQLERRPL  TO SQL-ERROR-05-SQLERRPL.

           MOVE "KEY : "  TO SQL-ERROR-06-KEYX.
           MOVE E-KEYX    TO SQL-ERROR-06-KEY.

           MOVE SQLERRMC  TO SQL-ERROR-07.
           MOVE SQLERRPC  TO SQL-ERROR-08.

           IF ( EXT-API-SCREEN-DISABLE = "Y" )
              MOVE SQL-ERROR-04 TO EXT-API-MESS
           ELSE
           IF ( SQL-ERROR-DISPLAY = "Y" )
              DISPLAY MESSAGE BOX SQL-ERROR-01, X"0A"
                                  SQL-ERROR-02, X"0A"
                                  SQL-ERROR-03, X"0A"
                                  SQL-ERROR-04, X"0A"
                                  SQL-ERROR-05, X"0A"
                                  SQL-ERROR-06, X"0A"
                                  SQL-ERROR-07, X"0A"
                                  SQL-ERROR-08.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  NOTE: WE ARE DOING A SQL-DISCONNECT AT THE END OF SQL-ERROR
      *        TO FORCE PROGRAMS TO STOP EXECUTING.  FOR EXAMPLE,
      *        LP/ACRERN CALLS TO LP/AC1ERN WHICH IF AC1ERN ERRORS
      *        WE WANT WHEN RETURNING BACK TO ACRERN TO HAVE THE
      *        CONNECTION CLOSED ("THE CONNECTION DOES NOT EXIST") THUS
      *        CAUSING AN ERROR ON ANY IO OPERATIONS (BLOCK UPDATES;
      *        WRITE/REWRITE).
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM SQL-DISCONNECT.
           MOVE 9 TO IO-FG.          

      ******************************************************************
      *
      *    S Q L - D A T E - D E C R E M E N T
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: TAKE INPUT DATE THEN DECREMENT IT BY ONE DAY THEN
      *       FORMAT IT THEN RETURN IT BACK;
      *       TO GET A START NOT GREATER THAN TO WORK IN SQL LIKE IT
      *       DOES IN VISION FILES FOR MULTIPLE SCAN PAGES, NEED TO
      *       SUBTRACT ONE TO THE WHERE SCAN BEG (WSBEG).
      ******************************************************************
       SQL-DATE-DECREMENT.
           MOVE SQL-DATE-YYYYMMDD          TO NDTE-DATE.
           MOVE -1                         TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE                  TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.

      ******************************************************************
      *
      *    S Q L - D A T E - I N C R E M E N T
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: TAKE INPUT DATE THEN INCREMENT IT BY ONE DAY THEN
      *       FORMAT IT THEN RETURN IT BACK;
      *       TO GET A START TO WORK IN SQL LIKE IT DOES IN VISION FILES
      *       FOR MULTIPLE SCAN PAGES, NEED TO ADD ONE TO THE
      *       WHERE SCAN BEG (WSBEG).
      ******************************************************************
       SQL-DATE-INCREMENT.
           MOVE SQL-DATE-YYYYMMDD          TO NDTE-DATE.
           MOVE 1                          TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE                  TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.

      ******************************************************************
      *
      *    S Q L - G E T - D A T E
      *
      *=================================================================
      * IN  : SQL-DATE-YYYY-MM-DD
      * OUT : SQL-DATE-YYYYMMDD
      * DESC: CONVERT DATE FROM YYYY-MM-DD TO YYYYMMDD FORMAT;
      *       NEEDED FOR 'GET' FIELDS ROUTINES.
      ******************************************************************
       SQL-GET-DATE.

           IF ( SQL-DATE-YYYY-MM-DD = "1900-01-01" )
              MOVE ZEROES TO SQL-DATE-YYYYMMDD
           ELSE
              INSPECT SQL-DATE-YYYY-MM-DD REPLACING ALL SPACES BY ZEROES
              MOVE SQL-DATE-YYYY-MM-DD-YYYY TO SQL-DATE-YYYYMMDD-YYYY
              MOVE SQL-DATE-YYYY-MM-DD-MM   TO SQL-DATE-YYYYMMDD-MM
              MOVE SQL-DATE-YYYY-MM-DD-DD   TO SQL-DATE-YYYYMMDD-DD.

      ******************************************************************
      *
      *    S Q L - S E T - D A T E
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: CONVERT DATE FROM YYYYMMDD TO YYYY-MM-DD FORMAT;
      *       NEEDED FOR 'SET' FIELDS ROUTINES.
      ******************************************************************
       SQL-SET-DATE.

           IF ( SQL-DATE-YYYYMMDD = ZEROES )
              MOVE "1900-01-01" TO SQL-DATE-YYYY-MM-DD
           ELSE
              MOVE SQL-DATE-YYYYMMDD TO SQL-DATE-YYYY-MM-DD-NUM
              INSPECT SQL-DATE-YYYY-MM-DD-NUM REPLACING ALL "/" BY "-".

      ******************************************************************
      *
      *    S Q L - T E X T - D E C R E M E N T
      *
      *=================================================================
      * IN  : SQL-TEXT
      * OUT : SQL-TEXT
      * DESC: USED TO DECREMENT THE LAST CHARACTER OF A STRING SO THAT
      *       A START-NOT-GREATER PARAGRAPH (DECLARE CURSOR) WORKS LIKE
      *       A VISION FILE IN A MULTI-PAGE SCAN WINDOW;
      *       FIND THE LAST CHARACTER IN A TEXT STRING THEN DECREMENT
      *       IT BY ONE.  USING SQL-TEXT-ASCII WORKERS, WORK BACKWARDS:
      *
      *         " "     BECOMES " " (REMAINS SPACE; FIRST CHARACTER)
      *         "!"     BECOMES " "
      *         "1"     BECOMES "0"
      *         "B"     BECOMES "A" (UPPER B AND A)
      *         "~"     BECOMES "}"
      *
      *         "   "   BECOMES "   " (REMAINS SPACES; NO WHERE TO GO)
      *         "!  "   BECOMES "   "
      *         " ! "   BECOMES "   "
      *         "012"   BECOMES "011"
      *         "ABC"   BECOMES "ABB" (UPPER)
      *         "~~ "   BECOMES "~} "
      *         "~~!"   BECOMES "~~ "
      *         "~~~"   BECOMES "~~}"
      *
      ******************************************************************
       SQL-TEXT-DECREMENT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF TEXT FIELD IS SPACES, THEN KEEP IT SPACES (NO WHERE TO GO)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT = SPACES )
              MOVE ZEROES TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    FIND THE LAST CHARACTER IN THE SIZE OF THE TEXT STRING BY
      *    SEARCHING FOR THE LAST CHARACTER THAT IS NOT A SPACE THEN
      *    USE THAT SUBSCRIPT TO SET SQL-TEXT-SIZE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES TO SQL-TEXT-SIZE.

           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-MAX BY -1
                        UNTIL SQL-TEXT-S1 <= ZEROES

                   IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                      MOVE SQL-TEXT-S1 TO SQL-TEXT-SIZE
                      MOVE ZEROES      TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

           IF ( SQL-TEXT-SIZE = ZEROES )
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    CHANGE LAST CHARACTER FOUND BACKWARDS
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SQL-TEXTX(SQL-TEXT-SIZE) TO SQL-TEXT-CURRENT.
           PERFORM SQL-TEXT-FIND-ASCII.
           MOVE SQL-TEXT-BEFORE          TO SQL-TEXTX(SQL-TEXT-SIZE).

      ******************************************************************
      *
      *    S Q L - T E X T - I N C R E M E N T
      *
      *=================================================================
      * IN  : SQL-TEXT
      *       SQL-TEXT-SIZE [SIZE OF THE COBOL FIELD SIZE = PIC X(##)]
      * OUT : SQL-TEXT
      * DESC: USED TO INCREMENT TEXT STRING.  NEED THE SIZE OF THE COBOL
      *       FIELD TO KNOW WHICH CHARACTER NEEDS TO BE INCREMENTED TO.
      *
      *       IF THE LAST CHARACTER (SQL-TEXT-SIZE) IS NOT SPACE, THEN
      *       INCREMENT THAT CHARACTER:
      *
      *         " "     BECOMES "!"
      *         "/"     BECOMES "0"
      *         "9"     BECOMES ":"
      *         "@"     BECOMES "A" (UPPER A)
      *         "Z"     BECOMES "[" (UPPER Z)
      *         "`"     BECOMES "A" (LOWER A)
      *         "Z"     BECOMES "{" (LOWER Z)
      *         "~"     BECOMES "~" (~ REMAINS ~; LAST CHARACTER)
      *
      *         "AB!"   BECOMES "AB"" (UPPER AB)
      *         "AB/"   BECOMES "AB0" (UPPER AB)
      *         "AB9"   BECOMES "AB:" (UPPER AB)
      *         "AB@"   BECOMES "ABA" (UPPER ABA)
      *         "ABZ"   BECOMES "AB[" (UPPER ABZ)
      *         "AB`"   BECOMES "ABA" (UPPER AB LOWER A)
      *         "ABZ"   BECOMES "AB{" (UPPER AB LOWER Z)
      *         "AB~"   BECOMES "AC " (UPPER AB~ || UPPER AC)
      *         "AZZ"   BECOMES "AZ[" (UPPER AZZ)
      *         "AZ~"   BECOMES "A[ " (UPPER AZ~)
      *         "A~~"   BECOMES "B  " (UPPER A~~)
      *         "~~~"   REMAINS "~~~" (NO WHERE TO GO TO)
      *
      *         "AB!  " BECOMES "AB!! " (UPPER AB)
      *         "AB/  " BECOMES "AB/! " (UPPER AB)
      *         "AB9  " BECOMES "AB9! " (UPPER AB)
      *         "AB@  " BECOMES "AB@! " (UPPER AB)
      *         "ABZ  " BECOMES "ABZ! " (UPPER ABZ)
      *         "AB`  " BECOMES "AB`! " (UPPER AB)
      *         "AB~  " BECOMES "AB~! " (UPPER AB)
      *         "~~~  " BECOMES "~~~! "
      *
      *         "A !"   BECOMES "A "" (UPPER A)
      *         "A /"   BECOMES "A 0" (UPPER A)
      *         "A 9"   BECOMES "A :" (UPPER A)
      *         "A @"   BECOMES "A A" (UPPER A A)
      *         "A Z"   BECOMES "A [" (UPPER ABZ)
      *         "A `"   BECOMES "A A" (UPPER A SPACE LOWER A)
      *         "A ~"   BECOMES "A! " (UPPER A)
      *         "~  "   BECOMES "~! " 
      *         "~~ "   BECOMES "~~!" 
      *
      ******************************************************************
       SQL-TEXT-INCREMENT.

      * IF TEXT FIELD IS SPACES, THEN MAKE IT A LEADING ! ("!     ")
      
           IF ( SQL-TEXT = SPACES )
      * ! CHARACTER
              MOVE SQL-TEXT-ASCIIX(2) TO SQL-TEXT
              MOVE ZEROES             TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF SQL-TEXT-SIZE IS NOT SET THEN FIND THE SIZE OF THE TEXT
      *    STRING BY SEARCHING FOR THE LAST CHARACTER THAT IS NOT A
      *    SPACE THEN USE THAT SUBSCRIPT TO SET SQL-TEXT-SIZE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-SIZE NOT NUMERIC ) OR
              ( SQL-TEXT-SIZE = ZEROES    )
              MOVE 01 TO SQL-TEXT-SIZE
              PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-MAX BY -1
                        UNTIL SQL-TEXT-S1 <= ZEROES

                      IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                         MOVE SQL-TEXT-S1 TO SQL-TEXT-SIZE
                         MOVE ZEROES      TO SQL-TEXT-S1
                      END-IF

              END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF TEXT SIZE = 1, INCREMENT EXECPT IF A `~`
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-SIZE = 1 )
              IF ( SQL-TEXTX(1) = "~" )
                 MOVE ZEROES         TO SQL-TEXT-SIZE
                 EXIT PARAGRAPH
              ELSE
                 MOVE SQL-TEXTX(1)   TO SQL-TEXT-CURRENT
                 PERFORM SQL-TEXT-FIND-ASCII
                 MOVE SQL-TEXT-AFTER TO SQL-TEXTX(1)
                 MOVE ZEROES         TO SQL-TEXT-SIZE
                 EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    FIND LAST CHARACTER THAT IS NOT A SPACE FROM THE SIZE OF
      *    STRING; NEED TO KNOW IF THE LAST CHARACTER IS ALSO THE
      *    LAST IN THE SIZE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SQL-TEXT-SIZE TO SQL-TEXT-LAST.

           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-SIZE BY -1
                     UNTIL SQL-TEXT-S1 <= 0

                   IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                      MOVE SQL-TEXT-S1 TO SQL-TEXT-LAST
                      MOVE ZEROES      TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF LAST CHARACTER (NON-SPACE; SQL-TEXT-LAST) IS ALSO THE
      *    LAST POSITON OF THE STRING (SQL-TEXT-SIZE), THEN INCREMENT
      *    THAT POSITION EXCEPT IF A `~`
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-LAST                = SQL-TEXT-SIZE ) AND
              ( SQL-TEXTX(SQL-TEXT-LAST) NOT = "~"           )
              MOVE SQL-TEXTX(SQL-TEXT-LAST) TO SQL-TEXT-CURRENT
              PERFORM SQL-TEXT-FIND-ASCII
              MOVE SQL-TEXT-AFTER TO SQL-TEXTX(SQL-TEXT-LAST)
              MOVE ZEROES         TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF LAST CHARACTER (NON-SPACE; SQL-TEXT-LAST) IS ***NOT*** THE
      *    LAST POSITON OF THE STRING (SQL-TEXT-SIZE), THEN INCREMENT
      *    THE NEXT POSITION (SHOULD BE A SPACE; BECOMES A "!")
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-LAST NOT = SQL-TEXT-SIZE )
              MOVE SQL-TEXT-ASCIIX(2) TO SQL-TEXTX(SQL-TEXT-LAST + 1)
              MOVE ZEROES             TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LAST CHARACTER (SQL-TEXT-LAST) IS EQUAL TO LAST POSITION OF
      *    THE STRING (SQL-TEXT-SIZE) AND IS EQUAL TO A `~`.  NEED TO
      *    MAKE THAT POSITION A SPACE, THEN WORK BACKWARDS AND INCREMENT
      *    THAT POSITION UNLESS IT ALSO IS A `~` WHICH IF SO MAKE IT
      *    ALSO A SPACE AND REPEAT BACKWARDS TILL NON ~ CHARACTER FOUND:
      *
      *         "AZ~"   BECOMES "A[ " (UPPER AZ~)
      *         "A~~"   BECOMES "B  " (UPPER A~~)
      *         "A ~"   BECOMES "A! " (UPPER A)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-LAST BY -1
                     UNTIL SQL-TEXT-S1 <= 0

                   IF ( SQL-TEXTX(SQL-TEXT-S1) = "~" )
                      MOVE SPACES TO SQL-TEXTX(SQL-TEXT-S1)
                   ELSE
                      MOVE SQL-TEXTX(SQL-TEXT-S1) TO SQL-TEXT-CURRENT
                      PERFORM SQL-TEXT-FIND-ASCII
                      MOVE SQL-TEXT-AFTER TO SQL-TEXTX(SQL-TEXT-S1)
                      MOVE ZEROES         TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF SQL-TEXT EQUAL SPACES, THEN FILL IT WITH ALL `~`;
      *    THE PREVIOUS `PERFORM VARYING` CLEARED (SPACES) TO SQL-TEXT
      *    SO NEED TO POPULATE IT WITH `~` SINCE THERE NEEDS TO GET TO
      *    MAX VALUE TO SIGNAL THERE WAS NO WHERE TO GO:
      *
      *         "~~~"   REMAINS "~~~" (NO WHERE TO GO TO)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT = SPACES )
              MOVE ALL "~" TO SQL-TEXT.

      ******************************************************************
      *
      *    S Q L - T E X T - F I N D - A S C I I
      *
      *=================================================================
      * IN  : SQL-TEXT-CURRENT
      * OUT : SQL-TEXT-AFTER
      *       SQL-TEXT-BEFORE
      * DESC: FIND THE CURRENT CHARACTER IN SQL-TEXT-ASCII THEN RETURN
      *       BACK THE CHARACTER BEFORE & AFTER THE CURRENT CHARACTER.
      ******************************************************************
       SQL-TEXT-FIND-ASCII.

           MOVE ZEROES TO SQL-TEXT-S4.

           PERFORM VARYING SQL-TEXT-S3 FROM 1 BY 1
                     UNTIL SQL-TEXT-S3 > SQL-TEXT-ASCII-MAX

                  IF ( SQL-TEXT-ASCIIX(SQL-TEXT-S3) = SQL-TEXT-CURRENT )
                     MOVE SQL-TEXT-S3        TO SQL-TEXT-S4
                     MOVE SQL-TEXT-ASCII-MAX TO SQL-TEXT-S3
                  END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-S4 = ZEROES )
              MOVE SPACES TO SQL-TEXT-AFTER
                             SQL-TEXT-BEFORE
              EXIT PARAGRAPH.

           IF ( SQL-TEXT-S4 = 1 )
              MOVE SQL-TEXT-ASCIIX(2)               TO SQL-TEXT-AFTER
              MOVE SPACES                           TO SQL-TEXT-BEFORE
           ELSE
           IF ( SQL-TEXT-S4 = SQL-TEXT-ASCII-MAX )
              MOVE SPACES                           TO SQL-TEXT-AFTER
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 - 1) TO SQL-TEXT-BEFORE
           ELSE
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 + 1) TO SQL-TEXT-AFTER
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 - 1) TO SQL-TEXT-BEFORE.

      *================================================================*
      * END COPYBOOK: LIBGB\CONNECT_SQL.CPY                                *
      *================================================================*
       OPEN-LOG-FILE-EXTEND.
           OPEN EXTEND LOG-FILE.
           IF IO-FG = 8
              GO TO OPEN-LOG-FILE-EXTEND.
           IF IO-FG = 7
              CLOSE LOG-FILE
              GO TO OPEN-LOG-FILE-EXTEND.

       OPEN-LOG-FILE-OUTPUT.
           OPEN OUTPUT LOG-FILE.
           IF IO-FG = 8
              GO TO OPEN-LOG-FILE-OUTPUT.
           IF IO-FG = 7
              CLOSE LOG-FILE
              GO TO OPEN-LOG-FILE-OUTPUT.
       OPEN-LOG-FILE.
           OPEN INPUT LOG-FILE.
           IF IO-FG = 8
              GO TO OPEN-LOG-FILE.
           IF IO-FG = 7
              CLOSE LOG-FILE
              GO TO OPEN-LOG-FILE.
       WRITE-LOG-FILE.
           WRITE LOG-REC.
       CLOSE-LOG-FILE.
           CLOSE LOG-FILE.
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPSPGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPSPGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - SPFILE (SPAFILE, SPBFILE, SPCFILE)
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD SPA-REC FROM QSPA-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-SPA-FIELDS.
           MOVE QSPA-ORGST TO SPA-ORGST.
           MOVE QSPA-SPRCLASS TO SPA-SPRCLASS.
           MOVE QSPA-SUBCLASS TO SPA-SUBCLASS.
           MOVE QSPA-LAWCODE TO SPA-LAWCODE.

           IF ( QSPA-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO SPA-LTOUCH-DATE
           ELSE
              MOVE QSPA-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO SPA-LTOUCH-DATE.

           MOVE QSPA-DESC TO SPA-DESC.
           MOVE QSPA-NOTES TO SPA-NOTES.

           IF ( QSPA-EFFDATE = "1900-01-01" )
              MOVE ZEROES TO SPA-EFFDATE
           ELSE
              MOVE QSPA-EFFDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO SPA-EFFDATE.


           IF ( QSPA-EXPDATE = "1900-01-01" )
              MOVE ZEROES TO SPA-EXPDATE
           ELSE
              MOVE QSPA-EXPDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO SPA-EXPDATE.

           MOVE QSPA-EXPD-MONTHS TO SPA-EXPD-MONTHS.
           MOVE QSPA-EXPD-DAYS TO SPA-EXPD-DAYS.
           MOVE QSPA-EXPD-FRMLA TO SPA-EXPD-FRMLA.
           MOVE QSPA-EXPD-EXCEPT TO SPA-EXPD-EXCEPT.
           MOVE QSPA-EXPR-FRMLA TO SPA-EXPR-FRMLA.
           MOVE QSPA-EXPR-REDU-FRMLA TO SPA-EXPR-REDU-FRMLA.
           MOVE QSPA-EXPR-RATE-1 TO SPA-EXPR-RATE(1).
           MOVE QSPA-EXPR-BREAK-1 TO SPA-EXPR-BREAK(1).
           MOVE QSPA-EXPR-YRTYPE-1 TO SPA-EXPR-YRTYPE(1).
           MOVE QSPA-EXPR-INTMETH-1 TO SPA-EXPR-INTMETH(1).
           MOVE QSPA-EXPR-RATE-2 TO SPA-EXPR-RATE(2).
           MOVE QSPA-EXPR-BREAK-2 TO SPA-EXPR-BREAK(2).
           MOVE QSPA-EXPR-YRTYPE-2 TO SPA-EXPR-YRTYPE(2).
           MOVE QSPA-EXPR-INTMETH-2 TO SPA-EXPR-INTMETH(2).
           MOVE QSPA-EXPR-RATE-3 TO SPA-EXPR-RATE(3).
           MOVE QSPA-EXPR-BREAK-3 TO SPA-EXPR-BREAK(3).
           MOVE QSPA-EXPR-YRTYPE-3 TO SPA-EXPR-YRTYPE(3).
           MOVE QSPA-EXPR-INTMETH-3 TO SPA-EXPR-INTMETH(3).
           MOVE QSPA-EXPR-RATE-4 TO SPA-EXPR-RATE(4).
           MOVE QSPA-EXPR-BREAK-4 TO SPA-EXPR-BREAK(4).
           MOVE QSPA-EXPR-YRTYPE-4 TO SPA-EXPR-YRTYPE(4).
           MOVE QSPA-EXPR-INTMETH-4 TO SPA-EXPR-INTMETH(4).
           MOVE QSPA-EXPR-RATE-5 TO SPA-EXPR-RATE(5).
           MOVE QSPA-EXPR-BREAK-5 TO SPA-EXPR-BREAK(5).
           MOVE QSPA-EXPR-YRTYPE-5 TO SPA-EXPR-YRTYPE(5).
           MOVE QSPA-EXPR-INTMETH-5 TO SPA-EXPR-INTMETH(5).
           MOVE QSPA-EXPR-LCHG TO SPA-EXPR-LCHG.
           MOVE QSPA-JUDGFRMLA TO SPA-JUDGFRMLA.
           MOVE QSPA-JUDGRATE TO SPA-JUDGRATE.
           MOVE QSPA-JUDGYRTYPE TO SPA-JUDGYRTYPE.
           MOVE QSPA-JUDGINTMETH TO SPA-JUDGINTMETH.
           MOVE QSPA-ACC-FRMLA TO SPA-ACC-FRMLA.
           MOVE QSPA-ACC-YRTYPE TO SPA-ACC-YRTYPE.
           MOVE QSPA-ACC-INTMETH TO SPA-ACC-INTMETH.
           MOVE QSPA-ACC-RATE-1 TO SPA-ACC-RATE(1).
           MOVE QSPA-ACC-BREAK-1 TO SPA-ACC-BREAK(1).
           MOVE QSPA-ACC-RATE-2 TO SPA-ACC-RATE(2).
           MOVE QSPA-ACC-BREAK-2 TO SPA-ACC-BREAK(2).
           MOVE QSPA-ACC-RATE-3 TO SPA-ACC-RATE(3).
           MOVE QSPA-ACC-BREAK-3 TO SPA-ACC-BREAK(3).
           MOVE QSPA-ACC-RATE-4 TO SPA-ACC-RATE(4).
           MOVE QSPA-ACC-BREAK-4 TO SPA-ACC-BREAK(4).
           MOVE QSPA-ACC-RATE-5 TO SPA-ACC-RATE(5).
           MOVE QSPA-ACC-BREAK-5 TO SPA-ACC-BREAK(5).
           MOVE QSPA-1098FRMLA TO SPA-1098FRMLA.
           MOVE QSPA-DISFRMLA TO SPA-DISFRMLA.
           MOVE QSPA-CONTRFRMLA TO SPA-CONTRFRMLA.
           MOVE QSPA-BANKRULE TO SPA-BANKRULE.
           MOVE QSPA-CONTPDTH TO SPA-CONTPDTH.
           MOVE QSPA-FINCHG TO SPA-FINCHG.
           MOVE QSPA-BANKUNITPER-CD TO SPA-BANKUNITPER-CD.
           MOVE QSPA-TRWBANKRULE TO SPA-TRWBANKRULE.
           MOVE QSPA-TRWCONTPDTH TO SPA-TRWCONTPDTH.
           MOVE QSPA-TRWBANKUNITPER-CD TO SPA-TRWBANKUNITPER-CD.
           MOVE QSPA-RECFRMLA TO SPA-RECFRMLA.
           MOVE QSPA-RECPAYCD TO SPA-RECPAYCD.
           MOVE QSPA-RECPDTH TO SPA-RECPDTH.
           MOVE QSPA-DISFRMLA-SPAY-FG TO SPA-DISFRMLA-SPAY-FG.
           MOVE QSPA-ERNFRMLA-1 TO SPA-ERNFRMLA(1).
           MOVE QSPA-ERNAMT-1 TO SPA-ERNAMT(1).
           MOVE QSPA-ERNPERCT-1 TO SPA-ERNPERCT(1).
           MOVE QSPA-ERNPERCD-1 TO SPA-ERNPERCD(1).
           MOVE QSPA-ERNACCRL-FG-1 TO SPA-ERNACCRL-FG(1).
           MOVE QSPA-ERNACCRL-START-CD-1 TO SPA-ERNACCRL-START-CD(1).
           MOVE QSPA-ERNACCRL-DFCD-1 TO SPA-ERNACCRL-DFCD(1).
           MOVE QSPA-ERN-DAYS-1 TO SPA-ERN-DAYS(1).
           MOVE QSPA-ERN-TERM-1 TO SPA-ERN-TERM(1).
           MOVE QSPA-ERN-TYPE-1 TO SPA-ERN-TYPE(1).
           MOVE QSPA-ERNFRMLA-2 TO SPA-ERNFRMLA(2).
           MOVE QSPA-ERNAMT-2 TO SPA-ERNAMT(2).
           MOVE QSPA-ERNPERCT-2 TO SPA-ERNPERCT(2).
           MOVE QSPA-ERNPERCD-2 TO SPA-ERNPERCD(2).
           MOVE QSPA-ERNACCRL-FG-2 TO SPA-ERNACCRL-FG(2).
           MOVE QSPA-ERNACCRL-START-CD-2 TO SPA-ERNACCRL-START-CD(2).
           MOVE QSPA-ERNACCRL-DFCD-2 TO SPA-ERNACCRL-DFCD(2).
           MOVE QSPA-ERN-DAYS-2 TO SPA-ERN-DAYS(2).
           MOVE QSPA-ERN-TERM-2 TO SPA-ERN-TERM(2).
           MOVE QSPA-ERN-TYPE-2 TO SPA-ERN-TYPE(2).
           MOVE QSPA-ERNFRMLA-3 TO SPA-ERNFRMLA(3).
           MOVE QSPA-ERNAMT-3 TO SPA-ERNAMT(3).
           MOVE QSPA-ERNPERCT-3 TO SPA-ERNPERCT(3).
           MOVE QSPA-ERNPERCD-3 TO SPA-ERNPERCD(3).
           MOVE QSPA-ERNACCRL-FG-3 TO SPA-ERNACCRL-FG(3).
           MOVE QSPA-ERNACCRL-START-CD-3 TO SPA-ERNACCRL-START-CD(3).
           MOVE QSPA-ERNACCRL-DFCD-3 TO SPA-ERNACCRL-DFCD(3).
           MOVE QSPA-ERN-DAYS-3 TO SPA-ERN-DAYS(3).
           MOVE QSPA-ERN-TERM-3 TO SPA-ERN-TERM(3).
           MOVE QSPA-ERN-TYPE-3 TO SPA-ERN-TYPE(3).
           MOVE QSPA-ERNFRMLA-4 TO SPA-ERNFRMLA(4).
           MOVE QSPA-ERNAMT-4 TO SPA-ERNAMT(4).
           MOVE QSPA-ERNPERCT-4 TO SPA-ERNPERCT(4).
           MOVE QSPA-ERNPERCD-4 TO SPA-ERNPERCD(4).
           MOVE QSPA-ERNACCRL-FG-4 TO SPA-ERNACCRL-FG(4).
           MOVE QSPA-ERNACCRL-START-CD-4 TO SPA-ERNACCRL-START-CD(4).
           MOVE QSPA-ERNACCRL-DFCD-4 TO SPA-ERNACCRL-DFCD(4).
           MOVE QSPA-ERN-DAYS-4 TO SPA-ERN-DAYS(4).
           MOVE QSPA-ERN-TERM-4 TO SPA-ERN-TERM(4).
           MOVE QSPA-ERN-TYPE-4 TO SPA-ERN-TYPE(4).
           MOVE QSPA-ERNFRMLA-5 TO SPA-ERNFRMLA(5).
           MOVE QSPA-ERNAMT-5 TO SPA-ERNAMT(5).
           MOVE QSPA-ERNPERCT-5 TO SPA-ERNPERCT(5).
           MOVE QSPA-ERNPERCD-5 TO SPA-ERNPERCD(5).
           MOVE QSPA-ERNACCRL-FG-5 TO SPA-ERNACCRL-FG(5).
           MOVE QSPA-ERNACCRL-START-CD-5 TO SPA-ERNACCRL-START-CD(5).
           MOVE QSPA-ERNACCRL-DFCD-5 TO SPA-ERNACCRL-DFCD(5).
           MOVE QSPA-ERN-DAYS-5 TO SPA-ERN-DAYS(5).
           MOVE QSPA-ERN-TERM-5 TO SPA-ERN-TERM(5).
           MOVE QSPA-ERN-TYPE-5 TO SPA-ERN-TYPE(5).
           MOVE QSPA-ERNFRMLA-6 TO SPA-ERNFRMLA(6).
           MOVE QSPA-ERNAMT-6 TO SPA-ERNAMT(6).
           MOVE QSPA-ERNPERCT-6 TO SPA-ERNPERCT(6).
           MOVE QSPA-ERNPERCD-6 TO SPA-ERNPERCD(6).
           MOVE QSPA-ERNACCRL-FG-6 TO SPA-ERNACCRL-FG(6).
           MOVE QSPA-ERNACCRL-START-CD-6 TO SPA-ERNACCRL-START-CD(6).
           MOVE QSPA-ERNACCRL-DFCD-6 TO SPA-ERNACCRL-DFCD(6).
           MOVE QSPA-ERN-DAYS-6 TO SPA-ERN-DAYS(6).
           MOVE QSPA-ERN-TERM-6 TO SPA-ERN-TERM(6).
           MOVE QSPA-ERN-TYPE-6 TO SPA-ERN-TYPE(6).
           MOVE QSPA-ERNFRMLA-7 TO SPA-ERNFRMLA(7).
           MOVE QSPA-ERNAMT-7 TO SPA-ERNAMT(7).
           MOVE QSPA-ERNPERCT-7 TO SPA-ERNPERCT(7).
           MOVE QSPA-ERNPERCD-7 TO SPA-ERNPERCD(7).
           MOVE QSPA-ERNACCRL-FG-7 TO SPA-ERNACCRL-FG(7).
           MOVE QSPA-ERNACCRL-START-CD-7 TO SPA-ERNACCRL-START-CD(7).
           MOVE QSPA-ERNACCRL-DFCD-7 TO SPA-ERNACCRL-DFCD(7).
           MOVE QSPA-ERN-DAYS-7 TO SPA-ERN-DAYS(7).
           MOVE QSPA-ERN-TERM-7 TO SPA-ERN-TERM(7).
           MOVE QSPA-ERN-TYPE-7 TO SPA-ERN-TYPE(7).
           MOVE QSPA-ERNFRMLA-8 TO SPA-ERNFRMLA(8).
           MOVE QSPA-ERNAMT-8 TO SPA-ERNAMT(8).
           MOVE QSPA-ERNPERCT-8 TO SPA-ERNPERCT(8).
           MOVE QSPA-ERNPERCD-8 TO SPA-ERNPERCD(8).
           MOVE QSPA-ERNACCRL-FG-8 TO SPA-ERNACCRL-FG(8).
           MOVE QSPA-ERNACCRL-START-CD-8 TO SPA-ERNACCRL-START-CD(8).
           MOVE QSPA-ERNACCRL-DFCD-8 TO SPA-ERNACCRL-DFCD(8).
           MOVE QSPA-ERN-DAYS-8 TO SPA-ERN-DAYS(8).
           MOVE QSPA-ERN-TERM-8 TO SPA-ERN-TERM(8).
           MOVE QSPA-ERN-TYPE-8 TO SPA-ERN-TYPE(8).
           MOVE QSPA-ERNFRMLA-9 TO SPA-ERNFRMLA(9).
           MOVE QSPA-ERNAMT-9 TO SPA-ERNAMT(9).
           MOVE QSPA-ERNPERCT-9 TO SPA-ERNPERCT(9).
           MOVE QSPA-ERNPERCD-9 TO SPA-ERNPERCD(9).
           MOVE QSPA-ERNACCRL-FG-9 TO SPA-ERNACCRL-FG(9).
           MOVE QSPA-ERNACCRL-START-CD-9 TO SPA-ERNACCRL-START-CD(9).
           MOVE QSPA-ERNACCRL-DFCD-9 TO SPA-ERNACCRL-DFCD(9).
           MOVE QSPA-ERN-DAYS-9 TO SPA-ERN-DAYS(9).
           MOVE QSPA-ERN-TERM-9 TO SPA-ERN-TERM(9).
           MOVE QSPA-ERN-TYPE-9 TO SPA-ERN-TYPE(9).
           MOVE QSPA-ERNFRMLA-10 TO SPA-ERNFRMLA(10).
           MOVE QSPA-ERNAMT-10 TO SPA-ERNAMT(10).
           MOVE QSPA-ERNPERCT-10 TO SPA-ERNPERCT(10).
           MOVE QSPA-ERNPERCD-10 TO SPA-ERNPERCD(10).
           MOVE QSPA-ERNACCRL-FG-10 TO SPA-ERNACCRL-FG(10).
           MOVE QSPA-ERNACCRL-START-CD-10 TO SPA-ERNACCRL-START-CD(10).
           MOVE QSPA-ERNACCRL-DFCD-10 TO SPA-ERNACCRL-DFCD(10).
           MOVE QSPA-ERN-DAYS-10 TO SPA-ERN-DAYS(10).
           MOVE QSPA-ERN-TERM-10 TO SPA-ERN-TERM(10).
           MOVE QSPA-ERN-TYPE-10 TO SPA-ERN-TYPE(10).
           MOVE QSPA-ERNACCEL-CD TO SPA-ERNACCEL-CD.
           MOVE QSPA-ERNJD-CD TO SPA-ERNJD-CD.
           MOVE QSPA-MIDSTRERNCD TO SPA-MIDSTRERNCD.
           MOVE QSPA-EARN-ORDER-1 TO SPA-EARN-ORDER(1).
           MOVE QSPA-EARN-ORDER-2 TO SPA-EARN-ORDER(2).
           MOVE QSPA-EARN-ORDER-3 TO SPA-EARN-ORDER(3).
           MOVE QSPA-EARN-ORDER-4 TO SPA-EARN-ORDER(4).
           MOVE QSPA-EARN-ORDER-5 TO SPA-EARN-ORDER(5).
           MOVE QSPA-EARN-ORDER-6 TO SPA-EARN-ORDER(6).
           MOVE QSPA-EARN-ORDER-7 TO SPA-EARN-ORDER(7).
           MOVE QSPA-EARN-ORDER-8 TO SPA-EARN-ORDER(8).
           MOVE QSPA-EARN-ORDER-9 TO SPA-EARN-ORDER(9).
           MOVE QSPA-EARN-ORDER-10 TO SPA-EARN-ORDER(10).
           MOVE QSPA-ERNDELQFRMLA TO SPA-ERNDELQFRMLA.
           MOVE QSPA-ERNDELQ-START TO SPA-ERNDELQ-START.
           MOVE QSPA-ERNDELQ-STOP TO SPA-ERNDELQ-STOP.
           MOVE QSPA-1098-INC-LC TO SPA-1098-INC-LC.
           MOVE QSPA-MAX-IB-ACR-DAYS TO SPA-MAX-IB-ACR-DAYS.
           MOVE QSPA-LCGRACE TO SPA-LCGRACE.
           MOVE QSPA-LCGRACECD TO SPA-LCGRACECD.
           MOVE QSPA-LCTYPE TO SPA-LCTYPE.
           MOVE QSPA-LCRATE TO SPA-LCRATE.
           MOVE QSPA-LCFRMLA TO SPA-LCFRMLA.
           MOVE QSPA-LCMINCHG TO SPA-LCMINCHG.
           MOVE QSPA-LCMAXAMT TO SPA-LCMAXAMT.
           MOVE QSPA-LCDELFAC TO SPA-LCDELFAC.
           MOVE QSPA-LCYRTYPE TO SPA-LCYRTYPE.
           MOVE QSPA-LC-CODE TO SPA-LC-CODE.
           MOVE QSPA-LCUNITPER-CD TO SPA-LCUNITPER-CD.
           MOVE QSPA-DEFFRMLA TO SPA-DEFFRMLA.
           MOVE QSPA-DEFEXCEPT TO SPA-DEFEXCEPT.
           MOVE QSPA-DEFWORKER TO SPA-DEFWORKER.
           MOVE QSPA-DEFPERCD TO SPA-DEFPERCD.
           MOVE QSPA-DEFBASE TO SPA-DEFBASE.
           MOVE QSPA-DEFPOLCD TO SPA-DEFPOLCD.
           MOVE QSPA-DEFPOLMX-1 TO SPA-DEFPOLMX(1).
           MOVE QSPA-DEFPOLMX-2 TO SPA-DEFPOLMX(2).
           MOVE QSPA-DEFPOLMX-3 TO SPA-DEFPOLMX(3).
           MOVE QSPA-DEFMIN TO SPA-DEFMIN.
           MOVE QSPA-DEFMAX TO SPA-DEFMAX.
           MOVE QSPA-DEFUNITPER-CD TO SPA-DEFUNITPER-CD.
           MOVE QSPA-PRFORM-1 TO SPA-PRFORM(1).
           MOVE QSPA-PRFLAG-1 TO SPA-PRFLAG(1).
           MOVE QSPA-PRFORM-2 TO SPA-PRFORM(2).
           MOVE QSPA-PRFLAG-2 TO SPA-PRFLAG(2).
           MOVE QSPA-PRFORM-3 TO SPA-PRFORM(3).
           MOVE QSPA-PRFLAG-3 TO SPA-PRFLAG(3).
           MOVE QSPA-PRFORM-4 TO SPA-PRFORM(4).
           MOVE QSPA-PRFLAG-4 TO SPA-PRFLAG(4).
           MOVE QSPA-PRFORM-5 TO SPA-PRFORM(5).
           MOVE QSPA-PRFLAG-5 TO SPA-PRFLAG(5).
           MOVE QSPA-PRFORM-6 TO SPA-PRFORM(6).
           MOVE QSPA-PRFLAG-6 TO SPA-PRFLAG(6).
           MOVE QSPA-PRFORM-7 TO SPA-PRFORM(7).
           MOVE QSPA-PRFLAG-7 TO SPA-PRFLAG(7).
           MOVE QSPA-PRFORM-8 TO SPA-PRFORM(8).
           MOVE QSPA-PRFLAG-8 TO SPA-PRFLAG(8).
           MOVE QSPA-PRFORM-9 TO SPA-PRFORM(9).
           MOVE QSPA-PRFLAG-9 TO SPA-PRFLAG(9).
           MOVE QSPA-PRFORM-10 TO SPA-PRFORM(10).
           MOVE QSPA-PRFLAG-10 TO SPA-PRFLAG(10).
           MOVE QSPA-PRFORM-11 TO SPA-PRFORM(11).
           MOVE QSPA-PRFLAG-11 TO SPA-PRFLAG(11).
           MOVE QSPA-PRFORM-12 TO SPA-PRFORM(12).
           MOVE QSPA-PRFLAG-12 TO SPA-PRFLAG(12).
           MOVE QSPA-PRFORM-13 TO SPA-PRFORM(13).
           MOVE QSPA-PRFLAG-13 TO SPA-PRFLAG(13).
           MOVE QSPA-PRFORM-14 TO SPA-PRFORM(14).
           MOVE QSPA-PRFLAG-14 TO SPA-PRFLAG(14).
           MOVE QSPA-PRFORM-15 TO SPA-PRFORM(15).
           MOVE QSPA-PRFLAG-15 TO SPA-PRFLAG(15).
           MOVE QSPA-PRFORM-16 TO SPA-PRFORM(16).
           MOVE QSPA-PRFLAG-16 TO SPA-PRFLAG(16).
           MOVE QSPA-PRFORM-17 TO SPA-PRFORM(17).
           MOVE QSPA-PRFLAG-17 TO SPA-PRFLAG(17).
           MOVE QSPA-PRFORM-18 TO SPA-PRFORM(18).
           MOVE QSPA-PRFLAG-18 TO SPA-PRFLAG(18).
           MOVE QSPA-PRFORM-19 TO SPA-PRFORM(19).
           MOVE QSPA-PRFLAG-19 TO SPA-PRFLAG(19).
           MOVE QSPA-PRFORM-20 TO SPA-PRFORM(20).
           MOVE QSPA-PRFLAG-20 TO SPA-PRFLAG(20).
           MOVE QSPA-IMED-REC TO SPA-IMED-REC.
           MOVE QSPA-SCFRMLA TO SPA-SCFRMLA.
           MOVE QSPA-SCRATE TO SPA-SCRATE.
           MOVE QSPA-SCMIN TO SPA-SCMIN.
           MOVE QSPA-SCMAX TO SPA-SCMAX.
           MOVE QSPA-MFFRMLA TO SPA-MFFRMLA.
           MOVE QSPA-MFRATE TO SPA-MFRATE.
           MOVE QSPA-MFMIN TO SPA-MFMIN.
           MOVE QSPA-MFMAX TO SPA-MFMAX.
           MOVE QSPA-INTMETHOD TO SPA-INTMETHOD.
           MOVE QSPA-YEARTYPE TO SPA-YEARTYPE.
           MOVE QSPA-PYEXFRMLA TO SPA-PYEXFRMLA.
           MOVE QSPA-PYEXSPCODE TO SPA-PYEXSPCODE.
           MOVE QSPA-PYEXYEARTP TO SPA-PYEXYEARTP.
           MOVE QSPA-PYEXFMDATE TO SPA-PYEXFMDATE.
           MOVE QSPA-PYEXBASECD TO SPA-PYEXBASECD.
           MOVE QSPA-PYEXBASE TO SPA-PYEXBASE.
           MOVE QSPA-PYEXDAYS TO SPA-PYEXDAYS.
           MOVE QSPA-CAL-SPFRMLA TO SPA-CAL-SPFRMLA.
           MOVE QSPA-CAL-RATETYPE-1 TO SPA-CAL-RATETYPE(1).
           MOVE QSPA-CAL-BREAKTYPE-1 TO SPA-CAL-BREAKTYPE(1).
           MOVE QSPA-CAL-CHGABLE-1 TO SPA-CAL-CHGABLE(1).
           MOVE QSPA-CAL-NORATES-1 TO SPA-CAL-NORATES(1).
           MOVE QSPA-CAL-TBFRMLA-1 TO SPA-CAL-TBFRMLA(1).
           MOVE QSPA-CAL-RATE-1-1 TO SPA-CAL-RATE(1 1).
           MOVE QSPA-CAL-BREAK-1-1 TO SPA-CAL-BREAK(1 1).
           MOVE QSPA-CAL-RATE-1-2 TO SPA-CAL-RATE(1 2).
           MOVE QSPA-CAL-BREAK-1-2 TO SPA-CAL-BREAK(1 2).
           MOVE QSPA-CAL-RATE-1-3 TO SPA-CAL-RATE(1 3).
           MOVE QSPA-CAL-BREAK-1-3 TO SPA-CAL-BREAK(1 3).
           MOVE QSPA-CAL-RATE-1-4 TO SPA-CAL-RATE(1 4).
           MOVE QSPA-CAL-BREAK-1-4 TO SPA-CAL-BREAK(1 4).
           MOVE QSPA-CAL-RATE-1-5 TO SPA-CAL-RATE(1 5).
           MOVE QSPA-CAL-BREAK-1-5 TO SPA-CAL-BREAK(1 5).
           MOVE QSPA-CAL-RATETYPE-2 TO SPA-CAL-RATETYPE(2).
           MOVE QSPA-CAL-BREAKTYPE-2 TO SPA-CAL-BREAKTYPE(2).
           MOVE QSPA-CAL-CHGABLE-2 TO SPA-CAL-CHGABLE(2).
           MOVE QSPA-CAL-NORATES-2 TO SPA-CAL-NORATES(2).
           MOVE QSPA-CAL-TBFRMLA-2 TO SPA-CAL-TBFRMLA(2).
           MOVE QSPA-CAL-RATE-2-1 TO SPA-CAL-RATE(2 1).
           MOVE QSPA-CAL-BREAK-2-1 TO SPA-CAL-BREAK(2 1).
           MOVE QSPA-CAL-RATE-2-2 TO SPA-CAL-RATE(2 2).
           MOVE QSPA-CAL-BREAK-2-2 TO SPA-CAL-BREAK(2 2).
           MOVE QSPA-CAL-RATE-2-3 TO SPA-CAL-RATE(2 3).
           MOVE QSPA-CAL-BREAK-2-3 TO SPA-CAL-BREAK(2 3).
           MOVE QSPA-CAL-RATE-2-4 TO SPA-CAL-RATE(2 4).
           MOVE QSPA-CAL-BREAK-2-4 TO SPA-CAL-BREAK(2 4).
           MOVE QSPA-CAL-RATE-2-5 TO SPA-CAL-RATE(2 5).
           MOVE QSPA-CAL-BREAK-2-5 TO SPA-CAL-BREAK(2 5).
           MOVE QSPA-MINSF-FRMLA TO SPA-MINSF-FRMLA.
           MOVE QSPA-MINSF-CHG TO SPA-MINSF-CHG.
           MOVE QSPA-MAXAPR-FRMLA TO SPA-MAXAPR-FRMLA.
           MOVE QSPA-EDT-NOEDITS-1 TO SPA-EDT-NOEDITS(1).
           MOVE QSPA-EDT-TYPE-1-1 TO SPA-EDT-TYPE(1 1).
           MOVE QSPA-EDT-HL-1-1 TO SPA-EDT-HL(1 1).
           MOVE QSPA-EDT-COLL-1-1 TO SPA-EDT-COLL(1 1).
           MOVE QSPA-EDT-CD-1-1 TO SPA-EDT-CD(1 1).
           MOVE QSPA-EDT-RATE-1-1 TO SPA-EDT-RATE(1 1).
           MOVE QSPA-EDT-RATETYPE-1-1 TO SPA-EDT-RATETYPE(1 1).
           MOVE QSPA-EDT-AMT-1-1 TO SPA-EDT-AMT(1 1).
           MOVE QSPA-EDT-AMTYPE-1-1 TO SPA-EDT-AMTYPE(1 1).
           MOVE QSPA-EDT-TERM-1-1 TO SPA-EDT-TERM(1 1).
           MOVE QSPA-EDT-TYPE-1-2 TO SPA-EDT-TYPE(1 2).
           MOVE QSPA-EDT-HL-1-2 TO SPA-EDT-HL(1 2).
           MOVE QSPA-EDT-COLL-1-2 TO SPA-EDT-COLL(1 2).
           MOVE QSPA-EDT-CD-1-2 TO SPA-EDT-CD(1 2).
           MOVE QSPA-EDT-RATE-1-2 TO SPA-EDT-RATE(1 2).
           MOVE QSPA-EDT-RATETYPE-1-2 TO SPA-EDT-RATETYPE(1 2).
           MOVE QSPA-EDT-AMT-1-2 TO SPA-EDT-AMT(1 2).
           MOVE QSPA-EDT-AMTYPE-1-2 TO SPA-EDT-AMTYPE(1 2).
           MOVE QSPA-EDT-TERM-1-2 TO SPA-EDT-TERM(1 2).
           MOVE QSPA-EDT-TYPE-1-3 TO SPA-EDT-TYPE(1 3).
           MOVE QSPA-EDT-HL-1-3 TO SPA-EDT-HL(1 3).
           MOVE QSPA-EDT-COLL-1-3 TO SPA-EDT-COLL(1 3).
           MOVE QSPA-EDT-CD-1-3 TO SPA-EDT-CD(1 3).
           MOVE QSPA-EDT-RATE-1-3 TO SPA-EDT-RATE(1 3).
           MOVE QSPA-EDT-RATETYPE-1-3 TO SPA-EDT-RATETYPE(1 3).
           MOVE QSPA-EDT-AMT-1-3 TO SPA-EDT-AMT(1 3).
           MOVE QSPA-EDT-AMTYPE-1-3 TO SPA-EDT-AMTYPE(1 3).
           MOVE QSPA-EDT-TERM-1-3 TO SPA-EDT-TERM(1 3).
           MOVE QSPA-EDT-TYPE-1-4 TO SPA-EDT-TYPE(1 4).
           MOVE QSPA-EDT-HL-1-4 TO SPA-EDT-HL(1 4).
           MOVE QSPA-EDT-COLL-1-4 TO SPA-EDT-COLL(1 4).
           MOVE QSPA-EDT-CD-1-4 TO SPA-EDT-CD(1 4).
           MOVE QSPA-EDT-RATE-1-4 TO SPA-EDT-RATE(1 4).
           MOVE QSPA-EDT-RATETYPE-1-4 TO SPA-EDT-RATETYPE(1 4).
           MOVE QSPA-EDT-AMT-1-4 TO SPA-EDT-AMT(1 4).
           MOVE QSPA-EDT-AMTYPE-1-4 TO SPA-EDT-AMTYPE(1 4).
           MOVE QSPA-EDT-TERM-1-4 TO SPA-EDT-TERM(1 4).
           MOVE QSPA-EDT-TYPE-1-5 TO SPA-EDT-TYPE(1 5).
           MOVE QSPA-EDT-HL-1-5 TO SPA-EDT-HL(1 5).
           MOVE QSPA-EDT-COLL-1-5 TO SPA-EDT-COLL(1 5).
           MOVE QSPA-EDT-CD-1-5 TO SPA-EDT-CD(1 5).
           MOVE QSPA-EDT-RATE-1-5 TO SPA-EDT-RATE(1 5).
           MOVE QSPA-EDT-RATETYPE-1-5 TO SPA-EDT-RATETYPE(1 5).
           MOVE QSPA-EDT-AMT-1-5 TO SPA-EDT-AMT(1 5).
           MOVE QSPA-EDT-AMTYPE-1-5 TO SPA-EDT-AMTYPE(1 5).
           MOVE QSPA-EDT-TERM-1-5 TO SPA-EDT-TERM(1 5).
           MOVE QSPA-EDT-TYPE-1-6 TO SPA-EDT-TYPE(1 6).
           MOVE QSPA-EDT-HL-1-6 TO SPA-EDT-HL(1 6).
           MOVE QSPA-EDT-COLL-1-6 TO SPA-EDT-COLL(1 6).
           MOVE QSPA-EDT-CD-1-6 TO SPA-EDT-CD(1 6).
           MOVE QSPA-EDT-RATE-1-6 TO SPA-EDT-RATE(1 6).
           MOVE QSPA-EDT-RATETYPE-1-6 TO SPA-EDT-RATETYPE(1 6).
           MOVE QSPA-EDT-AMT-1-6 TO SPA-EDT-AMT(1 6).
           MOVE QSPA-EDT-AMTYPE-1-6 TO SPA-EDT-AMTYPE(1 6).
           MOVE QSPA-EDT-TERM-1-6 TO SPA-EDT-TERM(1 6).
           MOVE QSPA-EDT-NOEDITS-2 TO SPA-EDT-NOEDITS(2).
           MOVE QSPA-EDT-TYPE-2-1 TO SPA-EDT-TYPE(2 1).
           MOVE QSPA-EDT-HL-2-1 TO SPA-EDT-HL(2 1).
           MOVE QSPA-EDT-COLL-2-1 TO SPA-EDT-COLL(2 1).
           MOVE QSPA-EDT-CD-2-1 TO SPA-EDT-CD(2 1).
           MOVE QSPA-EDT-RATE-2-1 TO SPA-EDT-RATE(2 1).
           MOVE QSPA-EDT-RATETYPE-2-1 TO SPA-EDT-RATETYPE(2 1).
           MOVE QSPA-EDT-AMT-2-1 TO SPA-EDT-AMT(2 1).
           MOVE QSPA-EDT-AMTYPE-2-1 TO SPA-EDT-AMTYPE(2 1).
           MOVE QSPA-EDT-TERM-2-1 TO SPA-EDT-TERM(2 1).
           MOVE QSPA-EDT-TYPE-2-2 TO SPA-EDT-TYPE(2 2).
           MOVE QSPA-EDT-HL-2-2 TO SPA-EDT-HL(2 2).
           MOVE QSPA-EDT-COLL-2-2 TO SPA-EDT-COLL(2 2).
           MOVE QSPA-EDT-CD-2-2 TO SPA-EDT-CD(2 2).
           MOVE QSPA-EDT-RATE-2-2 TO SPA-EDT-RATE(2 2).
           MOVE QSPA-EDT-RATETYPE-2-2 TO SPA-EDT-RATETYPE(2 2).
           MOVE QSPA-EDT-AMT-2-2 TO SPA-EDT-AMT(2 2).
           MOVE QSPA-EDT-AMTYPE-2-2 TO SPA-EDT-AMTYPE(2 2).
           MOVE QSPA-EDT-TERM-2-2 TO SPA-EDT-TERM(2 2).
           MOVE QSPA-EDT-TYPE-2-3 TO SPA-EDT-TYPE(2 3).
           MOVE QSPA-EDT-HL-2-3 TO SPA-EDT-HL(2 3).
           MOVE QSPA-EDT-COLL-2-3 TO SPA-EDT-COLL(2 3).
           MOVE QSPA-EDT-CD-2-3 TO SPA-EDT-CD(2 3).
           MOVE QSPA-EDT-RATE-2-3 TO SPA-EDT-RATE(2 3).
           MOVE QSPA-EDT-RATETYPE-2-3 TO SPA-EDT-RATETYPE(2 3).
           MOVE QSPA-EDT-AMT-2-3 TO SPA-EDT-AMT(2 3).
           MOVE QSPA-EDT-AMTYPE-2-3 TO SPA-EDT-AMTYPE(2 3).
           MOVE QSPA-EDT-TERM-2-3 TO SPA-EDT-TERM(2 3).
           MOVE QSPA-EDT-TYPE-2-4 TO SPA-EDT-TYPE(2 4).
           MOVE QSPA-EDT-HL-2-4 TO SPA-EDT-HL(2 4).
           MOVE QSPA-EDT-COLL-2-4 TO SPA-EDT-COLL(2 4).
           MOVE QSPA-EDT-CD-2-4 TO SPA-EDT-CD(2 4).
           MOVE QSPA-EDT-RATE-2-4 TO SPA-EDT-RATE(2 4).
           MOVE QSPA-EDT-RATETYPE-2-4 TO SPA-EDT-RATETYPE(2 4).
           MOVE QSPA-EDT-AMT-2-4 TO SPA-EDT-AMT(2 4).
           MOVE QSPA-EDT-AMTYPE-2-4 TO SPA-EDT-AMTYPE(2 4).
           MOVE QSPA-EDT-TERM-2-4 TO SPA-EDT-TERM(2 4).
           MOVE QSPA-EDT-TYPE-2-5 TO SPA-EDT-TYPE(2 5).
           MOVE QSPA-EDT-HL-2-5 TO SPA-EDT-HL(2 5).
           MOVE QSPA-EDT-COLL-2-5 TO SPA-EDT-COLL(2 5).
           MOVE QSPA-EDT-CD-2-5 TO SPA-EDT-CD(2 5).
           MOVE QSPA-EDT-RATE-2-5 TO SPA-EDT-RATE(2 5).
           MOVE QSPA-EDT-RATETYPE-2-5 TO SPA-EDT-RATETYPE(2 5).
           MOVE QSPA-EDT-AMT-2-5 TO SPA-EDT-AMT(2 5).
           MOVE QSPA-EDT-AMTYPE-2-5 TO SPA-EDT-AMTYPE(2 5).
           MOVE QSPA-EDT-TERM-2-5 TO SPA-EDT-TERM(2 5).
           MOVE QSPA-EDT-TYPE-2-6 TO SPA-EDT-TYPE(2 6).
           MOVE QSPA-EDT-HL-2-6 TO SPA-EDT-HL(2 6).
           MOVE QSPA-EDT-COLL-2-6 TO SPA-EDT-COLL(2 6).
           MOVE QSPA-EDT-CD-2-6 TO SPA-EDT-CD(2 6).
           MOVE QSPA-EDT-RATE-2-6 TO SPA-EDT-RATE(2 6).
           MOVE QSPA-EDT-RATETYPE-2-6 TO SPA-EDT-RATETYPE(2 6).
           MOVE QSPA-EDT-AMT-2-6 TO SPA-EDT-AMT(2 6).
           MOVE QSPA-EDT-AMTYPE-2-6 TO SPA-EDT-AMTYPE(2 6).
           MOVE QSPA-EDT-TERM-2-6 TO SPA-EDT-TERM(2 6).
 
      *-----------------------------------------------------------------
      *    LOAD QSPA-REC FROM SPA-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-SPA-FIELDS.
           MOVE SPA-ORGST TO QSPA-ORGST.
           MOVE SPA-SPRCLASS TO QSPA-SPRCLASS.
           MOVE SPA-SUBCLASS TO QSPA-SUBCLASS.
           MOVE SPA-LAWCODE TO QSPA-LAWCODE.

           IF ( SPA-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QSPA-LTOUCH-DATE
           ELSE
              MOVE SPA-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QSPA-LTOUCH-DATE.

           MOVE SPA-DESC TO QSPA-DESC.
           MOVE SPA-NOTES TO QSPA-NOTES.

           IF ( SPA-EFFDATE = ZEROES )
              MOVE "1900-01-01" TO QSPA-EFFDATE
           ELSE
              MOVE SPA-EFFDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QSPA-EFFDATE.


           IF ( SPA-EXPDATE = ZEROES )
              MOVE "1900-01-01" TO QSPA-EXPDATE
           ELSE
              MOVE SPA-EXPDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QSPA-EXPDATE.

           MOVE SPA-EXPD-MONTHS TO QSPA-EXPD-MONTHS.
           MOVE SPA-EXPD-DAYS TO QSPA-EXPD-DAYS.
           MOVE SPA-EXPD-FRMLA TO QSPA-EXPD-FRMLA.
           MOVE SPA-EXPD-EXCEPT TO QSPA-EXPD-EXCEPT.
           MOVE SPA-EXPR-FRMLA TO QSPA-EXPR-FRMLA.
           MOVE SPA-EXPR-REDU-FRMLA TO QSPA-EXPR-REDU-FRMLA.
           MOVE SPA-EXPR-RATE(1) TO QSPA-EXPR-RATE-1.
           MOVE SPA-EXPR-BREAK(1) TO QSPA-EXPR-BREAK-1.
           MOVE SPA-EXPR-YRTYPE(1) TO QSPA-EXPR-YRTYPE-1.
           MOVE SPA-EXPR-INTMETH(1) TO QSPA-EXPR-INTMETH-1.
           MOVE SPA-EXPR-RATE(2) TO QSPA-EXPR-RATE-2.
           MOVE SPA-EXPR-BREAK(2) TO QSPA-EXPR-BREAK-2.
           MOVE SPA-EXPR-YRTYPE(2) TO QSPA-EXPR-YRTYPE-2.
           MOVE SPA-EXPR-INTMETH(2) TO QSPA-EXPR-INTMETH-2.
           MOVE SPA-EXPR-RATE(3) TO QSPA-EXPR-RATE-3.
           MOVE SPA-EXPR-BREAK(3) TO QSPA-EXPR-BREAK-3.
           MOVE SPA-EXPR-YRTYPE(3) TO QSPA-EXPR-YRTYPE-3.
           MOVE SPA-EXPR-INTMETH(3) TO QSPA-EXPR-INTMETH-3.
           MOVE SPA-EXPR-RATE(4) TO QSPA-EXPR-RATE-4.
           MOVE SPA-EXPR-BREAK(4) TO QSPA-EXPR-BREAK-4.
           MOVE SPA-EXPR-YRTYPE(4) TO QSPA-EXPR-YRTYPE-4.
           MOVE SPA-EXPR-INTMETH(4) TO QSPA-EXPR-INTMETH-4.
           MOVE SPA-EXPR-RATE(5) TO QSPA-EXPR-RATE-5.
           MOVE SPA-EXPR-BREAK(5) TO QSPA-EXPR-BREAK-5.
           MOVE SPA-EXPR-YRTYPE(5) TO QSPA-EXPR-YRTYPE-5.
           MOVE SPA-EXPR-INTMETH(5) TO QSPA-EXPR-INTMETH-5.
           MOVE SPA-EXPR-LCHG TO QSPA-EXPR-LCHG.
           MOVE SPA-JUDGFRMLA TO QSPA-JUDGFRMLA.
           MOVE SPA-JUDGRATE TO QSPA-JUDGRATE.
           MOVE SPA-JUDGYRTYPE TO QSPA-JUDGYRTYPE.
           MOVE SPA-JUDGINTMETH TO QSPA-JUDGINTMETH.
           MOVE SPA-ACC-FRMLA TO QSPA-ACC-FRMLA.
           MOVE SPA-ACC-YRTYPE TO QSPA-ACC-YRTYPE.
           MOVE SPA-ACC-INTMETH TO QSPA-ACC-INTMETH.
           MOVE SPA-ACC-RATE(1) TO QSPA-ACC-RATE-1.
           MOVE SPA-ACC-BREAK(1) TO QSPA-ACC-BREAK-1.
           MOVE SPA-ACC-RATE(2) TO QSPA-ACC-RATE-2.
           MOVE SPA-ACC-BREAK(2) TO QSPA-ACC-BREAK-2.
           MOVE SPA-ACC-RATE(3) TO QSPA-ACC-RATE-3.
           MOVE SPA-ACC-BREAK(3) TO QSPA-ACC-BREAK-3.
           MOVE SPA-ACC-RATE(4) TO QSPA-ACC-RATE-4.
           MOVE SPA-ACC-BREAK(4) TO QSPA-ACC-BREAK-4.
           MOVE SPA-ACC-RATE(5) TO QSPA-ACC-RATE-5.
           MOVE SPA-ACC-BREAK(5) TO QSPA-ACC-BREAK-5.
           MOVE SPA-1098FRMLA TO QSPA-1098FRMLA.
           MOVE SPA-DISFRMLA TO QSPA-DISFRMLA.
           MOVE SPA-CONTRFRMLA TO QSPA-CONTRFRMLA.
           MOVE SPA-BANKRULE TO QSPA-BANKRULE.
           MOVE SPA-CONTPDTH TO QSPA-CONTPDTH.
           MOVE SPA-FINCHG TO QSPA-FINCHG.
           MOVE SPA-BANKUNITPER-CD TO QSPA-BANKUNITPER-CD.
           MOVE SPA-TRWBANKRULE TO QSPA-TRWBANKRULE.
           MOVE SPA-TRWCONTPDTH TO QSPA-TRWCONTPDTH.
           MOVE SPA-TRWBANKUNITPER-CD TO QSPA-TRWBANKUNITPER-CD.
           MOVE SPA-RECFRMLA TO QSPA-RECFRMLA.
           MOVE SPA-RECPAYCD TO QSPA-RECPAYCD.
           MOVE SPA-RECPDTH TO QSPA-RECPDTH.
           MOVE SPA-DISFRMLA-SPAY-FG TO QSPA-DISFRMLA-SPAY-FG.
           MOVE SPA-ERNFRMLA(1) TO QSPA-ERNFRMLA-1.
           MOVE SPA-ERNAMT(1) TO QSPA-ERNAMT-1.
           MOVE SPA-ERNPERCT(1) TO QSPA-ERNPERCT-1.
           MOVE SPA-ERNPERCD(1) TO QSPA-ERNPERCD-1.
           MOVE SPA-ERNACCRL-FG(1) TO QSPA-ERNACCRL-FG-1.
           MOVE SPA-ERNACCRL-START-CD(1) TO QSPA-ERNACCRL-START-CD-1.
           MOVE SPA-ERNACCRL-DFCD(1) TO QSPA-ERNACCRL-DFCD-1.
           MOVE SPA-ERN-DAYS(1) TO QSPA-ERN-DAYS-1.
           MOVE SPA-ERN-TERM(1) TO QSPA-ERN-TERM-1.
           MOVE SPA-ERN-TYPE(1) TO QSPA-ERN-TYPE-1.
           MOVE SPA-ERNFRMLA(2) TO QSPA-ERNFRMLA-2.
           MOVE SPA-ERNAMT(2) TO QSPA-ERNAMT-2.
           MOVE SPA-ERNPERCT(2) TO QSPA-ERNPERCT-2.
           MOVE SPA-ERNPERCD(2) TO QSPA-ERNPERCD-2.
           MOVE SPA-ERNACCRL-FG(2) TO QSPA-ERNACCRL-FG-2.
           MOVE SPA-ERNACCRL-START-CD(2) TO QSPA-ERNACCRL-START-CD-2.
           MOVE SPA-ERNACCRL-DFCD(2) TO QSPA-ERNACCRL-DFCD-2.
           MOVE SPA-ERN-DAYS(2) TO QSPA-ERN-DAYS-2.
           MOVE SPA-ERN-TERM(2) TO QSPA-ERN-TERM-2.
           MOVE SPA-ERN-TYPE(2) TO QSPA-ERN-TYPE-2.
           MOVE SPA-ERNFRMLA(3) TO QSPA-ERNFRMLA-3.
           MOVE SPA-ERNAMT(3) TO QSPA-ERNAMT-3.
           MOVE SPA-ERNPERCT(3) TO QSPA-ERNPERCT-3.
           MOVE SPA-ERNPERCD(3) TO QSPA-ERNPERCD-3.
           MOVE SPA-ERNACCRL-FG(3) TO QSPA-ERNACCRL-FG-3.
           MOVE SPA-ERNACCRL-START-CD(3) TO QSPA-ERNACCRL-START-CD-3.
           MOVE SPA-ERNACCRL-DFCD(3) TO QSPA-ERNACCRL-DFCD-3.
           MOVE SPA-ERN-DAYS(3) TO QSPA-ERN-DAYS-3.
           MOVE SPA-ERN-TERM(3) TO QSPA-ERN-TERM-3.
           MOVE SPA-ERN-TYPE(3) TO QSPA-ERN-TYPE-3.
           MOVE SPA-ERNFRMLA(4) TO QSPA-ERNFRMLA-4.
           MOVE SPA-ERNAMT(4) TO QSPA-ERNAMT-4.
           MOVE SPA-ERNPERCT(4) TO QSPA-ERNPERCT-4.
           MOVE SPA-ERNPERCD(4) TO QSPA-ERNPERCD-4.
           MOVE SPA-ERNACCRL-FG(4) TO QSPA-ERNACCRL-FG-4.
           MOVE SPA-ERNACCRL-START-CD(4) TO QSPA-ERNACCRL-START-CD-4.
           MOVE SPA-ERNACCRL-DFCD(4) TO QSPA-ERNACCRL-DFCD-4.
           MOVE SPA-ERN-DAYS(4) TO QSPA-ERN-DAYS-4.
           MOVE SPA-ERN-TERM(4) TO QSPA-ERN-TERM-4.
           MOVE SPA-ERN-TYPE(4) TO QSPA-ERN-TYPE-4.
           MOVE SPA-ERNFRMLA(5) TO QSPA-ERNFRMLA-5.
           MOVE SPA-ERNAMT(5) TO QSPA-ERNAMT-5.
           MOVE SPA-ERNPERCT(5) TO QSPA-ERNPERCT-5.
           MOVE SPA-ERNPERCD(5) TO QSPA-ERNPERCD-5.
           MOVE SPA-ERNACCRL-FG(5) TO QSPA-ERNACCRL-FG-5.
           MOVE SPA-ERNACCRL-START-CD(5) TO QSPA-ERNACCRL-START-CD-5.
           MOVE SPA-ERNACCRL-DFCD(5) TO QSPA-ERNACCRL-DFCD-5.
           MOVE SPA-ERN-DAYS(5) TO QSPA-ERN-DAYS-5.
           MOVE SPA-ERN-TERM(5) TO QSPA-ERN-TERM-5.
           MOVE SPA-ERN-TYPE(5) TO QSPA-ERN-TYPE-5.
           MOVE SPA-ERNFRMLA(6) TO QSPA-ERNFRMLA-6.
           MOVE SPA-ERNAMT(6) TO QSPA-ERNAMT-6.
           MOVE SPA-ERNPERCT(6) TO QSPA-ERNPERCT-6.
           MOVE SPA-ERNPERCD(6) TO QSPA-ERNPERCD-6.
           MOVE SPA-ERNACCRL-FG(6) TO QSPA-ERNACCRL-FG-6.
           MOVE SPA-ERNACCRL-START-CD(6) TO QSPA-ERNACCRL-START-CD-6.
           MOVE SPA-ERNACCRL-DFCD(6) TO QSPA-ERNACCRL-DFCD-6.
           MOVE SPA-ERN-DAYS(6) TO QSPA-ERN-DAYS-6.
           MOVE SPA-ERN-TERM(6) TO QSPA-ERN-TERM-6.
           MOVE SPA-ERN-TYPE(6) TO QSPA-ERN-TYPE-6.
           MOVE SPA-ERNFRMLA(7) TO QSPA-ERNFRMLA-7.
           MOVE SPA-ERNAMT(7) TO QSPA-ERNAMT-7.
           MOVE SPA-ERNPERCT(7) TO QSPA-ERNPERCT-7.
           MOVE SPA-ERNPERCD(7) TO QSPA-ERNPERCD-7.
           MOVE SPA-ERNACCRL-FG(7) TO QSPA-ERNACCRL-FG-7.
           MOVE SPA-ERNACCRL-START-CD(7) TO QSPA-ERNACCRL-START-CD-7.
           MOVE SPA-ERNACCRL-DFCD(7) TO QSPA-ERNACCRL-DFCD-7.
           MOVE SPA-ERN-DAYS(7) TO QSPA-ERN-DAYS-7.
           MOVE SPA-ERN-TERM(7) TO QSPA-ERN-TERM-7.
           MOVE SPA-ERN-TYPE(7) TO QSPA-ERN-TYPE-7.
           MOVE SPA-ERNFRMLA(8) TO QSPA-ERNFRMLA-8.
           MOVE SPA-ERNAMT(8) TO QSPA-ERNAMT-8.
           MOVE SPA-ERNPERCT(8) TO QSPA-ERNPERCT-8.
           MOVE SPA-ERNPERCD(8) TO QSPA-ERNPERCD-8.
           MOVE SPA-ERNACCRL-FG(8) TO QSPA-ERNACCRL-FG-8.
           MOVE SPA-ERNACCRL-START-CD(8) TO QSPA-ERNACCRL-START-CD-8.
           MOVE SPA-ERNACCRL-DFCD(8) TO QSPA-ERNACCRL-DFCD-8.
           MOVE SPA-ERN-DAYS(8) TO QSPA-ERN-DAYS-8.
           MOVE SPA-ERN-TERM(8) TO QSPA-ERN-TERM-8.
           MOVE SPA-ERN-TYPE(8) TO QSPA-ERN-TYPE-8.
           MOVE SPA-ERNFRMLA(9) TO QSPA-ERNFRMLA-9.
           MOVE SPA-ERNAMT(9) TO QSPA-ERNAMT-9.
           MOVE SPA-ERNPERCT(9) TO QSPA-ERNPERCT-9.
           MOVE SPA-ERNPERCD(9) TO QSPA-ERNPERCD-9.
           MOVE SPA-ERNACCRL-FG(9) TO QSPA-ERNACCRL-FG-9.
           MOVE SPA-ERNACCRL-START-CD(9) TO QSPA-ERNACCRL-START-CD-9.
           MOVE SPA-ERNACCRL-DFCD(9) TO QSPA-ERNACCRL-DFCD-9.
           MOVE SPA-ERN-DAYS(9) TO QSPA-ERN-DAYS-9.
           MOVE SPA-ERN-TERM(9) TO QSPA-ERN-TERM-9.
           MOVE SPA-ERN-TYPE(9) TO QSPA-ERN-TYPE-9.
           MOVE SPA-ERNFRMLA(10) TO QSPA-ERNFRMLA-10.
           MOVE SPA-ERNAMT(10) TO QSPA-ERNAMT-10.
           MOVE SPA-ERNPERCT(10) TO QSPA-ERNPERCT-10.
           MOVE SPA-ERNPERCD(10) TO QSPA-ERNPERCD-10.
           MOVE SPA-ERNACCRL-FG(10) TO QSPA-ERNACCRL-FG-10.
           MOVE SPA-ERNACCRL-START-CD(10) TO QSPA-ERNACCRL-START-CD-10.
           MOVE SPA-ERNACCRL-DFCD(10) TO QSPA-ERNACCRL-DFCD-10.
           MOVE SPA-ERN-DAYS(10) TO QSPA-ERN-DAYS-10.
           MOVE SPA-ERN-TERM(10) TO QSPA-ERN-TERM-10.
           MOVE SPA-ERN-TYPE(10) TO QSPA-ERN-TYPE-10.
           MOVE SPA-ERNACCEL-CD TO QSPA-ERNACCEL-CD.
           MOVE SPA-ERNJD-CD TO QSPA-ERNJD-CD.
           MOVE SPA-MIDSTRERNCD TO QSPA-MIDSTRERNCD.
           MOVE SPA-EARN-ORDER(1) TO QSPA-EARN-ORDER-1.
           MOVE SPA-EARN-ORDER(2) TO QSPA-EARN-ORDER-2.
           MOVE SPA-EARN-ORDER(3) TO QSPA-EARN-ORDER-3.
           MOVE SPA-EARN-ORDER(4) TO QSPA-EARN-ORDER-4.
           MOVE SPA-EARN-ORDER(5) TO QSPA-EARN-ORDER-5.
           MOVE SPA-EARN-ORDER(6) TO QSPA-EARN-ORDER-6.
           MOVE SPA-EARN-ORDER(7) TO QSPA-EARN-ORDER-7.
           MOVE SPA-EARN-ORDER(8) TO QSPA-EARN-ORDER-8.
           MOVE SPA-EARN-ORDER(9) TO QSPA-EARN-ORDER-9.
           MOVE SPA-EARN-ORDER(10) TO QSPA-EARN-ORDER-10.
           MOVE SPA-ERNDELQFRMLA TO QSPA-ERNDELQFRMLA.
           MOVE SPA-ERNDELQ-START TO QSPA-ERNDELQ-START.
           MOVE SPA-ERNDELQ-STOP TO QSPA-ERNDELQ-STOP.
           MOVE SPA-1098-INC-LC TO QSPA-1098-INC-LC.
           MOVE SPA-MAX-IB-ACR-DAYS TO QSPA-MAX-IB-ACR-DAYS.
           MOVE SPA-LCGRACE TO QSPA-LCGRACE.
           MOVE SPA-LCGRACECD TO QSPA-LCGRACECD.
           MOVE SPA-LCTYPE TO QSPA-LCTYPE.
           MOVE SPA-LCRATE TO QSPA-LCRATE.
           MOVE SPA-LCFRMLA TO QSPA-LCFRMLA.
           MOVE SPA-LCMINCHG TO QSPA-LCMINCHG.
           MOVE SPA-LCMAXAMT TO QSPA-LCMAXAMT.
           MOVE SPA-LCDELFAC TO QSPA-LCDELFAC.
           MOVE SPA-LCYRTYPE TO QSPA-LCYRTYPE.
           MOVE SPA-LC-CODE TO QSPA-LC-CODE.
           MOVE SPA-LCUNITPER-CD TO QSPA-LCUNITPER-CD.
           MOVE SPA-DEFFRMLA TO QSPA-DEFFRMLA.
           MOVE SPA-DEFEXCEPT TO QSPA-DEFEXCEPT.
           MOVE SPA-DEFWORKER TO QSPA-DEFWORKER.
           MOVE SPA-DEFPERCD TO QSPA-DEFPERCD.
           MOVE SPA-DEFBASE TO QSPA-DEFBASE.
           MOVE SPA-DEFPOLCD TO QSPA-DEFPOLCD.
           MOVE SPA-DEFPOLMX(1) TO QSPA-DEFPOLMX-1.
           MOVE SPA-DEFPOLMX(2) TO QSPA-DEFPOLMX-2.
           MOVE SPA-DEFPOLMX(3) TO QSPA-DEFPOLMX-3.
           MOVE SPA-DEFMIN TO QSPA-DEFMIN.
           MOVE SPA-DEFMAX TO QSPA-DEFMAX.
           MOVE SPA-DEFUNITPER-CD TO QSPA-DEFUNITPER-CD.
           MOVE SPA-PRFORM(1) TO QSPA-PRFORM-1.
           MOVE SPA-PRFLAG(1) TO QSPA-PRFLAG-1.
           MOVE SPA-PRFORM(2) TO QSPA-PRFORM-2.
           MOVE SPA-PRFLAG(2) TO QSPA-PRFLAG-2.
           MOVE SPA-PRFORM(3) TO QSPA-PRFORM-3.
           MOVE SPA-PRFLAG(3) TO QSPA-PRFLAG-3.
           MOVE SPA-PRFORM(4) TO QSPA-PRFORM-4.
           MOVE SPA-PRFLAG(4) TO QSPA-PRFLAG-4.
           MOVE SPA-PRFORM(5) TO QSPA-PRFORM-5.
           MOVE SPA-PRFLAG(5) TO QSPA-PRFLAG-5.
           MOVE SPA-PRFORM(6) TO QSPA-PRFORM-6.
           MOVE SPA-PRFLAG(6) TO QSPA-PRFLAG-6.
           MOVE SPA-PRFORM(7) TO QSPA-PRFORM-7.
           MOVE SPA-PRFLAG(7) TO QSPA-PRFLAG-7.
           MOVE SPA-PRFORM(8) TO QSPA-PRFORM-8.
           MOVE SPA-PRFLAG(8) TO QSPA-PRFLAG-8.
           MOVE SPA-PRFORM(9) TO QSPA-PRFORM-9.
           MOVE SPA-PRFLAG(9) TO QSPA-PRFLAG-9.
           MOVE SPA-PRFORM(10) TO QSPA-PRFORM-10.
           MOVE SPA-PRFLAG(10) TO QSPA-PRFLAG-10.
           MOVE SPA-PRFORM(11) TO QSPA-PRFORM-11.
           MOVE SPA-PRFLAG(11) TO QSPA-PRFLAG-11.
           MOVE SPA-PRFORM(12) TO QSPA-PRFORM-12.
           MOVE SPA-PRFLAG(12) TO QSPA-PRFLAG-12.
           MOVE SPA-PRFORM(13) TO QSPA-PRFORM-13.
           MOVE SPA-PRFLAG(13) TO QSPA-PRFLAG-13.
           MOVE SPA-PRFORM(14) TO QSPA-PRFORM-14.
           MOVE SPA-PRFLAG(14) TO QSPA-PRFLAG-14.
           MOVE SPA-PRFORM(15) TO QSPA-PRFORM-15.
           MOVE SPA-PRFLAG(15) TO QSPA-PRFLAG-15.
           MOVE SPA-PRFORM(16) TO QSPA-PRFORM-16.
           MOVE SPA-PRFLAG(16) TO QSPA-PRFLAG-16.
           MOVE SPA-PRFORM(17) TO QSPA-PRFORM-17.
           MOVE SPA-PRFLAG(17) TO QSPA-PRFLAG-17.
           MOVE SPA-PRFORM(18) TO QSPA-PRFORM-18.
           MOVE SPA-PRFLAG(18) TO QSPA-PRFLAG-18.
           MOVE SPA-PRFORM(19) TO QSPA-PRFORM-19.
           MOVE SPA-PRFLAG(19) TO QSPA-PRFLAG-19.
           MOVE SPA-PRFORM(20) TO QSPA-PRFORM-20.
           MOVE SPA-PRFLAG(20) TO QSPA-PRFLAG-20.
           MOVE SPA-IMED-REC TO QSPA-IMED-REC.
           MOVE SPA-SCFRMLA TO QSPA-SCFRMLA.
           MOVE SPA-SCRATE TO QSPA-SCRATE.
           MOVE SPA-SCMIN TO QSPA-SCMIN.
           MOVE SPA-SCMAX TO QSPA-SCMAX.
           MOVE SPA-MFFRMLA TO QSPA-MFFRMLA.
           MOVE SPA-MFRATE TO QSPA-MFRATE.
           MOVE SPA-MFMIN TO QSPA-MFMIN.
           MOVE SPA-MFMAX TO QSPA-MFMAX.
           MOVE SPA-INTMETHOD TO QSPA-INTMETHOD.
           MOVE SPA-YEARTYPE TO QSPA-YEARTYPE.
           MOVE SPA-PYEXFRMLA TO QSPA-PYEXFRMLA.
           MOVE SPA-PYEXSPCODE TO QSPA-PYEXSPCODE.
           MOVE SPA-PYEXYEARTP TO QSPA-PYEXYEARTP.
           MOVE SPA-PYEXFMDATE TO QSPA-PYEXFMDATE.
           MOVE SPA-PYEXBASECD TO QSPA-PYEXBASECD.
           MOVE SPA-PYEXBASE TO QSPA-PYEXBASE.
           MOVE SPA-PYEXDAYS TO QSPA-PYEXDAYS.
           MOVE SPA-CAL-SPFRMLA TO QSPA-CAL-SPFRMLA.
           MOVE SPA-CAL-RATETYPE(1) TO QSPA-CAL-RATETYPE-1.
           MOVE SPA-CAL-BREAKTYPE(1) TO QSPA-CAL-BREAKTYPE-1.
           MOVE SPA-CAL-CHGABLE(1) TO QSPA-CAL-CHGABLE-1.
           MOVE SPA-CAL-NORATES(1) TO QSPA-CAL-NORATES-1.
           MOVE SPA-CAL-TBFRMLA(1) TO QSPA-CAL-TBFRMLA-1.
           MOVE SPA-CAL-RATE(1 1) TO QSPA-CAL-RATE-1-1.
           MOVE SPA-CAL-BREAK(1 1) TO QSPA-CAL-BREAK-1-1.
           MOVE SPA-CAL-RATE(1 2) TO QSPA-CAL-RATE-1-2.
           MOVE SPA-CAL-BREAK(1 2) TO QSPA-CAL-BREAK-1-2.
           MOVE SPA-CAL-RATE(1 3) TO QSPA-CAL-RATE-1-3.
           MOVE SPA-CAL-BREAK(1 3) TO QSPA-CAL-BREAK-1-3.
           MOVE SPA-CAL-RATE(1 4) TO QSPA-CAL-RATE-1-4.
           MOVE SPA-CAL-BREAK(1 4) TO QSPA-CAL-BREAK-1-4.
           MOVE SPA-CAL-RATE(1 5) TO QSPA-CAL-RATE-1-5.
           MOVE SPA-CAL-BREAK(1 5) TO QSPA-CAL-BREAK-1-5.
           MOVE SPA-CAL-RATETYPE(2) TO QSPA-CAL-RATETYPE-2.
           MOVE SPA-CAL-BREAKTYPE(2) TO QSPA-CAL-BREAKTYPE-2.
           MOVE SPA-CAL-CHGABLE(2) TO QSPA-CAL-CHGABLE-2.
           MOVE SPA-CAL-NORATES(2) TO QSPA-CAL-NORATES-2.
           MOVE SPA-CAL-TBFRMLA(2) TO QSPA-CAL-TBFRMLA-2.
           MOVE SPA-CAL-RATE(2 1) TO QSPA-CAL-RATE-2-1.
           MOVE SPA-CAL-BREAK(2 1) TO QSPA-CAL-BREAK-2-1.
           MOVE SPA-CAL-RATE(2 2) TO QSPA-CAL-RATE-2-2.
           MOVE SPA-CAL-BREAK(2 2) TO QSPA-CAL-BREAK-2-2.
           MOVE SPA-CAL-RATE(2 3) TO QSPA-CAL-RATE-2-3.
           MOVE SPA-CAL-BREAK(2 3) TO QSPA-CAL-BREAK-2-3.
           MOVE SPA-CAL-RATE(2 4) TO QSPA-CAL-RATE-2-4.
           MOVE SPA-CAL-BREAK(2 4) TO QSPA-CAL-BREAK-2-4.
           MOVE SPA-CAL-RATE(2 5) TO QSPA-CAL-RATE-2-5.
           MOVE SPA-CAL-BREAK(2 5) TO QSPA-CAL-BREAK-2-5.
           MOVE SPA-MINSF-FRMLA TO QSPA-MINSF-FRMLA.
           MOVE SPA-MINSF-CHG TO QSPA-MINSF-CHG.
           MOVE SPA-MAXAPR-FRMLA TO QSPA-MAXAPR-FRMLA.
           MOVE SPA-EDT-NOEDITS(1) TO QSPA-EDT-NOEDITS-1.
           MOVE SPA-EDT-TYPE(1 1) TO QSPA-EDT-TYPE-1-1.
           MOVE SPA-EDT-HL(1 1) TO QSPA-EDT-HL-1-1.
           MOVE SPA-EDT-COLL(1 1) TO QSPA-EDT-COLL-1-1.
           MOVE SPA-EDT-CD(1 1) TO QSPA-EDT-CD-1-1.
           MOVE SPA-EDT-RATE(1 1) TO QSPA-EDT-RATE-1-1.
           MOVE SPA-EDT-RATETYPE(1 1) TO QSPA-EDT-RATETYPE-1-1.
           MOVE SPA-EDT-AMT(1 1) TO QSPA-EDT-AMT-1-1.
           MOVE SPA-EDT-AMTYPE(1 1) TO QSPA-EDT-AMTYPE-1-1.
           MOVE SPA-EDT-TERM(1 1) TO QSPA-EDT-TERM-1-1.
           MOVE SPA-EDT-TYPE(1 2) TO QSPA-EDT-TYPE-1-2.
           MOVE SPA-EDT-HL(1 2) TO QSPA-EDT-HL-1-2.
           MOVE SPA-EDT-COLL(1 2) TO QSPA-EDT-COLL-1-2.
           MOVE SPA-EDT-CD(1 2) TO QSPA-EDT-CD-1-2.
           MOVE SPA-EDT-RATE(1 2) TO QSPA-EDT-RATE-1-2.
           MOVE SPA-EDT-RATETYPE(1 2) TO QSPA-EDT-RATETYPE-1-2.
           MOVE SPA-EDT-AMT(1 2) TO QSPA-EDT-AMT-1-2.
           MOVE SPA-EDT-AMTYPE(1 2) TO QSPA-EDT-AMTYPE-1-2.
           MOVE SPA-EDT-TERM(1 2) TO QSPA-EDT-TERM-1-2.
           MOVE SPA-EDT-TYPE(1 3) TO QSPA-EDT-TYPE-1-3.
           MOVE SPA-EDT-HL(1 3) TO QSPA-EDT-HL-1-3.
           MOVE SPA-EDT-COLL(1 3) TO QSPA-EDT-COLL-1-3.
           MOVE SPA-EDT-CD(1 3) TO QSPA-EDT-CD-1-3.
           MOVE SPA-EDT-RATE(1 3) TO QSPA-EDT-RATE-1-3.
           MOVE SPA-EDT-RATETYPE(1 3) TO QSPA-EDT-RATETYPE-1-3.
           MOVE SPA-EDT-AMT(1 3) TO QSPA-EDT-AMT-1-3.
           MOVE SPA-EDT-AMTYPE(1 3) TO QSPA-EDT-AMTYPE-1-3.
           MOVE SPA-EDT-TERM(1 3) TO QSPA-EDT-TERM-1-3.
           MOVE SPA-EDT-TYPE(1 4) TO QSPA-EDT-TYPE-1-4.
           MOVE SPA-EDT-HL(1 4) TO QSPA-EDT-HL-1-4.
           MOVE SPA-EDT-COLL(1 4) TO QSPA-EDT-COLL-1-4.
           MOVE SPA-EDT-CD(1 4) TO QSPA-EDT-CD-1-4.
           MOVE SPA-EDT-RATE(1 4) TO QSPA-EDT-RATE-1-4.
           MOVE SPA-EDT-RATETYPE(1 4) TO QSPA-EDT-RATETYPE-1-4.
           MOVE SPA-EDT-AMT(1 4) TO QSPA-EDT-AMT-1-4.
           MOVE SPA-EDT-AMTYPE(1 4) TO QSPA-EDT-AMTYPE-1-4.
           MOVE SPA-EDT-TERM(1 4) TO QSPA-EDT-TERM-1-4.
           MOVE SPA-EDT-TYPE(1 5) TO QSPA-EDT-TYPE-1-5.
           MOVE SPA-EDT-HL(1 5) TO QSPA-EDT-HL-1-5.
           MOVE SPA-EDT-COLL(1 5) TO QSPA-EDT-COLL-1-5.
           MOVE SPA-EDT-CD(1 5) TO QSPA-EDT-CD-1-5.
           MOVE SPA-EDT-RATE(1 5) TO QSPA-EDT-RATE-1-5.
           MOVE SPA-EDT-RATETYPE(1 5) TO QSPA-EDT-RATETYPE-1-5.
           MOVE SPA-EDT-AMT(1 5) TO QSPA-EDT-AMT-1-5.
           MOVE SPA-EDT-AMTYPE(1 5) TO QSPA-EDT-AMTYPE-1-5.
           MOVE SPA-EDT-TERM(1 5) TO QSPA-EDT-TERM-1-5.
           MOVE SPA-EDT-TYPE(1 6) TO QSPA-EDT-TYPE-1-6.
           MOVE SPA-EDT-HL(1 6) TO QSPA-EDT-HL-1-6.
           MOVE SPA-EDT-COLL(1 6) TO QSPA-EDT-COLL-1-6.
           MOVE SPA-EDT-CD(1 6) TO QSPA-EDT-CD-1-6.
           MOVE SPA-EDT-RATE(1 6) TO QSPA-EDT-RATE-1-6.
           MOVE SPA-EDT-RATETYPE(1 6) TO QSPA-EDT-RATETYPE-1-6.
           MOVE SPA-EDT-AMT(1 6) TO QSPA-EDT-AMT-1-6.
           MOVE SPA-EDT-AMTYPE(1 6) TO QSPA-EDT-AMTYPE-1-6.
           MOVE SPA-EDT-TERM(1 6) TO QSPA-EDT-TERM-1-6.
           MOVE SPA-EDT-NOEDITS(2) TO QSPA-EDT-NOEDITS-2.
           MOVE SPA-EDT-TYPE(2 1) TO QSPA-EDT-TYPE-2-1.
           MOVE SPA-EDT-HL(2 1) TO QSPA-EDT-HL-2-1.
           MOVE SPA-EDT-COLL(2 1) TO QSPA-EDT-COLL-2-1.
           MOVE SPA-EDT-CD(2 1) TO QSPA-EDT-CD-2-1.
           MOVE SPA-EDT-RATE(2 1) TO QSPA-EDT-RATE-2-1.
           MOVE SPA-EDT-RATETYPE(2 1) TO QSPA-EDT-RATETYPE-2-1.
           MOVE SPA-EDT-AMT(2 1) TO QSPA-EDT-AMT-2-1.
           MOVE SPA-EDT-AMTYPE(2 1) TO QSPA-EDT-AMTYPE-2-1.
           MOVE SPA-EDT-TERM(2 1) TO QSPA-EDT-TERM-2-1.
           MOVE SPA-EDT-TYPE(2 2) TO QSPA-EDT-TYPE-2-2.
           MOVE SPA-EDT-HL(2 2) TO QSPA-EDT-HL-2-2.
           MOVE SPA-EDT-COLL(2 2) TO QSPA-EDT-COLL-2-2.
           MOVE SPA-EDT-CD(2 2) TO QSPA-EDT-CD-2-2.
           MOVE SPA-EDT-RATE(2 2) TO QSPA-EDT-RATE-2-2.
           MOVE SPA-EDT-RATETYPE(2 2) TO QSPA-EDT-RATETYPE-2-2.
           MOVE SPA-EDT-AMT(2 2) TO QSPA-EDT-AMT-2-2.
           MOVE SPA-EDT-AMTYPE(2 2) TO QSPA-EDT-AMTYPE-2-2.
           MOVE SPA-EDT-TERM(2 2) TO QSPA-EDT-TERM-2-2.
           MOVE SPA-EDT-TYPE(2 3) TO QSPA-EDT-TYPE-2-3.
           MOVE SPA-EDT-HL(2 3) TO QSPA-EDT-HL-2-3.
           MOVE SPA-EDT-COLL(2 3) TO QSPA-EDT-COLL-2-3.
           MOVE SPA-EDT-CD(2 3) TO QSPA-EDT-CD-2-3.
           MOVE SPA-EDT-RATE(2 3) TO QSPA-EDT-RATE-2-3.
           MOVE SPA-EDT-RATETYPE(2 3) TO QSPA-EDT-RATETYPE-2-3.
           MOVE SPA-EDT-AMT(2 3) TO QSPA-EDT-AMT-2-3.
           MOVE SPA-EDT-AMTYPE(2 3) TO QSPA-EDT-AMTYPE-2-3.
           MOVE SPA-EDT-TERM(2 3) TO QSPA-EDT-TERM-2-3.
           MOVE SPA-EDT-TYPE(2 4) TO QSPA-EDT-TYPE-2-4.
           MOVE SPA-EDT-HL(2 4) TO QSPA-EDT-HL-2-4.
           MOVE SPA-EDT-COLL(2 4) TO QSPA-EDT-COLL-2-4.
           MOVE SPA-EDT-CD(2 4) TO QSPA-EDT-CD-2-4.
           MOVE SPA-EDT-RATE(2 4) TO QSPA-EDT-RATE-2-4.
           MOVE SPA-EDT-RATETYPE(2 4) TO QSPA-EDT-RATETYPE-2-4.
           MOVE SPA-EDT-AMT(2 4) TO QSPA-EDT-AMT-2-4.
           MOVE SPA-EDT-AMTYPE(2 4) TO QSPA-EDT-AMTYPE-2-4.
           MOVE SPA-EDT-TERM(2 4) TO QSPA-EDT-TERM-2-4.
           MOVE SPA-EDT-TYPE(2 5) TO QSPA-EDT-TYPE-2-5.
           MOVE SPA-EDT-HL(2 5) TO QSPA-EDT-HL-2-5.
           MOVE SPA-EDT-COLL(2 5) TO QSPA-EDT-COLL-2-5.
           MOVE SPA-EDT-CD(2 5) TO QSPA-EDT-CD-2-5.
           MOVE SPA-EDT-RATE(2 5) TO QSPA-EDT-RATE-2-5.
           MOVE SPA-EDT-RATETYPE(2 5) TO QSPA-EDT-RATETYPE-2-5.
           MOVE SPA-EDT-AMT(2 5) TO QSPA-EDT-AMT-2-5.
           MOVE SPA-EDT-AMTYPE(2 5) TO QSPA-EDT-AMTYPE-2-5.
           MOVE SPA-EDT-TERM(2 5) TO QSPA-EDT-TERM-2-5.
           MOVE SPA-EDT-TYPE(2 6) TO QSPA-EDT-TYPE-2-6.
           MOVE SPA-EDT-HL(2 6) TO QSPA-EDT-HL-2-6.
           MOVE SPA-EDT-COLL(2 6) TO QSPA-EDT-COLL-2-6.
           MOVE SPA-EDT-CD(2 6) TO QSPA-EDT-CD-2-6.
           MOVE SPA-EDT-RATE(2 6) TO QSPA-EDT-RATE-2-6.
           MOVE SPA-EDT-RATETYPE(2 6) TO QSPA-EDT-RATETYPE-2-6.
           MOVE SPA-EDT-AMT(2 6) TO QSPA-EDT-AMT-2-6.
           MOVE SPA-EDT-AMTYPE(2 6) TO QSPA-EDT-AMTYPE-2-6.
           MOVE SPA-EDT-TERM(2 6) TO QSPA-EDT-TERM-2-6.
 
      *-----------------------------------------------------------------
      *    LOAD SPB-REC FROM QSPB-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-SPB-FIELDS.
           MOVE QSPB-ORGST TO SPB-ORGST.
           MOVE QSPB-SPRCLASS TO SPB-SPRCLASS.
           MOVE QSPB-SUBCLASS TO SPB-SUBCLASS.
           MOVE QSPB-LAWCODE TO SPB-LAWCODE.
           MOVE QSPB-INSCOM-1 TO SPB-INSCOM(1).
           MOVE QSPB-INSRATECD-1 TO SPB-INSRATECD(1).
           MOVE QSPB-INSJFAC-1 TO SPB-INSJFAC(1).
           MOVE QSPB-INSDISCNT-1 TO SPB-INSDISCNT(1).
           MOVE QSPB-INSCHGABL-1 TO SPB-INSCHGABL(1).
           MOVE QSPB-INSTERM-1-1 TO SPB-INSTERM(1 1).
           MOVE QSPB-INSRATE-1-1 TO SPB-INSRATE(1 1).
           MOVE QSPB-INSTERM-1-2 TO SPB-INSTERM(1 2).
           MOVE QSPB-INSRATE-1-2 TO SPB-INSRATE(1 2).
           MOVE QSPB-INSTERM-1-3 TO SPB-INSTERM(1 3).
           MOVE QSPB-INSRATE-1-3 TO SPB-INSRATE(1 3).
           MOVE QSPB-INSTERM-1-4 TO SPB-INSTERM(1 4).
           MOVE QSPB-INSRATE-1-4 TO SPB-INSRATE(1 4).
           MOVE QSPB-INSTERM-1-5 TO SPB-INSTERM(1 5).
           MOVE QSPB-INSRATE-1-5 TO SPB-INSRATE(1 5).
           MOVE QSPB-INSTERM-1-6 TO SPB-INSTERM(1 6).
           MOVE QSPB-INSRATE-1-6 TO SPB-INSRATE(1 6).
           MOVE QSPB-INSTERM-1-7 TO SPB-INSTERM(1 7).
           MOVE QSPB-INSRATE-1-7 TO SPB-INSRATE(1 7).
           MOVE QSPB-INSTERM-1-8 TO SPB-INSTERM(1 8).
           MOVE QSPB-INSRATE-1-8 TO SPB-INSRATE(1 8).
           MOVE QSPB-INSTERM-1-9 TO SPB-INSTERM(1 9).
           MOVE QSPB-INSRATE-1-9 TO SPB-INSRATE(1 9).
           MOVE QSPB-INSTERM-1-10 TO SPB-INSTERM(1 10).
           MOVE QSPB-INSRATE-1-10 TO SPB-INSRATE(1 10).
           MOVE QSPB-INSTERM-1-11 TO SPB-INSTERM(1 11).
           MOVE QSPB-INSRATE-1-11 TO SPB-INSRATE(1 11).
           MOVE QSPB-INSTERM-1-12 TO SPB-INSTERM(1 12).
           MOVE QSPB-INSRATE-1-12 TO SPB-INSRATE(1 12).
           MOVE QSPB-INSTERM-1-13 TO SPB-INSTERM(1 13).
           MOVE QSPB-INSRATE-1-13 TO SPB-INSRATE(1 13).
           MOVE QSPB-INSTERM-1-14 TO SPB-INSTERM(1 14).
           MOVE QSPB-INSRATE-1-14 TO SPB-INSRATE(1 14).
           MOVE QSPB-INSTERM-1-15 TO SPB-INSTERM(1 15).
           MOVE QSPB-INSRATE-1-15 TO SPB-INSRATE(1 15).
           MOVE QSPB-INSTERM-1-16 TO SPB-INSTERM(1 16).
           MOVE QSPB-INSRATE-1-16 TO SPB-INSRATE(1 16).
           MOVE QSPB-INSTERM-1-17 TO SPB-INSTERM(1 17).
           MOVE QSPB-INSRATE-1-17 TO SPB-INSRATE(1 17).
           MOVE QSPB-INSTERM-1-18 TO SPB-INSTERM(1 18).
           MOVE QSPB-INSRATE-1-18 TO SPB-INSRATE(1 18).
           MOVE QSPB-INSTERM-1-19 TO SPB-INSTERM(1 19).
           MOVE QSPB-INSRATE-1-19 TO SPB-INSRATE(1 19).
           MOVE QSPB-INSTERM-1-20 TO SPB-INSTERM(1 20).
           MOVE QSPB-INSRATE-1-20 TO SPB-INSRATE(1 20).
           MOVE QSPB-INSMINPREM-1 TO SPB-INSMINPREM(1).
           MOVE QSPB-INSMINCHGABL-1 TO SPB-INSMINCHGABL(1).
           MOVE QSPB-INSMAXCHGABL-1 TO SPB-INSMAXCHGABL(1).
           MOVE QSPB-INSMAXBENIF-1 TO SPB-INSMAXBENIF(1).
           MOVE QSPB-INSMAXTERM-1 TO SPB-INSMAXTERM(1).
           MOVE QSPB-INSCHGBEN-1 TO SPB-INSCHGBEN(1).
           MOVE QSPB-INSEXCEPT-1 TO SPB-INSEXCEPT(1).
           MOVE QSPB-INSNOVER-1 TO SPB-INSNOVER(1).
           MOVE QSPB-INSMINAGE-1-1 TO SPB-INSMINAGE(1 1).
           MOVE QSPB-INSMAXAGE-1-1 TO SPB-INSMAXAGE(1 1).
           MOVE QSPB-INSMAXCOV-1-1 TO SPB-INSMAXCOV(1 1).
           MOVE QSPB-INSMAXTRM-1-1 TO SPB-INSMAXTRM(1 1).
           MOVE QSPB-INSMINAGE-1-2 TO SPB-INSMINAGE(1 2).
           MOVE QSPB-INSMAXAGE-1-2 TO SPB-INSMAXAGE(1 2).
           MOVE QSPB-INSMAXCOV-1-2 TO SPB-INSMAXCOV(1 2).
           MOVE QSPB-INSMAXTRM-1-2 TO SPB-INSMAXTRM(1 2).
           MOVE QSPB-INSMINAGE-1-3 TO SPB-INSMINAGE(1 3).
           MOVE QSPB-INSMAXAGE-1-3 TO SPB-INSMAXAGE(1 3).
           MOVE QSPB-INSMAXCOV-1-3 TO SPB-INSMAXCOV(1 3).
           MOVE QSPB-INSMAXTRM-1-3 TO SPB-INSMAXTRM(1 3).
           MOVE QSPB-INSMINAGE-1-4 TO SPB-INSMINAGE(1 4).
           MOVE QSPB-INSMAXAGE-1-4 TO SPB-INSMAXAGE(1 4).
           MOVE QSPB-INSMAXCOV-1-4 TO SPB-INSMAXCOV(1 4).
           MOVE QSPB-INSMAXTRM-1-4 TO SPB-INSMAXTRM(1 4).
           MOVE QSPB-INSMINAGE-1-5 TO SPB-INSMINAGE(1 5).
           MOVE QSPB-INSMAXAGE-1-5 TO SPB-INSMAXAGE(1 5).
           MOVE QSPB-INSMAXCOV-1-5 TO SPB-INSMAXCOV(1 5).
           MOVE QSPB-INSMAXTRM-1-5 TO SPB-INSMAXTRM(1 5).
           MOVE QSPB-INSFEECD-1 TO SPB-INSFEECD(1).
           MOVE QSPB-INSFEE-FRMLA-1 TO SPB-INSFEE-FRMLA(1).
           MOVE QSPB-INSCHGABL-FG-1 TO SPB-INSCHGABL-FG(1).
           MOVE QSPB-INSREJECT-FG-1 TO SPB-INSREJECT-FG(1).
           MOVE QSPB-INSFINCHG-1 TO SPB-INSFINCHG(1).
           MOVE QSPB-INSCOM-2 TO SPB-INSCOM(2).
           MOVE QSPB-INSRATECD-2 TO SPB-INSRATECD(2).
           MOVE QSPB-INSJFAC-2 TO SPB-INSJFAC(2).
           MOVE QSPB-INSDISCNT-2 TO SPB-INSDISCNT(2).
           MOVE QSPB-INSCHGABL-2 TO SPB-INSCHGABL(2).
           MOVE QSPB-INSTERM-2-1 TO SPB-INSTERM(2 1).
           MOVE QSPB-INSRATE-2-1 TO SPB-INSRATE(2 1).
           MOVE QSPB-INSTERM-2-2 TO SPB-INSTERM(2 2).
           MOVE QSPB-INSRATE-2-2 TO SPB-INSRATE(2 2).
           MOVE QSPB-INSTERM-2-3 TO SPB-INSTERM(2 3).
           MOVE QSPB-INSRATE-2-3 TO SPB-INSRATE(2 3).
           MOVE QSPB-INSTERM-2-4 TO SPB-INSTERM(2 4).
           MOVE QSPB-INSRATE-2-4 TO SPB-INSRATE(2 4).
           MOVE QSPB-INSTERM-2-5 TO SPB-INSTERM(2 5).
           MOVE QSPB-INSRATE-2-5 TO SPB-INSRATE(2 5).
           MOVE QSPB-INSTERM-2-6 TO SPB-INSTERM(2 6).
           MOVE QSPB-INSRATE-2-6 TO SPB-INSRATE(2 6).
           MOVE QSPB-INSTERM-2-7 TO SPB-INSTERM(2 7).
           MOVE QSPB-INSRATE-2-7 TO SPB-INSRATE(2 7).
           MOVE QSPB-INSTERM-2-8 TO SPB-INSTERM(2 8).
           MOVE QSPB-INSRATE-2-8 TO SPB-INSRATE(2 8).
           MOVE QSPB-INSTERM-2-9 TO SPB-INSTERM(2 9).
           MOVE QSPB-INSRATE-2-9 TO SPB-INSRATE(2 9).
           MOVE QSPB-INSTERM-2-10 TO SPB-INSTERM(2 10).
           MOVE QSPB-INSRATE-2-10 TO SPB-INSRATE(2 10).
           MOVE QSPB-INSTERM-2-11 TO SPB-INSTERM(2 11).
           MOVE QSPB-INSRATE-2-11 TO SPB-INSRATE(2 11).
           MOVE QSPB-INSTERM-2-12 TO SPB-INSTERM(2 12).
           MOVE QSPB-INSRATE-2-12 TO SPB-INSRATE(2 12).
           MOVE QSPB-INSTERM-2-13 TO SPB-INSTERM(2 13).
           MOVE QSPB-INSRATE-2-13 TO SPB-INSRATE(2 13).
           MOVE QSPB-INSTERM-2-14 TO SPB-INSTERM(2 14).
           MOVE QSPB-INSRATE-2-14 TO SPB-INSRATE(2 14).
           MOVE QSPB-INSTERM-2-15 TO SPB-INSTERM(2 15).
           MOVE QSPB-INSRATE-2-15 TO SPB-INSRATE(2 15).
           MOVE QSPB-INSTERM-2-16 TO SPB-INSTERM(2 16).
           MOVE QSPB-INSRATE-2-16 TO SPB-INSRATE(2 16).
           MOVE QSPB-INSTERM-2-17 TO SPB-INSTERM(2 17).
           MOVE QSPB-INSRATE-2-17 TO SPB-INSRATE(2 17).
           MOVE QSPB-INSTERM-2-18 TO SPB-INSTERM(2 18).
           MOVE QSPB-INSRATE-2-18 TO SPB-INSRATE(2 18).
           MOVE QSPB-INSTERM-2-19 TO SPB-INSTERM(2 19).
           MOVE QSPB-INSRATE-2-19 TO SPB-INSRATE(2 19).
           MOVE QSPB-INSTERM-2-20 TO SPB-INSTERM(2 20).
           MOVE QSPB-INSRATE-2-20 TO SPB-INSRATE(2 20).
           MOVE QSPB-INSMINPREM-2 TO SPB-INSMINPREM(2).
           MOVE QSPB-INSMINCHGABL-2 TO SPB-INSMINCHGABL(2).
           MOVE QSPB-INSMAXCHGABL-2 TO SPB-INSMAXCHGABL(2).
           MOVE QSPB-INSMAXBENIF-2 TO SPB-INSMAXBENIF(2).
           MOVE QSPB-INSMAXTERM-2 TO SPB-INSMAXTERM(2).
           MOVE QSPB-INSCHGBEN-2 TO SPB-INSCHGBEN(2).
           MOVE QSPB-INSEXCEPT-2 TO SPB-INSEXCEPT(2).
           MOVE QSPB-INSNOVER-2 TO SPB-INSNOVER(2).
           MOVE QSPB-INSMINAGE-2-1 TO SPB-INSMINAGE(2 1).
           MOVE QSPB-INSMAXAGE-2-1 TO SPB-INSMAXAGE(2 1).
           MOVE QSPB-INSMAXCOV-2-1 TO SPB-INSMAXCOV(2 1).
           MOVE QSPB-INSMAXTRM-2-1 TO SPB-INSMAXTRM(2 1).
           MOVE QSPB-INSMINAGE-2-2 TO SPB-INSMINAGE(2 2).
           MOVE QSPB-INSMAXAGE-2-2 TO SPB-INSMAXAGE(2 2).
           MOVE QSPB-INSMAXCOV-2-2 TO SPB-INSMAXCOV(2 2).
           MOVE QSPB-INSMAXTRM-2-2 TO SPB-INSMAXTRM(2 2).
           MOVE QSPB-INSMINAGE-2-3 TO SPB-INSMINAGE(2 3).
           MOVE QSPB-INSMAXAGE-2-3 TO SPB-INSMAXAGE(2 3).
           MOVE QSPB-INSMAXCOV-2-3 TO SPB-INSMAXCOV(2 3).
           MOVE QSPB-INSMAXTRM-2-3 TO SPB-INSMAXTRM(2 3).
           MOVE QSPB-INSMINAGE-2-4 TO SPB-INSMINAGE(2 4).
           MOVE QSPB-INSMAXAGE-2-4 TO SPB-INSMAXAGE(2 4).
           MOVE QSPB-INSMAXCOV-2-4 TO SPB-INSMAXCOV(2 4).
           MOVE QSPB-INSMAXTRM-2-4 TO SPB-INSMAXTRM(2 4).
           MOVE QSPB-INSMINAGE-2-5 TO SPB-INSMINAGE(2 5).
           MOVE QSPB-INSMAXAGE-2-5 TO SPB-INSMAXAGE(2 5).
           MOVE QSPB-INSMAXCOV-2-5 TO SPB-INSMAXCOV(2 5).
           MOVE QSPB-INSMAXTRM-2-5 TO SPB-INSMAXTRM(2 5).
           MOVE QSPB-INSFEECD-2 TO SPB-INSFEECD(2).
           MOVE QSPB-INSFEE-FRMLA-2 TO SPB-INSFEE-FRMLA(2).
           MOVE QSPB-INSCHGABL-FG-2 TO SPB-INSCHGABL-FG(2).
           MOVE QSPB-INSREJECT-FG-2 TO SPB-INSREJECT-FG(2).
           MOVE QSPB-INSFINCHG-2 TO SPB-INSFINCHG(2).
           MOVE QSPB-INSCOM-3 TO SPB-INSCOM(3).
           MOVE QSPB-INSRATECD-3 TO SPB-INSRATECD(3).
           MOVE QSPB-INSJFAC-3 TO SPB-INSJFAC(3).
           MOVE QSPB-INSDISCNT-3 TO SPB-INSDISCNT(3).
           MOVE QSPB-INSCHGABL-3 TO SPB-INSCHGABL(3).
           MOVE QSPB-INSTERM-3-1 TO SPB-INSTERM(3 1).
           MOVE QSPB-INSRATE-3-1 TO SPB-INSRATE(3 1).
           MOVE QSPB-INSTERM-3-2 TO SPB-INSTERM(3 2).
           MOVE QSPB-INSRATE-3-2 TO SPB-INSRATE(3 2).
           MOVE QSPB-INSTERM-3-3 TO SPB-INSTERM(3 3).
           MOVE QSPB-INSRATE-3-3 TO SPB-INSRATE(3 3).
           MOVE QSPB-INSTERM-3-4 TO SPB-INSTERM(3 4).
           MOVE QSPB-INSRATE-3-4 TO SPB-INSRATE(3 4).
           MOVE QSPB-INSTERM-3-5 TO SPB-INSTERM(3 5).
           MOVE QSPB-INSRATE-3-5 TO SPB-INSRATE(3 5).
           MOVE QSPB-INSTERM-3-6 TO SPB-INSTERM(3 6).
           MOVE QSPB-INSRATE-3-6 TO SPB-INSRATE(3 6).
           MOVE QSPB-INSTERM-3-7 TO SPB-INSTERM(3 7).
           MOVE QSPB-INSRATE-3-7 TO SPB-INSRATE(3 7).
           MOVE QSPB-INSTERM-3-8 TO SPB-INSTERM(3 8).
           MOVE QSPB-INSRATE-3-8 TO SPB-INSRATE(3 8).
           MOVE QSPB-INSTERM-3-9 TO SPB-INSTERM(3 9).
           MOVE QSPB-INSRATE-3-9 TO SPB-INSRATE(3 9).
           MOVE QSPB-INSTERM-3-10 TO SPB-INSTERM(3 10).
           MOVE QSPB-INSRATE-3-10 TO SPB-INSRATE(3 10).
           MOVE QSPB-INSTERM-3-11 TO SPB-INSTERM(3 11).
           MOVE QSPB-INSRATE-3-11 TO SPB-INSRATE(3 11).
           MOVE QSPB-INSTERM-3-12 TO SPB-INSTERM(3 12).
           MOVE QSPB-INSRATE-3-12 TO SPB-INSRATE(3 12).
           MOVE QSPB-INSTERM-3-13 TO SPB-INSTERM(3 13).
           MOVE QSPB-INSRATE-3-13 TO SPB-INSRATE(3 13).
           MOVE QSPB-INSTERM-3-14 TO SPB-INSTERM(3 14).
           MOVE QSPB-INSRATE-3-14 TO SPB-INSRATE(3 14).
           MOVE QSPB-INSTERM-3-15 TO SPB-INSTERM(3 15).
           MOVE QSPB-INSRATE-3-15 TO SPB-INSRATE(3 15).
           MOVE QSPB-INSTERM-3-16 TO SPB-INSTERM(3 16).
           MOVE QSPB-INSRATE-3-16 TO SPB-INSRATE(3 16).
           MOVE QSPB-INSTERM-3-17 TO SPB-INSTERM(3 17).
           MOVE QSPB-INSRATE-3-17 TO SPB-INSRATE(3 17).
           MOVE QSPB-INSTERM-3-18 TO SPB-INSTERM(3 18).
           MOVE QSPB-INSRATE-3-18 TO SPB-INSRATE(3 18).
           MOVE QSPB-INSTERM-3-19 TO SPB-INSTERM(3 19).
           MOVE QSPB-INSRATE-3-19 TO SPB-INSRATE(3 19).
           MOVE QSPB-INSTERM-3-20 TO SPB-INSTERM(3 20).
           MOVE QSPB-INSRATE-3-20 TO SPB-INSRATE(3 20).
           MOVE QSPB-INSMINPREM-3 TO SPB-INSMINPREM(3).
           MOVE QSPB-INSMINCHGABL-3 TO SPB-INSMINCHGABL(3).
           MOVE QSPB-INSMAXCHGABL-3 TO SPB-INSMAXCHGABL(3).
           MOVE QSPB-INSMAXBENIF-3 TO SPB-INSMAXBENIF(3).
           MOVE QSPB-INSMAXTERM-3 TO SPB-INSMAXTERM(3).
           MOVE QSPB-INSCHGBEN-3 TO SPB-INSCHGBEN(3).
           MOVE QSPB-INSEXCEPT-3 TO SPB-INSEXCEPT(3).
           MOVE QSPB-INSNOVER-3 TO SPB-INSNOVER(3).
           MOVE QSPB-INSMINAGE-3-1 TO SPB-INSMINAGE(3 1).
           MOVE QSPB-INSMAXAGE-3-1 TO SPB-INSMAXAGE(3 1).
           MOVE QSPB-INSMAXCOV-3-1 TO SPB-INSMAXCOV(3 1).
           MOVE QSPB-INSMAXTRM-3-1 TO SPB-INSMAXTRM(3 1).
           MOVE QSPB-INSMINAGE-3-2 TO SPB-INSMINAGE(3 2).
           MOVE QSPB-INSMAXAGE-3-2 TO SPB-INSMAXAGE(3 2).
           MOVE QSPB-INSMAXCOV-3-2 TO SPB-INSMAXCOV(3 2).
           MOVE QSPB-INSMAXTRM-3-2 TO SPB-INSMAXTRM(3 2).
           MOVE QSPB-INSMINAGE-3-3 TO SPB-INSMINAGE(3 3).
           MOVE QSPB-INSMAXAGE-3-3 TO SPB-INSMAXAGE(3 3).
           MOVE QSPB-INSMAXCOV-3-3 TO SPB-INSMAXCOV(3 3).
           MOVE QSPB-INSMAXTRM-3-3 TO SPB-INSMAXTRM(3 3).
           MOVE QSPB-INSMINAGE-3-4 TO SPB-INSMINAGE(3 4).
           MOVE QSPB-INSMAXAGE-3-4 TO SPB-INSMAXAGE(3 4).
           MOVE QSPB-INSMAXCOV-3-4 TO SPB-INSMAXCOV(3 4).
           MOVE QSPB-INSMAXTRM-3-4 TO SPB-INSMAXTRM(3 4).
           MOVE QSPB-INSMINAGE-3-5 TO SPB-INSMINAGE(3 5).
           MOVE QSPB-INSMAXAGE-3-5 TO SPB-INSMAXAGE(3 5).
           MOVE QSPB-INSMAXCOV-3-5 TO SPB-INSMAXCOV(3 5).
           MOVE QSPB-INSMAXTRM-3-5 TO SPB-INSMAXTRM(3 5).
           MOVE QSPB-INSFEECD-3 TO SPB-INSFEECD(3).
           MOVE QSPB-INSFEE-FRMLA-3 TO SPB-INSFEE-FRMLA(3).
           MOVE QSPB-INSCHGABL-FG-3 TO SPB-INSCHGABL-FG(3).
           MOVE QSPB-INSREJECT-FG-3 TO SPB-INSREJECT-FG(3).
           MOVE QSPB-INSFINCHG-3 TO SPB-INSFINCHG(3).
           MOVE QSPB-INSCOM-4 TO SPB-INSCOM(4).
           MOVE QSPB-INSRATECD-4 TO SPB-INSRATECD(4).
           MOVE QSPB-INSJFAC-4 TO SPB-INSJFAC(4).
           MOVE QSPB-INSDISCNT-4 TO SPB-INSDISCNT(4).
           MOVE QSPB-INSCHGABL-4 TO SPB-INSCHGABL(4).
           MOVE QSPB-INSTERM-4-1 TO SPB-INSTERM(4 1).
           MOVE QSPB-INSRATE-4-1 TO SPB-INSRATE(4 1).
           MOVE QSPB-INSTERM-4-2 TO SPB-INSTERM(4 2).
           MOVE QSPB-INSRATE-4-2 TO SPB-INSRATE(4 2).
           MOVE QSPB-INSTERM-4-3 TO SPB-INSTERM(4 3).
           MOVE QSPB-INSRATE-4-3 TO SPB-INSRATE(4 3).
           MOVE QSPB-INSTERM-4-4 TO SPB-INSTERM(4 4).
           MOVE QSPB-INSRATE-4-4 TO SPB-INSRATE(4 4).
           MOVE QSPB-INSTERM-4-5 TO SPB-INSTERM(4 5).
           MOVE QSPB-INSRATE-4-5 TO SPB-INSRATE(4 5).
           MOVE QSPB-INSTERM-4-6 TO SPB-INSTERM(4 6).
           MOVE QSPB-INSRATE-4-6 TO SPB-INSRATE(4 6).
           MOVE QSPB-INSTERM-4-7 TO SPB-INSTERM(4 7).
           MOVE QSPB-INSRATE-4-7 TO SPB-INSRATE(4 7).
           MOVE QSPB-INSTERM-4-8 TO SPB-INSTERM(4 8).
           MOVE QSPB-INSRATE-4-8 TO SPB-INSRATE(4 8).
           MOVE QSPB-INSTERM-4-9 TO SPB-INSTERM(4 9).
           MOVE QSPB-INSRATE-4-9 TO SPB-INSRATE(4 9).
           MOVE QSPB-INSTERM-4-10 TO SPB-INSTERM(4 10).
           MOVE QSPB-INSRATE-4-10 TO SPB-INSRATE(4 10).
           MOVE QSPB-INSTERM-4-11 TO SPB-INSTERM(4 11).
           MOVE QSPB-INSRATE-4-11 TO SPB-INSRATE(4 11).
           MOVE QSPB-INSTERM-4-12 TO SPB-INSTERM(4 12).
           MOVE QSPB-INSRATE-4-12 TO SPB-INSRATE(4 12).
           MOVE QSPB-INSTERM-4-13 TO SPB-INSTERM(4 13).
           MOVE QSPB-INSRATE-4-13 TO SPB-INSRATE(4 13).
           MOVE QSPB-INSTERM-4-14 TO SPB-INSTERM(4 14).
           MOVE QSPB-INSRATE-4-14 TO SPB-INSRATE(4 14).
           MOVE QSPB-INSTERM-4-15 TO SPB-INSTERM(4 15).
           MOVE QSPB-INSRATE-4-15 TO SPB-INSRATE(4 15).
           MOVE QSPB-INSTERM-4-16 TO SPB-INSTERM(4 16).
           MOVE QSPB-INSRATE-4-16 TO SPB-INSRATE(4 16).
           MOVE QSPB-INSTERM-4-17 TO SPB-INSTERM(4 17).
           MOVE QSPB-INSRATE-4-17 TO SPB-INSRATE(4 17).
           MOVE QSPB-INSTERM-4-18 TO SPB-INSTERM(4 18).
           MOVE QSPB-INSRATE-4-18 TO SPB-INSRATE(4 18).
           MOVE QSPB-INSTERM-4-19 TO SPB-INSTERM(4 19).
           MOVE QSPB-INSRATE-4-19 TO SPB-INSRATE(4 19).
           MOVE QSPB-INSTERM-4-20 TO SPB-INSTERM(4 20).
           MOVE QSPB-INSRATE-4-20 TO SPB-INSRATE(4 20).
           MOVE QSPB-INSMINPREM-4 TO SPB-INSMINPREM(4).
           MOVE QSPB-INSMINCHGABL-4 TO SPB-INSMINCHGABL(4).
           MOVE QSPB-INSMAXCHGABL-4 TO SPB-INSMAXCHGABL(4).
           MOVE QSPB-INSMAXBENIF-4 TO SPB-INSMAXBENIF(4).
           MOVE QSPB-INSMAXTERM-4 TO SPB-INSMAXTERM(4).
           MOVE QSPB-INSCHGBEN-4 TO SPB-INSCHGBEN(4).
           MOVE QSPB-INSEXCEPT-4 TO SPB-INSEXCEPT(4).
           MOVE QSPB-INSNOVER-4 TO SPB-INSNOVER(4).
           MOVE QSPB-INSMINAGE-4-1 TO SPB-INSMINAGE(4 1).
           MOVE QSPB-INSMAXAGE-4-1 TO SPB-INSMAXAGE(4 1).
           MOVE QSPB-INSMAXCOV-4-1 TO SPB-INSMAXCOV(4 1).
           MOVE QSPB-INSMAXTRM-4-1 TO SPB-INSMAXTRM(4 1).
           MOVE QSPB-INSMINAGE-4-2 TO SPB-INSMINAGE(4 2).
           MOVE QSPB-INSMAXAGE-4-2 TO SPB-INSMAXAGE(4 2).
           MOVE QSPB-INSMAXCOV-4-2 TO SPB-INSMAXCOV(4 2).
           MOVE QSPB-INSMAXTRM-4-2 TO SPB-INSMAXTRM(4 2).
           MOVE QSPB-INSMINAGE-4-3 TO SPB-INSMINAGE(4 3).
           MOVE QSPB-INSMAXAGE-4-3 TO SPB-INSMAXAGE(4 3).
           MOVE QSPB-INSMAXCOV-4-3 TO SPB-INSMAXCOV(4 3).
           MOVE QSPB-INSMAXTRM-4-3 TO SPB-INSMAXTRM(4 3).
           MOVE QSPB-INSMINAGE-4-4 TO SPB-INSMINAGE(4 4).
           MOVE QSPB-INSMAXAGE-4-4 TO SPB-INSMAXAGE(4 4).
           MOVE QSPB-INSMAXCOV-4-4 TO SPB-INSMAXCOV(4 4).
           MOVE QSPB-INSMAXTRM-4-4 TO SPB-INSMAXTRM(4 4).
           MOVE QSPB-INSMINAGE-4-5 TO SPB-INSMINAGE(4 5).
           MOVE QSPB-INSMAXAGE-4-5 TO SPB-INSMAXAGE(4 5).
           MOVE QSPB-INSMAXCOV-4-5 TO SPB-INSMAXCOV(4 5).
           MOVE QSPB-INSMAXTRM-4-5 TO SPB-INSMAXTRM(4 5).
           MOVE QSPB-INSFEECD-4 TO SPB-INSFEECD(4).
           MOVE QSPB-INSFEE-FRMLA-4 TO SPB-INSFEE-FRMLA(4).
           MOVE QSPB-INSCHGABL-FG-4 TO SPB-INSCHGABL-FG(4).
           MOVE QSPB-INSREJECT-FG-4 TO SPB-INSREJECT-FG(4).
           MOVE QSPB-INSFINCHG-4 TO SPB-INSFINCHG(4).
           MOVE QSPB-INSCOM-5 TO SPB-INSCOM(5).
           MOVE QSPB-INSRATECD-5 TO SPB-INSRATECD(5).
           MOVE QSPB-INSJFAC-5 TO SPB-INSJFAC(5).
           MOVE QSPB-INSDISCNT-5 TO SPB-INSDISCNT(5).
           MOVE QSPB-INSCHGABL-5 TO SPB-INSCHGABL(5).
           MOVE QSPB-INSTERM-5-1 TO SPB-INSTERM(5 1).
           MOVE QSPB-INSRATE-5-1 TO SPB-INSRATE(5 1).
           MOVE QSPB-INSTERM-5-2 TO SPB-INSTERM(5 2).
           MOVE QSPB-INSRATE-5-2 TO SPB-INSRATE(5 2).
           MOVE QSPB-INSTERM-5-3 TO SPB-INSTERM(5 3).
           MOVE QSPB-INSRATE-5-3 TO SPB-INSRATE(5 3).
           MOVE QSPB-INSTERM-5-4 TO SPB-INSTERM(5 4).
           MOVE QSPB-INSRATE-5-4 TO SPB-INSRATE(5 4).
           MOVE QSPB-INSTERM-5-5 TO SPB-INSTERM(5 5).
           MOVE QSPB-INSRATE-5-5 TO SPB-INSRATE(5 5).
           MOVE QSPB-INSTERM-5-6 TO SPB-INSTERM(5 6).
           MOVE QSPB-INSRATE-5-6 TO SPB-INSRATE(5 6).
           MOVE QSPB-INSTERM-5-7 TO SPB-INSTERM(5 7).
           MOVE QSPB-INSRATE-5-7 TO SPB-INSRATE(5 7).
           MOVE QSPB-INSTERM-5-8 TO SPB-INSTERM(5 8).
           MOVE QSPB-INSRATE-5-8 TO SPB-INSRATE(5 8).
           MOVE QSPB-INSTERM-5-9 TO SPB-INSTERM(5 9).
           MOVE QSPB-INSRATE-5-9 TO SPB-INSRATE(5 9).
           MOVE QSPB-INSTERM-5-10 TO SPB-INSTERM(5 10).
           MOVE QSPB-INSRATE-5-10 TO SPB-INSRATE(5 10).
           MOVE QSPB-INSTERM-5-11 TO SPB-INSTERM(5 11).
           MOVE QSPB-INSRATE-5-11 TO SPB-INSRATE(5 11).
           MOVE QSPB-INSTERM-5-12 TO SPB-INSTERM(5 12).
           MOVE QSPB-INSRATE-5-12 TO SPB-INSRATE(5 12).
           MOVE QSPB-INSTERM-5-13 TO SPB-INSTERM(5 13).
           MOVE QSPB-INSRATE-5-13 TO SPB-INSRATE(5 13).
           MOVE QSPB-INSTERM-5-14 TO SPB-INSTERM(5 14).
           MOVE QSPB-INSRATE-5-14 TO SPB-INSRATE(5 14).
           MOVE QSPB-INSTERM-5-15 TO SPB-INSTERM(5 15).
           MOVE QSPB-INSRATE-5-15 TO SPB-INSRATE(5 15).
           MOVE QSPB-INSTERM-5-16 TO SPB-INSTERM(5 16).
           MOVE QSPB-INSRATE-5-16 TO SPB-INSRATE(5 16).
           MOVE QSPB-INSTERM-5-17 TO SPB-INSTERM(5 17).
           MOVE QSPB-INSRATE-5-17 TO SPB-INSRATE(5 17).
           MOVE QSPB-INSTERM-5-18 TO SPB-INSTERM(5 18).
           MOVE QSPB-INSRATE-5-18 TO SPB-INSRATE(5 18).
           MOVE QSPB-INSTERM-5-19 TO SPB-INSTERM(5 19).
           MOVE QSPB-INSRATE-5-19 TO SPB-INSRATE(5 19).
           MOVE QSPB-INSTERM-5-20 TO SPB-INSTERM(5 20).
           MOVE QSPB-INSRATE-5-20 TO SPB-INSRATE(5 20).
           MOVE QSPB-INSMINPREM-5 TO SPB-INSMINPREM(5).
           MOVE QSPB-INSMINCHGABL-5 TO SPB-INSMINCHGABL(5).
           MOVE QSPB-INSMAXCHGABL-5 TO SPB-INSMAXCHGABL(5).
           MOVE QSPB-INSMAXBENIF-5 TO SPB-INSMAXBENIF(5).
           MOVE QSPB-INSMAXTERM-5 TO SPB-INSMAXTERM(5).
           MOVE QSPB-INSCHGBEN-5 TO SPB-INSCHGBEN(5).
           MOVE QSPB-INSEXCEPT-5 TO SPB-INSEXCEPT(5).
           MOVE QSPB-INSNOVER-5 TO SPB-INSNOVER(5).
           MOVE QSPB-INSMINAGE-5-1 TO SPB-INSMINAGE(5 1).
           MOVE QSPB-INSMAXAGE-5-1 TO SPB-INSMAXAGE(5 1).
           MOVE QSPB-INSMAXCOV-5-1 TO SPB-INSMAXCOV(5 1).
           MOVE QSPB-INSMAXTRM-5-1 TO SPB-INSMAXTRM(5 1).
           MOVE QSPB-INSMINAGE-5-2 TO SPB-INSMINAGE(5 2).
           MOVE QSPB-INSMAXAGE-5-2 TO SPB-INSMAXAGE(5 2).
           MOVE QSPB-INSMAXCOV-5-2 TO SPB-INSMAXCOV(5 2).
           MOVE QSPB-INSMAXTRM-5-2 TO SPB-INSMAXTRM(5 2).
           MOVE QSPB-INSMINAGE-5-3 TO SPB-INSMINAGE(5 3).
           MOVE QSPB-INSMAXAGE-5-3 TO SPB-INSMAXAGE(5 3).
           MOVE QSPB-INSMAXCOV-5-3 TO SPB-INSMAXCOV(5 3).
           MOVE QSPB-INSMAXTRM-5-3 TO SPB-INSMAXTRM(5 3).
           MOVE QSPB-INSMINAGE-5-4 TO SPB-INSMINAGE(5 4).
           MOVE QSPB-INSMAXAGE-5-4 TO SPB-INSMAXAGE(5 4).
           MOVE QSPB-INSMAXCOV-5-4 TO SPB-INSMAXCOV(5 4).
           MOVE QSPB-INSMAXTRM-5-4 TO SPB-INSMAXTRM(5 4).
           MOVE QSPB-INSMINAGE-5-5 TO SPB-INSMINAGE(5 5).
           MOVE QSPB-INSMAXAGE-5-5 TO SPB-INSMAXAGE(5 5).
           MOVE QSPB-INSMAXCOV-5-5 TO SPB-INSMAXCOV(5 5).
           MOVE QSPB-INSMAXTRM-5-5 TO SPB-INSMAXTRM(5 5).
           MOVE QSPB-INSFEECD-5 TO SPB-INSFEECD(5).
           MOVE QSPB-INSFEE-FRMLA-5 TO SPB-INSFEE-FRMLA(5).
           MOVE QSPB-INSCHGABL-FG-5 TO SPB-INSCHGABL-FG(5).
           MOVE QSPB-INSREJECT-FG-5 TO SPB-INSREJECT-FG(5).
           MOVE QSPB-INSFINCHG-5 TO SPB-INSFINCHG(5).
           MOVE QSPB-INSCOM-6 TO SPB-INSCOM(6).
           MOVE QSPB-INSRATECD-6 TO SPB-INSRATECD(6).
           MOVE QSPB-INSJFAC-6 TO SPB-INSJFAC(6).
           MOVE QSPB-INSDISCNT-6 TO SPB-INSDISCNT(6).
           MOVE QSPB-INSCHGABL-6 TO SPB-INSCHGABL(6).
           MOVE QSPB-INSTERM-6-1 TO SPB-INSTERM(6 1).
           MOVE QSPB-INSRATE-6-1 TO SPB-INSRATE(6 1).
           MOVE QSPB-INSTERM-6-2 TO SPB-INSTERM(6 2).
           MOVE QSPB-INSRATE-6-2 TO SPB-INSRATE(6 2).
           MOVE QSPB-INSTERM-6-3 TO SPB-INSTERM(6 3).
           MOVE QSPB-INSRATE-6-3 TO SPB-INSRATE(6 3).
           MOVE QSPB-INSTERM-6-4 TO SPB-INSTERM(6 4).
           MOVE QSPB-INSRATE-6-4 TO SPB-INSRATE(6 4).
           MOVE QSPB-INSTERM-6-5 TO SPB-INSTERM(6 5).
           MOVE QSPB-INSRATE-6-5 TO SPB-INSRATE(6 5).
           MOVE QSPB-INSTERM-6-6 TO SPB-INSTERM(6 6).
           MOVE QSPB-INSRATE-6-6 TO SPB-INSRATE(6 6).
           MOVE QSPB-INSTERM-6-7 TO SPB-INSTERM(6 7).
           MOVE QSPB-INSRATE-6-7 TO SPB-INSRATE(6 7).
           MOVE QSPB-INSTERM-6-8 TO SPB-INSTERM(6 8).
           MOVE QSPB-INSRATE-6-8 TO SPB-INSRATE(6 8).
           MOVE QSPB-INSTERM-6-9 TO SPB-INSTERM(6 9).
           MOVE QSPB-INSRATE-6-9 TO SPB-INSRATE(6 9).
           MOVE QSPB-INSTERM-6-10 TO SPB-INSTERM(6 10).
           MOVE QSPB-INSRATE-6-10 TO SPB-INSRATE(6 10).
           MOVE QSPB-INSTERM-6-11 TO SPB-INSTERM(6 11).
           MOVE QSPB-INSRATE-6-11 TO SPB-INSRATE(6 11).
           MOVE QSPB-INSTERM-6-12 TO SPB-INSTERM(6 12).
           MOVE QSPB-INSRATE-6-12 TO SPB-INSRATE(6 12).
           MOVE QSPB-INSTERM-6-13 TO SPB-INSTERM(6 13).
           MOVE QSPB-INSRATE-6-13 TO SPB-INSRATE(6 13).
           MOVE QSPB-INSTERM-6-14 TO SPB-INSTERM(6 14).
           MOVE QSPB-INSRATE-6-14 TO SPB-INSRATE(6 14).
           MOVE QSPB-INSTERM-6-15 TO SPB-INSTERM(6 15).
           MOVE QSPB-INSRATE-6-15 TO SPB-INSRATE(6 15).
           MOVE QSPB-INSTERM-6-16 TO SPB-INSTERM(6 16).
           MOVE QSPB-INSRATE-6-16 TO SPB-INSRATE(6 16).
           MOVE QSPB-INSTERM-6-17 TO SPB-INSTERM(6 17).
           MOVE QSPB-INSRATE-6-17 TO SPB-INSRATE(6 17).
           MOVE QSPB-INSTERM-6-18 TO SPB-INSTERM(6 18).
           MOVE QSPB-INSRATE-6-18 TO SPB-INSRATE(6 18).
           MOVE QSPB-INSTERM-6-19 TO SPB-INSTERM(6 19).
           MOVE QSPB-INSRATE-6-19 TO SPB-INSRATE(6 19).
           MOVE QSPB-INSTERM-6-20 TO SPB-INSTERM(6 20).
           MOVE QSPB-INSRATE-6-20 TO SPB-INSRATE(6 20).
           MOVE QSPB-INSMINPREM-6 TO SPB-INSMINPREM(6).
           MOVE QSPB-INSMINCHGABL-6 TO SPB-INSMINCHGABL(6).
           MOVE QSPB-INSMAXCHGABL-6 TO SPB-INSMAXCHGABL(6).
           MOVE QSPB-INSMAXBENIF-6 TO SPB-INSMAXBENIF(6).
           MOVE QSPB-INSMAXTERM-6 TO SPB-INSMAXTERM(6).
           MOVE QSPB-INSCHGBEN-6 TO SPB-INSCHGBEN(6).
           MOVE QSPB-INSEXCEPT-6 TO SPB-INSEXCEPT(6).
           MOVE QSPB-INSNOVER-6 TO SPB-INSNOVER(6).
           MOVE QSPB-INSMINAGE-6-1 TO SPB-INSMINAGE(6 1).
           MOVE QSPB-INSMAXAGE-6-1 TO SPB-INSMAXAGE(6 1).
           MOVE QSPB-INSMAXCOV-6-1 TO SPB-INSMAXCOV(6 1).
           MOVE QSPB-INSMAXTRM-6-1 TO SPB-INSMAXTRM(6 1).
           MOVE QSPB-INSMINAGE-6-2 TO SPB-INSMINAGE(6 2).
           MOVE QSPB-INSMAXAGE-6-2 TO SPB-INSMAXAGE(6 2).
           MOVE QSPB-INSMAXCOV-6-2 TO SPB-INSMAXCOV(6 2).
           MOVE QSPB-INSMAXTRM-6-2 TO SPB-INSMAXTRM(6 2).
           MOVE QSPB-INSMINAGE-6-3 TO SPB-INSMINAGE(6 3).
           MOVE QSPB-INSMAXAGE-6-3 TO SPB-INSMAXAGE(6 3).
           MOVE QSPB-INSMAXCOV-6-3 TO SPB-INSMAXCOV(6 3).
           MOVE QSPB-INSMAXTRM-6-3 TO SPB-INSMAXTRM(6 3).
           MOVE QSPB-INSMINAGE-6-4 TO SPB-INSMINAGE(6 4).
           MOVE QSPB-INSMAXAGE-6-4 TO SPB-INSMAXAGE(6 4).
           MOVE QSPB-INSMAXCOV-6-4 TO SPB-INSMAXCOV(6 4).
           MOVE QSPB-INSMAXTRM-6-4 TO SPB-INSMAXTRM(6 4).
           MOVE QSPB-INSMINAGE-6-5 TO SPB-INSMINAGE(6 5).
           MOVE QSPB-INSMAXAGE-6-5 TO SPB-INSMAXAGE(6 5).
           MOVE QSPB-INSMAXCOV-6-5 TO SPB-INSMAXCOV(6 5).
           MOVE QSPB-INSMAXTRM-6-5 TO SPB-INSMAXTRM(6 5).
           MOVE QSPB-INSFEECD-6 TO SPB-INSFEECD(6).
           MOVE QSPB-INSFEE-FRMLA-6 TO SPB-INSFEE-FRMLA(6).
           MOVE QSPB-INSCHGABL-FG-6 TO SPB-INSCHGABL-FG(6).
           MOVE QSPB-INSREJECT-FG-6 TO SPB-INSREJECT-FG(6).
           MOVE QSPB-INSFINCHG-6 TO SPB-INSFINCHG(6).
           MOVE QSPB-INSCOM-7 TO SPB-INSCOM(7).
           MOVE QSPB-INSRATECD-7 TO SPB-INSRATECD(7).
           MOVE QSPB-INSJFAC-7 TO SPB-INSJFAC(7).
           MOVE QSPB-INSDISCNT-7 TO SPB-INSDISCNT(7).
           MOVE QSPB-INSCHGABL-7 TO SPB-INSCHGABL(7).
           MOVE QSPB-INSTERM-7-1 TO SPB-INSTERM(7 1).
           MOVE QSPB-INSRATE-7-1 TO SPB-INSRATE(7 1).
           MOVE QSPB-INSTERM-7-2 TO SPB-INSTERM(7 2).
           MOVE QSPB-INSRATE-7-2 TO SPB-INSRATE(7 2).
           MOVE QSPB-INSTERM-7-3 TO SPB-INSTERM(7 3).
           MOVE QSPB-INSRATE-7-3 TO SPB-INSRATE(7 3).
           MOVE QSPB-INSTERM-7-4 TO SPB-INSTERM(7 4).
           MOVE QSPB-INSRATE-7-4 TO SPB-INSRATE(7 4).
           MOVE QSPB-INSTERM-7-5 TO SPB-INSTERM(7 5).
           MOVE QSPB-INSRATE-7-5 TO SPB-INSRATE(7 5).
           MOVE QSPB-INSTERM-7-6 TO SPB-INSTERM(7 6).
           MOVE QSPB-INSRATE-7-6 TO SPB-INSRATE(7 6).
           MOVE QSPB-INSTERM-7-7 TO SPB-INSTERM(7 7).
           MOVE QSPB-INSRATE-7-7 TO SPB-INSRATE(7 7).
           MOVE QSPB-INSTERM-7-8 TO SPB-INSTERM(7 8).
           MOVE QSPB-INSRATE-7-8 TO SPB-INSRATE(7 8).
           MOVE QSPB-INSTERM-7-9 TO SPB-INSTERM(7 9).
           MOVE QSPB-INSRATE-7-9 TO SPB-INSRATE(7 9).
           MOVE QSPB-INSTERM-7-10 TO SPB-INSTERM(7 10).
           MOVE QSPB-INSRATE-7-10 TO SPB-INSRATE(7 10).
           MOVE QSPB-INSTERM-7-11 TO SPB-INSTERM(7 11).
           MOVE QSPB-INSRATE-7-11 TO SPB-INSRATE(7 11).
           MOVE QSPB-INSTERM-7-12 TO SPB-INSTERM(7 12).
           MOVE QSPB-INSRATE-7-12 TO SPB-INSRATE(7 12).
           MOVE QSPB-INSTERM-7-13 TO SPB-INSTERM(7 13).
           MOVE QSPB-INSRATE-7-13 TO SPB-INSRATE(7 13).
           MOVE QSPB-INSTERM-7-14 TO SPB-INSTERM(7 14).
           MOVE QSPB-INSRATE-7-14 TO SPB-INSRATE(7 14).
           MOVE QSPB-INSTERM-7-15 TO SPB-INSTERM(7 15).
           MOVE QSPB-INSRATE-7-15 TO SPB-INSRATE(7 15).
           MOVE QSPB-INSTERM-7-16 TO SPB-INSTERM(7 16).
           MOVE QSPB-INSRATE-7-16 TO SPB-INSRATE(7 16).
           MOVE QSPB-INSTERM-7-17 TO SPB-INSTERM(7 17).
           MOVE QSPB-INSRATE-7-17 TO SPB-INSRATE(7 17).
           MOVE QSPB-INSTERM-7-18 TO SPB-INSTERM(7 18).
           MOVE QSPB-INSRATE-7-18 TO SPB-INSRATE(7 18).
           MOVE QSPB-INSTERM-7-19 TO SPB-INSTERM(7 19).
           MOVE QSPB-INSRATE-7-19 TO SPB-INSRATE(7 19).
           MOVE QSPB-INSTERM-7-20 TO SPB-INSTERM(7 20).
           MOVE QSPB-INSRATE-7-20 TO SPB-INSRATE(7 20).
           MOVE QSPB-INSMINPREM-7 TO SPB-INSMINPREM(7).
           MOVE QSPB-INSMINCHGABL-7 TO SPB-INSMINCHGABL(7).
           MOVE QSPB-INSMAXCHGABL-7 TO SPB-INSMAXCHGABL(7).
           MOVE QSPB-INSMAXBENIF-7 TO SPB-INSMAXBENIF(7).
           MOVE QSPB-INSMAXTERM-7 TO SPB-INSMAXTERM(7).
           MOVE QSPB-INSCHGBEN-7 TO SPB-INSCHGBEN(7).
           MOVE QSPB-INSEXCEPT-7 TO SPB-INSEXCEPT(7).
           MOVE QSPB-INSNOVER-7 TO SPB-INSNOVER(7).
           MOVE QSPB-INSMINAGE-7-1 TO SPB-INSMINAGE(7 1).
           MOVE QSPB-INSMAXAGE-7-1 TO SPB-INSMAXAGE(7 1).
           MOVE QSPB-INSMAXCOV-7-1 TO SPB-INSMAXCOV(7 1).
           MOVE QSPB-INSMAXTRM-7-1 TO SPB-INSMAXTRM(7 1).
           MOVE QSPB-INSMINAGE-7-2 TO SPB-INSMINAGE(7 2).
           MOVE QSPB-INSMAXAGE-7-2 TO SPB-INSMAXAGE(7 2).
           MOVE QSPB-INSMAXCOV-7-2 TO SPB-INSMAXCOV(7 2).
           MOVE QSPB-INSMAXTRM-7-2 TO SPB-INSMAXTRM(7 2).
           MOVE QSPB-INSMINAGE-7-3 TO SPB-INSMINAGE(7 3).
           MOVE QSPB-INSMAXAGE-7-3 TO SPB-INSMAXAGE(7 3).
           MOVE QSPB-INSMAXCOV-7-3 TO SPB-INSMAXCOV(7 3).
           MOVE QSPB-INSMAXTRM-7-3 TO SPB-INSMAXTRM(7 3).
           MOVE QSPB-INSMINAGE-7-4 TO SPB-INSMINAGE(7 4).
           MOVE QSPB-INSMAXAGE-7-4 TO SPB-INSMAXAGE(7 4).
           MOVE QSPB-INSMAXCOV-7-4 TO SPB-INSMAXCOV(7 4).
           MOVE QSPB-INSMAXTRM-7-4 TO SPB-INSMAXTRM(7 4).
           MOVE QSPB-INSMINAGE-7-5 TO SPB-INSMINAGE(7 5).
           MOVE QSPB-INSMAXAGE-7-5 TO SPB-INSMAXAGE(7 5).
           MOVE QSPB-INSMAXCOV-7-5 TO SPB-INSMAXCOV(7 5).
           MOVE QSPB-INSMAXTRM-7-5 TO SPB-INSMAXTRM(7 5).
           MOVE QSPB-INSFEECD-7 TO SPB-INSFEECD(7).
           MOVE QSPB-INSFEE-FRMLA-7 TO SPB-INSFEE-FRMLA(7).
           MOVE QSPB-INSCHGABL-FG-7 TO SPB-INSCHGABL-FG(7).
           MOVE QSPB-INSREJECT-FG-7 TO SPB-INSREJECT-FG(7).
           MOVE QSPB-INSFINCHG-7 TO SPB-INSFINCHG(7).
           MOVE QSPB-INSCOM-8 TO SPB-INSCOM(8).
           MOVE QSPB-INSRATECD-8 TO SPB-INSRATECD(8).
           MOVE QSPB-INSJFAC-8 TO SPB-INSJFAC(8).
           MOVE QSPB-INSDISCNT-8 TO SPB-INSDISCNT(8).
           MOVE QSPB-INSCHGABL-8 TO SPB-INSCHGABL(8).
           MOVE QSPB-INSTERM-8-1 TO SPB-INSTERM(8 1).
           MOVE QSPB-INSRATE-8-1 TO SPB-INSRATE(8 1).
           MOVE QSPB-INSTERM-8-2 TO SPB-INSTERM(8 2).
           MOVE QSPB-INSRATE-8-2 TO SPB-INSRATE(8 2).
           MOVE QSPB-INSTERM-8-3 TO SPB-INSTERM(8 3).
           MOVE QSPB-INSRATE-8-3 TO SPB-INSRATE(8 3).
           MOVE QSPB-INSTERM-8-4 TO SPB-INSTERM(8 4).
           MOVE QSPB-INSRATE-8-4 TO SPB-INSRATE(8 4).
           MOVE QSPB-INSTERM-8-5 TO SPB-INSTERM(8 5).
           MOVE QSPB-INSRATE-8-5 TO SPB-INSRATE(8 5).
           MOVE QSPB-INSTERM-8-6 TO SPB-INSTERM(8 6).
           MOVE QSPB-INSRATE-8-6 TO SPB-INSRATE(8 6).
           MOVE QSPB-INSTERM-8-7 TO SPB-INSTERM(8 7).
           MOVE QSPB-INSRATE-8-7 TO SPB-INSRATE(8 7).
           MOVE QSPB-INSTERM-8-8 TO SPB-INSTERM(8 8).
           MOVE QSPB-INSRATE-8-8 TO SPB-INSRATE(8 8).
           MOVE QSPB-INSTERM-8-9 TO SPB-INSTERM(8 9).
           MOVE QSPB-INSRATE-8-9 TO SPB-INSRATE(8 9).
           MOVE QSPB-INSTERM-8-10 TO SPB-INSTERM(8 10).
           MOVE QSPB-INSRATE-8-10 TO SPB-INSRATE(8 10).
           MOVE QSPB-INSTERM-8-11 TO SPB-INSTERM(8 11).
           MOVE QSPB-INSRATE-8-11 TO SPB-INSRATE(8 11).
           MOVE QSPB-INSTERM-8-12 TO SPB-INSTERM(8 12).
           MOVE QSPB-INSRATE-8-12 TO SPB-INSRATE(8 12).
           MOVE QSPB-INSTERM-8-13 TO SPB-INSTERM(8 13).
           MOVE QSPB-INSRATE-8-13 TO SPB-INSRATE(8 13).
           MOVE QSPB-INSTERM-8-14 TO SPB-INSTERM(8 14).
           MOVE QSPB-INSRATE-8-14 TO SPB-INSRATE(8 14).
           MOVE QSPB-INSTERM-8-15 TO SPB-INSTERM(8 15).
           MOVE QSPB-INSRATE-8-15 TO SPB-INSRATE(8 15).
           MOVE QSPB-INSTERM-8-16 TO SPB-INSTERM(8 16).
           MOVE QSPB-INSRATE-8-16 TO SPB-INSRATE(8 16).
           MOVE QSPB-INSTERM-8-17 TO SPB-INSTERM(8 17).
           MOVE QSPB-INSRATE-8-17 TO SPB-INSRATE(8 17).
           MOVE QSPB-INSTERM-8-18 TO SPB-INSTERM(8 18).
           MOVE QSPB-INSRATE-8-18 TO SPB-INSRATE(8 18).
           MOVE QSPB-INSTERM-8-19 TO SPB-INSTERM(8 19).
           MOVE QSPB-INSRATE-8-19 TO SPB-INSRATE(8 19).
           MOVE QSPB-INSTERM-8-20 TO SPB-INSTERM(8 20).
           MOVE QSPB-INSRATE-8-20 TO SPB-INSRATE(8 20).
           MOVE QSPB-INSMINPREM-8 TO SPB-INSMINPREM(8).
           MOVE QSPB-INSMINCHGABL-8 TO SPB-INSMINCHGABL(8).
           MOVE QSPB-INSMAXCHGABL-8 TO SPB-INSMAXCHGABL(8).
           MOVE QSPB-INSMAXBENIF-8 TO SPB-INSMAXBENIF(8).
           MOVE QSPB-INSMAXTERM-8 TO SPB-INSMAXTERM(8).
           MOVE QSPB-INSCHGBEN-8 TO SPB-INSCHGBEN(8).
           MOVE QSPB-INSEXCEPT-8 TO SPB-INSEXCEPT(8).
           MOVE QSPB-INSNOVER-8 TO SPB-INSNOVER(8).
           MOVE QSPB-INSMINAGE-8-1 TO SPB-INSMINAGE(8 1).
           MOVE QSPB-INSMAXAGE-8-1 TO SPB-INSMAXAGE(8 1).
           MOVE QSPB-INSMAXCOV-8-1 TO SPB-INSMAXCOV(8 1).
           MOVE QSPB-INSMAXTRM-8-1 TO SPB-INSMAXTRM(8 1).
           MOVE QSPB-INSMINAGE-8-2 TO SPB-INSMINAGE(8 2).
           MOVE QSPB-INSMAXAGE-8-2 TO SPB-INSMAXAGE(8 2).
           MOVE QSPB-INSMAXCOV-8-2 TO SPB-INSMAXCOV(8 2).
           MOVE QSPB-INSMAXTRM-8-2 TO SPB-INSMAXTRM(8 2).
           MOVE QSPB-INSMINAGE-8-3 TO SPB-INSMINAGE(8 3).
           MOVE QSPB-INSMAXAGE-8-3 TO SPB-INSMAXAGE(8 3).
           MOVE QSPB-INSMAXCOV-8-3 TO SPB-INSMAXCOV(8 3).
           MOVE QSPB-INSMAXTRM-8-3 TO SPB-INSMAXTRM(8 3).
           MOVE QSPB-INSMINAGE-8-4 TO SPB-INSMINAGE(8 4).
           MOVE QSPB-INSMAXAGE-8-4 TO SPB-INSMAXAGE(8 4).
           MOVE QSPB-INSMAXCOV-8-4 TO SPB-INSMAXCOV(8 4).
           MOVE QSPB-INSMAXTRM-8-4 TO SPB-INSMAXTRM(8 4).
           MOVE QSPB-INSMINAGE-8-5 TO SPB-INSMINAGE(8 5).
           MOVE QSPB-INSMAXAGE-8-5 TO SPB-INSMAXAGE(8 5).
           MOVE QSPB-INSMAXCOV-8-5 TO SPB-INSMAXCOV(8 5).
           MOVE QSPB-INSMAXTRM-8-5 TO SPB-INSMAXTRM(8 5).
           MOVE QSPB-INSFEECD-8 TO SPB-INSFEECD(8).
           MOVE QSPB-INSFEE-FRMLA-8 TO SPB-INSFEE-FRMLA(8).
           MOVE QSPB-INSCHGABL-FG-8 TO SPB-INSCHGABL-FG(8).
           MOVE QSPB-INSREJECT-FG-8 TO SPB-INSREJECT-FG(8).
           MOVE QSPB-INSFINCHG-8 TO SPB-INSFINCHG(8).
           MOVE QSPB-INSCOM-9 TO SPB-INSCOM(9).
           MOVE QSPB-INSRATECD-9 TO SPB-INSRATECD(9).
           MOVE QSPB-INSJFAC-9 TO SPB-INSJFAC(9).
           MOVE QSPB-INSDISCNT-9 TO SPB-INSDISCNT(9).
           MOVE QSPB-INSCHGABL-9 TO SPB-INSCHGABL(9).
           MOVE QSPB-INSTERM-9-1 TO SPB-INSTERM(9 1).
           MOVE QSPB-INSRATE-9-1 TO SPB-INSRATE(9 1).
           MOVE QSPB-INSTERM-9-2 TO SPB-INSTERM(9 2).
           MOVE QSPB-INSRATE-9-2 TO SPB-INSRATE(9 2).
           MOVE QSPB-INSTERM-9-3 TO SPB-INSTERM(9 3).
           MOVE QSPB-INSRATE-9-3 TO SPB-INSRATE(9 3).
           MOVE QSPB-INSTERM-9-4 TO SPB-INSTERM(9 4).
           MOVE QSPB-INSRATE-9-4 TO SPB-INSRATE(9 4).
           MOVE QSPB-INSTERM-9-5 TO SPB-INSTERM(9 5).
           MOVE QSPB-INSRATE-9-5 TO SPB-INSRATE(9 5).
           MOVE QSPB-INSTERM-9-6 TO SPB-INSTERM(9 6).
           MOVE QSPB-INSRATE-9-6 TO SPB-INSRATE(9 6).
           MOVE QSPB-INSTERM-9-7 TO SPB-INSTERM(9 7).
           MOVE QSPB-INSRATE-9-7 TO SPB-INSRATE(9 7).
           MOVE QSPB-INSTERM-9-8 TO SPB-INSTERM(9 8).
           MOVE QSPB-INSRATE-9-8 TO SPB-INSRATE(9 8).
           MOVE QSPB-INSTERM-9-9 TO SPB-INSTERM(9 9).
           MOVE QSPB-INSRATE-9-9 TO SPB-INSRATE(9 9).
           MOVE QSPB-INSTERM-9-10 TO SPB-INSTERM(9 10).
           MOVE QSPB-INSRATE-9-10 TO SPB-INSRATE(9 10).
           MOVE QSPB-INSTERM-9-11 TO SPB-INSTERM(9 11).
           MOVE QSPB-INSRATE-9-11 TO SPB-INSRATE(9 11).
           MOVE QSPB-INSTERM-9-12 TO SPB-INSTERM(9 12).
           MOVE QSPB-INSRATE-9-12 TO SPB-INSRATE(9 12).
           MOVE QSPB-INSTERM-9-13 TO SPB-INSTERM(9 13).
           MOVE QSPB-INSRATE-9-13 TO SPB-INSRATE(9 13).
           MOVE QSPB-INSTERM-9-14 TO SPB-INSTERM(9 14).
           MOVE QSPB-INSRATE-9-14 TO SPB-INSRATE(9 14).
           MOVE QSPB-INSTERM-9-15 TO SPB-INSTERM(9 15).
           MOVE QSPB-INSRATE-9-15 TO SPB-INSRATE(9 15).
           MOVE QSPB-INSTERM-9-16 TO SPB-INSTERM(9 16).
           MOVE QSPB-INSRATE-9-16 TO SPB-INSRATE(9 16).
           MOVE QSPB-INSTERM-9-17 TO SPB-INSTERM(9 17).
           MOVE QSPB-INSRATE-9-17 TO SPB-INSRATE(9 17).
           MOVE QSPB-INSTERM-9-18 TO SPB-INSTERM(9 18).
           MOVE QSPB-INSRATE-9-18 TO SPB-INSRATE(9 18).
           MOVE QSPB-INSTERM-9-19 TO SPB-INSTERM(9 19).
           MOVE QSPB-INSRATE-9-19 TO SPB-INSRATE(9 19).
           MOVE QSPB-INSTERM-9-20 TO SPB-INSTERM(9 20).
           MOVE QSPB-INSRATE-9-20 TO SPB-INSRATE(9 20).
           MOVE QSPB-INSMINPREM-9 TO SPB-INSMINPREM(9).
           MOVE QSPB-INSMINCHGABL-9 TO SPB-INSMINCHGABL(9).
           MOVE QSPB-INSMAXCHGABL-9 TO SPB-INSMAXCHGABL(9).
           MOVE QSPB-INSMAXBENIF-9 TO SPB-INSMAXBENIF(9).
           MOVE QSPB-INSMAXTERM-9 TO SPB-INSMAXTERM(9).
           MOVE QSPB-INSCHGBEN-9 TO SPB-INSCHGBEN(9).
           MOVE QSPB-INSEXCEPT-9 TO SPB-INSEXCEPT(9).
           MOVE QSPB-INSNOVER-9 TO SPB-INSNOVER(9).
           MOVE QSPB-INSMINAGE-9-1 TO SPB-INSMINAGE(9 1).
           MOVE QSPB-INSMAXAGE-9-1 TO SPB-INSMAXAGE(9 1).
           MOVE QSPB-INSMAXCOV-9-1 TO SPB-INSMAXCOV(9 1).
           MOVE QSPB-INSMAXTRM-9-1 TO SPB-INSMAXTRM(9 1).
           MOVE QSPB-INSMINAGE-9-2 TO SPB-INSMINAGE(9 2).
           MOVE QSPB-INSMAXAGE-9-2 TO SPB-INSMAXAGE(9 2).
           MOVE QSPB-INSMAXCOV-9-2 TO SPB-INSMAXCOV(9 2).
           MOVE QSPB-INSMAXTRM-9-2 TO SPB-INSMAXTRM(9 2).
           MOVE QSPB-INSMINAGE-9-3 TO SPB-INSMINAGE(9 3).
           MOVE QSPB-INSMAXAGE-9-3 TO SPB-INSMAXAGE(9 3).
           MOVE QSPB-INSMAXCOV-9-3 TO SPB-INSMAXCOV(9 3).
           MOVE QSPB-INSMAXTRM-9-3 TO SPB-INSMAXTRM(9 3).
           MOVE QSPB-INSMINAGE-9-4 TO SPB-INSMINAGE(9 4).
           MOVE QSPB-INSMAXAGE-9-4 TO SPB-INSMAXAGE(9 4).
           MOVE QSPB-INSMAXCOV-9-4 TO SPB-INSMAXCOV(9 4).
           MOVE QSPB-INSMAXTRM-9-4 TO SPB-INSMAXTRM(9 4).
           MOVE QSPB-INSMINAGE-9-5 TO SPB-INSMINAGE(9 5).
           MOVE QSPB-INSMAXAGE-9-5 TO SPB-INSMAXAGE(9 5).
           MOVE QSPB-INSMAXCOV-9-5 TO SPB-INSMAXCOV(9 5).
           MOVE QSPB-INSMAXTRM-9-5 TO SPB-INSMAXTRM(9 5).
           MOVE QSPB-INSFEECD-9 TO SPB-INSFEECD(9).
           MOVE QSPB-INSFEE-FRMLA-9 TO SPB-INSFEE-FRMLA(9).
           MOVE QSPB-INSCHGABL-FG-9 TO SPB-INSCHGABL-FG(9).
           MOVE QSPB-INSREJECT-FG-9 TO SPB-INSREJECT-FG(9).
           MOVE QSPB-INSFINCHG-9 TO SPB-INSFINCHG(9).
           MOVE QSPB-INSCOM-10 TO SPB-INSCOM(10).
           MOVE QSPB-INSRATECD-10 TO SPB-INSRATECD(10).
           MOVE QSPB-INSJFAC-10 TO SPB-INSJFAC(10).
           MOVE QSPB-INSDISCNT-10 TO SPB-INSDISCNT(10).
           MOVE QSPB-INSCHGABL-10 TO SPB-INSCHGABL(10).
           MOVE QSPB-INSTERM-10-1 TO SPB-INSTERM(10 1).
           MOVE QSPB-INSRATE-10-1 TO SPB-INSRATE(10 1).
           MOVE QSPB-INSTERM-10-2 TO SPB-INSTERM(10 2).
           MOVE QSPB-INSRATE-10-2 TO SPB-INSRATE(10 2).
           MOVE QSPB-INSTERM-10-3 TO SPB-INSTERM(10 3).
           MOVE QSPB-INSRATE-10-3 TO SPB-INSRATE(10 3).
           MOVE QSPB-INSTERM-10-4 TO SPB-INSTERM(10 4).
           MOVE QSPB-INSRATE-10-4 TO SPB-INSRATE(10 4).
           MOVE QSPB-INSTERM-10-5 TO SPB-INSTERM(10 5).
           MOVE QSPB-INSRATE-10-5 TO SPB-INSRATE(10 5).
           MOVE QSPB-INSTERM-10-6 TO SPB-INSTERM(10 6).
           MOVE QSPB-INSRATE-10-6 TO SPB-INSRATE(10 6).
           MOVE QSPB-INSTERM-10-7 TO SPB-INSTERM(10 7).
           MOVE QSPB-INSRATE-10-7 TO SPB-INSRATE(10 7).
           MOVE QSPB-INSTERM-10-8 TO SPB-INSTERM(10 8).
           MOVE QSPB-INSRATE-10-8 TO SPB-INSRATE(10 8).
           MOVE QSPB-INSTERM-10-9 TO SPB-INSTERM(10 9).
           MOVE QSPB-INSRATE-10-9 TO SPB-INSRATE(10 9).
           MOVE QSPB-INSTERM-10-10 TO SPB-INSTERM(10 10).
           MOVE QSPB-INSRATE-10-10 TO SPB-INSRATE(10 10).
           MOVE QSPB-INSTERM-10-11 TO SPB-INSTERM(10 11).
           MOVE QSPB-INSRATE-10-11 TO SPB-INSRATE(10 11).
           MOVE QSPB-INSTERM-10-12 TO SPB-INSTERM(10 12).
           MOVE QSPB-INSRATE-10-12 TO SPB-INSRATE(10 12).
           MOVE QSPB-INSTERM-10-13 TO SPB-INSTERM(10 13).
           MOVE QSPB-INSRATE-10-13 TO SPB-INSRATE(10 13).
           MOVE QSPB-INSTERM-10-14 TO SPB-INSTERM(10 14).
           MOVE QSPB-INSRATE-10-14 TO SPB-INSRATE(10 14).
           MOVE QSPB-INSTERM-10-15 TO SPB-INSTERM(10 15).
           MOVE QSPB-INSRATE-10-15 TO SPB-INSRATE(10 15).
           MOVE QSPB-INSTERM-10-16 TO SPB-INSTERM(10 16).
           MOVE QSPB-INSRATE-10-16 TO SPB-INSRATE(10 16).
           MOVE QSPB-INSTERM-10-17 TO SPB-INSTERM(10 17).
           MOVE QSPB-INSRATE-10-17 TO SPB-INSRATE(10 17).
           MOVE QSPB-INSTERM-10-18 TO SPB-INSTERM(10 18).
           MOVE QSPB-INSRATE-10-18 TO SPB-INSRATE(10 18).
           MOVE QSPB-INSTERM-10-19 TO SPB-INSTERM(10 19).
           MOVE QSPB-INSRATE-10-19 TO SPB-INSRATE(10 19).
           MOVE QSPB-INSTERM-10-20 TO SPB-INSTERM(10 20).
           MOVE QSPB-INSRATE-10-20 TO SPB-INSRATE(10 20).
           MOVE QSPB-INSMINPREM-10 TO SPB-INSMINPREM(10).
           MOVE QSPB-INSMINCHGABL-10 TO SPB-INSMINCHGABL(10).
           MOVE QSPB-INSMAXCHGABL-10 TO SPB-INSMAXCHGABL(10).
           MOVE QSPB-INSMAXBENIF-10 TO SPB-INSMAXBENIF(10).
           MOVE QSPB-INSMAXTERM-10 TO SPB-INSMAXTERM(10).
           MOVE QSPB-INSCHGBEN-10 TO SPB-INSCHGBEN(10).
           MOVE QSPB-INSEXCEPT-10 TO SPB-INSEXCEPT(10).
           MOVE QSPB-INSNOVER-10 TO SPB-INSNOVER(10).
           MOVE QSPB-INSMINAGE-10-1 TO SPB-INSMINAGE(10 1).
           MOVE QSPB-INSMAXAGE-10-1 TO SPB-INSMAXAGE(10 1).
           MOVE QSPB-INSMAXCOV-10-1 TO SPB-INSMAXCOV(10 1).
           MOVE QSPB-INSMAXTRM-10-1 TO SPB-INSMAXTRM(10 1).
           MOVE QSPB-INSMINAGE-10-2 TO SPB-INSMINAGE(10 2).
           MOVE QSPB-INSMAXAGE-10-2 TO SPB-INSMAXAGE(10 2).
           MOVE QSPB-INSMAXCOV-10-2 TO SPB-INSMAXCOV(10 2).
           MOVE QSPB-INSMAXTRM-10-2 TO SPB-INSMAXTRM(10 2).
           MOVE QSPB-INSMINAGE-10-3 TO SPB-INSMINAGE(10 3).
           MOVE QSPB-INSMAXAGE-10-3 TO SPB-INSMAXAGE(10 3).
           MOVE QSPB-INSMAXCOV-10-3 TO SPB-INSMAXCOV(10 3).
           MOVE QSPB-INSMAXTRM-10-3 TO SPB-INSMAXTRM(10 3).
           MOVE QSPB-INSMINAGE-10-4 TO SPB-INSMINAGE(10 4).
           MOVE QSPB-INSMAXAGE-10-4 TO SPB-INSMAXAGE(10 4).
           MOVE QSPB-INSMAXCOV-10-4 TO SPB-INSMAXCOV(10 4).
           MOVE QSPB-INSMAXTRM-10-4 TO SPB-INSMAXTRM(10 4).
           MOVE QSPB-INSMINAGE-10-5 TO SPB-INSMINAGE(10 5).
           MOVE QSPB-INSMAXAGE-10-5 TO SPB-INSMAXAGE(10 5).
           MOVE QSPB-INSMAXCOV-10-5 TO SPB-INSMAXCOV(10 5).
           MOVE QSPB-INSMAXTRM-10-5 TO SPB-INSMAXTRM(10 5).
           MOVE QSPB-INSFEECD-10 TO SPB-INSFEECD(10).
           MOVE QSPB-INSFEE-FRMLA-10 TO SPB-INSFEE-FRMLA(10).
           MOVE QSPB-INSCHGABL-FG-10 TO SPB-INSCHGABL-FG(10).
           MOVE QSPB-INSREJECT-FG-10 TO SPB-INSREJECT-FG(10).
           MOVE QSPB-INSFINCHG-10 TO SPB-INSFINCHG(10).
           MOVE QSPB-INSCOM-11 TO SPB-INSCOM(11).
           MOVE QSPB-INSRATECD-11 TO SPB-INSRATECD(11).
           MOVE QSPB-INSJFAC-11 TO SPB-INSJFAC(11).
           MOVE QSPB-INSDISCNT-11 TO SPB-INSDISCNT(11).
           MOVE QSPB-INSCHGABL-11 TO SPB-INSCHGABL(11).
           MOVE QSPB-INSTERM-11-1 TO SPB-INSTERM(11 1).
           MOVE QSPB-INSRATE-11-1 TO SPB-INSRATE(11 1).
           MOVE QSPB-INSTERM-11-2 TO SPB-INSTERM(11 2).
           MOVE QSPB-INSRATE-11-2 TO SPB-INSRATE(11 2).
           MOVE QSPB-INSTERM-11-3 TO SPB-INSTERM(11 3).
           MOVE QSPB-INSRATE-11-3 TO SPB-INSRATE(11 3).
           MOVE QSPB-INSTERM-11-4 TO SPB-INSTERM(11 4).
           MOVE QSPB-INSRATE-11-4 TO SPB-INSRATE(11 4).
           MOVE QSPB-INSTERM-11-5 TO SPB-INSTERM(11 5).
           MOVE QSPB-INSRATE-11-5 TO SPB-INSRATE(11 5).
           MOVE QSPB-INSTERM-11-6 TO SPB-INSTERM(11 6).
           MOVE QSPB-INSRATE-11-6 TO SPB-INSRATE(11 6).
           MOVE QSPB-INSTERM-11-7 TO SPB-INSTERM(11 7).
           MOVE QSPB-INSRATE-11-7 TO SPB-INSRATE(11 7).
           MOVE QSPB-INSTERM-11-8 TO SPB-INSTERM(11 8).
           MOVE QSPB-INSRATE-11-8 TO SPB-INSRATE(11 8).
           MOVE QSPB-INSTERM-11-9 TO SPB-INSTERM(11 9).
           MOVE QSPB-INSRATE-11-9 TO SPB-INSRATE(11 9).
           MOVE QSPB-INSTERM-11-10 TO SPB-INSTERM(11 10).
           MOVE QSPB-INSRATE-11-10 TO SPB-INSRATE(11 10).
           MOVE QSPB-INSTERM-11-11 TO SPB-INSTERM(11 11).
           MOVE QSPB-INSRATE-11-11 TO SPB-INSRATE(11 11).
           MOVE QSPB-INSTERM-11-12 TO SPB-INSTERM(11 12).
           MOVE QSPB-INSRATE-11-12 TO SPB-INSRATE(11 12).
           MOVE QSPB-INSTERM-11-13 TO SPB-INSTERM(11 13).
           MOVE QSPB-INSRATE-11-13 TO SPB-INSRATE(11 13).
           MOVE QSPB-INSTERM-11-14 TO SPB-INSTERM(11 14).
           MOVE QSPB-INSRATE-11-14 TO SPB-INSRATE(11 14).
           MOVE QSPB-INSTERM-11-15 TO SPB-INSTERM(11 15).
           MOVE QSPB-INSRATE-11-15 TO SPB-INSRATE(11 15).
           MOVE QSPB-INSTERM-11-16 TO SPB-INSTERM(11 16).
           MOVE QSPB-INSRATE-11-16 TO SPB-INSRATE(11 16).
           MOVE QSPB-INSTERM-11-17 TO SPB-INSTERM(11 17).
           MOVE QSPB-INSRATE-11-17 TO SPB-INSRATE(11 17).
           MOVE QSPB-INSTERM-11-18 TO SPB-INSTERM(11 18).
           MOVE QSPB-INSRATE-11-18 TO SPB-INSRATE(11 18).
           MOVE QSPB-INSTERM-11-19 TO SPB-INSTERM(11 19).
           MOVE QSPB-INSRATE-11-19 TO SPB-INSRATE(11 19).
           MOVE QSPB-INSTERM-11-20 TO SPB-INSTERM(11 20).
           MOVE QSPB-INSRATE-11-20 TO SPB-INSRATE(11 20).
           MOVE QSPB-INSMINPREM-11 TO SPB-INSMINPREM(11).
           MOVE QSPB-INSMINCHGABL-11 TO SPB-INSMINCHGABL(11).
           MOVE QSPB-INSMAXCHGABL-11 TO SPB-INSMAXCHGABL(11).
           MOVE QSPB-INSMAXBENIF-11 TO SPB-INSMAXBENIF(11).
           MOVE QSPB-INSMAXTERM-11 TO SPB-INSMAXTERM(11).
           MOVE QSPB-INSCHGBEN-11 TO SPB-INSCHGBEN(11).
           MOVE QSPB-INSEXCEPT-11 TO SPB-INSEXCEPT(11).
           MOVE QSPB-INSNOVER-11 TO SPB-INSNOVER(11).
           MOVE QSPB-INSMINAGE-11-1 TO SPB-INSMINAGE(11 1).
           MOVE QSPB-INSMAXAGE-11-1 TO SPB-INSMAXAGE(11 1).
           MOVE QSPB-INSMAXCOV-11-1 TO SPB-INSMAXCOV(11 1).
           MOVE QSPB-INSMAXTRM-11-1 TO SPB-INSMAXTRM(11 1).
           MOVE QSPB-INSMINAGE-11-2 TO SPB-INSMINAGE(11 2).
           MOVE QSPB-INSMAXAGE-11-2 TO SPB-INSMAXAGE(11 2).
           MOVE QSPB-INSMAXCOV-11-2 TO SPB-INSMAXCOV(11 2).
           MOVE QSPB-INSMAXTRM-11-2 TO SPB-INSMAXTRM(11 2).
           MOVE QSPB-INSMINAGE-11-3 TO SPB-INSMINAGE(11 3).
           MOVE QSPB-INSMAXAGE-11-3 TO SPB-INSMAXAGE(11 3).
           MOVE QSPB-INSMAXCOV-11-3 TO SPB-INSMAXCOV(11 3).
           MOVE QSPB-INSMAXTRM-11-3 TO SPB-INSMAXTRM(11 3).
           MOVE QSPB-INSMINAGE-11-4 TO SPB-INSMINAGE(11 4).
           MOVE QSPB-INSMAXAGE-11-4 TO SPB-INSMAXAGE(11 4).
           MOVE QSPB-INSMAXCOV-11-4 TO SPB-INSMAXCOV(11 4).
           MOVE QSPB-INSMAXTRM-11-4 TO SPB-INSMAXTRM(11 4).
           MOVE QSPB-INSMINAGE-11-5 TO SPB-INSMINAGE(11 5).
           MOVE QSPB-INSMAXAGE-11-5 TO SPB-INSMAXAGE(11 5).
           MOVE QSPB-INSMAXCOV-11-5 TO SPB-INSMAXCOV(11 5).
           MOVE QSPB-INSMAXTRM-11-5 TO SPB-INSMAXTRM(11 5).
           MOVE QSPB-INSFEECD-11 TO SPB-INSFEECD(11).
           MOVE QSPB-INSFEE-FRMLA-11 TO SPB-INSFEE-FRMLA(11).
           MOVE QSPB-INSCHGABL-FG-11 TO SPB-INSCHGABL-FG(11).
           MOVE QSPB-INSREJECT-FG-11 TO SPB-INSREJECT-FG(11).
           MOVE QSPB-INSFINCHG-11 TO SPB-INSFINCHG(11).
           MOVE QSPB-INSCOM-12 TO SPB-INSCOM(12).
           MOVE QSPB-INSRATECD-12 TO SPB-INSRATECD(12).
           MOVE QSPB-INSJFAC-12 TO SPB-INSJFAC(12).
           MOVE QSPB-INSDISCNT-12 TO SPB-INSDISCNT(12).
           MOVE QSPB-INSCHGABL-12 TO SPB-INSCHGABL(12).
           MOVE QSPB-INSTERM-12-1 TO SPB-INSTERM(12 1).
           MOVE QSPB-INSRATE-12-1 TO SPB-INSRATE(12 1).
           MOVE QSPB-INSTERM-12-2 TO SPB-INSTERM(12 2).
           MOVE QSPB-INSRATE-12-2 TO SPB-INSRATE(12 2).
           MOVE QSPB-INSTERM-12-3 TO SPB-INSTERM(12 3).
           MOVE QSPB-INSRATE-12-3 TO SPB-INSRATE(12 3).
           MOVE QSPB-INSTERM-12-4 TO SPB-INSTERM(12 4).
           MOVE QSPB-INSRATE-12-4 TO SPB-INSRATE(12 4).
           MOVE QSPB-INSTERM-12-5 TO SPB-INSTERM(12 5).
           MOVE QSPB-INSRATE-12-5 TO SPB-INSRATE(12 5).
           MOVE QSPB-INSTERM-12-6 TO SPB-INSTERM(12 6).
           MOVE QSPB-INSRATE-12-6 TO SPB-INSRATE(12 6).
           MOVE QSPB-INSTERM-12-7 TO SPB-INSTERM(12 7).
           MOVE QSPB-INSRATE-12-7 TO SPB-INSRATE(12 7).
           MOVE QSPB-INSTERM-12-8 TO SPB-INSTERM(12 8).
           MOVE QSPB-INSRATE-12-8 TO SPB-INSRATE(12 8).
           MOVE QSPB-INSTERM-12-9 TO SPB-INSTERM(12 9).
           MOVE QSPB-INSRATE-12-9 TO SPB-INSRATE(12 9).
           MOVE QSPB-INSTERM-12-10 TO SPB-INSTERM(12 10).
           MOVE QSPB-INSRATE-12-10 TO SPB-INSRATE(12 10).
           MOVE QSPB-INSTERM-12-11 TO SPB-INSTERM(12 11).
           MOVE QSPB-INSRATE-12-11 TO SPB-INSRATE(12 11).
           MOVE QSPB-INSTERM-12-12 TO SPB-INSTERM(12 12).
           MOVE QSPB-INSRATE-12-12 TO SPB-INSRATE(12 12).
           MOVE QSPB-INSTERM-12-13 TO SPB-INSTERM(12 13).
           MOVE QSPB-INSRATE-12-13 TO SPB-INSRATE(12 13).
           MOVE QSPB-INSTERM-12-14 TO SPB-INSTERM(12 14).
           MOVE QSPB-INSRATE-12-14 TO SPB-INSRATE(12 14).
           MOVE QSPB-INSTERM-12-15 TO SPB-INSTERM(12 15).
           MOVE QSPB-INSRATE-12-15 TO SPB-INSRATE(12 15).
           MOVE QSPB-INSTERM-12-16 TO SPB-INSTERM(12 16).
           MOVE QSPB-INSRATE-12-16 TO SPB-INSRATE(12 16).
           MOVE QSPB-INSTERM-12-17 TO SPB-INSTERM(12 17).
           MOVE QSPB-INSRATE-12-17 TO SPB-INSRATE(12 17).
           MOVE QSPB-INSTERM-12-18 TO SPB-INSTERM(12 18).
           MOVE QSPB-INSRATE-12-18 TO SPB-INSRATE(12 18).
           MOVE QSPB-INSTERM-12-19 TO SPB-INSTERM(12 19).
           MOVE QSPB-INSRATE-12-19 TO SPB-INSRATE(12 19).
           MOVE QSPB-INSTERM-12-20 TO SPB-INSTERM(12 20).
           MOVE QSPB-INSRATE-12-20 TO SPB-INSRATE(12 20).
           MOVE QSPB-INSMINPREM-12 TO SPB-INSMINPREM(12).
           MOVE QSPB-INSMINCHGABL-12 TO SPB-INSMINCHGABL(12).
           MOVE QSPB-INSMAXCHGABL-12 TO SPB-INSMAXCHGABL(12).
           MOVE QSPB-INSMAXBENIF-12 TO SPB-INSMAXBENIF(12).
           MOVE QSPB-INSMAXTERM-12 TO SPB-INSMAXTERM(12).
           MOVE QSPB-INSCHGBEN-12 TO SPB-INSCHGBEN(12).
           MOVE QSPB-INSEXCEPT-12 TO SPB-INSEXCEPT(12).
           MOVE QSPB-INSNOVER-12 TO SPB-INSNOVER(12).
           MOVE QSPB-INSMINAGE-12-1 TO SPB-INSMINAGE(12 1).
           MOVE QSPB-INSMAXAGE-12-1 TO SPB-INSMAXAGE(12 1).
           MOVE QSPB-INSMAXCOV-12-1 TO SPB-INSMAXCOV(12 1).
           MOVE QSPB-INSMAXTRM-12-1 TO SPB-INSMAXTRM(12 1).
           MOVE QSPB-INSMINAGE-12-2 TO SPB-INSMINAGE(12 2).
           MOVE QSPB-INSMAXAGE-12-2 TO SPB-INSMAXAGE(12 2).
           MOVE QSPB-INSMAXCOV-12-2 TO SPB-INSMAXCOV(12 2).
           MOVE QSPB-INSMAXTRM-12-2 TO SPB-INSMAXTRM(12 2).
           MOVE QSPB-INSMINAGE-12-3 TO SPB-INSMINAGE(12 3).
           MOVE QSPB-INSMAXAGE-12-3 TO SPB-INSMAXAGE(12 3).
           MOVE QSPB-INSMAXCOV-12-3 TO SPB-INSMAXCOV(12 3).
           MOVE QSPB-INSMAXTRM-12-3 TO SPB-INSMAXTRM(12 3).
           MOVE QSPB-INSMINAGE-12-4 TO SPB-INSMINAGE(12 4).
           MOVE QSPB-INSMAXAGE-12-4 TO SPB-INSMAXAGE(12 4).
           MOVE QSPB-INSMAXCOV-12-4 TO SPB-INSMAXCOV(12 4).
           MOVE QSPB-INSMAXTRM-12-4 TO SPB-INSMAXTRM(12 4).
           MOVE QSPB-INSMINAGE-12-5 TO SPB-INSMINAGE(12 5).
           MOVE QSPB-INSMAXAGE-12-5 TO SPB-INSMAXAGE(12 5).
           MOVE QSPB-INSMAXCOV-12-5 TO SPB-INSMAXCOV(12 5).
           MOVE QSPB-INSMAXTRM-12-5 TO SPB-INSMAXTRM(12 5).
           MOVE QSPB-INSFEECD-12 TO SPB-INSFEECD(12).
           MOVE QSPB-INSFEE-FRMLA-12 TO SPB-INSFEE-FRMLA(12).
           MOVE QSPB-INSCHGABL-FG-12 TO SPB-INSCHGABL-FG(12).
           MOVE QSPB-INSREJECT-FG-12 TO SPB-INSREJECT-FG(12).
           MOVE QSPB-INSFINCHG-12 TO SPB-INSFINCHG(12).
 
      *-----------------------------------------------------------------
      *    LOAD QSPB-REC FROM SPB-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-SPB-FIELDS.
           MOVE SPB-ORGST TO QSPB-ORGST.
           MOVE SPB-SPRCLASS TO QSPB-SPRCLASS.
           MOVE SPB-SUBCLASS TO QSPB-SUBCLASS.
           MOVE SPB-LAWCODE TO QSPB-LAWCODE.
           MOVE SPB-INSCOM(1) TO QSPB-INSCOM-1.
           MOVE SPB-INSRATECD(1) TO QSPB-INSRATECD-1.
           MOVE SPB-INSJFAC(1) TO QSPB-INSJFAC-1.
           MOVE SPB-INSDISCNT(1) TO QSPB-INSDISCNT-1.
           MOVE SPB-INSCHGABL(1) TO QSPB-INSCHGABL-1.
           MOVE SPB-INSTERM(1 1) TO QSPB-INSTERM-1-1.
           MOVE SPB-INSRATE(1 1) TO QSPB-INSRATE-1-1.
           MOVE SPB-INSTERM(1 2) TO QSPB-INSTERM-1-2.
           MOVE SPB-INSRATE(1 2) TO QSPB-INSRATE-1-2.
           MOVE SPB-INSTERM(1 3) TO QSPB-INSTERM-1-3.
           MOVE SPB-INSRATE(1 3) TO QSPB-INSRATE-1-3.
           MOVE SPB-INSTERM(1 4) TO QSPB-INSTERM-1-4.
           MOVE SPB-INSRATE(1 4) TO QSPB-INSRATE-1-4.
           MOVE SPB-INSTERM(1 5) TO QSPB-INSTERM-1-5.
           MOVE SPB-INSRATE(1 5) TO QSPB-INSRATE-1-5.
           MOVE SPB-INSTERM(1 6) TO QSPB-INSTERM-1-6.
           MOVE SPB-INSRATE(1 6) TO QSPB-INSRATE-1-6.
           MOVE SPB-INSTERM(1 7) TO QSPB-INSTERM-1-7.
           MOVE SPB-INSRATE(1 7) TO QSPB-INSRATE-1-7.
           MOVE SPB-INSTERM(1 8) TO QSPB-INSTERM-1-8.
           MOVE SPB-INSRATE(1 8) TO QSPB-INSRATE-1-8.
           MOVE SPB-INSTERM(1 9) TO QSPB-INSTERM-1-9.
           MOVE SPB-INSRATE(1 9) TO QSPB-INSRATE-1-9.
           MOVE SPB-INSTERM(1 10) TO QSPB-INSTERM-1-10.
           MOVE SPB-INSRATE(1 10) TO QSPB-INSRATE-1-10.
           MOVE SPB-INSTERM(1 11) TO QSPB-INSTERM-1-11.
           MOVE SPB-INSRATE(1 11) TO QSPB-INSRATE-1-11.
           MOVE SPB-INSTERM(1 12) TO QSPB-INSTERM-1-12.
           MOVE SPB-INSRATE(1 12) TO QSPB-INSRATE-1-12.
           MOVE SPB-INSTERM(1 13) TO QSPB-INSTERM-1-13.
           MOVE SPB-INSRATE(1 13) TO QSPB-INSRATE-1-13.
           MOVE SPB-INSTERM(1 14) TO QSPB-INSTERM-1-14.
           MOVE SPB-INSRATE(1 14) TO QSPB-INSRATE-1-14.
           MOVE SPB-INSTERM(1 15) TO QSPB-INSTERM-1-15.
           MOVE SPB-INSRATE(1 15) TO QSPB-INSRATE-1-15.
           MOVE SPB-INSTERM(1 16) TO QSPB-INSTERM-1-16.
           MOVE SPB-INSRATE(1 16) TO QSPB-INSRATE-1-16.
           MOVE SPB-INSTERM(1 17) TO QSPB-INSTERM-1-17.
           MOVE SPB-INSRATE(1 17) TO QSPB-INSRATE-1-17.
           MOVE SPB-INSTERM(1 18) TO QSPB-INSTERM-1-18.
           MOVE SPB-INSRATE(1 18) TO QSPB-INSRATE-1-18.
           MOVE SPB-INSTERM(1 19) TO QSPB-INSTERM-1-19.
           MOVE SPB-INSRATE(1 19) TO QSPB-INSRATE-1-19.
           MOVE SPB-INSTERM(1 20) TO QSPB-INSTERM-1-20.
           MOVE SPB-INSRATE(1 20) TO QSPB-INSRATE-1-20.
           MOVE SPB-INSMINPREM(1) TO QSPB-INSMINPREM-1.
           MOVE SPB-INSMINCHGABL(1) TO QSPB-INSMINCHGABL-1.
           MOVE SPB-INSMAXCHGABL(1) TO QSPB-INSMAXCHGABL-1.
           MOVE SPB-INSMAXBENIF(1) TO QSPB-INSMAXBENIF-1.
           MOVE SPB-INSMAXTERM(1) TO QSPB-INSMAXTERM-1.
           MOVE SPB-INSCHGBEN(1) TO QSPB-INSCHGBEN-1.
           MOVE SPB-INSEXCEPT(1) TO QSPB-INSEXCEPT-1.
           MOVE SPB-INSNOVER(1) TO QSPB-INSNOVER-1.
           MOVE SPB-INSMINAGE(1 1) TO QSPB-INSMINAGE-1-1.
           MOVE SPB-INSMAXAGE(1 1) TO QSPB-INSMAXAGE-1-1.
           MOVE SPB-INSMAXCOV(1 1) TO QSPB-INSMAXCOV-1-1.
           MOVE SPB-INSMAXTRM(1 1) TO QSPB-INSMAXTRM-1-1.
           MOVE SPB-INSMINAGE(1 2) TO QSPB-INSMINAGE-1-2.
           MOVE SPB-INSMAXAGE(1 2) TO QSPB-INSMAXAGE-1-2.
           MOVE SPB-INSMAXCOV(1 2) TO QSPB-INSMAXCOV-1-2.
           MOVE SPB-INSMAXTRM(1 2) TO QSPB-INSMAXTRM-1-2.
           MOVE SPB-INSMINAGE(1 3) TO QSPB-INSMINAGE-1-3.
           MOVE SPB-INSMAXAGE(1 3) TO QSPB-INSMAXAGE-1-3.
           MOVE SPB-INSMAXCOV(1 3) TO QSPB-INSMAXCOV-1-3.
           MOVE SPB-INSMAXTRM(1 3) TO QSPB-INSMAXTRM-1-3.
           MOVE SPB-INSMINAGE(1 4) TO QSPB-INSMINAGE-1-4.
           MOVE SPB-INSMAXAGE(1 4) TO QSPB-INSMAXAGE-1-4.
           MOVE SPB-INSMAXCOV(1 4) TO QSPB-INSMAXCOV-1-4.
           MOVE SPB-INSMAXTRM(1 4) TO QSPB-INSMAXTRM-1-4.
           MOVE SPB-INSMINAGE(1 5) TO QSPB-INSMINAGE-1-5.
           MOVE SPB-INSMAXAGE(1 5) TO QSPB-INSMAXAGE-1-5.
           MOVE SPB-INSMAXCOV(1 5) TO QSPB-INSMAXCOV-1-5.
           MOVE SPB-INSMAXTRM(1 5) TO QSPB-INSMAXTRM-1-5.
           MOVE SPB-INSFEECD(1) TO QSPB-INSFEECD-1.
           MOVE SPB-INSFEE-FRMLA(1) TO QSPB-INSFEE-FRMLA-1.
           MOVE SPB-INSCHGABL-FG(1) TO QSPB-INSCHGABL-FG-1.
           MOVE SPB-INSREJECT-FG(1) TO QSPB-INSREJECT-FG-1.
           MOVE SPB-INSFINCHG(1) TO QSPB-INSFINCHG-1.
           MOVE SPB-INSCOM(2) TO QSPB-INSCOM-2.
           MOVE SPB-INSRATECD(2) TO QSPB-INSRATECD-2.
           MOVE SPB-INSJFAC(2) TO QSPB-INSJFAC-2.
           MOVE SPB-INSDISCNT(2) TO QSPB-INSDISCNT-2.
           MOVE SPB-INSCHGABL(2) TO QSPB-INSCHGABL-2.
           MOVE SPB-INSTERM(2 1) TO QSPB-INSTERM-2-1.
           MOVE SPB-INSRATE(2 1) TO QSPB-INSRATE-2-1.
           MOVE SPB-INSTERM(2 2) TO QSPB-INSTERM-2-2.
           MOVE SPB-INSRATE(2 2) TO QSPB-INSRATE-2-2.
           MOVE SPB-INSTERM(2 3) TO QSPB-INSTERM-2-3.
           MOVE SPB-INSRATE(2 3) TO QSPB-INSRATE-2-3.
           MOVE SPB-INSTERM(2 4) TO QSPB-INSTERM-2-4.
           MOVE SPB-INSRATE(2 4) TO QSPB-INSRATE-2-4.
           MOVE SPB-INSTERM(2 5) TO QSPB-INSTERM-2-5.
           MOVE SPB-INSRATE(2 5) TO QSPB-INSRATE-2-5.
           MOVE SPB-INSTERM(2 6) TO QSPB-INSTERM-2-6.
           MOVE SPB-INSRATE(2 6) TO QSPB-INSRATE-2-6.
           MOVE SPB-INSTERM(2 7) TO QSPB-INSTERM-2-7.
           MOVE SPB-INSRATE(2 7) TO QSPB-INSRATE-2-7.
           MOVE SPB-INSTERM(2 8) TO QSPB-INSTERM-2-8.
           MOVE SPB-INSRATE(2 8) TO QSPB-INSRATE-2-8.
           MOVE SPB-INSTERM(2 9) TO QSPB-INSTERM-2-9.
           MOVE SPB-INSRATE(2 9) TO QSPB-INSRATE-2-9.
           MOVE SPB-INSTERM(2 10) TO QSPB-INSTERM-2-10.
           MOVE SPB-INSRATE(2 10) TO QSPB-INSRATE-2-10.
           MOVE SPB-INSTERM(2 11) TO QSPB-INSTERM-2-11.
           MOVE SPB-INSRATE(2 11) TO QSPB-INSRATE-2-11.
           MOVE SPB-INSTERM(2 12) TO QSPB-INSTERM-2-12.
           MOVE SPB-INSRATE(2 12) TO QSPB-INSRATE-2-12.
           MOVE SPB-INSTERM(2 13) TO QSPB-INSTERM-2-13.
           MOVE SPB-INSRATE(2 13) TO QSPB-INSRATE-2-13.
           MOVE SPB-INSTERM(2 14) TO QSPB-INSTERM-2-14.
           MOVE SPB-INSRATE(2 14) TO QSPB-INSRATE-2-14.
           MOVE SPB-INSTERM(2 15) TO QSPB-INSTERM-2-15.
           MOVE SPB-INSRATE(2 15) TO QSPB-INSRATE-2-15.
           MOVE SPB-INSTERM(2 16) TO QSPB-INSTERM-2-16.
           MOVE SPB-INSRATE(2 16) TO QSPB-INSRATE-2-16.
           MOVE SPB-INSTERM(2 17) TO QSPB-INSTERM-2-17.
           MOVE SPB-INSRATE(2 17) TO QSPB-INSRATE-2-17.
           MOVE SPB-INSTERM(2 18) TO QSPB-INSTERM-2-18.
           MOVE SPB-INSRATE(2 18) TO QSPB-INSRATE-2-18.
           MOVE SPB-INSTERM(2 19) TO QSPB-INSTERM-2-19.
           MOVE SPB-INSRATE(2 19) TO QSPB-INSRATE-2-19.
           MOVE SPB-INSTERM(2 20) TO QSPB-INSTERM-2-20.
           MOVE SPB-INSRATE(2 20) TO QSPB-INSRATE-2-20.
           MOVE SPB-INSMINPREM(2) TO QSPB-INSMINPREM-2.
           MOVE SPB-INSMINCHGABL(2) TO QSPB-INSMINCHGABL-2.
           MOVE SPB-INSMAXCHGABL(2) TO QSPB-INSMAXCHGABL-2.
           MOVE SPB-INSMAXBENIF(2) TO QSPB-INSMAXBENIF-2.
           MOVE SPB-INSMAXTERM(2) TO QSPB-INSMAXTERM-2.
           MOVE SPB-INSCHGBEN(2) TO QSPB-INSCHGBEN-2.
           MOVE SPB-INSEXCEPT(2) TO QSPB-INSEXCEPT-2.
           MOVE SPB-INSNOVER(2) TO QSPB-INSNOVER-2.
           MOVE SPB-INSMINAGE(2 1) TO QSPB-INSMINAGE-2-1.
           MOVE SPB-INSMAXAGE(2 1) TO QSPB-INSMAXAGE-2-1.
           MOVE SPB-INSMAXCOV(2 1) TO QSPB-INSMAXCOV-2-1.
           MOVE SPB-INSMAXTRM(2 1) TO QSPB-INSMAXTRM-2-1.
           MOVE SPB-INSMINAGE(2 2) TO QSPB-INSMINAGE-2-2.
           MOVE SPB-INSMAXAGE(2 2) TO QSPB-INSMAXAGE-2-2.
           MOVE SPB-INSMAXCOV(2 2) TO QSPB-INSMAXCOV-2-2.
           MOVE SPB-INSMAXTRM(2 2) TO QSPB-INSMAXTRM-2-2.
           MOVE SPB-INSMINAGE(2 3) TO QSPB-INSMINAGE-2-3.
           MOVE SPB-INSMAXAGE(2 3) TO QSPB-INSMAXAGE-2-3.
           MOVE SPB-INSMAXCOV(2 3) TO QSPB-INSMAXCOV-2-3.
           MOVE SPB-INSMAXTRM(2 3) TO QSPB-INSMAXTRM-2-3.
           MOVE SPB-INSMINAGE(2 4) TO QSPB-INSMINAGE-2-4.
           MOVE SPB-INSMAXAGE(2 4) TO QSPB-INSMAXAGE-2-4.
           MOVE SPB-INSMAXCOV(2 4) TO QSPB-INSMAXCOV-2-4.
           MOVE SPB-INSMAXTRM(2 4) TO QSPB-INSMAXTRM-2-4.
           MOVE SPB-INSMINAGE(2 5) TO QSPB-INSMINAGE-2-5.
           MOVE SPB-INSMAXAGE(2 5) TO QSPB-INSMAXAGE-2-5.
           MOVE SPB-INSMAXCOV(2 5) TO QSPB-INSMAXCOV-2-5.
           MOVE SPB-INSMAXTRM(2 5) TO QSPB-INSMAXTRM-2-5.
           MOVE SPB-INSFEECD(2) TO QSPB-INSFEECD-2.
           MOVE SPB-INSFEE-FRMLA(2) TO QSPB-INSFEE-FRMLA-2.
           MOVE SPB-INSCHGABL-FG(2) TO QSPB-INSCHGABL-FG-2.
           MOVE SPB-INSREJECT-FG(2) TO QSPB-INSREJECT-FG-2.
           MOVE SPB-INSFINCHG(2) TO QSPB-INSFINCHG-2.
           MOVE SPB-INSCOM(3) TO QSPB-INSCOM-3.
           MOVE SPB-INSRATECD(3) TO QSPB-INSRATECD-3.
           MOVE SPB-INSJFAC(3) TO QSPB-INSJFAC-3.
           MOVE SPB-INSDISCNT(3) TO QSPB-INSDISCNT-3.
           MOVE SPB-INSCHGABL(3) TO QSPB-INSCHGABL-3.
           MOVE SPB-INSTERM(3 1) TO QSPB-INSTERM-3-1.
           MOVE SPB-INSRATE(3 1) TO QSPB-INSRATE-3-1.
           MOVE SPB-INSTERM(3 2) TO QSPB-INSTERM-3-2.
           MOVE SPB-INSRATE(3 2) TO QSPB-INSRATE-3-2.
           MOVE SPB-INSTERM(3 3) TO QSPB-INSTERM-3-3.
           MOVE SPB-INSRATE(3 3) TO QSPB-INSRATE-3-3.
           MOVE SPB-INSTERM(3 4) TO QSPB-INSTERM-3-4.
           MOVE SPB-INSRATE(3 4) TO QSPB-INSRATE-3-4.
           MOVE SPB-INSTERM(3 5) TO QSPB-INSTERM-3-5.
           MOVE SPB-INSRATE(3 5) TO QSPB-INSRATE-3-5.
           MOVE SPB-INSTERM(3 6) TO QSPB-INSTERM-3-6.
           MOVE SPB-INSRATE(3 6) TO QSPB-INSRATE-3-6.
           MOVE SPB-INSTERM(3 7) TO QSPB-INSTERM-3-7.
           MOVE SPB-INSRATE(3 7) TO QSPB-INSRATE-3-7.
           MOVE SPB-INSTERM(3 8) TO QSPB-INSTERM-3-8.
           MOVE SPB-INSRATE(3 8) TO QSPB-INSRATE-3-8.
           MOVE SPB-INSTERM(3 9) TO QSPB-INSTERM-3-9.
           MOVE SPB-INSRATE(3 9) TO QSPB-INSRATE-3-9.
           MOVE SPB-INSTERM(3 10) TO QSPB-INSTERM-3-10.
           MOVE SPB-INSRATE(3 10) TO QSPB-INSRATE-3-10.
           MOVE SPB-INSTERM(3 11) TO QSPB-INSTERM-3-11.
           MOVE SPB-INSRATE(3 11) TO QSPB-INSRATE-3-11.
           MOVE SPB-INSTERM(3 12) TO QSPB-INSTERM-3-12.
           MOVE SPB-INSRATE(3 12) TO QSPB-INSRATE-3-12.
           MOVE SPB-INSTERM(3 13) TO QSPB-INSTERM-3-13.
           MOVE SPB-INSRATE(3 13) TO QSPB-INSRATE-3-13.
           MOVE SPB-INSTERM(3 14) TO QSPB-INSTERM-3-14.
           MOVE SPB-INSRATE(3 14) TO QSPB-INSRATE-3-14.
           MOVE SPB-INSTERM(3 15) TO QSPB-INSTERM-3-15.
           MOVE SPB-INSRATE(3 15) TO QSPB-INSRATE-3-15.
           MOVE SPB-INSTERM(3 16) TO QSPB-INSTERM-3-16.
           MOVE SPB-INSRATE(3 16) TO QSPB-INSRATE-3-16.
           MOVE SPB-INSTERM(3 17) TO QSPB-INSTERM-3-17.
           MOVE SPB-INSRATE(3 17) TO QSPB-INSRATE-3-17.
           MOVE SPB-INSTERM(3 18) TO QSPB-INSTERM-3-18.
           MOVE SPB-INSRATE(3 18) TO QSPB-INSRATE-3-18.
           MOVE SPB-INSTERM(3 19) TO QSPB-INSTERM-3-19.
           MOVE SPB-INSRATE(3 19) TO QSPB-INSRATE-3-19.
           MOVE SPB-INSTERM(3 20) TO QSPB-INSTERM-3-20.
           MOVE SPB-INSRATE(3 20) TO QSPB-INSRATE-3-20.
           MOVE SPB-INSMINPREM(3) TO QSPB-INSMINPREM-3.
           MOVE SPB-INSMINCHGABL(3) TO QSPB-INSMINCHGABL-3.
           MOVE SPB-INSMAXCHGABL(3) TO QSPB-INSMAXCHGABL-3.
           MOVE SPB-INSMAXBENIF(3) TO QSPB-INSMAXBENIF-3.
           MOVE SPB-INSMAXTERM(3) TO QSPB-INSMAXTERM-3.
           MOVE SPB-INSCHGBEN(3) TO QSPB-INSCHGBEN-3.
           MOVE SPB-INSEXCEPT(3) TO QSPB-INSEXCEPT-3.
           MOVE SPB-INSNOVER(3) TO QSPB-INSNOVER-3.
           MOVE SPB-INSMINAGE(3 1) TO QSPB-INSMINAGE-3-1.
           MOVE SPB-INSMAXAGE(3 1) TO QSPB-INSMAXAGE-3-1.
           MOVE SPB-INSMAXCOV(3 1) TO QSPB-INSMAXCOV-3-1.
           MOVE SPB-INSMAXTRM(3 1) TO QSPB-INSMAXTRM-3-1.
           MOVE SPB-INSMINAGE(3 2) TO QSPB-INSMINAGE-3-2.
           MOVE SPB-INSMAXAGE(3 2) TO QSPB-INSMAXAGE-3-2.
           MOVE SPB-INSMAXCOV(3 2) TO QSPB-INSMAXCOV-3-2.
           MOVE SPB-INSMAXTRM(3 2) TO QSPB-INSMAXTRM-3-2.
           MOVE SPB-INSMINAGE(3 3) TO QSPB-INSMINAGE-3-3.
           MOVE SPB-INSMAXAGE(3 3) TO QSPB-INSMAXAGE-3-3.
           MOVE SPB-INSMAXCOV(3 3) TO QSPB-INSMAXCOV-3-3.
           MOVE SPB-INSMAXTRM(3 3) TO QSPB-INSMAXTRM-3-3.
           MOVE SPB-INSMINAGE(3 4) TO QSPB-INSMINAGE-3-4.
           MOVE SPB-INSMAXAGE(3 4) TO QSPB-INSMAXAGE-3-4.
           MOVE SPB-INSMAXCOV(3 4) TO QSPB-INSMAXCOV-3-4.
           MOVE SPB-INSMAXTRM(3 4) TO QSPB-INSMAXTRM-3-4.
           MOVE SPB-INSMINAGE(3 5) TO QSPB-INSMINAGE-3-5.
           MOVE SPB-INSMAXAGE(3 5) TO QSPB-INSMAXAGE-3-5.
           MOVE SPB-INSMAXCOV(3 5) TO QSPB-INSMAXCOV-3-5.
           MOVE SPB-INSMAXTRM(3 5) TO QSPB-INSMAXTRM-3-5.
           MOVE SPB-INSFEECD(3) TO QSPB-INSFEECD-3.
           MOVE SPB-INSFEE-FRMLA(3) TO QSPB-INSFEE-FRMLA-3.
           MOVE SPB-INSCHGABL-FG(3) TO QSPB-INSCHGABL-FG-3.
           MOVE SPB-INSREJECT-FG(3) TO QSPB-INSREJECT-FG-3.
           MOVE SPB-INSFINCHG(3) TO QSPB-INSFINCHG-3.
           MOVE SPB-INSCOM(4) TO QSPB-INSCOM-4.
           MOVE SPB-INSRATECD(4) TO QSPB-INSRATECD-4.
           MOVE SPB-INSJFAC(4) TO QSPB-INSJFAC-4.
           MOVE SPB-INSDISCNT(4) TO QSPB-INSDISCNT-4.
           MOVE SPB-INSCHGABL(4) TO QSPB-INSCHGABL-4.
           MOVE SPB-INSTERM(4 1) TO QSPB-INSTERM-4-1.
           MOVE SPB-INSRATE(4 1) TO QSPB-INSRATE-4-1.
           MOVE SPB-INSTERM(4 2) TO QSPB-INSTERM-4-2.
           MOVE SPB-INSRATE(4 2) TO QSPB-INSRATE-4-2.
           MOVE SPB-INSTERM(4 3) TO QSPB-INSTERM-4-3.
           MOVE SPB-INSRATE(4 3) TO QSPB-INSRATE-4-3.
           MOVE SPB-INSTERM(4 4) TO QSPB-INSTERM-4-4.
           MOVE SPB-INSRATE(4 4) TO QSPB-INSRATE-4-4.
           MOVE SPB-INSTERM(4 5) TO QSPB-INSTERM-4-5.
           MOVE SPB-INSRATE(4 5) TO QSPB-INSRATE-4-5.
           MOVE SPB-INSTERM(4 6) TO QSPB-INSTERM-4-6.
           MOVE SPB-INSRATE(4 6) TO QSPB-INSRATE-4-6.
           MOVE SPB-INSTERM(4 7) TO QSPB-INSTERM-4-7.
           MOVE SPB-INSRATE(4 7) TO QSPB-INSRATE-4-7.
           MOVE SPB-INSTERM(4 8) TO QSPB-INSTERM-4-8.
           MOVE SPB-INSRATE(4 8) TO QSPB-INSRATE-4-8.
           MOVE SPB-INSTERM(4 9) TO QSPB-INSTERM-4-9.
           MOVE SPB-INSRATE(4 9) TO QSPB-INSRATE-4-9.
           MOVE SPB-INSTERM(4 10) TO QSPB-INSTERM-4-10.
           MOVE SPB-INSRATE(4 10) TO QSPB-INSRATE-4-10.
           MOVE SPB-INSTERM(4 11) TO QSPB-INSTERM-4-11.
           MOVE SPB-INSRATE(4 11) TO QSPB-INSRATE-4-11.
           MOVE SPB-INSTERM(4 12) TO QSPB-INSTERM-4-12.
           MOVE SPB-INSRATE(4 12) TO QSPB-INSRATE-4-12.
           MOVE SPB-INSTERM(4 13) TO QSPB-INSTERM-4-13.
           MOVE SPB-INSRATE(4 13) TO QSPB-INSRATE-4-13.
           MOVE SPB-INSTERM(4 14) TO QSPB-INSTERM-4-14.
           MOVE SPB-INSRATE(4 14) TO QSPB-INSRATE-4-14.
           MOVE SPB-INSTERM(4 15) TO QSPB-INSTERM-4-15.
           MOVE SPB-INSRATE(4 15) TO QSPB-INSRATE-4-15.
           MOVE SPB-INSTERM(4 16) TO QSPB-INSTERM-4-16.
           MOVE SPB-INSRATE(4 16) TO QSPB-INSRATE-4-16.
           MOVE SPB-INSTERM(4 17) TO QSPB-INSTERM-4-17.
           MOVE SPB-INSRATE(4 17) TO QSPB-INSRATE-4-17.
           MOVE SPB-INSTERM(4 18) TO QSPB-INSTERM-4-18.
           MOVE SPB-INSRATE(4 18) TO QSPB-INSRATE-4-18.
           MOVE SPB-INSTERM(4 19) TO QSPB-INSTERM-4-19.
           MOVE SPB-INSRATE(4 19) TO QSPB-INSRATE-4-19.
           MOVE SPB-INSTERM(4 20) TO QSPB-INSTERM-4-20.
           MOVE SPB-INSRATE(4 20) TO QSPB-INSRATE-4-20.
           MOVE SPB-INSMINPREM(4) TO QSPB-INSMINPREM-4.
           MOVE SPB-INSMINCHGABL(4) TO QSPB-INSMINCHGABL-4.
           MOVE SPB-INSMAXCHGABL(4) TO QSPB-INSMAXCHGABL-4.
           MOVE SPB-INSMAXBENIF(4) TO QSPB-INSMAXBENIF-4.
           MOVE SPB-INSMAXTERM(4) TO QSPB-INSMAXTERM-4.
           MOVE SPB-INSCHGBEN(4) TO QSPB-INSCHGBEN-4.
           MOVE SPB-INSEXCEPT(4) TO QSPB-INSEXCEPT-4.
           MOVE SPB-INSNOVER(4) TO QSPB-INSNOVER-4.
           MOVE SPB-INSMINAGE(4 1) TO QSPB-INSMINAGE-4-1.
           MOVE SPB-INSMAXAGE(4 1) TO QSPB-INSMAXAGE-4-1.
           MOVE SPB-INSMAXCOV(4 1) TO QSPB-INSMAXCOV-4-1.
           MOVE SPB-INSMAXTRM(4 1) TO QSPB-INSMAXTRM-4-1.
           MOVE SPB-INSMINAGE(4 2) TO QSPB-INSMINAGE-4-2.
           MOVE SPB-INSMAXAGE(4 2) TO QSPB-INSMAXAGE-4-2.
           MOVE SPB-INSMAXCOV(4 2) TO QSPB-INSMAXCOV-4-2.
           MOVE SPB-INSMAXTRM(4 2) TO QSPB-INSMAXTRM-4-2.
           MOVE SPB-INSMINAGE(4 3) TO QSPB-INSMINAGE-4-3.
           MOVE SPB-INSMAXAGE(4 3) TO QSPB-INSMAXAGE-4-3.
           MOVE SPB-INSMAXCOV(4 3) TO QSPB-INSMAXCOV-4-3.
           MOVE SPB-INSMAXTRM(4 3) TO QSPB-INSMAXTRM-4-3.
           MOVE SPB-INSMINAGE(4 4) TO QSPB-INSMINAGE-4-4.
           MOVE SPB-INSMAXAGE(4 4) TO QSPB-INSMAXAGE-4-4.
           MOVE SPB-INSMAXCOV(4 4) TO QSPB-INSMAXCOV-4-4.
           MOVE SPB-INSMAXTRM(4 4) TO QSPB-INSMAXTRM-4-4.
           MOVE SPB-INSMINAGE(4 5) TO QSPB-INSMINAGE-4-5.
           MOVE SPB-INSMAXAGE(4 5) TO QSPB-INSMAXAGE-4-5.
           MOVE SPB-INSMAXCOV(4 5) TO QSPB-INSMAXCOV-4-5.
           MOVE SPB-INSMAXTRM(4 5) TO QSPB-INSMAXTRM-4-5.
           MOVE SPB-INSFEECD(4) TO QSPB-INSFEECD-4.
           MOVE SPB-INSFEE-FRMLA(4) TO QSPB-INSFEE-FRMLA-4.
           MOVE SPB-INSCHGABL-FG(4) TO QSPB-INSCHGABL-FG-4.
           MOVE SPB-INSREJECT-FG(4) TO QSPB-INSREJECT-FG-4.
           MOVE SPB-INSFINCHG(4) TO QSPB-INSFINCHG-4.
           MOVE SPB-INSCOM(5) TO QSPB-INSCOM-5.
           MOVE SPB-INSRATECD(5) TO QSPB-INSRATECD-5.
           MOVE SPB-INSJFAC(5) TO QSPB-INSJFAC-5.
           MOVE SPB-INSDISCNT(5) TO QSPB-INSDISCNT-5.
           MOVE SPB-INSCHGABL(5) TO QSPB-INSCHGABL-5.
           MOVE SPB-INSTERM(5 1) TO QSPB-INSTERM-5-1.
           MOVE SPB-INSRATE(5 1) TO QSPB-INSRATE-5-1.
           MOVE SPB-INSTERM(5 2) TO QSPB-INSTERM-5-2.
           MOVE SPB-INSRATE(5 2) TO QSPB-INSRATE-5-2.
           MOVE SPB-INSTERM(5 3) TO QSPB-INSTERM-5-3.
           MOVE SPB-INSRATE(5 3) TO QSPB-INSRATE-5-3.
           MOVE SPB-INSTERM(5 4) TO QSPB-INSTERM-5-4.
           MOVE SPB-INSRATE(5 4) TO QSPB-INSRATE-5-4.
           MOVE SPB-INSTERM(5 5) TO QSPB-INSTERM-5-5.
           MOVE SPB-INSRATE(5 5) TO QSPB-INSRATE-5-5.
           MOVE SPB-INSTERM(5 6) TO QSPB-INSTERM-5-6.
           MOVE SPB-INSRATE(5 6) TO QSPB-INSRATE-5-6.
           MOVE SPB-INSTERM(5 7) TO QSPB-INSTERM-5-7.
           MOVE SPB-INSRATE(5 7) TO QSPB-INSRATE-5-7.
           MOVE SPB-INSTERM(5 8) TO QSPB-INSTERM-5-8.
           MOVE SPB-INSRATE(5 8) TO QSPB-INSRATE-5-8.
           MOVE SPB-INSTERM(5 9) TO QSPB-INSTERM-5-9.
           MOVE SPB-INSRATE(5 9) TO QSPB-INSRATE-5-9.
           MOVE SPB-INSTERM(5 10) TO QSPB-INSTERM-5-10.
           MOVE SPB-INSRATE(5 10) TO QSPB-INSRATE-5-10.
           MOVE SPB-INSTERM(5 11) TO QSPB-INSTERM-5-11.
           MOVE SPB-INSRATE(5 11) TO QSPB-INSRATE-5-11.
           MOVE SPB-INSTERM(5 12) TO QSPB-INSTERM-5-12.
           MOVE SPB-INSRATE(5 12) TO QSPB-INSRATE-5-12.
           MOVE SPB-INSTERM(5 13) TO QSPB-INSTERM-5-13.
           MOVE SPB-INSRATE(5 13) TO QSPB-INSRATE-5-13.
           MOVE SPB-INSTERM(5 14) TO QSPB-INSTERM-5-14.
           MOVE SPB-INSRATE(5 14) TO QSPB-INSRATE-5-14.
           MOVE SPB-INSTERM(5 15) TO QSPB-INSTERM-5-15.
           MOVE SPB-INSRATE(5 15) TO QSPB-INSRATE-5-15.
           MOVE SPB-INSTERM(5 16) TO QSPB-INSTERM-5-16.
           MOVE SPB-INSRATE(5 16) TO QSPB-INSRATE-5-16.
           MOVE SPB-INSTERM(5 17) TO QSPB-INSTERM-5-17.
           MOVE SPB-INSRATE(5 17) TO QSPB-INSRATE-5-17.
           MOVE SPB-INSTERM(5 18) TO QSPB-INSTERM-5-18.
           MOVE SPB-INSRATE(5 18) TO QSPB-INSRATE-5-18.
           MOVE SPB-INSTERM(5 19) TO QSPB-INSTERM-5-19.
           MOVE SPB-INSRATE(5 19) TO QSPB-INSRATE-5-19.
           MOVE SPB-INSTERM(5 20) TO QSPB-INSTERM-5-20.
           MOVE SPB-INSRATE(5 20) TO QSPB-INSRATE-5-20.
           MOVE SPB-INSMINPREM(5) TO QSPB-INSMINPREM-5.
           MOVE SPB-INSMINCHGABL(5) TO QSPB-INSMINCHGABL-5.
           MOVE SPB-INSMAXCHGABL(5) TO QSPB-INSMAXCHGABL-5.
           MOVE SPB-INSMAXBENIF(5) TO QSPB-INSMAXBENIF-5.
           MOVE SPB-INSMAXTERM(5) TO QSPB-INSMAXTERM-5.
           MOVE SPB-INSCHGBEN(5) TO QSPB-INSCHGBEN-5.
           MOVE SPB-INSEXCEPT(5) TO QSPB-INSEXCEPT-5.
           MOVE SPB-INSNOVER(5) TO QSPB-INSNOVER-5.
           MOVE SPB-INSMINAGE(5 1) TO QSPB-INSMINAGE-5-1.
           MOVE SPB-INSMAXAGE(5 1) TO QSPB-INSMAXAGE-5-1.
           MOVE SPB-INSMAXCOV(5 1) TO QSPB-INSMAXCOV-5-1.
           MOVE SPB-INSMAXTRM(5 1) TO QSPB-INSMAXTRM-5-1.
           MOVE SPB-INSMINAGE(5 2) TO QSPB-INSMINAGE-5-2.
           MOVE SPB-INSMAXAGE(5 2) TO QSPB-INSMAXAGE-5-2.
           MOVE SPB-INSMAXCOV(5 2) TO QSPB-INSMAXCOV-5-2.
           MOVE SPB-INSMAXTRM(5 2) TO QSPB-INSMAXTRM-5-2.
           MOVE SPB-INSMINAGE(5 3) TO QSPB-INSMINAGE-5-3.
           MOVE SPB-INSMAXAGE(5 3) TO QSPB-INSMAXAGE-5-3.
           MOVE SPB-INSMAXCOV(5 3) TO QSPB-INSMAXCOV-5-3.
           MOVE SPB-INSMAXTRM(5 3) TO QSPB-INSMAXTRM-5-3.
           MOVE SPB-INSMINAGE(5 4) TO QSPB-INSMINAGE-5-4.
           MOVE SPB-INSMAXAGE(5 4) TO QSPB-INSMAXAGE-5-4.
           MOVE SPB-INSMAXCOV(5 4) TO QSPB-INSMAXCOV-5-4.
           MOVE SPB-INSMAXTRM(5 4) TO QSPB-INSMAXTRM-5-4.
           MOVE SPB-INSMINAGE(5 5) TO QSPB-INSMINAGE-5-5.
           MOVE SPB-INSMAXAGE(5 5) TO QSPB-INSMAXAGE-5-5.
           MOVE SPB-INSMAXCOV(5 5) TO QSPB-INSMAXCOV-5-5.
           MOVE SPB-INSMAXTRM(5 5) TO QSPB-INSMAXTRM-5-5.
           MOVE SPB-INSFEECD(5) TO QSPB-INSFEECD-5.
           MOVE SPB-INSFEE-FRMLA(5) TO QSPB-INSFEE-FRMLA-5.
           MOVE SPB-INSCHGABL-FG(5) TO QSPB-INSCHGABL-FG-5.
           MOVE SPB-INSREJECT-FG(5) TO QSPB-INSREJECT-FG-5.
           MOVE SPB-INSFINCHG(5) TO QSPB-INSFINCHG-5.
           MOVE SPB-INSCOM(6) TO QSPB-INSCOM-6.
           MOVE SPB-INSRATECD(6) TO QSPB-INSRATECD-6.
           MOVE SPB-INSJFAC(6) TO QSPB-INSJFAC-6.
           MOVE SPB-INSDISCNT(6) TO QSPB-INSDISCNT-6.
           MOVE SPB-INSCHGABL(6) TO QSPB-INSCHGABL-6.
           MOVE SPB-INSTERM(6 1) TO QSPB-INSTERM-6-1.
           MOVE SPB-INSRATE(6 1) TO QSPB-INSRATE-6-1.
           MOVE SPB-INSTERM(6 2) TO QSPB-INSTERM-6-2.
           MOVE SPB-INSRATE(6 2) TO QSPB-INSRATE-6-2.
           MOVE SPB-INSTERM(6 3) TO QSPB-INSTERM-6-3.
           MOVE SPB-INSRATE(6 3) TO QSPB-INSRATE-6-3.
           MOVE SPB-INSTERM(6 4) TO QSPB-INSTERM-6-4.
           MOVE SPB-INSRATE(6 4) TO QSPB-INSRATE-6-4.
           MOVE SPB-INSTERM(6 5) TO QSPB-INSTERM-6-5.
           MOVE SPB-INSRATE(6 5) TO QSPB-INSRATE-6-5.
           MOVE SPB-INSTERM(6 6) TO QSPB-INSTERM-6-6.
           MOVE SPB-INSRATE(6 6) TO QSPB-INSRATE-6-6.
           MOVE SPB-INSTERM(6 7) TO QSPB-INSTERM-6-7.
           MOVE SPB-INSRATE(6 7) TO QSPB-INSRATE-6-7.
           MOVE SPB-INSTERM(6 8) TO QSPB-INSTERM-6-8.
           MOVE SPB-INSRATE(6 8) TO QSPB-INSRATE-6-8.
           MOVE SPB-INSTERM(6 9) TO QSPB-INSTERM-6-9.
           MOVE SPB-INSRATE(6 9) TO QSPB-INSRATE-6-9.
           MOVE SPB-INSTERM(6 10) TO QSPB-INSTERM-6-10.
           MOVE SPB-INSRATE(6 10) TO QSPB-INSRATE-6-10.
           MOVE SPB-INSTERM(6 11) TO QSPB-INSTERM-6-11.
           MOVE SPB-INSRATE(6 11) TO QSPB-INSRATE-6-11.
           MOVE SPB-INSTERM(6 12) TO QSPB-INSTERM-6-12.
           MOVE SPB-INSRATE(6 12) TO QSPB-INSRATE-6-12.
           MOVE SPB-INSTERM(6 13) TO QSPB-INSTERM-6-13.
           MOVE SPB-INSRATE(6 13) TO QSPB-INSRATE-6-13.
           MOVE SPB-INSTERM(6 14) TO QSPB-INSTERM-6-14.
           MOVE SPB-INSRATE(6 14) TO QSPB-INSRATE-6-14.
           MOVE SPB-INSTERM(6 15) TO QSPB-INSTERM-6-15.
           MOVE SPB-INSRATE(6 15) TO QSPB-INSRATE-6-15.
           MOVE SPB-INSTERM(6 16) TO QSPB-INSTERM-6-16.
           MOVE SPB-INSRATE(6 16) TO QSPB-INSRATE-6-16.
           MOVE SPB-INSTERM(6 17) TO QSPB-INSTERM-6-17.
           MOVE SPB-INSRATE(6 17) TO QSPB-INSRATE-6-17.
           MOVE SPB-INSTERM(6 18) TO QSPB-INSTERM-6-18.
           MOVE SPB-INSRATE(6 18) TO QSPB-INSRATE-6-18.
           MOVE SPB-INSTERM(6 19) TO QSPB-INSTERM-6-19.
           MOVE SPB-INSRATE(6 19) TO QSPB-INSRATE-6-19.
           MOVE SPB-INSTERM(6 20) TO QSPB-INSTERM-6-20.
           MOVE SPB-INSRATE(6 20) TO QSPB-INSRATE-6-20.
           MOVE SPB-INSMINPREM(6) TO QSPB-INSMINPREM-6.
           MOVE SPB-INSMINCHGABL(6) TO QSPB-INSMINCHGABL-6.
           MOVE SPB-INSMAXCHGABL(6) TO QSPB-INSMAXCHGABL-6.
           MOVE SPB-INSMAXBENIF(6) TO QSPB-INSMAXBENIF-6.
           MOVE SPB-INSMAXTERM(6) TO QSPB-INSMAXTERM-6.
           MOVE SPB-INSCHGBEN(6) TO QSPB-INSCHGBEN-6.
           MOVE SPB-INSEXCEPT(6) TO QSPB-INSEXCEPT-6.
           MOVE SPB-INSNOVER(6) TO QSPB-INSNOVER-6.
           MOVE SPB-INSMINAGE(6 1) TO QSPB-INSMINAGE-6-1.
           MOVE SPB-INSMAXAGE(6 1) TO QSPB-INSMAXAGE-6-1.
           MOVE SPB-INSMAXCOV(6 1) TO QSPB-INSMAXCOV-6-1.
           MOVE SPB-INSMAXTRM(6 1) TO QSPB-INSMAXTRM-6-1.
           MOVE SPB-INSMINAGE(6 2) TO QSPB-INSMINAGE-6-2.
           MOVE SPB-INSMAXAGE(6 2) TO QSPB-INSMAXAGE-6-2.
           MOVE SPB-INSMAXCOV(6 2) TO QSPB-INSMAXCOV-6-2.
           MOVE SPB-INSMAXTRM(6 2) TO QSPB-INSMAXTRM-6-2.
           MOVE SPB-INSMINAGE(6 3) TO QSPB-INSMINAGE-6-3.
           MOVE SPB-INSMAXAGE(6 3) TO QSPB-INSMAXAGE-6-3.
           MOVE SPB-INSMAXCOV(6 3) TO QSPB-INSMAXCOV-6-3.
           MOVE SPB-INSMAXTRM(6 3) TO QSPB-INSMAXTRM-6-3.
           MOVE SPB-INSMINAGE(6 4) TO QSPB-INSMINAGE-6-4.
           MOVE SPB-INSMAXAGE(6 4) TO QSPB-INSMAXAGE-6-4.
           MOVE SPB-INSMAXCOV(6 4) TO QSPB-INSMAXCOV-6-4.
           MOVE SPB-INSMAXTRM(6 4) TO QSPB-INSMAXTRM-6-4.
           MOVE SPB-INSMINAGE(6 5) TO QSPB-INSMINAGE-6-5.
           MOVE SPB-INSMAXAGE(6 5) TO QSPB-INSMAXAGE-6-5.
           MOVE SPB-INSMAXCOV(6 5) TO QSPB-INSMAXCOV-6-5.
           MOVE SPB-INSMAXTRM(6 5) TO QSPB-INSMAXTRM-6-5.
           MOVE SPB-INSFEECD(6) TO QSPB-INSFEECD-6.
           MOVE SPB-INSFEE-FRMLA(6) TO QSPB-INSFEE-FRMLA-6.
           MOVE SPB-INSCHGABL-FG(6) TO QSPB-INSCHGABL-FG-6.
           MOVE SPB-INSREJECT-FG(6) TO QSPB-INSREJECT-FG-6.
           MOVE SPB-INSFINCHG(6) TO QSPB-INSFINCHG-6.
           MOVE SPB-INSCOM(7) TO QSPB-INSCOM-7.
           MOVE SPB-INSRATECD(7) TO QSPB-INSRATECD-7.
           MOVE SPB-INSJFAC(7) TO QSPB-INSJFAC-7.
           MOVE SPB-INSDISCNT(7) TO QSPB-INSDISCNT-7.
           MOVE SPB-INSCHGABL(7) TO QSPB-INSCHGABL-7.
           MOVE SPB-INSTERM(7 1) TO QSPB-INSTERM-7-1.
           MOVE SPB-INSRATE(7 1) TO QSPB-INSRATE-7-1.
           MOVE SPB-INSTERM(7 2) TO QSPB-INSTERM-7-2.
           MOVE SPB-INSRATE(7 2) TO QSPB-INSRATE-7-2.
           MOVE SPB-INSTERM(7 3) TO QSPB-INSTERM-7-3.
           MOVE SPB-INSRATE(7 3) TO QSPB-INSRATE-7-3.
           MOVE SPB-INSTERM(7 4) TO QSPB-INSTERM-7-4.
           MOVE SPB-INSRATE(7 4) TO QSPB-INSRATE-7-4.
           MOVE SPB-INSTERM(7 5) TO QSPB-INSTERM-7-5.
           MOVE SPB-INSRATE(7 5) TO QSPB-INSRATE-7-5.
           MOVE SPB-INSTERM(7 6) TO QSPB-INSTERM-7-6.
           MOVE SPB-INSRATE(7 6) TO QSPB-INSRATE-7-6.
           MOVE SPB-INSTERM(7 7) TO QSPB-INSTERM-7-7.
           MOVE SPB-INSRATE(7 7) TO QSPB-INSRATE-7-7.
           MOVE SPB-INSTERM(7 8) TO QSPB-INSTERM-7-8.
           MOVE SPB-INSRATE(7 8) TO QSPB-INSRATE-7-8.
           MOVE SPB-INSTERM(7 9) TO QSPB-INSTERM-7-9.
           MOVE SPB-INSRATE(7 9) TO QSPB-INSRATE-7-9.
           MOVE SPB-INSTERM(7 10) TO QSPB-INSTERM-7-10.
           MOVE SPB-INSRATE(7 10) TO QSPB-INSRATE-7-10.
           MOVE SPB-INSTERM(7 11) TO QSPB-INSTERM-7-11.
           MOVE SPB-INSRATE(7 11) TO QSPB-INSRATE-7-11.
           MOVE SPB-INSTERM(7 12) TO QSPB-INSTERM-7-12.
           MOVE SPB-INSRATE(7 12) TO QSPB-INSRATE-7-12.
           MOVE SPB-INSTERM(7 13) TO QSPB-INSTERM-7-13.
           MOVE SPB-INSRATE(7 13) TO QSPB-INSRATE-7-13.
           MOVE SPB-INSTERM(7 14) TO QSPB-INSTERM-7-14.
           MOVE SPB-INSRATE(7 14) TO QSPB-INSRATE-7-14.
           MOVE SPB-INSTERM(7 15) TO QSPB-INSTERM-7-15.
           MOVE SPB-INSRATE(7 15) TO QSPB-INSRATE-7-15.
           MOVE SPB-INSTERM(7 16) TO QSPB-INSTERM-7-16.
           MOVE SPB-INSRATE(7 16) TO QSPB-INSRATE-7-16.
           MOVE SPB-INSTERM(7 17) TO QSPB-INSTERM-7-17.
           MOVE SPB-INSRATE(7 17) TO QSPB-INSRATE-7-17.
           MOVE SPB-INSTERM(7 18) TO QSPB-INSTERM-7-18.
           MOVE SPB-INSRATE(7 18) TO QSPB-INSRATE-7-18.
           MOVE SPB-INSTERM(7 19) TO QSPB-INSTERM-7-19.
           MOVE SPB-INSRATE(7 19) TO QSPB-INSRATE-7-19.
           MOVE SPB-INSTERM(7 20) TO QSPB-INSTERM-7-20.
           MOVE SPB-INSRATE(7 20) TO QSPB-INSRATE-7-20.
           MOVE SPB-INSMINPREM(7) TO QSPB-INSMINPREM-7.
           MOVE SPB-INSMINCHGABL(7) TO QSPB-INSMINCHGABL-7.
           MOVE SPB-INSMAXCHGABL(7) TO QSPB-INSMAXCHGABL-7.
           MOVE SPB-INSMAXBENIF(7) TO QSPB-INSMAXBENIF-7.
           MOVE SPB-INSMAXTERM(7) TO QSPB-INSMAXTERM-7.
           MOVE SPB-INSCHGBEN(7) TO QSPB-INSCHGBEN-7.
           MOVE SPB-INSEXCEPT(7) TO QSPB-INSEXCEPT-7.
           MOVE SPB-INSNOVER(7) TO QSPB-INSNOVER-7.
           MOVE SPB-INSMINAGE(7 1) TO QSPB-INSMINAGE-7-1.
           MOVE SPB-INSMAXAGE(7 1) TO QSPB-INSMAXAGE-7-1.
           MOVE SPB-INSMAXCOV(7 1) TO QSPB-INSMAXCOV-7-1.
           MOVE SPB-INSMAXTRM(7 1) TO QSPB-INSMAXTRM-7-1.
           MOVE SPB-INSMINAGE(7 2) TO QSPB-INSMINAGE-7-2.
           MOVE SPB-INSMAXAGE(7 2) TO QSPB-INSMAXAGE-7-2.
           MOVE SPB-INSMAXCOV(7 2) TO QSPB-INSMAXCOV-7-2.
           MOVE SPB-INSMAXTRM(7 2) TO QSPB-INSMAXTRM-7-2.
           MOVE SPB-INSMINAGE(7 3) TO QSPB-INSMINAGE-7-3.
           MOVE SPB-INSMAXAGE(7 3) TO QSPB-INSMAXAGE-7-3.
           MOVE SPB-INSMAXCOV(7 3) TO QSPB-INSMAXCOV-7-3.
           MOVE SPB-INSMAXTRM(7 3) TO QSPB-INSMAXTRM-7-3.
           MOVE SPB-INSMINAGE(7 4) TO QSPB-INSMINAGE-7-4.
           MOVE SPB-INSMAXAGE(7 4) TO QSPB-INSMAXAGE-7-4.
           MOVE SPB-INSMAXCOV(7 4) TO QSPB-INSMAXCOV-7-4.
           MOVE SPB-INSMAXTRM(7 4) TO QSPB-INSMAXTRM-7-4.
           MOVE SPB-INSMINAGE(7 5) TO QSPB-INSMINAGE-7-5.
           MOVE SPB-INSMAXAGE(7 5) TO QSPB-INSMAXAGE-7-5.
           MOVE SPB-INSMAXCOV(7 5) TO QSPB-INSMAXCOV-7-5.
           MOVE SPB-INSMAXTRM(7 5) TO QSPB-INSMAXTRM-7-5.
           MOVE SPB-INSFEECD(7) TO QSPB-INSFEECD-7.
           MOVE SPB-INSFEE-FRMLA(7) TO QSPB-INSFEE-FRMLA-7.
           MOVE SPB-INSCHGABL-FG(7) TO QSPB-INSCHGABL-FG-7.
           MOVE SPB-INSREJECT-FG(7) TO QSPB-INSREJECT-FG-7.
           MOVE SPB-INSFINCHG(7) TO QSPB-INSFINCHG-7.
           MOVE SPB-INSCOM(8) TO QSPB-INSCOM-8.
           MOVE SPB-INSRATECD(8) TO QSPB-INSRATECD-8.
           MOVE SPB-INSJFAC(8) TO QSPB-INSJFAC-8.
           MOVE SPB-INSDISCNT(8) TO QSPB-INSDISCNT-8.
           MOVE SPB-INSCHGABL(8) TO QSPB-INSCHGABL-8.
           MOVE SPB-INSTERM(8 1) TO QSPB-INSTERM-8-1.
           MOVE SPB-INSRATE(8 1) TO QSPB-INSRATE-8-1.
           MOVE SPB-INSTERM(8 2) TO QSPB-INSTERM-8-2.
           MOVE SPB-INSRATE(8 2) TO QSPB-INSRATE-8-2.
           MOVE SPB-INSTERM(8 3) TO QSPB-INSTERM-8-3.
           MOVE SPB-INSRATE(8 3) TO QSPB-INSRATE-8-3.
           MOVE SPB-INSTERM(8 4) TO QSPB-INSTERM-8-4.
           MOVE SPB-INSRATE(8 4) TO QSPB-INSRATE-8-4.
           MOVE SPB-INSTERM(8 5) TO QSPB-INSTERM-8-5.
           MOVE SPB-INSRATE(8 5) TO QSPB-INSRATE-8-5.
           MOVE SPB-INSTERM(8 6) TO QSPB-INSTERM-8-6.
           MOVE SPB-INSRATE(8 6) TO QSPB-INSRATE-8-6.
           MOVE SPB-INSTERM(8 7) TO QSPB-INSTERM-8-7.
           MOVE SPB-INSRATE(8 7) TO QSPB-INSRATE-8-7.
           MOVE SPB-INSTERM(8 8) TO QSPB-INSTERM-8-8.
           MOVE SPB-INSRATE(8 8) TO QSPB-INSRATE-8-8.
           MOVE SPB-INSTERM(8 9) TO QSPB-INSTERM-8-9.
           MOVE SPB-INSRATE(8 9) TO QSPB-INSRATE-8-9.
           MOVE SPB-INSTERM(8 10) TO QSPB-INSTERM-8-10.
           MOVE SPB-INSRATE(8 10) TO QSPB-INSRATE-8-10.
           MOVE SPB-INSTERM(8 11) TO QSPB-INSTERM-8-11.
           MOVE SPB-INSRATE(8 11) TO QSPB-INSRATE-8-11.
           MOVE SPB-INSTERM(8 12) TO QSPB-INSTERM-8-12.
           MOVE SPB-INSRATE(8 12) TO QSPB-INSRATE-8-12.
           MOVE SPB-INSTERM(8 13) TO QSPB-INSTERM-8-13.
           MOVE SPB-INSRATE(8 13) TO QSPB-INSRATE-8-13.
           MOVE SPB-INSTERM(8 14) TO QSPB-INSTERM-8-14.
           MOVE SPB-INSRATE(8 14) TO QSPB-INSRATE-8-14.
           MOVE SPB-INSTERM(8 15) TO QSPB-INSTERM-8-15.
           MOVE SPB-INSRATE(8 15) TO QSPB-INSRATE-8-15.
           MOVE SPB-INSTERM(8 16) TO QSPB-INSTERM-8-16.
           MOVE SPB-INSRATE(8 16) TO QSPB-INSRATE-8-16.
           MOVE SPB-INSTERM(8 17) TO QSPB-INSTERM-8-17.
           MOVE SPB-INSRATE(8 17) TO QSPB-INSRATE-8-17.
           MOVE SPB-INSTERM(8 18) TO QSPB-INSTERM-8-18.
           MOVE SPB-INSRATE(8 18) TO QSPB-INSRATE-8-18.
           MOVE SPB-INSTERM(8 19) TO QSPB-INSTERM-8-19.
           MOVE SPB-INSRATE(8 19) TO QSPB-INSRATE-8-19.
           MOVE SPB-INSTERM(8 20) TO QSPB-INSTERM-8-20.
           MOVE SPB-INSRATE(8 20) TO QSPB-INSRATE-8-20.
           MOVE SPB-INSMINPREM(8) TO QSPB-INSMINPREM-8.
           MOVE SPB-INSMINCHGABL(8) TO QSPB-INSMINCHGABL-8.
           MOVE SPB-INSMAXCHGABL(8) TO QSPB-INSMAXCHGABL-8.
           MOVE SPB-INSMAXBENIF(8) TO QSPB-INSMAXBENIF-8.
           MOVE SPB-INSMAXTERM(8) TO QSPB-INSMAXTERM-8.
           MOVE SPB-INSCHGBEN(8) TO QSPB-INSCHGBEN-8.
           MOVE SPB-INSEXCEPT(8) TO QSPB-INSEXCEPT-8.
           MOVE SPB-INSNOVER(8) TO QSPB-INSNOVER-8.
           MOVE SPB-INSMINAGE(8 1) TO QSPB-INSMINAGE-8-1.
           MOVE SPB-INSMAXAGE(8 1) TO QSPB-INSMAXAGE-8-1.
           MOVE SPB-INSMAXCOV(8 1) TO QSPB-INSMAXCOV-8-1.
           MOVE SPB-INSMAXTRM(8 1) TO QSPB-INSMAXTRM-8-1.
           MOVE SPB-INSMINAGE(8 2) TO QSPB-INSMINAGE-8-2.
           MOVE SPB-INSMAXAGE(8 2) TO QSPB-INSMAXAGE-8-2.
           MOVE SPB-INSMAXCOV(8 2) TO QSPB-INSMAXCOV-8-2.
           MOVE SPB-INSMAXTRM(8 2) TO QSPB-INSMAXTRM-8-2.
           MOVE SPB-INSMINAGE(8 3) TO QSPB-INSMINAGE-8-3.
           MOVE SPB-INSMAXAGE(8 3) TO QSPB-INSMAXAGE-8-3.
           MOVE SPB-INSMAXCOV(8 3) TO QSPB-INSMAXCOV-8-3.
           MOVE SPB-INSMAXTRM(8 3) TO QSPB-INSMAXTRM-8-3.
           MOVE SPB-INSMINAGE(8 4) TO QSPB-INSMINAGE-8-4.
           MOVE SPB-INSMAXAGE(8 4) TO QSPB-INSMAXAGE-8-4.
           MOVE SPB-INSMAXCOV(8 4) TO QSPB-INSMAXCOV-8-4.
           MOVE SPB-INSMAXTRM(8 4) TO QSPB-INSMAXTRM-8-4.
           MOVE SPB-INSMINAGE(8 5) TO QSPB-INSMINAGE-8-5.
           MOVE SPB-INSMAXAGE(8 5) TO QSPB-INSMAXAGE-8-5.
           MOVE SPB-INSMAXCOV(8 5) TO QSPB-INSMAXCOV-8-5.
           MOVE SPB-INSMAXTRM(8 5) TO QSPB-INSMAXTRM-8-5.
           MOVE SPB-INSFEECD(8) TO QSPB-INSFEECD-8.
           MOVE SPB-INSFEE-FRMLA(8) TO QSPB-INSFEE-FRMLA-8.
           MOVE SPB-INSCHGABL-FG(8) TO QSPB-INSCHGABL-FG-8.
           MOVE SPB-INSREJECT-FG(8) TO QSPB-INSREJECT-FG-8.
           MOVE SPB-INSFINCHG(8) TO QSPB-INSFINCHG-8.
           MOVE SPB-INSCOM(9) TO QSPB-INSCOM-9.
           MOVE SPB-INSRATECD(9) TO QSPB-INSRATECD-9.
           MOVE SPB-INSJFAC(9) TO QSPB-INSJFAC-9.
           MOVE SPB-INSDISCNT(9) TO QSPB-INSDISCNT-9.
           MOVE SPB-INSCHGABL(9) TO QSPB-INSCHGABL-9.
           MOVE SPB-INSTERM(9 1) TO QSPB-INSTERM-9-1.
           MOVE SPB-INSRATE(9 1) TO QSPB-INSRATE-9-1.
           MOVE SPB-INSTERM(9 2) TO QSPB-INSTERM-9-2.
           MOVE SPB-INSRATE(9 2) TO QSPB-INSRATE-9-2.
           MOVE SPB-INSTERM(9 3) TO QSPB-INSTERM-9-3.
           MOVE SPB-INSRATE(9 3) TO QSPB-INSRATE-9-3.
           MOVE SPB-INSTERM(9 4) TO QSPB-INSTERM-9-4.
           MOVE SPB-INSRATE(9 4) TO QSPB-INSRATE-9-4.
           MOVE SPB-INSTERM(9 5) TO QSPB-INSTERM-9-5.
           MOVE SPB-INSRATE(9 5) TO QSPB-INSRATE-9-5.
           MOVE SPB-INSTERM(9 6) TO QSPB-INSTERM-9-6.
           MOVE SPB-INSRATE(9 6) TO QSPB-INSRATE-9-6.
           MOVE SPB-INSTERM(9 7) TO QSPB-INSTERM-9-7.
           MOVE SPB-INSRATE(9 7) TO QSPB-INSRATE-9-7.
           MOVE SPB-INSTERM(9 8) TO QSPB-INSTERM-9-8.
           MOVE SPB-INSRATE(9 8) TO QSPB-INSRATE-9-8.
           MOVE SPB-INSTERM(9 9) TO QSPB-INSTERM-9-9.
           MOVE SPB-INSRATE(9 9) TO QSPB-INSRATE-9-9.
           MOVE SPB-INSTERM(9 10) TO QSPB-INSTERM-9-10.
           MOVE SPB-INSRATE(9 10) TO QSPB-INSRATE-9-10.
           MOVE SPB-INSTERM(9 11) TO QSPB-INSTERM-9-11.
           MOVE SPB-INSRATE(9 11) TO QSPB-INSRATE-9-11.
           MOVE SPB-INSTERM(9 12) TO QSPB-INSTERM-9-12.
           MOVE SPB-INSRATE(9 12) TO QSPB-INSRATE-9-12.
           MOVE SPB-INSTERM(9 13) TO QSPB-INSTERM-9-13.
           MOVE SPB-INSRATE(9 13) TO QSPB-INSRATE-9-13.
           MOVE SPB-INSTERM(9 14) TO QSPB-INSTERM-9-14.
           MOVE SPB-INSRATE(9 14) TO QSPB-INSRATE-9-14.
           MOVE SPB-INSTERM(9 15) TO QSPB-INSTERM-9-15.
           MOVE SPB-INSRATE(9 15) TO QSPB-INSRATE-9-15.
           MOVE SPB-INSTERM(9 16) TO QSPB-INSTERM-9-16.
           MOVE SPB-INSRATE(9 16) TO QSPB-INSRATE-9-16.
           MOVE SPB-INSTERM(9 17) TO QSPB-INSTERM-9-17.
           MOVE SPB-INSRATE(9 17) TO QSPB-INSRATE-9-17.
           MOVE SPB-INSTERM(9 18) TO QSPB-INSTERM-9-18.
           MOVE SPB-INSRATE(9 18) TO QSPB-INSRATE-9-18.
           MOVE SPB-INSTERM(9 19) TO QSPB-INSTERM-9-19.
           MOVE SPB-INSRATE(9 19) TO QSPB-INSRATE-9-19.
           MOVE SPB-INSTERM(9 20) TO QSPB-INSTERM-9-20.
           MOVE SPB-INSRATE(9 20) TO QSPB-INSRATE-9-20.
           MOVE SPB-INSMINPREM(9) TO QSPB-INSMINPREM-9.
           MOVE SPB-INSMINCHGABL(9) TO QSPB-INSMINCHGABL-9.
           MOVE SPB-INSMAXCHGABL(9) TO QSPB-INSMAXCHGABL-9.
           MOVE SPB-INSMAXBENIF(9) TO QSPB-INSMAXBENIF-9.
           MOVE SPB-INSMAXTERM(9) TO QSPB-INSMAXTERM-9.
           MOVE SPB-INSCHGBEN(9) TO QSPB-INSCHGBEN-9.
           MOVE SPB-INSEXCEPT(9) TO QSPB-INSEXCEPT-9.
           MOVE SPB-INSNOVER(9) TO QSPB-INSNOVER-9.
           MOVE SPB-INSMINAGE(9 1) TO QSPB-INSMINAGE-9-1.
           MOVE SPB-INSMAXAGE(9 1) TO QSPB-INSMAXAGE-9-1.
           MOVE SPB-INSMAXCOV(9 1) TO QSPB-INSMAXCOV-9-1.
           MOVE SPB-INSMAXTRM(9 1) TO QSPB-INSMAXTRM-9-1.
           MOVE SPB-INSMINAGE(9 2) TO QSPB-INSMINAGE-9-2.
           MOVE SPB-INSMAXAGE(9 2) TO QSPB-INSMAXAGE-9-2.
           MOVE SPB-INSMAXCOV(9 2) TO QSPB-INSMAXCOV-9-2.
           MOVE SPB-INSMAXTRM(9 2) TO QSPB-INSMAXTRM-9-2.
           MOVE SPB-INSMINAGE(9 3) TO QSPB-INSMINAGE-9-3.
           MOVE SPB-INSMAXAGE(9 3) TO QSPB-INSMAXAGE-9-3.
           MOVE SPB-INSMAXCOV(9 3) TO QSPB-INSMAXCOV-9-3.
           MOVE SPB-INSMAXTRM(9 3) TO QSPB-INSMAXTRM-9-3.
           MOVE SPB-INSMINAGE(9 4) TO QSPB-INSMINAGE-9-4.
           MOVE SPB-INSMAXAGE(9 4) TO QSPB-INSMAXAGE-9-4.
           MOVE SPB-INSMAXCOV(9 4) TO QSPB-INSMAXCOV-9-4.
           MOVE SPB-INSMAXTRM(9 4) TO QSPB-INSMAXTRM-9-4.
           MOVE SPB-INSMINAGE(9 5) TO QSPB-INSMINAGE-9-5.
           MOVE SPB-INSMAXAGE(9 5) TO QSPB-INSMAXAGE-9-5.
           MOVE SPB-INSMAXCOV(9 5) TO QSPB-INSMAXCOV-9-5.
           MOVE SPB-INSMAXTRM(9 5) TO QSPB-INSMAXTRM-9-5.
           MOVE SPB-INSFEECD(9) TO QSPB-INSFEECD-9.
           MOVE SPB-INSFEE-FRMLA(9) TO QSPB-INSFEE-FRMLA-9.
           MOVE SPB-INSCHGABL-FG(9) TO QSPB-INSCHGABL-FG-9.
           MOVE SPB-INSREJECT-FG(9) TO QSPB-INSREJECT-FG-9.
           MOVE SPB-INSFINCHG(9) TO QSPB-INSFINCHG-9.
           MOVE SPB-INSCOM(10) TO QSPB-INSCOM-10.
           MOVE SPB-INSRATECD(10) TO QSPB-INSRATECD-10.
           MOVE SPB-INSJFAC(10) TO QSPB-INSJFAC-10.
           MOVE SPB-INSDISCNT(10) TO QSPB-INSDISCNT-10.
           MOVE SPB-INSCHGABL(10) TO QSPB-INSCHGABL-10.
           MOVE SPB-INSTERM(10 1) TO QSPB-INSTERM-10-1.
           MOVE SPB-INSRATE(10 1) TO QSPB-INSRATE-10-1.
           MOVE SPB-INSTERM(10 2) TO QSPB-INSTERM-10-2.
           MOVE SPB-INSRATE(10 2) TO QSPB-INSRATE-10-2.
           MOVE SPB-INSTERM(10 3) TO QSPB-INSTERM-10-3.
           MOVE SPB-INSRATE(10 3) TO QSPB-INSRATE-10-3.
           MOVE SPB-INSTERM(10 4) TO QSPB-INSTERM-10-4.
           MOVE SPB-INSRATE(10 4) TO QSPB-INSRATE-10-4.
           MOVE SPB-INSTERM(10 5) TO QSPB-INSTERM-10-5.
           MOVE SPB-INSRATE(10 5) TO QSPB-INSRATE-10-5.
           MOVE SPB-INSTERM(10 6) TO QSPB-INSTERM-10-6.
           MOVE SPB-INSRATE(10 6) TO QSPB-INSRATE-10-6.
           MOVE SPB-INSTERM(10 7) TO QSPB-INSTERM-10-7.
           MOVE SPB-INSRATE(10 7) TO QSPB-INSRATE-10-7.
           MOVE SPB-INSTERM(10 8) TO QSPB-INSTERM-10-8.
           MOVE SPB-INSRATE(10 8) TO QSPB-INSRATE-10-8.
           MOVE SPB-INSTERM(10 9) TO QSPB-INSTERM-10-9.
           MOVE SPB-INSRATE(10 9) TO QSPB-INSRATE-10-9.
           MOVE SPB-INSTERM(10 10) TO QSPB-INSTERM-10-10.
           MOVE SPB-INSRATE(10 10) TO QSPB-INSRATE-10-10.
           MOVE SPB-INSTERM(10 11) TO QSPB-INSTERM-10-11.
           MOVE SPB-INSRATE(10 11) TO QSPB-INSRATE-10-11.
           MOVE SPB-INSTERM(10 12) TO QSPB-INSTERM-10-12.
           MOVE SPB-INSRATE(10 12) TO QSPB-INSRATE-10-12.
           MOVE SPB-INSTERM(10 13) TO QSPB-INSTERM-10-13.
           MOVE SPB-INSRATE(10 13) TO QSPB-INSRATE-10-13.
           MOVE SPB-INSTERM(10 14) TO QSPB-INSTERM-10-14.
           MOVE SPB-INSRATE(10 14) TO QSPB-INSRATE-10-14.
           MOVE SPB-INSTERM(10 15) TO QSPB-INSTERM-10-15.
           MOVE SPB-INSRATE(10 15) TO QSPB-INSRATE-10-15.
           MOVE SPB-INSTERM(10 16) TO QSPB-INSTERM-10-16.
           MOVE SPB-INSRATE(10 16) TO QSPB-INSRATE-10-16.
           MOVE SPB-INSTERM(10 17) TO QSPB-INSTERM-10-17.
           MOVE SPB-INSRATE(10 17) TO QSPB-INSRATE-10-17.
           MOVE SPB-INSTERM(10 18) TO QSPB-INSTERM-10-18.
           MOVE SPB-INSRATE(10 18) TO QSPB-INSRATE-10-18.
           MOVE SPB-INSTERM(10 19) TO QSPB-INSTERM-10-19.
           MOVE SPB-INSRATE(10 19) TO QSPB-INSRATE-10-19.
           MOVE SPB-INSTERM(10 20) TO QSPB-INSTERM-10-20.
           MOVE SPB-INSRATE(10 20) TO QSPB-INSRATE-10-20.
           MOVE SPB-INSMINPREM(10) TO QSPB-INSMINPREM-10.
           MOVE SPB-INSMINCHGABL(10) TO QSPB-INSMINCHGABL-10.
           MOVE SPB-INSMAXCHGABL(10) TO QSPB-INSMAXCHGABL-10.
           MOVE SPB-INSMAXBENIF(10) TO QSPB-INSMAXBENIF-10.
           MOVE SPB-INSMAXTERM(10) TO QSPB-INSMAXTERM-10.
           MOVE SPB-INSCHGBEN(10) TO QSPB-INSCHGBEN-10.
           MOVE SPB-INSEXCEPT(10) TO QSPB-INSEXCEPT-10.
           MOVE SPB-INSNOVER(10) TO QSPB-INSNOVER-10.
           MOVE SPB-INSMINAGE(10 1) TO QSPB-INSMINAGE-10-1.
           MOVE SPB-INSMAXAGE(10 1) TO QSPB-INSMAXAGE-10-1.
           MOVE SPB-INSMAXCOV(10 1) TO QSPB-INSMAXCOV-10-1.
           MOVE SPB-INSMAXTRM(10 1) TO QSPB-INSMAXTRM-10-1.
           MOVE SPB-INSMINAGE(10 2) TO QSPB-INSMINAGE-10-2.
           MOVE SPB-INSMAXAGE(10 2) TO QSPB-INSMAXAGE-10-2.
           MOVE SPB-INSMAXCOV(10 2) TO QSPB-INSMAXCOV-10-2.
           MOVE SPB-INSMAXTRM(10 2) TO QSPB-INSMAXTRM-10-2.
           MOVE SPB-INSMINAGE(10 3) TO QSPB-INSMINAGE-10-3.
           MOVE SPB-INSMAXAGE(10 3) TO QSPB-INSMAXAGE-10-3.
           MOVE SPB-INSMAXCOV(10 3) TO QSPB-INSMAXCOV-10-3.
           MOVE SPB-INSMAXTRM(10 3) TO QSPB-INSMAXTRM-10-3.
           MOVE SPB-INSMINAGE(10 4) TO QSPB-INSMINAGE-10-4.
           MOVE SPB-INSMAXAGE(10 4) TO QSPB-INSMAXAGE-10-4.
           MOVE SPB-INSMAXCOV(10 4) TO QSPB-INSMAXCOV-10-4.
           MOVE SPB-INSMAXTRM(10 4) TO QSPB-INSMAXTRM-10-4.
           MOVE SPB-INSMINAGE(10 5) TO QSPB-INSMINAGE-10-5.
           MOVE SPB-INSMAXAGE(10 5) TO QSPB-INSMAXAGE-10-5.
           MOVE SPB-INSMAXCOV(10 5) TO QSPB-INSMAXCOV-10-5.
           MOVE SPB-INSMAXTRM(10 5) TO QSPB-INSMAXTRM-10-5.
           MOVE SPB-INSFEECD(10) TO QSPB-INSFEECD-10.
           MOVE SPB-INSFEE-FRMLA(10) TO QSPB-INSFEE-FRMLA-10.
           MOVE SPB-INSCHGABL-FG(10) TO QSPB-INSCHGABL-FG-10.
           MOVE SPB-INSREJECT-FG(10) TO QSPB-INSREJECT-FG-10.
           MOVE SPB-INSFINCHG(10) TO QSPB-INSFINCHG-10.
           MOVE SPB-INSCOM(11) TO QSPB-INSCOM-11.
           MOVE SPB-INSRATECD(11) TO QSPB-INSRATECD-11.
           MOVE SPB-INSJFAC(11) TO QSPB-INSJFAC-11.
           MOVE SPB-INSDISCNT(11) TO QSPB-INSDISCNT-11.
           MOVE SPB-INSCHGABL(11) TO QSPB-INSCHGABL-11.
           MOVE SPB-INSTERM(11 1) TO QSPB-INSTERM-11-1.
           MOVE SPB-INSRATE(11 1) TO QSPB-INSRATE-11-1.
           MOVE SPB-INSTERM(11 2) TO QSPB-INSTERM-11-2.
           MOVE SPB-INSRATE(11 2) TO QSPB-INSRATE-11-2.
           MOVE SPB-INSTERM(11 3) TO QSPB-INSTERM-11-3.
           MOVE SPB-INSRATE(11 3) TO QSPB-INSRATE-11-3.
           MOVE SPB-INSTERM(11 4) TO QSPB-INSTERM-11-4.
           MOVE SPB-INSRATE(11 4) TO QSPB-INSRATE-11-4.
           MOVE SPB-INSTERM(11 5) TO QSPB-INSTERM-11-5.
           MOVE SPB-INSRATE(11 5) TO QSPB-INSRATE-11-5.
           MOVE SPB-INSTERM(11 6) TO QSPB-INSTERM-11-6.
           MOVE SPB-INSRATE(11 6) TO QSPB-INSRATE-11-6.
           MOVE SPB-INSTERM(11 7) TO QSPB-INSTERM-11-7.
           MOVE SPB-INSRATE(11 7) TO QSPB-INSRATE-11-7.
           MOVE SPB-INSTERM(11 8) TO QSPB-INSTERM-11-8.
           MOVE SPB-INSRATE(11 8) TO QSPB-INSRATE-11-8.
           MOVE SPB-INSTERM(11 9) TO QSPB-INSTERM-11-9.
           MOVE SPB-INSRATE(11 9) TO QSPB-INSRATE-11-9.
           MOVE SPB-INSTERM(11 10) TO QSPB-INSTERM-11-10.
           MOVE SPB-INSRATE(11 10) TO QSPB-INSRATE-11-10.
           MOVE SPB-INSTERM(11 11) TO QSPB-INSTERM-11-11.
           MOVE SPB-INSRATE(11 11) TO QSPB-INSRATE-11-11.
           MOVE SPB-INSTERM(11 12) TO QSPB-INSTERM-11-12.
           MOVE SPB-INSRATE(11 12) TO QSPB-INSRATE-11-12.
           MOVE SPB-INSTERM(11 13) TO QSPB-INSTERM-11-13.
           MOVE SPB-INSRATE(11 13) TO QSPB-INSRATE-11-13.
           MOVE SPB-INSTERM(11 14) TO QSPB-INSTERM-11-14.
           MOVE SPB-INSRATE(11 14) TO QSPB-INSRATE-11-14.
           MOVE SPB-INSTERM(11 15) TO QSPB-INSTERM-11-15.
           MOVE SPB-INSRATE(11 15) TO QSPB-INSRATE-11-15.
           MOVE SPB-INSTERM(11 16) TO QSPB-INSTERM-11-16.
           MOVE SPB-INSRATE(11 16) TO QSPB-INSRATE-11-16.
           MOVE SPB-INSTERM(11 17) TO QSPB-INSTERM-11-17.
           MOVE SPB-INSRATE(11 17) TO QSPB-INSRATE-11-17.
           MOVE SPB-INSTERM(11 18) TO QSPB-INSTERM-11-18.
           MOVE SPB-INSRATE(11 18) TO QSPB-INSRATE-11-18.
           MOVE SPB-INSTERM(11 19) TO QSPB-INSTERM-11-19.
           MOVE SPB-INSRATE(11 19) TO QSPB-INSRATE-11-19.
           MOVE SPB-INSTERM(11 20) TO QSPB-INSTERM-11-20.
           MOVE SPB-INSRATE(11 20) TO QSPB-INSRATE-11-20.
           MOVE SPB-INSMINPREM(11) TO QSPB-INSMINPREM-11.
           MOVE SPB-INSMINCHGABL(11) TO QSPB-INSMINCHGABL-11.
           MOVE SPB-INSMAXCHGABL(11) TO QSPB-INSMAXCHGABL-11.
           MOVE SPB-INSMAXBENIF(11) TO QSPB-INSMAXBENIF-11.
           MOVE SPB-INSMAXTERM(11) TO QSPB-INSMAXTERM-11.
           MOVE SPB-INSCHGBEN(11) TO QSPB-INSCHGBEN-11.
           MOVE SPB-INSEXCEPT(11) TO QSPB-INSEXCEPT-11.
           MOVE SPB-INSNOVER(11) TO QSPB-INSNOVER-11.
           MOVE SPB-INSMINAGE(11 1) TO QSPB-INSMINAGE-11-1.
           MOVE SPB-INSMAXAGE(11 1) TO QSPB-INSMAXAGE-11-1.
           MOVE SPB-INSMAXCOV(11 1) TO QSPB-INSMAXCOV-11-1.
           MOVE SPB-INSMAXTRM(11 1) TO QSPB-INSMAXTRM-11-1.
           MOVE SPB-INSMINAGE(11 2) TO QSPB-INSMINAGE-11-2.
           MOVE SPB-INSMAXAGE(11 2) TO QSPB-INSMAXAGE-11-2.
           MOVE SPB-INSMAXCOV(11 2) TO QSPB-INSMAXCOV-11-2.
           MOVE SPB-INSMAXTRM(11 2) TO QSPB-INSMAXTRM-11-2.
           MOVE SPB-INSMINAGE(11 3) TO QSPB-INSMINAGE-11-3.
           MOVE SPB-INSMAXAGE(11 3) TO QSPB-INSMAXAGE-11-3.
           MOVE SPB-INSMAXCOV(11 3) TO QSPB-INSMAXCOV-11-3.
           MOVE SPB-INSMAXTRM(11 3) TO QSPB-INSMAXTRM-11-3.
           MOVE SPB-INSMINAGE(11 4) TO QSPB-INSMINAGE-11-4.
           MOVE SPB-INSMAXAGE(11 4) TO QSPB-INSMAXAGE-11-4.
           MOVE SPB-INSMAXCOV(11 4) TO QSPB-INSMAXCOV-11-4.
           MOVE SPB-INSMAXTRM(11 4) TO QSPB-INSMAXTRM-11-4.
           MOVE SPB-INSMINAGE(11 5) TO QSPB-INSMINAGE-11-5.
           MOVE SPB-INSMAXAGE(11 5) TO QSPB-INSMAXAGE-11-5.
           MOVE SPB-INSMAXCOV(11 5) TO QSPB-INSMAXCOV-11-5.
           MOVE SPB-INSMAXTRM(11 5) TO QSPB-INSMAXTRM-11-5.
           MOVE SPB-INSFEECD(11) TO QSPB-INSFEECD-11.
           MOVE SPB-INSFEE-FRMLA(11) TO QSPB-INSFEE-FRMLA-11.
           MOVE SPB-INSCHGABL-FG(11) TO QSPB-INSCHGABL-FG-11.
           MOVE SPB-INSREJECT-FG(11) TO QSPB-INSREJECT-FG-11.
           MOVE SPB-INSFINCHG(11) TO QSPB-INSFINCHG-11.
           MOVE SPB-INSCOM(12) TO QSPB-INSCOM-12.
           MOVE SPB-INSRATECD(12) TO QSPB-INSRATECD-12.
           MOVE SPB-INSJFAC(12) TO QSPB-INSJFAC-12.
           MOVE SPB-INSDISCNT(12) TO QSPB-INSDISCNT-12.
           MOVE SPB-INSCHGABL(12) TO QSPB-INSCHGABL-12.
           MOVE SPB-INSTERM(12 1) TO QSPB-INSTERM-12-1.
           MOVE SPB-INSRATE(12 1) TO QSPB-INSRATE-12-1.
           MOVE SPB-INSTERM(12 2) TO QSPB-INSTERM-12-2.
           MOVE SPB-INSRATE(12 2) TO QSPB-INSRATE-12-2.
           MOVE SPB-INSTERM(12 3) TO QSPB-INSTERM-12-3.
           MOVE SPB-INSRATE(12 3) TO QSPB-INSRATE-12-3.
           MOVE SPB-INSTERM(12 4) TO QSPB-INSTERM-12-4.
           MOVE SPB-INSRATE(12 4) TO QSPB-INSRATE-12-4.
           MOVE SPB-INSTERM(12 5) TO QSPB-INSTERM-12-5.
           MOVE SPB-INSRATE(12 5) TO QSPB-INSRATE-12-5.
           MOVE SPB-INSTERM(12 6) TO QSPB-INSTERM-12-6.
           MOVE SPB-INSRATE(12 6) TO QSPB-INSRATE-12-6.
           MOVE SPB-INSTERM(12 7) TO QSPB-INSTERM-12-7.
           MOVE SPB-INSRATE(12 7) TO QSPB-INSRATE-12-7.
           MOVE SPB-INSTERM(12 8) TO QSPB-INSTERM-12-8.
           MOVE SPB-INSRATE(12 8) TO QSPB-INSRATE-12-8.
           MOVE SPB-INSTERM(12 9) TO QSPB-INSTERM-12-9.
           MOVE SPB-INSRATE(12 9) TO QSPB-INSRATE-12-9.
           MOVE SPB-INSTERM(12 10) TO QSPB-INSTERM-12-10.
           MOVE SPB-INSRATE(12 10) TO QSPB-INSRATE-12-10.
           MOVE SPB-INSTERM(12 11) TO QSPB-INSTERM-12-11.
           MOVE SPB-INSRATE(12 11) TO QSPB-INSRATE-12-11.
           MOVE SPB-INSTERM(12 12) TO QSPB-INSTERM-12-12.
           MOVE SPB-INSRATE(12 12) TO QSPB-INSRATE-12-12.
           MOVE SPB-INSTERM(12 13) TO QSPB-INSTERM-12-13.
           MOVE SPB-INSRATE(12 13) TO QSPB-INSRATE-12-13.
           MOVE SPB-INSTERM(12 14) TO QSPB-INSTERM-12-14.
           MOVE SPB-INSRATE(12 14) TO QSPB-INSRATE-12-14.
           MOVE SPB-INSTERM(12 15) TO QSPB-INSTERM-12-15.
           MOVE SPB-INSRATE(12 15) TO QSPB-INSRATE-12-15.
           MOVE SPB-INSTERM(12 16) TO QSPB-INSTERM-12-16.
           MOVE SPB-INSRATE(12 16) TO QSPB-INSRATE-12-16.
           MOVE SPB-INSTERM(12 17) TO QSPB-INSTERM-12-17.
           MOVE SPB-INSRATE(12 17) TO QSPB-INSRATE-12-17.
           MOVE SPB-INSTERM(12 18) TO QSPB-INSTERM-12-18.
           MOVE SPB-INSRATE(12 18) TO QSPB-INSRATE-12-18.
           MOVE SPB-INSTERM(12 19) TO QSPB-INSTERM-12-19.
           MOVE SPB-INSRATE(12 19) TO QSPB-INSRATE-12-19.
           MOVE SPB-INSTERM(12 20) TO QSPB-INSTERM-12-20.
           MOVE SPB-INSRATE(12 20) TO QSPB-INSRATE-12-20.
           MOVE SPB-INSMINPREM(12) TO QSPB-INSMINPREM-12.
           MOVE SPB-INSMINCHGABL(12) TO QSPB-INSMINCHGABL-12.
           MOVE SPB-INSMAXCHGABL(12) TO QSPB-INSMAXCHGABL-12.
           MOVE SPB-INSMAXBENIF(12) TO QSPB-INSMAXBENIF-12.
           MOVE SPB-INSMAXTERM(12) TO QSPB-INSMAXTERM-12.
           MOVE SPB-INSCHGBEN(12) TO QSPB-INSCHGBEN-12.
           MOVE SPB-INSEXCEPT(12) TO QSPB-INSEXCEPT-12.
           MOVE SPB-INSNOVER(12) TO QSPB-INSNOVER-12.
           MOVE SPB-INSMINAGE(12 1) TO QSPB-INSMINAGE-12-1.
           MOVE SPB-INSMAXAGE(12 1) TO QSPB-INSMAXAGE-12-1.
           MOVE SPB-INSMAXCOV(12 1) TO QSPB-INSMAXCOV-12-1.
           MOVE SPB-INSMAXTRM(12 1) TO QSPB-INSMAXTRM-12-1.
           MOVE SPB-INSMINAGE(12 2) TO QSPB-INSMINAGE-12-2.
           MOVE SPB-INSMAXAGE(12 2) TO QSPB-INSMAXAGE-12-2.
           MOVE SPB-INSMAXCOV(12 2) TO QSPB-INSMAXCOV-12-2.
           MOVE SPB-INSMAXTRM(12 2) TO QSPB-INSMAXTRM-12-2.
           MOVE SPB-INSMINAGE(12 3) TO QSPB-INSMINAGE-12-3.
           MOVE SPB-INSMAXAGE(12 3) TO QSPB-INSMAXAGE-12-3.
           MOVE SPB-INSMAXCOV(12 3) TO QSPB-INSMAXCOV-12-3.
           MOVE SPB-INSMAXTRM(12 3) TO QSPB-INSMAXTRM-12-3.
           MOVE SPB-INSMINAGE(12 4) TO QSPB-INSMINAGE-12-4.
           MOVE SPB-INSMAXAGE(12 4) TO QSPB-INSMAXAGE-12-4.
           MOVE SPB-INSMAXCOV(12 4) TO QSPB-INSMAXCOV-12-4.
           MOVE SPB-INSMAXTRM(12 4) TO QSPB-INSMAXTRM-12-4.
           MOVE SPB-INSMINAGE(12 5) TO QSPB-INSMINAGE-12-5.
           MOVE SPB-INSMAXAGE(12 5) TO QSPB-INSMAXAGE-12-5.
           MOVE SPB-INSMAXCOV(12 5) TO QSPB-INSMAXCOV-12-5.
           MOVE SPB-INSMAXTRM(12 5) TO QSPB-INSMAXTRM-12-5.
           MOVE SPB-INSFEECD(12) TO QSPB-INSFEECD-12.
           MOVE SPB-INSFEE-FRMLA(12) TO QSPB-INSFEE-FRMLA-12.
           MOVE SPB-INSCHGABL-FG(12) TO QSPB-INSCHGABL-FG-12.
           MOVE SPB-INSREJECT-FG(12) TO QSPB-INSREJECT-FG-12.
           MOVE SPB-INSFINCHG(12) TO QSPB-INSFINCHG-12.
 
      *-----------------------------------------------------------------
      *    LOAD SPC-REC FROM QSPC-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-SPC-FIELDS.
           MOVE QSPC-ORGST TO SPC-ORGST.
           MOVE QSPC-SPRCLASS TO SPC-SPRCLASS.
           MOVE QSPC-SUBCLASS TO SPC-SUBCLASS.
           MOVE QSPC-LAWCODE TO SPC-LAWCODE.
           MOVE QSPC-INSEARN-ORDER-1 TO SPC-INSEARN-ORDER(1).
           MOVE QSPC-INSEARN-ORDER-2 TO SPC-INSEARN-ORDER(2).
           MOVE QSPC-INSEARN-ORDER-3 TO SPC-INSEARN-ORDER(3).
           MOVE QSPC-INSEARN-ORDER-4 TO SPC-INSEARN-ORDER(4).
           MOVE QSPC-INSEARN-ORDER-5 TO SPC-INSEARN-ORDER(5).
           MOVE QSPC-INSEARN-ORDER-6 TO SPC-INSEARN-ORDER(6).
           MOVE QSPC-INSEARN-ORDER-7 TO SPC-INSEARN-ORDER(7).
           MOVE QSPC-INSEARN-ORDER-8 TO SPC-INSEARN-ORDER(8).
           MOVE QSPC-INSEARN-ORDER-9 TO SPC-INSEARN-ORDER(9).
           MOVE QSPC-INSEARN-ORDER-10 TO SPC-INSEARN-ORDER(10).
           MOVE QSPC-INSEARN-ORDER-11 TO SPC-INSEARN-ORDER(11).
           MOVE QSPC-INSEARN-ORDER-12 TO SPC-INSEARN-ORDER(12).
           MOVE QSPC-INSAH-JOINT-FG TO SPC-INSAH-JOINT-FG.
           MOVE QSPC-INS-O1-EDIT TO SPC-INS-O1-EDIT.
           MOVE QSPC-INS-O2-EDIT TO SPC-INS-O2-EDIT.
           MOVE QSPC-RBFRMLA-1 TO SPC-RBFRMLA(1).
           MOVE QSPC-RBDTE-1-1 TO SPC-RBDTE(1 1).
           MOVE QSPC-RBDAYS-1-1 TO SPC-RBDAYS(1 1).
           MOVE QSPC-RBYRTYPE-1-1 TO SPC-RBYRTYPE(1 1).
           MOVE QSPC-RBDTE-1-2 TO SPC-RBDTE(1 2).
           MOVE QSPC-RBDAYS-1-2 TO SPC-RBDAYS(1 2).
           MOVE QSPC-RBYRTYPE-1-2 TO SPC-RBYRTYPE(1 2).
           MOVE QSPC-RBMINRET-1 TO SPC-RBMINRET(1).
           MOVE QSPC-RBNOMON-1 TO SPC-RBNOMON(1).
           MOVE QSPC-RBDEDCHG-1 TO SPC-RBDEDCHG(1).
           MOVE QSPC-RBRECAST-1 TO SPC-RBRECAST(1).
           MOVE QSPC-RBEARLY-1 TO SPC-RBEARLY(1).
           MOVE QSPC-RBDEFER-1 TO SPC-RBDEFER(1).
           MOVE QSPC-RBPCT-1 TO SPC-RBPCT(1).
           MOVE QSPC-RBREDUC-1 TO SPC-RBREDUC(1).
           MOVE QSPC-RBMIN-1 TO SPC-RBMIN(1).
           MOVE QSPC-RBSPOPT1-1 TO SPC-RBSPOPT1(1).
           MOVE QSPC-RBSPOPT2-1 TO SPC-RBSPOPT2(1).
           MOVE QSPC-RBMANAGER-1 TO SPC-RBMANAGER(1).
           MOVE QSPC-RBUNITPER-CD-1 TO SPC-RBUNITPER-CD(1).
           MOVE QSPC-RBFRMLA2-1 TO SPC-RBFRMLA2(1).
           MOVE QSPC-RBFRMLA-2 TO SPC-RBFRMLA(2).
           MOVE QSPC-RBDTE-2-1 TO SPC-RBDTE(2 1).
           MOVE QSPC-RBDAYS-2-1 TO SPC-RBDAYS(2 1).
           MOVE QSPC-RBYRTYPE-2-1 TO SPC-RBYRTYPE(2 1).
           MOVE QSPC-RBDTE-2-2 TO SPC-RBDTE(2 2).
           MOVE QSPC-RBDAYS-2-2 TO SPC-RBDAYS(2 2).
           MOVE QSPC-RBYRTYPE-2-2 TO SPC-RBYRTYPE(2 2).
           MOVE QSPC-RBMINRET-2 TO SPC-RBMINRET(2).
           MOVE QSPC-RBNOMON-2 TO SPC-RBNOMON(2).
           MOVE QSPC-RBDEDCHG-2 TO SPC-RBDEDCHG(2).
           MOVE QSPC-RBRECAST-2 TO SPC-RBRECAST(2).
           MOVE QSPC-RBEARLY-2 TO SPC-RBEARLY(2).
           MOVE QSPC-RBDEFER-2 TO SPC-RBDEFER(2).
           MOVE QSPC-RBPCT-2 TO SPC-RBPCT(2).
           MOVE QSPC-RBREDUC-2 TO SPC-RBREDUC(2).
           MOVE QSPC-RBMIN-2 TO SPC-RBMIN(2).
           MOVE QSPC-RBSPOPT1-2 TO SPC-RBSPOPT1(2).
           MOVE QSPC-RBSPOPT2-2 TO SPC-RBSPOPT2(2).
           MOVE QSPC-RBMANAGER-2 TO SPC-RBMANAGER(2).
           MOVE QSPC-RBUNITPER-CD-2 TO SPC-RBUNITPER-CD(2).
           MOVE QSPC-RBFRMLA2-2 TO SPC-RBFRMLA2(2).
           MOVE QSPC-RBFRMLA-3 TO SPC-RBFRMLA(3).
           MOVE QSPC-RBDTE-3-1 TO SPC-RBDTE(3 1).
           MOVE QSPC-RBDAYS-3-1 TO SPC-RBDAYS(3 1).
           MOVE QSPC-RBYRTYPE-3-1 TO SPC-RBYRTYPE(3 1).
           MOVE QSPC-RBDTE-3-2 TO SPC-RBDTE(3 2).
           MOVE QSPC-RBDAYS-3-2 TO SPC-RBDAYS(3 2).
           MOVE QSPC-RBYRTYPE-3-2 TO SPC-RBYRTYPE(3 2).
           MOVE QSPC-RBMINRET-3 TO SPC-RBMINRET(3).
           MOVE QSPC-RBNOMON-3 TO SPC-RBNOMON(3).
           MOVE QSPC-RBDEDCHG-3 TO SPC-RBDEDCHG(3).
           MOVE QSPC-RBRECAST-3 TO SPC-RBRECAST(3).
           MOVE QSPC-RBEARLY-3 TO SPC-RBEARLY(3).
           MOVE QSPC-RBDEFER-3 TO SPC-RBDEFER(3).
           MOVE QSPC-RBPCT-3 TO SPC-RBPCT(3).
           MOVE QSPC-RBREDUC-3 TO SPC-RBREDUC(3).
           MOVE QSPC-RBMIN-3 TO SPC-RBMIN(3).
           MOVE QSPC-RBSPOPT1-3 TO SPC-RBSPOPT1(3).
           MOVE QSPC-RBSPOPT2-3 TO SPC-RBSPOPT2(3).
           MOVE QSPC-RBMANAGER-3 TO SPC-RBMANAGER(3).
           MOVE QSPC-RBUNITPER-CD-3 TO SPC-RBUNITPER-CD(3).
           MOVE QSPC-RBFRMLA2-3 TO SPC-RBFRMLA2(3).
           MOVE QSPC-RBFRMLA-4 TO SPC-RBFRMLA(4).
           MOVE QSPC-RBDTE-4-1 TO SPC-RBDTE(4 1).
           MOVE QSPC-RBDAYS-4-1 TO SPC-RBDAYS(4 1).
           MOVE QSPC-RBYRTYPE-4-1 TO SPC-RBYRTYPE(4 1).
           MOVE QSPC-RBDTE-4-2 TO SPC-RBDTE(4 2).
           MOVE QSPC-RBDAYS-4-2 TO SPC-RBDAYS(4 2).
           MOVE QSPC-RBYRTYPE-4-2 TO SPC-RBYRTYPE(4 2).
           MOVE QSPC-RBMINRET-4 TO SPC-RBMINRET(4).
           MOVE QSPC-RBNOMON-4 TO SPC-RBNOMON(4).
           MOVE QSPC-RBDEDCHG-4 TO SPC-RBDEDCHG(4).
           MOVE QSPC-RBRECAST-4 TO SPC-RBRECAST(4).
           MOVE QSPC-RBEARLY-4 TO SPC-RBEARLY(4).
           MOVE QSPC-RBDEFER-4 TO SPC-RBDEFER(4).
           MOVE QSPC-RBPCT-4 TO SPC-RBPCT(4).
           MOVE QSPC-RBREDUC-4 TO SPC-RBREDUC(4).
           MOVE QSPC-RBMIN-4 TO SPC-RBMIN(4).
           MOVE QSPC-RBSPOPT1-4 TO SPC-RBSPOPT1(4).
           MOVE QSPC-RBSPOPT2-4 TO SPC-RBSPOPT2(4).
           MOVE QSPC-RBMANAGER-4 TO SPC-RBMANAGER(4).
           MOVE QSPC-RBUNITPER-CD-4 TO SPC-RBUNITPER-CD(4).
           MOVE QSPC-RBFRMLA2-4 TO SPC-RBFRMLA2(4).
           MOVE QSPC-RBFRMLA-5 TO SPC-RBFRMLA(5).
           MOVE QSPC-RBDTE-5-1 TO SPC-RBDTE(5 1).
           MOVE QSPC-RBDAYS-5-1 TO SPC-RBDAYS(5 1).
           MOVE QSPC-RBYRTYPE-5-1 TO SPC-RBYRTYPE(5 1).
           MOVE QSPC-RBDTE-5-2 TO SPC-RBDTE(5 2).
           MOVE QSPC-RBDAYS-5-2 TO SPC-RBDAYS(5 2).
           MOVE QSPC-RBYRTYPE-5-2 TO SPC-RBYRTYPE(5 2).
           MOVE QSPC-RBMINRET-5 TO SPC-RBMINRET(5).
           MOVE QSPC-RBNOMON-5 TO SPC-RBNOMON(5).
           MOVE QSPC-RBDEDCHG-5 TO SPC-RBDEDCHG(5).
           MOVE QSPC-RBRECAST-5 TO SPC-RBRECAST(5).
           MOVE QSPC-RBEARLY-5 TO SPC-RBEARLY(5).
           MOVE QSPC-RBDEFER-5 TO SPC-RBDEFER(5).
           MOVE QSPC-RBPCT-5 TO SPC-RBPCT(5).
           MOVE QSPC-RBREDUC-5 TO SPC-RBREDUC(5).
           MOVE QSPC-RBMIN-5 TO SPC-RBMIN(5).
           MOVE QSPC-RBSPOPT1-5 TO SPC-RBSPOPT1(5).
           MOVE QSPC-RBSPOPT2-5 TO SPC-RBSPOPT2(5).
           MOVE QSPC-RBMANAGER-5 TO SPC-RBMANAGER(5).
           MOVE QSPC-RBUNITPER-CD-5 TO SPC-RBUNITPER-CD(5).
           MOVE QSPC-RBFRMLA2-5 TO SPC-RBFRMLA2(5).
           MOVE QSPC-RBFRMLA-6 TO SPC-RBFRMLA(6).
           MOVE QSPC-RBDTE-6-1 TO SPC-RBDTE(6 1).
           MOVE QSPC-RBDAYS-6-1 TO SPC-RBDAYS(6 1).
           MOVE QSPC-RBYRTYPE-6-1 TO SPC-RBYRTYPE(6 1).
           MOVE QSPC-RBDTE-6-2 TO SPC-RBDTE(6 2).
           MOVE QSPC-RBDAYS-6-2 TO SPC-RBDAYS(6 2).
           MOVE QSPC-RBYRTYPE-6-2 TO SPC-RBYRTYPE(6 2).
           MOVE QSPC-RBMINRET-6 TO SPC-RBMINRET(6).
           MOVE QSPC-RBNOMON-6 TO SPC-RBNOMON(6).
           MOVE QSPC-RBDEDCHG-6 TO SPC-RBDEDCHG(6).
           MOVE QSPC-RBRECAST-6 TO SPC-RBRECAST(6).
           MOVE QSPC-RBEARLY-6 TO SPC-RBEARLY(6).
           MOVE QSPC-RBDEFER-6 TO SPC-RBDEFER(6).
           MOVE QSPC-RBPCT-6 TO SPC-RBPCT(6).
           MOVE QSPC-RBREDUC-6 TO SPC-RBREDUC(6).
           MOVE QSPC-RBMIN-6 TO SPC-RBMIN(6).
           MOVE QSPC-RBSPOPT1-6 TO SPC-RBSPOPT1(6).
           MOVE QSPC-RBSPOPT2-6 TO SPC-RBSPOPT2(6).
           MOVE QSPC-RBMANAGER-6 TO SPC-RBMANAGER(6).
           MOVE QSPC-RBUNITPER-CD-6 TO SPC-RBUNITPER-CD(6).
           MOVE QSPC-RBFRMLA2-6 TO SPC-RBFRMLA2(6).
           MOVE QSPC-RBFRMLA-7 TO SPC-RBFRMLA(7).
           MOVE QSPC-RBDTE-7-1 TO SPC-RBDTE(7 1).
           MOVE QSPC-RBDAYS-7-1 TO SPC-RBDAYS(7 1).
           MOVE QSPC-RBYRTYPE-7-1 TO SPC-RBYRTYPE(7 1).
           MOVE QSPC-RBDTE-7-2 TO SPC-RBDTE(7 2).
           MOVE QSPC-RBDAYS-7-2 TO SPC-RBDAYS(7 2).
           MOVE QSPC-RBYRTYPE-7-2 TO SPC-RBYRTYPE(7 2).
           MOVE QSPC-RBMINRET-7 TO SPC-RBMINRET(7).
           MOVE QSPC-RBNOMON-7 TO SPC-RBNOMON(7).
           MOVE QSPC-RBDEDCHG-7 TO SPC-RBDEDCHG(7).
           MOVE QSPC-RBRECAST-7 TO SPC-RBRECAST(7).
           MOVE QSPC-RBEARLY-7 TO SPC-RBEARLY(7).
           MOVE QSPC-RBDEFER-7 TO SPC-RBDEFER(7).
           MOVE QSPC-RBPCT-7 TO SPC-RBPCT(7).
           MOVE QSPC-RBREDUC-7 TO SPC-RBREDUC(7).
           MOVE QSPC-RBMIN-7 TO SPC-RBMIN(7).
           MOVE QSPC-RBSPOPT1-7 TO SPC-RBSPOPT1(7).
           MOVE QSPC-RBSPOPT2-7 TO SPC-RBSPOPT2(7).
           MOVE QSPC-RBMANAGER-7 TO SPC-RBMANAGER(7).
           MOVE QSPC-RBUNITPER-CD-7 TO SPC-RBUNITPER-CD(7).
           MOVE QSPC-RBFRMLA2-7 TO SPC-RBFRMLA2(7).
           MOVE QSPC-RBFRMLA-8 TO SPC-RBFRMLA(8).
           MOVE QSPC-RBDTE-8-1 TO SPC-RBDTE(8 1).
           MOVE QSPC-RBDAYS-8-1 TO SPC-RBDAYS(8 1).
           MOVE QSPC-RBYRTYPE-8-1 TO SPC-RBYRTYPE(8 1).
           MOVE QSPC-RBDTE-8-2 TO SPC-RBDTE(8 2).
           MOVE QSPC-RBDAYS-8-2 TO SPC-RBDAYS(8 2).
           MOVE QSPC-RBYRTYPE-8-2 TO SPC-RBYRTYPE(8 2).
           MOVE QSPC-RBMINRET-8 TO SPC-RBMINRET(8).
           MOVE QSPC-RBNOMON-8 TO SPC-RBNOMON(8).
           MOVE QSPC-RBDEDCHG-8 TO SPC-RBDEDCHG(8).
           MOVE QSPC-RBRECAST-8 TO SPC-RBRECAST(8).
           MOVE QSPC-RBEARLY-8 TO SPC-RBEARLY(8).
           MOVE QSPC-RBDEFER-8 TO SPC-RBDEFER(8).
           MOVE QSPC-RBPCT-8 TO SPC-RBPCT(8).
           MOVE QSPC-RBREDUC-8 TO SPC-RBREDUC(8).
           MOVE QSPC-RBMIN-8 TO SPC-RBMIN(8).
           MOVE QSPC-RBSPOPT1-8 TO SPC-RBSPOPT1(8).
           MOVE QSPC-RBSPOPT2-8 TO SPC-RBSPOPT2(8).
           MOVE QSPC-RBMANAGER-8 TO SPC-RBMANAGER(8).
           MOVE QSPC-RBUNITPER-CD-8 TO SPC-RBUNITPER-CD(8).
           MOVE QSPC-RBFRMLA2-8 TO SPC-RBFRMLA2(8).
           MOVE QSPC-RBFRMLA-9 TO SPC-RBFRMLA(9).
           MOVE QSPC-RBDTE-9-1 TO SPC-RBDTE(9 1).
           MOVE QSPC-RBDAYS-9-1 TO SPC-RBDAYS(9 1).
           MOVE QSPC-RBYRTYPE-9-1 TO SPC-RBYRTYPE(9 1).
           MOVE QSPC-RBDTE-9-2 TO SPC-RBDTE(9 2).
           MOVE QSPC-RBDAYS-9-2 TO SPC-RBDAYS(9 2).
           MOVE QSPC-RBYRTYPE-9-2 TO SPC-RBYRTYPE(9 2).
           MOVE QSPC-RBMINRET-9 TO SPC-RBMINRET(9).
           MOVE QSPC-RBNOMON-9 TO SPC-RBNOMON(9).
           MOVE QSPC-RBDEDCHG-9 TO SPC-RBDEDCHG(9).
           MOVE QSPC-RBRECAST-9 TO SPC-RBRECAST(9).
           MOVE QSPC-RBEARLY-9 TO SPC-RBEARLY(9).
           MOVE QSPC-RBDEFER-9 TO SPC-RBDEFER(9).
           MOVE QSPC-RBPCT-9 TO SPC-RBPCT(9).
           MOVE QSPC-RBREDUC-9 TO SPC-RBREDUC(9).
           MOVE QSPC-RBMIN-9 TO SPC-RBMIN(9).
           MOVE QSPC-RBSPOPT1-9 TO SPC-RBSPOPT1(9).
           MOVE QSPC-RBSPOPT2-9 TO SPC-RBSPOPT2(9).
           MOVE QSPC-RBMANAGER-9 TO SPC-RBMANAGER(9).
           MOVE QSPC-RBUNITPER-CD-9 TO SPC-RBUNITPER-CD(9).
           MOVE QSPC-RBFRMLA2-9 TO SPC-RBFRMLA2(9).
           MOVE QSPC-RBFRMLA-10 TO SPC-RBFRMLA(10).
           MOVE QSPC-RBDTE-10-1 TO SPC-RBDTE(10 1).
           MOVE QSPC-RBDAYS-10-1 TO SPC-RBDAYS(10 1).
           MOVE QSPC-RBYRTYPE-10-1 TO SPC-RBYRTYPE(10 1).
           MOVE QSPC-RBDTE-10-2 TO SPC-RBDTE(10 2).
           MOVE QSPC-RBDAYS-10-2 TO SPC-RBDAYS(10 2).
           MOVE QSPC-RBYRTYPE-10-2 TO SPC-RBYRTYPE(10 2).
           MOVE QSPC-RBMINRET-10 TO SPC-RBMINRET(10).
           MOVE QSPC-RBNOMON-10 TO SPC-RBNOMON(10).
           MOVE QSPC-RBDEDCHG-10 TO SPC-RBDEDCHG(10).
           MOVE QSPC-RBRECAST-10 TO SPC-RBRECAST(10).
           MOVE QSPC-RBEARLY-10 TO SPC-RBEARLY(10).
           MOVE QSPC-RBDEFER-10 TO SPC-RBDEFER(10).
           MOVE QSPC-RBPCT-10 TO SPC-RBPCT(10).
           MOVE QSPC-RBREDUC-10 TO SPC-RBREDUC(10).
           MOVE QSPC-RBMIN-10 TO SPC-RBMIN(10).
           MOVE QSPC-RBSPOPT1-10 TO SPC-RBSPOPT1(10).
           MOVE QSPC-RBSPOPT2-10 TO SPC-RBSPOPT2(10).
           MOVE QSPC-RBMANAGER-10 TO SPC-RBMANAGER(10).
           MOVE QSPC-RBUNITPER-CD-10 TO SPC-RBUNITPER-CD(10).
           MOVE QSPC-RBFRMLA2-10 TO SPC-RBFRMLA2(10).
           MOVE QSPC-RBFRMLA-11 TO SPC-RBFRMLA(11).
           MOVE QSPC-RBDTE-11-1 TO SPC-RBDTE(11 1).
           MOVE QSPC-RBDAYS-11-1 TO SPC-RBDAYS(11 1).
           MOVE QSPC-RBYRTYPE-11-1 TO SPC-RBYRTYPE(11 1).
           MOVE QSPC-RBDTE-11-2 TO SPC-RBDTE(11 2).
           MOVE QSPC-RBDAYS-11-2 TO SPC-RBDAYS(11 2).
           MOVE QSPC-RBYRTYPE-11-2 TO SPC-RBYRTYPE(11 2).
           MOVE QSPC-RBMINRET-11 TO SPC-RBMINRET(11).
           MOVE QSPC-RBNOMON-11 TO SPC-RBNOMON(11).
           MOVE QSPC-RBDEDCHG-11 TO SPC-RBDEDCHG(11).
           MOVE QSPC-RBRECAST-11 TO SPC-RBRECAST(11).
           MOVE QSPC-RBEARLY-11 TO SPC-RBEARLY(11).
           MOVE QSPC-RBDEFER-11 TO SPC-RBDEFER(11).
           MOVE QSPC-RBPCT-11 TO SPC-RBPCT(11).
           MOVE QSPC-RBREDUC-11 TO SPC-RBREDUC(11).
           MOVE QSPC-RBMIN-11 TO SPC-RBMIN(11).
           MOVE QSPC-RBSPOPT1-11 TO SPC-RBSPOPT1(11).
           MOVE QSPC-RBSPOPT2-11 TO SPC-RBSPOPT2(11).
           MOVE QSPC-RBMANAGER-11 TO SPC-RBMANAGER(11).
           MOVE QSPC-RBUNITPER-CD-11 TO SPC-RBUNITPER-CD(11).
           MOVE QSPC-RBFRMLA2-11 TO SPC-RBFRMLA2(11).
           MOVE QSPC-RBFRMLA-12 TO SPC-RBFRMLA(12).
           MOVE QSPC-RBDTE-12-1 TO SPC-RBDTE(12 1).
           MOVE QSPC-RBDAYS-12-1 TO SPC-RBDAYS(12 1).
           MOVE QSPC-RBYRTYPE-12-1 TO SPC-RBYRTYPE(12 1).
           MOVE QSPC-RBDTE-12-2 TO SPC-RBDTE(12 2).
           MOVE QSPC-RBDAYS-12-2 TO SPC-RBDAYS(12 2).
           MOVE QSPC-RBYRTYPE-12-2 TO SPC-RBYRTYPE(12 2).
           MOVE QSPC-RBMINRET-12 TO SPC-RBMINRET(12).
           MOVE QSPC-RBNOMON-12 TO SPC-RBNOMON(12).
           MOVE QSPC-RBDEDCHG-12 TO SPC-RBDEDCHG(12).
           MOVE QSPC-RBRECAST-12 TO SPC-RBRECAST(12).
           MOVE QSPC-RBEARLY-12 TO SPC-RBEARLY(12).
           MOVE QSPC-RBDEFER-12 TO SPC-RBDEFER(12).
           MOVE QSPC-RBPCT-12 TO SPC-RBPCT(12).
           MOVE QSPC-RBREDUC-12 TO SPC-RBREDUC(12).
           MOVE QSPC-RBMIN-12 TO SPC-RBMIN(12).
           MOVE QSPC-RBSPOPT1-12 TO SPC-RBSPOPT1(12).
           MOVE QSPC-RBSPOPT2-12 TO SPC-RBSPOPT2(12).
           MOVE QSPC-RBMANAGER-12 TO SPC-RBMANAGER(12).
           MOVE QSPC-RBUNITPER-CD-12 TO SPC-RBUNITPER-CD(12).
           MOVE QSPC-RBFRMLA2-12 TO SPC-RBFRMLA2(12).
           MOVE QSPC-RBFRMLA-13 TO SPC-RBFRMLA(13).
           MOVE QSPC-RBDTE-13-1 TO SPC-RBDTE(13 1).
           MOVE QSPC-RBDAYS-13-1 TO SPC-RBDAYS(13 1).
           MOVE QSPC-RBYRTYPE-13-1 TO SPC-RBYRTYPE(13 1).
           MOVE QSPC-RBDTE-13-2 TO SPC-RBDTE(13 2).
           MOVE QSPC-RBDAYS-13-2 TO SPC-RBDAYS(13 2).
           MOVE QSPC-RBYRTYPE-13-2 TO SPC-RBYRTYPE(13 2).
           MOVE QSPC-RBMINRET-13 TO SPC-RBMINRET(13).
           MOVE QSPC-RBNOMON-13 TO SPC-RBNOMON(13).
           MOVE QSPC-RBDEDCHG-13 TO SPC-RBDEDCHG(13).
           MOVE QSPC-RBRECAST-13 TO SPC-RBRECAST(13).
           MOVE QSPC-RBEARLY-13 TO SPC-RBEARLY(13).
           MOVE QSPC-RBDEFER-13 TO SPC-RBDEFER(13).
           MOVE QSPC-RBPCT-13 TO SPC-RBPCT(13).
           MOVE QSPC-RBREDUC-13 TO SPC-RBREDUC(13).
           MOVE QSPC-RBMIN-13 TO SPC-RBMIN(13).
           MOVE QSPC-RBSPOPT1-13 TO SPC-RBSPOPT1(13).
           MOVE QSPC-RBSPOPT2-13 TO SPC-RBSPOPT2(13).
           MOVE QSPC-RBMANAGER-13 TO SPC-RBMANAGER(13).
           MOVE QSPC-RBUNITPER-CD-13 TO SPC-RBUNITPER-CD(13).
           MOVE QSPC-RBFRMLA2-13 TO SPC-RBFRMLA2(13).
           MOVE QSPC-RBFRMLA-14 TO SPC-RBFRMLA(14).
           MOVE QSPC-RBDTE-14-1 TO SPC-RBDTE(14 1).
           MOVE QSPC-RBDAYS-14-1 TO SPC-RBDAYS(14 1).
           MOVE QSPC-RBYRTYPE-14-1 TO SPC-RBYRTYPE(14 1).
           MOVE QSPC-RBDTE-14-2 TO SPC-RBDTE(14 2).
           MOVE QSPC-RBDAYS-14-2 TO SPC-RBDAYS(14 2).
           MOVE QSPC-RBYRTYPE-14-2 TO SPC-RBYRTYPE(14 2).
           MOVE QSPC-RBMINRET-14 TO SPC-RBMINRET(14).
           MOVE QSPC-RBNOMON-14 TO SPC-RBNOMON(14).
           MOVE QSPC-RBDEDCHG-14 TO SPC-RBDEDCHG(14).
           MOVE QSPC-RBRECAST-14 TO SPC-RBRECAST(14).
           MOVE QSPC-RBEARLY-14 TO SPC-RBEARLY(14).
           MOVE QSPC-RBDEFER-14 TO SPC-RBDEFER(14).
           MOVE QSPC-RBPCT-14 TO SPC-RBPCT(14).
           MOVE QSPC-RBREDUC-14 TO SPC-RBREDUC(14).
           MOVE QSPC-RBMIN-14 TO SPC-RBMIN(14).
           MOVE QSPC-RBSPOPT1-14 TO SPC-RBSPOPT1(14).
           MOVE QSPC-RBSPOPT2-14 TO SPC-RBSPOPT2(14).
           MOVE QSPC-RBMANAGER-14 TO SPC-RBMANAGER(14).
           MOVE QSPC-RBUNITPER-CD-14 TO SPC-RBUNITPER-CD(14).
           MOVE QSPC-RBFRMLA2-14 TO SPC-RBFRMLA2(14).
           MOVE QSPC-RBFRMLA-15 TO SPC-RBFRMLA(15).
           MOVE QSPC-RBDTE-15-1 TO SPC-RBDTE(15 1).
           MOVE QSPC-RBDAYS-15-1 TO SPC-RBDAYS(15 1).
           MOVE QSPC-RBYRTYPE-15-1 TO SPC-RBYRTYPE(15 1).
           MOVE QSPC-RBDTE-15-2 TO SPC-RBDTE(15 2).
           MOVE QSPC-RBDAYS-15-2 TO SPC-RBDAYS(15 2).
           MOVE QSPC-RBYRTYPE-15-2 TO SPC-RBYRTYPE(15 2).
           MOVE QSPC-RBMINRET-15 TO SPC-RBMINRET(15).
           MOVE QSPC-RBNOMON-15 TO SPC-RBNOMON(15).
           MOVE QSPC-RBDEDCHG-15 TO SPC-RBDEDCHG(15).
           MOVE QSPC-RBRECAST-15 TO SPC-RBRECAST(15).
           MOVE QSPC-RBEARLY-15 TO SPC-RBEARLY(15).
           MOVE QSPC-RBDEFER-15 TO SPC-RBDEFER(15).
           MOVE QSPC-RBPCT-15 TO SPC-RBPCT(15).
           MOVE QSPC-RBREDUC-15 TO SPC-RBREDUC(15).
           MOVE QSPC-RBMIN-15 TO SPC-RBMIN(15).
           MOVE QSPC-RBSPOPT1-15 TO SPC-RBSPOPT1(15).
           MOVE QSPC-RBSPOPT2-15 TO SPC-RBSPOPT2(15).
           MOVE QSPC-RBMANAGER-15 TO SPC-RBMANAGER(15).
           MOVE QSPC-RBUNITPER-CD-15 TO SPC-RBUNITPER-CD(15).
           MOVE QSPC-RBFRMLA2-15 TO SPC-RBFRMLA2(15).
           MOVE QSPC-RBFRMLA-16 TO SPC-RBFRMLA(16).
           MOVE QSPC-RBDTE-16-1 TO SPC-RBDTE(16 1).
           MOVE QSPC-RBDAYS-16-1 TO SPC-RBDAYS(16 1).
           MOVE QSPC-RBYRTYPE-16-1 TO SPC-RBYRTYPE(16 1).
           MOVE QSPC-RBDTE-16-2 TO SPC-RBDTE(16 2).
           MOVE QSPC-RBDAYS-16-2 TO SPC-RBDAYS(16 2).
           MOVE QSPC-RBYRTYPE-16-2 TO SPC-RBYRTYPE(16 2).
           MOVE QSPC-RBMINRET-16 TO SPC-RBMINRET(16).
           MOVE QSPC-RBNOMON-16 TO SPC-RBNOMON(16).
           MOVE QSPC-RBDEDCHG-16 TO SPC-RBDEDCHG(16).
           MOVE QSPC-RBRECAST-16 TO SPC-RBRECAST(16).
           MOVE QSPC-RBEARLY-16 TO SPC-RBEARLY(16).
           MOVE QSPC-RBDEFER-16 TO SPC-RBDEFER(16).
           MOVE QSPC-RBPCT-16 TO SPC-RBPCT(16).
           MOVE QSPC-RBREDUC-16 TO SPC-RBREDUC(16).
           MOVE QSPC-RBMIN-16 TO SPC-RBMIN(16).
           MOVE QSPC-RBSPOPT1-16 TO SPC-RBSPOPT1(16).
           MOVE QSPC-RBSPOPT2-16 TO SPC-RBSPOPT2(16).
           MOVE QSPC-RBMANAGER-16 TO SPC-RBMANAGER(16).
           MOVE QSPC-RBUNITPER-CD-16 TO SPC-RBUNITPER-CD(16).
           MOVE QSPC-RBFRMLA2-16 TO SPC-RBFRMLA2(16).
           MOVE QSPC-RBFRMLA-17 TO SPC-RBFRMLA(17).
           MOVE QSPC-RBDTE-17-1 TO SPC-RBDTE(17 1).
           MOVE QSPC-RBDAYS-17-1 TO SPC-RBDAYS(17 1).
           MOVE QSPC-RBYRTYPE-17-1 TO SPC-RBYRTYPE(17 1).
           MOVE QSPC-RBDTE-17-2 TO SPC-RBDTE(17 2).
           MOVE QSPC-RBDAYS-17-2 TO SPC-RBDAYS(17 2).
           MOVE QSPC-RBYRTYPE-17-2 TO SPC-RBYRTYPE(17 2).
           MOVE QSPC-RBMINRET-17 TO SPC-RBMINRET(17).
           MOVE QSPC-RBNOMON-17 TO SPC-RBNOMON(17).
           MOVE QSPC-RBDEDCHG-17 TO SPC-RBDEDCHG(17).
           MOVE QSPC-RBRECAST-17 TO SPC-RBRECAST(17).
           MOVE QSPC-RBEARLY-17 TO SPC-RBEARLY(17).
           MOVE QSPC-RBDEFER-17 TO SPC-RBDEFER(17).
           MOVE QSPC-RBPCT-17 TO SPC-RBPCT(17).
           MOVE QSPC-RBREDUC-17 TO SPC-RBREDUC(17).
           MOVE QSPC-RBMIN-17 TO SPC-RBMIN(17).
           MOVE QSPC-RBSPOPT1-17 TO SPC-RBSPOPT1(17).
           MOVE QSPC-RBSPOPT2-17 TO SPC-RBSPOPT2(17).
           MOVE QSPC-RBMANAGER-17 TO SPC-RBMANAGER(17).
           MOVE QSPC-RBUNITPER-CD-17 TO SPC-RBUNITPER-CD(17).
           MOVE QSPC-RBFRMLA2-17 TO SPC-RBFRMLA2(17).
           MOVE QSPC-RBFRMLA-18 TO SPC-RBFRMLA(18).
           MOVE QSPC-RBDTE-18-1 TO SPC-RBDTE(18 1).
           MOVE QSPC-RBDAYS-18-1 TO SPC-RBDAYS(18 1).
           MOVE QSPC-RBYRTYPE-18-1 TO SPC-RBYRTYPE(18 1).
           MOVE QSPC-RBDTE-18-2 TO SPC-RBDTE(18 2).
           MOVE QSPC-RBDAYS-18-2 TO SPC-RBDAYS(18 2).
           MOVE QSPC-RBYRTYPE-18-2 TO SPC-RBYRTYPE(18 2).
           MOVE QSPC-RBMINRET-18 TO SPC-RBMINRET(18).
           MOVE QSPC-RBNOMON-18 TO SPC-RBNOMON(18).
           MOVE QSPC-RBDEDCHG-18 TO SPC-RBDEDCHG(18).
           MOVE QSPC-RBRECAST-18 TO SPC-RBRECAST(18).
           MOVE QSPC-RBEARLY-18 TO SPC-RBEARLY(18).
           MOVE QSPC-RBDEFER-18 TO SPC-RBDEFER(18).
           MOVE QSPC-RBPCT-18 TO SPC-RBPCT(18).
           MOVE QSPC-RBREDUC-18 TO SPC-RBREDUC(18).
           MOVE QSPC-RBMIN-18 TO SPC-RBMIN(18).
           MOVE QSPC-RBSPOPT1-18 TO SPC-RBSPOPT1(18).
           MOVE QSPC-RBSPOPT2-18 TO SPC-RBSPOPT2(18).
           MOVE QSPC-RBMANAGER-18 TO SPC-RBMANAGER(18).
           MOVE QSPC-RBUNITPER-CD-18 TO SPC-RBUNITPER-CD(18).
           MOVE QSPC-RBFRMLA2-18 TO SPC-RBFRMLA2(18).
           MOVE QSPC-RBFRMLA-19 TO SPC-RBFRMLA(19).
           MOVE QSPC-RBDTE-19-1 TO SPC-RBDTE(19 1).
           MOVE QSPC-RBDAYS-19-1 TO SPC-RBDAYS(19 1).
           MOVE QSPC-RBYRTYPE-19-1 TO SPC-RBYRTYPE(19 1).
           MOVE QSPC-RBDTE-19-2 TO SPC-RBDTE(19 2).
           MOVE QSPC-RBDAYS-19-2 TO SPC-RBDAYS(19 2).
           MOVE QSPC-RBYRTYPE-19-2 TO SPC-RBYRTYPE(19 2).
           MOVE QSPC-RBMINRET-19 TO SPC-RBMINRET(19).
           MOVE QSPC-RBNOMON-19 TO SPC-RBNOMON(19).
           MOVE QSPC-RBDEDCHG-19 TO SPC-RBDEDCHG(19).
           MOVE QSPC-RBRECAST-19 TO SPC-RBRECAST(19).
           MOVE QSPC-RBEARLY-19 TO SPC-RBEARLY(19).
           MOVE QSPC-RBDEFER-19 TO SPC-RBDEFER(19).
           MOVE QSPC-RBPCT-19 TO SPC-RBPCT(19).
           MOVE QSPC-RBREDUC-19 TO SPC-RBREDUC(19).
           MOVE QSPC-RBMIN-19 TO SPC-RBMIN(19).
           MOVE QSPC-RBSPOPT1-19 TO SPC-RBSPOPT1(19).
           MOVE QSPC-RBSPOPT2-19 TO SPC-RBSPOPT2(19).
           MOVE QSPC-RBMANAGER-19 TO SPC-RBMANAGER(19).
           MOVE QSPC-RBUNITPER-CD-19 TO SPC-RBUNITPER-CD(19).
           MOVE QSPC-RBFRMLA2-19 TO SPC-RBFRMLA2(19).
           MOVE QSPC-RBFRMLA-20 TO SPC-RBFRMLA(20).
           MOVE QSPC-RBDTE-20-1 TO SPC-RBDTE(20 1).
           MOVE QSPC-RBDAYS-20-1 TO SPC-RBDAYS(20 1).
           MOVE QSPC-RBYRTYPE-20-1 TO SPC-RBYRTYPE(20 1).
           MOVE QSPC-RBDTE-20-2 TO SPC-RBDTE(20 2).
           MOVE QSPC-RBDAYS-20-2 TO SPC-RBDAYS(20 2).
           MOVE QSPC-RBYRTYPE-20-2 TO SPC-RBYRTYPE(20 2).
           MOVE QSPC-RBMINRET-20 TO SPC-RBMINRET(20).
           MOVE QSPC-RBNOMON-20 TO SPC-RBNOMON(20).
           MOVE QSPC-RBDEDCHG-20 TO SPC-RBDEDCHG(20).
           MOVE QSPC-RBRECAST-20 TO SPC-RBRECAST(20).
           MOVE QSPC-RBEARLY-20 TO SPC-RBEARLY(20).
           MOVE QSPC-RBDEFER-20 TO SPC-RBDEFER(20).
           MOVE QSPC-RBPCT-20 TO SPC-RBPCT(20).
           MOVE QSPC-RBREDUC-20 TO SPC-RBREDUC(20).
           MOVE QSPC-RBMIN-20 TO SPC-RBMIN(20).
           MOVE QSPC-RBSPOPT1-20 TO SPC-RBSPOPT1(20).
           MOVE QSPC-RBSPOPT2-20 TO SPC-RBSPOPT2(20).
           MOVE QSPC-RBMANAGER-20 TO SPC-RBMANAGER(20).
           MOVE QSPC-RBUNITPER-CD-20 TO SPC-RBUNITPER-CD(20).
           MOVE QSPC-RBFRMLA2-20 TO SPC-RBFRMLA2(20).
           MOVE QSPC-RBFRMLA-21 TO SPC-RBFRMLA(21).
           MOVE QSPC-RBDTE-21-1 TO SPC-RBDTE(21 1).
           MOVE QSPC-RBDAYS-21-1 TO SPC-RBDAYS(21 1).
           MOVE QSPC-RBYRTYPE-21-1 TO SPC-RBYRTYPE(21 1).
           MOVE QSPC-RBDTE-21-2 TO SPC-RBDTE(21 2).
           MOVE QSPC-RBDAYS-21-2 TO SPC-RBDAYS(21 2).
           MOVE QSPC-RBYRTYPE-21-2 TO SPC-RBYRTYPE(21 2).
           MOVE QSPC-RBMINRET-21 TO SPC-RBMINRET(21).
           MOVE QSPC-RBNOMON-21 TO SPC-RBNOMON(21).
           MOVE QSPC-RBDEDCHG-21 TO SPC-RBDEDCHG(21).
           MOVE QSPC-RBRECAST-21 TO SPC-RBRECAST(21).
           MOVE QSPC-RBEARLY-21 TO SPC-RBEARLY(21).
           MOVE QSPC-RBDEFER-21 TO SPC-RBDEFER(21).
           MOVE QSPC-RBPCT-21 TO SPC-RBPCT(21).
           MOVE QSPC-RBREDUC-21 TO SPC-RBREDUC(21).
           MOVE QSPC-RBMIN-21 TO SPC-RBMIN(21).
           MOVE QSPC-RBSPOPT1-21 TO SPC-RBSPOPT1(21).
           MOVE QSPC-RBSPOPT2-21 TO SPC-RBSPOPT2(21).
           MOVE QSPC-RBMANAGER-21 TO SPC-RBMANAGER(21).
           MOVE QSPC-RBUNITPER-CD-21 TO SPC-RBUNITPER-CD(21).
           MOVE QSPC-RBFRMLA2-21 TO SPC-RBFRMLA2(21).
           MOVE QSPC-RBFRMLA-22 TO SPC-RBFRMLA(22).
           MOVE QSPC-RBDTE-22-1 TO SPC-RBDTE(22 1).
           MOVE QSPC-RBDAYS-22-1 TO SPC-RBDAYS(22 1).
           MOVE QSPC-RBYRTYPE-22-1 TO SPC-RBYRTYPE(22 1).
           MOVE QSPC-RBDTE-22-2 TO SPC-RBDTE(22 2).
           MOVE QSPC-RBDAYS-22-2 TO SPC-RBDAYS(22 2).
           MOVE QSPC-RBYRTYPE-22-2 TO SPC-RBYRTYPE(22 2).
           MOVE QSPC-RBMINRET-22 TO SPC-RBMINRET(22).
           MOVE QSPC-RBNOMON-22 TO SPC-RBNOMON(22).
           MOVE QSPC-RBDEDCHG-22 TO SPC-RBDEDCHG(22).
           MOVE QSPC-RBRECAST-22 TO SPC-RBRECAST(22).
           MOVE QSPC-RBEARLY-22 TO SPC-RBEARLY(22).
           MOVE QSPC-RBDEFER-22 TO SPC-RBDEFER(22).
           MOVE QSPC-RBPCT-22 TO SPC-RBPCT(22).
           MOVE QSPC-RBREDUC-22 TO SPC-RBREDUC(22).
           MOVE QSPC-RBMIN-22 TO SPC-RBMIN(22).
           MOVE QSPC-RBSPOPT1-22 TO SPC-RBSPOPT1(22).
           MOVE QSPC-RBSPOPT2-22 TO SPC-RBSPOPT2(22).
           MOVE QSPC-RBMANAGER-22 TO SPC-RBMANAGER(22).
           MOVE QSPC-RBUNITPER-CD-22 TO SPC-RBUNITPER-CD(22).
           MOVE QSPC-RBFRMLA2-22 TO SPC-RBFRMLA2(22).
           MOVE QSPC-RBCOMCD TO SPC-RBCOMCD.
           MOVE QSPC-ADDON-DISFRMLA TO SPC-ADDON-DISFRMLA.
           MOVE QSPC-ADDON-WHOLE-FG TO SPC-ADDON-WHOLE-FG.
           MOVE QSPC-ADDON-ORG-MATURITY TO SPC-ADDON-ORG-MATURITY.
           MOVE QSPC-CONSOLIDATE-RT-FG TO SPC-CONSOLIDATE-RT-FG.
           MOVE QSPC-1STPY-ADDON-DAYS TO SPC-1STPY-ADDON-DAYS.
           MOVE QSPC-1STPY-ADDON-YRTYPE TO SPC-1STPY-ADDON-YRTYPE.
           MOVE QSPC-ADDON-RATE-FG TO SPC-ADDON-RATE-FG.
           MOVE QSPC-ADDON-RATE TO SPC-ADDON-RATE.
           MOVE QSPC-FEEFRMLA-1 TO SPC-FEEFRMLA(1).
           MOVE QSPC-FEECD-1 TO SPC-FEECD(1).
           MOVE QSPC-FEEID-1 TO SPC-FEEID(1).
           MOVE QSPC-FEEFRMLA-2 TO SPC-FEEFRMLA(2).
           MOVE QSPC-FEECD-2 TO SPC-FEECD(2).
           MOVE QSPC-FEEID-2 TO SPC-FEEID(2).
           MOVE QSPC-ROUND-PAY-FG TO SPC-ROUND-PAY-FG.
           MOVE QSPC-IRREGULAR-PAY-FG TO SPC-IRREGULAR-PAY-FG.
           MOVE QSPC-DLRVCHGS-RB-CD-1 TO SPC-DLRVCHGS-RB-CD(1).
           MOVE QSPC-DLRVCHGS-RB-CD-2 TO SPC-DLRVCHGS-RB-CD(2).
           MOVE QSPC-DLRVCHGS-RB-CD-3 TO SPC-DLRVCHGS-RB-CD(3).
           MOVE QSPC-PARVHELD-RB-CD TO SPC-PARVHELD-RB-CD.
           MOVE QSPC-PARVPAID-RB-CD TO SPC-PARVPAID-RB-CD.
           MOVE QSPC-CONTR-CREDIT TO SPC-CONTR-CREDIT.
           MOVE QSPC-CONTR-CREDIT-CD TO SPC-CONTR-CREDIT-CD.
           MOVE QSPC-CONTR-CREDIT-MIN-DEL-PER
              TO SPC-CONTR-CREDIT-MIN-DEL-PER.
           MOVE QSPC-OPT-CAL-CHGABLE TO SPC-OPT-CAL-CHGABLE.
           MOVE QSPC-PBDEL-DAYS TO SPC-PBDEL-DAYS.
           MOVE QSPC-PBINCR-PERCENT TO SPC-PBINCR-PERCENT.
           MOVE QSPC-CPOT30-CD TO SPC-CPOT30-CD.
           MOVE QSPC-CPOTCHGOFF-CD TO SPC-CPOTCHGOFF-CD.
           MOVE QSPC-RDPOT30-CD TO SPC-RDPOT30-CD.
           MOVE QSPC-RDPOTCHGOFF-CD TO SPC-RDPOTCHGOFF-CD.
           MOVE QSPC-MAX-ALLOW-DELINQ TO SPC-MAX-ALLOW-DELINQ.
           MOVE QSPC-RESCIND-BUS-DAYS TO SPC-RESCIND-BUS-DAYS.
           MOVE QSPC-RESCIND-SATURDAY TO SPC-RESCIND-SATURDAY.
           MOVE QSPC-MIN-CREDIT-SCORE TO SPC-MIN-CREDIT-SCORE.
           MOVE QSPC-DUAL-IN-BRANCH TO SPC-DUAL-IN-BRANCH.
           MOVE QSPC-DUAL-IN-STATE TO SPC-DUAL-IN-STATE.
           MOVE QSPC-PACESETTER-FG TO SPC-PACESETTER-FG.
           MOVE QSPC-WAGE-ASSIGN-DAYS TO SPC-WAGE-ASSIGN-DAYS.
           MOVE QSPC-CAL-PAYMENT-ROUND-FG TO SPC-CAL-PAYMENT-ROUND-FG.
           MOVE QSPC-CAN-LOANS-FG TO SPC-CAN-LOANS-FG.
           MOVE QSPC-ALLOW-DELINQ-POLCD TO SPC-ALLOW-DELINQ-POLCD.
           MOVE QSPC-YTD-MAX-ALLOW-DELINQ TO SPC-YTD-MAX-ALLOW-DELINQ.
           MOVE QSPC-LNCOST-FRMLA TO SPC-LNCOST-FRMLA.
           MOVE QSPC-LNCOST-AMT TO SPC-LNCOST-AMT.
           MOVE QSPC-DLDISC-RVPRIN1-PCNT TO SPC-DLDISC-RVPRIN1-PCNT.
           MOVE QSPC-RENEWABLE-PAYS TO SPC-RENEWABLE-PAYS.
           MOVE QSPC-RENEWABLE-DAYS TO SPC-RENEWABLE-DAYS.
           MOVE QSPC-ALLOW-LN-BACK-DATE TO SPC-ALLOW-LN-BACK-DATE.
           MOVE QSPC-DLDISC-RVPRIN1-AF-PCNT
              TO SPC-DLDISC-RVPRIN1-AF-PCNT.
           MOVE QSPC-CAL-MAX-AT-ESTIMATE TO SPC-CAL-MAX-AT-ESTIMATE.
           MOVE QSPC-INSAH-RETRO TO SPC-INSAH-RETRO.
           MOVE QSPC-INSAH-DAYS-WAIT TO SPC-INSAH-DAYS-WAIT.
           MOVE QSPC-ADDON-EXCEPT-FG TO SPC-ADDON-EXCEPT-FG.
           MOVE QSPC-REPO-TRCD-1 TO SPC-REPO-TRCD(1).
           MOVE QSPC-REPO-FMNO-1-1 TO SPC-REPO-FMNO(1 1).
           MOVE QSPC-REPO-FMNO-1-2 TO SPC-REPO-FMNO(1 2).
           MOVE QSPC-REPO-FMNO-1-3 TO SPC-REPO-FMNO(1 3).
           MOVE QSPC-REPO-FMNO-1-4 TO SPC-REPO-FMNO(1 4).
           MOVE QSPC-REPO-TRCD-2 TO SPC-REPO-TRCD(2).
           MOVE QSPC-REPO-FMNO-2-1 TO SPC-REPO-FMNO(2 1).
           MOVE QSPC-REPO-FMNO-2-2 TO SPC-REPO-FMNO(2 2).
           MOVE QSPC-REPO-FMNO-2-3 TO SPC-REPO-FMNO(2 3).
           MOVE QSPC-REPO-FMNO-2-4 TO SPC-REPO-FMNO(2 4).
           MOVE QSPC-REPO-TRCD-3 TO SPC-REPO-TRCD(3).
           MOVE QSPC-REPO-FMNO-3-1 TO SPC-REPO-FMNO(3 1).
           MOVE QSPC-REPO-FMNO-3-2 TO SPC-REPO-FMNO(3 2).
           MOVE QSPC-REPO-FMNO-3-3 TO SPC-REPO-FMNO(3 3).
           MOVE QSPC-REPO-FMNO-3-4 TO SPC-REPO-FMNO(3 4).
           MOVE QSPC-CANCEL-ADDON-FG TO SPC-CANCEL-ADDON-FG.
           MOVE QSPC-DEFAULT-O2-INS-COMP TO SPC-DEFAULT-O2-INS-COMP.
           MOVE QSPC-LC-ON-JUDGEMENTS TO SPC-LC-ON-JUDGEMENTS.
           MOVE QSPC-DELQ-IB-AGE TO SPC-DELQ-IB-AGE.
           MOVE QSPC-DELQ-IB-MAX-DAYS TO SPC-DELQ-IB-MAX-DAYS.
           MOVE QSPC-INSURANCE-WRITTEN TO SPC-INSURANCE-WRITTEN.
           MOVE QSPC-INTERIM-COUPON TO SPC-INTERIM-COUPON.
           MOVE QSPC-AUTO-ASSESS-LCHG TO SPC-AUTO-ASSESS-LCHG.
           MOVE QSPC-MAX-CASH-PROCEEDS TO SPC-MAX-CASH-PROCEEDS.
           MOVE QSPC-ALLOW-ZERO-PROC TO SPC-ALLOW-ZERO-PROC.
           MOVE QSPC-BANKRULE-RATE TO SPC-BANKRULE-RATE.
           MOVE QSPC-AUTO-SEND-TRCD-1 TO SPC-AUTO-SEND-TRCD(1).
           MOVE QSPC-AUTO-SEND-FMNO-1-1 TO SPC-AUTO-SEND-FMNO(1 1).
           MOVE QSPC-AUTO-SEND-FMNO-1-2 TO SPC-AUTO-SEND-FMNO(1 2).
           MOVE QSPC-AUTO-SEND-FMNO-1-3 TO SPC-AUTO-SEND-FMNO(1 3).
           MOVE QSPC-AUTO-SEND-FMNO-1-4 TO SPC-AUTO-SEND-FMNO(1 4).
           MOVE QSPC-AUTO-SEND-TRCD-2 TO SPC-AUTO-SEND-TRCD(2).
           MOVE QSPC-AUTO-SEND-FMNO-2-1 TO SPC-AUTO-SEND-FMNO(2 1).
           MOVE QSPC-AUTO-SEND-FMNO-2-2 TO SPC-AUTO-SEND-FMNO(2 2).
           MOVE QSPC-AUTO-SEND-FMNO-2-3 TO SPC-AUTO-SEND-FMNO(2 3).
           MOVE QSPC-AUTO-SEND-FMNO-2-4 TO SPC-AUTO-SEND-FMNO(2 4).
           MOVE QSPC-DLDISC-CONV-BF-PCNT TO SPC-DLDISC-CONV-BF-PCNT.
           MOVE QSPC-UNITPER-CD TO SPC-UNITPER-CD.
           MOVE QSPC-RENEWAL-EDIT TO SPC-RENEWAL-EDIT.
           MOVE QSPC-ROUND-MFEE TO SPC-ROUND-MFEE.
           MOVE QSPC-ADV-TO-1ST-NO-CORR TO SPC-ADV-TO-1ST-NO-CORR.
           MOVE QSPC-LC-INT-ON-REPO-NON-PL
              TO SPC-LC-INT-ON-REPO-NON-PL.
           MOVE QSPC-CONTRACTUAL-SET-NONACCRUAL
              TO SPC-CONTRACTUAL-SET-NONACCRUAL.
           MOVE QSPC-CONTRACTUAL-RESET-ACCRUAL
              TO SPC-CONTRACTUAL-RESET-ACCRUAL.
           MOVE QSPC-MONTHS-PAY-NAPP-COUNTER
              TO SPC-MONTHS-PAY-NAPP-COUNTER.
           MOVE QSPC-SHORT-PAY-THRESHOLD TO SPC-SHORT-PAY-THRESHOLD.
           MOVE QSPC-CASH-AVAIL-PERCENT TO SPC-CASH-AVAIL-PERCENT.
           MOVE QSPC-O1-JOINT-FG TO SPC-O1-JOINT-FG.
           MOVE QSPC-NET-BAL-REQ TO SPC-NET-BAL-REQ.
           MOVE QSPC-AMT-PROCEEDS-REQ TO SPC-AMT-PROCEEDS-REQ.
           MOVE QSPC-ALT-PREPAY-MONTHS TO SPC-ALT-PREPAY-MONTHS.
           MOVE QSPC-PERCENT-REGPAY-AVAIL TO SPC-PERCENT-REGPAY-AVAIL.
           MOVE QSPC-ALT-DEFFRMLA TO SPC-ALT-DEFFRMLA.
           MOVE QSPC-ALT-DEFMIN TO SPC-ALT-DEFMIN.
           MOVE QSPC-ALT-DEFMAX TO SPC-ALT-DEFMAX.
           MOVE QSPC-NON-LOAN-FLAG TO SPC-NON-LOAN-FLAG.
           MOVE QSPC-SKIP-TRW TO SPC-SKIP-TRW.
 
      *-----------------------------------------------------------------
      *    LOAD QSPC-REC FROM SPC-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-SPC-FIELDS.
           MOVE SPC-ORGST TO QSPC-ORGST.
           MOVE SPC-SPRCLASS TO QSPC-SPRCLASS.
           MOVE SPC-SUBCLASS TO QSPC-SUBCLASS.
           MOVE SPC-LAWCODE TO QSPC-LAWCODE.
           MOVE SPC-INSEARN-ORDER(1) TO QSPC-INSEARN-ORDER-1.
           MOVE SPC-INSEARN-ORDER(2) TO QSPC-INSEARN-ORDER-2.
           MOVE SPC-INSEARN-ORDER(3) TO QSPC-INSEARN-ORDER-3.
           MOVE SPC-INSEARN-ORDER(4) TO QSPC-INSEARN-ORDER-4.
           MOVE SPC-INSEARN-ORDER(5) TO QSPC-INSEARN-ORDER-5.
           MOVE SPC-INSEARN-ORDER(6) TO QSPC-INSEARN-ORDER-6.
           MOVE SPC-INSEARN-ORDER(7) TO QSPC-INSEARN-ORDER-7.
           MOVE SPC-INSEARN-ORDER(8) TO QSPC-INSEARN-ORDER-8.
           MOVE SPC-INSEARN-ORDER(9) TO QSPC-INSEARN-ORDER-9.
           MOVE SPC-INSEARN-ORDER(10) TO QSPC-INSEARN-ORDER-10.
           MOVE SPC-INSEARN-ORDER(11) TO QSPC-INSEARN-ORDER-11.
           MOVE SPC-INSEARN-ORDER(12) TO QSPC-INSEARN-ORDER-12.
           MOVE SPC-INSAH-JOINT-FG TO QSPC-INSAH-JOINT-FG.
           MOVE SPC-INS-O1-EDIT TO QSPC-INS-O1-EDIT.
           MOVE SPC-INS-O2-EDIT TO QSPC-INS-O2-EDIT.
           MOVE SPC-RBFRMLA(1) TO QSPC-RBFRMLA-1.
           MOVE SPC-RBDTE(1 1) TO QSPC-RBDTE-1-1.
           MOVE SPC-RBDAYS(1 1) TO QSPC-RBDAYS-1-1.
           MOVE SPC-RBYRTYPE(1 1) TO QSPC-RBYRTYPE-1-1.
           MOVE SPC-RBDTE(1 2) TO QSPC-RBDTE-1-2.
           MOVE SPC-RBDAYS(1 2) TO QSPC-RBDAYS-1-2.
           MOVE SPC-RBYRTYPE(1 2) TO QSPC-RBYRTYPE-1-2.
           MOVE SPC-RBMINRET(1) TO QSPC-RBMINRET-1.
           MOVE SPC-RBNOMON(1) TO QSPC-RBNOMON-1.
           MOVE SPC-RBDEDCHG(1) TO QSPC-RBDEDCHG-1.
           MOVE SPC-RBRECAST(1) TO QSPC-RBRECAST-1.
           MOVE SPC-RBEARLY(1) TO QSPC-RBEARLY-1.
           MOVE SPC-RBDEFER(1) TO QSPC-RBDEFER-1.
           MOVE SPC-RBPCT(1) TO QSPC-RBPCT-1.
           MOVE SPC-RBREDUC(1) TO QSPC-RBREDUC-1.
           MOVE SPC-RBMIN(1) TO QSPC-RBMIN-1.
           MOVE SPC-RBSPOPT1(1) TO QSPC-RBSPOPT1-1.
           MOVE SPC-RBSPOPT2(1) TO QSPC-RBSPOPT2-1.
           MOVE SPC-RBMANAGER(1) TO QSPC-RBMANAGER-1.
           MOVE SPC-RBUNITPER-CD(1) TO QSPC-RBUNITPER-CD-1.
           MOVE SPC-RBFRMLA2(1) TO QSPC-RBFRMLA2-1.
           MOVE SPC-RBFRMLA(2) TO QSPC-RBFRMLA-2.
           MOVE SPC-RBDTE(2 1) TO QSPC-RBDTE-2-1.
           MOVE SPC-RBDAYS(2 1) TO QSPC-RBDAYS-2-1.
           MOVE SPC-RBYRTYPE(2 1) TO QSPC-RBYRTYPE-2-1.
           MOVE SPC-RBDTE(2 2) TO QSPC-RBDTE-2-2.
           MOVE SPC-RBDAYS(2 2) TO QSPC-RBDAYS-2-2.
           MOVE SPC-RBYRTYPE(2 2) TO QSPC-RBYRTYPE-2-2.
           MOVE SPC-RBMINRET(2) TO QSPC-RBMINRET-2.
           MOVE SPC-RBNOMON(2) TO QSPC-RBNOMON-2.
           MOVE SPC-RBDEDCHG(2) TO QSPC-RBDEDCHG-2.
           MOVE SPC-RBRECAST(2) TO QSPC-RBRECAST-2.
           MOVE SPC-RBEARLY(2) TO QSPC-RBEARLY-2.
           MOVE SPC-RBDEFER(2) TO QSPC-RBDEFER-2.
           MOVE SPC-RBPCT(2) TO QSPC-RBPCT-2.
           MOVE SPC-RBREDUC(2) TO QSPC-RBREDUC-2.
           MOVE SPC-RBMIN(2) TO QSPC-RBMIN-2.
           MOVE SPC-RBSPOPT1(2) TO QSPC-RBSPOPT1-2.
           MOVE SPC-RBSPOPT2(2) TO QSPC-RBSPOPT2-2.
           MOVE SPC-RBMANAGER(2) TO QSPC-RBMANAGER-2.
           MOVE SPC-RBUNITPER-CD(2) TO QSPC-RBUNITPER-CD-2.
           MOVE SPC-RBFRMLA2(2) TO QSPC-RBFRMLA2-2.
           MOVE SPC-RBFRMLA(3) TO QSPC-RBFRMLA-3.
           MOVE SPC-RBDTE(3 1) TO QSPC-RBDTE-3-1.
           MOVE SPC-RBDAYS(3 1) TO QSPC-RBDAYS-3-1.
           MOVE SPC-RBYRTYPE(3 1) TO QSPC-RBYRTYPE-3-1.
           MOVE SPC-RBDTE(3 2) TO QSPC-RBDTE-3-2.
           MOVE SPC-RBDAYS(3 2) TO QSPC-RBDAYS-3-2.
           MOVE SPC-RBYRTYPE(3 2) TO QSPC-RBYRTYPE-3-2.
           MOVE SPC-RBMINRET(3) TO QSPC-RBMINRET-3.
           MOVE SPC-RBNOMON(3) TO QSPC-RBNOMON-3.
           MOVE SPC-RBDEDCHG(3) TO QSPC-RBDEDCHG-3.
           MOVE SPC-RBRECAST(3) TO QSPC-RBRECAST-3.
           MOVE SPC-RBEARLY(3) TO QSPC-RBEARLY-3.
           MOVE SPC-RBDEFER(3) TO QSPC-RBDEFER-3.
           MOVE SPC-RBPCT(3) TO QSPC-RBPCT-3.
           MOVE SPC-RBREDUC(3) TO QSPC-RBREDUC-3.
           MOVE SPC-RBMIN(3) TO QSPC-RBMIN-3.
           MOVE SPC-RBSPOPT1(3) TO QSPC-RBSPOPT1-3.
           MOVE SPC-RBSPOPT2(3) TO QSPC-RBSPOPT2-3.
           MOVE SPC-RBMANAGER(3) TO QSPC-RBMANAGER-3.
           MOVE SPC-RBUNITPER-CD(3) TO QSPC-RBUNITPER-CD-3.
           MOVE SPC-RBFRMLA2(3) TO QSPC-RBFRMLA2-3.
           MOVE SPC-RBFRMLA(4) TO QSPC-RBFRMLA-4.
           MOVE SPC-RBDTE(4 1) TO QSPC-RBDTE-4-1.
           MOVE SPC-RBDAYS(4 1) TO QSPC-RBDAYS-4-1.
           MOVE SPC-RBYRTYPE(4 1) TO QSPC-RBYRTYPE-4-1.
           MOVE SPC-RBDTE(4 2) TO QSPC-RBDTE-4-2.
           MOVE SPC-RBDAYS(4 2) TO QSPC-RBDAYS-4-2.
           MOVE SPC-RBYRTYPE(4 2) TO QSPC-RBYRTYPE-4-2.
           MOVE SPC-RBMINRET(4) TO QSPC-RBMINRET-4.
           MOVE SPC-RBNOMON(4) TO QSPC-RBNOMON-4.
           MOVE SPC-RBDEDCHG(4) TO QSPC-RBDEDCHG-4.
           MOVE SPC-RBRECAST(4) TO QSPC-RBRECAST-4.
           MOVE SPC-RBEARLY(4) TO QSPC-RBEARLY-4.
           MOVE SPC-RBDEFER(4) TO QSPC-RBDEFER-4.
           MOVE SPC-RBPCT(4) TO QSPC-RBPCT-4.
           MOVE SPC-RBREDUC(4) TO QSPC-RBREDUC-4.
           MOVE SPC-RBMIN(4) TO QSPC-RBMIN-4.
           MOVE SPC-RBSPOPT1(4) TO QSPC-RBSPOPT1-4.
           MOVE SPC-RBSPOPT2(4) TO QSPC-RBSPOPT2-4.
           MOVE SPC-RBMANAGER(4) TO QSPC-RBMANAGER-4.
           MOVE SPC-RBUNITPER-CD(4) TO QSPC-RBUNITPER-CD-4.
           MOVE SPC-RBFRMLA2(4) TO QSPC-RBFRMLA2-4.
           MOVE SPC-RBFRMLA(5) TO QSPC-RBFRMLA-5.
           MOVE SPC-RBDTE(5 1) TO QSPC-RBDTE-5-1.
           MOVE SPC-RBDAYS(5 1) TO QSPC-RBDAYS-5-1.
           MOVE SPC-RBYRTYPE(5 1) TO QSPC-RBYRTYPE-5-1.
           MOVE SPC-RBDTE(5 2) TO QSPC-RBDTE-5-2.
           MOVE SPC-RBDAYS(5 2) TO QSPC-RBDAYS-5-2.
           MOVE SPC-RBYRTYPE(5 2) TO QSPC-RBYRTYPE-5-2.
           MOVE SPC-RBMINRET(5) TO QSPC-RBMINRET-5.
           MOVE SPC-RBNOMON(5) TO QSPC-RBNOMON-5.
           MOVE SPC-RBDEDCHG(5) TO QSPC-RBDEDCHG-5.
           MOVE SPC-RBRECAST(5) TO QSPC-RBRECAST-5.
           MOVE SPC-RBEARLY(5) TO QSPC-RBEARLY-5.
           MOVE SPC-RBDEFER(5) TO QSPC-RBDEFER-5.
           MOVE SPC-RBPCT(5) TO QSPC-RBPCT-5.
           MOVE SPC-RBREDUC(5) TO QSPC-RBREDUC-5.
           MOVE SPC-RBMIN(5) TO QSPC-RBMIN-5.
           MOVE SPC-RBSPOPT1(5) TO QSPC-RBSPOPT1-5.
           MOVE SPC-RBSPOPT2(5) TO QSPC-RBSPOPT2-5.
           MOVE SPC-RBMANAGER(5) TO QSPC-RBMANAGER-5.
           MOVE SPC-RBUNITPER-CD(5) TO QSPC-RBUNITPER-CD-5.
           MOVE SPC-RBFRMLA2(5) TO QSPC-RBFRMLA2-5.
           MOVE SPC-RBFRMLA(6) TO QSPC-RBFRMLA-6.
           MOVE SPC-RBDTE(6 1) TO QSPC-RBDTE-6-1.
           MOVE SPC-RBDAYS(6 1) TO QSPC-RBDAYS-6-1.
           MOVE SPC-RBYRTYPE(6 1) TO QSPC-RBYRTYPE-6-1.
           MOVE SPC-RBDTE(6 2) TO QSPC-RBDTE-6-2.
           MOVE SPC-RBDAYS(6 2) TO QSPC-RBDAYS-6-2.
           MOVE SPC-RBYRTYPE(6 2) TO QSPC-RBYRTYPE-6-2.
           MOVE SPC-RBMINRET(6) TO QSPC-RBMINRET-6.
           MOVE SPC-RBNOMON(6) TO QSPC-RBNOMON-6.
           MOVE SPC-RBDEDCHG(6) TO QSPC-RBDEDCHG-6.
           MOVE SPC-RBRECAST(6) TO QSPC-RBRECAST-6.
           MOVE SPC-RBEARLY(6) TO QSPC-RBEARLY-6.
           MOVE SPC-RBDEFER(6) TO QSPC-RBDEFER-6.
           MOVE SPC-RBPCT(6) TO QSPC-RBPCT-6.
           MOVE SPC-RBREDUC(6) TO QSPC-RBREDUC-6.
           MOVE SPC-RBMIN(6) TO QSPC-RBMIN-6.
           MOVE SPC-RBSPOPT1(6) TO QSPC-RBSPOPT1-6.
           MOVE SPC-RBSPOPT2(6) TO QSPC-RBSPOPT2-6.
           MOVE SPC-RBMANAGER(6) TO QSPC-RBMANAGER-6.
           MOVE SPC-RBUNITPER-CD(6) TO QSPC-RBUNITPER-CD-6.
           MOVE SPC-RBFRMLA2(6) TO QSPC-RBFRMLA2-6.
           MOVE SPC-RBFRMLA(7) TO QSPC-RBFRMLA-7.
           MOVE SPC-RBDTE(7 1) TO QSPC-RBDTE-7-1.
           MOVE SPC-RBDAYS(7 1) TO QSPC-RBDAYS-7-1.
           MOVE SPC-RBYRTYPE(7 1) TO QSPC-RBYRTYPE-7-1.
           MOVE SPC-RBDTE(7 2) TO QSPC-RBDTE-7-2.
           MOVE SPC-RBDAYS(7 2) TO QSPC-RBDAYS-7-2.
           MOVE SPC-RBYRTYPE(7 2) TO QSPC-RBYRTYPE-7-2.
           MOVE SPC-RBMINRET(7) TO QSPC-RBMINRET-7.
           MOVE SPC-RBNOMON(7) TO QSPC-RBNOMON-7.
           MOVE SPC-RBDEDCHG(7) TO QSPC-RBDEDCHG-7.
           MOVE SPC-RBRECAST(7) TO QSPC-RBRECAST-7.
           MOVE SPC-RBEARLY(7) TO QSPC-RBEARLY-7.
           MOVE SPC-RBDEFER(7) TO QSPC-RBDEFER-7.
           MOVE SPC-RBPCT(7) TO QSPC-RBPCT-7.
           MOVE SPC-RBREDUC(7) TO QSPC-RBREDUC-7.
           MOVE SPC-RBMIN(7) TO QSPC-RBMIN-7.
           MOVE SPC-RBSPOPT1(7) TO QSPC-RBSPOPT1-7.
           MOVE SPC-RBSPOPT2(7) TO QSPC-RBSPOPT2-7.
           MOVE SPC-RBMANAGER(7) TO QSPC-RBMANAGER-7.
           MOVE SPC-RBUNITPER-CD(7) TO QSPC-RBUNITPER-CD-7.
           MOVE SPC-RBFRMLA2(7) TO QSPC-RBFRMLA2-7.
           MOVE SPC-RBFRMLA(8) TO QSPC-RBFRMLA-8.
           MOVE SPC-RBDTE(8 1) TO QSPC-RBDTE-8-1.
           MOVE SPC-RBDAYS(8 1) TO QSPC-RBDAYS-8-1.
           MOVE SPC-RBYRTYPE(8 1) TO QSPC-RBYRTYPE-8-1.
           MOVE SPC-RBDTE(8 2) TO QSPC-RBDTE-8-2.
           MOVE SPC-RBDAYS(8 2) TO QSPC-RBDAYS-8-2.
           MOVE SPC-RBYRTYPE(8 2) TO QSPC-RBYRTYPE-8-2.
           MOVE SPC-RBMINRET(8) TO QSPC-RBMINRET-8.
           MOVE SPC-RBNOMON(8) TO QSPC-RBNOMON-8.
           MOVE SPC-RBDEDCHG(8) TO QSPC-RBDEDCHG-8.
           MOVE SPC-RBRECAST(8) TO QSPC-RBRECAST-8.
           MOVE SPC-RBEARLY(8) TO QSPC-RBEARLY-8.
           MOVE SPC-RBDEFER(8) TO QSPC-RBDEFER-8.
           MOVE SPC-RBPCT(8) TO QSPC-RBPCT-8.
           MOVE SPC-RBREDUC(8) TO QSPC-RBREDUC-8.
           MOVE SPC-RBMIN(8) TO QSPC-RBMIN-8.
           MOVE SPC-RBSPOPT1(8) TO QSPC-RBSPOPT1-8.
           MOVE SPC-RBSPOPT2(8) TO QSPC-RBSPOPT2-8.
           MOVE SPC-RBMANAGER(8) TO QSPC-RBMANAGER-8.
           MOVE SPC-RBUNITPER-CD(8) TO QSPC-RBUNITPER-CD-8.
           MOVE SPC-RBFRMLA2(8) TO QSPC-RBFRMLA2-8.
           MOVE SPC-RBFRMLA(9) TO QSPC-RBFRMLA-9.
           MOVE SPC-RBDTE(9 1) TO QSPC-RBDTE-9-1.
           MOVE SPC-RBDAYS(9 1) TO QSPC-RBDAYS-9-1.
           MOVE SPC-RBYRTYPE(9 1) TO QSPC-RBYRTYPE-9-1.
           MOVE SPC-RBDTE(9 2) TO QSPC-RBDTE-9-2.
           MOVE SPC-RBDAYS(9 2) TO QSPC-RBDAYS-9-2.
           MOVE SPC-RBYRTYPE(9 2) TO QSPC-RBYRTYPE-9-2.
           MOVE SPC-RBMINRET(9) TO QSPC-RBMINRET-9.
           MOVE SPC-RBNOMON(9) TO QSPC-RBNOMON-9.
           MOVE SPC-RBDEDCHG(9) TO QSPC-RBDEDCHG-9.
           MOVE SPC-RBRECAST(9) TO QSPC-RBRECAST-9.
           MOVE SPC-RBEARLY(9) TO QSPC-RBEARLY-9.
           MOVE SPC-RBDEFER(9) TO QSPC-RBDEFER-9.
           MOVE SPC-RBPCT(9) TO QSPC-RBPCT-9.
           MOVE SPC-RBREDUC(9) TO QSPC-RBREDUC-9.
           MOVE SPC-RBMIN(9) TO QSPC-RBMIN-9.
           MOVE SPC-RBSPOPT1(9) TO QSPC-RBSPOPT1-9.
           MOVE SPC-RBSPOPT2(9) TO QSPC-RBSPOPT2-9.
           MOVE SPC-RBMANAGER(9) TO QSPC-RBMANAGER-9.
           MOVE SPC-RBUNITPER-CD(9) TO QSPC-RBUNITPER-CD-9.
           MOVE SPC-RBFRMLA2(9) TO QSPC-RBFRMLA2-9.
           MOVE SPC-RBFRMLA(10) TO QSPC-RBFRMLA-10.
           MOVE SPC-RBDTE(10 1) TO QSPC-RBDTE-10-1.
           MOVE SPC-RBDAYS(10 1) TO QSPC-RBDAYS-10-1.
           MOVE SPC-RBYRTYPE(10 1) TO QSPC-RBYRTYPE-10-1.
           MOVE SPC-RBDTE(10 2) TO QSPC-RBDTE-10-2.
           MOVE SPC-RBDAYS(10 2) TO QSPC-RBDAYS-10-2.
           MOVE SPC-RBYRTYPE(10 2) TO QSPC-RBYRTYPE-10-2.
           MOVE SPC-RBMINRET(10) TO QSPC-RBMINRET-10.
           MOVE SPC-RBNOMON(10) TO QSPC-RBNOMON-10.
           MOVE SPC-RBDEDCHG(10) TO QSPC-RBDEDCHG-10.
           MOVE SPC-RBRECAST(10) TO QSPC-RBRECAST-10.
           MOVE SPC-RBEARLY(10) TO QSPC-RBEARLY-10.
           MOVE SPC-RBDEFER(10) TO QSPC-RBDEFER-10.
           MOVE SPC-RBPCT(10) TO QSPC-RBPCT-10.
           MOVE SPC-RBREDUC(10) TO QSPC-RBREDUC-10.
           MOVE SPC-RBMIN(10) TO QSPC-RBMIN-10.
           MOVE SPC-RBSPOPT1(10) TO QSPC-RBSPOPT1-10.
           MOVE SPC-RBSPOPT2(10) TO QSPC-RBSPOPT2-10.
           MOVE SPC-RBMANAGER(10) TO QSPC-RBMANAGER-10.
           MOVE SPC-RBUNITPER-CD(10) TO QSPC-RBUNITPER-CD-10.
           MOVE SPC-RBFRMLA2(10) TO QSPC-RBFRMLA2-10.
           MOVE SPC-RBFRMLA(11) TO QSPC-RBFRMLA-11.
           MOVE SPC-RBDTE(11 1) TO QSPC-RBDTE-11-1.
           MOVE SPC-RBDAYS(11 1) TO QSPC-RBDAYS-11-1.
           MOVE SPC-RBYRTYPE(11 1) TO QSPC-RBYRTYPE-11-1.
           MOVE SPC-RBDTE(11 2) TO QSPC-RBDTE-11-2.
           MOVE SPC-RBDAYS(11 2) TO QSPC-RBDAYS-11-2.
           MOVE SPC-RBYRTYPE(11 2) TO QSPC-RBYRTYPE-11-2.
           MOVE SPC-RBMINRET(11) TO QSPC-RBMINRET-11.
           MOVE SPC-RBNOMON(11) TO QSPC-RBNOMON-11.
           MOVE SPC-RBDEDCHG(11) TO QSPC-RBDEDCHG-11.
           MOVE SPC-RBRECAST(11) TO QSPC-RBRECAST-11.
           MOVE SPC-RBEARLY(11) TO QSPC-RBEARLY-11.
           MOVE SPC-RBDEFER(11) TO QSPC-RBDEFER-11.
           MOVE SPC-RBPCT(11) TO QSPC-RBPCT-11.
           MOVE SPC-RBREDUC(11) TO QSPC-RBREDUC-11.
           MOVE SPC-RBMIN(11) TO QSPC-RBMIN-11.
           MOVE SPC-RBSPOPT1(11) TO QSPC-RBSPOPT1-11.
           MOVE SPC-RBSPOPT2(11) TO QSPC-RBSPOPT2-11.
           MOVE SPC-RBMANAGER(11) TO QSPC-RBMANAGER-11.
           MOVE SPC-RBUNITPER-CD(11) TO QSPC-RBUNITPER-CD-11.
           MOVE SPC-RBFRMLA2(11) TO QSPC-RBFRMLA2-11.
           MOVE SPC-RBFRMLA(12) TO QSPC-RBFRMLA-12.
           MOVE SPC-RBDTE(12 1) TO QSPC-RBDTE-12-1.
           MOVE SPC-RBDAYS(12 1) TO QSPC-RBDAYS-12-1.
           MOVE SPC-RBYRTYPE(12 1) TO QSPC-RBYRTYPE-12-1.
           MOVE SPC-RBDTE(12 2) TO QSPC-RBDTE-12-2.
           MOVE SPC-RBDAYS(12 2) TO QSPC-RBDAYS-12-2.
           MOVE SPC-RBYRTYPE(12 2) TO QSPC-RBYRTYPE-12-2.
           MOVE SPC-RBMINRET(12) TO QSPC-RBMINRET-12.
           MOVE SPC-RBNOMON(12) TO QSPC-RBNOMON-12.
           MOVE SPC-RBDEDCHG(12) TO QSPC-RBDEDCHG-12.
           MOVE SPC-RBRECAST(12) TO QSPC-RBRECAST-12.
           MOVE SPC-RBEARLY(12) TO QSPC-RBEARLY-12.
           MOVE SPC-RBDEFER(12) TO QSPC-RBDEFER-12.
           MOVE SPC-RBPCT(12) TO QSPC-RBPCT-12.
           MOVE SPC-RBREDUC(12) TO QSPC-RBREDUC-12.
           MOVE SPC-RBMIN(12) TO QSPC-RBMIN-12.
           MOVE SPC-RBSPOPT1(12) TO QSPC-RBSPOPT1-12.
           MOVE SPC-RBSPOPT2(12) TO QSPC-RBSPOPT2-12.
           MOVE SPC-RBMANAGER(12) TO QSPC-RBMANAGER-12.
           MOVE SPC-RBUNITPER-CD(12) TO QSPC-RBUNITPER-CD-12.
           MOVE SPC-RBFRMLA2(12) TO QSPC-RBFRMLA2-12.
           MOVE SPC-RBFRMLA(13) TO QSPC-RBFRMLA-13.
           MOVE SPC-RBDTE(13 1) TO QSPC-RBDTE-13-1.
           MOVE SPC-RBDAYS(13 1) TO QSPC-RBDAYS-13-1.
           MOVE SPC-RBYRTYPE(13 1) TO QSPC-RBYRTYPE-13-1.
           MOVE SPC-RBDTE(13 2) TO QSPC-RBDTE-13-2.
           MOVE SPC-RBDAYS(13 2) TO QSPC-RBDAYS-13-2.
           MOVE SPC-RBYRTYPE(13 2) TO QSPC-RBYRTYPE-13-2.
           MOVE SPC-RBMINRET(13) TO QSPC-RBMINRET-13.
           MOVE SPC-RBNOMON(13) TO QSPC-RBNOMON-13.
           MOVE SPC-RBDEDCHG(13) TO QSPC-RBDEDCHG-13.
           MOVE SPC-RBRECAST(13) TO QSPC-RBRECAST-13.
           MOVE SPC-RBEARLY(13) TO QSPC-RBEARLY-13.
           MOVE SPC-RBDEFER(13) TO QSPC-RBDEFER-13.
           MOVE SPC-RBPCT(13) TO QSPC-RBPCT-13.
           MOVE SPC-RBREDUC(13) TO QSPC-RBREDUC-13.
           MOVE SPC-RBMIN(13) TO QSPC-RBMIN-13.
           MOVE SPC-RBSPOPT1(13) TO QSPC-RBSPOPT1-13.
           MOVE SPC-RBSPOPT2(13) TO QSPC-RBSPOPT2-13.
           MOVE SPC-RBMANAGER(13) TO QSPC-RBMANAGER-13.
           MOVE SPC-RBUNITPER-CD(13) TO QSPC-RBUNITPER-CD-13.
           MOVE SPC-RBFRMLA2(13) TO QSPC-RBFRMLA2-13.
           MOVE SPC-RBFRMLA(14) TO QSPC-RBFRMLA-14.
           MOVE SPC-RBDTE(14 1) TO QSPC-RBDTE-14-1.
           MOVE SPC-RBDAYS(14 1) TO QSPC-RBDAYS-14-1.
           MOVE SPC-RBYRTYPE(14 1) TO QSPC-RBYRTYPE-14-1.
           MOVE SPC-RBDTE(14 2) TO QSPC-RBDTE-14-2.
           MOVE SPC-RBDAYS(14 2) TO QSPC-RBDAYS-14-2.
           MOVE SPC-RBYRTYPE(14 2) TO QSPC-RBYRTYPE-14-2.
           MOVE SPC-RBMINRET(14) TO QSPC-RBMINRET-14.
           MOVE SPC-RBNOMON(14) TO QSPC-RBNOMON-14.
           MOVE SPC-RBDEDCHG(14) TO QSPC-RBDEDCHG-14.
           MOVE SPC-RBRECAST(14) TO QSPC-RBRECAST-14.
           MOVE SPC-RBEARLY(14) TO QSPC-RBEARLY-14.
           MOVE SPC-RBDEFER(14) TO QSPC-RBDEFER-14.
           MOVE SPC-RBPCT(14) TO QSPC-RBPCT-14.
           MOVE SPC-RBREDUC(14) TO QSPC-RBREDUC-14.
           MOVE SPC-RBMIN(14) TO QSPC-RBMIN-14.
           MOVE SPC-RBSPOPT1(14) TO QSPC-RBSPOPT1-14.
           MOVE SPC-RBSPOPT2(14) TO QSPC-RBSPOPT2-14.
           MOVE SPC-RBMANAGER(14) TO QSPC-RBMANAGER-14.
           MOVE SPC-RBUNITPER-CD(14) TO QSPC-RBUNITPER-CD-14.
           MOVE SPC-RBFRMLA2(14) TO QSPC-RBFRMLA2-14.
           MOVE SPC-RBFRMLA(15) TO QSPC-RBFRMLA-15.
           MOVE SPC-RBDTE(15 1) TO QSPC-RBDTE-15-1.
           MOVE SPC-RBDAYS(15 1) TO QSPC-RBDAYS-15-1.
           MOVE SPC-RBYRTYPE(15 1) TO QSPC-RBYRTYPE-15-1.
           MOVE SPC-RBDTE(15 2) TO QSPC-RBDTE-15-2.
           MOVE SPC-RBDAYS(15 2) TO QSPC-RBDAYS-15-2.
           MOVE SPC-RBYRTYPE(15 2) TO QSPC-RBYRTYPE-15-2.
           MOVE SPC-RBMINRET(15) TO QSPC-RBMINRET-15.
           MOVE SPC-RBNOMON(15) TO QSPC-RBNOMON-15.
           MOVE SPC-RBDEDCHG(15) TO QSPC-RBDEDCHG-15.
           MOVE SPC-RBRECAST(15) TO QSPC-RBRECAST-15.
           MOVE SPC-RBEARLY(15) TO QSPC-RBEARLY-15.
           MOVE SPC-RBDEFER(15) TO QSPC-RBDEFER-15.
           MOVE SPC-RBPCT(15) TO QSPC-RBPCT-15.
           MOVE SPC-RBREDUC(15) TO QSPC-RBREDUC-15.
           MOVE SPC-RBMIN(15) TO QSPC-RBMIN-15.
           MOVE SPC-RBSPOPT1(15) TO QSPC-RBSPOPT1-15.
           MOVE SPC-RBSPOPT2(15) TO QSPC-RBSPOPT2-15.
           MOVE SPC-RBMANAGER(15) TO QSPC-RBMANAGER-15.
           MOVE SPC-RBUNITPER-CD(15) TO QSPC-RBUNITPER-CD-15.
           MOVE SPC-RBFRMLA2(15) TO QSPC-RBFRMLA2-15.
           MOVE SPC-RBFRMLA(16) TO QSPC-RBFRMLA-16.
           MOVE SPC-RBDTE(16 1) TO QSPC-RBDTE-16-1.
           MOVE SPC-RBDAYS(16 1) TO QSPC-RBDAYS-16-1.
           MOVE SPC-RBYRTYPE(16 1) TO QSPC-RBYRTYPE-16-1.
           MOVE SPC-RBDTE(16 2) TO QSPC-RBDTE-16-2.
           MOVE SPC-RBDAYS(16 2) TO QSPC-RBDAYS-16-2.
           MOVE SPC-RBYRTYPE(16 2) TO QSPC-RBYRTYPE-16-2.
           MOVE SPC-RBMINRET(16) TO QSPC-RBMINRET-16.
           MOVE SPC-RBNOMON(16) TO QSPC-RBNOMON-16.
           MOVE SPC-RBDEDCHG(16) TO QSPC-RBDEDCHG-16.
           MOVE SPC-RBRECAST(16) TO QSPC-RBRECAST-16.
           MOVE SPC-RBEARLY(16) TO QSPC-RBEARLY-16.
           MOVE SPC-RBDEFER(16) TO QSPC-RBDEFER-16.
           MOVE SPC-RBPCT(16) TO QSPC-RBPCT-16.
           MOVE SPC-RBREDUC(16) TO QSPC-RBREDUC-16.
           MOVE SPC-RBMIN(16) TO QSPC-RBMIN-16.
           MOVE SPC-RBSPOPT1(16) TO QSPC-RBSPOPT1-16.
           MOVE SPC-RBSPOPT2(16) TO QSPC-RBSPOPT2-16.
           MOVE SPC-RBMANAGER(16) TO QSPC-RBMANAGER-16.
           MOVE SPC-RBUNITPER-CD(16) TO QSPC-RBUNITPER-CD-16.
           MOVE SPC-RBFRMLA2(16) TO QSPC-RBFRMLA2-16.
           MOVE SPC-RBFRMLA(17) TO QSPC-RBFRMLA-17.
           MOVE SPC-RBDTE(17 1) TO QSPC-RBDTE-17-1.
           MOVE SPC-RBDAYS(17 1) TO QSPC-RBDAYS-17-1.
           MOVE SPC-RBYRTYPE(17 1) TO QSPC-RBYRTYPE-17-1.
           MOVE SPC-RBDTE(17 2) TO QSPC-RBDTE-17-2.
           MOVE SPC-RBDAYS(17 2) TO QSPC-RBDAYS-17-2.
           MOVE SPC-RBYRTYPE(17 2) TO QSPC-RBYRTYPE-17-2.
           MOVE SPC-RBMINRET(17) TO QSPC-RBMINRET-17.
           MOVE SPC-RBNOMON(17) TO QSPC-RBNOMON-17.
           MOVE SPC-RBDEDCHG(17) TO QSPC-RBDEDCHG-17.
           MOVE SPC-RBRECAST(17) TO QSPC-RBRECAST-17.
           MOVE SPC-RBEARLY(17) TO QSPC-RBEARLY-17.
           MOVE SPC-RBDEFER(17) TO QSPC-RBDEFER-17.
           MOVE SPC-RBPCT(17) TO QSPC-RBPCT-17.
           MOVE SPC-RBREDUC(17) TO QSPC-RBREDUC-17.
           MOVE SPC-RBMIN(17) TO QSPC-RBMIN-17.
           MOVE SPC-RBSPOPT1(17) TO QSPC-RBSPOPT1-17.
           MOVE SPC-RBSPOPT2(17) TO QSPC-RBSPOPT2-17.
           MOVE SPC-RBMANAGER(17) TO QSPC-RBMANAGER-17.
           MOVE SPC-RBUNITPER-CD(17) TO QSPC-RBUNITPER-CD-17.
           MOVE SPC-RBFRMLA2(17) TO QSPC-RBFRMLA2-17.
           MOVE SPC-RBFRMLA(18) TO QSPC-RBFRMLA-18.
           MOVE SPC-RBDTE(18 1) TO QSPC-RBDTE-18-1.
           MOVE SPC-RBDAYS(18 1) TO QSPC-RBDAYS-18-1.
           MOVE SPC-RBYRTYPE(18 1) TO QSPC-RBYRTYPE-18-1.
           MOVE SPC-RBDTE(18 2) TO QSPC-RBDTE-18-2.
           MOVE SPC-RBDAYS(18 2) TO QSPC-RBDAYS-18-2.
           MOVE SPC-RBYRTYPE(18 2) TO QSPC-RBYRTYPE-18-2.
           MOVE SPC-RBMINRET(18) TO QSPC-RBMINRET-18.
           MOVE SPC-RBNOMON(18) TO QSPC-RBNOMON-18.
           MOVE SPC-RBDEDCHG(18) TO QSPC-RBDEDCHG-18.
           MOVE SPC-RBRECAST(18) TO QSPC-RBRECAST-18.
           MOVE SPC-RBEARLY(18) TO QSPC-RBEARLY-18.
           MOVE SPC-RBDEFER(18) TO QSPC-RBDEFER-18.
           MOVE SPC-RBPCT(18) TO QSPC-RBPCT-18.
           MOVE SPC-RBREDUC(18) TO QSPC-RBREDUC-18.
           MOVE SPC-RBMIN(18) TO QSPC-RBMIN-18.
           MOVE SPC-RBSPOPT1(18) TO QSPC-RBSPOPT1-18.
           MOVE SPC-RBSPOPT2(18) TO QSPC-RBSPOPT2-18.
           MOVE SPC-RBMANAGER(18) TO QSPC-RBMANAGER-18.
           MOVE SPC-RBUNITPER-CD(18) TO QSPC-RBUNITPER-CD-18.
           MOVE SPC-RBFRMLA2(18) TO QSPC-RBFRMLA2-18.
           MOVE SPC-RBFRMLA(19) TO QSPC-RBFRMLA-19.
           MOVE SPC-RBDTE(19 1) TO QSPC-RBDTE-19-1.
           MOVE SPC-RBDAYS(19 1) TO QSPC-RBDAYS-19-1.
           MOVE SPC-RBYRTYPE(19 1) TO QSPC-RBYRTYPE-19-1.
           MOVE SPC-RBDTE(19 2) TO QSPC-RBDTE-19-2.
           MOVE SPC-RBDAYS(19 2) TO QSPC-RBDAYS-19-2.
           MOVE SPC-RBYRTYPE(19 2) TO QSPC-RBYRTYPE-19-2.
           MOVE SPC-RBMINRET(19) TO QSPC-RBMINRET-19.
           MOVE SPC-RBNOMON(19) TO QSPC-RBNOMON-19.
           MOVE SPC-RBDEDCHG(19) TO QSPC-RBDEDCHG-19.
           MOVE SPC-RBRECAST(19) TO QSPC-RBRECAST-19.
           MOVE SPC-RBEARLY(19) TO QSPC-RBEARLY-19.
           MOVE SPC-RBDEFER(19) TO QSPC-RBDEFER-19.
           MOVE SPC-RBPCT(19) TO QSPC-RBPCT-19.
           MOVE SPC-RBREDUC(19) TO QSPC-RBREDUC-19.
           MOVE SPC-RBMIN(19) TO QSPC-RBMIN-19.
           MOVE SPC-RBSPOPT1(19) TO QSPC-RBSPOPT1-19.
           MOVE SPC-RBSPOPT2(19) TO QSPC-RBSPOPT2-19.
           MOVE SPC-RBMANAGER(19) TO QSPC-RBMANAGER-19.
           MOVE SPC-RBUNITPER-CD(19) TO QSPC-RBUNITPER-CD-19.
           MOVE SPC-RBFRMLA2(19) TO QSPC-RBFRMLA2-19.
           MOVE SPC-RBFRMLA(20) TO QSPC-RBFRMLA-20.
           MOVE SPC-RBDTE(20 1) TO QSPC-RBDTE-20-1.
           MOVE SPC-RBDAYS(20 1) TO QSPC-RBDAYS-20-1.
           MOVE SPC-RBYRTYPE(20 1) TO QSPC-RBYRTYPE-20-1.
           MOVE SPC-RBDTE(20 2) TO QSPC-RBDTE-20-2.
           MOVE SPC-RBDAYS(20 2) TO QSPC-RBDAYS-20-2.
           MOVE SPC-RBYRTYPE(20 2) TO QSPC-RBYRTYPE-20-2.
           MOVE SPC-RBMINRET(20) TO QSPC-RBMINRET-20.
           MOVE SPC-RBNOMON(20) TO QSPC-RBNOMON-20.
           MOVE SPC-RBDEDCHG(20) TO QSPC-RBDEDCHG-20.
           MOVE SPC-RBRECAST(20) TO QSPC-RBRECAST-20.
           MOVE SPC-RBEARLY(20) TO QSPC-RBEARLY-20.
           MOVE SPC-RBDEFER(20) TO QSPC-RBDEFER-20.
           MOVE SPC-RBPCT(20) TO QSPC-RBPCT-20.
           MOVE SPC-RBREDUC(20) TO QSPC-RBREDUC-20.
           MOVE SPC-RBMIN(20) TO QSPC-RBMIN-20.
           MOVE SPC-RBSPOPT1(20) TO QSPC-RBSPOPT1-20.
           MOVE SPC-RBSPOPT2(20) TO QSPC-RBSPOPT2-20.
           MOVE SPC-RBMANAGER(20) TO QSPC-RBMANAGER-20.
           MOVE SPC-RBUNITPER-CD(20) TO QSPC-RBUNITPER-CD-20.
           MOVE SPC-RBFRMLA2(20) TO QSPC-RBFRMLA2-20.
           MOVE SPC-RBFRMLA(21) TO QSPC-RBFRMLA-21.
           MOVE SPC-RBDTE(21 1) TO QSPC-RBDTE-21-1.
           MOVE SPC-RBDAYS(21 1) TO QSPC-RBDAYS-21-1.
           MOVE SPC-RBYRTYPE(21 1) TO QSPC-RBYRTYPE-21-1.
           MOVE SPC-RBDTE(21 2) TO QSPC-RBDTE-21-2.
           MOVE SPC-RBDAYS(21 2) TO QSPC-RBDAYS-21-2.
           MOVE SPC-RBYRTYPE(21 2) TO QSPC-RBYRTYPE-21-2.
           MOVE SPC-RBMINRET(21) TO QSPC-RBMINRET-21.
           MOVE SPC-RBNOMON(21) TO QSPC-RBNOMON-21.
           MOVE SPC-RBDEDCHG(21) TO QSPC-RBDEDCHG-21.
           MOVE SPC-RBRECAST(21) TO QSPC-RBRECAST-21.
           MOVE SPC-RBEARLY(21) TO QSPC-RBEARLY-21.
           MOVE SPC-RBDEFER(21) TO QSPC-RBDEFER-21.
           MOVE SPC-RBPCT(21) TO QSPC-RBPCT-21.
           MOVE SPC-RBREDUC(21) TO QSPC-RBREDUC-21.
           MOVE SPC-RBMIN(21) TO QSPC-RBMIN-21.
           MOVE SPC-RBSPOPT1(21) TO QSPC-RBSPOPT1-21.
           MOVE SPC-RBSPOPT2(21) TO QSPC-RBSPOPT2-21.
           MOVE SPC-RBMANAGER(21) TO QSPC-RBMANAGER-21.
           MOVE SPC-RBUNITPER-CD(21) TO QSPC-RBUNITPER-CD-21.
           MOVE SPC-RBFRMLA2(21) TO QSPC-RBFRMLA2-21.
           MOVE SPC-RBFRMLA(22) TO QSPC-RBFRMLA-22.
           MOVE SPC-RBDTE(22 1) TO QSPC-RBDTE-22-1.
           MOVE SPC-RBDAYS(22 1) TO QSPC-RBDAYS-22-1.
           MOVE SPC-RBYRTYPE(22 1) TO QSPC-RBYRTYPE-22-1.
           MOVE SPC-RBDTE(22 2) TO QSPC-RBDTE-22-2.
           MOVE SPC-RBDAYS(22 2) TO QSPC-RBDAYS-22-2.
           MOVE SPC-RBYRTYPE(22 2) TO QSPC-RBYRTYPE-22-2.
           MOVE SPC-RBMINRET(22) TO QSPC-RBMINRET-22.
           MOVE SPC-RBNOMON(22) TO QSPC-RBNOMON-22.
           MOVE SPC-RBDEDCHG(22) TO QSPC-RBDEDCHG-22.
           MOVE SPC-RBRECAST(22) TO QSPC-RBRECAST-22.
           MOVE SPC-RBEARLY(22) TO QSPC-RBEARLY-22.
           MOVE SPC-RBDEFER(22) TO QSPC-RBDEFER-22.
           MOVE SPC-RBPCT(22) TO QSPC-RBPCT-22.
           MOVE SPC-RBREDUC(22) TO QSPC-RBREDUC-22.
           MOVE SPC-RBMIN(22) TO QSPC-RBMIN-22.
           MOVE SPC-RBSPOPT1(22) TO QSPC-RBSPOPT1-22.
           MOVE SPC-RBSPOPT2(22) TO QSPC-RBSPOPT2-22.
           MOVE SPC-RBMANAGER(22) TO QSPC-RBMANAGER-22.
           MOVE SPC-RBUNITPER-CD(22) TO QSPC-RBUNITPER-CD-22.
           MOVE SPC-RBFRMLA2(22) TO QSPC-RBFRMLA2-22.
           MOVE SPC-RBCOMCD TO QSPC-RBCOMCD.
           MOVE SPC-ADDON-DISFRMLA TO QSPC-ADDON-DISFRMLA.
           MOVE SPC-ADDON-WHOLE-FG TO QSPC-ADDON-WHOLE-FG.
           MOVE SPC-ADDON-ORG-MATURITY TO QSPC-ADDON-ORG-MATURITY.
           MOVE SPC-CONSOLIDATE-RT-FG TO QSPC-CONSOLIDATE-RT-FG.
           MOVE SPC-1STPY-ADDON-DAYS TO QSPC-1STPY-ADDON-DAYS.
           MOVE SPC-1STPY-ADDON-YRTYPE TO QSPC-1STPY-ADDON-YRTYPE.
           MOVE SPC-ADDON-RATE-FG TO QSPC-ADDON-RATE-FG.
           MOVE SPC-ADDON-RATE TO QSPC-ADDON-RATE.
           MOVE SPC-FEEFRMLA(1) TO QSPC-FEEFRMLA-1.
           MOVE SPC-FEECD(1) TO QSPC-FEECD-1.
           MOVE SPC-FEEID(1) TO QSPC-FEEID-1.
           MOVE SPC-FEEFRMLA(2) TO QSPC-FEEFRMLA-2.
           MOVE SPC-FEECD(2) TO QSPC-FEECD-2.
           MOVE SPC-FEEID(2) TO QSPC-FEEID-2.
           MOVE SPC-ROUND-PAY-FG TO QSPC-ROUND-PAY-FG.
           MOVE SPC-IRREGULAR-PAY-FG TO QSPC-IRREGULAR-PAY-FG.
           MOVE SPC-DLRVCHGS-RB-CD(1) TO QSPC-DLRVCHGS-RB-CD-1.
           MOVE SPC-DLRVCHGS-RB-CD(2) TO QSPC-DLRVCHGS-RB-CD-2.
           MOVE SPC-DLRVCHGS-RB-CD(3) TO QSPC-DLRVCHGS-RB-CD-3.
           MOVE SPC-PARVHELD-RB-CD TO QSPC-PARVHELD-RB-CD.
           MOVE SPC-PARVPAID-RB-CD TO QSPC-PARVPAID-RB-CD.
           MOVE SPC-CONTR-CREDIT TO QSPC-CONTR-CREDIT.
           MOVE SPC-CONTR-CREDIT-CD TO QSPC-CONTR-CREDIT-CD.
           MOVE SPC-CONTR-CREDIT-MIN-DEL-PER
            TO QSPC-CONTR-CREDIT-MIN-DEL-PER.
           MOVE SPC-OPT-CAL-CHGABLE TO QSPC-OPT-CAL-CHGABLE.
           MOVE SPC-PBDEL-DAYS TO QSPC-PBDEL-DAYS.
           MOVE SPC-PBINCR-PERCENT TO QSPC-PBINCR-PERCENT.
           MOVE SPC-CPOT30-CD TO QSPC-CPOT30-CD.
           MOVE SPC-CPOTCHGOFF-CD TO QSPC-CPOTCHGOFF-CD.
           MOVE SPC-RDPOT30-CD TO QSPC-RDPOT30-CD.
           MOVE SPC-RDPOTCHGOFF-CD TO QSPC-RDPOTCHGOFF-CD.
           MOVE SPC-MAX-ALLOW-DELINQ TO QSPC-MAX-ALLOW-DELINQ.
           MOVE SPC-RESCIND-BUS-DAYS TO QSPC-RESCIND-BUS-DAYS.
           MOVE SPC-RESCIND-SATURDAY TO QSPC-RESCIND-SATURDAY.
           MOVE SPC-MIN-CREDIT-SCORE TO QSPC-MIN-CREDIT-SCORE.
           MOVE SPC-DUAL-IN-BRANCH TO QSPC-DUAL-IN-BRANCH.
           MOVE SPC-DUAL-IN-STATE TO QSPC-DUAL-IN-STATE.
           MOVE SPC-PACESETTER-FG TO QSPC-PACESETTER-FG.
           MOVE SPC-WAGE-ASSIGN-DAYS TO QSPC-WAGE-ASSIGN-DAYS.
           MOVE SPC-CAL-PAYMENT-ROUND-FG TO QSPC-CAL-PAYMENT-ROUND-FG.
           MOVE SPC-CAN-LOANS-FG TO QSPC-CAN-LOANS-FG.
           MOVE SPC-ALLOW-DELINQ-POLCD TO QSPC-ALLOW-DELINQ-POLCD.
           MOVE SPC-YTD-MAX-ALLOW-DELINQ TO QSPC-YTD-MAX-ALLOW-DELINQ.
           MOVE SPC-LNCOST-FRMLA TO QSPC-LNCOST-FRMLA.
           MOVE SPC-LNCOST-AMT TO QSPC-LNCOST-AMT.
           MOVE SPC-DLDISC-RVPRIN1-PCNT TO QSPC-DLDISC-RVPRIN1-PCNT.
           MOVE SPC-RENEWABLE-PAYS TO QSPC-RENEWABLE-PAYS.
           MOVE SPC-RENEWABLE-DAYS TO QSPC-RENEWABLE-DAYS.
           MOVE SPC-ALLOW-LN-BACK-DATE TO QSPC-ALLOW-LN-BACK-DATE.
           MOVE SPC-DLDISC-RVPRIN1-AF-PCNT
            TO QSPC-DLDISC-RVPRIN1-AF-PCNT.
           MOVE SPC-CAL-MAX-AT-ESTIMATE TO QSPC-CAL-MAX-AT-ESTIMATE.
           MOVE SPC-INSAH-RETRO TO QSPC-INSAH-RETRO.
           MOVE SPC-INSAH-DAYS-WAIT TO QSPC-INSAH-DAYS-WAIT.
           MOVE SPC-ADDON-EXCEPT-FG TO QSPC-ADDON-EXCEPT-FG.
           MOVE SPC-REPO-TRCD(1) TO QSPC-REPO-TRCD-1.
           MOVE SPC-REPO-FMNO(1 1) TO QSPC-REPO-FMNO-1-1.
           MOVE SPC-REPO-FMNO(1 2) TO QSPC-REPO-FMNO-1-2.
           MOVE SPC-REPO-FMNO(1 3) TO QSPC-REPO-FMNO-1-3.
           MOVE SPC-REPO-FMNO(1 4) TO QSPC-REPO-FMNO-1-4.
           MOVE SPC-REPO-TRCD(2) TO QSPC-REPO-TRCD-2.
           MOVE SPC-REPO-FMNO(2 1) TO QSPC-REPO-FMNO-2-1.
           MOVE SPC-REPO-FMNO(2 2) TO QSPC-REPO-FMNO-2-2.
           MOVE SPC-REPO-FMNO(2 3) TO QSPC-REPO-FMNO-2-3.
           MOVE SPC-REPO-FMNO(2 4) TO QSPC-REPO-FMNO-2-4.
           MOVE SPC-REPO-TRCD(3) TO QSPC-REPO-TRCD-3.
           MOVE SPC-REPO-FMNO(3 1) TO QSPC-REPO-FMNO-3-1.
           MOVE SPC-REPO-FMNO(3 2) TO QSPC-REPO-FMNO-3-2.
           MOVE SPC-REPO-FMNO(3 3) TO QSPC-REPO-FMNO-3-3.
           MOVE SPC-REPO-FMNO(3 4) TO QSPC-REPO-FMNO-3-4.
           MOVE SPC-CANCEL-ADDON-FG TO QSPC-CANCEL-ADDON-FG.
           MOVE SPC-DEFAULT-O2-INS-COMP TO QSPC-DEFAULT-O2-INS-COMP.
           MOVE SPC-LC-ON-JUDGEMENTS TO QSPC-LC-ON-JUDGEMENTS.
           MOVE SPC-DELQ-IB-AGE TO QSPC-DELQ-IB-AGE.
           MOVE SPC-DELQ-IB-MAX-DAYS TO QSPC-DELQ-IB-MAX-DAYS.
           MOVE SPC-INSURANCE-WRITTEN TO QSPC-INSURANCE-WRITTEN.
           MOVE SPC-INTERIM-COUPON TO QSPC-INTERIM-COUPON.
           MOVE SPC-AUTO-ASSESS-LCHG TO QSPC-AUTO-ASSESS-LCHG.
           MOVE SPC-MAX-CASH-PROCEEDS TO QSPC-MAX-CASH-PROCEEDS.
           MOVE SPC-ALLOW-ZERO-PROC TO QSPC-ALLOW-ZERO-PROC.
           MOVE SPC-BANKRULE-RATE TO QSPC-BANKRULE-RATE.
           MOVE SPC-AUTO-SEND-TRCD(1) TO QSPC-AUTO-SEND-TRCD-1.
           MOVE SPC-AUTO-SEND-FMNO(1 1) TO QSPC-AUTO-SEND-FMNO-1-1.
           MOVE SPC-AUTO-SEND-FMNO(1 2) TO QSPC-AUTO-SEND-FMNO-1-2.
           MOVE SPC-AUTO-SEND-FMNO(1 3) TO QSPC-AUTO-SEND-FMNO-1-3.
           MOVE SPC-AUTO-SEND-FMNO(1 4) TO QSPC-AUTO-SEND-FMNO-1-4.
           MOVE SPC-AUTO-SEND-TRCD(2) TO QSPC-AUTO-SEND-TRCD-2.
           MOVE SPC-AUTO-SEND-FMNO(2 1) TO QSPC-AUTO-SEND-FMNO-2-1.
           MOVE SPC-AUTO-SEND-FMNO(2 2) TO QSPC-AUTO-SEND-FMNO-2-2.
           MOVE SPC-AUTO-SEND-FMNO(2 3) TO QSPC-AUTO-SEND-FMNO-2-3.
           MOVE SPC-AUTO-SEND-FMNO(2 4) TO QSPC-AUTO-SEND-FMNO-2-4.
           MOVE SPC-DLDISC-CONV-BF-PCNT TO QSPC-DLDISC-CONV-BF-PCNT.
           MOVE SPC-UNITPER-CD TO QSPC-UNITPER-CD.
           MOVE SPC-RENEWAL-EDIT TO QSPC-RENEWAL-EDIT.
           MOVE SPC-ROUND-MFEE TO QSPC-ROUND-MFEE.
           MOVE SPC-ADV-TO-1ST-NO-CORR TO QSPC-ADV-TO-1ST-NO-CORR.
           MOVE SPC-LC-INT-ON-REPO-NON-PL
            TO QSPC-LC-INT-ON-REPO-NON-PL.
           MOVE SPC-CONTRACTUAL-SET-NONACCRUAL
            TO QSPC-CONTRACTUAL-SET-NONACCRUAL.
           MOVE SPC-CONTRACTUAL-RESET-ACCRUAL
            TO QSPC-CONTRACTUAL-RESET-ACCRUAL.
           MOVE SPC-MONTHS-PAY-NAPP-COUNTER
            TO QSPC-MONTHS-PAY-NAPP-COUNTER.
           MOVE SPC-SHORT-PAY-THRESHOLD TO QSPC-SHORT-PAY-THRESHOLD.
           MOVE SPC-CASH-AVAIL-PERCENT TO QSPC-CASH-AVAIL-PERCENT.
           MOVE SPC-O1-JOINT-FG TO QSPC-O1-JOINT-FG.
           MOVE SPC-NET-BAL-REQ TO QSPC-NET-BAL-REQ.
           MOVE SPC-AMT-PROCEEDS-REQ TO QSPC-AMT-PROCEEDS-REQ.
           MOVE SPC-ALT-PREPAY-MONTHS TO QSPC-ALT-PREPAY-MONTHS.
           MOVE SPC-PERCENT-REGPAY-AVAIL TO QSPC-PERCENT-REGPAY-AVAIL.
           MOVE SPC-ALT-DEFFRMLA TO QSPC-ALT-DEFFRMLA.
           MOVE SPC-ALT-DEFMIN TO QSPC-ALT-DEFMIN.
           MOVE SPC-ALT-DEFMAX TO QSPC-ALT-DEFMAX.
           MOVE SPC-NON-LOAN-FLAG TO QSPC-NON-LOAN-FLAG.
           MOVE SPC-SKIP-TRW TO QSPC-SKIP-TRW.
 
      *================================================================*
      * END COPYBOOK: LIBLP\LPSPGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLXGGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLXGGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN PAYMENT TRAILER - G/L
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LXG-REC FROM QLXG-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LXG-FIELDS.
           MOVE QLXG-BRNO TO LXG-BRNO.
           MOVE QLXG-ACCTNO TO LXG-ACCTNO.
           MOVE QLXG-SEQNO TO LXG-SEQNO.

           IF ( QLXG-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LXG-LTOUCH-DATE
           ELSE
              MOVE QLXG-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LXG-LTOUCH-DATE.

           MOVE QLXG-GLNO-1 TO LXG-GLNO(1).
           MOVE QLXG-GLAMT-1 TO LXG-GLAMT(1).
           MOVE QLXG-GLNO-2 TO LXG-GLNO(2).
           MOVE QLXG-GLAMT-2 TO LXG-GLAMT(2).
           MOVE QLXG-GLNO-3 TO LXG-GLNO(3).
           MOVE QLXG-GLAMT-3 TO LXG-GLAMT(3).
 
      *-----------------------------------------------------------------
      *    LOAD QLXG-REC FROM LXG-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LXG-FIELDS.
           MOVE LXG-BRNO TO QLXG-BRNO.
           MOVE LXG-ACCTNO TO QLXG-ACCTNO.
           MOVE LXG-SEQNO TO QLXG-SEQNO.

           IF ( LXG-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLXG-LTOUCH-DATE
           ELSE
              MOVE LXG-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLXG-LTOUCH-DATE.

           MOVE LXG-GLNO(1) TO QLXG-GLNO-1.
           MOVE LXG-GLAMT(1) TO QLXG-GLAMT-1.
           MOVE LXG-GLNO(2) TO QLXG-GLNO-2.
           MOVE LXG-GLAMT(2) TO QLXG-GLAMT-2.
           MOVE LXG-GLNO(3) TO QLXG-GLNO-3.
           MOVE LXG-GLAMT(3) TO QLXG-GLAMT-3.
 

      *================================================================*
      * END COPYBOOK: LIBLP\LPLXGGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLXEGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLXEGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN PAYMENT TRAILER - EARNINGS
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LXE-REC FROM QLXE-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LXE-FIELDS.
           MOVE QLXE-BRNO TO LXE-BRNO.
           MOVE QLXE-ACCTNO TO LXE-ACCTNO.
           MOVE QLXE-SEQNO TO LXE-SEQNO.

           IF ( QLXE-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LXE-LTOUCH-DATE
           ELSE
              MOVE QLXE-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LXE-LTOUCH-DATE.

           MOVE QLXE-EARN-1 TO LXE-EARN(1).
           MOVE QLXE-EARN-2 TO LXE-EARN(2).
           MOVE QLXE-EARN-3 TO LXE-EARN(3).
           MOVE QLXE-EARN-4 TO LXE-EARN(4).
           MOVE QLXE-EARN-5 TO LXE-EARN(5).
           MOVE QLXE-EARN-6 TO LXE-EARN(6).
           MOVE QLXE-EARN-7 TO LXE-EARN(7).
           MOVE QLXE-WORKER TO LXE-WORKER.
           MOVE QLXE-WORKER2 TO LXE-WORKER2.
 
      *-----------------------------------------------------------------
      *    LOAD QLXE-REC FROM LXE-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LXE-FIELDS.
           MOVE LXE-BRNO TO QLXE-BRNO.
           MOVE LXE-ACCTNO TO QLXE-ACCTNO.
           MOVE LXE-SEQNO TO QLXE-SEQNO.

           IF ( LXE-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLXE-LTOUCH-DATE
           ELSE
              MOVE LXE-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLXE-LTOUCH-DATE.

           MOVE LXE-EARN(1) TO QLXE-EARN-1.
           MOVE LXE-EARN(2) TO QLXE-EARN-2.
           MOVE LXE-EARN(3) TO QLXE-EARN-3.
           MOVE LXE-EARN(4) TO QLXE-EARN-4.
           MOVE LXE-EARN(5) TO QLXE-EARN-5.
           MOVE LXE-EARN(6) TO QLXE-EARN-6.
           MOVE LXE-EARN(7) TO QLXE-EARN-7.
           MOVE LXE-WORKER TO QLXE-WORKER.
           MOVE LXE-WORKER2 TO QLXE-WORKER2.
 
      *================================================================*
      * END COPYBOOK: LIBLP\LPLXEGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLTPGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLTPGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN TRAILER - PAYMENT SCHEDULE
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LTP-REC FROM QLTP-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LTP-FIELDS.
           MOVE QLTP-BRNO TO LTP-BRNO.
           MOVE QLTP-ACCTNO TO LTP-ACCTNO.
           MOVE QLTP-SEQNO TO LTP-SEQNO.

           IF ( QLTP-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LTP-LTOUCH-DATE
           ELSE
              MOVE QLTP-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTP-LTOUCH-DATE.

           MOVE QLTP-SCHLD-TERM-1 TO LTP-SCHLD-TERM(1).
           MOVE QLTP-SCHLD-PAYMNT-1 TO LTP-SCHLD-PAYMNT(1).
           MOVE QLTP-SCHLD-TERM-2 TO LTP-SCHLD-TERM(2).
           MOVE QLTP-SCHLD-PAYMNT-2 TO LTP-SCHLD-PAYMNT(2).
           MOVE QLTP-SCHLD-TERM-3 TO LTP-SCHLD-TERM(3).
           MOVE QLTP-SCHLD-PAYMNT-3 TO LTP-SCHLD-PAYMNT(3).
           MOVE QLTP-SCHLD-TERM-4 TO LTP-SCHLD-TERM(4).
           MOVE QLTP-SCHLD-PAYMNT-4 TO LTP-SCHLD-PAYMNT(4).
           MOVE QLTP-SCHLD-TERM-5 TO LTP-SCHLD-TERM(5).
           MOVE QLTP-SCHLD-PAYMNT-5 TO LTP-SCHLD-PAYMNT(5).
           MOVE QLTP-SCHLD-TERM-6 TO LTP-SCHLD-TERM(6).
           MOVE QLTP-SCHLD-PAYMNT-6 TO LTP-SCHLD-PAYMNT(6).
           MOVE QLTP-SCHLD-TERM-7 TO LTP-SCHLD-TERM(7).
           MOVE QLTP-SCHLD-PAYMNT-7 TO LTP-SCHLD-PAYMNT(7).
           MOVE QLTP-SCHLD-TERM-8 TO LTP-SCHLD-TERM(8).
           MOVE QLTP-SCHLD-PAYMNT-8 TO LTP-SCHLD-PAYMNT(8).
           MOVE QLTP-SCHLD-TERM-9 TO LTP-SCHLD-TERM(9).
           MOVE QLTP-SCHLD-PAYMNT-9 TO LTP-SCHLD-PAYMNT(9).
           MOVE QLTP-SCHLD-TERM-10 TO LTP-SCHLD-TERM(10).
           MOVE QLTP-SCHLD-PAYMNT-10 TO LTP-SCHLD-PAYMNT(10).
           MOVE QLTP-SCHLD-TERM-11 TO LTP-SCHLD-TERM(11).
           MOVE QLTP-SCHLD-PAYMNT-11 TO LTP-SCHLD-PAYMNT(11).
           MOVE QLTP-SCHLD-TERM-12 TO LTP-SCHLD-TERM(12).
           MOVE QLTP-SCHLD-PAYMNT-12 TO LTP-SCHLD-PAYMNT(12).
           MOVE QLTP-SCHLD-TERM-13 TO LTP-SCHLD-TERM(13).
           MOVE QLTP-SCHLD-PAYMNT-13 TO LTP-SCHLD-PAYMNT(13).
           MOVE QLTP-SCHLD-TERM-14 TO LTP-SCHLD-TERM(14).
           MOVE QLTP-SCHLD-PAYMNT-14 TO LTP-SCHLD-PAYMNT(14).
           MOVE QLTP-SCHLD-TERM-15 TO LTP-SCHLD-TERM(15).
           MOVE QLTP-SCHLD-PAYMNT-15 TO LTP-SCHLD-PAYMNT(15).
           MOVE QLTP-SCHLD-TERM-16 TO LTP-SCHLD-TERM(16).
           MOVE QLTP-SCHLD-PAYMNT-16 TO LTP-SCHLD-PAYMNT(16).
           MOVE QLTP-SCHLD-TERM-17 TO LTP-SCHLD-TERM(17).
           MOVE QLTP-SCHLD-PAYMNT-17 TO LTP-SCHLD-PAYMNT(17).
           MOVE QLTP-SCHLD-TERM-18 TO LTP-SCHLD-TERM(18).
           MOVE QLTP-SCHLD-PAYMNT-18 TO LTP-SCHLD-PAYMNT(18).
           MOVE QLTP-SCHLD-TERM-19 TO LTP-SCHLD-TERM(19).
           MOVE QLTP-SCHLD-PAYMNT-19 TO LTP-SCHLD-PAYMNT(19).
           MOVE QLTP-SCHLD-TERM-20 TO LTP-SCHLD-TERM(20).
           MOVE QLTP-SCHLD-PAYMNT-20 TO LTP-SCHLD-PAYMNT(20).
           MOVE QLTP-SCHLD-TERM-21 TO LTP-SCHLD-TERM(21).
           MOVE QLTP-SCHLD-PAYMNT-21 TO LTP-SCHLD-PAYMNT(21).
           MOVE QLTP-SCHLD-TERM-22 TO LTP-SCHLD-TERM(22).
           MOVE QLTP-SCHLD-PAYMNT-22 TO LTP-SCHLD-PAYMNT(22).
           MOVE QLTP-SCHLD-TERM-23 TO LTP-SCHLD-TERM(23).
           MOVE QLTP-SCHLD-PAYMNT-23 TO LTP-SCHLD-PAYMNT(23).
           MOVE QLTP-SCHLD-TERM-24 TO LTP-SCHLD-TERM(24).
           MOVE QLTP-SCHLD-PAYMNT-24 TO LTP-SCHLD-PAYMNT(24).
           MOVE QLTP-SCHLD-TERM-25 TO LTP-SCHLD-TERM(25).
           MOVE QLTP-SCHLD-PAYMNT-25 TO LTP-SCHLD-PAYMNT(25).
           MOVE QLTP-SCHLD-TERM-26 TO LTP-SCHLD-TERM(26).
           MOVE QLTP-SCHLD-PAYMNT-26 TO LTP-SCHLD-PAYMNT(26).
           MOVE QLTP-SCHLD-TERM-27 TO LTP-SCHLD-TERM(27).
           MOVE QLTP-SCHLD-PAYMNT-27 TO LTP-SCHLD-PAYMNT(27).
           MOVE QLTP-SCHLD-TERM-28 TO LTP-SCHLD-TERM(28).
           MOVE QLTP-SCHLD-PAYMNT-28 TO LTP-SCHLD-PAYMNT(28).
           MOVE QLTP-SCHLD-TERM-29 TO LTP-SCHLD-TERM(29).
           MOVE QLTP-SCHLD-PAYMNT-29 TO LTP-SCHLD-PAYMNT(29).
           MOVE QLTP-SCHLD-TERM-30 TO LTP-SCHLD-TERM(30).
           MOVE QLTP-SCHLD-PAYMNT-30 TO LTP-SCHLD-PAYMNT(30).
           MOVE QLTP-SCHLD-TERM-31 TO LTP-SCHLD-TERM(31).
           MOVE QLTP-SCHLD-PAYMNT-31 TO LTP-SCHLD-PAYMNT(31).
           MOVE QLTP-SCHLD-TERM-32 TO LTP-SCHLD-TERM(32).
           MOVE QLTP-SCHLD-PAYMNT-32 TO LTP-SCHLD-PAYMNT(32).
           MOVE QLTP-SCHLD-TERM-33 TO LTP-SCHLD-TERM(33).
           MOVE QLTP-SCHLD-PAYMNT-33 TO LTP-SCHLD-PAYMNT(33).
           MOVE QLTP-SCHLD-TERM-34 TO LTP-SCHLD-TERM(34).
           MOVE QLTP-SCHLD-PAYMNT-34 TO LTP-SCHLD-PAYMNT(34).
           MOVE QLTP-SCHLD-TERM-35 TO LTP-SCHLD-TERM(35).
           MOVE QLTP-SCHLD-PAYMNT-35 TO LTP-SCHLD-PAYMNT(35).
           MOVE QLTP-SCHLD-TERM-36 TO LTP-SCHLD-TERM(36).
           MOVE QLTP-SCHLD-PAYMNT-36 TO LTP-SCHLD-PAYMNT(36).
           MOVE QLTP-SCHLD-TERM-37 TO LTP-SCHLD-TERM(37).
           MOVE QLTP-SCHLD-PAYMNT-37 TO LTP-SCHLD-PAYMNT(37).
           MOVE QLTP-SCHLD-TERM-38 TO LTP-SCHLD-TERM(38).
           MOVE QLTP-SCHLD-PAYMNT-38 TO LTP-SCHLD-PAYMNT(38).
           MOVE QLTP-SCHLD-TERM-39 TO LTP-SCHLD-TERM(39).
           MOVE QLTP-SCHLD-PAYMNT-39 TO LTP-SCHLD-PAYMNT(39).
           MOVE QLTP-SCHLD-TERM-40 TO LTP-SCHLD-TERM(40).
           MOVE QLTP-SCHLD-PAYMNT-40 TO LTP-SCHLD-PAYMNT(40).
           MOVE QLTP-SCHLD-TERM-41 TO LTP-SCHLD-TERM(41).
           MOVE QLTP-SCHLD-PAYMNT-41 TO LTP-SCHLD-PAYMNT(41).
 
      *-----------------------------------------------------------------
      *    LOAD QLTP-REC FROM LTP-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LTP-FIELDS.
           MOVE LTP-BRNO TO QLTP-BRNO.
           MOVE LTP-ACCTNO TO QLTP-ACCTNO.
           MOVE LTP-SEQNO TO QLTP-SEQNO.

           IF ( LTP-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLTP-LTOUCH-DATE
           ELSE
              MOVE LTP-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTP-LTOUCH-DATE.

           MOVE LTP-SCHLD-TERM(1) TO QLTP-SCHLD-TERM-1.
           MOVE LTP-SCHLD-PAYMNT(1) TO QLTP-SCHLD-PAYMNT-1.
           MOVE LTP-SCHLD-TERM(2) TO QLTP-SCHLD-TERM-2.
           MOVE LTP-SCHLD-PAYMNT(2) TO QLTP-SCHLD-PAYMNT-2.
           MOVE LTP-SCHLD-TERM(3) TO QLTP-SCHLD-TERM-3.
           MOVE LTP-SCHLD-PAYMNT(3) TO QLTP-SCHLD-PAYMNT-3.
           MOVE LTP-SCHLD-TERM(4) TO QLTP-SCHLD-TERM-4.
           MOVE LTP-SCHLD-PAYMNT(4) TO QLTP-SCHLD-PAYMNT-4.
           MOVE LTP-SCHLD-TERM(5) TO QLTP-SCHLD-TERM-5.
           MOVE LTP-SCHLD-PAYMNT(5) TO QLTP-SCHLD-PAYMNT-5.
           MOVE LTP-SCHLD-TERM(6) TO QLTP-SCHLD-TERM-6.
           MOVE LTP-SCHLD-PAYMNT(6) TO QLTP-SCHLD-PAYMNT-6.
           MOVE LTP-SCHLD-TERM(7) TO QLTP-SCHLD-TERM-7.
           MOVE LTP-SCHLD-PAYMNT(7) TO QLTP-SCHLD-PAYMNT-7.
           MOVE LTP-SCHLD-TERM(8) TO QLTP-SCHLD-TERM-8.
           MOVE LTP-SCHLD-PAYMNT(8) TO QLTP-SCHLD-PAYMNT-8.
           MOVE LTP-SCHLD-TERM(9) TO QLTP-SCHLD-TERM-9.
           MOVE LTP-SCHLD-PAYMNT(9) TO QLTP-SCHLD-PAYMNT-9.
           MOVE LTP-SCHLD-TERM(10) TO QLTP-SCHLD-TERM-10.
           MOVE LTP-SCHLD-PAYMNT(10) TO QLTP-SCHLD-PAYMNT-10.
           MOVE LTP-SCHLD-TERM(11) TO QLTP-SCHLD-TERM-11.
           MOVE LTP-SCHLD-PAYMNT(11) TO QLTP-SCHLD-PAYMNT-11.
           MOVE LTP-SCHLD-TERM(12) TO QLTP-SCHLD-TERM-12.
           MOVE LTP-SCHLD-PAYMNT(12) TO QLTP-SCHLD-PAYMNT-12.
           MOVE LTP-SCHLD-TERM(13) TO QLTP-SCHLD-TERM-13.
           MOVE LTP-SCHLD-PAYMNT(13) TO QLTP-SCHLD-PAYMNT-13.
           MOVE LTP-SCHLD-TERM(14) TO QLTP-SCHLD-TERM-14.
           MOVE LTP-SCHLD-PAYMNT(14) TO QLTP-SCHLD-PAYMNT-14.
           MOVE LTP-SCHLD-TERM(15) TO QLTP-SCHLD-TERM-15.
           MOVE LTP-SCHLD-PAYMNT(15) TO QLTP-SCHLD-PAYMNT-15.
           MOVE LTP-SCHLD-TERM(16) TO QLTP-SCHLD-TERM-16.
           MOVE LTP-SCHLD-PAYMNT(16) TO QLTP-SCHLD-PAYMNT-16.
           MOVE LTP-SCHLD-TERM(17) TO QLTP-SCHLD-TERM-17.
           MOVE LTP-SCHLD-PAYMNT(17) TO QLTP-SCHLD-PAYMNT-17.
           MOVE LTP-SCHLD-TERM(18) TO QLTP-SCHLD-TERM-18.
           MOVE LTP-SCHLD-PAYMNT(18) TO QLTP-SCHLD-PAYMNT-18.
           MOVE LTP-SCHLD-TERM(19) TO QLTP-SCHLD-TERM-19.
           MOVE LTP-SCHLD-PAYMNT(19) TO QLTP-SCHLD-PAYMNT-19.
           MOVE LTP-SCHLD-TERM(20) TO QLTP-SCHLD-TERM-20.
           MOVE LTP-SCHLD-PAYMNT(20) TO QLTP-SCHLD-PAYMNT-20.
           MOVE LTP-SCHLD-TERM(21) TO QLTP-SCHLD-TERM-21.
           MOVE LTP-SCHLD-PAYMNT(21) TO QLTP-SCHLD-PAYMNT-21.
           MOVE LTP-SCHLD-TERM(22) TO QLTP-SCHLD-TERM-22.
           MOVE LTP-SCHLD-PAYMNT(22) TO QLTP-SCHLD-PAYMNT-22.
           MOVE LTP-SCHLD-TERM(23) TO QLTP-SCHLD-TERM-23.
           MOVE LTP-SCHLD-PAYMNT(23) TO QLTP-SCHLD-PAYMNT-23.
           MOVE LTP-SCHLD-TERM(24) TO QLTP-SCHLD-TERM-24.
           MOVE LTP-SCHLD-PAYMNT(24) TO QLTP-SCHLD-PAYMNT-24.
           MOVE LTP-SCHLD-TERM(25) TO QLTP-SCHLD-TERM-25.
           MOVE LTP-SCHLD-PAYMNT(25) TO QLTP-SCHLD-PAYMNT-25.
           MOVE LTP-SCHLD-TERM(26) TO QLTP-SCHLD-TERM-26.
           MOVE LTP-SCHLD-PAYMNT(26) TO QLTP-SCHLD-PAYMNT-26.
           MOVE LTP-SCHLD-TERM(27) TO QLTP-SCHLD-TERM-27.
           MOVE LTP-SCHLD-PAYMNT(27) TO QLTP-SCHLD-PAYMNT-27.
           MOVE LTP-SCHLD-TERM(28) TO QLTP-SCHLD-TERM-28.
           MOVE LTP-SCHLD-PAYMNT(28) TO QLTP-SCHLD-PAYMNT-28.
           MOVE LTP-SCHLD-TERM(29) TO QLTP-SCHLD-TERM-29.
           MOVE LTP-SCHLD-PAYMNT(29) TO QLTP-SCHLD-PAYMNT-29.
           MOVE LTP-SCHLD-TERM(30) TO QLTP-SCHLD-TERM-30.
           MOVE LTP-SCHLD-PAYMNT(30) TO QLTP-SCHLD-PAYMNT-30.
           MOVE LTP-SCHLD-TERM(31) TO QLTP-SCHLD-TERM-31.
           MOVE LTP-SCHLD-PAYMNT(31) TO QLTP-SCHLD-PAYMNT-31.
           MOVE LTP-SCHLD-TERM(32) TO QLTP-SCHLD-TERM-32.
           MOVE LTP-SCHLD-PAYMNT(32) TO QLTP-SCHLD-PAYMNT-32.
           MOVE LTP-SCHLD-TERM(33) TO QLTP-SCHLD-TERM-33.
           MOVE LTP-SCHLD-PAYMNT(33) TO QLTP-SCHLD-PAYMNT-33.
           MOVE LTP-SCHLD-TERM(34) TO QLTP-SCHLD-TERM-34.
           MOVE LTP-SCHLD-PAYMNT(34) TO QLTP-SCHLD-PAYMNT-34.
           MOVE LTP-SCHLD-TERM(35) TO QLTP-SCHLD-TERM-35.
           MOVE LTP-SCHLD-PAYMNT(35) TO QLTP-SCHLD-PAYMNT-35.
           MOVE LTP-SCHLD-TERM(36) TO QLTP-SCHLD-TERM-36.
           MOVE LTP-SCHLD-PAYMNT(36) TO QLTP-SCHLD-PAYMNT-36.
           MOVE LTP-SCHLD-TERM(37) TO QLTP-SCHLD-TERM-37.
           MOVE LTP-SCHLD-PAYMNT(37) TO QLTP-SCHLD-PAYMNT-37.
           MOVE LTP-SCHLD-TERM(38) TO QLTP-SCHLD-TERM-38.
           MOVE LTP-SCHLD-PAYMNT(38) TO QLTP-SCHLD-PAYMNT-38.
           MOVE LTP-SCHLD-TERM(39) TO QLTP-SCHLD-TERM-39.
           MOVE LTP-SCHLD-PAYMNT(39) TO QLTP-SCHLD-PAYMNT-39.
           MOVE LTP-SCHLD-TERM(40) TO QLTP-SCHLD-TERM-40.
           MOVE LTP-SCHLD-PAYMNT(40) TO QLTP-SCHLD-PAYMNT-40.
           MOVE LTP-SCHLD-TERM(41) TO QLTP-SCHLD-TERM-41.
           MOVE LTP-SCHLD-PAYMNT(41) TO QLTP-SCHLD-PAYMNT-41.
 

      *================================================================*
      * END COPYBOOK: LIBLP\LPLTPGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLTIGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLTIGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN TRAILER - INSURANCE
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LTI-REC FROM QLTI-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LTI-FIELDS.
           MOVE QLTI-BRNO TO LTI-BRNO.
           MOVE QLTI-ACCTNO TO LTI-ACCTNO.
           MOVE QLTI-SEQNO TO LTI-SEQNO.

           IF ( QLTI-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LTI-LTOUCH-DATE
           ELSE
              MOVE QLTI-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTI-LTOUCH-DATE.

           MOVE QLTI-INS-TYPE TO LTI-INS-TYPE.

           IF ( QLTI-ORIG-1STPYDATE = "1900-01-01" )
              MOVE ZEROES TO LTI-ORIG-1STPYDATE
           ELSE
              MOVE QLTI-ORIG-1STPYDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTI-ORIG-1STPYDATE.

           MOVE QLTI-PRIOR-NODEF TO LTI-PRIOR-NODEF.
           MOVE QLTI-INSFEECD-1 TO LTI-INSFEECD(1).
           MOVE QLTI-INSFEE-1 TO LTI-INSFEE(1).
           MOVE QLTI-INSFEECD-2 TO LTI-INSFEECD(2).
           MOVE QLTI-INSFEE-2 TO LTI-INSFEE(2).
           MOVE QLTI-TRCD TO LTI-TRCD.
           MOVE QLTI-INSCOMP TO LTI-INSCOMP.
           MOVE QLTI-INSOURS TO LTI-INSOURS.

           IF ( QLTI-INSEFF-DATE = "1900-01-01" )
              MOVE ZEROES TO LTI-INSEFF-DATE
           ELSE
              MOVE QLTI-INSEFF-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTI-INSEFF-DATE.


           IF ( QLTI-INSEXP-DATE = "1900-01-01" )
              MOVE ZEROES TO LTI-INSEXP-DATE
           ELSE
              MOVE QLTI-INSEXP-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTI-INSEXP-DATE.

           MOVE QLTI-INSPREM TO LTI-INSPREM.
           MOVE QLTI-INSCOVR TO LTI-INSCOVR.
           MOVE QLTI-INSCOMM TO LTI-INSCOMM.
           MOVE QLTI-ANTICTERM TO LTI-ANTICTERM.
           MOVE QLTI-ANTICERN-1 TO LTI-ANTICERN(1).
           MOVE QLTI-ANTICADJ-1 TO LTI-ANTICADJ(1).
           MOVE QLTI-UFERN-1 TO LTI-UFERN(1).
           MOVE QLTI-ACCERN-1 TO LTI-ACCERN(1).
           MOVE QLTI-ANTICERN-2 TO LTI-ANTICERN(2).
           MOVE QLTI-ANTICADJ-2 TO LTI-ANTICADJ(2).
           MOVE QLTI-UFERN-2 TO LTI-UFERN(2).
           MOVE QLTI-ACCERN-2 TO LTI-ACCERN(2).
           MOVE QLTI-ANTICERN-3 TO LTI-ANTICERN(3).
           MOVE QLTI-ANTICADJ-3 TO LTI-ANTICADJ(3).
           MOVE QLTI-UFERN-3 TO LTI-UFERN(3).
           MOVE QLTI-ACCERN-3 TO LTI-ACCERN(3).
           MOVE QLTI-INT-REBATE TO LTI-INT-REBATE.
           MOVE QLTI-INS-PAYMNT-INCR TO LTI-INS-PAYMNT-INCR.
           MOVE QLTI-INS-TOT-ADDON TO LTI-INS-TOT-ADDON.
           MOVE QLTI-INT-LAST-EARNED TO LTI-INT-LAST-EARNED.
           MOVE QLTI-INS-REBATE TO LTI-INS-REBATE.
           MOVE QLTI-RB-WORKER TO LTI-RB-WORKER.

           IF ( QLTI-ANTIC-START-DATE = "1900-01-01" )
              MOVE ZEROES TO LTI-ANTIC-START-DATE
           ELSE
              MOVE QLTI-ANTIC-START-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LTI-ANTIC-START-DATE.

           MOVE QLTI-CANCEL-REASON-CD TO LTI-CANCEL-REASON-CD.
 
      *-----------------------------------------------------------------
      *    LOAD QLTI-REC FROM LTI-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LTI-FIELDS.
           MOVE LTI-BRNO TO QLTI-BRNO.
           MOVE LTI-ACCTNO TO QLTI-ACCTNO.
           MOVE LTI-SEQNO TO QLTI-SEQNO.

           IF ( LTI-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLTI-LTOUCH-DATE
           ELSE
              MOVE LTI-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTI-LTOUCH-DATE.

           MOVE LTI-INS-TYPE TO QLTI-INS-TYPE.

           IF ( LTI-ORIG-1STPYDATE = ZEROES )
              MOVE "1900-01-01" TO QLTI-ORIG-1STPYDATE
           ELSE
              MOVE LTI-ORIG-1STPYDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTI-ORIG-1STPYDATE.

           MOVE LTI-PRIOR-NODEF TO QLTI-PRIOR-NODEF.
           MOVE LTI-INSFEECD(1) TO QLTI-INSFEECD-1.
           MOVE LTI-INSFEE(1) TO QLTI-INSFEE-1.
           MOVE LTI-INSFEECD(2) TO QLTI-INSFEECD-2.
           MOVE LTI-INSFEE(2) TO QLTI-INSFEE-2.
           MOVE LTI-TRCD TO QLTI-TRCD.
           MOVE LTI-INSCOMP TO QLTI-INSCOMP.
           MOVE LTI-INSOURS TO QLTI-INSOURS.

           IF ( LTI-INSEFF-DATE = ZEROES )
              MOVE "1900-01-01" TO QLTI-INSEFF-DATE
           ELSE
              MOVE LTI-INSEFF-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTI-INSEFF-DATE.


           IF ( LTI-INSEXP-DATE = ZEROES )
              MOVE "1900-01-01" TO QLTI-INSEXP-DATE
           ELSE
              MOVE LTI-INSEXP-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTI-INSEXP-DATE.

           MOVE LTI-INSPREM TO QLTI-INSPREM.
           MOVE LTI-INSCOVR TO QLTI-INSCOVR.
           MOVE LTI-INSCOMM TO QLTI-INSCOMM.
           MOVE LTI-ANTICTERM TO QLTI-ANTICTERM.
           MOVE LTI-ANTICERN(1) TO QLTI-ANTICERN-1.
           MOVE LTI-ANTICADJ(1) TO QLTI-ANTICADJ-1.
           MOVE LTI-UFERN(1) TO QLTI-UFERN-1.
           MOVE LTI-ACCERN(1) TO QLTI-ACCERN-1.
           MOVE LTI-ANTICERN(2) TO QLTI-ANTICERN-2.
           MOVE LTI-ANTICADJ(2) TO QLTI-ANTICADJ-2.
           MOVE LTI-UFERN(2) TO QLTI-UFERN-2.
           MOVE LTI-ACCERN(2) TO QLTI-ACCERN-2.
           MOVE LTI-ANTICERN(3) TO QLTI-ANTICERN-3.
           MOVE LTI-ANTICADJ(3) TO QLTI-ANTICADJ-3.
           MOVE LTI-UFERN(3) TO QLTI-UFERN-3.
           MOVE LTI-ACCERN(3) TO QLTI-ACCERN-3.
           MOVE LTI-INT-REBATE TO QLTI-INT-REBATE.
           MOVE LTI-INS-PAYMNT-INCR TO QLTI-INS-PAYMNT-INCR.
           MOVE LTI-INS-TOT-ADDON TO QLTI-INS-TOT-ADDON.
           MOVE LTI-INT-LAST-EARNED TO QLTI-INT-LAST-EARNED.
           MOVE LTI-INS-REBATE TO QLTI-INS-REBATE.
           MOVE LTI-RB-WORKER TO QLTI-RB-WORKER.

           IF ( LTI-ANTIC-START-DATE = ZEROES )
              MOVE "1900-01-01" TO QLTI-ANTIC-START-DATE
           ELSE
              MOVE LTI-ANTIC-START-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLTI-ANTIC-START-DATE.

           MOVE LTI-CANCEL-REASON-CD TO QLTI-CANCEL-REASON-CD.
 

      *================================================================*
      * END COPYBOOK: LIBLP\LPLTIGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLPGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLPGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN PAYMENT FILE
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      * BAH 20240212 ADDED LP-REPAY-TRANS-ID #1641
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LP-REC FROM QLP-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LP-FIELDS.
           MOVE QLP-BRNO TO LP-BRNO.
           MOVE QLP-ACCTNO TO LP-ACCTNO.
           MOVE QLP-SEQNO TO LP-SEQNO.

           IF ( QLP-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LP-LTOUCH-DATE
           ELSE
              MOVE QLP-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-LTOUCH-DATE.

           MOVE QLP-USERID TO LP-USERID.

           IF ( QLP-POSTDATE = "1900-01-01" )
              MOVE ZEROES TO LP-POSTDATE
           ELSE
              MOVE QLP-POSTDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-POSTDATE.

           MOVE QLP-POSTTIME TO LP-POSTTIME.

           IF ( QLP-TRDATE = "1900-01-01" )
              MOVE ZEROES TO LP-TRDATE
           ELSE
              MOVE QLP-TRDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-TRDATE.


           IF ( QLP-PAYDATE = "1900-01-01" )
              MOVE ZEROES TO LP-PAYDATE
           ELSE
              MOVE QLP-PAYDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-PAYDATE.

           MOVE QLP-TRCD TO LP-TRCD.
           MOVE QLP-REFNO TO LP-REFNO.
           MOVE QLP-TRAMT TO LP-TRAMT.
           MOVE QLP-APOTH TO LP-APOTH.
           MOVE QLP-APOT2 TO LP-APOT2.
           MOVE QLP-APINT TO LP-APINT.
           MOVE QLP-APLC TO LP-APLC.
           MOVE QLP-APCUR TO LP-APCUR.
           MOVE QLP-OTHBAL TO LP-OTHBAL.
           MOVE QLP-OT2BAL TO LP-OT2BAL.
           MOVE QLP-INTBAL TO LP-INTBAL.
           MOVE QLP-LCBAL TO LP-LCBAL.
           MOVE QLP-CURBAL TO LP-CURBAL.
           MOVE QLP-INTDUE TO LP-INTDUE.
           MOVE QLP-DLPROC TO LP-DLPROC.
           MOVE QLP-EARNED-1 TO LP-EARNED(1).
           MOVE QLP-EARNED-2 TO LP-EARNED(2).
           MOVE QLP-EARNED-3 TO LP-EARNED(3).
           MOVE QLP-INTPAID TO LP-INTPAID.
           MOVE QLP-SSNO TO LP-SSNO.

           IF ( QLP-PDTH-DATE = "1900-01-01" )
              MOVE ZEROES TO LP-PDTH-DATE
           ELSE
              MOVE QLP-PDTH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-PDTH-DATE.


           IF ( QLP-LCPDTH-DATE = "1900-01-01" )
              MOVE ZEROES TO LP-LCPDTH-DATE
           ELSE
              MOVE QLP-LCPDTH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-LCPDTH-DATE.


           IF ( QLP-INTPDTH-DATE = "1900-01-01" )
              MOVE ZEROES TO LP-INTPDTH-DATE
           ELSE
              MOVE QLP-INTPDTH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-INTPDTH-DATE.

           MOVE QLP-TILLNO TO LP-TILLNO.
           MOVE QLP-APINTOWE TO LP-APINTOWE.
           MOVE QLP-DLPARVHELD-ADJ TO LP-DLPARVHELD-ADJ.
           MOVE QLP-LT-SEQNO TO LP-LT-SEQNO.
           MOVE QLP-IBPC TO LP-IBPC.
           MOVE QLP-MANUAL-RB TO LP-MANUAL-RB.
           MOVE QLP-INSTYPES TO LP-INSTYPES.
           MOVE QLP-REV TO LP-REV.
           MOVE QLP-REVTRCD TO LP-REVTRCD.
           MOVE QLP-REVSEQNO TO LP-REVSEQNO.
           MOVE QLP-STATUSFG TO LP-STATUSFG.
           MOVE QLP-NEWSTAT-RATE TO LP-NEWSTAT-RATE.
           MOVE QLP-LCPARTIALS TO LP-LCPARTIALS.
           MOVE QLP-ADDON-ORIG-REGPY TO LP-ADDON-ORIG-REGPY.

           IF ( QLP-NEW1ST-PYDATE = "1900-01-01" )
              MOVE ZEROES TO LP-NEW1ST-PYDATE
           ELSE
              MOVE QLP-NEW1ST-PYDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-NEW1ST-PYDATE.


           IF ( QLP-DEF-DUEDATE = "1900-01-01" )
              MOVE ZEROES TO LP-DEF-DUEDATE
           ELSE
              MOVE QLP-DEF-DUEDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-DEF-DUEDATE.

           MOVE QLP-LCPAID TO LP-LCPAID.

           IF ( QLP-OLD1ST-PYDATE = "1900-01-01" )
              MOVE ZEROES TO LP-OLD1ST-PYDATE
           ELSE
              MOVE QLP-OLD1ST-PYDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-OLD1ST-PYDATE.

           MOVE QLP-DEF-TERM TO LP-DEF-TERM.
           MOVE QLP-ADDON-LAST-PYAMT TO LP-ADDON-LAST-PYAMT.
           MOVE QLP-DLRVCHGS-ADJ-1 TO LP-DLRVCHGS-ADJ(1).
           MOVE QLP-DLRVCHGS-ADJ-2 TO LP-DLRVCHGS-ADJ(2).
           MOVE QLP-DLRVCHGS-ADJ-3 TO LP-DLRVCHGS-ADJ(3).
           MOVE QLP-DLPARVPAID-ADJ TO LP-DLPARVPAID-ADJ.
           MOVE QLP-DLNO TO LP-DLNO.
           MOVE QLP-PREPAY-PENALTY TO LP-PREPAY-PENALTY.
           MOVE QLP-PRORATED-INS-REB TO LP-PRORATED-INS-REB.
           MOVE QLP-POSTING-BR TO LP-POSTING-BR.
           MOVE QLP-NOLCHG TO LP-NOLCHG.
           MOVE QLP-COLLECTOR TO LP-COLLECTOR.
           MOVE QLP-EXTRA-PRIN-LFP TO LP-EXTRA-PRIN-LFP.
           MOVE QLP-REMAIN-INT-SINCE-LFP TO LP-REMAIN-INT-SINCE-LFP.
           MOVE QLP-REMAIN-PRIN-SINCE-LFP TO LP-REMAIN-PRIN-SINCE-LFP.
           MOVE QLP-APPLIED-TO-ESCROW TO LP-APPLIED-TO-ESCROW.
           MOVE QLP-ESCROW-PREPAID TO LP-ESCROW-PREPAID.
           MOVE QLP-PRIOR-POOLID TO LP-PRIOR-POOLID.

           IF ( QLP-ADDON-INTPDTH-DATE = "1900-01-01" )
              MOVE ZEROES TO LP-ADDON-INTPDTH-DATE
           ELSE
              MOVE QLP-ADDON-INTPDTH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LP-ADDON-INTPDTH-DATE.

           MOVE QLP-FROMCL TO LP-FROMCL.
           MOVE QLP-TOCL TO LP-TOCL.
           MOVE QLP-ALT-PREPAY-FG TO LP-ALT-PREPAY-FG.
           MOVE QLP-REPAY-TRANS-ID TO LP-REPAY-TRANS-ID.
 
      *-----------------------------------------------------------------
      *    LOAD QLP-REC FROM LP-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LP-FIELDS.
           MOVE LP-BRNO TO QLP-BRNO.
           MOVE LP-ACCTNO TO QLP-ACCTNO.
           MOVE LP-SEQNO TO QLP-SEQNO.

           IF ( LP-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLP-LTOUCH-DATE
           ELSE
              MOVE LP-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-LTOUCH-DATE.

           MOVE LP-USERID TO QLP-USERID.

           IF ( LP-POSTDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-POSTDATE
           ELSE
              MOVE LP-POSTDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-POSTDATE.

           MOVE LP-POSTTIME TO QLP-POSTTIME.

           IF ( LP-TRDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-TRDATE
           ELSE
              MOVE LP-TRDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-TRDATE.


           IF ( LP-PAYDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-PAYDATE
           ELSE
              MOVE LP-PAYDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-PAYDATE.

           MOVE LP-TRCD TO QLP-TRCD.
           MOVE LP-REFNO TO QLP-REFNO.
           MOVE LP-TRAMT TO QLP-TRAMT.
           MOVE LP-APOTH TO QLP-APOTH.
           MOVE LP-APOT2 TO QLP-APOT2.
           MOVE LP-APINT TO QLP-APINT.
           MOVE LP-APLC TO QLP-APLC.
           MOVE LP-APCUR TO QLP-APCUR.
           MOVE LP-OTHBAL TO QLP-OTHBAL.
           MOVE LP-OT2BAL TO QLP-OT2BAL.
           MOVE LP-INTBAL TO QLP-INTBAL.
           MOVE LP-LCBAL TO QLP-LCBAL.
           MOVE LP-CURBAL TO QLP-CURBAL.
           MOVE LP-INTDUE TO QLP-INTDUE.
           MOVE LP-DLPROC TO QLP-DLPROC.
           MOVE LP-EARNED(1) TO QLP-EARNED-1.
           MOVE LP-EARNED(2) TO QLP-EARNED-2.
           MOVE LP-EARNED(3) TO QLP-EARNED-3.
           MOVE LP-INTPAID TO QLP-INTPAID.
           MOVE LP-SSNO TO QLP-SSNO.

           IF ( LP-PDTH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLP-PDTH-DATE
           ELSE
              MOVE LP-PDTH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-PDTH-DATE.


           IF ( LP-LCPDTH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLP-LCPDTH-DATE
           ELSE
              MOVE LP-LCPDTH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-LCPDTH-DATE.


           IF ( LP-INTPDTH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLP-INTPDTH-DATE
           ELSE
              MOVE LP-INTPDTH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-INTPDTH-DATE.

           MOVE LP-TILLNO TO QLP-TILLNO.
           MOVE LP-APINTOWE TO QLP-APINTOWE.
           MOVE LP-DLPARVHELD-ADJ TO QLP-DLPARVHELD-ADJ.
           MOVE LP-LT-SEQNO TO QLP-LT-SEQNO.
           MOVE LP-IBPC TO QLP-IBPC.
           MOVE LP-MANUAL-RB TO QLP-MANUAL-RB.
           MOVE LP-INSTYPES TO QLP-INSTYPES.
           MOVE LP-REV TO QLP-REV.
           MOVE LP-REVTRCD TO QLP-REVTRCD.
           MOVE LP-REVSEQNO TO QLP-REVSEQNO.
           MOVE LP-STATUSFG TO QLP-STATUSFG.
           MOVE LP-NEWSTAT-RATE TO QLP-NEWSTAT-RATE.
           MOVE LP-LCPARTIALS TO QLP-LCPARTIALS.
           MOVE LP-ADDON-ORIG-REGPY TO QLP-ADDON-ORIG-REGPY.

           IF ( LP-NEW1ST-PYDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-NEW1ST-PYDATE
           ELSE
              MOVE LP-NEW1ST-PYDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-NEW1ST-PYDATE.


           IF ( LP-DEF-DUEDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-DEF-DUEDATE
           ELSE
              MOVE LP-DEF-DUEDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-DEF-DUEDATE.

           MOVE LP-LCPAID TO QLP-LCPAID.

           IF ( LP-OLD1ST-PYDATE = ZEROES )
              MOVE "1900-01-01" TO QLP-OLD1ST-PYDATE
           ELSE
              MOVE LP-OLD1ST-PYDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-OLD1ST-PYDATE.

           MOVE LP-DEF-TERM TO QLP-DEF-TERM.
           MOVE LP-ADDON-LAST-PYAMT TO QLP-ADDON-LAST-PYAMT.
           MOVE LP-DLRVCHGS-ADJ(1) TO QLP-DLRVCHGS-ADJ-1.
           MOVE LP-DLRVCHGS-ADJ(2) TO QLP-DLRVCHGS-ADJ-2.
           MOVE LP-DLRVCHGS-ADJ(3) TO QLP-DLRVCHGS-ADJ-3.
           MOVE LP-DLPARVPAID-ADJ TO QLP-DLPARVPAID-ADJ.
           MOVE LP-DLNO TO QLP-DLNO.
           MOVE LP-PREPAY-PENALTY TO QLP-PREPAY-PENALTY.
           MOVE LP-PRORATED-INS-REB TO QLP-PRORATED-INS-REB.
           MOVE LP-POSTING-BR TO QLP-POSTING-BR.
           MOVE LP-NOLCHG TO QLP-NOLCHG.
           MOVE LP-COLLECTOR TO QLP-COLLECTOR.
           MOVE LP-EXTRA-PRIN-LFP TO QLP-EXTRA-PRIN-LFP.
           MOVE LP-REMAIN-INT-SINCE-LFP TO QLP-REMAIN-INT-SINCE-LFP.
           MOVE LP-REMAIN-PRIN-SINCE-LFP TO QLP-REMAIN-PRIN-SINCE-LFP.
           MOVE LP-APPLIED-TO-ESCROW TO QLP-APPLIED-TO-ESCROW.
           MOVE LP-ESCROW-PREPAID TO QLP-ESCROW-PREPAID.
           MOVE LP-PRIOR-POOLID TO QLP-PRIOR-POOLID.

           IF ( LP-ADDON-INTPDTH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLP-ADDON-INTPDTH-DATE
           ELSE
              MOVE LP-ADDON-INTPDTH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLP-ADDON-INTPDTH-DATE.

           MOVE LP-FROMCL TO QLP-FROMCL.
           MOVE LP-TOCL TO QLP-TOCL.
           MOVE LP-ALT-PREPAY-FG TO QLP-ALT-PREPAY-FG.
           MOVE LP-REPAY-TRANS-ID TO QLP-REPAY-TRANS-ID.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLPGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLNGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLNGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN MASTER FILE
      *
      *=================================================================
      * REV:
      * JKC 2021-0430 ***NEW***
      * JKC 2024-0404 ADDED LN-LOS-APP-ID.
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LN-REC FROM QLN-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LN-FIELDS.
           MOVE QLN-OWNBR TO LN-OWNBR.
           MOVE QLN-ACCTNO TO LN-ACCTNO.
           MOVE QLN-CLASS TO LN-CLASS.
           MOVE QLN-SUBCLASS TO LN-SUBCLASS.
           MOVE QLN-LAWCODE TO LN-LAWCODE.
           MOVE QLN-SSNO1 TO LN-SSNO1.
           MOVE QLN-MAKERCD1 TO LN-MAKERCD1.
           MOVE QLN-SSNO2 TO LN-SSNO2.
           MOVE QLN-MAKERCD2 TO LN-MAKERCD2.
           MOVE QLN-SSNO3 TO LN-SSNO3.
           MOVE QLN-MAKERCD3 TO LN-MAKERCD3.
           MOVE QLN-SSNO4 TO LN-SSNO4.
           MOVE QLN-MAKERCD4 TO LN-MAKERCD4.
           MOVE QLN-ORGST TO LN-ORGST.
           MOVE QLN-ORGBR TO LN-ORGBR.
           MOVE QLN-OWNST TO LN-OWNST.
           MOVE QLN-SPRCLASS TO LN-SPRCLASS.
           MOVE QLN-CONVERCD TO LN-CONVERCD.
           MOVE QLN-MIDSTREAM TO LN-MIDSTREAM.
           MOVE QLN-PURCD TO LN-PURCD.
           MOVE QLN-SRCD TO LN-SRCD.
           MOVE QLN-COLLCD TO LN-COLLCD.
           MOVE QLN-COLLID TO LN-COLLID.
           MOVE QLN-POCD TO LN-POCD.
           MOVE QLN-PLCD TO LN-PLCD.
           MOVE QLN-PLTYPE TO LN-PLTYPE.
           MOVE QLN-CONFIDENTCD TO LN-CONFIDENTCD.
           MOVE QLN-ALLOTCD TO LN-ALLOTCD.
           MOVE QLN-RECASTCD TO LN-RECASTCD.
           MOVE QLN-SKIP-TRW TO LN-SKIP-TRW.
           MOVE QLN-STATUSFG TO LN-STATUSFG.
           MOVE QLN-SMALLOAN TO LN-SMALLOAN.
           MOVE QLN-SALEFIN TO LN-SALEFIN.
           MOVE QLN-SERVACCT TO LN-SERVACCT.
           MOVE QLN-LOANTYPE TO LN-LOANTYPE.
           MOVE QLN-ADDON-FG TO LN-ADDON-FG.
           MOVE QLN-PAY-SCHLD-FG TO LN-PAY-SCHLD-FG.
           MOVE QLN-LC-CODE TO LN-LC-CODE.
           MOVE QLN-CAN-LOAN-NO TO LN-CAN-LOAN-NO.
           MOVE QLN-STATFLAGS TO LN-STATFLAGS.

           MOVE QLN-ENTDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-ENTDATE.


           MOVE QLN-LOANDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LOANDATE.


           MOVE QLN-PURDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PURDATE.


           MOVE QLN-INTDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INTDATE.


           MOVE QLN-CASHDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-CASHDATE.


           MOVE QLN-FILEDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-FILEDATE.


           MOVE QLN-RESCISSION-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-RESCISSION-DATE.


           MOVE QLN-PART-RECOURSE-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PART-RECOURSE-DATE.


           MOVE QLN-ORIG-1STPYDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-ORIG-1STPYDATE.


           MOVE QLN-1STPYDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-1STPYDATE.


           MOVE QLN-JDDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-JDDATE.


           MOVE QLN-PLDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PLDATE.


           MOVE QLN-PL-TRDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PL-TRDATE.


           MOVE QLN-ACCELDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-ACCELDATE.


           MOVE QLN-REDUDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-REDUDATE.


           MOVE QLN-POFFDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-POFFDATE.


           MOVE QLN-PO-TRDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PO-TRDATE.


           MOVE QLN-LEGALDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LEGALDATE.


           MOVE QLN-BNKRPTDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-BNKRPTDATE.


           MOVE QLN-BNKRPT-DISMISS-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-BNKRPT-DISMISS-DATE.


           MOVE QLN-BNKRPT-DISCHARGE-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-BNKRPT-DISCHARGE-DATE.


           MOVE QLN-BNKRPT-REAFFIRM-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-BNKRPT-REAFFIRM-DATE.


           MOVE QLN-DEBTAIDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-DEBTAIDATE.


           MOVE QLN-REPODATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-REPODATE.


           MOVE QLN-REDEEMDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-REDEEMDATE.


           MOVE QLN-SOLDDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-SOLDDATE.


           MOVE QLN-INS-CONFIRM-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INS-CONFIRM-DATE.


           MOVE QLN-PRIOR-RN-FOR10-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PRIOR-RN-FOR10-DATE.


           MOVE QLN-LAST-RN-FOR10-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LAST-RN-FOR10-DATE.


           MOVE QLN-TRW-DOFD-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-TRW-DOFD-DATE.


           MOVE QLN-LAST-PYPA-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LAST-PYPA-DATE.


           MOVE QLN-BT-TRDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-BT-TRDATE.


           MOVE QLN-METRO2-LAST-PMT-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-METRO2-LAST-PMT-DATE.


           MOVE QLN-FOLLOWUP-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-FOLLOWUP-DATE.


           MOVE QLN-LAST-ACCRUAL-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LAST-ACCRUAL-DATE.

           MOVE QLN-APRATE TO LN-APRATE.
           MOVE QLN-EFFRATE TO LN-EFFRATE.
           MOVE QLN-SMPRATE TO LN-SMPRATE.
           MOVE QLN-YLDRATE TO LN-YLDRATE.
           MOVE QLN-OVRDRATE TO LN-OVRDRATE.
           MOVE QLN-ENDORATE TO LN-ENDORATE.
           MOVE QLN-JDRATE TO LN-JDRATE.
           MOVE QLN-ACCRATE TO LN-ACCRATE.
           MOVE QLN-REDURATE TO LN-REDURATE.
           MOVE QLN-CONRATE TO LN-CONRATE.
           MOVE QLN-SERVPER TO LN-SERVPER.
           MOVE QLN-SELLPR TO LN-SELLPR.
           MOVE QLN-DOWNPY TO LN-DOWNPY.
           MOVE QLN-TRADEIN TO LN-TRADEIN.
           MOVE QLN-LNAMT TO LN-LNAMT.
           MOVE QLN-FINCHG TO LN-FINCHG.
           MOVE QLN-INTCHG TO LN-INTCHG.
           MOVE QLN-SERCHG TO LN-SERCHG.
           MOVE QLN-EXTCHG TO LN-EXTCHG.
           MOVE QLN-MAINTFEE TO LN-MAINTFEE.
           MOVE QLN-POINTS TO LN-POINTS.
           MOVE QLN-PROCEEDS TO LN-PROCEEDS.
           MOVE QLN-ORGTERM TO LN-ORGTERM.
           MOVE QLN-1STPYAMT TO LN-1STPYAMT.
           MOVE QLN-NOREGPY TO LN-NOREGPY.
           MOVE QLN-REGPYAMT TO LN-REGPYAMT.
           MOVE QLN-LASTPYAMT TO LN-LASTPYAMT.
           MOVE QLN-PROCASH TO LN-PROCASH.
           MOVE QLN-TILLNO TO LN-TILLNO.
           MOVE QLN-STATE-FLAG TO LN-STATE-FLAG.
           MOVE QLN-STATE-WORKER TO LN-STATE-WORKER.
           MOVE QLN-STATE-WORKER2 TO LN-STATE-WORKER2.
           MOVE QLN-FEECODE-1 TO LN-FEECODE(1).
           MOVE QLN-FEEAMT-1 TO LN-FEEAMT(1).
           MOVE QLN-FEEOURS-1 TO LN-FEEOURS(1).
           MOVE QLN-FEEFINCHG-1 TO LN-FEEFINCHG(1).
           MOVE QLN-FEECODE-2 TO LN-FEECODE(2).
           MOVE QLN-FEEAMT-2 TO LN-FEEAMT(2).
           MOVE QLN-FEEOURS-2 TO LN-FEEOURS(2).
           MOVE QLN-FEEFINCHG-2 TO LN-FEEFINCHG(2).
           MOVE QLN-FEECODE-3 TO LN-FEECODE(3).
           MOVE QLN-FEEAMT-3 TO LN-FEEAMT(3).
           MOVE QLN-FEEOURS-3 TO LN-FEEOURS(3).
           MOVE QLN-FEEFINCHG-3 TO LN-FEEFINCHG(3).
           MOVE QLN-FEECODE-4 TO LN-FEECODE(4).
           MOVE QLN-FEEAMT-4 TO LN-FEEAMT(4).
           MOVE QLN-FEEOURS-4 TO LN-FEEOURS(4).
           MOVE QLN-FEEFINCHG-4 TO LN-FEEFINCHG(4).
           MOVE QLN-FEECODE-5 TO LN-FEECODE(5).
           MOVE QLN-FEEAMT-5 TO LN-FEEAMT(5).
           MOVE QLN-FEEOURS-5 TO LN-FEEOURS(5).
           MOVE QLN-FEEFINCHG-5 TO LN-FEEFINCHG(5).
           MOVE QLN-FEECODE-6 TO LN-FEECODE(6).
           MOVE QLN-FEEAMT-6 TO LN-FEEAMT(6).
           MOVE QLN-FEEOURS-6 TO LN-FEEOURS(6).
           MOVE QLN-FEEFINCHG-6 TO LN-FEEFINCHG(6).
           MOVE QLN-FEECODE-7 TO LN-FEECODE(7).
           MOVE QLN-FEEAMT-7 TO LN-FEEAMT(7).
           MOVE QLN-FEEOURS-7 TO LN-FEEOURS(7).
           MOVE QLN-FEEFINCHG-7 TO LN-FEEFINCHG(7).
           MOVE QLN-FEECODE-8 TO LN-FEECODE(8).
           MOVE QLN-FEEAMT-8 TO LN-FEEAMT(8).
           MOVE QLN-FEEOURS-8 TO LN-FEEOURS(8).
           MOVE QLN-FEEFINCHG-8 TO LN-FEEFINCHG(8).
           MOVE QLN-FEECODE-9 TO LN-FEECODE(9).
           MOVE QLN-FEEAMT-9 TO LN-FEEAMT(9).
           MOVE QLN-FEEOURS-9 TO LN-FEEOURS(9).
           MOVE QLN-FEEFINCHG-9 TO LN-FEEFINCHG(9).
           MOVE QLN-FEECODE-10 TO LN-FEECODE(10).
           MOVE QLN-FEEAMT-10 TO LN-FEEAMT(10).
           MOVE QLN-FEEOURS-10 TO LN-FEEOURS(10).
           MOVE QLN-FEEFINCHG-10 TO LN-FEEFINCHG(10).
           MOVE QLN-FEECODE-11 TO LN-FEECODE(11).
           MOVE QLN-FEEAMT-11 TO LN-FEEAMT(11).
           MOVE QLN-FEEOURS-11 TO LN-FEEOURS(11).
           MOVE QLN-FEEFINCHG-11 TO LN-FEEFINCHG(11).
           MOVE QLN-FEECODE-12 TO LN-FEECODE(12).
           MOVE QLN-FEEAMT-12 TO LN-FEEAMT(12).
           MOVE QLN-FEEOURS-12 TO LN-FEEOURS(12).
           MOVE QLN-FEEFINCHG-12 TO LN-FEEFINCHG(12).
           MOVE QLN-FEECODE-13 TO LN-FEECODE(13).
           MOVE QLN-FEEAMT-13 TO LN-FEEAMT(13).
           MOVE QLN-FEEOURS-13 TO LN-FEEOURS(13).
           MOVE QLN-FEEFINCHG-13 TO LN-FEEFINCHG(13).
           MOVE QLN-FEECODE-14 TO LN-FEECODE(14).
           MOVE QLN-FEEAMT-14 TO LN-FEEAMT(14).
           MOVE QLN-FEEOURS-14 TO LN-FEEOURS(14).
           MOVE QLN-FEEFINCHG-14 TO LN-FEEFINCHG(14).
           MOVE QLN-FEECODE-15 TO LN-FEECODE(15).
           MOVE QLN-FEEAMT-15 TO LN-FEEAMT(15).
           MOVE QLN-FEEOURS-15 TO LN-FEEOURS(15).
           MOVE QLN-FEEFINCHG-15 TO LN-FEEFINCHG(15).
           MOVE QLN-FEECODE-16 TO LN-FEECODE(16).
           MOVE QLN-FEEAMT-16 TO LN-FEEAMT(16).
           MOVE QLN-FEEOURS-16 TO LN-FEEOURS(16).
           MOVE QLN-FEEFINCHG-16 TO LN-FEEFINCHG(16).
           MOVE QLN-FEECODE-17 TO LN-FEECODE(17).
           MOVE QLN-FEEAMT-17 TO LN-FEEAMT(17).
           MOVE QLN-FEEOURS-17 TO LN-FEEOURS(17).
           MOVE QLN-FEEFINCHG-17 TO LN-FEEFINCHG(17).
           MOVE QLN-FEECODE-18 TO LN-FEECODE(18).
           MOVE QLN-FEEAMT-18 TO LN-FEEAMT(18).
           MOVE QLN-FEEOURS-18 TO LN-FEEOURS(18).
           MOVE QLN-FEEFINCHG-18 TO LN-FEEFINCHG(18).
           MOVE QLN-FEECODE-19 TO LN-FEECODE(19).
           MOVE QLN-FEEAMT-19 TO LN-FEEAMT(19).
           MOVE QLN-FEEOURS-19 TO LN-FEEOURS(19).
           MOVE QLN-FEEFINCHG-19 TO LN-FEEFINCHG(19).
           MOVE QLN-FEECODE-20 TO LN-FEECODE(20).
           MOVE QLN-FEEAMT-20 TO LN-FEEAMT(20).
           MOVE QLN-FEEOURS-20 TO LN-FEEOURS(20).
           MOVE QLN-FEEFINCHG-20 TO LN-FEEFINCHG(20).
           MOVE QLN-INSURED TO LN-INSURED.
           MOVE QLN-INSTYPES TO LN-INSTYPES.
           MOVE QLN-INSELIGIBLE TO LN-INSELIGIBLE.
           MOVE QLN-INSCOMP-1 TO LN-INSCOMP(1).
           MOVE QLN-INSOURS-1 TO LN-INSOURS(1).

           MOVE QLN-INSEFF-DATE-1 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(1).


           MOVE QLN-INSEXP-DATE-1 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(1).

           MOVE QLN-INSPREM-1 TO LN-INSPREM(1).
           MOVE QLN-INSCOVR-1 TO LN-INSCOVR(1).
           MOVE QLN-INSCOMM-1 TO LN-INSCOMM(1).
           MOVE QLN-INSANTICERN-1 TO LN-INSANTICERN(1).
           MOVE QLN-INSANTICADJ-1 TO LN-INSANTICADJ(1).
           MOVE QLN-INSUFERN-1 TO LN-INSUFERN(1).
           MOVE QLN-INSACCERN-1 TO LN-INSACCERN(1).
           MOVE QLN-INSEARN-ORDER-1 TO LN-INSEARN-ORDER(1).
           MOVE QLN-INSFINCHG-1 TO LN-INSFINCHG(1).
           MOVE QLN-INSCOMP-2 TO LN-INSCOMP(2).
           MOVE QLN-INSOURS-2 TO LN-INSOURS(2).

           MOVE QLN-INSEFF-DATE-2 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(2).


           MOVE QLN-INSEXP-DATE-2 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(2).

           MOVE QLN-INSPREM-2 TO LN-INSPREM(2).
           MOVE QLN-INSCOVR-2 TO LN-INSCOVR(2).
           MOVE QLN-INSCOMM-2 TO LN-INSCOMM(2).
           MOVE QLN-INSANTICERN-2 TO LN-INSANTICERN(2).
           MOVE QLN-INSANTICADJ-2 TO LN-INSANTICADJ(2).
           MOVE QLN-INSUFERN-2 TO LN-INSUFERN(2).
           MOVE QLN-INSACCERN-2 TO LN-INSACCERN(2).
           MOVE QLN-INSEARN-ORDER-2 TO LN-INSEARN-ORDER(2).
           MOVE QLN-INSFINCHG-2 TO LN-INSFINCHG(2).
           MOVE QLN-INSCOMP-3 TO LN-INSCOMP(3).
           MOVE QLN-INSOURS-3 TO LN-INSOURS(3).

           MOVE QLN-INSEFF-DATE-3 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(3).


           MOVE QLN-INSEXP-DATE-3 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(3).

           MOVE QLN-INSPREM-3 TO LN-INSPREM(3).
           MOVE QLN-INSCOVR-3 TO LN-INSCOVR(3).
           MOVE QLN-INSCOMM-3 TO LN-INSCOMM(3).
           MOVE QLN-INSANTICERN-3 TO LN-INSANTICERN(3).
           MOVE QLN-INSANTICADJ-3 TO LN-INSANTICADJ(3).
           MOVE QLN-INSUFERN-3 TO LN-INSUFERN(3).
           MOVE QLN-INSACCERN-3 TO LN-INSACCERN(3).
           MOVE QLN-INSEARN-ORDER-3 TO LN-INSEARN-ORDER(3).
           MOVE QLN-INSFINCHG-3 TO LN-INSFINCHG(3).
           MOVE QLN-INSCOMP-4 TO LN-INSCOMP(4).
           MOVE QLN-INSOURS-4 TO LN-INSOURS(4).

           MOVE QLN-INSEFF-DATE-4 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(4).


           MOVE QLN-INSEXP-DATE-4 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(4).

           MOVE QLN-INSPREM-4 TO LN-INSPREM(4).
           MOVE QLN-INSCOVR-4 TO LN-INSCOVR(4).
           MOVE QLN-INSCOMM-4 TO LN-INSCOMM(4).
           MOVE QLN-INSANTICERN-4 TO LN-INSANTICERN(4).
           MOVE QLN-INSANTICADJ-4 TO LN-INSANTICADJ(4).
           MOVE QLN-INSUFERN-4 TO LN-INSUFERN(4).
           MOVE QLN-INSACCERN-4 TO LN-INSACCERN(4).
           MOVE QLN-INSEARN-ORDER-4 TO LN-INSEARN-ORDER(4).
           MOVE QLN-INSFINCHG-4 TO LN-INSFINCHG(4).
           MOVE QLN-INSCOMP-5 TO LN-INSCOMP(5).
           MOVE QLN-INSOURS-5 TO LN-INSOURS(5).

           MOVE QLN-INSEFF-DATE-5 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(5).


           MOVE QLN-INSEXP-DATE-5 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(5).

           MOVE QLN-INSPREM-5 TO LN-INSPREM(5).
           MOVE QLN-INSCOVR-5 TO LN-INSCOVR(5).
           MOVE QLN-INSCOMM-5 TO LN-INSCOMM(5).
           MOVE QLN-INSANTICERN-5 TO LN-INSANTICERN(5).
           MOVE QLN-INSANTICADJ-5 TO LN-INSANTICADJ(5).
           MOVE QLN-INSUFERN-5 TO LN-INSUFERN(5).
           MOVE QLN-INSACCERN-5 TO LN-INSACCERN(5).
           MOVE QLN-INSEARN-ORDER-5 TO LN-INSEARN-ORDER(5).
           MOVE QLN-INSFINCHG-5 TO LN-INSFINCHG(5).
           MOVE QLN-INSCOMP-6 TO LN-INSCOMP(6).
           MOVE QLN-INSOURS-6 TO LN-INSOURS(6).

           MOVE QLN-INSEFF-DATE-6 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(6).


           MOVE QLN-INSEXP-DATE-6 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(6).

           MOVE QLN-INSPREM-6 TO LN-INSPREM(6).
           MOVE QLN-INSCOVR-6 TO LN-INSCOVR(6).
           MOVE QLN-INSCOMM-6 TO LN-INSCOMM(6).
           MOVE QLN-INSANTICERN-6 TO LN-INSANTICERN(6).
           MOVE QLN-INSANTICADJ-6 TO LN-INSANTICADJ(6).
           MOVE QLN-INSUFERN-6 TO LN-INSUFERN(6).
           MOVE QLN-INSACCERN-6 TO LN-INSACCERN(6).
           MOVE QLN-INSEARN-ORDER-6 TO LN-INSEARN-ORDER(6).
           MOVE QLN-INSFINCHG-6 TO LN-INSFINCHG(6).
           MOVE QLN-INSCOMP-7 TO LN-INSCOMP(7).
           MOVE QLN-INSOURS-7 TO LN-INSOURS(7).

           MOVE QLN-INSEFF-DATE-7 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(7).


           MOVE QLN-INSEXP-DATE-7 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(7).

           MOVE QLN-INSPREM-7 TO LN-INSPREM(7).
           MOVE QLN-INSCOVR-7 TO LN-INSCOVR(7).
           MOVE QLN-INSCOMM-7 TO LN-INSCOMM(7).
           MOVE QLN-INSANTICERN-7 TO LN-INSANTICERN(7).
           MOVE QLN-INSANTICADJ-7 TO LN-INSANTICADJ(7).
           MOVE QLN-INSUFERN-7 TO LN-INSUFERN(7).
           MOVE QLN-INSACCERN-7 TO LN-INSACCERN(7).
           MOVE QLN-INSEARN-ORDER-7 TO LN-INSEARN-ORDER(7).
           MOVE QLN-INSFINCHG-7 TO LN-INSFINCHG(7).
           MOVE QLN-INSCOMP-8 TO LN-INSCOMP(8).
           MOVE QLN-INSOURS-8 TO LN-INSOURS(8).

           MOVE QLN-INSEFF-DATE-8 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(8).


           MOVE QLN-INSEXP-DATE-8 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(8).

           MOVE QLN-INSPREM-8 TO LN-INSPREM(8).
           MOVE QLN-INSCOVR-8 TO LN-INSCOVR(8).
           MOVE QLN-INSCOMM-8 TO LN-INSCOMM(8).
           MOVE QLN-INSANTICERN-8 TO LN-INSANTICERN(8).
           MOVE QLN-INSANTICADJ-8 TO LN-INSANTICADJ(8).
           MOVE QLN-INSUFERN-8 TO LN-INSUFERN(8).
           MOVE QLN-INSACCERN-8 TO LN-INSACCERN(8).
           MOVE QLN-INSEARN-ORDER-8 TO LN-INSEARN-ORDER(8).
           MOVE QLN-INSFINCHG-8 TO LN-INSFINCHG(8).
           MOVE QLN-INSCOMP-9 TO LN-INSCOMP(9).
           MOVE QLN-INSOURS-9 TO LN-INSOURS(9).

           MOVE QLN-INSEFF-DATE-9 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(9).


           MOVE QLN-INSEXP-DATE-9 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(9).

           MOVE QLN-INSPREM-9 TO LN-INSPREM(9).
           MOVE QLN-INSCOVR-9 TO LN-INSCOVR(9).
           MOVE QLN-INSCOMM-9 TO LN-INSCOMM(9).
           MOVE QLN-INSANTICERN-9 TO LN-INSANTICERN(9).
           MOVE QLN-INSANTICADJ-9 TO LN-INSANTICADJ(9).
           MOVE QLN-INSUFERN-9 TO LN-INSUFERN(9).
           MOVE QLN-INSACCERN-9 TO LN-INSACCERN(9).
           MOVE QLN-INSEARN-ORDER-9 TO LN-INSEARN-ORDER(9).
           MOVE QLN-INSFINCHG-9 TO LN-INSFINCHG(9).
           MOVE QLN-INSCOMP-10 TO LN-INSCOMP(10).
           MOVE QLN-INSOURS-10 TO LN-INSOURS(10).

           MOVE QLN-INSEFF-DATE-10 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEFF-DATE(10).


           MOVE QLN-INSEXP-DATE-10 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INSEXP-DATE(10).

           MOVE QLN-INSPREM-10 TO LN-INSPREM(10).
           MOVE QLN-INSCOVR-10 TO LN-INSCOVR(10).
           MOVE QLN-INSCOMM-10 TO LN-INSCOMM(10).
           MOVE QLN-INSANTICERN-10 TO LN-INSANTICERN(10).
           MOVE QLN-INSANTICADJ-10 TO LN-INSANTICADJ(10).
           MOVE QLN-INSUFERN-10 TO LN-INSUFERN(10).
           MOVE QLN-INSACCERN-10 TO LN-INSACCERN(10).
           MOVE QLN-INSEARN-ORDER-10 TO LN-INSEARN-ORDER(10).
           MOVE QLN-INSFINCHG-10 TO LN-INSFINCHG(10).
           MOVE QLN-PY-YYYYMM-RECDEL TO LN-PY-YYYYMM-RECDEL.
           MOVE QLN-MTD-PAYS-RECDEL TO LN-MTD-PAYS-RECDEL.
           MOVE QLN-GARNISH-EXTR TO LN-GARNISH-EXTR.
           MOVE QLN-SHIP-SAME-FG TO LN-SHIP-SAME-FG.
           MOVE QLN-AD-D-INS-COVR TO LN-AD-D-INS-COVR.
           MOVE QLN-TOT-PARTIAL-CHGOFF TO LN-TOT-PARTIAL-CHGOFF.
           MOVE QLN-LPO TO LN-LPO.
           MOVE QLN-REP-CD TO LN-REP-CD.
           MOVE QLN-EMP-ID TO LN-EMP-ID.
           MOVE QLN-PROCESS-CD TO LN-PROCESS-CD.
           MOVE QLN-WCBC-CREDITLIM TO LN-WCBC-CREDITLIM.
           MOVE QLN-FOLLOWUP-CD TO LN-FOLLOWUP-CD.
           MOVE QLN-MIP-FG TO LN-MIP-FG.
           MOVE QLN-MIP-MTD-CLAHPAID TO LN-MIP-MTD-CLAHPAID.

           MOVE QLN-MIP-CLPDTH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-MIP-CLPDTH-DATE.

           MOVE QLN-MIP-TOT-CLPAID TO LN-MIP-TOT-CLPAID.

           MOVE QLN-MIP-AHPDTH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-MIP-AHPDTH-DATE.

           MOVE QLN-MIP-TOT-AHPAID TO LN-MIP-TOT-AHPAID.
           MOVE QLN-IL-GROSS-INCOME TO LN-IL-GROSS-INCOME.
           MOVE QLN-IL-GROSS-INCOME2 TO LN-IL-GROSS-INCOME2.
           MOVE QLN-RESCISSION TO LN-RESCISSION.
           MOVE QLN-INTERIM-TRW TO LN-INTERIM-TRW.
           MOVE QLN-DLNO TO LN-DLNO.
           MOVE QLN-DLPOOL TO LN-DLPOOL.
           MOVE QLN-DLRECOURSE TO LN-DLRECOURSE.
           MOVE QLN-DLPARTRCAMT TO LN-DLPARTRCAMT.
           MOVE QLN-ORIGPURAMT TO LN-ORIGPURAMT.
           MOVE QLN-PURBAL TO LN-PURBAL.
           MOVE QLN-DLRVPRIN-1 TO LN-DLRVPRIN(1).
           MOVE QLN-DLRVPRIN-2 TO LN-DLRVPRIN(2).
           MOVE QLN-DLRVPRIN-3 TO LN-DLRVPRIN(3).
           MOVE QLN-DLRVCHGS-1 TO LN-DLRVCHGS(1).
           MOVE QLN-DLRVCHGS-2 TO LN-DLRVCHGS(2).
           MOVE QLN-DLRVCHGS-3 TO LN-DLRVCHGS(3).
           MOVE QLN-DLPARVHELD TO LN-DLPARVHELD.
           MOVE QLN-DLPARVPAID TO LN-DLPARVPAID.
           MOVE QLN-DLDISC TO LN-DLDISC.

           MOVE QLN-LCPDTH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LCPDTH-DATE.


           MOVE QLN-INTPDTH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-INTPDTH-DATE.

           MOVE QLN-CURBAL TO LN-CURBAL.
           MOVE QLN-INTBAL TO LN-INTBAL.
           MOVE QLN-LCBAL TO LN-LCBAL.
           MOVE QLN-OTHBAL TO LN-OTHBAL.
           MOVE QLN-OT2BAL TO LN-OT2BAL.
           MOVE QLN-LCPAID TO LN-LCPAID.
           MOVE QLN-LCPARTIALS TO LN-LCPARTIALS.
           MOVE QLN-STMT-COUNTER TO LN-STMT-COUNTER.
           MOVE QLN-PRIOR-STMT-COUNTER TO LN-PRIOR-STMT-COUNTER.
           MOVE QLN-FROZEN-REASON TO LN-FROZEN-REASON.
           MOVE QLN-COUPON-STATEMENT TO LN-COUPON-STATEMENT.
           MOVE QLN-MONTHEND-BAL TO LN-MONTHEND-BAL.
           MOVE QLN-ANTICTERM TO LN-ANTICTERM.
           MOVE QLN-ANTICERN-1 TO LN-ANTICERN(1).
           MOVE QLN-ANTICADJ-1 TO LN-ANTICADJ(1).
           MOVE QLN-UFERN-1 TO LN-UFERN(1).
           MOVE QLN-ACCERN-1 TO LN-ACCERN(1).
           MOVE QLN-EARN-ORDER-1 TO LN-EARN-ORDER(1).
           MOVE QLN-ANTICERN-2 TO LN-ANTICERN(2).
           MOVE QLN-ANTICADJ-2 TO LN-ANTICADJ(2).
           MOVE QLN-UFERN-2 TO LN-UFERN(2).
           MOVE QLN-ACCERN-2 TO LN-ACCERN(2).
           MOVE QLN-EARN-ORDER-2 TO LN-EARN-ORDER(2).
           MOVE QLN-ANTICERN-3 TO LN-ANTICERN(3).
           MOVE QLN-ANTICADJ-3 TO LN-ANTICADJ(3).
           MOVE QLN-UFERN-3 TO LN-UFERN(3).
           MOVE QLN-ACCERN-3 TO LN-ACCERN(3).
           MOVE QLN-EARN-ORDER-3 TO LN-EARN-ORDER(3).
           MOVE QLN-ANTICERN-4 TO LN-ANTICERN(4).
           MOVE QLN-ANTICADJ-4 TO LN-ANTICADJ(4).
           MOVE QLN-UFERN-4 TO LN-UFERN(4).
           MOVE QLN-ACCERN-4 TO LN-ACCERN(4).
           MOVE QLN-EARN-ORDER-4 TO LN-EARN-ORDER(4).
           MOVE QLN-ANTICERN-5 TO LN-ANTICERN(5).
           MOVE QLN-ANTICADJ-5 TO LN-ANTICADJ(5).
           MOVE QLN-UFERN-5 TO LN-UFERN(5).
           MOVE QLN-ACCERN-5 TO LN-ACCERN(5).
           MOVE QLN-EARN-ORDER-5 TO LN-EARN-ORDER(5).
           MOVE QLN-ANTICERN-6 TO LN-ANTICERN(6).
           MOVE QLN-ANTICADJ-6 TO LN-ANTICADJ(6).
           MOVE QLN-UFERN-6 TO LN-UFERN(6).
           MOVE QLN-ACCERN-6 TO LN-ACCERN(6).
           MOVE QLN-EARN-ORDER-6 TO LN-EARN-ORDER(6).
           MOVE QLN-ANTICERN-7 TO LN-ANTICERN(7).
           MOVE QLN-ANTICADJ-7 TO LN-ANTICADJ(7).
           MOVE QLN-UFERN-7 TO LN-UFERN(7).
           MOVE QLN-ACCERN-7 TO LN-ACCERN(7).
           MOVE QLN-EARN-ORDER-7 TO LN-EARN-ORDER(7).
           MOVE QLN-ANTICERN-8 TO LN-ANTICERN(8).
           MOVE QLN-ANTICADJ-8 TO LN-ANTICADJ(8).
           MOVE QLN-UFERN-8 TO LN-UFERN(8).
           MOVE QLN-ACCERN-8 TO LN-ACCERN(8).
           MOVE QLN-EARN-ORDER-8 TO LN-EARN-ORDER(8).
           MOVE QLN-ANTICERN-9 TO LN-ANTICERN(9).
           MOVE QLN-ANTICADJ-9 TO LN-ANTICADJ(9).
           MOVE QLN-UFERN-9 TO LN-UFERN(9).
           MOVE QLN-ACCERN-9 TO LN-ACCERN(9).
           MOVE QLN-EARN-ORDER-9 TO LN-EARN-ORDER(9).
           MOVE QLN-ANTICERN-10 TO LN-ANTICERN(10).
           MOVE QLN-ANTICADJ-10 TO LN-ANTICADJ(10).
           MOVE QLN-UFERN-10 TO LN-UFERN(10).
           MOVE QLN-ACCERN-10 TO LN-ACCERN(10).
           MOVE QLN-EARN-ORDER-10 TO LN-EARN-ORDER(10).
           MOVE QLN-LMO-PRIOR-INTEREST TO LN-LMO-PRIOR-INTEREST.
           MOVE QLN-PRIOR-UNEARNED TO LN-PRIOR-UNEARNED.
           MOVE QLN-ERNDELQ-STOP TO LN-ERNDELQ-STOP.
           MOVE QLN-NONACRERN TO LN-NONACRERN.
           MOVE QLN-PRIOR-NONACRERN TO LN-PRIOR-NONACRERN.

           MOVE QLN-ERN-IB-PDTH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-ERN-IB-PDTH-DATE.

           MOVE QLN-ERN-IB-PRINBAL TO LN-ERN-IB-PRINBAL.
           MOVE QLN-ERN-IB-INTOWE TO LN-ERN-IB-INTOWE.
           MOVE QLN-TOTERN TO LN-TOTERN.
           MOVE QLN-TOTOTH TO LN-TOTOTH.
           MOVE QLN-TOTINT TO LN-TOTINT.
           MOVE QLN-TOTLCHG TO LN-TOTLCHG.
           MOVE QLN-TOTDEF TO LN-TOTDEF.
           MOVE QLN-TOTSERACCT TO LN-TOTSERACCT.
           MOVE QLN-LCWAIVERS TO LN-LCWAIVERS.
           MOVE QLN-INTWAIVERS TO LN-INTWAIVERS.
           MOVE QLN-TOTPAYMNTD TO LN-TOTPAYMNTD.
           MOVE QLN-TOTEXCPAYMNTD TO LN-TOTEXCPAYMNTD.
           MOVE QLN-TOTNODEF TO LN-TOTNODEF.
           MOVE QLN-YTDNODEF TO LN-YTDNODEF.
           MOVE QLN-TOTNODEFACT TO LN-TOTNODEFACT.
           MOVE QLN-YTDNODEFACT TO LN-YTDNODEFACT.
           MOVE QLN-TOTNOALDEL TO LN-TOTNOALDEL.
           MOVE QLN-YTDNOALDEL TO LN-YTDNOALDEL.
           MOVE QLN-YTDINTPD TO LN-YTDINTPD.
           MOVE QLN-LYRINTPD TO LN-LYRINTPD.
           MOVE QLN-TOTINTPD TO LN-TOTINTPD.
           MOVE QLN-RECASTINT TO LN-RECASTINT.
           MOVE QLN-RECASTPRIN TO LN-RECASTPRIN.
           MOVE QLN-CL-REBATE TO LN-CL-REBATE.
           MOVE QLN-AH-REBATE TO LN-AH-REBATE.
           MOVE QLN-PP-REBATE TO LN-PP-REBATE.
           MOVE QLN-INT-REBATE TO LN-INT-REBATE.
           MOVE QLN-SC-REBATE TO LN-SC-REBATE.
           MOVE QLN-MF-REBATE TO LN-MF-REBATE.
           MOVE QLN-DF-REBATE TO LN-DF-REBATE.
           MOVE QLN-EX-REBATE TO LN-EX-REBATE.
           MOVE QLN-O1-REBATE TO LN-O1-REBATE.
           MOVE QLN-O2-REBATE TO LN-O2-REBATE.
           MOVE QLN-O3-REBATE TO LN-O3-REBATE.
           MOVE QLN-O4-REBATE TO LN-O4-REBATE.
           MOVE QLN-O5-REBATE TO LN-O5-REBATE.
           MOVE QLN-O6-REBATE TO LN-O6-REBATE.
           MOVE QLN-O7-REBATE TO LN-O7-REBATE.
           MOVE QLN-UN-O7-REB TO LN-UN-O7-REB.
           MOVE QLN-UN-O8-REB TO LN-UN-O8-REB.
           MOVE QLN-UN-O9-REB TO LN-UN-O9-REB.
           MOVE QLN-UN-O10-REB TO LN-UN-O10-REB.
           MOVE QLN-PLREASON TO LN-PLREASON.
           MOVE QLN-COLLECTOR TO LN-COLLECTOR.
           MOVE QLN-ACTIONCD TO LN-ACTIONCD.
           MOVE QLN-ACTIONCD2 TO LN-ACTIONCD2.
           MOVE QLN-ATCODE TO LN-ATCODE.
           MOVE QLN-RECODE TO LN-RECODE.
           MOVE QLN-ESCROW-FG TO LN-ESCROW-FG.
           MOVE QLN-PROMDAYS-PASTDUE TO LN-PROMDAYS-PASTDUE.
           MOVE QLN-PROMID TO LN-PROMID.

           MOVE QLN-PROMDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PROMDATE.

           MOVE QLN-PROMAMT TO LN-PROMAMT.

           MOVE QLN-PROMDATE2 TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PROMDATE2.


           MOVE QLN-DATE-PAID-LAST TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-DATE-PAID-LAST.

           MOVE QLN-AMT-PAID-LAST TO LN-AMT-PAID-LAST.
           MOVE QLN-LASTCFORMNO TO LN-LASTCFORMNO.

           MOVE QLN-LASTCFORMDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LASTCFORMDATE.

           MOVE QLN-DELCNT TO LN-DELCNT.
           MOVE QLN-DELCNT2 TO LN-DELCNT2.
           MOVE QLN-CREDITLIM TO LN-CREDITLIM.
           MOVE QLN-CRSCORE TO LN-CRSCORE.
           MOVE QLN-LASTSFORMNO TO LN-LASTSFORMNO.

           MOVE QLN-LASTSFORMDATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LASTSFORMDATE.

           MOVE QLN-SOLCNT TO LN-SOLCNT.
           MOVE QLN-MESSAGE TO LN-MESSAGE.
           MOVE QLN-OLDACCTNO TO LN-OLDACCTNO.
           MOVE QLN-PRLNNO TO LN-PRLNNO.
           MOVE QLN-PRBAL TO LN-PRBAL.
           MOVE QLN-PRINTDUE TO LN-PRINTDUE.
           MOVE QLN-PRFINCHGRB TO LN-PRFINCHGRB.
           MOVE QLN-PRINSRB TO LN-PRINSRB.
           MOVE QLN-PRPOCD TO LN-PRPOCD.

           MOVE QLN-PRPODATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-PRPODATE.

           MOVE QLN-PRDELINQAMT TO LN-PRDELINQAMT.
           MOVE QLN-PRLNAMT TO LN-PRLNAMT.
           MOVE QLN-PRPDUE-DAYS TO LN-PRPDUE-DAYS.
           MOVE QLN-PRDLDISC-UNEARN TO LN-PRDLDISC-UNEARN.
           MOVE QLN-PRCONPROFILE TO LN-PRCONPROFILE.
           MOVE QLN-SUM-ORIGPURAMT TO LN-SUM-ORIGPURAMT.
           MOVE QLN-SUM-LNAMT TO LN-SUM-LNAMT.
           MOVE QLN-SUM-FINCHG TO LN-SUM-FINCHG.
           MOVE QLN-SUM-INTCHG TO LN-SUM-INTCHG.
           MOVE QLN-SUM-ORGTERM TO LN-SUM-ORGTERM.
           MOVE QLN-SUM-REGPYAMT TO LN-SUM-REGPYAMT.
           MOVE QLN-SUM-EXTCHG TO LN-SUM-EXTCHG.
           MOVE QLN-SUM-SERCHG TO LN-SUM-SERCHG.
           MOVE QLN-SUM-MAINTFEE TO LN-SUM-MAINTFEE.
           MOVE QLN-UNITPER-CD TO LN-UNITPER-CD.
           MOVE QLN-UNITPER-FREQ TO LN-UNITPER-FREQ.
           MOVE QLN-DAYS-IN-UNITPER TO LN-DAYS-IN-UNITPER.
           MOVE QLN-UNITPER-PER-YEAR TO LN-UNITPER-PER-YEAR.
           MOVE QLN-REPOCD TO LN-REPOCD.
           MOVE QLN-BR-TFR-FG TO LN-BR-TFR-FG.
           MOVE QLN-O3INS-DLPROC TO LN-O3INS-DLPROC.
           MOVE QLN-INSPREM-DLADJ TO LN-INSPREM-DLADJ.
           MOVE QLN-PLAMT TO LN-PLAMT.
           MOVE QLN-MTD-PRIN TO LN-MTD-PRIN.
           MOVE QLN-MTD-LC TO LN-MTD-LC.
           MOVE QLN-MTD-INT TO LN-MTD-INT.
           MOVE QLN-MTD-OT TO LN-MTD-OT.
           MOVE QLN-MTD-EX TO LN-MTD-EX.
           MOVE QLN-BNKRPT-CHAPTER TO LN-BNKRPT-CHAPTER.
           MOVE QLN-BMO-CON-STATUS TO LN-BMO-CON-STATUS.
           MOVE QLN-BMO-REC-STATUS TO LN-BMO-REC-STATUS.
           MOVE QLN-APP-NUMBER TO LN-APP-NUMBER.
           MOVE QLN-GIFTNET TO LN-GIFTNET.
           MOVE QLN-GIFTNET-OUR-PO TO LN-GIFTNET-OUR-PO.
           MOVE QLN-PROC-DISBURSED TO LN-PROC-DISBURSED.
           MOVE QLN-NOODDPY TO LN-NOODDPY.
           MOVE QLN-CONPROFILE-1 TO LN-CONPROFILE(1).
           MOVE QLN-CONPROFILE-2 TO LN-CONPROFILE(2).
           MOVE QLN-CONPROFILE-3 TO LN-CONPROFILE(3).
           MOVE QLN-CONPROFILE-4 TO LN-CONPROFILE(4).
           MOVE QLN-CONPROFILE-5 TO LN-CONPROFILE(5).
           MOVE QLN-RECPROFILE-1 TO LN-RECPROFILE(1).
           MOVE QLN-RECPROFILE-2 TO LN-RECPROFILE(2).
           MOVE QLN-RECPROFILE-3 TO LN-RECPROFILE(3).
           MOVE QLN-RECPROFILE-4 TO LN-RECPROFILE(4).
           MOVE QLN-RECPROFILE-5 TO LN-RECPROFILE(5).
           MOVE QLN-TRW-STATUS TO LN-TRW-STATUS.
           MOVE QLN-ORIGIN TO LN-ORIGIN.
           MOVE QLN-PO-TRCD TO LN-PO-TRCD.
           MOVE QLN-NEXIS-CRSCORE TO LN-NEXIS-CRSCORE.
           MOVE QLN-TRW-B-CONSUMER-IND TO LN-TRW-B-CONSUMER-IND.
           MOVE QLN-PARVHELD-PAID-FG TO LN-PARVHELD-PAID-FG.
           MOVE QLN-ACCT-FROZEN TO LN-ACCT-FROZEN.
           MOVE QLN-TRW-SPECIAL-CODE TO LN-TRW-SPECIAL-CODE.
           MOVE QLN-CREATION-STATUS TO LN-CREATION-STATUS.
           MOVE QLN-TOTNOLCHG TO LN-TOTNOLCHG.
           MOVE QLN-LBOX TO LN-LBOX.
           MOVE QLN-EXTRA-PRIN-LFP TO LN-EXTRA-PRIN-LFP.
           MOVE QLN-REMAIN-INT-SINCE-LFP TO LN-REMAIN-INT-SINCE-LFP.
           MOVE QLN-REMAIN-PRIN-SINCE-LFP TO LN-REMAIN-PRIN-SINCE-LFP.
           MOVE QLN-INTERIM-COUPON TO LN-INTERIM-COUPON.
           MOVE QLN-DLCOMM-O3-CMSI TO LN-DLCOMM-O3-CMSI.
           MOVE QLN-DLCOMM-PP-CMSI TO LN-DLCOMM-PP-CMSI.
           MOVE QLN-TRW-J-CONSUMER-IND TO LN-TRW-J-CONSUMER-IND.
           MOVE QLN-ACH TO LN-ACH.
           MOVE QLN-1099-C-FG TO LN-1099-C-FG.
           MOVE QLN-TRW-COMPLIANCE-CODE TO LN-TRW-COMPLIANCE-CODE.
           MOVE QLN-UNWIND-REASON-CODE TO LN-UNWIND-REASON-CODE.
           MOVE QLN-PBI-PBD-FG TO LN-PBI-PBD-FG.
           MOVE QLN-OLD-ACCT-FORMAT-FG TO LN-OLD-ACCT-FORMAT-FG.
           MOVE QLN-APPROVED-BY-USER TO LN-APPROVED-BY-USER.
           MOVE QLN-APPROVED-BY-CODE TO LN-APPROVED-BY-CODE.

           MOVE QLN-APPROVED-BY-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-APPROVED-BY-DATE.

           MOVE QLN-APPROVED-BY-TIME TO LN-APPROVED-BY-TIME.

           MOVE QLN-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD TO LN-LTOUCH-DATE.

           MOVE QLN-LTOUCH-TIME TO LN-LTOUCH-TIME.
           MOVE QLN-LOS-APP-ID  TO LN-LOS-APP-ID.

      *-----------------------------------------------------------------
      *    LOAD QLN-REC FROM LN-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LN-FIELDS.
           MOVE LN-OWNBR TO QLN-OWNBR.
           MOVE LN-ACCTNO TO QLN-ACCTNO.
           MOVE LN-CLASS TO QLN-CLASS.
           MOVE LN-SUBCLASS TO QLN-SUBCLASS.
           MOVE LN-LAWCODE TO QLN-LAWCODE.
           MOVE LN-SSNO1 TO QLN-SSNO1.
           MOVE LN-MAKERCD1 TO QLN-MAKERCD1.
           MOVE LN-SSNO2 TO QLN-SSNO2.
           MOVE LN-MAKERCD2 TO QLN-MAKERCD2.
           MOVE LN-SSNO3 TO QLN-SSNO3.
           MOVE LN-MAKERCD3 TO QLN-MAKERCD3.
           MOVE LN-SSNO4 TO QLN-SSNO4.
           MOVE LN-MAKERCD4 TO QLN-MAKERCD4.
           MOVE LN-ORGST TO QLN-ORGST.
           MOVE LN-ORGBR TO QLN-ORGBR.
           MOVE LN-OWNST TO QLN-OWNST.
           MOVE LN-SPRCLASS TO QLN-SPRCLASS.
           MOVE LN-CONVERCD TO QLN-CONVERCD.
           MOVE LN-MIDSTREAM TO QLN-MIDSTREAM.
           MOVE LN-PURCD TO QLN-PURCD.
           MOVE LN-SRCD TO QLN-SRCD.
           MOVE LN-COLLCD TO QLN-COLLCD.
           MOVE LN-COLLID TO QLN-COLLID.
           MOVE LN-POCD TO QLN-POCD.
           MOVE LN-PLCD TO QLN-PLCD.
           MOVE LN-PLTYPE TO QLN-PLTYPE.
           MOVE LN-CONFIDENTCD TO QLN-CONFIDENTCD.
           MOVE LN-ALLOTCD TO QLN-ALLOTCD.
           MOVE LN-RECASTCD TO QLN-RECASTCD.
           MOVE LN-SKIP-TRW TO QLN-SKIP-TRW.
           MOVE LN-STATUSFG TO QLN-STATUSFG.
           MOVE LN-SMALLOAN TO QLN-SMALLOAN.
           MOVE LN-SALEFIN TO QLN-SALEFIN.
           MOVE LN-SERVACCT TO QLN-SERVACCT.
           MOVE LN-LOANTYPE TO QLN-LOANTYPE.
           MOVE LN-ADDON-FG TO QLN-ADDON-FG.
           MOVE LN-PAY-SCHLD-FG TO QLN-PAY-SCHLD-FG.
           MOVE LN-LC-CODE TO QLN-LC-CODE.
           MOVE LN-CAN-LOAN-NO TO QLN-CAN-LOAN-NO.
           MOVE LN-STATFLAGS TO QLN-STATFLAGS.

           MOVE LN-ENTDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-ENTDATE.


           MOVE LN-LOANDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LOANDATE.


           MOVE LN-PURDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PURDATE.


           MOVE LN-INTDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INTDATE.


           MOVE LN-CASHDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-CASHDATE.


           MOVE LN-FILEDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-FILEDATE.


           MOVE LN-RESCISSION-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-RESCISSION-DATE.


           MOVE LN-PART-RECOURSE-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PART-RECOURSE-DATE.


           MOVE LN-ORIG-1STPYDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-ORIG-1STPYDATE.


           MOVE LN-1STPYDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-1STPYDATE.


           MOVE LN-JDDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-JDDATE.


           MOVE LN-PLDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PLDATE.


           MOVE LN-PL-TRDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PL-TRDATE.


           MOVE LN-ACCELDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-ACCELDATE.


           MOVE LN-REDUDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-REDUDATE.


           MOVE LN-POFFDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-POFFDATE.


           MOVE LN-PO-TRDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PO-TRDATE.


           MOVE LN-LEGALDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LEGALDATE.


           MOVE LN-BNKRPTDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-BNKRPTDATE.


           MOVE LN-BNKRPT-DISMISS-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-BNKRPT-DISMISS-DATE.


           MOVE LN-BNKRPT-DISCHARGE-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-BNKRPT-DISCHARGE-DATE.


           MOVE LN-BNKRPT-REAFFIRM-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-BNKRPT-REAFFIRM-DATE.


           MOVE LN-DEBTAIDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-DEBTAIDATE.


           MOVE LN-REPODATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-REPODATE.


           MOVE LN-REDEEMDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-REDEEMDATE.


           MOVE LN-SOLDDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-SOLDDATE.


           MOVE LN-INS-CONFIRM-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INS-CONFIRM-DATE.


           MOVE LN-PRIOR-RN-FOR10-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PRIOR-RN-FOR10-DATE.


           MOVE LN-LAST-RN-FOR10-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LAST-RN-FOR10-DATE.


           MOVE LN-TRW-DOFD-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-TRW-DOFD-DATE.


           MOVE LN-LAST-PYPA-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LAST-PYPA-DATE.


           MOVE LN-BT-TRDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-BT-TRDATE.


           MOVE LN-METRO2-LAST-PMT-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-METRO2-LAST-PMT-DATE.


           MOVE LN-FOLLOWUP-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-FOLLOWUP-DATE.


           MOVE LN-LAST-ACCRUAL-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LAST-ACCRUAL-DATE.

           MOVE LN-APRATE TO QLN-APRATE.
           MOVE LN-EFFRATE TO QLN-EFFRATE.
           MOVE LN-SMPRATE TO QLN-SMPRATE.
           MOVE LN-YLDRATE TO QLN-YLDRATE.
           MOVE LN-OVRDRATE TO QLN-OVRDRATE.
           MOVE LN-ENDORATE TO QLN-ENDORATE.
           MOVE LN-JDRATE TO QLN-JDRATE.
           MOVE LN-ACCRATE TO QLN-ACCRATE.
           MOVE LN-REDURATE TO QLN-REDURATE.
           MOVE LN-CONRATE TO QLN-CONRATE.
           MOVE LN-SERVPER TO QLN-SERVPER.
           MOVE LN-SELLPR TO QLN-SELLPR.
           MOVE LN-DOWNPY TO QLN-DOWNPY.
           MOVE LN-TRADEIN TO QLN-TRADEIN.
           MOVE LN-LNAMT TO QLN-LNAMT.
           MOVE LN-FINCHG TO QLN-FINCHG.
           MOVE LN-INTCHG TO QLN-INTCHG.
           MOVE LN-SERCHG TO QLN-SERCHG.
           MOVE LN-EXTCHG TO QLN-EXTCHG.
           MOVE LN-MAINTFEE TO QLN-MAINTFEE.
           MOVE LN-POINTS TO QLN-POINTS.
           MOVE LN-PROCEEDS TO QLN-PROCEEDS.
           MOVE LN-ORGTERM TO QLN-ORGTERM.
           MOVE LN-1STPYAMT TO QLN-1STPYAMT.
           MOVE LN-NOREGPY TO QLN-NOREGPY.
           MOVE LN-REGPYAMT TO QLN-REGPYAMT.
           MOVE LN-LASTPYAMT TO QLN-LASTPYAMT.
           MOVE LN-PROCASH TO QLN-PROCASH.
           MOVE LN-TILLNO TO QLN-TILLNO.
           MOVE LN-STATE-FLAG TO QLN-STATE-FLAG.
           MOVE LN-STATE-WORKER TO QLN-STATE-WORKER.
           MOVE LN-STATE-WORKER2 TO QLN-STATE-WORKER2.
           MOVE LN-FEECODE(1) TO QLN-FEECODE-1.
           MOVE LN-FEEAMT(1) TO QLN-FEEAMT-1.
           MOVE LN-FEEOURS(1) TO QLN-FEEOURS-1.
           MOVE LN-FEEFINCHG(1) TO QLN-FEEFINCHG-1.
           MOVE LN-FEECODE(2) TO QLN-FEECODE-2.
           MOVE LN-FEEAMT(2) TO QLN-FEEAMT-2.
           MOVE LN-FEEOURS(2) TO QLN-FEEOURS-2.
           MOVE LN-FEEFINCHG(2) TO QLN-FEEFINCHG-2.
           MOVE LN-FEECODE(3) TO QLN-FEECODE-3.
           MOVE LN-FEEAMT(3) TO QLN-FEEAMT-3.
           MOVE LN-FEEOURS(3) TO QLN-FEEOURS-3.
           MOVE LN-FEEFINCHG(3) TO QLN-FEEFINCHG-3.
           MOVE LN-FEECODE(4) TO QLN-FEECODE-4.
           MOVE LN-FEEAMT(4) TO QLN-FEEAMT-4.
           MOVE LN-FEEOURS(4) TO QLN-FEEOURS-4.
           MOVE LN-FEEFINCHG(4) TO QLN-FEEFINCHG-4.
           MOVE LN-FEECODE(5) TO QLN-FEECODE-5.
           MOVE LN-FEEAMT(5) TO QLN-FEEAMT-5.
           MOVE LN-FEEOURS(5) TO QLN-FEEOURS-5.
           MOVE LN-FEEFINCHG(5) TO QLN-FEEFINCHG-5.
           MOVE LN-FEECODE(6) TO QLN-FEECODE-6.
           MOVE LN-FEEAMT(6) TO QLN-FEEAMT-6.
           MOVE LN-FEEOURS(6) TO QLN-FEEOURS-6.
           MOVE LN-FEEFINCHG(6) TO QLN-FEEFINCHG-6.
           MOVE LN-FEECODE(7) TO QLN-FEECODE-7.
           MOVE LN-FEEAMT(7) TO QLN-FEEAMT-7.
           MOVE LN-FEEOURS(7) TO QLN-FEEOURS-7.
           MOVE LN-FEEFINCHG(7) TO QLN-FEEFINCHG-7.
           MOVE LN-FEECODE(8) TO QLN-FEECODE-8.
           MOVE LN-FEEAMT(8) TO QLN-FEEAMT-8.
           MOVE LN-FEEOURS(8) TO QLN-FEEOURS-8.
           MOVE LN-FEEFINCHG(8) TO QLN-FEEFINCHG-8.
           MOVE LN-FEECODE(9) TO QLN-FEECODE-9.
           MOVE LN-FEEAMT(9) TO QLN-FEEAMT-9.
           MOVE LN-FEEOURS(9) TO QLN-FEEOURS-9.
           MOVE LN-FEEFINCHG(9) TO QLN-FEEFINCHG-9.
           MOVE LN-FEECODE(10) TO QLN-FEECODE-10.
           MOVE LN-FEEAMT(10) TO QLN-FEEAMT-10.
           MOVE LN-FEEOURS(10) TO QLN-FEEOURS-10.
           MOVE LN-FEEFINCHG(10) TO QLN-FEEFINCHG-10.
           MOVE LN-FEECODE(11) TO QLN-FEECODE-11.
           MOVE LN-FEEAMT(11) TO QLN-FEEAMT-11.
           MOVE LN-FEEOURS(11) TO QLN-FEEOURS-11.
           MOVE LN-FEEFINCHG(11) TO QLN-FEEFINCHG-11.
           MOVE LN-FEECODE(12) TO QLN-FEECODE-12.
           MOVE LN-FEEAMT(12) TO QLN-FEEAMT-12.
           MOVE LN-FEEOURS(12) TO QLN-FEEOURS-12.
           MOVE LN-FEEFINCHG(12) TO QLN-FEEFINCHG-12.
           MOVE LN-FEECODE(13) TO QLN-FEECODE-13.
           MOVE LN-FEEAMT(13) TO QLN-FEEAMT-13.
           MOVE LN-FEEOURS(13) TO QLN-FEEOURS-13.
           MOVE LN-FEEFINCHG(13) TO QLN-FEEFINCHG-13.
           MOVE LN-FEECODE(14) TO QLN-FEECODE-14.
           MOVE LN-FEEAMT(14) TO QLN-FEEAMT-14.
           MOVE LN-FEEOURS(14) TO QLN-FEEOURS-14.
           MOVE LN-FEEFINCHG(14) TO QLN-FEEFINCHG-14.
           MOVE LN-FEECODE(15) TO QLN-FEECODE-15.
           MOVE LN-FEEAMT(15) TO QLN-FEEAMT-15.
           MOVE LN-FEEOURS(15) TO QLN-FEEOURS-15.
           MOVE LN-FEEFINCHG(15) TO QLN-FEEFINCHG-15.
           MOVE LN-FEECODE(16) TO QLN-FEECODE-16.
           MOVE LN-FEEAMT(16) TO QLN-FEEAMT-16.
           MOVE LN-FEEOURS(16) TO QLN-FEEOURS-16.
           MOVE LN-FEEFINCHG(16) TO QLN-FEEFINCHG-16.
           MOVE LN-FEECODE(17) TO QLN-FEECODE-17.
           MOVE LN-FEEAMT(17) TO QLN-FEEAMT-17.
           MOVE LN-FEEOURS(17) TO QLN-FEEOURS-17.
           MOVE LN-FEEFINCHG(17) TO QLN-FEEFINCHG-17.
           MOVE LN-FEECODE(18) TO QLN-FEECODE-18.
           MOVE LN-FEEAMT(18) TO QLN-FEEAMT-18.
           MOVE LN-FEEOURS(18) TO QLN-FEEOURS-18.
           MOVE LN-FEEFINCHG(18) TO QLN-FEEFINCHG-18.
           MOVE LN-FEECODE(19) TO QLN-FEECODE-19.
           MOVE LN-FEEAMT(19) TO QLN-FEEAMT-19.
           MOVE LN-FEEOURS(19) TO QLN-FEEOURS-19.
           MOVE LN-FEEFINCHG(19) TO QLN-FEEFINCHG-19.
           MOVE LN-FEECODE(20) TO QLN-FEECODE-20.
           MOVE LN-FEEAMT(20) TO QLN-FEEAMT-20.
           MOVE LN-FEEOURS(20) TO QLN-FEEOURS-20.
           MOVE LN-FEEFINCHG(20) TO QLN-FEEFINCHG-20.
           MOVE LN-INSURED TO QLN-INSURED.
           MOVE LN-INSTYPES TO QLN-INSTYPES.
           MOVE LN-INSELIGIBLE TO QLN-INSELIGIBLE.
           MOVE LN-INSCOMP(1) TO QLN-INSCOMP-1.
           MOVE LN-INSOURS(1) TO QLN-INSOURS-1.

           MOVE LN-INSEFF-DATE(1) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-1.


           MOVE LN-INSEXP-DATE(1) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-1.

           MOVE LN-INSPREM(1) TO QLN-INSPREM-1.
           MOVE LN-INSCOVR(1) TO QLN-INSCOVR-1.
           MOVE LN-INSCOMM(1) TO QLN-INSCOMM-1.
           MOVE LN-INSANTICERN(1) TO QLN-INSANTICERN-1.
           MOVE LN-INSANTICADJ(1) TO QLN-INSANTICADJ-1.
           MOVE LN-INSUFERN(1) TO QLN-INSUFERN-1.
           MOVE LN-INSACCERN(1) TO QLN-INSACCERN-1.
           MOVE LN-INSEARN-ORDER(1) TO QLN-INSEARN-ORDER-1.
           MOVE LN-INSFINCHG(1) TO QLN-INSFINCHG-1.
           MOVE LN-INSCOMP(2) TO QLN-INSCOMP-2.
           MOVE LN-INSOURS(2) TO QLN-INSOURS-2.

           MOVE LN-INSEFF-DATE(2) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-2.


           MOVE LN-INSEXP-DATE(2) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-2.

           MOVE LN-INSPREM(2) TO QLN-INSPREM-2.
           MOVE LN-INSCOVR(2) TO QLN-INSCOVR-2.
           MOVE LN-INSCOMM(2) TO QLN-INSCOMM-2.
           MOVE LN-INSANTICERN(2) TO QLN-INSANTICERN-2.
           MOVE LN-INSANTICADJ(2) TO QLN-INSANTICADJ-2.
           MOVE LN-INSUFERN(2) TO QLN-INSUFERN-2.
           MOVE LN-INSACCERN(2) TO QLN-INSACCERN-2.
           MOVE LN-INSEARN-ORDER(2) TO QLN-INSEARN-ORDER-2.
           MOVE LN-INSFINCHG(2) TO QLN-INSFINCHG-2.
           MOVE LN-INSCOMP(3) TO QLN-INSCOMP-3.
           MOVE LN-INSOURS(3) TO QLN-INSOURS-3.

           MOVE LN-INSEFF-DATE(3) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-3.


           MOVE LN-INSEXP-DATE(3) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-3.

           MOVE LN-INSPREM(3) TO QLN-INSPREM-3.
           MOVE LN-INSCOVR(3) TO QLN-INSCOVR-3.
           MOVE LN-INSCOMM(3) TO QLN-INSCOMM-3.
           MOVE LN-INSANTICERN(3) TO QLN-INSANTICERN-3.
           MOVE LN-INSANTICADJ(3) TO QLN-INSANTICADJ-3.
           MOVE LN-INSUFERN(3) TO QLN-INSUFERN-3.
           MOVE LN-INSACCERN(3) TO QLN-INSACCERN-3.
           MOVE LN-INSEARN-ORDER(3) TO QLN-INSEARN-ORDER-3.
           MOVE LN-INSFINCHG(3) TO QLN-INSFINCHG-3.
           MOVE LN-INSCOMP(4) TO QLN-INSCOMP-4.
           MOVE LN-INSOURS(4) TO QLN-INSOURS-4.

           MOVE LN-INSEFF-DATE(4) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-4.


           MOVE LN-INSEXP-DATE(4) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-4.

           MOVE LN-INSPREM(4) TO QLN-INSPREM-4.
           MOVE LN-INSCOVR(4) TO QLN-INSCOVR-4.
           MOVE LN-INSCOMM(4) TO QLN-INSCOMM-4.
           MOVE LN-INSANTICERN(4) TO QLN-INSANTICERN-4.
           MOVE LN-INSANTICADJ(4) TO QLN-INSANTICADJ-4.
           MOVE LN-INSUFERN(4) TO QLN-INSUFERN-4.
           MOVE LN-INSACCERN(4) TO QLN-INSACCERN-4.
           MOVE LN-INSEARN-ORDER(4) TO QLN-INSEARN-ORDER-4.
           MOVE LN-INSFINCHG(4) TO QLN-INSFINCHG-4.
           MOVE LN-INSCOMP(5) TO QLN-INSCOMP-5.
           MOVE LN-INSOURS(5) TO QLN-INSOURS-5.

           MOVE LN-INSEFF-DATE(5) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-5.


           MOVE LN-INSEXP-DATE(5) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-5.

           MOVE LN-INSPREM(5) TO QLN-INSPREM-5.
           MOVE LN-INSCOVR(5) TO QLN-INSCOVR-5.
           MOVE LN-INSCOMM(5) TO QLN-INSCOMM-5.
           MOVE LN-INSANTICERN(5) TO QLN-INSANTICERN-5.
           MOVE LN-INSANTICADJ(5) TO QLN-INSANTICADJ-5.
           MOVE LN-INSUFERN(5) TO QLN-INSUFERN-5.
           MOVE LN-INSACCERN(5) TO QLN-INSACCERN-5.
           MOVE LN-INSEARN-ORDER(5) TO QLN-INSEARN-ORDER-5.
           MOVE LN-INSFINCHG(5) TO QLN-INSFINCHG-5.
           MOVE LN-INSCOMP(6) TO QLN-INSCOMP-6.
           MOVE LN-INSOURS(6) TO QLN-INSOURS-6.

           MOVE LN-INSEFF-DATE(6) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-6.


           MOVE LN-INSEXP-DATE(6) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-6.

           MOVE LN-INSPREM(6) TO QLN-INSPREM-6.
           MOVE LN-INSCOVR(6) TO QLN-INSCOVR-6.
           MOVE LN-INSCOMM(6) TO QLN-INSCOMM-6.
           MOVE LN-INSANTICERN(6) TO QLN-INSANTICERN-6.
           MOVE LN-INSANTICADJ(6) TO QLN-INSANTICADJ-6.
           MOVE LN-INSUFERN(6) TO QLN-INSUFERN-6.
           MOVE LN-INSACCERN(6) TO QLN-INSACCERN-6.
           MOVE LN-INSEARN-ORDER(6) TO QLN-INSEARN-ORDER-6.
           MOVE LN-INSFINCHG(6) TO QLN-INSFINCHG-6.
           MOVE LN-INSCOMP(7) TO QLN-INSCOMP-7.
           MOVE LN-INSOURS(7) TO QLN-INSOURS-7.

           MOVE LN-INSEFF-DATE(7) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-7.


           MOVE LN-INSEXP-DATE(7) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-7.

           MOVE LN-INSPREM(7) TO QLN-INSPREM-7.
           MOVE LN-INSCOVR(7) TO QLN-INSCOVR-7.
           MOVE LN-INSCOMM(7) TO QLN-INSCOMM-7.
           MOVE LN-INSANTICERN(7) TO QLN-INSANTICERN-7.
           MOVE LN-INSANTICADJ(7) TO QLN-INSANTICADJ-7.
           MOVE LN-INSUFERN(7) TO QLN-INSUFERN-7.
           MOVE LN-INSACCERN(7) TO QLN-INSACCERN-7.
           MOVE LN-INSEARN-ORDER(7) TO QLN-INSEARN-ORDER-7.
           MOVE LN-INSFINCHG(7) TO QLN-INSFINCHG-7.
           MOVE LN-INSCOMP(8) TO QLN-INSCOMP-8.
           MOVE LN-INSOURS(8) TO QLN-INSOURS-8.

           MOVE LN-INSEFF-DATE(8) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-8.


           MOVE LN-INSEXP-DATE(8) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-8.

           MOVE LN-INSPREM(8) TO QLN-INSPREM-8.
           MOVE LN-INSCOVR(8) TO QLN-INSCOVR-8.
           MOVE LN-INSCOMM(8) TO QLN-INSCOMM-8.
           MOVE LN-INSANTICERN(8) TO QLN-INSANTICERN-8.
           MOVE LN-INSANTICADJ(8) TO QLN-INSANTICADJ-8.
           MOVE LN-INSUFERN(8) TO QLN-INSUFERN-8.
           MOVE LN-INSACCERN(8) TO QLN-INSACCERN-8.
           MOVE LN-INSEARN-ORDER(8) TO QLN-INSEARN-ORDER-8.
           MOVE LN-INSFINCHG(8) TO QLN-INSFINCHG-8.
           MOVE LN-INSCOMP(9) TO QLN-INSCOMP-9.
           MOVE LN-INSOURS(9) TO QLN-INSOURS-9.

           MOVE LN-INSEFF-DATE(9) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-9.


           MOVE LN-INSEXP-DATE(9) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-9.

           MOVE LN-INSPREM(9) TO QLN-INSPREM-9.
           MOVE LN-INSCOVR(9) TO QLN-INSCOVR-9.
           MOVE LN-INSCOMM(9) TO QLN-INSCOMM-9.
           MOVE LN-INSANTICERN(9) TO QLN-INSANTICERN-9.
           MOVE LN-INSANTICADJ(9) TO QLN-INSANTICADJ-9.
           MOVE LN-INSUFERN(9) TO QLN-INSUFERN-9.
           MOVE LN-INSACCERN(9) TO QLN-INSACCERN-9.
           MOVE LN-INSEARN-ORDER(9) TO QLN-INSEARN-ORDER-9.
           MOVE LN-INSFINCHG(9) TO QLN-INSFINCHG-9.
           MOVE LN-INSCOMP(10) TO QLN-INSCOMP-10.
           MOVE LN-INSOURS(10) TO QLN-INSOURS-10.

           MOVE LN-INSEFF-DATE(10) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEFF-DATE-10.


           MOVE LN-INSEXP-DATE(10) TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INSEXP-DATE-10.

           MOVE LN-INSPREM(10) TO QLN-INSPREM-10.
           MOVE LN-INSCOVR(10) TO QLN-INSCOVR-10.
           MOVE LN-INSCOMM(10) TO QLN-INSCOMM-10.
           MOVE LN-INSANTICERN(10) TO QLN-INSANTICERN-10.
           MOVE LN-INSANTICADJ(10) TO QLN-INSANTICADJ-10.
           MOVE LN-INSUFERN(10) TO QLN-INSUFERN-10.
           MOVE LN-INSACCERN(10) TO QLN-INSACCERN-10.
           MOVE LN-INSEARN-ORDER(10) TO QLN-INSEARN-ORDER-10.
           MOVE LN-INSFINCHG(10) TO QLN-INSFINCHG-10.
           MOVE LN-PY-YYYYMM-RECDEL TO QLN-PY-YYYYMM-RECDEL.
           MOVE LN-MTD-PAYS-RECDEL TO QLN-MTD-PAYS-RECDEL.
           MOVE LN-GARNISH-EXTR TO QLN-GARNISH-EXTR.
           MOVE LN-SHIP-SAME-FG TO QLN-SHIP-SAME-FG.
           MOVE LN-AD-D-INS-COVR TO QLN-AD-D-INS-COVR.
           MOVE LN-TOT-PARTIAL-CHGOFF TO QLN-TOT-PARTIAL-CHGOFF.
           MOVE LN-LPO TO QLN-LPO.
           MOVE LN-REP-CD TO QLN-REP-CD.
           MOVE LN-EMP-ID TO QLN-EMP-ID.
           MOVE LN-PROCESS-CD TO QLN-PROCESS-CD.
           MOVE LN-WCBC-CREDITLIM TO QLN-WCBC-CREDITLIM.
           MOVE LN-FOLLOWUP-CD TO QLN-FOLLOWUP-CD.
           MOVE LN-MIP-FG TO QLN-MIP-FG.
           MOVE LN-MIP-MTD-CLAHPAID TO QLN-MIP-MTD-CLAHPAID.

           MOVE LN-MIP-CLPDTH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-MIP-CLPDTH-DATE.

           MOVE LN-MIP-TOT-CLPAID TO QLN-MIP-TOT-CLPAID.

           MOVE LN-MIP-AHPDTH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-MIP-AHPDTH-DATE.

           MOVE LN-MIP-TOT-AHPAID TO QLN-MIP-TOT-AHPAID.
           MOVE LN-IL-GROSS-INCOME TO QLN-IL-GROSS-INCOME.
           MOVE LN-IL-GROSS-INCOME2 TO QLN-IL-GROSS-INCOME2.
           MOVE LN-RESCISSION TO QLN-RESCISSION.
           MOVE LN-INTERIM-TRW TO QLN-INTERIM-TRW.
           MOVE LN-DLNO TO QLN-DLNO.
           MOVE LN-DLPOOL TO QLN-DLPOOL.
           MOVE LN-DLRECOURSE TO QLN-DLRECOURSE.
           MOVE LN-DLPARTRCAMT TO QLN-DLPARTRCAMT.
           MOVE LN-ORIGPURAMT TO QLN-ORIGPURAMT.
           MOVE LN-PURBAL TO QLN-PURBAL.
           MOVE LN-DLRVPRIN(1) TO QLN-DLRVPRIN-1.
           MOVE LN-DLRVPRIN(2) TO QLN-DLRVPRIN-2.
           MOVE LN-DLRVPRIN(3) TO QLN-DLRVPRIN-3.
           MOVE LN-DLRVCHGS(1) TO QLN-DLRVCHGS-1.
           MOVE LN-DLRVCHGS(2) TO QLN-DLRVCHGS-2.
           MOVE LN-DLRVCHGS(3) TO QLN-DLRVCHGS-3.
           MOVE LN-DLPARVHELD TO QLN-DLPARVHELD.
           MOVE LN-DLPARVPAID TO QLN-DLPARVPAID.
           MOVE LN-DLDISC TO QLN-DLDISC.

           MOVE LN-LCPDTH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LCPDTH-DATE.


           MOVE LN-INTPDTH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-INTPDTH-DATE.

           MOVE LN-CURBAL TO QLN-CURBAL.
           MOVE LN-INTBAL TO QLN-INTBAL.
           MOVE LN-LCBAL TO QLN-LCBAL.
           MOVE LN-OTHBAL TO QLN-OTHBAL.
           MOVE LN-OT2BAL TO QLN-OT2BAL.
           MOVE LN-LCPAID TO QLN-LCPAID.
           MOVE LN-LCPARTIALS TO QLN-LCPARTIALS.
           MOVE LN-STMT-COUNTER TO QLN-STMT-COUNTER.
           MOVE LN-PRIOR-STMT-COUNTER TO QLN-PRIOR-STMT-COUNTER.
           MOVE LN-FROZEN-REASON TO QLN-FROZEN-REASON.
           MOVE LN-COUPON-STATEMENT TO QLN-COUPON-STATEMENT.
           MOVE LN-MONTHEND-BAL TO QLN-MONTHEND-BAL.
           MOVE LN-ANTICTERM TO QLN-ANTICTERM.
           MOVE LN-ANTICERN(1) TO QLN-ANTICERN-1.
           MOVE LN-ANTICADJ(1) TO QLN-ANTICADJ-1.
           MOVE LN-UFERN(1) TO QLN-UFERN-1.
           MOVE LN-ACCERN(1) TO QLN-ACCERN-1.
           MOVE LN-EARN-ORDER(1) TO QLN-EARN-ORDER-1.
           MOVE LN-ANTICERN(2) TO QLN-ANTICERN-2.
           MOVE LN-ANTICADJ(2) TO QLN-ANTICADJ-2.
           MOVE LN-UFERN(2) TO QLN-UFERN-2.
           MOVE LN-ACCERN(2) TO QLN-ACCERN-2.
           MOVE LN-EARN-ORDER(2) TO QLN-EARN-ORDER-2.
           MOVE LN-ANTICERN(3) TO QLN-ANTICERN-3.
           MOVE LN-ANTICADJ(3) TO QLN-ANTICADJ-3.
           MOVE LN-UFERN(3) TO QLN-UFERN-3.
           MOVE LN-ACCERN(3) TO QLN-ACCERN-3.
           MOVE LN-EARN-ORDER(3) TO QLN-EARN-ORDER-3.
           MOVE LN-ANTICERN(4) TO QLN-ANTICERN-4.
           MOVE LN-ANTICADJ(4) TO QLN-ANTICADJ-4.
           MOVE LN-UFERN(4) TO QLN-UFERN-4.
           MOVE LN-ACCERN(4) TO QLN-ACCERN-4.
           MOVE LN-EARN-ORDER(4) TO QLN-EARN-ORDER-4.
           MOVE LN-ANTICERN(5) TO QLN-ANTICERN-5.
           MOVE LN-ANTICADJ(5) TO QLN-ANTICADJ-5.
           MOVE LN-UFERN(5) TO QLN-UFERN-5.
           MOVE LN-ACCERN(5) TO QLN-ACCERN-5.
           MOVE LN-EARN-ORDER(5) TO QLN-EARN-ORDER-5.
           MOVE LN-ANTICERN(6) TO QLN-ANTICERN-6.
           MOVE LN-ANTICADJ(6) TO QLN-ANTICADJ-6.
           MOVE LN-UFERN(6) TO QLN-UFERN-6.
           MOVE LN-ACCERN(6) TO QLN-ACCERN-6.
           MOVE LN-EARN-ORDER(6) TO QLN-EARN-ORDER-6.
           MOVE LN-ANTICERN(7) TO QLN-ANTICERN-7.
           MOVE LN-ANTICADJ(7) TO QLN-ANTICADJ-7.
           MOVE LN-UFERN(7) TO QLN-UFERN-7.
           MOVE LN-ACCERN(7) TO QLN-ACCERN-7.
           MOVE LN-EARN-ORDER(7) TO QLN-EARN-ORDER-7.
           MOVE LN-ANTICERN(8) TO QLN-ANTICERN-8.
           MOVE LN-ANTICADJ(8) TO QLN-ANTICADJ-8.
           MOVE LN-UFERN(8) TO QLN-UFERN-8.
           MOVE LN-ACCERN(8) TO QLN-ACCERN-8.
           MOVE LN-EARN-ORDER(8) TO QLN-EARN-ORDER-8.
           MOVE LN-ANTICERN(9) TO QLN-ANTICERN-9.
           MOVE LN-ANTICADJ(9) TO QLN-ANTICADJ-9.
           MOVE LN-UFERN(9) TO QLN-UFERN-9.
           MOVE LN-ACCERN(9) TO QLN-ACCERN-9.
           MOVE LN-EARN-ORDER(9) TO QLN-EARN-ORDER-9.
           MOVE LN-ANTICERN(10) TO QLN-ANTICERN-10.
           MOVE LN-ANTICADJ(10) TO QLN-ANTICADJ-10.
           MOVE LN-UFERN(10) TO QLN-UFERN-10.
           MOVE LN-ACCERN(10) TO QLN-ACCERN-10.
           MOVE LN-EARN-ORDER(10) TO QLN-EARN-ORDER-10.
           MOVE LN-LMO-PRIOR-INTEREST TO QLN-LMO-PRIOR-INTEREST.
           MOVE LN-PRIOR-UNEARNED TO QLN-PRIOR-UNEARNED.
           MOVE LN-ERNDELQ-STOP TO QLN-ERNDELQ-STOP.
           MOVE LN-NONACRERN TO QLN-NONACRERN.
           MOVE LN-PRIOR-NONACRERN TO QLN-PRIOR-NONACRERN.

           MOVE LN-ERN-IB-PDTH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-ERN-IB-PDTH-DATE.

           MOVE LN-ERN-IB-PRINBAL TO QLN-ERN-IB-PRINBAL.
           MOVE LN-ERN-IB-INTOWE TO QLN-ERN-IB-INTOWE.
           MOVE LN-TOTERN TO QLN-TOTERN.
           MOVE LN-TOTOTH TO QLN-TOTOTH.
           MOVE LN-TOTINT TO QLN-TOTINT.
           MOVE LN-TOTLCHG TO QLN-TOTLCHG.
           MOVE LN-TOTDEF TO QLN-TOTDEF.
           MOVE LN-TOTSERACCT TO QLN-TOTSERACCT.
           MOVE LN-LCWAIVERS TO QLN-LCWAIVERS.
           MOVE LN-INTWAIVERS TO QLN-INTWAIVERS.
           MOVE LN-TOTPAYMNTD TO QLN-TOTPAYMNTD.
           MOVE LN-TOTEXCPAYMNTD TO QLN-TOTEXCPAYMNTD.
           MOVE LN-TOTNODEF TO QLN-TOTNODEF.
           MOVE LN-YTDNODEF TO QLN-YTDNODEF.
           MOVE LN-TOTNODEFACT TO QLN-TOTNODEFACT.
           MOVE LN-YTDNODEFACT TO QLN-YTDNODEFACT.
           MOVE LN-TOTNOALDEL TO QLN-TOTNOALDEL.
           MOVE LN-YTDNOALDEL TO QLN-YTDNOALDEL.
           MOVE LN-YTDINTPD TO QLN-YTDINTPD.
           MOVE LN-LYRINTPD TO QLN-LYRINTPD.
           MOVE LN-TOTINTPD TO QLN-TOTINTPD.
           MOVE LN-RECASTINT TO QLN-RECASTINT.
           MOVE LN-RECASTPRIN TO QLN-RECASTPRIN.
           MOVE LN-CL-REBATE TO QLN-CL-REBATE.
           MOVE LN-AH-REBATE TO QLN-AH-REBATE.
           MOVE LN-PP-REBATE TO QLN-PP-REBATE.
           MOVE LN-INT-REBATE TO QLN-INT-REBATE.
           MOVE LN-SC-REBATE TO QLN-SC-REBATE.
           MOVE LN-MF-REBATE TO QLN-MF-REBATE.
           MOVE LN-DF-REBATE TO QLN-DF-REBATE.
           MOVE LN-EX-REBATE TO QLN-EX-REBATE.
           MOVE LN-O1-REBATE TO QLN-O1-REBATE.
           MOVE LN-O2-REBATE TO QLN-O2-REBATE.
           MOVE LN-O3-REBATE TO QLN-O3-REBATE.
           MOVE LN-O4-REBATE TO QLN-O4-REBATE.
           MOVE LN-O5-REBATE TO QLN-O5-REBATE.
           MOVE LN-O6-REBATE TO QLN-O6-REBATE.
           MOVE LN-O7-REBATE TO QLN-O7-REBATE.
           MOVE LN-UN-O7-REB TO QLN-UN-O7-REB.
           MOVE LN-UN-O8-REB TO QLN-UN-O8-REB.
           MOVE LN-UN-O9-REB TO QLN-UN-O9-REB.
           MOVE LN-UN-O10-REB TO QLN-UN-O10-REB.
           MOVE LN-PLREASON TO QLN-PLREASON.
           MOVE LN-COLLECTOR TO QLN-COLLECTOR.
           MOVE LN-ACTIONCD TO QLN-ACTIONCD.
           MOVE LN-ACTIONCD2 TO QLN-ACTIONCD2.
           MOVE LN-ATCODE TO QLN-ATCODE.
           MOVE LN-RECODE TO QLN-RECODE.
           MOVE LN-ESCROW-FG TO QLN-ESCROW-FG.
           MOVE LN-PROMDAYS-PASTDUE TO QLN-PROMDAYS-PASTDUE.
           MOVE LN-PROMID TO QLN-PROMID.

           MOVE LN-PROMDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PROMDATE.

           MOVE LN-PROMAMT TO QLN-PROMAMT.

           MOVE LN-PROMDATE2 TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PROMDATE2.


           MOVE LN-DATE-PAID-LAST TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-DATE-PAID-LAST.

           MOVE LN-AMT-PAID-LAST TO QLN-AMT-PAID-LAST.
           MOVE LN-LASTCFORMNO TO QLN-LASTCFORMNO.

           MOVE LN-LASTCFORMDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LASTCFORMDATE.

           MOVE LN-DELCNT TO QLN-DELCNT.
           MOVE LN-DELCNT2 TO QLN-DELCNT2.
           MOVE LN-CREDITLIM TO QLN-CREDITLIM.
           MOVE LN-CRSCORE TO QLN-CRSCORE.
           MOVE LN-LASTSFORMNO TO QLN-LASTSFORMNO.

           MOVE LN-LASTSFORMDATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LASTSFORMDATE.

           MOVE LN-SOLCNT TO QLN-SOLCNT.
           MOVE LN-MESSAGE TO QLN-MESSAGE.
           MOVE LN-OLDACCTNO TO QLN-OLDACCTNO.
           MOVE LN-PRLNNO TO QLN-PRLNNO.
           MOVE LN-PRBAL TO QLN-PRBAL.
           MOVE LN-PRINTDUE TO QLN-PRINTDUE.
           MOVE LN-PRFINCHGRB TO QLN-PRFINCHGRB.
           MOVE LN-PRINSRB TO QLN-PRINSRB.
           MOVE LN-PRPOCD TO QLN-PRPOCD.

           MOVE LN-PRPODATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-PRPODATE.

           MOVE LN-PRDELINQAMT TO QLN-PRDELINQAMT.
           MOVE LN-PRLNAMT TO QLN-PRLNAMT.
           MOVE LN-PRPDUE-DAYS TO QLN-PRPDUE-DAYS.
           MOVE LN-PRDLDISC-UNEARN TO QLN-PRDLDISC-UNEARN.
           MOVE LN-PRCONPROFILE TO QLN-PRCONPROFILE.
           MOVE LN-SUM-ORIGPURAMT TO QLN-SUM-ORIGPURAMT.
           MOVE LN-SUM-LNAMT TO QLN-SUM-LNAMT.
           MOVE LN-SUM-FINCHG TO QLN-SUM-FINCHG.
           MOVE LN-SUM-INTCHG TO QLN-SUM-INTCHG.
           MOVE LN-SUM-ORGTERM TO QLN-SUM-ORGTERM.
           MOVE LN-SUM-REGPYAMT TO QLN-SUM-REGPYAMT.
           MOVE LN-SUM-EXTCHG TO QLN-SUM-EXTCHG.
           MOVE LN-SUM-SERCHG TO QLN-SUM-SERCHG.
           MOVE LN-SUM-MAINTFEE TO QLN-SUM-MAINTFEE.
           MOVE LN-UNITPER-CD TO QLN-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO QLN-UNITPER-FREQ.
           MOVE LN-DAYS-IN-UNITPER TO QLN-DAYS-IN-UNITPER.
           MOVE LN-UNITPER-PER-YEAR TO QLN-UNITPER-PER-YEAR.
           MOVE LN-REPOCD TO QLN-REPOCD.
           MOVE LN-BR-TFR-FG TO QLN-BR-TFR-FG.
           MOVE LN-O3INS-DLPROC TO QLN-O3INS-DLPROC.
           MOVE LN-INSPREM-DLADJ TO QLN-INSPREM-DLADJ.
           MOVE LN-PLAMT TO QLN-PLAMT.
           MOVE LN-MTD-PRIN TO QLN-MTD-PRIN.
           MOVE LN-MTD-LC TO QLN-MTD-LC.
           MOVE LN-MTD-INT TO QLN-MTD-INT.
           MOVE LN-MTD-OT TO QLN-MTD-OT.
           MOVE LN-MTD-EX TO QLN-MTD-EX.
           MOVE LN-BNKRPT-CHAPTER TO QLN-BNKRPT-CHAPTER.
           MOVE LN-BMO-CON-STATUS TO QLN-BMO-CON-STATUS.
           MOVE LN-BMO-REC-STATUS TO QLN-BMO-REC-STATUS.
           MOVE LN-APP-NUMBER TO QLN-APP-NUMBER.
           MOVE LN-GIFTNET TO QLN-GIFTNET.
           MOVE LN-GIFTNET-OUR-PO TO QLN-GIFTNET-OUR-PO.
           MOVE LN-PROC-DISBURSED TO QLN-PROC-DISBURSED.
           MOVE LN-NOODDPY TO QLN-NOODDPY.
           MOVE LN-CONPROFILE(1) TO QLN-CONPROFILE-1.
           MOVE LN-CONPROFILE(2) TO QLN-CONPROFILE-2.
           MOVE LN-CONPROFILE(3) TO QLN-CONPROFILE-3.
           MOVE LN-CONPROFILE(4) TO QLN-CONPROFILE-4.
           MOVE LN-CONPROFILE(5) TO QLN-CONPROFILE-5.
           MOVE LN-RECPROFILE(1) TO QLN-RECPROFILE-1.
           MOVE LN-RECPROFILE(2) TO QLN-RECPROFILE-2.
           MOVE LN-RECPROFILE(3) TO QLN-RECPROFILE-3.
           MOVE LN-RECPROFILE(4) TO QLN-RECPROFILE-4.
           MOVE LN-RECPROFILE(5) TO QLN-RECPROFILE-5.
           MOVE LN-TRW-STATUS TO QLN-TRW-STATUS.
           MOVE LN-ORIGIN TO QLN-ORIGIN.
           MOVE LN-PO-TRCD TO QLN-PO-TRCD.
           MOVE LN-NEXIS-CRSCORE TO QLN-NEXIS-CRSCORE.
           MOVE LN-TRW-B-CONSUMER-IND TO QLN-TRW-B-CONSUMER-IND.
           MOVE LN-PARVHELD-PAID-FG TO QLN-PARVHELD-PAID-FG.
           MOVE LN-ACCT-FROZEN TO QLN-ACCT-FROZEN.
           MOVE LN-TRW-SPECIAL-CODE TO QLN-TRW-SPECIAL-CODE.
           MOVE LN-CREATION-STATUS TO QLN-CREATION-STATUS.
           MOVE LN-TOTNOLCHG TO QLN-TOTNOLCHG.
           MOVE LN-LBOX TO QLN-LBOX.
           MOVE LN-EXTRA-PRIN-LFP TO QLN-EXTRA-PRIN-LFP.
           MOVE LN-REMAIN-INT-SINCE-LFP TO QLN-REMAIN-INT-SINCE-LFP.
           MOVE LN-REMAIN-PRIN-SINCE-LFP TO QLN-REMAIN-PRIN-SINCE-LFP.
           MOVE LN-INTERIM-COUPON TO QLN-INTERIM-COUPON.
           MOVE LN-DLCOMM-O3-CMSI TO QLN-DLCOMM-O3-CMSI.
           MOVE LN-DLCOMM-PP-CMSI TO QLN-DLCOMM-PP-CMSI.
           MOVE LN-TRW-J-CONSUMER-IND TO QLN-TRW-J-CONSUMER-IND.
           MOVE LN-ACH TO QLN-ACH.
           MOVE LN-1099-C-FG TO QLN-1099-C-FG.
           MOVE LN-TRW-COMPLIANCE-CODE TO QLN-TRW-COMPLIANCE-CODE.
           MOVE LN-UNWIND-REASON-CODE TO QLN-UNWIND-REASON-CODE.
           MOVE LN-PBI-PBD-FG TO QLN-PBI-PBD-FG.
           MOVE LN-OLD-ACCT-FORMAT-FG TO QLN-OLD-ACCT-FORMAT-FG.
           MOVE LN-APPROVED-BY-USER TO QLN-APPROVED-BY-USER.
           MOVE LN-APPROVED-BY-CODE TO QLN-APPROVED-BY-CODE.

           MOVE LN-APPROVED-BY-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-APPROVED-BY-DATE.

           MOVE LN-APPROVED-BY-TIME TO QLN-APPROVED-BY-TIME.

           MOVE LN-LTOUCH-DATE TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QLN-LTOUCH-DATE.

           MOVE LN-LTOUCH-TIME TO QLN-LTOUCH-TIME.
           MOVE LN-LOS-APP-ID  TO QLN-LOS-APP-ID.
      *================================================================*
      * END COPYBOOK: LIBLP\LPLNGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPCDGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPCDGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - CDFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0507 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD CD-REC FROM QCD-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-CD-FIELDS.
           MOVE QCD-TYPE TO CD-TYPE.
           MOVE QCD-CODE TO CD-CODE.

           IF ( QCD-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO CD-LTOUCH-DATE
           ELSE
              MOVE QCD-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO CD-LTOUCH-DATE.

           MOVE QCD-DESC TO CD-DESC.
           MOVE QCD-AT-ACTIONCD TO CD-AT-ACTIONCD.
           MOVE QCD-AT-MEMO-REQUIRED TO CD-AT-MEMO-REQUIRED.
           MOVE QCD-AT-SUPERVISOR-ONLY TO CD-AT-SUPERVISOR-ONLY.
           MOVE QCD-AT-RESULT-REQUIRED TO CD-AT-RESULT-REQUIRED.
           MOVE QCD-BR-FILE-TYPE TO CD-BR-FILE-TYPE.
           MOVE QCD-BR-FILE-NAME TO CD-BR-FILE-NAME.
           MOVE QCD-BR-PAYOFF-FG TO CD-BR-PAYOFF-FG.
           MOVE QCD-BR-POST-SS-TRCD TO CD-BR-POST-SS-TRCD.
           MOVE QCD-BR-GL-BRANCH TO CD-BR-GL-BRANCH.
           MOVE QCD-BR-GL-ACCT TO CD-BR-GL-ACCT.
           MOVE QCD-BR-ALLOT-OPTION TO CD-BR-ALLOT-OPTION.
           MOVE QCD-BR-LBOX-OPTION TO CD-BR-LBOX-OPTION.
           MOVE QCD-BR-LC-FG TO CD-BR-LC-FG.
           MOVE QCD-BR-OT-GL-BRANCH TO CD-BR-OT-GL-BRANCH.
           MOVE QCD-BR-OT-GL-ACCT TO CD-BR-OT-GL-ACCT.
           MOVE QCD-BR-MULTIPLE-REFCDS TO CD-BR-MULTIPLE-REFCDS.
           MOVE QCD-BR-COLLECT-LC TO CD-BR-COLLECT-LC.
           MOVE QCD-CO-GROUP TO CD-CO-GROUP.
           MOVE QCD-CO-SECURED TO CD-CO-SECURED.
           MOVE QCD-CO-TRW TO CD-CO-TRW.
           MOVE QCD-CT-INSTAXFRMLA-1 TO CD-CT-INSTAXFRMLA(1).
           MOVE QCD-CT-INSTAXAMT-1 TO CD-CT-INSTAXAMT(1).
           MOVE QCD-CT-INSTAXFRMLA-2 TO CD-CT-INSTAXFRMLA(2).
           MOVE QCD-CT-INSTAXAMT-2 TO CD-CT-INSTAXAMT(2).
           MOVE QCD-CT-INSTAXFRMLA-3 TO CD-CT-INSTAXFRMLA(3).
           MOVE QCD-CT-INSTAXAMT-3 TO CD-CT-INSTAXAMT(3).
           MOVE QCD-CT-INSTAXFRMLA-4 TO CD-CT-INSTAXFRMLA(4).
           MOVE QCD-CT-INSTAXAMT-4 TO CD-CT-INSTAXAMT(4).
           MOVE QCD-CT-INSTAXFRMLA-5 TO CD-CT-INSTAXFRMLA(5).
           MOVE QCD-CT-INSTAXAMT-5 TO CD-CT-INSTAXAMT(5).
           MOVE QCD-CT-INSTAXFRMLA-6 TO CD-CT-INSTAXFRMLA(6).
           MOVE QCD-CT-INSTAXAMT-6 TO CD-CT-INSTAXAMT(6).
           MOVE QCD-CT-INSTAXFRMLA-7 TO CD-CT-INSTAXFRMLA(7).
           MOVE QCD-CT-INSTAXAMT-7 TO CD-CT-INSTAXAMT(7).
           MOVE QCD-CT-INSTAXFRMLA-8 TO CD-CT-INSTAXFRMLA(8).
           MOVE QCD-CT-INSTAXAMT-8 TO CD-CT-INSTAXAMT(8).
           MOVE QCD-CT-INSTAXFRMLA-9 TO CD-CT-INSTAXFRMLA(9).
           MOVE QCD-CT-INSTAXAMT-9 TO CD-CT-INSTAXAMT(9).
           MOVE QCD-CT-INSTAXFRMLA-10 TO CD-CT-INSTAXFRMLA(10).
           MOVE QCD-CT-INSTAXAMT-10 TO CD-CT-INSTAXAMT(10).
           MOVE QCD-CT-INSTAXFRMLA-11 TO CD-CT-INSTAXFRMLA(11).
           MOVE QCD-CT-INSTAXAMT-11 TO CD-CT-INSTAXAMT(11).
           MOVE QCD-CT-INSTAXFRMLA-12 TO CD-CT-INSTAXFRMLA(12).
           MOVE QCD-CT-INSTAXAMT-12 TO CD-CT-INSTAXAMT(12).
           MOVE QCD-CT-BOTH-TAX-FG TO CD-CT-BOTH-TAX-FG.
           MOVE QCD-CY-INSTAXFRMLA-1 TO CD-CY-INSTAXFRMLA(1).
           MOVE QCD-CY-INSTAXAMT-1 TO CD-CY-INSTAXAMT(1).
           MOVE QCD-CY-INSTAXFRMLA-2 TO CD-CY-INSTAXFRMLA(2).
           MOVE QCD-CY-INSTAXAMT-2 TO CD-CY-INSTAXAMT(2).
           MOVE QCD-CY-INSTAXFRMLA-3 TO CD-CY-INSTAXFRMLA(3).
           MOVE QCD-CY-INSTAXAMT-3 TO CD-CY-INSTAXAMT(3).
           MOVE QCD-CY-INSTAXFRMLA-4 TO CD-CY-INSTAXFRMLA(4).
           MOVE QCD-CY-INSTAXAMT-4 TO CD-CY-INSTAXAMT(4).
           MOVE QCD-CY-INSTAXFRMLA-5 TO CD-CY-INSTAXFRMLA(5).
           MOVE QCD-CY-INSTAXAMT-5 TO CD-CY-INSTAXAMT(5).
           MOVE QCD-CY-INSTAXFRMLA-6 TO CD-CY-INSTAXFRMLA(6).
           MOVE QCD-CY-INSTAXAMT-6 TO CD-CY-INSTAXAMT(6).
           MOVE QCD-CY-INSTAXFRMLA-7 TO CD-CY-INSTAXFRMLA(7).
           MOVE QCD-CY-INSTAXAMT-7 TO CD-CY-INSTAXAMT(7).
           MOVE QCD-CY-INSTAXFRMLA-8 TO CD-CY-INSTAXFRMLA(8).
           MOVE QCD-CY-INSTAXAMT-8 TO CD-CY-INSTAXAMT(8).
           MOVE QCD-CY-INSTAXFRMLA-9 TO CD-CY-INSTAXFRMLA(9).
           MOVE QCD-CY-INSTAXAMT-9 TO CD-CY-INSTAXAMT(9).
           MOVE QCD-CY-INSTAXFRMLA-10 TO CD-CY-INSTAXFRMLA(10).
           MOVE QCD-CY-INSTAXAMT-10 TO CD-CY-INSTAXAMT(10).
           MOVE QCD-CY-INSTAXFRMLA-11 TO CD-CY-INSTAXFRMLA(11).
           MOVE QCD-CY-INSTAXAMT-11 TO CD-CY-INSTAXAMT(11).
           MOVE QCD-CY-INSTAXFRMLA-12 TO CD-CY-INSTAXFRMLA(12).
           MOVE QCD-CY-INSTAXAMT-12 TO CD-CY-INSTAXAMT(12).
           MOVE QCD-CY-BOTH-TAX-FG TO CD-CY-BOTH-TAX-FG.
           MOVE QCD-EA-CQ-FG TO CD-EA-CQ-FG.
           MOVE QCD-EA-GQ-FG TO CD-EA-GQ-FG.
           MOVE QCD-ELGRACE TO CD-ELGRACE.
           MOVE QCD-ELGRACECD TO CD-ELGRACECD.
           MOVE QCD-ELTYPE TO CD-ELTYPE.
           MOVE QCD-ELRATE TO CD-ELRATE.
           MOVE QCD-ELFRMLA TO CD-ELFRMLA.
           MOVE QCD-ELMINCHG TO CD-ELMINCHG.
           MOVE QCD-ELMAXAMT TO CD-ELMAXAMT.
           MOVE QCD-ELDELFAC TO CD-ELDELFAC.
           MOVE QCD-ELYRTYPE TO CD-ELYRTYPE.
           MOVE QCD-ELUNITPER-CD TO CD-ELUNITPER-CD.
           MOVE QCD-PO-TITLE-HOLD-DAYS TO CD-PO-TITLE-HOLD-DAYS.
           MOVE QCD-RE-ACTIONCD TO CD-RE-ACTIONCD.
           MOVE QCD-RE-MEMO-REQUIRED TO CD-RE-MEMO-REQUIRED.
           MOVE QCD-RE-SUPERVISOR-ONLY TO CD-RE-SUPERVISOR-ONLY.
           MOVE QCD-RE-ACTIVITY-REQUIRED TO CD-RE-ACTIVITY-REQUIRED.
           MOVE QCD-RE-RESCHEDULE-REQ TO CD-RE-RESCHEDULE-REQ.
           MOVE QCD-RE-RESCHEDULE-TIME TO CD-RE-RESCHEDULE-TIME.
           MOVE QCD-RE-WORKED-ACCOUNT TO CD-RE-WORKED-ACCOUNT.
           MOVE QCD-FC-FEEAMT TO CD-FC-FEEAMT.
           MOVE QCD-TC-REFNO-1 TO CD-TC-REFNO(1).
           MOVE QCD-TC-REFNO-2 TO CD-TC-REFNO(2).
           MOVE QCD-TC-REFNO-3 TO CD-TC-REFNO(3).
           MOVE QCD-TC-REFNO-4 TO CD-TC-REFNO(4).
           MOVE QCD-TC-REFNO-5 TO CD-TC-REFNO(5).
           MOVE QCD-TC-REFNO-6 TO CD-TC-REFNO(6).
           MOVE QCD-TC-REFNO-7 TO CD-TC-REFNO(7).
           MOVE QCD-TC-REFNO-8 TO CD-TC-REFNO(8).
           MOVE QCD-TC-REFNO-9 TO CD-TC-REFNO(9).
           MOVE QCD-TC-REFNO-10 TO CD-TC-REFNO(10).
           MOVE QCD-PS-TDR-FLAG TO CD-PS-TDR-FLAG.
 
      *-----------------------------------------------------------------
      *    LOAD QCD-REC FROM CD-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-CD-FIELDS.
           MOVE CD-TYPE TO QCD-TYPE.
           MOVE CD-CODE TO QCD-CODE.

           IF ( CD-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QCD-LTOUCH-DATE
           ELSE
              MOVE CD-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QCD-LTOUCH-DATE.

           MOVE CD-DESC TO QCD-DESC.
           MOVE CD-AT-ACTIONCD TO QCD-AT-ACTIONCD.
           MOVE CD-AT-MEMO-REQUIRED TO QCD-AT-MEMO-REQUIRED.
           MOVE CD-AT-SUPERVISOR-ONLY TO QCD-AT-SUPERVISOR-ONLY.
           MOVE CD-AT-RESULT-REQUIRED TO QCD-AT-RESULT-REQUIRED.
           MOVE CD-BR-FILE-TYPE TO QCD-BR-FILE-TYPE.
           MOVE CD-BR-FILE-NAME TO QCD-BR-FILE-NAME.
           MOVE CD-BR-PAYOFF-FG TO QCD-BR-PAYOFF-FG.
           MOVE CD-BR-POST-SS-TRCD TO QCD-BR-POST-SS-TRCD.
           MOVE CD-BR-GL-BRANCH TO QCD-BR-GL-BRANCH.
           MOVE CD-BR-GL-ACCT TO QCD-BR-GL-ACCT.
           MOVE CD-BR-ALLOT-OPTION TO QCD-BR-ALLOT-OPTION.
           MOVE CD-BR-LBOX-OPTION TO QCD-BR-LBOX-OPTION.
           MOVE CD-BR-LC-FG TO QCD-BR-LC-FG.
           MOVE CD-BR-OT-GL-BRANCH TO QCD-BR-OT-GL-BRANCH.
           MOVE CD-BR-OT-GL-ACCT TO QCD-BR-OT-GL-ACCT.
           MOVE CD-BR-MULTIPLE-REFCDS TO QCD-BR-MULTIPLE-REFCDS.
           MOVE CD-BR-COLLECT-LC TO QCD-BR-COLLECT-LC.
           MOVE CD-CO-GROUP TO QCD-CO-GROUP.
           MOVE CD-CO-SECURED TO QCD-CO-SECURED.
           MOVE CD-CO-TRW TO QCD-CO-TRW.
           MOVE CD-CT-INSTAXFRMLA(1) TO QCD-CT-INSTAXFRMLA-1.
           MOVE CD-CT-INSTAXAMT(1) TO QCD-CT-INSTAXAMT-1.
           MOVE CD-CT-INSTAXFRMLA(2) TO QCD-CT-INSTAXFRMLA-2.
           MOVE CD-CT-INSTAXAMT(2) TO QCD-CT-INSTAXAMT-2.
           MOVE CD-CT-INSTAXFRMLA(3) TO QCD-CT-INSTAXFRMLA-3.
           MOVE CD-CT-INSTAXAMT(3) TO QCD-CT-INSTAXAMT-3.
           MOVE CD-CT-INSTAXFRMLA(4) TO QCD-CT-INSTAXFRMLA-4.
           MOVE CD-CT-INSTAXAMT(4) TO QCD-CT-INSTAXAMT-4.
           MOVE CD-CT-INSTAXFRMLA(5) TO QCD-CT-INSTAXFRMLA-5.
           MOVE CD-CT-INSTAXAMT(5) TO QCD-CT-INSTAXAMT-5.
           MOVE CD-CT-INSTAXFRMLA(6) TO QCD-CT-INSTAXFRMLA-6.
           MOVE CD-CT-INSTAXAMT(6) TO QCD-CT-INSTAXAMT-6.
           MOVE CD-CT-INSTAXFRMLA(7) TO QCD-CT-INSTAXFRMLA-7.
           MOVE CD-CT-INSTAXAMT(7) TO QCD-CT-INSTAXAMT-7.
           MOVE CD-CT-INSTAXFRMLA(8) TO QCD-CT-INSTAXFRMLA-8.
           MOVE CD-CT-INSTAXAMT(8) TO QCD-CT-INSTAXAMT-8.
           MOVE CD-CT-INSTAXFRMLA(9) TO QCD-CT-INSTAXFRMLA-9.
           MOVE CD-CT-INSTAXAMT(9) TO QCD-CT-INSTAXAMT-9.
           MOVE CD-CT-INSTAXFRMLA(10) TO QCD-CT-INSTAXFRMLA-10.
           MOVE CD-CT-INSTAXAMT(10) TO QCD-CT-INSTAXAMT-10.
           MOVE CD-CT-INSTAXFRMLA(11) TO QCD-CT-INSTAXFRMLA-11.
           MOVE CD-CT-INSTAXAMT(11) TO QCD-CT-INSTAXAMT-11.
           MOVE CD-CT-INSTAXFRMLA(12) TO QCD-CT-INSTAXFRMLA-12.
           MOVE CD-CT-INSTAXAMT(12) TO QCD-CT-INSTAXAMT-12.
           MOVE CD-CT-BOTH-TAX-FG TO QCD-CT-BOTH-TAX-FG.
           MOVE CD-CY-INSTAXFRMLA(1) TO QCD-CY-INSTAXFRMLA-1.
           MOVE CD-CY-INSTAXAMT(1) TO QCD-CY-INSTAXAMT-1.
           MOVE CD-CY-INSTAXFRMLA(2) TO QCD-CY-INSTAXFRMLA-2.
           MOVE CD-CY-INSTAXAMT(2) TO QCD-CY-INSTAXAMT-2.
           MOVE CD-CY-INSTAXFRMLA(3) TO QCD-CY-INSTAXFRMLA-3.
           MOVE CD-CY-INSTAXAMT(3) TO QCD-CY-INSTAXAMT-3.
           MOVE CD-CY-INSTAXFRMLA(4) TO QCD-CY-INSTAXFRMLA-4.
           MOVE CD-CY-INSTAXAMT(4) TO QCD-CY-INSTAXAMT-4.
           MOVE CD-CY-INSTAXFRMLA(5) TO QCD-CY-INSTAXFRMLA-5.
           MOVE CD-CY-INSTAXAMT(5) TO QCD-CY-INSTAXAMT-5.
           MOVE CD-CY-INSTAXFRMLA(6) TO QCD-CY-INSTAXFRMLA-6.
           MOVE CD-CY-INSTAXAMT(6) TO QCD-CY-INSTAXAMT-6.
           MOVE CD-CY-INSTAXFRMLA(7) TO QCD-CY-INSTAXFRMLA-7.
           MOVE CD-CY-INSTAXAMT(7) TO QCD-CY-INSTAXAMT-7.
           MOVE CD-CY-INSTAXFRMLA(8) TO QCD-CY-INSTAXFRMLA-8.
           MOVE CD-CY-INSTAXAMT(8) TO QCD-CY-INSTAXAMT-8.
           MOVE CD-CY-INSTAXFRMLA(9) TO QCD-CY-INSTAXFRMLA-9.
           MOVE CD-CY-INSTAXAMT(9) TO QCD-CY-INSTAXAMT-9.
           MOVE CD-CY-INSTAXFRMLA(10) TO QCD-CY-INSTAXFRMLA-10.
           MOVE CD-CY-INSTAXAMT(10) TO QCD-CY-INSTAXAMT-10.
           MOVE CD-CY-INSTAXFRMLA(11) TO QCD-CY-INSTAXFRMLA-11.
           MOVE CD-CY-INSTAXAMT(11) TO QCD-CY-INSTAXAMT-11.
           MOVE CD-CY-INSTAXFRMLA(12) TO QCD-CY-INSTAXFRMLA-12.
           MOVE CD-CY-INSTAXAMT(12) TO QCD-CY-INSTAXAMT-12.
           MOVE CD-CY-BOTH-TAX-FG TO QCD-CY-BOTH-TAX-FG.
           MOVE CD-EA-CQ-FG TO QCD-EA-CQ-FG.
           MOVE CD-EA-GQ-FG TO QCD-EA-GQ-FG.
           MOVE CD-ELGRACE TO QCD-ELGRACE.
           MOVE CD-ELGRACECD TO QCD-ELGRACECD.
           MOVE CD-ELTYPE TO QCD-ELTYPE.
           MOVE CD-ELRATE TO QCD-ELRATE.
           MOVE CD-ELFRMLA TO QCD-ELFRMLA.
           MOVE CD-ELMINCHG TO QCD-ELMINCHG.
           MOVE CD-ELMAXAMT TO QCD-ELMAXAMT.
           MOVE CD-ELDELFAC TO QCD-ELDELFAC.
           MOVE CD-ELYRTYPE TO QCD-ELYRTYPE.
           MOVE CD-ELUNITPER-CD TO QCD-ELUNITPER-CD.
           MOVE CD-PO-TITLE-HOLD-DAYS TO QCD-PO-TITLE-HOLD-DAYS.
           MOVE CD-RE-ACTIONCD TO QCD-RE-ACTIONCD.
           MOVE CD-RE-MEMO-REQUIRED TO QCD-RE-MEMO-REQUIRED.
           MOVE CD-RE-SUPERVISOR-ONLY TO QCD-RE-SUPERVISOR-ONLY.
           MOVE CD-RE-ACTIVITY-REQUIRED TO QCD-RE-ACTIVITY-REQUIRED.
           MOVE CD-RE-RESCHEDULE-REQ TO QCD-RE-RESCHEDULE-REQ.
           MOVE CD-RE-RESCHEDULE-TIME TO QCD-RE-RESCHEDULE-TIME.
           MOVE CD-RE-WORKED-ACCOUNT TO QCD-RE-WORKED-ACCOUNT.
           MOVE CD-FC-FEEAMT TO QCD-FC-FEEAMT.
           MOVE CD-TC-REFNO(1) TO QCD-TC-REFNO-1.
           MOVE CD-TC-REFNO(2) TO QCD-TC-REFNO-2.
           MOVE CD-TC-REFNO(3) TO QCD-TC-REFNO-3.
           MOVE CD-TC-REFNO(4) TO QCD-TC-REFNO-4.
           MOVE CD-TC-REFNO(5) TO QCD-TC-REFNO-5.
           MOVE CD-TC-REFNO(6) TO QCD-TC-REFNO-6.
           MOVE CD-TC-REFNO(7) TO QCD-TC-REFNO-7.
           MOVE CD-TC-REFNO(8) TO QCD-TC-REFNO-8.
           MOVE CD-TC-REFNO(9) TO QCD-TC-REFNO-9.
           MOVE CD-TC-REFNO(10) TO QCD-TC-REFNO-10.
           MOVE CD-PS-TDR-FLAG TO QCD-PS-TDR-FLAG.
 
      *================================================================*
      * END COPYBOOK: LIBLP\LPCDGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPBWGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPBWGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - BWFILE
      *
      *=================================================================
      * REV:
      * JKC 2021-0521 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD BW-REC FROM QBW-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-BW-FIELDS.
           MOVE QBW-OWNBR TO BW-OWNBR.
           MOVE QBW-SSNO TO BW-SSNO.
           MOVE QBW-LNAME TO BW-LNAME.
           MOVE QBW-FNAME TO BW-FNAME.
           MOVE QBW-MNAME TO BW-MNAME.
           MOVE QBW-NICKNAME TO BW-NICKNAME.
           MOVE QBW-GENERATION TO BW-GENERATION.
           MOVE QBW-ADR1 TO BW-ADR1.
           MOVE QBW-ADR2 TO BW-ADR2.
           MOVE QBW-CITY TO BW-CITY.
           MOVE QBW-STATE TO BW-STATE.
           MOVE QBW-ZIP TO BW-ZIP.

           IF ( QBW-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-LTOUCH-DATE
           ELSE
              MOVE QBW-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-LTOUCH-DATE.


           IF ( QBW-REFDATE = "1900-01-01" )
              MOVE ZEROES TO BW-REFDATE
           ELSE
              MOVE QBW-REFDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-REFDATE.


           IF ( QBW-BDATE = "1900-01-01" )
              MOVE ZEROES TO BW-BDATE
           ELSE
              MOVE QBW-BDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-BDATE.

           MOVE QBW-PHONE TO BW-PHONE.
           MOVE QBW-CELL-PHONE TO BW-CELL-PHONE.
           MOVE QBW-NATIONALITY TO BW-NATIONALITY.
           MOVE QBW-GENDER TO BW-GENDER.
           MOVE QBW-DEPEND TO BW-DEPEND.
           MOVE QBW-RENTCD TO BW-RENTCD.
           MOVE QBW-TIMEADDR TO BW-TIMEADDR.
           MOVE QBW-CREDITCD TO BW-CREDITCD.
           MOVE QBW-STRTGCD TO BW-STRTGCD.
           MOVE QBW-DWELLCD TO BW-DWELLCD.
           MOVE QBW-COUNTY TO BW-COUNTY.
           MOVE QBW-ORIGIN TO BW-ORIGIN.
           MOVE QBW-CENSUSCD TO BW-CENSUSCD.
           MOVE QBW-ORGSLSMN TO BW-ORGSLSMN.
           MOVE QBW-REPCODE TO BW-REPCODE.
           MOVE QBW-SPSSNO TO BW-SPSSNO.
           MOVE QBW-SPLNAME TO BW-SPLNAME.
           MOVE QBW-SPFNAME TO BW-SPFNAME.

           IF ( QBW-SP-BDATE = "1900-01-01" )
              MOVE ZEROES TO BW-SP-BDATE
           ELSE
              MOVE QBW-SP-BDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-SP-BDATE.

           MOVE QBW-EMPLOYER TO BW-EMPLOYER.
           MOVE QBW-EMPLPOS TO BW-EMPLPOS.
           MOVE QBW-EMPPHONE TO BW-EMPPHONE.
           MOVE QBW-EMPEXT TO BW-EMPEXT.
           MOVE QBW-EMPYEARS TO BW-EMPYEARS.
           MOVE QBW-EMPPAY TO BW-EMPPAY.
           MOVE QBW-EMPPAYOT TO BW-EMPPAYOT.
           MOVE QBW-EMPPAYSR TO BW-EMPPAYSR.
           MOVE QBW-EMPADDR1 TO BW-EMPADDR1.
           MOVE QBW-EMPADDR2 TO BW-EMPADDR2.
           MOVE QBW-EMPCITY TO BW-EMPCITY.
           MOVE QBW-EMPSTATE TO BW-EMPSTATE.
           MOVE QBW-EMPZIP TO BW-EMPZIP.
           MOVE QBW-WORKHRS TO BW-WORKHRS.
           MOVE QBW-LOANS TO BW-LOANS.
           MOVE QBW-INTYTD TO BW-INTYTD.
           MOVE QBW-INTLYR TO BW-INTLYR.
           MOVE QBW-LIASMLN TO BW-LIASMLN.
           MOVE QBW-LIAOTH TO BW-LIAOTH.

           IF ( QBW-LASTPODATE = "1900-01-01" )
              MOVE ZEROES TO BW-LASTPODATE
           ELSE
              MOVE QBW-LASTPODATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-LASTPODATE.

           MOVE QBW-PRLOANS TO BW-PRLOANS.
           MOVE QBW-RE-INTYTD TO BW-RE-INTYTD.
           MOVE QBW-RE-INTLYR TO BW-RE-INTLYR.
           MOVE QBW-CREDIT-LIMIT TO BW-CREDIT-LIMIT.
           MOVE QBW-CREDIT-SCORE TO BW-CREDIT-SCORE.
           MOVE QBW-CRED-SCORE-1 TO BW-CRED-SCORE(1).
           MOVE QBW-CRED-SCORE-2 TO BW-CRED-SCORE(2).
           MOVE QBW-CRED-SCORE-3 TO BW-CRED-SCORE(3).
           MOVE QBW-CRED-SCORE-4 TO BW-CRED-SCORE(4).
           MOVE QBW-BNKRPT-SCORE-1 TO BW-BNKRPT-SCORE(1).
           MOVE QBW-BNKRPT-SCORE-2 TO BW-BNKRPT-SCORE(2).
           MOVE QBW-BNKRPT-SCORE-3 TO BW-BNKRPT-SCORE(3).
           MOVE QBW-BNKRPT-SCORE-4 TO BW-BNKRPT-SCORE(4).
           MOVE QBW-LAST-FORM-NO TO BW-LAST-FORM-NO.

           IF ( QBW-LAST-FORM-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-LAST-FORM-DATE
           ELSE
              MOVE QBW-LAST-FORM-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-LAST-FORM-DATE.


           IF ( QBW-PRIOR-RN-FOR10-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-PRIOR-RN-FOR10-DATE
           ELSE
              MOVE QBW-PRIOR-RN-FOR10-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-PRIOR-RN-FOR10-DATE.


           IF ( QBW-LAST-RN-FOR10-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-LAST-RN-FOR10-DATE
           ELSE
              MOVE QBW-LAST-RN-FOR10-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-LAST-RN-FOR10-DATE.


           IF ( QBW-ADR-PHONE-CHG-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-ADR-PHONE-CHG-DATE
           ELSE
              MOVE QBW-ADR-PHONE-CHG-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-ADR-PHONE-CHG-DATE.

           MOVE QBW-BAD-ADR-FG TO BW-BAD-ADR-FG.
           MOVE QBW-BAD-PHONE-FG TO BW-BAD-PHONE-FG.
           MOVE QBW-BAD-EMPPHONE-FG TO BW-BAD-EMPPHONE-FG.
           MOVE QBW-BAD-MISC-PHONE1-FG TO BW-BAD-MISC-PHONE1-FG.
           MOVE QBW-BAD-MISC-PHONE2-FG TO BW-BAD-MISC-PHONE2-FG.
           MOVE QBW-BAD-CELL-FG TO BW-BAD-CELL-FG.
           MOVE QBW-MISC-PHONE-1 TO BW-MISC-PHONE(1).
           MOVE QBW-MISC-EXT-1 TO BW-MISC-EXT(1).
           MOVE QBW-MISC-PHONE-CD-1 TO BW-MISC-PHONE-CD(1).
           MOVE QBW-MISC-PHONE-2 TO BW-MISC-PHONE(2).
           MOVE QBW-MISC-EXT-2 TO BW-MISC-EXT(2).
           MOVE QBW-MISC-PHONE-CD-2 TO BW-MISC-PHONE-CD(2).
           MOVE QBW-MISC-PHONE-3 TO BW-MISC-PHONE(3).
           MOVE QBW-MISC-EXT-3 TO BW-MISC-EXT(3).
           MOVE QBW-MISC-PHONE-CD-3 TO BW-MISC-PHONE-CD(3).
           MOVE QBW-MISC-PHONE-4 TO BW-MISC-PHONE(4).
           MOVE QBW-MISC-EXT-4 TO BW-MISC-EXT(4).
           MOVE QBW-MISC-PHONE-CD-4 TO BW-MISC-PHONE-CD(4).
           MOVE QBW-MISC-PHONE-5 TO BW-MISC-PHONE(5).
           MOVE QBW-MISC-EXT-5 TO BW-MISC-EXT(5).
           MOVE QBW-MISC-PHONE-CD-5 TO BW-MISC-PHONE-CD(5).
           MOVE QBW-MISC-PHONE-6 TO BW-MISC-PHONE(6).
           MOVE QBW-MISC-EXT-6 TO BW-MISC-EXT(6).
           MOVE QBW-MISC-PHONE-CD-6 TO BW-MISC-PHONE-CD(6).
           MOVE QBW-CONTACT-DESC-1 TO BW-CONTACT-DESC(1).
           MOVE QBW-CONTACT-PHONE-1 TO BW-CONTACT-PHONE(1).
           MOVE QBW-CONTACT-EXT-1 TO BW-CONTACT-EXT(1).
           MOVE QBW-CONTACT-RELATION-1 TO BW-CONTACT-RELATION(1).
           MOVE QBW-CONTACT-DESC-2 TO BW-CONTACT-DESC(2).
           MOVE QBW-CONTACT-PHONE-2 TO BW-CONTACT-PHONE(2).
           MOVE QBW-CONTACT-EXT-2 TO BW-CONTACT-EXT(2).
           MOVE QBW-CONTACT-RELATION-2 TO BW-CONTACT-RELATION(2).
           MOVE QBW-CONTACT-DESC-3 TO BW-CONTACT-DESC(3).
           MOVE QBW-CONTACT-PHONE-3 TO BW-CONTACT-PHONE(3).
           MOVE QBW-CONTACT-EXT-3 TO BW-CONTACT-EXT(3).
           MOVE QBW-CONTACT-RELATION-3 TO BW-CONTACT-RELATION(3).
           MOVE QBW-CONTACT-DESC-4 TO BW-CONTACT-DESC(4).
           MOVE QBW-CONTACT-PHONE-4 TO BW-CONTACT-PHONE(4).
           MOVE QBW-CONTACT-EXT-4 TO BW-CONTACT-EXT(4).
           MOVE QBW-CONTACT-RELATION-4 TO BW-CONTACT-RELATION(4).
           MOVE QBW-CONTACT-DESC-5 TO BW-CONTACT-DESC(5).
           MOVE QBW-CONTACT-PHONE-5 TO BW-CONTACT-PHONE(5).
           MOVE QBW-CONTACT-EXT-5 TO BW-CONTACT-EXT(5).
           MOVE QBW-CONTACT-RELATION-5 TO BW-CONTACT-RELATION(5).
           MOVE QBW-CONTACT-DESC-6 TO BW-CONTACT-DESC(6).
           MOVE QBW-CONTACT-PHONE-6 TO BW-CONTACT-PHONE(6).
           MOVE QBW-CONTACT-EXT-6 TO BW-CONTACT-EXT(6).
           MOVE QBW-CONTACT-RELATION-6 TO BW-CONTACT-RELATION(6).
           MOVE QBW-CONTACT-DESC-7 TO BW-CONTACT-DESC(7).
           MOVE QBW-CONTACT-PHONE-7 TO BW-CONTACT-PHONE(7).
           MOVE QBW-CONTACT-EXT-7 TO BW-CONTACT-EXT(7).
           MOVE QBW-CONTACT-RELATION-7 TO BW-CONTACT-RELATION(7).
           MOVE QBW-CONTACT-DESC-8 TO BW-CONTACT-DESC(8).
           MOVE QBW-CONTACT-PHONE-8 TO BW-CONTACT-PHONE(8).
           MOVE QBW-CONTACT-EXT-8 TO BW-CONTACT-EXT(8).
           MOVE QBW-CONTACT-RELATION-8 TO BW-CONTACT-RELATION(8).
           MOVE QBW-CONTACT-DESC-9 TO BW-CONTACT-DESC(9).
           MOVE QBW-CONTACT-PHONE-9 TO BW-CONTACT-PHONE(9).
           MOVE QBW-CONTACT-EXT-9 TO BW-CONTACT-EXT(9).
           MOVE QBW-CONTACT-RELATION-9 TO BW-CONTACT-RELATION(9).
           MOVE QBW-CONTACT-DESC-10 TO BW-CONTACT-DESC(10).
           MOVE QBW-CONTACT-PHONE-10 TO BW-CONTACT-PHONE(10).
           MOVE QBW-CONTACT-EXT-10 TO BW-CONTACT-EXT(10).
           MOVE QBW-CONTACT-RELATION-10 TO BW-CONTACT-RELATION(10).
           MOVE QBW-SRCD TO BW-SRCD.
           MOVE QBW-CALL-ON-SUNDAY TO BW-CALL-ON-SUNDAY.
           MOVE QBW-SOLICIT TO BW-SOLICIT.
           MOVE QBW-CONFIDENTIAL TO BW-CONFIDENTIAL.
           MOVE QBW-PRIVACY-OPT-OUT TO BW-PRIVACY-OPT-OUT.
           MOVE QBW-OPT-IN-EMAIL TO BW-OPT-IN-EMAIL.
           MOVE QBW-OPT-IN-TEXT TO BW-OPT-IN-TEXT.
           MOVE QBW-CITY-TAX-CD TO BW-CITY-TAX-CD.

           IF ( QBW-DEALTRACK-CHG-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-DEALTRACK-CHG-DATE
           ELSE
              MOVE QBW-DEALTRACK-CHG-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-DEALTRACK-CHG-DATE.

           MOVE QBW-DECEASED TO BW-DECEASED.

           IF ( QBW-DECEASED-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-DECEASED-DATE
           ELSE
              MOVE QBW-DECEASED-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-DECEASED-DATE.

           MOVE QBW-EMAIL TO BW-EMAIL.
           MOVE QBW-IDENT-NO TO BW-IDENT-NO.
           MOVE QBW-IDENT-TYPE TO BW-IDENT-TYPE.
           MOVE QBW-IDENT-STATE   TO BW-IDENT-STATE.
           MOVE QBW-MILITARY-FLAG TO BW-MILITARY-FLAG.
           MOVE QBW-ORGBR         TO BW-ORGBR.
           IF ( QBW-CEASE-DESIST-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-CEASE-DESIST-DATE
           ELSE
              MOVE QBW-CEASE-DESIST-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-CEASE-DESIST-DATE.
           MOVE QBW-CEASE-DESIST-TYPE TO BW-CEASE-DESIST-TYPE.
           IF ( QBW-UMC-EXPIRE-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-UMC-EXPIRE-DATE
           ELSE
              MOVE QBW-UMC-EXPIRE-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-UMC-EXPIRE-DATE.
           IF ( QBW-UMC-PR-EXPIRE-DATE = "1900-01-01" )
              MOVE ZEROES TO BW-UMC-PR-EXPIRE-DATE
           ELSE
              MOVE QBW-UMC-PR-EXPIRE-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BW-UMC-PR-EXPIRE-DATE.
      *    MOVE QBW-VISION-KEY1   TO BW-VISION-KEY1.
      *    MOVE QBW-VISION-KEY2   TO BW-VISION-KEY2.
      *    MOVE QBW-VISION-KEY3   TO BW-VISION-KEY3.
      *    MOVE QBW-VISION-KEY4   TO BW-VISION-KEY4.
 
      *-----------------------------------------------------------------
      *    LOAD QBW-REC FROM BW-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-BW-FIELDS.
           MOVE BW-OWNBR TO QBW-OWNBR.
           MOVE BW-SSNO TO QBW-SSNO.
           MOVE BW-LNAME TO QBW-LNAME.
           MOVE BW-FNAME TO QBW-FNAME.
           MOVE BW-MNAME TO QBW-MNAME.
           MOVE BW-NICKNAME TO QBW-NICKNAME.
           MOVE BW-GENERATION TO QBW-GENERATION.
           MOVE BW-ADR1 TO QBW-ADR1.
           MOVE BW-ADR2 TO QBW-ADR2.
           MOVE BW-CITY TO QBW-CITY.
           MOVE BW-STATE TO QBW-STATE.
           MOVE BW-ZIP TO QBW-ZIP.

           IF ( BW-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-LTOUCH-DATE
           ELSE
              MOVE BW-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-LTOUCH-DATE.


           IF ( BW-REFDATE = ZEROES )
              MOVE "1900-01-01" TO QBW-REFDATE
           ELSE
              MOVE BW-REFDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-REFDATE.


           IF ( BW-BDATE = ZEROES )
              MOVE "1900-01-01" TO QBW-BDATE
           ELSE
              MOVE BW-BDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-BDATE.

           MOVE BW-PHONE TO QBW-PHONE.
           MOVE BW-CELL-PHONE TO QBW-CELL-PHONE.
           MOVE BW-NATIONALITY TO QBW-NATIONALITY.
           MOVE BW-GENDER TO QBW-GENDER.
           MOVE BW-DEPEND TO QBW-DEPEND.
           MOVE BW-RENTCD TO QBW-RENTCD.
           MOVE BW-TIMEADDR TO QBW-TIMEADDR.
           MOVE BW-CREDITCD TO QBW-CREDITCD.
           MOVE BW-STRTGCD TO QBW-STRTGCD.
           MOVE BW-DWELLCD TO QBW-DWELLCD.
           MOVE BW-COUNTY TO QBW-COUNTY.
           MOVE BW-ORIGIN TO QBW-ORIGIN.
           MOVE BW-CENSUSCD TO QBW-CENSUSCD.
           MOVE BW-ORGSLSMN TO QBW-ORGSLSMN.
           MOVE BW-REPCODE TO QBW-REPCODE.
           MOVE BW-SPSSNO TO QBW-SPSSNO.
           MOVE BW-SPLNAME TO QBW-SPLNAME.
           MOVE BW-SPFNAME TO QBW-SPFNAME.

           IF ( BW-SP-BDATE = ZEROES )
              MOVE "1900-01-01" TO QBW-SP-BDATE
           ELSE
              MOVE BW-SP-BDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-SP-BDATE.

           MOVE BW-EMPLOYER TO QBW-EMPLOYER.
           MOVE BW-EMPLPOS TO QBW-EMPLPOS.
           MOVE BW-EMPPHONE TO QBW-EMPPHONE.
           MOVE BW-EMPEXT TO QBW-EMPEXT.
           MOVE BW-EMPYEARS TO QBW-EMPYEARS.
           MOVE BW-EMPPAY TO QBW-EMPPAY.
           MOVE BW-EMPPAYOT TO QBW-EMPPAYOT.
           MOVE BW-EMPPAYSR TO QBW-EMPPAYSR.
           MOVE BW-EMPADDR1 TO QBW-EMPADDR1.
           MOVE BW-EMPADDR2 TO QBW-EMPADDR2.
           MOVE BW-EMPCITY TO QBW-EMPCITY.
           MOVE BW-EMPSTATE TO QBW-EMPSTATE.
           MOVE BW-EMPZIP TO QBW-EMPZIP.
           MOVE BW-WORKHRS TO QBW-WORKHRS.
           MOVE BW-LOANS TO QBW-LOANS.
           MOVE BW-INTYTD TO QBW-INTYTD.
           MOVE BW-INTLYR TO QBW-INTLYR.
           MOVE BW-LIASMLN TO QBW-LIASMLN.
           MOVE BW-LIAOTH TO QBW-LIAOTH.

           IF ( BW-LASTPODATE = ZEROES )
              MOVE "1900-01-01" TO QBW-LASTPODATE
           ELSE
              MOVE BW-LASTPODATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-LASTPODATE.

           MOVE BW-PRLOANS TO QBW-PRLOANS.
           MOVE BW-RE-INTYTD TO QBW-RE-INTYTD.
           MOVE BW-RE-INTLYR TO QBW-RE-INTLYR.
           MOVE BW-CREDIT-LIMIT TO QBW-CREDIT-LIMIT.
           MOVE BW-CREDIT-SCORE TO QBW-CREDIT-SCORE.
           MOVE BW-CRED-SCORE(1) TO QBW-CRED-SCORE-1.
           MOVE BW-CRED-SCORE(2) TO QBW-CRED-SCORE-2.
           MOVE BW-CRED-SCORE(3) TO QBW-CRED-SCORE-3.
           MOVE BW-CRED-SCORE(4) TO QBW-CRED-SCORE-4.
           MOVE BW-BNKRPT-SCORE(1) TO QBW-BNKRPT-SCORE-1.
           MOVE BW-BNKRPT-SCORE(2) TO QBW-BNKRPT-SCORE-2.
           MOVE BW-BNKRPT-SCORE(3) TO QBW-BNKRPT-SCORE-3.
           MOVE BW-BNKRPT-SCORE(4) TO QBW-BNKRPT-SCORE-4.
           MOVE BW-LAST-FORM-NO TO QBW-LAST-FORM-NO.

           IF ( BW-LAST-FORM-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-LAST-FORM-DATE
           ELSE
              MOVE BW-LAST-FORM-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-LAST-FORM-DATE.


           IF ( BW-PRIOR-RN-FOR10-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-PRIOR-RN-FOR10-DATE
           ELSE
              MOVE BW-PRIOR-RN-FOR10-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-PRIOR-RN-FOR10-DATE.


           IF ( BW-LAST-RN-FOR10-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-LAST-RN-FOR10-DATE
           ELSE
              MOVE BW-LAST-RN-FOR10-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-LAST-RN-FOR10-DATE.


           IF ( BW-ADR-PHONE-CHG-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-ADR-PHONE-CHG-DATE
           ELSE
              MOVE BW-ADR-PHONE-CHG-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-ADR-PHONE-CHG-DATE.

           MOVE BW-BAD-ADR-FG TO QBW-BAD-ADR-FG.
           MOVE BW-BAD-PHONE-FG TO QBW-BAD-PHONE-FG.
           MOVE BW-BAD-EMPPHONE-FG TO QBW-BAD-EMPPHONE-FG.
           MOVE BW-BAD-MISC-PHONE1-FG TO QBW-BAD-MISC-PHONE1-FG.
           MOVE BW-BAD-MISC-PHONE2-FG TO QBW-BAD-MISC-PHONE2-FG.
           MOVE BW-BAD-CELL-FG TO QBW-BAD-CELL-FG.
           MOVE BW-MISC-PHONE(1) TO QBW-MISC-PHONE-1.
           MOVE BW-MISC-EXT(1) TO QBW-MISC-EXT-1.
           MOVE BW-MISC-PHONE-CD(1) TO QBW-MISC-PHONE-CD-1.
           MOVE BW-MISC-PHONE(2) TO QBW-MISC-PHONE-2.
           MOVE BW-MISC-EXT(2) TO QBW-MISC-EXT-2.
           MOVE BW-MISC-PHONE-CD(2) TO QBW-MISC-PHONE-CD-2.
           MOVE BW-MISC-PHONE(3) TO QBW-MISC-PHONE-3.
           MOVE BW-MISC-EXT(3) TO QBW-MISC-EXT-3.
           MOVE BW-MISC-PHONE-CD(3) TO QBW-MISC-PHONE-CD-3.
           MOVE BW-MISC-PHONE(4) TO QBW-MISC-PHONE-4.
           MOVE BW-MISC-EXT(4) TO QBW-MISC-EXT-4.
           MOVE BW-MISC-PHONE-CD(4) TO QBW-MISC-PHONE-CD-4.
           MOVE BW-MISC-PHONE(5) TO QBW-MISC-PHONE-5.
           MOVE BW-MISC-EXT(5) TO QBW-MISC-EXT-5.
           MOVE BW-MISC-PHONE-CD(5) TO QBW-MISC-PHONE-CD-5.
           MOVE BW-MISC-PHONE(6) TO QBW-MISC-PHONE-6.
           MOVE BW-MISC-EXT(6) TO QBW-MISC-EXT-6.
           MOVE BW-MISC-PHONE-CD(6) TO QBW-MISC-PHONE-CD-6.
           MOVE BW-CONTACT-DESC(1) TO QBW-CONTACT-DESC-1.
           MOVE BW-CONTACT-PHONE(1) TO QBW-CONTACT-PHONE-1.
           MOVE BW-CONTACT-EXT(1) TO QBW-CONTACT-EXT-1.
           MOVE BW-CONTACT-RELATION(1) TO QBW-CONTACT-RELATION-1.
           MOVE BW-CONTACT-DESC(2) TO QBW-CONTACT-DESC-2.
           MOVE BW-CONTACT-PHONE(2) TO QBW-CONTACT-PHONE-2.
           MOVE BW-CONTACT-EXT(2) TO QBW-CONTACT-EXT-2.
           MOVE BW-CONTACT-RELATION(2) TO QBW-CONTACT-RELATION-2.
           MOVE BW-CONTACT-DESC(3) TO QBW-CONTACT-DESC-3.
           MOVE BW-CONTACT-PHONE(3) TO QBW-CONTACT-PHONE-3.
           MOVE BW-CONTACT-EXT(3) TO QBW-CONTACT-EXT-3.
           MOVE BW-CONTACT-RELATION(3) TO QBW-CONTACT-RELATION-3.
           MOVE BW-CONTACT-DESC(4) TO QBW-CONTACT-DESC-4.
           MOVE BW-CONTACT-PHONE(4) TO QBW-CONTACT-PHONE-4.
           MOVE BW-CONTACT-EXT(4) TO QBW-CONTACT-EXT-4.
           MOVE BW-CONTACT-RELATION(4) TO QBW-CONTACT-RELATION-4.
           MOVE BW-CONTACT-DESC(5) TO QBW-CONTACT-DESC-5.
           MOVE BW-CONTACT-PHONE(5) TO QBW-CONTACT-PHONE-5.
           MOVE BW-CONTACT-EXT(5) TO QBW-CONTACT-EXT-5.
           MOVE BW-CONTACT-RELATION(5) TO QBW-CONTACT-RELATION-5.
           MOVE BW-CONTACT-DESC(6) TO QBW-CONTACT-DESC-6.
           MOVE BW-CONTACT-PHONE(6) TO QBW-CONTACT-PHONE-6.
           MOVE BW-CONTACT-EXT(6) TO QBW-CONTACT-EXT-6.
           MOVE BW-CONTACT-RELATION(6) TO QBW-CONTACT-RELATION-6.
           MOVE BW-CONTACT-DESC(7) TO QBW-CONTACT-DESC-7.
           MOVE BW-CONTACT-PHONE(7) TO QBW-CONTACT-PHONE-7.
           MOVE BW-CONTACT-EXT(7) TO QBW-CONTACT-EXT-7.
           MOVE BW-CONTACT-RELATION(7) TO QBW-CONTACT-RELATION-7.
           MOVE BW-CONTACT-DESC(8) TO QBW-CONTACT-DESC-8.
           MOVE BW-CONTACT-PHONE(8) TO QBW-CONTACT-PHONE-8.
           MOVE BW-CONTACT-EXT(8) TO QBW-CONTACT-EXT-8.
           MOVE BW-CONTACT-RELATION(8) TO QBW-CONTACT-RELATION-8.
           MOVE BW-CONTACT-DESC(9) TO QBW-CONTACT-DESC-9.
           MOVE BW-CONTACT-PHONE(9) TO QBW-CONTACT-PHONE-9.
           MOVE BW-CONTACT-EXT(9) TO QBW-CONTACT-EXT-9.
           MOVE BW-CONTACT-RELATION(9) TO QBW-CONTACT-RELATION-9.
           MOVE BW-CONTACT-DESC(10) TO QBW-CONTACT-DESC-10.
           MOVE BW-CONTACT-PHONE(10) TO QBW-CONTACT-PHONE-10.
           MOVE BW-CONTACT-EXT(10) TO QBW-CONTACT-EXT-10.
           MOVE BW-CONTACT-RELATION(10) TO QBW-CONTACT-RELATION-10.
           MOVE BW-SRCD TO QBW-SRCD.
           MOVE BW-CALL-ON-SUNDAY TO QBW-CALL-ON-SUNDAY.
           MOVE BW-SOLICIT TO QBW-SOLICIT.
           MOVE BW-CONFIDENTIAL TO QBW-CONFIDENTIAL.
           MOVE BW-PRIVACY-OPT-OUT TO QBW-PRIVACY-OPT-OUT.
           MOVE BW-OPT-IN-EMAIL TO QBW-OPT-IN-EMAIL.
           MOVE BW-OPT-IN-TEXT TO QBW-OPT-IN-TEXT.
           MOVE BW-CITY-TAX-CD TO QBW-CITY-TAX-CD.

           IF ( BW-DEALTRACK-CHG-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-DEALTRACK-CHG-DATE
           ELSE
              MOVE BW-DEALTRACK-CHG-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-DEALTRACK-CHG-DATE.

           MOVE BW-DECEASED TO QBW-DECEASED.

           IF ( BW-DECEASED-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-DECEASED-DATE
           ELSE
              MOVE BW-DECEASED-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-DECEASED-DATE.

           MOVE BW-EMAIL         TO QBW-EMAIL.
           MOVE BW-IDENT-NO      TO QBW-IDENT-NO.
           MOVE BW-IDENT-TYPE    TO QBW-IDENT-TYPE.
           MOVE BW-IDENT-STATE   TO QBW-IDENT-STATE.
           MOVE BW-MILITARY-FLAG TO QBW-MILITARY-FLAG.
           MOVE BW-ORGBR         TO QBW-ORGBR.
           IF ( BW-CEASE-DESIST-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-CEASE-DESIST-DATE
           ELSE
              MOVE BW-CEASE-DESIST-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-CEASE-DESIST-DATE.
           MOVE BW-CEASE-DESIST-TYPE TO QBW-CEASE-DESIST-TYPE.
           IF ( BW-UMC-EXPIRE-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-UMC-EXPIRE-DATE
           ELSE
              MOVE BW-UMC-EXPIRE-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-UMC-EXPIRE-DATE.
           IF ( BW-UMC-PR-EXPIRE-DATE = ZEROES )
              MOVE "1900-01-01" TO QBW-UMC-PR-EXPIRE-DATE
           ELSE
              MOVE BW-UMC-PR-EXPIRE-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBW-UMC-PR-EXPIRE-DATE.
 
      *    MOVE BW-VISION-KEY1   TO QBW-VISION-KEY1.
      *    MOVE BW-VISION-KEY2   TO QBW-VISION-KEY2.
      *    MOVE BW-VISION-KEY3   TO QBW-VISION-KEY3.
      *    MOVE BW-VISION-KEY4   TO QBW-VISION-KEY4.
      *================================================================*
      * END COPYBOOK: LIBLP\LPBWGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGL\GLGIGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGL/GLGIGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - GIFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0507 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD GI-REC FROM QGI-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-GI-FIELDS.
           MOVE QGI-BRANCH TO GI-BRANCH.
           MOVE QGI-CLASS TO GI-CLASS.

           IF ( QGI-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO GI-LTOUCH-DATE
           ELSE
              MOVE QGI-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO GI-LTOUCH-DATE.

           MOVE QGI-CASH TO GI-CASH.
           MOVE QGI-BANK TO GI-BANK.
           MOVE QGI-NSF TO GI-NSF.
           MOVE QGI-AR TO GI-AR.
           MOVE QGI-PL-1 TO GI-PL(1).
           MOVE QGI-PL-2 TO GI-PL(2).
           MOVE QGI-PL-3 TO GI-PL(3).
           MOVE QGI-PL-4 TO GI-PL(4).
           MOVE QGI-PL-5 TO GI-PL(5).
           MOVE QGI-DLINSREB TO GI-DLINSREB.
           MOVE QGI-ACR-INT-AR-AR TO GI-ACR-INT-AR-AR.
           MOVE QGI-OTHBR-REC TO GI-OTHBR-REC.
           MOVE QGI-OTHBR-PAY TO GI-OTHBR-PAY.
           MOVE QGI-UNINTCHG TO GI-UNINTCHG.
           MOVE QGI-UNADDON TO GI-UNADDON.
           MOVE QGI-UNSERCHG TO GI-UNSERCHG.
           MOVE QGI-UNMAINTFEE TO GI-UNMAINTFEE.
           MOVE QGI-UNDLDISC TO GI-UNDLDISC.
           MOVE QGI-UNOTHER TO GI-UNOTHER.
           MOVE QGI-UN7 TO GI-UN7.
           MOVE QGI-UN8 TO GI-UN8.
           MOVE QGI-UN9 TO GI-UN9.
           MOVE QGI-UN10 TO GI-UN10.
           MOVE QGI-UNCL1 TO GI-UNCL1.
           MOVE QGI-UNCL2 TO GI-UNCL2.
           MOVE QGI-UNAH TO GI-UNAH.
           MOVE QGI-UNPP TO GI-UNPP.
           MOVE QGI-UNO1 TO GI-UNO1.
           MOVE QGI-UNO2 TO GI-UNO2.
           MOVE QGI-UNO3 TO GI-UNO3.
           MOVE QGI-UNO4 TO GI-UNO4.
           MOVE QGI-UNO5 TO GI-UNO5.
           MOVE QGI-UNO6 TO GI-UNO6.
           MOVE QGI-UNO7 TO GI-UNO7.
           MOVE QGI-UNINTREPO TO GI-UNINTREPO.
           MOVE QGI-UNADDONINTREPO TO GI-UNADDONINTREPO.
           MOVE QGI-PLEXP-1 TO GI-PLEXP(1).
           MOVE QGI-PLEXP-2 TO GI-PLEXP(2).
           MOVE QGI-PLEXP-3 TO GI-PLEXP(3).
           MOVE QGI-PLEXP-4 TO GI-PLEXP(4).
           MOVE QGI-PLEXP-5 TO GI-PLEXP(5).
           MOVE QGI-DLPARVEX TO GI-DLPARVEX.
           MOVE QGI-PLOFFSET-1 TO GI-PLOFFSET(1).
           MOVE QGI-PLOFFSET-2 TO GI-PLOFFSET(2).
           MOVE QGI-PLOFFSET-3 TO GI-PLOFFSET(3).
           MOVE QGI-PLOFFSET-4 TO GI-PLOFFSET(4).
           MOVE QGI-PLOFFSET-5 TO GI-PLOFFSET(5).
           MOVE QGI-SERVOFF TO GI-SERVOFF.
           MOVE QGI-PAYCL1 TO GI-PAYCL1.
           MOVE QGI-PAYCL2 TO GI-PAYCL2.
           MOVE QGI-PAYAH TO GI-PAYAH.
           MOVE QGI-PAYPP TO GI-PAYPP.
           MOVE QGI-PAYO1 TO GI-PAYO1.
           MOVE QGI-PAYO2 TO GI-PAYO2.
           MOVE QGI-PAYO3 TO GI-PAYO3.
           MOVE QGI-PAYO4 TO GI-PAYO4.
           MOVE QGI-PAYO5 TO GI-PAYO5.
           MOVE QGI-PAYO6 TO GI-PAYO6.
           MOVE QGI-PAYO7 TO GI-PAYO7.
           MOVE QGI-DLPAYABLE TO GI-DLPAYABLE.
           MOVE QGI-DLRVPRIN-1 TO GI-DLRVPRIN(1).
           MOVE QGI-DLRVPRIN-2 TO GI-DLRVPRIN(2).
           MOVE QGI-DLRVPRIN-3 TO GI-DLRVPRIN(3).
           MOVE QGI-DLRVCHGS-1 TO GI-DLRVCHGS(1).
           MOVE QGI-DLRVCHGS-2 TO GI-DLRVCHGS(2).
           MOVE QGI-DLRVCHGS-3 TO GI-DLRVCHGS(3).
           MOVE QGI-DLPARV TO GI-DLPARV.
           MOVE QGI-PAYALLOT TO GI-PAYALLOT.
           MOVE QGI-DIRECT-PAY TO GI-DIRECT-PAY.
           MOVE QGI-ERINTCHG TO GI-ERINTCHG.
           MOVE QGI-ERADDON TO GI-ERADDON.
           MOVE QGI-ERSERCHG TO GI-ERSERCHG.
           MOVE QGI-ERMAINTFEE TO GI-ERMAINTFEE.
           MOVE QGI-ERDLDISC TO GI-ERDLDISC.
           MOVE QGI-EROTHER TO GI-EROTHER.
           MOVE QGI-EARN7 TO GI-EARN7.
           MOVE QGI-EARN8 TO GI-EARN8.
           MOVE QGI-EARN9 TO GI-EARN9.
           MOVE QGI-EARN10 TO GI-EARN10.
           MOVE QGI-LATECHG TO GI-LATECHG.
           MOVE QGI-INTEREST TO GI-INTEREST.
           MOVE QGI-DEFERMENTS TO GI-DEFERMENTS.
           MOVE QGI-SAPRINCIPAL TO GI-SAPRINCIPAL.
           MOVE QGI-PLINT-1 TO GI-PLINT(1).
           MOVE QGI-PLINT-2 TO GI-PLINT(2).
           MOVE QGI-PLINT-3 TO GI-PLINT(3).
           MOVE QGI-PLINT-4 TO GI-PLINT(4).
           MOVE QGI-PLINT-5 TO GI-PLINT(5).
           MOVE QGI-PLREC-1 TO GI-PLREC(1).
           MOVE QGI-PLREC-2 TO GI-PLREC(2).
           MOVE QGI-PLREC-3 TO GI-PLREC(3).
           MOVE QGI-PLREC-4 TO GI-PLREC(4).
           MOVE QGI-PLREC-5 TO GI-PLREC(5).
           MOVE QGI-CL1 TO GI-CL1.
           MOVE QGI-CL2 TO GI-CL2.
           MOVE QGI-AH TO GI-AH.
           MOVE QGI-PP TO GI-PP.
           MOVE QGI-O1 TO GI-O1.
           MOVE QGI-O2 TO GI-O2.
           MOVE QGI-O3 TO GI-O3.
           MOVE QGI-O4 TO GI-O4.
           MOVE QGI-O5 TO GI-O5.
           MOVE QGI-O6 TO GI-O6.
           MOVE QGI-O7 TO GI-O7.
           MOVE QGI-PLNEW-AR-1 TO GI-PLNEW-AR(1).
           MOVE QGI-PLNEW-AR-2 TO GI-PLNEW-AR(2).
           MOVE QGI-PLNEW-AR-3 TO GI-PLNEW-AR(3).
           MOVE QGI-PLNEW-AR-4 TO GI-PLNEW-AR(4).
           MOVE QGI-PLNEW-AR-5 TO GI-PLNEW-AR(5).
           MOVE QGI-REPO-AR TO GI-REPO-AR.
           MOVE QGI-REPO-INT TO GI-REPO-INT.
           MOVE QGI-ACR-INT-AR TO GI-ACR-INT-AR.
           MOVE QGI-CONV-OFFSET TO GI-CONV-OFFSET.
           MOVE QGI-PARTIAL-PLEXP TO GI-PARTIAL-PLEXP.
           MOVE QGI-PAYLBOX TO GI-PAYLBOX.
           MOVE QGI-PENALTY-INT TO GI-PENALTY-INT.
           MOVE QGI-PAYTPAY TO GI-PAYTPAY.
           MOVE QGI-PAYTCOLL TO GI-PAYTCOLL.
           MOVE QGI-PAYMGRAM TO GI-PAYMGRAM.
           MOVE QGI-REPO-ADDON-EXP TO GI-REPO-ADDON-EXP.
           MOVE QGI-ACH-BANK TO GI-ACH-BANK.
           MOVE QGI-LN-APPROVAL-LIMIT TO GI-LN-APPROVAL-LIMIT.
 
      *-----------------------------------------------------------------
      *    LOAD QGI-REC FROM GI-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-GI-FIELDS.
           MOVE GI-BRANCH TO QGI-BRANCH.
           MOVE GI-CLASS TO QGI-CLASS.

           IF ( GI-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QGI-LTOUCH-DATE
           ELSE
              MOVE GI-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QGI-LTOUCH-DATE.

           MOVE GI-CASH TO QGI-CASH.
           MOVE GI-BANK TO QGI-BANK.
           MOVE GI-NSF TO QGI-NSF.
           MOVE GI-AR TO QGI-AR.
           MOVE GI-PL(1) TO QGI-PL-1.
           MOVE GI-PL(2) TO QGI-PL-2.
           MOVE GI-PL(3) TO QGI-PL-3.
           MOVE GI-PL(4) TO QGI-PL-4.
           MOVE GI-PL(5) TO QGI-PL-5.
           MOVE GI-DLINSREB TO QGI-DLINSREB.
           MOVE GI-ACR-INT-AR-AR TO QGI-ACR-INT-AR-AR.
           MOVE GI-OTHBR-REC TO QGI-OTHBR-REC.
           MOVE GI-OTHBR-PAY TO QGI-OTHBR-PAY.
           MOVE GI-UNINTCHG TO QGI-UNINTCHG.
           MOVE GI-UNADDON TO QGI-UNADDON.
           MOVE GI-UNSERCHG TO QGI-UNSERCHG.
           MOVE GI-UNMAINTFEE TO QGI-UNMAINTFEE.
           MOVE GI-UNDLDISC TO QGI-UNDLDISC.
           MOVE GI-UNOTHER TO QGI-UNOTHER.
           MOVE GI-UN7 TO QGI-UN7.
           MOVE GI-UN8 TO QGI-UN8.
           MOVE GI-UN9 TO QGI-UN9.
           MOVE GI-UN10 TO QGI-UN10.
           MOVE GI-UNCL1 TO QGI-UNCL1.
           MOVE GI-UNCL2 TO QGI-UNCL2.
           MOVE GI-UNAH TO QGI-UNAH.
           MOVE GI-UNPP TO QGI-UNPP.
           MOVE GI-UNO1 TO QGI-UNO1.
           MOVE GI-UNO2 TO QGI-UNO2.
           MOVE GI-UNO3 TO QGI-UNO3.
           MOVE GI-UNO4 TO QGI-UNO4.
           MOVE GI-UNO5 TO QGI-UNO5.
           MOVE GI-UNO6 TO QGI-UNO6.
           MOVE GI-UNO7 TO QGI-UNO7.
           MOVE GI-UNINTREPO TO QGI-UNINTREPO.
           MOVE GI-UNADDONINTREPO TO QGI-UNADDONINTREPO.
           MOVE GI-PLEXP(1) TO QGI-PLEXP-1.
           MOVE GI-PLEXP(2) TO QGI-PLEXP-2.
           MOVE GI-PLEXP(3) TO QGI-PLEXP-3.
           MOVE GI-PLEXP(4) TO QGI-PLEXP-4.
           MOVE GI-PLEXP(5) TO QGI-PLEXP-5.
           MOVE GI-DLPARVEX TO QGI-DLPARVEX.
           MOVE GI-PLOFFSET(1) TO QGI-PLOFFSET-1.
           MOVE GI-PLOFFSET(2) TO QGI-PLOFFSET-2.
           MOVE GI-PLOFFSET(3) TO QGI-PLOFFSET-3.
           MOVE GI-PLOFFSET(4) TO QGI-PLOFFSET-4.
           MOVE GI-PLOFFSET(5) TO QGI-PLOFFSET-5.
           MOVE GI-SERVOFF TO QGI-SERVOFF.
           MOVE GI-PAYCL1 TO QGI-PAYCL1.
           MOVE GI-PAYCL2 TO QGI-PAYCL2.
           MOVE GI-PAYAH TO QGI-PAYAH.
           MOVE GI-PAYPP TO QGI-PAYPP.
           MOVE GI-PAYO1 TO QGI-PAYO1.
           MOVE GI-PAYO2 TO QGI-PAYO2.
           MOVE GI-PAYO3 TO QGI-PAYO3.
           MOVE GI-PAYO4 TO QGI-PAYO4.
           MOVE GI-PAYO5 TO QGI-PAYO5.
           MOVE GI-PAYO6 TO QGI-PAYO6.
           MOVE GI-PAYO7 TO QGI-PAYO7.
           MOVE GI-DLPAYABLE TO QGI-DLPAYABLE.
           MOVE GI-DLRVPRIN(1) TO QGI-DLRVPRIN-1.
           MOVE GI-DLRVPRIN(2) TO QGI-DLRVPRIN-2.
           MOVE GI-DLRVPRIN(3) TO QGI-DLRVPRIN-3.
           MOVE GI-DLRVCHGS(1) TO QGI-DLRVCHGS-1.
           MOVE GI-DLRVCHGS(2) TO QGI-DLRVCHGS-2.
           MOVE GI-DLRVCHGS(3) TO QGI-DLRVCHGS-3.
           MOVE GI-DLPARV TO QGI-DLPARV.
           MOVE GI-PAYALLOT TO QGI-PAYALLOT.
           MOVE GI-DIRECT-PAY TO QGI-DIRECT-PAY.
           MOVE GI-ERINTCHG TO QGI-ERINTCHG.
           MOVE GI-ERADDON TO QGI-ERADDON.
           MOVE GI-ERSERCHG TO QGI-ERSERCHG.
           MOVE GI-ERMAINTFEE TO QGI-ERMAINTFEE.
           MOVE GI-ERDLDISC TO QGI-ERDLDISC.
           MOVE GI-EROTHER TO QGI-EROTHER.
           MOVE GI-EARN7 TO QGI-EARN7.
           MOVE GI-EARN8 TO QGI-EARN8.
           MOVE GI-EARN9 TO QGI-EARN9.
           MOVE GI-EARN10 TO QGI-EARN10.
           MOVE GI-LATECHG TO QGI-LATECHG.
           MOVE GI-INTEREST TO QGI-INTEREST.
           MOVE GI-DEFERMENTS TO QGI-DEFERMENTS.
           MOVE GI-SAPRINCIPAL TO QGI-SAPRINCIPAL.
           MOVE GI-PLINT(1) TO QGI-PLINT-1.
           MOVE GI-PLINT(2) TO QGI-PLINT-2.
           MOVE GI-PLINT(3) TO QGI-PLINT-3.
           MOVE GI-PLINT(4) TO QGI-PLINT-4.
           MOVE GI-PLINT(5) TO QGI-PLINT-5.
           MOVE GI-PLREC(1) TO QGI-PLREC-1.
           MOVE GI-PLREC(2) TO QGI-PLREC-2.
           MOVE GI-PLREC(3) TO QGI-PLREC-3.
           MOVE GI-PLREC(4) TO QGI-PLREC-4.
           MOVE GI-PLREC(5) TO QGI-PLREC-5.
           MOVE GI-CL1 TO QGI-CL1.
           MOVE GI-CL2 TO QGI-CL2.
           MOVE GI-AH TO QGI-AH.
           MOVE GI-PP TO QGI-PP.
           MOVE GI-O1 TO QGI-O1.
           MOVE GI-O2 TO QGI-O2.
           MOVE GI-O3 TO QGI-O3.
           MOVE GI-O4 TO QGI-O4.
           MOVE GI-O5 TO QGI-O5.
           MOVE GI-O6 TO QGI-O6.
           MOVE GI-O7 TO QGI-O7.
           MOVE GI-PLNEW-AR(1) TO QGI-PLNEW-AR-1.
           MOVE GI-PLNEW-AR(2) TO QGI-PLNEW-AR-2.
           MOVE GI-PLNEW-AR(3) TO QGI-PLNEW-AR-3.
           MOVE GI-PLNEW-AR(4) TO QGI-PLNEW-AR-4.
           MOVE GI-PLNEW-AR(5) TO QGI-PLNEW-AR-5.
           MOVE GI-REPO-AR TO QGI-REPO-AR.
           MOVE GI-REPO-INT TO QGI-REPO-INT.
           MOVE GI-ACR-INT-AR TO QGI-ACR-INT-AR.
           MOVE GI-CONV-OFFSET TO QGI-CONV-OFFSET.
           MOVE GI-PARTIAL-PLEXP TO QGI-PARTIAL-PLEXP.
           MOVE GI-PAYLBOX TO QGI-PAYLBOX.
           MOVE GI-PENALTY-INT TO QGI-PENALTY-INT.
           MOVE GI-PAYTPAY TO QGI-PAYTPAY.
           MOVE GI-PAYTCOLL TO QGI-PAYTCOLL.
           MOVE GI-PAYMGRAM TO QGI-PAYMGRAM.
           MOVE GI-REPO-ADDON-EXP TO QGI-REPO-ADDON-EXP.
           MOVE GI-ACH-BANK TO QGI-ACH-BANK.
           MOVE GI-LN-APPROVAL-LIMIT TO QGI-LN-APPROVAL-LIMIT.
 
      *================================================================*
      * END COPYBOOK: LIBGL\GLGIGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBRCGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBRCGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - RCFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      * BAH 2025.0410 RC-UPDATED-USERID WAS BEING TESTED AS A DATE S35Q-198
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD RC-REC FROM QRC-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-RC-FIELDS.
           MOVE QRC-STATUS TO RC-STATUS.
           MOVE QRC-BRNO TO RC-BRNO.

           IF ( QRC-TRANS-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-TRANS-DATE
           ELSE
              MOVE QRC-TRANS-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-TRANS-DATE.


           IF ( QRC-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-LTOUCH-DATE
           ELSE
              MOVE QRC-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-LTOUCH-DATE.

           MOVE QRC-RECAP-FG TO RC-RECAP-FG.
           MOVE QRC-GL-FG TO RC-GL-FG.
           MOVE QRC-EOD-BATCH-FG TO RC-EOD-BATCH-FG.
           MOVE QRC-NIGHTLY-FUNDS-FG TO RC-NIGHTLY-FUNDS-FG.
           MOVE QRC-EOM1-BATCH-FG TO RC-EOM1-BATCH-FG.
           MOVE QRC-EOM-UPDATE-FG TO RC-EOM-UPDATE-FG.
           MOVE QRC-EOM2-BATCH-FG TO RC-EOM2-BATCH-FG.
           MOVE QRC-BS-P2P3-INBAL-FG TO RC-BS-P2P3-INBAL-FG.
           MOVE QRC-DEPOSIT TO RC-DEPOSIT.
           MOVE QRC-OVER-SHORT TO RC-OVER-SHORT.
           MOVE QRC-CHECKS TO RC-CHECKS.

           IF ( QRC-OPENED-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-OPENED-DATE
           ELSE
              MOVE QRC-OPENED-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-OPENED-DATE.

           MOVE QRC-OPENED-TIME TO RC-OPENED-TIME.
           MOVE QRC-OP-USERID TO RC-OP-USERID.

           IF ( QRC-CLOSED-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-CLOSED-DATE
           ELSE
              MOVE QRC-CLOSED-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-CLOSED-DATE.

           MOVE QRC-CLOSED-TIME TO RC-CLOSED-TIME.
           MOVE QRC-CL-USERID TO RC-CL-USERID.

           IF ( QRC-UPDATED-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-UPDATED-DATE
           ELSE
              MOVE QRC-UPDATED-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-UPDATED-DATE.

           MOVE QRC-UPDATED-TIME   TO RC-UPDATED-TIME.
           MOVE QRC-UPDATED-USERID TO RC-UPDATED-USERID.

           IF ( QRC-EOD-BATCH-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-EOD-BATCH-DATE
           ELSE
              MOVE QRC-EOD-BATCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-EOD-BATCH-DATE.

           MOVE QRC-EOD-BATCH-TIME TO RC-EOD-BATCH-TIME.

           IF ( QRC-FUNDS-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-FUNDS-DATE
           ELSE
              MOVE QRC-FUNDS-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-FUNDS-DATE.

           MOVE QRC-FUNDS-TIME TO RC-FUNDS-TIME.

           IF ( QRC-EARNINGS-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-EARNINGS-DATE
           ELSE
              MOVE QRC-EARNINGS-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-EARNINGS-DATE.

           MOVE QRC-EARNINGS-TIME TO RC-EARNINGS-TIME.

           IF ( QRC-EOM-UPDATED-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-EOM-UPDATED-DATE
           ELSE
              MOVE QRC-EOM-UPDATED-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-EOM-UPDATED-DATE.

           MOVE QRC-EOM-UPDATED-TIME TO RC-EOM-UPDATED-TIME.

           IF ( QRC-EOM2-BATCH-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-EOM2-BATCH-DATE
           ELSE
              MOVE QRC-EOM2-BATCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-EOM2-BATCH-DATE.

           MOVE QRC-EOM2-BATCH-TIME TO RC-EOM2-BATCH-TIME.

           IF ( QRC-CHECK-DATE = "1900-01-01" )
              MOVE ZEROES TO RC-CHECK-DATE
           ELSE
              MOVE QRC-CHECK-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RC-CHECK-DATE.

           MOVE QRC-CHECK-TIME TO RC-CHECK-TIME.
           MOVE QRC-LAST-ACCRUE TO RC-LAST-ACCRUE.
           MOVE QRC-ERROR-MSG TO RC-ERROR-MSG.
           MOVE QRC-BANK-BAL TO RC-BANK-BAL.
           MOVE QRC-CHECK-DEPOSIT TO RC-CHECK-DEPOSIT.
 
      *-----------------------------------------------------------------
      *    LOAD QRC-REC FROM RC-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-RC-FIELDS.
           MOVE RC-STATUS TO QRC-STATUS.
           MOVE RC-BRNO TO QRC-BRNO.

           IF ( RC-TRANS-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-TRANS-DATE
           ELSE
              MOVE RC-TRANS-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-TRANS-DATE.


           IF ( RC-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-LTOUCH-DATE
           ELSE
              MOVE RC-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-LTOUCH-DATE.

           MOVE RC-RECAP-FG TO QRC-RECAP-FG.
           MOVE RC-GL-FG TO QRC-GL-FG.
           MOVE RC-EOD-BATCH-FG TO QRC-EOD-BATCH-FG.
           MOVE RC-NIGHTLY-FUNDS-FG TO QRC-NIGHTLY-FUNDS-FG.
           MOVE RC-EOM1-BATCH-FG TO QRC-EOM1-BATCH-FG.
           MOVE RC-EOM-UPDATE-FG TO QRC-EOM-UPDATE-FG.
           MOVE RC-EOM2-BATCH-FG TO QRC-EOM2-BATCH-FG.
           MOVE RC-BS-P2P3-INBAL-FG TO QRC-BS-P2P3-INBAL-FG.
           MOVE RC-DEPOSIT TO QRC-DEPOSIT.
           MOVE RC-OVER-SHORT TO QRC-OVER-SHORT.
           MOVE RC-CHECKS TO QRC-CHECKS.

           IF ( RC-OPENED-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-OPENED-DATE
           ELSE
              MOVE RC-OPENED-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-OPENED-DATE.

           MOVE RC-OPENED-TIME TO QRC-OPENED-TIME.
           MOVE RC-OP-USERID TO QRC-OP-USERID.

           IF ( RC-CLOSED-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-CLOSED-DATE
           ELSE
              MOVE RC-CLOSED-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-CLOSED-DATE.

           MOVE RC-CLOSED-TIME TO QRC-CLOSED-TIME.
           MOVE RC-CL-USERID TO QRC-CL-USERID.

           IF ( RC-UPDATED-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-UPDATED-DATE
           ELSE
              MOVE RC-UPDATED-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-UPDATED-DATE.

           MOVE RC-UPDATED-TIME   TO QRC-UPDATED-TIME.
           MOVE RC-UPDATED-USERID TO QRC-UPDATED-USERID.

           IF ( RC-EOD-BATCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-EOD-BATCH-DATE
           ELSE
              MOVE RC-EOD-BATCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-EOD-BATCH-DATE.

           MOVE RC-EOD-BATCH-TIME TO QRC-EOD-BATCH-TIME.

           IF ( RC-FUNDS-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-FUNDS-DATE
           ELSE
              MOVE RC-FUNDS-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-FUNDS-DATE.

           MOVE RC-FUNDS-TIME TO QRC-FUNDS-TIME.

           IF ( RC-EARNINGS-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-EARNINGS-DATE
           ELSE
              MOVE RC-EARNINGS-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-EARNINGS-DATE.

           MOVE RC-EARNINGS-TIME TO QRC-EARNINGS-TIME.

           IF ( RC-EOM-UPDATED-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-EOM-UPDATED-DATE
           ELSE
              MOVE RC-EOM-UPDATED-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-EOM-UPDATED-DATE.

           MOVE RC-EOM-UPDATED-TIME TO QRC-EOM-UPDATED-TIME.

           IF ( RC-EOM2-BATCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-EOM2-BATCH-DATE
           ELSE
              MOVE RC-EOM2-BATCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-EOM2-BATCH-DATE.

           MOVE RC-EOM2-BATCH-TIME TO QRC-EOM2-BATCH-TIME.

           IF ( RC-CHECK-DATE = ZEROES )
              MOVE "1900-01-01" TO QRC-CHECK-DATE
           ELSE
              MOVE RC-CHECK-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRC-CHECK-DATE.

           MOVE RC-CHECK-TIME TO QRC-CHECK-TIME.
           MOVE RC-LAST-ACCRUE TO QRC-LAST-ACCRUE.
           MOVE RC-ERROR-MSG TO QRC-ERROR-MSG.
           MOVE RC-BANK-BAL TO QRC-BANK-BAL.
           MOVE RC-CHECK-DEPOSIT TO QRC-CHECK-DEPOSIT.
 
      *================================================================*
      * END COPYBOOK: LIBGB\GBRCGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBBRGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBBRGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - BRFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0507 ***NEW***
      * BAH 20220923 ADDED QBR-VERITEC-LICENSE #1570
      * BAH 20230419 ADDED QBR-TEST-PP-AUTO-INSCOVR #1594A
      * BAH 20230713 ADDED BR-USE-NEW-WFARGO-ACCT #1616
      * BAH 20230801 ADDED BR-BRANCH-CLOSED #1618
      * BAH 20231113 ADDED QBR-ALLOW-F3-ALL-DOCS #1630
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD BR-REC FROM QBR-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-BR-FIELDS.
           MOVE QBR-NO TO BR-NO.

           IF ( QBR-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO BR-LTOUCH-DATE
           ELSE
              MOVE QBR-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO BR-LTOUCH-DATE.

           MOVE QBR-NAME TO BR-NAME.
           MOVE QBR-ADR1 TO BR-ADR1.
           MOVE QBR-ADR2 TO BR-ADR2.
           MOVE QBR-CITY TO BR-CITY.
           MOVE QBR-STATE TO BR-STATE.
           MOVE QBR-ZIP TO BR-ZIP.
           MOVE QBR-PHONE TO BR-PHONE.
           MOVE QBR-RETAIN TO BR-RETAIN.
           MOVE QBR-NEXT-CHECK TO BR-NEXT-CHECK.
           MOVE QBR-PRINTER-1 TO BR-PRINTER(1).
           MOVE QBR-PRINTER-2 TO BR-PRINTER(2).
           MOVE QBR-PRINTER-3 TO BR-PRINTER(3).
           MOVE QBR-PRINTER-4 TO BR-PRINTER(4).
           MOVE QBR-FEE-GL-BRNO TO BR-FEE-GL-BRNO.
           MOVE QBR-REMIT1 TO BR-REMIT1.
           MOVE QBR-REMIT2 TO BR-REMIT2.
           MOVE QBR-REMIT3 TO BR-REMIT3.
           MOVE QBR-STMNT1 TO BR-STMNT1.
           MOVE QBR-STMNT2 TO BR-STMNT2.
           MOVE QBR-INS-PRODUCER-NUM TO BR-INS-PRODUCER-NUM.
           MOVE QBR-DLRCHK TO BR-DLRCHK.
           MOVE QBR-FRONT-END-FG TO BR-FRONT-END-FG.
           MOVE QBR-EMLNRG-PHONE TO BR-EMLNRG-PHONE.
           MOVE QBR-POST-GL TO BR-POST-GL.
           MOVE QBR-ALLOTMNTS TO BR-ALLOTMNTS.
           MOVE QBR-EXTRACT-AUTO-UPD TO BR-EXTRACT-AUTO-UPD.
           MOVE QBR-PCNI-LEDGER TO BR-PCNI-LEDGER.
           MOVE QBR-PRINTERFG-1 TO BR-PRINTERFG(1).
           MOVE QBR-PRINTERFG-2 TO BR-PRINTERFG(2).
           MOVE QBR-PRINTERFG-3 TO BR-PRINTERFG(3).
           MOVE QBR-PRINTERFG-4 TO BR-PRINTERFG(4).
           MOVE QBR-NEGDLRSV TO BR-NEGDLRSV.
           MOVE QBR-CPCORP-ORDER TO BR-CPCORP-ORDER.
           MOVE QBR-PRIO-MEMO-FLAG TO BR-PRIO-MEMO-FLAG.
           MOVE QBR-PREBILL-PL-JD-OPT TO BR-PREBILL-PL-JD-OPT.
           MOVE QBR-LOAN-NUM-FLAG TO BR-LOAN-NUM-FLAG.
           MOVE QBR-DOWNPY-FLAG TO BR-DOWNPY-FLAG.
           MOVE QBR-AUTO-INS-EARN TO BR-AUTO-INS-EARN.
           MOVE QBR-OTH-INS-LEVELS TO BR-OTH-INS-LEVELS.
           MOVE QBR-ALLOW-INTERBR TO BR-ALLOW-INTERBR.
           MOVE QBR-UNER-DLANRP TO BR-UNER-DLANRP.
           MOVE QBR-SECOND-PROMISE TO BR-SECOND-PROMISE.
           MOVE QBR-AVAIL-CREDIT TO BR-AVAIL-CREDIT.
           MOVE QBR-RECP1 TO BR-RECP1.
           MOVE QBR-RECP2 TO BR-RECP2.
           MOVE QBR-INC-WAIVERS TO BR-INC-WAIVERS.
           MOVE QBR-INC-INS TO BR-INC-INS.
           MOVE QBR-BP-NEXT-BATCH TO BR-BP-NEXT-BATCH.
           MOVE QBR-BP-NOPAYOFF TO BR-BP-NOPAYOFF.
           MOVE QBR-BP-ODDPAY TO BR-BP-ODDPAY.
           MOVE QBR-BP-LC TO BR-BP-LC.
           MOVE QBR-BP-NOPRIN TO BR-BP-NOPRIN.
           MOVE QBR-BP-FLASH TO BR-BP-FLASH.
           MOVE QBR-BP-ACTIONCD TO BR-BP-ACTIONCD.
           MOVE QBR-BP-MAXCON TO BR-BP-MAXCON.
           MOVE QBR-BP-MAXREC TO BR-BP-MAXREC.
           MOVE QBR-BP-PL TO BR-BP-PL.
           MOVE QBR-BP-JD TO BR-BP-JD.
           MOVE QBR-BP-BRANCH TO BR-BP-BRANCH.
           MOVE QBR-AGE-ERN TO BR-AGE-ERN.
           MOVE QBR-OTHER-BRANCH-GL TO BR-OTHER-BRANCH-GL.
           MOVE QBR-SALES-SMALL TO BR-SALES-SMALL.
           MOVE QBR-NEW-COLL-INQUIRY TO BR-NEW-COLL-INQUIRY.
           MOVE QBR-CHANGE-MEMO TO BR-CHANGE-MEMO.
           MOVE QBR-INS-ADDON TO BR-INS-ADDON.
           MOVE QBR-TRAILER-REC TO BR-TRAILER-REC.
           MOVE QBR-ALDEL-FLAG TO BR-ALDEL-FLAG.
           MOVE QBR-IB-LCHG-MESS TO BR-IB-LCHG-MESS.
           MOVE QBR-COL-QUEUE-PAST-DUE TO BR-COL-QUEUE-PAST-DUE.
           MOVE QBR-LI-DLCOMM-CMSI-PP-MAX TO BR-LI-DLCOMM-CMSI-PP-MAX.
           MOVE QBR-ADDON-FEECD-O2-1 TO BR-ADDON-FEECD-O2(1).
           MOVE QBR-ADDON-FEECD-O2-2 TO BR-ADDON-FEECD-O2(2).
           MOVE QBR-AUTO-CHECK TO BR-AUTO-CHECK.
           MOVE QBR-RECEIPT-PROMDATE TO BR-RECEIPT-PROMDATE.
           MOVE QBR-RECEIPT-INTPD TO BR-RECEIPT-INTPD.
           MOVE QBR-COLL-ID-SCAN TO BR-COLL-ID-SCAN.
           MOVE QBR-STOP-ON-COLL TO BR-STOP-ON-COLL.
           MOVE QBR-DUEDATE-CHANGE-CD TO BR-DUEDATE-CHANGE-CD.
           MOVE QBR-CHECK-EOM-FG TO BR-CHECK-EOM-FG.
           MOVE QBR-VOLUME-DLANRP TO BR-VOLUME-DLANRP.
           MOVE QBR-PDTH-NXDUE TO BR-PDTH-NXDUE.
           MOVE QBR-LC-CODE TO BR-LC-CODE.
           MOVE QBR-VALIDATE-PRUS TO BR-VALIDATE-PRUS.
           MOVE QBR-AUTO-OPEN-BAL TO BR-AUTO-OPEN-BAL.
           MOVE QBR-OPEN-BAL-1 TO BR-OPEN-BAL(1).
           MOVE QBR-OPEN-BAL-2 TO BR-OPEN-BAL(2).
           MOVE QBR-OPEN-BAL-3 TO BR-OPEN-BAL(3).
           MOVE QBR-OPEN-BAL-4 TO BR-OPEN-BAL(4).
           MOVE QBR-OPEN-BAL-5 TO BR-OPEN-BAL(5).
           MOVE QBR-OPEN-BAL-6 TO BR-OPEN-BAL(6).
           MOVE QBR-OPEN-BAL-7 TO BR-OPEN-BAL(7).
           MOVE QBR-OPEN-BAL-8 TO BR-OPEN-BAL(8).
           MOVE QBR-OPEN-BAL-9 TO BR-OPEN-BAL(9).
           MOVE QBR-OPEN-BAL-10 TO BR-OPEN-BAL(10).
           MOVE QBR-OPEN-BAL-11 TO BR-OPEN-BAL(11).
           MOVE QBR-OPEN-BAL-12 TO BR-OPEN-BAL(12).
           MOVE QBR-OPEN-BAL-13 TO BR-OPEN-BAL(13).
           MOVE QBR-OPEN-BAL-14 TO BR-OPEN-BAL(14).
           MOVE QBR-OPEN-BAL-15 TO BR-OPEN-BAL(15).
           MOVE QBR-OPEN-BAL-16 TO BR-OPEN-BAL(16).
           MOVE QBR-OPEN-BAL-17 TO BR-OPEN-BAL(17).
           MOVE QBR-OPEN-BAL-18 TO BR-OPEN-BAL(18).
           MOVE QBR-OPEN-BAL-19 TO BR-OPEN-BAL(19).
           MOVE QBR-OPEN-BAL-20 TO BR-OPEN-BAL(20).
           MOVE QBR-TENDER-CD-1 TO BR-TENDER-CD(1).
           MOVE QBR-TENDER-CD-2 TO BR-TENDER-CD(2).
           MOVE QBR-TENDER-CD-3 TO BR-TENDER-CD(3).
           MOVE QBR-DLPARV-ADJ-FG TO BR-DLPARV-ADJ-FG.
           MOVE QBR-OVERRIDE-BR-STATE TO BR-OVERRIDE-BR-STATE.
           MOVE QBR-DEFAULT-SC-CLASS TO BR-DEFAULT-SC-CLASS.
           MOVE QBR-RECDEL-NOT-REC TO BR-RECDEL-NOT-REC.
           MOVE QBR-POST-AHEAD-FG TO BR-POST-AHEAD-FG.
           MOVE QBR-CAN-LOANS-FG TO BR-CAN-LOANS-FG.
           MOVE QBR-NON-MONTHLY-CAN-LOANS TO BR-NON-MONTHLY-CAN-LOANS.
           MOVE QBR-BP-ALLOW-PMT-ACCT-OTHBAL
              TO BR-BP-ALLOW-PMT-ACCT-OTHBAL.
           MOVE QBR-LBOX-ALLOW-PMT-ACCT-OTHBAL
              TO BR-LBOX-ALLOW-PMT-ACCT-OTHBAL.
           MOVE QBR-REGION-NUMBER TO BR-REGION-NUMBER.
           MOVE QBR-OUR-FEE TO BR-OUR-FEE.
           MOVE QBR-REB-METHOD-1 TO BR-REB-METHOD(1).
           MOVE QBR-REB-METHOD-2 TO BR-REB-METHOD(2).
           MOVE QBR-REB-METHOD-3 TO BR-REB-METHOD(3).
           MOVE QBR-REB-METHOD-4 TO BR-REB-METHOD(4).
           MOVE QBR-REB-METHOD-5 TO BR-REB-METHOD(5).
           MOVE QBR-REB-METHOD-6 TO BR-REB-METHOD(6).
           MOVE QBR-REB-METHOD-7 TO BR-REB-METHOD(7).
           MOVE QBR-REB-METHOD-8 TO BR-REB-METHOD(8).
           MOVE QBR-REB-METHOD-9 TO BR-REB-METHOD(9).
           MOVE QBR-REB-METHOD-10 TO BR-REB-METHOD(10).
           MOVE QBR-REB-METHOD-11 TO BR-REB-METHOD(11).
           MOVE QBR-REBDAYS-MONTH-1 TO BR-REBDAYS-MONTH(1).
           MOVE QBR-REBDAYS-MONTH-2 TO BR-REBDAYS-MONTH(2).
           MOVE QBR-REBDAYS-MONTH-3 TO BR-REBDAYS-MONTH(3).
           MOVE QBR-REBDAYS-MONTH-4 TO BR-REBDAYS-MONTH(4).
           MOVE QBR-REBDAYS-MONTH-5 TO BR-REBDAYS-MONTH(5).
           MOVE QBR-REBDAYS-MONTH-6 TO BR-REBDAYS-MONTH(6).
           MOVE QBR-REBDAYS-MONTH-7 TO BR-REBDAYS-MONTH(7).
           MOVE QBR-REBDAYS-MONTH-8 TO BR-REBDAYS-MONTH(8).
           MOVE QBR-REBDAYS-MONTH-9 TO BR-REBDAYS-MONTH(9).
           MOVE QBR-REBDAYS-MONTH-10 TO BR-REBDAYS-MONTH(10).
           MOVE QBR-REBDAYS-MONTH-11 TO BR-REBDAYS-MONTH(11).
           MOVE QBR-ACCRUAL-MONTHS-1 TO BR-ACCRUAL-MONTHS(1).
           MOVE QBR-ACCRUAL-MONTHS-2 TO BR-ACCRUAL-MONTHS(2).
           MOVE QBR-ACCRUAL-MONTHS-3 TO BR-ACCRUAL-MONTHS(3).
           MOVE QBR-ACCRUAL-MONTHS-4 TO BR-ACCRUAL-MONTHS(4).
           MOVE QBR-ACCRUAL-MONTHS-5 TO BR-ACCRUAL-MONTHS(5).
           MOVE QBR-ACCRUAL-MONTHS-6 TO BR-ACCRUAL-MONTHS(6).
           MOVE QBR-ACCRUAL-MONTHS-7 TO BR-ACCRUAL-MONTHS(7).
           MOVE QBR-ACCRUAL-MONTHS-8 TO BR-ACCRUAL-MONTHS(8).
           MOVE QBR-ACCRUAL-MONTHS-9 TO BR-ACCRUAL-MONTHS(9).
           MOVE QBR-ACCRUAL-MONTHS-10 TO BR-ACCRUAL-MONTHS(10).
           MOVE QBR-ACCRUAL-MONTHS-11 TO BR-ACCRUAL-MONTHS(11).
           MOVE QBR-GLOVERSHORT TO BR-GLOVERSHORT.
           MOVE QBR-GLBANK TO BR-GLBANK.
           MOVE QBR-GLONHAND TO BR-GLONHAND.
           MOVE QBR-BANKBAL TO BR-BANKBAL.
           MOVE QBR-RETAIN-AMT TO BR-RETAIN-AMT.
           MOVE QBR-LCARDFG TO BR-LCARDFG.
           MOVE QBR-DATA-PATH TO BR-DATA-PATH.
           MOVE QBR-MACHINE TO BR-MACHINE.
           MOVE QBR-MANAGER TO BR-MANAGER.
           MOVE QBR-EOD-PROCEDURE TO BR-EOD-PROCEDURE.
           MOVE QBR-BP-PAYOFF-NONCASH TO BR-BP-PAYOFF-NONCASH.
           MOVE QBR-BP-PAYOFF-OV TO BR-BP-PAYOFF-OV.
           MOVE QBR-LI-DLCOMM-CMSI-O3-MAX TO BR-LI-DLCOMM-CMSI-O3-MAX.
           MOVE QBR-LR-GROUP-COLLID TO BR-LR-GROUP-COLLID.
           MOVE QBR-UNITPER-FG TO BR-UNITPER-FG.
           MOVE QBR-UNITPER-Y-D-FG TO BR-UNITPER-Y-D-FG.
           MOVE QBR-NO-PROMPT-FOR-OTHBR TO BR-NO-PROMPT-FOR-OTHBR.
           MOVE QBR-WORLD-BRANCH-TYPE TO BR-WORLD-BRANCH-TYPE.
           MOVE QBR-COL-QUEUE-BEHAVIOR-FG TO BR-COL-QUEUE-BEHAVIOR-FG.
           MOVE QBR-CONVERT-AUTO-ACCTNO TO BR-CONVERT-AUTO-ACCTNO.
           MOVE QBR-TS-REPO-INS-FG TO BR-TS-REPO-INS-FG.
           MOVE QBR-BOOK-SF-BR-ONLY TO BR-BOOK-SF-BR-ONLY.
           MOVE QBR-FORCE-VALID-CITY-COUNTY
              TO BR-FORCE-VALID-CITY-COUNTY.
           MOVE QBR-SET-COLLCD-DL-MFGCD TO BR-SET-COLLCD-DL-MFGCD.
           MOVE QBR-DEFAULT-SF-UNITPER-CD TO BR-DEFAULT-SF-UNITPER-CD.
           MOVE QBR-DEFAULT-SF-PURCD TO BR-DEFAULT-SF-PURCD.
           MOVE QBR-DEFAULT-LN-UNITPER-CD TO BR-DEFAULT-LN-UNITPER-CD.
           MOVE QBR-DEFAULT-LN-PURCD TO BR-DEFAULT-LN-PURCD.
           MOVE QBR-TAP-OTHER-DL TO BR-TAP-OTHER-DL.
           MOVE QBR-AH-AND-CL TO BR-AH-AND-CL.
           MOVE QBR-NO-CASH-PROCEEDS TO BR-NO-CASH-PROCEEDS.
           MOVE QBR-RI-BEFORE-REPO TO BR-RI-BEFORE-REPO.
           MOVE QBR-RI-BEFORE-P4P5 TO BR-RI-BEFORE-P4P5.
           MOVE QBR-NOT-OURS-REFUND TO BR-NOT-OURS-REFUND.
           MOVE QBR-SFDLO3-WINDOW-FG TO BR-SFDLO3-WINDOW-FG.
           MOVE QBR-CALC-INS-ADJ TO BR-CALC-INS-ADJ.
           MOVE QBR-AC-BEFORE-REPO TO BR-AC-BEFORE-REPO.
           MOVE QBR-AC-BEFORE-P4P5 TO BR-AC-BEFORE-P4P5.
           MOVE QBR-BANK-ROUTING-NO TO BR-BANK-ROUTING-NO.
           MOVE QBR-BANK-CLEARING-GL TO BR-BANK-CLEARING-GL.
           MOVE QBR-GLBANK-DEPOSIT TO BR-GLBANK-DEPOSIT.
           MOVE QBR-BANK-ACCTNO TO BR-BANK-ACCTNO.
           MOVE QBR-DEFAULT-SC-SUBCLASS TO BR-DEFAULT-SC-SUBCLASS.
           MOVE QBR-NO-OUT-DLR-RSV TO BR-NO-OUT-DLR-RSV.
           MOVE QBR-COLLECTOR-QUEUE TO BR-COLLECTOR-QUEUE.
           MOVE QBR-COLL-QUEUE-CON-REC TO BR-COLL-QUEUE-CON-REC.
           MOVE QBR-JE-ALLOCATION-SKIP TO BR-JE-ALLOCATION-SKIP.
           MOVE QBR-EXPAND-APP-INPUT TO BR-EXPAND-APP-INPUT.
           MOVE QBR-A50-CPCORP TO BR-A50-CPCORP.
           MOVE QBR-INBR-BILNSC-FG TO BR-INBR-BILNSC-FG.
           MOVE QBR-INBR-BRIEF-FG TO BR-INBR-BRIEF-FG.
           MOVE QBR-LEDGER-JUST-INTCHG TO BR-LEDGER-JUST-INTCHG.
           MOVE QBR-BYINQ-START-PAGE TO BR-BYINQ-START-PAGE.
           MOVE QBR-DSINQ-START-PAGE TO BR-DSINQ-START-PAGE.
           MOVE QBR-APP-REQUIRED-FOR-INPUT
              TO BR-APP-REQUIRED-FOR-INPUT.
           MOVE QBR-CREDIT-SCORING-FG TO BR-CREDIT-SCORING-FG.
           MOVE QBR-COL-QUEUE-LOW-TO-HI TO BR-COL-QUEUE-LOW-TO-HI.
           MOVE QBR-CAN-GROUP-ID TO BR-CAN-GROUP-ID.
           MOVE QBR-AUTO-LNSTAT-WINDOW TO BR-AUTO-LNSTAT-WINDOW.
           MOVE QBR-TIME-ZONE-FACTOR TO BR-TIME-ZONE-FACTOR.
           MOVE QBR-LONPF-OPT-DISPLAY TO BR-LONPF-OPT-DISPLAY.
           MOVE QBR-GIFTNET TO BR-GIFTNET.
           MOVE QBR-GIFTNET-LEDGER-LINE TO BR-GIFTNET-LEDGER-LINE.
           MOVE QBR-NO-FT-EMP TO BR-NO-FT-EMP.
           MOVE QBR-NO-PT-EMP TO BR-NO-PT-EMP.
           MOVE QBR-BALLOON-LOANS-FG TO BR-BALLOON-LOANS-FG.
           MOVE QBR-GL-TYPE-ALLOWED TO BR-GL-TYPE-ALLOWED.
           MOVE QBR-GL-ENTRY-DEFAULT TO BR-GL-ENTRY-DEFAULT.
           MOVE QBR-MIDSTREAM-1STPAY-FG TO BR-MIDSTREAM-1STPAY-FG.
           MOVE QBR-NODEF-1ST-X-MONTHS TO BR-NODEF-1ST-X-MONTHS.
           MOVE QBR-ADD-INS-FEECODE TO BR-ADD-INS-FEECODE.
           MOVE QBR-ROAD-G-SGL-FEECODE TO BR-ROAD-G-SGL-FEECODE.
           MOVE QBR-ROAD-G-FAM-FEECODE TO BR-ROAD-G-FAM-FEECODE.
           MOVE QBR-NODEF-IF-ZERO-AMT TO BR-NODEF-IF-ZERO-AMT.
           MOVE QBR-ASSESS-LATE-CHGS TO BR-ASSESS-LATE-CHGS.
           MOVE QBR-NEXT-SOLICIT-NO TO BR-NEXT-SOLICIT-NO.
           MOVE QBR-ADDON-FEECD-O3-1 TO BR-ADDON-FEECD-O3(1).
           MOVE QBR-ADDON-FEECD-O3-2 TO BR-ADDON-FEECD-O3(2).
           MOVE QBR-IMMEDIATE-RECEIPT TO BR-IMMEDIATE-RECEIPT.
           MOVE QBR-IMMEDIATE-DOC-PRINT TO BR-IMMEDIATE-DOC-PRINT.
           MOVE QBR-AUTO-PL-REF-AC TO BR-AUTO-PL-REF-AC.
           MOVE QBR-FAX-NUMBER TO BR-FAX-NUMBER.
           MOVE QBR-ALPHA-DRAWERS TO BR-ALPHA-DRAWERS.
           MOVE QBR-LATECHG-ON-ALLOTMENTS TO BR-LATECHG-ON-ALLOTMENTS.
           MOVE QBR-ALLOW-SYS-AS-EFFDATE TO BR-ALLOW-SYS-AS-EFFDATE.
           MOVE QBR-TAX-PREBOOK-CUST TO BR-TAX-PREBOOK-CUST.
           MOVE QBR-TAX-PREBOOK-NONCUST TO BR-TAX-PREBOOK-NONCUST.
           MOVE QBR-PASSWORD-DRAWER TO BR-PASSWORD-DRAWER.
           MOVE QBR-ONESTEP-RN-FG TO BR-ONESTEP-RN-FG.
           MOVE QBR-LI-LISCAN-FG TO BR-LI-LISCAN-FG.
           MOVE QBR-HIDE-END-BAL TO BR-HIDE-END-BAL.
           MOVE QBR-LBOX-NOPAYOFF TO BR-LBOX-NOPAYOFF.
           MOVE QBR-LBOX-ODDPAY TO BR-LBOX-ODDPAY.
           MOVE QBR-LBOX-LC TO BR-LBOX-LC.
           MOVE QBR-LBOX-NOPRIN TO BR-LBOX-NOPRIN.
           MOVE QBR-LBOX-FLASH TO BR-LBOX-FLASH.
           MOVE QBR-LBOX-ACTIONCD TO BR-LBOX-ACTIONCD.
           MOVE QBR-LBOX-MAXCON TO BR-LBOX-MAXCON.
           MOVE QBR-LBOX-MAXREC TO BR-LBOX-MAXREC.
           MOVE QBR-LBOX-PL TO BR-LBOX-PL.
           MOVE QBR-LBOX-JD TO BR-LBOX-JD.
           MOVE QBR-LBOX TO BR-LBOX.
           MOVE QBR-LATECHG-ON-LBOX TO BR-LATECHG-ON-LBOX.
           MOVE QBR-ALLOW-OV-TRCD TO BR-ALLOW-OV-TRCD.
           MOVE QBR-GLOBAL-QUEUE TO BR-GLOBAL-QUEUE.
           MOVE QBR-LBOX-PAYOFF-NONCASH TO BR-LBOX-PAYOFF-NONCASH.
           MOVE QBR-LBOX-PAYOFF-OV TO BR-LBOX-PAYOFF-OV.
           MOVE QBR-COLLECT-MANAGER TO BR-COLLECT-MANAGER.
           MOVE QBR-COLLECT-PHONE TO BR-COLLECT-PHONE.
           MOVE QBR-COLLECT-EXT TO BR-COLLECT-EXT.
           MOVE QBR-ALT-INTO-THIS-BRANCH TO BR-ALT-INTO-THIS-BRANCH.
           MOVE QBR-POFF-TITLE-WINDOW TO BR-POFF-TITLE-WINDOW.
           MOVE QBR-COUPON-STATEMENT TO BR-COUPON-STATEMENT.
           MOVE QBR-SUPERVISOR TO BR-SUPERVISOR.
           MOVE QBR-AREA-MANAGER TO BR-AREA-MANAGER.
           MOVE QBR-MIN-MONTHS-DEF TO BR-MIN-MONTHS-DEF.
           MOVE QBR-CC-FLAG TO BR-CC-FLAG.
           MOVE QBR-CC-ADR1 TO BR-CC-ADR1.
           MOVE QBR-CC-CITY TO BR-CC-CITY.
           MOVE QBR-CC-STATE TO BR-CC-STATE.
           MOVE QBR-CC-ZIP TO BR-CC-ZIP.
           MOVE QBR-MIN-MONTHS-D2 TO BR-MIN-MONTHS-D2.
           MOVE QBR-SKIP-MIDSTREAM-TRW TO BR-SKIP-MIDSTREAM-TRW.
           MOVE QBR-GL-ESCROW-BALANCE TO BR-GL-ESCROW-BALANCE.
           MOVE QBR-GL-ESCROW-PAYABLE TO BR-GL-ESCROW-PAYABLE.
           MOVE QBR-ALLOW-FORCE-OPEN-FG TO BR-ALLOW-FORCE-OPEN-FG.
           MOVE QBR-ACH-BANK-NO TO BR-ACH-BANK-NO.
           MOVE QBR-WIMENU-CHECK-WRITING TO BR-WIMENU-CHECK-WRITING.
           MOVE QBR-ADP-PAY-GROUP TO BR-ADP-PAY-GROUP.
           MOVE QBR-ALLOW-SCANNED-CKS TO BR-ALLOW-SCANNED-CKS.
           MOVE QBR-CHECK-DEPOSIT-GL TO BR-CHECK-DEPOSIT-GL.
           MOVE QBR-OPTION-PST-LASER TO BR-OPTION-PST-LASER.
           MOVE QBR-USE-DEBIT-CARDS TO BR-USE-DEBIT-CARDS.
           MOVE QBR-GL-DEBIT-CARD-PROCEEDS
                                    TO BR-GL-DEBIT-CARD-PROCEEDS.
           MOVE QBR-WKDAY-BANKID    TO BR-WKDAY-BANKID.
           MOVE QBR-PURGE-NOW-FLAG  TO BR-PURGE-NOW-FLAG.
           MOVE QBR-EMAIL           TO BR-EMAIL.
           MOVE QBR-MANAGER-EMAIL   TO BR-MANAGER-EMAIL.
           MOVE QBR-VERITEC-LICENSE TO BR-VERITEC-LICENSE.
           MOVE QBR-TEST-PP-AUTO-INSCOVR TO BR-TEST-PP-AUTO-INSCOVR.
           MOVE QBR-USE-NEW-WFARGO-ACCT TO BR-USE-NEW-WFARGO-ACCT.
           MOVE QBR-BRANCH-CLOSED     TO BR-BRANCH-CLOSED.
           MOVE QBR-ALLOW-F3-ALL-DOCS TO BR-ALLOW-F3-ALL-DOCS.
 
      *-----------------------------------------------------------------
      *    LOAD QBR-REC FROM BR-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-BR-FIELDS.
           MOVE BR-NO TO QBR-NO.

           IF ( BR-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QBR-LTOUCH-DATE
           ELSE
              MOVE BR-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QBR-LTOUCH-DATE.

           MOVE BR-NAME TO QBR-NAME.
           MOVE BR-ADR1 TO QBR-ADR1.
           MOVE BR-ADR2 TO QBR-ADR2.
           MOVE BR-CITY TO QBR-CITY.
           MOVE BR-STATE TO QBR-STATE.
           MOVE BR-ZIP TO QBR-ZIP.
           MOVE BR-PHONE TO QBR-PHONE.
           MOVE BR-RETAIN TO QBR-RETAIN.
           MOVE BR-NEXT-CHECK TO QBR-NEXT-CHECK.
           MOVE BR-PRINTER(1) TO QBR-PRINTER-1.
           MOVE BR-PRINTER(2) TO QBR-PRINTER-2.
           MOVE BR-PRINTER(3) TO QBR-PRINTER-3.
           MOVE BR-PRINTER(4) TO QBR-PRINTER-4.
           MOVE BR-FEE-GL-BRNO TO QBR-FEE-GL-BRNO.
           MOVE BR-REMIT1 TO QBR-REMIT1.
           MOVE BR-REMIT2 TO QBR-REMIT2.
           MOVE BR-REMIT3 TO QBR-REMIT3.
           MOVE BR-STMNT1 TO QBR-STMNT1.
           MOVE BR-STMNT2 TO QBR-STMNT2.
           MOVE BR-INS-PRODUCER-NUM TO QBR-INS-PRODUCER-NUM.
           MOVE BR-DLRCHK TO QBR-DLRCHK.
           MOVE BR-FRONT-END-FG TO QBR-FRONT-END-FG.
           MOVE BR-EMLNRG-PHONE TO QBR-EMLNRG-PHONE.
           MOVE BR-POST-GL TO QBR-POST-GL.
           MOVE BR-ALLOTMNTS TO QBR-ALLOTMNTS.
           MOVE BR-EXTRACT-AUTO-UPD TO QBR-EXTRACT-AUTO-UPD.
           MOVE BR-PCNI-LEDGER TO QBR-PCNI-LEDGER.
           MOVE BR-PRINTERFG(1) TO QBR-PRINTERFG-1.
           MOVE BR-PRINTERFG(2) TO QBR-PRINTERFG-2.
           MOVE BR-PRINTERFG(3) TO QBR-PRINTERFG-3.
           MOVE BR-PRINTERFG(4) TO QBR-PRINTERFG-4.
           MOVE BR-NEGDLRSV TO QBR-NEGDLRSV.
           MOVE BR-CPCORP-ORDER TO QBR-CPCORP-ORDER.
           MOVE BR-PRIO-MEMO-FLAG TO QBR-PRIO-MEMO-FLAG.
           MOVE BR-PREBILL-PL-JD-OPT TO QBR-PREBILL-PL-JD-OPT.
           MOVE BR-LOAN-NUM-FLAG TO QBR-LOAN-NUM-FLAG.
           MOVE BR-DOWNPY-FLAG TO QBR-DOWNPY-FLAG.
           MOVE BR-AUTO-INS-EARN TO QBR-AUTO-INS-EARN.
           MOVE BR-OTH-INS-LEVELS TO QBR-OTH-INS-LEVELS.
           MOVE BR-ALLOW-INTERBR TO QBR-ALLOW-INTERBR.
           MOVE BR-UNER-DLANRP TO QBR-UNER-DLANRP.
           MOVE BR-SECOND-PROMISE TO QBR-SECOND-PROMISE.
           MOVE BR-AVAIL-CREDIT TO QBR-AVAIL-CREDIT.
           MOVE BR-RECP1 TO QBR-RECP1.
           MOVE BR-RECP2 TO QBR-RECP2.
           MOVE BR-INC-WAIVERS TO QBR-INC-WAIVERS.
           MOVE BR-INC-INS TO QBR-INC-INS.
           MOVE BR-BP-NEXT-BATCH TO QBR-BP-NEXT-BATCH.
           MOVE BR-BP-NOPAYOFF TO QBR-BP-NOPAYOFF.
           MOVE BR-BP-ODDPAY TO QBR-BP-ODDPAY.
           MOVE BR-BP-LC TO QBR-BP-LC.
           MOVE BR-BP-NOPRIN TO QBR-BP-NOPRIN.
           MOVE BR-BP-FLASH TO QBR-BP-FLASH.
           MOVE BR-BP-ACTIONCD TO QBR-BP-ACTIONCD.
           MOVE BR-BP-MAXCON TO QBR-BP-MAXCON.
           MOVE BR-BP-MAXREC TO QBR-BP-MAXREC.
           MOVE BR-BP-PL TO QBR-BP-PL.
           MOVE BR-BP-JD TO QBR-BP-JD.
           MOVE BR-BP-BRANCH TO QBR-BP-BRANCH.
           MOVE BR-AGE-ERN TO QBR-AGE-ERN.
           MOVE BR-OTHER-BRANCH-GL TO QBR-OTHER-BRANCH-GL.
           MOVE BR-SALES-SMALL TO QBR-SALES-SMALL.
           MOVE BR-NEW-COLL-INQUIRY TO QBR-NEW-COLL-INQUIRY.
           MOVE BR-CHANGE-MEMO TO QBR-CHANGE-MEMO.
           MOVE BR-INS-ADDON TO QBR-INS-ADDON.
           MOVE BR-TRAILER-REC TO QBR-TRAILER-REC.
           MOVE BR-ALDEL-FLAG TO QBR-ALDEL-FLAG.
           MOVE BR-IB-LCHG-MESS TO QBR-IB-LCHG-MESS.
           MOVE BR-COL-QUEUE-PAST-DUE TO QBR-COL-QUEUE-PAST-DUE.
           MOVE BR-LI-DLCOMM-CMSI-PP-MAX TO QBR-LI-DLCOMM-CMSI-PP-MAX.
           MOVE BR-ADDON-FEECD-O2(1) TO QBR-ADDON-FEECD-O2-1.
           MOVE BR-ADDON-FEECD-O2(2) TO QBR-ADDON-FEECD-O2-2.
           MOVE BR-AUTO-CHECK TO QBR-AUTO-CHECK.
           MOVE BR-RECEIPT-PROMDATE TO QBR-RECEIPT-PROMDATE.
           MOVE BR-RECEIPT-INTPD TO QBR-RECEIPT-INTPD.
           MOVE BR-COLL-ID-SCAN TO QBR-COLL-ID-SCAN.
           MOVE BR-STOP-ON-COLL TO QBR-STOP-ON-COLL.
           MOVE BR-DUEDATE-CHANGE-CD TO QBR-DUEDATE-CHANGE-CD.
           MOVE BR-CHECK-EOM-FG TO QBR-CHECK-EOM-FG.
           MOVE BR-VOLUME-DLANRP TO QBR-VOLUME-DLANRP.
           MOVE BR-PDTH-NXDUE TO QBR-PDTH-NXDUE.
           MOVE BR-LC-CODE TO QBR-LC-CODE.
           MOVE BR-VALIDATE-PRUS TO QBR-VALIDATE-PRUS.
           MOVE BR-AUTO-OPEN-BAL TO QBR-AUTO-OPEN-BAL.
           MOVE BR-OPEN-BAL(1) TO QBR-OPEN-BAL-1.
           MOVE BR-OPEN-BAL(2) TO QBR-OPEN-BAL-2.
           MOVE BR-OPEN-BAL(3) TO QBR-OPEN-BAL-3.
           MOVE BR-OPEN-BAL(4) TO QBR-OPEN-BAL-4.
           MOVE BR-OPEN-BAL(5) TO QBR-OPEN-BAL-5.
           MOVE BR-OPEN-BAL(6) TO QBR-OPEN-BAL-6.
           MOVE BR-OPEN-BAL(7) TO QBR-OPEN-BAL-7.
           MOVE BR-OPEN-BAL(8) TO QBR-OPEN-BAL-8.
           MOVE BR-OPEN-BAL(9) TO QBR-OPEN-BAL-9.
           MOVE BR-OPEN-BAL(10) TO QBR-OPEN-BAL-10.
           MOVE BR-OPEN-BAL(11) TO QBR-OPEN-BAL-11.
           MOVE BR-OPEN-BAL(12) TO QBR-OPEN-BAL-12.
           MOVE BR-OPEN-BAL(13) TO QBR-OPEN-BAL-13.
           MOVE BR-OPEN-BAL(14) TO QBR-OPEN-BAL-14.
           MOVE BR-OPEN-BAL(15) TO QBR-OPEN-BAL-15.
           MOVE BR-OPEN-BAL(16) TO QBR-OPEN-BAL-16.
           MOVE BR-OPEN-BAL(17) TO QBR-OPEN-BAL-17.
           MOVE BR-OPEN-BAL(18) TO QBR-OPEN-BAL-18.
           MOVE BR-OPEN-BAL(19) TO QBR-OPEN-BAL-19.
           MOVE BR-OPEN-BAL(20) TO QBR-OPEN-BAL-20.
           MOVE BR-TENDER-CD(1) TO QBR-TENDER-CD-1.
           MOVE BR-TENDER-CD(2) TO QBR-TENDER-CD-2.
           MOVE BR-TENDER-CD(3) TO QBR-TENDER-CD-3.
           MOVE BR-DLPARV-ADJ-FG TO QBR-DLPARV-ADJ-FG.
           MOVE BR-OVERRIDE-BR-STATE TO QBR-OVERRIDE-BR-STATE.
           MOVE BR-DEFAULT-SC-CLASS TO QBR-DEFAULT-SC-CLASS.
           MOVE BR-RECDEL-NOT-REC TO QBR-RECDEL-NOT-REC.
           MOVE BR-POST-AHEAD-FG TO QBR-POST-AHEAD-FG.
           MOVE BR-CAN-LOANS-FG TO QBR-CAN-LOANS-FG.
           MOVE BR-NON-MONTHLY-CAN-LOANS TO QBR-NON-MONTHLY-CAN-LOANS.
           MOVE BR-BP-ALLOW-PMT-ACCT-OTHBAL
            TO QBR-BP-ALLOW-PMT-ACCT-OTHBAL.
           MOVE BR-LBOX-ALLOW-PMT-ACCT-OTHBAL
            TO QBR-LBOX-ALLOW-PMT-ACCT-OTHBAL.
           MOVE BR-REGION-NUMBER TO QBR-REGION-NUMBER.
           MOVE BR-OUR-FEE TO QBR-OUR-FEE.
           MOVE BR-REB-METHOD(1) TO QBR-REB-METHOD-1.
           MOVE BR-REB-METHOD(2) TO QBR-REB-METHOD-2.
           MOVE BR-REB-METHOD(3) TO QBR-REB-METHOD-3.
           MOVE BR-REB-METHOD(4) TO QBR-REB-METHOD-4.
           MOVE BR-REB-METHOD(5) TO QBR-REB-METHOD-5.
           MOVE BR-REB-METHOD(6) TO QBR-REB-METHOD-6.
           MOVE BR-REB-METHOD(7) TO QBR-REB-METHOD-7.
           MOVE BR-REB-METHOD(8) TO QBR-REB-METHOD-8.
           MOVE BR-REB-METHOD(9) TO QBR-REB-METHOD-9.
           MOVE BR-REB-METHOD(10) TO QBR-REB-METHOD-10.
           MOVE BR-REB-METHOD(11) TO QBR-REB-METHOD-11.
           MOVE BR-REBDAYS-MONTH(1) TO QBR-REBDAYS-MONTH-1.
           MOVE BR-REBDAYS-MONTH(2) TO QBR-REBDAYS-MONTH-2.
           MOVE BR-REBDAYS-MONTH(3) TO QBR-REBDAYS-MONTH-3.
           MOVE BR-REBDAYS-MONTH(4) TO QBR-REBDAYS-MONTH-4.
           MOVE BR-REBDAYS-MONTH(5) TO QBR-REBDAYS-MONTH-5.
           MOVE BR-REBDAYS-MONTH(6) TO QBR-REBDAYS-MONTH-6.
           MOVE BR-REBDAYS-MONTH(7) TO QBR-REBDAYS-MONTH-7.
           MOVE BR-REBDAYS-MONTH(8) TO QBR-REBDAYS-MONTH-8.
           MOVE BR-REBDAYS-MONTH(9) TO QBR-REBDAYS-MONTH-9.
           MOVE BR-REBDAYS-MONTH(10) TO QBR-REBDAYS-MONTH-10.
           MOVE BR-REBDAYS-MONTH(11) TO QBR-REBDAYS-MONTH-11.
           MOVE BR-ACCRUAL-MONTHS(1) TO QBR-ACCRUAL-MONTHS-1.
           MOVE BR-ACCRUAL-MONTHS(2) TO QBR-ACCRUAL-MONTHS-2.
           MOVE BR-ACCRUAL-MONTHS(3) TO QBR-ACCRUAL-MONTHS-3.
           MOVE BR-ACCRUAL-MONTHS(4) TO QBR-ACCRUAL-MONTHS-4.
           MOVE BR-ACCRUAL-MONTHS(5) TO QBR-ACCRUAL-MONTHS-5.
           MOVE BR-ACCRUAL-MONTHS(6) TO QBR-ACCRUAL-MONTHS-6.
           MOVE BR-ACCRUAL-MONTHS(7) TO QBR-ACCRUAL-MONTHS-7.
           MOVE BR-ACCRUAL-MONTHS(8) TO QBR-ACCRUAL-MONTHS-8.
           MOVE BR-ACCRUAL-MONTHS(9) TO QBR-ACCRUAL-MONTHS-9.
           MOVE BR-ACCRUAL-MONTHS(10) TO QBR-ACCRUAL-MONTHS-10.
           MOVE BR-ACCRUAL-MONTHS(11) TO QBR-ACCRUAL-MONTHS-11.
           MOVE BR-GLOVERSHORT TO QBR-GLOVERSHORT.
           MOVE BR-GLBANK TO QBR-GLBANK.
           MOVE BR-GLONHAND TO QBR-GLONHAND.
           MOVE BR-BANKBAL TO QBR-BANKBAL.
           MOVE BR-RETAIN-AMT TO QBR-RETAIN-AMT.
           MOVE BR-LCARDFG TO QBR-LCARDFG.
           MOVE BR-DATA-PATH TO QBR-DATA-PATH.
           MOVE BR-MACHINE TO QBR-MACHINE.
           MOVE BR-MANAGER TO QBR-MANAGER.
           MOVE BR-EOD-PROCEDURE TO QBR-EOD-PROCEDURE.
           MOVE BR-BP-PAYOFF-NONCASH TO QBR-BP-PAYOFF-NONCASH.
           MOVE BR-BP-PAYOFF-OV TO QBR-BP-PAYOFF-OV.
           MOVE BR-LI-DLCOMM-CMSI-O3-MAX TO QBR-LI-DLCOMM-CMSI-O3-MAX.
           MOVE BR-LR-GROUP-COLLID TO QBR-LR-GROUP-COLLID.
           MOVE BR-UNITPER-FG TO QBR-UNITPER-FG.
           MOVE BR-UNITPER-Y-D-FG TO QBR-UNITPER-Y-D-FG.
           MOVE BR-NO-PROMPT-FOR-OTHBR TO QBR-NO-PROMPT-FOR-OTHBR.
           MOVE BR-WORLD-BRANCH-TYPE TO QBR-WORLD-BRANCH-TYPE.
           MOVE BR-COL-QUEUE-BEHAVIOR-FG TO QBR-COL-QUEUE-BEHAVIOR-FG.
           MOVE BR-CONVERT-AUTO-ACCTNO TO QBR-CONVERT-AUTO-ACCTNO.
           MOVE BR-TS-REPO-INS-FG TO QBR-TS-REPO-INS-FG.
           MOVE BR-BOOK-SF-BR-ONLY TO QBR-BOOK-SF-BR-ONLY.
           MOVE BR-FORCE-VALID-CITY-COUNTY
            TO QBR-FORCE-VALID-CITY-COUNTY.
           MOVE BR-SET-COLLCD-DL-MFGCD TO QBR-SET-COLLCD-DL-MFGCD.
           MOVE BR-DEFAULT-SF-UNITPER-CD TO QBR-DEFAULT-SF-UNITPER-CD.
           MOVE BR-DEFAULT-SF-PURCD TO QBR-DEFAULT-SF-PURCD.
           MOVE BR-DEFAULT-LN-UNITPER-CD TO QBR-DEFAULT-LN-UNITPER-CD.
           MOVE BR-DEFAULT-LN-PURCD TO QBR-DEFAULT-LN-PURCD.
           MOVE BR-TAP-OTHER-DL TO QBR-TAP-OTHER-DL.
           MOVE BR-AH-AND-CL TO QBR-AH-AND-CL.
           MOVE BR-NO-CASH-PROCEEDS TO QBR-NO-CASH-PROCEEDS.
           MOVE BR-RI-BEFORE-REPO TO QBR-RI-BEFORE-REPO.
           MOVE BR-RI-BEFORE-P4P5 TO QBR-RI-BEFORE-P4P5.
           MOVE BR-NOT-OURS-REFUND TO QBR-NOT-OURS-REFUND.
           MOVE BR-SFDLO3-WINDOW-FG TO QBR-SFDLO3-WINDOW-FG.
           MOVE BR-CALC-INS-ADJ TO QBR-CALC-INS-ADJ.
           MOVE BR-AC-BEFORE-REPO TO QBR-AC-BEFORE-REPO.
           MOVE BR-AC-BEFORE-P4P5 TO QBR-AC-BEFORE-P4P5.
           MOVE BR-BANK-ROUTING-NO TO QBR-BANK-ROUTING-NO.
           MOVE BR-BANK-CLEARING-GL TO QBR-BANK-CLEARING-GL.
           MOVE BR-GLBANK-DEPOSIT TO QBR-GLBANK-DEPOSIT.
           MOVE BR-BANK-ACCTNO TO QBR-BANK-ACCTNO.
           MOVE BR-DEFAULT-SC-SUBCLASS TO QBR-DEFAULT-SC-SUBCLASS.
           MOVE BR-NO-OUT-DLR-RSV TO QBR-NO-OUT-DLR-RSV.
           MOVE BR-COLLECTOR-QUEUE TO QBR-COLLECTOR-QUEUE.
           MOVE BR-COLL-QUEUE-CON-REC TO QBR-COLL-QUEUE-CON-REC.
           MOVE BR-JE-ALLOCATION-SKIP TO QBR-JE-ALLOCATION-SKIP.
           MOVE BR-EXPAND-APP-INPUT TO QBR-EXPAND-APP-INPUT.
           MOVE BR-A50-CPCORP TO QBR-A50-CPCORP.
           MOVE BR-INBR-BILNSC-FG TO QBR-INBR-BILNSC-FG.
           MOVE BR-INBR-BRIEF-FG TO QBR-INBR-BRIEF-FG.
           MOVE BR-LEDGER-JUST-INTCHG TO QBR-LEDGER-JUST-INTCHG.
           MOVE BR-BYINQ-START-PAGE TO QBR-BYINQ-START-PAGE.
           MOVE BR-DSINQ-START-PAGE TO QBR-DSINQ-START-PAGE.
           MOVE BR-APP-REQUIRED-FOR-INPUT
            TO QBR-APP-REQUIRED-FOR-INPUT.
           MOVE BR-CREDIT-SCORING-FG TO QBR-CREDIT-SCORING-FG.
           MOVE BR-COL-QUEUE-LOW-TO-HI TO QBR-COL-QUEUE-LOW-TO-HI.
           MOVE BR-CAN-GROUP-ID TO QBR-CAN-GROUP-ID.
           MOVE BR-AUTO-LNSTAT-WINDOW TO QBR-AUTO-LNSTAT-WINDOW.
           MOVE BR-TIME-ZONE-FACTOR TO QBR-TIME-ZONE-FACTOR.
           MOVE BR-LONPF-OPT-DISPLAY TO QBR-LONPF-OPT-DISPLAY.
           MOVE BR-GIFTNET TO QBR-GIFTNET.
           MOVE BR-GIFTNET-LEDGER-LINE TO QBR-GIFTNET-LEDGER-LINE.
           MOVE BR-NO-FT-EMP TO QBR-NO-FT-EMP.
           MOVE BR-NO-PT-EMP TO QBR-NO-PT-EMP.
           MOVE BR-BALLOON-LOANS-FG TO QBR-BALLOON-LOANS-FG.
           MOVE BR-GL-TYPE-ALLOWED TO QBR-GL-TYPE-ALLOWED.
           MOVE BR-GL-ENTRY-DEFAULT TO QBR-GL-ENTRY-DEFAULT.
           MOVE BR-MIDSTREAM-1STPAY-FG TO QBR-MIDSTREAM-1STPAY-FG.
           MOVE BR-NODEF-1ST-X-MONTHS TO QBR-NODEF-1ST-X-MONTHS.
           MOVE BR-ADD-INS-FEECODE TO QBR-ADD-INS-FEECODE.
           MOVE BR-ROAD-G-SGL-FEECODE TO QBR-ROAD-G-SGL-FEECODE.
           MOVE BR-ROAD-G-FAM-FEECODE TO QBR-ROAD-G-FAM-FEECODE.
           MOVE BR-NODEF-IF-ZERO-AMT TO QBR-NODEF-IF-ZERO-AMT.
           MOVE BR-ASSESS-LATE-CHGS TO QBR-ASSESS-LATE-CHGS.
           MOVE BR-NEXT-SOLICIT-NO TO QBR-NEXT-SOLICIT-NO.
           MOVE BR-ADDON-FEECD-O3(1) TO QBR-ADDON-FEECD-O3-1.
           MOVE BR-ADDON-FEECD-O3(2) TO QBR-ADDON-FEECD-O3-2.
           MOVE BR-IMMEDIATE-RECEIPT TO QBR-IMMEDIATE-RECEIPT.
           MOVE BR-IMMEDIATE-DOC-PRINT TO QBR-IMMEDIATE-DOC-PRINT.
           MOVE BR-AUTO-PL-REF-AC TO QBR-AUTO-PL-REF-AC.
           MOVE BR-FAX-NUMBER TO QBR-FAX-NUMBER.
           MOVE BR-ALPHA-DRAWERS TO QBR-ALPHA-DRAWERS.
           MOVE BR-LATECHG-ON-ALLOTMENTS TO QBR-LATECHG-ON-ALLOTMENTS.
           MOVE BR-ALLOW-SYS-AS-EFFDATE TO QBR-ALLOW-SYS-AS-EFFDATE.
           MOVE BR-TAX-PREBOOK-CUST TO QBR-TAX-PREBOOK-CUST.
           MOVE BR-TAX-PREBOOK-NONCUST TO QBR-TAX-PREBOOK-NONCUST.
           MOVE BR-PASSWORD-DRAWER TO QBR-PASSWORD-DRAWER.
           MOVE BR-ONESTEP-RN-FG TO QBR-ONESTEP-RN-FG.
           MOVE BR-LI-LISCAN-FG TO QBR-LI-LISCAN-FG.
           MOVE BR-HIDE-END-BAL TO QBR-HIDE-END-BAL.
           MOVE BR-LBOX-NOPAYOFF TO QBR-LBOX-NOPAYOFF.
           MOVE BR-LBOX-ODDPAY TO QBR-LBOX-ODDPAY.
           MOVE BR-LBOX-LC TO QBR-LBOX-LC.
           MOVE BR-LBOX-NOPRIN TO QBR-LBOX-NOPRIN.
           MOVE BR-LBOX-FLASH TO QBR-LBOX-FLASH.
           MOVE BR-LBOX-ACTIONCD TO QBR-LBOX-ACTIONCD.
           MOVE BR-LBOX-MAXCON TO QBR-LBOX-MAXCON.
           MOVE BR-LBOX-MAXREC TO QBR-LBOX-MAXREC.
           MOVE BR-LBOX-PL TO QBR-LBOX-PL.
           MOVE BR-LBOX-JD TO QBR-LBOX-JD.
           MOVE BR-LBOX TO QBR-LBOX.
           MOVE BR-LATECHG-ON-LBOX TO QBR-LATECHG-ON-LBOX.
           MOVE BR-ALLOW-OV-TRCD TO QBR-ALLOW-OV-TRCD.
           MOVE BR-GLOBAL-QUEUE TO QBR-GLOBAL-QUEUE.
           MOVE BR-LBOX-PAYOFF-NONCASH TO QBR-LBOX-PAYOFF-NONCASH.
           MOVE BR-LBOX-PAYOFF-OV TO QBR-LBOX-PAYOFF-OV.
           MOVE BR-COLLECT-MANAGER TO QBR-COLLECT-MANAGER.
           MOVE BR-COLLECT-PHONE TO QBR-COLLECT-PHONE.
           MOVE BR-COLLECT-EXT TO QBR-COLLECT-EXT.
           MOVE BR-ALT-INTO-THIS-BRANCH TO QBR-ALT-INTO-THIS-BRANCH.
           MOVE BR-POFF-TITLE-WINDOW TO QBR-POFF-TITLE-WINDOW.
           MOVE BR-COUPON-STATEMENT TO QBR-COUPON-STATEMENT.
           MOVE BR-SUPERVISOR TO QBR-SUPERVISOR.
           MOVE BR-AREA-MANAGER TO QBR-AREA-MANAGER.
           MOVE BR-MIN-MONTHS-DEF TO QBR-MIN-MONTHS-DEF.
           MOVE BR-CC-FLAG TO QBR-CC-FLAG.
           MOVE BR-CC-ADR1 TO QBR-CC-ADR1.
           MOVE BR-CC-CITY TO QBR-CC-CITY.
           MOVE BR-CC-STATE TO QBR-CC-STATE.
           MOVE BR-CC-ZIP TO QBR-CC-ZIP.
           MOVE BR-MIN-MONTHS-D2 TO QBR-MIN-MONTHS-D2.
           MOVE BR-SKIP-MIDSTREAM-TRW TO QBR-SKIP-MIDSTREAM-TRW.
           MOVE BR-GL-ESCROW-BALANCE TO QBR-GL-ESCROW-BALANCE.
           MOVE BR-GL-ESCROW-PAYABLE TO QBR-GL-ESCROW-PAYABLE.
           MOVE BR-ALLOW-FORCE-OPEN-FG TO QBR-ALLOW-FORCE-OPEN-FG.
           MOVE BR-ACH-BANK-NO TO QBR-ACH-BANK-NO.
           MOVE BR-WIMENU-CHECK-WRITING TO QBR-WIMENU-CHECK-WRITING.
           MOVE BR-ADP-PAY-GROUP TO QBR-ADP-PAY-GROUP.
           MOVE BR-ALLOW-SCANNED-CKS TO QBR-ALLOW-SCANNED-CKS.
           MOVE BR-CHECK-DEPOSIT-GL TO QBR-CHECK-DEPOSIT-GL.
           MOVE BR-OPTION-PST-LASER TO QBR-OPTION-PST-LASER.
           MOVE BR-USE-DEBIT-CARDS TO QBR-USE-DEBIT-CARDS.
           MOVE BR-GL-DEBIT-CARD-PROCEEDS
                                   TO QBR-GL-DEBIT-CARD-PROCEEDS.
           MOVE BR-WKDAY-BANKID    TO QBR-WKDAY-BANKID.
           MOVE BR-PURGE-NOW-FLAG  TO QBR-PURGE-NOW-FLAG.
           MOVE BR-EMAIL           TO QBR-EMAIL.
           MOVE BR-MANAGER-EMAIL   TO QBR-MANAGER-EMAIL.
           MOVE BR-VERITEC-LICENSE TO QBR-VERITEC-LICENSE.
           MOVE BR-TEST-PP-AUTO-INSCOVR TO QBR-TEST-PP-AUTO-INSCOVR.
           MOVE BR-USE-NEW-WFARGO-ACCT TO QBR-USE-NEW-WFARGO-ACCT.
           MOVE BR-BRANCH-CLOSED     TO QBR-BRANCH-CLOSED.
           MOVE BR-ALLOW-F3-ALL-DOCS TO QBR-ALLOW-F3-ALL-DOCS.
      *================================================================*
      * END COPYBOOK: LIBGB\GBBRGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBGBGS_SQL.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBGBGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - GBFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD GB-REC FROM QGB-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-GB-FIELDS.
           MOVE QGB-BRNO TO GB-BRNO.
           MOVE QGB-NO TO GB-NO.

           IF ( QGB-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO GB-LTOUCH-DATE
           ELSE
              MOVE QGB-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO GB-LTOUCH-DATE.

           MOVE QGB-COMPANY-NAME TO GB-COMPANY-NAME.
           MOVE QGB-ADDR-1 TO GB-ADDR-1.
           MOVE QGB-ADDR-2 TO GB-ADDR-2.
           MOVE QGB-CITY TO GB-CITY.
           MOVE QGB-STATE TO GB-STATE.
           MOVE QGB-ZIP TO GB-ZIP.
           MOVE QGB-PHONE TO GB-PHONE.
           MOVE QGB-NEXT-SF TO GB-NEXT-SF.
           MOVE QGB-NEXT-SMALL TO GB-NEXT-SMALL.
           MOVE QGB-NEXT-OTHER TO GB-NEXT-OTHER.
           MOVE QGB-HOLIDAY-1 TO GB-HOLIDAY(1).
           MOVE QGB-HOLIDAY-2 TO GB-HOLIDAY(2).
           MOVE QGB-HOLIDAY-3 TO GB-HOLIDAY(3).
           MOVE QGB-HOLIDAY-4 TO GB-HOLIDAY(4).
           MOVE QGB-HOLIDAY-5 TO GB-HOLIDAY(5).
           MOVE QGB-HOLIDAY-6 TO GB-HOLIDAY(6).
           MOVE QGB-HOLIDAY-7 TO GB-HOLIDAY(7).
           MOVE QGB-HOLIDAY-8 TO GB-HOLIDAY(8).
           MOVE QGB-HOLIDAY-9 TO GB-HOLIDAY(9).
           MOVE QGB-HOLIDAY-10 TO GB-HOLIDAY(10).
           MOVE QGB-HOLIDAY-11 TO GB-HOLIDAY(11).
           MOVE QGB-HOLIDAY-12 TO GB-HOLIDAY(12).
           MOVE QGB-HOLIDAY-13 TO GB-HOLIDAY(13).
           MOVE QGB-HOLIDAY-14 TO GB-HOLIDAY(14).
           MOVE QGB-HOLIDAY-15 TO GB-HOLIDAY(15).
           MOVE QGB-HOLIDAY-16 TO GB-HOLIDAY(16).
           MOVE QGB-RPT-LINES TO GB-RPT-LINES.
           MOVE QGB-CHECK-PROG TO GB-CHECK-PROG.
           MOVE QGB-OTHER-BRANCH-POST TO GB-OTHER-BRANCH-POST.
           MOVE QGB-LAST-ACCRUE TO GB-LAST-ACCRUE.
           MOVE QGB-AUTO-DEPOSIT TO GB-AUTO-DEPOSIT.
           MOVE QGB-UUCP-HOME TO GB-UUCP-HOME.
           MOVE QGB-EOM-TAG-CCYYMM TO GB-EOM-TAG-CCYYMM.

           IF ( QGB-EOM-UPDATE-DATE = "1900-01-01" )
              MOVE ZEROES TO GB-EOM-UPDATE-DATE
           ELSE
              MOVE QGB-EOM-UPDATE-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO GB-EOM-UPDATE-DATE.

           MOVE QGB-EOM-UPDATE-TIME TO GB-EOM-UPDATE-TIME.
           MOVE QGB-EOM-UPDATE-USERID TO GB-EOM-UPDATE-USERID.

           MOVE QGB-FISCAL-EOY-TAG-CCYYMM TO GB-FISCAL-EOY-TAG-CCYYMM.

           IF ( QGB-EOYF-UPDATE-DATE = "1900-01-01" )
              MOVE ZEROES TO GB-EOYF-UPDATE-DATE
           ELSE
              MOVE QGB-EOYF-UPDATE-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO GB-EOYF-UPDATE-DATE.

           MOVE QGB-EOYF-UPDATE-TIME TO GB-EOYF-UPDATE-TIME.
           MOVE QGB-EOYF-UPDATE-USERID TO GB-EOYF-UPDATE-USERID.

           MOVE QGB-CALENDAR-EOY-TAG-CCYYMM
              TO GB-CALENDAR-EOY-TAG-CCYYMM.

           IF ( QGB-EOYC-UPDATE-DATE = "1900-01-01" )
              MOVE ZEROES TO GB-EOYC-UPDATE-DATE
           ELSE
              MOVE QGB-EOYC-UPDATE-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO GB-EOYC-UPDATE-DATE.

           MOVE QGB-EOYC-UPDATE-TIME TO GB-EOYC-UPDATE-TIME.
           MOVE QGB-EOYC-UPDATE-USERID TO GB-EOYC-UPDATE-USERID.

      *-----------------------------------------------------------------
      *    LOAD QGB-REC FROM GB-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-GB-FIELDS.
           MOVE GB-BRNO TO QGB-BRNO.
           MOVE GB-NO TO QGB-NO.

           IF ( GB-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QGB-LTOUCH-DATE
           ELSE
              MOVE GB-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QGB-LTOUCH-DATE.

           MOVE GB-COMPANY-NAME TO QGB-COMPANY-NAME.
           MOVE GB-ADDR-1 TO QGB-ADDR-1.
           MOVE GB-ADDR-2 TO QGB-ADDR-2.
           MOVE GB-CITY TO QGB-CITY.
           MOVE GB-STATE TO QGB-STATE.
           MOVE GB-ZIP TO QGB-ZIP.
           MOVE GB-PHONE TO QGB-PHONE.
           MOVE GB-NEXT-SF TO QGB-NEXT-SF.
           MOVE GB-NEXT-SMALL TO QGB-NEXT-SMALL.
           MOVE GB-NEXT-OTHER TO QGB-NEXT-OTHER.
           MOVE GB-HOLIDAY(1) TO QGB-HOLIDAY-1.
           MOVE GB-HOLIDAY(2) TO QGB-HOLIDAY-2.
           MOVE GB-HOLIDAY(3) TO QGB-HOLIDAY-3.
           MOVE GB-HOLIDAY(4) TO QGB-HOLIDAY-4.
           MOVE GB-HOLIDAY(5) TO QGB-HOLIDAY-5.
           MOVE GB-HOLIDAY(6) TO QGB-HOLIDAY-6.
           MOVE GB-HOLIDAY(7) TO QGB-HOLIDAY-7.
           MOVE GB-HOLIDAY(8) TO QGB-HOLIDAY-8.
           MOVE GB-HOLIDAY(9) TO QGB-HOLIDAY-9.
           MOVE GB-HOLIDAY(10) TO QGB-HOLIDAY-10.
           MOVE GB-HOLIDAY(11) TO QGB-HOLIDAY-11.
           MOVE GB-HOLIDAY(12) TO QGB-HOLIDAY-12.
           MOVE GB-HOLIDAY(13) TO QGB-HOLIDAY-13.
           MOVE GB-HOLIDAY(14) TO QGB-HOLIDAY-14.
           MOVE GB-HOLIDAY(15) TO QGB-HOLIDAY-15.
           MOVE GB-HOLIDAY(16) TO QGB-HOLIDAY-16.
           MOVE GB-RPT-LINES TO QGB-RPT-LINES.
           MOVE GB-CHECK-PROG TO QGB-CHECK-PROG.
           MOVE GB-OTHER-BRANCH-POST TO QGB-OTHER-BRANCH-POST.
           MOVE GB-LAST-ACCRUE TO QGB-LAST-ACCRUE.
           MOVE GB-AUTO-DEPOSIT TO QGB-AUTO-DEPOSIT.
           MOVE GB-UUCP-HOME TO QGB-UUCP-HOME.
           MOVE GB-EOM-TAG-CCYYMM TO QGB-EOM-TAG-CCYYMM.

           IF ( GB-EOM-UPDATE-DATE = ZEROES )
              MOVE "1900-01-01" TO QGB-EOM-UPDATE-DATE
           ELSE
              MOVE GB-EOM-UPDATE-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QGB-EOM-UPDATE-DATE.

           MOVE GB-EOM-UPDATE-TIME TO QGB-EOM-UPDATE-TIME.
           MOVE GB-EOM-UPDATE-USERID TO QGB-EOM-UPDATE-USERID.

           MOVE GB-FISCAL-EOY-TAG-CCYYMM TO QGB-FISCAL-EOY-TAG-CCYYMM.

           IF ( GB-EOYF-UPDATE-DATE = ZEROES )
              MOVE "1900-01-01" TO QGB-EOYF-UPDATE-DATE
           ELSE
              MOVE GB-EOYF-UPDATE-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QGB-EOYF-UPDATE-DATE.

           MOVE GB-EOYF-UPDATE-TIME TO QGB-EOYF-UPDATE-TIME.
           MOVE GB-EOYF-UPDATE-USERID TO QGB-EOYF-UPDATE-USERID.

           MOVE GB-CALENDAR-EOY-TAG-CCYYMM
            TO QGB-CALENDAR-EOY-TAG-CCYYMM.

           IF ( GB-EOYC-UPDATE-DATE = ZEROES )
              MOVE "1900-01-01" TO QGB-EOYC-UPDATE-DATE
           ELSE
              MOVE GB-EOYC-UPDATE-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QGB-EOYC-UPDATE-DATE.

           MOVE GB-EOYC-UPDATE-TIME TO QGB-EOYC-UPDATE-TIME.
           MOVE GB-EOYC-UPDATE-USERID TO QGB-EOYC-UPDATE-USERID.

      *================================================================*
      * END COPYBOOK: LIBGB\GBGBGS_SQL.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBBRRN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBBRRN
      * BAH 2022-0923 BAH ADDED BR_VERITEC_LICENSE #1570
      * BAH 2023-0419 BAH ADDED BR-TEST-PP-AUTO-INSCOVR #1594A
      * BAH 2023-0713 BAH ADDED BR-USE-NEW-WFARGO-ACCT #1616
      * BAH 2023-1113 BAH ADDED BR-ALLOW-F3-ALL-DOCS #1630
      * JKC 2024-0124 ADDED OTIS TRACE LOGGING LOGIC
      *
       LOAD-BR-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( BR-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( BR-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO BR-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO BR-ALL-MACHINE
              MOVE BR-ALL-PATH             TO BR-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( BR-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO BR-ALL-BASE
              MOVE FILPATH-MACHINE         TO BR-ALL-MACHINE
              MOVE BR-ALL-PATH             TO BR-PATH.

      *-----------------------------------------------------------------
       OPEN-BR-FILE.
           PERFORM LOAD-BR-FILE.
           PERFORM OPEN-IT.
           MOVE BR-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       COUNT-BR-FILE.
           PERFORM COUNT-IT.
           MOVE BR-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.

           EXEC SQL
            SELECT COUNT(*)
            INTO :BR1-ROW-COUNT
            FROM DBO.BRFILE
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO COUNT-BR-FILE.

      *-----------------------------------------------------------------
       START-BR-FILE.
           PERFORM START-IT.
           MOVE BR-PATH-SQL TO E-FILE.
           MOVE BR-NO TO E-KEYX.

           IF ( EXT-TCLP-TRACE-BRANCH )
              STRING "START-BR-FILE | ", BR-NO
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

           IF ( BR-CURSOR-STAT-GOOD )
              PERFORM CLOSE-BR-FILE.

           IF ( QBR-WEND-NO = ZEROES    ) OR
              ( QBR-WEND-NO NOT NUMERIC )
              MOVE BR-NO                TO QBR-WBEG-NO
              MOVE ALL "9"              TO QBR-WEND-NO.

           EXEC SQL
            DECLARE BR_CURSOR CURSOR FOR
            SELECT BRFILE.BR_NO,
                   CAST(BRFILE.BR_LTOUCH_DATE AS VARCHAR(10)),
                   BRFILE.BR_NAME,
                   BRFILE.BR_ADR1,
                   BRFILE.BR_ADR2,
                   BRFILE.BR_CITY,
                   BRFILE.BR_STATE,
                   BRFILE.BR_ZIP,
                   BRFILE.BR_PHONE,
                   BRFILE.BR_RETAIN,
                   BRFILE.BR_NEXT_CHECK,
                   BRFILE.BR_PRINTER_1,
                   BRFILE.BR_PRINTER_2,
                   BRFILE.BR_PRINTER_3,
                   BRFILE.BR_PRINTER_4,
                   BRFILE.BR_FEE_GL_BRNO,
                   BRFILE.BR_REMIT1,
                   BRFILE.BR_REMIT2,
                   BRFILE.BR_REMIT3,
                   BRFILE.BR_STMNT1,
                   BRFILE.BR_STMNT2,
                   BRFILE.BR_INS_PRODUCER_NUM,
                   BRFILE.BR_DLRCHK,
                   BRFILE.BR_FRONT_END_FG,
                   BRFILE.BR_EMLNRG_PHONE,
                   BRFILE.BR_POST_GL,
                   BRFILE.BR_ALLOTMNTS,
                   BRFILE.BR_EXTRACT_AUTO_UPD,
                   BRFILE.BR_PCNI_LEDGER,
                   BRFILE.BR_PRINTERFG_1,
                   BRFILE.BR_PRINTERFG_2,
                   BRFILE.BR_PRINTERFG_3,
                   BRFILE.BR_PRINTERFG_4,
                   BRFILE.BR_NEGDLRSV,
                   BRFILE.BR_CPCORP_ORDER,
                   BRFILE.BR_PRIO_MEMO_FLAG,
                   BRFILE.BR_PREBILL_PL_JD_OPT,
                   BRFILE.BR_LOAN_NUM_FLAG,
                   BRFILE.BR_DOWNPY_FLAG,
                   BRFILE.BR_AUTO_INS_EARN,
                   BRFILE.BR_OTH_INS_LEVELS,
                   BRFILE.BR_ALLOW_INTERBR,
                   BRFILE.BR_UNER_DLANRP,
                   BRFILE.BR_SECOND_PROMISE,
                   BRFILE.BR_AVAIL_CREDIT,
                   BRFILE.BR_RECP1,
                   BRFILE.BR_RECP2,
                   BRFILE.BR_INC_WAIVERS,
                   BRFILE.BR_INC_INS,
                   BRFILE.BR_BP_NEXT_BATCH,
                   BRFILE.BR_BP_NOPAYOFF,
                   BRFILE.BR_BP_ODDPAY,
                   BRFILE.BR_BP_LC,
                   BRFILE.BR_BP_NOPRIN,
                   BRFILE.BR_BP_FLASH,
                   BRFILE.BR_BP_ACTIONCD,
                   BRFILE.BR_BP_MAXCON,
                   BRFILE.BR_BP_MAXREC,
                   BRFILE.BR_BP_PL,
                   BRFILE.BR_BP_JD,
                   BRFILE.BR_BP_BRANCH,
                   BRFILE.BR_AGE_ERN,
                   BRFILE.BR_OTHER_BRANCH_GL,
                   BRFILE.BR_SALES_SMALL,
                   BRFILE.BR_NEW_COLL_INQUIRY,
                   BRFILE.BR_CHANGE_MEMO,
                   BRFILE.BR_INS_ADDON,
                   BRFILE.BR_TRAILER_REC,
                   BRFILE.BR_ALDEL_FLAG,
                   BRFILE.BR_IB_LCHG_MESS,
                   BRFILE.BR_COL_QUEUE_PAST_DUE,
                   BRFILE.BR_LI_DLCOMM_CMSI_PP_MAX,
                   BRFILE.BR_ADDON_FEECD_O2_1,
                   BRFILE.BR_ADDON_FEECD_O2_2,
                   BRFILE.BR_AUTO_CHECK,
                   BRFILE.BR_RECEIPT_PROMDATE,
                   BRFILE.BR_RECEIPT_INTPD,
                   BRFILE.BR_COLL_ID_SCAN,
                   BRFILE.BR_STOP_ON_COLL,
                   BRFILE.BR_DUEDATE_CHANGE_CD,
                   BRFILE.BR_CHECK_EOM_FG,
                   BRFILE.BR_VOLUME_DLANRP,
                   BRFILE.BR_PDTH_NXDUE,
                   BRFILE.BR_LC_CODE,
                   BRFILE.BR_VALIDATE_PRUS,
                   BRFILE.BR_AUTO_OPEN_BAL,
                   BRFILE.BR_OPEN_BAL_1,
                   BRFILE.BR_OPEN_BAL_2,
                   BRFILE.BR_OPEN_BAL_3,
                   BRFILE.BR_OPEN_BAL_4,
                   BRFILE.BR_OPEN_BAL_5,
                   BRFILE.BR_OPEN_BAL_6,
                   BRFILE.BR_OPEN_BAL_7,
                   BRFILE.BR_OPEN_BAL_8,
                   BRFILE.BR_OPEN_BAL_9,
                   BRFILE.BR_OPEN_BAL_10,
                   BRFILE.BR_OPEN_BAL_11,
                   BRFILE.BR_OPEN_BAL_12,
                   BRFILE.BR_OPEN_BAL_13,
                   BRFILE.BR_OPEN_BAL_14,
                   BRFILE.BR_OPEN_BAL_15,
                   BRFILE.BR_OPEN_BAL_16,
                   BRFILE.BR_OPEN_BAL_17,
                   BRFILE.BR_OPEN_BAL_18,
                   BRFILE.BR_OPEN_BAL_19,
                   BRFILE.BR_OPEN_BAL_20,
                   BRFILE.BR_TENDER_CD_1,
                   BRFILE.BR_TENDER_CD_2,
                   BRFILE.BR_TENDER_CD_3,
                   BRFILE.BR_DLPARV_ADJ_FG,
                   BRFILE.BR_OVERRIDE_BR_STATE,
                   BRFILE.BR_DEFAULT_SC_CLASS,
                   BRFILE.BR_RECDEL_NOT_REC,
                   BRFILE.BR_POST_AHEAD_FG,
                   BRFILE.BR_CAN_LOANS_FG,
                   BRFILE.BR_NON_MONTHLY_CAN_LOANS,
                   BRFILE.BR_BP_ALLOW_PMT_ACCT_OTHBAL,
                   BRFILE.BR_LBOX_ALLOW_PMT_ACCT_OTHBAL,
                   BRFILE.BR_REGION_NUMBER,
                   BRFILE.BR_OUR_FEE,
                   BRFILE.BR_REB_METHOD_1,
                   BRFILE.BR_REB_METHOD_2,
                   BRFILE.BR_REB_METHOD_3,
                   BRFILE.BR_REB_METHOD_4,
                   BRFILE.BR_REB_METHOD_5,
                   BRFILE.BR_REB_METHOD_6,
                   BRFILE.BR_REB_METHOD_7,
                   BRFILE.BR_REB_METHOD_8,
                   BRFILE.BR_REB_METHOD_9,
                   BRFILE.BR_REB_METHOD_10,
                   BRFILE.BR_REB_METHOD_11,
                   BRFILE.BR_REBDAYS_MONTH_1,
                   BRFILE.BR_REBDAYS_MONTH_2,
                   BRFILE.BR_REBDAYS_MONTH_3,
                   BRFILE.BR_REBDAYS_MONTH_4,
                   BRFILE.BR_REBDAYS_MONTH_5,
                   BRFILE.BR_REBDAYS_MONTH_6,
                   BRFILE.BR_REBDAYS_MONTH_7,
                   BRFILE.BR_REBDAYS_MONTH_8,
                   BRFILE.BR_REBDAYS_MONTH_9,
                   BRFILE.BR_REBDAYS_MONTH_10,
                   BRFILE.BR_REBDAYS_MONTH_11,
                   BRFILE.BR_ACCRUAL_MONTHS_1,
                   BRFILE.BR_ACCRUAL_MONTHS_2,
                   BRFILE.BR_ACCRUAL_MONTHS_3,
                   BRFILE.BR_ACCRUAL_MONTHS_4,
                   BRFILE.BR_ACCRUAL_MONTHS_5,
                   BRFILE.BR_ACCRUAL_MONTHS_6,
                   BRFILE.BR_ACCRUAL_MONTHS_7,
                   BRFILE.BR_ACCRUAL_MONTHS_8,
                   BRFILE.BR_ACCRUAL_MONTHS_9,
                   BRFILE.BR_ACCRUAL_MONTHS_10,
                   BRFILE.BR_ACCRUAL_MONTHS_11,
                   BRFILE.BR_GLOVERSHORT,
                   BRFILE.BR_GLBANK,
                   BRFILE.BR_GLONHAND,
                   BRFILE.BR_BANKBAL,
                   BRFILE.BR_RETAIN_AMT,
                   BRFILE.BR_LCARDFG,
                   BRFILE.BR_DATA_PATH,
                   BRFILE.BR_MACHINE,
                   BRFILE.BR_MANAGER,
                   BRFILE.BR_EOD_PROCEDURE,
                   BRFILE.BR_BP_PAYOFF_NONCASH,
                   BRFILE.BR_BP_PAYOFF_OV,
                   BRFILE.BR_LI_DLCOMM_CMSI_O3_MAX,
                   BRFILE.BR_LR_GROUP_COLLID,
                   BRFILE.BR_UNITPER_FG,
                   BRFILE.BR_UNITPER_Y_D_FG,
                   BRFILE.BR_NO_PROMPT_FOR_OTHBR,
                   BRFILE.BR_WORLD_BRANCH_TYPE,
                   BRFILE.BR_COL_QUEUE_BEHAVIOR_FG,
                   BRFILE.BR_CONVERT_AUTO_ACCTNO,
                   BRFILE.BR_TS_REPO_INS_FG,
                   BRFILE.BR_BOOK_SF_BR_ONLY,
                   BRFILE.BR_FORCE_VALID_CITY_COUNTY,
                   BRFILE.BR_SET_COLLCD_DL_MFGCD,
                   BRFILE.BR_DEFAULT_SF_UNITPER_CD,
                   BRFILE.BR_DEFAULT_SF_PURCD,
                   BRFILE.BR_DEFAULT_LN_UNITPER_CD,
                   BRFILE.BR_DEFAULT_LN_PURCD,
                   BRFILE.BR_TAP_OTHER_DL,
                   BRFILE.BR_AH_AND_CL,
                   BRFILE.BR_NO_CASH_PROCEEDS,
                   BRFILE.BR_RI_BEFORE_REPO,
                   BRFILE.BR_RI_BEFORE_P4P5,
                   BRFILE.BR_NOT_OURS_REFUND,
                   BRFILE.BR_SFDLO3_WINDOW_FG,
                   BRFILE.BR_CALC_INS_ADJ,
                   BRFILE.BR_AC_BEFORE_REPO,
                   BRFILE.BR_AC_BEFORE_P4P5,
                   BRFILE.BR_BANK_ROUTING_NO,
                   BRFILE.BR_BANK_CLEARING_GL,
                   BRFILE.BR_GLBANK_DEPOSIT,
                   BRFILE.BR_BANK_ACCTNO,
                   BRFILE.BR_DEFAULT_SC_SUBCLASS,
                   BRFILE.BR_NO_OUT_DLR_RSV,
                   BRFILE.BR_COLLECTOR_QUEUE,
                   BRFILE.BR_COLL_QUEUE_CON_REC,
                   BRFILE.BR_JE_ALLOCATION_SKIP,
                   BRFILE.BR_EXPAND_APP_INPUT,
                   BRFILE.BR_A50_CPCORP,
                   BRFILE.BR_INBR_BILNSC_FG,
                   BRFILE.BR_INBR_BRIEF_FG,
                   BRFILE.BR_LEDGER_JUST_INTCHG,
                   BRFILE.BR_BYINQ_START_PAGE,
                   BRFILE.BR_DSINQ_START_PAGE,
                   BRFILE.BR_APP_REQUIRED_FOR_INPUT,
                   BRFILE.BR_CREDIT_SCORING_FG,
                   BRFILE.BR_COL_QUEUE_LOW_TO_HI,
                   BRFILE.BR_CAN_GROUP_ID,
                   BRFILE.BR_AUTO_LNSTAT_WINDOW,
                   BRFILE.BR_TIME_ZONE_FACTOR,
                   BRFILE.BR_LONPF_OPT_DISPLAY,
                   BRFILE.BR_GIFTNET,
                   BRFILE.BR_GIFTNET_LEDGER_LINE,
                   BRFILE.BR_NO_FT_EMP,
                   BRFILE.BR_NO_PT_EMP,
                   BRFILE.BR_BALLOON_LOANS_FG,
                   BRFILE.BR_GL_TYPE_ALLOWED,
                   BRFILE.BR_GL_ENTRY_DEFAULT,
                   BRFILE.BR_MIDSTREAM_1STPAY_FG,
                   BRFILE.BR_NODEF_1ST_X_MONTHS,
                   BRFILE.BR_ADD_INS_FEECODE,
                   BRFILE.BR_ROAD_G_SGL_FEECODE,
                   BRFILE.BR_ROAD_G_FAM_FEECODE,
                   BRFILE.BR_NODEF_IF_ZERO_AMT,
                   BRFILE.BR_ASSESS_LATE_CHGS,
                   BRFILE.BR_NEXT_SOLICIT_NO,
                   BRFILE.BR_ADDON_FEECD_O3_1,
                   BRFILE.BR_ADDON_FEECD_O3_2,
                   BRFILE.BR_IMMEDIATE_RECEIPT,
                   BRFILE.BR_IMMEDIATE_DOC_PRINT,
                   BRFILE.BR_AUTO_PL_REF_AC,
                   BRFILE.BR_FAX_NUMBER,
                   BRFILE.BR_ALPHA_DRAWERS,
                   BRFILE.BR_LATECHG_ON_ALLOTMENTS,
                   BRFILE.BR_ALLOW_SYS_AS_EFFDATE,
                   BRFILE.BR_TAX_PREBOOK_CUST,
                   BRFILE.BR_TAX_PREBOOK_NONCUST,
                   BRFILE.BR_PASSWORD_DRAWER,
                   BRFILE.BR_ONESTEP_RN_FG,
                   BRFILE.BR_LI_LISCAN_FG,
                   BRFILE.BR_HIDE_END_BAL,
                   BRFILE.BR_LBOX_NOPAYOFF,
                   BRFILE.BR_LBOX_ODDPAY,
                   BRFILE.BR_LBOX_LC,
                   BRFILE.BR_LBOX_NOPRIN,
                   BRFILE.BR_LBOX_FLASH,
                   BRFILE.BR_LBOX_ACTIONCD,
                   BRFILE.BR_LBOX_MAXCON,
                   BRFILE.BR_LBOX_MAXREC,
                   BRFILE.BR_LBOX_PL,
                   BRFILE.BR_LBOX_JD,
                   BRFILE.BR_LBOX,
                   BRFILE.BR_LATECHG_ON_LBOX,
                   BRFILE.BR_ALLOW_OV_TRCD,
                   BRFILE.BR_GLOBAL_QUEUE,
                   BRFILE.BR_LBOX_PAYOFF_NONCASH,
                   BRFILE.BR_LBOX_PAYOFF_OV,
                   BRFILE.BR_COLLECT_MANAGER,
                   BRFILE.BR_COLLECT_PHONE,
                   BRFILE.BR_COLLECT_EXT,
                   BRFILE.BR_ALT_INTO_THIS_BRANCH,
                   BRFILE.BR_POFF_TITLE_WINDOW,
                   BRFILE.BR_COUPON_STATEMENT,
                   BRFILE.BR_SUPERVISOR,
                   BRFILE.BR_AREA_MANAGER,
                   BRFILE.BR_MIN_MONTHS_DEF,
                   BRFILE.BR_CC_FLAG,
                   BRFILE.BR_CC_ADR1,
                   BRFILE.BR_CC_CITY,
                   BRFILE.BR_CC_STATE,
                   BRFILE.BR_CC_ZIP,
                   BRFILE.BR_MIN_MONTHS_D2,
                   BRFILE.BR_SKIP_MIDSTREAM_TRW,
                   BRFILE.BR_GL_ESCROW_BALANCE,
                   BRFILE.BR_GL_ESCROW_PAYABLE,
                   BRFILE.BR_ALLOW_FORCE_OPEN_FG,
                   BRFILE.BR_ACH_BANK_NO,
                   BRFILE.BR_WIMENU_CHECK_WRITING,
                   BRFILE.BR_ADP_PAY_GROUP,
                   BRFILE.BR_ALLOW_SCANNED_CKS,
                   BRFILE.BR_CHECK_DEPOSIT_GL,
                   BRFILE.BR_OPTION_PST_LASER,
                   BRFILE.BR_USE_DEBIT_CARDS,
                   BRFILE.BR_GL_DEBIT_CARD_PROCEEDS,
                   BRFILE.BR_WKDAY_BANKID,
                   BRFILE.BR_PURGE_NOW_FLAG,
                   BRFILE.BR_EMAIL,
                   BRFILE.BR_MANAGER_EMAIL,
                   BRFILE.BR_VERITEC_LICENSE,
                   BRFILE.BR_TEST_PP_AUTO_INSCOVR,
                   BRFILE.BR_USE_NEW_WFARGO_ACCT,
                   BRFILE.BR_BRANCH_CLOSED,
                   BRFILE.BR_ALLOW_F3_ALL_DOCS
            FROM DBO.BRFILE
            WHERE BRFILE.BR_NO >= :QBR-WBEG-NO
              AND BRFILE.BR_NO <= :QBR-WEND-NO
            ORDER BY BR_NO
           END-EXEC.

           EXEC SQL
               OPEN BR_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QBR-WBEG-NO
                          QBR-WEND-NO.

           MOVE STAT---GOOD TO BR-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-BR-FILE.
           PERFORM READ-IT.
           MOVE BR-PATH-SQL TO E-FILE.
           MOVE BR-NO TO E-KEYX.

           IF ( EXT-TCLP-TRACE-BRANCH )
              STRING "READ-BR-FILE | ", BR-NO
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

           INITIALIZE QBR-REC.

           MOVE BR-NO TO QBR-NO.

           EXEC SQL
            SELECT BRFILE.BR_NO,
                   CAST(BRFILE.BR_LTOUCH_DATE AS VARCHAR(10)),
                   BRFILE.BR_NAME,
                   BRFILE.BR_ADR1,
                   BRFILE.BR_ADR2,
                   BRFILE.BR_CITY,
                   BRFILE.BR_STATE,
                   BRFILE.BR_ZIP,
                   BRFILE.BR_PHONE,
                   BRFILE.BR_RETAIN,
                   BRFILE.BR_NEXT_CHECK,
                   BRFILE.BR_PRINTER_1,
                   BRFILE.BR_PRINTER_2,
                   BRFILE.BR_PRINTER_3,
                   BRFILE.BR_PRINTER_4,
                   BRFILE.BR_FEE_GL_BRNO,
                   BRFILE.BR_REMIT1,
                   BRFILE.BR_REMIT2,
                   BRFILE.BR_REMIT3,
                   BRFILE.BR_STMNT1,
                   BRFILE.BR_STMNT2,
                   BRFILE.BR_INS_PRODUCER_NUM,
                   BRFILE.BR_DLRCHK,
                   BRFILE.BR_FRONT_END_FG,
                   BRFILE.BR_EMLNRG_PHONE,
                   BRFILE.BR_POST_GL,
                   BRFILE.BR_ALLOTMNTS,
                   BRFILE.BR_EXTRACT_AUTO_UPD,
                   BRFILE.BR_PCNI_LEDGER,
                   BRFILE.BR_PRINTERFG_1,
                   BRFILE.BR_PRINTERFG_2,
                   BRFILE.BR_PRINTERFG_3,
                   BRFILE.BR_PRINTERFG_4,
                   BRFILE.BR_NEGDLRSV,
                   BRFILE.BR_CPCORP_ORDER,
                   BRFILE.BR_PRIO_MEMO_FLAG,
                   BRFILE.BR_PREBILL_PL_JD_OPT,
                   BRFILE.BR_LOAN_NUM_FLAG,
                   BRFILE.BR_DOWNPY_FLAG,
                   BRFILE.BR_AUTO_INS_EARN,
                   BRFILE.BR_OTH_INS_LEVELS,
                   BRFILE.BR_ALLOW_INTERBR,
                   BRFILE.BR_UNER_DLANRP,
                   BRFILE.BR_SECOND_PROMISE,
                   BRFILE.BR_AVAIL_CREDIT,
                   BRFILE.BR_RECP1,
                   BRFILE.BR_RECP2,
                   BRFILE.BR_INC_WAIVERS,
                   BRFILE.BR_INC_INS,
                   BRFILE.BR_BP_NEXT_BATCH,
                   BRFILE.BR_BP_NOPAYOFF,
                   BRFILE.BR_BP_ODDPAY,
                   BRFILE.BR_BP_LC,
                   BRFILE.BR_BP_NOPRIN,
                   BRFILE.BR_BP_FLASH,
                   BRFILE.BR_BP_ACTIONCD,
                   BRFILE.BR_BP_MAXCON,
                   BRFILE.BR_BP_MAXREC,
                   BRFILE.BR_BP_PL,
                   BRFILE.BR_BP_JD,
                   BRFILE.BR_BP_BRANCH,
                   BRFILE.BR_AGE_ERN,
                   BRFILE.BR_OTHER_BRANCH_GL,
                   BRFILE.BR_SALES_SMALL,
                   BRFILE.BR_NEW_COLL_INQUIRY,
                   BRFILE.BR_CHANGE_MEMO,
                   BRFILE.BR_INS_ADDON,
                   BRFILE.BR_TRAILER_REC,
                   BRFILE.BR_ALDEL_FLAG,
                   BRFILE.BR_IB_LCHG_MESS,
                   BRFILE.BR_COL_QUEUE_PAST_DUE,
                   BRFILE.BR_LI_DLCOMM_CMSI_PP_MAX,
                   BRFILE.BR_ADDON_FEECD_O2_1,
                   BRFILE.BR_ADDON_FEECD_O2_2,
                   BRFILE.BR_AUTO_CHECK,
                   BRFILE.BR_RECEIPT_PROMDATE,
                   BRFILE.BR_RECEIPT_INTPD,
                   BRFILE.BR_COLL_ID_SCAN,
                   BRFILE.BR_STOP_ON_COLL,
                   BRFILE.BR_DUEDATE_CHANGE_CD,
                   BRFILE.BR_CHECK_EOM_FG,
                   BRFILE.BR_VOLUME_DLANRP,
                   BRFILE.BR_PDTH_NXDUE,
                   BRFILE.BR_LC_CODE,
                   BRFILE.BR_VALIDATE_PRUS,
                   BRFILE.BR_AUTO_OPEN_BAL,
                   BRFILE.BR_OPEN_BAL_1,
                   BRFILE.BR_OPEN_BAL_2,
                   BRFILE.BR_OPEN_BAL_3,
                   BRFILE.BR_OPEN_BAL_4,
                   BRFILE.BR_OPEN_BAL_5,
                   BRFILE.BR_OPEN_BAL_6,
                   BRFILE.BR_OPEN_BAL_7,
                   BRFILE.BR_OPEN_BAL_8,
                   BRFILE.BR_OPEN_BAL_9,
                   BRFILE.BR_OPEN_BAL_10,
                   BRFILE.BR_OPEN_BAL_11,
                   BRFILE.BR_OPEN_BAL_12,
                   BRFILE.BR_OPEN_BAL_13,
                   BRFILE.BR_OPEN_BAL_14,
                   BRFILE.BR_OPEN_BAL_15,
                   BRFILE.BR_OPEN_BAL_16,
                   BRFILE.BR_OPEN_BAL_17,
                   BRFILE.BR_OPEN_BAL_18,
                   BRFILE.BR_OPEN_BAL_19,
                   BRFILE.BR_OPEN_BAL_20,
                   BRFILE.BR_TENDER_CD_1,
                   BRFILE.BR_TENDER_CD_2,
                   BRFILE.BR_TENDER_CD_3,
                   BRFILE.BR_DLPARV_ADJ_FG,
                   BRFILE.BR_OVERRIDE_BR_STATE,
                   BRFILE.BR_DEFAULT_SC_CLASS,
                   BRFILE.BR_RECDEL_NOT_REC,
                   BRFILE.BR_POST_AHEAD_FG,
                   BRFILE.BR_CAN_LOANS_FG,
                   BRFILE.BR_NON_MONTHLY_CAN_LOANS,
                   BRFILE.BR_BP_ALLOW_PMT_ACCT_OTHBAL,
                   BRFILE.BR_LBOX_ALLOW_PMT_ACCT_OTHBAL,
                   BRFILE.BR_REGION_NUMBER,
                   BRFILE.BR_OUR_FEE,
                   BRFILE.BR_REB_METHOD_1,
                   BRFILE.BR_REB_METHOD_2,
                   BRFILE.BR_REB_METHOD_3,
                   BRFILE.BR_REB_METHOD_4,
                   BRFILE.BR_REB_METHOD_5,
                   BRFILE.BR_REB_METHOD_6,
                   BRFILE.BR_REB_METHOD_7,
                   BRFILE.BR_REB_METHOD_8,
                   BRFILE.BR_REB_METHOD_9,
                   BRFILE.BR_REB_METHOD_10,
                   BRFILE.BR_REB_METHOD_11,
                   BRFILE.BR_REBDAYS_MONTH_1,
                   BRFILE.BR_REBDAYS_MONTH_2,
                   BRFILE.BR_REBDAYS_MONTH_3,
                   BRFILE.BR_REBDAYS_MONTH_4,
                   BRFILE.BR_REBDAYS_MONTH_5,
                   BRFILE.BR_REBDAYS_MONTH_6,
                   BRFILE.BR_REBDAYS_MONTH_7,
                   BRFILE.BR_REBDAYS_MONTH_8,
                   BRFILE.BR_REBDAYS_MONTH_9,
                   BRFILE.BR_REBDAYS_MONTH_10,
                   BRFILE.BR_REBDAYS_MONTH_11,
                   BRFILE.BR_ACCRUAL_MONTHS_1,
                   BRFILE.BR_ACCRUAL_MONTHS_2,
                   BRFILE.BR_ACCRUAL_MONTHS_3,
                   BRFILE.BR_ACCRUAL_MONTHS_4,
                   BRFILE.BR_ACCRUAL_MONTHS_5,
                   BRFILE.BR_ACCRUAL_MONTHS_6,
                   BRFILE.BR_ACCRUAL_MONTHS_7,
                   BRFILE.BR_ACCRUAL_MONTHS_8,
                   BRFILE.BR_ACCRUAL_MONTHS_9,
                   BRFILE.BR_ACCRUAL_MONTHS_10,
                   BRFILE.BR_ACCRUAL_MONTHS_11,
                   BRFILE.BR_GLOVERSHORT,
                   BRFILE.BR_GLBANK,
                   BRFILE.BR_GLONHAND,
                   BRFILE.BR_BANKBAL,
                   BRFILE.BR_RETAIN_AMT,
                   BRFILE.BR_LCARDFG,
                   BRFILE.BR_DATA_PATH,
                   BRFILE.BR_MACHINE,
                   BRFILE.BR_MANAGER,
                   BRFILE.BR_EOD_PROCEDURE,
                   BRFILE.BR_BP_PAYOFF_NONCASH,
                   BRFILE.BR_BP_PAYOFF_OV,
                   BRFILE.BR_LI_DLCOMM_CMSI_O3_MAX,
                   BRFILE.BR_LR_GROUP_COLLID,
                   BRFILE.BR_UNITPER_FG,
                   BRFILE.BR_UNITPER_Y_D_FG,
                   BRFILE.BR_NO_PROMPT_FOR_OTHBR,
                   BRFILE.BR_WORLD_BRANCH_TYPE,
                   BRFILE.BR_COL_QUEUE_BEHAVIOR_FG,
                   BRFILE.BR_CONVERT_AUTO_ACCTNO,
                   BRFILE.BR_TS_REPO_INS_FG,
                   BRFILE.BR_BOOK_SF_BR_ONLY,
                   BRFILE.BR_FORCE_VALID_CITY_COUNTY,
                   BRFILE.BR_SET_COLLCD_DL_MFGCD,
                   BRFILE.BR_DEFAULT_SF_UNITPER_CD,
                   BRFILE.BR_DEFAULT_SF_PURCD,
                   BRFILE.BR_DEFAULT_LN_UNITPER_CD,
                   BRFILE.BR_DEFAULT_LN_PURCD,
                   BRFILE.BR_TAP_OTHER_DL,
                   BRFILE.BR_AH_AND_CL,
                   BRFILE.BR_NO_CASH_PROCEEDS,
                   BRFILE.BR_RI_BEFORE_REPO,
                   BRFILE.BR_RI_BEFORE_P4P5,
                   BRFILE.BR_NOT_OURS_REFUND,
                   BRFILE.BR_SFDLO3_WINDOW_FG,
                   BRFILE.BR_CALC_INS_ADJ,
                   BRFILE.BR_AC_BEFORE_REPO,
                   BRFILE.BR_AC_BEFORE_P4P5,
                   BRFILE.BR_BANK_ROUTING_NO,
                   BRFILE.BR_BANK_CLEARING_GL,
                   BRFILE.BR_GLBANK_DEPOSIT,
                   BRFILE.BR_BANK_ACCTNO,
                   BRFILE.BR_DEFAULT_SC_SUBCLASS,
                   BRFILE.BR_NO_OUT_DLR_RSV,
                   BRFILE.BR_COLLECTOR_QUEUE,
                   BRFILE.BR_COLL_QUEUE_CON_REC,
                   BRFILE.BR_JE_ALLOCATION_SKIP,
                   BRFILE.BR_EXPAND_APP_INPUT,
                   BRFILE.BR_A50_CPCORP,
                   BRFILE.BR_INBR_BILNSC_FG,
                   BRFILE.BR_INBR_BRIEF_FG,
                   BRFILE.BR_LEDGER_JUST_INTCHG,
                   BRFILE.BR_BYINQ_START_PAGE,
                   BRFILE.BR_DSINQ_START_PAGE,
                   BRFILE.BR_APP_REQUIRED_FOR_INPUT,
                   BRFILE.BR_CREDIT_SCORING_FG,
                   BRFILE.BR_COL_QUEUE_LOW_TO_HI,
                   BRFILE.BR_CAN_GROUP_ID,
                   BRFILE.BR_AUTO_LNSTAT_WINDOW,
                   BRFILE.BR_TIME_ZONE_FACTOR,
                   BRFILE.BR_LONPF_OPT_DISPLAY,
                   BRFILE.BR_GIFTNET,
                   BRFILE.BR_GIFTNET_LEDGER_LINE,
                   BRFILE.BR_NO_FT_EMP,
                   BRFILE.BR_NO_PT_EMP,
                   BRFILE.BR_BALLOON_LOANS_FG,
                   BRFILE.BR_GL_TYPE_ALLOWED,
                   BRFILE.BR_GL_ENTRY_DEFAULT,
                   BRFILE.BR_MIDSTREAM_1STPAY_FG,
                   BRFILE.BR_NODEF_1ST_X_MONTHS,
                   BRFILE.BR_ADD_INS_FEECODE,
                   BRFILE.BR_ROAD_G_SGL_FEECODE,
                   BRFILE.BR_ROAD_G_FAM_FEECODE,
                   BRFILE.BR_NODEF_IF_ZERO_AMT,
                   BRFILE.BR_ASSESS_LATE_CHGS,
                   BRFILE.BR_NEXT_SOLICIT_NO,
                   BRFILE.BR_ADDON_FEECD_O3_1,
                   BRFILE.BR_ADDON_FEECD_O3_2,
                   BRFILE.BR_IMMEDIATE_RECEIPT,
                   BRFILE.BR_IMMEDIATE_DOC_PRINT,
                   BRFILE.BR_AUTO_PL_REF_AC,
                   BRFILE.BR_FAX_NUMBER,
                   BRFILE.BR_ALPHA_DRAWERS,
                   BRFILE.BR_LATECHG_ON_ALLOTMENTS,
                   BRFILE.BR_ALLOW_SYS_AS_EFFDATE,
                   BRFILE.BR_TAX_PREBOOK_CUST,
                   BRFILE.BR_TAX_PREBOOK_NONCUST,
                   BRFILE.BR_PASSWORD_DRAWER,
                   BRFILE.BR_ONESTEP_RN_FG,
                   BRFILE.BR_LI_LISCAN_FG,
                   BRFILE.BR_HIDE_END_BAL,
                   BRFILE.BR_LBOX_NOPAYOFF,
                   BRFILE.BR_LBOX_ODDPAY,
                   BRFILE.BR_LBOX_LC,
                   BRFILE.BR_LBOX_NOPRIN,
                   BRFILE.BR_LBOX_FLASH,
                   BRFILE.BR_LBOX_ACTIONCD,
                   BRFILE.BR_LBOX_MAXCON,
                   BRFILE.BR_LBOX_MAXREC,
                   BRFILE.BR_LBOX_PL,
                   BRFILE.BR_LBOX_JD,
                   BRFILE.BR_LBOX,
                   BRFILE.BR_LATECHG_ON_LBOX,
                   BRFILE.BR_ALLOW_OV_TRCD,
                   BRFILE.BR_GLOBAL_QUEUE,
                   BRFILE.BR_LBOX_PAYOFF_NONCASH,
                   BRFILE.BR_LBOX_PAYOFF_OV,
                   BRFILE.BR_COLLECT_MANAGER,
                   BRFILE.BR_COLLECT_PHONE,
                   BRFILE.BR_COLLECT_EXT,
                   BRFILE.BR_ALT_INTO_THIS_BRANCH,
                   BRFILE.BR_POFF_TITLE_WINDOW,
                   BRFILE.BR_COUPON_STATEMENT,
                   BRFILE.BR_SUPERVISOR,
                   BRFILE.BR_AREA_MANAGER,
                   BRFILE.BR_MIN_MONTHS_DEF,
                   BRFILE.BR_CC_FLAG,
                   BRFILE.BR_CC_ADR1,
                   BRFILE.BR_CC_CITY,
                   BRFILE.BR_CC_STATE,
                   BRFILE.BR_CC_ZIP,
                   BRFILE.BR_MIN_MONTHS_D2,
                   BRFILE.BR_SKIP_MIDSTREAM_TRW,
                   BRFILE.BR_GL_ESCROW_BALANCE,
                   BRFILE.BR_GL_ESCROW_PAYABLE,
                   BRFILE.BR_ALLOW_FORCE_OPEN_FG,
                   BRFILE.BR_ACH_BANK_NO,
                   BRFILE.BR_WIMENU_CHECK_WRITING,
                   BRFILE.BR_ADP_PAY_GROUP,
                   BRFILE.BR_ALLOW_SCANNED_CKS,
                   BRFILE.BR_CHECK_DEPOSIT_GL,
                   BRFILE.BR_OPTION_PST_LASER,
                   BRFILE.BR_USE_DEBIT_CARDS,
                   BRFILE.BR_GL_DEBIT_CARD_PROCEEDS,
                   BRFILE.BR_WKDAY_BANKID,
                   BRFILE.BR_PURGE_NOW_FLAG,
                   BRFILE.BR_EMAIL,
                   BRFILE.BR_MANAGER_EMAIL,
                   BRFILE.BR_VERITEC_LICENSE,
                   BRFILE.BR_TEST_PP_AUTO_INSCOVR,
                   BRFILE.BR_USE_NEW_WFARGO_ACCT,
                   BRFILE.BR_BRANCH_CLOSED,
                   BRFILE.BR_ALLOW_F3_ALL_DOCS
            INTO :QBR-REC
            FROM DBO.BRFILE
            WHERE BRFILE.BR_NO = :QBR-NO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO READ-BR-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-BR-FIELDS.

      *-----------------------------------------------------------------
       READ-BR-FILE-NEXT.
           PERFORM READ-IT.
           MOVE BR-PATH-SQL TO E-FILE.
           MOVE BR-NO TO E-KEYX.

           IF ( EXT-TCLP-TRACE-BRANCH )
              STRING "READ-BR-FILE-NEXT | ", BR-NO
                     DELIMITED BY SIZE INTO EXT-TCLP-TRACE-MESS
              CALL "TRACE" USING FORM-PATHNAME
              CANCEL "TRACE".

           INITIALIZE QBR-REC.

           IF ( BR-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH BR_CURSOR INTO :QBR-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO READ-BR-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-BR-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-BR-FILE.
           PERFORM CLOSE-IT.
           IF ( BR-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE BR_CURSOR
              END-EXEC
              MOVE STAT---BAD TO BR-CURSOR-STAT.
 
      *================================================================*
      * END COPYBOOK: LIBGB\GBBRRN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBGBRN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBGBRN
       LOAD-GB-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( GB-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( GB-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO GB-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO GB-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO GB-ALL-DATA
              MOVE GB-ALL-PATH             TO GB-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( GB-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO GB-ALL-BASE
              MOVE FILPATH-MACHINE         TO GB-ALL-MACHINE
              MOVE FILPATH-DATA            TO GB-ALL-DATA
              MOVE GB-ALL-PATH             TO GB-PATH.

      *-----------------------------------------------------------------
       OPEN-GB-FILE.
           PERFORM LOAD-GB-FILE.
           PERFORM OPEN-IT.
           MOVE GB-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-GB-FILE.
           PERFORM START-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.

           IF ( GB-CURSOR-STAT-GOOD )
              PERFORM CLOSE-GB-FILE.

           IF ( QGB-WEND-NO = ZEROES    ) OR
              ( QGB-WEND-NO NOT NUMERIC )
              MOVE GB-PATH-OWNBR    TO QGB-WBEG-BRNO
              MOVE GB-PATH-OWNBR    TO QGB-WEND-BRNO
              MOVE GB-NO            TO QGB-WBEG-NO
              MOVE 9                TO QGB-WEND-NO.

           EXEC SQL
            DECLARE GB_CURSOR CURSOR FOR
            SELECT GBFILE.GB_BRNO,
                   GBFILE.GB_NO,
                   CAST(GBFILE.GB_LTOUCH_DATE AS VARCHAR(10)),
                   GBFILE.GB_COMPANY_NAME,
                   GBFILE.GB_ADDR_1,
                   GBFILE.GB_ADDR_2,
                   GBFILE.GB_CITY,
                   GBFILE.GB_STATE,
                   GBFILE.GB_ZIP,
                   GBFILE.GB_PHONE,
                   GBFILE.GB_NEXT_SF,
                   GBFILE.GB_NEXT_SMALL,
                   GBFILE.GB_NEXT_OTHER,
                   GBFILE.GB_HOLIDAY_1,
                   GBFILE.GB_HOLIDAY_2,
                   GBFILE.GB_HOLIDAY_3,
                   GBFILE.GB_HOLIDAY_4,
                   GBFILE.GB_HOLIDAY_5,
                   GBFILE.GB_HOLIDAY_6,
                   GBFILE.GB_HOLIDAY_7,
                   GBFILE.GB_HOLIDAY_8,
                   GBFILE.GB_HOLIDAY_9,
                   GBFILE.GB_HOLIDAY_10,
                   GBFILE.GB_HOLIDAY_11,
                   GBFILE.GB_HOLIDAY_12,
                   GBFILE.GB_HOLIDAY_13,
                   GBFILE.GB_HOLIDAY_14,
                   GBFILE.GB_HOLIDAY_15,
                   GBFILE.GB_HOLIDAY_16,
                   GBFILE.GB_RPT_LINES,
                   GBFILE.GB_CHECK_PROG,
                   GBFILE.GB_OTHER_BRANCH_POST,
                   GBFILE.GB_LAST_ACCRUE,
                   GBFILE.GB_AUTO_DEPOSIT,
                   GBFILE.GB_UUCP_HOME,
                   GBFILE.GB_EOM_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOM_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOM_UPDATE_TIME,
                   GBFILE.GB_EOM_UPDATE_USERID,
                   GBFILE.GB_FISCAL_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYF_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYF_UPDATE_TIME,
                   GBFILE.GB_EOYF_UPDATE_USERID,
                   GBFILE.GB_CALENDAR_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYC_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYC_UPDATE_TIME,
                   GBFILE.GB_EOYC_UPDATE_USERID
            FROM DBO.GBFILE
            WHERE GBFILE.GB_BRNO = :QGB-WBEG-BRNO
              AND GBFILE.GB_NO >= :QGB-WBEG-NO
              AND GBFILE.GB_NO <= :QGB-WEND-NO
            ORDER BY GBFILE.GB_BRNO,
                     GBFILE.GB_NO
           END-EXEC.

           EXEC SQL
               OPEN GB_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QGB-WBEG-BRNO 
                          QGB-WEND-BRNO
                          QGB-WBEG-NO
                          QGB-WEND-NO.

           MOVE STAT---GOOD TO GB-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-GB-FILE.
           PERFORM READ-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO. 
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           INITIALIZE QGB-REC.

           MOVE GB-BRNO   TO QGB-BRNO.
           MOVE GB-NO     TO QGB-NO.

           EXEC SQL
            SELECT GBFILE.GB_BRNO,
                   GBFILE.GB_NO,
                   CAST(GBFILE.GB_LTOUCH_DATE AS VARCHAR(10)),
                   GBFILE.GB_COMPANY_NAME,
                   GBFILE.GB_ADDR_1,
                   GBFILE.GB_ADDR_2,
                   GBFILE.GB_CITY,
                   GBFILE.GB_STATE,
                   GBFILE.GB_ZIP,
                   GBFILE.GB_PHONE,
                   GBFILE.GB_NEXT_SF,
                   GBFILE.GB_NEXT_SMALL,
                   GBFILE.GB_NEXT_OTHER,
                   GBFILE.GB_HOLIDAY_1,
                   GBFILE.GB_HOLIDAY_2,
                   GBFILE.GB_HOLIDAY_3,
                   GBFILE.GB_HOLIDAY_4,
                   GBFILE.GB_HOLIDAY_5,
                   GBFILE.GB_HOLIDAY_6,
                   GBFILE.GB_HOLIDAY_7,
                   GBFILE.GB_HOLIDAY_8,
                   GBFILE.GB_HOLIDAY_9,
                   GBFILE.GB_HOLIDAY_10,
                   GBFILE.GB_HOLIDAY_11,
                   GBFILE.GB_HOLIDAY_12,
                   GBFILE.GB_HOLIDAY_13,
                   GBFILE.GB_HOLIDAY_14,
                   GBFILE.GB_HOLIDAY_15,
                   GBFILE.GB_HOLIDAY_16,
                   GBFILE.GB_RPT_LINES,
                   GBFILE.GB_CHECK_PROG,
                   GBFILE.GB_OTHER_BRANCH_POST,
                   GBFILE.GB_LAST_ACCRUE,
                   GBFILE.GB_AUTO_DEPOSIT,
                   GBFILE.GB_UUCP_HOME,
                   GBFILE.GB_EOM_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOM_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOM_UPDATE_TIME,
                   GBFILE.GB_EOM_UPDATE_USERID,
                   GBFILE.GB_FISCAL_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYF_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYF_UPDATE_TIME,
                   GBFILE.GB_EOYF_UPDATE_USERID,
                   GBFILE.GB_CALENDAR_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYC_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYC_UPDATE_TIME,
                   GBFILE.GB_EOYC_UPDATE_USERID
            INTO :QGB-REC
            FROM DBO.GBFILE
            WHERE GBFILE.GB_BRNO = :QGB-BRNO
              AND GBFILE.GB_NO = :QGB-NO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GB-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-GB-FIELDS.

      *-----------------------------------------------------------------
       READ-GB-FILE-NEXT.
           PERFORM READ-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           INITIALIZE QGB-REC.

           IF ( GB-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH GB_CURSOR INTO :QGB-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GB-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-GB-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-GB-FILE.

           PERFORM CLOSE-IT.
           IF ( GB-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE GB_CURSOR
              END-EXEC
              MOVE STAT---BAD TO GB-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBGB\GBGBRN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPEDPATHIO.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPEDPATHIO
      *-----------------------------------------------------------------
       LOAD-OPEN-FILE.

      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( OPEN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( OPEN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO OPEN-PATH-BASE
              MOVE EXT-FILPATH-MACHINE     TO OPEN-PATH-MACHINE
              MOVE OPEN-PATH-FORMAT        TO OPEN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( OPEN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO OPEN-PATH-BASE
              MOVE FILPATH-MACHINE         TO OPEN-PATH-MACHINE
              MOVE OPEN-PATH-FORMAT        TO OPEN-PATH.

      *-----------------------------------------------------------------
       LOAD-CLOSE-FILE.

      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
      *    IF ( CLOSE-PATH-OVERRIDE = "Y" ) 
      *       NEXT SENTENCE
      *    ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
      *    IF ( CLOSE-PATH-OVERRIDE = SPACES ) 
      *       MOVE EXT-FILPATH-BASE        TO CLOSE-PATH-BASE
      *       MOVE EXT-FILPATH-MACHINE     TO CLOSE-PATH-MACHINE
      *       MOVE CLOSE-PATH-FORMAT       TO CLOSE-PATH
      *    ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
      *    IF ( CLOSE-PATH-OVERRIDE = "B" ) 
      *       MOVE FILPATH-BASE            TO CLOSE-PATH-BASE
      *       MOVE FILPATH-MACHINE         TO CLOSE-PATH-MACHINE
      *       MOVE CLOSE-PATH-FORMAT       TO CLOSE-PATH.

      *-----------------------------------------------------------------
       LOAD-UPDATE-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
      *    IF ( UPDATE-PATH-OVERRIDE = "Y" ) 
      *       NEXT SENTENCE
      *    ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
      *    IF ( UPDATE-PATH-OVERRIDE = SPACES ) 
      *       MOVE EXT-FILPATH-BASE        TO UPDATE-PATH-BASE
      *       MOVE EXT-FILPATH-MACHINE     TO UPDATE-PATH-MACHINE
      *       MOVE UPDATE-PATH-FORMAT      TO UPDATE-PATH
      *    ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
      *    IF ( UPDATE-PATH-OVERRIDE = "B" ) 
      *       MOVE FILPATH-BASE            TO UPDATE-PATH-BASE
      *       MOVE FILPATH-MACHINE         TO UPDATE-PATH-MACHINE
      *       MOVE UPDATE-PATH-FORMAT      TO UPDATE-PATH.
      *================================================================*
      * END COPYBOOK: LIBLP\LPEDPATHIO.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPSP1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPSP1RN
      ******************************************************************
       SET-ALL-TO-SP1.
           MOVE SPA1-KEY   TO SP1-KEY.
           MOVE SPA-AREA-A TO SP-AREA-A.
           MOVE SPB-AREA-B TO SP-AREA-B.
           MOVE SPC-AREA-C TO SP-AREA-C.

       SET-SP1-TO-ALL.
           MOVE SP1-KEY   TO SPA1-KEY.
           MOVE SP-AREA-A TO SPA-AREA-A.
           MOVE SP1-KEY   TO SPB1-KEY.
           MOVE SP-AREA-B TO SPB-AREA-B.
           MOVE SP1-KEY   TO SPC1-KEY.
           MOVE SP-AREA-C TO SPC-AREA-C.

       LOAD-SP1-FILE.
           PERFORM LOAD-SPA1-FILE.
           PERFORM LOAD-SPB1-FILE.
           PERFORM LOAD-SPC1-FILE.

      *-----------------------------------------------------------------
       OPEN-SP1-FILE.
           PERFORM OPEN-SPA1-FILE.
           IF ( IO-FG = 0 )
               PERFORM OPEN-SPB1-FILE
               IF ( IO-FG = 0 )
                  PERFORM OPEN-SPC1-FILE
                  IF ( IO-FG = 0 )
                     MOVE " " TO IO-MULTI-FG
                  ELSE
                     MOVE "C" TO IO-MULTI-FG
               ELSE
                  MOVE "B" TO IO-MULTI-FG
            ELSE
               MOVE "A" TO IO-MULTI-FG.

      *-----------------------------------------------------------------
       START-SP1-FILE.
           PERFORM SET-SP1-TO-ALL.
           PERFORM START-SPA1-FILE.
           IF ( IO-FG NOT = 0 )
              MOVE "A" TO IO-MULTI-FG.
             
      *-----------------------------------------------------------------
       READ-SP1-FILE.
           PERFORM SET-SP1-TO-ALL.
           PERFORM READ-SPA1-FILE.
           IF ( IO-FG = 0 )
              PERFORM READ-SPB1-FILE
              IF ( IO-FG = 0 )
                 PERFORM READ-SPC1-FILE
                 IF ( IO-FG = 0 )
                    PERFORM SET-ALL-TO-SP1
                 ELSE
                    MOVE "C" TO IO-MULTI-FG
              ELSE
                 MOVE "B" TO IO-MULTI-FG
           ELSE
              MOVE "A" TO IO-MULTI-FG.

      *-----------------------------------------------------------------
       READ-SP1-FILE-NEXT.
           PERFORM SET-SP1-TO-ALL.
           PERFORM READ-SPA1-FILE-NEXT.
           IF ( IO-FG = 0 )
              MOVE SPA1-KEY TO SPB1-KEY
              PERFORM READ-SPB1-FILE
              IF ( IO-FG = 0 )
                 MOVE SPA1-KEY TO SPC1-KEY
                 PERFORM READ-SPC1-FILE
                 IF ( IO-FG = 0 )
                    PERFORM SET-ALL-TO-SP1
                 ELSE
                    MOVE "C" TO IO-MULTI-FG
              ELSE
                 MOVE "B" TO IO-MULTI-FG
           ELSE
              MOVE "A" TO IO-MULTI-FG.

      *-----------------------------------------------------------------
       CLOSE-SP1-FILE.
           PERFORM CLOSE-SPA1-FILE.
           PERFORM CLOSE-SPB1-FILE.
           PERFORM CLOSE-SPC1-FILE.

      *================================================================E
       LOAD-SPA1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( SP-PATH-OVERRIDE = "Y" )
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( SP-PATH-OVERRIDE = SPACES )
              MOVE EXT-FILPATH-BASE        TO SPA-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO SPA-ALL-MACHINE
              MOVE SPA-ALL-PATH             TO SPA-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( SP-PATH-OVERRIDE = "B" )
              MOVE FILPATH-BASE            TO SPA-ALL-BASE
              MOVE FILPATH-MACHINE         TO SPA-ALL-MACHINE
              MOVE SPA-ALL-PATH             TO SPA-PATH.

      *-----------------------------------------------------------------
       OPEN-SPA1-FILE.
           PERFORM LOAD-SPA1-FILE.
           PERFORM OPEN-IT.
           MOVE SPA-PATH-SQL TO E-FILE.
      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-SPA1-FILE.
           PERFORM START-IT.
           MOVE SPA-PATH-SQL TO E-FILE.
           MOVE SPA1-KEY TO E-KEYX.

           IF ( SPA1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-SPA1-FILE.

           IF ( QSP1-WEND-LAWCODE = 0  ) OR
              ( QSP1-WEND-LAWCODE NOT NUMERIC)
              MOVE SPA-ORGST            TO QSP1-WBEG-ORGST 
              MOVE ALL "Z"              TO QSP1-WEND-ORGST 
              MOVE SPA-SPRCLASS         TO QSP1-WBEG-SPRCLASS
              MOVE ALL "9"              TO QSP1-WEND-SPRCLASS
              MOVE SPA-SUBCLASS         TO QSP1-WBEG-SUBCLASS
              MOVE ALL "9"              TO QSP1-WEND-SUBCLASS
              MOVE SPA-LAWCODE          TO QSP1-WBEG-LAWCODE
              MOVE ALL "9"              TO QSP1-WEND-LAWCODE.

           EXEC SQL
            DECLARE SPA1_CURSOR CURSOR FOR
            SELECT SPAFILE.SPA_ORGST,
                   SPAFILE.SPA_SPRCLASS,
                   SPAFILE.SPA_SUBCLASS,
                   SPAFILE.SPA_LAWCODE,
                   CAST(SPAFILE.SPA_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   SPAFILE.SPA_DESC,
                   SPAFILE.SPA_NOTES,
                   CAST(SPAFILE.SPA_EFFDATE
                                                  AS VARCHAR(10)),
                   CAST(SPAFILE.SPA_EXPDATE
                                                  AS VARCHAR(10)),
                   SPAFILE.SPA_EXPD_MONTHS,
                   SPAFILE.SPA_EXPD_DAYS,
                   SPAFILE.SPA_EXPD_FRMLA,
                   SPAFILE.SPA_EXPD_EXCEPT,
                   SPAFILE.SPA_EXPR_FRMLA,
                   SPAFILE.SPA_EXPR_REDU_FRMLA,
                   SPAFILE.SPA_EXPR_RATE_1,
                   SPAFILE.SPA_EXPR_BREAK_1,
                   SPAFILE.SPA_EXPR_YRTYPE_1,
                   SPAFILE.SPA_EXPR_INTMETH_1,
                   SPAFILE.SPA_EXPR_RATE_2,
                   SPAFILE.SPA_EXPR_BREAK_2,
                   SPAFILE.SPA_EXPR_YRTYPE_2,
                   SPAFILE.SPA_EXPR_INTMETH_2,
                   SPAFILE.SPA_EXPR_RATE_3,
                   SPAFILE.SPA_EXPR_BREAK_3,
                   SPAFILE.SPA_EXPR_YRTYPE_3,
                   SPAFILE.SPA_EXPR_INTMETH_3,
                   SPAFILE.SPA_EXPR_RATE_4,
                   SPAFILE.SPA_EXPR_BREAK_4,
                   SPAFILE.SPA_EXPR_YRTYPE_4,
                   SPAFILE.SPA_EXPR_INTMETH_4,
                   SPAFILE.SPA_EXPR_RATE_5,
                   SPAFILE.SPA_EXPR_BREAK_5,
                   SPAFILE.SPA_EXPR_YRTYPE_5,
                   SPAFILE.SPA_EXPR_INTMETH_5,
                   SPAFILE.SPA_EXPR_LCHG,
                   SPAFILE.SPA_JUDGFRMLA,
                   SPAFILE.SPA_JUDGRATE,
                   SPAFILE.SPA_JUDGYRTYPE,
                   SPAFILE.SPA_JUDGINTMETH,
                   SPAFILE.SPA_ACC_FRMLA,
                   SPAFILE.SPA_ACC_YRTYPE,
                   SPAFILE.SPA_ACC_INTMETH,
                   SPAFILE.SPA_ACC_RATE_1,
                   SPAFILE.SPA_ACC_BREAK_1,
                   SPAFILE.SPA_ACC_RATE_2,
                   SPAFILE.SPA_ACC_BREAK_2,
                   SPAFILE.SPA_ACC_RATE_3,
                   SPAFILE.SPA_ACC_BREAK_3,
                   SPAFILE.SPA_ACC_RATE_4,
                   SPAFILE.SPA_ACC_BREAK_4,
                   SPAFILE.SPA_ACC_RATE_5,
                   SPAFILE.SPA_ACC_BREAK_5,
                   SPAFILE.SPA_1098FRMLA,
                   SPAFILE.SPA_DISFRMLA,
                   SPAFILE.SPA_CONTRFRMLA,
                   SPAFILE.SPA_BANKRULE,
                   SPAFILE.SPA_CONTPDTH,
                   SPAFILE.SPA_FINCHG,
                   SPAFILE.SPA_BANKUNITPER_CD,
                   SPAFILE.SPA_TRWBANKRULE,
                   SPAFILE.SPA_TRWCONTPDTH,
                   SPAFILE.SPA_TRWBANKUNITPER_CD,
                   SPAFILE.SPA_RECFRMLA,
                   SPAFILE.SPA_RECPAYCD,
                   SPAFILE.SPA_RECPDTH,
                   SPAFILE.SPA_DISFRMLA_SPAY_FG,
                   SPAFILE.SPA_ERNFRMLA_1,
                   SPAFILE.SPA_ERNAMT_1,
                   SPAFILE.SPA_ERNPERCT_1,
                   SPAFILE.SPA_ERNPERCD_1,
                   SPAFILE.SPA_ERNACCRL_FG_1,
                   SPAFILE.SPA_ERNACCRL_START_CD_1,
                   SPAFILE.SPA_ERNACCRL_DFCD_1,
                   SPAFILE.SPA_ERN_DAYS_1,
                   SPAFILE.SPA_ERN_TERM_1,
                   SPAFILE.SPA_ERN_TYPE_1,
                   SPAFILE.SPA_ERNFRMLA_2,
                   SPAFILE.SPA_ERNAMT_2,
                   SPAFILE.SPA_ERNPERCT_2,
                   SPAFILE.SPA_ERNPERCD_2,
                   SPAFILE.SPA_ERNACCRL_FG_2,
                   SPAFILE.SPA_ERNACCRL_START_CD_2,
                   SPAFILE.SPA_ERNACCRL_DFCD_2,
                   SPAFILE.SPA_ERN_DAYS_2,
                   SPAFILE.SPA_ERN_TERM_2,
                   SPAFILE.SPA_ERN_TYPE_2,
                   SPAFILE.SPA_ERNFRMLA_3,
                   SPAFILE.SPA_ERNAMT_3,
                   SPAFILE.SPA_ERNPERCT_3,
                   SPAFILE.SPA_ERNPERCD_3,
                   SPAFILE.SPA_ERNACCRL_FG_3,
                   SPAFILE.SPA_ERNACCRL_START_CD_3,
                   SPAFILE.SPA_ERNACCRL_DFCD_3,
                   SPAFILE.SPA_ERN_DAYS_3,
                   SPAFILE.SPA_ERN_TERM_3,
                   SPAFILE.SPA_ERN_TYPE_3,
                   SPAFILE.SPA_ERNFRMLA_4,
                   SPAFILE.SPA_ERNAMT_4,
                   SPAFILE.SPA_ERNPERCT_4,
                   SPAFILE.SPA_ERNPERCD_4,
                   SPAFILE.SPA_ERNACCRL_FG_4,
                   SPAFILE.SPA_ERNACCRL_START_CD_4,
                   SPAFILE.SPA_ERNACCRL_DFCD_4,
                   SPAFILE.SPA_ERN_DAYS_4,
                   SPAFILE.SPA_ERN_TERM_4,
                   SPAFILE.SPA_ERN_TYPE_4,
                   SPAFILE.SPA_ERNFRMLA_5,
                   SPAFILE.SPA_ERNAMT_5,
                   SPAFILE.SPA_ERNPERCT_5,
                   SPAFILE.SPA_ERNPERCD_5,
                   SPAFILE.SPA_ERNACCRL_FG_5,
                   SPAFILE.SPA_ERNACCRL_START_CD_5,
                   SPAFILE.SPA_ERNACCRL_DFCD_5,
                   SPAFILE.SPA_ERN_DAYS_5,
                   SPAFILE.SPA_ERN_TERM_5,
                   SPAFILE.SPA_ERN_TYPE_5,
                   SPAFILE.SPA_ERNFRMLA_6,
                   SPAFILE.SPA_ERNAMT_6,
                   SPAFILE.SPA_ERNPERCT_6,
                   SPAFILE.SPA_ERNPERCD_6,
                   SPAFILE.SPA_ERNACCRL_FG_6,
                   SPAFILE.SPA_ERNACCRL_START_CD_6,
                   SPAFILE.SPA_ERNACCRL_DFCD_6,
                   SPAFILE.SPA_ERN_DAYS_6,
                   SPAFILE.SPA_ERN_TERM_6,
                   SPAFILE.SPA_ERN_TYPE_6,
                   SPAFILE.SPA_ERNFRMLA_7,
                   SPAFILE.SPA_ERNAMT_7,
                   SPAFILE.SPA_ERNPERCT_7,
                   SPAFILE.SPA_ERNPERCD_7,
                   SPAFILE.SPA_ERNACCRL_FG_7,
                   SPAFILE.SPA_ERNACCRL_START_CD_7,
                   SPAFILE.SPA_ERNACCRL_DFCD_7,
                   SPAFILE.SPA_ERN_DAYS_7,
                   SPAFILE.SPA_ERN_TERM_7,
                   SPAFILE.SPA_ERN_TYPE_7,
                   SPAFILE.SPA_ERNFRMLA_8,
                   SPAFILE.SPA_ERNAMT_8,
                   SPAFILE.SPA_ERNPERCT_8,
                   SPAFILE.SPA_ERNPERCD_8,
                   SPAFILE.SPA_ERNACCRL_FG_8,
                   SPAFILE.SPA_ERNACCRL_START_CD_8,
                   SPAFILE.SPA_ERNACCRL_DFCD_8,
                   SPAFILE.SPA_ERN_DAYS_8,
                   SPAFILE.SPA_ERN_TERM_8,
                   SPAFILE.SPA_ERN_TYPE_8,
                   SPAFILE.SPA_ERNFRMLA_9,
                   SPAFILE.SPA_ERNAMT_9,
                   SPAFILE.SPA_ERNPERCT_9,
                   SPAFILE.SPA_ERNPERCD_9,
                   SPAFILE.SPA_ERNACCRL_FG_9,
                   SPAFILE.SPA_ERNACCRL_START_CD_9,
                   SPAFILE.SPA_ERNACCRL_DFCD_9,
                   SPAFILE.SPA_ERN_DAYS_9,
                   SPAFILE.SPA_ERN_TERM_9,
                   SPAFILE.SPA_ERN_TYPE_9,
                   SPAFILE.SPA_ERNFRMLA_10,
                   SPAFILE.SPA_ERNAMT_10,
                   SPAFILE.SPA_ERNPERCT_10,
                   SPAFILE.SPA_ERNPERCD_10,
                   SPAFILE.SPA_ERNACCRL_FG_10,
                   SPAFILE.SPA_ERNACCRL_START_CD_10,
                   SPAFILE.SPA_ERNACCRL_DFCD_10,
                   SPAFILE.SPA_ERN_DAYS_10,
                   SPAFILE.SPA_ERN_TERM_10,
                   SPAFILE.SPA_ERN_TYPE_10,
                   SPAFILE.SPA_ERNACCEL_CD,
                   SPAFILE.SPA_ERNJD_CD,
                   SPAFILE.SPA_MIDSTRERNCD,
                   SPAFILE.SPA_EARN_ORDER_1,
                   SPAFILE.SPA_EARN_ORDER_2,
                   SPAFILE.SPA_EARN_ORDER_3,
                   SPAFILE.SPA_EARN_ORDER_4,
                   SPAFILE.SPA_EARN_ORDER_5,
                   SPAFILE.SPA_EARN_ORDER_6,
                   SPAFILE.SPA_EARN_ORDER_7,
                   SPAFILE.SPA_EARN_ORDER_8,
                   SPAFILE.SPA_EARN_ORDER_9,
                   SPAFILE.SPA_EARN_ORDER_10,
                   SPAFILE.SPA_ERNDELQFRMLA,
                   SPAFILE.SPA_ERNDELQ_START,
                   SPAFILE.SPA_ERNDELQ_STOP,
                   SPAFILE.SPA_1098_INC_LC,
                   SPAFILE.SPA_MAX_IB_ACR_DAYS,
                   SPAFILE.SPA_LCGRACE,
                   SPAFILE.SPA_LCGRACECD,
                   SPAFILE.SPA_LCTYPE,
                   SPAFILE.SPA_LCRATE,
                   SPAFILE.SPA_LCFRMLA,
                   SPAFILE.SPA_LCMINCHG,
                   SPAFILE.SPA_LCMAXAMT,
                   SPAFILE.SPA_LCDELFAC,
                   SPAFILE.SPA_LCYRTYPE,
                   SPAFILE.SPA_LC_CODE,
                   SPAFILE.SPA_LCUNITPER_CD,
                   SPAFILE.SPA_DEFFRMLA,
                   SPAFILE.SPA_DEFEXCEPT,
                   SPAFILE.SPA_DEFWORKER,
                   SPAFILE.SPA_DEFPERCD,
                   SPAFILE.SPA_DEFBASE,
                   SPAFILE.SPA_DEFPOLCD,
                   SPAFILE.SPA_DEFPOLMX_1,
                   SPAFILE.SPA_DEFPOLMX_2,
                   SPAFILE.SPA_DEFPOLMX_3,
                   SPAFILE.SPA_DEFMIN,
                   SPAFILE.SPA_DEFMAX,
                   SPAFILE.SPA_DEFUNITPER_CD,
                   SPAFILE.SPA_PRFORM_1,
                   SPAFILE.SPA_PRFLAG_1,
                   SPAFILE.SPA_PRFORM_2,
                   SPAFILE.SPA_PRFLAG_2,
                   SPAFILE.SPA_PRFORM_3,
                   SPAFILE.SPA_PRFLAG_3,
                   SPAFILE.SPA_PRFORM_4,
                   SPAFILE.SPA_PRFLAG_4,
                   SPAFILE.SPA_PRFORM_5,
                   SPAFILE.SPA_PRFLAG_5,
                   SPAFILE.SPA_PRFORM_6,
                   SPAFILE.SPA_PRFLAG_6,
                   SPAFILE.SPA_PRFORM_7,
                   SPAFILE.SPA_PRFLAG_7,
                   SPAFILE.SPA_PRFORM_8,
                   SPAFILE.SPA_PRFLAG_8,
                   SPAFILE.SPA_PRFORM_9,
                   SPAFILE.SPA_PRFLAG_9,
                   SPAFILE.SPA_PRFORM_10,
                   SPAFILE.SPA_PRFLAG_10,
                   SPAFILE.SPA_PRFORM_11,
                   SPAFILE.SPA_PRFLAG_11,
                   SPAFILE.SPA_PRFORM_12,
                   SPAFILE.SPA_PRFLAG_12,
                   SPAFILE.SPA_PRFORM_13,
                   SPAFILE.SPA_PRFLAG_13,
                   SPAFILE.SPA_PRFORM_14,
                   SPAFILE.SPA_PRFLAG_14,
                   SPAFILE.SPA_PRFORM_15,
                   SPAFILE.SPA_PRFLAG_15,
                   SPAFILE.SPA_PRFORM_16,
                   SPAFILE.SPA_PRFLAG_16,
                   SPAFILE.SPA_PRFORM_17,
                   SPAFILE.SPA_PRFLAG_17,
                   SPAFILE.SPA_PRFORM_18,
                   SPAFILE.SPA_PRFLAG_18,
                   SPAFILE.SPA_PRFORM_19,
                   SPAFILE.SPA_PRFLAG_19,
                   SPAFILE.SPA_PRFORM_20,
                   SPAFILE.SPA_PRFLAG_20,
                   SPAFILE.SPA_IMED_REC,
                   SPAFILE.SPA_SCFRMLA,
                   SPAFILE.SPA_SCRATE,
                   SPAFILE.SPA_SCMIN,
                   SPAFILE.SPA_SCMAX,
                   SPAFILE.SPA_MFFRMLA,
                   SPAFILE.SPA_MFRATE,
                   SPAFILE.SPA_MFMIN,
                   SPAFILE.SPA_MFMAX,
                   SPAFILE.SPA_INTMETHOD,
                   SPAFILE.SPA_YEARTYPE,
                   SPAFILE.SPA_PYEXFRMLA,
                   SPAFILE.SPA_PYEXSPCODE,
                   SPAFILE.SPA_PYEXYEARTP,
                   SPAFILE.SPA_PYEXFMDATE,
                   SPAFILE.SPA_PYEXBASECD,
                   SPAFILE.SPA_PYEXBASE,
                   SPAFILE.SPA_PYEXDAYS,
                   SPAFILE.SPA_CAL_SPFRMLA,
                   SPAFILE.SPA_CAL_RATETYPE_1,
                   SPAFILE.SPA_CAL_BREAKTYPE_1,
                   SPAFILE.SPA_CAL_CHGABLE_1,
                   SPAFILE.SPA_CAL_NORATES_1,
                   SPAFILE.SPA_CAL_TBFRMLA_1,
                   SPAFILE.SPA_CAL_RATE_1_1,
                   SPAFILE.SPA_CAL_BREAK_1_1,
                   SPAFILE.SPA_CAL_RATE_1_2,
                   SPAFILE.SPA_CAL_BREAK_1_2,
                   SPAFILE.SPA_CAL_RATE_1_3,
                   SPAFILE.SPA_CAL_BREAK_1_3,
                   SPAFILE.SPA_CAL_RATE_1_4,
                   SPAFILE.SPA_CAL_BREAK_1_4,
                   SPAFILE.SPA_CAL_RATE_1_5,
                   SPAFILE.SPA_CAL_BREAK_1_5,
                   SPAFILE.SPA_CAL_RATETYPE_2,
                   SPAFILE.SPA_CAL_BREAKTYPE_2,
                   SPAFILE.SPA_CAL_CHGABLE_2,
                   SPAFILE.SPA_CAL_NORATES_2,
                   SPAFILE.SPA_CAL_TBFRMLA_2,
                   SPAFILE.SPA_CAL_RATE_2_1,
                   SPAFILE.SPA_CAL_BREAK_2_1,
                   SPAFILE.SPA_CAL_RATE_2_2,
                   SPAFILE.SPA_CAL_BREAK_2_2,
                   SPAFILE.SPA_CAL_RATE_2_3,
                   SPAFILE.SPA_CAL_BREAK_2_3,
                   SPAFILE.SPA_CAL_RATE_2_4,
                   SPAFILE.SPA_CAL_BREAK_2_4,
                   SPAFILE.SPA_CAL_RATE_2_5,
                   SPAFILE.SPA_CAL_BREAK_2_5,
                   SPAFILE.SPA_MINSF_FRMLA,
                   SPAFILE.SPA_MINSF_CHG,
                   SPAFILE.SPA_MAXAPR_FRMLA,
                   SPAFILE.SPA_EDT_NOEDITS_1,
                   SPAFILE.SPA_EDT_TYPE_1_1,
                   SPAFILE.SPA_EDT_HL_1_1,
                   SPAFILE.SPA_EDT_COLL_1_1,
                   SPAFILE.SPA_EDT_CD_1_1,
                   SPAFILE.SPA_EDT_RATE_1_1,
                   SPAFILE.SPA_EDT_RATETYPE_1_1,
                   SPAFILE.SPA_EDT_AMT_1_1,
                   SPAFILE.SPA_EDT_AMTYPE_1_1,
                   SPAFILE.SPA_EDT_TERM_1_1,
                   SPAFILE.SPA_EDT_TYPE_1_2,
                   SPAFILE.SPA_EDT_HL_1_2,
                   SPAFILE.SPA_EDT_COLL_1_2,
                   SPAFILE.SPA_EDT_CD_1_2,
                   SPAFILE.SPA_EDT_RATE_1_2,
                   SPAFILE.SPA_EDT_RATETYPE_1_2,
                   SPAFILE.SPA_EDT_AMT_1_2,
                   SPAFILE.SPA_EDT_AMTYPE_1_2,
                   SPAFILE.SPA_EDT_TERM_1_2,
                   SPAFILE.SPA_EDT_TYPE_1_3,
                   SPAFILE.SPA_EDT_HL_1_3,
                   SPAFILE.SPA_EDT_COLL_1_3,
                   SPAFILE.SPA_EDT_CD_1_3,
                   SPAFILE.SPA_EDT_RATE_1_3,
                   SPAFILE.SPA_EDT_RATETYPE_1_3,
                   SPAFILE.SPA_EDT_AMT_1_3,
                   SPAFILE.SPA_EDT_AMTYPE_1_3,
                   SPAFILE.SPA_EDT_TERM_1_3,
                   SPAFILE.SPA_EDT_TYPE_1_4,
                   SPAFILE.SPA_EDT_HL_1_4,
                   SPAFILE.SPA_EDT_COLL_1_4,
                   SPAFILE.SPA_EDT_CD_1_4,
                   SPAFILE.SPA_EDT_RATE_1_4,
                   SPAFILE.SPA_EDT_RATETYPE_1_4,
                   SPAFILE.SPA_EDT_AMT_1_4,
                   SPAFILE.SPA_EDT_AMTYPE_1_4,
                   SPAFILE.SPA_EDT_TERM_1_4,
                   SPAFILE.SPA_EDT_TYPE_1_5,
                   SPAFILE.SPA_EDT_HL_1_5,
                   SPAFILE.SPA_EDT_COLL_1_5,
                   SPAFILE.SPA_EDT_CD_1_5,
                   SPAFILE.SPA_EDT_RATE_1_5,
                   SPAFILE.SPA_EDT_RATETYPE_1_5,
                   SPAFILE.SPA_EDT_AMT_1_5,
                   SPAFILE.SPA_EDT_AMTYPE_1_5,
                   SPAFILE.SPA_EDT_TERM_1_5,
                   SPAFILE.SPA_EDT_TYPE_1_6,
                   SPAFILE.SPA_EDT_HL_1_6,
                   SPAFILE.SPA_EDT_COLL_1_6,
                   SPAFILE.SPA_EDT_CD_1_6,
                   SPAFILE.SPA_EDT_RATE_1_6,
                   SPAFILE.SPA_EDT_RATETYPE_1_6,
                   SPAFILE.SPA_EDT_AMT_1_6,
                   SPAFILE.SPA_EDT_AMTYPE_1_6,
                   SPAFILE.SPA_EDT_TERM_1_6,
                   SPAFILE.SPA_EDT_NOEDITS_2,
                   SPAFILE.SPA_EDT_TYPE_2_1,
                   SPAFILE.SPA_EDT_HL_2_1,
                   SPAFILE.SPA_EDT_COLL_2_1,
                   SPAFILE.SPA_EDT_CD_2_1,
                   SPAFILE.SPA_EDT_RATE_2_1,
                   SPAFILE.SPA_EDT_RATETYPE_2_1,
                   SPAFILE.SPA_EDT_AMT_2_1,
                   SPAFILE.SPA_EDT_AMTYPE_2_1,
                   SPAFILE.SPA_EDT_TERM_2_1,
                   SPAFILE.SPA_EDT_TYPE_2_2,
                   SPAFILE.SPA_EDT_HL_2_2,
                   SPAFILE.SPA_EDT_COLL_2_2,
                   SPAFILE.SPA_EDT_CD_2_2,
                   SPAFILE.SPA_EDT_RATE_2_2,
                   SPAFILE.SPA_EDT_RATETYPE_2_2,
                   SPAFILE.SPA_EDT_AMT_2_2,
                   SPAFILE.SPA_EDT_AMTYPE_2_2,
                   SPAFILE.SPA_EDT_TERM_2_2,
                   SPAFILE.SPA_EDT_TYPE_2_3,
                   SPAFILE.SPA_EDT_HL_2_3,
                   SPAFILE.SPA_EDT_COLL_2_3,
                   SPAFILE.SPA_EDT_CD_2_3,
                   SPAFILE.SPA_EDT_RATE_2_3,
                   SPAFILE.SPA_EDT_RATETYPE_2_3,
                   SPAFILE.SPA_EDT_AMT_2_3,
                   SPAFILE.SPA_EDT_AMTYPE_2_3,
                   SPAFILE.SPA_EDT_TERM_2_3,
                   SPAFILE.SPA_EDT_TYPE_2_4,
                   SPAFILE.SPA_EDT_HL_2_4,
                   SPAFILE.SPA_EDT_COLL_2_4,
                   SPAFILE.SPA_EDT_CD_2_4,
                   SPAFILE.SPA_EDT_RATE_2_4,
                   SPAFILE.SPA_EDT_RATETYPE_2_4,
                   SPAFILE.SPA_EDT_AMT_2_4,
                   SPAFILE.SPA_EDT_AMTYPE_2_4,
                   SPAFILE.SPA_EDT_TERM_2_4,
                   SPAFILE.SPA_EDT_TYPE_2_5,
                   SPAFILE.SPA_EDT_HL_2_5,
                   SPAFILE.SPA_EDT_COLL_2_5,
                   SPAFILE.SPA_EDT_CD_2_5,
                   SPAFILE.SPA_EDT_RATE_2_5,
                   SPAFILE.SPA_EDT_RATETYPE_2_5,
                   SPAFILE.SPA_EDT_AMT_2_5,
                   SPAFILE.SPA_EDT_AMTYPE_2_5,
                   SPAFILE.SPA_EDT_TERM_2_5,
                   SPAFILE.SPA_EDT_TYPE_2_6,
                   SPAFILE.SPA_EDT_HL_2_6,
                   SPAFILE.SPA_EDT_COLL_2_6,
                   SPAFILE.SPA_EDT_CD_2_6,
                   SPAFILE.SPA_EDT_RATE_2_6,
                   SPAFILE.SPA_EDT_RATETYPE_2_6,
                   SPAFILE.SPA_EDT_AMT_2_6,
                   SPAFILE.SPA_EDT_AMTYPE_2_6,
                   SPAFILE.SPA_EDT_TERM_2_6
            FROM DBO.SPAFILE
            WHERE SPAFILE.SPA_ORGST >= :QSP1-WBEG-ORGST
              AND SPAFILE.SPA_ORGST <= :QSP1-WEND-ORGST
              AND SPAFILE.SPA_SPRCLASS >= :QSP1-WBEG-SPRCLASS
              AND SPAFILE.SPA_SPRCLASS <= :QSP1-WEND-SPRCLASS
              AND SPAFILE.SPA_SUBCLASS >= :QSP1-WBEG-SUBCLASS
              AND SPAFILE.SPA_SUBCLASS <= :QSP1-WEND-SUBCLASS
              AND SPAFILE.SPA_LAWCODE >= :QSP1-WBEG-LAWCODE 
              AND SPAFILE.SPA_LAWCODE <= :QSP1-WEND-LAWCODE 
            ORDER BY SPAFILE.SPA_ORGST,
                     SPAFILE.SPA_SPRCLASS,
                     SPAFILE.SPA_SUBCLASS,
                     SPAFILE.SPA_LAWCODE
           END-EXEC.

           EXEC SQL
               OPEN SPA1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE SPACES TO QSP1-WBEG-ORGST
                          QSP1-WEND-ORGST.

           MOVE ZEROES TO QSP1-WBEG-SPRCLASS
                          QSP1-WEND-SPRCLASS
                          QSP1-WBEG-SUBCLASS
                          QSP1-WEND-SUBCLASS
                          QSP1-WBEG-LAWCODE
                          QSP1-WEND-LAWCODE.

           MOVE STAT---GOOD TO SPA1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-SPA1-FILE.
           PERFORM READ-IT.
           MOVE SPA-PATH-SQL TO E-FILE.
           MOVE SPA1-KEY TO E-KEYX.
           INITIALIZE QSPA-REC.

           MOVE SPA-ORGST            TO QSPA-ORGST.
           MOVE SPA-SPRCLASS         TO QSPA-SPRCLASS.
           MOVE SPA-SUBCLASS         TO QSPA-SUBCLASS.
           MOVE SPA-LAWCODE          TO QSPA-LAWCODE.

           EXEC SQL
            SELECT SPAFILE.SPA_ORGST,
                   SPAFILE.SPA_SPRCLASS,
                   SPAFILE.SPA_SUBCLASS,
                   SPAFILE.SPA_LAWCODE,
                   CAST(SPAFILE.SPA_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   SPAFILE.SPA_DESC,
                   SPAFILE.SPA_NOTES,
                   CAST(SPAFILE.SPA_EFFDATE
                                                  AS VARCHAR(10)),
                   CAST(SPAFILE.SPA_EXPDATE
                                                  AS VARCHAR(10)),
                   SPAFILE.SPA_EXPD_MONTHS,
                   SPAFILE.SPA_EXPD_DAYS,
                   SPAFILE.SPA_EXPD_FRMLA,
                   SPAFILE.SPA_EXPD_EXCEPT,
                   SPAFILE.SPA_EXPR_FRMLA,
                   SPAFILE.SPA_EXPR_REDU_FRMLA,
                   SPAFILE.SPA_EXPR_RATE_1,
                   SPAFILE.SPA_EXPR_BREAK_1,
                   SPAFILE.SPA_EXPR_YRTYPE_1,
                   SPAFILE.SPA_EXPR_INTMETH_1,
                   SPAFILE.SPA_EXPR_RATE_2,
                   SPAFILE.SPA_EXPR_BREAK_2,
                   SPAFILE.SPA_EXPR_YRTYPE_2,
                   SPAFILE.SPA_EXPR_INTMETH_2,
                   SPAFILE.SPA_EXPR_RATE_3,
                   SPAFILE.SPA_EXPR_BREAK_3,
                   SPAFILE.SPA_EXPR_YRTYPE_3,
                   SPAFILE.SPA_EXPR_INTMETH_3,
                   SPAFILE.SPA_EXPR_RATE_4,
                   SPAFILE.SPA_EXPR_BREAK_4,
                   SPAFILE.SPA_EXPR_YRTYPE_4,
                   SPAFILE.SPA_EXPR_INTMETH_4,
                   SPAFILE.SPA_EXPR_RATE_5,
                   SPAFILE.SPA_EXPR_BREAK_5,
                   SPAFILE.SPA_EXPR_YRTYPE_5,
                   SPAFILE.SPA_EXPR_INTMETH_5,
                   SPAFILE.SPA_EXPR_LCHG,
                   SPAFILE.SPA_JUDGFRMLA,
                   SPAFILE.SPA_JUDGRATE,
                   SPAFILE.SPA_JUDGYRTYPE,
                   SPAFILE.SPA_JUDGINTMETH,
                   SPAFILE.SPA_ACC_FRMLA,
                   SPAFILE.SPA_ACC_YRTYPE,
                   SPAFILE.SPA_ACC_INTMETH,
                   SPAFILE.SPA_ACC_RATE_1,
                   SPAFILE.SPA_ACC_BREAK_1,
                   SPAFILE.SPA_ACC_RATE_2,
                   SPAFILE.SPA_ACC_BREAK_2,
                   SPAFILE.SPA_ACC_RATE_3,
                   SPAFILE.SPA_ACC_BREAK_3,
                   SPAFILE.SPA_ACC_RATE_4,
                   SPAFILE.SPA_ACC_BREAK_4,
                   SPAFILE.SPA_ACC_RATE_5,
                   SPAFILE.SPA_ACC_BREAK_5,
                   SPAFILE.SPA_1098FRMLA,
                   SPAFILE.SPA_DISFRMLA,
                   SPAFILE.SPA_CONTRFRMLA,
                   SPAFILE.SPA_BANKRULE,
                   SPAFILE.SPA_CONTPDTH,
                   SPAFILE.SPA_FINCHG,
                   SPAFILE.SPA_BANKUNITPER_CD,
                   SPAFILE.SPA_TRWBANKRULE,
                   SPAFILE.SPA_TRWCONTPDTH,
                   SPAFILE.SPA_TRWBANKUNITPER_CD,
                   SPAFILE.SPA_RECFRMLA,
                   SPAFILE.SPA_RECPAYCD,
                   SPAFILE.SPA_RECPDTH,
                   SPAFILE.SPA_DISFRMLA_SPAY_FG,
                   SPAFILE.SPA_ERNFRMLA_1,
                   SPAFILE.SPA_ERNAMT_1,
                   SPAFILE.SPA_ERNPERCT_1,
                   SPAFILE.SPA_ERNPERCD_1,
                   SPAFILE.SPA_ERNACCRL_FG_1,
                   SPAFILE.SPA_ERNACCRL_START_CD_1,
                   SPAFILE.SPA_ERNACCRL_DFCD_1,
                   SPAFILE.SPA_ERN_DAYS_1,
                   SPAFILE.SPA_ERN_TERM_1,
                   SPAFILE.SPA_ERN_TYPE_1,
                   SPAFILE.SPA_ERNFRMLA_2,
                   SPAFILE.SPA_ERNAMT_2,
                   SPAFILE.SPA_ERNPERCT_2,
                   SPAFILE.SPA_ERNPERCD_2,
                   SPAFILE.SPA_ERNACCRL_FG_2,
                   SPAFILE.SPA_ERNACCRL_START_CD_2,
                   SPAFILE.SPA_ERNACCRL_DFCD_2,
                   SPAFILE.SPA_ERN_DAYS_2,
                   SPAFILE.SPA_ERN_TERM_2,
                   SPAFILE.SPA_ERN_TYPE_2,
                   SPAFILE.SPA_ERNFRMLA_3,
                   SPAFILE.SPA_ERNAMT_3,
                   SPAFILE.SPA_ERNPERCT_3,
                   SPAFILE.SPA_ERNPERCD_3,
                   SPAFILE.SPA_ERNACCRL_FG_3,
                   SPAFILE.SPA_ERNACCRL_START_CD_3,
                   SPAFILE.SPA_ERNACCRL_DFCD_3,
                   SPAFILE.SPA_ERN_DAYS_3,
                   SPAFILE.SPA_ERN_TERM_3,
                   SPAFILE.SPA_ERN_TYPE_3,
                   SPAFILE.SPA_ERNFRMLA_4,
                   SPAFILE.SPA_ERNAMT_4,
                   SPAFILE.SPA_ERNPERCT_4,
                   SPAFILE.SPA_ERNPERCD_4,
                   SPAFILE.SPA_ERNACCRL_FG_4,
                   SPAFILE.SPA_ERNACCRL_START_CD_4,
                   SPAFILE.SPA_ERNACCRL_DFCD_4,
                   SPAFILE.SPA_ERN_DAYS_4,
                   SPAFILE.SPA_ERN_TERM_4,
                   SPAFILE.SPA_ERN_TYPE_4,
                   SPAFILE.SPA_ERNFRMLA_5,
                   SPAFILE.SPA_ERNAMT_5,
                   SPAFILE.SPA_ERNPERCT_5,
                   SPAFILE.SPA_ERNPERCD_5,
                   SPAFILE.SPA_ERNACCRL_FG_5,
                   SPAFILE.SPA_ERNACCRL_START_CD_5,
                   SPAFILE.SPA_ERNACCRL_DFCD_5,
                   SPAFILE.SPA_ERN_DAYS_5,
                   SPAFILE.SPA_ERN_TERM_5,
                   SPAFILE.SPA_ERN_TYPE_5,
                   SPAFILE.SPA_ERNFRMLA_6,
                   SPAFILE.SPA_ERNAMT_6,
                   SPAFILE.SPA_ERNPERCT_6,
                   SPAFILE.SPA_ERNPERCD_6,
                   SPAFILE.SPA_ERNACCRL_FG_6,
                   SPAFILE.SPA_ERNACCRL_START_CD_6,
                   SPAFILE.SPA_ERNACCRL_DFCD_6,
                   SPAFILE.SPA_ERN_DAYS_6,
                   SPAFILE.SPA_ERN_TERM_6,
                   SPAFILE.SPA_ERN_TYPE_6,
                   SPAFILE.SPA_ERNFRMLA_7,
                   SPAFILE.SPA_ERNAMT_7,
                   SPAFILE.SPA_ERNPERCT_7,
                   SPAFILE.SPA_ERNPERCD_7,
                   SPAFILE.SPA_ERNACCRL_FG_7,
                   SPAFILE.SPA_ERNACCRL_START_CD_7,
                   SPAFILE.SPA_ERNACCRL_DFCD_7,
                   SPAFILE.SPA_ERN_DAYS_7,
                   SPAFILE.SPA_ERN_TERM_7,
                   SPAFILE.SPA_ERN_TYPE_7,
                   SPAFILE.SPA_ERNFRMLA_8,
                   SPAFILE.SPA_ERNAMT_8,
                   SPAFILE.SPA_ERNPERCT_8,
                   SPAFILE.SPA_ERNPERCD_8,
                   SPAFILE.SPA_ERNACCRL_FG_8,
                   SPAFILE.SPA_ERNACCRL_START_CD_8,
                   SPAFILE.SPA_ERNACCRL_DFCD_8,
                   SPAFILE.SPA_ERN_DAYS_8,
                   SPAFILE.SPA_ERN_TERM_8,
                   SPAFILE.SPA_ERN_TYPE_8,
                   SPAFILE.SPA_ERNFRMLA_9,
                   SPAFILE.SPA_ERNAMT_9,
                   SPAFILE.SPA_ERNPERCT_9,
                   SPAFILE.SPA_ERNPERCD_9,
                   SPAFILE.SPA_ERNACCRL_FG_9,
                   SPAFILE.SPA_ERNACCRL_START_CD_9,
                   SPAFILE.SPA_ERNACCRL_DFCD_9,
                   SPAFILE.SPA_ERN_DAYS_9,
                   SPAFILE.SPA_ERN_TERM_9,
                   SPAFILE.SPA_ERN_TYPE_9,
                   SPAFILE.SPA_ERNFRMLA_10,
                   SPAFILE.SPA_ERNAMT_10,
                   SPAFILE.SPA_ERNPERCT_10,
                   SPAFILE.SPA_ERNPERCD_10,
                   SPAFILE.SPA_ERNACCRL_FG_10,
                   SPAFILE.SPA_ERNACCRL_START_CD_10,
                   SPAFILE.SPA_ERNACCRL_DFCD_10,
                   SPAFILE.SPA_ERN_DAYS_10,
                   SPAFILE.SPA_ERN_TERM_10,
                   SPAFILE.SPA_ERN_TYPE_10,
                   SPAFILE.SPA_ERNACCEL_CD,
                   SPAFILE.SPA_ERNJD_CD,
                   SPAFILE.SPA_MIDSTRERNCD,
                   SPAFILE.SPA_EARN_ORDER_1,
                   SPAFILE.SPA_EARN_ORDER_2,
                   SPAFILE.SPA_EARN_ORDER_3,
                   SPAFILE.SPA_EARN_ORDER_4,
                   SPAFILE.SPA_EARN_ORDER_5,
                   SPAFILE.SPA_EARN_ORDER_6,
                   SPAFILE.SPA_EARN_ORDER_7,
                   SPAFILE.SPA_EARN_ORDER_8,
                   SPAFILE.SPA_EARN_ORDER_9,
                   SPAFILE.SPA_EARN_ORDER_10,
                   SPAFILE.SPA_ERNDELQFRMLA,
                   SPAFILE.SPA_ERNDELQ_START,
                   SPAFILE.SPA_ERNDELQ_STOP,
                   SPAFILE.SPA_1098_INC_LC,
                   SPAFILE.SPA_MAX_IB_ACR_DAYS,
                   SPAFILE.SPA_LCGRACE,
                   SPAFILE.SPA_LCGRACECD,
                   SPAFILE.SPA_LCTYPE,
                   SPAFILE.SPA_LCRATE,
                   SPAFILE.SPA_LCFRMLA,
                   SPAFILE.SPA_LCMINCHG,
                   SPAFILE.SPA_LCMAXAMT,
                   SPAFILE.SPA_LCDELFAC,
                   SPAFILE.SPA_LCYRTYPE,
                   SPAFILE.SPA_LC_CODE,
                   SPAFILE.SPA_LCUNITPER_CD,
                   SPAFILE.SPA_DEFFRMLA,
                   SPAFILE.SPA_DEFEXCEPT,
                   SPAFILE.SPA_DEFWORKER,
                   SPAFILE.SPA_DEFPERCD,
                   SPAFILE.SPA_DEFBASE,
                   SPAFILE.SPA_DEFPOLCD,
                   SPAFILE.SPA_DEFPOLMX_1,
                   SPAFILE.SPA_DEFPOLMX_2,
                   SPAFILE.SPA_DEFPOLMX_3,
                   SPAFILE.SPA_DEFMIN,
                   SPAFILE.SPA_DEFMAX,
                   SPAFILE.SPA_DEFUNITPER_CD,
                   SPAFILE.SPA_PRFORM_1,
                   SPAFILE.SPA_PRFLAG_1,
                   SPAFILE.SPA_PRFORM_2,
                   SPAFILE.SPA_PRFLAG_2,
                   SPAFILE.SPA_PRFORM_3,
                   SPAFILE.SPA_PRFLAG_3,
                   SPAFILE.SPA_PRFORM_4,
                   SPAFILE.SPA_PRFLAG_4,
                   SPAFILE.SPA_PRFORM_5,
                   SPAFILE.SPA_PRFLAG_5,
                   SPAFILE.SPA_PRFORM_6,
                   SPAFILE.SPA_PRFLAG_6,
                   SPAFILE.SPA_PRFORM_7,
                   SPAFILE.SPA_PRFLAG_7,
                   SPAFILE.SPA_PRFORM_8,
                   SPAFILE.SPA_PRFLAG_8,
                   SPAFILE.SPA_PRFORM_9,
                   SPAFILE.SPA_PRFLAG_9,
                   SPAFILE.SPA_PRFORM_10,
                   SPAFILE.SPA_PRFLAG_10,
                   SPAFILE.SPA_PRFORM_11,
                   SPAFILE.SPA_PRFLAG_11,
                   SPAFILE.SPA_PRFORM_12,
                   SPAFILE.SPA_PRFLAG_12,
                   SPAFILE.SPA_PRFORM_13,
                   SPAFILE.SPA_PRFLAG_13,
                   SPAFILE.SPA_PRFORM_14,
                   SPAFILE.SPA_PRFLAG_14,
                   SPAFILE.SPA_PRFORM_15,
                   SPAFILE.SPA_PRFLAG_15,
                   SPAFILE.SPA_PRFORM_16,
                   SPAFILE.SPA_PRFLAG_16,
                   SPAFILE.SPA_PRFORM_17,
                   SPAFILE.SPA_PRFLAG_17,
                   SPAFILE.SPA_PRFORM_18,
                   SPAFILE.SPA_PRFLAG_18,
                   SPAFILE.SPA_PRFORM_19,
                   SPAFILE.SPA_PRFLAG_19,
                   SPAFILE.SPA_PRFORM_20,
                   SPAFILE.SPA_PRFLAG_20,
                   SPAFILE.SPA_IMED_REC,
                   SPAFILE.SPA_SCFRMLA,
                   SPAFILE.SPA_SCRATE,
                   SPAFILE.SPA_SCMIN,
                   SPAFILE.SPA_SCMAX,
                   SPAFILE.SPA_MFFRMLA,
                   SPAFILE.SPA_MFRATE,
                   SPAFILE.SPA_MFMIN,
                   SPAFILE.SPA_MFMAX,
                   SPAFILE.SPA_INTMETHOD,
                   SPAFILE.SPA_YEARTYPE,
                   SPAFILE.SPA_PYEXFRMLA,
                   SPAFILE.SPA_PYEXSPCODE,
                   SPAFILE.SPA_PYEXYEARTP,
                   SPAFILE.SPA_PYEXFMDATE,
                   SPAFILE.SPA_PYEXBASECD,
                   SPAFILE.SPA_PYEXBASE,
                   SPAFILE.SPA_PYEXDAYS,
                   SPAFILE.SPA_CAL_SPFRMLA,
                   SPAFILE.SPA_CAL_RATETYPE_1,
                   SPAFILE.SPA_CAL_BREAKTYPE_1,
                   SPAFILE.SPA_CAL_CHGABLE_1,
                   SPAFILE.SPA_CAL_NORATES_1,
                   SPAFILE.SPA_CAL_TBFRMLA_1,
                   SPAFILE.SPA_CAL_RATE_1_1,
                   SPAFILE.SPA_CAL_BREAK_1_1,
                   SPAFILE.SPA_CAL_RATE_1_2,
                   SPAFILE.SPA_CAL_BREAK_1_2,
                   SPAFILE.SPA_CAL_RATE_1_3,
                   SPAFILE.SPA_CAL_BREAK_1_3,
                   SPAFILE.SPA_CAL_RATE_1_4,
                   SPAFILE.SPA_CAL_BREAK_1_4,
                   SPAFILE.SPA_CAL_RATE_1_5,
                   SPAFILE.SPA_CAL_BREAK_1_5,
                   SPAFILE.SPA_CAL_RATETYPE_2,
                   SPAFILE.SPA_CAL_BREAKTYPE_2,
                   SPAFILE.SPA_CAL_CHGABLE_2,
                   SPAFILE.SPA_CAL_NORATES_2,
                   SPAFILE.SPA_CAL_TBFRMLA_2,
                   SPAFILE.SPA_CAL_RATE_2_1,
                   SPAFILE.SPA_CAL_BREAK_2_1,
                   SPAFILE.SPA_CAL_RATE_2_2,
                   SPAFILE.SPA_CAL_BREAK_2_2,
                   SPAFILE.SPA_CAL_RATE_2_3,
                   SPAFILE.SPA_CAL_BREAK_2_3,
                   SPAFILE.SPA_CAL_RATE_2_4,
                   SPAFILE.SPA_CAL_BREAK_2_4,
                   SPAFILE.SPA_CAL_RATE_2_5,
                   SPAFILE.SPA_CAL_BREAK_2_5,
                   SPAFILE.SPA_MINSF_FRMLA,
                   SPAFILE.SPA_MINSF_CHG,
                   SPAFILE.SPA_MAXAPR_FRMLA,
                   SPAFILE.SPA_EDT_NOEDITS_1,
                   SPAFILE.SPA_EDT_TYPE_1_1,
                   SPAFILE.SPA_EDT_HL_1_1,
                   SPAFILE.SPA_EDT_COLL_1_1,
                   SPAFILE.SPA_EDT_CD_1_1,
                   SPAFILE.SPA_EDT_RATE_1_1,
                   SPAFILE.SPA_EDT_RATETYPE_1_1,
                   SPAFILE.SPA_EDT_AMT_1_1,
                   SPAFILE.SPA_EDT_AMTYPE_1_1,
                   SPAFILE.SPA_EDT_TERM_1_1,
                   SPAFILE.SPA_EDT_TYPE_1_2,
                   SPAFILE.SPA_EDT_HL_1_2,
                   SPAFILE.SPA_EDT_COLL_1_2,
                   SPAFILE.SPA_EDT_CD_1_2,
                   SPAFILE.SPA_EDT_RATE_1_2,
                   SPAFILE.SPA_EDT_RATETYPE_1_2,
                   SPAFILE.SPA_EDT_AMT_1_2,
                   SPAFILE.SPA_EDT_AMTYPE_1_2,
                   SPAFILE.SPA_EDT_TERM_1_2,
                   SPAFILE.SPA_EDT_TYPE_1_3,
                   SPAFILE.SPA_EDT_HL_1_3,
                   SPAFILE.SPA_EDT_COLL_1_3,
                   SPAFILE.SPA_EDT_CD_1_3,
                   SPAFILE.SPA_EDT_RATE_1_3,
                   SPAFILE.SPA_EDT_RATETYPE_1_3,
                   SPAFILE.SPA_EDT_AMT_1_3,
                   SPAFILE.SPA_EDT_AMTYPE_1_3,
                   SPAFILE.SPA_EDT_TERM_1_3,
                   SPAFILE.SPA_EDT_TYPE_1_4,
                   SPAFILE.SPA_EDT_HL_1_4,
                   SPAFILE.SPA_EDT_COLL_1_4,
                   SPAFILE.SPA_EDT_CD_1_4,
                   SPAFILE.SPA_EDT_RATE_1_4,
                   SPAFILE.SPA_EDT_RATETYPE_1_4,
                   SPAFILE.SPA_EDT_AMT_1_4,
                   SPAFILE.SPA_EDT_AMTYPE_1_4,
                   SPAFILE.SPA_EDT_TERM_1_4,
                   SPAFILE.SPA_EDT_TYPE_1_5,
                   SPAFILE.SPA_EDT_HL_1_5,
                   SPAFILE.SPA_EDT_COLL_1_5,
                   SPAFILE.SPA_EDT_CD_1_5,
                   SPAFILE.SPA_EDT_RATE_1_5,
                   SPAFILE.SPA_EDT_RATETYPE_1_5,
                   SPAFILE.SPA_EDT_AMT_1_5,
                   SPAFILE.SPA_EDT_AMTYPE_1_5,
                   SPAFILE.SPA_EDT_TERM_1_5,
                   SPAFILE.SPA_EDT_TYPE_1_6,
                   SPAFILE.SPA_EDT_HL_1_6,
                   SPAFILE.SPA_EDT_COLL_1_6,
                   SPAFILE.SPA_EDT_CD_1_6,
                   SPAFILE.SPA_EDT_RATE_1_6,
                   SPAFILE.SPA_EDT_RATETYPE_1_6,
                   SPAFILE.SPA_EDT_AMT_1_6,
                   SPAFILE.SPA_EDT_AMTYPE_1_6,
                   SPAFILE.SPA_EDT_TERM_1_6,
                   SPAFILE.SPA_EDT_NOEDITS_2,
                   SPAFILE.SPA_EDT_TYPE_2_1,
                   SPAFILE.SPA_EDT_HL_2_1,
                   SPAFILE.SPA_EDT_COLL_2_1,
                   SPAFILE.SPA_EDT_CD_2_1,
                   SPAFILE.SPA_EDT_RATE_2_1,
                   SPAFILE.SPA_EDT_RATETYPE_2_1,
                   SPAFILE.SPA_EDT_AMT_2_1,
                   SPAFILE.SPA_EDT_AMTYPE_2_1,
                   SPAFILE.SPA_EDT_TERM_2_1,
                   SPAFILE.SPA_EDT_TYPE_2_2,
                   SPAFILE.SPA_EDT_HL_2_2,
                   SPAFILE.SPA_EDT_COLL_2_2,
                   SPAFILE.SPA_EDT_CD_2_2,
                   SPAFILE.SPA_EDT_RATE_2_2,
                   SPAFILE.SPA_EDT_RATETYPE_2_2,
                   SPAFILE.SPA_EDT_AMT_2_2,
                   SPAFILE.SPA_EDT_AMTYPE_2_2,
                   SPAFILE.SPA_EDT_TERM_2_2,
                   SPAFILE.SPA_EDT_TYPE_2_3,
                   SPAFILE.SPA_EDT_HL_2_3,
                   SPAFILE.SPA_EDT_COLL_2_3,
                   SPAFILE.SPA_EDT_CD_2_3,
                   SPAFILE.SPA_EDT_RATE_2_3,
                   SPAFILE.SPA_EDT_RATETYPE_2_3,
                   SPAFILE.SPA_EDT_AMT_2_3,
                   SPAFILE.SPA_EDT_AMTYPE_2_3,
                   SPAFILE.SPA_EDT_TERM_2_3,
                   SPAFILE.SPA_EDT_TYPE_2_4,
                   SPAFILE.SPA_EDT_HL_2_4,
                   SPAFILE.SPA_EDT_COLL_2_4,
                   SPAFILE.SPA_EDT_CD_2_4,
                   SPAFILE.SPA_EDT_RATE_2_4,
                   SPAFILE.SPA_EDT_RATETYPE_2_4,
                   SPAFILE.SPA_EDT_AMT_2_4,
                   SPAFILE.SPA_EDT_AMTYPE_2_4,
                   SPAFILE.SPA_EDT_TERM_2_4,
                   SPAFILE.SPA_EDT_TYPE_2_5,
                   SPAFILE.SPA_EDT_HL_2_5,
                   SPAFILE.SPA_EDT_COLL_2_5,
                   SPAFILE.SPA_EDT_CD_2_5,
                   SPAFILE.SPA_EDT_RATE_2_5,
                   SPAFILE.SPA_EDT_RATETYPE_2_5,
                   SPAFILE.SPA_EDT_AMT_2_5,
                   SPAFILE.SPA_EDT_AMTYPE_2_5,
                   SPAFILE.SPA_EDT_TERM_2_5,
                   SPAFILE.SPA_EDT_TYPE_2_6,
                   SPAFILE.SPA_EDT_HL_2_6,
                   SPAFILE.SPA_EDT_COLL_2_6,
                   SPAFILE.SPA_EDT_CD_2_6,
                   SPAFILE.SPA_EDT_RATE_2_6,
                   SPAFILE.SPA_EDT_RATETYPE_2_6,
                   SPAFILE.SPA_EDT_AMT_2_6,
                   SPAFILE.SPA_EDT_AMTYPE_2_6,
                   SPAFILE.SPA_EDT_TERM_2_6
            INTO :QSPA-REC
            FROM DBO.SPAFILE
            WHERE SPAFILE.SPA_ORGST = :QSPA-ORGST
              AND SPAFILE.SPA_SPRCLASS = :QSPA-SPRCLASS
              AND SPAFILE.SPA_SUBCLASS = :QSPA-SUBCLASS
              AND SPAFILE.SPA_LAWCODE = :QSPA-LAWCODE 
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-SPA1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-SPA-FIELDS.

      *-----------------------------------------------------------------
       READ-SPA1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE SPA-PATH-SQL TO E-FILE.
           MOVE SPA1-KEY TO E-KEYX.
           INITIALIZE QSPA-REC.

           IF ( SPA1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH SPA1_CURSOR INTO :QSPA-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-SPA1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-SPA-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-SPA1-FILE.
           PERFORM CLOSE-IT.
           IF ( SPA1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE SPA1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO SPA1-CURSOR-STAT.

      *=================================================================
       LOAD-SPB1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( SP-PATH-OVERRIDE = "Y" )
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( SP-PATH-OVERRIDE = SPACES )
              MOVE EXT-FILPATH-BASE        TO SPB-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO SPB-ALL-MACHINE
              MOVE SPB-ALL-PATH             TO SPB-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( SP-PATH-OVERRIDE = "B" )
              MOVE FILPATH-BASE            TO SPB-ALL-BASE
              MOVE FILPATH-MACHINE         TO SPB-ALL-MACHINE
              MOVE SPB-ALL-PATH             TO SPB-PATH.

      *-----------------------------------------------------------------
       OPEN-SPB1-FILE.
           PERFORM LOAD-SPB1-FILE.
           PERFORM OPEN-IT.
           MOVE SPB-PATH-SQL TO E-FILE.

      *-----------------------------------------------------------------
       READ-SPB1-FILE.
           PERFORM READ-IT.
           MOVE SPB-PATH-SQL TO E-FILE.
           MOVE SPB1-KEY TO E-KEYX.
           INITIALIZE QSPB-REC.

           MOVE SPB-ORGST            TO QSPB-ORGST.
           MOVE SPB-SPRCLASS         TO QSPB-SPRCLASS.
           MOVE SPB-SUBCLASS         TO QSPB-SUBCLASS.
           MOVE SPB-LAWCODE          TO QSPB-LAWCODE.

           EXEC SQL
            SELECT SPBFILE.SPB_ORGST,
                   SPBFILE.SPB_SPRCLASS,
                   SPBFILE.SPB_SUBCLASS,
                   SPBFILE.SPB_LAWCODE,
                   SPBFILE.SPB_INSCOM_1,
                   SPBFILE.SPB_INSRATECD_1,
                   SPBFILE.SPB_INSJFAC_1,
                   SPBFILE.SPB_INSDISCNT_1,
                   SPBFILE.SPB_INSCHGABL_1,
                   SPBFILE.SPB_INSTERM_1_1,
                   SPBFILE.SPB_INSRATE_1_1,
                   SPBFILE.SPB_INSTERM_1_2,
                   SPBFILE.SPB_INSRATE_1_2,
                   SPBFILE.SPB_INSTERM_1_3,
                   SPBFILE.SPB_INSRATE_1_3,
                   SPBFILE.SPB_INSTERM_1_4,
                   SPBFILE.SPB_INSRATE_1_4,
                   SPBFILE.SPB_INSTERM_1_5,
                   SPBFILE.SPB_INSRATE_1_5,
                   SPBFILE.SPB_INSTERM_1_6,
                   SPBFILE.SPB_INSRATE_1_6,
                   SPBFILE.SPB_INSTERM_1_7,
                   SPBFILE.SPB_INSRATE_1_7,
                   SPBFILE.SPB_INSTERM_1_8,
                   SPBFILE.SPB_INSRATE_1_8,
                   SPBFILE.SPB_INSTERM_1_9,
                   SPBFILE.SPB_INSRATE_1_9,
                   SPBFILE.SPB_INSTERM_1_10,
                   SPBFILE.SPB_INSRATE_1_10,
                   SPBFILE.SPB_INSTERM_1_11,
                   SPBFILE.SPB_INSRATE_1_11,
                   SPBFILE.SPB_INSTERM_1_12,
                   SPBFILE.SPB_INSRATE_1_12,
                   SPBFILE.SPB_INSTERM_1_13,
                   SPBFILE.SPB_INSRATE_1_13,
                   SPBFILE.SPB_INSTERM_1_14,
                   SPBFILE.SPB_INSRATE_1_14,
                   SPBFILE.SPB_INSTERM_1_15,
                   SPBFILE.SPB_INSRATE_1_15,
                   SPBFILE.SPB_INSTERM_1_16,
                   SPBFILE.SPB_INSRATE_1_16,
                   SPBFILE.SPB_INSTERM_1_17,
                   SPBFILE.SPB_INSRATE_1_17,
                   SPBFILE.SPB_INSTERM_1_18,
                   SPBFILE.SPB_INSRATE_1_18,
                   SPBFILE.SPB_INSTERM_1_19,
                   SPBFILE.SPB_INSRATE_1_19,
                   SPBFILE.SPB_INSTERM_1_20,
                   SPBFILE.SPB_INSRATE_1_20,
                   SPBFILE.SPB_INSMINPREM_1,
                   SPBFILE.SPB_INSMINCHGABL_1,
                   SPBFILE.SPB_INSMAXCHGABL_1,
                   SPBFILE.SPB_INSMAXBENIF_1,
                   SPBFILE.SPB_INSMAXTERM_1,
                   SPBFILE.SPB_INSCHGBEN_1,
                   SPBFILE.SPB_INSEXCEPT_1,
                   SPBFILE.SPB_INSNOVER_1,
                   SPBFILE.SPB_INSMINAGE_1_1,
                   SPBFILE.SPB_INSMAXAGE_1_1,
                   SPBFILE.SPB_INSMAXCOV_1_1,
                   SPBFILE.SPB_INSMAXTRM_1_1,
                   SPBFILE.SPB_INSMINAGE_1_2,
                   SPBFILE.SPB_INSMAXAGE_1_2,
                   SPBFILE.SPB_INSMAXCOV_1_2,
                   SPBFILE.SPB_INSMAXTRM_1_2,
                   SPBFILE.SPB_INSMINAGE_1_3,
                   SPBFILE.SPB_INSMAXAGE_1_3,
                   SPBFILE.SPB_INSMAXCOV_1_3,
                   SPBFILE.SPB_INSMAXTRM_1_3,
                   SPBFILE.SPB_INSMINAGE_1_4,
                   SPBFILE.SPB_INSMAXAGE_1_4,
                   SPBFILE.SPB_INSMAXCOV_1_4,
                   SPBFILE.SPB_INSMAXTRM_1_4,
                   SPBFILE.SPB_INSMINAGE_1_5,
                   SPBFILE.SPB_INSMAXAGE_1_5,
                   SPBFILE.SPB_INSMAXCOV_1_5,
                   SPBFILE.SPB_INSMAXTRM_1_5,
                   SPBFILE.SPB_INSFEECD_1,
                   SPBFILE.SPB_INSFEE_FRMLA_1,
                   SPBFILE.SPB_INSCHGABL_FG_1,
                   SPBFILE.SPB_INSREJECT_FG_1,
                   SPBFILE.SPB_INSFINCHG_1,
                   SPBFILE.SPB_INSCOM_2,
                   SPBFILE.SPB_INSRATECD_2,
                   SPBFILE.SPB_INSJFAC_2,
                   SPBFILE.SPB_INSDISCNT_2,
                   SPBFILE.SPB_INSCHGABL_2,
                   SPBFILE.SPB_INSTERM_2_1,
                   SPBFILE.SPB_INSRATE_2_1,
                   SPBFILE.SPB_INSTERM_2_2,
                   SPBFILE.SPB_INSRATE_2_2,
                   SPBFILE.SPB_INSTERM_2_3,
                   SPBFILE.SPB_INSRATE_2_3,
                   SPBFILE.SPB_INSTERM_2_4,
                   SPBFILE.SPB_INSRATE_2_4,
                   SPBFILE.SPB_INSTERM_2_5,
                   SPBFILE.SPB_INSRATE_2_5,
                   SPBFILE.SPB_INSTERM_2_6,
                   SPBFILE.SPB_INSRATE_2_6,
                   SPBFILE.SPB_INSTERM_2_7,
                   SPBFILE.SPB_INSRATE_2_7,
                   SPBFILE.SPB_INSTERM_2_8,
                   SPBFILE.SPB_INSRATE_2_8,
                   SPBFILE.SPB_INSTERM_2_9,
                   SPBFILE.SPB_INSRATE_2_9,
                   SPBFILE.SPB_INSTERM_2_10,
                   SPBFILE.SPB_INSRATE_2_10,
                   SPBFILE.SPB_INSTERM_2_11,
                   SPBFILE.SPB_INSRATE_2_11,
                   SPBFILE.SPB_INSTERM_2_12,
                   SPBFILE.SPB_INSRATE_2_12,
                   SPBFILE.SPB_INSTERM_2_13,
                   SPBFILE.SPB_INSRATE_2_13,
                   SPBFILE.SPB_INSTERM_2_14,
                   SPBFILE.SPB_INSRATE_2_14,
                   SPBFILE.SPB_INSTERM_2_15,
                   SPBFILE.SPB_INSRATE_2_15,
                   SPBFILE.SPB_INSTERM_2_16,
                   SPBFILE.SPB_INSRATE_2_16,
                   SPBFILE.SPB_INSTERM_2_17,
                   SPBFILE.SPB_INSRATE_2_17,
                   SPBFILE.SPB_INSTERM_2_18,
                   SPBFILE.SPB_INSRATE_2_18,
                   SPBFILE.SPB_INSTERM_2_19,
                   SPBFILE.SPB_INSRATE_2_19,
                   SPBFILE.SPB_INSTERM_2_20,
                   SPBFILE.SPB_INSRATE_2_20,
                   SPBFILE.SPB_INSMINPREM_2,
                   SPBFILE.SPB_INSMINCHGABL_2,
                   SPBFILE.SPB_INSMAXCHGABL_2,
                   SPBFILE.SPB_INSMAXBENIF_2,
                   SPBFILE.SPB_INSMAXTERM_2,
                   SPBFILE.SPB_INSCHGBEN_2,
                   SPBFILE.SPB_INSEXCEPT_2,
                   SPBFILE.SPB_INSNOVER_2,
                   SPBFILE.SPB_INSMINAGE_2_1,
                   SPBFILE.SPB_INSMAXAGE_2_1,
                   SPBFILE.SPB_INSMAXCOV_2_1,
                   SPBFILE.SPB_INSMAXTRM_2_1,
                   SPBFILE.SPB_INSMINAGE_2_2,
                   SPBFILE.SPB_INSMAXAGE_2_2,
                   SPBFILE.SPB_INSMAXCOV_2_2,
                   SPBFILE.SPB_INSMAXTRM_2_2,
                   SPBFILE.SPB_INSMINAGE_2_3,
                   SPBFILE.SPB_INSMAXAGE_2_3,
                   SPBFILE.SPB_INSMAXCOV_2_3,
                   SPBFILE.SPB_INSMAXTRM_2_3,
                   SPBFILE.SPB_INSMINAGE_2_4,
                   SPBFILE.SPB_INSMAXAGE_2_4,
                   SPBFILE.SPB_INSMAXCOV_2_4,
                   SPBFILE.SPB_INSMAXTRM_2_4,
                   SPBFILE.SPB_INSMINAGE_2_5,
                   SPBFILE.SPB_INSMAXAGE_2_5,
                   SPBFILE.SPB_INSMAXCOV_2_5,
                   SPBFILE.SPB_INSMAXTRM_2_5,
                   SPBFILE.SPB_INSFEECD_2,
                   SPBFILE.SPB_INSFEE_FRMLA_2,
                   SPBFILE.SPB_INSCHGABL_FG_2,
                   SPBFILE.SPB_INSREJECT_FG_2,
                   SPBFILE.SPB_INSFINCHG_2,
                   SPBFILE.SPB_INSCOM_3,
                   SPBFILE.SPB_INSRATECD_3,
                   SPBFILE.SPB_INSJFAC_3,
                   SPBFILE.SPB_INSDISCNT_3,
                   SPBFILE.SPB_INSCHGABL_3,
                   SPBFILE.SPB_INSTERM_3_1,
                   SPBFILE.SPB_INSRATE_3_1,
                   SPBFILE.SPB_INSTERM_3_2,
                   SPBFILE.SPB_INSRATE_3_2,
                   SPBFILE.SPB_INSTERM_3_3,
                   SPBFILE.SPB_INSRATE_3_3,
                   SPBFILE.SPB_INSTERM_3_4,
                   SPBFILE.SPB_INSRATE_3_4,
                   SPBFILE.SPB_INSTERM_3_5,
                   SPBFILE.SPB_INSRATE_3_5,
                   SPBFILE.SPB_INSTERM_3_6,
                   SPBFILE.SPB_INSRATE_3_6,
                   SPBFILE.SPB_INSTERM_3_7,
                   SPBFILE.SPB_INSRATE_3_7,
                   SPBFILE.SPB_INSTERM_3_8,
                   SPBFILE.SPB_INSRATE_3_8,
                   SPBFILE.SPB_INSTERM_3_9,
                   SPBFILE.SPB_INSRATE_3_9,
                   SPBFILE.SPB_INSTERM_3_10,
                   SPBFILE.SPB_INSRATE_3_10,
                   SPBFILE.SPB_INSTERM_3_11,
                   SPBFILE.SPB_INSRATE_3_11,
                   SPBFILE.SPB_INSTERM_3_12,
                   SPBFILE.SPB_INSRATE_3_12,
                   SPBFILE.SPB_INSTERM_3_13,
                   SPBFILE.SPB_INSRATE_3_13,
                   SPBFILE.SPB_INSTERM_3_14,
                   SPBFILE.SPB_INSRATE_3_14,
                   SPBFILE.SPB_INSTERM_3_15,
                   SPBFILE.SPB_INSRATE_3_15,
                   SPBFILE.SPB_INSTERM_3_16,
                   SPBFILE.SPB_INSRATE_3_16,
                   SPBFILE.SPB_INSTERM_3_17,
                   SPBFILE.SPB_INSRATE_3_17,
                   SPBFILE.SPB_INSTERM_3_18,
                   SPBFILE.SPB_INSRATE_3_18,
                   SPBFILE.SPB_INSTERM_3_19,
                   SPBFILE.SPB_INSRATE_3_19,
                   SPBFILE.SPB_INSTERM_3_20,
                   SPBFILE.SPB_INSRATE_3_20,
                   SPBFILE.SPB_INSMINPREM_3,
                   SPBFILE.SPB_INSMINCHGABL_3,
                   SPBFILE.SPB_INSMAXCHGABL_3,
                   SPBFILE.SPB_INSMAXBENIF_3,
                   SPBFILE.SPB_INSMAXTERM_3,
                   SPBFILE.SPB_INSCHGBEN_3,
                   SPBFILE.SPB_INSEXCEPT_3,
                   SPBFILE.SPB_INSNOVER_3,
                   SPBFILE.SPB_INSMINAGE_3_1,
                   SPBFILE.SPB_INSMAXAGE_3_1,
                   SPBFILE.SPB_INSMAXCOV_3_1,
                   SPBFILE.SPB_INSMAXTRM_3_1,
                   SPBFILE.SPB_INSMINAGE_3_2,
                   SPBFILE.SPB_INSMAXAGE_3_2,
                   SPBFILE.SPB_INSMAXCOV_3_2,
                   SPBFILE.SPB_INSMAXTRM_3_2,
                   SPBFILE.SPB_INSMINAGE_3_3,
                   SPBFILE.SPB_INSMAXAGE_3_3,
                   SPBFILE.SPB_INSMAXCOV_3_3,
                   SPBFILE.SPB_INSMAXTRM_3_3,
                   SPBFILE.SPB_INSMINAGE_3_4,
                   SPBFILE.SPB_INSMAXAGE_3_4,
                   SPBFILE.SPB_INSMAXCOV_3_4,
                   SPBFILE.SPB_INSMAXTRM_3_4,
                   SPBFILE.SPB_INSMINAGE_3_5,
                   SPBFILE.SPB_INSMAXAGE_3_5,
                   SPBFILE.SPB_INSMAXCOV_3_5,
                   SPBFILE.SPB_INSMAXTRM_3_5,
                   SPBFILE.SPB_INSFEECD_3,
                   SPBFILE.SPB_INSFEE_FRMLA_3,
                   SPBFILE.SPB_INSCHGABL_FG_3,
                   SPBFILE.SPB_INSREJECT_FG_3,
                   SPBFILE.SPB_INSFINCHG_3,
                   SPBFILE.SPB_INSCOM_4,
                   SPBFILE.SPB_INSRATECD_4,
                   SPBFILE.SPB_INSJFAC_4,
                   SPBFILE.SPB_INSDISCNT_4,
                   SPBFILE.SPB_INSCHGABL_4,
                   SPBFILE.SPB_INSTERM_4_1,
                   SPBFILE.SPB_INSRATE_4_1,
                   SPBFILE.SPB_INSTERM_4_2,
                   SPBFILE.SPB_INSRATE_4_2,
                   SPBFILE.SPB_INSTERM_4_3,
                   SPBFILE.SPB_INSRATE_4_3,
                   SPBFILE.SPB_INSTERM_4_4,
                   SPBFILE.SPB_INSRATE_4_4,
                   SPBFILE.SPB_INSTERM_4_5,
                   SPBFILE.SPB_INSRATE_4_5,
                   SPBFILE.SPB_INSTERM_4_6,
                   SPBFILE.SPB_INSRATE_4_6,
                   SPBFILE.SPB_INSTERM_4_7,
                   SPBFILE.SPB_INSRATE_4_7,
                   SPBFILE.SPB_INSTERM_4_8,
                   SPBFILE.SPB_INSRATE_4_8,
                   SPBFILE.SPB_INSTERM_4_9,
                   SPBFILE.SPB_INSRATE_4_9,
                   SPBFILE.SPB_INSTERM_4_10,
                   SPBFILE.SPB_INSRATE_4_10,
                   SPBFILE.SPB_INSTERM_4_11,
                   SPBFILE.SPB_INSRATE_4_11,
                   SPBFILE.SPB_INSTERM_4_12,
                   SPBFILE.SPB_INSRATE_4_12,
                   SPBFILE.SPB_INSTERM_4_13,
                   SPBFILE.SPB_INSRATE_4_13,
                   SPBFILE.SPB_INSTERM_4_14,
                   SPBFILE.SPB_INSRATE_4_14,
                   SPBFILE.SPB_INSTERM_4_15,
                   SPBFILE.SPB_INSRATE_4_15,
                   SPBFILE.SPB_INSTERM_4_16,
                   SPBFILE.SPB_INSRATE_4_16,
                   SPBFILE.SPB_INSTERM_4_17,
                   SPBFILE.SPB_INSRATE_4_17,
                   SPBFILE.SPB_INSTERM_4_18,
                   SPBFILE.SPB_INSRATE_4_18,
                   SPBFILE.SPB_INSTERM_4_19,
                   SPBFILE.SPB_INSRATE_4_19,
                   SPBFILE.SPB_INSTERM_4_20,
                   SPBFILE.SPB_INSRATE_4_20,
                   SPBFILE.SPB_INSMINPREM_4,
                   SPBFILE.SPB_INSMINCHGABL_4,
                   SPBFILE.SPB_INSMAXCHGABL_4,
                   SPBFILE.SPB_INSMAXBENIF_4,
                   SPBFILE.SPB_INSMAXTERM_4,
                   SPBFILE.SPB_INSCHGBEN_4,
                   SPBFILE.SPB_INSEXCEPT_4,
                   SPBFILE.SPB_INSNOVER_4,
                   SPBFILE.SPB_INSMINAGE_4_1,
                   SPBFILE.SPB_INSMAXAGE_4_1,
                   SPBFILE.SPB_INSMAXCOV_4_1,
                   SPBFILE.SPB_INSMAXTRM_4_1,
                   SPBFILE.SPB_INSMINAGE_4_2,
                   SPBFILE.SPB_INSMAXAGE_4_2,
                   SPBFILE.SPB_INSMAXCOV_4_2,
                   SPBFILE.SPB_INSMAXTRM_4_2,
                   SPBFILE.SPB_INSMINAGE_4_3,
                   SPBFILE.SPB_INSMAXAGE_4_3,
                   SPBFILE.SPB_INSMAXCOV_4_3,
                   SPBFILE.SPB_INSMAXTRM_4_3,
                   SPBFILE.SPB_INSMINAGE_4_4,
                   SPBFILE.SPB_INSMAXAGE_4_4,
                   SPBFILE.SPB_INSMAXCOV_4_4,
                   SPBFILE.SPB_INSMAXTRM_4_4,
                   SPBFILE.SPB_INSMINAGE_4_5,
                   SPBFILE.SPB_INSMAXAGE_4_5,
                   SPBFILE.SPB_INSMAXCOV_4_5,
                   SPBFILE.SPB_INSMAXTRM_4_5,
                   SPBFILE.SPB_INSFEECD_4,
                   SPBFILE.SPB_INSFEE_FRMLA_4,
                   SPBFILE.SPB_INSCHGABL_FG_4,
                   SPBFILE.SPB_INSREJECT_FG_4,
                   SPBFILE.SPB_INSFINCHG_4,
                   SPBFILE.SPB_INSCOM_5,
                   SPBFILE.SPB_INSRATECD_5,
                   SPBFILE.SPB_INSJFAC_5,
                   SPBFILE.SPB_INSDISCNT_5,
                   SPBFILE.SPB_INSCHGABL_5,
                   SPBFILE.SPB_INSTERM_5_1,
                   SPBFILE.SPB_INSRATE_5_1,
                   SPBFILE.SPB_INSTERM_5_2,
                   SPBFILE.SPB_INSRATE_5_2,
                   SPBFILE.SPB_INSTERM_5_3,
                   SPBFILE.SPB_INSRATE_5_3,
                   SPBFILE.SPB_INSTERM_5_4,
                   SPBFILE.SPB_INSRATE_5_4,
                   SPBFILE.SPB_INSTERM_5_5,
                   SPBFILE.SPB_INSRATE_5_5,
                   SPBFILE.SPB_INSTERM_5_6,
                   SPBFILE.SPB_INSRATE_5_6,
                   SPBFILE.SPB_INSTERM_5_7,
                   SPBFILE.SPB_INSRATE_5_7,
                   SPBFILE.SPB_INSTERM_5_8,
                   SPBFILE.SPB_INSRATE_5_8,
                   SPBFILE.SPB_INSTERM_5_9,
                   SPBFILE.SPB_INSRATE_5_9,
                   SPBFILE.SPB_INSTERM_5_10,
                   SPBFILE.SPB_INSRATE_5_10,
                   SPBFILE.SPB_INSTERM_5_11,
                   SPBFILE.SPB_INSRATE_5_11,
                   SPBFILE.SPB_INSTERM_5_12,
                   SPBFILE.SPB_INSRATE_5_12,
                   SPBFILE.SPB_INSTERM_5_13,
                   SPBFILE.SPB_INSRATE_5_13,
                   SPBFILE.SPB_INSTERM_5_14,
                   SPBFILE.SPB_INSRATE_5_14,
                   SPBFILE.SPB_INSTERM_5_15,
                   SPBFILE.SPB_INSRATE_5_15,
                   SPBFILE.SPB_INSTERM_5_16,
                   SPBFILE.SPB_INSRATE_5_16,
                   SPBFILE.SPB_INSTERM_5_17,
                   SPBFILE.SPB_INSRATE_5_17,
                   SPBFILE.SPB_INSTERM_5_18,
                   SPBFILE.SPB_INSRATE_5_18,
                   SPBFILE.SPB_INSTERM_5_19,
                   SPBFILE.SPB_INSRATE_5_19,
                   SPBFILE.SPB_INSTERM_5_20,
                   SPBFILE.SPB_INSRATE_5_20,
                   SPBFILE.SPB_INSMINPREM_5,
                   SPBFILE.SPB_INSMINCHGABL_5,
                   SPBFILE.SPB_INSMAXCHGABL_5,
                   SPBFILE.SPB_INSMAXBENIF_5,
                   SPBFILE.SPB_INSMAXTERM_5,
                   SPBFILE.SPB_INSCHGBEN_5,
                   SPBFILE.SPB_INSEXCEPT_5,
                   SPBFILE.SPB_INSNOVER_5,
                   SPBFILE.SPB_INSMINAGE_5_1,
                   SPBFILE.SPB_INSMAXAGE_5_1,
                   SPBFILE.SPB_INSMAXCOV_5_1,
                   SPBFILE.SPB_INSMAXTRM_5_1,
                   SPBFILE.SPB_INSMINAGE_5_2,
                   SPBFILE.SPB_INSMAXAGE_5_2,
                   SPBFILE.SPB_INSMAXCOV_5_2,
                   SPBFILE.SPB_INSMAXTRM_5_2,
                   SPBFILE.SPB_INSMINAGE_5_3,
                   SPBFILE.SPB_INSMAXAGE_5_3,
                   SPBFILE.SPB_INSMAXCOV_5_3,
                   SPBFILE.SPB_INSMAXTRM_5_3,
                   SPBFILE.SPB_INSMINAGE_5_4,
                   SPBFILE.SPB_INSMAXAGE_5_4,
                   SPBFILE.SPB_INSMAXCOV_5_4,
                   SPBFILE.SPB_INSMAXTRM_5_4,
                   SPBFILE.SPB_INSMINAGE_5_5,
                   SPBFILE.SPB_INSMAXAGE_5_5,
                   SPBFILE.SPB_INSMAXCOV_5_5,
                   SPBFILE.SPB_INSMAXTRM_5_5,
                   SPBFILE.SPB_INSFEECD_5,
                   SPBFILE.SPB_INSFEE_FRMLA_5,
                   SPBFILE.SPB_INSCHGABL_FG_5,
                   SPBFILE.SPB_INSREJECT_FG_5,
                   SPBFILE.SPB_INSFINCHG_5,
                   SPBFILE.SPB_INSCOM_6,
                   SPBFILE.SPB_INSRATECD_6,
                   SPBFILE.SPB_INSJFAC_6,
                   SPBFILE.SPB_INSDISCNT_6,
                   SPBFILE.SPB_INSCHGABL_6,
                   SPBFILE.SPB_INSTERM_6_1,
                   SPBFILE.SPB_INSRATE_6_1,
                   SPBFILE.SPB_INSTERM_6_2,
                   SPBFILE.SPB_INSRATE_6_2,
                   SPBFILE.SPB_INSTERM_6_3,
                   SPBFILE.SPB_INSRATE_6_3,
                   SPBFILE.SPB_INSTERM_6_4,
                   SPBFILE.SPB_INSRATE_6_4,
                   SPBFILE.SPB_INSTERM_6_5,
                   SPBFILE.SPB_INSRATE_6_5,
                   SPBFILE.SPB_INSTERM_6_6,
                   SPBFILE.SPB_INSRATE_6_6,
                   SPBFILE.SPB_INSTERM_6_7,
                   SPBFILE.SPB_INSRATE_6_7,
                   SPBFILE.SPB_INSTERM_6_8,
                   SPBFILE.SPB_INSRATE_6_8,
                   SPBFILE.SPB_INSTERM_6_9,
                   SPBFILE.SPB_INSRATE_6_9,
                   SPBFILE.SPB_INSTERM_6_10,
                   SPBFILE.SPB_INSRATE_6_10,
                   SPBFILE.SPB_INSTERM_6_11,
                   SPBFILE.SPB_INSRATE_6_11,
                   SPBFILE.SPB_INSTERM_6_12,
                   SPBFILE.SPB_INSRATE_6_12,
                   SPBFILE.SPB_INSTERM_6_13,
                   SPBFILE.SPB_INSRATE_6_13,
                   SPBFILE.SPB_INSTERM_6_14,
                   SPBFILE.SPB_INSRATE_6_14,
                   SPBFILE.SPB_INSTERM_6_15,
                   SPBFILE.SPB_INSRATE_6_15,
                   SPBFILE.SPB_INSTERM_6_16,
                   SPBFILE.SPB_INSRATE_6_16,
                   SPBFILE.SPB_INSTERM_6_17,
                   SPBFILE.SPB_INSRATE_6_17,
                   SPBFILE.SPB_INSTERM_6_18,
                   SPBFILE.SPB_INSRATE_6_18,
                   SPBFILE.SPB_INSTERM_6_19,
                   SPBFILE.SPB_INSRATE_6_19,
                   SPBFILE.SPB_INSTERM_6_20,
                   SPBFILE.SPB_INSRATE_6_20,
                   SPBFILE.SPB_INSMINPREM_6,
                   SPBFILE.SPB_INSMINCHGABL_6,
                   SPBFILE.SPB_INSMAXCHGABL_6,
                   SPBFILE.SPB_INSMAXBENIF_6,
                   SPBFILE.SPB_INSMAXTERM_6,
                   SPBFILE.SPB_INSCHGBEN_6,
                   SPBFILE.SPB_INSEXCEPT_6,
                   SPBFILE.SPB_INSNOVER_6,
                   SPBFILE.SPB_INSMINAGE_6_1,
                   SPBFILE.SPB_INSMAXAGE_6_1,
                   SPBFILE.SPB_INSMAXCOV_6_1,
                   SPBFILE.SPB_INSMAXTRM_6_1,
                   SPBFILE.SPB_INSMINAGE_6_2,
                   SPBFILE.SPB_INSMAXAGE_6_2,
                   SPBFILE.SPB_INSMAXCOV_6_2,
                   SPBFILE.SPB_INSMAXTRM_6_2,
                   SPBFILE.SPB_INSMINAGE_6_3,
                   SPBFILE.SPB_INSMAXAGE_6_3,
                   SPBFILE.SPB_INSMAXCOV_6_3,
                   SPBFILE.SPB_INSMAXTRM_6_3,
                   SPBFILE.SPB_INSMINAGE_6_4,
                   SPBFILE.SPB_INSMAXAGE_6_4,
                   SPBFILE.SPB_INSMAXCOV_6_4,
                   SPBFILE.SPB_INSMAXTRM_6_4,
                   SPBFILE.SPB_INSMINAGE_6_5,
                   SPBFILE.SPB_INSMAXAGE_6_5,
                   SPBFILE.SPB_INSMAXCOV_6_5,
                   SPBFILE.SPB_INSMAXTRM_6_5,
                   SPBFILE.SPB_INSFEECD_6,
                   SPBFILE.SPB_INSFEE_FRMLA_6,
                   SPBFILE.SPB_INSCHGABL_FG_6,
                   SPBFILE.SPB_INSREJECT_FG_6,
                   SPBFILE.SPB_INSFINCHG_6,
                   SPBFILE.SPB_INSCOM_7,
                   SPBFILE.SPB_INSRATECD_7,
                   SPBFILE.SPB_INSJFAC_7,
                   SPBFILE.SPB_INSDISCNT_7,
                   SPBFILE.SPB_INSCHGABL_7,
                   SPBFILE.SPB_INSTERM_7_1,
                   SPBFILE.SPB_INSRATE_7_1,
                   SPBFILE.SPB_INSTERM_7_2,
                   SPBFILE.SPB_INSRATE_7_2,
                   SPBFILE.SPB_INSTERM_7_3,
                   SPBFILE.SPB_INSRATE_7_3,
                   SPBFILE.SPB_INSTERM_7_4,
                   SPBFILE.SPB_INSRATE_7_4,
                   SPBFILE.SPB_INSTERM_7_5,
                   SPBFILE.SPB_INSRATE_7_5,
                   SPBFILE.SPB_INSTERM_7_6,
                   SPBFILE.SPB_INSRATE_7_6,
                   SPBFILE.SPB_INSTERM_7_7,
                   SPBFILE.SPB_INSRATE_7_7,
                   SPBFILE.SPB_INSTERM_7_8,
                   SPBFILE.SPB_INSRATE_7_8,
                   SPBFILE.SPB_INSTERM_7_9,
                   SPBFILE.SPB_INSRATE_7_9,
                   SPBFILE.SPB_INSTERM_7_10,
                   SPBFILE.SPB_INSRATE_7_10,
                   SPBFILE.SPB_INSTERM_7_11,
                   SPBFILE.SPB_INSRATE_7_11,
                   SPBFILE.SPB_INSTERM_7_12,
                   SPBFILE.SPB_INSRATE_7_12,
                   SPBFILE.SPB_INSTERM_7_13,
                   SPBFILE.SPB_INSRATE_7_13,
                   SPBFILE.SPB_INSTERM_7_14,
                   SPBFILE.SPB_INSRATE_7_14,
                   SPBFILE.SPB_INSTERM_7_15,
                   SPBFILE.SPB_INSRATE_7_15,
                   SPBFILE.SPB_INSTERM_7_16,
                   SPBFILE.SPB_INSRATE_7_16,
                   SPBFILE.SPB_INSTERM_7_17,
                   SPBFILE.SPB_INSRATE_7_17,
                   SPBFILE.SPB_INSTERM_7_18,
                   SPBFILE.SPB_INSRATE_7_18,
                   SPBFILE.SPB_INSTERM_7_19,
                   SPBFILE.SPB_INSRATE_7_19,
                   SPBFILE.SPB_INSTERM_7_20,
                   SPBFILE.SPB_INSRATE_7_20,
                   SPBFILE.SPB_INSMINPREM_7,
                   SPBFILE.SPB_INSMINCHGABL_7,
                   SPBFILE.SPB_INSMAXCHGABL_7,
                   SPBFILE.SPB_INSMAXBENIF_7,
                   SPBFILE.SPB_INSMAXTERM_7,
                   SPBFILE.SPB_INSCHGBEN_7,
                   SPBFILE.SPB_INSEXCEPT_7,
                   SPBFILE.SPB_INSNOVER_7,
                   SPBFILE.SPB_INSMINAGE_7_1,
                   SPBFILE.SPB_INSMAXAGE_7_1,
                   SPBFILE.SPB_INSMAXCOV_7_1,
                   SPBFILE.SPB_INSMAXTRM_7_1,
                   SPBFILE.SPB_INSMINAGE_7_2,
                   SPBFILE.SPB_INSMAXAGE_7_2,
                   SPBFILE.SPB_INSMAXCOV_7_2,
                   SPBFILE.SPB_INSMAXTRM_7_2,
                   SPBFILE.SPB_INSMINAGE_7_3,
                   SPBFILE.SPB_INSMAXAGE_7_3,
                   SPBFILE.SPB_INSMAXCOV_7_3,
                   SPBFILE.SPB_INSMAXTRM_7_3,
                   SPBFILE.SPB_INSMINAGE_7_4,
                   SPBFILE.SPB_INSMAXAGE_7_4,
                   SPBFILE.SPB_INSMAXCOV_7_4,
                   SPBFILE.SPB_INSMAXTRM_7_4,
                   SPBFILE.SPB_INSMINAGE_7_5,
                   SPBFILE.SPB_INSMAXAGE_7_5,
                   SPBFILE.SPB_INSMAXCOV_7_5,
                   SPBFILE.SPB_INSMAXTRM_7_5,
                   SPBFILE.SPB_INSFEECD_7,
                   SPBFILE.SPB_INSFEE_FRMLA_7,
                   SPBFILE.SPB_INSCHGABL_FG_7,
                   SPBFILE.SPB_INSREJECT_FG_7,
                   SPBFILE.SPB_INSFINCHG_7,
                   SPBFILE.SPB_INSCOM_8,
                   SPBFILE.SPB_INSRATECD_8,
                   SPBFILE.SPB_INSJFAC_8,
                   SPBFILE.SPB_INSDISCNT_8,
                   SPBFILE.SPB_INSCHGABL_8,
                   SPBFILE.SPB_INSTERM_8_1,
                   SPBFILE.SPB_INSRATE_8_1,
                   SPBFILE.SPB_INSTERM_8_2,
                   SPBFILE.SPB_INSRATE_8_2,
                   SPBFILE.SPB_INSTERM_8_3,
                   SPBFILE.SPB_INSRATE_8_3,
                   SPBFILE.SPB_INSTERM_8_4,
                   SPBFILE.SPB_INSRATE_8_4,
                   SPBFILE.SPB_INSTERM_8_5,
                   SPBFILE.SPB_INSRATE_8_5,
                   SPBFILE.SPB_INSTERM_8_6,
                   SPBFILE.SPB_INSRATE_8_6,
                   SPBFILE.SPB_INSTERM_8_7,
                   SPBFILE.SPB_INSRATE_8_7,
                   SPBFILE.SPB_INSTERM_8_8,
                   SPBFILE.SPB_INSRATE_8_8,
                   SPBFILE.SPB_INSTERM_8_9,
                   SPBFILE.SPB_INSRATE_8_9,
                   SPBFILE.SPB_INSTERM_8_10,
                   SPBFILE.SPB_INSRATE_8_10,
                   SPBFILE.SPB_INSTERM_8_11,
                   SPBFILE.SPB_INSRATE_8_11,
                   SPBFILE.SPB_INSTERM_8_12,
                   SPBFILE.SPB_INSRATE_8_12,
                   SPBFILE.SPB_INSTERM_8_13,
                   SPBFILE.SPB_INSRATE_8_13,
                   SPBFILE.SPB_INSTERM_8_14,
                   SPBFILE.SPB_INSRATE_8_14,
                   SPBFILE.SPB_INSTERM_8_15,
                   SPBFILE.SPB_INSRATE_8_15,
                   SPBFILE.SPB_INSTERM_8_16,
                   SPBFILE.SPB_INSRATE_8_16,
                   SPBFILE.SPB_INSTERM_8_17,
                   SPBFILE.SPB_INSRATE_8_17,
                   SPBFILE.SPB_INSTERM_8_18,
                   SPBFILE.SPB_INSRATE_8_18,
                   SPBFILE.SPB_INSTERM_8_19,
                   SPBFILE.SPB_INSRATE_8_19,
                   SPBFILE.SPB_INSTERM_8_20,
                   SPBFILE.SPB_INSRATE_8_20,
                   SPBFILE.SPB_INSMINPREM_8,
                   SPBFILE.SPB_INSMINCHGABL_8,
                   SPBFILE.SPB_INSMAXCHGABL_8,
                   SPBFILE.SPB_INSMAXBENIF_8,
                   SPBFILE.SPB_INSMAXTERM_8,
                   SPBFILE.SPB_INSCHGBEN_8,
                   SPBFILE.SPB_INSEXCEPT_8,
                   SPBFILE.SPB_INSNOVER_8,
                   SPBFILE.SPB_INSMINAGE_8_1,
                   SPBFILE.SPB_INSMAXAGE_8_1,
                   SPBFILE.SPB_INSMAXCOV_8_1,
                   SPBFILE.SPB_INSMAXTRM_8_1,
                   SPBFILE.SPB_INSMINAGE_8_2,
                   SPBFILE.SPB_INSMAXAGE_8_2,
                   SPBFILE.SPB_INSMAXCOV_8_2,
                   SPBFILE.SPB_INSMAXTRM_8_2,
                   SPBFILE.SPB_INSMINAGE_8_3,
                   SPBFILE.SPB_INSMAXAGE_8_3,
                   SPBFILE.SPB_INSMAXCOV_8_3,
                   SPBFILE.SPB_INSMAXTRM_8_3,
                   SPBFILE.SPB_INSMINAGE_8_4,
                   SPBFILE.SPB_INSMAXAGE_8_4,
                   SPBFILE.SPB_INSMAXCOV_8_4,
                   SPBFILE.SPB_INSMAXTRM_8_4,
                   SPBFILE.SPB_INSMINAGE_8_5,
                   SPBFILE.SPB_INSMAXAGE_8_5,
                   SPBFILE.SPB_INSMAXCOV_8_5,
                   SPBFILE.SPB_INSMAXTRM_8_5,
                   SPBFILE.SPB_INSFEECD_8,
                   SPBFILE.SPB_INSFEE_FRMLA_8,
                   SPBFILE.SPB_INSCHGABL_FG_8,
                   SPBFILE.SPB_INSREJECT_FG_8,
                   SPBFILE.SPB_INSFINCHG_8,
                   SPBFILE.SPB_INSCOM_9,
                   SPBFILE.SPB_INSRATECD_9,
                   SPBFILE.SPB_INSJFAC_9,
                   SPBFILE.SPB_INSDISCNT_9,
                   SPBFILE.SPB_INSCHGABL_9,
                   SPBFILE.SPB_INSTERM_9_1,
                   SPBFILE.SPB_INSRATE_9_1,
                   SPBFILE.SPB_INSTERM_9_2,
                   SPBFILE.SPB_INSRATE_9_2,
                   SPBFILE.SPB_INSTERM_9_3,
                   SPBFILE.SPB_INSRATE_9_3,
                   SPBFILE.SPB_INSTERM_9_4,
                   SPBFILE.SPB_INSRATE_9_4,
                   SPBFILE.SPB_INSTERM_9_5,
                   SPBFILE.SPB_INSRATE_9_5,
                   SPBFILE.SPB_INSTERM_9_6,
                   SPBFILE.SPB_INSRATE_9_6,
                   SPBFILE.SPB_INSTERM_9_7,
                   SPBFILE.SPB_INSRATE_9_7,
                   SPBFILE.SPB_INSTERM_9_8,
                   SPBFILE.SPB_INSRATE_9_8,
                   SPBFILE.SPB_INSTERM_9_9,
                   SPBFILE.SPB_INSRATE_9_9,
                   SPBFILE.SPB_INSTERM_9_10,
                   SPBFILE.SPB_INSRATE_9_10,
                   SPBFILE.SPB_INSTERM_9_11,
                   SPBFILE.SPB_INSRATE_9_11,
                   SPBFILE.SPB_INSTERM_9_12,
                   SPBFILE.SPB_INSRATE_9_12,
                   SPBFILE.SPB_INSTERM_9_13,
                   SPBFILE.SPB_INSRATE_9_13,
                   SPBFILE.SPB_INSTERM_9_14,
                   SPBFILE.SPB_INSRATE_9_14,
                   SPBFILE.SPB_INSTERM_9_15,
                   SPBFILE.SPB_INSRATE_9_15,
                   SPBFILE.SPB_INSTERM_9_16,
                   SPBFILE.SPB_INSRATE_9_16,
                   SPBFILE.SPB_INSTERM_9_17,
                   SPBFILE.SPB_INSRATE_9_17,
                   SPBFILE.SPB_INSTERM_9_18,
                   SPBFILE.SPB_INSRATE_9_18,
                   SPBFILE.SPB_INSTERM_9_19,
                   SPBFILE.SPB_INSRATE_9_19,
                   SPBFILE.SPB_INSTERM_9_20,
                   SPBFILE.SPB_INSRATE_9_20,
                   SPBFILE.SPB_INSMINPREM_9,
                   SPBFILE.SPB_INSMINCHGABL_9,
                   SPBFILE.SPB_INSMAXCHGABL_9,
                   SPBFILE.SPB_INSMAXBENIF_9,
                   SPBFILE.SPB_INSMAXTERM_9,
                   SPBFILE.SPB_INSCHGBEN_9,
                   SPBFILE.SPB_INSEXCEPT_9,
                   SPBFILE.SPB_INSNOVER_9,
                   SPBFILE.SPB_INSMINAGE_9_1,
                   SPBFILE.SPB_INSMAXAGE_9_1,
                   SPBFILE.SPB_INSMAXCOV_9_1,
                   SPBFILE.SPB_INSMAXTRM_9_1,
                   SPBFILE.SPB_INSMINAGE_9_2,
                   SPBFILE.SPB_INSMAXAGE_9_2,
                   SPBFILE.SPB_INSMAXCOV_9_2,
                   SPBFILE.SPB_INSMAXTRM_9_2,
                   SPBFILE.SPB_INSMINAGE_9_3,
                   SPBFILE.SPB_INSMAXAGE_9_3,
                   SPBFILE.SPB_INSMAXCOV_9_3,
                   SPBFILE.SPB_INSMAXTRM_9_3,
                   SPBFILE.SPB_INSMINAGE_9_4,
                   SPBFILE.SPB_INSMAXAGE_9_4,
                   SPBFILE.SPB_INSMAXCOV_9_4,
                   SPBFILE.SPB_INSMAXTRM_9_4,
                   SPBFILE.SPB_INSMINAGE_9_5,
                   SPBFILE.SPB_INSMAXAGE_9_5,
                   SPBFILE.SPB_INSMAXCOV_9_5,
                   SPBFILE.SPB_INSMAXTRM_9_5,
                   SPBFILE.SPB_INSFEECD_9,
                   SPBFILE.SPB_INSFEE_FRMLA_9,
                   SPBFILE.SPB_INSCHGABL_FG_9,
                   SPBFILE.SPB_INSREJECT_FG_9,
                   SPBFILE.SPB_INSFINCHG_9,
                   SPBFILE.SPB_INSCOM_10,
                   SPBFILE.SPB_INSRATECD_10,
                   SPBFILE.SPB_INSJFAC_10,
                   SPBFILE.SPB_INSDISCNT_10,
                   SPBFILE.SPB_INSCHGABL_10,
                   SPBFILE.SPB_INSTERM_10_1,
                   SPBFILE.SPB_INSRATE_10_1,
                   SPBFILE.SPB_INSTERM_10_2,
                   SPBFILE.SPB_INSRATE_10_2,
                   SPBFILE.SPB_INSTERM_10_3,
                   SPBFILE.SPB_INSRATE_10_3,
                   SPBFILE.SPB_INSTERM_10_4,
                   SPBFILE.SPB_INSRATE_10_4,
                   SPBFILE.SPB_INSTERM_10_5,
                   SPBFILE.SPB_INSRATE_10_5,
                   SPBFILE.SPB_INSTERM_10_6,
                   SPBFILE.SPB_INSRATE_10_6,
                   SPBFILE.SPB_INSTERM_10_7,
                   SPBFILE.SPB_INSRATE_10_7,
                   SPBFILE.SPB_INSTERM_10_8,
                   SPBFILE.SPB_INSRATE_10_8,
                   SPBFILE.SPB_INSTERM_10_9,
                   SPBFILE.SPB_INSRATE_10_9,
                   SPBFILE.SPB_INSTERM_10_10,
                   SPBFILE.SPB_INSRATE_10_10,
                   SPBFILE.SPB_INSTERM_10_11,
                   SPBFILE.SPB_INSRATE_10_11,
                   SPBFILE.SPB_INSTERM_10_12,
                   SPBFILE.SPB_INSRATE_10_12,
                   SPBFILE.SPB_INSTERM_10_13,
                   SPBFILE.SPB_INSRATE_10_13,
                   SPBFILE.SPB_INSTERM_10_14,
                   SPBFILE.SPB_INSRATE_10_14,
                   SPBFILE.SPB_INSTERM_10_15,
                   SPBFILE.SPB_INSRATE_10_15,
                   SPBFILE.SPB_INSTERM_10_16,
                   SPBFILE.SPB_INSRATE_10_16,
                   SPBFILE.SPB_INSTERM_10_17,
                   SPBFILE.SPB_INSRATE_10_17,
                   SPBFILE.SPB_INSTERM_10_18,
                   SPBFILE.SPB_INSRATE_10_18,
                   SPBFILE.SPB_INSTERM_10_19,
                   SPBFILE.SPB_INSRATE_10_19,
                   SPBFILE.SPB_INSTERM_10_20,
                   SPBFILE.SPB_INSRATE_10_20,
                   SPBFILE.SPB_INSMINPREM_10,
                   SPBFILE.SPB_INSMINCHGABL_10,
                   SPBFILE.SPB_INSMAXCHGABL_10,
                   SPBFILE.SPB_INSMAXBENIF_10,
                   SPBFILE.SPB_INSMAXTERM_10,
                   SPBFILE.SPB_INSCHGBEN_10,
                   SPBFILE.SPB_INSEXCEPT_10,
                   SPBFILE.SPB_INSNOVER_10,
                   SPBFILE.SPB_INSMINAGE_10_1,
                   SPBFILE.SPB_INSMAXAGE_10_1,
                   SPBFILE.SPB_INSMAXCOV_10_1,
                   SPBFILE.SPB_INSMAXTRM_10_1,
                   SPBFILE.SPB_INSMINAGE_10_2,
                   SPBFILE.SPB_INSMAXAGE_10_2,
                   SPBFILE.SPB_INSMAXCOV_10_2,
                   SPBFILE.SPB_INSMAXTRM_10_2,
                   SPBFILE.SPB_INSMINAGE_10_3,
                   SPBFILE.SPB_INSMAXAGE_10_3,
                   SPBFILE.SPB_INSMAXCOV_10_3,
                   SPBFILE.SPB_INSMAXTRM_10_3,
                   SPBFILE.SPB_INSMINAGE_10_4,
                   SPBFILE.SPB_INSMAXAGE_10_4,
                   SPBFILE.SPB_INSMAXCOV_10_4,
                   SPBFILE.SPB_INSMAXTRM_10_4,
                   SPBFILE.SPB_INSMINAGE_10_5,
                   SPBFILE.SPB_INSMAXAGE_10_5,
                   SPBFILE.SPB_INSMAXCOV_10_5,
                   SPBFILE.SPB_INSMAXTRM_10_5,
                   SPBFILE.SPB_INSFEECD_10,
                   SPBFILE.SPB_INSFEE_FRMLA_10,
                   SPBFILE.SPB_INSCHGABL_FG_10,
                   SPBFILE.SPB_INSREJECT_FG_10,
                   SPBFILE.SPB_INSFINCHG_10,
                   SPBFILE.SPB_INSCOM_11,
                   SPBFILE.SPB_INSRATECD_11,
                   SPBFILE.SPB_INSJFAC_11,
                   SPBFILE.SPB_INSDISCNT_11,
                   SPBFILE.SPB_INSCHGABL_11,
                   SPBFILE.SPB_INSTERM_11_1,
                   SPBFILE.SPB_INSRATE_11_1,
                   SPBFILE.SPB_INSTERM_11_2,
                   SPBFILE.SPB_INSRATE_11_2,
                   SPBFILE.SPB_INSTERM_11_3,
                   SPBFILE.SPB_INSRATE_11_3,
                   SPBFILE.SPB_INSTERM_11_4,
                   SPBFILE.SPB_INSRATE_11_4,
                   SPBFILE.SPB_INSTERM_11_5,
                   SPBFILE.SPB_INSRATE_11_5,
                   SPBFILE.SPB_INSTERM_11_6,
                   SPBFILE.SPB_INSRATE_11_6,
                   SPBFILE.SPB_INSTERM_11_7,
                   SPBFILE.SPB_INSRATE_11_7,
                   SPBFILE.SPB_INSTERM_11_8,
                   SPBFILE.SPB_INSRATE_11_8,
                   SPBFILE.SPB_INSTERM_11_9,
                   SPBFILE.SPB_INSRATE_11_9,
                   SPBFILE.SPB_INSTERM_11_10,
                   SPBFILE.SPB_INSRATE_11_10,
                   SPBFILE.SPB_INSTERM_11_11,
                   SPBFILE.SPB_INSRATE_11_11,
                   SPBFILE.SPB_INSTERM_11_12,
                   SPBFILE.SPB_INSRATE_11_12,
                   SPBFILE.SPB_INSTERM_11_13,
                   SPBFILE.SPB_INSRATE_11_13,
                   SPBFILE.SPB_INSTERM_11_14,
                   SPBFILE.SPB_INSRATE_11_14,
                   SPBFILE.SPB_INSTERM_11_15,
                   SPBFILE.SPB_INSRATE_11_15,
                   SPBFILE.SPB_INSTERM_11_16,
                   SPBFILE.SPB_INSRATE_11_16,
                   SPBFILE.SPB_INSTERM_11_17,
                   SPBFILE.SPB_INSRATE_11_17,
                   SPBFILE.SPB_INSTERM_11_18,
                   SPBFILE.SPB_INSRATE_11_18,
                   SPBFILE.SPB_INSTERM_11_19,
                   SPBFILE.SPB_INSRATE_11_19,
                   SPBFILE.SPB_INSTERM_11_20,
                   SPBFILE.SPB_INSRATE_11_20,
                   SPBFILE.SPB_INSMINPREM_11,
                   SPBFILE.SPB_INSMINCHGABL_11,
                   SPBFILE.SPB_INSMAXCHGABL_11,
                   SPBFILE.SPB_INSMAXBENIF_11,
                   SPBFILE.SPB_INSMAXTERM_11,
                   SPBFILE.SPB_INSCHGBEN_11,
                   SPBFILE.SPB_INSEXCEPT_11,
                   SPBFILE.SPB_INSNOVER_11,
                   SPBFILE.SPB_INSMINAGE_11_1,
                   SPBFILE.SPB_INSMAXAGE_11_1,
                   SPBFILE.SPB_INSMAXCOV_11_1,
                   SPBFILE.SPB_INSMAXTRM_11_1,
                   SPBFILE.SPB_INSMINAGE_11_2,
                   SPBFILE.SPB_INSMAXAGE_11_2,
                   SPBFILE.SPB_INSMAXCOV_11_2,
                   SPBFILE.SPB_INSMAXTRM_11_2,
                   SPBFILE.SPB_INSMINAGE_11_3,
                   SPBFILE.SPB_INSMAXAGE_11_3,
                   SPBFILE.SPB_INSMAXCOV_11_3,
                   SPBFILE.SPB_INSMAXTRM_11_3,
                   SPBFILE.SPB_INSMINAGE_11_4,
                   SPBFILE.SPB_INSMAXAGE_11_4,
                   SPBFILE.SPB_INSMAXCOV_11_4,
                   SPBFILE.SPB_INSMAXTRM_11_4,
                   SPBFILE.SPB_INSMINAGE_11_5,
                   SPBFILE.SPB_INSMAXAGE_11_5,
                   SPBFILE.SPB_INSMAXCOV_11_5,
                   SPBFILE.SPB_INSMAXTRM_11_5,
                   SPBFILE.SPB_INSFEECD_11,
                   SPBFILE.SPB_INSFEE_FRMLA_11,
                   SPBFILE.SPB_INSCHGABL_FG_11,
                   SPBFILE.SPB_INSREJECT_FG_11,
                   SPBFILE.SPB_INSFINCHG_11,
                   SPBFILE.SPB_INSCOM_12,
                   SPBFILE.SPB_INSRATECD_12,
                   SPBFILE.SPB_INSJFAC_12,
                   SPBFILE.SPB_INSDISCNT_12,
                   SPBFILE.SPB_INSCHGABL_12,
                   SPBFILE.SPB_INSTERM_12_1,
                   SPBFILE.SPB_INSRATE_12_1,
                   SPBFILE.SPB_INSTERM_12_2,
                   SPBFILE.SPB_INSRATE_12_2,
                   SPBFILE.SPB_INSTERM_12_3,
                   SPBFILE.SPB_INSRATE_12_3,
                   SPBFILE.SPB_INSTERM_12_4,
                   SPBFILE.SPB_INSRATE_12_4,
                   SPBFILE.SPB_INSTERM_12_5,
                   SPBFILE.SPB_INSRATE_12_5,
                   SPBFILE.SPB_INSTERM_12_6,
                   SPBFILE.SPB_INSRATE_12_6,
                   SPBFILE.SPB_INSTERM_12_7,
                   SPBFILE.SPB_INSRATE_12_7,
                   SPBFILE.SPB_INSTERM_12_8,
                   SPBFILE.SPB_INSRATE_12_8,
                   SPBFILE.SPB_INSTERM_12_9,
                   SPBFILE.SPB_INSRATE_12_9,
                   SPBFILE.SPB_INSTERM_12_10,
                   SPBFILE.SPB_INSRATE_12_10,
                   SPBFILE.SPB_INSTERM_12_11,
                   SPBFILE.SPB_INSRATE_12_11,
                   SPBFILE.SPB_INSTERM_12_12,
                   SPBFILE.SPB_INSRATE_12_12,
                   SPBFILE.SPB_INSTERM_12_13,
                   SPBFILE.SPB_INSRATE_12_13,
                   SPBFILE.SPB_INSTERM_12_14,
                   SPBFILE.SPB_INSRATE_12_14,
                   SPBFILE.SPB_INSTERM_12_15,
                   SPBFILE.SPB_INSRATE_12_15,
                   SPBFILE.SPB_INSTERM_12_16,
                   SPBFILE.SPB_INSRATE_12_16,
                   SPBFILE.SPB_INSTERM_12_17,
                   SPBFILE.SPB_INSRATE_12_17,
                   SPBFILE.SPB_INSTERM_12_18,
                   SPBFILE.SPB_INSRATE_12_18,
                   SPBFILE.SPB_INSTERM_12_19,
                   SPBFILE.SPB_INSRATE_12_19,
                   SPBFILE.SPB_INSTERM_12_20,
                   SPBFILE.SPB_INSRATE_12_20,
                   SPBFILE.SPB_INSMINPREM_12,
                   SPBFILE.SPB_INSMINCHGABL_12,
                   SPBFILE.SPB_INSMAXCHGABL_12,
                   SPBFILE.SPB_INSMAXBENIF_12,
                   SPBFILE.SPB_INSMAXTERM_12,
                   SPBFILE.SPB_INSCHGBEN_12,
                   SPBFILE.SPB_INSEXCEPT_12,
                   SPBFILE.SPB_INSNOVER_12,
                   SPBFILE.SPB_INSMINAGE_12_1,
                   SPBFILE.SPB_INSMAXAGE_12_1,
                   SPBFILE.SPB_INSMAXCOV_12_1,
                   SPBFILE.SPB_INSMAXTRM_12_1,
                   SPBFILE.SPB_INSMINAGE_12_2,
                   SPBFILE.SPB_INSMAXAGE_12_2,
                   SPBFILE.SPB_INSMAXCOV_12_2,
                   SPBFILE.SPB_INSMAXTRM_12_2,
                   SPBFILE.SPB_INSMINAGE_12_3,
                   SPBFILE.SPB_INSMAXAGE_12_3,
                   SPBFILE.SPB_INSMAXCOV_12_3,
                   SPBFILE.SPB_INSMAXTRM_12_3,
                   SPBFILE.SPB_INSMINAGE_12_4,
                   SPBFILE.SPB_INSMAXAGE_12_4,
                   SPBFILE.SPB_INSMAXCOV_12_4,
                   SPBFILE.SPB_INSMAXTRM_12_4,
                   SPBFILE.SPB_INSMINAGE_12_5,
                   SPBFILE.SPB_INSMAXAGE_12_5,
                   SPBFILE.SPB_INSMAXCOV_12_5,
                   SPBFILE.SPB_INSMAXTRM_12_5,
                   SPBFILE.SPB_INSFEECD_12,
                   SPBFILE.SPB_INSFEE_FRMLA_12,
                   SPBFILE.SPB_INSCHGABL_FG_12,
                   SPBFILE.SPB_INSREJECT_FG_12,
                   SPBFILE.SPB_INSFINCHG_12
            INTO :QSPB-REC
            FROM DBO.SPBFILE
            WHERE SPBFILE.SPB_ORGST = :QSPB-ORGST
              AND SPBFILE.SPB_SPRCLASS = :QSPB-SPRCLASS
              AND SPBFILE.SPB_SUBCLASS = :QSPB-SUBCLASS
              AND SPBFILE.SPB_LAWCODE = :QSPB-LAWCODE 
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-SPB1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-SPB-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-SPB1-FILE.
           PERFORM CLOSE-IT.

      *=================================================================
       LOAD-SPC1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( SP-PATH-OVERRIDE = "Y" )
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( SP-PATH-OVERRIDE = SPACES )
              MOVE EXT-FILPATH-BASE        TO SPC-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO SPC-ALL-MACHINE
              MOVE SPC-ALL-PATH             TO SPC-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( SP-PATH-OVERRIDE = "B" )
              MOVE FILPATH-BASE            TO SPC-ALL-BASE
              MOVE FILPATH-MACHINE         TO SPC-ALL-MACHINE
              MOVE SPC-ALL-PATH             TO SPC-PATH.

      *-----------------------------------------------------------------
       OPEN-SPC1-FILE.
           PERFORM LOAD-SPC1-FILE.
           PERFORM OPEN-IT.
           MOVE SPC-PATH-SQL TO E-FILE.

      *-----------------------------------------------------------------
       READ-SPC1-FILE.
           PERFORM READ-IT.
           MOVE SPC-PATH-SQL TO E-FILE.
           MOVE SPC1-KEY TO E-KEYX.
           INITIALIZE QSPC-REC.

           MOVE SPC-ORGST            TO QSPC-ORGST.
           MOVE SPC-SPRCLASS         TO QSPC-SPRCLASS.
           MOVE SPC-SUBCLASS         TO QSPC-SUBCLASS.
           MOVE SPC-LAWCODE          TO QSPC-LAWCODE.

           EXEC SQL
            SELECT SPCFILE.SPC_ORGST,
                   SPCFILE.SPC_SPRCLASS,
                   SPCFILE.SPC_SUBCLASS,
                   SPCFILE.SPC_LAWCODE,
                   SPCFILE.SPC_INSEARN_ORDER_1,
                   SPCFILE.SPC_INSEARN_ORDER_2,
                   SPCFILE.SPC_INSEARN_ORDER_3,
                   SPCFILE.SPC_INSEARN_ORDER_4,
                   SPCFILE.SPC_INSEARN_ORDER_5,
                   SPCFILE.SPC_INSEARN_ORDER_6,
                   SPCFILE.SPC_INSEARN_ORDER_7,
                   SPCFILE.SPC_INSEARN_ORDER_8,
                   SPCFILE.SPC_INSEARN_ORDER_9,
                   SPCFILE.SPC_INSEARN_ORDER_10,
                   SPCFILE.SPC_INSEARN_ORDER_11,
                   SPCFILE.SPC_INSEARN_ORDER_12,
                   SPCFILE.SPC_INSAH_JOINT_FG,
                   SPCFILE.SPC_INS_O1_EDIT,
                   SPCFILE.SPC_INS_O2_EDIT,
                   SPCFILE.SPC_RBFRMLA_1,
                   SPCFILE.SPC_RBDTE_1_1,
                   SPCFILE.SPC_RBDAYS_1_1,
                   SPCFILE.SPC_RBYRTYPE_1_1,
                   SPCFILE.SPC_RBDTE_1_2,
                   SPCFILE.SPC_RBDAYS_1_2,
                   SPCFILE.SPC_RBYRTYPE_1_2,
                   SPCFILE.SPC_RBMINRET_1,
                   SPCFILE.SPC_RBNOMON_1,
                   SPCFILE.SPC_RBDEDCHG_1,
                   SPCFILE.SPC_RBRECAST_1,
                   SPCFILE.SPC_RBEARLY_1,
                   SPCFILE.SPC_RBDEFER_1,
                   SPCFILE.SPC_RBPCT_1,
                   SPCFILE.SPC_RBREDUC_1,
                   SPCFILE.SPC_RBMIN_1,
                   SPCFILE.SPC_RBSPOPT1_1,
                   SPCFILE.SPC_RBSPOPT2_1,
                   SPCFILE.SPC_RBMANAGER_1,
                   SPCFILE.SPC_RBUNITPER_CD_1,
                   SPCFILE.SPC_RBFRMLA2_1,
                   SPCFILE.SPC_RBFRMLA_2,
                   SPCFILE.SPC_RBDTE_2_1,
                   SPCFILE.SPC_RBDAYS_2_1,
                   SPCFILE.SPC_RBYRTYPE_2_1,
                   SPCFILE.SPC_RBDTE_2_2,
                   SPCFILE.SPC_RBDAYS_2_2,
                   SPCFILE.SPC_RBYRTYPE_2_2,
                   SPCFILE.SPC_RBMINRET_2,
                   SPCFILE.SPC_RBNOMON_2,
                   SPCFILE.SPC_RBDEDCHG_2,
                   SPCFILE.SPC_RBRECAST_2,
                   SPCFILE.SPC_RBEARLY_2,
                   SPCFILE.SPC_RBDEFER_2,
                   SPCFILE.SPC_RBPCT_2,
                   SPCFILE.SPC_RBREDUC_2,
                   SPCFILE.SPC_RBMIN_2,
                   SPCFILE.SPC_RBSPOPT1_2,
                   SPCFILE.SPC_RBSPOPT2_2,
                   SPCFILE.SPC_RBMANAGER_2,
                   SPCFILE.SPC_RBUNITPER_CD_2,
                   SPCFILE.SPC_RBFRMLA2_2,
                   SPCFILE.SPC_RBFRMLA_3,
                   SPCFILE.SPC_RBDTE_3_1,
                   SPCFILE.SPC_RBDAYS_3_1,
                   SPCFILE.SPC_RBYRTYPE_3_1,
                   SPCFILE.SPC_RBDTE_3_2,
                   SPCFILE.SPC_RBDAYS_3_2,
                   SPCFILE.SPC_RBYRTYPE_3_2,
                   SPCFILE.SPC_RBMINRET_3,
                   SPCFILE.SPC_RBNOMON_3,
                   SPCFILE.SPC_RBDEDCHG_3,
                   SPCFILE.SPC_RBRECAST_3,
                   SPCFILE.SPC_RBEARLY_3,
                   SPCFILE.SPC_RBDEFER_3,
                   SPCFILE.SPC_RBPCT_3,
                   SPCFILE.SPC_RBREDUC_3,
                   SPCFILE.SPC_RBMIN_3,
                   SPCFILE.SPC_RBSPOPT1_3,
                   SPCFILE.SPC_RBSPOPT2_3,
                   SPCFILE.SPC_RBMANAGER_3,
                   SPCFILE.SPC_RBUNITPER_CD_3,
                   SPCFILE.SPC_RBFRMLA2_3,
                   SPCFILE.SPC_RBFRMLA_4,
                   SPCFILE.SPC_RBDTE_4_1,
                   SPCFILE.SPC_RBDAYS_4_1,
                   SPCFILE.SPC_RBYRTYPE_4_1,
                   SPCFILE.SPC_RBDTE_4_2,
                   SPCFILE.SPC_RBDAYS_4_2,
                   SPCFILE.SPC_RBYRTYPE_4_2,
                   SPCFILE.SPC_RBMINRET_4,
                   SPCFILE.SPC_RBNOMON_4,
                   SPCFILE.SPC_RBDEDCHG_4,
                   SPCFILE.SPC_RBRECAST_4,
                   SPCFILE.SPC_RBEARLY_4,
                   SPCFILE.SPC_RBDEFER_4,
                   SPCFILE.SPC_RBPCT_4,
                   SPCFILE.SPC_RBREDUC_4,
                   SPCFILE.SPC_RBMIN_4,
                   SPCFILE.SPC_RBSPOPT1_4,
                   SPCFILE.SPC_RBSPOPT2_4,
                   SPCFILE.SPC_RBMANAGER_4,
                   SPCFILE.SPC_RBUNITPER_CD_4,
                   SPCFILE.SPC_RBFRMLA2_4,
                   SPCFILE.SPC_RBFRMLA_5,
                   SPCFILE.SPC_RBDTE_5_1,
                   SPCFILE.SPC_RBDAYS_5_1,
                   SPCFILE.SPC_RBYRTYPE_5_1,
                   SPCFILE.SPC_RBDTE_5_2,
                   SPCFILE.SPC_RBDAYS_5_2,
                   SPCFILE.SPC_RBYRTYPE_5_2,
                   SPCFILE.SPC_RBMINRET_5,
                   SPCFILE.SPC_RBNOMON_5,
                   SPCFILE.SPC_RBDEDCHG_5,
                   SPCFILE.SPC_RBRECAST_5,
                   SPCFILE.SPC_RBEARLY_5,
                   SPCFILE.SPC_RBDEFER_5,
                   SPCFILE.SPC_RBPCT_5,
                   SPCFILE.SPC_RBREDUC_5,
                   SPCFILE.SPC_RBMIN_5,
                   SPCFILE.SPC_RBSPOPT1_5,
                   SPCFILE.SPC_RBSPOPT2_5,
                   SPCFILE.SPC_RBMANAGER_5,
                   SPCFILE.SPC_RBUNITPER_CD_5,
                   SPCFILE.SPC_RBFRMLA2_5,
                   SPCFILE.SPC_RBFRMLA_6,
                   SPCFILE.SPC_RBDTE_6_1,
                   SPCFILE.SPC_RBDAYS_6_1,
                   SPCFILE.SPC_RBYRTYPE_6_1,
                   SPCFILE.SPC_RBDTE_6_2,
                   SPCFILE.SPC_RBDAYS_6_2,
                   SPCFILE.SPC_RBYRTYPE_6_2,
                   SPCFILE.SPC_RBMINRET_6,
                   SPCFILE.SPC_RBNOMON_6,
                   SPCFILE.SPC_RBDEDCHG_6,
                   SPCFILE.SPC_RBRECAST_6,
                   SPCFILE.SPC_RBEARLY_6,
                   SPCFILE.SPC_RBDEFER_6,
                   SPCFILE.SPC_RBPCT_6,
                   SPCFILE.SPC_RBREDUC_6,
                   SPCFILE.SPC_RBMIN_6,
                   SPCFILE.SPC_RBSPOPT1_6,
                   SPCFILE.SPC_RBSPOPT2_6,
                   SPCFILE.SPC_RBMANAGER_6,
                   SPCFILE.SPC_RBUNITPER_CD_6,
                   SPCFILE.SPC_RBFRMLA2_6,
                   SPCFILE.SPC_RBFRMLA_7,
                   SPCFILE.SPC_RBDTE_7_1,
                   SPCFILE.SPC_RBDAYS_7_1,
                   SPCFILE.SPC_RBYRTYPE_7_1,
                   SPCFILE.SPC_RBDTE_7_2,
                   SPCFILE.SPC_RBDAYS_7_2,
                   SPCFILE.SPC_RBYRTYPE_7_2,
                   SPCFILE.SPC_RBMINRET_7,
                   SPCFILE.SPC_RBNOMON_7,
                   SPCFILE.SPC_RBDEDCHG_7,
                   SPCFILE.SPC_RBRECAST_7,
                   SPCFILE.SPC_RBEARLY_7,
                   SPCFILE.SPC_RBDEFER_7,
                   SPCFILE.SPC_RBPCT_7,
                   SPCFILE.SPC_RBREDUC_7,
                   SPCFILE.SPC_RBMIN_7,
                   SPCFILE.SPC_RBSPOPT1_7,
                   SPCFILE.SPC_RBSPOPT2_7,
                   SPCFILE.SPC_RBMANAGER_7,
                   SPCFILE.SPC_RBUNITPER_CD_7,
                   SPCFILE.SPC_RBFRMLA2_7,
                   SPCFILE.SPC_RBFRMLA_8,
                   SPCFILE.SPC_RBDTE_8_1,
                   SPCFILE.SPC_RBDAYS_8_1,
                   SPCFILE.SPC_RBYRTYPE_8_1,
                   SPCFILE.SPC_RBDTE_8_2,
                   SPCFILE.SPC_RBDAYS_8_2,
                   SPCFILE.SPC_RBYRTYPE_8_2,
                   SPCFILE.SPC_RBMINRET_8,
                   SPCFILE.SPC_RBNOMON_8,
                   SPCFILE.SPC_RBDEDCHG_8,
                   SPCFILE.SPC_RBRECAST_8,
                   SPCFILE.SPC_RBEARLY_8,
                   SPCFILE.SPC_RBDEFER_8,
                   SPCFILE.SPC_RBPCT_8,
                   SPCFILE.SPC_RBREDUC_8,
                   SPCFILE.SPC_RBMIN_8,
                   SPCFILE.SPC_RBSPOPT1_8,
                   SPCFILE.SPC_RBSPOPT2_8,
                   SPCFILE.SPC_RBMANAGER_8,
                   SPCFILE.SPC_RBUNITPER_CD_8,
                   SPCFILE.SPC_RBFRMLA2_8,
                   SPCFILE.SPC_RBFRMLA_9,
                   SPCFILE.SPC_RBDTE_9_1,
                   SPCFILE.SPC_RBDAYS_9_1,
                   SPCFILE.SPC_RBYRTYPE_9_1,
                   SPCFILE.SPC_RBDTE_9_2,
                   SPCFILE.SPC_RBDAYS_9_2,
                   SPCFILE.SPC_RBYRTYPE_9_2,
                   SPCFILE.SPC_RBMINRET_9,
                   SPCFILE.SPC_RBNOMON_9,
                   SPCFILE.SPC_RBDEDCHG_9,
                   SPCFILE.SPC_RBRECAST_9,
                   SPCFILE.SPC_RBEARLY_9,
                   SPCFILE.SPC_RBDEFER_9,
                   SPCFILE.SPC_RBPCT_9,
                   SPCFILE.SPC_RBREDUC_9,
                   SPCFILE.SPC_RBMIN_9,
                   SPCFILE.SPC_RBSPOPT1_9,
                   SPCFILE.SPC_RBSPOPT2_9,
                   SPCFILE.SPC_RBMANAGER_9,
                   SPCFILE.SPC_RBUNITPER_CD_9,
                   SPCFILE.SPC_RBFRMLA2_9,
                   SPCFILE.SPC_RBFRMLA_10,
                   SPCFILE.SPC_RBDTE_10_1,
                   SPCFILE.SPC_RBDAYS_10_1,
                   SPCFILE.SPC_RBYRTYPE_10_1,
                   SPCFILE.SPC_RBDTE_10_2,
                   SPCFILE.SPC_RBDAYS_10_2,
                   SPCFILE.SPC_RBYRTYPE_10_2,
                   SPCFILE.SPC_RBMINRET_10,
                   SPCFILE.SPC_RBNOMON_10,
                   SPCFILE.SPC_RBDEDCHG_10,
                   SPCFILE.SPC_RBRECAST_10,
                   SPCFILE.SPC_RBEARLY_10,
                   SPCFILE.SPC_RBDEFER_10,
                   SPCFILE.SPC_RBPCT_10,
                   SPCFILE.SPC_RBREDUC_10,
                   SPCFILE.SPC_RBMIN_10,
                   SPCFILE.SPC_RBSPOPT1_10,
                   SPCFILE.SPC_RBSPOPT2_10,
                   SPCFILE.SPC_RBMANAGER_10,
                   SPCFILE.SPC_RBUNITPER_CD_10,
                   SPCFILE.SPC_RBFRMLA2_10,
                   SPCFILE.SPC_RBFRMLA_11,
                   SPCFILE.SPC_RBDTE_11_1,
                   SPCFILE.SPC_RBDAYS_11_1,
                   SPCFILE.SPC_RBYRTYPE_11_1,
                   SPCFILE.SPC_RBDTE_11_2,
                   SPCFILE.SPC_RBDAYS_11_2,
                   SPCFILE.SPC_RBYRTYPE_11_2,
                   SPCFILE.SPC_RBMINRET_11,
                   SPCFILE.SPC_RBNOMON_11,
                   SPCFILE.SPC_RBDEDCHG_11,
                   SPCFILE.SPC_RBRECAST_11,
                   SPCFILE.SPC_RBEARLY_11,
                   SPCFILE.SPC_RBDEFER_11,
                   SPCFILE.SPC_RBPCT_11,
                   SPCFILE.SPC_RBREDUC_11,
                   SPCFILE.SPC_RBMIN_11,
                   SPCFILE.SPC_RBSPOPT1_11,
                   SPCFILE.SPC_RBSPOPT2_11,
                   SPCFILE.SPC_RBMANAGER_11,
                   SPCFILE.SPC_RBUNITPER_CD_11,
                   SPCFILE.SPC_RBFRMLA2_11,
                   SPCFILE.SPC_RBFRMLA_12,
                   SPCFILE.SPC_RBDTE_12_1,
                   SPCFILE.SPC_RBDAYS_12_1,
                   SPCFILE.SPC_RBYRTYPE_12_1,
                   SPCFILE.SPC_RBDTE_12_2,
                   SPCFILE.SPC_RBDAYS_12_2,
                   SPCFILE.SPC_RBYRTYPE_12_2,
                   SPCFILE.SPC_RBMINRET_12,
                   SPCFILE.SPC_RBNOMON_12,
                   SPCFILE.SPC_RBDEDCHG_12,
                   SPCFILE.SPC_RBRECAST_12,
                   SPCFILE.SPC_RBEARLY_12,
                   SPCFILE.SPC_RBDEFER_12,
                   SPCFILE.SPC_RBPCT_12,
                   SPCFILE.SPC_RBREDUC_12,
                   SPCFILE.SPC_RBMIN_12,
                   SPCFILE.SPC_RBSPOPT1_12,
                   SPCFILE.SPC_RBSPOPT2_12,
                   SPCFILE.SPC_RBMANAGER_12,
                   SPCFILE.SPC_RBUNITPER_CD_12,
                   SPCFILE.SPC_RBFRMLA2_12,
                   SPCFILE.SPC_RBFRMLA_13,
                   SPCFILE.SPC_RBDTE_13_1,
                   SPCFILE.SPC_RBDAYS_13_1,
                   SPCFILE.SPC_RBYRTYPE_13_1,
                   SPCFILE.SPC_RBDTE_13_2,
                   SPCFILE.SPC_RBDAYS_13_2,
                   SPCFILE.SPC_RBYRTYPE_13_2,
                   SPCFILE.SPC_RBMINRET_13,
                   SPCFILE.SPC_RBNOMON_13,
                   SPCFILE.SPC_RBDEDCHG_13,
                   SPCFILE.SPC_RBRECAST_13,
                   SPCFILE.SPC_RBEARLY_13,
                   SPCFILE.SPC_RBDEFER_13,
                   SPCFILE.SPC_RBPCT_13,
                   SPCFILE.SPC_RBREDUC_13,
                   SPCFILE.SPC_RBMIN_13,
                   SPCFILE.SPC_RBSPOPT1_13,
                   SPCFILE.SPC_RBSPOPT2_13,
                   SPCFILE.SPC_RBMANAGER_13,
                   SPCFILE.SPC_RBUNITPER_CD_13,
                   SPCFILE.SPC_RBFRMLA2_13,
                   SPCFILE.SPC_RBFRMLA_14,
                   SPCFILE.SPC_RBDTE_14_1,
                   SPCFILE.SPC_RBDAYS_14_1,
                   SPCFILE.SPC_RBYRTYPE_14_1,
                   SPCFILE.SPC_RBDTE_14_2,
                   SPCFILE.SPC_RBDAYS_14_2,
                   SPCFILE.SPC_RBYRTYPE_14_2,
                   SPCFILE.SPC_RBMINRET_14,
                   SPCFILE.SPC_RBNOMON_14,
                   SPCFILE.SPC_RBDEDCHG_14,
                   SPCFILE.SPC_RBRECAST_14,
                   SPCFILE.SPC_RBEARLY_14,
                   SPCFILE.SPC_RBDEFER_14,
                   SPCFILE.SPC_RBPCT_14,
                   SPCFILE.SPC_RBREDUC_14,
                   SPCFILE.SPC_RBMIN_14,
                   SPCFILE.SPC_RBSPOPT1_14,
                   SPCFILE.SPC_RBSPOPT2_14,
                   SPCFILE.SPC_RBMANAGER_14,
                   SPCFILE.SPC_RBUNITPER_CD_14,
                   SPCFILE.SPC_RBFRMLA2_14,
                   SPCFILE.SPC_RBFRMLA_15,
                   SPCFILE.SPC_RBDTE_15_1,
                   SPCFILE.SPC_RBDAYS_15_1,
                   SPCFILE.SPC_RBYRTYPE_15_1,
                   SPCFILE.SPC_RBDTE_15_2,
                   SPCFILE.SPC_RBDAYS_15_2,
                   SPCFILE.SPC_RBYRTYPE_15_2,
                   SPCFILE.SPC_RBMINRET_15,
                   SPCFILE.SPC_RBNOMON_15,
                   SPCFILE.SPC_RBDEDCHG_15,
                   SPCFILE.SPC_RBRECAST_15,
                   SPCFILE.SPC_RBEARLY_15,
                   SPCFILE.SPC_RBDEFER_15,
                   SPCFILE.SPC_RBPCT_15,
                   SPCFILE.SPC_RBREDUC_15,
                   SPCFILE.SPC_RBMIN_15,
                   SPCFILE.SPC_RBSPOPT1_15,
                   SPCFILE.SPC_RBSPOPT2_15,
                   SPCFILE.SPC_RBMANAGER_15,
                   SPCFILE.SPC_RBUNITPER_CD_15,
                   SPCFILE.SPC_RBFRMLA2_15,
                   SPCFILE.SPC_RBFRMLA_16,
                   SPCFILE.SPC_RBDTE_16_1,
                   SPCFILE.SPC_RBDAYS_16_1,
                   SPCFILE.SPC_RBYRTYPE_16_1,
                   SPCFILE.SPC_RBDTE_16_2,
                   SPCFILE.SPC_RBDAYS_16_2,
                   SPCFILE.SPC_RBYRTYPE_16_2,
                   SPCFILE.SPC_RBMINRET_16,
                   SPCFILE.SPC_RBNOMON_16,
                   SPCFILE.SPC_RBDEDCHG_16,
                   SPCFILE.SPC_RBRECAST_16,
                   SPCFILE.SPC_RBEARLY_16,
                   SPCFILE.SPC_RBDEFER_16,
                   SPCFILE.SPC_RBPCT_16,
                   SPCFILE.SPC_RBREDUC_16,
                   SPCFILE.SPC_RBMIN_16,
                   SPCFILE.SPC_RBSPOPT1_16,
                   SPCFILE.SPC_RBSPOPT2_16,
                   SPCFILE.SPC_RBMANAGER_16,
                   SPCFILE.SPC_RBUNITPER_CD_16,
                   SPCFILE.SPC_RBFRMLA2_16,
                   SPCFILE.SPC_RBFRMLA_17,
                   SPCFILE.SPC_RBDTE_17_1,
                   SPCFILE.SPC_RBDAYS_17_1,
                   SPCFILE.SPC_RBYRTYPE_17_1,
                   SPCFILE.SPC_RBDTE_17_2,
                   SPCFILE.SPC_RBDAYS_17_2,
                   SPCFILE.SPC_RBYRTYPE_17_2,
                   SPCFILE.SPC_RBMINRET_17,
                   SPCFILE.SPC_RBNOMON_17,
                   SPCFILE.SPC_RBDEDCHG_17,
                   SPCFILE.SPC_RBRECAST_17,
                   SPCFILE.SPC_RBEARLY_17,
                   SPCFILE.SPC_RBDEFER_17,
                   SPCFILE.SPC_RBPCT_17,
                   SPCFILE.SPC_RBREDUC_17,
                   SPCFILE.SPC_RBMIN_17,
                   SPCFILE.SPC_RBSPOPT1_17,
                   SPCFILE.SPC_RBSPOPT2_17,
                   SPCFILE.SPC_RBMANAGER_17,
                   SPCFILE.SPC_RBUNITPER_CD_17,
                   SPCFILE.SPC_RBFRMLA2_17,
                   SPCFILE.SPC_RBFRMLA_18,
                   SPCFILE.SPC_RBDTE_18_1,
                   SPCFILE.SPC_RBDAYS_18_1,
                   SPCFILE.SPC_RBYRTYPE_18_1,
                   SPCFILE.SPC_RBDTE_18_2,
                   SPCFILE.SPC_RBDAYS_18_2,
                   SPCFILE.SPC_RBYRTYPE_18_2,
                   SPCFILE.SPC_RBMINRET_18,
                   SPCFILE.SPC_RBNOMON_18,
                   SPCFILE.SPC_RBDEDCHG_18,
                   SPCFILE.SPC_RBRECAST_18,
                   SPCFILE.SPC_RBEARLY_18,
                   SPCFILE.SPC_RBDEFER_18,
                   SPCFILE.SPC_RBPCT_18,
                   SPCFILE.SPC_RBREDUC_18,
                   SPCFILE.SPC_RBMIN_18,
                   SPCFILE.SPC_RBSPOPT1_18,
                   SPCFILE.SPC_RBSPOPT2_18,
                   SPCFILE.SPC_RBMANAGER_18,
                   SPCFILE.SPC_RBUNITPER_CD_18,
                   SPCFILE.SPC_RBFRMLA2_18,
                   SPCFILE.SPC_RBFRMLA_19,
                   SPCFILE.SPC_RBDTE_19_1,
                   SPCFILE.SPC_RBDAYS_19_1,
                   SPCFILE.SPC_RBYRTYPE_19_1,
                   SPCFILE.SPC_RBDTE_19_2,
                   SPCFILE.SPC_RBDAYS_19_2,
                   SPCFILE.SPC_RBYRTYPE_19_2,
                   SPCFILE.SPC_RBMINRET_19,
                   SPCFILE.SPC_RBNOMON_19,
                   SPCFILE.SPC_RBDEDCHG_19,
                   SPCFILE.SPC_RBRECAST_19,
                   SPCFILE.SPC_RBEARLY_19,
                   SPCFILE.SPC_RBDEFER_19,
                   SPCFILE.SPC_RBPCT_19,
                   SPCFILE.SPC_RBREDUC_19,
                   SPCFILE.SPC_RBMIN_19,
                   SPCFILE.SPC_RBSPOPT1_19,
                   SPCFILE.SPC_RBSPOPT2_19,
                   SPCFILE.SPC_RBMANAGER_19,
                   SPCFILE.SPC_RBUNITPER_CD_19,
                   SPCFILE.SPC_RBFRMLA2_19,
                   SPCFILE.SPC_RBFRMLA_20,
                   SPCFILE.SPC_RBDTE_20_1,
                   SPCFILE.SPC_RBDAYS_20_1,
                   SPCFILE.SPC_RBYRTYPE_20_1,
                   SPCFILE.SPC_RBDTE_20_2,
                   SPCFILE.SPC_RBDAYS_20_2,
                   SPCFILE.SPC_RBYRTYPE_20_2,
                   SPCFILE.SPC_RBMINRET_20,
                   SPCFILE.SPC_RBNOMON_20,
                   SPCFILE.SPC_RBDEDCHG_20,
                   SPCFILE.SPC_RBRECAST_20,
                   SPCFILE.SPC_RBEARLY_20,
                   SPCFILE.SPC_RBDEFER_20,
                   SPCFILE.SPC_RBPCT_20,
                   SPCFILE.SPC_RBREDUC_20,
                   SPCFILE.SPC_RBMIN_20,
                   SPCFILE.SPC_RBSPOPT1_20,
                   SPCFILE.SPC_RBSPOPT2_20,
                   SPCFILE.SPC_RBMANAGER_20,
                   SPCFILE.SPC_RBUNITPER_CD_20,
                   SPCFILE.SPC_RBFRMLA2_20,
                   SPCFILE.SPC_RBFRMLA_21,
                   SPCFILE.SPC_RBDTE_21_1,
                   SPCFILE.SPC_RBDAYS_21_1,
                   SPCFILE.SPC_RBYRTYPE_21_1,
                   SPCFILE.SPC_RBDTE_21_2,
                   SPCFILE.SPC_RBDAYS_21_2,
                   SPCFILE.SPC_RBYRTYPE_21_2,
                   SPCFILE.SPC_RBMINRET_21,
                   SPCFILE.SPC_RBNOMON_21,
                   SPCFILE.SPC_RBDEDCHG_21,
                   SPCFILE.SPC_RBRECAST_21,
                   SPCFILE.SPC_RBEARLY_21,
                   SPCFILE.SPC_RBDEFER_21,
                   SPCFILE.SPC_RBPCT_21,
                   SPCFILE.SPC_RBREDUC_21,
                   SPCFILE.SPC_RBMIN_21,
                   SPCFILE.SPC_RBSPOPT1_21,
                   SPCFILE.SPC_RBSPOPT2_21,
                   SPCFILE.SPC_RBMANAGER_21,
                   SPCFILE.SPC_RBUNITPER_CD_21,
                   SPCFILE.SPC_RBFRMLA2_21,
                   SPCFILE.SPC_RBFRMLA_22,
                   SPCFILE.SPC_RBDTE_22_1,
                   SPCFILE.SPC_RBDAYS_22_1,
                   SPCFILE.SPC_RBYRTYPE_22_1,
                   SPCFILE.SPC_RBDTE_22_2,
                   SPCFILE.SPC_RBDAYS_22_2,
                   SPCFILE.SPC_RBYRTYPE_22_2,
                   SPCFILE.SPC_RBMINRET_22,
                   SPCFILE.SPC_RBNOMON_22,
                   SPCFILE.SPC_RBDEDCHG_22,
                   SPCFILE.SPC_RBRECAST_22,
                   SPCFILE.SPC_RBEARLY_22,
                   SPCFILE.SPC_RBDEFER_22,
                   SPCFILE.SPC_RBPCT_22,
                   SPCFILE.SPC_RBREDUC_22,
                   SPCFILE.SPC_RBMIN_22,
                   SPCFILE.SPC_RBSPOPT1_22,
                   SPCFILE.SPC_RBSPOPT2_22,
                   SPCFILE.SPC_RBMANAGER_22,
                   SPCFILE.SPC_RBUNITPER_CD_22,
                   SPCFILE.SPC_RBFRMLA2_22,
                   SPCFILE.SPC_RBCOMCD,
                   SPCFILE.SPC_ADDON_DISFRMLA,
                   SPCFILE.SPC_ADDON_WHOLE_FG,
                   SPCFILE.SPC_ADDON_ORG_MATURITY,
                   SPCFILE.SPC_CONSOLIDATE_RT_FG,
                   SPCFILE.SPC_1STPY_ADDON_DAYS,
                   SPCFILE.SPC_1STPY_ADDON_YRTYPE,
                   SPCFILE.SPC_ADDON_RATE_FG,
                   SPCFILE.SPC_ADDON_RATE,
                   SPCFILE.SPC_FEEFRMLA_1,
                   SPCFILE.SPC_FEECD_1,
                   SPCFILE.SPC_FEEID_1,
                   SPCFILE.SPC_FEEFRMLA_2,
                   SPCFILE.SPC_FEECD_2,
                   SPCFILE.SPC_FEEID_2,
                   SPCFILE.SPC_ROUND_PAY_FG,
                   SPCFILE.SPC_IRREGULAR_PAY_FG,
                   SPCFILE.SPC_DLRVCHGS_RB_CD_1,
                   SPCFILE.SPC_DLRVCHGS_RB_CD_2,
                   SPCFILE.SPC_DLRVCHGS_RB_CD_3,
                   SPCFILE.SPC_PARVHELD_RB_CD,
                   SPCFILE.SPC_PARVPAID_RB_CD,
                   SPCFILE.SPC_CONTR_CREDIT,
                   SPCFILE.SPC_CONTR_CREDIT_CD,
                   SPCFILE.SPC_CONTR_CREDIT_MIN_DEL_PER,
                   SPCFILE.SPC_OPT_CAL_CHGABLE,
                   SPCFILE.SPC_PBDEL_DAYS,
                   SPCFILE.SPC_PBINCR_PERCENT,
                   SPCFILE.SPC_CPOT30_CD,
                   SPCFILE.SPC_CPOTCHGOFF_CD,
                   SPCFILE.SPC_RDPOT30_CD,
                   SPCFILE.SPC_RDPOTCHGOFF_CD,
                   SPCFILE.SPC_MAX_ALLOW_DELINQ,
                   SPCFILE.SPC_RESCIND_BUS_DAYS,
                   SPCFILE.SPC_RESCIND_SATURDAY,
                   SPCFILE.SPC_MIN_CREDIT_SCORE,
                   SPCFILE.SPC_DUAL_IN_BRANCH,
                   SPCFILE.SPC_DUAL_IN_STATE,
                   SPCFILE.SPC_PACESETTER_FG,
                   SPCFILE.SPC_WAGE_ASSIGN_DAYS,
                   SPCFILE.SPC_CAL_PAYMENT_ROUND_FG,
                   SPCFILE.SPC_CAN_LOANS_FG,
                   SPCFILE.SPC_ALLOW_DELINQ_POLCD,
                   SPCFILE.SPC_YTD_MAX_ALLOW_DELINQ,
                   SPCFILE.SPC_LNCOST_FRMLA,
                   SPCFILE.SPC_LNCOST_AMT,
                   SPCFILE.SPC_DLDISC_RVPRIN1_PCNT,
                   SPCFILE.SPC_RENEWABLE_PAYS,
                   SPCFILE.SPC_RENEWABLE_DAYS,
                   SPCFILE.SPC_ALLOW_LN_BACK_DATE,
                   SPCFILE.SPC_DLDISC_RVPRIN1_AF_PCNT,
                   SPCFILE.SPC_CAL_MAX_AT_ESTIMATE,
                   SPCFILE.SPC_INSAH_RETRO,
                   SPCFILE.SPC_INSAH_DAYS_WAIT,
                   SPCFILE.SPC_ADDON_EXCEPT_FG,
                   SPCFILE.SPC_REPO_TRCD_1,
                   SPCFILE.SPC_REPO_FMNO_1_1,
                   SPCFILE.SPC_REPO_FMNO_1_2,
                   SPCFILE.SPC_REPO_FMNO_1_3,
                   SPCFILE.SPC_REPO_FMNO_1_4,
                   SPCFILE.SPC_REPO_TRCD_2,
                   SPCFILE.SPC_REPO_FMNO_2_1,
                   SPCFILE.SPC_REPO_FMNO_2_2,
                   SPCFILE.SPC_REPO_FMNO_2_3,
                   SPCFILE.SPC_REPO_FMNO_2_4,
                   SPCFILE.SPC_REPO_TRCD_3,
                   SPCFILE.SPC_REPO_FMNO_3_1,
                   SPCFILE.SPC_REPO_FMNO_3_2,
                   SPCFILE.SPC_REPO_FMNO_3_3,
                   SPCFILE.SPC_REPO_FMNO_3_4,
                   SPCFILE.SPC_CANCEL_ADDON_FG,
                   SPCFILE.SPC_DEFAULT_O2_INS_COMP,
                   SPCFILE.SPC_LC_ON_JUDGEMENTS,
                   SPCFILE.SPC_DELQ_IB_AGE,
                   SPCFILE.SPC_DELQ_IB_MAX_DAYS,
                   SPCFILE.SPC_INSURANCE_WRITTEN,
                   SPCFILE.SPC_INTERIM_COUPON,
                   SPCFILE.SPC_AUTO_ASSESS_LCHG,
                   SPCFILE.SPC_MAX_CASH_PROCEEDS,
                   SPCFILE.SPC_ALLOW_ZERO_PROC,
                   SPCFILE.SPC_BANKRULE_RATE,
                   SPCFILE.SPC_AUTO_SEND_TRCD_1,
                   SPCFILE.SPC_AUTO_SEND_FMNO_1_1,
                   SPCFILE.SPC_AUTO_SEND_FMNO_1_2,
                   SPCFILE.SPC_AUTO_SEND_FMNO_1_3,
                   SPCFILE.SPC_AUTO_SEND_FMNO_1_4,
                   SPCFILE.SPC_AUTO_SEND_TRCD_2,
                   SPCFILE.SPC_AUTO_SEND_FMNO_2_1,
                   SPCFILE.SPC_AUTO_SEND_FMNO_2_2,
                   SPCFILE.SPC_AUTO_SEND_FMNO_2_3,
                   SPCFILE.SPC_AUTO_SEND_FMNO_2_4,
                   SPCFILE.SPC_DLDISC_CONV_BF_PCNT,
                   SPCFILE.SPC_UNITPER_CD,
                   SPCFILE.SPC_RENEWAL_EDIT,
                   SPCFILE.SPC_ROUND_MFEE,
                   SPCFILE.SPC_ADV_TO_1ST_NO_CORR,
                   SPCFILE.SPC_LC_INT_ON_REPO_NON_PL,
                   SPCFILE.SPC_CONTRACTUAL_SET_NONACCRUAL,
                   SPCFILE.SPC_CONTRACTUAL_RESET_ACCRUAL,
                   SPCFILE.SPC_MONTHS_PAY_NAPP_COUNTER,
                   SPCFILE.SPC_SHORT_PAY_THRESHOLD,
                   SPCFILE.SPC_CASH_AVAIL_PERCENT,
                   SPCFILE.SPC_O1_JOINT_FG,
                   SPCFILE.SPC_NET_BAL_REQ,
                   SPCFILE.SPC_AMT_PROCEEDS_REQ,
                   SPCFILE.SPC_ALT_PREPAY_MONTHS,
                   SPCFILE.SPC_PERCENT_REGPAY_AVAIL,
                   SPCFILE.SPC_ALT_DEFFRMLA,
                   SPCFILE.SPC_ALT_DEFMIN,
                   SPCFILE.SPC_ALT_DEFMAX,
                   SPCFILE.SPC_NON_LOAN_FLAG,
                   SPCFILE.SPC_SKIP_TRW
            INTO :QSPC-REC
            FROM DBO.SPCFILE
            WHERE SPCFILE.SPC_ORGST = :QSPC-ORGST
              AND SPCFILE.SPC_SPRCLASS = :QSPC-SPRCLASS
              AND SPCFILE.SPC_SUBCLASS = :QSPC-SUBCLASS
              AND SPCFILE.SPC_LAWCODE = :QSPC-LAWCODE 
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-SPC1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-SPC-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-SPC1-FILE.
           PERFORM CLOSE-IT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPSP1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPBW1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPBW1RN
       LOAD-BW1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( BW-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( BW-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO BW-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO BW-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO BW-ALL-DATA
              MOVE BW-ALL-PATH             TO BW-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( BW-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO BW-ALL-BASE
              MOVE FILPATH-MACHINE         TO BW-ALL-MACHINE
              MOVE FILPATH-DATA            TO BW-ALL-DATA
              MOVE BW-ALL-PATH             TO BW-PATH.

      *-----------------------------------------------------------------
       OPEN-BW1-FILE.
           PERFORM LOAD-BW1-FILE.
           PERFORM OPEN-IT.
           MOVE BW-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-BW1-FILE.
           PERFORM START-IT.
           MOVE BW-PATH-OWNBR  TO BW-OWNBR.
           MOVE BW-PATH-SQL    TO E-FILE.
           MOVE BW1-KEY        TO E-KEYX.

           IF ( BW1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-BW1-FILE.

           IF ( QBW1-WEND-SSNO = ZEROES    ) OR
              ( QBW1-WEND-SSNO NOT NUMERIC )
              MOVE BW-OWNBR             TO QBW1-WBEG-OWNBR
                                           QBW1-WEND-OWNBR
              MOVE BW-SSNO              TO QBW1-WBEG-SSNO
              MOVE ALL "9"              TO QBW1-WEND-SSNO.

           EXEC SQL
            DECLARE BW1_CURSOR CURSOR FOR
            SELECT BWFILE.BW_OWNBR,
                   BWFILE.BW_SSNO,
                   BWFILE.BW_LNAME,
                   BWFILE.BW_FNAME,
                   BWFILE.BW_MNAME,
                   BWFILE.BW_NICKNAME,
                   BWFILE.BW_GENERATION,
                   BWFILE.BW_ADR1,
                   BWFILE.BW_ADR2,
                   BWFILE.BW_CITY,
                   BWFILE.BW_STATE,
                   BWFILE.BW_ZIP,
                   CAST(BWFILE.BW_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_REFDATE AS VARCHAR(10)),
                   CAST(BWFILE.BW_BDATE AS VARCHAR(10)),
                   BWFILE.BW_PHONE,
                   BWFILE.BW_CELL_PHONE,
                   BWFILE.BW_NATIONALITY,
                   BWFILE.BW_GENDER,
                   BWFILE.BW_DEPEND,
                   BWFILE.BW_RENTCD,
                   BWFILE.BW_TIMEADDR,
                   BWFILE.BW_CREDITCD,
                   BWFILE.BW_STRTGCD,
                   BWFILE.BW_DWELLCD,
                   BWFILE.BW_COUNTY,
                   BWFILE.BW_ORIGIN,
                   BWFILE.BW_CENSUSCD,
                   BWFILE.BW_ORGSLSMN,
                   BWFILE.BW_REPCODE,
                   BWFILE.BW_SPSSNO,
                   BWFILE.BW_SPLNAME,
                   BWFILE.BW_SPFNAME,
                   CAST(BWFILE.BW_SP_BDATE AS VARCHAR(10)),
                   BWFILE.BW_EMPLOYER,
                   BWFILE.BW_EMPLPOS,
                   BWFILE.BW_EMPPHONE,
                   BWFILE.BW_EMPEXT,
                   BWFILE.BW_EMPYEARS,
                   BWFILE.BW_EMPPAY,
                   BWFILE.BW_EMPPAYOT,
                   BWFILE.BW_EMPPAYSR,
                   BWFILE.BW_EMPADDR1,
                   BWFILE.BW_EMPADDR2,
                   BWFILE.BW_EMPCITY,
                   BWFILE.BW_EMPSTATE,
                   BWFILE.BW_EMPZIP,
                   BWFILE.BW_WORKHRS,
                   BWFILE.BW_LOANS,
                   BWFILE.BW_INTYTD,
                   BWFILE.BW_INTLYR,
                   BWFILE.BW_LIASMLN,
                   BWFILE.BW_LIAOTH,
                   CAST(BWFILE.BW_LASTPODATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_PRLOANS,
                   BWFILE.BW_RE_INTYTD,
                   BWFILE.BW_RE_INTLYR,
                   BWFILE.BW_CREDIT_LIMIT,
                   BWFILE.BW_CREDIT_SCORE,
                   BWFILE.BW_CRED_SCORE_1,
                   BWFILE.BW_CRED_SCORE_2,
                   BWFILE.BW_CRED_SCORE_3,
                   BWFILE.BW_CRED_SCORE_4,
                   BWFILE.BW_BNKRPT_SCORE_1,
                   BWFILE.BW_BNKRPT_SCORE_2,
                   BWFILE.BW_BNKRPT_SCORE_3,
                   BWFILE.BW_BNKRPT_SCORE_4,
                   BWFILE.BW_LAST_FORM_NO,
                   CAST(BWFILE.BW_LAST_FORM_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_ADR_PHONE_CHG_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_BAD_ADR_FG,
                   BWFILE.BW_BAD_PHONE_FG,
                   BWFILE.BW_BAD_EMPPHONE_FG,
                   BWFILE.BW_BAD_MISC_PHONE1_FG,
                   BWFILE.BW_BAD_MISC_PHONE2_FG,
                   BWFILE.BW_BAD_CELL_FG,
                   BWFILE.BW_MISC_PHONE_1,
                   BWFILE.BW_MISC_EXT_1,
                   BWFILE.BW_MISC_PHONE_CD_1,
                   BWFILE.BW_MISC_PHONE_2,
                   BWFILE.BW_MISC_EXT_2,
                   BWFILE.BW_MISC_PHONE_CD_2,
                   BWFILE.BW_MISC_PHONE_3,
                   BWFILE.BW_MISC_EXT_3,
                   BWFILE.BW_MISC_PHONE_CD_3,
                   BWFILE.BW_MISC_PHONE_4,
                   BWFILE.BW_MISC_EXT_4,
                   BWFILE.BW_MISC_PHONE_CD_4,
                   BWFILE.BW_MISC_PHONE_5,
                   BWFILE.BW_MISC_EXT_5,
                   BWFILE.BW_MISC_PHONE_CD_5,
                   BWFILE.BW_MISC_PHONE_6,
                   BWFILE.BW_MISC_EXT_6,
                   BWFILE.BW_MISC_PHONE_CD_6,
                   BWFILE.BW_CONTACT_DESC_1,
                   BWFILE.BW_CONTACT_PHONE_1,
                   BWFILE.BW_CONTACT_EXT_1,
                   BWFILE.BW_CONTACT_RELATION_1,
                   BWFILE.BW_CONTACT_DESC_2,
                   BWFILE.BW_CONTACT_PHONE_2,
                   BWFILE.BW_CONTACT_EXT_2,
                   BWFILE.BW_CONTACT_RELATION_2,
                   BWFILE.BW_CONTACT_DESC_3,
                   BWFILE.BW_CONTACT_PHONE_3,
                   BWFILE.BW_CONTACT_EXT_3,
                   BWFILE.BW_CONTACT_RELATION_3,
                   BWFILE.BW_CONTACT_DESC_4,
                   BWFILE.BW_CONTACT_PHONE_4,
                   BWFILE.BW_CONTACT_EXT_4,
                   BWFILE.BW_CONTACT_RELATION_4,
                   BWFILE.BW_CONTACT_DESC_5,
                   BWFILE.BW_CONTACT_PHONE_5,
                   BWFILE.BW_CONTACT_EXT_5,
                   BWFILE.BW_CONTACT_RELATION_5,
                   BWFILE.BW_CONTACT_DESC_6,
                   BWFILE.BW_CONTACT_PHONE_6,
                   BWFILE.BW_CONTACT_EXT_6,
                   BWFILE.BW_CONTACT_RELATION_6,
                   BWFILE.BW_CONTACT_DESC_7,
                   BWFILE.BW_CONTACT_PHONE_7,
                   BWFILE.BW_CONTACT_EXT_7,
                   BWFILE.BW_CONTACT_RELATION_7,
                   BWFILE.BW_CONTACT_DESC_8,
                   BWFILE.BW_CONTACT_PHONE_8,
                   BWFILE.BW_CONTACT_EXT_8,
                   BWFILE.BW_CONTACT_RELATION_8,
                   BWFILE.BW_CONTACT_DESC_9,
                   BWFILE.BW_CONTACT_PHONE_9,
                   BWFILE.BW_CONTACT_EXT_9,
                   BWFILE.BW_CONTACT_RELATION_9,
                   BWFILE.BW_CONTACT_DESC_10,
                   BWFILE.BW_CONTACT_PHONE_10,
                   BWFILE.BW_CONTACT_EXT_10,
                   BWFILE.BW_CONTACT_RELATION_10,
                   BWFILE.BW_SRCD,
                   BWFILE.BW_CALL_ON_SUNDAY,
                   BWFILE.BW_SOLICIT,
                   BWFILE.BW_CONFIDENTIAL,
                   BWFILE.BW_PRIVACY_OPT_OUT,
                   BWFILE.BW_OPT_IN_EMAIL,
                   BWFILE.BW_OPT_IN_TEXT,
                   BWFILE.BW_CITY_TAX_CD,
                   CAST(BWFILE.BW_DEALTRACK_CHG_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_DECEASED,
                   CAST(BWFILE.BW_DECEASED_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_EMAIL,
                   BWFILE.BW_IDENT_NO,
                   BWFILE.BW_IDENT_TYPE,
                   BWFILE.BW_IDENT_STATE,
                   BWFILE.BW_MILITARY_FLAG,
                   BWFILE.BW_ORGBR,
                   CAST(BWFILE.BW_CEASE_DESIST_DATE AS VARCHAR(10)),
                   BWFILE.BW_CEASE_DESIST_TYPE,
                   CAST(BWFILE.BW_UMC_EXPIRE_DATE AS VARCHAR(10)),
                   CAST(BWFILE.BW_UMC_PR_EXPIRE_DATE AS VARCHAR(10))
            FROM DBO.BWFILE
            WHERE BWFILE.BW_OWNBR = :QBW1-WBEG-OWNBR
              AND BWFILE.BW_SSNO >= :QBW1-WBEG-SSNO
              AND BWFILE.BW_SSNO <= :QBW1-WEND-SSNO
              ORDER BY BWFILE.BW_OWNBR,
                       BWFILE.BW_SSNO
           END-EXEC.

           EXEC SQL
               OPEN BW1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QBW1-WBEG-OWNBR 
                          QBW1-WEND-OWNBR
                          QBW1-WBEG-SSNO
                          QBW1-WEND-SSNO.

           MOVE STAT---GOOD TO BW1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-BW1-FILE.
           PERFORM READ-IT.
           MOVE BW-PATH-OWNBR  TO BW-OWNBR. 
           MOVE BW-PATH-SQL    TO E-FILE.
           MOVE BW1-KEY        TO E-KEYX.
           INITIALIZE QBW-REC.

           MOVE BW-OWNBR   TO QBW-OWNBR.
           MOVE BW-SSNO    TO QBW-SSNO.

           EXEC SQL
            SELECT BWFILE.BW_OWNBR,
                   BWFILE.BW_SSNO,
                   BWFILE.BW_LNAME,
                   BWFILE.BW_FNAME,
                   BWFILE.BW_MNAME,
                   BWFILE.BW_NICKNAME,
                   BWFILE.BW_GENERATION,
                   BWFILE.BW_ADR1,
                   BWFILE.BW_ADR2,
                   BWFILE.BW_CITY,
                   BWFILE.BW_STATE,
                   BWFILE.BW_ZIP,
                   CAST(BWFILE.BW_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_REFDATE AS VARCHAR(10)),
                   CAST(BWFILE.BW_BDATE AS VARCHAR(10)),
                   BWFILE.BW_PHONE,
                   BWFILE.BW_CELL_PHONE,
                   BWFILE.BW_NATIONALITY,
                   BWFILE.BW_GENDER,
                   BWFILE.BW_DEPEND,
                   BWFILE.BW_RENTCD,
                   BWFILE.BW_TIMEADDR,
                   BWFILE.BW_CREDITCD,
                   BWFILE.BW_STRTGCD,
                   BWFILE.BW_DWELLCD,
                   BWFILE.BW_COUNTY,
                   BWFILE.BW_ORIGIN,
                   BWFILE.BW_CENSUSCD,
                   BWFILE.BW_ORGSLSMN,
                   BWFILE.BW_REPCODE,
                   BWFILE.BW_SPSSNO,
                   BWFILE.BW_SPLNAME,
                   BWFILE.BW_SPFNAME,
                   CAST(BWFILE.BW_SP_BDATE AS VARCHAR(10)),
                   BWFILE.BW_EMPLOYER,
                   BWFILE.BW_EMPLPOS,
                   BWFILE.BW_EMPPHONE,
                   BWFILE.BW_EMPEXT,
                   BWFILE.BW_EMPYEARS,
                   BWFILE.BW_EMPPAY,
                   BWFILE.BW_EMPPAYOT,
                   BWFILE.BW_EMPPAYSR,
                   BWFILE.BW_EMPADDR1,
                   BWFILE.BW_EMPADDR2,
                   BWFILE.BW_EMPCITY,
                   BWFILE.BW_EMPSTATE,
                   BWFILE.BW_EMPZIP,
                   BWFILE.BW_WORKHRS,
                   BWFILE.BW_LOANS,
                   BWFILE.BW_INTYTD,
                   BWFILE.BW_INTLYR,
                   BWFILE.BW_LIASMLN,
                   BWFILE.BW_LIAOTH,
                   CAST(BWFILE.BW_LASTPODATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_PRLOANS,
                   BWFILE.BW_RE_INTYTD,
                   BWFILE.BW_RE_INTLYR,
                   BWFILE.BW_CREDIT_LIMIT,
                   BWFILE.BW_CREDIT_SCORE,
                   BWFILE.BW_CRED_SCORE_1,
                   BWFILE.BW_CRED_SCORE_2,
                   BWFILE.BW_CRED_SCORE_3,
                   BWFILE.BW_CRED_SCORE_4,
                   BWFILE.BW_BNKRPT_SCORE_1,
                   BWFILE.BW_BNKRPT_SCORE_2,
                   BWFILE.BW_BNKRPT_SCORE_3,
                   BWFILE.BW_BNKRPT_SCORE_4,
                   BWFILE.BW_LAST_FORM_NO,
                   CAST(BWFILE.BW_LAST_FORM_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(BWFILE.BW_ADR_PHONE_CHG_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_BAD_ADR_FG,
                   BWFILE.BW_BAD_PHONE_FG,
                   BWFILE.BW_BAD_EMPPHONE_FG,
                   BWFILE.BW_BAD_MISC_PHONE1_FG,
                   BWFILE.BW_BAD_MISC_PHONE2_FG,
                   BWFILE.BW_BAD_CELL_FG,
                   BWFILE.BW_MISC_PHONE_1,
                   BWFILE.BW_MISC_EXT_1,
                   BWFILE.BW_MISC_PHONE_CD_1,
                   BWFILE.BW_MISC_PHONE_2,
                   BWFILE.BW_MISC_EXT_2,
                   BWFILE.BW_MISC_PHONE_CD_2,
                   BWFILE.BW_MISC_PHONE_3,
                   BWFILE.BW_MISC_EXT_3,
                   BWFILE.BW_MISC_PHONE_CD_3,
                   BWFILE.BW_MISC_PHONE_4,
                   BWFILE.BW_MISC_EXT_4,
                   BWFILE.BW_MISC_PHONE_CD_4,
                   BWFILE.BW_MISC_PHONE_5,
                   BWFILE.BW_MISC_EXT_5,
                   BWFILE.BW_MISC_PHONE_CD_5,
                   BWFILE.BW_MISC_PHONE_6,
                   BWFILE.BW_MISC_EXT_6,
                   BWFILE.BW_MISC_PHONE_CD_6,
                   BWFILE.BW_CONTACT_DESC_1,
                   BWFILE.BW_CONTACT_PHONE_1,
                   BWFILE.BW_CONTACT_EXT_1,
                   BWFILE.BW_CONTACT_RELATION_1,
                   BWFILE.BW_CONTACT_DESC_2,
                   BWFILE.BW_CONTACT_PHONE_2,
                   BWFILE.BW_CONTACT_EXT_2,
                   BWFILE.BW_CONTACT_RELATION_2,
                   BWFILE.BW_CONTACT_DESC_3,
                   BWFILE.BW_CONTACT_PHONE_3,
                   BWFILE.BW_CONTACT_EXT_3,
                   BWFILE.BW_CONTACT_RELATION_3,
                   BWFILE.BW_CONTACT_DESC_4,
                   BWFILE.BW_CONTACT_PHONE_4,
                   BWFILE.BW_CONTACT_EXT_4,
                   BWFILE.BW_CONTACT_RELATION_4,
                   BWFILE.BW_CONTACT_DESC_5,
                   BWFILE.BW_CONTACT_PHONE_5,
                   BWFILE.BW_CONTACT_EXT_5,
                   BWFILE.BW_CONTACT_RELATION_5,
                   BWFILE.BW_CONTACT_DESC_6,
                   BWFILE.BW_CONTACT_PHONE_6,
                   BWFILE.BW_CONTACT_EXT_6,
                   BWFILE.BW_CONTACT_RELATION_6,
                   BWFILE.BW_CONTACT_DESC_7,
                   BWFILE.BW_CONTACT_PHONE_7,
                   BWFILE.BW_CONTACT_EXT_7,
                   BWFILE.BW_CONTACT_RELATION_7,
                   BWFILE.BW_CONTACT_DESC_8,
                   BWFILE.BW_CONTACT_PHONE_8,
                   BWFILE.BW_CONTACT_EXT_8,
                   BWFILE.BW_CONTACT_RELATION_8,
                   BWFILE.BW_CONTACT_DESC_9,
                   BWFILE.BW_CONTACT_PHONE_9,
                   BWFILE.BW_CONTACT_EXT_9,
                   BWFILE.BW_CONTACT_RELATION_9,
                   BWFILE.BW_CONTACT_DESC_10,
                   BWFILE.BW_CONTACT_PHONE_10,
                   BWFILE.BW_CONTACT_EXT_10,
                   BWFILE.BW_CONTACT_RELATION_10,
                   BWFILE.BW_SRCD,
                   BWFILE.BW_CALL_ON_SUNDAY,
                   BWFILE.BW_SOLICIT,
                   BWFILE.BW_CONFIDENTIAL,
                   BWFILE.BW_PRIVACY_OPT_OUT,
                   BWFILE.BW_OPT_IN_EMAIL,
                   BWFILE.BW_OPT_IN_TEXT,
                   BWFILE.BW_CITY_TAX_CD,
                   CAST(BWFILE.BW_DEALTRACK_CHG_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_DECEASED,
                   CAST(BWFILE.BW_DECEASED_DATE
                                                  AS VARCHAR(10)),
                   BWFILE.BW_EMAIL,
                   BWFILE.BW_IDENT_NO,
                   BWFILE.BW_IDENT_TYPE,
                   BWFILE.BW_IDENT_STATE,
                   BWFILE.BW_MILITARY_FLAG,
                   BWFILE.BW_ORGBR,
                   CAST(BWFILE.BW_CEASE_DESIST_DATE AS VARCHAR(10)),
                   BWFILE.BW_CEASE_DESIST_TYPE,
                   CAST(BWFILE.BW_UMC_EXPIRE_DATE AS VARCHAR(10)),
                   CAST(BWFILE.BW_UMC_PR_EXPIRE_DATE AS VARCHAR(10))
            INTO :QBW-REC
            FROM DBO.BWFILE
            WHERE BWFILE.BW_OWNBR = :QBW-OWNBR
              AND BWFILE.BW_SSNO = :QBW-SSNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-BW1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-BW-FIELDS.

      *-----------------------------------------------------------------
       READ-BW1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE BW-PATH-OWNBR  TO BW-OWNBR.
           MOVE BW-PATH-SQL    TO E-FILE.
           MOVE BW1-KEY        TO E-KEYX.
           INITIALIZE QBW-REC.

           IF ( BW1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH BW1_CURSOR INTO :QBW-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-BW1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-BW-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-BW1-FILE.

           PERFORM CLOSE-IT.
           IF ( BW1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE BW1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO BW1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPBW1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGL\GLGI1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGL/GLGI1RN
       LOAD-GI1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( GI-PATH-OVERRIDE = "Y" )
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( GI-PATH-OVERRIDE = SPACES )
              MOVE EXT-FILPATH-BASE        TO GI-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO GI-ALL-MACHINE
              MOVE GI-ALL-PATH             TO GI-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( GI-PATH-OVERRIDE = "B" )
              MOVE FILPATH-BASE            TO GI-ALL-BASE
              MOVE FILPATH-MACHINE         TO GI-ALL-MACHINE
              MOVE GI-ALL-PATH             TO GI-PATH.

      *-----------------------------------------------------------------
       OPEN-GI1-FILE.
           PERFORM LOAD-GI1-FILE.
           PERFORM OPEN-IT.
           MOVE GI-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       COUNT-GI1-FILE.
           PERFORM COUNT-IT.
           MOVE GI-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           MOVE GI-BRANCH      TO QGI-BRANCH.

           EXEC SQL
            SELECT COUNT(*)
              INTO :GI1-ROW-COUNT
              FROM DBO.GIFILE
             WHERE GI_BRANCH = :QGI-BRANCH
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO COUNT-GI1-FILE.

      *-----------------------------------------------------------------
       START-GI1-FILE.
           PERFORM START-IT.
           MOVE GI-PATH-SQL TO E-FILE.
           MOVE GI1-KEY TO E-KEYX.

           IF ( GI1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-GI1-FILE.

           IF ( QGI1-WEND-CLASS = ZEROES    ) OR
              ( QGI1-WEND-CLASS NOT NUMERIC )
              MOVE GI-BRANCH            TO QGI1-WBEG-BRANCH
              MOVE ALL "9"              TO QGI1-WEND-BRANCH
              MOVE GI-CLASS             TO QGI1-WBEG-CLASS
              MOVE ALL "9"              TO QGI1-WEND-CLASS.

           EXEC SQL
            DECLARE GI1_CURSOR CURSOR FOR
            SELECT GIFILE.GI_BRANCH,
                   GIFILE.GI_CLASS,
                   CAST(GIFILE.GI_LTOUCH_DATE AS VARCHAR(10)),
                   GIFILE.GI_CASH,
                   GIFILE.GI_BANK,
                   GIFILE.GI_NSF,
                   GIFILE.GI_AR,
                   GIFILE.GI_PL_1,
                   GIFILE.GI_PL_2,
                   GIFILE.GI_PL_3,
                   GIFILE.GI_PL_4,
                   GIFILE.GI_PL_5,
                   GIFILE.GI_DLINSREB,
                   GIFILE.GI_ACR_INT_AR_AR,
                   GIFILE.GI_OTHBR_REC,
                   GIFILE.GI_OTHBR_PAY,
                   GIFILE.GI_UNINTCHG,
                   GIFILE.GI_UNADDON,
                   GIFILE.GI_UNSERCHG,
                   GIFILE.GI_UNMAINTFEE,
                   GIFILE.GI_UNDLDISC,
                   GIFILE.GI_UNOTHER,
                   GIFILE.GI_UN7,
                   GIFILE.GI_UN8,
                   GIFILE.GI_UN9,
                   GIFILE.GI_UN10,
                   GIFILE.GI_UNCL1,
                   GIFILE.GI_UNCL2,
                   GIFILE.GI_UNAH,
                   GIFILE.GI_UNPP,
                   GIFILE.GI_UNO1,
                   GIFILE.GI_UNO2,
                   GIFILE.GI_UNO3,
                   GIFILE.GI_UNO4,
                   GIFILE.GI_UNO5,
                   GIFILE.GI_UNO6,
                   GIFILE.GI_UNO7,
                   GIFILE.GI_UNINTREPO,
                   GIFILE.GI_UNADDONINTREPO,
                   GIFILE.GI_PLEXP_1,
                   GIFILE.GI_PLEXP_2,
                   GIFILE.GI_PLEXP_3,
                   GIFILE.GI_PLEXP_4,
                   GIFILE.GI_PLEXP_5,
                   GIFILE.GI_DLPARVEX,
                   GIFILE.GI_PLOFFSET_1,
                   GIFILE.GI_PLOFFSET_2,
                   GIFILE.GI_PLOFFSET_3,
                   GIFILE.GI_PLOFFSET_4,
                   GIFILE.GI_PLOFFSET_5,
                   GIFILE.GI_SERVOFF,
                   GIFILE.GI_PAYCL1,
                   GIFILE.GI_PAYCL2,
                   GIFILE.GI_PAYAH,
                   GIFILE.GI_PAYPP,
                   GIFILE.GI_PAYO1,
                   GIFILE.GI_PAYO2,
                   GIFILE.GI_PAYO3,
                   GIFILE.GI_PAYO4,
                   GIFILE.GI_PAYO5,
                   GIFILE.GI_PAYO6,
                   GIFILE.GI_PAYO7,
                   GIFILE.GI_DLPAYABLE,
                   GIFILE.GI_DLRVPRIN_1,
                   GIFILE.GI_DLRVPRIN_2,
                   GIFILE.GI_DLRVPRIN_3,
                   GIFILE.GI_DLRVCHGS_1,
                   GIFILE.GI_DLRVCHGS_2,
                   GIFILE.GI_DLRVCHGS_3,
                   GIFILE.GI_DLPARV,
                   GIFILE.GI_PAYALLOT,
                   GIFILE.GI_DIRECT_PAY,
                   GIFILE.GI_ERINTCHG,
                   GIFILE.GI_ERADDON,
                   GIFILE.GI_ERSERCHG,
                   GIFILE.GI_ERMAINTFEE,
                   GIFILE.GI_ERDLDISC,
                   GIFILE.GI_EROTHER,
                   GIFILE.GI_EARN7,
                   GIFILE.GI_EARN8,
                   GIFILE.GI_EARN9,
                   GIFILE.GI_EARN10,
                   GIFILE.GI_LATECHG,
                   GIFILE.GI_INTEREST,
                   GIFILE.GI_DEFERMENTS,
                   GIFILE.GI_SAPRINCIPAL,
                   GIFILE.GI_PLINT_1,
                   GIFILE.GI_PLINT_2,
                   GIFILE.GI_PLINT_3,
                   GIFILE.GI_PLINT_4,
                   GIFILE.GI_PLINT_5,
                   GIFILE.GI_PLREC_1,
                   GIFILE.GI_PLREC_2,
                   GIFILE.GI_PLREC_3,
                   GIFILE.GI_PLREC_4,
                   GIFILE.GI_PLREC_5,
                   GIFILE.GI_CL1,
                   GIFILE.GI_CL2,
                   GIFILE.GI_AH,
                   GIFILE.GI_PP,
                   GIFILE.GI_O1,
                   GIFILE.GI_O2,
                   GIFILE.GI_O3,
                   GIFILE.GI_O4,
                   GIFILE.GI_O5,
                   GIFILE.GI_O6,
                   GIFILE.GI_O7,
                   GIFILE.GI_PLNEW_AR_1,
                   GIFILE.GI_PLNEW_AR_2,
                   GIFILE.GI_PLNEW_AR_3,
                   GIFILE.GI_PLNEW_AR_4,
                   GIFILE.GI_PLNEW_AR_5,
                   GIFILE.GI_REPO_AR,
                   GIFILE.GI_REPO_INT,
                   GIFILE.GI_ACR_INT_AR,
                   GIFILE.GI_CONV_OFFSET,
                   GIFILE.GI_PARTIAL_PLEXP,
                   GIFILE.GI_PAYLBOX,
                   GIFILE.GI_PENALTY_INT,
                   GIFILE.GI_PAYTPAY,
                   GIFILE.GI_PAYTCOLL,
                   GIFILE.GI_PAYMGRAM,
                   GIFILE.GI_REPO_ADDON_EXP,
                   GIFILE.GI_ACH_BANK,
                   GIFILE.GI_LN_APPROVAL_LIMIT
            FROM DBO.GIFILE
            WHERE GIFILE.GI_BRANCH >= :QGI1-WBEG-BRANCH
              AND GIFILE.GI_BRANCH <= :QGI1-WEND-BRANCH
              AND GIFILE.GI_CLASS >= :QGI1-WBEG-CLASS
              AND GIFILE.GI_CLASS <= :QGI1-WEND-CLASS
            ORDER BY GIFILE.GI_BRANCH,
                     GIFILE.GI_CLASS
           END-EXEC.

           EXEC SQL
               OPEN GI1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QGI1-WBEG-BRANCH
                          QGI1-WBEG-CLASS
                          QGI1-WEND-BRANCH
                          QGI1-WEND-CLASS.

           MOVE STAT---GOOD TO GI1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-GI1-FILE.
           PERFORM READ-IT.
           MOVE GI-PATH-SQL TO E-FILE.
           MOVE GI1-KEY TO E-KEYX.
           INITIALIZE QGI-REC.

           MOVE GI-BRANCH    TO QGI-BRANCH. 
           MOVE GI-CLASS     TO QGI-CLASS.

           EXEC SQL
            SELECT GIFILE.GI_BRANCH,
                   GIFILE.GI_CLASS,
                   CAST(GIFILE.GI_LTOUCH_DATE AS VARCHAR(10)),
                   GIFILE.GI_CASH,
                   GIFILE.GI_BANK,
                   GIFILE.GI_NSF,
                   GIFILE.GI_AR,
                   GIFILE.GI_PL_1,
                   GIFILE.GI_PL_2,
                   GIFILE.GI_PL_3,
                   GIFILE.GI_PL_4,
                   GIFILE.GI_PL_5,
                   GIFILE.GI_DLINSREB,
                   GIFILE.GI_ACR_INT_AR_AR,
                   GIFILE.GI_OTHBR_REC,
                   GIFILE.GI_OTHBR_PAY,
                   GIFILE.GI_UNINTCHG,
                   GIFILE.GI_UNADDON,
                   GIFILE.GI_UNSERCHG,
                   GIFILE.GI_UNMAINTFEE,
                   GIFILE.GI_UNDLDISC,
                   GIFILE.GI_UNOTHER,
                   GIFILE.GI_UN7,
                   GIFILE.GI_UN8,
                   GIFILE.GI_UN9,
                   GIFILE.GI_UN10,
                   GIFILE.GI_UNCL1,
                   GIFILE.GI_UNCL2,
                   GIFILE.GI_UNAH,
                   GIFILE.GI_UNPP,
                   GIFILE.GI_UNO1,
                   GIFILE.GI_UNO2,
                   GIFILE.GI_UNO3,
                   GIFILE.GI_UNO4,
                   GIFILE.GI_UNO5,
                   GIFILE.GI_UNO6,
                   GIFILE.GI_UNO7,
                   GIFILE.GI_UNINTREPO,
                   GIFILE.GI_UNADDONINTREPO,
                   GIFILE.GI_PLEXP_1,
                   GIFILE.GI_PLEXP_2,
                   GIFILE.GI_PLEXP_3,
                   GIFILE.GI_PLEXP_4,
                   GIFILE.GI_PLEXP_5,
                   GIFILE.GI_DLPARVEX,
                   GIFILE.GI_PLOFFSET_1,
                   GIFILE.GI_PLOFFSET_2,
                   GIFILE.GI_PLOFFSET_3,
                   GIFILE.GI_PLOFFSET_4,
                   GIFILE.GI_PLOFFSET_5,
                   GIFILE.GI_SERVOFF,
                   GIFILE.GI_PAYCL1,
                   GIFILE.GI_PAYCL2,
                   GIFILE.GI_PAYAH,
                   GIFILE.GI_PAYPP,
                   GIFILE.GI_PAYO1,
                   GIFILE.GI_PAYO2,
                   GIFILE.GI_PAYO3,
                   GIFILE.GI_PAYO4,
                   GIFILE.GI_PAYO5,
                   GIFILE.GI_PAYO6,
                   GIFILE.GI_PAYO7,
                   GIFILE.GI_DLPAYABLE,
                   GIFILE.GI_DLRVPRIN_1,
                   GIFILE.GI_DLRVPRIN_2,
                   GIFILE.GI_DLRVPRIN_3,
                   GIFILE.GI_DLRVCHGS_1,
                   GIFILE.GI_DLRVCHGS_2,
                   GIFILE.GI_DLRVCHGS_3,
                   GIFILE.GI_DLPARV,
                   GIFILE.GI_PAYALLOT,
                   GIFILE.GI_DIRECT_PAY,
                   GIFILE.GI_ERINTCHG,
                   GIFILE.GI_ERADDON,
                   GIFILE.GI_ERSERCHG,
                   GIFILE.GI_ERMAINTFEE,
                   GIFILE.GI_ERDLDISC,
                   GIFILE.GI_EROTHER,
                   GIFILE.GI_EARN7,
                   GIFILE.GI_EARN8,
                   GIFILE.GI_EARN9,
                   GIFILE.GI_EARN10,
                   GIFILE.GI_LATECHG,
                   GIFILE.GI_INTEREST,
                   GIFILE.GI_DEFERMENTS,
                   GIFILE.GI_SAPRINCIPAL,
                   GIFILE.GI_PLINT_1,
                   GIFILE.GI_PLINT_2,
                   GIFILE.GI_PLINT_3,
                   GIFILE.GI_PLINT_4,
                   GIFILE.GI_PLINT_5,
                   GIFILE.GI_PLREC_1,
                   GIFILE.GI_PLREC_2,
                   GIFILE.GI_PLREC_3,
                   GIFILE.GI_PLREC_4,
                   GIFILE.GI_PLREC_5,
                   GIFILE.GI_CL1,
                   GIFILE.GI_CL2,
                   GIFILE.GI_AH,
                   GIFILE.GI_PP,
                   GIFILE.GI_O1,
                   GIFILE.GI_O2,
                   GIFILE.GI_O3,
                   GIFILE.GI_O4,
                   GIFILE.GI_O5,
                   GIFILE.GI_O6,
                   GIFILE.GI_O7,
                   GIFILE.GI_PLNEW_AR_1,
                   GIFILE.GI_PLNEW_AR_2,
                   GIFILE.GI_PLNEW_AR_3,
                   GIFILE.GI_PLNEW_AR_4,
                   GIFILE.GI_PLNEW_AR_5,
                   GIFILE.GI_REPO_AR,
                   GIFILE.GI_REPO_INT,
                   GIFILE.GI_ACR_INT_AR,
                   GIFILE.GI_CONV_OFFSET,
                   GIFILE.GI_PARTIAL_PLEXP,
                   GIFILE.GI_PAYLBOX,
                   GIFILE.GI_PENALTY_INT,
                   GIFILE.GI_PAYTPAY,
                   GIFILE.GI_PAYTCOLL,
                   GIFILE.GI_PAYMGRAM,
                   GIFILE.GI_REPO_ADDON_EXP,
                   GIFILE.GI_ACH_BANK,
                   GIFILE.GI_LN_APPROVAL_LIMIT
            INTO :QGI-REC
            FROM DBO.GIFILE
            WHERE GIFILE.GI_BRANCH = :QGI-BRANCH
              AND GIFILE.GI_CLASS = :QGI-CLASS
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GI1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-GI-FIELDS.

      *-----------------------------------------------------------------
       READ-GI1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE GI-PATH-SQL TO E-FILE.
           MOVE GI1-KEY TO E-KEYX.
           INITIALIZE QGI-REC.

           IF ( GI1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH GI1_CURSOR INTO :QGI-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GI1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-GI-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-GI1-FILE.
           PERFORM CLOSE-IT.
           IF ( GI1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE GI1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO GI1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBGL\GLGI1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPCD1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPCD1RN
       LOAD-CD1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( CD-PATH-OVERRIDE = "Y" )
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( CD-PATH-OVERRIDE = SPACES )
              MOVE EXT-FILPATH-BASE        TO CD-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO CD-ALL-MACHINE
              MOVE CD-ALL-PATH             TO CD-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( CD-PATH-OVERRIDE = "B" )
              MOVE FILPATH-BASE            TO CD-ALL-BASE
              MOVE FILPATH-MACHINE         TO CD-ALL-MACHINE
              MOVE CD-ALL-PATH             TO CD-PATH.

      *-----------------------------------------------------------------
       OPEN-CD1-FILE.
           PERFORM LOAD-CD1-FILE.
           PERFORM OPEN-IT.
           MOVE CD-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-CD1-FILE.
           PERFORM START-IT.
           MOVE CD-PATH-SQL TO E-FILE.
           MOVE CD1-KEY TO E-KEYX.

           IF ( CD1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-CD1-FILE.

           IF ( QCD1-WEND-TYPE = SPACES    ) OR
              ( QCD1-WEND-CODE = SPACES    )
              MOVE CD-TYPE              TO QCD1-WBEG-TYPE
              MOVE ALL "Z"              TO QCD1-WEND-TYPE
              MOVE CD-CODE              TO QCD1-WBEG-CODE
              MOVE ALL "Z"              TO QCD1-WEND-CODE.

           EXEC SQL
            DECLARE CD1_CURSOR CURSOR FOR
            SELECT CDFILE.CD_TYPE,
                   CDFILE.CD_CODE,
                   CAST(CDFILE.CD_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   CDFILE.CD_DESC,
                   CDFILE.CD_AT_ACTIONCD,
                   CDFILE.CD_AT_MEMO_REQUIRED,
                   CDFILE.CD_AT_SUPERVISOR_ONLY,
                   CDFILE.CD_AT_RESULT_REQUIRED,
                   CDFILE.CD_BR_FILE_TYPE,
                   CDFILE.CD_BR_FILE_NAME,
                   CDFILE.CD_BR_PAYOFF_FG,
                   CDFILE.CD_BR_POST_SS_TRCD,
                   CDFILE.CD_BR_GL_BRANCH,
                   CDFILE.CD_BR_GL_ACCT,
                   CDFILE.CD_BR_ALLOT_OPTION,
                   CDFILE.CD_BR_LBOX_OPTION,
                   CDFILE.CD_BR_LC_FG,
                   CDFILE.CD_BR_OT_GL_BRANCH,
                   CDFILE.CD_BR_OT_GL_ACCT,
                   CDFILE.CD_BR_MULTIPLE_REFCDS,
                   CDFILE.CD_BR_COLLECT_LC,
                   CDFILE.CD_CO_GROUP,
                   CDFILE.CD_CO_SECURED,
                   CDFILE.CD_CO_TRW,
                   CDFILE.CD_CT_INSTAXFRMLA_1,
                   CDFILE.CD_CT_INSTAXAMT_1,
                   CDFILE.CD_CT_INSTAXFRMLA_2,
                   CDFILE.CD_CT_INSTAXAMT_2,
                   CDFILE.CD_CT_INSTAXFRMLA_3,
                   CDFILE.CD_CT_INSTAXAMT_3,
                   CDFILE.CD_CT_INSTAXFRMLA_4,
                   CDFILE.CD_CT_INSTAXAMT_4,
                   CDFILE.CD_CT_INSTAXFRMLA_5,
                   CDFILE.CD_CT_INSTAXAMT_5,
                   CDFILE.CD_CT_INSTAXFRMLA_6,
                   CDFILE.CD_CT_INSTAXAMT_6,
                   CDFILE.CD_CT_INSTAXFRMLA_7,
                   CDFILE.CD_CT_INSTAXAMT_7,
                   CDFILE.CD_CT_INSTAXFRMLA_8,
                   CDFILE.CD_CT_INSTAXAMT_8,
                   CDFILE.CD_CT_INSTAXFRMLA_9,
                   CDFILE.CD_CT_INSTAXAMT_9,
                   CDFILE.CD_CT_INSTAXFRMLA_10,
                   CDFILE.CD_CT_INSTAXAMT_10,
                   CDFILE.CD_CT_INSTAXFRMLA_11,
                   CDFILE.CD_CT_INSTAXAMT_11,
                   CDFILE.CD_CT_INSTAXFRMLA_12,
                   CDFILE.CD_CT_INSTAXAMT_12,
                   CDFILE.CD_CT_BOTH_TAX_FG,
                   CDFILE.CD_CY_INSTAXFRMLA_1,
                   CDFILE.CD_CY_INSTAXAMT_1,
                   CDFILE.CD_CY_INSTAXFRMLA_2,
                   CDFILE.CD_CY_INSTAXAMT_2,
                   CDFILE.CD_CY_INSTAXFRMLA_3,
                   CDFILE.CD_CY_INSTAXAMT_3,
                   CDFILE.CD_CY_INSTAXFRMLA_4,
                   CDFILE.CD_CY_INSTAXAMT_4,
                   CDFILE.CD_CY_INSTAXFRMLA_5,
                   CDFILE.CD_CY_INSTAXAMT_5,
                   CDFILE.CD_CY_INSTAXFRMLA_6,
                   CDFILE.CD_CY_INSTAXAMT_6,
                   CDFILE.CD_CY_INSTAXFRMLA_7,
                   CDFILE.CD_CY_INSTAXAMT_7,
                   CDFILE.CD_CY_INSTAXFRMLA_8,
                   CDFILE.CD_CY_INSTAXAMT_8,
                   CDFILE.CD_CY_INSTAXFRMLA_9,
                   CDFILE.CD_CY_INSTAXAMT_9,
                   CDFILE.CD_CY_INSTAXFRMLA_10,
                   CDFILE.CD_CY_INSTAXAMT_10,
                   CDFILE.CD_CY_INSTAXFRMLA_11,
                   CDFILE.CD_CY_INSTAXAMT_11,
                   CDFILE.CD_CY_INSTAXFRMLA_12,
                   CDFILE.CD_CY_INSTAXAMT_12,
                   CDFILE.CD_CY_BOTH_TAX_FG,
                   CDFILE.CD_EA_CQ_FG,
                   CDFILE.CD_EA_GQ_FG,
                   CDFILE.CD_ELGRACE,
                   CDFILE.CD_ELGRACECD,
                   CDFILE.CD_ELTYPE,
                   CDFILE.CD_ELRATE,
                   CDFILE.CD_ELFRMLA,
                   CDFILE.CD_ELMINCHG,
                   CDFILE.CD_ELMAXAMT,
                   CDFILE.CD_ELDELFAC,
                   CDFILE.CD_ELYRTYPE,
                   CDFILE.CD_ELUNITPER_CD,
                   CDFILE.CD_PO_TITLE_HOLD_DAYS,
                   CDFILE.CD_RE_ACTIONCD,
                   CDFILE.CD_RE_MEMO_REQUIRED,
                   CDFILE.CD_RE_SUPERVISOR_ONLY,
                   CDFILE.CD_RE_ACTIVITY_REQUIRED,
                   CDFILE.CD_RE_RESCHEDULE_REQ,
                   CDFILE.CD_RE_RESCHEDULE_TIME,
                   CDFILE.CD_RE_WORKED_ACCOUNT,
                   CDFILE.CD_FC_FEEAMT,
                   CDFILE.CD_TC_REFNO_1,
                   CDFILE.CD_TC_REFNO_2,
                   CDFILE.CD_TC_REFNO_3,
                   CDFILE.CD_TC_REFNO_4,
                   CDFILE.CD_TC_REFNO_5,
                   CDFILE.CD_TC_REFNO_6,
                   CDFILE.CD_TC_REFNO_7,
                   CDFILE.CD_TC_REFNO_8,
                   CDFILE.CD_TC_REFNO_9,
                   CDFILE.CD_TC_REFNO_10,
                   CDFILE.CD_PS_TDR_FLAG
            FROM DBO.CDFILE
            WHERE CDFILE.CD_TYPE >= :QCD1-WBEG-TYPE
              AND CDFILE.CD_TYPE <= :QCD1-WEND-TYPE
              AND CDFILE.CD_CODE >= :QCD1-WBEG-CODE
              AND CDFILE.CD_CODE <= :QCD1-WEND-CODE
              ORDER BY CDFILE.CD_TYPE,
                       CDFILE.CD_CODE
           END-EXEC.

           EXEC SQL
               OPEN CD1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE SPACES TO QCD1-WBEG-TYPE
                          QCD1-WEND-TYPE
                          QCD1-WBEG-CODE
                          QCD1-WEND-CODE.

           MOVE STAT---GOOD TO CD1-CURSOR-STAT.

      *------------------------------------------------
       START-CD1-FILE-NOT-GREATER.
           PERFORM START-IT.
           MOVE CD-PATH-SQL TO E-FILE.
           MOVE CD1-KEY TO E-KEYX.

           IF ( CD1-CURSOR-NG-STAT-GOOD )
              PERFORM CLOSE-CD1-FILE.

           IF ( QCD1-WEND-TYPE = SPACES    ) OR
              ( QCD1-WEND-CODE = SPACES    )
              MOVE SPACES               TO QCD1-WBEG-TYPE
              MOVE CD-TYPE              TO QCD1-WEND-TYPE
              MOVE SPACES               TO QCD1-WBEG-CODE
              MOVE CD-CODE              TO QCD1-WEND-CODE.

           EXEC SQL
            DECLARE CD1_CURSOR_NG CURSOR FOR
            SELECT CDFILE.CD_TYPE,
                   CDFILE.CD_CODE,
                   CAST(CDFILE.CD_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   CDFILE.CD_DESC,
                   CDFILE.CD_AT_ACTIONCD,
                   CDFILE.CD_AT_MEMO_REQUIRED,
                   CDFILE.CD_AT_SUPERVISOR_ONLY,
                   CDFILE.CD_AT_RESULT_REQUIRED,
                   CDFILE.CD_BR_FILE_TYPE,
                   CDFILE.CD_BR_FILE_NAME,
                   CDFILE.CD_BR_PAYOFF_FG,
                   CDFILE.CD_BR_POST_SS_TRCD,
                   CDFILE.CD_BR_GL_BRANCH,
                   CDFILE.CD_BR_GL_ACCT,
                   CDFILE.CD_BR_ALLOT_OPTION,
                   CDFILE.CD_BR_LBOX_OPTION,
                   CDFILE.CD_BR_LC_FG,
                   CDFILE.CD_BR_OT_GL_BRANCH,
                   CDFILE.CD_BR_OT_GL_ACCT,
                   CDFILE.CD_BR_MULTIPLE_REFCDS,
                   CDFILE.CD_BR_COLLECT_LC,
                   CDFILE.CD_CO_GROUP,
                   CDFILE.CD_CO_SECURED,
                   CDFILE.CD_CO_TRW,
                   CDFILE.CD_CT_INSTAXFRMLA_1,
                   CDFILE.CD_CT_INSTAXAMT_1,
                   CDFILE.CD_CT_INSTAXFRMLA_2,
                   CDFILE.CD_CT_INSTAXAMT_2,
                   CDFILE.CD_CT_INSTAXFRMLA_3,
                   CDFILE.CD_CT_INSTAXAMT_3,
                   CDFILE.CD_CT_INSTAXFRMLA_4,
                   CDFILE.CD_CT_INSTAXAMT_4,
                   CDFILE.CD_CT_INSTAXFRMLA_5,
                   CDFILE.CD_CT_INSTAXAMT_5,
                   CDFILE.CD_CT_INSTAXFRMLA_6,
                   CDFILE.CD_CT_INSTAXAMT_6,
                   CDFILE.CD_CT_INSTAXFRMLA_7,
                   CDFILE.CD_CT_INSTAXAMT_7,
                   CDFILE.CD_CT_INSTAXFRMLA_8,
                   CDFILE.CD_CT_INSTAXAMT_8,
                   CDFILE.CD_CT_INSTAXFRMLA_9,
                   CDFILE.CD_CT_INSTAXAMT_9,
                   CDFILE.CD_CT_INSTAXFRMLA_10,
                   CDFILE.CD_CT_INSTAXAMT_10,
                   CDFILE.CD_CT_INSTAXFRMLA_11,
                   CDFILE.CD_CT_INSTAXAMT_11,
                   CDFILE.CD_CT_INSTAXFRMLA_12,
                   CDFILE.CD_CT_INSTAXAMT_12,
                   CDFILE.CD_CT_BOTH_TAX_FG,
                   CDFILE.CD_CY_INSTAXFRMLA_1,
                   CDFILE.CD_CY_INSTAXAMT_1,
                   CDFILE.CD_CY_INSTAXFRMLA_2,
                   CDFILE.CD_CY_INSTAXAMT_2,
                   CDFILE.CD_CY_INSTAXFRMLA_3,
                   CDFILE.CD_CY_INSTAXAMT_3,
                   CDFILE.CD_CY_INSTAXFRMLA_4,
                   CDFILE.CD_CY_INSTAXAMT_4,
                   CDFILE.CD_CY_INSTAXFRMLA_5,
                   CDFILE.CD_CY_INSTAXAMT_5,
                   CDFILE.CD_CY_INSTAXFRMLA_6,
                   CDFILE.CD_CY_INSTAXAMT_6,
                   CDFILE.CD_CY_INSTAXFRMLA_7,
                   CDFILE.CD_CY_INSTAXAMT_7,
                   CDFILE.CD_CY_INSTAXFRMLA_8,
                   CDFILE.CD_CY_INSTAXAMT_8,
                   CDFILE.CD_CY_INSTAXFRMLA_9,
                   CDFILE.CD_CY_INSTAXAMT_9,
                   CDFILE.CD_CY_INSTAXFRMLA_10,
                   CDFILE.CD_CY_INSTAXAMT_10,
                   CDFILE.CD_CY_INSTAXFRMLA_11,
                   CDFILE.CD_CY_INSTAXAMT_11,
                   CDFILE.CD_CY_INSTAXFRMLA_12,
                   CDFILE.CD_CY_INSTAXAMT_12,
                   CDFILE.CD_CY_BOTH_TAX_FG,
                   CDFILE.CD_EA_CQ_FG,
                   CDFILE.CD_EA_GQ_FG,
                   CDFILE.CD_ELGRACE,
                   CDFILE.CD_ELGRACECD,
                   CDFILE.CD_ELTYPE,
                   CDFILE.CD_ELRATE,
                   CDFILE.CD_ELFRMLA,
                   CDFILE.CD_ELMINCHG,
                   CDFILE.CD_ELMAXAMT,
                   CDFILE.CD_ELDELFAC,
                   CDFILE.CD_ELYRTYPE,
                   CDFILE.CD_ELUNITPER_CD,
                   CDFILE.CD_PO_TITLE_HOLD_DAYS,
                   CDFILE.CD_RE_ACTIONCD,
                   CDFILE.CD_RE_MEMO_REQUIRED,
                   CDFILE.CD_RE_SUPERVISOR_ONLY,
                   CDFILE.CD_RE_ACTIVITY_REQUIRED,
                   CDFILE.CD_RE_RESCHEDULE_REQ,
                   CDFILE.CD_RE_RESCHEDULE_TIME,
                   CDFILE.CD_RE_WORKED_ACCOUNT,
                   CDFILE.CD_FC_FEEAMT,
                   CDFILE.CD_TC_REFNO_1,
                   CDFILE.CD_TC_REFNO_2,
                   CDFILE.CD_TC_REFNO_3,
                   CDFILE.CD_TC_REFNO_4,
                   CDFILE.CD_TC_REFNO_5,
                   CDFILE.CD_TC_REFNO_6,
                   CDFILE.CD_TC_REFNO_7,
                   CDFILE.CD_TC_REFNO_8,
                   CDFILE.CD_TC_REFNO_9,
                   CDFILE.CD_TC_REFNO_10,
                   CDFILE.CD_PS_TDR_FLAG
            FROM DBO.CDFILE
            WHERE CDFILE.CD_TYPE >= :QCD1-WBEG-TYPE
              AND CDFILE.CD_TYPE <= :QCD1-WEND-TYPE
              AND CDFILE.CD_CODE >= :QCD1-WBEG-CODE
              AND CDFILE.CD_CODE <= :QCD1-WEND-CODE
            ORDER BY CDFILE.CD_TYPE DESC,
                     CDFILE.CD_CODE DESC
           END-EXEC.

           EXEC SQL
               OPEN CD1_CURSOR_NG
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE SPACES TO QCD1-WBEG-TYPE
                          QCD1-WEND-TYPE
                          QCD1-WBEG-CODE
                          QCD1-WEND-CODE.

           MOVE STAT---GOOD TO CD1-CURSOR-NG-STAT.

      *-----------------------------------------------------------------
       READ-CD1-FILE.
           PERFORM READ-IT.
           MOVE CD-PATH-SQL TO E-FILE.
           MOVE CD1-KEY TO E-KEYX.
           INITIALIZE QCD-REC.

           MOVE CD-TYPE    TO QCD-TYPE.
           MOVE CD-CODE    TO QCD-CODE.

           EXEC SQL
            SELECT CDFILE.CD_TYPE,
                   CDFILE.CD_CODE,
                   CAST(CDFILE.CD_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   CDFILE.CD_DESC,
                   CDFILE.CD_AT_ACTIONCD,
                   CDFILE.CD_AT_MEMO_REQUIRED,
                   CDFILE.CD_AT_SUPERVISOR_ONLY,
                   CDFILE.CD_AT_RESULT_REQUIRED,
                   CDFILE.CD_BR_FILE_TYPE,
                   CDFILE.CD_BR_FILE_NAME,
                   CDFILE.CD_BR_PAYOFF_FG,
                   CDFILE.CD_BR_POST_SS_TRCD,
                   CDFILE.CD_BR_GL_BRANCH,
                   CDFILE.CD_BR_GL_ACCT,
                   CDFILE.CD_BR_ALLOT_OPTION,
                   CDFILE.CD_BR_LBOX_OPTION,
                   CDFILE.CD_BR_LC_FG,
                   CDFILE.CD_BR_OT_GL_BRANCH,
                   CDFILE.CD_BR_OT_GL_ACCT,
                   CDFILE.CD_BR_MULTIPLE_REFCDS,
                   CDFILE.CD_BR_COLLECT_LC,
                   CDFILE.CD_CO_GROUP,
                   CDFILE.CD_CO_SECURED,
                   CDFILE.CD_CO_TRW,
                   CDFILE.CD_CT_INSTAXFRMLA_1,
                   CDFILE.CD_CT_INSTAXAMT_1,
                   CDFILE.CD_CT_INSTAXFRMLA_2,
                   CDFILE.CD_CT_INSTAXAMT_2,
                   CDFILE.CD_CT_INSTAXFRMLA_3,
                   CDFILE.CD_CT_INSTAXAMT_3,
                   CDFILE.CD_CT_INSTAXFRMLA_4,
                   CDFILE.CD_CT_INSTAXAMT_4,
                   CDFILE.CD_CT_INSTAXFRMLA_5,
                   CDFILE.CD_CT_INSTAXAMT_5,
                   CDFILE.CD_CT_INSTAXFRMLA_6,
                   CDFILE.CD_CT_INSTAXAMT_6,
                   CDFILE.CD_CT_INSTAXFRMLA_7,
                   CDFILE.CD_CT_INSTAXAMT_7,
                   CDFILE.CD_CT_INSTAXFRMLA_8,
                   CDFILE.CD_CT_INSTAXAMT_8,
                   CDFILE.CD_CT_INSTAXFRMLA_9,
                   CDFILE.CD_CT_INSTAXAMT_9,
                   CDFILE.CD_CT_INSTAXFRMLA_10,
                   CDFILE.CD_CT_INSTAXAMT_10,
                   CDFILE.CD_CT_INSTAXFRMLA_11,
                   CDFILE.CD_CT_INSTAXAMT_11,
                   CDFILE.CD_CT_INSTAXFRMLA_12,
                   CDFILE.CD_CT_INSTAXAMT_12,
                   CDFILE.CD_CT_BOTH_TAX_FG,
                   CDFILE.CD_CY_INSTAXFRMLA_1,
                   CDFILE.CD_CY_INSTAXAMT_1,
                   CDFILE.CD_CY_INSTAXFRMLA_2,
                   CDFILE.CD_CY_INSTAXAMT_2,
                   CDFILE.CD_CY_INSTAXFRMLA_3,
                   CDFILE.CD_CY_INSTAXAMT_3,
                   CDFILE.CD_CY_INSTAXFRMLA_4,
                   CDFILE.CD_CY_INSTAXAMT_4,
                   CDFILE.CD_CY_INSTAXFRMLA_5,
                   CDFILE.CD_CY_INSTAXAMT_5,
                   CDFILE.CD_CY_INSTAXFRMLA_6,
                   CDFILE.CD_CY_INSTAXAMT_6,
                   CDFILE.CD_CY_INSTAXFRMLA_7,
                   CDFILE.CD_CY_INSTAXAMT_7,
                   CDFILE.CD_CY_INSTAXFRMLA_8,
                   CDFILE.CD_CY_INSTAXAMT_8,
                   CDFILE.CD_CY_INSTAXFRMLA_9,
                   CDFILE.CD_CY_INSTAXAMT_9,
                   CDFILE.CD_CY_INSTAXFRMLA_10,
                   CDFILE.CD_CY_INSTAXAMT_10,
                   CDFILE.CD_CY_INSTAXFRMLA_11,
                   CDFILE.CD_CY_INSTAXAMT_11,
                   CDFILE.CD_CY_INSTAXFRMLA_12,
                   CDFILE.CD_CY_INSTAXAMT_12,
                   CDFILE.CD_CY_BOTH_TAX_FG,
                   CDFILE.CD_EA_CQ_FG,
                   CDFILE.CD_EA_GQ_FG,
                   CDFILE.CD_ELGRACE,
                   CDFILE.CD_ELGRACECD,
                   CDFILE.CD_ELTYPE,
                   CDFILE.CD_ELRATE,
                   CDFILE.CD_ELFRMLA,
                   CDFILE.CD_ELMINCHG,
                   CDFILE.CD_ELMAXAMT,
                   CDFILE.CD_ELDELFAC,
                   CDFILE.CD_ELYRTYPE,
                   CDFILE.CD_ELUNITPER_CD,
                   CDFILE.CD_PO_TITLE_HOLD_DAYS,
                   CDFILE.CD_RE_ACTIONCD,
                   CDFILE.CD_RE_MEMO_REQUIRED,
                   CDFILE.CD_RE_SUPERVISOR_ONLY,
                   CDFILE.CD_RE_ACTIVITY_REQUIRED,
                   CDFILE.CD_RE_RESCHEDULE_REQ,
                   CDFILE.CD_RE_RESCHEDULE_TIME,
                   CDFILE.CD_RE_WORKED_ACCOUNT,
                   CDFILE.CD_FC_FEEAMT,
                   CDFILE.CD_TC_REFNO_1,
                   CDFILE.CD_TC_REFNO_2,
                   CDFILE.CD_TC_REFNO_3,
                   CDFILE.CD_TC_REFNO_4,
                   CDFILE.CD_TC_REFNO_5,
                   CDFILE.CD_TC_REFNO_6,
                   CDFILE.CD_TC_REFNO_7,
                   CDFILE.CD_TC_REFNO_8,
                   CDFILE.CD_TC_REFNO_9,
                   CDFILE.CD_TC_REFNO_10,
                   CDFILE.CD_PS_TDR_FLAG
            INTO :QCD-REC
            FROM DBO.CDFILE
            WHERE CDFILE.CD_TYPE = :QCD-TYPE
              AND CDFILE.CD_CODE = :QCD-CODE
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CD1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-CD-FIELDS.

      *-----------------------------------------------------------------
       READ-CD1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE CD-PATH-SQL TO E-FILE.
           MOVE CD1-KEY TO E-KEYX.
           INITIALIZE QCD-REC.

           IF ( CD1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH CD1_CURSOR INTO :QCD-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CD1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-CD-FIELDS.

      *-----------------------------------------------------------------
       READ-CD1-FILE-PREVIOUS.
           PERFORM READ-IT.
           MOVE CD-PATH-SQL TO E-FILE.
           MOVE CD1-KEY TO E-KEYX.
           INITIALIZE QCD-REC.

           IF ( CD1-CURSOR-NG-STAT-GOOD )
              EXEC SQL
                   FETCH CD1_CURSOR_NG INTO :QCD-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDPVCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CD1-FILE-PREVIOUS.

           IF ( IO-FG = 0 )
              PERFORM GET-CD-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-CD1-FILE.
           PERFORM CLOSE-IT.
           IF ( CD1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE CD1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO CD1-CURSOR-STAT.

           IF ( CD1-CURSOR-NG-STAT-GOOD )
              EXEC SQL
                   CLOSE CD1_CURSOR_NG
              END-EXEC
              MOVE STAT---BAD TO CD1-CURSOR-NG-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPCD1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLN1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLN1RN
      * REV:
      * JKC 2024-0404 ADDED LN-LOS-APP-ID
      ******************************************************************
       LOAD-LN1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LN-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LN-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LN-ALL-BASE
              MOVE FILPATH-MACHINE         TO LN-ALL-MACHINE
              MOVE FILPATH-DATA            TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH.

      *-----------------------------------------------------------------
       OPEN-LN1-FILE.
           PERFORM LOAD-LN1-FILE.
           PERFORM OPEN-IT.
           MOVE LN-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-LN1-FILE.
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.

           IF ( LN1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LN1-FILE.

           IF ( QLN1-WEND-OWNBR = ZEROES    ) OR
              ( QLN1-WEND-OWNBR NOT NUMERIC )
              MOVE LN-OWNBR             TO QLN1-WBEG-OWNBR
              MOVE LN-OWNBR             TO QLN1-WEND-OWNBR
              MOVE LN-ACCTNO            TO QLN1-WBEG-ACCTNO
              MOVE ALL "9"              TO QLN1-WEND-ACCTNO.

           EXEC SQL
            DECLARE LN1_CURSOR CURSOR FOR
            SELECT LNFILE.LN_OWNBR,
                   LNFILE.LN_ACCTNO,
                   LNFILE.LN_CLASS,
                   LNFILE.LN_SUBCLASS,
                   LNFILE.LN_LAWCODE,
                   LNFILE.LN_SSNO1,
                   LNFILE.LN_MAKERCD1,
                   LNFILE.LN_SSNO2,
                   LNFILE.LN_MAKERCD2,
                   LNFILE.LN_SSNO3,
                   LNFILE.LN_MAKERCD3,
                   LNFILE.LN_SSNO4,
                   LNFILE.LN_MAKERCD4,
                   LNFILE.LN_ORGST,
                   LNFILE.LN_ORGBR,
                   LNFILE.LN_OWNST,
                   LNFILE.LN_SPRCLASS,
                   LNFILE.LN_CONVERCD,
                   LNFILE.LN_MIDSTREAM,
                   LNFILE.LN_PURCD,
                   LNFILE.LN_SRCD,
                   LNFILE.LN_COLLCD,
                   LNFILE.LN_COLLID,
                   LNFILE.LN_POCD,
                   LNFILE.LN_PLCD,
                   LNFILE.LN_PLTYPE,
                   LNFILE.LN_CONFIDENTCD,
                   LNFILE.LN_ALLOTCD,
                   LNFILE.LN_RECASTCD,
                   LNFILE.LN_SKIP_TRW,
                   LNFILE.LN_STATUSFG,
                   LNFILE.LN_SMALLOAN,
                   LNFILE.LN_SALEFIN,
                   LNFILE.LN_SERVACCT,
                   LNFILE.LN_LOANTYPE,
                   LNFILE.LN_ADDON_FG,
                   LNFILE.LN_PAY_SCHLD_FG,
                   LNFILE.LN_LC_CODE,
                   LNFILE.LN_CAN_LOAN_NO,
                   LNFILE.LN_STATFLAGS,
                   CAST(LNFILE.LN_ENTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_LOANDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PURDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_CASHDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_FILEDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_RESCISSION_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PART_RECOURSE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_JDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PLDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PL_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ACCELDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDUDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_POFFDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PO_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LEGALDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPTDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISMISS_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DEBTAIDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REPODATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDEEMDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_SOLDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INS_CONFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_TRW_DOFD_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_PYPA_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BT_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_METRO2_LAST_PMT_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_FOLLOWUP_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_ACCRUAL_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APRATE,
                   LNFILE.LN_EFFRATE,
                   LNFILE.LN_SMPRATE,
                   LNFILE.LN_YLDRATE,
                   LNFILE.LN_OVRDRATE,
                   LNFILE.LN_ENDORATE,
                   LNFILE.LN_JDRATE,
                   LNFILE.LN_ACCRATE,
                   LNFILE.LN_REDURATE,
                   LNFILE.LN_CONRATE,
                   LNFILE.LN_SERVPER,
                   LNFILE.LN_SELLPR,
                   LNFILE.LN_DOWNPY,
                   LNFILE.LN_TRADEIN,
                   LNFILE.LN_LNAMT,
                   LNFILE.LN_FINCHG,
                   LNFILE.LN_INTCHG,
                   LNFILE.LN_SERCHG,
                   LNFILE.LN_EXTCHG,
                   LNFILE.LN_MAINTFEE,
                   LNFILE.LN_POINTS,
                   LNFILE.LN_PROCEEDS,
                   LNFILE.LN_ORGTERM,
                   LNFILE.LN_1STPYAMT,
                   LNFILE.LN_NOREGPY,
                   LNFILE.LN_REGPYAMT,
                   LNFILE.LN_LASTPYAMT,
                   LNFILE.LN_PROCASH,
                   LNFILE.LN_TILLNO,
                   LNFILE.LN_STATE_FLAG,
                   LNFILE.LN_STATE_WORKER,
                   LNFILE.LN_STATE_WORKER2,
                   LNFILE.LN_FEECODE_1,
                   LNFILE.LN_FEEAMT_1,
                   LNFILE.LN_FEEOURS_1,
                   LNFILE.LN_FEEFINCHG_1,
                   LNFILE.LN_FEECODE_2,
                   LNFILE.LN_FEEAMT_2,
                   LNFILE.LN_FEEOURS_2,
                   LNFILE.LN_FEEFINCHG_2,
                   LNFILE.LN_FEECODE_3,
                   LNFILE.LN_FEEAMT_3,
                   LNFILE.LN_FEEOURS_3,
                   LNFILE.LN_FEEFINCHG_3,
                   LNFILE.LN_FEECODE_4,
                   LNFILE.LN_FEEAMT_4,
                   LNFILE.LN_FEEOURS_4,
                   LNFILE.LN_FEEFINCHG_4,
                   LNFILE.LN_FEECODE_5,
                   LNFILE.LN_FEEAMT_5,
                   LNFILE.LN_FEEOURS_5,
                   LNFILE.LN_FEEFINCHG_5,
                   LNFILE.LN_FEECODE_6,
                   LNFILE.LN_FEEAMT_6,
                   LNFILE.LN_FEEOURS_6,
                   LNFILE.LN_FEEFINCHG_6,
                   LNFILE.LN_FEECODE_7,
                   LNFILE.LN_FEEAMT_7,
                   LNFILE.LN_FEEOURS_7,
                   LNFILE.LN_FEEFINCHG_7,
                   LNFILE.LN_FEECODE_8,
                   LNFILE.LN_FEEAMT_8,
                   LNFILE.LN_FEEOURS_8,
                   LNFILE.LN_FEEFINCHG_8,
                   LNFILE.LN_FEECODE_9,
                   LNFILE.LN_FEEAMT_9,
                   LNFILE.LN_FEEOURS_9,
                   LNFILE.LN_FEEFINCHG_9,
                   LNFILE.LN_FEECODE_10,
                   LNFILE.LN_FEEAMT_10,
                   LNFILE.LN_FEEOURS_10,
                   LNFILE.LN_FEEFINCHG_10,
                   LNFILE.LN_FEECODE_11,
                   LNFILE.LN_FEEAMT_11,
                   LNFILE.LN_FEEOURS_11,
                   LNFILE.LN_FEEFINCHG_11,
                   LNFILE.LN_FEECODE_12,
                   LNFILE.LN_FEEAMT_12,
                   LNFILE.LN_FEEOURS_12,
                   LNFILE.LN_FEEFINCHG_12,
                   LNFILE.LN_FEECODE_13,
                   LNFILE.LN_FEEAMT_13,
                   LNFILE.LN_FEEOURS_13,
                   LNFILE.LN_FEEFINCHG_13,
                   LNFILE.LN_FEECODE_14,
                   LNFILE.LN_FEEAMT_14,
                   LNFILE.LN_FEEOURS_14,
                   LNFILE.LN_FEEFINCHG_14,
                   LNFILE.LN_FEECODE_15,
                   LNFILE.LN_FEEAMT_15,
                   LNFILE.LN_FEEOURS_15,
                   LNFILE.LN_FEEFINCHG_15,
                   LNFILE.LN_FEECODE_16,
                   LNFILE.LN_FEEAMT_16,
                   LNFILE.LN_FEEOURS_16,
                   LNFILE.LN_FEEFINCHG_16,
                   LNFILE.LN_FEECODE_17,
                   LNFILE.LN_FEEAMT_17,
                   LNFILE.LN_FEEOURS_17,
                   LNFILE.LN_FEEFINCHG_17,
                   LNFILE.LN_FEECODE_18,
                   LNFILE.LN_FEEAMT_18,
                   LNFILE.LN_FEEOURS_18,
                   LNFILE.LN_FEEFINCHG_18,
                   LNFILE.LN_FEECODE_19,
                   LNFILE.LN_FEEAMT_19,
                   LNFILE.LN_FEEOURS_19,
                   LNFILE.LN_FEEFINCHG_19,
                   LNFILE.LN_FEECODE_20,
                   LNFILE.LN_FEEAMT_20,
                   LNFILE.LN_FEEOURS_20,
                   LNFILE.LN_FEEFINCHG_20,
                   LNFILE.LN_INSURED,
                   LNFILE.LN_INSTYPES,
                   LNFILE.LN_INSELIGIBLE,
                   LNFILE.LN_INSCOMP_1,
                   LNFILE.LN_INSOURS_1,
                   CAST(LNFILE.LN_INSEFF_DATE_1
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_1
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_1,
                   LNFILE.LN_INSCOVR_1,
                   LNFILE.LN_INSCOMM_1,
                   LNFILE.LN_INSANTICERN_1,
                   LNFILE.LN_INSANTICADJ_1,
                   LNFILE.LN_INSUFERN_1,
                   LNFILE.LN_INSACCERN_1,
                   LNFILE.LN_INSEARN_ORDER_1,
                   LNFILE.LN_INSFINCHG_1,
                   LNFILE.LN_INSCOMP_2,
                   LNFILE.LN_INSOURS_2,
                   CAST(LNFILE.LN_INSEFF_DATE_2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_2
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_2,
                   LNFILE.LN_INSCOVR_2,
                   LNFILE.LN_INSCOMM_2,
                   LNFILE.LN_INSANTICERN_2,
                   LNFILE.LN_INSANTICADJ_2,
                   LNFILE.LN_INSUFERN_2,
                   LNFILE.LN_INSACCERN_2,
                   LNFILE.LN_INSEARN_ORDER_2,
                   LNFILE.LN_INSFINCHG_2,
                   LNFILE.LN_INSCOMP_3,
                   LNFILE.LN_INSOURS_3,
                   CAST(LNFILE.LN_INSEFF_DATE_3
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_3
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_3,
                   LNFILE.LN_INSCOVR_3,
                   LNFILE.LN_INSCOMM_3,
                   LNFILE.LN_INSANTICERN_3,
                   LNFILE.LN_INSANTICADJ_3,
                   LNFILE.LN_INSUFERN_3,
                   LNFILE.LN_INSACCERN_3,
                   LNFILE.LN_INSEARN_ORDER_3,
                   LNFILE.LN_INSFINCHG_3,
                   LNFILE.LN_INSCOMP_4,
                   LNFILE.LN_INSOURS_4,
                   CAST(LNFILE.LN_INSEFF_DATE_4
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_4
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_4,
                   LNFILE.LN_INSCOVR_4,
                   LNFILE.LN_INSCOMM_4,
                   LNFILE.LN_INSANTICERN_4,
                   LNFILE.LN_INSANTICADJ_4,
                   LNFILE.LN_INSUFERN_4,
                   LNFILE.LN_INSACCERN_4,
                   LNFILE.LN_INSEARN_ORDER_4,
                   LNFILE.LN_INSFINCHG_4,
                   LNFILE.LN_INSCOMP_5,
                   LNFILE.LN_INSOURS_5,
                   CAST(LNFILE.LN_INSEFF_DATE_5
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_5
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_5,
                   LNFILE.LN_INSCOVR_5,
                   LNFILE.LN_INSCOMM_5,
                   LNFILE.LN_INSANTICERN_5,
                   LNFILE.LN_INSANTICADJ_5,
                   LNFILE.LN_INSUFERN_5,
                   LNFILE.LN_INSACCERN_5,
                   LNFILE.LN_INSEARN_ORDER_5,
                   LNFILE.LN_INSFINCHG_5,
                   LNFILE.LN_INSCOMP_6,
                   LNFILE.LN_INSOURS_6,
                   CAST(LNFILE.LN_INSEFF_DATE_6
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_6
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_6,
                   LNFILE.LN_INSCOVR_6,
                   LNFILE.LN_INSCOMM_6,
                   LNFILE.LN_INSANTICERN_6,
                   LNFILE.LN_INSANTICADJ_6,
                   LNFILE.LN_INSUFERN_6,
                   LNFILE.LN_INSACCERN_6,
                   LNFILE.LN_INSEARN_ORDER_6,
                   LNFILE.LN_INSFINCHG_6,
                   LNFILE.LN_INSCOMP_7,
                   LNFILE.LN_INSOURS_7,
                   CAST(LNFILE.LN_INSEFF_DATE_7
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_7
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_7,
                   LNFILE.LN_INSCOVR_7,
                   LNFILE.LN_INSCOMM_7,
                   LNFILE.LN_INSANTICERN_7,
                   LNFILE.LN_INSANTICADJ_7,
                   LNFILE.LN_INSUFERN_7,
                   LNFILE.LN_INSACCERN_7,
                   LNFILE.LN_INSEARN_ORDER_7,
                   LNFILE.LN_INSFINCHG_7,
                   LNFILE.LN_INSCOMP_8,
                   LNFILE.LN_INSOURS_8,
                   CAST(LNFILE.LN_INSEFF_DATE_8
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_8
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_8,
                   LNFILE.LN_INSCOVR_8,
                   LNFILE.LN_INSCOMM_8,
                   LNFILE.LN_INSANTICERN_8,
                   LNFILE.LN_INSANTICADJ_8,
                   LNFILE.LN_INSUFERN_8,
                   LNFILE.LN_INSACCERN_8,
                   LNFILE.LN_INSEARN_ORDER_8,
                   LNFILE.LN_INSFINCHG_8,
                   LNFILE.LN_INSCOMP_9,
                   LNFILE.LN_INSOURS_9,
                   CAST(LNFILE.LN_INSEFF_DATE_9
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_9
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_9,
                   LNFILE.LN_INSCOVR_9,
                   LNFILE.LN_INSCOMM_9,
                   LNFILE.LN_INSANTICERN_9,
                   LNFILE.LN_INSANTICADJ_9,
                   LNFILE.LN_INSUFERN_9,
                   LNFILE.LN_INSACCERN_9,
                   LNFILE.LN_INSEARN_ORDER_9,
                   LNFILE.LN_INSFINCHG_9,
                   LNFILE.LN_INSCOMP_10,
                   LNFILE.LN_INSOURS_10,
                   CAST(LNFILE.LN_INSEFF_DATE_10
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_10
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_10,
                   LNFILE.LN_INSCOVR_10,
                   LNFILE.LN_INSCOMM_10,
                   LNFILE.LN_INSANTICERN_10,
                   LNFILE.LN_INSANTICADJ_10,
                   LNFILE.LN_INSUFERN_10,
                   LNFILE.LN_INSACCERN_10,
                   LNFILE.LN_INSEARN_ORDER_10,
                   LNFILE.LN_INSFINCHG_10,
                   LNFILE.LN_PY_YYYYMM_RECDEL,
                   LNFILE.LN_MTD_PAYS_RECDEL,
                   LNFILE.LN_GARNISH_EXTR,
                   LNFILE.LN_SHIP_SAME_FG,
                   LNFILE.LN_AD_D_INS_COVR,
                   LNFILE.LN_TOT_PARTIAL_CHGOFF,
                   LNFILE.LN_LPO,
                   LNFILE.LN_REP_CD,
                   LNFILE.LN_EMP_ID,
                   LNFILE.LN_PROCESS_CD,
                   LNFILE.LN_WCBC_CREDITLIM,
                   LNFILE.LN_FOLLOWUP_CD,
                   LNFILE.LN_MIP_FG,
                   LNFILE.LN_MIP_MTD_CLAHPAID,
                   CAST(LNFILE.LN_MIP_CLPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_CLPAID,
                   CAST(LNFILE.LN_MIP_AHPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_AHPAID,
                   LNFILE.LN_IL_GROSS_INCOME,
                   LNFILE.LN_IL_GROSS_INCOME2,
                   LNFILE.LN_RESCISSION,
                   LNFILE.LN_INTERIM_TRW,
                   LNFILE.LN_DLNO,
                   LNFILE.LN_DLPOOL,
                   LNFILE.LN_DLRECOURSE,
                   LNFILE.LN_DLPARTRCAMT,
                   LNFILE.LN_ORIGPURAMT,
                   LNFILE.LN_PURBAL,
                   LNFILE.LN_DLRVPRIN_1,
                   LNFILE.LN_DLRVPRIN_2,
                   LNFILE.LN_DLRVPRIN_3,
                   LNFILE.LN_DLRVCHGS_1,
                   LNFILE.LN_DLRVCHGS_2,
                   LNFILE.LN_DLRVCHGS_3,
                   LNFILE.LN_DLPARVHELD,
                   LNFILE.LN_DLPARVPAID,
                   LNFILE.LN_DLDISC,
                   CAST(LNFILE.LN_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_CURBAL,
                   LNFILE.LN_INTBAL,
                   LNFILE.LN_LCBAL,
                   LNFILE.LN_OTHBAL,
                   LNFILE.LN_OT2BAL,
                   LNFILE.LN_LCPAID,
                   LNFILE.LN_LCPARTIALS,
                   LNFILE.LN_STMT_COUNTER,
                   LNFILE.LN_PRIOR_STMT_COUNTER,
                   LNFILE.LN_FROZEN_REASON,
                   LNFILE.LN_COUPON_STATEMENT,
                   LNFILE.LN_MONTHEND_BAL,
                   LNFILE.LN_ANTICTERM,
                   LNFILE.LN_ANTICERN_1,
                   LNFILE.LN_ANTICADJ_1,
                   LNFILE.LN_UFERN_1,
                   LNFILE.LN_ACCERN_1,
                   LNFILE.LN_EARN_ORDER_1,
                   LNFILE.LN_ANTICERN_2,
                   LNFILE.LN_ANTICADJ_2,
                   LNFILE.LN_UFERN_2,
                   LNFILE.LN_ACCERN_2,
                   LNFILE.LN_EARN_ORDER_2,
                   LNFILE.LN_ANTICERN_3,
                   LNFILE.LN_ANTICADJ_3,
                   LNFILE.LN_UFERN_3,
                   LNFILE.LN_ACCERN_3,
                   LNFILE.LN_EARN_ORDER_3,
                   LNFILE.LN_ANTICERN_4,
                   LNFILE.LN_ANTICADJ_4,
                   LNFILE.LN_UFERN_4,
                   LNFILE.LN_ACCERN_4,
                   LNFILE.LN_EARN_ORDER_4,
                   LNFILE.LN_ANTICERN_5,
                   LNFILE.LN_ANTICADJ_5,
                   LNFILE.LN_UFERN_5,
                   LNFILE.LN_ACCERN_5,
                   LNFILE.LN_EARN_ORDER_5,
                   LNFILE.LN_ANTICERN_6,
                   LNFILE.LN_ANTICADJ_6,
                   LNFILE.LN_UFERN_6,
                   LNFILE.LN_ACCERN_6,
                   LNFILE.LN_EARN_ORDER_6,
                   LNFILE.LN_ANTICERN_7,
                   LNFILE.LN_ANTICADJ_7,
                   LNFILE.LN_UFERN_7,
                   LNFILE.LN_ACCERN_7,
                   LNFILE.LN_EARN_ORDER_7,
                   LNFILE.LN_ANTICERN_8,
                   LNFILE.LN_ANTICADJ_8,
                   LNFILE.LN_UFERN_8,
                   LNFILE.LN_ACCERN_8,
                   LNFILE.LN_EARN_ORDER_8,
                   LNFILE.LN_ANTICERN_9,
                   LNFILE.LN_ANTICADJ_9,
                   LNFILE.LN_UFERN_9,
                   LNFILE.LN_ACCERN_9,
                   LNFILE.LN_EARN_ORDER_9,
                   LNFILE.LN_ANTICERN_10,
                   LNFILE.LN_ANTICADJ_10,
                   LNFILE.LN_UFERN_10,
                   LNFILE.LN_ACCERN_10,
                   LNFILE.LN_EARN_ORDER_10,
                   LNFILE.LN_LMO_PRIOR_INTEREST,
                   LNFILE.LN_PRIOR_UNEARNED,
                   LNFILE.LN_ERNDELQ_STOP,
                   LNFILE.LN_NONACRERN,
                   LNFILE.LN_PRIOR_NONACRERN,
                   CAST(LNFILE.LN_ERN_IB_PDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_ERN_IB_PRINBAL,
                   LNFILE.LN_ERN_IB_INTOWE,
                   LNFILE.LN_TOTERN,
                   LNFILE.LN_TOTOTH,
                   LNFILE.LN_TOTINT,
                   LNFILE.LN_TOTLCHG,
                   LNFILE.LN_TOTDEF,
                   LNFILE.LN_TOTSERACCT,
                   LNFILE.LN_LCWAIVERS,
                   LNFILE.LN_INTWAIVERS,
                   LNFILE.LN_TOTPAYMNTD,
                   LNFILE.LN_TOTEXCPAYMNTD,
                   LNFILE.LN_TOTNODEF,
                   LNFILE.LN_YTDNODEF,
                   LNFILE.LN_TOTNODEFACT,
                   LNFILE.LN_YTDNODEFACT,
                   LNFILE.LN_TOTNOALDEL,
                   LNFILE.LN_YTDNOALDEL,
                   LNFILE.LN_YTDINTPD,
                   LNFILE.LN_LYRINTPD,
                   LNFILE.LN_TOTINTPD,
                   LNFILE.LN_RECASTINT,
                   LNFILE.LN_RECASTPRIN,
                   LNFILE.LN_CL_REBATE,
                   LNFILE.LN_AH_REBATE,
                   LNFILE.LN_PP_REBATE,
                   LNFILE.LN_INT_REBATE,
                   LNFILE.LN_SC_REBATE,
                   LNFILE.LN_MF_REBATE,
                   LNFILE.LN_DF_REBATE,
                   LNFILE.LN_EX_REBATE,
                   LNFILE.LN_O1_REBATE,
                   LNFILE.LN_O2_REBATE,
                   LNFILE.LN_O3_REBATE,
                   LNFILE.LN_O4_REBATE,
                   LNFILE.LN_O5_REBATE,
                   LNFILE.LN_O6_REBATE,
                   LNFILE.LN_O7_REBATE,
                   LNFILE.LN_UN_O7_REB,
                   LNFILE.LN_UN_O8_REB,
                   LNFILE.LN_UN_O9_REB,
                   LNFILE.LN_UN_O10_REB,
                   LNFILE.LN_PLREASON,
                   LNFILE.LN_COLLECTOR,
                   LNFILE.LN_ACTIONCD,
                   LNFILE.LN_ACTIONCD2,
                   LNFILE.LN_ATCODE,
                   LNFILE.LN_RECODE,
                   LNFILE.LN_ESCROW_FG,
                   LNFILE.LN_PROMDAYS_PASTDUE,
                   LNFILE.LN_PROMID,
                   CAST(LNFILE.LN_PROMDATE AS VARCHAR(10)),
                   LNFILE.LN_PROMAMT,
                   CAST(LNFILE.LN_PROMDATE2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DATE_PAID_LAST
                                                  AS VARCHAR(10)),
                   LNFILE.LN_AMT_PAID_LAST,
                   LNFILE.LN_LASTCFORMNO,
                   CAST(LNFILE.LN_LASTCFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_DELCNT,
                   LNFILE.LN_DELCNT2,
                   LNFILE.LN_CREDITLIM,
                   LNFILE.LN_CRSCORE,
                   LNFILE.LN_LASTSFORMNO,
                   CAST(LNFILE.LN_LASTSFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_SOLCNT,
                   LNFILE.LN_MESSAGE,
                   LNFILE.LN_OLDACCTNO,
                   LNFILE.LN_PRLNNO,
                   LNFILE.LN_PRBAL,
                   LNFILE.LN_PRINTDUE,
                   LNFILE.LN_PRFINCHGRB,
                   LNFILE.LN_PRINSRB,
                   LNFILE.LN_PRPOCD,
                   CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)),
                   LNFILE.LN_PRDELINQAMT,
                   LNFILE.LN_PRLNAMT,
                   LNFILE.LN_PRPDUE_DAYS,
                   LNFILE.LN_PRDLDISC_UNEARN,
                   LNFILE.LN_PRCONPROFILE,
                   LNFILE.LN_SUM_ORIGPURAMT,
                   LNFILE.LN_SUM_LNAMT,
                   LNFILE.LN_SUM_FINCHG,
                   LNFILE.LN_SUM_INTCHG,
                   LNFILE.LN_SUM_ORGTERM,
                   LNFILE.LN_SUM_REGPYAMT,
                   LNFILE.LN_SUM_EXTCHG,
                   LNFILE.LN_SUM_SERCHG,
                   LNFILE.LN_SUM_MAINTFEE,
                   LNFILE.LN_UNITPER_CD,
                   LNFILE.LN_UNITPER_FREQ,
                   LNFILE.LN_DAYS_IN_UNITPER,
                   LNFILE.LN_UNITPER_PER_YEAR,
                   LNFILE.LN_REPOCD,
                   LNFILE.LN_BR_TFR_FG,
                   LNFILE.LN_O3INS_DLPROC,
                   LNFILE.LN_INSPREM_DLADJ,
                   LNFILE.LN_PLAMT,
                   LNFILE.LN_MTD_PRIN,
                   LNFILE.LN_MTD_LC,
                   LNFILE.LN_MTD_INT,
                   LNFILE.LN_MTD_OT,
                   LNFILE.LN_MTD_EX,
                   LNFILE.LN_BNKRPT_CHAPTER,
                   LNFILE.LN_BMO_CON_STATUS,
                   LNFILE.LN_BMO_REC_STATUS,
                   LNFILE.LN_APP_NUMBER,
                   LNFILE.LN_GIFTNET,
                   LNFILE.LN_GIFTNET_OUR_PO,
                   LNFILE.LN_PROC_DISBURSED,
                   LNFILE.LN_NOODDPY,
                   LNFILE.LN_CONPROFILE_1,
                   LNFILE.LN_CONPROFILE_2,
                   LNFILE.LN_CONPROFILE_3,
                   LNFILE.LN_CONPROFILE_4,
                   LNFILE.LN_CONPROFILE_5,
                   LNFILE.LN_RECPROFILE_1,
                   LNFILE.LN_RECPROFILE_2,
                   LNFILE.LN_RECPROFILE_3,
                   LNFILE.LN_RECPROFILE_4,
                   LNFILE.LN_RECPROFILE_5,
                   LNFILE.LN_TRW_STATUS,
                   LNFILE.LN_ORIGIN,
                   LNFILE.LN_PO_TRCD,
                   LNFILE.LN_NEXIS_CRSCORE,
                   LNFILE.LN_TRW_B_CONSUMER_IND,
                   LNFILE.LN_PARVHELD_PAID_FG,
                   LNFILE.LN_ACCT_FROZEN,
                   LNFILE.LN_TRW_SPECIAL_CODE,
                   LNFILE.LN_CREATION_STATUS,
                   LNFILE.LN_TOTNOLCHG,
                   LNFILE.LN_LBOX,
                   LNFILE.LN_EXTRA_PRIN_LFP,
                   LNFILE.LN_REMAIN_INT_SINCE_LFP,
                   LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
                   LNFILE.LN_INTERIM_COUPON,
                   LNFILE.LN_DLCOMM_O3_CMSI,
                   LNFILE.LN_DLCOMM_PP_CMSI,
                   LNFILE.LN_TRW_J_CONSUMER_IND,
                   LNFILE.LN_ACH,
                   LNFILE.LN_1099_C_FG,
                   LNFILE.LN_TRW_COMPLIANCE_CODE,
                   LNFILE.LN_UNWIND_REASON_CODE,
                   LNFILE.LN_PBI_PBD_FG,
                   LNFILE.LN_OLD_ACCT_FORMAT_FG,
                   LNFILE.LN_APPROVED_BY_USER,
                   LNFILE.LN_APPROVED_BY_CODE,
                   CAST(LNFILE.LN_APPROVED_BY_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APPROVED_BY_TIME,
                   CAST(LNFILE.LN_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_LTOUCH_TIME,
                   LNFILE.LN_LOS_APP_ID
            FROM DBO.LNFILE
            WHERE LNFILE.LN_OWNBR   = :QLN1-WBEG-OWNBR
              AND LNFILE.LN_ACCTNO >= :QLN1-WBEG-ACCTNO
              AND LNFILE.LN_ACCTNO <= :QLN1-WEND-ACCTNO 
            ORDER BY LNFILE.LN_OWNBR,
                     LNFILE.LN_ACCTNO
           END-EXEC.

           EXEC SQL
               OPEN LN1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLN1-WBEG-OWNBR
                          QLN1-WEND-OWNBR
                          QLN1-WBEG-ACCTNO
                          QLN1-WEND-ACCTNO.

           MOVE STAT---GOOD TO LN1-CURSOR-STAT.

      *-----------------------------------------------------------------
       START-LN1-FILE-GREATER.
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.

           IF ( LN1-CURSOR-GR-STAT-GOOD )
              PERFORM CLOSE-LN1-FILE.

           IF ( QLN1-WEND-OWNBR = ZEROES    ) OR
              ( QLN1-WEND-OWNBR NOT NUMERIC )
              MOVE LN-OWNBR             TO QLN1-WBEG-OWNBR
              MOVE LN-OWNBR             TO QLN1-WEND-OWNBR
              MOVE LN-ACCTNO            TO QLN1-WBEG-ACCTNO
              MOVE ALL "9"              TO QLN1-WEND-ACCTNO.

           EXEC SQL
            DECLARE LN1_CURSOR_GR CURSOR FOR
            SELECT LNFILE.LN_OWNBR,
                   LNFILE.LN_ACCTNO,
                   LNFILE.LN_CLASS,
                   LNFILE.LN_SUBCLASS,
                   LNFILE.LN_LAWCODE,
                   LNFILE.LN_SSNO1,
                   LNFILE.LN_MAKERCD1,
                   LNFILE.LN_SSNO2,
                   LNFILE.LN_MAKERCD2,
                   LNFILE.LN_SSNO3,
                   LNFILE.LN_MAKERCD3,
                   LNFILE.LN_SSNO4,
                   LNFILE.LN_MAKERCD4,
                   LNFILE.LN_ORGST,
                   LNFILE.LN_ORGBR,
                   LNFILE.LN_OWNST,
                   LNFILE.LN_SPRCLASS,
                   LNFILE.LN_CONVERCD,
                   LNFILE.LN_MIDSTREAM,
                   LNFILE.LN_PURCD,
                   LNFILE.LN_SRCD,
                   LNFILE.LN_COLLCD,
                   LNFILE.LN_COLLID,
                   LNFILE.LN_POCD,
                   LNFILE.LN_PLCD,
                   LNFILE.LN_PLTYPE,
                   LNFILE.LN_CONFIDENTCD,
                   LNFILE.LN_ALLOTCD,
                   LNFILE.LN_RECASTCD,
                   LNFILE.LN_SKIP_TRW,
                   LNFILE.LN_STATUSFG,
                   LNFILE.LN_SMALLOAN,
                   LNFILE.LN_SALEFIN,
                   LNFILE.LN_SERVACCT,
                   LNFILE.LN_LOANTYPE,
                   LNFILE.LN_ADDON_FG,
                   LNFILE.LN_PAY_SCHLD_FG,
                   LNFILE.LN_LC_CODE,
                   LNFILE.LN_CAN_LOAN_NO,
                   LNFILE.LN_STATFLAGS,
                   CAST(LNFILE.LN_ENTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_LOANDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PURDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_CASHDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_FILEDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_RESCISSION_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PART_RECOURSE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_JDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PLDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PL_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ACCELDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDUDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_POFFDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PO_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LEGALDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPTDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISMISS_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DEBTAIDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REPODATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDEEMDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_SOLDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INS_CONFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_TRW_DOFD_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_PYPA_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BT_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_METRO2_LAST_PMT_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_FOLLOWUP_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_ACCRUAL_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APRATE,
                   LNFILE.LN_EFFRATE,
                   LNFILE.LN_SMPRATE,
                   LNFILE.LN_YLDRATE,
                   LNFILE.LN_OVRDRATE,
                   LNFILE.LN_ENDORATE,
                   LNFILE.LN_JDRATE,
                   LNFILE.LN_ACCRATE,
                   LNFILE.LN_REDURATE,
                   LNFILE.LN_CONRATE,
                   LNFILE.LN_SERVPER,
                   LNFILE.LN_SELLPR,
                   LNFILE.LN_DOWNPY,
                   LNFILE.LN_TRADEIN,
                   LNFILE.LN_LNAMT,
                   LNFILE.LN_FINCHG,
                   LNFILE.LN_INTCHG,
                   LNFILE.LN_SERCHG,
                   LNFILE.LN_EXTCHG,
                   LNFILE.LN_MAINTFEE,
                   LNFILE.LN_POINTS,
                   LNFILE.LN_PROCEEDS,
                   LNFILE.LN_ORGTERM,
                   LNFILE.LN_1STPYAMT,
                   LNFILE.LN_NOREGPY,
                   LNFILE.LN_REGPYAMT,
                   LNFILE.LN_LASTPYAMT,
                   LNFILE.LN_PROCASH,
                   LNFILE.LN_TILLNO,
                   LNFILE.LN_STATE_FLAG,
                   LNFILE.LN_STATE_WORKER,
                   LNFILE.LN_STATE_WORKER2,
                   LNFILE.LN_FEECODE_1,
                   LNFILE.LN_FEEAMT_1,
                   LNFILE.LN_FEEOURS_1,
                   LNFILE.LN_FEEFINCHG_1,
                   LNFILE.LN_FEECODE_2,
                   LNFILE.LN_FEEAMT_2,
                   LNFILE.LN_FEEOURS_2,
                   LNFILE.LN_FEEFINCHG_2,
                   LNFILE.LN_FEECODE_3,
                   LNFILE.LN_FEEAMT_3,
                   LNFILE.LN_FEEOURS_3,
                   LNFILE.LN_FEEFINCHG_3,
                   LNFILE.LN_FEECODE_4,
                   LNFILE.LN_FEEAMT_4,
                   LNFILE.LN_FEEOURS_4,
                   LNFILE.LN_FEEFINCHG_4,
                   LNFILE.LN_FEECODE_5,
                   LNFILE.LN_FEEAMT_5,
                   LNFILE.LN_FEEOURS_5,
                   LNFILE.LN_FEEFINCHG_5,
                   LNFILE.LN_FEECODE_6,
                   LNFILE.LN_FEEAMT_6,
                   LNFILE.LN_FEEOURS_6,
                   LNFILE.LN_FEEFINCHG_6,
                   LNFILE.LN_FEECODE_7,
                   LNFILE.LN_FEEAMT_7,
                   LNFILE.LN_FEEOURS_7,
                   LNFILE.LN_FEEFINCHG_7,
                   LNFILE.LN_FEECODE_8,
                   LNFILE.LN_FEEAMT_8,
                   LNFILE.LN_FEEOURS_8,
                   LNFILE.LN_FEEFINCHG_8,
                   LNFILE.LN_FEECODE_9,
                   LNFILE.LN_FEEAMT_9,
                   LNFILE.LN_FEEOURS_9,
                   LNFILE.LN_FEEFINCHG_9,
                   LNFILE.LN_FEECODE_10,
                   LNFILE.LN_FEEAMT_10,
                   LNFILE.LN_FEEOURS_10,
                   LNFILE.LN_FEEFINCHG_10,
                   LNFILE.LN_FEECODE_11,
                   LNFILE.LN_FEEAMT_11,
                   LNFILE.LN_FEEOURS_11,
                   LNFILE.LN_FEEFINCHG_11,
                   LNFILE.LN_FEECODE_12,
                   LNFILE.LN_FEEAMT_12,
                   LNFILE.LN_FEEOURS_12,
                   LNFILE.LN_FEEFINCHG_12,
                   LNFILE.LN_FEECODE_13,
                   LNFILE.LN_FEEAMT_13,
                   LNFILE.LN_FEEOURS_13,
                   LNFILE.LN_FEEFINCHG_13,
                   LNFILE.LN_FEECODE_14,
                   LNFILE.LN_FEEAMT_14,
                   LNFILE.LN_FEEOURS_14,
                   LNFILE.LN_FEEFINCHG_14,
                   LNFILE.LN_FEECODE_15,
                   LNFILE.LN_FEEAMT_15,
                   LNFILE.LN_FEEOURS_15,
                   LNFILE.LN_FEEFINCHG_15,
                   LNFILE.LN_FEECODE_16,
                   LNFILE.LN_FEEAMT_16,
                   LNFILE.LN_FEEOURS_16,
                   LNFILE.LN_FEEFINCHG_16,
                   LNFILE.LN_FEECODE_17,
                   LNFILE.LN_FEEAMT_17,
                   LNFILE.LN_FEEOURS_17,
                   LNFILE.LN_FEEFINCHG_17,
                   LNFILE.LN_FEECODE_18,
                   LNFILE.LN_FEEAMT_18,
                   LNFILE.LN_FEEOURS_18,
                   LNFILE.LN_FEEFINCHG_18,
                   LNFILE.LN_FEECODE_19,
                   LNFILE.LN_FEEAMT_19,
                   LNFILE.LN_FEEOURS_19,
                   LNFILE.LN_FEEFINCHG_19,
                   LNFILE.LN_FEECODE_20,
                   LNFILE.LN_FEEAMT_20,
                   LNFILE.LN_FEEOURS_20,
                   LNFILE.LN_FEEFINCHG_20,
                   LNFILE.LN_INSURED,
                   LNFILE.LN_INSTYPES,
                   LNFILE.LN_INSELIGIBLE,
                   LNFILE.LN_INSCOMP_1,
                   LNFILE.LN_INSOURS_1,
                   CAST(LNFILE.LN_INSEFF_DATE_1
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_1
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_1,
                   LNFILE.LN_INSCOVR_1,
                   LNFILE.LN_INSCOMM_1,
                   LNFILE.LN_INSANTICERN_1,
                   LNFILE.LN_INSANTICADJ_1,
                   LNFILE.LN_INSUFERN_1,
                   LNFILE.LN_INSACCERN_1,
                   LNFILE.LN_INSEARN_ORDER_1,
                   LNFILE.LN_INSFINCHG_1,
                   LNFILE.LN_INSCOMP_2,
                   LNFILE.LN_INSOURS_2,
                   CAST(LNFILE.LN_INSEFF_DATE_2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_2
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_2,
                   LNFILE.LN_INSCOVR_2,
                   LNFILE.LN_INSCOMM_2,
                   LNFILE.LN_INSANTICERN_2,
                   LNFILE.LN_INSANTICADJ_2,
                   LNFILE.LN_INSUFERN_2,
                   LNFILE.LN_INSACCERN_2,
                   LNFILE.LN_INSEARN_ORDER_2,
                   LNFILE.LN_INSFINCHG_2,
                   LNFILE.LN_INSCOMP_3,
                   LNFILE.LN_INSOURS_3,
                   CAST(LNFILE.LN_INSEFF_DATE_3
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_3
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_3,
                   LNFILE.LN_INSCOVR_3,
                   LNFILE.LN_INSCOMM_3,
                   LNFILE.LN_INSANTICERN_3,
                   LNFILE.LN_INSANTICADJ_3,
                   LNFILE.LN_INSUFERN_3,
                   LNFILE.LN_INSACCERN_3,
                   LNFILE.LN_INSEARN_ORDER_3,
                   LNFILE.LN_INSFINCHG_3,
                   LNFILE.LN_INSCOMP_4,
                   LNFILE.LN_INSOURS_4,
                   CAST(LNFILE.LN_INSEFF_DATE_4
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_4
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_4,
                   LNFILE.LN_INSCOVR_4,
                   LNFILE.LN_INSCOMM_4,
                   LNFILE.LN_INSANTICERN_4,
                   LNFILE.LN_INSANTICADJ_4,
                   LNFILE.LN_INSUFERN_4,
                   LNFILE.LN_INSACCERN_4,
                   LNFILE.LN_INSEARN_ORDER_4,
                   LNFILE.LN_INSFINCHG_4,
                   LNFILE.LN_INSCOMP_5,
                   LNFILE.LN_INSOURS_5,
                   CAST(LNFILE.LN_INSEFF_DATE_5
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_5
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_5,
                   LNFILE.LN_INSCOVR_5,
                   LNFILE.LN_INSCOMM_5,
                   LNFILE.LN_INSANTICERN_5,
                   LNFILE.LN_INSANTICADJ_5,
                   LNFILE.LN_INSUFERN_5,
                   LNFILE.LN_INSACCERN_5,
                   LNFILE.LN_INSEARN_ORDER_5,
                   LNFILE.LN_INSFINCHG_5,
                   LNFILE.LN_INSCOMP_6,
                   LNFILE.LN_INSOURS_6,
                   CAST(LNFILE.LN_INSEFF_DATE_6
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_6
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_6,
                   LNFILE.LN_INSCOVR_6,
                   LNFILE.LN_INSCOMM_6,
                   LNFILE.LN_INSANTICERN_6,
                   LNFILE.LN_INSANTICADJ_6,
                   LNFILE.LN_INSUFERN_6,
                   LNFILE.LN_INSACCERN_6,
                   LNFILE.LN_INSEARN_ORDER_6,
                   LNFILE.LN_INSFINCHG_6,
                   LNFILE.LN_INSCOMP_7,
                   LNFILE.LN_INSOURS_7,
                   CAST(LNFILE.LN_INSEFF_DATE_7
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_7
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_7,
                   LNFILE.LN_INSCOVR_7,
                   LNFILE.LN_INSCOMM_7,
                   LNFILE.LN_INSANTICERN_7,
                   LNFILE.LN_INSANTICADJ_7,
                   LNFILE.LN_INSUFERN_7,
                   LNFILE.LN_INSACCERN_7,
                   LNFILE.LN_INSEARN_ORDER_7,
                   LNFILE.LN_INSFINCHG_7,
                   LNFILE.LN_INSCOMP_8,
                   LNFILE.LN_INSOURS_8,
                   CAST(LNFILE.LN_INSEFF_DATE_8
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_8
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_8,
                   LNFILE.LN_INSCOVR_8,
                   LNFILE.LN_INSCOMM_8,
                   LNFILE.LN_INSANTICERN_8,
                   LNFILE.LN_INSANTICADJ_8,
                   LNFILE.LN_INSUFERN_8,
                   LNFILE.LN_INSACCERN_8,
                   LNFILE.LN_INSEARN_ORDER_8,
                   LNFILE.LN_INSFINCHG_8,
                   LNFILE.LN_INSCOMP_9,
                   LNFILE.LN_INSOURS_9,
                   CAST(LNFILE.LN_INSEFF_DATE_9
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_9
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_9,
                   LNFILE.LN_INSCOVR_9,
                   LNFILE.LN_INSCOMM_9,
                   LNFILE.LN_INSANTICERN_9,
                   LNFILE.LN_INSANTICADJ_9,
                   LNFILE.LN_INSUFERN_9,
                   LNFILE.LN_INSACCERN_9,
                   LNFILE.LN_INSEARN_ORDER_9,
                   LNFILE.LN_INSFINCHG_9,
                   LNFILE.LN_INSCOMP_10,
                   LNFILE.LN_INSOURS_10,
                   CAST(LNFILE.LN_INSEFF_DATE_10
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_10
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_10,
                   LNFILE.LN_INSCOVR_10,
                   LNFILE.LN_INSCOMM_10,
                   LNFILE.LN_INSANTICERN_10,
                   LNFILE.LN_INSANTICADJ_10,
                   LNFILE.LN_INSUFERN_10,
                   LNFILE.LN_INSACCERN_10,
                   LNFILE.LN_INSEARN_ORDER_10,
                   LNFILE.LN_INSFINCHG_10,
                   LNFILE.LN_PY_YYYYMM_RECDEL,
                   LNFILE.LN_MTD_PAYS_RECDEL,
                   LNFILE.LN_GARNISH_EXTR,
                   LNFILE.LN_SHIP_SAME_FG,
                   LNFILE.LN_AD_D_INS_COVR,
                   LNFILE.LN_TOT_PARTIAL_CHGOFF,
                   LNFILE.LN_LPO,
                   LNFILE.LN_REP_CD,
                   LNFILE.LN_EMP_ID,
                   LNFILE.LN_PROCESS_CD,
                   LNFILE.LN_WCBC_CREDITLIM,
                   LNFILE.LN_FOLLOWUP_CD,
                   LNFILE.LN_MIP_FG,
                   LNFILE.LN_MIP_MTD_CLAHPAID,
                   CAST(LNFILE.LN_MIP_CLPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_CLPAID,
                   CAST(LNFILE.LN_MIP_AHPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_AHPAID,
                   LNFILE.LN_IL_GROSS_INCOME,
                   LNFILE.LN_IL_GROSS_INCOME2,
                   LNFILE.LN_RESCISSION,
                   LNFILE.LN_INTERIM_TRW,
                   LNFILE.LN_DLNO,
                   LNFILE.LN_DLPOOL,
                   LNFILE.LN_DLRECOURSE,
                   LNFILE.LN_DLPARTRCAMT,
                   LNFILE.LN_ORIGPURAMT,
                   LNFILE.LN_PURBAL,
                   LNFILE.LN_DLRVPRIN_1,
                   LNFILE.LN_DLRVPRIN_2,
                   LNFILE.LN_DLRVPRIN_3,
                   LNFILE.LN_DLRVCHGS_1,
                   LNFILE.LN_DLRVCHGS_2,
                   LNFILE.LN_DLRVCHGS_3,
                   LNFILE.LN_DLPARVHELD,
                   LNFILE.LN_DLPARVPAID,
                   LNFILE.LN_DLDISC,
                   CAST(LNFILE.LN_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_CURBAL,
                   LNFILE.LN_INTBAL,
                   LNFILE.LN_LCBAL,
                   LNFILE.LN_OTHBAL,
                   LNFILE.LN_OT2BAL,
                   LNFILE.LN_LCPAID,
                   LNFILE.LN_LCPARTIALS,
                   LNFILE.LN_STMT_COUNTER,
                   LNFILE.LN_PRIOR_STMT_COUNTER,
                   LNFILE.LN_FROZEN_REASON,
                   LNFILE.LN_COUPON_STATEMENT,
                   LNFILE.LN_MONTHEND_BAL,
                   LNFILE.LN_ANTICTERM,
                   LNFILE.LN_ANTICERN_1,
                   LNFILE.LN_ANTICADJ_1,
                   LNFILE.LN_UFERN_1,
                   LNFILE.LN_ACCERN_1,
                   LNFILE.LN_EARN_ORDER_1,
                   LNFILE.LN_ANTICERN_2,
                   LNFILE.LN_ANTICADJ_2,
                   LNFILE.LN_UFERN_2,
                   LNFILE.LN_ACCERN_2,
                   LNFILE.LN_EARN_ORDER_2,
                   LNFILE.LN_ANTICERN_3,
                   LNFILE.LN_ANTICADJ_3,
                   LNFILE.LN_UFERN_3,
                   LNFILE.LN_ACCERN_3,
                   LNFILE.LN_EARN_ORDER_3,
                   LNFILE.LN_ANTICERN_4,
                   LNFILE.LN_ANTICADJ_4,
                   LNFILE.LN_UFERN_4,
                   LNFILE.LN_ACCERN_4,
                   LNFILE.LN_EARN_ORDER_4,
                   LNFILE.LN_ANTICERN_5,
                   LNFILE.LN_ANTICADJ_5,
                   LNFILE.LN_UFERN_5,
                   LNFILE.LN_ACCERN_5,
                   LNFILE.LN_EARN_ORDER_5,
                   LNFILE.LN_ANTICERN_6,
                   LNFILE.LN_ANTICADJ_6,
                   LNFILE.LN_UFERN_6,
                   LNFILE.LN_ACCERN_6,
                   LNFILE.LN_EARN_ORDER_6,
                   LNFILE.LN_ANTICERN_7,
                   LNFILE.LN_ANTICADJ_7,
                   LNFILE.LN_UFERN_7,
                   LNFILE.LN_ACCERN_7,
                   LNFILE.LN_EARN_ORDER_7,
                   LNFILE.LN_ANTICERN_8,
                   LNFILE.LN_ANTICADJ_8,
                   LNFILE.LN_UFERN_8,
                   LNFILE.LN_ACCERN_8,
                   LNFILE.LN_EARN_ORDER_8,
                   LNFILE.LN_ANTICERN_9,
                   LNFILE.LN_ANTICADJ_9,
                   LNFILE.LN_UFERN_9,
                   LNFILE.LN_ACCERN_9,
                   LNFILE.LN_EARN_ORDER_9,
                   LNFILE.LN_ANTICERN_10,
                   LNFILE.LN_ANTICADJ_10,
                   LNFILE.LN_UFERN_10,
                   LNFILE.LN_ACCERN_10,
                   LNFILE.LN_EARN_ORDER_10,
                   LNFILE.LN_LMO_PRIOR_INTEREST,
                   LNFILE.LN_PRIOR_UNEARNED,
                   LNFILE.LN_ERNDELQ_STOP,
                   LNFILE.LN_NONACRERN,
                   LNFILE.LN_PRIOR_NONACRERN,
                   CAST(LNFILE.LN_ERN_IB_PDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_ERN_IB_PRINBAL,
                   LNFILE.LN_ERN_IB_INTOWE,
                   LNFILE.LN_TOTERN,
                   LNFILE.LN_TOTOTH,
                   LNFILE.LN_TOTINT,
                   LNFILE.LN_TOTLCHG,
                   LNFILE.LN_TOTDEF,
                   LNFILE.LN_TOTSERACCT,
                   LNFILE.LN_LCWAIVERS,
                   LNFILE.LN_INTWAIVERS,
                   LNFILE.LN_TOTPAYMNTD,
                   LNFILE.LN_TOTEXCPAYMNTD,
                   LNFILE.LN_TOTNODEF,
                   LNFILE.LN_YTDNODEF,
                   LNFILE.LN_TOTNODEFACT,
                   LNFILE.LN_YTDNODEFACT,
                   LNFILE.LN_TOTNOALDEL,
                   LNFILE.LN_YTDNOALDEL,
                   LNFILE.LN_YTDINTPD,
                   LNFILE.LN_LYRINTPD,
                   LNFILE.LN_TOTINTPD,
                   LNFILE.LN_RECASTINT,
                   LNFILE.LN_RECASTPRIN,
                   LNFILE.LN_CL_REBATE,
                   LNFILE.LN_AH_REBATE,
                   LNFILE.LN_PP_REBATE,
                   LNFILE.LN_INT_REBATE,
                   LNFILE.LN_SC_REBATE,
                   LNFILE.LN_MF_REBATE,
                   LNFILE.LN_DF_REBATE,
                   LNFILE.LN_EX_REBATE,
                   LNFILE.LN_O1_REBATE,
                   LNFILE.LN_O2_REBATE,
                   LNFILE.LN_O3_REBATE,
                   LNFILE.LN_O4_REBATE,
                   LNFILE.LN_O5_REBATE,
                   LNFILE.LN_O6_REBATE,
                   LNFILE.LN_O7_REBATE,
                   LNFILE.LN_UN_O7_REB,
                   LNFILE.LN_UN_O8_REB,
                   LNFILE.LN_UN_O9_REB,
                   LNFILE.LN_UN_O10_REB,
                   LNFILE.LN_PLREASON,
                   LNFILE.LN_COLLECTOR,
                   LNFILE.LN_ACTIONCD,
                   LNFILE.LN_ACTIONCD2,
                   LNFILE.LN_ATCODE,
                   LNFILE.LN_RECODE,
                   LNFILE.LN_ESCROW_FG,
                   LNFILE.LN_PROMDAYS_PASTDUE,
                   LNFILE.LN_PROMID,
                   CAST(LNFILE.LN_PROMDATE AS VARCHAR(10)),
                   LNFILE.LN_PROMAMT,
                   CAST(LNFILE.LN_PROMDATE2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DATE_PAID_LAST
                                                  AS VARCHAR(10)),
                   LNFILE.LN_AMT_PAID_LAST,
                   LNFILE.LN_LASTCFORMNO,
                   CAST(LNFILE.LN_LASTCFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_DELCNT,
                   LNFILE.LN_DELCNT2,
                   LNFILE.LN_CREDITLIM,
                   LNFILE.LN_CRSCORE,
                   LNFILE.LN_LASTSFORMNO,
                   CAST(LNFILE.LN_LASTSFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_SOLCNT,
                   LNFILE.LN_MESSAGE,
                   LNFILE.LN_OLDACCTNO,
                   LNFILE.LN_PRLNNO,
                   LNFILE.LN_PRBAL,
                   LNFILE.LN_PRINTDUE,
                   LNFILE.LN_PRFINCHGRB,
                   LNFILE.LN_PRINSRB,
                   LNFILE.LN_PRPOCD,
                   CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)),
                   LNFILE.LN_PRDELINQAMT,
                   LNFILE.LN_PRLNAMT,
                   LNFILE.LN_PRPDUE_DAYS,
                   LNFILE.LN_PRDLDISC_UNEARN,
                   LNFILE.LN_PRCONPROFILE,
                   LNFILE.LN_SUM_ORIGPURAMT,
                   LNFILE.LN_SUM_LNAMT,
                   LNFILE.LN_SUM_FINCHG,
                   LNFILE.LN_SUM_INTCHG,
                   LNFILE.LN_SUM_ORGTERM,
                   LNFILE.LN_SUM_REGPYAMT,
                   LNFILE.LN_SUM_EXTCHG,
                   LNFILE.LN_SUM_SERCHG,
                   LNFILE.LN_SUM_MAINTFEE,
                   LNFILE.LN_UNITPER_CD,
                   LNFILE.LN_UNITPER_FREQ,
                   LNFILE.LN_DAYS_IN_UNITPER,
                   LNFILE.LN_UNITPER_PER_YEAR,
                   LNFILE.LN_REPOCD,
                   LNFILE.LN_BR_TFR_FG,
                   LNFILE.LN_O3INS_DLPROC,
                   LNFILE.LN_INSPREM_DLADJ,
                   LNFILE.LN_PLAMT,
                   LNFILE.LN_MTD_PRIN,
                   LNFILE.LN_MTD_LC,
                   LNFILE.LN_MTD_INT,
                   LNFILE.LN_MTD_OT,
                   LNFILE.LN_MTD_EX,
                   LNFILE.LN_BNKRPT_CHAPTER,
                   LNFILE.LN_BMO_CON_STATUS,
                   LNFILE.LN_BMO_REC_STATUS,
                   LNFILE.LN_APP_NUMBER,
                   LNFILE.LN_GIFTNET,
                   LNFILE.LN_GIFTNET_OUR_PO,
                   LNFILE.LN_PROC_DISBURSED,
                   LNFILE.LN_NOODDPY,
                   LNFILE.LN_CONPROFILE_1,
                   LNFILE.LN_CONPROFILE_2,
                   LNFILE.LN_CONPROFILE_3,
                   LNFILE.LN_CONPROFILE_4,
                   LNFILE.LN_CONPROFILE_5,
                   LNFILE.LN_RECPROFILE_1,
                   LNFILE.LN_RECPROFILE_2,
                   LNFILE.LN_RECPROFILE_3,
                   LNFILE.LN_RECPROFILE_4,
                   LNFILE.LN_RECPROFILE_5,
                   LNFILE.LN_TRW_STATUS,
                   LNFILE.LN_ORIGIN,
                   LNFILE.LN_PO_TRCD,
                   LNFILE.LN_NEXIS_CRSCORE,
                   LNFILE.LN_TRW_B_CONSUMER_IND,
                   LNFILE.LN_PARVHELD_PAID_FG,
                   LNFILE.LN_ACCT_FROZEN,
                   LNFILE.LN_TRW_SPECIAL_CODE,
                   LNFILE.LN_CREATION_STATUS,
                   LNFILE.LN_TOTNOLCHG,
                   LNFILE.LN_LBOX,
                   LNFILE.LN_EXTRA_PRIN_LFP,
                   LNFILE.LN_REMAIN_INT_SINCE_LFP,
                   LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
                   LNFILE.LN_INTERIM_COUPON,
                   LNFILE.LN_DLCOMM_O3_CMSI,
                   LNFILE.LN_DLCOMM_PP_CMSI,
                   LNFILE.LN_TRW_J_CONSUMER_IND,
                   LNFILE.LN_ACH,
                   LNFILE.LN_1099_C_FG,
                   LNFILE.LN_TRW_COMPLIANCE_CODE,
                   LNFILE.LN_UNWIND_REASON_CODE,
                   LNFILE.LN_PBI_PBD_FG,
                   LNFILE.LN_OLD_ACCT_FORMAT_FG,
                   LNFILE.LN_APPROVED_BY_USER,
                   LNFILE.LN_APPROVED_BY_CODE,
                   CAST(LNFILE.LN_APPROVED_BY_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APPROVED_BY_TIME,
                   CAST(LNFILE.LN_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_LTOUCH_TIME,
                   LNFILE.LN_LOS_APP_ID
            FROM DBO.LNFILE
            WHERE LNFILE.LN_OWNBR   = :QLN1-WBEG-OWNBR
              AND LNFILE.LN_ACCTNO  > :QLN1-WBEG-ACCTNO
              AND LNFILE.LN_ACCTNO <= :QLN1-WEND-ACCTNO 
            ORDER BY LNFILE.LN_OWNBR,
                     LNFILE.LN_ACCTNO
           END-EXEC.

           EXEC SQL
               OPEN LN1_CURSOR_GR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLN1-WBEG-OWNBR
                          QLN1-WEND-OWNBR
                          QLN1-WBEG-ACCTNO
                          QLN1-WEND-ACCTNO.

           MOVE STAT---GOOD TO LN1-CURSOR-GR-STAT.

      *-----------------------------------------------------------------
       READ-LN1-FILE.
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.
           INITIALIZE QLN-REC.

           MOVE LN-OWNBR  TO QLN-OWNBR.
           MOVE LN-ACCTNO TO QLN-ACCTNO.

           EXEC SQL
            SELECT LNFILE.LN_OWNBR,
                   LNFILE.LN_ACCTNO,
                   LNFILE.LN_CLASS,
                   LNFILE.LN_SUBCLASS,
                   LNFILE.LN_LAWCODE,
                   LNFILE.LN_SSNO1,
                   LNFILE.LN_MAKERCD1,
                   LNFILE.LN_SSNO2,
                   LNFILE.LN_MAKERCD2,
                   LNFILE.LN_SSNO3,
                   LNFILE.LN_MAKERCD3,
                   LNFILE.LN_SSNO4,
                   LNFILE.LN_MAKERCD4,
                   LNFILE.LN_ORGST,
                   LNFILE.LN_ORGBR,
                   LNFILE.LN_OWNST,
                   LNFILE.LN_SPRCLASS,
                   LNFILE.LN_CONVERCD,
                   LNFILE.LN_MIDSTREAM,
                   LNFILE.LN_PURCD,
                   LNFILE.LN_SRCD,
                   LNFILE.LN_COLLCD,
                   LNFILE.LN_COLLID,
                   LNFILE.LN_POCD,
                   LNFILE.LN_PLCD,
                   LNFILE.LN_PLTYPE,
                   LNFILE.LN_CONFIDENTCD,
                   LNFILE.LN_ALLOTCD,
                   LNFILE.LN_RECASTCD,
                   LNFILE.LN_SKIP_TRW,
                   LNFILE.LN_STATUSFG,
                   LNFILE.LN_SMALLOAN,
                   LNFILE.LN_SALEFIN,
                   LNFILE.LN_SERVACCT,
                   LNFILE.LN_LOANTYPE,
                   LNFILE.LN_ADDON_FG,
                   LNFILE.LN_PAY_SCHLD_FG,
                   LNFILE.LN_LC_CODE,
                   LNFILE.LN_CAN_LOAN_NO,
                   LNFILE.LN_STATFLAGS,
                   CAST(LNFILE.LN_ENTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_LOANDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PURDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_CASHDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_FILEDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_RESCISSION_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PART_RECOURSE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_JDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PLDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PL_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ACCELDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDUDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_POFFDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PO_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LEGALDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPTDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISMISS_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DEBTAIDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REPODATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDEEMDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_SOLDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INS_CONFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_TRW_DOFD_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_PYPA_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BT_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_METRO2_LAST_PMT_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_FOLLOWUP_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_ACCRUAL_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APRATE,
                   LNFILE.LN_EFFRATE,
                   LNFILE.LN_SMPRATE,
                   LNFILE.LN_YLDRATE,
                   LNFILE.LN_OVRDRATE,
                   LNFILE.LN_ENDORATE,
                   LNFILE.LN_JDRATE,
                   LNFILE.LN_ACCRATE,
                   LNFILE.LN_REDURATE,
                   LNFILE.LN_CONRATE,
                   LNFILE.LN_SERVPER,
                   LNFILE.LN_SELLPR,
                   LNFILE.LN_DOWNPY,
                   LNFILE.LN_TRADEIN,
                   LNFILE.LN_LNAMT,
                   LNFILE.LN_FINCHG,
                   LNFILE.LN_INTCHG,
                   LNFILE.LN_SERCHG,
                   LNFILE.LN_EXTCHG,
                   LNFILE.LN_MAINTFEE,
                   LNFILE.LN_POINTS,
                   LNFILE.LN_PROCEEDS,
                   LNFILE.LN_ORGTERM,
                   LNFILE.LN_1STPYAMT,
                   LNFILE.LN_NOREGPY,
                   LNFILE.LN_REGPYAMT,
                   LNFILE.LN_LASTPYAMT,
                   LNFILE.LN_PROCASH,
                   LNFILE.LN_TILLNO,
                   LNFILE.LN_STATE_FLAG,
                   LNFILE.LN_STATE_WORKER,
                   LNFILE.LN_STATE_WORKER2,
                   LNFILE.LN_FEECODE_1,
                   LNFILE.LN_FEEAMT_1,
                   LNFILE.LN_FEEOURS_1,
                   LNFILE.LN_FEEFINCHG_1,
                   LNFILE.LN_FEECODE_2,
                   LNFILE.LN_FEEAMT_2,
                   LNFILE.LN_FEEOURS_2,
                   LNFILE.LN_FEEFINCHG_2,
                   LNFILE.LN_FEECODE_3,
                   LNFILE.LN_FEEAMT_3,
                   LNFILE.LN_FEEOURS_3,
                   LNFILE.LN_FEEFINCHG_3,
                   LNFILE.LN_FEECODE_4,
                   LNFILE.LN_FEEAMT_4,
                   LNFILE.LN_FEEOURS_4,
                   LNFILE.LN_FEEFINCHG_4,
                   LNFILE.LN_FEECODE_5,
                   LNFILE.LN_FEEAMT_5,
                   LNFILE.LN_FEEOURS_5,
                   LNFILE.LN_FEEFINCHG_5,
                   LNFILE.LN_FEECODE_6,
                   LNFILE.LN_FEEAMT_6,
                   LNFILE.LN_FEEOURS_6,
                   LNFILE.LN_FEEFINCHG_6,
                   LNFILE.LN_FEECODE_7,
                   LNFILE.LN_FEEAMT_7,
                   LNFILE.LN_FEEOURS_7,
                   LNFILE.LN_FEEFINCHG_7,
                   LNFILE.LN_FEECODE_8,
                   LNFILE.LN_FEEAMT_8,
                   LNFILE.LN_FEEOURS_8,
                   LNFILE.LN_FEEFINCHG_8,
                   LNFILE.LN_FEECODE_9,
                   LNFILE.LN_FEEAMT_9,
                   LNFILE.LN_FEEOURS_9,
                   LNFILE.LN_FEEFINCHG_9,
                   LNFILE.LN_FEECODE_10,
                   LNFILE.LN_FEEAMT_10,
                   LNFILE.LN_FEEOURS_10,
                   LNFILE.LN_FEEFINCHG_10,
                   LNFILE.LN_FEECODE_11,
                   LNFILE.LN_FEEAMT_11,
                   LNFILE.LN_FEEOURS_11,
                   LNFILE.LN_FEEFINCHG_11,
                   LNFILE.LN_FEECODE_12,
                   LNFILE.LN_FEEAMT_12,
                   LNFILE.LN_FEEOURS_12,
                   LNFILE.LN_FEEFINCHG_12,
                   LNFILE.LN_FEECODE_13,
                   LNFILE.LN_FEEAMT_13,
                   LNFILE.LN_FEEOURS_13,
                   LNFILE.LN_FEEFINCHG_13,
                   LNFILE.LN_FEECODE_14,
                   LNFILE.LN_FEEAMT_14,
                   LNFILE.LN_FEEOURS_14,
                   LNFILE.LN_FEEFINCHG_14,
                   LNFILE.LN_FEECODE_15,
                   LNFILE.LN_FEEAMT_15,
                   LNFILE.LN_FEEOURS_15,
                   LNFILE.LN_FEEFINCHG_15,
                   LNFILE.LN_FEECODE_16,
                   LNFILE.LN_FEEAMT_16,
                   LNFILE.LN_FEEOURS_16,
                   LNFILE.LN_FEEFINCHG_16,
                   LNFILE.LN_FEECODE_17,
                   LNFILE.LN_FEEAMT_17,
                   LNFILE.LN_FEEOURS_17,
                   LNFILE.LN_FEEFINCHG_17,
                   LNFILE.LN_FEECODE_18,
                   LNFILE.LN_FEEAMT_18,
                   LNFILE.LN_FEEOURS_18,
                   LNFILE.LN_FEEFINCHG_18,
                   LNFILE.LN_FEECODE_19,
                   LNFILE.LN_FEEAMT_19,
                   LNFILE.LN_FEEOURS_19,
                   LNFILE.LN_FEEFINCHG_19,
                   LNFILE.LN_FEECODE_20,
                   LNFILE.LN_FEEAMT_20,
                   LNFILE.LN_FEEOURS_20,
                   LNFILE.LN_FEEFINCHG_20,
                   LNFILE.LN_INSURED,
                   LNFILE.LN_INSTYPES,
                   LNFILE.LN_INSELIGIBLE,
                   LNFILE.LN_INSCOMP_1,
                   LNFILE.LN_INSOURS_1,
                   CAST(LNFILE.LN_INSEFF_DATE_1
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_1
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_1,
                   LNFILE.LN_INSCOVR_1,
                   LNFILE.LN_INSCOMM_1,
                   LNFILE.LN_INSANTICERN_1,
                   LNFILE.LN_INSANTICADJ_1,
                   LNFILE.LN_INSUFERN_1,
                   LNFILE.LN_INSACCERN_1,
                   LNFILE.LN_INSEARN_ORDER_1,
                   LNFILE.LN_INSFINCHG_1,
                   LNFILE.LN_INSCOMP_2,
                   LNFILE.LN_INSOURS_2,
                   CAST(LNFILE.LN_INSEFF_DATE_2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_2
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_2,
                   LNFILE.LN_INSCOVR_2,
                   LNFILE.LN_INSCOMM_2,
                   LNFILE.LN_INSANTICERN_2,
                   LNFILE.LN_INSANTICADJ_2,
                   LNFILE.LN_INSUFERN_2,
                   LNFILE.LN_INSACCERN_2,
                   LNFILE.LN_INSEARN_ORDER_2,
                   LNFILE.LN_INSFINCHG_2,
                   LNFILE.LN_INSCOMP_3,
                   LNFILE.LN_INSOURS_3,
                   CAST(LNFILE.LN_INSEFF_DATE_3
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_3
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_3,
                   LNFILE.LN_INSCOVR_3,
                   LNFILE.LN_INSCOMM_3,
                   LNFILE.LN_INSANTICERN_3,
                   LNFILE.LN_INSANTICADJ_3,
                   LNFILE.LN_INSUFERN_3,
                   LNFILE.LN_INSACCERN_3,
                   LNFILE.LN_INSEARN_ORDER_3,
                   LNFILE.LN_INSFINCHG_3,
                   LNFILE.LN_INSCOMP_4,
                   LNFILE.LN_INSOURS_4,
                   CAST(LNFILE.LN_INSEFF_DATE_4
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_4
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_4,
                   LNFILE.LN_INSCOVR_4,
                   LNFILE.LN_INSCOMM_4,
                   LNFILE.LN_INSANTICERN_4,
                   LNFILE.LN_INSANTICADJ_4,
                   LNFILE.LN_INSUFERN_4,
                   LNFILE.LN_INSACCERN_4,
                   LNFILE.LN_INSEARN_ORDER_4,
                   LNFILE.LN_INSFINCHG_4,
                   LNFILE.LN_INSCOMP_5,
                   LNFILE.LN_INSOURS_5,
                   CAST(LNFILE.LN_INSEFF_DATE_5
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_5
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_5,
                   LNFILE.LN_INSCOVR_5,
                   LNFILE.LN_INSCOMM_5,
                   LNFILE.LN_INSANTICERN_5,
                   LNFILE.LN_INSANTICADJ_5,
                   LNFILE.LN_INSUFERN_5,
                   LNFILE.LN_INSACCERN_5,
                   LNFILE.LN_INSEARN_ORDER_5,
                   LNFILE.LN_INSFINCHG_5,
                   LNFILE.LN_INSCOMP_6,
                   LNFILE.LN_INSOURS_6,
                   CAST(LNFILE.LN_INSEFF_DATE_6
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_6
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_6,
                   LNFILE.LN_INSCOVR_6,
                   LNFILE.LN_INSCOMM_6,
                   LNFILE.LN_INSANTICERN_6,
                   LNFILE.LN_INSANTICADJ_6,
                   LNFILE.LN_INSUFERN_6,
                   LNFILE.LN_INSACCERN_6,
                   LNFILE.LN_INSEARN_ORDER_6,
                   LNFILE.LN_INSFINCHG_6,
                   LNFILE.LN_INSCOMP_7,
                   LNFILE.LN_INSOURS_7,
                   CAST(LNFILE.LN_INSEFF_DATE_7
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_7
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_7,
                   LNFILE.LN_INSCOVR_7,
                   LNFILE.LN_INSCOMM_7,
                   LNFILE.LN_INSANTICERN_7,
                   LNFILE.LN_INSANTICADJ_7,
                   LNFILE.LN_INSUFERN_7,
                   LNFILE.LN_INSACCERN_7,
                   LNFILE.LN_INSEARN_ORDER_7,
                   LNFILE.LN_INSFINCHG_7,
                   LNFILE.LN_INSCOMP_8,
                   LNFILE.LN_INSOURS_8,
                   CAST(LNFILE.LN_INSEFF_DATE_8
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_8
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_8,
                   LNFILE.LN_INSCOVR_8,
                   LNFILE.LN_INSCOMM_8,
                   LNFILE.LN_INSANTICERN_8,
                   LNFILE.LN_INSANTICADJ_8,
                   LNFILE.LN_INSUFERN_8,
                   LNFILE.LN_INSACCERN_8,
                   LNFILE.LN_INSEARN_ORDER_8,
                   LNFILE.LN_INSFINCHG_8,
                   LNFILE.LN_INSCOMP_9,
                   LNFILE.LN_INSOURS_9,
                   CAST(LNFILE.LN_INSEFF_DATE_9
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_9
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_9,
                   LNFILE.LN_INSCOVR_9,
                   LNFILE.LN_INSCOMM_9,
                   LNFILE.LN_INSANTICERN_9,
                   LNFILE.LN_INSANTICADJ_9,
                   LNFILE.LN_INSUFERN_9,
                   LNFILE.LN_INSACCERN_9,
                   LNFILE.LN_INSEARN_ORDER_9,
                   LNFILE.LN_INSFINCHG_9,
                   LNFILE.LN_INSCOMP_10,
                   LNFILE.LN_INSOURS_10,
                   CAST(LNFILE.LN_INSEFF_DATE_10
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_10
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_10,
                   LNFILE.LN_INSCOVR_10,
                   LNFILE.LN_INSCOMM_10,
                   LNFILE.LN_INSANTICERN_10,
                   LNFILE.LN_INSANTICADJ_10,
                   LNFILE.LN_INSUFERN_10,
                   LNFILE.LN_INSACCERN_10,
                   LNFILE.LN_INSEARN_ORDER_10,
                   LNFILE.LN_INSFINCHG_10,
                   LNFILE.LN_PY_YYYYMM_RECDEL,
                   LNFILE.LN_MTD_PAYS_RECDEL,
                   LNFILE.LN_GARNISH_EXTR,
                   LNFILE.LN_SHIP_SAME_FG,
                   LNFILE.LN_AD_D_INS_COVR,
                   LNFILE.LN_TOT_PARTIAL_CHGOFF,
                   LNFILE.LN_LPO,
                   LNFILE.LN_REP_CD,
                   LNFILE.LN_EMP_ID,
                   LNFILE.LN_PROCESS_CD,
                   LNFILE.LN_WCBC_CREDITLIM,
                   LNFILE.LN_FOLLOWUP_CD,
                   LNFILE.LN_MIP_FG,
                   LNFILE.LN_MIP_MTD_CLAHPAID,
                   CAST(LNFILE.LN_MIP_CLPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_CLPAID,
                   CAST(LNFILE.LN_MIP_AHPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_AHPAID,
                   LNFILE.LN_IL_GROSS_INCOME,
                   LNFILE.LN_IL_GROSS_INCOME2,
                   LNFILE.LN_RESCISSION,
                   LNFILE.LN_INTERIM_TRW,
                   LNFILE.LN_DLNO,
                   LNFILE.LN_DLPOOL,
                   LNFILE.LN_DLRECOURSE,
                   LNFILE.LN_DLPARTRCAMT,
                   LNFILE.LN_ORIGPURAMT,
                   LNFILE.LN_PURBAL,
                   LNFILE.LN_DLRVPRIN_1,
                   LNFILE.LN_DLRVPRIN_2,
                   LNFILE.LN_DLRVPRIN_3,
                   LNFILE.LN_DLRVCHGS_1,
                   LNFILE.LN_DLRVCHGS_2,
                   LNFILE.LN_DLRVCHGS_3,
                   LNFILE.LN_DLPARVHELD,
                   LNFILE.LN_DLPARVPAID,
                   LNFILE.LN_DLDISC,
                   CAST(LNFILE.LN_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_CURBAL,
                   LNFILE.LN_INTBAL,
                   LNFILE.LN_LCBAL,
                   LNFILE.LN_OTHBAL,
                   LNFILE.LN_OT2BAL,
                   LNFILE.LN_LCPAID,
                   LNFILE.LN_LCPARTIALS,
                   LNFILE.LN_STMT_COUNTER,
                   LNFILE.LN_PRIOR_STMT_COUNTER,
                   LNFILE.LN_FROZEN_REASON,
                   LNFILE.LN_COUPON_STATEMENT,
                   LNFILE.LN_MONTHEND_BAL,
                   LNFILE.LN_ANTICTERM,
                   LNFILE.LN_ANTICERN_1,
                   LNFILE.LN_ANTICADJ_1,
                   LNFILE.LN_UFERN_1,
                   LNFILE.LN_ACCERN_1,
                   LNFILE.LN_EARN_ORDER_1,
                   LNFILE.LN_ANTICERN_2,
                   LNFILE.LN_ANTICADJ_2,
                   LNFILE.LN_UFERN_2,
                   LNFILE.LN_ACCERN_2,
                   LNFILE.LN_EARN_ORDER_2,
                   LNFILE.LN_ANTICERN_3,
                   LNFILE.LN_ANTICADJ_3,
                   LNFILE.LN_UFERN_3,
                   LNFILE.LN_ACCERN_3,
                   LNFILE.LN_EARN_ORDER_3,
                   LNFILE.LN_ANTICERN_4,
                   LNFILE.LN_ANTICADJ_4,
                   LNFILE.LN_UFERN_4,
                   LNFILE.LN_ACCERN_4,
                   LNFILE.LN_EARN_ORDER_4,
                   LNFILE.LN_ANTICERN_5,
                   LNFILE.LN_ANTICADJ_5,
                   LNFILE.LN_UFERN_5,
                   LNFILE.LN_ACCERN_5,
                   LNFILE.LN_EARN_ORDER_5,
                   LNFILE.LN_ANTICERN_6,
                   LNFILE.LN_ANTICADJ_6,
                   LNFILE.LN_UFERN_6,
                   LNFILE.LN_ACCERN_6,
                   LNFILE.LN_EARN_ORDER_6,
                   LNFILE.LN_ANTICERN_7,
                   LNFILE.LN_ANTICADJ_7,
                   LNFILE.LN_UFERN_7,
                   LNFILE.LN_ACCERN_7,
                   LNFILE.LN_EARN_ORDER_7,
                   LNFILE.LN_ANTICERN_8,
                   LNFILE.LN_ANTICADJ_8,
                   LNFILE.LN_UFERN_8,
                   LNFILE.LN_ACCERN_8,
                   LNFILE.LN_EARN_ORDER_8,
                   LNFILE.LN_ANTICERN_9,
                   LNFILE.LN_ANTICADJ_9,
                   LNFILE.LN_UFERN_9,
                   LNFILE.LN_ACCERN_9,
                   LNFILE.LN_EARN_ORDER_9,
                   LNFILE.LN_ANTICERN_10,
                   LNFILE.LN_ANTICADJ_10,
                   LNFILE.LN_UFERN_10,
                   LNFILE.LN_ACCERN_10,
                   LNFILE.LN_EARN_ORDER_10,
                   LNFILE.LN_LMO_PRIOR_INTEREST,
                   LNFILE.LN_PRIOR_UNEARNED,
                   LNFILE.LN_ERNDELQ_STOP,
                   LNFILE.LN_NONACRERN,
                   LNFILE.LN_PRIOR_NONACRERN,
                   CAST(LNFILE.LN_ERN_IB_PDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_ERN_IB_PRINBAL,
                   LNFILE.LN_ERN_IB_INTOWE,
                   LNFILE.LN_TOTERN,
                   LNFILE.LN_TOTOTH,
                   LNFILE.LN_TOTINT,
                   LNFILE.LN_TOTLCHG,
                   LNFILE.LN_TOTDEF,
                   LNFILE.LN_TOTSERACCT,
                   LNFILE.LN_LCWAIVERS,
                   LNFILE.LN_INTWAIVERS,
                   LNFILE.LN_TOTPAYMNTD,
                   LNFILE.LN_TOTEXCPAYMNTD,
                   LNFILE.LN_TOTNODEF,
                   LNFILE.LN_YTDNODEF,
                   LNFILE.LN_TOTNODEFACT,
                   LNFILE.LN_YTDNODEFACT,
                   LNFILE.LN_TOTNOALDEL,
                   LNFILE.LN_YTDNOALDEL,
                   LNFILE.LN_YTDINTPD,
                   LNFILE.LN_LYRINTPD,
                   LNFILE.LN_TOTINTPD,
                   LNFILE.LN_RECASTINT,
                   LNFILE.LN_RECASTPRIN,
                   LNFILE.LN_CL_REBATE,
                   LNFILE.LN_AH_REBATE,
                   LNFILE.LN_PP_REBATE,
                   LNFILE.LN_INT_REBATE,
                   LNFILE.LN_SC_REBATE,
                   LNFILE.LN_MF_REBATE,
                   LNFILE.LN_DF_REBATE,
                   LNFILE.LN_EX_REBATE,
                   LNFILE.LN_O1_REBATE,
                   LNFILE.LN_O2_REBATE,
                   LNFILE.LN_O3_REBATE,
                   LNFILE.LN_O4_REBATE,
                   LNFILE.LN_O5_REBATE,
                   LNFILE.LN_O6_REBATE,
                   LNFILE.LN_O7_REBATE,
                   LNFILE.LN_UN_O7_REB,
                   LNFILE.LN_UN_O8_REB,
                   LNFILE.LN_UN_O9_REB,
                   LNFILE.LN_UN_O10_REB,
                   LNFILE.LN_PLREASON,
                   LNFILE.LN_COLLECTOR,
                   LNFILE.LN_ACTIONCD,
                   LNFILE.LN_ACTIONCD2,
                   LNFILE.LN_ATCODE,
                   LNFILE.LN_RECODE,
                   LNFILE.LN_ESCROW_FG,
                   LNFILE.LN_PROMDAYS_PASTDUE,
                   LNFILE.LN_PROMID,
                   CAST(LNFILE.LN_PROMDATE AS VARCHAR(10)),
                   LNFILE.LN_PROMAMT,
                   CAST(LNFILE.LN_PROMDATE2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DATE_PAID_LAST
                                                  AS VARCHAR(10)),
                   LNFILE.LN_AMT_PAID_LAST,
                   LNFILE.LN_LASTCFORMNO,
                   CAST(LNFILE.LN_LASTCFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_DELCNT,
                   LNFILE.LN_DELCNT2,
                   LNFILE.LN_CREDITLIM,
                   LNFILE.LN_CRSCORE,
                   LNFILE.LN_LASTSFORMNO,
                   CAST(LNFILE.LN_LASTSFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_SOLCNT,
                   LNFILE.LN_MESSAGE,
                   LNFILE.LN_OLDACCTNO,
                   LNFILE.LN_PRLNNO,
                   LNFILE.LN_PRBAL,
                   LNFILE.LN_PRINTDUE,
                   LNFILE.LN_PRFINCHGRB,
                   LNFILE.LN_PRINSRB,
                   LNFILE.LN_PRPOCD,
                   CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)),
                   LNFILE.LN_PRDELINQAMT,
                   LNFILE.LN_PRLNAMT,
                   LNFILE.LN_PRPDUE_DAYS,
                   LNFILE.LN_PRDLDISC_UNEARN,
                   LNFILE.LN_PRCONPROFILE,
                   LNFILE.LN_SUM_ORIGPURAMT,
                   LNFILE.LN_SUM_LNAMT,
                   LNFILE.LN_SUM_FINCHG,
                   LNFILE.LN_SUM_INTCHG,
                   LNFILE.LN_SUM_ORGTERM,
                   LNFILE.LN_SUM_REGPYAMT,
                   LNFILE.LN_SUM_EXTCHG,
                   LNFILE.LN_SUM_SERCHG,
                   LNFILE.LN_SUM_MAINTFEE,
                   LNFILE.LN_UNITPER_CD,
                   LNFILE.LN_UNITPER_FREQ,
                   LNFILE.LN_DAYS_IN_UNITPER,
                   LNFILE.LN_UNITPER_PER_YEAR,
                   LNFILE.LN_REPOCD,
                   LNFILE.LN_BR_TFR_FG,
                   LNFILE.LN_O3INS_DLPROC,
                   LNFILE.LN_INSPREM_DLADJ,
                   LNFILE.LN_PLAMT,
                   LNFILE.LN_MTD_PRIN,
                   LNFILE.LN_MTD_LC,
                   LNFILE.LN_MTD_INT,
                   LNFILE.LN_MTD_OT,
                   LNFILE.LN_MTD_EX,
                   LNFILE.LN_BNKRPT_CHAPTER,
                   LNFILE.LN_BMO_CON_STATUS,
                   LNFILE.LN_BMO_REC_STATUS,
                   LNFILE.LN_APP_NUMBER,
                   LNFILE.LN_GIFTNET,
                   LNFILE.LN_GIFTNET_OUR_PO,
                   LNFILE.LN_PROC_DISBURSED,
                   LNFILE.LN_NOODDPY,
                   LNFILE.LN_CONPROFILE_1,
                   LNFILE.LN_CONPROFILE_2,
                   LNFILE.LN_CONPROFILE_3,
                   LNFILE.LN_CONPROFILE_4,
                   LNFILE.LN_CONPROFILE_5,
                   LNFILE.LN_RECPROFILE_1,
                   LNFILE.LN_RECPROFILE_2,
                   LNFILE.LN_RECPROFILE_3,
                   LNFILE.LN_RECPROFILE_4,
                   LNFILE.LN_RECPROFILE_5,
                   LNFILE.LN_TRW_STATUS,
                   LNFILE.LN_ORIGIN,
                   LNFILE.LN_PO_TRCD,
                   LNFILE.LN_NEXIS_CRSCORE,
                   LNFILE.LN_TRW_B_CONSUMER_IND,
                   LNFILE.LN_PARVHELD_PAID_FG,
                   LNFILE.LN_ACCT_FROZEN,
                   LNFILE.LN_TRW_SPECIAL_CODE,
                   LNFILE.LN_CREATION_STATUS,
                   LNFILE.LN_TOTNOLCHG,
                   LNFILE.LN_LBOX,
                   LNFILE.LN_EXTRA_PRIN_LFP,
                   LNFILE.LN_REMAIN_INT_SINCE_LFP,
                   LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
                   LNFILE.LN_INTERIM_COUPON,
                   LNFILE.LN_DLCOMM_O3_CMSI,
                   LNFILE.LN_DLCOMM_PP_CMSI,
                   LNFILE.LN_TRW_J_CONSUMER_IND,
                   LNFILE.LN_ACH,
                   LNFILE.LN_1099_C_FG,
                   LNFILE.LN_TRW_COMPLIANCE_CODE,
                   LNFILE.LN_UNWIND_REASON_CODE,
                   LNFILE.LN_PBI_PBD_FG,
                   LNFILE.LN_OLD_ACCT_FORMAT_FG,
                   LNFILE.LN_APPROVED_BY_USER,
                   LNFILE.LN_APPROVED_BY_CODE,
                   CAST(LNFILE.LN_APPROVED_BY_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APPROVED_BY_TIME,
                   CAST(LNFILE.LN_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_LTOUCH_TIME,
                   LNFILE.LN_LOS_APP_ID 
            INTO :QLN-REC
            FROM DBO.LNFILE
            WHERE LNFILE.LN_OWNBR  = :QLN-OWNBR
              AND LNFILE.LN_ACCTNO = :QLN-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS.

      *-----------------------------------------------------------------
       READ-LN1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.
           INITIALIZE QLN-REC.

           IF ( LN1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LN1_CURSOR INTO :QLN-REC
              END-EXEC
           ELSE
           IF ( LN1-CURSOR-GR-STAT-GOOD )
              EXEC SQL
                   FETCH LN1_CURSOR_GR INTO :QLN-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LN1-FILE.

           PERFORM CLOSE-IT.
           IF ( LN1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LN1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LN1-CURSOR-STAT.

           IF ( LN1-CURSOR-GR-STAT-GOOD )
              EXEC SQL
                   CLOSE LN1_CURSOR_GR
              END-EXEC
              MOVE STAT---BAD TO LN1-CURSOR-GR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLN1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLTI1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLTI1RN
       LOAD-LTI1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LTI-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LTI-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LTI-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LTI-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LTI-ALL-DATA
              MOVE LTI-ALL-PATH             TO LTI-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LTI-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LTI-ALL-BASE
              MOVE FILPATH-MACHINE         TO LTI-ALL-MACHINE
              MOVE FILPATH-DATA            TO LTI-ALL-DATA
              MOVE LTI-ALL-PATH             TO LTI-PATH.

      *-----------------------------------------------------------------
       OPEN-LTI1-FILE.
           PERFORM LOAD-LTI1-FILE.
           PERFORM OPEN-IT.
           MOVE LTI-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-LTI1-FILE.
           PERFORM START-IT.
           MOVE LTI-PATH-OWNBR  TO LTI-BRNO.
           MOVE LTI-PATH-SQL    TO E-FILE.
           MOVE LTI1-KEY        TO E-KEYX.

           IF ( LTI1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LTI1-FILE.

           IF ( QLTI1-WEND-BRNO = ZEROES    ) OR
              ( QLTI1-WEND-BRNO NOT NUMERIC )
              MOVE LTI-PATH-OWNBR        TO QLTI1-WBEG-BRNO
              MOVE LTI-PATH-OWNBR        TO QLTI1-WEND-BRNO
              MOVE LTI-ACCTNO            TO QLTI1-WBEG-ACCTNO
              MOVE ALL "9"               TO QLTI1-WEND-ACCTNO
              MOVE LTI-SEQNO             TO QLTI1-WBEG-SEQNO
              MOVE ALL "9"               TO QLTI1-WEND-SEQNO.


           EXEC SQL
            DECLARE LTI1_CURSOR CURSOR FOR
            SELECT LTIFILE.LTI_BRNO,
                   LTIFILE.LTI_ACCTNO,
                   LTIFILE.LTI_SEQNO,
                   CAST(LTIFILE.LTI_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_INS_TYPE,
                   CAST(LTIFILE.LTI_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_PRIOR_NODEF,
                   LTIFILE.LTI_INSFEECD_1,
                   LTIFILE.LTI_INSFEE_1,
                   LTIFILE.LTI_INSFEECD_2,
                   LTIFILE.LTI_INSFEE_2,
                   LTIFILE.LTI_TRCD,
                   LTIFILE.LTI_INSCOMP,
                   LTIFILE.LTI_INSOURS,
                   CAST(LTIFILE.LTI_INSEFF_DATE
                                                  AS VARCHAR(10)),
                   CAST(LTIFILE.LTI_INSEXP_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_INSPREM,
                   LTIFILE.LTI_INSCOVR,
                   LTIFILE.LTI_INSCOMM,
                   LTIFILE.LTI_ANTICTERM,
                   LTIFILE.LTI_ANTICERN_1,
                   LTIFILE.LTI_ANTICADJ_1,
                   LTIFILE.LTI_UFERN_1,
                   LTIFILE.LTI_ACCERN_1,
                   LTIFILE.LTI_ANTICERN_2,
                   LTIFILE.LTI_ANTICADJ_2,
                   LTIFILE.LTI_UFERN_2,
                   LTIFILE.LTI_ACCERN_2,
                   LTIFILE.LTI_ANTICERN_3,
                   LTIFILE.LTI_ANTICADJ_3,
                   LTIFILE.LTI_UFERN_3,
                   LTIFILE.LTI_ACCERN_3,
                   LTIFILE.LTI_INT_REBATE,
                   LTIFILE.LTI_INS_PAYMNT_INCR,
                   LTIFILE.LTI_INS_TOT_ADDON,
                   LTIFILE.LTI_INT_LAST_EARNED,
                   LTIFILE.LTI_INS_REBATE,
                   LTIFILE.LTI_RB_WORKER,
                   CAST(LTIFILE.LTI_ANTIC_START_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_CANCEL_REASON_CD
            FROM DBO.LTIFILE
            WHERE LTIFILE.LTI_BRNO  = :QLTI1-WBEG-BRNO
              AND LTIFILE.LTI_ACCTNO >= :QLTI1-WBEG-ACCTNO
              AND LTIFILE.LTI_ACCTNO <= :QLTI1-WEND-ACCTNO
              AND LTIFILE.LTI_SEQNO >= :QLTI1-WBEG-SEQNO
              AND LTIFILE.LTI_SEQNO <= :QLTI1-WEND-SEQNO
            ORDER BY LTIFILE.LTI_BRNO,
                     LTIFILE.LTI_ACCTNO,
                     LTIFILE.LTI_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LTI1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLTI1-WBEG-BRNO
                          QLTI1-WEND-BRNO
                          QLTI1-WBEG-ACCTNO
                          QLTI1-WEND-ACCTNO
                          QLTI1-WBEG-SEQNO
                          QLTI1-WEND-SEQNO.

           MOVE STAT---GOOD TO LTI1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-LTI1-FILE.
           PERFORM READ-IT.
           MOVE LTI-PATH-OWNBR  TO LTI-BRNO. 
           MOVE LTI-PATH-SQL    TO E-FILE.
           MOVE LTI1-KEY        TO E-KEYX.
           INITIALIZE QLTI-REC.

           MOVE LTI-BRNO   TO QLTI-BRNO.
           MOVE LTI-ACCTNO TO QLTI-ACCTNO.
           MOVE LTI-SEQNO  TO QLTI-SEQNO.

           EXEC SQL
            SELECT LTIFILE.LTI_BRNO,
                   LTIFILE.LTI_ACCTNO,
                   LTIFILE.LTI_SEQNO,
                   CAST(LTIFILE.LTI_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_INS_TYPE,
                   CAST(LTIFILE.LTI_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_PRIOR_NODEF,
                   LTIFILE.LTI_INSFEECD_1,
                   LTIFILE.LTI_INSFEE_1,
                   LTIFILE.LTI_INSFEECD_2,
                   LTIFILE.LTI_INSFEE_2,
                   LTIFILE.LTI_TRCD,
                   LTIFILE.LTI_INSCOMP,
                   LTIFILE.LTI_INSOURS,
                   CAST(LTIFILE.LTI_INSEFF_DATE
                                                  AS VARCHAR(10)),
                   CAST(LTIFILE.LTI_INSEXP_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_INSPREM,
                   LTIFILE.LTI_INSCOVR,
                   LTIFILE.LTI_INSCOMM,
                   LTIFILE.LTI_ANTICTERM,
                   LTIFILE.LTI_ANTICERN_1,
                   LTIFILE.LTI_ANTICADJ_1,
                   LTIFILE.LTI_UFERN_1,
                   LTIFILE.LTI_ACCERN_1,
                   LTIFILE.LTI_ANTICERN_2,
                   LTIFILE.LTI_ANTICADJ_2,
                   LTIFILE.LTI_UFERN_2,
                   LTIFILE.LTI_ACCERN_2,
                   LTIFILE.LTI_ANTICERN_3,
                   LTIFILE.LTI_ANTICADJ_3,
                   LTIFILE.LTI_UFERN_3,
                   LTIFILE.LTI_ACCERN_3,
                   LTIFILE.LTI_INT_REBATE,
                   LTIFILE.LTI_INS_PAYMNT_INCR,
                   LTIFILE.LTI_INS_TOT_ADDON,
                   LTIFILE.LTI_INT_LAST_EARNED,
                   LTIFILE.LTI_INS_REBATE,
                   LTIFILE.LTI_RB_WORKER,
                   CAST(LTIFILE.LTI_ANTIC_START_DATE
                                                  AS VARCHAR(10)),
                   LTIFILE.LTI_CANCEL_REASON_CD
            INTO :QLTI-REC
            FROM DBO.LTIFILE
            WHERE LTIFILE.LTI_BRNO = :QLTI-BRNO
              AND LTIFILE.LTI_ACCTNO = :QLTI-ACCTNO
              AND LTIFILE.LTI_SEQNO = :QLTI-SEQNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LTI1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LTI-FIELDS.

      *-----------------------------------------------------------------
       READ-LTI1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LTI-PATH-OWNBR  TO LTI-BRNO.
           MOVE LTI-PATH-SQL    TO E-FILE.
           MOVE LTI1-KEY        TO E-KEYX.
           INITIALIZE QLTI-REC.

           IF ( LTI1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LTI1_CURSOR INTO :QLTI-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LTI1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LTI-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LTI1-FILE.

           PERFORM CLOSE-IT.
           IF ( LTI1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LTI1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LTI1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLTI1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLTP1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLTP1RN
      *=================================================================
       GET-LT-P-REC.
           MOVE 0 TO IO-FG.
           IF NOT (LN-ACCTNO = LTP-ACCTNO)
              MOVE LN-OWNBR  TO LTP-BRNO
              MOVE LN-ACCTNO TO LTP-ACCTNO
              MOVE 1         TO LTP-SEQNO
              PERFORM OPEN-LTP1-FILE
              PERFORM READ-LTP1-FILE
              PERFORM CLOSE-LTP1-FILE.

      *-----------------------------------------------------------------
       LOAD-LTP1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LTP-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LTP-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LTP-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LTP-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LTP-ALL-DATA
              MOVE LTP-ALL-PATH             TO LTP-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LTP-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LTP-ALL-BASE
              MOVE FILPATH-MACHINE         TO LTP-ALL-MACHINE
              MOVE FILPATH-DATA            TO LTP-ALL-DATA
              MOVE LTP-ALL-PATH             TO LTP-PATH.

      *-----------------------------------------------------------------
       OPEN-LTP1-FILE.
           PERFORM LOAD-LTP1-FILE.
           PERFORM OPEN-IT.
           MOVE LTP-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-LTP1-FILE.
           PERFORM START-IT.
           MOVE LTP-PATH-OWNBR  TO LTP-BRNO.
           MOVE LTP-PATH-SQL    TO E-FILE.
           MOVE LTP1-KEY        TO E-KEYX.

           IF ( LTP1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LTP1-FILE.

           IF ( QLTP1-WEND-BRANCH = ZEROES    ) OR
              ( QLTP1-WEND-BRANCH NOT NUMERIC )
              MOVE LTP-PATH-OWNBR        TO QLTP1-WBEG-BRANCH
              MOVE LTP-PATH-OWNBR        TO QLTP1-WEND-BRANCH
              MOVE LTP-ACCTNO            TO QLTP1-WBEG-ACCTNO
              MOVE ALL "9"               TO QLTP1-WEND-ACCTNO
              MOVE LTP-SEQNO             TO QLTP1-WBEG-SEQNO
              MOVE ALL "9"               TO QLTP1-WEND-SEQNO.

           EXEC SQL
            DECLARE LTP1_CURSOR CURSOR FOR
            SELECT LTPFILE.LTP_BRNO,
                   LTPFILE.LTP_ACCTNO,
                   LTPFILE.LTP_SEQNO,
                   CAST(LTPFILE.LTP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LTPFILE.LTP_SCHLD_TERM_1,
                   LTPFILE.LTP_SCHLD_PAYMNT_1,
                   LTPFILE.LTP_SCHLD_TERM_2,
                   LTPFILE.LTP_SCHLD_PAYMNT_2,
                   LTPFILE.LTP_SCHLD_TERM_3,
                   LTPFILE.LTP_SCHLD_PAYMNT_3,
                   LTPFILE.LTP_SCHLD_TERM_4,
                   LTPFILE.LTP_SCHLD_PAYMNT_4,
                   LTPFILE.LTP_SCHLD_TERM_5,
                   LTPFILE.LTP_SCHLD_PAYMNT_5,
                   LTPFILE.LTP_SCHLD_TERM_6,
                   LTPFILE.LTP_SCHLD_PAYMNT_6,
                   LTPFILE.LTP_SCHLD_TERM_7,
                   LTPFILE.LTP_SCHLD_PAYMNT_7,
                   LTPFILE.LTP_SCHLD_TERM_8,
                   LTPFILE.LTP_SCHLD_PAYMNT_8,
                   LTPFILE.LTP_SCHLD_TERM_9,
                   LTPFILE.LTP_SCHLD_PAYMNT_9,
                   LTPFILE.LTP_SCHLD_TERM_10,
                   LTPFILE.LTP_SCHLD_PAYMNT_10,
                   LTPFILE.LTP_SCHLD_TERM_11,
                   LTPFILE.LTP_SCHLD_PAYMNT_11,
                   LTPFILE.LTP_SCHLD_TERM_12,
                   LTPFILE.LTP_SCHLD_PAYMNT_12,
                   LTPFILE.LTP_SCHLD_TERM_13,
                   LTPFILE.LTP_SCHLD_PAYMNT_13,
                   LTPFILE.LTP_SCHLD_TERM_14,
                   LTPFILE.LTP_SCHLD_PAYMNT_14,
                   LTPFILE.LTP_SCHLD_TERM_15,
                   LTPFILE.LTP_SCHLD_PAYMNT_15,
                   LTPFILE.LTP_SCHLD_TERM_16,
                   LTPFILE.LTP_SCHLD_PAYMNT_16,
                   LTPFILE.LTP_SCHLD_TERM_17,
                   LTPFILE.LTP_SCHLD_PAYMNT_17,
                   LTPFILE.LTP_SCHLD_TERM_18,
                   LTPFILE.LTP_SCHLD_PAYMNT_18,
                   LTPFILE.LTP_SCHLD_TERM_19,
                   LTPFILE.LTP_SCHLD_PAYMNT_19,
                   LTPFILE.LTP_SCHLD_TERM_20,
                   LTPFILE.LTP_SCHLD_PAYMNT_20,
                   LTPFILE.LTP_SCHLD_TERM_21,
                   LTPFILE.LTP_SCHLD_PAYMNT_21,
                   LTPFILE.LTP_SCHLD_TERM_22,
                   LTPFILE.LTP_SCHLD_PAYMNT_22,
                   LTPFILE.LTP_SCHLD_TERM_23,
                   LTPFILE.LTP_SCHLD_PAYMNT_23,
                   LTPFILE.LTP_SCHLD_TERM_24,
                   LTPFILE.LTP_SCHLD_PAYMNT_24,
                   LTPFILE.LTP_SCHLD_TERM_25,
                   LTPFILE.LTP_SCHLD_PAYMNT_25,
                   LTPFILE.LTP_SCHLD_TERM_26,
                   LTPFILE.LTP_SCHLD_PAYMNT_26,
                   LTPFILE.LTP_SCHLD_TERM_27,
                   LTPFILE.LTP_SCHLD_PAYMNT_27,
                   LTPFILE.LTP_SCHLD_TERM_28,
                   LTPFILE.LTP_SCHLD_PAYMNT_28,
                   LTPFILE.LTP_SCHLD_TERM_29,
                   LTPFILE.LTP_SCHLD_PAYMNT_29,
                   LTPFILE.LTP_SCHLD_TERM_30,
                   LTPFILE.LTP_SCHLD_PAYMNT_30,
                   LTPFILE.LTP_SCHLD_TERM_31,
                   LTPFILE.LTP_SCHLD_PAYMNT_31,
                   LTPFILE.LTP_SCHLD_TERM_32,
                   LTPFILE.LTP_SCHLD_PAYMNT_32,
                   LTPFILE.LTP_SCHLD_TERM_33,
                   LTPFILE.LTP_SCHLD_PAYMNT_33,
                   LTPFILE.LTP_SCHLD_TERM_34,
                   LTPFILE.LTP_SCHLD_PAYMNT_34,
                   LTPFILE.LTP_SCHLD_TERM_35,
                   LTPFILE.LTP_SCHLD_PAYMNT_35,
                   LTPFILE.LTP_SCHLD_TERM_36,
                   LTPFILE.LTP_SCHLD_PAYMNT_36,
                   LTPFILE.LTP_SCHLD_TERM_37,
                   LTPFILE.LTP_SCHLD_PAYMNT_37,
                   LTPFILE.LTP_SCHLD_TERM_38,
                   LTPFILE.LTP_SCHLD_PAYMNT_38,
                   LTPFILE.LTP_SCHLD_TERM_39,
                   LTPFILE.LTP_SCHLD_PAYMNT_39,
                   LTPFILE.LTP_SCHLD_TERM_40,
                   LTPFILE.LTP_SCHLD_PAYMNT_40,
                   LTPFILE.LTP_SCHLD_TERM_41,
                   LTPFILE.LTP_SCHLD_PAYMNT_41
            FROM DBO.LTPFILE
            WHERE LTPFILE.LTP_BRNO  = :QLTP1-WBEG-BRANCH
              AND LTPFILE.LTP_ACCTNO >= :QLTP1-WBEG-ACCTNO
              AND LTPFILE.LTP_ACCTNO <= :QLTP1-WEND-ACCTNO
              AND LTPFILE.LTP_SEQNO >= :QLTP1-WEND-SEQNO
              AND LTPFILE.LTP_SEQNO <= :QLTP1-WEND-SEQNO
            ORDER BY LTPFILE.LTP_BRNO,
                     LTPFILE.LTP_ACCTNO,
                     LTPFILE.LTP_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LTP1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLTP1-WBEG-BRANCH 
                          QLTP1-WEND-BRANCH
                          QLTP1-WBEG-ACCTNO
                          QLTP1-WEND-ACCTNO
                          QLTP1-WBEG-SEQNO
                          QLTP1-WEND-SEQNO.

           MOVE STAT---GOOD TO LTP1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-LTP1-FILE.
           PERFORM READ-IT.
           MOVE LTP-PATH-OWNBR  TO LTP-BRNO. 
           MOVE LTP-PATH-SQL    TO E-FILE.
           MOVE LTP1-KEY        TO E-KEYX.
           INITIALIZE QLTP-REC.

           MOVE LTP-BRNO   TO QLTP-BRNO.
           MOVE LTP-ACCTNO TO QLTP-ACCTNO.
           MOVE LTP-SEQNO  TO QLTP-SEQNO.

           EXEC SQL
            SELECT LTPFILE.LTP_BRNO,
                   LTPFILE.LTP_ACCTNO,
                   LTPFILE.LTP_SEQNO,
                   CAST(LTPFILE.LTP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LTPFILE.LTP_SCHLD_TERM_1,
                   LTPFILE.LTP_SCHLD_PAYMNT_1,
                   LTPFILE.LTP_SCHLD_TERM_2,
                   LTPFILE.LTP_SCHLD_PAYMNT_2,
                   LTPFILE.LTP_SCHLD_TERM_3,
                   LTPFILE.LTP_SCHLD_PAYMNT_3,
                   LTPFILE.LTP_SCHLD_TERM_4,
                   LTPFILE.LTP_SCHLD_PAYMNT_4,
                   LTPFILE.LTP_SCHLD_TERM_5,
                   LTPFILE.LTP_SCHLD_PAYMNT_5,
                   LTPFILE.LTP_SCHLD_TERM_6,
                   LTPFILE.LTP_SCHLD_PAYMNT_6,
                   LTPFILE.LTP_SCHLD_TERM_7,
                   LTPFILE.LTP_SCHLD_PAYMNT_7,
                   LTPFILE.LTP_SCHLD_TERM_8,
                   LTPFILE.LTP_SCHLD_PAYMNT_8,
                   LTPFILE.LTP_SCHLD_TERM_9,
                   LTPFILE.LTP_SCHLD_PAYMNT_9,
                   LTPFILE.LTP_SCHLD_TERM_10,
                   LTPFILE.LTP_SCHLD_PAYMNT_10,
                   LTPFILE.LTP_SCHLD_TERM_11,
                   LTPFILE.LTP_SCHLD_PAYMNT_11,
                   LTPFILE.LTP_SCHLD_TERM_12,
                   LTPFILE.LTP_SCHLD_PAYMNT_12,
                   LTPFILE.LTP_SCHLD_TERM_13,
                   LTPFILE.LTP_SCHLD_PAYMNT_13,
                   LTPFILE.LTP_SCHLD_TERM_14,
                   LTPFILE.LTP_SCHLD_PAYMNT_14,
                   LTPFILE.LTP_SCHLD_TERM_15,
                   LTPFILE.LTP_SCHLD_PAYMNT_15,
                   LTPFILE.LTP_SCHLD_TERM_16,
                   LTPFILE.LTP_SCHLD_PAYMNT_16,
                   LTPFILE.LTP_SCHLD_TERM_17,
                   LTPFILE.LTP_SCHLD_PAYMNT_17,
                   LTPFILE.LTP_SCHLD_TERM_18,
                   LTPFILE.LTP_SCHLD_PAYMNT_18,
                   LTPFILE.LTP_SCHLD_TERM_19,
                   LTPFILE.LTP_SCHLD_PAYMNT_19,
                   LTPFILE.LTP_SCHLD_TERM_20,
                   LTPFILE.LTP_SCHLD_PAYMNT_20,
                   LTPFILE.LTP_SCHLD_TERM_21,
                   LTPFILE.LTP_SCHLD_PAYMNT_21,
                   LTPFILE.LTP_SCHLD_TERM_22,
                   LTPFILE.LTP_SCHLD_PAYMNT_22,
                   LTPFILE.LTP_SCHLD_TERM_23,
                   LTPFILE.LTP_SCHLD_PAYMNT_23,
                   LTPFILE.LTP_SCHLD_TERM_24,
                   LTPFILE.LTP_SCHLD_PAYMNT_24,
                   LTPFILE.LTP_SCHLD_TERM_25,
                   LTPFILE.LTP_SCHLD_PAYMNT_25,
                   LTPFILE.LTP_SCHLD_TERM_26,
                   LTPFILE.LTP_SCHLD_PAYMNT_26,
                   LTPFILE.LTP_SCHLD_TERM_27,
                   LTPFILE.LTP_SCHLD_PAYMNT_27,
                   LTPFILE.LTP_SCHLD_TERM_28,
                   LTPFILE.LTP_SCHLD_PAYMNT_28,
                   LTPFILE.LTP_SCHLD_TERM_29,
                   LTPFILE.LTP_SCHLD_PAYMNT_29,
                   LTPFILE.LTP_SCHLD_TERM_30,
                   LTPFILE.LTP_SCHLD_PAYMNT_30,
                   LTPFILE.LTP_SCHLD_TERM_31,
                   LTPFILE.LTP_SCHLD_PAYMNT_31,
                   LTPFILE.LTP_SCHLD_TERM_32,
                   LTPFILE.LTP_SCHLD_PAYMNT_32,
                   LTPFILE.LTP_SCHLD_TERM_33,
                   LTPFILE.LTP_SCHLD_PAYMNT_33,
                   LTPFILE.LTP_SCHLD_TERM_34,
                   LTPFILE.LTP_SCHLD_PAYMNT_34,
                   LTPFILE.LTP_SCHLD_TERM_35,
                   LTPFILE.LTP_SCHLD_PAYMNT_35,
                   LTPFILE.LTP_SCHLD_TERM_36,
                   LTPFILE.LTP_SCHLD_PAYMNT_36,
                   LTPFILE.LTP_SCHLD_TERM_37,
                   LTPFILE.LTP_SCHLD_PAYMNT_37,
                   LTPFILE.LTP_SCHLD_TERM_38,
                   LTPFILE.LTP_SCHLD_PAYMNT_38,
                   LTPFILE.LTP_SCHLD_TERM_39,
                   LTPFILE.LTP_SCHLD_PAYMNT_39,
                   LTPFILE.LTP_SCHLD_TERM_40,
                   LTPFILE.LTP_SCHLD_PAYMNT_40,
                   LTPFILE.LTP_SCHLD_TERM_41,
                   LTPFILE.LTP_SCHLD_PAYMNT_41
            INTO :QLTP-REC
            FROM DBO.LTPFILE
            WHERE LTPFILE.LTP_BRNO = :QLTP-BRNO
              AND LTPFILE.LTP_ACCTNO = :QLTP-ACCTNO
              AND LTPFILE.LTP_SEQNO = :QLTP-SEQNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LTP1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LTP-FIELDS.

      *-----------------------------------------------------------------
       READ-LTP1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LTP-PATH-OWNBR  TO LTP-BRNO.
           MOVE LTP-PATH-SQL    TO E-FILE.
           MOVE LTP1-KEY        TO E-KEYX.
           INITIALIZE QLTP-REC.

           IF ( LTP1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LTP1_CURSOR INTO :QLTP-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LTP1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LTP-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LTP1-FILE.

           PERFORM CLOSE-IT.
           IF ( LTP1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LTP1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LTP1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLTP1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLP1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLP1RN
      * BAH 20240212 ADDED LP-REPAY-TRANS-ID #1641
       LOAD-LP1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LP-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LP-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LP-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LP-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LP-ALL-DATA
              MOVE LP-ALL-PATH             TO LP-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LP-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LP-ALL-BASE
              MOVE FILPATH-MACHINE         TO LP-ALL-MACHINE
              MOVE FILPATH-DATA            TO LP-ALL-DATA
              MOVE LP-ALL-PATH             TO LP-PATH.

      *-----------------------------------------------------------------
       OPEN-LP1-FILE.
           PERFORM LOAD-LP1-FILE.
           PERFORM OPEN-IT.
           MOVE LP-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
      * ***NOTE*** THIS 'START' IS NOT FOR DISPLAYING MULTIPLE PAGES.
      * ONLY SHOULD BE USED ONCE PER PROGRAM/BRANCH/ACCOUNT LIKE IN
      * A STANDARD REPORT.  USE START-LP1-FILE-SCAN FOR DISPLAYING
      * MULTIPLE PAGES.
      *-----------------------------------------------------------------
       START-LP1-FILE.
           PERFORM START-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.

           IF ( LP1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LP1-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  DEFAULT THE WBEG AND WEND; TO GET A START TO WORK IN SQL LIKE
      *  IT DOES IN VISION FILES FOR MULTIPLE SCAN PAGES, NEED TO ADD
      *  ONE TO THE WHERE SCAN BEG (WSBEG).
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( QLP1-WEND-SEQNO = ZEROES    ) OR
              ( QLP1-WEND-SEQNO NOT NUMERIC )
              MOVE LP-PATH-OWNBR        TO QLP1-WBEG-BRNO
              MOVE LP-PATH-OWNBR        TO QLP1-WEND-BRNO
              MOVE LP-ACCTNO            TO QLP1-WBEG-ACCTNO
              MOVE ALL "9"              TO QLP1-WEND-ACCTNO
              MOVE LP-SEQNO             TO QLP1-WBEG-SEQNO
              MOVE ALL "9"              TO QLP1-WEND-SEQNO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           EXEC SQL
            DECLARE LP1_CURSOR CURSOR FOR
            SELECT LPFILE.LP_BRNO,
                   LPFILE.LP_ACCTNO,
                   LPFILE.LP_SEQNO,
                   CAST(LPFILE.LP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_USERID,
                   CAST(LPFILE.LP_POSTDATE AS VARCHAR(10)),
                   LPFILE.LP_POSTTIME,
                   CAST(LPFILE.LP_TRDATE AS VARCHAR(10)),
                   CAST(LPFILE.LP_PAYDATE AS VARCHAR(10)),
                   LPFILE.LP_TRCD,
                   LPFILE.LP_REFNO,
                   LPFILE.LP_TRAMT,
                   LPFILE.LP_APOTH,
                   LPFILE.LP_APOT2,
                   LPFILE.LP_APINT,
                   LPFILE.LP_APLC,
                   LPFILE.LP_APCUR,
                   LPFILE.LP_OTHBAL,
                   LPFILE.LP_OT2BAL,
                   LPFILE.LP_INTBAL,
                   LPFILE.LP_LCBAL,
                   LPFILE.LP_CURBAL,
                   LPFILE.LP_INTDUE,
                   LPFILE.LP_DLPROC,
                   LPFILE.LP_EARNED_1,
                   LPFILE.LP_EARNED_2,
                   LPFILE.LP_EARNED_3,
                   LPFILE.LP_INTPAID,
                   LPFILE.LP_SSNO,
                   CAST(LPFILE.LP_PDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_TILLNO,
                   LPFILE.LP_APINTOWE,
                   LPFILE.LP_DLPARVHELD_ADJ,
                   LPFILE.LP_LT_SEQNO,
                   LPFILE.LP_IBPC,
                   LPFILE.LP_MANUAL_RB,
                   LPFILE.LP_INSTYPES,
                   LPFILE.LP_REV,
                   LPFILE.LP_REVTRCD,
                   LPFILE.LP_REVSEQNO,
                   LPFILE.LP_STATUSFG,
                   LPFILE.LP_NEWSTAT_RATE,
                   LPFILE.LP_LCPARTIALS,
                   LPFILE.LP_ADDON_ORIG_REGPY,
                   CAST(LPFILE.LP_NEW1ST_PYDATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_DEF_DUEDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_LCPAID,
                   CAST(LPFILE.LP_OLD1ST_PYDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_DEF_TERM,
                   LPFILE.LP_ADDON_LAST_PYAMT,
                   LPFILE.LP_DLRVCHGS_ADJ_1,
                   LPFILE.LP_DLRVCHGS_ADJ_2,
                   LPFILE.LP_DLRVCHGS_ADJ_3,
                   LPFILE.LP_DLPARVPAID_ADJ,
                   LPFILE.LP_DLNO,
                   LPFILE.LP_PREPAY_PENALTY,
                   LPFILE.LP_PRORATED_INS_REB,
                   LPFILE.LP_POSTING_BR,
                   LPFILE.LP_NOLCHG,
                   LPFILE.LP_COLLECTOR,
                   LPFILE.LP_EXTRA_PRIN_LFP,
                   LPFILE.LP_REMAIN_INT_SINCE_LFP,
                   LPFILE.LP_REMAIN_PRIN_SINCE_LFP,
                   LPFILE.LP_APPLIED_TO_ESCROW,
                   LPFILE.LP_ESCROW_PREPAID,
                   LPFILE.LP_PRIOR_POOLID,
                   CAST(LPFILE.LP_ADDON_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_FROMCL,
                   LPFILE.LP_TOCL,
                   LPFILE.LP_ALT_PREPAY_FG,
                   LPFILE.LP_REPAY_TRANS_ID
            FROM DBO.LPFILE
            WHERE ( LPFILE.LP_BRNO    = :QLP1-WBEG-BRNO )
              AND ( LPFILE.LP_ACCTNO >= :QLP1-WBEG-ACCTNO
              AND   LPFILE.LP_SEQNO  >= :QLP1-WBEG-SEQNO )
              AND ( LPFILE.LP_ACCTNO <= :QLP1-WEND-ACCTNO
              AND   LPFILE.LP_SEQNO  <= :QLP1-WEND-SEQNO )
            ORDER BY LPFILE.LP_BRNO,
                     LPFILE.LP_ACCTNO,
                     LPFILE.LP_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LP1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLP1-WBEG-BRNO 
                          QLP1-WEND-BRNO
                          QLP1-WBEG-ACCTNO
                          QLP1-WEND-ACCTNO
                          QLP1-WBEG-SEQNO
                          QLP1-WEND-SEQNO.

           MOVE STAT---GOOD TO LP1-CURSOR-STAT.

      *-----------------------------------------------------------------
      * ***NOTE*** THIS 'START' IS FOR USE IN DISPLAYING MULTIPLE PAGES.
      * WHEN GOING UP & DOWN DISPLAYING PAGES, NEED TO USE THIS 'START'.
      * IF FIRST USED A START-LP1-FILE-NOT-GREATER, YOU NEED TO ADD
      * ONE TO LP-SEQNO IN ORDER TO GET THE DISPLAY TO WORK
      * LIKE VISION FILES.
      *-----------------------------------------------------------------
       START-LP1-FILE-SCAN.

           PERFORM START-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.

           IF ( LP1-CURSOR-SC-STAT-GOOD )
              PERFORM CLOSE-LP1-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  DEFAULT THE WBEG AND WEND; TO GET A START TO WORK IN SQL LIKE
      *  IT DOES IN VISION FILES FOR MULTIPLE SCAN PAGES, NEED TO ADD
      *  ONE TO THE WHERE SCAN BEG (WSBEG).
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( QLP1-WEND-SEQNO = ZEROES    ) OR
              ( QLP1-WEND-SEQNO NOT NUMERIC )
              MOVE LP-PATH-OWNBR        TO QLP1-WBEG-BRNO
              MOVE LP-PATH-OWNBR        TO QLP1-WEND-BRNO
              MOVE LP-ACCTNO            TO QLP1-WBEG-ACCTNO
              MOVE ALL "9"              TO QLP1-WEND-ACCTNO
              MOVE LP-SEQNO             TO QLP1-WBEG-SEQNO
              MOVE ALL "9"              TO QLP1-WEND-SEQNO
      *-   -   -{ ADD ONE TO WHERE SCAN BEG FIELDS }
              IF ( LP-BRNO = 9999 )
                 MOVE LP-BRNO           TO QLP1-WSBEG-BRNO
              ELSE
                 COMPUTE QLP1-WSBEG-BRNO = LP-BRNO + 1
              END-IF

              IF ( LP-ACCTNO = 99999999 )
                 MOVE LP-ACCTNO         TO QLP1-WSBEG-ACCTNO
              ELSE
                 COMPUTE QLP1-WSBEG-ACCTNO = LP-ACCTNO + 1.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           EXEC SQL
            DECLARE LP1_CURSOR_SC CURSOR FOR
            SELECT LPFILE.LP_BRNO,
                   LPFILE.LP_ACCTNO,
                   LPFILE.LP_SEQNO,
                   CAST(LPFILE.LP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_USERID,
                   CAST(LPFILE.LP_POSTDATE AS VARCHAR(10)),
                   LPFILE.LP_POSTTIME,
                   CAST(LPFILE.LP_TRDATE AS VARCHAR(10)),
                   CAST(LPFILE.LP_PAYDATE AS VARCHAR(10)),
                   LPFILE.LP_TRCD,
                   LPFILE.LP_REFNO,
                   LPFILE.LP_TRAMT,
                   LPFILE.LP_APOTH,
                   LPFILE.LP_APOT2,
                   LPFILE.LP_APINT,
                   LPFILE.LP_APLC,
                   LPFILE.LP_APCUR,
                   LPFILE.LP_OTHBAL,
                   LPFILE.LP_OT2BAL,
                   LPFILE.LP_INTBAL,
                   LPFILE.LP_LCBAL,
                   LPFILE.LP_CURBAL,
                   LPFILE.LP_INTDUE,
                   LPFILE.LP_DLPROC,
                   LPFILE.LP_EARNED_1,
                   LPFILE.LP_EARNED_2,
                   LPFILE.LP_EARNED_3,
                   LPFILE.LP_INTPAID,
                   LPFILE.LP_SSNO,
                   CAST(LPFILE.LP_PDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_TILLNO,
                   LPFILE.LP_APINTOWE,
                   LPFILE.LP_DLPARVHELD_ADJ,
                   LPFILE.LP_LT_SEQNO,
                   LPFILE.LP_IBPC,
                   LPFILE.LP_MANUAL_RB,
                   LPFILE.LP_INSTYPES,
                   LPFILE.LP_REV,
                   LPFILE.LP_REVTRCD,
                   LPFILE.LP_REVSEQNO,
                   LPFILE.LP_STATUSFG,
                   LPFILE.LP_NEWSTAT_RATE,
                   LPFILE.LP_LCPARTIALS,
                   LPFILE.LP_ADDON_ORIG_REGPY,
                   CAST(LPFILE.LP_NEW1ST_PYDATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_DEF_DUEDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_LCPAID,
                   CAST(LPFILE.LP_OLD1ST_PYDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_DEF_TERM,
                   LPFILE.LP_ADDON_LAST_PYAMT,
                   LPFILE.LP_DLRVCHGS_ADJ_1,
                   LPFILE.LP_DLRVCHGS_ADJ_2,
                   LPFILE.LP_DLRVCHGS_ADJ_3,
                   LPFILE.LP_DLPARVPAID_ADJ,
                   LPFILE.LP_DLNO,
                   LPFILE.LP_PREPAY_PENALTY,
                   LPFILE.LP_PRORATED_INS_REB,
                   LPFILE.LP_POSTING_BR,
                   LPFILE.LP_NOLCHG,
                   LPFILE.LP_COLLECTOR,
                   LPFILE.LP_EXTRA_PRIN_LFP,
                   LPFILE.LP_REMAIN_INT_SINCE_LFP,
                   LPFILE.LP_REMAIN_PRIN_SINCE_LFP,
                   LPFILE.LP_APPLIED_TO_ESCROW,
                   LPFILE.LP_ESCROW_PREPAID,
                   LPFILE.LP_PRIOR_POOLID,
                   CAST(LPFILE.LP_ADDON_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_FROMCL,
                   LPFILE.LP_TOCL,
                   LPFILE.LP_ALT_PREPAY_FG,
                   LPFILE.LP_REPAY_TRANS_ID
            FROM DBO.LPFILE
            WHERE  ( LPFILE.LP_BRNO        = :QLP1-WBEG-BRNO )
              AND (( LPFILE.LP_ACCTNO     >= :QLP1-WBEG-ACCTNO
              AND    LPFILE.LP_SEQNO      >= :QLP1-WBEG-SEQNO )
               OR  ( LPFILE.LP_ACCTNO     >= :QLP1-WSBEG-ACCTNO
              AND    LPFILE.LP_SEQNO      >= 0 ))
      **       OR  ( LPFILE.LP_ACCTNO     >= 0
      *       AND    LPFILE.LP_SEQNO      >= 0 ))
              AND (  LPFILE.LP_ACCTNO     <= :QLP1-WEND-ACCTNO
              AND    LPFILE.LP_SEQNO      <= :QLP1-WEND-SEQNO )
            ORDER BY LPFILE.LP_BRNO,
                     LPFILE.LP_ACCTNO,
                     LPFILE.LP_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LP1_CURSOR_SC
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLP1-WBEG-BRNO 
                          QLP1-WEND-BRNO
                          QLP1-WBEG-ACCTNO
                          QLP1-WEND-ACCTNO
                          QLP1-WBEG-SEQNO
                          QLP1-WEND-SEQNO
                          QLP1-WSBEG-BRNO
                          QLP1-WSBEG-ACCTNO.

           MOVE STAT---GOOD TO LP1-CURSOR-SC-STAT.

      *-----------------------------------------------------------------
      *  ***NOTE*** ONLY USE START-LP1-FILE-SCAN WHEN USING A 
      *  START-LP1-FILE-NOT-GREATER.  THIS IS FOR DISPLAYING MULTIPLE
      *  PAGE IN A UP & DOWN SCENARIO.
      *-----------------------------------------------------------------
       START-LP1-FILE-NOT-GREATER.
           PERFORM START-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP1-KEY        TO E-KEYX.

           IF ( LP1-CURSOR-NG-STAT-GOOD )
              PERFORM CLOSE-LP1-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  DEFAULT THE WBEG AND WEND
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( QLP1-WEND-SEQNO = ZEROES    ) OR
              ( QLP1-WEND-SEQNO NOT NUMERIC )
              MOVE LP-PATH-OWNBR        TO QLP1-WBEG-BRNO
              MOVE LP-PATH-OWNBR        TO QLP1-WEND-BRNO
              MOVE LP-ACCTNO            TO QLP1-WBEG-ACCTNO
              MOVE LP-ACCTNO            TO QLP1-WEND-ACCTNO
              MOVE ALL "0"              TO QLP1-WBEG-SEQNO
              MOVE LP-SEQNO             TO QLP1-WEND-SEQNO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           EXEC SQL
            DECLARE LP1_CURSOR_NG CURSOR FOR
            SELECT LPFILE.LP_BRNO,
                   LPFILE.LP_ACCTNO,
                   LPFILE.LP_SEQNO,
                   CAST(LPFILE.LP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_USERID,
                   CAST(LPFILE.LP_POSTDATE AS VARCHAR(10)),
                   LPFILE.LP_POSTTIME,
                   CAST(LPFILE.LP_TRDATE AS VARCHAR(10)),
                   CAST(LPFILE.LP_PAYDATE AS VARCHAR(10)),
                   LPFILE.LP_TRCD,
                   LPFILE.LP_REFNO,
                   LPFILE.LP_TRAMT,
                   LPFILE.LP_APOTH,
                   LPFILE.LP_APOT2,
                   LPFILE.LP_APINT,
                   LPFILE.LP_APLC,
                   LPFILE.LP_APCUR,
                   LPFILE.LP_OTHBAL,
                   LPFILE.LP_OT2BAL,
                   LPFILE.LP_INTBAL,
                   LPFILE.LP_LCBAL,
                   LPFILE.LP_CURBAL,
                   LPFILE.LP_INTDUE,
                   LPFILE.LP_DLPROC,
                   LPFILE.LP_EARNED_1,
                   LPFILE.LP_EARNED_2,
                   LPFILE.LP_EARNED_3,
                   LPFILE.LP_INTPAID,
                   LPFILE.LP_SSNO,
                   CAST(LPFILE.LP_PDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_TILLNO,
                   LPFILE.LP_APINTOWE,
                   LPFILE.LP_DLPARVHELD_ADJ,
                   LPFILE.LP_LT_SEQNO,
                   LPFILE.LP_IBPC,
                   LPFILE.LP_MANUAL_RB,
                   LPFILE.LP_INSTYPES,
                   LPFILE.LP_REV,
                   LPFILE.LP_REVTRCD,
                   LPFILE.LP_REVSEQNO,
                   LPFILE.LP_STATUSFG,
                   LPFILE.LP_NEWSTAT_RATE,
                   LPFILE.LP_LCPARTIALS,
                   LPFILE.LP_ADDON_ORIG_REGPY,
                   CAST(LPFILE.LP_NEW1ST_PYDATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_DEF_DUEDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_LCPAID,
                   CAST(LPFILE.LP_OLD1ST_PYDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_DEF_TERM,
                   LPFILE.LP_ADDON_LAST_PYAMT,
                   LPFILE.LP_DLRVCHGS_ADJ_1,
                   LPFILE.LP_DLRVCHGS_ADJ_2,
                   LPFILE.LP_DLRVCHGS_ADJ_3,
                   LPFILE.LP_DLPARVPAID_ADJ,
                   LPFILE.LP_DLNO,
                   LPFILE.LP_PREPAY_PENALTY,
                   LPFILE.LP_PRORATED_INS_REB,
                   LPFILE.LP_POSTING_BR,
                   LPFILE.LP_NOLCHG,
                   LPFILE.LP_COLLECTOR,
                   LPFILE.LP_EXTRA_PRIN_LFP,
                   LPFILE.LP_REMAIN_INT_SINCE_LFP,
                   LPFILE.LP_REMAIN_PRIN_SINCE_LFP,
                   LPFILE.LP_APPLIED_TO_ESCROW,
                   LPFILE.LP_ESCROW_PREPAID,
                   LPFILE.LP_PRIOR_POOLID,
                   CAST(LPFILE.LP_ADDON_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_FROMCL,
                   LPFILE.LP_TOCL,
                   LPFILE.LP_ALT_PREPAY_FG,
                   LPFILE.LP_REPAY_TRANS_ID
            FROM DBO.LPFILE
            WHERE LPFILE.LP_BRNO    = :QLP1-WEND-BRNO
              AND LPFILE.LP_ACCTNO  = :QLP1-WEND-ACCTNO
              AND LPFILE.LP_SEQNO  <= :QLP1-WEND-SEQNO 
            ORDER BY LPFILE.LP_BRNO DESC,
                     LPFILE.LP_ACCTNO DESC,
                     LPFILE.LP_SEQNO DESC
           END-EXEC.

           EXEC SQL
               OPEN LP1_CURSOR_NG
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLP1-WBEG-BRNO 
                          QLP1-WEND-BRNO
                          QLP1-WBEG-ACCTNO
                          QLP1-WEND-ACCTNO
                          QLP1-WBEG-SEQNO
                          QLP1-WEND-SEQNO.

           MOVE STAT---GOOD TO LP1-CURSOR-NG-STAT.

      *-----------------------------------------------------------------
       READ-LP1-FILE.
           PERFORM READ-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO. 
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP1-KEY        TO E-KEYX.
           INITIALIZE QLP-REC.

           MOVE LP-BRNO   TO QLP-BRNO.
           MOVE LP-ACCTNO TO QLP-ACCTNO.
           MOVE LP-SEQNO  TO QLP-SEQNO.

           EXEC SQL
            SELECT LPFILE.LP_BRNO,
                   LPFILE.LP_ACCTNO,
                   LPFILE.LP_SEQNO,
                   CAST(LPFILE.LP_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_USERID,
                   CAST(LPFILE.LP_POSTDATE AS VARCHAR(10)),
                   LPFILE.LP_POSTTIME,
                   CAST(LPFILE.LP_TRDATE AS VARCHAR(10)),
                   CAST(LPFILE.LP_PAYDATE AS VARCHAR(10)),
                   LPFILE.LP_TRCD,
                   LPFILE.LP_REFNO,
                   LPFILE.LP_TRAMT,
                   LPFILE.LP_APOTH,
                   LPFILE.LP_APOT2,
                   LPFILE.LP_APINT,
                   LPFILE.LP_APLC,
                   LPFILE.LP_APCUR,
                   LPFILE.LP_OTHBAL,
                   LPFILE.LP_OT2BAL,
                   LPFILE.LP_INTBAL,
                   LPFILE.LP_LCBAL,
                   LPFILE.LP_CURBAL,
                   LPFILE.LP_INTDUE,
                   LPFILE.LP_DLPROC,
                   LPFILE.LP_EARNED_1,
                   LPFILE.LP_EARNED_2,
                   LPFILE.LP_EARNED_3,
                   LPFILE.LP_INTPAID,
                   LPFILE.LP_SSNO,
                   CAST(LPFILE.LP_PDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_TILLNO,
                   LPFILE.LP_APINTOWE,
                   LPFILE.LP_DLPARVHELD_ADJ,
                   LPFILE.LP_LT_SEQNO,
                   LPFILE.LP_IBPC,
                   LPFILE.LP_MANUAL_RB,
                   LPFILE.LP_INSTYPES,
                   LPFILE.LP_REV,
                   LPFILE.LP_REVTRCD,
                   LPFILE.LP_REVSEQNO,
                   LPFILE.LP_STATUSFG,
                   LPFILE.LP_NEWSTAT_RATE,
                   LPFILE.LP_LCPARTIALS,
                   LPFILE.LP_ADDON_ORIG_REGPY,
                   CAST(LPFILE.LP_NEW1ST_PYDATE
                                                  AS VARCHAR(10)),
                   CAST(LPFILE.LP_DEF_DUEDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_LCPAID,
                   CAST(LPFILE.LP_OLD1ST_PYDATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_DEF_TERM,
                   LPFILE.LP_ADDON_LAST_PYAMT,
                   LPFILE.LP_DLRVCHGS_ADJ_1,
                   LPFILE.LP_DLRVCHGS_ADJ_2,
                   LPFILE.LP_DLRVCHGS_ADJ_3,
                   LPFILE.LP_DLPARVPAID_ADJ,
                   LPFILE.LP_DLNO,
                   LPFILE.LP_PREPAY_PENALTY,
                   LPFILE.LP_PRORATED_INS_REB,
                   LPFILE.LP_POSTING_BR,
                   LPFILE.LP_NOLCHG,
                   LPFILE.LP_COLLECTOR,
                   LPFILE.LP_EXTRA_PRIN_LFP,
                   LPFILE.LP_REMAIN_INT_SINCE_LFP,
                   LPFILE.LP_REMAIN_PRIN_SINCE_LFP,
                   LPFILE.LP_APPLIED_TO_ESCROW,
                   LPFILE.LP_ESCROW_PREPAID,
                   LPFILE.LP_PRIOR_POOLID,
                   CAST(LPFILE.LP_ADDON_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LPFILE.LP_FROMCL,
                   LPFILE.LP_TOCL,
                   LPFILE.LP_ALT_PREPAY_FG,
                   LPFILE.LP_REPAY_TRANS_ID
            INTO :QLP-REC
            FROM DBO.LPFILE
            WHERE LPFILE.LP_BRNO = :QLP-BRNO
              AND LPFILE.LP_ACCTNO = :QLP-ACCTNO
              AND LPFILE.LP_SEQNO = :QLP-SEQNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LP1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LP-FIELDS.

      *-----------------------------------------------------------------
       READ-LP1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP1-KEY        TO E-KEYX.
           INITIALIZE QLP-REC.

           IF ( LP1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LP1_CURSOR INTO :QLP-REC
              END-EXEC
           ELSE
           IF ( LP1-CURSOR-SC-STAT-GOOD )
              EXEC SQL
                   FETCH LP1_CURSOR_SC INTO :QLP-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LP1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LP-FIELDS.

      *-----------------------------------------------------------------
       READ-LP1-FILE-PREVIOUS.
           PERFORM READ-IT.
           MOVE LP-PATH-OWNBR  TO LP-BRNO.
           MOVE LP-PATH-SQL    TO E-FILE.
           MOVE LP1-KEY        TO E-KEYX.
           INITIALIZE QLP-REC.

           IF ( LP1-CURSOR-NG-STAT-GOOD )
              EXEC SQL
                   FETCH LP1_CURSOR_NG INTO :QLP-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDPVCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LP1-FILE-PREVIOUS.

           IF ( IO-FG = 0 )
              PERFORM GET-LP-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LP1-FILE.

           PERFORM CLOSE-IT.
           IF ( LP1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LP1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LP1-CURSOR-STAT.

           IF ( LP1-CURSOR-NG-STAT-GOOD )
              EXEC SQL
                   CLOSE LP1_CURSOR_NG
              END-EXEC
              MOVE STAT---BAD TO LP1-CURSOR-NG-STAT.

           IF ( LP1-CURSOR-SC-STAT-GOOD )
              EXEC SQL
                   CLOSE LP1_CURSOR_SC
              END-EXEC
              MOVE STAT---BAD TO LP1-CURSOR-SC-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLP1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLXE1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLXE1RN
       LOAD-LXE1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LXE-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LXE-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LXE-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LXE-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LXE-ALL-DATA
              MOVE LXE-ALL-PATH             TO LXE-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LXE-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LXE-ALL-BASE
              MOVE FILPATH-MACHINE         TO LXE-ALL-MACHINE
              MOVE FILPATH-DATA            TO LXE-ALL-DATA
              MOVE LXE-ALL-PATH             TO LXE-PATH.

      *-----------------------------------------------------------------
       OPEN-LXE1-FILE.
           PERFORM LOAD-LXE1-FILE.
           PERFORM OPEN-IT.
           MOVE LXE-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-LXE1-FILE.
           PERFORM START-IT.
           MOVE LXE-PATH-OWNBR  TO LXE-BRNO.
           MOVE LXE-PATH-SQL    TO E-FILE.
           MOVE LXE1-KEY        TO E-KEYX.

           IF ( LXE1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LXE1-FILE.

           IF ( QLXE1-WEND-SEQNO = ZEROES    ) OR
              ( QLXE1-WEND-SEQNO NOT NUMERIC )
              MOVE LXE-PATH-OWNBR        TO QLXE1-WBEG-BRNO
              MOVE LXE-PATH-OWNBR        TO QLXE1-WEND-BRNO
              MOVE LXE-ACCTNO            TO QLXE1-WBEG-ACCTNO
              MOVE ALL "9"               TO QLXE1-WEND-ACCTNO
              MOVE LXE-SEQNO             TO QLXE1-WBEG-SEQNO
              MOVE ALL "9"               TO QLXE1-WEND-SEQNO.

           EXEC SQL
            DECLARE LXE1_CURSOR CURSOR FOR
            SELECT LXEFILE.LXE_BRNO,
                   LXEFILE.LXE_ACCTNO,
                   LXEFILE.LXE_SEQNO,
                   CAST(LXEFILE.LXE_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LXEFILE.LXE_EARN_1,
                   LXEFILE.LXE_EARN_2,
                   LXEFILE.LXE_EARN_3,
                   LXEFILE.LXE_EARN_4,
                   LXEFILE.LXE_EARN_5,
                   LXEFILE.LXE_EARN_6,
                   LXEFILE.LXE_EARN_7,
                   LXEFILE.LXE_WORKER,
                   LXEFILE.LXE_WORKER2
            FROM DBO.LXEFILE
            WHERE LXEFILE.LXE_BRNO  = :QLXE1-WBEG-BRNO
              AND LXEFILE.LXE_ACCTNO >= :QLXE1-WBEG-ACCTNO
              AND LXEFILE.LXE_ACCTNO <= :QLXE1-WEND-ACCTNO
              AND LXEFILE.LXE_SEQNO >= :QLXE1-WBEG-SEQNO
              AND LXEFILE.LXE_SEQNO <= :QLXE1-WEND-SEQNO
            ORDER BY LXEFILE.LXE_BRNO,
                     LXEFILE.LXE_ACCTNO,
                     LXEFILE.LXE_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LXE1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLXE1-WBEG-BRNO
                          QLXE1-WEND-BRNO
                          QLXE1-WBEG-ACCTNO
                          QLXE1-WEND-ACCTNO
                          QLXE1-WBEG-SEQNO
                          QLXE1-WEND-SEQNO.


           MOVE STAT---GOOD TO LXE1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-LXE1-FILE.
           PERFORM READ-IT.
           MOVE LXE-PATH-OWNBR  TO LXE-BRNO. 
           MOVE LXE-PATH-SQL    TO E-FILE.
           MOVE LXE1-KEY        TO E-KEYX.
           INITIALIZE QLXE-REC.

           MOVE LXE-BRNO   TO QLXE-BRNO.
           MOVE LXE-ACCTNO TO QLXE-ACCTNO.
           MOVE LXE-SEQNO TO QLXE-SEQNO.

           EXEC SQL
            SELECT LXEFILE.LXE_BRNO,
                   LXEFILE.LXE_ACCTNO,
                   LXEFILE.LXE_SEQNO,
                   CAST(LXEFILE.LXE_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LXEFILE.LXE_EARN_1,
                   LXEFILE.LXE_EARN_2,
                   LXEFILE.LXE_EARN_3,
                   LXEFILE.LXE_EARN_4,
                   LXEFILE.LXE_EARN_5,
                   LXEFILE.LXE_EARN_6,
                   LXEFILE.LXE_EARN_7,
                   LXEFILE.LXE_WORKER,
                   LXEFILE.LXE_WORKER2
            INTO :QLXE-REC
            FROM DBO.LXEFILE
            WHERE LXEFILE.LXE_BRNO = :QLXE-BRNO
              AND LXEFILE.LXE_ACCTNO = :QLXE-ACCTNO
              AND LXEFILE.LXE_SEQNO = :QLXE-SEQNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LXE1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LXE-FIELDS.

      *-----------------------------------------------------------------
       READ-LXE1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LXE-PATH-OWNBR  TO LXE-BRNO.
           MOVE LXE-PATH-SQL    TO E-FILE.
           MOVE LXE1-KEY        TO E-KEYX.
           INITIALIZE QLXE-REC.

           IF ( LXE1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LXE1_CURSOR INTO :QLXE-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LXE1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LXE-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LXE1-FILE.

           PERFORM CLOSE-IT.
           IF ( LXE1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LXE1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LXE1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLXE1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPLXG1RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPLXGE1RN
       LOAD-LXG1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LXG-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LXG-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LXG-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LXG-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LXG-ALL-DATA
              MOVE LXG-ALL-PATH             TO LXG-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LXG-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LXG-ALL-BASE
              MOVE FILPATH-MACHINE         TO LXG-ALL-MACHINE
              MOVE FILPATH-DATA            TO LXG-ALL-DATA
              MOVE LXG-ALL-PATH             TO LXG-PATH.

      *-----------------------------------------------------------------
       OPEN-LXG1-FILE.
           PERFORM LOAD-LXG1-FILE.
           PERFORM OPEN-IT.
           MOVE LXG-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-LXG1-FILE.
           PERFORM START-IT.
           MOVE LXG-PATH-OWNBR  TO LXG-BRNO.
           MOVE LXG-PATH-SQL    TO E-FILE.
           MOVE LXG1-KEY        TO E-KEYX.

           IF ( LXG1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LXG1-FILE.

           IF ( QLXG1-WEND-SEQNO = ZEROES    ) OR
              ( QLXG1-WEND-SEQNO NOT NUMERIC )
              MOVE LXG-PATH-OWNBR        TO QLXG1-WBEG-BRNO
              MOVE LXG-PATH-OWNBR        TO QLXG1-WEND-BRNO
              MOVE LXG-ACCTNO            TO QLXG1-WBEG-ACCTNO
              MOVE ALL "9"               TO QLXG1-WEND-ACCTNO
              MOVE LXG-SEQNO             TO QLXG1-WBEG-SEQNO
              MOVE ALL "9"               TO QLXG1-WEND-SEQNO.

           EXEC SQL
            DECLARE LXG1_CURSOR CURSOR FOR
            SELECT LXGFILE.LXG_BRNO,
                   LXGFILE.LXG_ACCTNO,
                   LXGFILE.LXG_SEQNO,
                   CAST(LXGFILE.LXG_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LXGFILE.LXG_GLNO_1,
                   LXGFILE.LXG_GLAMT_1,
                   LXGFILE.LXG_GLNO_2,
                   LXGFILE.LXG_GLAMT_2,
                   LXGFILE.LXG_GLNO_3,
                   LXGFILE.LXG_GLAMT_3
            FROM DBO.LXGFILE
            WHERE LXGFILE.LXG_BRNO  = :QLXG1-WBEG-BRNO
              AND LXGFILE.LXG_ACCTNO >= :QLXG1-WBEG-ACCTNO
              AND LXGFILE.LXG_ACCTNO <= :QLXG1-WEND-ACCTNO
              AND LXGFILE.LXG_SEQNO >= :QLXG1-WBEG-SEQNO
              AND LXGFILE.LXG_SEQNO <= :QLXG1-WEND-SEQNO
            ORDER BY LXGFILE.LXG_BRNO,
                     LXGFILE.LXG_ACCTNO,
                     LXGFILE.LXG_SEQNO
           END-EXEC.

           EXEC SQL
               OPEN LXG1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLXG1-WBEG-BRNO
                          QLXG1-WEND-BRNO
                          QLXG1-WBEG-ACCTNO
                          QLXG1-WEND-ACCTNO
                          QLXG1-WBEG-SEQNO
                          QLXG1-WEND-SEQNO.

           MOVE STAT---GOOD TO LXG1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-LXG1-FILE.
           PERFORM READ-IT.
           MOVE LXG-PATH-OWNBR  TO LXG-BRNO. 
           MOVE LXG-PATH-SQL    TO E-FILE.
           MOVE LXG1-KEY        TO E-KEYX.
           INITIALIZE QLXG-REC.

           MOVE LXG-BRNO   TO QLXG-BRNO.
           MOVE LXG-ACCTNO TO QLXG-ACCTNO.
           MOVE LXG-SEQNO TO QLXG-SEQNO.

           EXEC SQL
            SELECT LXGFILE.LXG_BRNO,
                   LXGFILE.LXG_ACCTNO,
                   LXGFILE.LXG_SEQNO,
                   CAST(LXGFILE.LXG_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LXGFILE.LXG_GLNO_1,
                   LXGFILE.LXG_GLAMT_1,
                   LXGFILE.LXG_GLNO_2,
                   LXGFILE.LXG_GLAMT_2,
                   LXGFILE.LXG_GLNO_3,
                   LXGFILE.LXG_GLAMT_3
            INTO :QLXG-REC
            FROM DBO.LXGFILE
            WHERE LXGFILE.LXG_BRNO = :QLXG-BRNO
              AND LXGFILE.LXG_ACCTNO = :QLXG-ACCTNO
              AND LXGFILE.LXG_SEQNO = :QLXG-SEQNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LXG1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LXG-FIELDS.

      *-----------------------------------------------------------------
       READ-LXG1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE LXG-PATH-OWNBR  TO LXG-BRNO.
           MOVE LXG-PATH-SQL TO E-FILE.
           MOVE LXG1-KEY        TO E-KEYX.
           INITIALIZE QLXG-REC.

           IF ( LXG1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LXG1_CURSOR INTO :QLXG-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LXG1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LXG-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LXG1-FILE.

           PERFORM CLOSE-IT.
           IF ( LXG1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE LXG1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO LXG1-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBLP\LPLXG1RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPWKI.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPWKI
       OPEN-WK-FILE-OUTPUT.
           PERFORM OPEN-IT.
           MOVE TEMP-PATH TO E-FILE.
           OPEN OUTPUT WK-FILE.
           IF IO-FG = 8
              GO TO OPEN-WK-FILE-OUTPUT.
           IF IO-FG = 7
              CLOSE WK-FILE
              GO TO OPEN-WK-FILE-OUTPUT.
           UNLOCK WK-FILE.
       OPEN-WK-FILE.
           PERFORM OPEN-IT.
           MOVE TEMP-PATH TO E-FILE.
           OPEN I-O WK-FILE.
           IF IO-FG = 8
              GO TO OPEN-WK-FILE.
           IF IO-FG = 7
              CLOSE WK-FILE
              GO TO OPEN-WK-FILE.
           UNLOCK WK-FILE.
       READ-WK-FILE.
           PERFORM READ-IT.
           MOVE TEMP-PATH TO E-FILE.
           MOVE WK-KEY TO E-KEYX.
           READ WK-FILE.
           IF IO-FG = 8
              GO TO READ-WK-FILE.
       WRITE-WK-FILE.
           PERFORM WRITE-IT.
           MOVE TEMP-PATH TO E-FILE.
           MOVE WK-KEY TO E-KEYX.
           WRITE WK-REC.
           IF IO-FG = 8
              GO TO WRITE-WK-FILE.
           UNLOCK WK-FILE.
       REWRITE-WK-FILE.
           PERFORM REWRITE-IT.
           MOVE TEMP-PATH TO E-FILE.
           MOVE WK-KEY TO E-KEYX.
           REWRITE WK-REC.
           IF IO-FG = 8
              GO TO REWRITE-WK-FILE.
           UNLOCK WK-FILE.
       DELETE-WK-FILE.
           PERFORM DELETE-IT.
           MOVE TEMP-PATH TO E-FILE.
           MOVE WK-KEY TO E-KEYX.
           DELETE WK-FILE.
           IF IO-FG = 8
              GO TO DELETE-WK-FILE.
           UNLOCK WK-FILE.
       CLOSE-WK-FILE.
           PERFORM CLOSE-IT.
           CLOSE WK-FILE.
      *================================================================*
      * END COPYBOOK: LIBLP\LPWKI.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\GBRC2RN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/GBRC2RN
       LOAD-RC2-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( RC-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( RC-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO RC-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO RC-ALL-MACHINE
              MOVE RC-ALL-PATH             TO RC-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( RC-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO RC-ALL-BASE
              MOVE FILPATH-MACHINE         TO RC-ALL-MACHINE
              MOVE RC-ALL-PATH             TO RC-PATH.

      *-----------------------------------------------------------------
       OPEN-RC2-FILE.
           PERFORM LOAD-RC2-FILE.
           PERFORM OPEN-IT.
           MOVE RC-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-RC2-FILE.
           PERFORM START-IT.
           MOVE RC-PATH-SQL TO E-FILE.
           MOVE RC2-KEY TO E-KEYX.

           IF ( RC2-CURSOR-STAT-GOOD )
              PERFORM CLOSE-RC2-FILE.

           IF ( QRC2-WEND-STATUS = SPACES )
              MOVE RC-STATUS            TO QRC2-WBEG-STATUS
              MOVE ALL "Z"              TO QRC2-WEND-STATUS
              MOVE RC-BRNO              TO QRC2-WBEG-BRNO
              MOVE ALL "9"              TO QRC2-WEND-BRNO

              MOVE RC-TRANS-DATE        TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD  TO QRC2-WBEG-TRANS-DATE

              MOVE EXT-JULIAN-END       TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD  TO QRC2-WEND-TRANS-DATE.

           EXEC SQL
            DECLARE RC2_CURSOR CURSOR FOR
            SELECT RCFILE.RC_STATUS,
                   RCFILE.RC_BRNO,
                   CAST(RCFILE.RC_TRANS_DATE AS VARCHAR(10)),
                   CAST(RCFILE.RC_LTOUCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_RECAP_FG,
                   RCFILE.RC_GL_FG,
                   RCFILE.RC_EOD_BATCH_FG,
                   RCFILE.RC_NIGHTLY_FUNDS_FG,
                   RCFILE.RC_EOM1_BATCH_FG,
                   RCFILE.RC_EOM_UPDATE_FG,
                   RCFILE.RC_EOM2_BATCH_FG,
                   RCFILE.RC_BS_P2P3_INBAL_FG,
                   RCFILE.RC_DEPOSIT,
                   RCFILE.RC_OVER_SHORT,
                   RCFILE.RC_CHECKS,
                   CAST(RCFILE.RC_OPENED_DATE AS VARCHAR(10)),
                   RCFILE.RC_OPENED_TIME,
                   RCFILE.RC_OP_USERID,
                   CAST(RCFILE.RC_CLOSED_DATE AS VARCHAR(10)),
                   RCFILE.RC_CLOSED_TIME,
                   RCFILE.RC_CL_USERID,
                   CAST(RCFILE.RC_UPDATED_DATE AS VARCHAR(10)),
                   RCFILE.RC_UPDATED_TIME,
                   CAST(RCFILE.RC_UPDATED_USERID AS VARCHAR(10)),
                   CAST(RCFILE.RC_EOD_BATCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOD_BATCH_TIME,
                   CAST(RCFILE.RC_FUNDS_DATE AS VARCHAR(10)),
                   RCFILE.RC_FUNDS_TIME,
                   CAST(RCFILE.RC_EARNINGS_DATE AS VARCHAR(10)),
                   RCFILE.RC_EARNINGS_TIME,
                   CAST(RCFILE.RC_EOM_UPDATED_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOM_UPDATED_TIME,
                   CAST(RCFILE.RC_EOM2_BATCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOM2_BATCH_TIME,
                   CAST(RCFILE.RC_CHECK_DATE AS VARCHAR(10)),
                   RCFILE.RC_CHECK_TIME,
                   RCFILE.RC_LAST_ACCRUE,
                   RCFILE.RC_ERROR_MSG,
                   RCFILE.RC_BANK_BAL,
                   RCFILE.RC_CHECK_DEPOSIT
            FROM DBO.RCFILE
            WHERE RCFILE.RC_STATUS >= :QRC2-WBEG-STATUS
              AND RCFILE.RC_STATUS <= :QRC2-WEND-STATUS
              AND RCFILE.RC_BRNO >= :QRC2-WBEG-BRNO
              AND RCFILE.RC_BRNO <= :QRC2-WEND-BRNO
              AND RCFILE.RC_TRANS_DATE >= :QRC2-WBEG-TRANS-DATE 
              AND RCFILE.RC_TRANS_DATE <= :QRC2-WEND-TRANS-DATE
            ORDER BY RCFILE.RC_STATUS,
                     RCFILE.RC_BRNO,
                     RCFILE.RC_TRANS_DATE
           END-EXEC.

           EXEC SQL
               OPEN RC2_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE SPACES TO QRC2-WBEG-STATUS
                          QRC2-WEND-STATUS
                          QRC2-WBEG-TRANS-DATE
                          QRC2-WEND-TRANS-DATE.

           MOVE ZEROES TO QRC2-WBEG-BRNO
                          QRC2-WEND-BRNO.

           MOVE STAT---GOOD TO RC2-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-RC2-FILE.
           PERFORM READ-IT.
           MOVE RC-PATH-SQL TO E-FILE.
           MOVE RC2-KEY TO E-KEYX.
           INITIALIZE QRC-REC.

           MOVE RC-STATUS        TO QRC-STATUS.
           MOVE RC-BRNO          TO QRC-BRNO.  
           MOVE RC-TRANS-DATE    TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD TO QRC-TRANS-DATE.

           EXEC SQL
            SELECT RCFILE.RC_STATUS,
                   RCFILE.RC_BRNO,
                   CAST(RCFILE.RC_TRANS_DATE AS VARCHAR(10)),
                   CAST(RCFILE.RC_LTOUCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_RECAP_FG,
                   RCFILE.RC_GL_FG,
                   RCFILE.RC_EOD_BATCH_FG,
                   RCFILE.RC_NIGHTLY_FUNDS_FG,
                   RCFILE.RC_EOM1_BATCH_FG,
                   RCFILE.RC_EOM_UPDATE_FG,
                   RCFILE.RC_EOM2_BATCH_FG,
                   RCFILE.RC_BS_P2P3_INBAL_FG,
                   RCFILE.RC_DEPOSIT,
                   RCFILE.RC_OVER_SHORT,
                   RCFILE.RC_CHECKS,
                   CAST(RCFILE.RC_OPENED_DATE AS VARCHAR(10)),
                   RCFILE.RC_OPENED_TIME,
                   RCFILE.RC_OP_USERID,
                   CAST(RCFILE.RC_CLOSED_DATE AS VARCHAR(10)),
                   RCFILE.RC_CLOSED_TIME,
                   RCFILE.RC_CL_USERID,
                   CAST(RCFILE.RC_UPDATED_DATE AS VARCHAR(10)),
                   RCFILE.RC_UPDATED_TIME,
                   CAST(RCFILE.RC_UPDATED_USERID AS VARCHAR(10)),
                   CAST(RCFILE.RC_EOD_BATCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOD_BATCH_TIME,
                   CAST(RCFILE.RC_FUNDS_DATE AS VARCHAR(10)),
                   RCFILE.RC_FUNDS_TIME,
                   CAST(RCFILE.RC_EARNINGS_DATE AS VARCHAR(10)),
                   RCFILE.RC_EARNINGS_TIME,
                   CAST(RCFILE.RC_EOM_UPDATED_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOM_UPDATED_TIME,
                   CAST(RCFILE.RC_EOM2_BATCH_DATE AS VARCHAR(10)),
                   RCFILE.RC_EOM2_BATCH_TIME,
                   CAST(RCFILE.RC_CHECK_DATE AS VARCHAR(10)),
                   RCFILE.RC_CHECK_TIME,
                   RCFILE.RC_LAST_ACCRUE,
                   RCFILE.RC_ERROR_MSG,
                   RCFILE.RC_BANK_BAL,
                   RCFILE.RC_CHECK_DEPOSIT
            INTO :QRC-REC
            FROM DBO.RCFILE
            WHERE RCFILE.RC_STATUS = :QRC-STATUS
              AND RCFILE.RC_BRNO = :QRC-BRNO
              AND RCFILE.RC_TRANS_DATE = :QRC-TRANS-DATE
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-RC2-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-RC-FIELDS.

      *-----------------------------------------------------------------
       READ-RC2-FILE-NEXT.
           PERFORM READ-IT.
           MOVE RC-PATH-SQL TO E-FILE.
           MOVE RC2-KEY        TO E-KEYX.
           INITIALIZE QRC-REC.

           IF ( RC2-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH RC2_CURSOR INTO :QRC-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-RC2-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-RC-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-RC2-FILE.
           PERFORM CLOSE-IT.
           IF ( RC2-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE RC2_CURSOR
              END-EXEC
              MOVE STAT---BAD TO RC2-CURSOR-STAT.

      *================================================================*
      * END COPYBOOK: LIBGB\GBRC2RN.CPY                                *
      *================================================================*
      *================================================================*
      * EMBEDDED COPYBOOK: LIBLP\LPOPIN.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBLP/LPOPIN
       LOAD-OP-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( OPEN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( OPEN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO OPEN-PATH-BASE
              MOVE EXT-FILPATH-MACHINE     TO OPEN-PATH-MACHINE
              MOVE OPEN-PATH-FORMAT        TO OPEN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( OPEN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO OPEN-PATH-BASE
              MOVE FILPATH-MACHINE         TO OPEN-PATH-MACHINE
              MOVE OPEN-PATH-FORMAT        TO OPEN-PATH.
      *-----------------------------------------------------------------
       OPEN-OP-FILE.
           PERFORM LOAD-OP-FILE.
           PERFORM OPEN-IT.
           MOVE OPEN-PATH TO E-FILE.
           OPEN I-O OP-FILE.
           IF IO-FG = 8
              GO TO OPEN-OP-FILE.
           IF IO-FG = 7
              PERFORM CLOSE-OP-FILE
              GO TO OPEN-OP-FILE.
      *-----------------------------------------------------------------
       OPEN-OP-FILE-OUTPUT.
           PERFORM LOAD-OP-FILE.
           PERFORM OPEN-IT.
           MOVE OPEN-PATH TO E-FILE.
           OPEN OUTPUT OP-FILE.
           IF ( IO-FG = 8 )
              GO TO OPEN-OP-FILE-OUTPUT.
           IF ( IO-FG = 7 )
              PERFORM CLOSE-OP-FILE
              GO TO OPEN-OP-FILE-OUTPUT.
      *-----------------------------------------------------------------
       CLOSE-OP-FILE.
           MOVE "CLOSE" TO E-MSG.
           CLOSE OP-FILE.
      *-----------------------------------------------------------------
      *================================================================*
      * END COPYBOOK: LIBLP\LPOPIN.CPY                                *
      *================================================================*

      *================================================================*
      * EMBEDDED COPYBOOK: LIBGB\FERRORS.CPY                           *
      *================================================================*
      * COPYMEMBER: LIBGB/FERRORS
      *    ****************************
      *    *    FILE ERRORS ROUTINES
      *    ****************************
       FILE-IO-ERROR SECTION.
       IO-ERROR.
           PERFORM FILE-ERRORS.
           PERFORM SEND-MESS.
      *================================================================*
      * END COPYBOOK: LIBGB\FERRORS.CPY                                *
      *================================================================*
           MOVE "E" TO ERRCD.

       END-PROGRAM.
           PERFORM CLOSE-FILES.

       EXIT-PROG.
       STOP-RUN.

           MOVE RETURN-STATUS TO RETURN-CODE.

           EXIT PROGRAM RETURNING RETURN-CODE.
