       IDENTIFICATION DIVISION.
       PROGRAM-ID.    UP1534.
       DATE-WRITTEN.  08-09-2019.
      ******************************************************************
      *
      *  IDENTIFICATION: UP/UP1534.C
      *
      *  DESCRIPTION   : UPGRADE A15 TO A34 FOR GLOBAL FILES:
      *       
      *  ASCII FILES ARE CREATED IN /USR/DATA/R1/ASCII; (TARGET)
      *                    ABWFILE.(GROUP) OR BEG-BR OR (ALL)
      *        WHEN ASCII FILE IS DONE, CREATES A TAG FILE IN
      *                            /USR/DATA/R1/ASCII/DONE
      *        WITH EXACT SAME SAME AS THE ASCII OUTPUT FILE
      *
      * GLOBALS:
      *   AL  [GL01AL] G/L ALLOCATION        
      *   AU  [GB01AU] NEW AUDIT/CHANGES FILE (REMOVED, KM SAID START FRESH)
      *   CD  [LP01CD] CODES                  (CDB NEW)
      *   CL  [LP01CL] CAN LOAN               SKIP "OK" AND "OKL" ON RISC2
      *   CP  [SP01CP] COLLECTOR POOLS        (LOCAL AND GLOBAL MERGED)
      *                (THIS PROGRAM CONVERTS GLOBAL CPFILE)
      *   EA  [LP01EA] EXTRACTION ACTION     
      *   FD  [LP01FD] DOC DESIGN             
      *   FS  [GL01FS] FINANCIAL STATEMENT    - NO, THEY DO NOT WANT
      *   GI  [GL01GI] G/L INTERFACE         
      *   GL+ [GL01GL] G/L MASTER            
      *   II  [SP01II] IRS IDENTIFICATION    
      *   IR  [LP01IR] INSURANCE RATE TABLE 
      *   JD  [GL01JT] G/L JOURNAL DETAIL
      *   LC  [LP01LC] LOAN CLASS            
      *   PE  [GB01PE] PASSWORD EXCEPTIONS    
      *   PW  [GB01PW] PASSWORD  - CANNOT CONVERT HASHED PASSWORD
      *   RB  [LP01RB] REBATE/CANCEL 
      *   RC+ [GB01RC] DAILY STATUS           SKIP 9990 ON RISC2
      *   SE  [GB01SE] USER SECURITY          (REMOVED, RUN SE1534)
      *   SN  [GB01SN] SECURITY PROGRAM NAME  (REMOVED, REBUILT MANUALLY)
      *   SM  [LP01SM] STATE PARAM MEMO      
      *   SP  [LP01SP] STATE PARAMETER       
      *   SS+ [LP01SS] CREDIT SCORE STATS    
      *   ST  [LP01ST] STATE FILE             (SU TRAILER)
      *   TRWINFO [SPFDTRWINFO] CREDIT BUREAU INFO FILE
      *   TZ  [LP01TZ] TIME ZONE             
      *   WR+ [SP01WR] RATING SHEET        
      *
      * LOCALS:
      *   BW+ [LP01BW] BORROWER
      *   BX+ [LP01BX] BORROWER TRAILER (KYC) KNOW YOUR CUSTOMER
      *   CA+ [LP01CA] CASH DRAWER
      *   CI+ [LP01CI] CUSTOMER INFO
      *   CK+ [LP01CK] CHECK MASTER
      *   DL  [LP01DL] DEALER MASTER
      *   DM  [LP01DM] DEALER MEMO 
      *   DT  [LP01DT] DEALER TRANS
      *   ES  [LP01ES] ESCROW
      *   GB  [GB01GB] GLOBAL 
      *   IC  [LP01IC] INSURANCE COMPANY
      *   IX+ [LP01IX] ALTERNATE VIN INDEX
      *   LE+ [LP01LE] LOAN ENDORSER
      *   LH+ [LP01LH] LOAN HISTORY
      *   LN+ [LP01LN] LOAN MASTER
      *   LP+ [LP01LP] LOAN PAYMENT
      *   LS+ [LP01LS] LOAN TRAILER (STATUS) SPLIT OUT
      *   LT+ [LP01LT] LOAN TRAILER SPLIT OUT
      *   LX+ [LP01LX] LOAN PAYMENT TRAILER 
      *   ML+ [LP01ML] MAIL LIST    ***** REMOVED ***** NO LONGER UPGRADING
      *   MP  [LP01MP] MEMO PAYMENT
      *   PC  [LP01PC] SAVED LOAN COLLATEARL
      *   PD  [LP01PD] SAVED LOANS/HALF RENEWALS
      *   TY+ [LP01TY] TODAYS TOTALS
      *
      *     + MEANS THAT ASCII EXTRACTION FILE AVAILABLE
      *
      *=================================================================
      * REV:
      * JKC 2019-1014 UPGRADE OF THE CDFILE GAVE AN ERROR OF "9D,25"
      *               ON THE RISC 1 & 2 FILES.  THE REASON IS ONE
      *               RECORD, SAME ON RISC 1 & 2, HAD A KEY OF
      *               "CN:647   ".  THE OCD-CN-BRANCH IS PIC 9(4) COMP-3
      *               WHICH ":647" IS NOT NUMERIC.  SO IT APPEARS THAT
      *               ACU4GL GIVES A STAT OF "9D,25" FOR NUMERIC FIELDS
      *               COLUMNS WITH NON-NUMERIC DATA.  SO WE ARE SKIPPING
      *               THESE ERRORS WHICH ARE PLACED IN THE REPORT.
      *
      * BAH 2019-1210 ADDED SOME CLEANSING (SEARCH FOR CLEANSE)
      *
      * JKC 2020-0123 ADDED SOME LOGIC TO DISPLAY ACU4GL ERRORS.
      *               THERE IS A COPY OF LIBGB/DECLARE.CPY NO IN
      *               LIBUP/DECLARE.CPY IN ORDER TO DISPLAY UNIQUE
      *               ERRORS.
      *
      * JKC 2020-0218 RESTORED USING LIBGB/DECLARE.CPY INSTEAD OF
      *               LIBUP/DECLARE.CPY; ADDED THE DISPLAY OF
      *               ACU4GL ERRORS TO THE STANDARD DECLARE COPY
      *               MEMBERS (DECLARE/DECLAREOD/DECLRP).
      * BAH 2020-0220 ADDED JDFILE
      *
      * KEC 2020-0317 PT0213 MADE SEVERAL CHANGES BASED ON NEW INFO:
      *          ADD CXFILE, RXFILE;
      *          REMOVE EPFILE, EWFILE, FDFILE, RBFILE, DMFILE,
      *                 ESFILE, PCFILE, PDFILE
      * BAH 2020-0327 SKIP BY RECS THAT ARE PRIOR TO THE YEAR 2000 (PT0214)
      *               SKIP CONVERTING DSFILE ALL TOGETHER, START EMPTY
      *               SKIP SSFILE RECORDS OLDER THAN 6 YEARS FROM SYSTEM
      *
      * BAH 2020-0408 ADDED FILE EXTENSIONS FOR BRANCH/GROUP RANGES. IF
      *               F3-ALL WILL CREATE AXXFILE.ALL, BRANCH RANGE WILL
      *               CREATE AXXFILE.(BEGBR), GROUP WILL CREATE
      *               AXXFILE.(GROUP). CREATE A DONE TAG FOR BRIAN,
      *               IN /USR/DATA/R1/ASCII/DONE. WILL HAVE SAME EXTENSION
      *               AS ASCII FILE. GLOBAL DONE TAG GETS CREATED WHEN
      *               ALL GLOBALS ARE DONE, LOCAL FILE TAGS GET CREATED
      *               AFTER ALL LOCALS ARE DONE, ALL BRANCHES MUST FINISH.
      * BAH 2020-0422 ASCII LOAN CLEAR WAS CLEARING LN-.-REB FLAGS INSTEAD
      *               OF ASCII AND 6 OF THEM WERE NOT GETTING OLN FIELDS
      *               MOVED TO THEM BECAUSE THEY DIDNT EXIST SO THEY STAYED
      *               TABS , BRIAN FOUND
      * BAH 2020-0423 CHANGED TO AUTOMATICALLY CREATE ASCII AND DONE DIRS
      * BAH 2020-0427 CLEANSE ALN-LAST-ACCRUAL-DATE, BRIAN FOUND 10/53/1976
      * BAH 2020-0427 FOUND A DUPLICATE KEY IN BR 482 BMFILE. HARD CODED AN
      *               'IF' STATEMENT TO GET AROUND IT, BUT KM IS GOING TO RUN
      *               A REBUILD TO FIX IT.
      * BAH 2020-0428 FOUND DUPLICATE KEYS IN BR 23 LHFILE. SKIP IF 
      *               OLH-LOANDATE = 0, GARBAGE LOANS
      * BAH 2020-0428 REMOVED ASCII ABILITY, CANT CATCH R2 DUPLICATES FOR
      *               ASCII, COMMENTED OUT CONVERT OF WRFILE FROM RISC2. KM
      *               NOTES MENTIONS RISC2 NOT UPDATING THE WRFILE, ALL DONE
      *               ON RISC1.
      * BAH 2020-0504 FOUND A DUPLICATE KEY IN BR 482 BMFILE. 
      *               REMOVED THE HARD CODED 'IF' STATEMENT.
      *               CLEANSE LN-GIFTNET-OUR-PO
      *               CLEANSE LN-LCPDTH-DATE, LN-INTPDTH-DATE
      *                       BX-KYC-ISSDATE, BX-KYC-EXPDATE, VERDATE
      *               CLEANSE CK-DLRVNO, SOME HAD SPACES
      * BAH 2020-0505 CLEANSE LTB-CHAPTER, A15 HAD A REDEFINES PIC XX.
      *               CLEAR-ALX-FILE MISSING ALXA-SRCD
      *               MISSING CLEAR OF ALXG-FUTURE-GLNO & GLAMT
      *
      * JKC 2020-0528 PER KEVIN MULLEN'S REQUEST IN AN EMAIL, ADDED
      *               UPGRADING THE RISC 2 PEFILE WITH SKIPPING
      *               DUPLICATE RECORDS.
      * BAH 2020-0817 ADD OPEN OUTPUT BEFORE ALL ASCII OPEN I-O. 
      *               A34 XCBLCONFIG HAS IO-CREATES 0, IT WONT CREATE A FILE
      *               WITH AN OPEN I/O, ONLY WITH AN OUTPUT.
      * BAH 2020-0925 ADDED ALTB-GROSS-BAL, #1461
      *  CS 2021-0503 CHANGED TESTS ON EA-LNDATE-DAYS2,EA-MATURE-DAYS2,
      *               IF = 2020. IF EA-DAY-OF-MO-DUE1 = 20-CHANGED TO 1
      *               IF EA-DAY-OF-MO-DUE2 = 20, CHANGED TO 31
      * BAH 2021-0913 KM SAID WE CAN LIMIT BYFILE UPGRADE TO PAST 10 YEARS
      * BAH 2021-1118 CHANGED SETTING CD-ELUNITPER-CD SINCE IT WAS
      *          PIC 9 BUT NOW PIC X.
      * BAH 2022-0215 EA-DAY-OF-MO-DUE2 WAS NOT BEING SET!
      * BAH 2022-0322 ADDED NEW GLOBAL AUFILE
      * BAH 2022.0627 RENAMED EXT-ACUSQL-ODBC-NAME TO EXT-ACUSQL-DSN-NAME
      * BAH 2022.0811 TEST ALL NUMERICS
      * BAH 20220921  UPDATE LSM-MISPAY-90-DATE AND CLEAR-LSM-FILE #1570
      * JKC 2023-0424 MOVED AUFILE INTO ALPHABETICAL ORDER BY ON THE 
      *               SCREEN, BUT THEN COMMENTED IT OUT SINCE KEVIN
      *               MULLEN SAID WE DO NOT NEED TO UPGRADE BECAUSE
      *               WE CAN START THAT FILE FROM SCRATCH (BETH WAS
      *               QUESTIONING HIM ON HOW TO HANDLE MERGING RISC1 AND
      *               RISC2 RECORDS).
      *               MOVED  'PERFORM UP1534-CREATE-FILE-UPDATE' TO BE
      *               UNDER 'ELSE' FOR 'IF ( IO-BAD )' SO THAT IT DOES
      *               NOT CREATE EXCESSIVE RECORDS IN THE REPORT FILE
      *               FOR BY GI GL GT AND RC FILES.
      * JKC 2023-0503 ADDED 'PERFORM LOAD-XX1-FILE' TO ALL THE LOCAL
      *               ASCII FILE LOGIC SO THAT IT POPULATES THE 
      *               HOLD-SORT-STATE FIELD SO THAT IT UPDATES THE 
      *               MSEXCEL FILE.
      * JKC 2023-0508 CHANGED THE F9-KEY OPTION ON LOCAL FILES TO USE
      *          "Y" INSTEAD OF "N"; WILL MOST LIKELY USE THIS SETTING
      *          FOR LIVE PRODUCTION.
      * JKC 2023-0824 ADDED UPDATED VERSION OF 'LIBGB/CONNECT_SQL.CPY'
      *               THAT IS HARDCODED WITHIN UP1534; ADDED NEW
      *               VERSION OF SQL-TEXT-DECREMENT, SQL-TEXT-INCREMENT,
      *               SQL-TEXT-FIND-ASCII.
      * BAH 2023-0907 REMOVED PAFILE AS PER KEVIN EMAIL 9/7/2023
      *               WAS USED FOR MEXICO, VERIFIED NO VALID RECORDS
      * BAH 2024-0109 UPDATE LSM-SECOND-BEN FIELDS #1637
      * BAH 2024-0124 REMOVED ASCII CREATE FOR THE LX RECORDS, WAS NOT WORKING!
      * JKC 2024-0124 FOR THE LEFILE, WE ARE NOW SKIPPING A15 LE-REC
      *          WHERE THE TYPE IS NOT EQUAL TO "R": 
      *             IF OLE-TYPE NOT "R"
      *          PER KEVIN MULLEN, WE DO NOT NEED TO MIGRATE TO S35.
      *          
      * JKC 2024-0215 COPIED UP/UP1534 TO BE UP/DATE35; REMOVED FROM
      *          UP1534 THE FOLLOWING AND PUT INTO DATE35:
      *             BY+ [LP01BY] BRANCH STATS          
      *             GT+ [GL01GT] G/L TRANSACTIONS      
      *             BM+ [LP01BM] BORROWER MEMO
      *             CJ+ [SP01CJ] COLLECTOR JOURNAL
      *             LM+ [LP01LM] LOAN MEMO
      *          NOTE: STILL NEED OBMFILE FOR OBWFILE UPGRADE!!!!!
      *
      * JKC 2024-0223 ADDED TRACE LOGIC
      *
      * JKC 2024-0314 WITHIN CREATE-GLOBAL-DONE-TAGS SECTION AND
      *               CREATE-DONE-TAGS SECTION, NEED TO CHECK IF THE
      *               'DONE-PATH-BEG' AND 'DONE-PATH-GROUP' IS NOT EQUAL
      *               SPACES; IT WILL BE EQUAL SPACES IF A GIVEN FILE'S
      *               SOURCE FILE WAS NOT FOUND;  IF THE SOURCE FILE IS
      *               FOUND THEN IT WILL POPULATE THE 'DONE-PATH-GROUP';
      *               NEED THIS CHECKBECAUSE IT WILL STOP EXECUTION
      *               WITH A FILE IO-ERROR WINDOW.
      *
      * JKC 2024-0318 ADDED TO THE TRACE INITIALIZATION:
      *               + SQL DATABASE NAME
      *               + SQL SERVER NAME
      *               + BEGINNING DATE 
      *               + ENDING DATE 
      *
      * JKC 2024-0324 ADDED SYSTEM DATE TO THE "OTIS SESSION STARTED"
      *               LINE.
      *
      * JKC 2024-0325 CHANGED TO NOT MOVE THE A15 BRFILE TO BE OBRFILE;
      *     THIS WAS OLD ACU4GL LOGIC WHERE WE NEED TO MAKE IT OBRFILE;
      *     THIS OLD LOGIC CAUSED A LOCKING ISSUE WHEN RUNNING
      *     MULTIPLE SESSIONS VIA BATCHES (HAD 8 SESSIONS).
      *     NOW GOING TO USE DIRECTLY THE A15 BRFILE AS IS.
      *
      * RMZ 2024-0410 LS-X-OTH-EXP-TBL IS CURRENTLY ONLY PROCESSING 2  
      *     OCCURANCES OF THE TABLE, AND THE TABLE HAS 3 OCCURANCES.  
      *     CHANGED CODE TO PROCESS 3RD OCCURANCE FILEDS ALSO.
      *
      * JKC 2024-0410 FIXED ISSUE OF NOT PROPERLY POPULATING
      *     LP-PRIOR-POOLID.
      *     PER KEVIN, CHANGED PROCESSING TYFILE RECORDS TO ONLY
      *     UPGRADE RECORDS FROM 2023 ONWARD; ONLY REALLY NEED ONE
      *     FISCAL YEAR OF TYFILE RECORDS; THE VERY OLD RECORDS WE
      *     HAVE BEEN UPGRADING ARE BELIEVED FROM CLOSED BRANCHES.
      *
      * JKC 2024-0410 MODIFIED THE UPGRADE OF CDFILE FOR FEECODES (GC)
      *     WHERE LOWERCASE X5 AND Z1; THERE IS NO X5 IN USE; THERE IS
      *     CONFLICT OF LOWER & UPPER Z1 WHICH NO LOWER Z1 IN USE AND
      *     CANNOT OVERWRITE UPPER Z1 DATA.
      * JKC 2024-0503 FOUND RECORDS WITH ZERO ACCOUNT NUMBERS;
      *     PER KEVIN MULLEN WE CAN SKIP LOADING THERE RECORDS IN 
      *     DATABASE; SKIPPED RECORDS LH (6), LN (4), LTC (1).
      * BAH 2024-0718 ADDED DATABASE NAME AND SERVER NAME TO RANGE LINES
      *                                                         S35Q-102
      * BAH 2024-0730 OLN-INTPDTH = 0 WAS MOVING LOANDATE OR POFFDATE
      *               FROM A BAD CLEANSE. IF DATE IS ALL 0'S, MOVE IT
      *               TO LN-INTPDTH-DATE AND MOVE ON! 
      * JKC 2024-1022 ADDED `IF OCX-TILLNO NOT NUMERIC` DUE TO ISSUE.
      * JKC 2024-1024 CHANGED POPULATING AGL-BRANCH & AGL-ACCOUNT
      *          TO NOW USE OGL-BR-ACCOUNT (OGL-NUMKEY).
      * BAH 2024-1025 ADDED LP-REPAY-TRANS-ID AND LP-ALT-PREPAY-FG
      * JKC 2024-1107 CHANGED 'UPGRADE-FILE-LT SECTION.' BY ADDING
      *     'ELSE' TO ALL 'IF' WITH A FINAL 'ELSE' TO ADD ONE TO THE
      *     SKIP COUNTER TO GET AN ACCURATE COUNT OF THE LT-REC PROCESS.
      * JKC 2024-1122 ADDED ADDITION CODE FOR LP-REPAY-TRANS-ID FOR SPACES:
      *     IF OLP-REPAY-TRANS-ID NOT NUMERIC OR
      *        OLP-REPAY-TRANS-ID = 0202020202 OR
      *        OLP-REPAY-TRANS-ID = 2020202020
      * BAH 2024.1204 ADDED BW-CEASE-DESIST-DATE & BW-CEASE-DESIST-TYPE #1686
      *                                                         S35Q-145
      * JKC 2024.1206 ADDED BW-UMC-EXPIRE-DATE AND BW-UMC-PR-EXPIRE-DATE
      * JKC 2024.1212 ADDED LOGIC TO REMOVE SORT WORKFILE.
      * 
      * JKC 2024-1216 SKIPPING BRANCH 9991 DUE TO A15 BRFILE SAYING
      *     IT IS A 'R1' WHEN S35 HAS IT AS 'R2'; THERE IS NO DATA
      *     FOR 'R2' BUT THERE IS FOR 'R1' WHICH IS THROWING OFF
      *     COMPARISONS AND COUNTS.
      *
      * RMZ 2025-0218 CHANGED CAFILE PROCESSING TO BYPASS ALL RECORDS
      *               OVER 5 YEARS OLD, FROM THE END-OF-MONTH DATE
      *               THIS PROGRAM IS RUNNING IN.
      *
      * JKC 2025-0225 ADDED TO UPGRADE-FILE-CD THE CODE TYPE "A2"
      * BAH 2025-0311 ADDED TRW-INFO-INNOVIS-ID #1702 S35Q-169
      * BAH 2025-0403 ADDED IF OCD-CN-PHONE =  2020202020 OR 0202020202 OR 

      *                          202020000 
      * JKC 2025-0403 THE OCD-COMM FIELDS ARE COMP-6 AND A NUMERIC
      *          CHECK DOES NOT WORK; NEED TO MOVE THEM TO A WSS FIELD
      *          TO DO A NUMERIC CHECK.
      *
      * JKC 2025-0403 FOR THE 11TH AND 12TH OCCURENCE OF 
      *          CD-CT-INSTAXAMT AND CD-CY-INSTAXAMT SINCE WE FOUND
      *          IN S35 USER TESTING QUITE A FEW WERE SET AS '20.2'
      *
      * JKC 2025-0403 FIXED LSD-AUCT-TIME AND LSD-AUCT-PHONE FOR A 
      *          IF NOT NUMERIC CHECK USING '202020' SERIES.
      * BAH 2025-0407 FIXED LSX-CYLINDERS, LSX-AGENT-PHONE AND 
      *               LSX-AGENT-FAX FOR COMP-6 202020, NUMERIC DOESNT WORK
      * JKC 2025-0409 PER BRIAN, REMOVED THE UPGRADE OF LTAFILE; MOST OF
      *          THE RECORDS WITHIN THE A15 LTFILE FOR TYPE OF "A" WAS
      *          EMPTY OR BAD DATA; WAS NOT WIDELY USED AND LAST RECORD
      *          WAS CREATED 10/2021.
      *
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBGB/GBFSPR.CPY".
       COPY "LIBSP/SPFSSORT.CPY".

      * ASCII GLOBAL UPLOAD FILES
       COPY "LIBUP/UPFSAGL.CPY".
       COPY "LIBUP/UPFSARC.CPY".
       COPY "LIBUP/UPFSAWR.CPY".

      * ASCII LOCAL UPLOAD FILES
       COPY "LIBUP/UPFSABW.CPY".
       COPY "LIBUP/UPFSABX.CPY".
       COPY "LIBUP/UPFSACA.CPY".
       COPY "LIBUP/UPFSACI.CPY".
       COPY "LIBUP/UPFSACK.CPY".
       COPY "LIBUP/UPFSAIX.CPY".
       COPY "LIBUP/UPFSALE.CPY".
       COPY "LIBUP/UPFSALH.CPY".
       COPY "LIBUP/UPFSALN.CPY".
       COPY "LIBUP/UPFSALP.CPY".
      *COPY "LIBUP/UPFSALTA.CPY".
       COPY "LIBUP/UPFSALTB.CPY".
       COPY "LIBUP/UPFSALTC.CPY".
       COPY "LIBUP/UPFSALTD.CPY".
       COPY "LIBUP/UPFSALTF.CPY".
       COPY "LIBUP/UPFSALTI.CPY".
       COPY "LIBUP/UPFSALTL.CPY".
       COPY "LIBUP/UPFSALTP.CPY".
      *COPY "LIBUP/UPFSALX.CPY".
      *COPY "LIBUP/UPFSALXE.CPY".
      *COPY "LIBUP/UPFSALXG.CPY".

       COPY "LIBUP/UP1534_FS.CPY".
       COPY "LIBUP/UP1534_SPFSREPORT.CPY".

      * USING FOR ORIGINAL MACHINE
           SELECT OBR-FILE ASSIGN TO OBR-PATH
                  ORGANIZATION RELATIVE
                  ACCESS MODE DYNAMIC
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  RELATIVE KEY OBR-KEY
                  FILE STATUS FILE-STAT.

      *=================================================================
      *    MSEXCEL EXTRACTION FILE
      *=================================================================
           SELECT MSEXCEL-FILE ASSIGN OUTPUT MSEXCEL-PATH
                  ORGANIZATION LINE SEQUENTIAL
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  FILE STATUS FILE-STAT.

      *=================================================================
      *    UPERROR EXTRACTION FILE
      *=================================================================
           SELECT UPERROR-FILE ASSIGN OUTPUT UPERROR-PATH
                  ORGANIZATION LINE SEQUENTIAL
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  FILE STATUS FILE-STAT.

      ******************************************************************
      ******************************************************************
      ******************************************************************
       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.
       COPY "LIBGB/GBFDPR.CPY".

      * ASCII UPLOAD FILES
       COPY "LIBUP/UPFDABW.CPY".
       COPY "LIBUP/UPFDABX.CPY".
       COPY "LIBUP/UPFDACA.CPY".
       COPY "LIBUP/UPFDACI.CPY".
       COPY "LIBUP/UPFDACK.CPY".
       COPY "LIBUP/UPFDAGL.CPY".
       COPY "LIBUP/UPFDAIX.CPY".
       COPY "LIBUP/UPFDALE.CPY".
       COPY "LIBUP/UPFDALH.CPY".
       COPY "LIBUP/UPFDALN.CPY".
       COPY "LIBUP/UPFDALP.CPY".
      *COPY "LIBUP/UPFDALX.CPY".
      *COPY "LIBUP/UPFDALXE.CPY".
      *COPY "LIBUP/UPFDALXG.CPY".
      *COPY "LIBUP/UPFDALTA.CPY".
       COPY "LIBUP/UPFDALTB.CPY".
       COPY "LIBUP/UPFDALTC.CPY".
       COPY "LIBUP/UPFDALTD.CPY".
       COPY "LIBUP/UPFDALTF.CPY".
       COPY "LIBUP/UPFDALTI.CPY".
       COPY "LIBUP/UPFDALTL.CPY".
       COPY "LIBUP/UPFDALTP.CPY".
       COPY "LIBUP/UPFDARC.CPY".
       COPY "LIBUP/UPFDAWR.CPY".

       COPY "LIBUP/UP1534_FD.CPY".
       COPY "LIBUP/UP1534_SPFDREPORT.CPY".

       FD  OBR-FILE
           LABEL RECORDS ARE STANDARD.
       COPY "LIBUP/A15SRC/GB01BR.CPY" REPLACING LEADING "BR" BY "OBR".

      *=================================================================
      *    SORT FILE FOR CREATING MSEXCEL EXTRACTION FILE
      *=================================================================
       COPY "LIBSP/SPFDSORT.CPY".
      *-----------------------------------------------------------------
       01  SORT-REC.
           03  SORT-KEY.
               05  SORT-FILENAME                     PIC X(08).
               05  SORT-FILEPATH                     PIC X(40).
               05  SORT-STATE                        PIC X(02).
               05  SORT-BRNO                         PIC 9(04).
           03  SORT-REC-INFO.
               05  SORT-RECS-READ                    PIC 9(15).
               05  SORT-RECS-WRITE                   PIC 9(15).
               05  SORT-RECS-SKIP                    PIC 9(15).
               05  SORT-TIME-BEG                     PIC 9V9(7).
               05  SORT-TIME-END                     PIC 9V9(7).
               05  SORT-TIME-ELAPSED                 PIC 9V9(7).

      *=================================================================
      *    MSEXCEL EXTRACTION FILE
      *=================================================================
       FD  MSEXCEL-FILE
           RECORD IS VARYING IN SIZE FROM 10 TO 150 CHARACTERS
           LABEL RECORDS ARE STANDARD.
       01  MSEXCEL-REC.
           03  MSEXCEL-BYTE             PIC X OCCURS 150 TIMES.

      *=================================================================
      *    UPERROR EXTRACTION FILE
      *=================================================================
       FD  UPERROR-FILE
           RECORD IS VARYING IN SIZE FROM 10 TO 100 CHARACTERS
           LABEL RECORDS ARE STANDARD.
       01  UPERROR-REC.
           03  UPERROR-BYTE             PIC X OCCURS 100 TIMES.

      ******************************************************************
      *
      *    W O R K I N G - S T O R A G E    S E C T I O N
      *
      ******************************************************************
      ******************************************************************
       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(41) VALUE
           "@(#)UP/UP1534.CBL S35 04/14/25-10:21:34 >".

      ******************************************************************
      *
      *    F I L E - P A T H - W O R K E R S   
      *
      ******************************************************************
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".

       COPY "LIBGB/GB01GR.CPY".
       COPY "LIBGB/GB01GR_SQL.CPY".
       COPY "LIBGB/GBWSGR.CPY".

       COPY "LIBSP/SPWSSORT.CPY".
       COPY "LIBUP/UP1534_WS.CPY".
      * ASCII UPLOAD FILES

       COPY "LIBUP/UPWSABW.CPY".
       COPY "LIBUP/UPWSABX.CPY".
       COPY "LIBUP/UPWSACA.CPY".
       COPY "LIBUP/UPWSACI.CPY".
       COPY "LIBUP/UPWSACK.CPY".
       COPY "LIBUP/UPWSAIX.CPY".
       COPY "LIBUP/UPWSALE.CPY".
       COPY "LIBUP/UPWSALH.CPY".
       COPY "LIBUP/UPWSALN.CPY".
       COPY "LIBUP/UPWSALP.CPY".
      *COPY "LIBUP/UPWSALTA.CPY".
       COPY "LIBUP/UPWSALTB.CPY".
       COPY "LIBUP/UPWSALTC.CPY".
       COPY "LIBUP/UPWSALTD.CPY".
       COPY "LIBUP/UPWSALTF.CPY".
       COPY "LIBUP/UPWSALTI.CPY".
       COPY "LIBUP/UPWSALTL.CPY".
       COPY "LIBUP/UPWSALTP.CPY".
      *COPY "LIBUP/UPWSALX.CPY".
      *COPY "LIBUP/UPWSALXE.CPY".
      *COPY "LIBUP/UPWSALXG.CPY".

       COPY "LIBUP/UPWSAGL.CPY".
       COPY "LIBUP/UPWSARC.CPY".
       COPY "LIBUP/UPWSAWR.CPY".

       01  ASCII-DIRECTORY-PATH.
           03  ASCII-DIR-BEG           PIC X(9).
           03  ASCII-FILLER            PIC X    VALUE "/".
           03  ASCII-DIR-MACHINE       PIC X(2).
           03  ASCII-DIR-NAME          PIC X(6) VALUE "/ASCII".
           03  ASCII-DIR-DONE          PIC X(5).

       01  HOLD-ASCII-PATH-GROUP      PIC X(4).
       01  HOLD-ASCII-PATH-BRNO    REDEFINES HOLD-ASCII-PATH-GROUP
                                      PIC 9(4).

      *=================================================================
      *   OWK-REC FROM 'REPLACING LEADING' ON WK-REC.
      *   NEED A15 & A30 VERSIONS OF LP01WK
      *    - A15: OWK-LT-RECORD       A30: WK-LT-RECORD
      *    - A15: OWK-LT-A-RECORD     A30: WK-LTA-RECORD
      *=================================================================
       COPY "LIBLP/LP01WK.CPY".
       COPY "LIBUP/A15SRC/LP01WK.CPY" REPLACING LEADING "WK" BY "OWK".

      *=================================================================
      *   NEED TO DEFINE OPD-REC (A15) AND PD-REC (A34)
      *   FOR UPGRADE OF CL-REC
      *=================================================================
       COPY "LIBLP/LP01PD.CPY".
       COPY "LIBUP/A15SRC/LP01PD.CPY" REPLACING LEADING "PD" BY "OPD".

      *=================================================================
      *    EXAMPLE: /USR/TMP/UP1534-MSEXCEL-???????.TXT
      *=================================================================
       01  MSEXCEL-PATH                PIC X(35)     VALUE SPACES.
       01  FILLER                      REDEFINES MSEXCEL-PATH.
           03  MSEXCEL-PATH-SLASH-1     PIC X(01).    *> /
           03  MSEXCEL-PATH-DIR-1       PIC X(03).    *> USR
           03  MSEXCEL-PATH-SLASH-2     PIC X(01).    *> /
           03  MSEXCEL-PATH-DIR-2       PIC X(03).    *> TMP
           03  MSEXCEL-PATH-SLASH-3     PIC X(01).    *> /
           03  MSEXCEL-PATH-PREFIX      PIC X(15).    *> UP1534-MSEXCEL-
           03  MSEXCEL-PATH-SUFFIX      PIC X(07).    *> ???????
           03  MSEXCEL-PATH-EXT         PIC X(04).    *> .TXT

      *=================================================================
      *    EXAMPLE: /USR/TMP/UP1534-ERROR-???????
      *=================================================================
       01  UPERROR-PATH                 PIC X(35)     VALUE SPACES.
       01  FILLER                      REDEFINES UPERROR-PATH.
           03  UPERROR-PATH-SLASH-1     PIC X(01).    *> /
           03  UPERROR-PATH-DIR-1       PIC X(03).    *> USR
           03  UPERROR-PATH-SLASH-2     PIC X(01).    *> /
           03  UPERROR-PATH-DIR-2       PIC X(03).    *> TMP
           03  UPERROR-PATH-SLASH-3     PIC X(01).    *> /
           03  UPERROR-PATH-PREFIX      PIC X(13).    *> UP1534-ERROR-
           03  UPERROR-PATH-MKTEMP      PIC X(07).    *> ???????

       01  UPERROR-MESS                 PIC X(80)     VALUE SPACES.

      *=================================================================
       01  PR-IFN                      PIC X(2) VALUE "PR".
       01  UP1534-REPORT-KEY           PIC 9(11).
       01  UP1534-REPORT-PATH          PIC X(35).
       01  OIR-KEY                     PIC 99.
       01  OII-KEY                     PIC 99.
       01  OGB-KEY                     PIC 9.
       01  OBR-KEY                     PIC 9(4).
       01  OBR-PATH                    PIC X(35)     VALUE SPACES.
       01  FILENAME-EXT                PIC X(4)      VALUE ".VIX".

      * ASCII FILES FOR SQL
       01  ABW-KEY                     PIC 9(12) VALUE 0.
       01  ABX-KEY                     PIC 9(12) VALUE 0.
      *01  SKIP-482-629056892-1        PIC X     VALUE "Y".
       01  ACA-KEY                     PIC 9(12) VALUE 0.
       01  ACI-KEY                     PIC 9(12) VALUE 0.
       01  ACK-KEY                     PIC 9(12) VALUE 0.
       01  AGL-KEY                     PIC 9(12) VALUE 0.
       01  AIX-KEY                     PIC 9(12) VALUE 0.
      *01  AJD-KEY                     PIC 9(12) VALUE 0.
       01  ALN-KEY                     PIC 9(12) VALUE 0.
       01  ALE-KEY                     PIC 9(12) VALUE 0.
       01  ALH-KEY                     PIC 9(12) VALUE 0.
       01  ALP-KEY                     PIC 9(12) VALUE 0.
      *01  ALX-KEY                     PIC 9(12) VALUE 0.
      *01  ALXE-KEY                    PIC 9(12) VALUE 0.
      *01  ALXG-KEY                    PIC 9(12) VALUE 0.
      *01  ALTA-KEY                    PIC 9(12) VALUE 0.
       01  ALTB-KEY                    PIC 9(12) VALUE 0.
       01  ALTC-KEY                    PIC 9(12) VALUE 0.
       01  ALTD-KEY                    PIC 9(12) VALUE 0.
       01  ALTF-KEY                    PIC 9(12) VALUE 0.
       01  ALTI-KEY                    PIC 9(12) VALUE 0.
       01  ALTL-KEY                    PIC 9(12) VALUE 0.
       01  ALTP-KEY                    PIC 9(12) VALUE 0.
       01  ARC-KEY                     PIC 9(12) VALUE 0.
       01  AWR-KEY                     PIC 9(12) VALUE 0.

      *-----------------------------------------------------------------
      *01  HOLD-ALX-KEY                PIC 9(12) VALUE 0.
      *01  HOLD-LX-ACCTNO              PIC 9(8)  VALUE 0.
       01  HOLD-ALT-KEY                PIC 9(12) VALUE 0.
       01  HOLD-LT-ACCTNO              PIC 9(8)  VALUE 0.
       01  HOLD-LT-CODE                PIC X     VALUE SPACES.

       01  HOLD-SORT-KEY.
           03  HOLD-SORT-FILENAME      PIC X(08).
           03  HOLD-SORT-FILEPATH      PIC X(40).
           03  HOLD-SORT-STATE         PIC X(02).
           03  HOLD-SORT-BRNO          PIC 9(04).

       01  SAVE-SORT-KEY.
           03  SAVE-SORT-FILENAME      PIC X(08).
           03  SAVE-SORT-FILEPATH      PIC X(40).
           03  SAVE-SORT-STATE         PIC X(02).
           03  SAVE-SORT-BRNO          PIC 9(04).

      *-----------------------------------------------------------------
       01  SAVE-A15-FILE-EXT           PIC X(4)      VALUE ".VIX".
       01  SAVE-A15-FILE-PATH-OLD      PIC X(40)     VALUE SPACES.
       01  SAVE-A15-FILE-PATH-NEW      PIC X(40)     VALUE SPACES.

      ******************************************************************
      *
      *    M I S C E L L A N E O U S - W O R K E R S
      *
      ******************************************************************

      *- - - - - - - - - - - - - - - - - -{ EDIT DISPLAY FORMAT - EDF }
       01  EDF-WORKERS.
           03  EDF-SORT-TIME-BEG       PIC 9.9(7).
           03  EDF-SORT-TIME-END       PIC 9.9(7).
           03  EDF-SORT-TIME-ELAPSED   PIC 9.9(7).

       01  ERRCD                       PIC X(01)     VALUE SPACES.

       01  LN-WORKERS.
           03  LN-FEED                 PIC 9(03)     VALUE ZEROES.
           03  LN-COUNT                PIC 9(03)     VALUE 99.
           03  LN-WK                   PIC 9(03)     VALUE ZEROES.

       01  ER-FEED                     PIC 9(01)     VALUE 1.
       01  PAGE-NUMBER                 PIC 9(04)     VALUE ZEROES.
       01  RECORDS-FOUND               PIC X(01).
           88  NO-RECORDS-FOUND                      VALUE "N".
           88  EXIT-PRIOR-TO-EXECUTION               VALUE "X".


       01  BRANCH-TABLE.
           03  BRANCH-MACHINE          PIC XX OCCURS 9999 TIMES.

       01  TODAYS-DATE                 PIC 9(8).
       01  COMPARE-DATE                PIC 9(8).
       01  COMPARE-DATEX REDEFINES COMPARE-DATE.
           03  COMPARE-DATE-YYYY       PIC 9(4).
           03  FILLER                  PIC X(4).

       01  OLD-ACCTNO                  PIC 9(8).
       01  FILLER REDEFINES OLD-ACCTNO.
           03  NEW-ACCTNO              PIC 9(6).
           03  FILLER                  PIC 99.

       01  LITTLE-Z.
           03  FILLER           PIC X VALUE X"7A".

       01  HOLD-LN-MESSAGE      PIC X(30).
       01  HOLD-LN-MESSAGEX REDEFINES HOLD-LN-MESSAGE.
           03  HOLD-LN-MESS-BYTE PIC X OCCURS 30.
       01  HOLD-BYTE            PIC X.
           88  VALID-SPECIAL-CHARS  VALUE "(" ")"
                              "/" "\" "-" "?" "+" "%" "#" "[" "]"
                              "!" "<" ">" "$" "*" "&" "." """"  "="
                              "'" "_" ":" "@" "," ";" "~" "|" "{" "}".

      * MISC HOLD KEYS NEEDED FOR CLEAR ROUTINES, BUT NOT USED
       01  HOLD-KEY                    PIC X(18).
       01  HOLD-LN1-KEY REDEFINES HOLD-KEY
                                       PIC 9(18).
       01  HOLD-ES1-KEY REDEFINES HOLD-KEY
                                       PIC 9(18).
       01  HOLD-DL1-KEY REDEFINES HOLD-KEY
                                       PIC 9(18).
       01  HOLD-LH1-KEY REDEFINES HOLD-KEY
                                       PIC X(18).
       01  HOLD-EFFDATE REDEFINES HOLD-KEY
                                       PIC 9(18).

       01  HOLD-A15-ALPNAME            PIC X(3).
       01  FILLER REDEFINES HOLD-A15-ALPNAME.
           03  HOLD-A15-BYTE           PIC X(1) OCCURS 3 TIMES.

       01  HOLD-A30-ALPNAME            PIC X(4).
       01  FILLER REDEFINES HOLD-A30-ALPNAME.
           03  HOLD-A30-BYTE           PIC X(1) OCCURS 4 TIMES.


       01  SHOW-OLT1-KEY.
           03  SHOW-OLT-ACCTNO         PIC 9(8).
           03  SHOW-OLT-CODE           PIC X(1).
           03  SHOW-OLT-SEQNO          PIC 9(3).

       01  SUBSCRIPT-WORKERS.
           03  ELE                     PIC 9(03)     VALUE ZEROES.
           03  SUB                     PIC 9(03)     VALUE ZEROES.
           03  S1                      PIC 9(03)     VALUE ZEROES.
           03  SUB1      REDEFINES S1  PIC 9(03).
           03  BYSUB1    REDEFINES S1  PIC 9(03).
           03  SSSUB1    REDEFINES S1  PIC 9(03).
           03  DSSUB1    REDEFINES S1  PIC 9(03).
           03  TYSUB1    REDEFINES S1  PIC 9(03).
           03  S2                      PIC 9(03)     VALUE ZEROES.
           03  SUB2      REDEFINES S2  PIC 9(03).
           03  BYSUB2    REDEFINES S2  PIC 9(03).
           03  SSSUB2    REDEFINES S2  PIC 9(03).
           03  DSSUB2    REDEFINES S2  PIC 9(03).
           03  TYSUB2    REDEFINES S2  PIC 9(03).
           03  S3                      PIC 9(03)     VALUE ZEROES.
           03  SUB3      REDEFINES S3  PIC 9(03).
           03  BYSUB3    REDEFINES S3  PIC 9(03).
           03  SSSUB3    REDEFINES S3  PIC 9(03).
           03  DSSUB3    REDEFINES S3  PIC 9(03).

       01  TEST-DELQ-IB-AGE            PIC 999     VALUE ZEROS.
       01  DELQ-IB-MAX-DAYS-REM        PIC 999V99  VALUE ZEROS.
       01  TEST-DIVIDE-BY-30           PIC 999     VALUE ZEROS.
       01  TEST-DIVIDE-BY-30-REM       PIC 999V99  VALUE ZEROS.
       01  TEST-TRCD                   PIC X(02).
           88  ADDON-TRCD              VALUE "RT" "LP" "NP" "ET" "ST".
           88  DEFER-TRCD              VALUE "DF" "D2" "D3" "D4" "D5"
                                             "D6" "D7" "D8" "D9".
           88  PMT-TRCD                VALUE "PY" "PA".
           88  REBATE-TRCD             VALUE "RC" "RA" "RP" "R1" "R2"
                                             "R3" "RI" "RS" "RM" "RD"
                                             "CC" "CA" "CP" "C1" "C2"
                                             "C3" "CD".
           88  REVOLV-TRCD             VALUE "AV" "PU" "ST" "PY".
           88  RESERVE-TRCD            VALUE "PR" "PC" "PP".
           88  RESERVE-P4P5-TRCD       VALUE "P4" "P5".

      *===============================================[ HEX CHARACTERS ]
       01  HEX-CARRIAGE-RETURN         PIC X(01)     VALUE X"0D".
       01  HEX-LINE-FEED               PIC X(01)     VALUE X"0A".
       01  HEX-LOWER-X5                PIC X(2)      VALUE X"7835".
       01  HEX-LOWER-Z1                PIC X(2)      VALUE X"7A31".
       01  HEX-TAB                     PIC X(01)     VALUE X"09".

      *===============================================[ PURGE WORKERS ]
       01  WS-DATE-MMDDYY.
           03  WS-DATE-MMDDYY-MM       PIC 9(02).
           03  WS-DATE-MMDDYY-DD       PIC 9(02).
           03  WS-DATE-MMDDYY-YY       PIC 9(02).

       01   WS-PURGE-DATE-YYYYMMDD     PIC 9(08).

      ******************************************************************
      *
      *    M E S S A G E - W O R K E R S
      *
      ******************************************************************
       01  MESSAGE-INVALID-YN.
           03  FILLER PIC X(30) VALUE "INVALID: (Y)ES OR (N)O ONLY!!!".
           03  FILLER PIC X(30) VALUE "                              ".

       01  MESSAGE-INVALID-FILE-PATH.
           03  FILLER PIC X(30) VALUE "INVALID FILE PATH; PATH NOT FO".
           03  FILLER PIC X(30) VALUE "UND!!!                        ".

       01  MESSAGE-INVALID-SAME-PATHS.
           03  FILLER PIC X(30) VALUE "INVALID: SOURCE AND TARGET CAN".
           03  FILLER PIC X(30) VALUE "NOT BE THE SAME               ".

      ******************************************************************
      *
      *    P R I N T - W O R K E R S
      *
      ******************************************************************
       01  HEADER-LINE-1.
           03  H1-DATE              PIC X(08)   VALUE SPACES.
           03  FILLER               PIC X(02)   VALUE SPACES.
           03  H1-TIME              PIC X(08)   VALUE SPACES.
           03  FILLER               PIC X(28)   VALUE SPACES.
           03  H1-NAME              PIC X(40)   VALUE SPACES.
           03  FILLER               PIC X(37)   VALUE SPACES.
           03  FILLER               PIC X(05)   VALUE "PAGE".
           03  H1-PAGE-NO           PIC ZZZ9.

      *-----------------------------------------------------------------
       01  HEADER-LINE-2.
           03  H2-USERID-PROMPT     PIC X(11)   VALUE "USER ID  : ".
           03  H2-USERID            PIC X(10)   VALUE SPACES.
           03  FILLER               PIC X(22)   VALUE SPACES.
           03  H2-TITLE             PIC X(45)   VALUE
               "--------- UPGRADE A15 TO A34 REPORT ---------".
           03  FILLER               PIC X(44)   VALUE SPACES.

      *=================================================================
       01  DETAIL-LINE                        PIC X(132)   VALUE SPACES.

      *-----------------------------------------------------------------
       01  DETAIL-RANGE-LINE        REDEFINES DETAIL-LINE.
           03  R1-DESC                        PIC X(34).
           03  FILLER                         PIC X(01).
           03  R1-FIELD                       PIC X(35).

           03  R1-DATE-RDF          REDEFINES R1-FIELD.
               05  R1-DATE                    PIC 99/99/99.
               05  FILLER                     PIC X(27).

           03  R1-MMYY-RDF          REDEFINES R1-FIELD.
               05  R1-MMYY                    PIC 99/99.
               05  FILLER                     PIC X(30).

           03  R1-NUMERIC-RDF       REDEFINES R1-FIELD.
               05  R1-NUMERIC                 PIC Z(09)9.
               05  FILLER                     PIC X(25).

           03  FILLER                  PIC X(62).

       01  WSS-DATE-YYYYSMM            PIC 9999/99.
       01  DEFAULT-GLOBAL-OPTIONS      PIC X(01)     VALUE SPACES.
       01  DEFAULT-LOCAL-OPTIONS       PIC X(01)     VALUE SPACES.

       01  SAVE-REPORT-COMMAND.
           03  SAVE-REPORT-CMD         PIC X(03)   VALUE "MV ".
           03  SAVE-REPORT-SOURCE      PIC X(35)   VALUE SPACES.
           03  FILLER                  PIC X(01)   VALUE SPACES.
           03  SAVE-REPORT-TARGET      PIC X(35)   VALUE SPACES.
           03  FILLER                  REDEFINES SAVE-REPORT-TARGET.
               05  FILLER              PIC X(09).
               05  SAVE-REPORT-TARGET-NEW
                                       PIC X(07).
               05  SAVE-REPORT-TARGET-MKTEMP
                                       PIC X(19).

       01  SOURCE-PATH-LIST            PIC X(07)     VALUE "S-PATH.".
       01  TARGET-PATH-LIST            PIC X(07)     VALUE "T-PATH.".
       01  LEGEND                      PIC X(77)     VALUE SPACES.
       01  LEGEND-LIST                 PIC X(09)     VALUE "LEGEND:B.".
       01  STARTING-TIME-LIST          PIC X(11)    VALUE "START-TIME.".
       01  STARTING-TIME-BUF.
           03  STARTING-TIME-RIGHT     PIC X(02)     VALUE SPACES.
           03  STARTING-TIME           PIC X(08)     VALUE SPACES.
           03  STARTING-TIME-LEFT      PIC X(02)     VALUE SPACES.

      *=================================================================
       01  LEGEND-PRINTER-OPTIONS.
           03  FILLER PIC X(30) VALUE "F1-RESET, F7-EXIT, ENTER PRINT".
           03  FILLER PIC X(30) VALUE "ER OPTIONS                    ".
           03  FILLER PIC X(17) VALUE "                 ".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  LEGEND-SOURCE-PATH.
           03  FILLER PIC X(30) VALUE "F1-RESET, F7-EXIT, ENTER SOURC".
           03  FILLER PIC X(30) VALUE "E PATH                        ".
           03  FILLER PIC X(17) VALUE "                 ".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  LEGEND-TARGET-PATH.
           03  FILLER PIC X(30) VALUE "F1-RESET, F7-EXIT, UP/DOWN, EN".
           03  FILLER PIC X(30) VALUE "TER TARGET PATH               ".
           03  FILLER PIC X(17) VALUE "                 ".

       01  LEGEND-BEG-BRANCH.
           03  FILLER PIC X(30) VALUE "F1-RESET, F3-ALL, F6-SCAN, F7-".
           03  FILLER PIC X(30) VALUE "EXIT, UP/DOWN, ENTER BEGINNING".
           03  FILLER PIC X(17) VALUE " BRANCH NUMBER   ".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  LEGEND-END-BRANCH.
           03  FILLER PIC X(30) VALUE "F1-RESET, F7-EXIT, UP/DOWN, EN".
           03  FILLER PIC X(30) VALUE "TER ENDING BRANCH NUMBER      ".
           03  FILLER PIC X(17) VALUE "                 ".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  LEGEND-OPTION-FILES.
           03  FILLER PIC X(30) VALUE "F1 THRU F7, F8-HELP, UP/DOWN, ".
           03  FILLER PIC X(30) VALUE "ENTER (Y)ES/(N)O/(C)HECK FOR U".
           03  FILLER PIC X(17) VALUE "PDATING THIS FILE".

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  LEGEND-ACCEPT.
           03  FILLER PIC X(30) VALUE "F1-RESET, F7-EXIT, UP/DOWN, EN".
           03  FILLER PIC X(30) VALUE "TER TO ACCEPT (YES/NO)        ".
           03  FILLER PIC X(17) VALUE "   ACCEPT (Y/N): ".

       01  FIL-LIST                    PIC X(11)    VALUE "DATA-SET:B.".
       01  FIL-BUF.
           03  FIL-PROMPT              PIC X(13)     VALUE SPACES.
           03  FIL-INFO                PIC X(35)     VALUE SPACES.

       01  RISC2                  PIC X(02)          VALUE "R2".
       01  SOURCE-MACHINE         PIC X(02).
       01  TARGET-MACHINE         PIC X(02).

      ***********************************************************
       COPY "LIBGB/EOBUF_EXT.CPY".
      ***********************************************************
           03  CURRENT-MACHINE         PIC X(02).
           03  SOURCE-PATH             PIC X(35).
           03  TARGET-PATH             PIC X(35).

           03  BEG-BRANCH              PIC 9(04).
           03  END-BRANCH              PIC 9(04).

           03  GROUP-OPTION-WORKERS.
               05  GROUP-FLAG          PIC X(01).
               05  ENT-GROUP           PIC X(04).

           03  FILE-OPTION-WORKERS.
      * GLOBALS
               05  FILE-OPTION-AL      PIC X(01).
               05  FILE-OPTION-CD      PIC X(01).
               05  FILE-OPTION-CL      PIC X(01).
               05  FILE-GLOBAL-CP      PIC X(01).
               05  FILE-OPTION-EA      PIC X(01).
      *        05  FILE-OPTION-EP      PIC X(01).
      *        05  FILE-OPTION-EW      PIC X(01).
      *        05  FILE-OPTION-FD      PIC X(01).
               05  FILE-OPTION-FS      PIC X(01).
               05  FILE-OPTION-GI      PIC X(01).
               05  FILE-OPTION-GL      PIC X(01).
               05  FILE-OPTION-II      PIC X(01).
               05  FILE-OPTION-IR      PIC X(01).
      *        05  FILE-OPTION-JD      PIC X(01).
               05  FILE-OPTION-LC      PIC X(01).
               05  FILE-OPTION-PE      PIC X(01).
               05  FILE-OPTION-PW      PIC X(01).
      *        05  FILE-OPTION-RB      PIC X(01).
               05  FILE-OPTION-RC      PIC X(01).
               05  FILE-OPTION-SM      PIC X(01).
               05  FILE-OPTION-SP      PIC X(01).
               05  FILE-OPTION-SS      PIC X(01).
               05  FILE-OPTION-ST      PIC X(01).
               05  FILE-OPTION-TRWINFO PIC X(01).
               05  FILE-OPTION-TZ      PIC X(01).
               05  FILE-OPTION-WR      PIC X(01).
               05  FILE-OPTION-AU      PIC X(01).
      * LOCALS
               05  FILE-OPTION-BW      PIC X(01).
               05  FILE-OPTION-CA      PIC X(01).
               05  FILE-OPTION-CI      PIC X(01).
               05  FILE-OPTION-CK      PIC X(01).
               05  FILE-OPTION-CP      PIC X(01).
               05  FILE-OPTION-CX      PIC X(01).
               05  FILE-OPTION-DL      PIC X(01).
      *        05  FILE-OPTION-DM      PIC X(01).
      *        05  FILE-OPTION-DS      PIC X(01).
               05  FILE-OPTION-DT      PIC X(01).
      *        05  FILE-OPTION-ES      PIC X(01).
               05  FILE-OPTION-GB      PIC X(01).
               05  FILE-OPTION-IC      PIC X(01).
               05  FILE-OPTION-IX      PIC X(01).
               05  FILE-OPTION-LE      PIC X(01).
               05  FILE-OPTION-LH      PIC X(01).
               05  FILE-OPTION-LN      PIC X(01).
               05  FILE-OPTION-LP      PIC X(01).
               05  FILE-OPTION-LS      PIC X(01).
               05  FILE-OPTION-LT      PIC X(01).
               05  FILE-OPTION-LX      PIC X(01).
      *        05  FILE-OPTION-MP      PIC X(01).
      *        05  FILE-OPTION-PA      PIC X(01).
      *        05  FILE-OPTION-PC      PIC X(01).
      *        05  FILE-OPTION-PD      PIC X(01).
               05  FILE-OPTION-RX      PIC X(01).
               05  FILE-OPTION-TY      PIC X(01).

       01  VERSION-CONTROL             PIC X(01)     VALUE "A".
       01  SAVE-SCREEN-RANGES.
           03  SV-BEG-BRANCH           PIC 9(04)     VALUE 9999.
           03  SV-END-BRANCH           PIC 9(04)     VALUE 9999.

           03  SV-GROUP-OPTION.
               05  SV-GROUP-FLAG       PIC X(01).
               05  SV-ENT-GROUP        PIC X(04).

      *=================================================[ UPGRADE-STAT ]
       78  UPGRADE-STAT---GOOD                     VALUE "00".
       78  UPGRADE-STAT---BAD                      VALUE "XX".
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       77  UPGRADE-STAT                PIC X(02)   VALUE SPACES.
           88  UPGRADE-STAT-GOOD                   VALUE "00".
           88  UPGRADE-STAT-BAD                    VALUE "  " THRU "//"
                                                         "01" THRU "~~".

      *=================================================================
       01  WSS-AM-APP-NUMBER           PIC 9(09)     VALUE ZEROES.
       01  FILLER            REDEFINES WSS-AM-APP-NUMBER.
           03  WSS-AM-APPNO            PIC 9(08).
           03  WSS-AM-SEQNO            PIC 9(01).
       01  WSS-MA-APP-NUMBER REDEFINES WSS-AM-APP-NUMBER
                                       PIC 9(09).
       01  FILLER            REDEFINES WSS-AM-APP-NUMBER.
           03  WSS-MA-APPNO            PIC 9(08).
           03  WSS-MA-SEQNO            PIC 9(01).

      *-----------------------------------------------------------------
       01  WSS-MSEXCEL-TIME-INPUT      PIC 9(6)      VALUE ZEROES.
       01  FILLER            REDEFINES WSS-MSEXCEL-TIME-INPUT.
           03  WSS-MSEXCEL-TIME-INPUT-HH   PIC 9(2).
           03  WSS-MSEXCEL-TIME-INPUT-MM   PIC 9(2).
           03  WSS-MSEXCEL-TIME-INPUT-SS   PIC 9(2).

       01  WSS-MSEXCEL-TIME-OUTPUT     PIC 9V9(7)    VALUE ZEROES.

      *-----------------------------------------------------------------

       01  WSS-PROGRAM-DIR-A15         PIC X(02)     VALUE SPACES.
       01  WSS-PROGRAM-NAME-A15        PIC X(10)     VALUE SPACES.
       01  WSS-PROGRAM-NAME-A30        PIC X(10)     VALUE SPACES.

      *-----------------------------------------------------------------
       01  WSS-VENDOR-LONG-NAMES.
           03  WSS-VENDOR-LONG-NAME1   PIC X(40).
           03  WSS-VENDOR-LONG-NAME2   PIC X(40).

       01  WSS-VENDOR-LONG-NAME-FG     PIC 9(01)   VALUE ZEROES.

       01  CREATE-BX-RECORD            PIC X VALUE SPACES.
       COPY "LIBLP/TFRMEMOW.CPY".
      *=================================================================
       01  A15MEMO-MEMO                PIC X(60)     VALUE SPACES.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * BASE FORMAT - USED FOR IDENTIFYING WHAT TYPE OF MEMO.
      * TFR FR BR #### TO BR ####                                   [BM]
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
       01  FILLER                      REDEFINES A15MEMO-MEMO.
           03  A15MEMO-PRIMARY         PIC X(09).
               88  A15MEMO-PRIMARY-FROM              VALUE "TFR FR BR".
               88  A15MEMO-PRIMARY-TO                VALUE "TFR TO BR".
           03  FILLER                  PIC X(01).
           03  A15MEMO-BRNO1           PIC 9(04).
           03  FILLER                  PIC X(01).
           03  A15MEMO-SECONDARY       PIC X(05).
               88  A15MEMO-SECONDARY-FROM            VALUE "FR BR".
               88  A15MEMO-SECONDARY-TO              VALUE "TO BR".
           03  FILLER                  PIC X(01).
           03  A15MEMO-BRNO2           PIC 9(04).
           03  FILLER                  PIC X(35).

      *=================================================================
      *    WORKERS FOR ACU4GL ERRORS
      *=================================================================
      *01  UP1534-ERROR-RELEASE            PIC X(7).
      *01  FILLER REDEFINES UP1534-ERROR-RELEASE.
      *    03  FILLER                      PIC X(4).
      *    03  UP1534-ERROR-REL            PIC X(3).

      *01  UP1534-ERROR-STATUS.
      *    03  UP1534-PRIMARY-ERROR        PIC X(2).
      *    03  UP1534-SECONDARY-ERROR      PIC X(40).

      *01  UP1534-ERROR-TEXT               PIC X(183).
      *01  FILLER REDEFINES UP1534-ERROR-TEXT.
      *    03  UP1534-ERROR-TEXT-1         PIC X(61).
      *    03  UP1534-ERROR-TEXT-2         PIC X(61).
      *    03  UP1534-ERROR-TEXT-3         PIC X(61).

      ******************************************************************
      *
      *    C O P Y - L I B R A R Y - W O R K E R S 
      *
      ******************************************************************
       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBGB/BRSECUREW.CPY".
       COPY "LIBGB/DACCESSW.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/GETENVW.CPY".
       COPY "LIBGB/GPENVW.CPY".
       COPY "LIBGB/GRWORKW.CPY".
       COPY "LIBGB/PASSWDW.CPY".
       COPY "LIBGB/MKTEMPW_CMD.CPY".
       COPY "LIBGB/SYSTEMW.CPY".
       COPY "LIBGB/GETPRW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBUP/UP1534W.CPY".
       COPY "LIBWI/GRSCANW.CPY".
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBGB/HELPLINK.CPY".
       COPY "LIBGB/PRU_LNK.CPY".
      *------------------------------------------{ NEED TO BE TOGETHER }
       COPY "LIBGB/SCREENW.CPY".
       COPY "LIBUP/UP1534_DEF.CPY".
       COPY "LIBUP/UP1534_WKS.CPY".
     
      ******************************************************************
      *
      *    L I N K A G E - S C R E E N - S E C T I O N S
      *
      ******************************************************************
       COPY "LIBGB/GETFMW.CPY".
      *-----------------------------------------------------------------
     
      *=================================================================
       SCREEN SECTION.
       COPY "LIBUP/UP1534_SCN.CPY".

      ******************************************************************
      *
      *    P R O C E D U R E    D I V I S I O N
      *
      ******************************************************************
       PROCEDURE DIVISION
            USING FORM-PATHNAME EXIT-PATHNAME.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
                 REPORT-FILE OBR-FILE SORT-FILE
                 MSEXCEL-FILE UPERROR-FILE
      * ASCII OUTPUT FILES
                 ALN-FILE ABW-FILE ABX-FILE
                 ALP-FILE  ACA-FILE ACI-FILE ACK-FILE
                 ALE-FILE  ALH-FILE ARC-FILE 
                 AGL-FILE  AIX-FILE AWR-FILE 
                 ALTB-FILE
                 ALTC-FILE ALTD-FILE ALTF-FILE ALTI-FILE ALTL-FILE
                 ALTP-FILE 
                 ABW-DONE-FILE ABX-DONE-FILE
                 ACA-DONE-FILE ACI-DONE-FILE
                 ACK-DONE-FILE AIX-DONE-FILE ALE-DONE-FILE
                 ALH-DONE-FILE ALN-DONE-FILE
                 ALP-DONE-FILE ALTB-DONE-FILE
                 ALTC-DONE-FILE ALTD-DONE-FILE ALTF-DONE-FILE
                 ALTI-DONE-FILE ALTL-DONE-FILE 
                 AGL-DONE-FILE
                 ARC-DONE-FILE AWR-DONE-FILE

      *- - - - - - - - - - - - - - - - - - - -{ SOURCE & TARGET FILES  }
      * GLOBALS
                 OAL-FILE  
                 OAU-FILE  
                 OCD-FILE  
                 OCL-FILE   
                 OCP-FILE  
                 OEA-FILE 
                 OGI-FILE
                 OGL-FILE
                 OII-FILE 
                 OIR-FILE
                 OLC-FILE
                 OPE-FILE
                 OPW-FILE
                 ORC-FILE  
                 OSM-FILE   
                 OSP-FILE   
                 OSS-FILE  
                 OST-FILE 
                 OSU-FILE
                 OTZ-FILE   
                 OTRW-INFO-FILE 
                 OWR-FILE  
      * LOCALS
                 OBM-FILE     *> STILL NEED FOR UPGRADE OF BWFILE
                 OBW-FILE  
                 OBX-FILE  
                 OCA-FILE  
                 OCI-FILE  
                 OCK-FILE  
                 OCX-FILE  
                 ODL-FILE  
                 ODT-FILE  
                 OGB-FILE  
                 OIC-FILE  
                 OIX-FILE  
                 OLE-FILE  
                 OLH-FILE  
                 OLN-FILE  
                 OLP-FILE  
                 OLS-FILE 
                 OLT-FILE   
                 OLX-FILE  
                 ORX-FILE  
                 OTY-FILE.

      *-----------------------------------------------------------------
      *COPY "LIBUP/DECLARE.CPY".   *> ATTENTION THIS IS UNIQUE COPY
       COPY "LIBGB/DECLARE.CPY".
           PERFORM CLOSE-GR1-FILE.
           PERFORM CLOSE-BR-FILE.

      *-----------------------------------------------------------------
           CLOSE REPORT-FILE OBR-FILE SORT-FILE
                 MSEXCEL-FILE UPERROR-FILE
      * ASCII OUTPUT FILES
                 ALN-FILE ABW-FILE ABX-FILE
                 ALP-FILE  ACA-FILE ACI-FILE ACK-FILE
                 ALE-FILE  ALH-FILE ARC-FILE
                 AGL-FILE  AIX-FILE AWR-FILE
                 ALTB-FILE
                 ALTC-FILE ALTD-FILE ALTF-FILE ALTI-FILE ALTL-FILE
                 ALTP-FILE 
                 ABW-DONE-FILE ABX-DONE-FILE
                 ACA-DONE-FILE ACI-DONE-FILE
                 ACK-DONE-FILE AIX-DONE-FILE ALE-DONE-FILE
                 ALH-DONE-FILE ALN-DONE-FILE
                 ALP-DONE-FILE ALTB-DONE-FILE
                 ALTC-DONE-FILE ALTD-DONE-FILE ALTF-DONE-FILE
                 ALTI-DONE-FILE ALTL-DONE-FILE 
                 AGL-DONE-FILE
                 ARC-DONE-FILE AWR-DONE-FILE

      *- - - - - - - - - - - - - - - - - - - -{ SOURCE & TARGET FILES  }
      * GLOBALS
                 OAL-FILE  
                 OAU-FILE  
                 OCD-FILE 
                 OCL-FILE  
                 OCP-FILE  
                 OEA-FILE  
                 OGI-FILE  
                 OGL-FILE  
                 OII-FILE  
                 OIR-FILE  
                 OLC-FILE  
                 OPE-FILE  
                 OPW-FILE  
                 ORC-FILE  
                 OSM-FILE  
                 OSP-FILE  
                 OSS-FILE   
                 OST-FILE  
                 OSU-FILE
                 OTZ-FILE 
                 OTRW-INFO-FILE 
                 OWR-FILE  
      * LOCALS
                 OBM-FILE     *> STILL NEED FOR UPGRADE OF BWFILE
                 OBW-FILE  
                 OBX-FILE  
                 OCA-FILE  
                 OCI-FILE  
                 OCK-FILE  
                 OCX-FILE  
                 ODL-FILE  
                 ODT-FILE  
                 OGB-FILE  
                 OIC-FILE  
                 OIX-FILE  
                 OLE-FILE  
                 OLH-FILE  
                 OLN-FILE   
                 OLP-FILE
                 OLS-FILE
                 OLT-FILE 
                 OLX-FILE  
                 ORX-FILE  
                 OTY-FILE.

       COPY "LIBGB/DECLAR2.CPY".

      ******************************************************************
      *
      *    M A I N - P R O G R A M
      *
      ******************************************************************
       MAIN-PROGRAM SECTION.
           PERFORM SQL-CONNECT.
      D    STOP MESS.

           PERFORM INITIALIZATION.

           IF ( ERRCD NOT = SPACES )
              GO TO MAIN-PROGRAM-EXIT.

           PERFORM MISC-TRACE-INITIALIZATION.           *> ENABLE TRACE

      * CURRENT-MACHINE WILL BE RISC1, "R1"
           MOVE CURRENT-MACHINE TO SOURCE-MACHINE TARGET-MACHINE.
           CALL "C$TOLOWER" USING RISC2, VALUE 02.

      * LOAD A TABLE INDEXED BY BR-NO JUST TO KNOW THAT BR-MACHINE.
      * USING THE ORIGINAL A15 BRANCH FILE IN CASE YOU ALREADY CHANGED
      * THE NEW FILE TO ALL BE R1 BRANCHES!
      * BRANCH 9990 WILL BE R1
      * USE THIS FOR LOCALS ALSO, SO WE CAN FIX ERRORS AFTER R2 HAS BEEN
      * CHANGED
           PERFORM LOAD-BRANCH-TABLE.
           IF ( ERRCD NOT = SPACES )
              IF ( EXT-ROUTE-BUF = "00" )
                 MOVE "NEED ORIGINAL BRANCH FILE FOR MACHINE" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "ERROR: NEED ORIGINAL BRANCH FILE FOR MACHINE"
                   TO EXT-TCLP-TRACE-MESS
                 MOVE FORM-PATHNAME       TO EXT-TCLP-TRACE-FORM-PATH
                 PERFORM TRACE-SEND-MESS
              END-IF
              GO TO MAIN-PROGRAM-EXIT.
    
      * ADDED FILE EXTENSIONS FOR BRANCH/GROUP RANGES.
      *       F3-ALL       CREATES AXXFILE.ALL
      *       BRANCH RANGE CREATES AXXFILE.(BEGBR)
      *       GROUP        CREATES AXXFILE.(GROUP)
           IF GROUP-FLAG = "Y"
              MOVE ENT-GROUP TO HOLD-ASCII-PATH-GROUP
           ELSE
              IF (BEG-BRANCH = 0 AND END-BRANCH = 9999)
                 MOVE "ALL" TO HOLD-ASCII-PATH-GROUP
              ELSE
                 MOVE BEG-BRANCH TO HOLD-ASCII-PATH-BRNO.

      * CREATE ASCII AND DONE DIRECTORIES IF THEY DONT EXIST
            MOVE TARGET-PATH         TO ASCII-DIR-BEG.
            MOVE TARGET-MACHINE      TO ASCII-DIR-MACHINE.
            CALL "C$TOLOWER" USING ASCII-DIR-NAME, VALUE 06.

      * /USR/DATA/R1/ASCII
           MOVE ASCII-DIRECTORY-PATH TO DIR-ACCESS-BUF.
           PERFORM DIR-ACCESS-CALL.
           IF STAT NOT = "00"
              CALL "C$MAKEDIR" USING ASCII-DIRECTORY-PATH GIVING STAT-99
              IF STAT NOT = "00"
                 IF ( EXT-ROUTE-BUF = "00" )
                    MOVE "CAN'T CREATE ASCII DIRECTORY" TO MESS
                    PERFORM SEND-MESS
                 ELSE
                    MOVE "ERROR: CAN'T CREATE ASCII DIRECTORY"
                      TO EXT-TCLP-TRACE-MESS
                    MOVE FORM-PATHNAME       TO EXT-TCLP-TRACE-FORM-PATH
                    PERFORM TRACE-SEND-MESS
                 END-IF
                 GO TO MAIN-PROGRAM-EXIT.

      * /USR/DATA/R1/ASCII/DONE
           MOVE "/DONE" TO ASCII-DIR-DONE.
           CALL "C$TOLOWER" USING ASCII-DIR-DONE, VALUE 05.
           MOVE ASCII-DIRECTORY-PATH TO DIR-ACCESS-BUF.
           PERFORM DIR-ACCESS-CALL.
           IF STAT NOT = "00"
              CALL "C$MAKEDIR" USING ASCII-DIRECTORY-PATH GIVING STAT-99
              IF STAT NOT = "00"
                 IF ( EXT-ROUTE-BUF = "00" )
                    MOVE "CAN'T CREATE ASCII/DONE DIRECTORY" TO MESS
                    PERFORM SEND-MESS
                 ELSE
                    MOVE "ERROR: CAN'T CREATE ASCII/DONE DIRECTORY"
                      TO EXT-TCLP-TRACE-MESS
                    MOVE FORM-PATHNAME       TO EXT-TCLP-TRACE-FORM-PATH
                    PERFORM TRACE-SEND-MESS
                 END-IF
                 GO TO MAIN-PROGRAM-EXIT.

      * NEED TO OPEN OUTPUT BEFORE IT ALL GETS STARTED. OPEN I-O WILL
      * NOT CREATE THEM!
           PERFORM OPEN-OUTPUT-ALL-ASCII-FILES.

      *=================================================================
      * PROCESS RISC1 GLOBAL FILES
      *=================================================================

           MOVE "PROCESS RISC1 GLOBAL FILES" TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           PERFORM PROCESS-FILE-AL.
      * REMOVED 4/24/2023 KM SAID START FRESH
      *    PERFORM PROCESS-FILE-AU.
           PERFORM PROCESS-FILE-CD.
           PERFORM PROCESS-FILE-CL.
           PERFORM PROCESS-FILE-GLOBAL-CP.
           PERFORM PROCESS-FILE-EA.
      *    PERFORM PROCESS-FILE-FD.
           PERFORM PROCESS-FILE-GI.
           PERFORM PROCESS-FILE-GL.
           PERFORM PROCESS-FILE-II.
           PERFORM PROCESS-FILE-IR.
           PERFORM PROCESS-FILE-LC.
           PERFORM PROCESS-FILE-PE.
           PERFORM PROCESS-FILE-PW.
      *    PERFORM PROCESS-FILE-RB.
           PERFORM PROCESS-FILE-RC.
           PERFORM PROCESS-FILE-SM.
           PERFORM PROCESS-FILE-SP.
           PERFORM PROCESS-FILE-SS.
           PERFORM PROCESS-FILE-ST.
           PERFORM PROCESS-FILE-TRWINFO.
           PERFORM PROCESS-FILE-TZ.
           PERFORM PROCESS-FILE-WR.

      *=================================================================
      * PROCESS RISC2 GLOBAL FILES TO MERGE/CONVERT
      *=================================================================

           MOVE "PROCESS RISC2 GLOBAL FILES TO MERGE/CONVERT" 
             TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE "R2" TO SOURCE-MACHINE.
           MOVE "R1" TO TARGET-MACHINE.
           CALL "C$TOLOWER" USING SOURCE-MACHINE, VALUE 02.
           CALL "C$TOLOWER" USING TARGET-MACHINE, VALUE 02.

      * NOT MERGING R2 AUFILE, KM SAID MAYBE NOT EVEN CONVERT 4/24/2023

      * CODE FILE, "GC" AND "CN", IF AN R2 BRANCH, OVERWRITE IT
           PERFORM PROCESS-FILE-CD.

      * CAN LOANS, SKIPPING "OK" FROM RISC2, THOSE WERE THE ONLY DUPS
           PERFORM PROCESS-FILE-CL.

      * EXTRACTION, 79,586 DUPLICATES, IF AN R2 BRANCH, OVERWRITE IT
           PERFORM PROCESS-FILE-EA.

      * G/L CONTROL FILE, 2841 DUPLICATES, IF AN R2 BRANCH, OVERWRITE IT
           PERFORM PROCESS-FILE-GI.

      * INSURANCE RATE, 1 DUPLICATE, THEY ARE CHANGING 74 ON R2 TO BE 84
           PERFORM PROCESS-FILE-IR.

      * PASSWORD EXCEPTION, SKIP R2 DUPLICATES
           PERFORM PROCESS-FILE-PE.

      * DAILY STATUS FILE, 938 DIFFERENT ALL BRANCH 9990, SKIP THESE FROM RISC2
           PERFORM PROCESS-FILE-RC.

      * SPR MEMO, NO DUPLICATES
           PERFORM PROCESS-FILE-SM.

      * SPR, NO DUPLICATES
           PERFORM PROCESS-FILE-SP.

      * CREDIT SCORE STATS, NO DUPLICATES
           PERFORM PROCESS-FILE-SS.

      * TIME ZONE, NO DUPLICATES
           PERFORM PROCESS-FILE-TZ.

      * THESE SHOULD BE ALL DUPLICATES FROM RISC2 BUT IT MAKES ME NERVOUS
      * IF IT DOESNT HAPPEN AT EOM, SO JUST SKIP DUPLICATES.
      * KM - SINCE THIS IS STATS ONLY NOW, AND WE ARE RUNNING THE BYFILE
      * MERGE BEFORE CREATING THE WRFILE ON RISC1, IT APPEARS THEN WE HAVE
      * EVERYTHING WE NEED ON RISC1, SO JUST NEED TO CONVERT RISC1 AFTER
      * UPDATING BYFILE TO RISC1 AS PART OF EOM.
      * 4/28/2020 COMMENTED OUT RISC2 UPGRADE OF WRFILE BASEON ON THE
      *           NOTES ABOVE, GETS UPDATED ON RISC1 ONLY.
      *    PERFORM PROCESS-FILE-WR.


      * CREATE DONE TAGS FOR GLOBAL FILES - EVEN IF NO FILES, NEED TO KNOW
      * ITS DONE. THE LOCALS WILL BE CREATED AT END OF PROGRAM

           PERFORM CREATE-GLOBAL-DONE-TAGS.

      * START LOCAL FILES USING BRANCH GROUP LOGIC

      * CURRENT-MACHINE WILL BE RISC1, "R1"
           MOVE CURRENT-MACHINE TO SOURCE-MACHINE TARGET-MACHINE.

           MOVE "PROCESS LOCAL FILES" TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME         TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           IF ( GROUP-FLAG = "N" )
              MOVE BEG-BRANCH TO BR-NO
              PERFORM START-BR-FILE
              GO TO MAIN-PROGRAM-NEXT-BRANCH.

           MOVE ENT-GROUP TO GR-ID.
           PERFORM SEARCH-GR-INIT.

       MAIN-PROGRAM-NEXT-GROUP.

           IF ( GROUP-FLAG = "N" )
              GO TO MAIN-PROGRAM-NEXT-BRANCH.

           PERFORM SEARCH-GR-NEXT.
           IF ( WGR-SRESULT = ZEROES )
              GO TO MAIN-PROGRAM-EXIT.

           MOVE WGR-SRESULT TO BR-NO.
           PERFORM READ-BR-FILE.
           IF ( IO-BAD )
              GO TO IO-ERROR.

           GO TO MAIN-PROGRAM-PROCESS-BRNO.

       MAIN-PROGRAM-NEXT-BRANCH.

           PERFORM READ-BR-FILE-NEXT.
           IF ( IO-BAD             ) OR
              ( BR-NO > END-BRANCH )
              GO TO MAIN-PROGRAM-EXIT.

       MAIN-PROGRAM-PROCESS-BRNO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JKC 2024-1216 SKIPPING BRANCH 9991 DUE TO A15 BRFILE SAYING
      *     IT IS A 'R1' WHEN S35 HAS IT AS 'R2'; THERE IS NO DATA
      *     FOR 'R2' BUT THERE IS FOR 'R1' WHICH IS THROWING OFF
      *     COMPARISONS AND COUNTS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( BR-NO = 9991 )
              GO TO MAIN-PROGRAM-NEXT-GROUP.

           MOVE EXT-FILPATH-BASE           TO FILPATH-BASE.
      *    MOVE BR-MACHINE                 TO FILPATH-MACHINE
      *                                       SOURCE-MACHINE.
      * MADE CHANGE TO USE OLD BRANCH FILE TABLE MACHINE SO WE CAN RERUN
      * AFTER THE NEW BRANCH FILE GETS CHANGED TO ALL R1
           MOVE BR-MACHINE                 TO FILPATH-MACHINE.
           MOVE BRANCH-MACHINE(BR-NO)      TO SOURCE-MACHINE.
           MOVE BR-DATA-PATH               TO FILPATH-DATA.

           PERFORM UP1534-CREATE-BRANCH-HEAD.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * PROCESS LOCAL FILES FOR RISC1 & RISC2 BASED ON BR-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM PROCESS-FILE-BW.
           PERFORM PROCESS-FILE-CA.
           PERFORM PROCESS-FILE-CI.
           PERFORM PROCESS-FILE-CK.
           PERFORM PROCESS-FILE-CX.
           PERFORM PROCESS-FILE-LOCAL-CP.
           PERFORM PROCESS-FILE-DL.
      *    PERFORM PROCESS-FILE-DM.
      * REMOVED DS 3/27/2020 PT0214, START EMPTY
      *    PERFORM PROCESS-FILE-DS.
           PERFORM PROCESS-FILE-DT.
      *    PERFORM PROCESS-FILE-ES.
           PERFORM PROCESS-FILE-GB.
           PERFORM PROCESS-FILE-IC.
           PERFORM PROCESS-FILE-IX.
           PERFORM PROCESS-FILE-LE.
           PERFORM PROCESS-FILE-LH.
           PERFORM PROCESS-FILE-LN.
           PERFORM PROCESS-FILE-LP.
           PERFORM PROCESS-FILE-LS.
           PERFORM PROCESS-FILE-LT.
           PERFORM PROCESS-FILE-LX.
      * REMOVED ML FILE UPGRADE 5/12/2023 PER KEVIN
      *    PERFORM PROCESS-FILE-ML.
      *    PERFORM PROCESS-FILE-MP.
      *    PERFORM PROCESS-FILE-PA.
      *    PERFORM PROCESS-FILE-PC.
      *    PERFORM PROCESS-FILE-PD.
           PERFORM PROCESS-FILE-RX.
           PERFORM PROCESS-FILE-TY.

           GO TO MAIN-PROGRAM-NEXT-GROUP.

      *=================================================================
       MAIN-PROGRAM-EXIT.

      * CREATE DONE TAGS EVEN IF NO RECORDS FOUND, NEED TO KNOW ITS DONE
           IF NOT EXIT-PRIOR-TO-EXECUTION
              PERFORM CREATE-DONE-TAGS.
           PERFORM PRINT-REPORT-MODULE.
           PERFORM EXTRACT-ROUTINE.

           GO TO END-PROGRAM.
 
      ******************************************************************
      *
      *    I N I T I A L I Z A T I O N
      *
      ******************************************************************
       INITIALIZATION SECTION.

           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "UP1534"      TO VDU-FORM-NAME.

           MOVE "X"           TO RECORDS-FOUND.

           MOVE UP1534-QUEUE-POS           TO Q-POS.
           MOVE UP1534-COPIES-POS          TO C-POS.
           MOVE UP1534-PRU-POS             TO P-POS.
           MOVE SPACES                     TO Q-BUF  C-BUF  P-BUF.

       COPY "LIBGB/EOINIT.CPY".

           IF ( BEG-BRANCH = ZEROES ) AND ( END-BRANCH = ZEROES )
              MOVE BEG-BRANCH              TO SV-BEG-BRANCH
              MOVE END-BRANCH              TO SV-END-BRANCH
              MOVE EXT-CONAME-USER-LOC     TO BEG-BRANCH.

           PERFORM GET-GPENV.

           IF ( EXT-EOBUF-GROUP-FG = "Y" )
              MOVE BEG-BRANCH              TO SV-BEG-BRANCH
              MOVE END-BRANCH              TO SV-END-BRANCH
              MOVE GROUP-FLAG              TO SV-GROUP-FLAG
              MOVE ENT-GROUP               TO SV-ENT-GROUP
              MOVE ZEROES                  TO BEG-BRANCH
              MOVE 9999                    TO END-BRANCH
              MOVE "Y"                     TO GROUP-FLAG
              MOVE EXT-EOBUF-GROUP         TO ENT-GROUP
              MOVE EXT-EOBUF-GROUP-PRPATH  TO PRU-FILE.

           MOVE "N"                        TO RECORDS-FOUND.
           PERFORM SEND-STARTING-TIME.

           MOVE EXT-CONAME-CONAME          TO H1-NAME.
           MOVE EXT-CONAME-SYSDATE         TO H1-DATE
                                              ALP-DATE.
           PERFORM CONVERT-ALPDATE-TO-YYYYMMDD
           MOVE DATE-YYYYMMDD              TO TODAYS-DATE.
           MOVE EXT-CONAME-USER-ID         TO H2-USERID.

      ******************************************************************
      *           FORMAT 5 YEAR PURGE DATE FOR CAFILE                  *
      ******************************************************************
           MOVE EXT-CONAME-SYSDATE-MM      TO DATE-MMDDYY-MM.
           MOVE EXT-CONAME-SYSDATE-DD      TO DATE-MMDDYY-DD.
           MOVE EXT-CONAME-SYSDATE-YY      TO DATE-MMDDYY-YY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD              TO NDTE-DATE.
           MOVE 99                         TO NDTE-DD.
           PERFORM NEW-DATE-CALCULATION.
           MOVE -5                         TO NDTE-HOLD.
           PERFORM INCREMENT-YEARS.
           MOVE NDTE-DATE                  TO WS-PURGE-DATE-YYYYMMDD.
      *
           MOVE MKTEMP-DEFAULT             TO MKTEMP-BUF.
           PERFORM MKTEMP-CALL.
           MOVE MKTEMP-BUF                 TO UP1534-REPORT-PATH.
   
           PERFORM OPEN-REPORT-FILE-OUTPUT.
           PERFORM CLOSE-REPORT-FILE.
           MOVE ZEROES TO UP1534-REPORT-KEY.

           PERFORM LOAD-SORT-FILE.
           PERFORM OPEN-SORT-FILE.

           PERFORM OPEN-BR-FILE.
           PERFORM OPEN-GR1-FILE.
           PERFORM OPEN-REPORT-FILE.
 
          
       EXIT-INITIALIZATION.
           EXIT.

      ******************************************************************
      *
      *    E N T E R - P A R A M E T E R S
      *
      ******************************************************************
       ENTER-PARAMETERS SECTION.
       ENTER-PARAMETERS-BEGIN.

           MOVE "S  A300TITLE:FR."               TO VDU.
           MOVE "[ 'A15' TO 'A34' CONVERSION  ]" TO VDUBUF.
           PERFORM SCREENIO.

           PERFORM SEND-FIL.

           MOVE SOURCE-PATH                TO WR-BUF.
           MOVE SOURCE-PATH-LIST           TO WR-LIST.
           PERFORM CALL-WRFORM.

           MOVE TARGET-PATH                TO WR-BUF.
           MOVE TARGET-PATH-LIST           TO WR-LIST.
           PERFORM CALL-WRFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( UP-KEY )
              GO TO ENTER-OPTION-AL.

      *=================================================================
       ENTER-SOURCE-PATH.

           MOVE LEGEND-SOURCE-PATH TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A090S-PATH." TO VDU.
           PERFORM SCREENIO.

           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-SOURCE-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( VDUBUF = SPACES )
              GO TO ENTER-SOURCE-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    SOURCE FILE ACCESS CHECK:
      *    - TO PREVENT BOMBING OUT IF BRANCH'S FILES NOT ON THIS SYSTEM
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE VDUBUF TO DIR-ACCESS-BUF SOURCE-PATH.
           PERFORM DIR-ACCESS-CALL.
           IF ( STAT-BAD )
              PERFORM INVALID-FILE-PATH-MESSAGE
              GO TO ENTER-SOURCE-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    SOURCE FILE ACCESS CHECK:
      *    - TO PREVENT BOMBING OUT IF BRANCH'S FILES NOT ON THIS SYSTEM
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO DIR-ACCESS-BUF.

           STRING VDUBUF, "/", CURRENT-MACHINE
                  DELIMITED BY " "       INTO DIR-ACCESS-BUF.

           PERFORM DIR-ACCESS-CALL.

           IF ( STAT-BAD )
              PERFORM INVALID-FILE-PATH-MESSAGE
              GO TO ENTER-SOURCE-PATH.

           MOVE VDUBUF                TO SOURCE-PATH.

      *-----------------------------------------------------------------
       ENTER-TARGET-PATH.

           MOVE LEGEND-TARGET-PATH TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A090T-PATH." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-SOURCE-PATH.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-TARGET-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( VDUBUF = SPACES )
              GO TO ENTER-TARGET-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    TARGET FILE ACCESS CHECK:
      *    - TO PREVENT BOMBING OUT IF BRANCH'S FILES NOT ON THIS SYSTEM
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO DIR-ACCESS-BUF.

           STRING VDUBUF, "/", CURRENT-MACHINE
                  DELIMITED BY " "       INTO DIR-ACCESS-BUF.

           PERFORM DIR-ACCESS-CALL.

           IF ( STAT-BAD )
              MOVE MESSAGE-INVALID-FILE-PATH TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-TARGET-PATH.

           MOVE VDUBUF                TO TARGET-PATH.

           IF ( SOURCE-PATH = TARGET-PATH )
              MOVE MESSAGE-INVALID-SAME-PATHS TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-SOURCE-PATH.

      *=================================================================
      *    ENTERING BRANCH NUMBER RANGE.
      *=================================================================
       ENTER-BEG-BRANCH.

           MOVE LEGEND-BEG-BRANCH TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A000BEG-BRANCH." TO VDU.
           PERFORM SCREENIO.

           IF ( UP-KEY ) GO TO ENTER-TARGET-PATH.
           IF ( F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF ( F3-KEY ) GO TO ENTER-ALL-BRANCH.
           IF ( F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.

           IF ( F6-KEY )
              PERFORM SCAN-GR-FILE
              IF ( IO-BAD )
                 GO TO ENTER-BEG-BRANCH.

           IF NOT ( DOWN-KEY OR ENTER-KEY ) GO TO ENTER-BEG-BRANCH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE VDUBUF TO WGR-WORD ENT-GROUP.

           IF ( WGR-WORD-ZERO )
              GO TO BRANCH-IS-NUMERIC.

           MOVE ZEROES TO WGR-MIN-LEVEL.
           PERFORM CHECK-MEMBER.

           IF ( WGR-ERR > ZEROES )
              MOVE WGR-MSG(WGR-ERR) TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-BEG-BRANCH.

           IF ( WGR-TYPE = "A" )
              MOVE "S  A000END-BRANCH." TO VDU
              MOVE SPACES               TO VDUBUF
              PERFORM SCREENIO
              MOVE "Y"                  TO GROUP-FLAG
              MOVE ZEROES               TO BEG-BRANCH
              MOVE 9999                 TO END-BRANCH
              GO TO CHECK-BRANCH-SECURITY.

      *----------------------------------------------------------------
       BRANCH-IS-NUMERIC.

           MOVE "N"                        TO GROUP-FLAG.
           MOVE WGR-SRESULT                TO BEG-BRANCH.
           MOVE "SN N040BEG-BRANCH."       TO VDU.
           MOVE BEG-BRANCH                 TO VDUNUM0.
           PERFORM SCREENIO.

      *----------------------------------------------------------------
       ENTER-END-BRANCH.

           IF ( UP-KEY           ) AND
              ( GROUP-FLAG = "Y" )
              GO TO ENTER-BEG-BRANCH.

           MOVE LEGEND-END-BRANCH TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "ENNN040END-BRANCH." TO VDU.
           PERFORM SCREENIO.

           IF ( UP-KEY ) GO TO ENTER-BEG-BRANCH.
           IF ( F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF ( F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.

           IF NOT ( DOWN-KEY OR ENTER-KEY ) GO TO ENTER-END-BRANCH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE VDUNUM0 TO END-BRANCH.

           IF ( BEG-BRANCH > END-BRANCH )
              MOVE "INVALID BRANCH RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-BEG-BRANCH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           GO TO CHECK-BRANCH-SECURITY.

      *-----------------------------------------------------------------
       ENTER-ALL-BRANCH.

           MOVE "N"                  TO GROUP-FLAG.
           MOVE "SNNN040BEG-BRANCH." TO VDU.
           MOVE ZEROES               TO VDUNUM0 BEG-BRANCH.
           PERFORM SCREENIO.

           MOVE "SNNN040END-BRANCH." TO VDU.
           MOVE 9999                 TO VDUNUM0 END-BRANCH.
           PERFORM SCREENIO.

      *-----------------------------------------------------------------
       CHECK-BRANCH-SECURITY.

           PERFORM BR-RANGE-SECURITY.
           IF ( BR-SECURITY-OKAY = "N" )
              GO TO ENTER-BEG-BRANCH.

      *========================================{ SOURCE & TARGET FILES }
       ENTER-OPTION-AL.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-AL." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-END-BRANCH.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF (        F9-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-AL.

           MOVE VDUBUF TO FILE-OPTION-AL.

           IF NOT ( FILE-OPTION-AL = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-AL.

      *-----------------------------------------------------------------
      *ENTER-OPTION-AU.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-AU." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-WR.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-AU.

      *    MOVE VDUBUF TO FILE-OPTION-AU.

      *    IF NOT ( FILE-OPTION-AU = "Y" OR "N" )
      *       MOVE "INVALID : 'Y' OR 'N' ONLY" TO MESS
      *       PERFORM SEND-MESS
      *       GO TO ENTER-OPTION-AU.

      *-----------------------------------------------------------------
       ENTER-OPTION-CD.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CD." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-AL.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CD.

           MOVE VDUBUF TO FILE-OPTION-CD.

           IF NOT ( FILE-OPTION-CD = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-CD.

      *-----------------------------------------------------------------
       ENTER-OPTION-CL.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CL." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CD.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CL.

           MOVE VDUBUF TO FILE-OPTION-CL.

           IF NOT ( FILE-OPTION-CL = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-CL.

      *-----------------------------------------------------------------
       ENTER-GLOBAL-CP.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010GLOBAL-CP." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CL.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-GLOBAL-CP.

           MOVE VDUBUF TO FILE-GLOBAL-CP.

           IF NOT ( FILE-GLOBAL-CP = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-GLOBAL-CP.

      *-----------------------------------------------------------------
       ENTER-OPTION-EA.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-EA." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-GLOBAL-CP.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-EA.

           MOVE VDUBUF TO FILE-OPTION-EA.

           IF NOT ( FILE-OPTION-EA = "Y" OR "N" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-EA.

      *-----------------------------------------------------------------
      *ENTER-OPTION-EP.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-EP." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-EA.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-EP.

      *    MOVE VDUBUF TO FILE-OPTION-EP.

      *    IF NOT ( FILE-OPTION-EP = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-EP.

      *-----------------------------------------------------------------
      *ENTER-OPTION-EW.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-EW." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-EP.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-EW.

      *    MOVE VDUBUF TO FILE-OPTION-EW.

      *    IF NOT ( FILE-OPTION-EW = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-EW.

      *-----------------------------------------------------------------
      *ENTER-OPTION-FD.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-FD." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-EW.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-FD.

      *    MOVE VDUBUF TO FILE-OPTION-FD.

      *    IF NOT ( FILE-OPTION-FD = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-FD.

      *-----------------------------------------------------------------
      *ENTER-OPTION-FS.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-FS." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-EA.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-FS.

      *    MOVE VDUBUF TO FILE-OPTION-FS.

      *    IF NOT ( FILE-OPTION-FS = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-FS.

      *-----------------------------------------------------------------
       ENTER-OPTION-GI.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-GI." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-EA.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-GI.

           MOVE VDUBUF TO FILE-OPTION-GI.

           IF NOT ( FILE-OPTION-GI = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-GI.

      *-----------------------------------------------------------------
       ENTER-OPTION-GL.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-GL." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-GI.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-GL.

           MOVE VDUBUF TO FILE-OPTION-GL.

           IF NOT ( FILE-OPTION-GL = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-GL.

      *-----------------------------------------------------------------
       ENTER-OPTION-II.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-II." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-GL.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-II.

           MOVE VDUBUF TO FILE-OPTION-II.

           IF NOT ( FILE-OPTION-II = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-II.

      *-----------------------------------------------------------------
       ENTER-OPTION-IR.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-IR." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-II.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-IR.

           MOVE VDUBUF TO FILE-OPTION-IR.

           IF NOT ( FILE-OPTION-IR = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-IR.

      *-----------------------------------------------------------------
      *ENTER-OPTION-JD.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-JD." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-IR.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-JD.

      *    MOVE VDUBUF TO FILE-OPTION-JD.

      *    IF NOT ( FILE-OPTION-JD = "Y" OR "N" OR "A" )
      *       MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
      *       PERFORM SEND-MESS
      *       GO TO ENTER-OPTION-JD.

      *-----------------------------------------------------------------
       ENTER-OPTION-LC.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LC." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-IR.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LC.

           MOVE VDUBUF TO FILE-OPTION-LC.

           IF NOT ( FILE-OPTION-LC = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-LC.

      *-----------------------------------------------------------------
       ENTER-OPTION-PE.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-PE." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LC.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-PE.

           MOVE VDUBUF TO FILE-OPTION-PE.

           IF NOT ( FILE-OPTION-PE = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-PE.

      *-----------------------------------------------------------------
       ENTER-OPTION-PW.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-PW." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-PE.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-PW.

           MOVE VDUBUF TO FILE-OPTION-PW.

           IF NOT ( FILE-OPTION-PW = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-PW.

      *-----------------------------------------------------------------
      *ENTER-OPTION-RB.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-RB." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-PW.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-RB.

      *    MOVE VDUBUF TO FILE-OPTION-RB.

      *    IF NOT ( FILE-OPTION-RB = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-RB.

      *-----------------------------------------------------------------
       ENTER-OPTION-RC.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-RC." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-PW.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-RC.

           MOVE VDUBUF TO FILE-OPTION-RC.

           IF NOT ( FILE-OPTION-RC = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-RC.

      *-----------------------------------------------------------------
       ENTER-OPTION-SM.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-SM." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-RC.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-SM.

           MOVE VDUBUF TO FILE-OPTION-SM.

           IF NOT ( FILE-OPTION-SM = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-SM.

      *-----------------------------------------------------------------
      *-----------------------------------------------------------------
       ENTER-OPTION-SP.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-SP." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-SM.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-SP.

           MOVE VDUBUF TO FILE-OPTION-SP.

           IF NOT ( FILE-OPTION-SP = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-SP.

      *-----------------------------------------------------------------
       ENTER-OPTION-SS.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-SS." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-SP.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-SS.

           MOVE VDUBUF TO FILE-OPTION-SS.

           IF NOT ( FILE-OPTION-SS = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-SS.

      *-----------------------------------------------------------------
       ENTER-OPTION-ST.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-ST." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-SS.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-ST.

           MOVE VDUBUF TO FILE-OPTION-ST.

           IF NOT ( FILE-OPTION-ST = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-ST.

      *-----------------------------------------------------------------
       ENTER-OPTION-TRWINFO.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-TRW." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-ST.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-TRWINFO.

           MOVE VDUBUF TO FILE-OPTION-TRWINFO.

           IF NOT ( FILE-OPTION-TRWINFO = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-TRWINFO.

      *-----------------------------------------------------------------
       ENTER-OPTION-TZ.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-TZ." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-TRWINFO.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-TZ.

           MOVE VDUBUF TO FILE-OPTION-TZ.

           IF NOT ( FILE-OPTION-TZ = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-TZ.

      *-----------------------------------------------------------------
       ENTER-OPTION-WR.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-WR." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-TZ.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-WR.

           MOVE VDUBUF TO FILE-OPTION-WR.

           IF NOT ( FILE-OPTION-WR = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-WR.

      *-----------------------------------------------------------------
       ENTER-OPTION-BW.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-BW." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-WR.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-BW.

           MOVE VDUBUF TO FILE-OPTION-BW.

           IF NOT ( FILE-OPTION-BW = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-BW.

      *-----------------------------------------------------------------
       ENTER-OPTION-CA.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CA." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-BW.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CA.

           MOVE VDUBUF TO FILE-OPTION-CA.

           IF NOT ( FILE-OPTION-CA = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-CA.

      *-----------------------------------------------------------------
       ENTER-OPTION-CI.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CI." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CA.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CI.

           MOVE VDUBUF TO FILE-OPTION-CI.

           IF NOT ( FILE-OPTION-CI = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-CI.

      *-----------------------------------------------------------------
       ENTER-OPTION-CK.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CK." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CI.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CK.

           MOVE VDUBUF TO FILE-OPTION-CK.
           IF NOT ( FILE-OPTION-CK = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-CK.

      *-----------------------------------------------------------------
       ENTER-OPTION-CP.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CP." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CK.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CP.

           MOVE VDUBUF TO FILE-OPTION-CP.

           IF NOT ( FILE-OPTION-CP = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-CP.

      *-----------------------------------------------------------------
       ENTER-OPTION-CX.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-CX." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CP.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-CX.

           MOVE VDUBUF TO FILE-OPTION-CX.

           IF NOT ( FILE-OPTION-CX = "Y" OR "N" )
              MOVE "INVALID : 'Y' OR 'N' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-CX.

      *-----------------------------------------------------------------
       ENTER-OPTION-DL.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-DL." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-CX.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-DL.

           MOVE VDUBUF TO FILE-OPTION-DL.

           IF NOT ( FILE-OPTION-DL = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-DL.

      *-----------------------------------------------------------------
      *ENTER-OPTION-DM.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-DM." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-DL.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-DM.

      *    MOVE VDUBUF TO FILE-OPTION-DM.

      *    IF NOT ( FILE-OPTION-DM = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-DM.

      *-----------------------------------------------------------------
      *ENTER-OPTION-DS.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-DS." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-DL.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-DS.

      *    MOVE VDUBUF TO FILE-OPTION-DS.

      *    IF NOT ( FILE-OPTION-DS = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-DS.

      *-----------------------------------------------------------------
       ENTER-OPTION-DT.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-DT." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-DL.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-DT.

           MOVE VDUBUF TO FILE-OPTION-DT.

           IF NOT ( FILE-OPTION-DT = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-DT.

      *-----------------------------------------------------------------
      *ENTER-OPTION-ES.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-ES." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-DT.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-ES.

      *    MOVE VDUBUF TO FILE-OPTION-ES.

      *    IF NOT ( FILE-OPTION-ES = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-ES.

      *-----------------------------------------------------------------
       ENTER-OPTION-GB.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-GB." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-DT.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-GB.

           MOVE VDUBUF TO FILE-OPTION-GB.

           IF NOT ( FILE-OPTION-GB = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-GB.

      *-----------------------------------------------------------------
       ENTER-OPTION-IC.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-IC." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-GB.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-IC.

           MOVE VDUBUF TO FILE-OPTION-IC.

           IF NOT ( FILE-OPTION-IC = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-IC.

      *-----------------------------------------------------------------
       ENTER-OPTION-IX.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-IX." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-IC.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-IX.

           MOVE VDUBUF TO FILE-OPTION-IX.

           IF NOT ( FILE-OPTION-IX = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-IX.

      *-----------------------------------------------------------------
       ENTER-OPTION-LE.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LE." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-IX.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LE.

           MOVE VDUBUF TO FILE-OPTION-LE.

           IF NOT ( FILE-OPTION-LE = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LE.

      *-----------------------------------------------------------------
       ENTER-OPTION-LH.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LH." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LE.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LH.

           MOVE VDUBUF TO FILE-OPTION-LH.

           IF NOT ( FILE-OPTION-LH = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LH.

      *-----------------------------------------------------------------
       ENTER-OPTION-LN.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LN." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LH.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LN.

           MOVE VDUBUF TO FILE-OPTION-LN.

           IF NOT ( FILE-OPTION-LN = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LN.

      *-----------------------------------------------------------------
       ENTER-OPTION-LP.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LP." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LN.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LP.

           MOVE VDUBUF TO FILE-OPTION-LP.

           IF NOT ( FILE-OPTION-LP = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LP.

      *-----------------------------------------------------------------
       ENTER-OPTION-LS.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LS." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LP.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LS.

           MOVE VDUBUF TO FILE-OPTION-LS.

           IF NOT ( FILE-OPTION-LS = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-LS.

      *-----------------------------------------------------------------
       ENTER-OPTION-LT.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LT." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LS.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LT.

           MOVE VDUBUF TO FILE-OPTION-LT.

           IF NOT ( FILE-OPTION-LT = "Y" OR "N" OR "A" )
              MOVE "INVALID : 'Y', 'N' OR 'A' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LT.

      *-----------------------------------------------------------------
       ENTER-OPTION-LX.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-LX." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LT.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-LX.

           MOVE VDUBUF TO FILE-OPTION-LX.

      *    IF NOT ( FILE-OPTION-LX = "Y" OR "N" OR "A" )
           IF NOT ( FILE-OPTION-LX = "Y" OR "N" )
              MOVE "INVALID : 'Y' OR 'N' ONLY" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-OPTION-LX.

      *-----------------------------------------------------------------
      *ENTER-OPTION-PA.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-PA." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-LX.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-PA.

      *    MOVE VDUBUF TO FILE-OPTION-PA.

      *    IF NOT ( FILE-OPTION-PA = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-PA.

      *-----------------------------------------------------------------
      *ENTER-OPTION-PC.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-PC." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-PA.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-PC.

      *    MOVE VDUBUF TO FILE-OPTION-PC.

      *    IF NOT ( FILE-OPTION-PC = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-PC.

      *-----------------------------------------------------------------
      *ENTER-OPTION-PD.

      *    MOVE LEGEND-OPTION-FILES TO LEGEND.
      *    PERFORM SEND-LEGEND.

      *    MOVE "E  A010OPTION-PD." TO VDU.
      *    PERFORM SCREENIO.

      *    IF (        UP-KEY ) GO TO ENTER-OPTION-PC.
      *    IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
      *    IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
      *    IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
      *    IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-PA.

      *    MOVE VDUBUF TO FILE-OPTION-PD.

      *    IF NOT ( FILE-OPTION-PD = "Y" OR "N" )
      *       PERFORM INVALID-YN-MESSAGE
      *       GO TO ENTER-OPTION-PD.

      *-----------------------------------------------------------------
       ENTER-OPTION-RX.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-RX." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-LX.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-RX.

           MOVE VDUBUF TO FILE-OPTION-RX.

           IF NOT ( FILE-OPTION-RX = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-RX.

      *-----------------------------------------------------------------
       ENTER-OPTION-TY.

           MOVE LEGEND-OPTION-FILES TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "E  A010OPTION-TY." TO VDU.
           PERFORM SCREENIO.

           IF (        UP-KEY ) GO TO ENTER-OPTION-RX.
           IF (        F1-KEY ) GO TO ENTER-PARAMETERS-BEGIN.
           IF (        F2-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F3-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F4-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F5-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F6-KEY ) GO TO ENTER-ALL-OPTIONS.
           IF (        F7-KEY ) GO TO ENTER-PARAMETERS-EXIT.
           IF NOT ( ENTER-KEY ) GO TO ENTER-OPTION-TY.

           MOVE VDUBUF TO FILE-OPTION-TY.

           IF NOT ( FILE-OPTION-TY = "Y" OR "N" )
              PERFORM INVALID-YN-MESSAGE
              GO TO ENTER-OPTION-TY.

           GO TO ENTER-ACCEPT-YN.

      *========================================{ SOURCE & TARGET FILES }
       ENTER-ALL-OPTIONS.

           IF ( F2-KEY )
              MOVE "C" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "C" TO DEFAULT-LOCAL-OPTIONS
           ELSE
           IF ( F3-KEY )
              MOVE "Y" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "Y" TO DEFAULT-LOCAL-OPTIONS
           ELSE
           IF ( F4-KEY ) 
              MOVE "N" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "N" TO DEFAULT-LOCAL-OPTIONS
           ELSE
           IF ( F5-KEY )
              MOVE "Y" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "N" TO DEFAULT-LOCAL-OPTIONS
           ELSE
           IF ( F9-KEY ) 
              MOVE "N" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "A" TO DEFAULT-LOCAL-OPTIONS
           ELSE
              MOVE "N" TO DEFAULT-GLOBAL-OPTIONS
              MOVE "Y" TO DEFAULT-LOCAL-OPTIONS.

      * GLOBALS
           MOVE "S  A010OPTION-AL."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-AL.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-AU."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-AU.
      *    PERFORM SCREENIO.


           MOVE "S  A010OPTION-CD."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-CD.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CL."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-CL.
           PERFORM SCREENIO.

           MOVE "S  A010GLOBAL-CP."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-GLOBAL-CP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-EA."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-EA.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-EP."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-EP.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-EW."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-EW.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-FD."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-FD.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-FS."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-FS.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-GI."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-GI.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-GL."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-GL.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-II."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-II.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IR."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-IR.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-JD."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-JD.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-LC."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-LC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-PE."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-PE.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-PW."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-PW.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-RB."    TO VDU.
      *    MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-RB.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-RC."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-RC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SM."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-SM.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SP."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-SP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SS."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-SS.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-ST."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-ST.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TRW."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-TRWINFO.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TZ."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-TZ.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-WR."    TO VDU.
           MOVE DEFAULT-GLOBAL-OPTIONS TO VDUBUF FILE-OPTION-WR.
           PERFORM SCREENIO.

      * LOCALS

           MOVE "S  A010OPTION-BW."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-BW.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CA."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-CA.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CI."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-CI.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CK."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-CK.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CP."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-CP
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-CP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CX."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-CX
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-CX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-DL."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-DL
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-DL.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-DT."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-DT
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-DT.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-GB."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-GB
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-GB.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IC."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-IC
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-IC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IX."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-IX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LE."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LE.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LH."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LH.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LN."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LN.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LP."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LS."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-LS
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LS.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LT."    TO VDU.
           MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LT.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LX."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-LX
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-LX.
           PERFORM SCREENIO.

      *
      *    MOVE "S  A010OPTION-PA."    TO VDU.
      *    IF DEFAULT-LOCAL-OPTIONS = "A"
      *       MOVE "Y" TO VDUBUF FILE-OPTION-PA
      *    ELSE
      *       MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-PA.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-RX."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-RX
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-RX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TY."    TO VDU.
           IF DEFAULT-LOCAL-OPTIONS = "A"
              MOVE "Y" TO VDUBUF FILE-OPTION-TY
           ELSE
              MOVE DEFAULT-LOCAL-OPTIONS TO VDUBUF FILE-OPTION-TY.
           PERFORM SCREENIO.

      *=================================================================
       ENTER-ACCEPT-YN.
           MOVE LEGEND-ACCEPT TO LEGEND.
           PERFORM SEND-LEGEND.

       ENTER-PARAMETERS-EXIT.
           EXIT.

      *****************************************************************
      *
      *    D I S P L A Y - P A R A M E T E R S
      *
      *****************************************************************
       DISPLAY-PARAMETERS SECTION.

           IF ( GROUP-FLAG = "Y" )
              MOVE "S  A000BEG-BRANCH."   TO VDU
              MOVE ENT-GROUP              TO VDUBUF
              PERFORM SCREENIO
              MOVE "S  A000END-BRANCH."   TO VDU
              MOVE SPACES                 TO VDUBUF
              PERFORM SCREENIO
           ELSE
              MOVE "SNNN040BEG-BRANCH."   TO VDU
              MOVE BEG-BRANCH             TO VDUNUM0
              PERFORM SCREENIO
              MOVE "SNNN040END-BRANCH."   TO VDU
              MOVE END-BRANCH             TO VDUNUM0
              PERFORM SCREENIO.

           MOVE "S  A090S-PATH."          TO VDU.
           MOVE SOURCE-PATH               TO VDUBUF.
           PERFORM SCREENIO.

           MOVE "S  A090T-PATH."          TO VDU.
           MOVE TARGET-PATH               TO VDUBUF.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-AL."       TO VDU.
           MOVE FILE-OPTION-AL            TO VDUBUF FILE-OPTION-AL.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-AU."       TO VDU.
      *    MOVE FILE-OPTION-AU            TO VDUBUF FILE-OPTION-AU.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-CD."       TO VDU.
           MOVE FILE-OPTION-CD            TO VDUBUF FILE-OPTION-CD.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CL."       TO VDU.
           MOVE FILE-OPTION-CL            TO VDUBUF FILE-OPTION-CL.
           PERFORM SCREENIO.

           MOVE "S  A010GLOBAL-CP."       TO VDU.
           MOVE FILE-GLOBAL-CP            TO VDUBUF FILE-GLOBAL-CP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-EA."       TO VDU.
           MOVE FILE-OPTION-EA            TO VDUBUF FILE-OPTION-EA.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-EP."       TO VDU.
      *    MOVE FILE-OPTION-EP            TO VDUBUF FILE-OPTION-EP.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-EW."       TO VDU.
      *    MOVE FILE-OPTION-EW            TO VDUBUF FILE-OPTION-EW.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-FD."       TO VDU.
      *    MOVE FILE-OPTION-FD            TO VDUBUF FILE-OPTION-FD.
      *    PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-FS."       TO VDU.
      *    MOVE FILE-OPTION-FS            TO VDUBUF FILE-OPTION-FS.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-GI."       TO VDU.
           MOVE FILE-OPTION-GI            TO VDUBUF FILE-OPTION-GI.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-GL."       TO VDU.
           MOVE FILE-OPTION-GL            TO VDUBUF FILE-OPTION-GL.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-II."       TO VDU.
           MOVE FILE-OPTION-II            TO VDUBUF FILE-OPTION-II.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IR."       TO VDU.
           MOVE FILE-OPTION-IR            TO VDUBUF FILE-OPTION-IR.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-JD."       TO VDU.
      *    MOVE FILE-OPTION-JD            TO VDUBUF FILE-OPTION-JD.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-LC."       TO VDU.
           MOVE FILE-OPTION-LC            TO VDUBUF FILE-OPTION-LC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-PE."       TO VDU.
           MOVE FILE-OPTION-PE            TO VDUBUF FILE-OPTION-PE.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-PW."       TO VDU.
           MOVE FILE-OPTION-PW            TO VDUBUF FILE-OPTION-PW.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-RB."       TO VDU.
      *    MOVE FILE-OPTION-RB            TO VDUBUF FILE-OPTION-RB.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-RC."       TO VDU.
           MOVE FILE-OPTION-RC            TO VDUBUF FILE-OPTION-RC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SM."       TO VDU.
           MOVE FILE-OPTION-SM            TO VDUBUF FILE-OPTION-SM.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SP."       TO VDU.
           MOVE FILE-OPTION-SP            TO VDUBUF FILE-OPTION-SP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-SS."       TO VDU.
           MOVE FILE-OPTION-SS            TO VDUBUF FILE-OPTION-SS.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-ST."       TO VDU.
           MOVE FILE-OPTION-ST            TO VDUBUF FILE-OPTION-ST.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TRW."      TO VDU.
           MOVE FILE-OPTION-TRWINFO       TO VDUBUF FILE-OPTION-TRWINFO.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TZ."       TO VDU.
           MOVE FILE-OPTION-TZ            TO VDUBUF FILE-OPTION-TZ.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-WR."       TO VDU.
           MOVE FILE-OPTION-WR            TO VDUBUF FILE-OPTION-WR.
           PERFORM SCREENIO.

      * LOCALS

           MOVE "S  A010OPTION-BW."       TO VDU.
           MOVE FILE-OPTION-BW            TO VDUBUF FILE-OPTION-BW.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CA."       TO VDU.
           MOVE FILE-OPTION-CA            TO VDUBUF FILE-OPTION-CA.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CI."       TO VDU.
           MOVE FILE-OPTION-CI            TO VDUBUF FILE-OPTION-CI.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CK."       TO VDU.
           MOVE FILE-OPTION-CK            TO VDUBUF FILE-OPTION-CK.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CP."       TO VDU.
           MOVE FILE-OPTION-CP            TO VDUBUF FILE-OPTION-CP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-CX."       TO VDU.
           MOVE FILE-OPTION-CX            TO VDUBUF FILE-OPTION-CX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-DL."       TO VDU.
           MOVE FILE-OPTION-DL            TO VDUBUF FILE-OPTION-DL.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-DT."       TO VDU.
           MOVE FILE-OPTION-DT            TO VDUBUF FILE-OPTION-DT.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-GB."       TO VDU.
           MOVE FILE-OPTION-GB            TO VDUBUF FILE-OPTION-GB.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IC."       TO VDU.
           MOVE FILE-OPTION-IC            TO VDUBUF FILE-OPTION-IC.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-IX."       TO VDU.
           MOVE FILE-OPTION-IX            TO VDUBUF FILE-OPTION-IX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LE."       TO VDU.
           MOVE FILE-OPTION-LE            TO VDUBUF FILE-OPTION-LE.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LH."       TO VDU.
           MOVE FILE-OPTION-LH            TO VDUBUF FILE-OPTION-LH.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LN."       TO VDU.
           MOVE FILE-OPTION-LN            TO VDUBUF FILE-OPTION-LN.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LP."       TO VDU.
           MOVE FILE-OPTION-LP            TO VDUBUF FILE-OPTION-LP.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LS."       TO VDU.
           MOVE FILE-OPTION-LS            TO VDUBUF FILE-OPTION-LS.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LT."       TO VDU.
           MOVE FILE-OPTION-LT            TO VDUBUF FILE-OPTION-LT.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-LX."       TO VDU.
           MOVE FILE-OPTION-LX            TO VDUBUF FILE-OPTION-LX.
           PERFORM SCREENIO.

      *    MOVE "S  A010OPTION-PA."       TO VDU.
      *    MOVE FILE-OPTION-PA            TO VDUBUF FILE-OPTION-PA.
      *    PERFORM SCREENIO.

           MOVE "S  A010OPTION-RX."       TO VDU.
           MOVE FILE-OPTION-RX            TO VDUBUF FILE-OPTION-RX.
           PERFORM SCREENIO.

           MOVE "S  A010OPTION-TY."       TO VDU.
           MOVE FILE-OPTION-TY            TO VDUBUF FILE-OPTION-TY.
           PERFORM SCREENIO.

      ******************************************************************
      *
      *    E O - E X E C - A U D I T
      *
      ******************************************************************
       EO-EXEC-AUDIT SECTION.

       EO-EXEC-AUDIT-EXIT.
           EXIT.

      ******************************************************************
       OPEN-OUTPUT-ALL-ASCII-FILES SECTION.
      ******************************************************************
      * CURRENT-MACHINE WILL BE RISC1, "R1"
           MOVE CURRENT-MACHINE TO SOURCE-MACHINE TARGET-MACHINE.
           CALL "C$TOLOWER" USING RISC2, VALUE 02.

           MOVE UP1534-FILE-TYPE---GLOBAL   TO UP1534-FILE-TYPE.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

           IF (FILE-OPTION-GL = "A")
              MOVE "GL/GLFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO AGL-PATH-BEG
              CALL "C$TOLOWER" USING AGL-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AGL-DONE-FILENAME, VALUE 11
              OPEN OUTPUT AGL-FILE
              CLOSE AGL-FILE.
           IF (FILE-OPTION-RC = "A")
              MOVE "GB/RCFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ARC-PATH-BEG
              CALL "C$TOLOWER" USING ARC-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ARC-DONE-FILENAME, VALUE 11
              OPEN OUTPUT ARC-FILE
              CLOSE ARC-FILE.
           IF (FILE-OPTION-WR = "A")
              MOVE "SP/WRFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO AWR-PATH-BEG
              CALL "C$TOLOWER" USING AWR-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AWR-DONE-FILENAME, VALUE 11
              OPEN OUTPUT AWR-FILE
              CLOSE AWR-FILE.

      * LOCAL FILES
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           IF (FILE-OPTION-BW = "A")
              MOVE "GB/BWFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ABW-PATH-BEG
              CALL "C$TOLOWER" USING ABW-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ABW-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ABW-PATH-GROUP
              OPEN OUTPUT ABW-FILE
              CLOSE ABW-FILE.
           IF (FILE-OPTION-BW = "A")
              MOVE "GB/BXFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ABX-PATH-BEG
              CALL "C$TOLOWER" USING ABX-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ABX-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ABX-PATH-GROUP
              OPEN OUTPUT ABX-FILE
              CLOSE ABX-FILE.
           IF (FILE-OPTION-CA = "A")
              MOVE "LP/CAFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ACA-PATH-BEG
              CALL "C$TOLOWER" USING ACA-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACA-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACA-PATH-GROUP
              OPEN OUTPUT ACA-FILE
              CLOSE ACA-FILE.
           IF (FILE-OPTION-CI = "A")
              MOVE "LP/CIFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ACI-PATH-BEG
              CALL "C$TOLOWER" USING ACI-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACI-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACI-PATH-GROUP
              OPEN OUTPUT ACI-FILE
              CLOSE ACI-FILE.
           IF (FILE-OPTION-CK = "A")
              MOVE "LP/CKFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ACK-PATH-BEG
              CALL "C$TOLOWER" USING ACK-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACK-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACK-PATH-GROUP
              OPEN OUTPUT ACK-FILE
              CLOSE ACK-FILE.
           IF (FILE-OPTION-IX = "A")
              MOVE "LP/IXFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO AIX-PATH-BEG
              CALL "C$TOLOWER" USING AIX-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AIX-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO AIX-PATH-GROUP
              OPEN OUTPUT AIX-FILE
              CLOSE AIX-FILE.
           IF (FILE-OPTION-LE = "A")
              MOVE "LP/LEFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALE-PATH-BEG
              CALL "C$TOLOWER" USING ALE-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALE-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALE-PATH-GROUP
              OPEN OUTPUT ALE-FILE
              CLOSE ALE-FILE.
           IF (FILE-OPTION-LH = "A")
              MOVE "LP/LHFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALH-PATH-BEG
              CALL "C$TOLOWER" USING ALH-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALH-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALH-PATH-GROUP
              OPEN OUTPUT ALH-FILE
              CLOSE ALH-FILE.
           IF (FILE-OPTION-LN = "A")
              MOVE "LP/LNFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALN-PATH-BEG
              CALL "C$TOLOWER" USING ALN-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALN-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALN-PATH-GROUP
              OPEN OUTPUT ALN-FILE
              CLOSE ALN-FILE.
           IF (FILE-OPTION-LP = "A")
              MOVE "GB/LPFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALP-PATH-BEG
              CALL "C$TOLOWER" USING ALP-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALP-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALP-PATH-GROUP
              OPEN OUTPUT ALP-FILE
              CLOSE ALP-FILE.
      *KC  IF (FILE-OPTION-LT = "A")
      *       MOVE "LP/LTAFILE" TO UP1534-FILE-INPUT
      *       PERFORM UP1534-LOAD-FILE-PATH
      *       MOVE UP1534-FILE-PATH TO ALTA-PATH-BEG
      *       CALL "C$TOLOWER" USING ALTA-FILENAME, VALUE 06
      *       CALL "C$TOLOWER" USING ALTA-DONE-FILENAME, VALUE 11
      *       MOVE HOLD-ASCII-PATH-GROUP TO ALTA-PATH-GROUP
      *       OPEN OUTPUT ALTA-FILE
      *KC     CLOSE ALTA-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTBFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTB-PATH-BEG
              CALL "C$TOLOWER" USING ALTB-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTB-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTB-PATH-GROUP
              OPEN OUTPUT ALTB-FILE
              CLOSE ALTB-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTCFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTC-PATH-BEG
              CALL "C$TOLOWER" USING ALTC-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTC-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTC-PATH-GROUP
              OPEN OUTPUT ALTC-FILE
              CLOSE ALTC-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTDFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTD-PATH-BEG
              CALL "C$TOLOWER" USING ALTD-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTD-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTD-PATH-GROUP
              OPEN OUTPUT ALTD-FILE
              CLOSE ALTD-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTFFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTF-PATH-BEG
              CALL "C$TOLOWER" USING ALTF-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTF-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTF-PATH-GROUP
              OPEN OUTPUT ALTF-FILE
              CLOSE ALTF-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTIFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTI-PATH-BEG
              CALL "C$TOLOWER" USING ALTI-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTI-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTI-PATH-GROUP
              OPEN OUTPUT ALTI-FILE
              CLOSE ALTI-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTLFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTL-PATH-BEG
              CALL "C$TOLOWER" USING ALTL-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTL-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTL-PATH-GROUP
              OPEN OUTPUT ALTL-FILE
              CLOSE ALTL-FILE.
           IF (FILE-OPTION-LT = "A")
              MOVE "LP/LTPFILE" TO UP1534-FILE-INPUT
              PERFORM UP1534-LOAD-FILE-PATH
              MOVE UP1534-FILE-PATH TO ALTP-PATH-BEG
              CALL "C$TOLOWER" USING ALTP-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTP-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTP-PATH-GROUP
              OPEN OUTPUT ALTP-FILE
              CLOSE ALTP-FILE.

      ******************************************************************
      *
      *    L O A D - B R A N C H - T A B L E 
      *
      *=================================================================
      * LOAD A BRANCH TABLE ONE TIME INDEXED BY BR-NO FOR BR-MACHINE
      ******************************************************************
        LOAD-BRANCH-TABLE SECTION.

           MOVE SPACES TO ERRCD.

           MOVE "BR"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/BRFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.

           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
      *KC  MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *KC  PERFORM UP1534-MV15-OLD-TO-NEW.
      *KC  MOVE UP1534-MV15-NEW-PATH       TO OBR-PATH.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JKC 2024-0325 CHANGED TO NOT MOVE THE A15 BRFILE TO BE OBRFILE;
      *     THIS WAS OLD ACU4GL LOGIC WHERE WE NEED TO MAKE IT OBRFILE;
      *     THIS OLD LOGIC CAUSED A LOCKING ISSUE WHEN RUNNING
      *     MULTIPLE SESSIONS VIA BATCHES (HAD 8 SESSIONS).
      *     NOW GOING TO USE DIRECTLY THE A15 BRFILE AS IS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE UP1534-FILE-PATH           TO OBR-PATH.

      *KC  IF ( STAT-BAD )     
      *KC     MOVE "X" TO ERRCD
      *KC     GO TO LOAD-BRANCH-TABLE-EXIT.

           PERFORM OPEN-OBR-FILE.

           MOVE 1 TO OBR-KEY.
           PERFORM START-OBR-FILE.

        LOAD-NEXT-BRANCH.
           PERFORM READ-OBR-FILE-NEXT.
           IF IO-BAD 
              MOVE SPACES TO ERRCD
      *KC     MOVE OBR-PATH TO UP1534-MV15-NEW-PATH
      *KC     PERFORM UP1534-MV15-NEW-TO-OLD
              GO TO LOAD-BRANCH-TABLE-EXIT.

           MOVE OBR-MACHINE TO BRANCH-MACHINE(OBR-NO).

           GO TO LOAD-NEXT-BRANCH.

       LOAD-BRANCH-TABLE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - A L
      *
      ******************************************************************
        PROCESS-FILE-AL SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-AL = "N" )
              GO TO PROCESS-FILE-AL-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO AL-PATH-OVERRIDE.
           MOVE "AL"                       TO UP1534-CURRENT-FILE.
           MOVE "GL/ALFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OAL-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-AL-EXIT.

      * - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
            MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
            PERFORM UP1534-LOAD-FILE-PATH.
            MOVE UP1534-FILE-PATH           TO AL-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OAL1-KEY.
           PERFORM OPEN-OAL1-FILE.
           PERFORM START-OAL1-FILE.

           PERFORM OPEN-AL1-FILE.

      *=================================================================
       PROCESS-FILE-AL-NEXT.

           PERFORM READ-OAL1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-AL-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM UPGRADE-FILE-AL.

           PERFORM WRITE-AL1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE AL1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-AL-NEXT
              ELSE
                 GO TO IO-ERROR.

            ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

            GO TO PROCESS-FILE-AL-NEXT.

      *=================================================================
        PROCESS-FILE-AL-END.

           PERFORM CLOSE-OAL1-FILE.
           MOVE OAL-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-AL1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "ALFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

        PROCESS-FILE-AL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C D
      *
      ******************************************************************
       PROCESS-FILE-CD SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CD = "N" )
              GO TO PROCESS-FILE-CD-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CD-PATH-OVERRIDE
                                              CDB-PATH-OVERRIDE.
           MOVE "CD"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CDFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCD-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CD-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

           MOVE "LP/CDFILE"                TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CD-PATH.

           MOVE "LP/CDBFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CDB-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OCD1-KEY.
           PERFORM OPEN-OCD1-FILE.
           PERFORM START-OCD1-FILE.

           PERFORM OPEN-CDB1-FILE.
           PERFORM OPEN-CD1-FILE.

      *=================================================================
       PROCESS-FILE-CD-NEXT.

           PERFORM READ-OCD1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CD-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      * ADVERTISING SOURCE CODE
           IF ( OCD-AS-TYPE = "AS" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * DORMANT REASON
           IF ( OCD-DR-TYPE = "DR" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * TRIAD SCORING
           IF ( OCD-LR-TYPE = "LR" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * PRODUCTS CODES (REVOLVING)
           IF ( OCD-PR-TYPE = "PR" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * TURN DOWN (REFUSAL CODES/LOAN APPLICATION STATUS)
           IF ( OCD-RF-TYPE = "RF" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * REVOLVING OTHER CHARGE CODES
           IF ( OCD-RO-TYPE = "RO" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * CLEANSE FEECODES (GC) FOR LOWERCASE X5 AND Z1; THERE IS NO X5 IN
      * USE; THERE IS CONFLICT OF LOWER & UPPER Z1 WHICH NO LOWER Z1 IN
      * USE AND CANNOT OVERWRITE UPPER Z1 DATA
           IF (  OCD-FEETYPE = "GC"          ) AND
              (( OCD-FEECD   = HEX-LOWER-X5 )  OR
               ( OCD-FEECD   = HEX-LOWER-Z1 ))
              ADD 1              TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CD-NEXT.

      * CLEANSE BRNO 9990, STL, NEXT RECORD GARBAGE BRANCH
           IF ( OCD-TYPE = "CN" ) AND (OCD-CN-BRANCH NOT NUMERIC)
              ADD 1              TO UP1534-RECORD-COUNTER-SKIP
              MOVE OCD-CN-KEY    TO UP1534-UPDATE-KEY
              MOVE "CNBR"        TO UP1534-UPDATE-STAT
              MOVE "E"           TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              GO TO PROCESS-FILE-CD-NEXT.

           PERFORM UPGRADE-FILE-CD.

           IF ( OCD-TYPE = "CN" OR "GC" )
              PERFORM WRITE-CDB1-FILE
              IF ( IO-BAD )
                 ADD 1                 TO UP1534-RECORD-COUNTER-SKIP
                 MOVE CDB1-KEY         TO UP1534-UPDATE-KEY
                 MOVE FILE-STAT-DISP   TO UP1534-UPDATE-STAT
                 MOVE "E"              TO UP1534-UPDATE-TYPE
                 PERFORM UP1534-CREATE-FILE-UPDATE
      * ONLY REWRITE THE CODES THAT ARE RISC2 AND A "R2" BRANCH
                 IF ( FILE-STAT-DISP = "22,00" )
                    IF (SOURCE-MACHINE = RISC2) AND
                               (BRANCH-MACHINE(CDB-BRANCH) = RISC2)
                       PERFORM REWRITE-CDB1-FILE
                    ELSE
                       GO TO PROCESS-FILE-CD-NEXT
                 ELSE
                 IF ( FILE-STAT-DISP = "9D,25" )
                    GO TO PROCESS-FILE-CD-NEXT
                 ELSE
                    GO TO IO-ERROR.

           IF NOT ( OCD-TYPE = "CN" OR "GC" )
              PERFORM WRITE-CD1-FILE
              IF ( IO-BAD )
                 ADD 1                  TO UP1534-RECORD-COUNTER-SKIP
                 MOVE CD1-KEY           TO UP1534-UPDATE-KEY
                 MOVE FILE-STAT-DISP    TO UP1534-UPDATE-STAT
                 MOVE "E"               TO UP1534-UPDATE-TYPE
                 PERFORM UP1534-CREATE-FILE-UPDATE
                 IF ( FILE-STAT-DISP = "22,00" )
                    GO TO PROCESS-FILE-CD-NEXT
                 ELSE
                 IF ( FILE-STAT-DISP = "9D,25" )
                    GO TO PROCESS-FILE-CD-NEXT
                 ELSE
                    GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CD-NEXT.

      *=================================================================
       PROCESS-FILE-CD-END.

           PERFORM CLOSE-OCD1-FILE.
           MOVE OCD-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-CDB1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CDFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CD-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C L
      *
      ******************************************************************
       PROCESS-FILE-CL SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CL = "N" )
              GO TO PROCESS-FILE-CL-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CL-PATH-OVERRIDE.
           MOVE "CL"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CLFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCL-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CL-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CL-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OCL1-KEY.
           MOVE ZEROES                     TO OCL-GROUP-LOC.
           PERFORM OPEN-OCL1-FILE.
           PERFORM START-OCL1-FILE.

           PERFORM OPEN-CL1-FILE.

      *=================================================================
       PROCESS-FILE-CL-NEXT.

           PERFORM READ-OCL1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CL-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      * RISC2 STILL CONTAINS "OK" CANS, SKIP THESE
           IF SOURCE-MACHINE = RISC2
              IF OCL-GROUP-LOC = "OK  " OR "OKL "
                 GO TO PROCESS-FILE-CL-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-CL.

           PERFORM WRITE-CL1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CL1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
      * CAN LOAN FILE SHOULD NOT HAVE ANY DUPLICATES EXCEPT "OK" FROM
      * FROM R2 TO R1 AND WE ARE SKIPPING THOSE ABOVE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-CL-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CL-NEXT.

      *=================================================================
       PROCESS-FILE-CL-END.

           PERFORM CLOSE-OCL1-FILE.
           MOVE OCL-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-CL1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CLFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - E A
      *
      ******************************************************************
       PROCESS-FILE-EA SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-EA = "N" )
              GO TO PROCESS-FILE-EA-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO EA-PATH-OVERRIDE.
           MOVE "EA"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/EAFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OEA-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-EA-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-EA = "Y")
              MOVE UP1534-FILE-PATH           TO EA-PATH
              PERFORM OPEN-EA1-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OEA1-KEY.
           MOVE 0                          TO OEA-BRANCH
                                              OEA-CLASS
                                              OEA-SEQNO.
           PERFORM OPEN-OEA1-FILE.
           PERFORM START-OEA1-FILE.


      *=================================================================
       PROCESS-FILE-EA-NEXT.

           PERFORM READ-OEA1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-EA-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OEA-BRANCH NOT NUMERIC OR
               OEA-CLASS NOT NUMERIC OR
                OEA-SEQNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-EA-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-EA.

           IF (FILE-OPTION-EA = "Y")
              PERFORM WRITE-EA1-FILE
              IF ( IO-BAD )
      * ONLY REWRITE THE EXTRACTION RECORDS THAT ARE RISC2 AND A "R2" BRANCH
                IF ( FILE-STAT-DISP = "22,00" )
                   IF (SOURCE-MACHINE = RISC2) AND
                              (BRANCH-MACHINE(EA-BRANCH) = RISC2)
                      PERFORM REWRITE-EA1-FILE
                   ELSE
                      ADD 1               TO UP1534-RECORD-COUNTER-SKIP
                      MOVE EA1-KEY        TO UP1534-UPDATE-KEY
                      MOVE FILE-STAT-DISP TO UP1534-UPDATE-STAT
                      MOVE "E"            TO UP1534-UPDATE-TYPE
                      PERFORM UP1534-CREATE-FILE-UPDATE
                      GO TO PROCESS-FILE-EA-NEXT
                ELSE
                   GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-EA-NEXT.

       PROCESS-FILE-EA-END.

           PERFORM CLOSE-OEA1-FILE.
           MOVE OEA-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-EA = "Y")
              PERFORM CLOSE-EA1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "EAFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-EA-EXIT.
           EXIT.


      ******************************************************************
      *
      *    P R O C E S S - F I L E - I I
      *
      ******************************************************************
       PROCESS-FILE-II SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-II = "N" )
              GO TO PROCESS-FILE-II-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO II-PATH-OVERRIDE.
           MOVE "II"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/IIFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OII-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-II-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO II-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0       TO OII-KEY.
           PERFORM OPEN-OII-FILE.
           PERFORM START-OII-FILE.

           PERFORM OPEN-II-FILE.

      *=================================================================
       PROCESS-FILE-II-NEXT.

           PERFORM READ-OII-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-II-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM UPGRADE-FILE-II.

           PERFORM WRITE-II-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE II-KEY                  TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-II-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-II-NEXT.

      *=================================================================
       PROCESS-FILE-II-END.

           PERFORM CLOSE-OII-FILE.
           MOVE OII-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-II-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "IIFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-II-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - I R
      *
      ******************************************************************
       PROCESS-FILE-IR SECTION.
      D    STOP MESS.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-IR = "N" )
              GO TO PROCESS-FILE-IR-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO IR-PATH-OVERRIDE.
           MOVE "IR"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/IRFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OIR-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-IR-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO IR-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0       TO OIR-KEY.
           PERFORM OPEN-OIR-FILE.
           PERFORM START-OIR-FILE.

           PERFORM OPEN-IR-FILE.

      *=================================================================
       PROCESS-FILE-IR-NEXT.

           PERFORM READ-OIR-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-IR-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM UPGRADE-FILE-IR.

           PERFORM WRITE-IR-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE IR-KEY                  TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-IR-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-IR-NEXT.

      *=================================================================
       PROCESS-FILE-IR-END.

           PERFORM CLOSE-OIR-FILE.
           MOVE OIR-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-IR-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "IRFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-IR-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - G L O B A L - C P
      *
      ******************************************************************
       PROCESS-FILE-GLOBAL-CP SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-GLOBAL-CP = "N" )
              GO TO PROCESS-FILE-GLO-CP-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: CP-PATH-OVERRIDE NEEDS TO BE "G" NOT "Y" HERE!!!
      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "G"                        TO CP-PATH-OVERRIDE.
           MOVE "CP"                       TO UP1534-CURRENT-FILE.
           MOVE "SP/CPFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCP-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-GLO-CP-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CP-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OCP1-KEY.
           PERFORM OPEN-OCP1-FILE.
           PERFORM START-OCP1-FILE.

           PERFORM OPEN-CP1-FILE.

      *=================================================================
       PROCESS-FILE-GLO-CP-NEXT.

           PERFORM READ-OCP1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-GLO-CP-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM CLEAR-CP-FILE.

      * GLOBAL CP-BRNO IS 0
      * LOCAL  CP-BRNO IS BRANCH
           MOVE 0                          TO CP-BRNO.

           MOVE OCP-ID                     TO CP-ID.
           MOVE OCP-DESC                   TO CP-DESC.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 80
              MOVE OCP-COL-ID(SUB) TO CP-COL-ID(SUB)
           END-PERFORM.
           MOVE OCP-ALPHA-FLAG             TO CP-ALPHA-FLAG.
      * CLEANSE 20202 9(5) COMP-3
           IF OCP-TOTAL-ACCOUNTS NOT NUMERIC OR
              (OCP-TOTAL-ACCOUNTS = 20202 OR 02020)
              MOVE 0                       TO CP-TOTAL-ACCOUNTS
           ELSE
              MOVE OCP-TOTAL-ACCOUNTS      TO CP-TOTAL-ACCOUNTS.
           IF OCP-COLLECTOR-COUNT NOT NUMERIC
              MOVE 0                       TO CP-COLLECTOR-COUNT
           ELSE
              MOVE OCP-COLLECTOR-COUNT     TO CP-COLLECTOR-COUNT.
           IF OCP-LAST-SUBSCRIPT NOT NUMERIC
              MOVE 0                       TO CP-LAST-SUBSCRIPT
           ELSE
           MOVE OCP-LAST-SUBSCRIPT         TO CP-LAST-SUBSCRIPT.

           PERFORM WRITE-CP1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CP1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-GLO-CP-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-GLO-CP-NEXT.

      *=================================================================
       PROCESS-FILE-GLO-CP-END.

           PERFORM CLOSE-OCP1-FILE.
           MOVE OCP-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-CP1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CPFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-GLO-CP-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - F D
      *
      ******************************************************************
      *PROCESS-FILE-FD SECTION.

      *    MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *    IF ( FILE-OPTION-FD = "N" )
      *       GO TO PROCESS-FILE-FD-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *    MOVE "Y"                        TO FD-PATH-OVERRIDE.
      *    MOVE "FD"                       TO UP1534-CURRENT-FILE.
      *    MOVE "LP/FDFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
      *    MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *    PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *    PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATH: FD }
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO OFD-PATH.

      *    IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *       GO TO PROCESS-FILE-FD-EXIT.

      *- - - - - - - - - - - - - - - -{ SETUP SOURCE PATH: FT (MERGE) }
      *    MOVE "LP/FTFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO OFT-PATH.

      *KC> IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *KC>    GO TO PROCESS-FILE-FD-EXIT.

      *    MOVE STAT                       TO OFT-FILE-STAT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *    MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

      *    MOVE "LP/FDFILE"                TO UP1534-FILE-INPUT.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO FD-PATH.

      *    MOVE "LP/FDBFILE"               TO UP1534-FILE-INPUT.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO FDB-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE ZEROES TO OFD-FMNO.
      *    PERFORM OPEN-OFD1-FILE.
      *    PERFORM START-OFD1-FILE.

      *    IF ( OFT-FILE-STAT-GOOD )
      *       PERFORM OPEN-OFT1-FILE.

      *    PERFORM OPEN-FD1-FILE.
      *    PERFORM OPEN-FDB1-FILE.

      *=================================================================
      *PROCESS-FILE-FD-NEXT.

      *    PERFORM READ-OFD1-FILE-NEXT.
      *    IF ( IO-BAD )
      *       GO TO PROCESS-FILE-FD-END.

      *    ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *    MOVE "Y" TO RECORDS-FOUND.
      *    PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - -{ GET MERGE RECORD }
      *    IF ( OFD-DCODE = 99 )
      *       MOVE STAT---BAD              TO OFT-RECORD-STAT
      *    ELSE
      *    IF ( OFT-FILE-STAT-BAD )
      *       MOVE STAT---BAD              TO OFT-RECORD-STAT
      *    ELSE
      *       MOVE OFD-FMNO                TO OFT-FMNO
      *       PERFORM READ-OFT1-FILE
      *       IF ( IO-BAD )
      *          MOVE STAT---BAD           TO OFT-RECORD-STAT
      *       ELSE
      *          MOVE STAT---GOOD          TO OFT-RECORD-STAT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
      *    IF ( OFD-DCODE = 99 )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       GO TO PROCESS-FILE-FD-NEXT
      *    ELSE
      *       PERFORM UPGRADE-FILE-FD
      *       PERFORM WRITE-FD1-FILE.

      *    IF ( IO-BAD )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       IF ( OFD-DCODE = 99 )
      *          MOVE FDB1-KEY             TO UP1534-UPDATE-KEY
      *       ELSE
      *          MOVE FD1-KEY              TO UP1534-UPDATE-KEY
      *       END-IF
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
      *       IF ( FILE-STAT-DISP = "22,00" )
      *          GO TO PROCESS-FILE-FD-NEXT
      *       ELSE
      *          GO TO IO-ERROR.

      *    ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *    GO TO PROCESS-FILE-FD-NEXT.

      *=================================================================
      *PROCESS-FILE-FD-END.

      *    PERFORM CLOSE-OFD1-FILE.
      *    MOVE OFD-PATH TO UP1534-MV15-NEW-PATH.
      *    PERFORM UP1534-MV15-NEW-TO-OLD.

      *    IF ( OFT-FILE-STAT-GOOD )
      *       PERFORM CLOSE-OFT1-FILE
      *       MOVE OFT-PATH TO UP1534-MV15-NEW-PATH
      *       PERFORM UP1534-MV15-NEW-TO-OLD.

      *    PERFORM CLOSE-FD1-FILE.
      *    PERFORM CLOSE-FDB1-FILE.

      *    PERFORM UP1534-CREATE-FILE-TOTALS.
      *    MOVE "FDFILE"                   TO HOLD-SORT-FILENAME.
      *    MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *    MOVE SPACES                     TO HOLD-SORT-STATE.
      *    MOVE ZEROES                     TO HOLD-SORT-BRNO.
      *    PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
      *PROCESS-FILE-FD-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - G I
      *
      ******************************************************************
       PROCESS-FILE-GI SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-GI = "N" )
              GO TO PROCESS-FILE-GI-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO GI-PATH-OVERRIDE.
           MOVE "GI"                       TO UP1534-CURRENT-FILE.
           MOVE "GL/GIFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OGI-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-GI-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO GI-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OGI1-KEY.
           MOVE 0                          TO OGI-BRANCH
                                              OGI-CLASS.

           PERFORM OPEN-OGI1-FILE.
           PERFORM START-OGI1-FILE.

           PERFORM OPEN-GI1-FILE.

      *=================================================================
       PROCESS-FILE-GI-NEXT.

           PERFORM READ-OGI1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-GI-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OGI-BRANCH NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-GI-NEXT.
           IF OGI-CLASS NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-GI-NEXT.

           PERFORM UPGRADE-FILE-GI.

           PERFORM WRITE-GI1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE GI1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
      * ONLY REWRITE THE EXTRACTION RECORDS THAT ARE RISC2 AND A "R2" BRANCH
              IF ( FILE-STAT-DISP = "22,00" )
                 IF (SOURCE-MACHINE = RISC2) AND
                            (BRANCH-MACHINE(GI-BRANCH) = RISC2)
                    PERFORM REWRITE-GI1-FILE
                 ELSE
                    PERFORM UP1534-CREATE-FILE-UPDATE
                    GO TO PROCESS-FILE-GI-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-GI-NEXT.

      *=================================================================
       PROCESS-FILE-GI-END.

           PERFORM CLOSE-OGI1-FILE.
           MOVE OGI-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-GI1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "GIFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-GI-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - G L
      *
      ******************************************************************
       PROCESS-FILE-GL SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-GL = "N" )
              GO TO PROCESS-FILE-GL-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO GL-PATH-OVERRIDE.
           MOVE "GL"                       TO UP1534-CURRENT-FILE.
           MOVE "GL/GLFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OGL-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-GL-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-GL = "Y")
              MOVE UP1534-FILE-PATH        TO GL-PATH
              PERFORM OPEN-GL1-FILE
           ELSE
              MOVE UP1534-FILE-PATH TO AGL-PATH-BEG
                                       AGL-DONE-PATH-BEG
              CALL "C$TOLOWER" USING AGL-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AGL-DONE-FILENAME, VALUE 11
              PERFORM OPEN-AGL-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OGL1-KEY.
           MOVE ZEROES                     TO OGL-BRANCH
                                              OGL-ACCOUNT.

           PERFORM OPEN-OGL1-FILE.
           PERFORM START-OGL1-FILE.

      *=================================================================
       PROCESS-FILE-GL-NEXT.

           PERFORM READ-OGL1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-GL-END.

           IF OGL-NUMKEY NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-GL-NEXT.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-GL.

           IF (FILE-OPTION-GL = "Y")
              PERFORM WRITE-GL1-FILE
           ELSE
              ADD 1 TO AGL-KEY
              ACCEPT AGL-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO AGL-CR
              MOVE X"0A"              TO AGL-LF
              PERFORM WRITE-AGL-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE GL1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-GL-NEXT
              ELSE
                 PERFORM UP1534-CREATE-FILE-UPDATE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-GL-NEXT.

      *=================================================================
       PROCESS-FILE-GL-END.

           PERFORM CLOSE-OGL1-FILE.
           MOVE OGL-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-GL = "Y")
              PERFORM CLOSE-GL1-FILE
           ELSE
              PERFORM CLOSE-AGL-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "GLFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-GL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L C
      *
      ******************************************************************
       PROCESS-FILE-LC SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LC = "N" )
              GO TO PROCESS-FILE-LC-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LC-PATH-OVERRIDE.
           MOVE "LC"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LCFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLC-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LC-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LC-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE 0                     TO OLC-CODE.
           PERFORM OPEN-OLC1-FILE.
           PERFORM START-OLC1-FILE.

           PERFORM OPEN-LC1-FILE.

      *=================================================================
       PROCESS-FILE-LC-NEXT.

           PERFORM READ-OLC1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LC-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OLC-CODE NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LC-NEXT.

           PERFORM UPGRADE-FILE-LC.

           PERFORM WRITE-LC1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LC1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LC-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LC-NEXT.

      *=================================================================
       PROCESS-FILE-LC-END.

           PERFORM CLOSE-OLC1-FILE.
           MOVE OLC-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-LC1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LCFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LC-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - P E
      *
      ******************************************************************
       PROCESS-FILE-PE SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-PE = "N" )
              GO TO PROCESS-FILE-PE-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO PE-PATH-OVERRIDE.

           MOVE "PE"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/PEFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OPE-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-PE-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO PE-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OPE1-KEY.
           MOVE ZEROES                     TO OPE-SEQ.
           PERFORM OPEN-OPE1-FILE.
           PERFORM START-OPE1-FILE.

           PERFORM OPEN-PE1-FILE.

      *=================================================================
       PROCESS-FILE-PE-NEXT.

           PERFORM READ-OPE1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-PE-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-PE.

           PERFORM WRITE-PE1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE PE1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-PE-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-PE-NEXT.

      *=================================================================
       PROCESS-FILE-PE-END.

           PERFORM CLOSE-OPE1-FILE.
           MOVE OPE-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-PE1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "PEFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-PE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - P W
      *
      ******************************************************************
       PROCESS-FILE-PW SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-PW = "N" )
              GO TO PROCESS-FILE-PW-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO PW-PATH-OVERRIDE.

           MOVE "PW"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/PWFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OPW-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-PW-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO PW-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPWN & START FILES }
           MOVE SPACES                     TO OPW1-KEY.
           MOVE ZEROES                     TO OPW-SEQ.
           PERFORM OPEN-OPW1-FILE.
           PERFORM START-OPW1-FILE.

           PERFORM OPEN-PW1-FILE.

      *=================================================================
       PROCESS-FILE-PW-NEXT.

           PERFORM READ-OPW1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-PW-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-PW.

           PERFORM WRITE-PW1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE PW1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-PW-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-PW-NEXT.

      *=================================================================
       PROCESS-FILE-PW-END.

           PERFORM CLOSE-OPW1-FILE.
           MOVE OPW-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-PW1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "PWFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-PW-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - R B
      *
      ******************************************************************
      *PROCESS-FILE-RB SECTION.

      *    MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *    IF ( FILE-OPTION-RB = "N" )
      *       GO TO PROCESS-FILE-RB-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *    MOVE "Y"                        TO RB-PATH-OVERRIDE.
      *    MOVE "RB"                       TO UP1534-CURRENT-FILE.
      *    MOVE "LP/RBFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
      *    MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *    PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *    PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO ORB-PATH.

      *    IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *       GO TO PROCESS-FILE-RB-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *    MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO RB-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE 0                     TO ORB-TBL-NO
      *                                  ORB-TERM.
      *    PERFORM OPEN-ORB1-FILE.
      *    PERFORM START-ORB1-FILE.

      *    PERFORM OPEN-RB1-FILE.

      *=================================================================
      *PROCESS-FILE-RB-NEXT.

      *    PERFORM READ-ORB1-FILE-NEXT.
      *    IF ( IO-BAD )
      *       GO TO PROCESS-FILE-RB-END.

      *    ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *    MOVE "Y" TO RECORDS-FOUND.
      *    PERFORM UP1534-VPI-DISPLAY.

      *    PERFORM UPGRADE-FILE-RB.

      *    PERFORM WRITE-RB1-FILE.
      *    IF ( IO-BAD )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       MOVE RB1-KEY                 TO UP1534-UPDATE-KEY
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
      *       IF ( FILE-STAT-DISP = "22,00" )
      *          GO TO PROCESS-FILE-RB-NEXT
      *       ELSE
      *          GO TO IO-ERROR.

      *    ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *    GO TO PROCESS-FILE-RB-NEXT.

      *=================================================================
      *PROCESS-FILE-RB-END.

      *    PERFORM CLOSE-ORB1-FILE.
      *    MOVE ORB-PATH TO UP1534-MV15-NEW-PATH.
      *    PERFORM UP1534-MV15-NEW-TO-OLD.

      *    PERFORM CLOSE-RB1-FILE.

      *    PERFORM UP1534-CREATE-FILE-TOTALS.
      *    MOVE "RBFILE"                   TO HOLD-SORT-FILENAME.
      *    MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *    MOVE SPACES                     TO HOLD-SORT-STATE.
      *    MOVE ZEROES                     TO HOLD-SORT-BRNO.
      *    PERFORM UPDATE-SORT-MODULE.

      *PROCESS-FILE-RB-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - R C
      *
      ******************************************************************
       PROCESS-FILE-RC SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-RC = "N" )
              GO TO PROCESS-FILE-RC-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO RC-PATH-OVERRIDE.
           MOVE "RC"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/RCFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO ORC-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-RC-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-RC = "Y")
              MOVE UP1534-FILE-PATH        TO RC-PATH
              PERFORM OPEN-RC1-FILE
           ELSE
              MOVE UP1534-FILE-PATH TO ARC-PATH-BEG
                                       ARC-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ARC-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ARC-DONE-FILENAME, VALUE 11
              PERFORM OPEN-ARC-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO ORC1-KEY.
           MOVE 0                          TO ORC-BRNO
                                              ORC-TRANS-DATE.

           PERFORM OPEN-ORC1-FILE.
           PERFORM START-ORC1-FILE.

      *=================================================================
       PROCESS-FILE-RC-NEXT.

           PERFORM READ-ORC1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-RC-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      * SKIP BRANCH 9990 ON RISC2
           IF SOURCE-MACHINE = RISC2
              IF ORC-BRNO = 9990
                 ADD 1     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO PROCESS-FILE-RC-NEXT.

           IF ORC-BRNO NOT NUMERIC
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-RC-NEXT.
           IF ORC-TRANS-DATE NOT NUMERIC
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-RC-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-RC.

           IF (FILE-OPTION-RC = "Y")
              PERFORM WRITE-RC1-FILE
           ELSE
              ADD 1 TO ARC-KEY
              ACCEPT ARC-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ARC-CR
              MOVE X"0A"              TO ARC-LF
              PERFORM WRITE-ARC-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE RC1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-RC-NEXT
              ELSE
                 PERFORM UP1534-CREATE-FILE-UPDATE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-RC-NEXT.

      *=================================================================
       PROCESS-FILE-RC-END.

           PERFORM CLOSE-ORC1-FILE.
           MOVE ORC-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-RC = "Y")
              PERFORM CLOSE-RC1-FILE
           ELSE
              PERFORM CLOSE-ARC-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "RCFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
       PROCESS-FILE-RC-EXIT.
           EXIT.


      ******************************************************************
      *
      *    P R O C E S S - F I L E - S M
      *
      ******************************************************************
       PROCESS-FILE-SM SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-SM = "N" )
              GO TO PROCESS-FILE-SM-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO SM-PATH-OVERRIDE.
           MOVE "SM"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/SMFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OSM-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-SM-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO SM-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OSM1-KEY.
           MOVE 0                          TO OSM-SPRCLASS
                                              OSM-SUBCLASS
                                              OSM-LAWCODE
                                              OSM-DATE
                                              OSM-SEQ.

           PERFORM OPEN-OSM1-FILE.
           PERFORM START-OSM1-FILE.

           PERFORM OPEN-SM1-FILE.

      *=================================================================
       PROCESS-FILE-SM-NEXT.

           PERFORM READ-OSM1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-SM-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OSM-SPRCLASS NOT NUMERIC OR
               OSM-SUBCLASS NOT NUMERIC OR
                OSM-LAWCODE NOT NUMERIC OR
                 OSM-DATE NOT NUMERIC OR
                  OSM-SEQ NOT NUMERIC
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-SM-NEXT.
              
      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-SM.

           PERFORM WRITE-SM1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE SM1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-SM-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-SM-NEXT.

      *=================================================================
       PROCESS-FILE-SM-END.

           PERFORM CLOSE-OSM1-FILE.
           MOVE OSM-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-SM1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "SMFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
       PROCESS-FILE-SM-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - S P
      *
      ******************************************************************
       PROCESS-FILE-SP SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-SP = "N" )
              GO TO PROCESS-FILE-SP-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO SP-PATH-OVERRIDE.
           MOVE "SP"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/SPFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OSP-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-SP-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

           MOVE "LP/SPAFILE"              TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO SPA-PATH.

           MOVE "LP/SPBFILE"              TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO SPB-PATH.

           MOVE "LP/SPCFILE"              TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO SPC-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OSP1-KEY.
           MOVE ZEROES                     TO OSP-SPRCLASS
                                              OSP-SUBCLASS
                                              OSP-LAWCODE.

           PERFORM OPEN-OSP1-FILE.
           PERFORM START-OSP1-FILE.

           PERFORM OPEN-SP1-FILE.

      *=================================================================
       PROCESS-FILE-SP-NEXT.

           PERFORM READ-OSP1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-SP-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OSP-SPRCLASS NOT NUMERIC OR
               OSP-SUBCLASS NOT NUMERIC OR
                OSP-LAWCODE NOT NUMERIC 
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-SP-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-SP.

           PERFORM WRITE-SP1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE SP1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
      * SPR FILE SHOULD NOT HAVE ANY DUPLICATES 
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-SP-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-SP-NEXT.

      *=================================================================
       PROCESS-FILE-SP-END.

           PERFORM CLOSE-OSP1-FILE.
           MOVE OSP-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-SP1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "SPFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
       PROCESS-FILE-SP-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - S S
      *
      ******************************************************************
       PROCESS-FILE-SS SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-SS = "N" )
              GO TO PROCESS-FILE-SS-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO SS-PATH-OVERRIDE.
           MOVE "SS"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/SSFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OSS-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-SS-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO SS-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * GET DATE 6 YEARS AGO, SKIP SS RECORDS OLDER THAN 6 YEARS
           MOVE TODAYS-DATE TO NDTE-DATE.
           MOVE -6          TO NDTE-HOLD.
           PERFORM INCREMENT-YEARS.
           MOVE NDTE-DATE   TO COMPARE-DATE.

           MOVE SPACES                     TO OSS1-KEY.
           MOVE 0                          TO OSS-DATE
                                              OSS-BRNO
                                              OSS-CLASS.

           PERFORM OPEN-OSS1-FILE.
           PERFORM START-OSS1-FILE.

           PERFORM OPEN-SS1-FILE.

      *=================================================================
       PROCESS-FILE-SS-NEXT.

           PERFORM READ-OSS1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-SS-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           MOVE OSS-DATE  TO DATE-YYYYMM.
      * COMPARE DATE HOLDS TODAYS DATE - 6 YEARS
           IF DATE-YYYYMM-YYYY < COMPARE-DATE-YYYY
              ADD 1        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-SS-NEXT.

           IF OSS-BRNO NOT NUMERIC OR OSS-CLASS NOT NUMERIC
              ADD 1        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-SS-NEXT.
              
      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-SS.

           PERFORM WRITE-SS1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE SS1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-SS-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-SS-NEXT.

      *=================================================================
       PROCESS-FILE-SS-END.

           PERFORM CLOSE-OSS1-FILE.
           MOVE OSS-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-SS1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "SSFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-SS-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - S T
      *
      ******************************************************************
       PROCESS-FILE-ST SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-ST = "N" )
              GO TO PROCESS-FILE-ST-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO ST-PATH-OVERRIDE.
           MOVE "ST"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/STFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OST-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-ST-EXIT.

      *- - - - - - - - - - - - - - - - - - - -{ SET MERGE FILE WORKERS }
           MOVE "LP/SUFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OSU-PATH.

      *KC  IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *KC     GO TO PROCESS-FILE-ST-EXIT.

           MOVE STAT                       TO OSU-FILE-STAT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE "LP/STFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO ST-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OST1-KEY.
           PERFORM OPEN-OST1-FILE.
           PERFORM START-OST1-FILE.

           IF ( OSU-FILE-STAT-GOOD )
              PERFORM OPEN-OSU1-FILE.

           PERFORM OPEN-ST1-FILE.

      *=================================================================
       PROCESS-FILE-ST-NEXT.

           PERFORM READ-OST1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-ST-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - -{ GET MERGE RECORD }
           IF ( OSU-FILE-STAT-GOOD )
              MOVE OST-CODE                TO OSU-CODE
              PERFORM READ-OSU1-FILE
              IF ( IO-BAD )
                 MOVE STAT---BAD           TO OSU-RECORD-STAT
              ELSE
                 MOVE STAT---GOOD          TO OSU-RECORD-STAT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-ST.

           PERFORM WRITE-ST1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE ST1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-ST-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-ST-NEXT.

      *=================================================================
       PROCESS-FILE-ST-END.

           PERFORM CLOSE-OST1-FILE.
           MOVE OST-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF ( OSU-FILE-STAT-GOOD )
              PERFORM CLOSE-OSU1-FILE
              MOVE OSU-PATH TO UP1534-MV15-NEW-PATH
              PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-ST1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "STFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
       PROCESS-FILE-ST-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - T R W I N F O
      *
      ******************************************************************
       PROCESS-FILE-TRWINFO SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-TRWINFO = "N" )
              GO TO PROCESS-FILE-TRWINFO-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO TRW-INFO-PATH-OVERRIDE.
           MOVE "TRWINFO"                  TO UP1534-CURRENT-FILE.
           MOVE "GB/TRWINFO"               TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OTRW-INFO-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-TRWINFO-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO TRW-INFO-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0                     TO OTRW-INFO-ID.
           PERFORM OPEN-OTRW-INFO-FILE.
           PERFORM START-OTRW-INFO-FILE.

           PERFORM OPEN-TRW-INFO-FILE.

      *=================================================================
       PROCESS-FILE-TRWINFO-NEXT.

           PERFORM READ-OTRW-INFO-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-TRWINFO-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-TRWINFO.

           PERFORM WRITE-TRW-INFO-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE TRW-INFO-KEY            TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-TRWINFO-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-TRWINFO-NEXT.

      *=================================================================
       PROCESS-FILE-TRWINFO-END.

           PERFORM CLOSE-OTRW-INFO-FILE.
           MOVE OTRW-INFO-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-TRW-INFO-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "TRWINFO"                  TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-TRWINFO-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - T Z
      *
      ******************************************************************
       PROCESS-FILE-TZ SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-TZ = "N" )
              GO TO PROCESS-FILE-TZ-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO TZ-PATH-OVERRIDE.
           MOVE "TZ"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/TZFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OTZ-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-TZ-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO TZ-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OTZ1-KEY.
           MOVE ZEROES                     TO OTZ-CODE
                                              OTZ-PREFIX.

           PERFORM OPEN-OTZ1-FILE.
           PERFORM START-OTZ1-FILE.

           PERFORM OPEN-TZ1-FILE.

      *=================================================================
       PROCESS-FILE-TZ-NEXT.

           PERFORM READ-OTZ1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-TZ-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OTZ-CODE NOT NUMERIC OR OTZ-PREFIX NOT NUMERIC
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-TZ-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-TZ.

           PERFORM WRITE-TZ1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE TZ1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-TZ-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-TZ-NEXT.

      *=================================================================
       PROCESS-FILE-TZ-END.

           PERFORM CLOSE-OTZ1-FILE.
           MOVE OTZ-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-TZ1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "TZFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

      *-----------------------------------------------------------------
       PROCESS-FILE-TZ-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - W R
      *
      ******************************************************************
       PROCESS-FILE-WR SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-WR = "N" )
              GO TO PROCESS-FILE-WR-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO WR-PATH-OVERRIDE.
           MOVE "WR"                       TO UP1534-CURRENT-FILE.
           MOVE "SP/WRFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OWR-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-WR-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-WR = "Y")
              MOVE UP1534-FILE-PATH        TO WR-PATH
              PERFORM OPEN-WR1-FILE
           ELSE
              MOVE UP1534-FILE-PATH TO AWR-PATH-BEG
                                       AWR-DONE-PATH-BEG
              CALL "C$TOLOWER" USING AWR-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AWR-DONE-FILENAME, VALUE 11
              PERFORM OPEN-AWR-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OWR1-KEY.
           MOVE ZEROES                     TO OWR-YYYYMM
                                              OWR-BRNO.

           PERFORM OPEN-OWR1-FILE.
           PERFORM START-OWR1-FILE.

      *=================================================================
       PROCESS-FILE-WR-NEXT.

           PERFORM READ-OWR1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-WR-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OWR-BRNO NOT NUMERIC OR OWR-YYYYMM NOT NUMERIC
              ADD 1              TO UP1534-RECORD-COUNTER-SKIP
              MOVE OWR1-KEY      TO UP1534-UPDATE-KEY
              MOVE "WRBR"        TO UP1534-UPDATE-STAT
              MOVE "E"           TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              GO TO PROCESS-FILE-WR-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
           PERFORM UPGRADE-FILE-WR.

           IF (FILE-OPTION-WR = "Y")
              PERFORM WRITE-WR1-FILE
           ELSE
              ADD 1 TO AWR-KEY
              ACCEPT AWR-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO AWR-CR
              MOVE X"0A"              TO AWR-LF
              PERFORM WRITE-AWR-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       MOVE WR1-KEY                 TO UP1534-UPDATE-KEY
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-WR-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-WR-NEXT.

      *=================================================================
       PROCESS-FILE-WR-END.

           PERFORM CLOSE-OWR1-FILE.
           MOVE OWR-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-WR = "Y")
              PERFORM CLOSE-WR1-FILE
           ELSE
              PERFORM CLOSE-AWR-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "WRFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE SPACES                     TO HOLD-SORT-STATE.
           MOVE ZEROES                     TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-WR-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - A U
      *
      ******************************************************************
      *PROCESS-FILE-AU SECTION.

      *    MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *    IF ( FILE-OPTION-AU = "N" )
      *       GO TO PROCESS-FILE-AU-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *    MOVE "Y"                        TO AU-PATH-OVERRIDE.
      *    MOVE "AU"                       TO UP1534-CURRENT-FILE.
      *    MOVE "GB/AUFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.
      *    MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *    PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *    PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO OAU-PATH.
      *    IF ( STAT-BAD )   
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *       GO TO PROCESS-FILE-AU-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *    MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH        TO AU-PATH.


      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
      *    MOVE SPACES                     TO OAU1-KEY.
      *    MOVE ZEROES                     TO OAU-DATE
      *                                       OAU-SEQ.

      *    PERFORM OPEN-OAU1-FILE.
      *    PERFORM START-OAU1-FILE.

      *    PERFORM OPEN-AU1-FILE.

      *=================================================================
      *PROCESS-FILE-AU-NEXT.

      *    PERFORM READ-OAU1-FILE-NEXT.
      *    IF ( IO-BAD )
      *       GO TO PROCESS-FILE-AU-END.

      *    ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *    MOVE "Y" TO RECORDS-FOUND.
      *    PERFORM UP1534-VPI-DISPLAY.

      *    PERFORM UPGRADE-FILE-AU.

      *    PERFORM WRITE-AU1-FILE.
      *    IF ( IO-BAD )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       MOVE AU1-KEY                 TO UP1534-UPDATE-KEY
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
      *       IF ( FILE-STAT-DISP = "22,00" )
      *          GO TO PROCESS-FILE-AU-NEXT
      *       ELSE
      *          GO TO IO-ERROR.

      *    ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *    GO TO PROCESS-FILE-AU-NEXT.

      *=================================================================
      *PROCESS-FILE-AU-END.

      *    PERFORM CLOSE-OAU1-FILE.
      *    MOVE OAU-PATH TO UP1534-MV15-NEW-PATH.
      *    PERFORM UP1534-MV15-NEW-TO-OLD.

      *    PERFORM CLOSE-AU1-FILE.

      *    PERFORM UP1534-CREATE-FILE-TOTALS.
      *    MOVE "AUFILE"                   TO HOLD-SORT-FILENAME.
      *    MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *    MOVE SPACES                     TO HOLD-SORT-STATE.
      *    MOVE ZEROES                     TO HOLD-SORT-BRNO.
      *    PERFORM UPDATE-SORT-MODULE.

      *PROCESS-FILE-AU-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - B W
      *
      ******************************************************************
       UPGRADE-FILE-BW SECTION.

           IF (FILE-OPTION-BW) = "A"
              PERFORM CLEAR-ABW-FILE
           ELSE
              PERFORM CLEAR-BW-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    USING BR-NO FOR BW-BRANCH.  IN A15, BW-BRANCH WAS NOT
      *    ENFORCED TO BE ENTERED AND COULD ENTERED ANYTHING THE USER
      *    WANTS.  BECAUSE THE BRANCH NEEDS TO BE BEFORE THE
      *    PRIMARY KEY (BW1-KEY) WE ARE FORCING BW-BRANCH TO BE
      *    FOR THE CONVERTING BRANCH (BR-NO).              KEC 2016.0928
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE BR-NO      TO BW-ORGBR  BW-OWNBR
                             ABW-ORGBR ABW-OWNBR.

           MOVE OBW-SSNO   TO BW-SSNO   ABW-SSNO.
           MOVE OBW-LNAME  TO BW-LNAME  ABW-LNAME.
           MOVE OBW-FNAME  TO BW-FNAME  ABW-FNAME.

           MOVE OBW-ADR1   TO BW-ADR1   ABW-ADR1.
           MOVE OBW-ADR2   TO BW-ADR2   ABW-ADR2.
           MOVE OBW-CITY   TO BW-CITY   ABW-CITY.
           MOVE OBW-STATE  TO BW-STATE  ABW-STATE.
           MOVE OBW-ZIP    TO BW-ZIP    ABW-ZIP.

      * CLEANSE BR 825 409334147
           IF (OBW-REFDATE NOT NUMERIC) OR
                (OBW-REFDATE = 020202) OR 
                 (OBW-REFDATE = 0)
              MOVE 0  TO BW-REFDATE ABW-REFDATE
           ELSE
              MOVE OBW-REFDATE      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD    TO BW-REFDATE ABW-REFDATE.

      * 2/7/2019 BW-AGE NEEDS TO CONVERT CONSISTENTLY WITH HOW WE CONVERT
      *          IT TO 8 DIGIT DATE IN THE A15 BWEXTR
      * EXAMPLE: BW-AGE 01/04/00 - CONVERT TO 01/04/2000
      *                 01/04/05 - CONVERT TO 01/04/2005
      *                 01/04/48 - CONVERT TO 01/04/1948

           IF (OBW-AGE = 0) OR (OBW-AGE NOT NUMERIC)
              MOVE 0 TO DATE-YYYYMMDD
           ELSE
              MOVE OBW-AGE        TO DATE-MMDDYY
              MOVE DATE-MMDDYY-MM TO DATE-YYYYMMDD-MM
              MOVE DATE-MMDDYY-DD TO DATE-YYYYMMDD-DD
              MOVE DATE-MMDDYY-YY TO DATE-YYYYMMDD-YY
              MOVE 19             TO DATE-YYYYMMDD-CC
              IF DATE-MMDDYY-YY < EXT-JULIAN-CC
                 MOVE EXT-CONAME-SYSDATE TO ALP-DATE
                 IF DATE-MMDDYY-YY NOT > ALP-YR
                    MOVE 20 TO DATE-YYYYMMDD-CC.

      * AGES! CANT FIX. BR 110 254354386 AGE 23
      *                 BR 143 999000818 AGE 88
           IF DATE-YYYYMMDD-MM > 12 OR
               DATE-YYYYMMDD-DD > 31 OR
               (DATE-YYYYMMDD-YYYY NOT = 0 AND DATE-YYYYMMDD-MM = 0) OR
                (DATE-YYYYMMDD-YYYY NOT = 0 AND DATE-YYYYMMDD-DD = 0)
              MOVE 0 TO DATE-YYYYMMDD.

           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO BW-BDATE ABW-BDATE.
      * BR 1502 BW-AGE 08/30/24 - YEAR 1924! WE HIT 2024 AND IT SET IT
      * TO 08/30/2024 IN S35. FORCE ANYONE 16 YEARS OLD OR YOUNGER TO BE
      * CENTURY 1900'S! A15 DIDNT HAVE CENTURY, TOUGH CONVERSION
           IF DATE-YYYYMMDD-YYYY > 2008
              MOVE 19 TO DATE-YYYYMMDD-CC
              MOVE DATE-YYYYMMDD TO BW-BDATE ABW-BDATE.

      * CLEANSE BR 800 HAS ? AND > IN THEM
           IF OBW-PHONE NOT NUMERIC
              MOVE 0         TO BW-PHONE ABW-PHONE
           ELSE
              MOVE OBW-PHONE TO BW-PHONE ABW-PHONE.
           
           IF OBW-CELL-PHONE NOT NUMERIC OR
               (OBW-CELL-PHONE = 2020202020 OR 0202020202)
              MOVE 0              TO BW-CELL-PHONE
                                    ABW-CELL-PHONE
           ELSE
              MOVE OBW-CELL-PHONE TO BW-CELL-PHONE
                                    ABW-CELL-PHONE.
           IF (OBW-DEPEND NOT NUMERIC) OR (OBW-DEPEND = 20)
              MOVE 0          TO BW-DEPEND     ABW-DEPEND
           ELSE
              MOVE OBW-DEPEND TO BW-DEPEND     ABW-DEPEND.
           MOVE OBW-RENTCD    TO BW-RENTCD     ABW-RENTCD.
           MOVE OBW-TIMEADDR  TO BW-TIMEADDR   ABW-TIMEADDR.
           MOVE OBW-CREDITCD  TO BW-CREDITCD   ABW-CREDITCD.
           MOVE OBW-STRTGCD   TO BW-STRTGCD    ABW-STRTGCD.
           MOVE OBW-DWELLCD   TO BW-DWELLCD    ABW-DWELLCD.
           MOVE OBW-COUNTY    TO BW-COUNTY     ABW-COUNTY.
           MOVE OBW-ORIGIN    TO BW-ORIGIN     ABW-ORIGIN.
           MOVE OBW-CENSUSCD  TO BW-CENSUSCD   ABW-CENSUSCD.
           IF OBW-ORGSLSMN NOT NUMERIC
              MOVE 0             TO BW-ORGSLSMN   ABW-ORGSLSMN
           ELSE
              MOVE OBW-ORGSLSMN  TO BW-ORGSLSMN   ABW-ORGSLSMN.
           MOVE OBW-REPCODE   TO BW-REPCODE    ABW-REPCODE.

      * BR 475 283561499 SPSSNO 0000000.
           IF OBW-SPSSNO NOT NUMERIC
              MOVE 0 TO BW-SPSSNO
           ELSE
              MOVE OBW-SPSSNO TO BW-SPSSNO ABW-SPSSNO.
           MOVE  OBW-SPLNAME TO BW-SPLNAME ABW-SPLNAME.
           MOVE  OBW-SPFNAME TO BW-SPFNAME ABW-SPFNAME.
      * 2/7/2019 BW-SPAGE NEEDS TO CONVERT CONSISTENTLY WITH HOW WE CONVERT
      *          IT TO 8 DIGIT DATE IN THE A15 BWEXTR
      * EXAMPLE: BW-AGE 01/04/00 - CONVERT TO 01/04/2000
      *                 01/04/05 - CONVERT TO 01/04/2005
      *                 01/04/48 - CONVERT TO 01/04/1948

           IF (OBW-SPAGE = 0) OR (OBW-SPAGE NOT NUMERIC) OR
                  (OBW-SPAGE = 20202)
              MOVE 0 TO DATE-YYYYMMDD
           ELSE
              MOVE OBW-SPAGE      TO DATE-MMDDYY
              MOVE DATE-MMDDYY-MM TO DATE-YYYYMMDD-MM
              MOVE DATE-MMDDYY-DD TO DATE-YYYYMMDD-DD
              MOVE DATE-MMDDYY-YY TO DATE-YYYYMMDD-YY
              MOVE 19             TO DATE-YYYYMMDD-CC
              IF DATE-MMDDYY-YY < EXT-JULIAN-CC
                 MOVE EXT-CONAME-SYSDATE TO ALP-DATE
                 IF DATE-MMDDYY-YY NOT > ALP-YR
                    MOVE 20 TO DATE-YYYYMMDD-CC.

           IF DATE-YYYYMMDD-MM > 12 OR
               DATE-YYYYMMDD-DD > 31 OR
               (DATE-YYYYMMDD-YYYY NOT = 0 AND DATE-YYYYMMDD-MM = 0) OR
                (DATE-YYYYMMDD-YYYY NOT = 0 AND DATE-YYYYMMDD-DD = 0)
              MOVE 0 TO DATE-YYYYMMDD.

           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO BW-SP-BDATE ABW-SP-BDATE.
      * BR 1502 BW-AGE 08/30/24 - YEAR 1924! WE HIT 2024 AND IT SET IT
      * TO 08/30/2024 IN S35. FORCE ANYONE 16 YEARS OLD OR YOUNGER TO BE
      * CENTURY 1900'S! A15 DIDNT HAVE CENTURY, TOUGH CONVERSION
           IF DATE-YYYYMMDD-YYYY > 2008
              MOVE 19 TO DATE-YYYYMMDD-CC
              MOVE DATE-YYYYMMDD TO BW-SP-BDATE ABW-SP-BDATE.

           MOVE OBW-EMPLOYER  TO BW-EMPLOYER ABW-EMPLOYER.
           MOVE OBW-EMPLPOS   TO BW-EMPLPOS  ABW-EMPLPOS.
      * CLEANSE BW-EMPPHONE TN 801 HAD > SIGNS
           IF OBW-EMPPHONE NOT NUMERIC
              MOVE 0             TO BW-EMPPHONE ABW-EMPPHONE
           ELSE
              MOVE OBW-EMPPHONE  TO BW-EMPPHONE ABW-EMPPHONE.

      * CLEANSE BW-EMPEXT     9(4) COMP-3
           IF (OBW-EMPEXT NOT NUMERIC)
              MOVE 0          TO BW-EMPEXT ABW-EMPEXT
           ELSE
              MOVE OBW-EMPEXT TO BW-EMPEXT ABW-EMPEXT.

           IF OBW-EMPYEARS NOT NUMERIC
              MOVE 0            TO BW-EMPYEARS ABW-EMPYEARS
           ELSE
              MOVE OBW-EMPYEARS TO BW-EMPYEARS ABW-EMPYEARS.
      * CLEANSE
           IF OBW-EMPPAY NOT NUMERIC
              MOVE 0            TO BW-EMPPAY ABW-EMPPAY
           ELSE
              MOVE OBW-EMPPAY   TO BW-EMPPAY ABW-EMPPAY.
           IF OBW-EMPPAYOT NOT NUMERIC
              MOVE 0         TO BW-EMPPAYOT  ABW-EMPPAYOT
           ELSE
           MOVE OBW-EMPPAYOT TO BW-EMPPAYOT  ABW-EMPPAYOT.
           MOVE OBW-EMPPAYSR TO BW-EMPPAYSR  ABW-EMPPAYSR.
           MOVE OBW-EMPADDR1 TO BW-EMPADDR1  ABW-EMPADDR1.
           MOVE OBW-EMPADDR2 TO BW-EMPADDR2  ABW-EMPADDR2.
           MOVE OBW-WORKHRS  TO BW-WORKHRS   ABW-WORKHRS.
           IF OBW-LOANS NOT NUMERIC
              MOVE 0         TO BW-LOANS     ABW-LOANS
           ELSE
              MOVE OBW-LOANS TO BW-LOANS     ABW-LOANS.
           IF OBW-INTYTD NOT NUMERIC
              MOVE 0           TO BW-INTYTD    ABW-INTYTD
           ELSE
              MOVE OBW-INTYTD  TO BW-INTYTD    ABW-INTYTD.
           IF OBW-INTLYR NOT NUMERIC
              MOVE 0           TO BW-INTLYR    ABW-INTLYR
           ELSE
              MOVE OBW-INTLYR  TO BW-INTLYR    ABW-INTLYR.
           IF OBW-LIASMLN NOT NUMERIC
              MOVE 0           TO BW-LIASMLN   ABW-LIASMLN
           ELSE
              MOVE OBW-LIASMLN TO BW-LIASMLN   ABW-LIASMLN.
           IF OBW-LIAOTH NOT NUMERIC
              MOVE 0           TO BW-LIAOTH    ABW-LIAOTH
           ELSE
              MOVE OBW-LIAOTH  TO BW-LIAOTH    ABW-LIAOTH.

      * CLEANSE BR 812 408238540
           IF (OBW-LSTPODATE NOT NUMERIC) OR
                 (OBW-LSTPODATE = 020202) OR 
                   (OBW-LSTPODATE = 0)
              MOVE 0                  TO BW-LASTPODATE
                                        ABW-LASTPODATE
           ELSE
              MOVE OBW-LSTPODATE      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO BW-LASTPODATE
                                        ABW-LASTPODATE.

           MOVE OBW-PRLOANS      TO BW-PRLOANS ABW-PRLOANS.
           MOVE OBW-RE-INTYTD    TO BW-RE-INTYTD ABW-RE-INTYTD.
           MOVE OBW-RE-INTLYR    TO BW-RE-INTLYR ABW-RE-INTLYR.
           IF OBW-CREDIT-LIMIT NOT NUMERIC OR
               (OBW-CREDIT-LIMIT = 202020.20 OR 020202.02)
               MOVE 0                TO BW-CREDIT-LIMIT
                                       ABW-CREDIT-LIMIT
           ELSE
               MOVE OBW-CREDIT-LIMIT TO BW-CREDIT-LIMIT
                                       ABW-CREDIT-LIMIT.
           MOVE OBW-CREDIT-SCORE TO BW-CREDIT-SCORE ABW-CREDIT-SCORE.
      * CLEANSE BR 801 'TN' 
           IF (OBW-LAST-FORM-NO NOT NUMERIC) OR (OBW-LAST-FORM-NO = 202)
              MOVE 0             TO BW-LAST-FORM-NO ABW-LAST-FORM-NO
           ELSE
              MOVE OBW-LAST-FORM-NO TO BW-LAST-FORM-NO
                                      ABW-LAST-FORM-NO.

      * CLEANSE BR 801 'TN' 
           IF (OBW-LAST-FORM-DATE NOT NUMERIC) OR 
                  (OBW-LAST-FORM-DATE = 020202) OR
                   (OBW-LAST-FORM-DATE = 0)
              MOVE 0                  TO BW-LAST-FORM-DATE
                                        ABW-LAST-FORM-DATE
           ELSE
              MOVE OBW-LAST-FORM-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO BW-LAST-FORM-DATE
                                        ABW-LAST-FORM-DATE.

           IF (OBW-PRIOR-RN-FOR10 NOT NUMERIC) OR 
               (OBW-PRIOR-RN-FOR10 = 0)
              MOVE 0               TO BW-PRIOR-RN-FOR10-DATE
                                     ABW-PRIOR-RN-FOR10-DATE
           ELSE
              MOVE OBW-PRIOR-RN-FOR10 TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO BW-PRIOR-RN-FOR10-DATE
                                     ABW-PRIOR-RN-FOR10-DATE.

      * CLEANSE 835 414868051
           IF (OBW-LAST-RN-FOR10 NOT NUMERIC) OR
               (OBW-LAST-RN-FOR10 = 020202) OR
                (OBW-LAST-RN-FOR10 = 0)
              MOVE 0               TO BW-LAST-RN-FOR10-DATE
                                     ABW-LAST-RN-FOR10-DATE
           ELSE
              MOVE OBW-LAST-RN-FOR10  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD  TO BW-LAST-RN-FOR10-DATE
                                    ABW-LAST-RN-FOR10-DATE.

           IF OBW-ADR-PHONE-CHG-DATE NOT NUMERIC OR
               (OBW-ADR-PHONE-CHG-DATE = 202020) OR
                (OBW-ADR-PHONE-CHG-DATE = 0)
              MOVE 0              TO BW-ADR-PHONE-CHG-DATE
                                     ABW-ADR-PHONE-CHG-DATE
           ELSE
              MOVE OBW-ADR-PHONE-CHG-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO BW-ADR-PHONE-CHG-DATE
                                     ABW-ADR-PHONE-CHG-DATE.

           MOVE OBW-BAD-ADR-FG   TO BW-BAD-ADR-FG ABW-BAD-ADR-FG.
           MOVE OBW-BAD-PHONE-FG TO BW-BAD-PHONE-FG ABW-BAD-PHONE-FG.
           MOVE OBW-BAD-EMPPHONE-FG TO BW-BAD-EMPPHONE-FG
                                      ABW-BAD-EMPPHONE-FG.
           MOVE OBW-BAD-MISC-PHONE1-FG TO BW-BAD-MISC-PHONE1-FG
                                         ABW-BAD-MISC-PHONE1-FG.
           MOVE OBW-BAD-MISC-PHONE2-FG TO BW-BAD-MISC-PHONE2-FG
                                         ABW-BAD-MISC-PHONE2-FG.
                              
           MOVE OBW-BAD-CELL-FG TO BW-BAD-CELL-FG ABW-BAD-CELL-FG.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
              IF OBW-MISC-PHONE(SUB) = 0202020202 OR
                   OBW-MISC-PHONE(SUB) NOT NUMERIC
                 MOVE 0                 TO BW-MISC-PHONE(SUB)
                                          ABW-MISC-PHONE(SUB)
              ELSE
                MOVE OBW-MISC-PHONE(SUB) TO BW-MISC-PHONE(SUB)
                                           ABW-MISC-PHONE(SUB)
              END-IF
              IF OBW-MISC-EXT(SUB) NOT NUMERIC 
                 MOVE 0                  TO BW-MISC-EXT(SUB)
                                           ABW-MISC-EXT(SUB)
              ELSE
                MOVE OBW-MISC-EXT(SUB)   TO BW-MISC-EXT(SUB)
                                           ABW-MISC-EXT(SUB)
              END-IF
              IF BW-MISC-PHONE(SUB) = 0 AND 
                  BW-MISC-EXT(SUB) = 0
                 MOVE SPACES TO BW-MISC-PHONE-CD(SUB)
                               ABW-MISC-PHONE-CD(SUB)
              ELSE
                MOVE OBW-MISC-PHONE-CD(SUB) TO BW-MISC-PHONE-CD(SUB)
                                              ABW-MISC-PHONE-CD(SUB)
              END-IF
           END-PERFORM.

      * CLEANSE 

           MOVE OBW-SRCD            TO BW-SRCD ABW-SRCD.
           MOVE OBW-CALL-ON-SUNDAY  TO BW-CALL-ON-SUNDAY
                                      ABW-CALL-ON-SUNDAY.
           MOVE OBW-SOLICIT         TO BW-SOLICIT ABW-SOLICIT.
           MOVE OBW-CONFIDENTIAL    TO BW-CONFIDENTIAL ABW-CONFIDENTIAL.
           MOVE OBW-PRIVACY-OPT-OUT TO BW-PRIVACY-OPT-OUT
                                      ABW-PRIVACY-OPT-OUT.
           MOVE OBW-CITY-TAX-CD     TO BW-CITY-TAX-CD ABW-CITY-TAX-CD.

      * CLEANSE - BR TX0494 FILLED WITH 2020202
           IF OBW-DEALTRACK-CHG-DATE NOT NUMERIC OR
               (OBW-DEALTRACK-CHG-DATE = 202020) OR
                (OBW-DEALTRACK-CHG-DATE = 0)
              MOVE 0               TO BW-DEALTRACK-CHG-DATE
                                     ABW-DEALTRACK-CHG-DATE
           ELSE
              MOVE OBW-DEALTRACK-CHG-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO BW-DEALTRACK-CHG-DATE
                                       ABW-DEALTRACK-CHG-DATE.

      * 
           IF OBW-CEASE-DESIST-DATE NOT NUMERIC OR
               (OBW-CEASE-DESIST-DATE = 202020) OR
                (OBW-CEASE-DESIST-DATE = 0)
              MOVE 0               TO BW-CEASE-DESIST-DATE
                                     ABW-CEASE-DESIST-DATE
           ELSE
              MOVE OBW-CEASE-DESIST-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO BW-CEASE-DESIST-DATE
                                       ABW-CEASE-DESIST-DATE.

           MOVE OBW-CEASE-DESIST-TYPE TO BW-CEASE-DESIST-TYPE
                                        ABW-CEASE-DESIST-TYPE.

           IF OBW-UMC-EXPIRE-DATE NOT NUMERIC OR
               (OBW-UMC-EXPIRE-DATE = 202020) OR
                (OBW-UMC-EXPIRE-DATE = 0)
              MOVE 0               TO BW-UMC-EXPIRE-DATE
                                     ABW-UMC-EXPIRE-DATE
           ELSE
              MOVE OBW-UMC-EXPIRE-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO BW-UMC-EXPIRE-DATE
                                       ABW-UMC-EXPIRE-DATE.

           IF OBW-UMC-PR-EXPIRE-DATE NOT NUMERIC OR
               (OBW-UMC-PR-EXPIRE-DATE = 202020) OR
                (OBW-UMC-PR-EXPIRE-DATE = 0)
              MOVE 0               TO BW-UMC-PR-EXPIRE-DATE
                                     ABW-UMC-PR-EXPIRE-DATE
           ELSE
              MOVE OBW-UMC-PR-EXPIRE-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO BW-UMC-PR-EXPIRE-DATE
                                       ABW-UMC-PR-EXPIRE-DATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    A15 BORROWER MEMO FILE (OBM-REC) CONTAINS THE
      *    OLD PHONE CONTACTS.
      *
      * DATE      SEQ   DESC
      * ========  ====  ===========================================
      * 99999999  1-10  BORROWER CONTACTS
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * MEXICO - SUB 6, 7 AND 8 ARE THE ONLY CONTACTS, SO MOVE THEM
      *          TO SUB 1, 2 AND 3
      *
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE BW-SSNO  TO OBM-SSNO.
           MOVE 99999999 TO OBM-DATE.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              MOVE SUB TO OBM-SEQ
              PERFORM READ-OBM1-FILE
              IF IO-GOOD
                 MOVE OBM-PHONE-DESC TO BW-CONTACT-DESC(SUB)
                                       ABW-CONTACT-DESC(SUB)
                 MOVE OBM-PHONE-NO   TO BW-CONTACT-PHONE(SUB)
                                       ABW-CONTACT-PHONE(SUB)
                 MOVE OBM-PHONE-EXT  TO BW-CONTACT-EXT(SUB)
                                       ABW-CONTACT-EXT(SUB)
              END-IF
           END-PERFORM.

      * GET BORROWER FIELDS OUT OF OLD BX BORROWER TRAILER
           MOVE OBW-SSNO TO OBX-SSNO.
           PERFORM READ-OBX1-FILE.
           IF IO-FG = 0
              MOVE OBX-EMAIL TO BW-EMAIL ABW-EMAIL
              PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
                IF OBX-CREDIT-SCORE(SUB) NOT NUMERIC
                   MOVE 0 TO BW-CRED-SCORE(SUB)
                            ABW-CRED-SCORE(SUB)
                ELSE
                MOVE OBX-CREDIT-SCORE(SUB) TO BW-CRED-SCORE(SUB)
                                             ABW-CRED-SCORE(SUB)
                END-IF
                IF OBX-BNKRPT-SCORE(SUB) NOT NUMERIC
                   MOVE 0 TO BW-BNKRPT-SCORE(SUB)
                            ABW-BNKRPT-SCORE(SUB)
                ELSE
                MOVE OBX-BNKRPT-SCORE(SUB) TO BW-BNKRPT-SCORE(SUB)
                                             ABW-BNKRPT-SCORE(SUB)
                END-IF
              END-PERFORM
      * IF WE DONT CHANGE THIS IT MAKES THE ERROR REPORT LOOK LIKE BW ERRORS
              MOVE "BX" TO UP1534-CURRENT-FILE
              PERFORM UPGRADE-FILE-BX
              MOVE "BW" TO UP1534-CURRENT-FILE.

       UPGRADE-FILE-BW-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - B X
      *
      ******************************************************************
       UPGRADE-FILE-BX SECTION.

      * IF NEW FIELDS LEFT IN BX DONT EXIST, DONT CREATE A BX

           MOVE "N" TO CREATE-BX-RECORD.

           PERFORM CLEAR-BX-FILE.
           IF (FILE-OPTION-BW) = "A"
              PERFORM CLEAR-ABX-FILE.

           MOVE BR-NO                      TO BX-BRNO ABX-BRNO.
           MOVE OBX-SSNO                   TO BX-SSNO ABX-SSNO.

           IF ( OBX-ALT-ADDRESS = SPACES )
              GO TO UPGRADE-FILE-BX-002.

           MOVE "Y"               TO CREATE-BX-RECORD.
           MOVE OBX-ALT-ADR1      TO BX-ALT-ADR1  ABX-ALT-ADR1.
           MOVE OBX-ALT-ADR2      TO BX-ALT-ADR2  ABX-ALT-ADR2.
           MOVE OBX-ALT-CITY      TO BX-ALT-CITY  ABX-ALT-CITY.
           MOVE OBX-ALT-STATE     TO BX-ALT-STATE ABX-ALT-STATE.
           MOVE OBX-ALT-ZIP       TO BX-ALT-ZIP   ABX-ALT-ZIP.

       UPGRADE-FILE-BX-002.

           IF ( OBX-KYC-ADR1        = SPACES ) AND
              ( OBX-KYC-CITY        = SPACES ) AND
              ( OBX-KYC-ISSAUTH     = SPACES ) AND
              ( OBX-KYC-ISSDTE      = ZEROES ) AND
              ( OBX-KYC-EXPDTE      = ZEROES ) 
      * WORLD ONLY HAS DATA IN OBX-KYC-LST-VER-DTE FROM LONPC2 UPDATING IT
      * FOR LOANS MADE FROM APPS. MUST HAVE HAD SOME BOGUS APPNO'S BECAUSE
      * KEVIN SAID THEY DONT USE OUR APPS AND WILL NEVER USE THEM.
      
      * I DONT THINK WE SHOULD CREATE A BX IF ONLY FIELD IN IT FILLED IN
      * IS LAST VERIFIED. ITS ALL BLANK OTHERWISE
      *       ( OBX-KYC-LST-VER-DTE = ZEROES )
              GO TO UPGRADE-FILE-BX-WRITE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "Y"              TO CREATE-BX-RECORD.
           MOVE OBX-KYC-ADR1     TO BX-KYC-ADR1    ABX-KYC-ADR1.
           MOVE OBX-KYC-ADR2     TO BX-KYC-ADR2    ABX-KYC-ADR2.
           MOVE OBX-KYC-CITY     TO BX-KYC-CITY    ABX-KYC-CITY.
           MOVE OBX-KYC-STATE    TO BX-KYC-STATE   ABX-KYC-STATE.
           MOVE OBX-KYC-ZIP      TO BX-KYC-ZIP     ABX-KYC-ZIP.
           MOVE OBX-KYC-IDTYPE   TO BX-KYC-IDTYPE  ABX-KYC-IDTYPE.
           MOVE OBX-KYC-ISSAUTH  TO BX-KYC-ISSAUTH ABX-KYC-ISSAUTH.
           MOVE OBX-KYC-NUMBER   TO BX-KYC-NUMBER  ABX-KYC-NUMBER.

           MOVE OBX-KYC-ISSDTE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO BX-KYC-ISSDATE ABX-KYC-ISSDATE.
              
           MOVE OBX-KYC-EXPDTE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO BX-KYC-EXPDATE ABX-KYC-EXPDATE.

           MOVE OBX-KYC-LST-VER-DTE  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD        TO BX-KYC-LAST-VERDATE
                                       ABX-KYC-LAST-VERDATE.

       UPGRADE-FILE-BX-WRITE.

           IF ( CREATE-BX-RECORD NOT = "Y" )
              GO TO UPGRADE-FILE-BX-EXIT.

           IF (FILE-OPTION-BW = "Y")
              PERFORM WRITE-BX1-FILE
           ELSE
              ADD 1 TO ABX-KEY
              ACCEPT ABX-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ABX-CR
              MOVE X"0A"              TO ABX-LF
              PERFORM WRITE-ABX-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE BX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP NOT = "22,00" )
                 GO TO IO-ERROR.

       UPGRADE-FILE-BX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C A
      *
      ******************************************************************
       UPGRADE-FILE-CA SECTION.

           IF FILE-OPTION-CA = "A"
              PERFORM CLEAR-ACA-FILE
           ELSE
              PERFORM CLEAR-CA-FILE.

           MOVE OCA-BRNO              TO CA-BRNO ACA-BRNO.

           MOVE OCA-DATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO CA-DATE ACA-DATE.

           IF OCA-TILLNO = "1"
              MOVE 1  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "2"
              MOVE 2  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "3"
              MOVE 3  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "4"
              MOVE 4  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "5"
              MOVE 5  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "6"
              MOVE 6  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "7"
              MOVE 7  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "8"
              MOVE 8  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "9"
              MOVE 9  TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "A"
              MOVE 10 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "B"
              MOVE 11 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "C"
              MOVE 12 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "D"
              MOVE 13 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "E"
              MOVE 14 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "F"
              MOVE 15 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "G"
              MOVE 16 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "H"
              MOVE 17 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "I"
              MOVE 18 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "J"
              MOVE 19 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "K"
              MOVE 20 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "L"
              MOVE 21 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "M"
              MOVE 22 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "N"
              MOVE 23 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "O"
              MOVE 24 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "P"
              MOVE 25 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "Q"
              MOVE 26 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "R"
              MOVE 27 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "S"
              MOVE 28 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "T"
              MOVE 29 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "U"
              MOVE 30 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "V"
              MOVE 31 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "W"
              MOVE 32 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "X"
              MOVE 33 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "Y"
              MOVE 34 TO CA-TILLNO ACA-TILLNO
           ELSE
           IF OCA-TILLNO = "Z"
              MOVE 35 TO CA-TILLNO ACA-TILLNO.

           MOVE OCA-DESC       TO CA-DESC        ACA-DESC.
           IF OCA-BEGBAL NOT NUMERIC
              MOVE 0           TO CA-BEGBAL      ACA-BEGBAL
           ELSE
              MOVE OCA-BEGBAL  TO CA-BEGBAL      ACA-BEGBAL.
      * CLEANSE
           IF (OCA-OPENED NOT NUMERIC) OR (OCA-OPENED = 2020 OR 0202)
              MOVE 0           TO CA-OPENED-HHMM ACA-OPENED-HHMM
           ELSE
              MOVE OCA-OPENED  TO CA-OPENED-HHMM ACA-OPENED-HHMM.
           IF (OCA-CLOSED NOT NUMERIC) OR (OCA-CLOSED = 2020 OR 0202)
              MOVE 0           TO CA-CLOSED-HHMM ACA-CLOSED-HHMM
           ELSE
              MOVE OCA-CLOSED  TO CA-CLOSED-HHMM ACA-CLOSED-HHMM.
           IF OCA-ENDBAL NOT NUMERIC
              MOVE 0           TO CA-ENDBAL      ACA-ENDBAL
           ELSE
           MOVE OCA-ENDBAL     TO CA-ENDBAL      ACA-ENDBAL.
           MOVE OCA-BALBY      TO CA-BALBY       ACA-BALBY.
           IF OCA-RUNNING NOT NUMERIC
              MOVE 0           TO CA-RUNNING     ACA-RUNNING
           ELSE
           MOVE OCA-RUNNING    TO CA-RUNNING     ACA-RUNNING.
           IF OCA-DEPOSIT NOT NUMERIC
              MOVE 0           TO CA-DEPOSIT     ACA-DEPOSIT
           ELSE
           MOVE OCA-DEPOSIT    TO CA-DEPOSIT     ACA-DEPOSIT.
           MOVE OCA-OPENID     TO CA-OPEN-USERID ACA-OPEN-USERID.
           IF OCA-NET-CASH-NOTES NOT NUMERIC
              MOVE 0                  TO CA-NET-CASH-NOTES  
                                        ACA-NET-CASH-NOTES
           ELSE
              MOVE OCA-NET-CASH-NOTES TO CA-NET-CASH-NOTES
                                        ACA-NET-CASH-NOTES.
           MOVE OCA-PASSWORD   TO CA-PASSWORD    ACA-PASSWORD.
           MOVE 0              TO CA-CHECK-DEPOSIT
                                 ACA-CHECK-DEPOSIT.

       UPGRADE-FILE-CA-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C I
      *
      ******************************************************************
       UPGRADE-FILE-CI SECTION.

           IF (FILE-OPTION-CI) = "A"
              PERFORM CLEAR-ACI-FILE
           ELSE
              PERFORM CLEAR-CI-FILE.

           MOVE BR-NO             TO CI-BRNO         ACI-BRNO.
           MOVE OCI-ACCTNO        TO OLD-ACCTNO.
           MOVE NEW-ACCTNO        TO CI-ACCTNO       ACI-ACCTNO.
           IF OCI-SSNO NOT NUMERIC
              MOVE 0              TO CI-SSNO         ACI-SSNO
           ELSE
              MOVE OCI-SSNO       TO CI-SSNO         ACI-SSNO.
           IF OCI-SSNO-2 NOT NUMERIC
              MOVE 0              TO CI-SSNO-2       ACI-SSNO-2
           ELSE
              MOVE OCI-SSNO-2     TO CI-SSNO-2       ACI-SSNO-2.
           MOVE ZEROES            TO CI-LTOUCH-DATE  ACI-LTOUCH-DATE.

           MOVE OCI-DATE-UPDATED  TO DATE-MMDDYYYY.
           PERFORM CONVERT-MMDDYYYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO CI-DATE-UPDATED ACI-DATE-UPDATED.

           IF OCI-AMT-REQUESTED NOT NUMERIC
              MOVE 0 TO CI-AMT-REQUESTED ACI-AMT-REQUESTED
           ELSE
              MOVE OCI-AMT-REQUESTED TO CI-AMT-REQUESTED
                                       ACI-AMT-REQUESTED.

      * CLEANSE - WE ALLOW ANYTHING TO BE ENTERED, WANT TO CLEAN IT UP
      *           ALL KINDS OF JUNK IN THIS FIELD, ;, ], 
           IF OCI-MARITAL-STAT NOT ALPHABETIC AND
                 OCI-MARITAL-STAT NOT NUMERIC
              MOVE SPACES TO CI-MARITAL-STAT ACI-MARITAL-STAT
           ELSE
              MOVE OCI-MARITAL-STAT TO CI-MARITAL-STAT
                                      ACI-MARITAL-STAT.

           IF OCI-YEARS-IN-AREA NOT NUMERIC
              MOVE 0 TO CI-YEARS-IN-AREA ACI-YEARS-IN-AREA
           ELSE
              MOVE OCI-YEARS-IN-AREA TO CI-YEARS-IN-AREA
                                       ACI-YEARS-IN-AREA.

           MOVE OCI-DATE-AT-PRESENT-ADR TO DATE-MMDDYYYY.
           PERFORM CONVERT-MMDDYYYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO CI-DATE-AT-PRESENT-ADR
                                        ACI-DATE-AT-PRESENT-ADR.

           IF OCI-MONTHLY-RENT-MTG NOT NUMERIC
              MOVE 0 TO CI-MONTHLY-RENT-MTG ACI-MONTHLY-RENT-MTG
           ELSE
              MOVE OCI-MONTHLY-RENT-MTG  TO CI-MONTHLY-RENT-MTG
                                           ACI-MONTHLY-RENT-MTG.

           IF OCI-FAIR-MARKET-VALUE NOT NUMERIC
              MOVE 0 TO CI-FAIR-MARKET-VALUE ACI-FAIR-MARKET-VALUE
           ELSE
              MOVE OCI-FAIR-MARKET-VALUE TO CI-FAIR-MARKET-VALUE
                                           ACI-FAIR-MARKET-VALUE.

           IF OCI-MTG-BALANCE NOT NUMERIC
              MOVE 0               TO CI-MTG-BALANCE ACI-MTG-BALANCE
           ELSE
              MOVE OCI-MTG-BALANCE TO CI-MTG-BALANCE ACI-MTG-BALANCE.
           MOVE OCI-CHECKING-ACCOUNT TO CI-CHECKING-ACCOUNT
                                       ACI-CHECKING-ACCOUNT.
           MOVE OCI-SAVINGS-ACCOUNT  TO CI-SAVINGS-ACCOUNT
                                       ACI-SAVINGS-ACCOUNT.
           IF OCI-TOTAL-MO-INCOME NOT NUMERIC
              MOVE 0                 TO CI-TOTAL-MO-INCOME
                                       ACI-TOTAL-MO-INCOME
           ELSE
           MOVE OCI-TOTAL-MO-INCOME  TO CI-TOTAL-MO-INCOME
                                       ACI-TOTAL-MO-INCOME.
           IF OCI-LESS-MO-PAY NOT NUMERIC
              MOVE 0                 TO CI-LESS-MO-PAY
                                       ACI-LESS-MO-PAY
           ELSE
              MOVE OCI-LESS-MO-PAY   TO CI-LESS-MO-PAY
                                       ACI-LESS-MO-PAY.
 
           MOVE OCI-DATE-HIRE-1        TO DATE-MMDDYYYY.
           PERFORM CONVERT-MMDDYYYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD          TO CI-DATE-HIRE-1 ACI-DATE-HIRE-1.

           MOVE OCI-DATE-HIRE-2        TO DATE-MMDDYYYY.
           PERFORM CONVERT-MMDDYYYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD          TO CI-DATE-HIRE-2 ACI-DATE-HIRE-2.

           MOVE OCI-POSITION-CODE-1    TO CI-POSITION-CODE-1
                                         ACI-POSITION-CODE-1.
           IF OCI-GROSS-MO-INCOME-1 NOT NUMERIC
              MOVE 0                     TO CI-GROSS-MO-INCOME-1
                                           ACI-GROSS-MO-INCOME-1
           ELSE
              MOVE OCI-GROSS-MO-INCOME-1 TO CI-GROSS-MO-INCOME-1
                                           ACI-GROSS-MO-INCOME-1.
           MOVE OCI-POSITION-CODE-2    TO CI-POSITION-CODE-2
                                         ACI-POSITION-CODE-2.
           IF OCI-GROSS-MO-INCOME-2 NOT NUMERIC
              MOVE 0                     TO CI-GROSS-MO-INCOME-2
                                           ACI-GROSS-MO-INCOME-2
           ELSE
              MOVE OCI-GROSS-MO-INCOME-2 TO CI-GROSS-MO-INCOME-2
                                           ACI-GROSS-MO-INCOME-2.

       UPGRADE-FILE-CI-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C K
      *
      ******************************************************************
       UPGRADE-FILE-CK SECTION.

           IF FILE-OPTION-CK = "A"
              PERFORM CLEAR-ACK-FILE
           ELSE
              PERFORM CLEAR-CK-FILE.

           MOVE OCK-BRNO           TO CK-BRNO ACK-BRNO.
           MOVE OCK-NO             TO CK-NO   ACK-NO.

           MOVE OCK-TYPE           TO CK-TYPE ACK-TYPE.

           IF (OCK-DATE NOT NUMERIC) 
              MOVE 0               TO CK-DATE ACK-DATE
           ELSE
              MOVE OCK-DATE        TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO CK-DATE ACK-DATE.

           IF OCK-AMT NOT NUMERIC
              MOVE 0               TO CK-AMT ACK-AMT
           ELSE
              MOVE OCK-AMT         TO CK-AMT ACK-AMT.

           MOVE SPACES TO CK-PAYEE.
           IF OCK-ADR1-PARTIAL NOT = SPACES
              STRING OCK-PAYEE," ",OCK-ADR1-PARTIAL
                     DELIMITED BY "  "   INTO CK-PAYEE
           ELSE
              MOVE OCK-PAYEE               TO CK-PAYEE.
           MOVE CK-PAYEE TO ACK-PAYEE.

      * CLEANSE CK-REF 9(6) C3  BR 809 
           IF OCK-REF NOT NUMERIC OR OCK-REF = 202020
              MOVE 0               TO CK-REF ACK-REF
           ELSE
              MOVE OCK-REF         TO CK-REF    ACK-REF.
           MOVE OCK-REASON         TO CK-REASON ACK-REASON.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OCK-GLNO(SUB) NOT NUMERIC
                 MOVE 0             TO CK-GLNO(SUB) ACK-GLNO(SUB)
              ELSE
                 MOVE OCK-GLNO(SUB) TO CK-GLNO(SUB)  ACK-GLNO(SUB)
              END-IF
              IF OCK-GLAMT(SUB) NOT NUMERIC
                 MOVE 0             TO CK-GLAMT(SUB) ACK-GLAMT(SUB)
              ELSE
                MOVE OCK-GLAMT(SUB) TO CK-GLAMT(SUB) ACK-GLAMT(SUB)
              END-IF
           END-PERFORM.

           MOVE OCK-VOID           TO CK-VOID  ACK-VOID.
           MOVE OCK-PAID           TO CK-PAID  ACK-PAID.
           IF OCK-CLASS NOT NUMERIC
              MOVE 0               TO CK-CLASS ACK-CLASS
           ELSE
              MOVE OCK-CLASS       TO CK-CLASS ACK-CLASS.
           IF OCK-DLNO NOT NUMERIC
              MOVE 0               TO CK-DLNO ACK-DLNO
           ELSE
              MOVE OCK-DLNO        TO CK-DLNO ACK-DLNO.
           MOVE OCK-PGM            TO CK-PGM   ACK-PGM.

           IF OCK-NC-SEQNO NUMERIC
              MOVE OCK-NC-SEQNO    TO CK-NC-SEQNO ACK-NC-SEQNO.

           IF (OCK-VOID-DATE NOT NUMERIC) 
              MOVE 0               TO CK-VOID-DATE ACK-VOID-DATE
           ELSE
              MOVE OCK-VOID-DATE   TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO CK-VOID-DATE
                                     ACK-VOID-DATE.

           IF OCK-ACCTNO NOT NUMERIC
              MOVE 0               TO OLD-ACCTNO
           ELSE
              MOVE OCK-ACCTNO      TO OLD-ACCTNO.
           MOVE NEW-ACCTNO         TO CK-ACCTNO      ACK-ACCTNO.

      * CLEANSE, SOME HAVE SPACES
           IF OCK-DLRVNO NUMERIC
              MOVE OCK-DLRVNO      TO CK-DLRVNO      ACK-DLRVNO
           ELSE
              MOVE 0               TO CK-DLRVNO      ACK-DLRVNO.
           MOVE OCK-CLEARED-FG     TO CK-CLEARED-FG  ACK-CLEARED-FG.
           IF OCK-SSNO NOT NUMERIC
              MOVE 0               TO CK-SSNO        ACK-SSNO
           ELSE
              MOVE OCK-SSNO        TO CK-SSNO        ACK-SSNO.
           IF OCK-BATCHID NOT NUMERIC
              MOVE 0               TO CK-BATCHID     ACK-BATCHID
           ELSE
              MOVE OCK-BATCHID     TO CK-BATCHID     ACK-BATCHID.
           MOVE OCK-UNPAID         TO CK-UNPAID      ACK-UNPAID.

      * CLEANSE, BR 1813, 11048, A15 63/01/60, 19606301
           MOVE 0 TO CK-CLEARED-DATE ACK-CLEARED-DATE.
           IF OCK-CLEARED-FG = "Y"
              IF OCK-CLEARED-DATE NOT NUMERIC
                 MOVE 0 TO CK-CLEARED-DATE ACK-CLEARED-DATE
              ELSE
                MOVE OCK-CLEARED-DATE TO DATE-MMDDYY
                PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                PERFORM TEST-INVALID-DATE
                MOVE DATE-YYYYMMDD TO CK-CLEARED-DATE
                                     ACK-CLEARED-DATE
                MOVE CK-CLEARED-DATE TO NUM-DATE
                PERFORM TSTDAT
                IF NUM-DATE = 0
                   MOVE CK-DATE TO CK-CLEARED-DATE
                                  ACK-CLEARED-DATE.

           IF OCK-TILLNO = "1"
              MOVE 1  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "2"
              MOVE 2  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "3"
              MOVE 3  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "4"
              MOVE 4  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "5"
              MOVE 5  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "6"
              MOVE 6  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "7"
              MOVE 7  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "8"
              MOVE 8  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "9"
              MOVE 9  TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "A"
              MOVE 10 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "B"
              MOVE 11 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "C"
              MOVE 12 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "D"
              MOVE 13 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "E"
              MOVE 14 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "F"
              MOVE 15 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "G"
              MOVE 16 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "H"
              MOVE 17 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "I"
              MOVE 18 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "J"
              MOVE 19 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "K"
              MOVE 20 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "L"
              MOVE 21 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "M"
              MOVE 22 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "N"
              MOVE 23 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "O"
              MOVE 24 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "P"
              MOVE 25 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "Q"
              MOVE 26 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "R"
              MOVE 27 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "S"
              MOVE 28 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "T"
              MOVE 29 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "U"
              MOVE 30 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "V"
              MOVE 31 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "W"
              MOVE 32 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "X"
              MOVE 33 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "Y"
              MOVE 34 TO CK-TILLNO ACK-TILLNO
           ELSE
           IF OCK-TILLNO = "Z"
              MOVE 35 TO CK-TILLNO ACK-TILLNO.

           MOVE OCK-EVENT-CD    TO CK-EVENT-CD ACK-EVENT-CD.
      * CLEANSE 805 
           IF OCK-PAYEE-NO NOT NUMERIC OR 
                (OCK-PAYEE-NO = 202020 OR 020202)
              MOVE 0            TO CK-PAYEE-NO ACK-PAYEE-NO
           ELSE
              MOVE OCK-PAYEE-NO TO CK-PAYEE-NO ACK-PAYEE-NO.

       UPGRADE-FILE-CK-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C X
      *
      ******************************************************************
       UPGRADE-FILE-CX SECTION.

           PERFORM CLEAR-CX-FILE.

           MOVE OCX-BRNO                   TO CX-BRNO.
           MOVE OCX-TYPE                   TO CX-TYPE.
           MOVE OCX-SEQNO                  TO CX-SEQNO.
           MOVE OCX-PAYEE                  TO CX-PAYEE.
           MOVE ZEROES                     TO CX-LTOUCH-DATE.
           MOVE OCX-ADR1                   TO CX-ADR1.
           MOVE OCX-ADR2                   TO CX-ADR2.
           MOVE OCX-CITY                   TO CX-CITY.
           MOVE OCX-STATE                  TO CX-STATE.
           MOVE OCX-ZIP                    TO CX-ZIP.
           MOVE OCX-AMT                    TO CX-AMT.
           IF OCX-REF NOT NUMERIC
              MOVE 0 TO CX-REF
           ELSE
              MOVE OCX-REF                 TO CX-REF.
           MOVE OCX-REASON                 TO CX-REASON.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OCX-GLNO(SUB) NOT NUMERIC
                  MOVE 0 TO CX-GLNO(SUB)
               ELSE
                  MOVE OCX-GLNO (SUB)     TO CX-GLNO (SUB)
              END-IF
              IF OCX-GLAMT(SUB) NOT NUMERIC
                  MOVE 0 TO CX-GLAMT(SUB)
               ELSE
                   MOVE OCX-GLAMT(SUB)     TO CX-GLAMT(SUB)
              END-IF
           END-PERFORM.

           MOVE OCX-FREE1                  TO CX-FREE1.
           MOVE OCX-FREE2                  TO CX-FREE2.
           MOVE OCX-VOID                   TO CX-VOID.
           IF OCX-CLASS NOT NUMERIC
              MOVE 0 TO CX-CLASS
           ELSE
           MOVE OCX-CLASS                  TO CX-CLASS.
           IF OCX-CKNO NOT NUMERIC
              MOVE 0 TO CX-CKNO
           ELSE
           MOVE OCX-CKNO                   TO CX-CKNO.
           IF OCX-DLNO NOT NUMERIC
              MOVE 0 TO CX-DLNO
           ELSE
           MOVE OCX-DLNO                   TO CX-DLNO.

           MOVE OCX-DATE                   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO CX-DATE.

           MOVE OCX-PAID                   TO CX-PAID.
           MOVE OCX-PGM                    TO CX-PGM.
           IF OCX-BATCHID NOT NUMERIC
              MOVE 0                       TO CX-BATCHID
           ELSE
           MOVE OCX-BATCHID                TO CX-BATCHID.
           MOVE OCX-BWPROC                 TO CX-BWPROC.
           IF OCX-CKNO-NEW NOT NUMERIC
              MOVE 0                       TO CX-CKNO-NEW
           ELSE
              MOVE OCX-CKNO-NEW            TO CX-CKNO-NEW.
           IF OCX-DLRVNO NOT NUMERIC
              MOVE 0                       TO CX-DLRVNO
           ELSE
              MOVE OCX-DLRVNO              TO CX-DLRVNO.
           IF OCX-DT-SEQ NOT NUMERIC
              MOVE 0                       TO CX-DT-SEQ
           ELSE
              MOVE OCX-DT-SEQ              TO CX-DT-SEQ.
           MOVE OCX-RESCISSION             TO CX-RESCISSION.

           IF OCX-TILLNO = "1"
              MOVE 1                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "2"
              MOVE 2                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "3"
              MOVE 3                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "4"
              MOVE 4                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "5"
              MOVE 5                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "6"
              MOVE 6                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "7"
              MOVE 7                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "8"
              MOVE 8                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "9"
              MOVE 9                       TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "A"
              MOVE 10                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "B"
              MOVE 11                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "C"
              MOVE 12                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "D"
              MOVE 13                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "E"
              MOVE 14                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "F"
              MOVE 15                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "G"
              MOVE 16                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "H"
              MOVE 17                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "I"
              MOVE 18                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "J"
              MOVE 19                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "K"
              MOVE 20                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "L"
              MOVE 21                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "M"
              MOVE 22                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "N"
              MOVE 23                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "O"
              MOVE 24                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "P"
              MOVE 25                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "Q"
              MOVE 26                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "R"
              MOVE 27                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "S"
              MOVE 28                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "T"
              MOVE 29                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "U"
              MOVE 30                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "V"
              MOVE 31                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "W"
              MOVE 32                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "X"
              MOVE 33                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "Y"
              MOVE 34                      TO CX-TILLNO
           ELSE
           IF OCX-TILLNO = "Z"
              MOVE 35                      TO CX-TILLNO
           ELSE
              MOVE  0                      TO CX-TILLNO.

           IF OCX-ACCTNO NOT NUMERIC
              MOVE 0                       TO CX-ACCTNO
           ELSE
              MOVE OCX-ACCTNO              TO CX-ACCTNO.
           MOVE OCX-SERVACCT               TO CX-SERVACCT.

           MOVE OCX-DT-DATE                TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO CX-DT-DATE.

           IF OCX-SSNO NOT NUMERIC
              MOVE 0                       TO CX-SSNO
           ELSE
              MOVE OCX-SSNO                TO CX-SSNO.
           MOVE OCX-DT-PAID                TO CX-DT-PAID.
           MOVE OCX-DT-UNPAID              TO CX-DT-UNPAID.
           MOVE OCX-CKPAID-NEW             TO CX-CKPAID-NEW.
           MOVE OCX-EVENT-CD               TO CX-EVENT-CD.
           IF OCX-PAYEE-NO NOT NUMERIC
              MOVE 0                       TO CX-PAYEE-NO
           ELSE
              MOVE OCX-PAYEE-NO            TO CX-PAYEE-NO.
           MOVE SPACES                     TO CX-DEPOSIT-WITHDR.

       UPGRADE-FILE-CX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - D S
      *
      ******************************************************************
      *UPGRADE-FILE-DS SECTION.

      *    PERFORM CLEAR-DS-FILE.

      *    MOVE ODS-DATE                   TO DATE-YYYMM.
      *    PERFORM CONVERT-YYYMM-TO-MMDDYY.
      *    PERFORM CONVERT-MMDDYY-TO-YYYYMM.
      *    MOVE DATE-YYYYMM                TO DS-DATE-CCYYMM.
      *    MOVE ODS-BRANCH                 TO DS-BRANCH.
      *    MOVE ODS-NUM                    TO DS-NUM.
      *    MOVE ODS-CLASS                  TO DS-CLASS.

      *    PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
      *            MOVE ODS-DLRVPRIN(SUB) TO DS-DLRVPRIN(SUB)
      *            MOVE ODS-DLRVCHGS(SUB) TO DS-DLRVCHGS(SUB)
      *    END-PERFORM.

      *    MOVE ODS-DLPARVHELD            TO DS-DLPARVHELD.
      *    MOVE ODS-UNPAIDCK              TO DS-UNPAIDCK.
      *    MOVE ODS-DLDISC                TO DS-DLDISC.
      *    MOVE ODS-DLPARVPAID            TO DS-DLPARVPAID.
      *    MOVE ODS-SUMWGTTM              TO DS-SUMWGTTM.
      *    MOVE ODS-SUMWGTAV              TO DS-SUMWGTAV.
      *    MOVE ODS-SUMWGTTA              TO DS-SUMWGTTA.

      *    PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
      *       MOVE ODS-RCOURSE-UNITS(S1) TO DS-RCOURSE-UNITS(S1)
      *       MOVE ODS-RCOURSE-AMT(S1)   TO DS-RCOURSE-AMT(S1)
      *       MOVE ODS-NPURUNIT(S1)      TO DS-NPURUNIT(S1)
      *       MOVE ODS-NPURAMT(S1)       TO DS-NPURAMT(S1)
      *       MOVE ODS-OPURUNIT(S1)      TO DS-OPURUNIT(S1)
      *       MOVE ODS-OPURAMT(S1)       TO DS-OPURAMT(S1)
      *       MOVE ODS-RNEWUNIT(S1)      TO DS-RNEWUNIT(S1)
      *       MOVE ODS-RNEWAMT(S1)       TO DS-RNEWAMT(S1)
      *       MOVE ODS-PAIDUNIT(S1)      TO DS-PAIDUNIT(S1)
      *       MOVE ODS-PAIDAMT(S1)       TO DS-PAIDAMT(S1)
      *       MOVE ODS-TODLUNIT(S1)      TO DS-TODLUNIT(S1)
      *       MOVE ODS-TODLAMT(S1)       TO DS-TODLAMT(S1)
      *       MOVE ODS-OUTSUNIT(S1)      TO DS-OUTSUNIT(S1)
      *       MOVE ODS-OUTSAMT(S1)       TO DS-OUTSAMT(S1)
      *       MOVE ODS-PLOSUNIT(S1)      TO DS-PLOSUNIT(S1)
      *       MOVE ODS-PLOSAMT(S1)       TO DS-PLOSAMT(S1)
      *       MOVE ODS-RCPLUNIT(S1)      TO DS-RCPLUNIT(S1)
      *       MOVE ODS-RCPLAMT(S1)       TO DS-RCPLAMT(S1)
      *       MOVE ODS-JDOSUNIT(S1)      TO DS-JDOSUNIT(S1)
      *       MOVE ODS-JDOSAMT(S1)       TO DS-JDOSAMT(S1)
      *    END-PERFORM.

      *    MOVE ODS-DELUNEDT   TO DATE-MMDDYY.
      *    PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *    MOVE DATE-YYYYMMDD  TO DS-DELUNEARN-DATE.

      *    MOVE ODS-PROCEEDS(1)           TO DS-PROCEEDS(1).
      *    MOVE ODS-PROCEEDS(2)           TO DS-PROCEEDS(2).

      *    PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
      *       AFTER   S2 FROM 1 BY 1 UNTIL S2 > 2
      *       AFTER   S3 FROM 1 BY 1 UNTIL S3 > 5
      *          MOVE ODS-NO-REPO (S1 S2 S3) TO DS-NO-REPO (S1 S2 S3)
      *          MOVE ODS-AMT-REPO(S1 S2 S3) TO DS-AMT-REPO(S1 S2 S3)
      *    END-PERFORM.
      
      *    PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
      *       AFTER S2 FROM 1 BY 1 UNTIL S2 > 2
      *       AFTER S3 FROM 1 BY 1 UNTIL S3 > 10
      *          MOVE ODS-UNITS (S1 S2 S3) TO DS-UNITS (S1 S2 S3)
      *          MOVE ODS-OUTBAL(S1 S2 S3) TO DS-OUTBAL(S1 S2 S3)
      *          MOVE ODS-UNITS-BNKRPT (S1 S2 S3) TO
      *                                DS-UNITS-BNKRPT (S1 S2 S3)
      *          MOVE ODS-OUTBAL-BNKRPT(S1 S2 S3) TO
      *                                DS-OUTBAL-BNKRPT(S1 S2 S3)
      *    END-PERFORM.
      



      *    PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 2
      *       AFTER S3 FROM 1 BY 1 UNTIL S3 > 6
      *          MOVE ODS-UNEARNED-AMT(S2 S3) TO
      *                DS-UNEARNED-AMT(1 S2 S3)
      *    END-PERFORM.

      *    PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
      *       AFTER S2 FROM 1 BY 1 UNTIL S2 > 2
      *       AFTER S3 FROM 1 BY 1 UNTIL S3 > 6
      *          MOVE ODS-UNEARNED-AMT2(S1 S2 S3) TO
      *                           DS-UNEARNED-AMT(S1 + 1 S2 S3)
      *    END-PERFORM.

      *    PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
      *       AFTER   S2 FROM 1 BY 1 UNTIL S2 > 2
      *       AFTER   S3 FROM 7 BY 1 UNTIL S3 > 10
      *          MOVE 0 TO DS-UNEARNED-AMT(S1 S2 S3)
      *    END-PERFORM.
      
      *    PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
      *           MOVE ODS-DLDISC-VOL(SUB) TO DS-DLDISC-VOL(SUB)
      *    END-PERFORM.

      *    MOVE ODS-AFPDUEDL-MEMO          TO DS-AFPDUEDL-MEMO.
      *    MOVE ODS-UNPAID-MANUAL          TO DS-UNPAID-MANUAL.

      *UPGRADE-FILE-DS-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - D T
      *
      ******************************************************************
       UPGRADE-FILE-DT SECTION.

           PERFORM CLEAR-DT-FILE.

           MOVE ODT-STATUS TO DT-STATUS.
           MOVE BR-NO      TO DT-BRNO.  
           MOVE ODT-NUM    TO DT-NUM.
           MOVE ODT-CLASS  TO DT-CLASS.
           MOVE ODT-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO DT-ACCTNO.

           MOVE ODT-DATE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD  TO DT-DATE.

           MOVE ODT-SEQ        TO DT-SEQ.

           MOVE ODT-TYPE       TO DT-TYPE.
           IF ODT-LPSEQNO NOT NUMERIC
              MOVE 0           TO DT-LPSEQNO
           ELSE
              MOVE ODT-LPSEQNO TO DT-LPSEQNO.
           MOVE ODT-TRCD     TO DT-TRCD.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              IF ODT-DLRVPRIN(SUB) NOT NUMERIC
                 MOVE 0                 TO DT-DLRVPRIN(SUB)
              ELSE
                 MOVE ODT-DLRVPRIN(SUB) TO DT-DLRVPRIN(SUB)
              END-IF
              IF ODT-DLRVCHGS(SUB) NOT NUMERIC
                 MOVE 0                 TO DT-DLRVCHGS(SUB)
              ELSE
                 MOVE ODT-DLRVCHGS(SUB) TO DT-DLRVCHGS(SUB)
              END-IF
           END-PERFORM.
      **********************************************************
           IF ODT-DLPARVHELD NOT NUMERIC
              MOVE 0               TO DT-DLPARVHELD
           ELSE
              MOVE ODT-DLPARVHELD  TO DT-DLPARVHELD.
           IF ODT-DLPARVPAID NOT NUMERIC
              MOVE 0               TO DT-DLPARVPAID
           ELSE
           MOVE ODT-DLPARVPAID     TO DT-DLPARVPAID.
           IF ODT-PROCEEDS NOT NUMERIC
              MOVE 0               TO DT-PROCEEDS
           ELSE
           MOVE ODT-PROCEEDS       TO DT-PROCEEDS.
      *****************************************************
           IF ODT-RELEASED NOT NUMERIC
              MOVE 0               TO DT-RELEASED
           ELSE
              MOVE ODT-RELEASED    TO DT-RELEASED.
           IF ODT-PAYMENTS NOT NUMERIC
              MOVE 0               TO DT-PAYMENTS
           ELSE
           MOVE ODT-PAYMENTS       TO DT-PAYMENTS.
           IF ODT-CKNO NOT NUMERIC
              MOVE 0               TO DT-CKNO
           ELSE
           MOVE ODT-CKNO           TO DT-CKNO.

           MOVE ODT-CKDATE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD  TO DT-CKDATE.

           IF ODT-BATCHID NOT NUMERIC
              MOVE 0                  TO DT-BATCHID
           ELSE
              MOVE ODT-BATCHID        TO DT-BATCHID.
           IF ODT-BATCHID-SEQ NOT NUMERIC
              MOVE 0                  TO DT-BATCHID-SEQ
           ELSE
              MOVE ODT-BATCHID-SEQ    TO DT-BATCHID-SEQ.
           MOVE ODT-PAID              TO DT-PAID.
           MOVE ODT-REVERSE           TO DT-REVERSE.
           MOVE ODT-REVERSE-TRCD      TO DT-REVERSE-TRCD.
           IF ODT-PURBAL NOT NUMERIC
              MOVE 0                  TO DT-PURBAL
           ELSE
              MOVE ODT-PURBAL         TO DT-PURBAL.
           IF ODT-APCUR NOT NUMERIC
              MOVE 0                  TO DT-APCUR
           ELSE
              MOVE ODT-APCUR          TO DT-APCUR.
           IF ODT-DLRVNO NOT NUMERIC
              MOVE 0                  TO DT-DLRVNO
           ELSE
              MOVE ODT-DLRVNO         TO DT-DLRVNO.
           MOVE ODT-SELECTED          TO DT-SELECTED.
           MOVE ODT-P4P5-TRCD         TO DT-P4P5-TRCD.

           IF ODT-DLRVPRIN-PAY NOT NUMERIC
              MOVE 0                  TO DT-DLRVPRIN-PAY
           ELSE
              MOVE ODT-DLRVPRIN-PAY   TO DT-DLRVPRIN-PAY.
           IF ODT-DLRVCHGS-PAY NOT NUMERIC
              MOVE 0                  TO DT-DLRVCHGS-PAY
           ELSE
              MOVE ODT-DLRVCHGS-PAY   TO DT-DLRVCHGS-PAY.
           IF ODT-DLPARVHELD-PAY NOT NUMERIC
              MOVE 0                  TO DT-DLPARVHELD-PAY
           ELSE
              MOVE ODT-DLPARVHELD-PAY TO DT-DLPARVHELD-PAY.

           MOVE ODT-CHECK-VOID        TO DT-CHECK-VOID.
           MOVE ODT-UNPAID            TO DT-UNPAID.
           MOVE ODT-MEMO              TO DT-MEMO.
           MOVE ODT-EVENT-CD          TO DT-EVENT-CD.
           MOVE ODT-PART-HELD-STATUS  TO DT-PART-HELD-STATUS.

       UPGRADE-FILE-DT-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L E
      *
      ******************************************************************
       UPGRADE-FILE-LE SECTION.

           IF FILE-OPTION-LE = "A"
              PERFORM CLEAR-ALE-FILE
           ELSE
              PERFORM CLEAR-LE-FILE.

           MOVE BR-NO                      TO LE-BRNO ALE-BRNO.

           MOVE OLE-ACCTNO                 TO OLD-ACCTNO.
           MOVE NEW-ACCTNO                 TO LE-ACCTNO ALE-ACCTNO.

           MOVE OLE-TYPE                   TO LE-TYPE ALE-TYPE.
           IF ( OLE-TYPE = "E" )
               MOVE SPACES                 TO LE-FLAG ALE-FLAG
               IF OLE-SSNO NOT NUMERIC
                  MOVE 0                   TO LE-SSNO ALE-SSNO
               ELSE
                  MOVE OLE-SSNO               TO LE-SSNO ALE-SSNO
           ELSE
               MOVE OLE-FLAG               TO LE-FLAG ALE-FLAG
               MOVE ZEROES                 TO LE-SSNO ALE-SSNO.

           IF OLE-OSACCTNO NOT NUMERIC
              MOVE 0 TO OLD-ACCTNO
           ELSE
              MOVE OLE-OSACCTNO            TO OLD-ACCTNO.
           MOVE NEW-ACCTNO                 TO LE-OSACCTNO ALE-OSACCTNO.

           MOVE 0                          TO LE-LTOUCH-DATE
                                             ALE-LTOUCH-DATE.

      *-----------------------------------------------------------------
      *    LE-TYPE - "E" - LOAN ENDORSER RECORDS
      *-----------------------------------------------------------------
       UPGRADE-FILE-LE-E.

           IF ( OLE-TYPE NOT = "E" )
              GO TO UPGRADE-FILE-LE-R.

           IF OLE-OSRATE NOT NUMERIC
              MOVE 0                  TO LE-E-OSRATE ALE-E-OSRATE
           ELSE
              MOVE OLE-OSRATE         TO LE-E-OSRATE ALE-E-OSRATE.
           IF OLE-OSAMT NOT NUMERIC
              MOVE 0                  TO LE-E-OSAMT  ALE-E-OSAMT
           ELSE
              MOVE OLE-OSAMT          TO LE-E-OSAMT  ALE-E-OSAMT.

           IF OLE-OSDATE NOT NUMERIC
              MOVE 0               TO LE-E-OSDATE ALE-E-OSDATE
           ELSE
              MOVE OLE-OSDATE      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LE-E-OSDATE ALE-E-OSDATE.

           IF OLE-AMT NOT NUMERIC
              MOVE 0                  TO LE-E-AMT    ALE-E-AMT
           ELSE
              MOVE OLE-AMT            TO LE-E-AMT    ALE-E-AMT.

           IF OLE-DATE NOT NUMERIC
              MOVE 0                  TO LE-E-DATE ALE-E-DATE
           ELSE
              MOVE OLE-DATE              TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO LE-E-DATE ALE-E-DATE.

           MOVE OLE-OSMAKERCD         TO LE-E-OSMAKERCD ALE-E-OSMAKERCD.

      *-----------------------------------------------------------------
      *    LE-TYPE - "R" - RESTRICTED RECORDS
      *-----------------------------------------------------------------
       UPGRADE-FILE-LE-R.

           IF ( OLE-TYPE NOT = "R" )
              GO TO UPGRADE-FILE-LE-EXIT.

           MOVE OLE-LOANDATE          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO LE-R-LOANDATE ALE-R-LOANDATE.

           IF OLE-LNAMT NOT NUMERIC
              MOVE 0                  TO LE-R-LNAMT    ALE-R-LNAMT
           ELSE
              MOVE OLE-LNAMT          TO LE-R-LNAMT    ALE-R-LNAMT.

           MOVE OLE-POFFDATE          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO LE-R-POFFDATE ALE-R-POFFDATE.

           IF OLE-RESTRICTED-MONEY NOT NUMERIC
              MOVE 0                  TO LE-R-RESTRICTED-MONEY 
                                        ALE-R-RESTRICTED-MONEY
           ELSE
           MOVE OLE-RESTRICTED-MONEY  TO LE-R-RESTRICTED-MONEY
                                        ALE-R-RESTRICTED-MONEY.
           IF OLE-BALANCE NOT NUMERIC
              MOVE 0                  TO LE-R-BALANCE ALE-R-BALANCE
           ELSE
              MOVE OLE-BALANCE        TO LE-R-BALANCE ALE-R-BALANCE.
           MOVE OLE-SALEFIN           TO LE-R-SALEFIN ALE-R-SALEFIN.

       UPGRADE-FILE-LE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L N
      *
      ******************************************************************
       UPGRADE-FILE-LN SECTION.

           IF FILE-OPTION-LN = "A"
              PERFORM CLEAR-ALN-FILE
           ELSE
              PERFORM CLEAR-LN-FILE.

           IF OLN-OWNBR NOT NUMERIC
              MOVE 0                      TO LN-OWNBR    ALN-OWNBR
           ELSE
              MOVE OLN-OWNBR              TO LN-OWNBR    ALN-OWNBR.
           MOVE OLN-NUMBER                TO LN-ACCTNO   ALN-ACCTNO.
           IF OLN-CLASS NOT NUMERIC
              MOVE 0                      TO LN-CLASS    ALN-CLASS
           ELSE
              MOVE OLN-CLASS              TO LN-CLASS    ALN-CLASS.
           IF OLN-SUBCLASS NOT NUMERIC
             MOVE 0                     TO LN-SUBCLASS ALN-SUBCLASS
           ELSE
             MOVE OLN-SUBCLASS          TO LN-SUBCLASS ALN-SUBCLASS.
           IF OLN-LAWCODE NOT NUMERIC
             MOVE 0                     TO LN-LAWCODE  ALN-LAWCODE
           ELSE
             MOVE OLN-LAWCODE           TO LN-LAWCODE  ALN-LAWCODE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
              IF OLN-SSNO(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-SSNO   (SUB)
              ELSE
                 MOVE OLN-SSNO(SUB)       TO LN-SSNO   (SUB)
              END-IF
              MOVE OLN-MAKERCD(SUB)       TO LN-MAKERCD(SUB)
           END-PERFORM.

           IF OLN-SSNO(1) NOT NUMERIC
              MOVE 0           TO ALN-SSNO1
           ELSE
              MOVE OLN-SSNO(1) TO ALN-SSNO1.
           IF OLN-SSNO(2) NOT NUMERIC
              MOVE 0           TO ALN-SSNO2
           ELSE
              MOVE OLN-SSNO(2) TO ALN-SSNO2.
           IF OLN-SSNO(3) NOT NUMERIC
              MOVE 0           TO ALN-SSNO3
           ELSE
              MOVE OLN-SSNO(3) TO ALN-SSNO3.
           IF OLN-SSNO(4) NOT NUMERIC
              MOVE 0           TO ALN-SSNO4
           ELSE
              MOVE OLN-SSNO(4) TO ALN-SSNO4.
           MOVE OLN-MAKERCD(1) TO ALN-MAKERCD1.
           MOVE OLN-MAKERCD(2) TO ALN-MAKERCD2.
           MOVE OLN-MAKERCD(3) TO ALN-MAKERCD3.
           MOVE OLN-MAKERCD(4) TO ALN-MAKERCD4.

           MOVE OLN-ORGST          TO LN-ORGST     ALN-ORGST.
           IF OLN-ORGBR NOT NUMERIC
              MOVE 0               TO LN-ORGBR     ALN-ORGBR
           ELSE
              MOVE OLN-ORGBR       TO LN-ORGBR     ALN-ORGBR.
           MOVE OLN-OWNST          TO LN-OWNST     ALN-OWNST.
           IF OLN-SPRCLASS NOT NUMERIC
              MOVE 0               TO LN-SPRCLASS   ALN-SPRCLASS
           ELSE
              MOVE OLN-SPRCLASS    TO LN-SPRCLASS  ALN-SPRCLASS.
           MOVE OLN-CONVERCD       TO LN-CONVERCD  ALN-CONVERCD.
           MOVE OLN-MIDSTREAM      TO LN-MIDSTREAM ALN-MIDSTREAM.
           MOVE OLN-PURCD          TO LN-PURCD     ALN-PURCD.
           MOVE OLN-SRCD           TO LN-SRCD      ALN-SRCD.
           MOVE OLN-COLLCD         TO LN-COLLCD    ALN-COLLCD.
           MOVE OLN-COLLID         TO LN-COLLID    ALN-COLLID.
           MOVE OLN-POCD           TO LN-POCD      ALN-POCD.
           MOVE OLN-PLCD           TO LN-PLCD      ALN-PLCD.
           MOVE OLN-PLTYPE         TO LN-PLTYPE    ALN-PLTYPE.
           MOVE OLN-CONFIDENTCD    TO LN-CONFIDENTCD
                                     ALN-CONFIDENTCD.
           MOVE OLN-ALLOTCD        TO LN-ALLOTCD   ALN-ALLOTCD.
           MOVE OLN-RECASTCD       TO LN-RECASTCD  ALN-RECASTCD.
           MOVE OLN-SKIP-TRW       TO LN-SKIP-TRW  ALN-SKIP-TRW.
           MOVE OLN-STATUSFG       TO LN-STATUSFG  ALN-STATUSFG.
           MOVE OLN-SMALLOAN       TO LN-SMALLOAN  ALN-SMALLOAN.
           MOVE OLN-SALEFIN        TO LN-SALEFIN   ALN-SALEFIN.
           MOVE OLN-SERVACCT       TO LN-SERVACCT  ALN-SERVACCT.
           MOVE OLN-LOANTYPE       TO LN-LOANTYPE  ALN-LOANTYPE.
           MOVE OLN-ADDON-FG       TO LN-ADDON-FG  ALN-ADDON-FG.
           MOVE OLN-PAY-SCHLD-FG   TO LN-PAY-SCHLD-FG ALN-PAY-SCHLD-FG.
           IF OLN-LC-CODE NOT NUMERIC
              MOVE 0               TO LN-LC-CODE   ALN-LC-CODE
           ELSE
              MOVE OLN-LC-CODE     TO LN-LC-CODE   ALN-LC-CODE.
           MOVE OLN-CAN-LOAN-NO    TO LN-CAN-LOAN-NO  ALN-CAN-LOAN-NO.
           MOVE OLN-STATFLAGS      TO LN-STATFLAGS ALN-STATFLAGS.

           MOVE OLN-ENTDATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-ENTDATE   ALN-ENTDATE.

           MOVE OLN-LOANDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-LOANDATE  ALN-LOANDATE.

           MOVE OLN-PURDATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-PURDATE   ALN-PURDATE.

           MOVE OLN-INTDATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-INTDATE   ALN-INTDATE.

           MOVE OLN-CASHDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-CASHDATE  ALN-CASHDATE.

           MOVE OLN-FILEDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.

           IF OLN-RESCISSION = "Y"
              MOVE DATE-YYYYMMDD   TO LN-RESCISSION-DATE 
                                     ALN-RESCISSION-DATE
           ELSE
              MOVE DATE-YYYYMMDD   TO LN-FILEDATE  ALN-FILEDATE.

      * BR 18 4606-01 202020
           IF OLN-ORIG-1STPAY NOT NUMERIC OR 
               OLN-ORIG-1STPAY = 0
              MOVE LN-LOANDATE TO LN-ORIG-1STPYDATE
                                 ALN-ORIG-1STPYDATE
           ELSE
              MOVE OLN-ORIG-1STPAY    TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO LN-ORIG-1STPYDATE
                                        ALN-ORIG-1STPYDATE.

      * BR 562 1988, BR 566 291 AND 360
           IF OLN-1STPYDATE NOT NUMERIC OR 
               OLN-1STPYDATE = 0
              MOVE LN-LOANDATE       TO LN-1STPYDATE ALN-1STPYDATE
           ELSE
              MOVE OLN-1STPYDATE   TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LN-1STPYDATE ALN-1STPYDATE.

           MOVE OLN-JDDATE         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-JDDATE    ALN-JDDATE.

           MOVE OLN-PLDATE         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-PLDATE    ALN-PLDATE.

           MOVE OLN-ACCELDATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-ACCELDATE ALN-ACCELDATE.

           MOVE OLN-REDUDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-REDUDATE  ALN-REDUDATE.

           MOVE OLN-POFFDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-POFFDATE  ALN-POFFDATE.

           MOVE OLN-LEGALDATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-LEGALDATE ALN-LEGALDATE.

           MOVE OLN-BNKRPTDATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LN-BNKRPTDATE ALN-BNKRPTDATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    A15: OLN-BNKRPT-DISMISSAL IS A REDEFINE OF OLN-CYCLE-DATE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

            IF OLN-BNKRPT-DISMISSAL NUMERIC
               IF OLN-BNKRPT-DISMISSAL NOT = 202020
                                   AND NOT = SPACES
                  MOVE OLN-BNKRPT-DISMISSAL TO DATE-MMDDYY
                  PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                  PERFORM TEST-INVALID-DATE
                  MOVE DATE-YYYYMMDD TO LN-BNKRPT-DISMISS-DATE
                                       ALN-BNKRPT-DISMISS-DATE.
                
           MOVE OLN-DEBTAIDATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO LN-DEBTAIDATE ALN-DEBTAIDATE.

           MOVE OLN-REPODATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO LN-REPODATE   ALN-REPODATE.

           MOVE OLN-REDEEMDATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO LN-REDEEMDATE ALN-REDEEMDATE.

           MOVE OLN-SOLDDATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO LN-SOLDDATE   ALN-SOLDDATE.

           MOVE OLN-INS-CONFIRMATION      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD     TO LN-INS-CONFIRM-DATE 
                                    ALN-INS-CONFIRM-DATE.

           IF OLN-PRIOR-RN-FOR10 NOT NUMERIC
              MOVE 0 TO LN-PRIOR-RN-FOR10-DATE
                       ALN-PRIOR-RN-FOR10-DATE
           ELSE
              MOVE OLN-PRIOR-RN-FOR10      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO LN-PRIOR-RN-FOR10-DATE
                                       ALN-PRIOR-RN-FOR10-DATE.

           IF OLN-LAST-RN-FOR10 NOT NUMERIC
              MOVE 0 TO LN-LAST-RN-FOR10-DATE
                       ALN-LAST-RN-FOR10-DATE
           ELSE
              MOVE OLN-LAST-RN-FOR10   TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LN-LAST-RN-FOR10-DATE
                                         ALN-LAST-RN-FOR10-DATE.

      * BR 436 ACCT 5546, 5587, 5654 = 220202 ?
           IF OLN-TRW-DOFD NOT NUMERIC OR
                 (OLN-TRW-DOFD = 202020 OR 220202)
              MOVE 0 TO LN-TRW-DOFD-DATE
                       ALN-TRW-DOFD-DATE
           ELSE
              MOVE OLN-TRW-DOFD        TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LN-TRW-DOFD-DATE
                                         ALN-TRW-DOFD-DATE.

           IF OLN-LAST-PYPA-DATE NOT NUMERIC
              MOVE 0 TO LN-LAST-PYPA-DATE ALN-LAST-PYPA-DATE
           ELSE
              MOVE OLN-LAST-PYPA-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LN-LAST-PYPA-DATE
                                         ALN-LAST-PYPA-DATE.

           IF OLN-FOLLOWUP-DATE NOT NUMERIC
              MOVE 0                TO LN-FOLLOWUP-DATE
                                      ALN-FOLLOWUP-DATE
           ELSE
              MOVE OLN-FOLLOWUP-DATE   TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD    TO LN-FOLLOWUP-DATE
                                      ALN-FOLLOWUP-DATE.

      * BR 718 ACCT 2129, 2135, 2138  DATE = 105376
           IF OLN-LAST-ACCRUAL-DATE = 105376 
              MOVE 0                TO LN-LAST-ACCRUAL-DATE
                                      ALN-LAST-ACCRUAL-DATE
           ELSE
              MOVE OLN-LAST-ACCRUAL-DATE  TO DATE-MMDDYY
              IF DATE-MMDDYY-DD > 31
                 MOVE 0                TO LN-LAST-ACCRUAL-DATE
                                         ALN-LAST-ACCRUAL-DATE
              ELSE
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD    TO LN-LAST-ACCRUAL-DATE
                                      ALN-LAST-ACCRUAL-DATE.
              
      * CLEANSE BR 125 1007-01 ?<?.=, BR 1735 
           IF OLN-APRATE NOT NUMERIC
              IF OLN-EFFRATE NUMERIC
                 MOVE OLN-EFFRATE    TO LN-APRATE ALN-APRATE
              ELSE
                 MOVE 0              TO LN-APRATE ALN-APRATE
           ELSE
              MOVE OLN-APRATE        TO LN-APRATE ALN-APRATE.

           IF OLN-EFFRATE NOT NUMERIC
              MOVE 0           TO LN-EFFRATE   ALN-EFFRATE
           ELSE
              MOVE OLN-EFFRATE TO LN-EFFRATE   ALN-EFFRATE.
           IF OLN-SMPRATE NOT NUMERIC
              MOVE 0           TO LN-SMPRATE   ALN-SMPRATE
           ELSE
              MOVE OLN-SMPRATE TO LN-SMPRATE   ALN-SMPRATE.
           IF OLN-YLDRATE NOT NUMERIC
              MOVE 0           TO LN-YLDRATE   ALN-YLDRATE
           ELSE
              MOVE OLN-YLDRATE TO LN-YLDRATE   ALN-YLDRATE.
           IF OLN-OVRDRATE NOT NUMERIC
              MOVE 0            TO LN-OVRDRATE  ALN-OVRDRATE
           ELSE
              MOVE OLN-OVRDRATE TO LN-OVRDRATE  ALN-OVRDRATE.
           IF OLN-ENDORATE NOT NUMERIC
              MOVE 0            TO LN-ENDORATE  ALN-ENDORATE
           ELSE
              MOVE OLN-ENDORATE TO LN-ENDORATE  ALN-ENDORATE.
           IF OLN-JDRATE NOT NUMERIC
              MOVE 0           TO LN-JDRATE    ALN-JDRATE
           ELSE
              MOVE OLN-JDRATE  TO LN-JDRATE    ALN-JDRATE.
           IF OLN-ACCRATE NOT NUMERIC
              MOVE 0           TO LN-ACCRATE   ALN-ACCRATE
           ELSE
              MOVE OLN-ACCRATE TO LN-ACCRATE   ALN-ACCRATE.
           IF OLN-REDURATE NOT NUMERIC
              MOVE 0            TO LN-REDURATE  ALN-REDURATE
           ELSE
              MOVE OLN-REDURATE TO LN-REDURATE  ALN-REDURATE.
      * 23 136-01
           IF OLN-CONRATE NOT NUMERIC
              MOVE 0           TO LN-CONRATE ALN-CONRATE
           ELSE
              MOVE OLN-CONRATE TO LN-CONRATE   ALN-CONRATE.
           IF OLN-SERVPER NOT NUMERIC
              MOVE 0           TO LN-SERVPER   ALN-SERVPER
           ELSE
              MOVE OLN-SERVPER TO LN-SERVPER   ALN-SERVPER.
           IF OLN-SELLPR NOT NUMERIC
              MOVE 0           TO LN-SELLPR    ALN-SELLPR
           ELSE
              MOVE OLN-SELLPR  TO LN-SELLPR    ALN-SELLPR.
           IF OLN-DOWNPY NOT NUMERIC
              MOVE 0           TO LN-DOWNPY    ALN-DOWNPY
           ELSE
              MOVE OLN-DOWNPY  TO LN-DOWNPY    ALN-DOWNPY.
           IF OLN-TRADEIN NOT NUMERIC
              MOVE 0           TO LN-TRADEIN   ALN-TRADEIN
           ELSE
              MOVE OLN-TRADEIN TO LN-TRADEIN   ALN-TRADEIN.
           IF OLN-LNAMT NOT NUMERIC
              MOVE 0           TO LN-LNAMT   ALN-LNAMT
           ELSE
              MOVE OLN-LNAMT   TO LN-LNAMT   ALN-LNAMT.
           IF OLN-FINCHG NOT NUMERIC
              MOVE 0           TO LN-FINCHG    ALN-FINCHG
           ELSE
              MOVE OLN-FINCHG  TO LN-FINCHG    ALN-FINCHG.
           IF OLN-INTCHG NOT NUMERIC
              MOVE 0           TO LN-INTCHG    ALN-INTCHG
           ELSE
              MOVE OLN-INTCHG  TO LN-INTCHG    ALN-INTCHG.
           IF OLN-SERCHG NOT NUMERIC
              MOVE 0           TO LN-SERCHG    ALN-SERCHG
           ELSE
              MOVE OLN-SERCHG  TO LN-SERCHG    ALN-SERCHG.
           IF OLN-EXTCHG NOT NUMERIC
              MOVE 0           TO LN-EXTCHG    ALN-EXTCHG
           ELSE
              MOVE OLN-EXTCHG  TO LN-EXTCHG    ALN-EXTCHG.
           IF OLN-MAINTFEE NOT NUMERIC
              MOVE 0            TO LN-MAINTFEE  ALN-MAINTFEE
           ELSE
              MOVE OLN-MAINTFEE TO LN-MAINTFEE  ALN-MAINTFEE.
           IF OLN-POINTS NOT NUMERIC
              MOVE 0           TO LN-POINTS    ALN-POINTS
           ELSE
              MOVE OLN-POINTS  TO LN-POINTS    ALN-POINTS.
           IF OLN-PROCEEDS NOT NUMERIC
              MOVE 0            TO LN-PROCEEDS  ALN-PROCEEDS
           ELSE
              MOVE OLN-PROCEEDS TO LN-PROCEEDS  ALN-PROCEEDS.
           IF OLN-ORGTERM NOT NUMERIC
              MOVE 0            TO LN-ORGTERM  ALN-ORGTERM
           ELSE
              MOVE OLN-ORGTERM  TO LN-ORGTERM   ALN-ORGTERM.
           IF OLN-1STPYAMT NOT NUMERIC
              MOVE 0            TO LN-1STPYAMT  ALN-1STPYAMT
           ELSE
              MOVE OLN-1STPYAMT TO LN-1STPYAMT  ALN-1STPYAMT.
           IF OLN-NOREGPY NOT NUMERIC
              MOVE 0            TO LN-NOREGPY   ALN-NOREGPY
           ELSE
              MOVE OLN-NOREGPY  TO LN-NOREGPY   ALN-NOREGPY.
           IF OLN-REGPYAMT NOT NUMERIC
              MOVE 0            TO LN-REGPYAMT  ALN-REGPYAMT
           ELSE
              MOVE OLN-REGPYAMT TO LN-REGPYAMT  ALN-REGPYAMT.

           IF OLN-LASTPYAMT NOT NUMERIC
              MOVE 0             TO LN-LASTPYAMT ALN-LASTPYAMT
           ELSE
              MOVE OLN-LASTPYAMT TO LN-LASTPYAMT ALN-LASTPYAMT.
           IF OLN-PROCASH NOT NUMERIC
              MOVE 0             TO LN-PROCASH   ALN-PROCASH
           ELSE
              MOVE OLN-PROCASH   TO LN-PROCASH   ALN-PROCASH.

           IF OLN-TILLNO = "1"
              MOVE 1  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "2"
              MOVE 2  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "3"
              MOVE 3  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "4"
              MOVE 4  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "5"
              MOVE 5  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "6"
              MOVE 6  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "7"
              MOVE 7  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "8"
              MOVE 8  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "9"
              MOVE 9  TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "A"
              MOVE 10 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "B"
              MOVE 11 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "C"
              MOVE 12 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "D"
              MOVE 13 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "E"
              MOVE 14 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "F"
              MOVE 15 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "G"
              MOVE 16 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "H"
              MOVE 17 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "I"
              MOVE 18 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "J"
              MOVE 19 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "K"
              MOVE 20 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "L"
              MOVE 21 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "M"
              MOVE 22 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "N"
              MOVE 23 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "O"
              MOVE 24 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "P"
              MOVE 25 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "Q"
              MOVE 26 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "R"
              MOVE 27 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "S"
              MOVE 28 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "T"
              MOVE 29 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "U"
              MOVE 30 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "V"
              MOVE 31 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "W"
              MOVE 32 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "X"
              MOVE 33 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "Y"
              MOVE 34 TO LN-TILLNO ALN-TILLNO
           ELSE
           IF OLN-TILLNO = "Z"
              MOVE 35 TO LN-TILLNO ALN-TILLNO.

           MOVE OLN-STATE-FLAG            TO LN-STATE-FLAG
                                            ALN-STATE-FLAG.
           IF OLN-STATE-WORKER NOT NUMERIC
              MOVE 0                      TO LN-STATE-WORKER
                                            ALN-STATE-WORKER
           ELSE
              MOVE OLN-STATE-WORKER       TO LN-STATE-WORKER
                                            ALN-STATE-WORKER.
           IF OLN-STATE-WORKER2 NOT NUMERIC
              MOVE 0                      TO LN-STATE-WORKER2
                                            ALN-STATE-WORKER2
           ELSE
              MOVE OLN-STATE-WORKER2      TO LN-STATE-WORKER2
                                            ALN-STATE-WORKER2.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              MOVE OLN-FEECODE  (SUB)     TO LN-FEECODE  (SUB)
                                            ALN-FEECODE  (SUB)
      * CLEANSE BR 1429 ACCT 40665 FEEAMT =17.00
              IF OLN-FEEAMT(SUB) NOT NUMERIC
                 MOVE 1.00                TO LN-FEEAMT   (SUB)
                                            ALN-FEEAMT   (SUB)
              ELSE
                 MOVE OLN-FEEAMT(SUB)     TO LN-FEEAMT   (SUB)
                                            ALN-FEEAMT   (SUB)
              END-IF
              MOVE OLN-FEEOURS  (SUB)     TO LN-FEEOURS  (SUB)
                                            ALN-FEEOURS  (SUB)
              MOVE OLN-FEEFINCHG(SUB)     TO LN-FEEFINCHG(SUB)
                                            ALN-FEEFINCHG(SUB)
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLN-INSURED       TO LN-INSURED  ALN-INSURED.
           MOVE OLN-INSTYPES      TO LN-INSTYPES ALN-INSTYPES.
           MOVE OLN-INSELIGIBLE   TO LN-INSELIGIBLE
                                    ALN-INSELIGIBLE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 8
              IF OLN-INSCOMP(SUB) NOT NUMERIC
                 MOVE 0                TO LN-INSCOMP(SUB)
                                         ALN-INSCOMP(SUB)
              ELSE
                 MOVE OLN-INSCOMP(SUB) TO LN-INSCOMP(SUB)
                                         ALN-INSCOMP(SUB)
              END-IF

              MOVE OLN-INSOURS(SUB)    TO LN-INSOURS(SUB)
                                         ALN-INSOURS(SUB)
              IF OLN-INSEFF(SUB) NOT NUMERIC
                 MOVE 0                TO LN-INSEFF-DATE(SUB)
                                         ALN-INSEFF-DATE(SUB)
              ELSE
                 MOVE OLN-INSEFF(SUB)  TO LN-INSEFF-DATE(SUB)
                                         ALN-INSEFF-DATE(SUB)
              END-IF

              IF OLN-INSEFF(SUB) > 900
                 MOVE OLN-INSEFF(SUB) TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD TO LN-INSEFF-DATE(SUB)
                                      ALN-INSEFF-DATE(SUB)
              END-IF

              MOVE OLN-INSEXP(SUB) TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD    TO LN-INSEXP-DATE(SUB)
                                      ALN-INSEXP-DATE(SUB)
      * CLEANSE KY1437 630 HAD =140.54, 977 HAD =2.21
              IF OLN-INSPREM(SUB) NOT NUMERIC
                 MOVE 1.00                TO LN-INSPREM      (SUB)
                                            ALN-INSPREM      (SUB)
              ELSE
                 MOVE OLN-INSPREM   (SUB) TO LN-INSPREM      (SUB)
                                            ALN-INSPREM      (SUB)
              END-IF

      * CLEANSE GA0034 39680 HAD ?462.00  LN-INSCOVR
              IF OLN-INSCOVR(SUB) NOT NUMERIC
                 MOVE OLN-LNAMT           TO LN-INSCOVR      (SUB)
                                            ALN-INSCOVR      (SUB)
              ELSE
                 MOVE OLN-INSCOVR   (SUB) TO LN-INSCOVR      (SUB)
                                             ALN-INSCOVR     (SUB)
              END-IF

              IF OLN-INSCOMM(SUB) NOT NUMERIC
                 MOVE OLN-LNAMT           TO LN-INSCOMM      (SUB)
                                            ALN-INSCOMM      (SUB)
              ELSE
                 MOVE OLN-INSCOMM(SUB)    TO LN-INSCOMM      (SUB)
                                            ALN-INSCOMM      (SUB)
              END-IF
      * BR 1518 094316
              IF OLN-INSANTICERN(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-INSANTICERN  (SUB)
                                            ALN-INSANTICERN  (SUB)
              ELSE
                 MOVE OLN-INSANTICERN(SUB) TO LN-INSANTICERN (SUB)
                                             ALN-INSANTICERN (SUB)
              END-IF
              IF OLN-INSANTICADJ(SUB) NOT NUMERIC
                 MOVE 0                    TO LN-INSANTICADJ (SUB)
                                             ALN-INSANTICADJ (SUB)
              ELSE
                 MOVE OLN-INSANTICADJ(SUB) TO LN-INSANTICADJ (SUB)
                                             ALN-INSANTICADJ (SUB)
              END-IF
              IF OLN-INSUFERN(SUB) NOT NUMERIC
                 MOVE 0                    TO LN-INSUFERN    (SUB)
                                             ALN-INSUFERN    (SUB)
              ELSE
                 MOVE OLN-INSUFERN(SUB)    TO LN-INSUFERN    (SUB)
                                             ALN-INSUFERN    (SUB)
              END-IF
              IF OLN-INSACCERN(SUB) NOT NUMERIC
                 MOVE 0                    TO LN-INSACCERN   (SUB)
                                             ALN-INSACCERN   (SUB)
              ELSE
                 MOVE OLN-INSACCERN(SUB)   TO LN-INSACCERN   (SUB)
                                             ALN-INSACCERN   (SUB)
              END-IF
              IF OLN-INSEARN-ORDER(SUB) NOT NUMERIC
                 MOVE 0                    TO LN-INSEARN-ORDER(SUB)
                                             ALN-INSEARN-ORDER(SUB)
              ELSE
                 MOVE OLN-INSEARN-ORDER(SUB) TO LN-INSEARN-ORDER(SUB)
                                               ALN-INSEARN-ORDER(SUB)
              END-IF
              MOVE OLN-INSFINCHG(SUB)     TO LN-INSFINCHG (SUB)
                                            ALN-INSFINCHG (SUB)
           END-PERFORM.

      * CLEANSE SOME INSEFF AND INSEXP 839 #6385
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 8
              IF LN-INSPREM(SUB) NOT = 0
                 IF OLN-INSEFF(SUB) = 0 AND OLN-INSEXP(SUB) NOT = 0
                    MOVE LN-LOANDATE TO LN-INSEFF-DATE(SUB)
                                       ALN-INSEFF-DATE(SUB)
                                        LN-INSEXP-DATE(SUB)
                                       ALN-INSEXP-DATE(SUB)
                 END-IF
              END-IF
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * THIS WILL MOVE THE MMYY FROM THE OLD TO THE NEW UNTIL WE CHANGE
      * THE WAY IT WORKS IN A30.
           MOVE OLN-PYMMYY-RECDEL         TO DATE-MMYY.
           PERFORM CONVERT-MMYY-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMM.
           MOVE DATE-YYYYMM               TO LN-PY-YYYYMM-RECDEL
                                            ALN-PY-YYYYMM-RECDEL.
           MOVE OLN-MTD-PAYS-RECDEL       TO LN-MTD-PAYS-RECDEL
                                            ALN-MTD-PAYS-RECDEL.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OLN-GARNISH-EXTR IS A REDEFINE OF OLN-GIFTNET-EXTR
      *          IN A15.  LN-GIFTNET-EXTR WAS REMOVED IN A30.
      *          LN-GARNISH-EXTR IS USED FOR MODERN FINANCE.
      *          2017-0609, BETH & JAY DISCUSSED AND MOVING 
      *          OLN-GARNISH-EXTR TO LN-GARNISH-EXTR JUST IN CASE
      *          EVENTHOUGH MAY NEVER BE USED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLN-GARNISH-EXTR  TO LN-GARNISH-EXTR ALN-GARNISH-EXTR.

           MOVE OLN-SHIP-SAME-FG          TO LN-SHIP-SAME-FG
                                            ALN-SHIP-SAME-FG.
           IF OLN-AD-D-INS-COVR NOT NUMERIC
              MOVE 0                      TO LN-AD-D-INS-COVR
                                            ALN-AD-D-INS-COVR
           ELSE
              MOVE OLN-AD-D-INS-COVR      TO LN-AD-D-INS-COVR
                                            ALN-AD-D-INS-COVR.
      * 15 69693-01
           IF OLN-TOT-PARTIAL-CHGOFF NOT NUMERIC
              MOVE 0 TO LN-TOT-PARTIAL-CHGOFF ALN-TOT-PARTIAL-CHGOFF
           ELSE
              MOVE OLN-TOT-PARTIAL-CHGOFF TO LN-TOT-PARTIAL-CHGOFF
                                            ALN-TOT-PARTIAL-CHGOFF.

           MOVE OLN-LPO                   TO LN-LPO ALN-LPO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OLN-EMP-ID IS A REDEFINES OF OLN-REP-CD IN A15.
      *          LN-EMP-ID WAS SEPERATED FROM LN-REP-CD IN A30.
      *          LN-EMP-ID IS POPULATED FROM OLN-EMP-ID IF WORLD.
      *          LN-REP-CD IS POPULATED FROM OLN-REP-CD NOT WORLD.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * CLEANSE - FOUND TONS OF RECORDS WITH 00020202 
           IF OLN-EMP-ID NUMERIC AND OLN-EMP-ID = 00020202
              MOVE 0                  TO LN-EMP-ID ALN-EMP-ID
           ELSE
              IF OLN-EMP-ID NUMERIC 
                 MOVE OLN-EMP-ID      TO LN-EMP-ID ALN-EMP-ID
              ELSE
                 MOVE OLN-REP-CD      TO LN-REP-CD ALN-REP-CD.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLN-PROCESS-CD        TO LN-PROCESS-CD  ALN-PROCESS-CD.
      * BR 23 ACCT 136
           IF OLN-WCBC-CREDITLIM NOT NUMERIC
              MOVE 0                  TO LN-WCBC-CREDITLIM
                                        ALN-WCBC-CREDITLIM
           ELSE
              MOVE OLN-WCBC-CREDITLIM TO LN-WCBC-CREDITLIM
                                        ALN-WCBC-CREDITLIM.
           MOVE OLN-FOLLOWUP-CD       TO LN-FOLLOWUP-CD ALN-FOLLOWUP-CD.
           MOVE OLN-MIP-FG            TO LN-MIP-FG      ALN-MIP-FG.
      * 23 136
           IF OLN-MIP-MTD-CLAHPAID NOT NUMERIC
              MOVE 0 TO LN-MIP-MTD-CLAHPAID ALN-MIP-MTD-CLAHPAID
           ELSE
              MOVE OLN-MIP-MTD-CLAHPAID  TO LN-MIP-MTD-CLAHPAID
                                           ALN-MIP-MTD-CLAHPAID.

           MOVE OLN-MIP-CLPDTH            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LN-MIP-CLPDTH-DATE
                                            ALN-MIP-CLPDTH-DATE.

      * 142 302872-01
           IF OLN-MIP-TOT-CLPAID NOT NUMERIC
              MOVE 0 TO LN-MIP-TOT-CLPAID ALN-MIP-TOT-CLPAID
           ELSE
              MOVE OLN-MIP-TOT-CLPAID     TO LN-MIP-TOT-CLPAID
                                            ALN-MIP-TOT-CLPAID.

           MOVE OLN-MIP-AHPDTH            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LN-MIP-AHPDTH-DATE
                                            ALN-MIP-AHPDTH-DATE.

      * 142 302872-01
           IF OLN-MIP-TOT-AHPAID NOT NUMERIC
              MOVE 0 TO LN-MIP-TOT-AHPAID ALN-MIP-TOT-AHPAID
           ELSE
              MOVE OLN-MIP-TOT-AHPAID     TO LN-MIP-TOT-AHPAID
                                            ALN-MIP-TOT-AHPAID.
           IF OLN-IL-GROSS-INCOME NOT NUMERIC
              MOVE 0                      TO LN-IL-GROSS-INCOME
                                            ALN-IL-GROSS-INCOME
           ELSE
              MOVE OLN-IL-GROSS-INCOME    TO LN-IL-GROSS-INCOME
                                            ALN-IL-GROSS-INCOME.
           IF OLN-IL-GROSS-INCOME2 NOT NUMERIC
              MOVE 0                      TO LN-IL-GROSS-INCOME2
                                            ALN-IL-GROSS-INCOME2
           ELSE
              MOVE OLN-IL-GROSS-INCOME2   TO LN-IL-GROSS-INCOME2
                                            ALN-IL-GROSS-INCOME2.
           MOVE OLN-RESCISSION            TO LN-RESCISSION
                                            ALN-RESCISSION.
           MOVE OLN-INTERIM-TRW           TO LN-INTERIM-TRW
                                            ALN-INTERIM-TRW.
           IF OLN-DLNO NOT NUMERIC
              MOVE 0              TO LN-DLNO ALN-DLNO
           ELSE
              MOVE OLN-DLNO       TO LN-DLNO ALN-DLNO.
      * CLEANSE 800 #22073 ;2000
           IF OLN-DLPOOL NOT NUMERIC
              MOVE 0              TO LN-DLPOOL ALN-DLPOOL
           ELSE
              MOVE OLN-DLPOOL     TO LN-DLPOOL ALN-DLPOOL.
           MOVE OLN-DLRECOURSE    TO LN-DLRECOURSE  ALN-DLRECOURSE.
           IF OLN-DLPARTRCAMT NOT NUMERIC
               MOVE 0             TO LN-DLPARTRCAMT
                                    ALN-DLPARTRCAMT
           ELSE
              MOVE OLN-DLPARTRCAMT TO LN-DLPARTRCAMT
                                     ALN-DLPARTRCAMT.
           IF OLN-ORIGPURAMT NOT NUMERIC
               MOVE 0            TO LN-ORIGPURAMT  ALN-ORIGPURAMT
           ELSE
             MOVE OLN-ORIGPURAMT TO LN-ORIGPURAMT  ALN-ORIGPURAMT.
           IF OLN-PURBAL NOT NUMERIC
               MOVE 0            TO LN-PURBAL  ALN-PURBAL
           ELSE
              MOVE OLN-PURBAL    TO LN-PURBAL  ALN-PURBAL.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
               IF OLN-DLRVPRIN(SUB) NOT NUMERIC
                  MOVE 0 TO LN-DLRVPRIN(SUB) ALN-DLRVPRIN(SUB)
               ELSE
                  MOVE OLN-DLRVPRIN(SUB) TO LN-DLRVPRIN(SUB)
                                           ALN-DLRVPRIN(SUB)
               END-IF
               IF OLN-DLRVCHGS(SUB) NOT NUMERIC
                  MOVE 0 TO LN-DLRVCHGS(SUB) ALN-DLRVCHGS(SUB)
               ELSE
                  MOVE OLN-DLRVCHGS(SUB) TO LN-DLRVCHGS(SUB)
                                           ALN-DLRVCHGS(SUB)
               END-IF
           END-PERFORM.
         
           IF OLN-DLPARVHELD NOT NUMERIC
              MOVE 0              TO LN-DLPARVHELD ALN-DLPARVHELD
           ELSE
              MOVE OLN-DLPARVHELD TO LN-DLPARVHELD ALN-DLPARVHELD.
           IF OLN-DLPARVPAID NOT NUMERIC
              MOVE 0              TO LN-DLPARVPAID ALN-DLPARVPAID
           ELSE
              MOVE OLN-DLPARVPAID TO LN-DLPARVPAID ALN-DLPARVPAID.
           IF OLN-DLDISC NOT NUMERIC
              MOVE 0              TO LN-DLDISC ALN-DLDISC
           ELSE
              MOVE OLN-DLDISC     TO LN-DLDISC ALN-DLDISC.

           MOVE OLN-LCPDTH       TO DATE-MMDDYY.
      * CLEANSE, THERE ARE OLD PAIDOUTS FROM NORWEST WITH 00/DD/00 
      *           BR14 32807, 32977, 33154
      * IF MONTH AND YEAR ARE BOTH 0, AND ITS PAID OUT, JUST SET
      * THE LCPDTH TO PAIDOUT DATE AND MOVE ON.
           IF (DATE-MMDDYY-MM = 0) AND (DATE-MMDDYY-YY = 0) AND
               (OLN-POFFDATE NOT = 0)
              MOVE OLN-POFFDATE TO OLN-LCPDTH DATE-MMDDYY.
           IF (DATE-MMDDYY-MM = 0) AND (DATE-MMDDYY-YY = 0) 
              MOVE OLN-LOANDATE TO OLN-LCPDTH DATE-MMDDYY.

           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LN-LCPDTH-DATE ALN-LCPDTH-DATE.

      * LN-INTPDTH-DATE
           PERFORM TEST-INTPDTH-DATE.

           IF OLN-CURBAL NOT NUMERIC
              MOVE 0                   TO LN-CURBAL     ALN-CURBAL
           ELSE
              MOVE OLN-CURBAL          TO LN-CURBAL     ALN-CURBAL.
           IF OLN-INTBAL NOT NUMERIC
              MOVE 0                   TO LN-INTBAL     ALN-INTBAL
           ELSE
              MOVE OLN-INTBAL          TO LN-INTBAL     ALN-INTBAL.
           IF OLN-LCBAL NOT NUMERIC
              MOVE 0                   TO LN-LCBAL      ALN-LCBAL
           ELSE
              MOVE OLN-LCBAL           TO LN-LCBAL      ALN-LCBAL.
           IF OLN-OTHBAL NOT NUMERIC
              MOVE 0                   TO LN-OTHBAL     ALN-OTHBAL
           ELSE
              MOVE OLN-OTHBAL          TO LN-OTHBAL     ALN-OTHBAL.
           IF OLN-OT2BAL NOT NUMERIC
              MOVE 0                   TO LN-OT2BAL     ALN-OT2BAL
           ELSE
              MOVE OLN-OT2BAL          TO LN-OT2BAL     ALN-OT2BAL.
           IF OLN-LCPAID NOT NUMERIC
              MOVE 0                   TO LN-LCPAID     ALN-LCPAID
           ELSE
              MOVE OLN-LCPAID          TO LN-LCPAID     ALN-LCPAID.
           IF OLN-LCPARTIALS NOT NUMERIC
              MOVE 0                   TO LN-LCPARTIALS
                                         ALN-LCPARTIALS
           ELSE
              MOVE OLN-LCPARTIALS      TO LN-LCPARTIALS
                                         ALN-LCPARTIALS.
           IF OLN-STMT-COUNTER NOT NUMERIC
              MOVE 0                   TO LN-STMT-COUNTER
                                         ALN-STMT-COUNTER
           ELSE
              MOVE OLN-STMT-COUNTER    TO LN-STMT-COUNTER
                                         ALN-STMT-COUNTER.
      * 23 136-01
           IF OLN-PRIOR-STMT-COUNTER NOT NUMERIC
              MOVE 0                      TO LN-PRIOR-STMT-COUNTER
                                            ALN-PRIOR-STMT-COUNTER
           ELSE
              MOVE OLN-PRIOR-STMT-COUNTER TO LN-PRIOR-STMT-COUNTER
                                            ALN-PRIOR-STMT-COUNTER.
           IF OLN-FROZEN-REASON1 = X"00"
              MOVE SPACES            TO LN-FROZEN-REASON
                                       ALN-FROZEN-REASON
           ELSE
              MOVE OLN-FROZEN-REASON TO LN-FROZEN-REASON
                                       ALN-FROZEN-REASON.

      * CLEANSE, SOME ACCOUNTS HAD ^@ DISPLAYING, CONVERSION ACCOUNTS
           IF OLN-COUPON-STATEMENT NOT = " " AND
                                    NOT = "C" AND
                                     NOT = "S" AND
                                      NOT = "E"
              MOVE " "                    TO LN-COUPON-STATEMENT
                                            ALN-COUPON-STATEMENT
           ELSE
              MOVE OLN-COUPON-STATEMENT   TO LN-COUPON-STATEMENT
                                            ALN-COUPON-STATEMENT.

           IF OLN-MONTHEND-BAL NOT NUMERIC
              MOVE 0                      TO LN-MONTHEND-BAL
                                            ALN-MONTHEND-BAL
           ELSE
              MOVE OLN-MONTHEND-BAL       TO LN-MONTHEND-BAL
                                            ALN-MONTHEND-BAL.
           IF OLN-ANTICTERM NOT NUMERIC
              MOVE 0                      TO LN-ANTICTERM
                                            ALN-ANTICTERM
           ELSE
              MOVE OLN-ANTICTERM          TO LN-ANTICTERM
                                            ALN-ANTICTERM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
              IF OLN-ANTICERN(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-ANTICERN  (SUB)
                                            ALN-ANTICERN  (SUB)
              ELSE
                 MOVE OLN-ANTICERN(SUB)   TO LN-ANTICERN  (SUB)
                                            ALN-ANTICERN  (SUB)
              END-IF
              IF OLN-ANTICADJ(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-ANTICADJ  (SUB)
                                            ALN-ANTICADJ  (SUB)
              ELSE
                 MOVE OLN-ANTICADJ(SUB)   TO LN-ANTICADJ  (SUB)
                                            ALN-ANTICADJ  (SUB)
              END-IF
              IF OLN-UFERN(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-UFERN  (SUB)
                                            ALN-UFERN  (SUB)
              ELSE
                 MOVE OLN-UFERN(SUB)      TO LN-UFERN  (SUB)
                                            ALN-UFERN  (SUB)
              END-IF
              IF OLN-ACCERN(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-ACCERN  (SUB)
                                            ALN-ACCERN  (SUB)
              ELSE
                 MOVE OLN-ACCERN(SUB)     TO LN-ACCERN    (SUB)
                                            ALN-ACCERN    (SUB)
              END-IF
              IF OLN-EARN-ORDER(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-EARN-ORDER  (SUB)
                                            ALN-EARN-ORDER  (SUB)
              ELSE
                 MOVE OLN-EARN-ORDER(SUB) TO LN-EARN-ORDER(SUB)
                                            ALN-EARN-ORDER(SUB)
              END-IF
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF OLN-LMO-PRIOR-INTEREST NOT NUMERIC
              MOVE 0                      TO LN-LMO-PRIOR-INTEREST
                                            ALN-LMO-PRIOR-INTEREST
           ELSE
              MOVE OLN-LMO-PRIOR-INTEREST TO LN-LMO-PRIOR-INTEREST
                                            ALN-LMO-PRIOR-INTEREST.
           IF OLN-PRIOR-UNEARNED NOT NUMERIC
              MOVE 0                      TO LN-PRIOR-UNEARNED
                                            ALN-PRIOR-UNEARNED
           ELSE
              MOVE OLN-PRIOR-UNEARNED     TO LN-PRIOR-UNEARNED
                                            ALN-PRIOR-UNEARNED.
           MOVE OLN-ERNDELQ-STOP          TO LN-ERNDELQ-STOP
                                            ALN-ERNDELQ-STOP.
           IF OLN-NONACRERN NOT NUMERIC
              MOVE 0                      TO LN-NONACRERN
                                            ALN-NONACRERN
           ELSE
              MOVE OLN-NONACRERN          TO LN-NONACRERN
                                            ALN-NONACRERN.
           IF OLN-PRIOR-NONACRERN NOT NUMERIC
              MOVE 0                      TO LN-PRIOR-NONACRERN
                                            ALN-PRIOR-NONACRERN
           ELSE
              MOVE OLN-PRIOR-NONACRERN    TO LN-PRIOR-NONACRERN
                                            ALN-PRIOR-NONACRERN.

           MOVE OLN-ERN-IB-PDTH           TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LN-ERN-IB-PDTH-DATE
                                            ALN-ERN-IB-PDTH-DATE.

           IF OLN-ERN-IB-PRINBAL NOT NUMERIC
              MOVE 0                      TO LN-ERN-IB-PRINBAL
                                            ALN-ERN-IB-PRINBAL
           ELSE
              MOVE OLN-ERN-IB-PRINBAL     TO LN-ERN-IB-PRINBAL
                                            ALN-ERN-IB-PRINBAL.
           IF OLN-ERN-IB-INTOWE NOT NUMERIC
              MOVE 0                      TO LN-ERN-IB-INTOWE
                                            ALN-ERN-IB-INTOWE
           ELSE
              MOVE OLN-ERN-IB-INTOWE      TO LN-ERN-IB-INTOWE
                                            ALN-ERN-IB-INTOWE.
           IF OLN-TOTERN NOT NUMERIC
              MOVE 0             TO LN-TOTERN ALN-TOTERN
           ELSE
              MOVE OLN-TOTERN    TO LN-TOTERN ALN-TOTERN.
 
           IF OLN-TOTOTH NOT NUMERIC
              MOVE 0             TO LN-TOTOTH ALN-TOTOTH
           ELSE
              MOVE OLN-TOTOTH    TO LN-TOTOTH ALN-TOTOTH.
      * CLEANSE BR GA0131 ACCT 42 TOTINT = 0D109F JUNK FROM A CONVERSION
           IF OLN-TOTINT NOT NUMERIC
              MOVE 0               TO LN-TOTINT ALN-TOTINT
           ELSE
              MOVE OLN-TOTINT      TO LN-TOTINT ALN-TOTINT.
           IF OLN-TOTLCHG NOT NUMERIC
              MOVE 0               TO LN-TOTLCHG ALN-TOTLCHG
           ELSE
              MOVE OLN-TOTLCHG     TO LN-TOTLCHG ALN-TOTLCHG.
           IF OLN-TOTDEF NOT NUMERIC
              MOVE 0               TO LN-TOTDEF ALN-TOTDEF
           ELSE
              MOVE OLN-TOTDEF      TO LN-TOTDEF ALN-TOTDEF.
           IF OLN-TOTSERACCT NOT NUMERIC
              MOVE 0               TO LN-TOTSERACCT ALN-TOTSERACCT
           ELSE
              MOVE OLN-TOTSERACCT  TO LN-TOTSERACCT ALN-TOTSERACCT.
           IF OLN-LCWAIVERS NOT NUMERIC
              MOVE 0               TO LN-LCWAIVERS ALN-LCWAIVERS
           ELSE
              MOVE OLN-LCWAIVERS   TO LN-LCWAIVERS  ALN-LCWAIVERS.
           IF OLN-INTWAIVERS NOT NUMERIC
              MOVE 0               TO LN-INTWAIVERS ALN-INTWAIVERS
           ELSE
              MOVE OLN-INTWAIVERS  TO LN-INTWAIVERS ALN-INTWAIVERS.
           IF OLN-TOTPAYMNTD NOT NUMERIC
              MOVE 0               TO LN-TOTPAYMNTD ALN-TOTPAYMNTD
           ELSE
              MOVE OLN-TOTPAYMNTD  TO LN-TOTPAYMNTD ALN-TOTPAYMNTD.
           IF OLN-TOTEXCPAYMNTD NOT NUMERIC
              MOVE 0                 TO LN-TOTEXCPAYMNTD
                                       ALN-TOTEXCPAYMNTD
           ELSE
              MOVE OLN-TOTEXCPAYMNTD TO LN-TOTEXCPAYMNTD
                                       ALN-TOTEXCPAYMNTD.
           IF OLN-TOTNODEF NOT NUMERIC
              MOVE 0               TO LN-TOTNODEF    ALN-TOTNODEF
           ELSE
              MOVE OLN-TOTNODEF    TO LN-TOTNODEF    ALN-TOTNODEF.
           IF OLN-YTDNODEF NOT NUMERIC
              MOVE 0               TO LN-YTDNODEF    ALN-YTDNODEF
           ELSE
              MOVE OLN-YTDNODEF    TO LN-YTDNODEF    ALN-YTDNODEF.
      * 23 136-01
           IF OLN-TOTNODEFACT NOT NUMERIC
              MOVE 0               TO LN-TOTNODEFACT ALN-TOTNODEFACT
           ELSE
              MOVE OLN-TOTNODEFACT TO LN-TOTNODEFACT ALN-TOTNODEFACT.
      * BR 724 ACCT 1312
           IF OLN-YTDNODEFACT NOT NUMERIC
              MOVE 0               TO LN-YTDNODEFACT ALN-YTDNODEFACT
           ELSE
              MOVE OLN-YTDNODEFACT TO LN-YTDNODEFACT ALN-YTDNODEFACT.
      * 15 69693-01
           IF OLN-TOTNOALDEL NOT NUMERIC
              MOVE 0               TO LN-TOTNOALDEL ALN-TOTNOALDEL
           ELSE
              MOVE OLN-TOTNOALDEL  TO LN-TOTNOALDEL ALN-TOTNOALDEL.
      * BR 534 ACCT 54163 
           IF OLN-YTDNOALDEL NOT NUMERIC
              MOVE 0               TO LN-YTDNOALDEL ALN-YTDNOALDEL
           ELSE
              MOVE OLN-YTDNOALDEL  TO LN-YTDNOALDEL ALN-YTDNOALDEL.
           MOVE OLN-YTDINTPD       TO LN-YTDINTPD    ALN-YTDINTPD.
           MOVE OLN-LYRINTPD       TO LN-LYRINTPD    ALN-LYRINTPD.

      * CLEANSE BR GA0131 ACCT 42 TOTINT = 0D109F JUNK FROM A CONVERSION
           IF OLN-TOTINTPD NOT NUMERIC
              MOVE 0               TO LN-TOTINTPD   ALN-TOTINTPD
           ELSE
              MOVE OLN-TOTINTPD    TO LN-TOTINTPD   ALN-TOTINTPD.
           IF OLN-RECASTINT NOT NUMERIC
              MOVE 0              TO LN-RECASTINT  ALN-RECASTINT
           ELSE
              MOVE OLN-RECASTINT  TO LN-RECASTINT   ALN-RECASTINT.
           IF OLN-RECASTPRIN NOT NUMERIC
              MOVE 0              TO LN-RECASTPRIN  ALN-RECASTPRIN
           ELSE
              MOVE OLN-RECASTPRIN TO LN-RECASTPRIN  ALN-RECASTPRIN.
           MOVE OLN-CL-REBATE    TO LN-CL-REBATE    ALN-CL-REBATE.
           MOVE OLN-AH-REBATE    TO LN-AH-REBATE    ALN-AH-REBATE.
           MOVE OLN-PP-REBATE    TO LN-PP-REBATE    ALN-PP-REBATE.
           MOVE OLN-INT-REBATE   TO LN-INT-REBATE   ALN-INT-REBATE.
           MOVE OLN-SC-REBATE    TO LN-SC-REBATE    ALN-SC-REBATE.
           MOVE OLN-MF-REBATE    TO LN-MF-REBATE    ALN-MF-REBATE.
           MOVE OLN-DF-REBATE    TO LN-DF-REBATE    ALN-DF-REBATE.
           MOVE OLN-EX-REBATE    TO LN-EX-REBATE    ALN-EX-REBATE.
           MOVE OLN-O1-REBATE    TO LN-O1-REBATE    ALN-O1-REBATE.
           MOVE OLN-O2-REBATE    TO LN-O2-REBATE    ALN-O2-REBATE.
           MOVE OLN-O3-REBATE    TO LN-O3-REBATE    ALN-O3-REBATE.
           MOVE OLN-O4-REBATE    TO LN-O4-REBATE    ALN-O4-REBATE.
           MOVE OLN-O5-REBATE    TO LN-O5-REBATE    ALN-O5-REBATE.
           MOVE OLN-PLREASON     TO LN-PLREASON     ALN-PLREASON.
           MOVE OLN-COLLECTOR    TO LN-COLLECTOR    ALN-COLLECTOR.
           MOVE OLN-ACTIONCD     TO LN-ACTIONCD     ALN-ACTIONCD.
           MOVE OLN-ACTIONCD2    TO LN-ACTIONCD2    ALN-ACTIONCD2.
           MOVE OLN-ATCODE       TO LN-ATCODE       ALN-ATCODE.
           MOVE OLN-RECODE       TO LN-RECODE       ALN-RECODE.
           MOVE OLN-ESCROW-FG    TO LN-ESCROW-FG    ALN-ESCROW-FG.
      * CLEANSE - FOUND 202 IN SEVERAL
           IF (OLN-PROMDAYS-PASTDUE NOT NUMERIC) OR
                (OLN-PROMDAYS-PASTDUE = 202)
              MOVE 0                  TO LN-PROMDAYS-PASTDUE
                                        ALN-PROMDAYS-PASTDUE
           ELSE
              MOVE OLN-PROMDAYS-PASTDUE TO LN-PROMDAYS-PASTDUE
                                           ALN-PROMDAYS-PASTDUE.

           MOVE OLN-PROMID       TO LN-PROMID       ALN-PROMID.

           MOVE OLN-PROMDATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LN-PROMDATE     ALN-PROMDATE.

           IF OLN-PROMAMT NOT NUMERIC
              MOVE 0             TO LN-PROMAMT ALN-PROMAMT
           ELSE
              MOVE OLN-PROMAMT   TO LN-PROMAMT ALN-PROMAMT.

           MOVE OLN-PROMDATE2    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LN-PROMDATE2 ALN-PROMDATE2.

           MOVE OLN-DATE-PAID-LAST  TO DATE-MMDDYY.
      * BR 1106 15205 2003/00/03
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD  TO LN-DATE-PAID-LAST ALN-DATE-PAID-LAST.

      * START THE METRO2 FIELD WITH DATE-PAID-LAST
           MOVE LN-DATE-PAID-LAST TO LN-METRO2-LAST-PMT-DATE
                                    ALN-METRO2-LAST-PMT-DATE.
          
      * CLEANSE BR GA0131 ACCT 1404 AMT-PAID-LAST = JUNK FROM A CONVERSION
           IF OLN-AMT-PAID-LAST NOT NUMERIC
              MOVE 0           TO LN-AMT-PAID-LAST  ALN-AMT-PAID-LAST
           ELSE
              MOVE OLN-AMT-PAID-LAST      TO LN-AMT-PAID-LAST
                                            ALN-AMT-PAID-LAST.

           IF OLN-LASTCFORMNO NOT NUMERIC
              MOVE 0               TO LN-LASTCFORMNO
                                     ALN-LASTCFORMNO
           ELSE
              MOVE OLN-LASTCFORMNO TO LN-LASTCFORMNO
                                     ALN-LASTCFORMNO.

           IF OLN-LASTCFORMDATE NOT NUMERIC
              MOVE 0            TO LN-LASTCFORMDATE
                                  ALN-LASTCFORMDATE
           ELSE
             MOVE OLN-LASTCFORMDATE TO DATE-MMDDYY
             PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
             PERFORM TEST-INVALID-DATE
             MOVE DATE-YYYYMMDD TO LN-LASTCFORMDATE
                                  ALN-LASTCFORMDATE.

           IF OLN-DELCNT NOT NUMERIC
              MOVE 0             TO LN-DELCNT ALN-DELCNT
           ELSE
              MOVE OLN-DELCNT    TO LN-DELCNT ALN-DELCNT.
           IF OLN-DELCNT2 NOT NUMERIC
              MOVE 0             TO LN-DELCNT2 ALN-DELCNT2
           ELSE
              MOVE OLN-DELCNT2   TO LN-DELCNT2 ALN-DELCNT2.
           IF OLN-CREDITLIM NOT NUMERIC
              MOVE 0             TO LN-CREDITLIM ALN-CREDITLIM
           ELSE
              MOVE OLN-CREDITLIM TO LN-CREDITLIM ALN-CREDITLIM. 
           IF OLN-CRSCORE NOT NUMERIC
              MOVE 0             TO LN-CRSCORE ALN-CRSCORE
           ELSE
              MOVE OLN-CRSCORE   TO LN-CRSCORE ALN-CRSCORE.
           IF OLN-LASTSFORMNO NOT NUMERIC
              MOVE 0               TO LN-LASTSFORMNO
                                     ALN-LASTSFORMNO
           ELSE
              MOVE OLN-LASTSFORMNO TO LN-LASTSFORMNO
                                     ALN-LASTSFORMNO.

           MOVE OLN-LASTSFORMDATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LN-LASTSFORMDATE ALN-LASTSFORMDATE.

           IF OLN-SOLCNT NOT NUMERIC
              MOVE 0             TO LN-SOLCNT ALN-SOLCNT
           ELSE
              MOVE OLN-SOLCNT    TO LN-SOLCNT ALN-SOLCNT.

      * GARBAGE IN LN-MESSAGE CAUSES MAJOR ISSUES IN DATABASE
      * EXAMPLE: BRANCH 34 ACCT 88536, BRANCH 1112 ACCT 9069
           MOVE OLN-MESSAGE      TO HOLD-LN-MESSAGE.
           PERFORM TEST-LN-MESSAGE VARYING SUB FROM 1 BY 1 UNTIL 
                    SUB > 30.

           MOVE HOLD-LN-MESSAGE  TO LN-MESSAGE ALN-MESSAGE.

           MOVE OLN-OLDACCTNO    TO OLD-ACCTNO.
           MOVE NEW-ACCTNO       TO LN-OLDACCTNO   ALN-OLDACCTNO.

           MOVE OLN-PRLNNO       TO OLD-ACCTNO.
           MOVE NEW-ACCTNO       TO LN-PRLNNO      ALN-PRLNNO.

           IF OLN-PRBAL NOT NUMERIC
              MOVE 0             TO LN-PRBAL ALN-PRBAL
           ELSE
              MOVE OLN-PRBAL     TO LN-PRBAL ALN-PRBAL.
           IF OLN-PRINTDUE NOT NUMERIC
              MOVE 0             TO LN-PRINTDUE ALN-PRINTDUE
           ELSE
              MOVE OLN-PRINTDUE  TO LN-PRINTDUE ALN-PRINTDUE.
           IF OLN-PRFINCHGRB NOT NUMERIC
              MOVE 0              TO LN-PRFINCHGRB ALN-PRFINCHGRB
           ELSE
              MOVE OLN-PRFINCHGRB TO LN-PRFINCHGRB ALN-PRFINCHGRB.
           IF OLN-PRINSRB NOT NUMERIC
              MOVE 0              TO LN-PRINSRB ALN-PRINSRB
           ELSE
              MOVE OLN-PRINSRB    TO LN-PRINSRB ALN-PRINSRB.
           MOVE OLN-PRPOCD       TO LN-PRPOCD      ALN-PRPOCD.

           MOVE OLN-PRPODATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LN-PRPODATE    ALN-PRPODATE.

           IF OLN-PRDELINQAMT NOT NUMERIC
              MOVE 0               TO LN-PRDELINQAMT
                                     ALN-PRDELINQAMT
           ELSE
              MOVE OLN-PRDELINQAMT TO LN-PRDELINQAMT
                                     ALN-PRDELINQAMT.
           IF OLN-PRLNAMT NOT NUMERIC
              MOVE 0               TO LN-PRLNAMT ALN-PRLNAMT
           ELSE
              MOVE OLN-PRLNAMT     TO LN-PRLNAMT ALN-PRLNAMT.
           IF OLN-PRPDUE-DAYS NOT NUMERIC
              MOVE 0               TO LN-PRPDUE-DAYS
                                     ALN-PRPDUE-DAYS
           ELSE
              MOVE OLN-PRPDUE-DAYS TO LN-PRPDUE-DAYS
                                     ALN-PRPDUE-DAYS.
      * BR 101 35835-01 2020202.02
           IF OLN-PRDLDISC-UNEARN NOT NUMERIC
              MOVE 0                   TO LN-PRDLDISC-UNEARN
                                         ALN-PRDLDISC-UNEARN
           ELSE
              MOVE OLN-PRDLDISC-UNEARN TO LN-PRDLDISC-UNEARN
                                         ALN-PRDLDISC-UNEARN.
           IF OLN-PRCONPROFILE NOT NUMERIC
              MOVE 0                 TO LN-PRCONPROFILE
                                       ALN-PRCONPROFILE
           ELSE
              MOVE OLN-PRCONPROFILE  TO LN-PRCONPROFILE
                                       ALN-PRCONPROFILE.
           IF OLN-SUM-ORIGPURAMT NOT NUMERIC
              MOVE 0                  TO LN-SUM-ORIGPURAMT
                                        ALN-SUM-ORIGPURAMT
           ELSE
              MOVE OLN-SUM-ORIGPURAMT TO LN-SUM-ORIGPURAMT
                                        ALN-SUM-ORIGPURAMT.
           IF OLN-SUM-LNAMT NOT NUMERIC
              MOVE 0             TO LN-SUM-LNAMT ALN-SUM-LNAMT
           ELSE
              MOVE OLN-SUM-LNAMT TO LN-SUM-LNAMT ALN-SUM-LNAMT.
           IF OLN-SUM-FINCHG NOT NUMERIC
              MOVE 0              TO LN-SUM-FINCHG ALN-SUM-FINCHG
           ELSE
              MOVE OLN-SUM-FINCHG TO LN-SUM-FINCHG ALN-SUM-FINCHG.
           IF OLN-SUM-INTCHG NOT NUMERIC
              MOVE 0              TO LN-SUM-INTCHG ALN-SUM-INTCHG
           ELSE
              MOVE OLN-SUM-INTCHG TO LN-SUM-INTCHG ALN-SUM-INTCHG.
           IF OLN-SUM-ORGTERM NOT NUMERIC
              MOVE 0               TO LN-SUM-ORGTERM
                                     ALN-SUM-ORGTERM
           ELSE
              MOVE OLN-SUM-ORGTERM TO LN-SUM-ORGTERM
                                     ALN-SUM-ORGTERM.
           IF OLN-SUM-REGPYAMT NOT NUMERIC
              MOVE 0                TO LN-SUM-REGPYAMT
                                      ALN-SUM-REGPYAMT
           ELSE
              MOVE OLN-SUM-REGPYAMT TO LN-SUM-REGPYAMT
                                      ALN-SUM-REGPYAMT.
           IF OLN-SUM-EXTCHG NOT NUMERIC
              MOVE 0              TO LN-SUM-EXTCHG ALN-SUM-EXTCHG
           ELSE
              MOVE OLN-SUM-EXTCHG TO LN-SUM-EXTCHG ALN-SUM-EXTCHG.
           IF OLN-SUM-SERCHG NOT NUMERIC
              MOVE 0              TO LN-SUM-SERCHG ALN-SUM-SERCHG
           ELSE
              MOVE OLN-SUM-SERCHG TO LN-SUM-SERCHG ALN-SUM-SERCHG.
           IF OLN-SUM-MAINTFEE NOT NUMERIC
              MOVE 0                TO LN-SUM-MAINTFEE
                                      ALN-SUM-MAINTFEE
           ELSE
              MOVE OLN-SUM-MAINTFEE TO LN-SUM-MAINTFEE
                                      ALN-SUM-MAINTFEE.

           MOVE OLN-UNITPER-CD       TO LN-UNITPER-CD ALN-UNITPER-CD.
           IF OLN-UNITPER-FREQ NOT NUMERIC
              MOVE 0                 TO LN-UNITPER-FREQ
                                       ALN-UNITPER-FREQ
           ELSE
              MOVE OLN-UNITPER-FREQ  TO LN-UNITPER-FREQ
                                       ALN-UNITPER-FREQ.
           IF OLN-DAYS-IN-UNITPER NOT NUMERIC
              MOVE 0                   TO LN-DAYS-IN-UNITPER
                                         ALN-DAYS-IN-UNITPER
           ELSE
              MOVE OLN-DAYS-IN-UNITPER TO LN-DAYS-IN-UNITPER
                                         ALN-DAYS-IN-UNITPER.
           IF OLN-UNITPER-PER-YEAR NOT NUMERIC
              MOVE 0                    TO LN-UNITPER-PER-YEAR
                                          ALN-UNITPER-PER-YEAR
           ELSE
              MOVE OLN-UNITPER-PER-YEAR TO LN-UNITPER-PER-YEAR
                                          ALN-UNITPER-PER-YEAR.
           MOVE OLN-REPOCD           TO LN-REPOCD       ALN-REPOCD.
           MOVE OLN-BR-TFR-FG        TO LN-BR-TFR-FG    ALN-BR-TFR-FG.
           IF OLN-O3INS-DLPROC NOT NUMERIC
              MOVE 0                TO LN-O3INS-DLPROC
                                      ALN-O3INS-DLPROC
           ELSE
              MOVE OLN-O3INS-DLPROC TO LN-O3INS-DLPROC
                                      ALN-O3INS-DLPROC.
           IF OLN-INSPREM-DLADJ NOT NUMERIC
              MOVE 0                 TO LN-INSPREM-DLADJ
                                       ALN-INSPREM-DLADJ
           ELSE
              MOVE OLN-INSPREM-DLADJ TO LN-INSPREM-DLADJ
                                       ALN-INSPREM-DLADJ.
           IF OLN-PLAMT NOT NUMERIC
              MOVE 0                 TO LN-PLAMT ALN-PLAMT
           ELSE
              MOVE OLN-PLAMT         TO LN-PLAMT ALN-PLAMT.
           IF OLN-MTD-PRIN NOT NUMERIC
              MOVE 0                 TO LN-MTD-PRIN ALN-MTD-PRIN
           ELSE
              MOVE OLN-MTD-PRIN      TO LN-MTD-PRIN ALN-MTD-PRIN.
           IF OLN-MTD-LC NOT NUMERIC
              MOVE 0                 TO LN-MTD-LC ALN-MTD-LC
           ELSE
              MOVE OLN-MTD-LC        TO LN-MTD-LC ALN-MTD-LC.
           IF OLN-MTD-INT NOT NUMERIC
              MOVE 0                 TO LN-MTD-INT ALN-MTD-INT
           ELSE
              MOVE OLN-MTD-INT       TO LN-MTD-INT ALN-MTD-INT.
           IF OLN-MTD-OT NOT NUMERIC
              MOVE 0                 TO LN-MTD-OT ALN-MTD-OT
           ELSE
              MOVE OLN-MTD-OT        TO LN-MTD-OT ALN-MTD-OT.
           IF OLN-MTD-EX NOT NUMERIC
              MOVE 0                 TO LN-MTD-EX ALN-MTD-EX
           ELSE
              MOVE OLN-MTD-EX        TO LN-MTD-EX ALN-MTD-EX.
           IF OLN-BNKRPT-CHAPTER NOT NUMERIC
              MOVE 0                  TO LN-BNKRPT-CHAPTER
                                        ALN-BNKRPT-CHAPTER
           ELSE
              MOVE OLN-BNKRPT-CHAPTER TO LN-BNKRPT-CHAPTER
                                        ALN-BNKRPT-CHAPTER.

           MOVE OLN-BMO-CON-STATUS   TO LN-BMO-CON-STATUS
                                       ALN-BMO-CON-STATUS.
           MOVE OLN-BMO-REC-STATUS   TO LN-BMO-REC-STATUS
                                       ALN-BMO-REC-STATUS.

           IF ( OLN-APPNO = ZEROES ) OR (OLN-APPNO NOT NUMERIC)
              MOVE 0                 TO LN-APP-NUMBER
                                       ALN-APP-NUMBER
           ELSE
              MOVE OLN-APPNO         TO WSS-MA-APPNO
              MOVE 01                TO WSS-MA-SEQNO
              MOVE WSS-MA-APP-NUMBER TO LN-APP-NUMBER
                                       ALN-APP-NUMBER.

           MOVE OLN-GIFTNET        TO LN-GIFTNET ALN-GIFTNET.
      * CLEANSE BR 18 3506-01 20202
           IF OLN-GIFTNET-OUR-PO NOT NUMERIC OR
               (OLN-GIFTNET-OUR-PO = 202020)
              MOVE 0                  TO LN-GIFTNET-OUR-PO
                                        ALN-GIFTNET-OUR-PO
           ELSE
              MOVE OLN-GIFTNET-OUR-PO TO LN-GIFTNET-OUR-PO
                                        ALN-GIFTNET-OUR-PO.
           MOVE OLN-PROC-DISBURSED TO LN-PROC-DISBURSED
                                     ALN-PROC-DISBURSED.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OLN-CONPROFILE(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-CONPROFILE(SUB)
                                            ALN-CONPROFILE(SUB)
              ELSE
                 MOVE OLN-CONPROFILE(SUB) TO LN-CONPROFILE(SUB)
                                            ALN-CONPROFILE(SUB)
              END-IF
              IF OLN-RECPROFILE(SUB) NOT NUMERIC
                 MOVE 0                   TO LN-RECPROFILE(SUB)
                                            ALN-RECPROFILE(SUB)
              ELSE
              MOVE OLN-RECPROFILE(SUB)    TO LN-RECPROFILE(SUB)
                                            ALN-RECPROFILE(SUB)
              END-IF
           END-PERFORM.

           MOVE OLN-TRW-STATUS    TO LN-TRW-STATUS ALN-TRW-STATUS.
           MOVE OLN-ORIGIN        TO LN-ORIGIN     ALN-ORIGIN.
           MOVE OLN-PO-TRCD       TO LN-PO-TRCD    ALN-PO-TRCD.

           IF OLN-NEXIS-CRSCORE NOT NUMERIC
              MOVE 0                 TO LN-NEXIS-CRSCORE
                                       ALN-NEXIS-CRSCORE
           ELSE
              MOVE OLN-NEXIS-CRSCORE TO LN-NEXIS-CRSCORE
                                       ALN-NEXIS-CRSCORE.
                
           IF OLN-TRW-B-CONSUMER-IND = X"000F"
              MOVE SPACES TO LN-TRW-B-CONSUMER-IND
                            ALN-TRW-B-CONSUMER-IND
           ELSE
              MOVE OLN-TRW-B-CONSUMER-IND TO LN-TRW-B-CONSUMER-IND
                                            ALN-TRW-B-CONSUMER-IND.

           IF OLN-PARVHELD-PAID-FG = "A" OR "R" OR "V"
              MOVE OLN-PARVHELD-PAID-FG   TO LN-PARVHELD-PAID-FG
                                            ALN-PARVHELD-PAID-FG
           ELSE
              MOVE SPACES                 TO LN-PARVHELD-PAID-FG
                                            ALN-PARVHELD-PAID-FG.

           MOVE OLN-ACCT-FROZEN           TO LN-ACCT-FROZEN
                                            ALN-ACCT-FROZEN.
           MOVE OLN-TRW-SPECIAL-CODE      TO LN-TRW-SPECIAL-CODE
                                            ALN-TRW-SPECIAL-CODE.
           MOVE OLN-CREATION-STATUS       TO LN-CREATION-STATUS
                                            ALN-CREATION-STATUS.
      * 23 136-01
           IF OLN-TOTNOLCHG NOT NUMERIC
              MOVE 0                      TO LN-TOTNOLCHG
                                            ALN-TOTNOLCHG
           ELSE
              MOVE OLN-TOTNOLCHG          TO LN-TOTNOLCHG
                                            ALN-TOTNOLCHG.
           MOVE OLN-LBOX                  TO LN-LBOX
                                            ALN-LBOX.
      * 23 136-01
           IF OLN-EXTRA-PRIN-LFP NOT NUMERIC
              MOVE 0                      TO LN-EXTRA-PRIN-LFP
                                            ALN-EXTRA-PRIN-LFP
           ELSE
              MOVE OLN-EXTRA-PRIN-LFP     TO LN-EXTRA-PRIN-LFP
                                            ALN-EXTRA-PRIN-LFP.
      * 23 136-01
           IF OLN-REMAIN-INT-SINCE-LFP NOT NUMERIC
              MOVE 0                   TO LN-REMAIN-INT-SINCE-LFP
                                         ALN-REMAIN-INT-SINCE-LFP
           ELSE
              MOVE OLN-REMAIN-INT-SINCE-LFP TO
                                       LN-REMAIN-INT-SINCE-LFP
                                      ALN-REMAIN-INT-SINCE-LFP.
      * 23 136-01
           IF OLN-REMAIN-PRIN-SINCE-LFP NOT NUMERIC
              MOVE 0                TO LN-REMAIN-PRIN-SINCE-LFP
                                      ALN-REMAIN-PRIN-SINCE-LFP
           ELSE
              MOVE OLN-REMAIN-PRIN-SINCE-LFP TO
                                       LN-REMAIN-PRIN-SINCE-LFP
                                      ALN-REMAIN-PRIN-SINCE-LFP.
           MOVE OLN-INTERIM-COUPON        TO LN-INTERIM-COUPON
                                            ALN-INTERIM-COUPON.
           IF OLN-DLCOMM-O3-CMSI NOT NUMERIC
              MOVE 0                      TO LN-DLCOMM-O3-CMSI
                                            ALN-DLCOMM-O3-CMSI
           ELSE
              MOVE OLN-DLCOMM-O3-CMSI     TO LN-DLCOMM-O3-CMSI
                                            ALN-DLCOMM-O3-CMSI.
           IF OLN-DLCOMM-PP-CMSI NOT NUMERIC
              MOVE 0                      TO LN-DLCOMM-PP-CMSI
                                            ALN-DLCOMM-PP-CMSI
           ELSE
           MOVE OLN-DLCOMM-PP-CMSI        TO LN-DLCOMM-PP-CMSI
                                            ALN-DLCOMM-PP-CMSI.
           MOVE OLN-TRW-J-CONSUMER-IND    TO LN-TRW-J-CONSUMER-IND
                                            ALN-TRW-J-CONSUMER-IND.
           MOVE OLN-ACH                   TO LN-ACH       ALN-ACH.
           MOVE OLN-1099-C-FG             TO LN-1099-C-FG ALN-1099-C-FG.
           MOVE OLN-TRW-COMPLIANCE-CODE   TO LN-TRW-COMPLIANCE-CODE
                                            ALN-TRW-COMPLIANCE-CODE.
           MOVE OLN-UNWIND-REASON-CODE    TO LN-UNWIND-REASON-CODE
                                            ALN-UNWIND-REASON-CODE.
           MOVE 0                         TO LN-LOS-APP-ID
                                            ALN-LOS-APP-ID.

       UPGRADE-FILE-LN-EXIT.
           EXIT.

      ******************************************
       TEST-INTPDTH-DATE SECTION.
      ******************************************
           IF OLN-INTPDTH NOT NUMERIC
              MOVE 0            TO DATE-MMDDYY
           ELSE
              MOVE OLN-INTPDTH  TO DATE-MMDDYY.

      * CLEANSE   BR 1007 ACCT 1500 INTPDTH = 2007/33/00; 33/00/07
           IF DATE-MMDDYY = 0
              MOVE 0 TO LN-INTPDTH-DATE ALN-INTPDTH-DATE
              GO TO EXIT-TEST-INTPDTH-DATE.

           IF (DATE-MMDDYY-MM = 0) AND (DATE-MMDDYY-YY = 0) AND
               (OLN-POFFDATE NOT = 0)
              MOVE OLN-POFFDATE TO OLN-INTPDTH DATE-MMDDYY.
           IF (DATE-MMDDYY-MM = 0) AND (DATE-MMDDYY-YY = 0) 
              MOVE OLN-LOANDATE TO OLN-INTPDTH DATE-MMDDYY.

           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LN-INTPDTH-DATE ALN-INTPDTH-DATE.

       EXIT-TEST-INTPDTH-DATE.
           EXIT.
      ******************************************************************
       TEST-LN-MESSAGE SECTION.
      ******************************************************************
           IF HOLD-LN-MESS-BYTE(SUB) NOT = SPACES
              IF HOLD-LN-MESS-BYTE(SUB) NOT ALPHABETIC
                 IF HOLD-LN-MESS-BYTE(SUB) NOT NUMERIC
                    MOVE HOLD-LN-MESS-BYTE(SUB) TO HOLD-BYTE
                    IF NOT VALID-SPECIAL-CHARS
                       MOVE SPACES TO HOLD-LN-MESS-BYTE(SUB).

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L P
      *
      ******************************************************************
       UPGRADE-FILE-LP SECTION.

           IF FILE-OPTION-LP = "A"
              PERFORM CLEAR-ALP-FILE
           ELSE
              PERFORM CLEAR-LP-FILE.

           MOVE BR-NO          TO LP-BRNO   ALP-BRNO.
           MOVE OLP-ACCTNO     TO OLD-ACCTNO.
           MOVE NEW-ACCTNO     TO LP-ACCTNO ALP-ACCTNO.
           MOVE OLP-SEQNO      TO LP-SEQNO  ALP-SEQNO.

           MOVE 0              TO LP-LTOUCH-DATE ALP-LTOUCH-DATE.
           MOVE OLP-USERID     TO LP-USERID      ALP-USERID.

      * LP-ALT-PREPAY-FG IS A REDEFINES OF LP-USERID BUT ONLY USING
      * THE 10TH BYTE, MOST USERID'S ARE ONLY 8 SO I THINK WE ARE SAFE
      * ALWAYS MOVING THAT 10TH BYTE REDEFINES TO THE FIELD IN S35
           MOVE OLP-ALT-PREPAY-FG TO LP-ALT-PREPAY-FG
                                    ALP-ALT-PREPAY-FG.

           MOVE OLP-POSTDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LP-POSTDATE ALP-POSTDATE.

           IF OLP-POSTTIME NOT NUMERIC
              MOVE 0               TO LP-POSTTIME ALP-POSTTIME
           ELSE
           MOVE OLP-POSTTIME       TO LP-POSTTIME ALP-POSTTIME.

           MOVE OLP-TRDATE         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LP-TRDATE ALP-TRDATE.

           MOVE OLP-PAYDATE        TO DATE-MMDDYY.
      * AL 1542 42076 SEQ 1 20080033   TRY TRDATE
      * LA 0735 2636  SEQ 1 00/11/27   TRY TRDATE
           IF DATE-MMDDYY-MM < 1 OR > 12
              MOVE OLP-TRDATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LP-PAYDATE ALP-PAYDATE.

           MOVE OLP-TRCD           TO LP-TRCD    ALP-TRCD.
           MOVE OLP-REFNO          TO LP-REFNO   ALP-REFNO.

           IF LP-TRCD = "TP"
              MOVE OLP-FROMCL    TO LP-FROMCL  ALP-FROMCL
              MOVE OLP-TOCL      TO LP-TOCL    ALP-TOCL
           ELSE
           IF LP-TRCD = "TS"
              MOVE OLP-FROMCL    TO LP-FROMCL  ALP-FROMCL
              MOVE OLP-TOCL      TO LP-TOCL    ALP-TOCL
           ELSE
                MOVE 0           TO LP-FROMCL  ALP-FROMCL
                                    LP-TOCL    ALP-TOCL.

      * CLEANSE BR 801 201905 SEQ 1
           IF OLP-TRAMT NOT NUMERIC
              MOVE 0               TO LP-TRAMT ALP-TRAMT
           ELSE
              MOVE OLP-TRAMT       TO LP-TRAMT  ALP-TRAMT.
           IF OLP-APOTH NOT NUMERIC
              MOVE 0               TO LP-APOTH ALP-APOTH
           ELSE
              MOVE OLP-APOTH       TO LP-APOTH  ALP-APOTH.
           IF OLP-APOT2 NOT NUMERIC
              MOVE 0               TO LP-APOT2 ALP-APOT2
           ELSE
              MOVE OLP-APOT2       TO LP-APOT2  ALP-APOT2.
           IF OLP-APINT NOT NUMERIC
              MOVE 0               TO LP-APINT ALP-APINT
           ELSE
              MOVE OLP-APINT       TO LP-APINT  ALP-APINT.
           IF OLP-APLC NOT NUMERIC
              MOVE 0               TO LP-APLC ALP-APLC
           ELSE
              MOVE OLP-APLC        TO LP-APLC   ALP-APLC.
           IF OLP-APCUR NOT NUMERIC
              MOVE 0               TO LP-APCUR ALP-APCUR
           ELSE
              MOVE OLP-APCUR       TO LP-APCUR  ALP-APCUR.
           IF OLP-OTHBAL NOT NUMERIC
              MOVE 0               TO LP-OTHBAL ALP-OTHBAL
           ELSE
              MOVE OLP-OTHBAL      TO LP-OTHBAL ALP-OTHBAL.
           IF OLP-OT2BAL NOT NUMERIC
              MOVE 0               TO LP-OT2BAL ALP-OT2BAL
           ELSE
              MOVE OLP-OT2BAL      TO LP-OT2BAL ALP-OT2BAL.
           IF OLP-INTBAL NOT NUMERIC
              MOVE 0               TO LP-INTBAL ALP-INTBAL
           ELSE
              MOVE OLP-INTBAL      TO LP-INTBAL ALP-INTBAL.
           IF OLP-LCBAL NOT NUMERIC
              MOVE 0               TO LP-LCBAL ALP-LCBAL
           ELSE
              MOVE OLP-LCBAL       TO LP-LCBAL  ALP-LCBAL.
           IF OLP-CURBAL NOT NUMERIC 
              MOVE 0               TO LP-CURBAL ALP-CURBAL
           ELSE
              MOVE OLP-CURBAL      TO LP-CURBAL ALP-CURBAL.
           IF OLP-INTDUE NOT NUMERIC 
              MOVE 0               TO LP-INTDUE ALP-INTDUE
           ELSE
              MOVE OLP-INTDUE      TO LP-INTDUE ALP-INTDUE.
           IF OLP-DLPROC NOT NUMERIC 
              MOVE 0               TO LP-DLPROC ALP-DLPROC
           ELSE
              MOVE OLP-DLPROC      TO LP-DLPROC ALP-DLPROC.
           IF OLP-EARNED(1) NOT NUMERIC 
              MOVE 0               TO LP-EARNED(1) ALP-EARNED(1)
           ELSE
              MOVE OLP-EARNED(1)   TO LP-EARNED(1) ALP-EARNED(1).
           IF OLP-EARNED(2) NOT NUMERIC 
              MOVE 0               TO LP-EARNED(2) ALP-EARNED(2)
           ELSE
              MOVE OLP-EARNED(2)   TO LP-EARNED(2) ALP-EARNED(2).
           IF OLP-EARNED(3) NOT NUMERIC 
              MOVE 0               TO LP-EARNED(3) ALP-EARNED(3)
           ELSE
              MOVE OLP-EARNED(3)   TO LP-EARNED(3) ALP-EARNED(3).
           IF OLP-INTPAID NOT NUMERIC 
              MOVE 0               TO LP-INTPAID ALP-INTPAID
           ELSE
              MOVE OLP-INTPAID     TO LP-INTPAID   ALP-INTPAID.
           IF OLP-SSNO NOT NUMERIC 
              MOVE 0               TO LP-SSNO ALP-SSNO
           ELSE
              MOVE OLP-SSNO        TO LP-SSNO      ALP-SSNO.

           IF OLP-PDTH NOT NUMERIC OR (OLP-PDTH = 202020)
              MOVE 0               TO LP-PDTH-DATE ALP-PDTH-DATE
           ELSE
              MOVE OLP-PDTH        TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LP-PDTH-DATE ALP-PDTH-DATE.

      * CLEANSE 705 4455 001 00/03/00
      * CLEANSE 711 530  001 00/10/00
           IF OLP-LCPDTH NOT NUMERIC OR (OLP-LCPDTH = 202020)
              MOVE 0               TO LP-LCPDTH-DATE ALP-LCPDTH-DATE
           ELSE
              MOVE OLP-LCPDTH      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LP-LCPDTH-DATE ALP-LCPDTH-DATE.

           MOVE 0                  TO LP-INTPDTH-DATE ALP-INTPDTH-DATE.

      * CLEANSE "BF" HAS SPACES IN TILLNO
           MOVE 0     TO LP-TILLNO ALP-TILLNO.

           IF OLP-TILLNO = "1"
              MOVE 1  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "2"
              MOVE 2  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "3"
              MOVE 3  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "4"
              MOVE 4  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "5"
              MOVE 5  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "6"
              MOVE 6  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "7"
              MOVE 7  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "8"
              MOVE 8  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "9"
              MOVE 9  TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "A"
              MOVE 10 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "B"
              MOVE 11 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "C"
              MOVE 12 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "D"
              MOVE 13 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "E"
              MOVE 14 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "F"
              MOVE 15 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "G"
              MOVE 16 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "H"
              MOVE 17 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "I"
              MOVE 18 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "J"
              MOVE 19 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "K"
              MOVE 20 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "L"
              MOVE 21 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "M"
              MOVE 22 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "N"
              MOVE 23 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "O"
              MOVE 24 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "P"
              MOVE 25 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "Q"
              MOVE 26 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "R"
              MOVE 27 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "S"
              MOVE 28 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "T"
              MOVE 29 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "U"
              MOVE 30 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "V"
              MOVE 31 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "W"
              MOVE 32 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "X"
              MOVE 33 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "Y"
              MOVE 34 TO LP-TILLNO ALP-TILLNO
           ELSE
           IF OLP-TILLNO = "Z"
              MOVE 35 TO LP-TILLNO ALP-TILLNO.

           MOVE OLP-TRCD                  TO TEST-TRCD.

           IF OLP-TRCD = "SP"
              MOVE OLP-PRIOR-POOLID    TO LP-PRIOR-POOLID
                                         ALP-PRIOR-POOLID
              MOVE 0                   TO LP-APINTOWE
                                         ALP-APINTOWE
                                          LP-ADDON-INTPDTH-DATE
                                         ALP-ADDON-INTPDTH-DATE
           ELSE IF ADDON-TRCD
              MOVE OLP-ADDON-INTPDTH   TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LP-ADDON-INTPDTH-DATE
                                         ALP-ADDON-INTPDTH-DATE
              MOVE 0                   TO LP-APINTOWE
                                         ALP-APINTOWE
                                          LP-PRIOR-POOLID
                                         ALP-PRIOR-POOLID
           ELSE
              MOVE 0                  TO LP-PRIOR-POOLID 
                                        ALP-PRIOR-POOLID
                                         LP-ADDON-INTPDTH-DATE
                                        ALP-ADDON-INTPDTH-DATE
              IF OLP-APINTOWE NOT NUMERIC
                 MOVE 0               TO LP-APINTOWE
                                        ALP-APINTOWE
              ELSE
                 MOVE OLP-APINTOWE    TO LP-APINTOWE
                                        ALP-APINTOWE.

           IF ADDON-TRCD
              MOVE 0                  TO LP-DLPARVHELD-ADJ
                                        ALP-DLPARVHELD-ADJ
              IF OLP-LT-SEQNO NOT NUMERIC
                 MOVE 0               TO LP-LT-SEQNO ALP-LT-SEQNO
              ELSE
                 MOVE OLP-LT-SEQNO    TO LP-LT-SEQNO ALP-LT-SEQNO
              END-IF
           ELSE
              MOVE 0                  TO LP-LT-SEQNO ALP-LT-SEQNO
              IF OLP-DLPARVHELD-ADJ NOT NUMERIC
                 MOVE 0               TO LP-DLPARVHELD-ADJ
                                        ALP-DLPARVHELD-ADJ
              ELSE
                 MOVE OLP-DLPARVHELD-ADJ TO LP-DLPARVHELD-ADJ
                                           ALP-DLPARVHELD-ADJ.

           IF ADDON-TRCD
              MOVE OLP-LCWORK1     TO LP-ADDON-ORIG-REGPY
              MOVE 0               TO LP-NEW1ST-PYDATE
                                             LP-DEF-DUEDATE
                                             LP-LCPARTIALS
           ELSE IF OLP-TRCD = "DC"
              MOVE OLP-NEW1ST-PYDATE TO DATE-MMDDYY           
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO LP-NEW1ST-PYDATE
                                       ALP-NEW1ST-PYDATE
              MOVE 0                 TO LP-DEF-DUEDATE
                                       ALP-DEF-DUEDATE
                                        LP-ADDON-ORIG-REGPY
                                       ALP-ADDON-ORIG-REGPY
                                        LP-LCPARTIALS
                                       ALP-LCPARTIALS
           ELSE IF DEFER-TRCD
              MOVE OLP-DEF-DUEDATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD     TO LP-DEF-DUEDATE ALP-DEF-DUEDATE
              MOVE 0                 TO LP-NEW1ST-PYDATE
                                       ALP-NEW1ST-PYDATE
                                        LP-ADDON-ORIG-REGPY
                                       ALP-ADDON-ORIG-REGPY
                                        LP-LCPARTIALS
                                       ALP-LCPARTIALS
           ELSE
              MOVE 0                 TO LP-NEW1ST-PYDATE
                                       ALP-NEW1ST-PYDATE
                                        LP-ADDON-ORIG-REGPY
                                       ALP-ADDON-ORIG-REGPY
                                        LP-DEF-DUEDATE
                                       ALP-DEF-DUEDATE
              IF OLP-LCWORK1 NOT NUMERIC
                 MOVE 0              TO LP-LCPARTIALS ALP-LCPARTIALS
              ELSE
                 MOVE OLP-LCWORK1    TO LP-LCPARTIALS
                                       ALP-LCPARTIALS.

           IF ADDON-TRCD
              MOVE OLP-LCWORK2       TO LP-ADDON-LAST-PYAMT
                                       ALP-ADDON-LAST-PYAMT
              MOVE 0                 TO LP-OLD1ST-PYDATE
                                       ALP-OLD1ST-PYDATE
                                        LP-DEF-TERM
                                       ALP-DEF-TERM
                                        LP-LCPAID
                                       ALP-LCPAID
           ELSE IF OLP-TRCD = "DC"
              MOVE OLP-OLD1ST-PYDATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO LP-OLD1ST-PYDATE
                                        ALP-OLD1ST-PYDATE
              MOVE 0                  TO LP-ADDON-LAST-PYAMT
                                        ALP-ADDON-LAST-PYAMT
                                         LP-DEF-TERM
                                        ALP-DEF-TERM
                                         LP-LCPAID
                                        ALP-LCPAID
           ELSE IF DEFER-TRCD
              MOVE OLP-DEF-TERM    TO LP-DEF-TERM ALP-DEF-TERM
              MOVE 0               TO LP-ADDON-LAST-PYAMT
                                     ALP-ADDON-LAST-PYAMT
                                      LP-OLD1ST-PYDATE
                                     ALP-OLD1ST-PYDATE
                                      LP-LCPAID ALP-LCPAID
           ELSE
              MOVE 0              TO LP-ADDON-LAST-PYAMT
                                    ALP-ADDON-LAST-PYAMT
                                     LP-OLD1ST-PYDATE
                                    ALP-OLD1ST-PYDATE
                                     LP-DEF-TERM ALP-DEF-TERM
              IF OLP-LCWORK2 NOT NUMERIC
                 MOVE 0           TO LP-LCPAID ALP-LCPAID
              ELSE
                 MOVE OLP-LCWORK2 TO LP-LCPAID ALP-LCPAID.

           MOVE OLP-IBPC                  TO LP-IBPC ALP-IBPC.
           IF ADDON-TRCD
              MOVE OLP-INSTYPES    TO LP-INSTYPES ALP-INSTYPES
              MOVE " "             TO LP-MANUAL-RB ALP-MANUAL-RB
           ELSE
              MOVE OLP-MANUAL-RB   TO LP-MANUAL-RB ALP-MANUAL-RB
              MOVE " "             TO LP-INSTYPES  ALP-INSTYPES.
           MOVE OLP-REV            TO LP-REV       ALP-REV.
           MOVE OLP-REVTRCD        TO LP-REVTRCD   ALP-REVTRCD.
           IF OLP-REVSEQNO NOT NUMERIC
              MOVE 0               TO LP-REVSEQNO  ALP-REVSEQNO
           ELSE
              MOVE OLP-REVSEQNO    TO LP-REVSEQNO  ALP-REVSEQNO.
           MOVE OLP-STATUSFG       TO LP-STATUSFG  ALP-STATUSFG.
           IF OLP-NEWSTAT-RATE NOT NUMERIC
              MOVE 0               TO LP-NEWSTAT-RATE ALP-NEWSTAT-RATE
           ELSE
              MOVE OLP-NEWSTAT-RATE TO LP-NEWSTAT-RATE
                                      ALP-NEWSTAT-RATE.

           IF OLP-DLRVCHGS-ADJ(1) NOT NUMERIC
              MOVE 0                   TO LP-DLRVCHGS-ADJ(1)
                                         ALP-DLRVCHGS-ADJ(1)
           ELSE
              MOVE OLP-DLRVCHGS-ADJ(1) TO LP-DLRVCHGS-ADJ(1)
                                         ALP-DLRVCHGS-ADJ(1).

           IF OLP-DLRVCHGS-ADJ(2) NOT NUMERIC
              MOVE 0                   TO LP-DLRVCHGS-ADJ(2)
                                         ALP-DLRVCHGS-ADJ(2)
           ELSE
              MOVE OLP-DLRVCHGS-ADJ(2) TO LP-DLRVCHGS-ADJ(2)
                                         ALP-DLRVCHGS-ADJ(2).

           IF OLP-DLRVCHGS-ADJ(3) NOT NUMERIC
              MOVE 0                   TO LP-DLRVCHGS-ADJ(3)
                                         ALP-DLRVCHGS-ADJ(3)
           ELSE
           MOVE OLP-DLRVCHGS-ADJ(3)    TO LP-DLRVCHGS-ADJ(3)
                                         ALP-DLRVCHGS-ADJ(3).

           IF OLP-DLPARVPAID-ADJ NOT NUMERIC
              MOVE 0                   TO LP-DLPARVPAID-ADJ
                                         ALP-DLPARVPAID-ADJ
           ELSE
              MOVE OLP-DLPARVPAID-ADJ  TO LP-DLPARVPAID-ADJ
                                         ALP-DLPARVPAID-ADJ.

           IF OLP-DLNO NOT NUMERIC
              MOVE 0                      TO LP-DLNO ALP-DLNO
           ELSE
              MOVE OLP-DLNO               TO LP-DLNO ALP-DLNO.
           IF OLP-WORKAMT1 NOT NUMERIC
              MOVE 0                   TO LP-PREPAY-PENALTY
                                         ALP-PREPAY-PENALTY
           ELSE
              MOVE OLP-WORKAMT1        TO LP-PREPAY-PENALTY
                                         ALP-PREPAY-PENALTY.
           IF OLP-WORKAMT2 NOT NUMERIC
              MOVE 0                   TO LP-PRORATED-INS-REB
                                         ALP-PRORATED-INS-REB
           ELSE
              MOVE OLP-WORKAMT2        TO LP-PRORATED-INS-REB
                                         ALP-PRORATED-INS-REB.
           IF OLP-POSTING-BR NOT NUMERIC
              MOVE 0                      TO LP-POSTING-BR
                                            ALP-POSTING-BR
           ELSE
              MOVE OLP-POSTING-BR         TO LP-POSTING-BR
                                            ALP-POSTING-BR.
           IF OLP-NOLCHG NOT NUMERIC
              MOVE 0                     TO LP-NOLCHG ALP-NOLCHG
           ELSE
              MOVE OLP-NOLCHG            TO LP-NOLCHG ALP-NOLCHG.
           MOVE OLP-COLLECTOR             TO LP-COLLECTOR
                                            ALP-COLLECTOR.
      * CLEANSE  BR 212 ACCT 82697 SEQ 24
           IF OLP-EXTRA-PRIN-LFP NOT NUMERIC OR
                 (OLP-EXTRA-PRIN-LFP = 2020202.02 OR 0202020.20)
              MOVE 0 TO LP-EXTRA-PRIN-LFP ALP-EXTRA-PRIN-LFP
           ELSE
              MOVE OLP-EXTRA-PRIN-LFP        TO LP-EXTRA-PRIN-LFP
                                               ALP-EXTRA-PRIN-LFP.

      * LP-REPAY-TRANS-ID IS A REDEFINE OF LP-EXTRA-PRIN-LFP AND
      * WONT BE NUMERIC IF IT WASNT USED AS LP-REPAY-TRANS-ID AS
      * EXTRA PRIN HAS A $ SIGN, IT WILL BE 00000000?
            IF OLP-REPAY-TRANS-ID NOT NUMERIC OR
               OLP-REPAY-TRANS-ID = 0202020202 OR
               OLP-REPAY-TRANS-ID = 2020202020
               MOVE 0 TO LP-REPAY-TRANS-ID ALP-REPAY-TRANS-ID
            ELSE
               MOVE OLP-REPAY-TRANS-ID TO LP-REPAY-TRANS-ID
                                         ALP-REPAY-TRANS-ID.

           IF OLP-REMAIN-INT-SINCE-LFP NOT NUMERIC OR
                 (OLP-REMAIN-INT-SINCE-LFP = 2020202.02 OR 0202020.20)
              MOVE 0 TO LP-REMAIN-INT-SINCE-LFP
                       ALP-REMAIN-INT-SINCE-LFP
           ELSE
            MOVE OLP-REMAIN-INT-SINCE-LFP TO LP-REMAIN-INT-SINCE-LFP
                                            ALP-REMAIN-INT-SINCE-LFP.

           IF OLP-REMAIN-PRIN-SINCE-LFP NOT NUMERIC OR
                 (OLP-REMAIN-PRIN-SINCE-LFP = 2020202.02 OR 0202020.20)
              MOVE 0 TO LP-REMAIN-PRIN-SINCE-LFP
                       ALP-REMAIN-PRIN-SINCE-LFP
           ELSE
           MOVE OLP-REMAIN-PRIN-SINCE-LFP TO LP-REMAIN-PRIN-SINCE-LFP
                                            ALP-REMAIN-PRIN-SINCE-LFP.

      * 1598 4886-01 002
           IF OLP-APPLIED-TO-ESCROW NOT NUMERIC OR
                 (OLP-APPLIED-TO-ESCROW = 20202.02 OR 02020.20)
              MOVE 0 TO OLP-APPLIED-TO-ESCROW.

           IF PMT-TRCD
              MOVE OLP-APPLIED-TO-ESCROW  TO LP-APPLIED-TO-ESCROW
                                            ALP-APPLIED-TO-ESCROW
              MOVE 0                      TO LP-ESCROW-PREPAID
                                            ALP-ESCROW-PREPAID
           ELSE
           IF OLP-TRCD = "EP"
              MOVE OLP-ESCROW-PREPAID     TO LP-ESCROW-PREPAID
                                            ALP-ESCROW-PREPAID
              MOVE 0                      TO LP-APPLIED-TO-ESCROW
                                            ALP-APPLIED-TO-ESCROW
           ELSE
              MOVE 0                      TO LP-ESCROW-PREPAID
                                            ALP-ESCROW-PREPAID
                                             LP-APPLIED-TO-ESCROW
                                            ALP-APPLIED-TO-ESCROW.


      *THERE ARE 2 LP-TRCD OF "ST", 1 IS USED AS SET TERM IN ADDONS
      *THE OTHER IS "ST" FOR REVOLVING STATMENT RUN.                    
           IF LP-TRCD = "ST"
              MOVE LP-REFNO TO LPWSLP-LP-REFNO
              IF LPWSLP-LP-ADDON-TEXT NOT = "ADD"
                MOVE LP-PAYDATE TO LP-INTPDTH-DATE ALP-INTPDTH-DATE.
       

      *THESE SHOULD BE THE CODES THAT ADVANCE INTEREST PAID THRU TODAY.
      *THINK THERE WILL BE A PROBLEM ON REVERSALS IF WE MOVE LP-PAYDATE
      *ACCROSS ON ALL TRANSCTIONS
           IF LP-TRCD = "PY" OR "PA" OR "PO" OR "PE" OR "SS"
                             OR "RN" OR "SC" OR "PB" OR "RB"
                             OR "RO" OR "DF" OR "D2" OR "D3"
                             OR "D4" OR "D5" OR "D6"
                             OR "D7" OR "D8" OR "D9"
                             OR "AI" OR "CI" OR "IR" OR "IN"
                             OR  "PR" OR "PC" OR "PP"
                             OR "Z2" OR "AH" OR "PN" OR "PZ"
                             OR "BF"
           MOVE LP-PAYDATE TO LP-INTPDTH-DATE ALP-INTPDTH-DATE.

       UPGRADE-FILE-LP-EXIT.
           EXIT.

      
      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S
      *
      *=================================================================
      *          "D" = DEFICIENCY
      *          "F" = FOLLOW
      *          "G" = GPS
      *          "J" = JUDGEMENT
      *          "L" = LEGAL
      *          "M" = MISC
      *          "P" = PDTH
      *          "R" = RESCHEDULE
      *          "X" = REPO
      *          "Y" = REPO
      ******************************************************************
       UPGRADE-FILE-LS SECTION.

           IF ( OLS-CODE = "D" ) PERFORM UPGRADE-FILE-LS-D.
           IF ( OLS-CODE = "F" ) PERFORM UPGRADE-FILE-LS-F.
           IF ( OLS-CODE = "G" ) PERFORM UPGRADE-FILE-LS-G.
           IF ( OLS-CODE = "J" ) PERFORM UPGRADE-FILE-LS-J.
           IF ( OLS-CODE = "L" ) PERFORM UPGRADE-FILE-LS-L.
           IF ( OLS-CODE = "M" ) PERFORM UPGRADE-FILE-LS-M.
           IF ( OLS-CODE = "P" ) PERFORM UPGRADE-FILE-LS-P.
           IF ( OLS-CODE = "R" ) PERFORM UPGRADE-FILE-LS-R.
           IF ( OLS-CODE = "X" ) PERFORM UPGRADE-FILE-LS-X.
           IF ( OLS-CODE = "Y" ) PERFORM UPGRADE-FILE-LS-Y.

       UPGRADE-FILE-LS-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - D
      *
      ******************************************************************
       UPGRADE-FILE-LS-D SECTION.

           MOVE BR-NO      TO LSD-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSD-ACCTNO.
           MOVE 1          TO LSD-SEQNO.
           PERFORM READ-LSD1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-D-EXIT.

           PERFORM CLEAR-LSD-FILE.

           MOVE BR-NO      TO LSD-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSD-ACCTNO.
           MOVE 1          TO LSD-SEQNO.

           MOVE OLS-D-STOLEN-DATE          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSD-STOLEN-DATE.

           IF OLS-D-GAP-INS-PAID NOT NUMERIC
              MOVE 0                       TO LSD-GAP-INS-PAID
           ELSE
              MOVE OLS-D-GAP-INS-PAID      TO LSD-GAP-INS-PAID.
           IF OLS-D-OTHER-EXPENSE NOT NUMERIC
              MOVE 0                       TO LSD-OTHER-EXPENSE
           ELSE
              MOVE OLS-D-OTHER-EXPENSE     TO LSD-OTHER-EXPENSE.
           IF OLS-D-MISC-AMT-EXPENSE NOT NUMERIC
              MOVE 0                      TO LSD-MISC-AMT-EXPENSE
           ELSE
              MOVE OLS-D-MISC-AMT-EXPENSE TO LSD-MISC-AMT-EXPENSE.

           MOVE OLS-D-MISC-DESC-EXPENSE    TO LSD-MISC-DESC-EXPENSE.
           IF OLS-D-TOT-EXPENSE NOT NUMERIC
              MOVE 0                       TO LSD-TOT-EXPENSE
           ELSE
              MOVE OLS-D-TOT-EXPENSE       TO LSD-TOT-EXPENSE.
           IF OLS-D-INT-REB NOT NUMERIC
              MOVE 0                       TO LSD-INT-REB
           ELSE
              MOVE OLS-D-INT-REB           TO LSD-INT-REB.
           IF OLS-D-CPP-REB NOT NUMERIC
              MOVE 0                       TO LSD-CPP-REB
           ELSE
              MOVE OLS-D-CPP-REB           TO LSD-CPP-REB.
           IF OLS-D-GAP-REB NOT NUMERIC
              MOVE 0                       TO LSD-GAP-REB
           ELSE
              MOVE OLS-D-GAP-REB           TO LSD-GAP-REB.
           IF OLS-D-WARRANTY-REB NOT NUMERIC
              MOVE 0                       TO LSD-WARRANTY-REB
           ELSE
              MOVE OLS-D-WARRANTY-REB      TO LSD-WARRANTY-REB.
           IF OLS-D-MISC-AMT-CREDIT NOT NUMERIC
              MOVE 0                     TO LSD-MISC-AMT-CREDIT
           ELSE
              MOVE OLS-D-MISC-AMT-CREDIT TO LSD-MISC-AMT-CREDIT.
           MOVE OLS-D-MISC-DESC-CREDIT     TO LSD-MISC-DESC-CREDIT.
           IF OLS-D-TOT-CREDITS NOT NUMERIC
              MOVE 0                       TO LSD-TOT-CREDITS
           ELSE
              MOVE OLS-D-TOT-CREDITS       TO LSD-TOT-CREDITS.
           IF OLS-D-PAID-TO-OTHER NOT NUMERIC
              MOVE 0                       TO LSD-PAID-TO-OTHER
           ELSE
              MOVE OLS-D-PAID-TO-OTHER     TO LSD-PAID-TO-OTHER.
           IF OLS-D-AMT-FROM-OWING NOT NUMERIC
              MOVE 0                       TO LSD-AMT-FROM-OWING
           ELSE
              MOVE OLS-D-AMT-FROM-OWING    TO LSD-AMT-FROM-OWING.
           IF OLS-D-AMT-OF-SURPLUS NOT NUMERIC
              MOVE 0                       TO LSD-AMT-OF-SURPLUS
           ELSE
              MOVE OLS-D-AMT-OF-SURPLUS    TO LSD-AMT-OF-SURPLUS.
           IF OLS-D-AMT-OF-DEFICIENCY NOT NUMERIC
              MOVE 0                      TO LSD-AMT-OF-DEFICIENCY
           ELSE
             MOVE OLS-D-AMT-OF-DEFICIENCY TO LSD-AMT-OF-DEFICIENCY.
           IF OLS-D-SEND-FMNO NOT NUMERIC
              MOVE 0                       TO LSD-SEND-FMNO
           ELSE
              MOVE OLS-D-SEND-FMNO         TO LSD-SEND-FMNO.
           IF OLS-D-INSURANCE-PROCEEDS NOT NUMERIC
            MOVE 0                        TO LSD-INSURANCE-PROCEEDS
           ELSE
            MOVE OLS-D-INSURANCE-PROCEEDS TO LSD-INSURANCE-PROCEEDS.

           MOVE OLS-D-DATE-CHECK-RECV      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSD-DATE-CHECK-RECV.

           IF OLS-D-INSURANCE-CHECK NOT NUMERIC
              MOVE 0                       TO LSD-INSURANCE-CHECK
           ELSE
              MOVE OLS-D-INSURANCE-CHECK   TO LSD-INSURANCE-CHECK.
           MOVE OLS-D-WHO-ADJUSTED         TO LSD-WHO-ADJUSTED.
           MOVE OLS-D-INS-COMPANY          TO LSD-INS-COMPANY.
           MOVE OLS-D-DEF-LETTER-SENT      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSD-DEF-LETTER-SENT-DATE.

           IF OLS-D-SALES-DATE NOT NUMERIC OR
                 OLS-D-SALES-DATE = 202020
              MOVE 0                       TO LSD-SALES-DATE
           ELSE
              MOVE OLS-D-SALES-DATE        TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD           TO LSD-SALES-DATE.

           MOVE OLS-D-AUCTION              TO LSD-AUCTION.

           IF OLS-D-AUCTN-TIME = 0202 OR 2020 OR -0202 OR -2020
              MOVE 0                       TO LSD-AUCTN-TIME
           ELSE
              MOVE OLS-D-AUCTN-TIME        TO LSD-AUCTN-TIME.

           MOVE OLS-D-AUCTN-ADR            TO LSD-AUCTN-ADR.
           MOVE OLS-D-AUCTN-CITY           TO LSD-AUCTN-CITY.
           MOVE OLS-D-AUCTN-STATE          TO LSD-AUCTN-STATE.
           MOVE OLS-D-AUCTN-ZIP            TO LSD-AUCTN-ZIP.

           IF OLS-D-AUCTN-PHONE = 0202020202 OR  2020202020 OR
                                 -0202020202 OR -2020202020
              MOVE 0                       TO LSD-AUCTN-PHONE
           ELSE
              MOVE OLS-D-AUCTN-PHONE       TO LSD-AUCTN-PHONE.
 
           IF OLS-D-REPO-CHARGE NOT NUMERIC
              MOVE 0                       TO LSD-REPO-CHARGE
           ELSE
              MOVE OLS-D-REPO-CHARGE       TO LSD-REPO-CHARGE.
           IF OLS-D-STORAGE-CHARGE NOT NUMERIC
              MOVE 0                       TO LSD-STORAGE-CHARGE
           ELSE
              MOVE OLS-D-STORAGE-CHARGE    TO LSD-STORAGE-CHARGE.
           IF OLS-D-REPAIR-CHARGE NOT NUMERIC
              MOVE 0                       TO LSD-REPAIR-CHARGE
           ELSE
              MOVE OLS-D-REPAIR-CHARGE     TO LSD-REPAIR-CHARGE.
           IF OLS-D-OTHER-CHARGE NOT NUMERIC
              MOVE 0                       TO LSD-OTHER-CHARGE
           ELSE
              MOVE OLS-D-OTHER-CHARGE      TO LSD-OTHER-CHARGE.
           IF OLS-D-STORAGE-RATE NOT NUMERIC
              MOVE 0                       TO LSD-STORAGE-RATE
           ELSE
              MOVE OLS-D-STORAGE-RATE      TO LSD-STORAGE-RATE.
           IF OLS-D-EST-REBATE NOT NUMERIC
              MOVE 0                       TO LSD-EST-REBATE
           ELSE
              MOVE OLS-D-EST-REBATE        TO LSD-EST-REBATE.
           IF OLS-D-MINIMUM-BID NOT NUMERIC
              MOVE 0                       TO LSD-MINIMUM-BID
           ELSE
              MOVE OLS-D-MINIMUM-BID       TO LSD-MINIMUM-BID.
           MOVE OLS-D-MAY-REINSTATE        TO LSD-MAY-REINSTATE.
           MOVE OLS-D-MAY-NOT-REINSTATE    TO LSD-MAY-NOT-REINSTATE.
           MOVE OLS-D-IN-PAST-12MONTHS     TO LSD-IN-PAST-12MONTHS.
           MOVE OLS-D-2X-DURING-CONTRACT   TO LSD-2X-DURING-CONTRACT.
           MOVE OLS-D-OTHER                TO LSD-OTHER.
           MOVE OLS-D-OTHER-COMMENTS1      TO LSD-OTHER-COMMENTS1.
           MOVE OLS-D-OTHER-COMMENTS2      TO LSD-OTHER-COMMENTS2.
           MOVE OLS-D-CA-PYMTS-AS-AGREED   TO LSD-CA-PYMTS-AS-AGREED.
           MOVE OLS-D-CA-KEEP-INS          TO LSD-CA-KEEP-INS.
           MOVE OLS-D-CA-KEEP-LIEN-FREE    TO LSD-CA-KEEP-LIEN-FREE.
           MOVE OLS-D-CA-OTHER             TO LSD-CA-OTHER.
           MOVE OLS-D-CA-OTHER-DESC        TO LSD-CA-OTHER-DESC.
           MOVE OLS-D-CURE                 TO LSD-CURE.

           PERFORM WRITE-LSD1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSD"                   TO UP1534-CURRENT-FILE
              MOVE LSD1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-D-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-D-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - F
      *
      ******************************************************************
       UPGRADE-FILE-LS-F SECTION.

           MOVE BR-NO      TO LSF-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSF-ACCTNO.
           MOVE 1          TO LSF-SEQNO.
           PERFORM READ-LSF1-FILE.
           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-F-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM CLEAR-LSF-FILE.
           MOVE BR-NO      TO LSF-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSF-ACCTNO.
           MOVE 1          TO LSF-SEQNO.

           MOVE OLS-F-SKIP-START-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-SKIP-START-DATE.
           MOVE OLS-F-SKIP-END-DATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-SKIP-END-DATE.

           MOVE OLS-F-OFR-START-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-OFR-START-DATE.
           MOVE OLS-F-OFR-END-DATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-OFR-END-DATE.

           MOVE OLS-F-IMPOUND-START-DATE  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-IMPOUND-START-DATE.
           MOVE OLS-F-IMPOUND-END-DATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-IMPOUND-END-DATE.

           MOVE OLS-F-BNKRPT-START-DATE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-BNKRPT-START-DATE.
           MOVE OLS-F-BNKRPT-END-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-BNKRPT-END-DATE.
           MOVE OLS-F-INSUR-START-DATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-INSUR-START-DATE.
           MOVE OLS-F-INSUR-END-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-INSUR-END-DATE.

           MOVE OLS-F-COLLECT-START-DATE  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-COLLECT-START-DATE.
           MOVE OLS-F-COLLECT-END-DATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSF-COLLECT-END-DATE.

           PERFORM WRITE-LSF1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSF"                   TO UP1534-CURRENT-FILE
              MOVE LSF1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-F-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-F-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - G
      *
      ******************************************************************
       UPGRADE-FILE-LS-G SECTION.

           MOVE BR-NO      TO LSG-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSG-ACCTNO.
           MOVE 1          TO LSG-SEQNO.
           PERFORM READ-LSG1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-G-EXIT.

           PERFORM CLEAR-LSG-FILE.

           MOVE BR-NO      TO LSG-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSG-ACCTNO.
           MOVE 1          TO LSG-SEQNO.

           MOVE OLS-G-SERIAL-NO             TO LSG-SERIAL-NO
           MOVE OLS-G-STARTER-STAT          TO LSG-STARTER-STAT
           MOVE OLS-G-WARNING-STAT          TO LSG-WARNING-STAT
           MOVE OLS-G-RECOVERY-STAT         TO LSG-RECOVERY-STAT

           MOVE OLS-G-LAST-COMMAND-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSG-LAST-COMMAND-DATE.

           MOVE OLS-G-LAST-ADDRESS        TO LSG-LAST-ADDRESS
           MOVE OLS-G-LAST-AUTO-REPORT-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSG-LAST-AUTO-REPORT-DATE.
           MOVE OLS-G-GPS-INSTALLER       TO LSG-GPS-INSTALLER.

           PERFORM WRITE-LSG1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSG"                   TO UP1534-CURRENT-FILE
              MOVE LSG1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-G-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-G-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - J
      *
      ******************************************************************
       UPGRADE-FILE-LS-J SECTION.

           MOVE BR-NO      TO LSJ-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSJ-ACCTNO.
           MOVE 1          TO LSJ-SEQNO.
           PERFORM READ-LSJ1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-J-EXIT.

           PERFORM CLEAR-LSJ-FILE.

           MOVE BR-NO      TO LSJ-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSJ-ACCTNO.
           MOVE 1          TO LSJ-SEQNO.

           MOVE OLS-J-FILEDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO LSJ-FILEDATE.

           MOVE OLS-J-CASE-NO         TO LSJ-CASE-NO.
           IF OLS-J-AMT NOT NUMERIC
              MOVE 0                  TO LSJ-AMT
           ELSE
              MOVE OLS-J-AMT          TO LSJ-AMT.
           MOVE OLS-J-COUNTY          TO LSJ-COUNTY.
           MOVE OLS-J-CLERK-NAME      TO LSJ-CLERK-NAME.
           MOVE OLS-J-CLERK-ADDR      TO LSJ-CLERK-ADDR.
           MOVE OLS-J-CLERK-CITY      TO LSJ-CLERK-CITY.
           MOVE OLS-J-CLERK-STATE     TO LSJ-CLERK-STATE.
           MOVE OLS-J-CLERK-ZIP       TO LSJ-CLERK-ZIP.
          
           IF OLS-J-CLERK-PHONE NOT NUMERIC
              MOVE 0                  TO LSJ-CLERK-PHONE
           ELSE
              MOVE OLS-J-CLERK-PHONE  TO LSJ-CLERK-PHONE.
           IF OLS-J-SHERIFF-FEE NOT NUMERIC
              MOVE 0                  TO LSJ-SHERIFF-FEE
           ELSE
              MOVE OLS-J-SHERIFF-FEE  TO LSJ-SHERIFF-FEE.
           IF OLS-J-COURT-FEE NOT NUMERIC
              MOVE 0                  TO LSJ-COURT-FEE
           ELSE
              MOVE OLS-J-COURT-FEE    TO LSJ-COURT-FEE.
           IF OLS-J-ATTY-FEE NOT NUMERIC
              MOVE 0                  TO LSJ-ATTY-FEE
           ELSE
              MOVE OLS-J-ATTY-FEE     TO LSJ-ATTY-FEE.
           MOVE OLS-J-DISMISS-DATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO LSJ-DISMISS-DATE.

           MOVE OLS-J-GARN-INFO       TO LSJ-GARN-INFO
           MOVE OLS-J-EMPLOY-NAME     TO LSJ-EMPLOY-NAME
           MOVE OLS-J-EMPLOY-ADDR     TO LSJ-EMPLOY-ADDR
           MOVE OLS-J-EMPLOY-CITY     TO LSJ-EMPLOY-CITY
           MOVE OLS-J-EMPLOY-STATE    TO LSJ-EMPLOY-STATE
           MOVE OLS-J-EMPLOY-ZIP      TO LSJ-EMPLOY-ZIP
           MOVE OLS-J-GARN-DATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO LSJ-GARN-DATE.

           MOVE OLS-J-JD-FILED-ON     TO LSJ-JD-FILED-ON
           MOVE OLS-J-GARN-FILED-ON   TO LSJ-GARN-FILED-ON
           MOVE OLS-J-ATTY-NAME       TO LSJ-ATTY-NAME
           MOVE OLS-J-ATTY-ADDR       TO LSJ-ATTY-ADDR
           MOVE OLS-J-ATTY-CITY       TO LSJ-ATTY-CITY
           MOVE OLS-J-ATTY-STATE      TO LSJ-ATTY-STATE
           MOVE OLS-J-ATTY-ZIP        TO LSJ-ATTY-ZIP
           IF OLS-J-ATTY-PHONE NOT NUMERIC
              MOVE 0 TO LSJ-ATTY-PHONE
           ELSE
              MOVE OLS-J-ATTY-PHONE   TO LSJ-ATTY-PHONE.

           PERFORM WRITE-LSJ1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSJ"                   TO UP1534-CURRENT-FILE
              MOVE LSJ1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-J-EXIT
              ELSE
                 GO TO IO-ERROR.
           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-J-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - L
      *
      ******************************************************************
       UPGRADE-FILE-LS-L SECTION.

           MOVE BR-NO      TO LSL-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSL-ACCTNO.
           MOVE 1          TO LSL-SEQNO.
           PERFORM READ-LSL1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-L-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM CLEAR-LSL-FILE.
           MOVE BR-NO      TO LSL-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSL-ACCTNO.
           MOVE 1          TO LSL-SEQNO.

           MOVE OLS-L-DATE-SUIT-AUTH    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD           TO LSL-DATE-SUIT-AUTH.
           MOVE OLS-L-DATE-SUIT-AUTH-BY   TO LSL-DATE-SUIT-AUTH-BY
           MOVE OLS-L-ATTORNEY-NET-ASSIGN TO LSL-ATTORNEY-NET-ASSIGN
           MOVE OLS-L-LOCAL-ATTORNEY      TO LSL-LOCAL-ATTORNEY.
           MOVE OLS-L-ATTORNEY-ADDRESS    TO LSL-ATTORNEY-ADDRESS.
           IF OLS-L-ATTORNEY-PHONE NOT NUMERIC
              MOVE 0                      TO LSL-ATTORNEY-PHONE
           ELSE
              MOVE OLS-L-ATTORNEY-PHONE   TO LSL-ATTORNEY-PHONE.

           MOVE OLS-L-DATE-ASSIGNED       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSL-DATE-ASSIGNED.
           MOVE OLS-L-ATTORNEY-ACCTNO     TO LSL-ATTORNEY-ACCTNO.
           IF OLS-L-PRIN-BAL-SENT NOT NUMERIC
              MOVE 0                        TO LSL-PRIN-BAL-SENT
           ELSE
              MOVE OLS-L-PRIN-BAL-SENT      TO LSL-PRIN-BAL-SENT.
           MOVE OLS-L-RECEIVED-ACKNOW       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-RECEIVED-ACKNOW-DATE.

           MOVE OLS-L-ATTORNEY-LETTER-SENT  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD          TO LSL-ATTORNEY-LETTER-SENT-DATE.

           MOVE OLS-L-HOLD-DATE             TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-HOLD-DATE.

           MOVE OLS-L-RESPONSE-RECEIVED     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSL-RESPONSE-RECEIVED-DATE.

           MOVE OLS-L-SUIT-DATE             TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-SUIT-DATE.

           MOVE OLS-L-SUIT-FILED            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-SUIT-FILED-DATE.
           MOVE OLS-L-SERVICE-DATE          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-SERVICE-DATE.

           MOVE OLS-L-CUSTOMER-SERVED       TO LSL-CUSTOMER-SERVED.
           MOVE OLS-L-ANSWER-FILED          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-ANSWER-FILED-DATE.
           MOVE OLS-L-COURT-DATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-COURT-DATE.
           MOVE OLS-L-JUDGMENT-TYPE         TO LSL-JUDGMENT-TYPE.
           MOVE OLS-L-JUDGMENT-OBTAINED     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD          TO LSL-JUDGMENT-OBTAINED-DATE.
           MOVE OLS-L-JUDGMENT-COPY-FILED TO LSL-JUDGMENT-COPY-FILED.
           IF OLS-L-JUDGMENT-AMT NOT NUMERIC
              MOVE 0                        TO LSL-JUDGMENT-AMT
           ELSE
              MOVE OLS-L-JUDGMENT-AMT       TO LSL-JUDGMENT-AMT.
           IF OLS-L-JUDGMENT-PRIN NOT NUMERIC
              MOVE 0                        TO LSL-JUDGMENT-PRIN
           ELSE
              MOVE OLS-L-JUDGMENT-PRIN      TO LSL-JUDGMENT-PRIN.
           IF OLS-L-POST-JUDG-INT-RATE NOT NUMERIC
              MOVE 0                    TO LSL-POST-JUDG-INT-RATE
           ELSE
              MOVE OLS-L-POST-JUDG-INT-RATE TO
                                           LSL-POST-JUDG-INT-RATE.
           IF OLS-L-JUDG-INT-AMT NOT NUMERIC
              MOVE 0                        TO LSL-JUDG-INT-AMT
           ELSE
              MOVE OLS-L-JUDG-INT-AMT       TO LSL-JUDG-INT-AMT.
           IF OLS-L-ATTORNEY-FEES-ALLOWED NOT NUMERIC
              MOVE 0                           TO
                                         LSL-ATTORNEY-FEES-ALLOWED
           ELSE
              MOVE OLS-L-ATTORNEY-FEES-ALLOWED TO
                                         LSL-ATTORNEY-FEES-ALLOWED.
           IF OLS-L-OTHER-FEES-ALLOWED NOT NUMERIC
              MOVE 0                           TO
                                            LSL-OTHER-FEES-ALLOWED
           ELSE
              MOVE OLS-L-OTHER-FEES-ALLOWED    TO
                                            LSL-OTHER-FEES-ALLOWED.
           IF OLS-L-JUDG-INT-RATE NOT NUMERIC
              MOVE 0                      TO LSL-JUDG-INT-RATE
           ELSE
              MOVE OLS-L-JUDG-INT-RATE    TO LSL-JUDG-INT-RATE.
           MOVE OLS-L-ASSET-USED-IN-SUIT  TO LSL-ASSET-USED-IN-SUIT.
           MOVE OLS-L-GARN-FILED-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSL-GARN-FILED-DATE.
           IF OLS-L-GARN-TERM-DAYS NOT NUMERIC
              MOVE 0                      TO LSL-GARN-TERM-DAYS
           ELSE
              MOVE OLS-L-GARN-TERM-DAYS   TO LSL-GARN-TERM-DAYS.
           MOVE OLS-L-INTERROGATORY-SENT  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD           TO LSL-INTERROGATORY-SENT-DATE.
           MOVE OLS-L-INTERROGATORY-ANSW  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD           TO LSL-INTERROGATORY-ANSW-DATE.
           MOVE OLS-L-FIFA-SENT             TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD           TO LSL-FIFA-SENT-DATE.
           MOVE OLS-L-FIFA-ANSWERED         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-FIFA-ANSWERED-DATE.
           MOVE OLS-L-DATE-TO-RECV-PAY      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-DATE-TO-RECV-PAY.
           MOVE OLS-L-FOLLOWUP-DATE         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-FOLLOWUP-DATE.
           MOVE OLS-L-FIFA-RENEWED          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-FIFA-RENEWED-DATE.
           MOVE OLS-L-PAYS-RECV-ATTORNEY    TO LSL-PAYS-RECV-ATTORNEY.
           MOVE OLS-L-DATE-CLOSED           TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD               TO LSL-DATE-CLOSED.
           MOVE OLS-L-REASON-CLOSED         TO LSL-REASON-CLOSED.

           PERFORM WRITE-LSL1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSL"                   TO UP1534-CURRENT-FILE
              MOVE LSL1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE

              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-L-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-L-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - M
      *
      ******************************************************************
       UPGRADE-FILE-LS-M SECTION.

           MOVE BR-NO      TO LSM-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSM-ACCTNO.
           MOVE 1          TO LSM-SEQNO.
           PERFORM READ-LSM1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-M-EXIT.

           PERFORM CLEAR-LSM-FILE.

           MOVE BR-NO      TO LSM-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSM-ACCTNO.
           MOVE 1          TO LSM-SEQNO.

           MOVE OLS-MISC-AREA TO LSM-MISC-AREA.

      * NEW #1547 3/22/2022
           IF OLS-M-TRANS-FROM-BRNO NOT NUMERIC OR
                (OLS-M-TRANS-FROM-BRNO = 2020 OR 0202)
              MOVE 0               TO LSM-TRANS-FROM-BRNO
           ELSE
              MOVE OLS-M-TRANS-FROM-BRNO TO LSM-TRANS-FROM-BRNO.
           IF OLS-M-TRANS-FROM-ACCTNO NOT NUMERIC OR
                (OLS-M-TRANS-FROM-ACCTNO = 20202020 OR 02020202)
              MOVE 0               TO LSM-TRANS-FROM-ACCTNO
           ELSE
              MOVE OLS-M-TRANS-FROM-ACCTNO TO LSM-TRANS-FROM-ACCTNO.

           MOVE OLS-M-TRANS-FROM-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSM-TRANS-FROM-DATE.

           MOVE OLS-M-MISPAY-90-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO LSM-MISPAY-90-DATE.

           MOVE OLS-M-SECOND-BEN-NAME      TO LSM-SECOND-BEN-NAME.
           MOVE OLS-M-SECOND-BEN-ADR       TO LSM-SECOND-BEN-ADR.
           MOVE OLS-M-SECOND-BEN-CITY      TO LSM-SECOND-BEN-CITY.
           MOVE OLS-M-SECOND-BEN-STATE     TO LSM-SECOND-BEN-STATE.
           MOVE OLS-M-SECOND-BEN-ZIP       TO LSM-SECOND-BEN-ZIP.
           IF OLS-M-SECOND-BEN-PHONE NOT NUMERIC OR
                (OLS-M-SECOND-BEN-PHONE = 2020202020 OR 0202020202)
              MOVE 0                       TO LSM-SECOND-BEN-PHONE
           ELSE
              MOVE OLS-M-SECOND-BEN-PHONE  TO LSM-SECOND-BEN-PHONE.
           MOVE OLS-M-SECOND-BEN-RELATION  TO LSM-SECOND-BEN-RELATION.


           PERFORM WRITE-LSM1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSM"                   TO UP1534-CURRENT-FILE
              MOVE LSM1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-M-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-M-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - P
      *
      ******************************************************************
       UPGRADE-FILE-LS-P SECTION.

           MOVE BR-NO      TO LSP-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSP-ACCTNO.
           MOVE 1          TO LSP-SEQNO.
           PERFORM READ-LSP1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-P-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM CLEAR-LSP-FILE.
           MOVE BR-NO      TO LSP-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSP-ACCTNO.
           MOVE 1          TO LSP-SEQNO.

           MOVE OLS-P-REASON-CODE          TO LSP-REASON-CODE.
           IF OLS-P-PERIODS-TO-DEFER NOT NUMERIC
              MOVE 0                       TO LSP-PERIODS-TO-DEFER
           ELSE
              MOVE OLS-P-PERIODS-TO-DEFER  TO LSP-PERIODS-TO-DEFER.
           MOVE OLS-P-REASON-FOR-DEFER     TO LSP-REASON-FOR-DEFER.
           MOVE OLS-P-MORTGAGE-PAST-DUE    TO LSP-MORTGAGE-PAST-DUE.
           IF OLS-P-MORTGAGE-BALANCE NOT NUMERIC
              MOVE 0                       TO LSP-MORTGAGE-BALANCE
           ELSE
              MOVE OLS-P-MORTGAGE-BALANCE  TO LSP-MORTGAGE-BALANCE.
           MOVE OLS-P-ATTEMPT-REFINANCE    TO LSP-ATTEMPT-REFINANCE.
           MOVE OLS-P-INFO-DATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSP-INFO-DATE.
           MOVE OLS-P-INFO-USERID          TO LSP-INFO-USERID.
           MOVE OLS-P-BR-MANAGER-COMMENTS  TO LSP-BR-MANAGER-COMMENTS.
           MOVE OLS-P-BR-MANAGER-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSP-BR-MANAGER-DATE.
           MOVE OLS-P-BR-MANAGER-USERID    TO LSP-BR-MANAGER-USERID.
           MOVE OLS-P-AVP-COMMENTS         TO LSP-AVP-COMMENTS.
           MOVE OLS-P-AVP-DATE             TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSP-AVP-DATE.
           MOVE OLS-P-AVP-USERID           TO LSP-AVP-USERID.
           MOVE OLS-P-AVP-APPROVE          TO LSP-AVP-APPROVE.
           MOVE OLS-P-VP-COMMENTS          TO LSP-VP-COMMENTS.
           MOVE OLS-P-VP-DATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSP-VP-DATE.
           MOVE OLS-P-VP-USERID            TO LSP-VP-USERID.
           MOVE OLS-P-VP-APPROVE           TO LSP-VP-APPROVE.

           PERFORM WRITE-LSP1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSP"                   TO UP1534-CURRENT-FILE
              MOVE LSP1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-P-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-P-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - R 
      *
      ******************************************************************
       UPGRADE-FILE-LS-R SECTION.

           MOVE BR-NO      TO LSR-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSR-ACCTNO.
           MOVE 1          TO LSR-SEQNO.
           PERFORM READ-LSR1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-R-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM CLEAR-LSR-FILE.
           MOVE BR-NO      TO LSR-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSR-ACCTNO.
           MOVE 1          TO LSR-SEQNO.

           MOVE OLS-R-SCRA-ACTIVE          TO LSR-SCRA-ACTIVE.

           MOVE OLS-R-SCRA-START-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-SCRA-START-DATE.

           MOVE OLS-R-SCRA-END-DATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-SCRA-END-DATE.

           MOVE OLS-R-SCRA-BORROWER        TO LSR-SCRA-BORROWER.

           MOVE OLS-R-CURRENT-RESCHED-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-CURRENT-RESCHED-DATE.
           MOVE OLS-R-CURRENT-REASON-CODE  TO LSR-CURRENT-REASON-CODE.

           MOVE OLS-R-INITIAL-RESCHED-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-INITIAL-RESCHED-DATE.
           MOVE OLS-R-INITIAL-REASON-CODE  TO LSR-INITIAL-REASON-CODE.

           MOVE OLS-R-INITIAL-TDR-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-INITIAL-TDR-DATE.
           MOVE OLS-R-INITIAL-TDR-REASON   TO LSR-INITIAL-TDR-REASON.

           MOVE OLS-R-CURRENT-TDR-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO LSR-CURRENT-TDR-DATE.
           MOVE OLS-R-CURRENT-TDR-REASON   TO LSR-CURRENT-TDR-REASON.

           PERFORM WRITE-LSR1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSR"                   TO UP1534-CURRENT-FILE
              MOVE LSR1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LS-R-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LS-R-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - X
      *
      *=================================================================
      * REPO RECORDS HAVE MULTIPLE SEQUENCES FOR REPO AND REDEEMING AND
      * REVERSING...
      *
      * REPO IS CONVERTING MULTIPLE SEQUENCES AND ALSO MERGING "Y" CODE
      * INTO "X" CODE
      *
      * THIS WILL ONLY DO "X" RECORDS
      *
      ******************************************************************
       UPGRADE-FILE-LS-X SECTION.

           MOVE BR-NO      TO LSX-BRNO.
           MOVE OLS-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LSX-ACCTNO.
           MOVE OLS-SEQNO  TO LSX-SEQNO.
           PERFORM READ-LSX1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-X-CONTINUE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LSX-REC DOES NOT EXIST; CREATE NEW LSX-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM CLEAR-LSX-FILE.
           MOVE BR-NO                      TO LSX-BRNO.
           MOVE OLS-ACCTNO                 TO OLD-ACCTNO.
           MOVE NEW-ACCTNO                 TO LSX-ACCTNO.
           MOVE OLS-SEQNO                  TO LSX-SEQNO.
           PERFORM WRITE-LSX1-FILE.

           IF ( IO-BAD )
              MOVE "LSX"                   TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO UPGRADE-FILE-LS-X-EXIT
              ELSE
                 GO TO IO-ERROR.
           MOVE BR-NO                      TO LSX-BRNO.
           MOVE OLS-ACCTNO                 TO OLD-ACCTNO.
           MOVE NEW-ACCTNO                 TO LSX-ACCTNO.
           MOVE OLS-SEQNO                  TO LSX-SEQNO.
           PERFORM READ-LSX1-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSX"                   TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *-----------------------------------------------------------------
       UPGRADE-FILE-LS-X-CONTINUE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      * RECORD!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE 0 TO LSX-LTOUCH-DATE.

           MOVE OLS-X-REPODATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-REPODATE.

           IF OLS-X-TITLE-MILEAGE NOT NUMERIC
              MOVE 0                   TO LSX-TITLE-MILEAGE
           ELSE
              MOVE OLS-X-TITLE-MILEAGE TO LSX-TITLE-MILEAGE.
           MOVE OLS-X-VOLUNTARY-FG    TO LSX-VOLUNTARY-FG.
           MOVE OLS-X-PERFECT         TO LSX-PERFECT.

           MOVE OLS-X-AUTHORIZED-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-AUTHORIZED-DATE.

           MOVE OLS-X-AUTHORIZED-BY   TO LSX-AUTHORIZED-BY.
           MOVE OLS-X-REASON          TO LSX-REASON.
           MOVE OLS-X-ASSIGNED-TO     TO LSX-X-ASSIGNED-TO.
           MOVE OLS-X-ASSIGNED-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-ASSIGNED-DATE.

           IF OLS-X-REPO-CKNO NOT NUMERIC
              MOVE 0                  TO LSX-REPO-CKNO
           ELSE
              MOVE OLS-X-REPO-CKNO    TO LSX-REPO-CKNO.
           MOVE OLS-X-REPO-CKDATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-REPO-CKDATE.
           IF OLS-X-REPO-CKAMT NOT NUMERIC
              MOVE 0                  TO LSX-REPO-CKAMT
           ELSE
              MOVE OLS-X-REPO-CKAMT   TO LSX-REPO-CKAMT.

           MOVE OLS-X-STORED-ADR1     TO LSX-STORED-ADR1.
           MOVE OLS-X-STORED-CKDATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-STORED-CKDATE.
           IF OLS-X-STORED-CKNO NOT NUMERIC
              MOVE 0                  TO LSX-STORED-CKNO
           ELSE
              MOVE OLS-X-STORED-CKNO  TO LSX-STORED-CKNO.
           IF OLS-X-STORED-CKAMT NOT NUMERIC
              MOVE 0                  TO LSX-STORED-CKAMT
           ELSE
              MOVE OLS-X-STORED-CKAMT TO LSX-STORED-CKAMT.

           MOVE OLS-X-REDEEM-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-REDEEM-DATE.
           MOVE OLS-X-BUREAU-NOTIFIED  TO LSX-BUREAU-NOTIFIED.
           MOVE OLS-X-BUREAU-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-BUREAU-DATE.
           MOVE OLS-X-BUREAU-BY        TO LSX-BUREAU-BY.

           MOVE OLS-X-10DAY-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-10DAY-DATE.
           MOVE OLS-X-10DAY-BY         TO LSX-10DAY-BY.
           IF OLS-X-10DAY-COST NOT NUMERIC
              MOVE 0                   TO LSX-10DAY-COST
           ELSE
              MOVE OLS-X-10DAY-COST    TO LSX-10DAY-COST.

           MOVE OLS-X-TITLE-APPL-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-TITLE-APPL-DATE.
           MOVE OLS-X-TITLE-APPL-BY     TO LSX-TITLE-APPL-BY.
           IF OLS-X-TITLE-APPL-COST NOT NUMERIC
             MOVE 0                     TO LSX-TITLE-APPL-COST
           ELSE
             MOVE OLS-X-TITLE-APPL-COST TO LSX-TITLE-APPL-COST.

          
           IF OLS-X-COND-MILEAGE NOT NUMERIC
              MOVE 0                    TO LSX-COND-MILEAGE
           ELSE
              MOVE OLS-X-COND-MILEAGE   TO LSX-COND-MILEAGE.
           MOVE OLS-X-COND-REPORT-Y-N   TO LSX-COND-REPORT-Y-N.

           MOVE OLS-X-REPAIRS-DESC(1) TO LSX-REPAIRS-DESC(1).
           MOVE OLS-X-REPAIRS-DESC(2) TO LSX-REPAIRS-DESC(2).
           IF OLS-X-REPAIRS-COST NOT NUMERIC
              MOVE 0                  TO LSX-REPAIRS-COST
           ELSE
              MOVE OLS-X-REPAIRS-COST TO LSX-REPAIRS-COST.
           MOVE OLS-X-ASSIGN-TO(1) TO LSX-ASSIGN-TO(1).
           MOVE OLS-X-ASSIGN-TO(2) TO LSX-ASSIGN-TO(2).

           MOVE OLS-X-ASSIGN-COMPLETE(1) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-ASSIGN-COMPLETE-DATE(1).
           MOVE OLS-X-ASSIGN-COMPLETE(2) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-ASSIGN-COMPLETE-DATE(2).
           MOVE OLS-X-ASSIGN-CKDATE(1) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-ASSIGN-CKDATE(1).
           MOVE OLS-X-ASSIGN-CKDATE(2) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-ASSIGN-CKDATE(2).
           IF OLS-X-ASSIGN-CKNO(1) NOT NUMERIC
              MOVE 0                    TO LSX-ASSIGN-CKNO(1)
           ELSE
              MOVE OLS-X-ASSIGN-CKNO(1) TO LSX-ASSIGN-CKNO(1).
           IF OLS-X-ASSIGN-CKNO(2) NOT NUMERIC
              MOVE 0                    TO LSX-ASSIGN-CKNO(2)
           ELSE
              MOVE OLS-X-ASSIGN-CKNO(2) TO LSX-ASSIGN-CKNO(2).
           IF OLS-X-ASSIGN-CKAMT(1) NOT NUMERIC
              MOVE 0                     TO LSX-ASSIGN-CKAMT(1)
           ELSE
              MOVE OLS-X-ASSIGN-CKAMT(1) TO LSX-ASSIGN-CKAMT(1).
           IF OLS-X-ASSIGN-CKAMT(2) NOT NUMERIC
              MOVE 0                     TO LSX-ASSIGN-CKAMT(2)
           ELSE
              MOVE OLS-X-ASSIGN-CKAMT(2) TO LSX-ASSIGN-CKAMT(2).

           MOVE OLS-X-OTH-EXP(1)      TO LSX-OTH-EXP(1).
           MOVE OLS-X-OTH-EXP(2)      TO LSX-OTH-EXP(2).
           MOVE OLS-X-OTH-EXP(3)      TO LSX-OTH-EXP(3).

           MOVE OLS-X-OTH-EXP-CKDATE(1) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-OTH-EXP-CKDATE(1).

           MOVE OLS-X-OTH-EXP-CKDATE(2) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-OTH-EXP-CKDATE(2).

           MOVE OLS-X-OTH-EXP-CKDATE(3) TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-OTH-EXP-CKDATE(3).

           IF OLS-X-OTH-EXP-CKNO(1) NOT NUMERIC
              MOVE 0                     TO LSX-OTH-EXP-CKNO(1)
           ELSE
              MOVE OLS-X-OTH-EXP-CKNO(1) TO LSX-OTH-EXP-CKNO(1).

           IF OLS-X-OTH-EXP-CKNO(2) NOT NUMERIC
              MOVE 0                     TO LSX-OTH-EXP-CKNO(2)
           ELSE
              MOVE OLS-X-OTH-EXP-CKNO(2) TO LSX-OTH-EXP-CKNO(2).

           IF OLS-X-OTH-EXP-CKNO(3) NOT NUMERIC
              MOVE 0                     TO LSX-OTH-EXP-CKNO(3)
           ELSE
              MOVE OLS-X-OTH-EXP-CKNO(3) TO LSX-OTH-EXP-CKNO(3).

           IF OLS-X-OTH-EXP-CKAMT(1) NOT NUMERIC
              MOVE 0                      TO LSX-OTH-EXP-CKAMT(1)
           ELSE
              MOVE OLS-X-OTH-EXP-CKAMT(1) TO LSX-OTH-EXP-CKAMT(1).

           IF OLS-X-OTH-EXP-CKAMT(2) NOT NUMERIC
              MOVE 0                      TO LSX-OTH-EXP-CKAMT(2)
           ELSE
              MOVE OLS-X-OTH-EXP-CKAMT(2) TO LSX-OTH-EXP-CKAMT(2).

           IF OLS-X-OTH-EXP-CKAMT(3) NOT NUMERIC
              MOVE 0                      TO LSX-OTH-EXP-CKAMT(3)
           ELSE
              MOVE OLS-X-OTH-EXP-CKAMT(3) TO LSX-OTH-EXP-CKAMT(3).

           MOVE OLS-X-INS-RB-REQ-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-INS-RB-REQ-DATE.
           MOVE OLS-X-INS-RB-REC-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-INS-RB-REC-DATE.
           IF OLS-X-INS-RB-AMT NOT NUMERIC
              MOVE 0                TO LSX-INS-RB-AMT
           ELSE
              MOVE OLS-X-INS-RB-AMT TO LSX-INS-RB-AMT.

           MOVE OLS-X-RB-REQ-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-RB-REQ-DATE.
           MOVE OLS-X-RB-REC-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-RB-REC-DATE.
           IF OLS-X-RB-AMT NOT NUMERIC
              MOVE 0             TO LSX-RB-AMT
           ELSE
              MOVE OLS-X-RB-AMT  TO LSX-RB-AMT.

           MOVE OLS-X-SIC-INS-FILE-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-SIC-INS-FILE-DATE.
           MOVE OLS-X-SIC-INS-PAID-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-SIC-INS-PAID-DATE.

           IF OLS-X-SIC-INS-PAID-AMT NOT NUMERIC
              MOVE 0                      TO
                                         LSX-SIC-INS-PAID-AMT
           ELSE
              MOVE OLS-X-SIC-INS-PAID-AMT TO
                                         LSX-SIC-INS-PAID-AMT.
           IF OLS-X-BOOK-VALUE NOT NUMERIC
              MOVE 0                   TO LSX-BOOK-VALUE
           ELSE
              MOVE OLS-X-BOOK-VALUE    TO LSX-BOOK-VALUE.
           MOVE OLS-X-SOLD-TO (1) TO LSX-SOLD-TO(1).
           MOVE OLS-X-SOLD-TO (2) TO LSX-SOLD-TO(2).
           MOVE OLS-X-SOLD-TO (3) TO LSX-SOLD-TO(3).

           MOVE OLS-X-SOLD-TO-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-SOLD-TO-DATE.
           IF OLS-X-SOLD-TO-AMT NOT NUMERIC
              MOVE 0                 TO LSX-SOLD-TO-AMT
           ELSE
              MOVE OLS-X-SOLD-TO-AMT TO LSX-SOLD-TO-AMT.
           IF OLS-X-DLNO NOT NUMERIC
              MOVE 0                 TO LSX-DLNO
           ELSE
              MOVE OLS-X-DLNO        TO LSX-DLNO.
           IF OLS-X-DLR-RSV-CKNO NOT NUMERIC
              MOVE 0                  TO LSX-DLR-RSV-CKNO
           ELSE
              MOVE OLS-X-DLR-RSV-CKNO TO LSX-DLR-RSV-CKNO.
           IF OLS-X-DLR-RSV-CKAMT NOT NUMERIC
              MOVE 0                   TO LSX-DLR-RSV-CKAMT
           ELSE
              MOVE OLS-X-DLR-RSV-CKAMT TO LSX-DLR-RSV-CKAMT.
           IF OLS-X-PL-EXPENSE NOT NUMERIC
              MOVE 0                 TO LSX-PL-EXPENSE
           ELSE
              MOVE OLS-X-PL-EXPENSE  TO LSX-PL-EXPENSE.
           MOVE OLS-X-DEFICIENCY-Y-N TO LSX-DEFICIENCY-Y-N.
           IF OLS-X-NET-BAL-DUE NOT NUMERIC
              MOVE 0                 TO LSX-NET-BAL-DUE
           ELSE
              MOVE OLS-X-NET-BAL-DUE TO LSX-NET-BAL-DUE.
           IF OLS-X-DEFICIENCY-BAL NOT NUMERIC
              MOVE 0                    TO LSX-DEFICIENCY-BAL
           ELSE
              MOVE OLS-X-DEFICIENCY-BAL TO LSX-DEFICIENCY-BAL.
      * BR 18 44720-01 X
           IF OLS-X-AUCTION-EXPENSE NOT NUMERIC
              MOVE 0                     TO LSX-AUCTION-EXPENSE
           ELSE
              MOVE OLS-X-AUCTION-EXPENSE TO LSX-AUCTION-EXPENSE.
           MOVE OLS-X-REASON-CODE    TO LSX-REASON-CODE.
           MOVE OLS-X-TRIM                 TO LSX-TRIM.
           MOVE OLS-X-DOORS                TO LSX-DOORS.
           MOVE OLS-X-COLOR                TO LSX-COLOR.
      * OLS-X-CYLINDERS IS COMP-6, NUMERIC TEST DOESNT WORK
           IF OLS-X-CYLINDERS = 20 OR 02
              MOVE 0                       TO LSX-CYLINDERS
           ELSE
              MOVE OLS-X-CYLINDERS         TO LSX-CYLINDERS.
           MOVE OLS-X-AUTO-TRANS           TO LSX-AUTO-TRANS.
           MOVE OLS-X-AC                   TO LSX-AC.
           MOVE OLS-X-SROOF                TO LSX-SROOF.
           MOVE OLS-X-LEATHER              TO LSX-LEATHER.
           MOVE OLS-X-4WD                  TO LSX-4WD.
           MOVE OLS-X-DIESEL               TO LSX-DIESEL.
           MOVE OLS-X-DUAL-AIR             TO LSX-DUAL-AIR.
           MOVE OLS-X-EXT-CAB              TO LSX-EXT-CAB.
      * OLS-X-AGENT-PHONE, OLS-X-AGENT-FAX ARE COMP-6, NUMERIC TEST DOESNT WORK
           IF OLS-X-AGENT-PHONE = 2020202020 OR 0202020202 
              MOVE 0                       TO LSX-AGENT-PHONE
           ELSE
              MOVE OLS-X-AGENT-PHONE       TO LSX-AGENT-PHONE.
           IF OLS-X-AGENT-FAX = 2020202020 OR 0202020202 
              MOVE 0                       TO LSX-AGENT-FAX
           ELSE
              MOVE OLS-X-AGENT-FAX         TO LSX-AGENT-FAX.
           MOVE OLS-X-STORED-ADR2          TO LSX-STORED-ADR2.
           MOVE OLS-X-STORED-CITY          TO LSX-X-STORED-CITY.
           MOVE OLS-X-STORED-STATE         TO LSX-X-STORED-STATE.
           MOVE OLS-X-STORED-ZIP           TO LSX-X-STORED-ZIP.
           MOVE OLS-X-INS-CLAIM-PENDING    TO LSX-INS-CLAIM-PENDING.
           MOVE OLS-X-WARRANTY-AVAILABLE   TO LSX-WARRANTY-AVAILABLE.
           MOVE OLS-X-INS-REBATE-REQUESTED TO LSX-INS-REBATE-REQUESTED.
           MOVE OLS-X-EXTRACTED            TO LSX-EXTRACTED.

           IF OLS-X-TITLE-SENT-DATE NOT NUMERIC
              MOVE 0 TO LSX-TITLE-SENT-DATE
           ELSE
              MOVE OLS-X-TITLE-SENT-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO LSX-TITLE-SENT-DATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OLS-X-KEYS WAS ADDED TO A15 IN 2016; OLS-Y-KEYS
      *          WAS ADDED TO A15 PRIOR TO 2016.  PER BETH & JAY,
      *          SET LSX-KEYS USING OLS-X-KEYS BUT WILL BE OVERWRITTEN
      *          WITH OLS-Y-KEYS IF EXISTS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLS-X-KEYS                 TO LSX-KEYS.

           PERFORM REWRITE-LSX1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSX"                   TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

       UPGRADE-FILE-LS-X-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L S - Y
      *
      *=================================================================
      * MERGING LS-Y RECORDS INTO LSX- NEW RECORDS
      *
      * THIS WILL ONLY DO "Y" RECORDS, COMBINING THEM WITH 'X'
      *
      ******************************************************************
       UPGRADE-FILE-LS-Y SECTION.

           MOVE BR-NO                      TO LSX-BRNO.
           MOVE OLS-ACCTNO                 TO OLD-ACCTNO.
           MOVE NEW-ACCTNO                 TO LSX-ACCTNO.
           MOVE OLS-SEQNO                  TO LSX-SEQNO.
           PERFORM READ-LSX1-FILE.

           IF ( IO-GOOD )
              GO TO UPGRADE-FILE-LS-Y-CONTINUE.

      * LSX-REC DOES NOT EXIST; CREATE NEW LSX-REC
           PERFORM CLEAR-LSX-FILE.
           MOVE BR-NO                      TO LSX-BRNO

           MOVE OLS-ACCTNO                 TO OLD-ACCTNO
           MOVE NEW-ACCTNO                 TO LSX-ACCTNO
           MOVE OLS-SEQNO                  TO LSX-SEQNO
           PERFORM WRITE-LSX1-FILE.

           IF ( IO-BAD )
              MOVE "LSX(Y)"                TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO UPGRADE-FILE-LS-Y-EXIT
              ELSE
                 GO TO IO-ERROR.
           MOVE BR-NO                   TO LSX-BRNO.
           MOVE OLS-ACCTNO              TO OLD-ACCTNO.
           MOVE NEW-ACCTNO              TO LSX-ACCTNO.
           MOVE OLS-SEQNO               TO LSX-SEQNO.
           PERFORM READ-LSX1-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSX(Y)"                TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *-----------------------------------------------------------------
       UPGRADE-FILE-LS-Y-CONTINUE.

      * HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      * RECORD!

           MOVE OLS-Y-DISPOSAL-HOLD         TO LSX-DISPOSAL-HOLD.
           MOVE OLS-Y-NEXT-HLD-RVW-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LSX-NEXT-HLD-RVW-DATE.

           IF OLS-Y-CASE-ID NOT NUMERIC
              MOVE 0                        TO LSX-CASE-ID
           ELSE
              MOVE OLS-Y-CASE-ID            TO LSX-CASE-ID.
           MOVE OLS-Y-COLLATERAL-LOCATION   TO LSX-COLLATERAL-LOCATION.
           MOVE OLS-Y-VIN-MATCH             TO LSX-VIN-MATCH.
           MOVE OLS-Y-PERSONALS             TO LSX-PERSONALS.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OLS-X-KEYS WAS ADDED TO A15 IN 2016; OLS-Y-KEYS
      *          WAS ADDED TO A15 PRIOR TO 2016.  PER BETH & JAY,
      *          SET LSX-KEYS USING OLS-X-KEYS BUT WILL BE OVERWRITTEN
      *          WITH OLS-Y-KEYS IF EXISTS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLS-Y-KEYS                  TO LSX-KEYS.
           MOVE OLS-Y-DRIVES                TO LSX-DRIVES.
           MOVE OLS-Y-DMG                   TO LSX-DMG.
           MOVE OLS-Y-ASSIGNED-TO           TO LSX-Y-ASSIGNED-TO.
           IF OLS-Y-SUPPLIER-ID NOT NUMERIC
              MOVE 0                        TO LSX-SUPPLIER-ID
           ELSE
              MOVE OLS-Y-SUPPLIER-ID        TO LSX-SUPPLIER-ID.
           MOVE OLS-Y-TRANSPORT-EMAIL       TO LSX-TRANSPORT-EMAIL.
           MOVE OLS-Y-STORED-LOCATION       TO LSX-STORED-LOCATION.
           MOVE OLS-Y-STORED-ADDRESS        TO LSX-STORED-ADDRESS.
           MOVE OLS-Y-STORED-CITY           TO LSX-Y-STORED-CITY.
           MOVE OLS-Y-STORED-STATE          TO LSX-Y-STORED-STATE.
           MOVE OLS-Y-STORED-ZIP            TO LSX-Y-STORED-ZIP.
           MOVE OLS-Y-AGENCY-NAME           TO LSX-AGENCY-NAME.
           MOVE OLS-Y-AGENCY-ADDRESS        TO LSX-AGENCY-ADDRESS.
           MOVE OLS-Y-AGENCY-CITY           TO LSX-AGENCY-CITY.
           MOVE OLS-Y-AGENCY-STATE          TO LSX-AGENCY-STATE.
           MOVE OLS-Y-AGENCY-ZIP            TO LSX-AGENCY-ZIP.
           IF OLS-Y-AGENCY-PHONE NOT NUMERIC
              MOVE 0                        TO LSX-AGENCY-PHONE
           ELSE
           MOVE OLS-Y-AGENCY-PHONE          TO LSX-AGENCY-PHONE.

           PERFORM REWRITE-LSX1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LSX(Y)"                TO UP1534-CURRENT-FILE
              MOVE LSX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LS"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

       UPGRADE-FILE-LS-Y-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T
      *
      *=================================================================
      *          "A" = AUTO INSURANCE
      *          "B" = BANKRUPTCY
      *          "C" = COLLATERAL
      *          "D" = DEBIT CARD
      *          "F" = FEECODE PAYABLE
      *          "I" = INSURANCE ADDON
      *          "L" = LIENHOLDER
      *          "P" = PAY SCHEDULE
      *
      *    NOTE: "R" = REVOLVING IS NOT CONVERTED HERE.  LTR-REC IS
      *          CREATED WITHIN THE CONVERSION OF THE LN-REC WHICH IS
      *          DONE IN PROCESS-FILE-LN CALLING TO UPGRADE-FILE-LT-R.
      *
      ******************************************************************
       UPGRADE-FILE-LT SECTION.

      *KC  IF ( OLT-CODE = "A" ) PERFORM UPGRADE-FILE-LT-A
      *KC  ELSE
           IF ( OLT-CODE = "B" ) PERFORM UPGRADE-FILE-LT-B
           ELSE
           IF ( OLT-CODE = "C" ) PERFORM UPGRADE-FILE-LT-C
           ELSE
           IF ( OLT-CODE = "D" ) PERFORM UPGRADE-FILE-LT-D
           ELSE
           IF ( OLT-CODE = "F" ) PERFORM UPGRADE-FILE-LT-F
           ELSE
           IF ( OLT-CODE = "I" ) PERFORM UPGRADE-FILE-LT-I
           ELSE
           IF ( OLT-CODE = "L" ) PERFORM UPGRADE-FILE-LT-L
           ELSE
           IF ( OLT-CODE = "P" ) PERFORM UPGRADE-FILE-LT-P
           ELSE
              MOVE OLT-ACCTNO           TO SHOW-OLT-ACCTNO
              MOVE OLT-CODE             TO SHOW-OLT-CODE
              MOVE OLT-SEQNO            TO SHOW-OLT-SEQNO
              MOVE "OLT"                TO UP1534-CURRENT-FILE
              MOVE SHOW-OLT1-KEY        TO UP1534-UPDATE-KEY
              MOVE "CODE"               TO UP1534-UPDATE-STAT
              MOVE "E"                  TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                 TO UP1534-CURRENT-FILE
              ADD 1                     TO UP1534-RECORD-COUNTER-SKIP.

       UPGRADE-FILE-LT-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - A
      *
      *=================================================================
      * AUTO INSURANCE IS CONVERTING 3 SEQUENCES TO 1 SEQUENCE
      * FORCE 1 TO SEQNO IN NEW FILE
      *
      ******************************************************************
      * UPGRADE-FILE-LT-A SECTION.

      ** A15 KEY IS ACCTNO, CODE, SEQNO
      ** 00000101A001
      ** 00000101A002
      ** 00000101B001

      *     IF FILE-OPTION-LT = "A"
      ** NEED TO SEE IF NEW LT-A ALREADY EXISTS BECAUSE WE ARE COMBINING
      ** 3 SEQUENCES, MUST TEST IF LAST SAVED KEY WAS FROM AN "A" RECORD
      *        IF HOLD-LT-ACCTNO = OLT-ACCTNO AND HOLD-LT-CODE = "A"
      *           MOVE HOLD-ALT-KEY TO ALTA-KEY
      *           PERFORM READ-ALTA-FILE
      *           IF IO-FG = 0
      *              GO TO UPGRADE-FILE-LT-A-CONTINUE.
     
      *     IF FILE-OPTION-LT NOT = "A"
      *        MOVE BR-NO                      TO LTA-BRNO
      *        MOVE OLT-ACCTNO                 TO OLD-ACCTNO
      *        MOVE NEW-ACCTNO                 TO LTA-ACCTNO
      *        MOVE 1                          TO LTA-SEQNO
      *        PERFORM READ-LTA1-FILE
      *        IF IO-FG = 0
      *           GO TO UPGRADE-FILE-LT-A-CONTINUE.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      **    LTA-REC DOES NOT EXIST; CREATE NEW LTA-REC
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     IF FILE-OPTION-LT = "A"
      *        PERFORM CLEAR-ALTA-FILE
      *     ELSE
      *        PERFORM CLEAR-LTA-FILE.

      *     MOVE OLT-CODE            TO HOLD-LT-CODE.
      *     MOVE BR-NO               TO LTA-BRNO   ALTA-BRNO.
      *     MOVE OLT-ACCTNO          TO OLD-ACCTNO HOLD-LT-ACCTNO.
      *     MOVE NEW-ACCTNO          TO LTA-ACCTNO ALTA-ACCTNO.
      *     MOVE 1                   TO LTA-SEQNO  ALTA-SEQNO.
      *     IF FILE-OPTION-LT = "Y"
      *        PERFORM WRITE-LTA1-FILE
      *     ELSE
      *        ADD 1        TO ALTA-KEY
      *        MOVE ALTA-KEY TO HOLD-ALT-KEY
      *        ACCEPT ALTA-LTOUCH-DATE FROM CENTURY-DATE
      *        MOVE X"0D"              TO ALTA-CR
      *        MOVE X"0A"              TO ALTA-LF
      *        PERFORM WRITE-ALTA-FILE.
      *     IF ( IO-BAD )
      *        MOVE "LTA"                   TO UP1534-CURRENT-FILE
      *        MOVE LTA1-KEY                TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        MOVE "LT"                    TO UP1534-CURRENT-FILE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
      *           GO TO UPGRADE-FILE-LT-A-EXIT
      *        ELSE
      *           GO TO IO-ERROR.

      *     IF FILE-OPTION-LT = "A"
      ** THE KEY WILL STILL BE SET FROM ABOVE WRITE
      *        PERFORM READ-ALTA-FILE
      *     ELSE
      *        MOVE BR-NO                TO LTA-BRNO
      *        MOVE OLT-ACCTNO           TO OLD-ACCTNO
      *        MOVE NEW-ACCTNO           TO LTA-ACCTNO
      *        MOVE 1                    TO LTA-SEQNO
      *        PERFORM READ-LTA1-FILE.
      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE "LTA"                   TO UP1534-CURRENT-FILE
      *        MOVE LTA1-KEY                TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        MOVE "LT"                    TO UP1534-CURRENT-FILE
      *        GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      **-----------------------------------------------------------------
      * UPGRADE-FILE-LT-A-CONTINUE.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      ** HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      ** RECORD!
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     IF OLT-SEQNO = 1
      *        MOVE OLT-A-DLR-REQ    TO LTA-DLR-REQ    ALTA-DLR-REQ
      *        MOVE OLT-A-INS-TYPE   TO LTA-INS-TYPE   ALTA-INS-TYPE
      *        MOVE OLT-A-INS-CO     TO LTA-INS-CO     ALTA-INS-CO
      *        MOVE OLT-A-POLICY-NO  TO LTA-POLICY-NO  ALTA-POLICY-NO
      *        MOVE OLT-A-AGENCY     TO LTA-AGENCY     ALTA-AGENCY
      *        MOVE OLT-A-AGENT      TO LTA-AGENT      ALTA-AGENT
      *        IF (FILE-OPTION-LT = "Y")
      *           PERFORM REWRITE-LTA1-FILE
      *        ELSE
      *           PERFORM REWRITE-ALTA-FILE.

      *     IF OLT-SEQNO = 2
      *        MOVE  OLT-A-ADR1      TO  LTA-ADR1    ALTA-ADR1
      *        MOVE  OLT-A-ADR2      TO  LTA-ADR2    ALTA-ADR2
      *        MOVE  OLT-A-CITY      TO  LTA-CITY    ALTA-CITY
      *        MOVE  OLT-A-STATE     TO  LTA-STATE   ALTA-STATE
      *        MOVE  OLT-A-ZIP       TO  LTA-ZIP     ALTA-ZIP
      *        IF OLT-A-PHONE NOT NUMERIC
      *           MOVE 0             TO  LTA-PHONE   ALTA-PHONE
      *        ELSE
      *           MOVE OLT-A-PHONE   TO  LTA-PHONE   ALTA-PHONE
      *        END-IF
      *        MOVE  OLT-A-EFF-DATE  TO  DATE-MMDDYY
      *        PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
      *        PERFORM TEST-INVALID-DATE
      *        MOVE DATE-YYYYMMDD    TO LTA-EFF-DATE ALTA-EFF-DATE
      *        MOVE  OLT-A-EXP-DATE  TO DATE-MMDDYY
      *        PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
      *        PERFORM TEST-INVALID-DATE
      *        MOVE DATE-YYYYMMDD    TO LTA-EXP-DATE ALTA-EXP-DATE
      *        MOVE  OLT-A-CAN-DATE  TO DATE-MMDDYY
      *        PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
      *        PERFORM TEST-INVALID-DATE
      *        MOVE DATE-YYYYMMDD    TO LTA-CAN-DATE ALTA-CAN-DATE
      *        MOVE  OLT-A-CONF-DATE TO DATE-MMDDYY
      *        PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
      *        PERFORM TEST-INVALID-DATE
      *        MOVE DATE-YYYYMMDD    TO LTA-CONF-DATE ALTA-CONF-DATE
      *        IF OLT-A-LAST-FORM NOT NUMERIC
      *           MOVE 0              TO LTA-LAST-FORM ALTA-LAST-FORM
      *        ELSE
      *         MOVE  OLT-A-LAST-FORM TO LTA-LAST-FORM ALTA-LAST-FORM
      *        END-IF
      *        IF (FILE-OPTION-LT = "Y")
      *           PERFORM REWRITE-LTA1-FILE
      *        ELSE
      *           PERFORM REWRITE-ALTA-FILE.

      *     IF OLT-SEQNO = 3
      *        MOVE OLT-A-COV-TYPE     TO LTA-COV-TYPE ALTA-COV-TYPE
      *        PERFORM TEST-OLT-A-NON-NUMERIC
      *        MOVE OLT-A-BIL-COV   TO LTA-BIL-COV  ALTA-BIL-COV
      *        MOVE OLT-A-PDL-COV   TO LTA-PDL-COV  ALTA-PDL-COV
      *        MOVE OLT-A-PIP-COV   TO LTA-PIP-COV  ALTA-PIP-COV
      *        MOVE OLT-A-UMB-COV   TO LTA-UMB-COV  ALTA-UMB-COV
      *        MOVE OLT-A-COL-COV   TO LTA-COL-COV  ALTA-COL-COV
      *        MOVE OLT-A-LOSS-PAYEE   TO LTA-LOSS-PAYEE ALTA-LOSS-PAYEE
      *        MOVE OLT-A-COM-COV   TO LTA-COM-COV  ALTA-COM-COV
      ** CLEANSE BR 807 #300441, BR 807 #301124
      *        IF OLT-A-TRACK-ONLY = "Y" OR "N" OR " "
      *           MOVE OLT-A-TRACK-ONLY   TO LTA-TRACK-ONLY
      *                                     ALTA-TRACK-ONLY
      *           MOVE OLT-A-INSURANCE    TO LTA-INSURANCE 
      *                                     ALTA-INSURANCE
      *           MOVE OLT-A-TRACK-MONTHS TO LTA-TRACK-MONTHS
      *                                     ALTA-TRACK-MONTHS
      *           MOVE OLT-A-INS-MONTHS   TO LTA-INS-MONTHS
      *                                      ALTA-INS-MONTHS
      *           MOVE OLT-A-CPP-MONTHS   TO LTA-CPP-MONTHS
      *                                     ALTA-CPP-MONTHS
      *        END-IF
      *        IF (FILE-OPTION-LT = "Y")
      *           PERFORM REWRITE-LTA1-FILE
      *        ELSE
      *           PERFORM REWRITE-ALTA-FILE.

      * UPGRADE-FILE-LT-A-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - B
      *
      *=================================================================
      * BANKRUPT IS CONVERTING 5 SEQUENCES TO 1 SEQUENCE
      * FORCE 1 TO SEQNO IN NEW FILE
      *
      ******************************************************************
       UPGRADE-FILE-LT-B SECTION.

      * A15 KEY IS ACCTNO, CODE, SEQNO
      * 00000101A001
      * 00000101A002
      * 00000101B001
           IF FILE-OPTION-LT = "A"
      * NEED TO SEE IF NEW LT-B ALREADY EXISTS BECAUSE WE ARE COMBINING
      * 5 SEQUENCES, MUST TEST IF LAST SAVED KEY WAS FROM A "B" RECORD,
      * COULD HAVE BEEN FROM AN "A" RECORD..., WITH SAME ACCOUNT #
              IF HOLD-LT-ACCTNO = OLT-ACCTNO AND HOLD-LT-CODE = "B"
                 MOVE HOLD-ALT-KEY TO ALTB-KEY
                 PERFORM READ-ALTB-FILE
                 IF IO-FG = 0
                    GO TO UPGRADE-FILE-LT-B-CONTINUE.

           IF FILE-OPTION-LT NOT = "A"
              MOVE BR-NO                      TO LTB-BRNO
              MOVE OLT-ACCTNO                 TO OLD-ACCTNO
              MOVE NEW-ACCTNO                 TO LTB-ACCTNO
              MOVE 1                          TO LTB-SEQNO
              PERFORM READ-LTB1-FILE
              IF ( IO-GOOD )
                 GO TO UPGRADE-FILE-LT-B-CONTINUE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LTB-REC DOES NOT EXIST; CREATE NEW LTB-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF FILE-OPTION-LT = "A"
              PERFORM CLEAR-ALTB-FILE
           ELSE
              PERFORM CLEAR-LTB-FILE.

           MOVE OLT-CODE     TO HOLD-LT-CODE.
           MOVE BR-NO        TO LTB-BRNO    ALTB-BRNO.
           MOVE OLT-ACCTNO   TO OLD-ACCTNO  HOLD-LT-ACCTNO.
           MOVE NEW-ACCTNO   TO LTB-ACCTNO  ALTB-ACCTNO.
           MOVE 1            TO LTB-SEQNO   ALTB-SEQNO.
           IF FILE-OPTION-LT = "Y"
              PERFORM WRITE-LTB1-FILE
           ELSE
              ADD 1        TO ALTB-KEY
              MOVE ALTB-KEY TO HOLD-ALT-KEY
              ACCEPT ALTB-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTB-CR
              MOVE X"0A"              TO ALTB-LF
              PERFORM WRITE-ALTB-FILE.

           IF ( IO-BAD )
              MOVE "LTB"                   TO UP1534-CURRENT-FILE
              MOVE LTB1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO UPGRADE-FILE-LT-B-EXIT
              ELSE
                 GO TO IO-ERROR.

           IF FILE-OPTION-LT = "A"
      * THE KEY WILL STILL BE SET FROM ABOVE WRITE
              PERFORM READ-ALTB-FILE
           ELSE
              MOVE BR-NO                   TO LTB-BRNO
              MOVE OLT-ACCTNO              TO OLD-ACCTNO
              MOVE NEW-ACCTNO              TO LTB-ACCTNO
              MOVE 1                       TO LTB-SEQNO
              PERFORM READ-LTB1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTB"                   TO UP1534-CURRENT-FILE
              MOVE LTB1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *-----------------------------------------------------------------
       UPGRADE-FILE-LT-B-CONTINUE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      * RECORD!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF OLT-SEQNO = 1
              PERFORM UPGRADE-FILE-LT-B-SEQ1.

           IF OLT-SEQNO = 2 OR 3 OR 4
              COMPUTE SUB = OLT-SEQNO - 1
              PERFORM UPGRADE-FILE-LT-B-BKRT
           ELSE
           IF OLT-SEQNO = 5
              MOVE OLT-B-REAFF-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD  TO LTB-REAFF-DATE ALTB-REAFF-DATE

              MOVE OLT-B-REAFF-SYSDATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD  TO LTB-REAFF-SYSDATE
                                    ALTB-REAFF-SYSDATE
              PERFORM TEST-OLT-B-NON-NUMERIC
              MOVE OLT-B-REAFF-BALANCE TO LTB-REAFF-BALANCE
                                         ALTB-REAFF-BALANCE
              MOVE OLT-B-REAFF-PAYAMT  TO LTB-REAFF-PAYAMT
                                         ALTB-REAFF-PAYAMT
              MOVE OLT-B-REAFF-NO-PAYS TO LTB-REAFF-NO-PAYS
                                         ALTB-REAFF-NO-PAYS
              MOVE OLT-B-INTRATE TO LTB-INTRATE ALTB-INTRATE
              MOVE OLT-B-RESCIND-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LTB-RESCIND-DATE
                                         ALTB-RESCIND-DATE
              MOVE OLT-B-PARTIAL-FULL  TO LTB-PARTIAL-FULL
                                         ALTB-PARTIAL-FULL
              MOVE OLT-B-DISCHARGE-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD       TO LTB-DISCHARGE-DATE
                                         ALTB-DISCHARGE-DATE
              MOVE OLT-B-DISCHARGE-SYSDATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD        TO LTB-DISCHARGE-SYSDATE
                                          ALTB-DISCHARGE-SYSDATE
              MOVE OLT-B-GROSS-BAL TO LTB-GROSS-BAL
                                     ALTB-GROSS-BAL
              IF (FILE-OPTION-LT = "Y")
                 PERFORM REWRITE-LTB1-FILE
              ELSE
                 PERFORM REWRITE-ALTB-FILE.

       UPGRADE-FILE-LT-B-EXIT.
           EXIT.

      ******************************************************************
       UPGRADE-FILE-LT-B-SEQ1 SECTION.
      ******************************************************************
      * TEST FOR VALID DAY
      * BRNO 1518 3206 SEQ 1 2008/02/33
      * BRNO 705  2750 SEQ 1 2012/02/33
           MOVE OLT-B-FILEDATE  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD   TO LTB-FILEDATE  ALTB-FILEDATE.

           MOVE OLT-B-CASE-NO   TO LTB-CASE-NO   ALTB-CASE-NO.
           PERFORM SET-LTB-CHAPTER.
           MOVE OLT-B-MISC1     TO LTB-MISC1     ALTB-MISC1.
           MOVE OLT-B-MISC2     TO LTB-MISC2     ALTB-MISC2.
           MOVE OLT-B-MISC3     TO LTB-MISC3     ALTB-MISC3.
           IF OLT-B-BDDATE NOT NUMERIC
              MOVE 0 TO LTB-BDDATE ALTB-BDDATE
           ELSE
              MOVE OLT-B-BDDATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO LTB-BDDATE ALTB-BDDATE.

           MOVE OLT-B-WHO-FILED TO LTB-WHO-FILED ALTB-WHO-FILED.
           MOVE OLT-B-ENDORSER-FILED  TO LTB-ENDORSER-FILED
                                        ALTB-ENDORSER-FILED.
      * 115 24685
           IF OLT-B-CLAIM-AMT NOT NUMERIC OR
               (OLT-B-CLAIM-AMT = 2020202.02 OR 0202020.20)
              MOVE 0               TO LTB-CLAIM-AMT ALTB-CLAIM-AMT
           ELSE
              MOVE OLT-B-CLAIM-AMT TO LTB-CLAIM-AMT ALTB-CLAIM-AMT.
           MOVE OLT-B-ACTIVE-INACTIVE TO LTB-ACTIVE-INACTIVE
                                        ALTB-ACTIVE-INACTIVE.
           IF OLT-B-INT-LC-DUE NOT NUMERIC OR
               (OLT-B-INT-LC-DUE = 2020202.02 OR 0202020.20)
              MOVE 0                  TO LTB-INT-LC-DUE
                                        ALTB-INT-LC-DUE
           ELSE
              MOVE OLT-B-INT-LC-DUE   TO LTB-INT-LC-DUE
                                        ALTB-INT-LC-DUE.
           IF OLT-B-OTH-DUE NOT NUMERIC OR
               (OLT-B-OTH-DUE = 2020202.02 OR 0202020.20)
              MOVE 0                  TO LTB-OTH-DUE ALTB-OTH-DUE
           ELSE
              MOVE OLT-B-OTH-DUE      TO LTB-OTH-DUE ALTB-OTH-DUE.
           IF OLT-B-TDUEAMT NOT NUMERIC OR
               (OLT-B-TDUEAMT = 2020202.02 OR 0202020.20)
              MOVE 0                  TO LTB-TDUEAMT ALTB-TDUEAMT
           ELSE
              MOVE OLT-B-TDUEAMT      TO LTB-TDUEAMT ALTB-TDUEAMT.
           IF (FILE-OPTION-LT = "Y")
              PERFORM REWRITE-LTB1-FILE
           ELSE
              PERFORM REWRITE-ALTB-FILE.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - B - B K R T
      *
      *=================================================================
      *          CONVERT LT (B) BANKRUPTY - BANKRUPT
      ******************************************************************
       UPGRADE-FILE-LT-B-BKRT SECTION.

           MOVE OLT-B-NAME     TO LTB-NAME (SUB) ALTB-NAME(SUB).
           MOVE OLT-B-ADR1     TO LTB-ADR1 (SUB) ALTB-ADR1(SUB).
           MOVE OLT-B-ADR2     TO LTB-ADR2 (SUB) ALTB-ADR2(SUB).
           MOVE OLT-B-CITY     TO LTB-CITY (SUB) ALTB-CITY(SUB).
           MOVE OLT-B-STATE    TO LTB-STATE(SUB) ALTB-STATE(SUB).
           MOVE OLT-B-ZIP      TO LTB-ZIP  (SUB) ALTB-ZIP(SUB).
           IF OLT-B-PHONE NOT NUMERIC
              MOVE 0           TO LTB-PHONE(SUB) ALTB-PHONE(SUB)
           ELSE
              MOVE OLT-B-PHONE TO LTB-PHONE(SUB) ALTB-PHONE(SUB).
           IF (FILE-OPTION-LT = "Y")
              PERFORM REWRITE-LTB1-FILE
           ELSE
              PERFORM REWRITE-ALTB-FILE.
           IF ( IO-BAD )
              MOVE "LTB(B)"                TO UP1534-CURRENT-FILE
              MOVE LTB1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

       UPGRADE-FILE-LT-B-BKR-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - C
      *
      *=================================================================
      * COLLATERAL IS CONVERTING MANY SEQUENCES TO 1 SEQUENCE
      * FORCE 1 TO SEQNO IN NEW FILE
      *
      ******************************************************************
       UPGRADE-FILE-LT-C SECTION.

      * A15 KEY IS ACCTNO, CODE, SEQNO
      * 00000101A001
      * 00000101A002
      * 00000101B001
           IF FILE-OPTION-LT = "A"
      * NEED TO SEE IF NEW LT-C ALREADY EXISTS BECAUSE WE ARE COMBINING
      * MANY SEQUENCES, MUST TEST IF LAST SAVED KEY WAS FROM A "C" RECORD,
      * COULD HAVE BEEN FROM A "B" RECORD..., WITH SAME ACCOUNT #
              IF HOLD-LT-ACCTNO = OLT-ACCTNO AND HOLD-LT-CODE = "C"
                 MOVE HOLD-ALT-KEY TO ALTC-KEY
                 PERFORM READ-ALTC-FILE
                 IF IO-FG = 0
                    GO TO UPGRADE-FILE-LT-C-CONTINUE.

           IF FILE-OPTION-LT NOT = "A"
              MOVE BR-NO                      TO LTC-BRNO
              MOVE OLT-ACCTNO                 TO OLD-ACCTNO
              MOVE NEW-ACCTNO                 TO LTC-ACCTNO
              MOVE 1                          TO LTC-SEQNO
              PERFORM READ-LTC1-FILE
              IF ( IO-GOOD )
                 GO TO UPGRADE-FILE-LT-C-CONTINUE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LTC-REC DOES NOT EXIST; CREATE NEW LTC-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF FILE-OPTION-LT = "A"
              PERFORM CLEAR-ALTC-FILE
           ELSE
              PERFORM CLEAR-LTC-FILE.

           MOVE OLT-CODE        TO HOLD-LT-CODE.
           MOVE BR-NO           TO LTC-BRNO    ALTC-BRNO.
           MOVE OLT-ACCTNO      TO OLD-ACCTNO  HOLD-LT-ACCTNO.
           MOVE NEW-ACCTNO      TO LTC-ACCTNO  ALTC-ACCTNO.
           MOVE 1               TO LTC-SEQNO   ALTC-SEQNO.
           IF FILE-OPTION-LT = "Y"
              PERFORM WRITE-LTC1-FILE
           ELSE
              ADD 1        TO ALTC-KEY
              MOVE ALTC-KEY TO HOLD-ALT-KEY
              ACCEPT ALTC-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTC-CR
              MOVE X"0A"              TO ALTC-LF
              PERFORM WRITE-ALTC-FILE.

           IF ( IO-BAD )
              MOVE "LTC"                   TO UP1534-CURRENT-FILE
              MOVE LTC1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO UPGRADE-FILE-LT-C-EXIT
              ELSE
                 GO TO IO-ERROR.

           IF FILE-OPTION-LT = "A"
      * THE KEY WILL STILL BE SET FROM ABOVE WRITE
              PERFORM READ-ALTC-FILE
           ELSE
              MOVE BR-NO                      TO LTC-BRNO
              MOVE OLT-ACCTNO                 TO OLD-ACCTNO
              MOVE NEW-ACCTNO                 TO LTC-ACCTNO
              MOVE 1                          TO LTC-SEQNO
              PERFORM READ-LTC1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTC"                   TO UP1534-CURRENT-FILE
              MOVE LTC1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *-----------------------------------------------------------------
       UPGRADE-FILE-LT-C-CONTINUE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      * RECORD!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF OLT-SEQNO = 1
              MOVE 1 TO SUB
              PERFORM UPGRADE-FILE-LT-C-AUTO
           ELSE
           IF OLT-SEQNO = 2
              MOVE 2 TO SUB
              PERFORM UPGRADE-FILE-LT-C-AUTO
           ELSE
           IF OLT-SEQNO = 3
              MOVE 1 TO SUB
              PERFORM UPGRADE-FILE-LT-C-HHGS
           ELSE
           IF OLT-SEQNO = 4
              MOVE 2 TO SUB
              PERFORM UPGRADE-FILE-LT-C-HHGS
           ELSE
              MOVE 3 TO SUB
              PERFORM UPGRADE-FILE-LT-C-HHGS.

       UPGRADE-FILE-LT-C-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C - A U T O
      *
      *=================================================================
      * COLLATERAL IS CONVERTING MANY SEQUENCES TO 1 SEQUENCE
      * FORCE 1 TO SEQNO IN NEW FILE
      *
      ******************************************************************
       UPGRADE-FILE-LT-C-AUTO SECTION.

           IF FILE-OPTION-LT = "Y"
              MOVE OLT-DESCRIPTION  TO LTC-DESC(SUB)
              MOVE OLT-MAKE      TO LTC-MAKE(SUB)
              MOVE OLT-MODEL     TO LTC-MODEL(SUB)
              MOVE OLT-YEAR      TO LTC-YEAR(SUB)    
              MOVE OLT-STYLE     TO LTC-STYLE(SUB)   
              MOVE OLT-CLASS     TO LTC-CLASS(SUB)   
              MOVE OLT-VIN       TO LTC-VIN(SUB)     
              MOVE OLT-TITLE-NO  TO LTC-TITLE-NO(SUB)
              PERFORM TEST-OLT-C-NON-NUMERIC
              MOVE OLT-MILEAGE   TO LTC-MILEAGE(SUB) 
              MOVE OLT-VALUE     TO LTC-VALUE(SUB)   
              MOVE OLT-SELLPR    TO LTC-SELLPR(SUB)  
              MOVE OLT-MISC-AMT  TO LTC-MISC-AMT(SUB)
              MOVE OLT-SENT-FLAG TO LTC-SENT-FLAG(SUB)
              MOVE OLT-VIN-CHG-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO LTC-VIN-CHG-DATE(SUB)
           ELSE
      * ASCII
              IF SUB = 1
                 MOVE OLT-DESCRIPTION  TO ALTC-DESC-1
                 MOVE OLT-MAKE      TO ALTC-MAKE-1
                 MOVE OLT-MODEL     TO ALTC-MODEL-1
                 MOVE OLT-YEAR      TO ALTC-YEAR-1
                 MOVE OLT-STYLE     TO ALTC-STYLE-1
                 MOVE OLT-CLASS     TO ALTC-CLASS-1
                 MOVE OLT-VIN       TO ALTC-VIN-1
                 MOVE OLT-TITLE-NO  TO ALTC-TITLE-NO-1
                 PERFORM TEST-OLT-C-NON-NUMERIC
                 MOVE OLT-MILEAGE   TO ALTC-MILEAGE-1
                 MOVE OLT-VALUE     TO ALTC-VALUE-1
                 MOVE OLT-SELLPR    TO ALTC-SELLPR-1
                 MOVE OLT-MISC-AMT  TO ALTC-MISC-AMT-1
                 MOVE OLT-SENT-FLAG TO ALTC-SENT-FLAG-1
                 MOVE OLT-VIN-CHG-DATE TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD  TO ALTC-VIN-CHG-DATE-1
              ELSE
              IF SUB = 2
                 MOVE OLT-DESCRIPTION  TO ALTC-DESC-2
                 MOVE OLT-MAKE      TO ALTC-MAKE-2
                 MOVE OLT-MODEL     TO ALTC-MODEL-2
                 MOVE OLT-YEAR      TO ALTC-YEAR-2
                 MOVE OLT-STYLE     TO ALTC-STYLE-2
                 MOVE OLT-CLASS     TO ALTC-CLASS-2
                 MOVE OLT-VIN       TO ALTC-VIN-2
                 MOVE OLT-TITLE-NO  TO ALTC-TITLE-NO-2
                 PERFORM TEST-OLT-C-NON-NUMERIC
                 MOVE OLT-MILEAGE   TO ALTC-MILEAGE-2
                 MOVE OLT-VALUE     TO ALTC-VALUE-2
                 MOVE OLT-SELLPR    TO ALTC-SELLPR-2
                 MOVE OLT-MISC-AMT  TO ALTC-MISC-AMT-2
                 MOVE OLT-SENT-FLAG TO ALTC-SENT-FLAG-2
                 MOVE OLT-VIN-CHG-DATE TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD  TO ALTC-VIN-CHG-DATE-2
              ELSE
              IF SUB = 3
                 MOVE OLT-DESCRIPTION  TO ALTC-DESC-3
                 MOVE OLT-MAKE      TO ALTC-MAKE-3
                 MOVE OLT-MODEL     TO ALTC-MODEL-3
                 MOVE OLT-YEAR      TO ALTC-YEAR-3
                 MOVE OLT-STYLE     TO ALTC-STYLE-3
                 MOVE OLT-CLASS     TO ALTC-CLASS-3
                 MOVE OLT-VIN       TO ALTC-VIN-3
                 MOVE OLT-TITLE-NO  TO ALTC-TITLE-NO-3
                 PERFORM TEST-OLT-C-NON-NUMERIC
                 MOVE OLT-MILEAGE   TO ALTC-MILEAGE-3
                 MOVE OLT-VALUE     TO ALTC-VALUE-3
                 MOVE OLT-SELLPR    TO ALTC-SELLPR-3
                 MOVE OLT-MISC-AMT  TO ALTC-MISC-AMT-3
                 MOVE OLT-SENT-FLAG TO ALTC-SENT-FLAG-3
                 MOVE OLT-VIN-CHG-DATE TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD  TO ALTC-VIN-CHG-DATE-3.

           IF (FILE-OPTION-LT = "Y")
              PERFORM REWRITE-LTC1-FILE
           ELSE
              PERFORM REWRITE-ALTC-FILE.
           IF ( IO-BAD )
              MOVE "LTC(A)"                TO UP1534-CURRENT-FILE
              MOVE LTC1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

       UPGRADE-FILE-LT-C-AUTO-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - C - H H G S
      *
      *=================================================================
      *    DESC: UPGRADE SOURCE RECORD TO TARGET RECORD
      *          CONVERT LT (C) COLLATERAL - HHGS
      *
      ******************************************************************
       UPGRADE-FILE-LT-C-HHGS SECTION.

           IF FILE-OPTION-LT = "Y"
              MOVE OLT-COLL-INFO1 TO LTC-COLL-INFO1(SUB)
              MOVE OLT-COLL-INFO2 TO LTC-COLL-INFO2(SUB)
              MOVE OLT-COLL-INFO3 TO LTC-COLL-INFO3(SUB)
              MOVE OLT-COLL-INFO4 TO LTC-COLL-INFO4(SUB)
           ELSE
              MOVE OLT-COLLATERAL-INFO TO ALTC-HHGS(SUB).

           IF (FILE-OPTION-LT = "Y")
              PERFORM REWRITE-LTC1-FILE
           ELSE
              PERFORM REWRITE-ALTC-FILE.
           IF ( IO-BAD )
              MOVE "LTC(H)"                TO UP1534-CURRENT-FILE
              MOVE LTC1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

       UPGRADE-FILE-LT-C-HHG-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - D
      *
      *=================================================================
      *    CONVERT LT (D) DEBIT CARD
      *    FORCE 1 TO SEQNO IN NEW FILE
      ******************************************************************
       UPGRADE-FILE-LT-D SECTION.

           IF FILE-OPTION-LT = "Y"
              PERFORM CLEAR-LTD-FILE
           ELSE
              PERFORM CLEAR-ALTD-FILE.

           MOVE BR-NO            TO LTD-BRNO ALTD-BRNO.
           MOVE OLT-ACCTNO       TO OLD-ACCTNO.
           MOVE NEW-ACCTNO       TO LTD-ACCTNO ALTD-ACCTNO.
           MOVE 1                TO LTD-SEQNO  ALTD-SEQNO.

           MOVE 0                TO LTD-LTOUCH-DATE ALTD-LTOUCH-DATE.

           IF OLT-D-DEBIT-CARD-NUMBER NOT NUMERIC
             MOVE 0                       TO LTD-DEBIT-CARD-NUMBER
                                            ALTD-DEBIT-CARD-NUMBER
           ELSE
             MOVE OLT-D-DEBIT-CARD-NUMBER TO LTD-DEBIT-CARD-NUMBER
                                            ALTD-DEBIT-CARD-NUMBER.
           
           IF OLT-D-DEBIT-CARD-AMT NOT NUMERIC
              MOVE 0                      TO LTD-DEBIT-CARD-AMT
                                            ALTD-DEBIT-CARD-AMT
           ELSE
              MOVE OLT-D-DEBIT-CARD-AMT   TO LTD-DEBIT-CARD-AMT
                                            ALTD-DEBIT-CARD-AMT.

           MOVE OLT-D-LOANDATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD        TO LTD-LOANDATE ALTD-LOANDATE.

           MOVE OLT-D-VOID-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD        TO LTD-VOID-DATE ALTD-VOID-DATE.

           MOVE OLT-D-CLEARED-DATE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD        TO LTD-CLEARED-DATE
                                       ALTD-CLEARED-DATE.

           IF OLT-D-CLEARED-AMT NOT NUMERIC
              MOVE 0                 TO LTD-CLEARED-AMT
                                       ALTD-CLEARED-AMT
           ELSE
              MOVE OLT-D-CLEARED-AMT TO LTD-CLEARED-AMT
                                       ALTD-CLEARED-AMT.

           IF (FILE-OPTION-LT = "Y")
              PERFORM WRITE-LTD1-FILE
           ELSE
              ADD 1 TO ALTD-KEY
              ACCEPT ALTD-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTD-CR
              MOVE X"0A"              TO ALTD-LF
              PERFORM WRITE-ALTD-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTD"                   TO UP1534-CURRENT-FILE
              MOVE LTD1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LT-D-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LT-D-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - F
      *
      *=================================================================
      *    CONVERT LT (F) FEECODE PAYABLE
      *
      *    FEECODE IS CONVERTING 1 SEQUENCE TO 1 SEQUENCE
      *    FORCE 1 TO SEQNO IN NEW FILE
      ******************************************************************
       UPGRADE-FILE-LT-F SECTION.

           IF FILE-OPTION-LT = "Y"
              PERFORM CLEAR-LTF-FILE
           ELSE
              PERFORM CLEAR-ALTF-FILE.

           MOVE BR-NO      TO LTF-BRNO     ALTF-BRNO.
           MOVE OLT-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LTF-ACCTNO   ALTF-ACCTNO.
           MOVE 1          TO LTF-SEQNO    ALTF-SEQNO.


           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              MOVE OLT-FEECODE(SUB) TO LTF-FEECODE(SUB)
                                      ALTF-FEECODE(SUB)
              IF OLT-FEECODE-PAYABLE(SUB) NOT NUMERIC
                 MOVE 0 TO LTF-FEECODE-PAYABLE(SUB)
                          ALTF-FEECODE-PAYABLE(SUB)
              ELSE
                 MOVE OLT-FEECODE-PAYABLE(SUB) TO
                           LTF-FEECODE-PAYABLE(SUB)
                          ALTF-FEECODE-PAYABLE(SUB)
              END-IF
           END-PERFORM.

           IF (FILE-OPTION-LT = "Y")
              PERFORM WRITE-LTF1-FILE
           ELSE
              ADD 1 TO ALTF-KEY
              ACCEPT ALTF-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTF-CR
              MOVE X"0A"              TO ALTF-LF
              PERFORM WRITE-ALTF-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTF"                   TO UP1534-CURRENT-FILE
              MOVE LTF1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LT-F-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LT-F-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - I
      *
      *=================================================================
      *    CONVERT LT (I) INSURANCE ADDON
      *
      * INSURANCE ADDONS CAN HAVE MULTIPLE SEQUENCES IN OLD AND NEW FILE
      * CONVERT EACH SEQUENCE FROM OLD TO NEW
      * EACH ADDON HAS ITS OWN SEQUENCE
      ******************************************************************
       UPGRADE-FILE-LT-I SECTION.

           IF FILE-OPTION-LT = "Y"
              PERFORM CLEAR-LTI-FILE
           ELSE
              PERFORM CLEAR-ALTI-FILE.

           MOVE BR-NO      TO LTI-BRNO    ALTI-BRNO.
           MOVE OLT-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LTI-ACCTNO  ALTI-ACCTNO.
           MOVE OLT-SEQNO  TO LTI-SEQNO   ALTI-SEQNO.

           MOVE 0          TO LTI-LTOUCH-DATE ALTI-LTOUCH-DATE.

           MOVE OLT-TYPE        TO LTI-INS-TYPE       ALTI-INS-TYPE.
           MOVE OLT-ORIG-1STPAY TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD   TO LTI-ORIG-1STPYDATE
                                  ALTI-ORIG-1STPYDATE.
           IF OLT-PRIOR-NODEF NOT NUMERIC
              MOVE 0               TO LTI-PRIOR-NODEF
                                     ALTI-PRIOR-NODEF
           ELSE
              MOVE OLT-PRIOR-NODEF TO LTI-PRIOR-NODEF  
                                     ALTI-PRIOR-NODEF.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              MOVE OLT-INSFEECD(SUB) TO LTI-INSFEECD(SUB)
                                       ALTI-INSFEECD(SUB)
              IF OLT-INSFEE(SUB) NOT NUMERIC
                 MOVE 0               TO LTI-INSFEE(SUB)
                                         ALTI-INSFEE(SUB)
              ELSE
                 MOVE OLT-INSFEE(SUB) TO LTI-INSFEE(SUB)
                                        ALTI-INSFEE(SUB)
              END-IF
           END-PERFORM.

           MOVE OLT-TRCD    TO LTI-TRCD    ALTI-TRCD.

           IF OLT-INSCOMP NOT NUMERIC
              MOVE 0           TO LTI-INSCOMP ALTI-INSCOMP
           ELSE
              MOVE OLT-INSCOMP TO LTI-INSCOMP ALTI-INSCOMP.
           MOVE OLT-INSOURS TO LTI-INSOURS ALTI-INSOURS.
           IF OLT-INSEFF > 900
              MOVE OLT-INSEFF TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO LTI-INSEFF-DATE ALTI-INSEFF-DATE
           ELSE
              IF OLT-INSTRM NOT NUMERIC
                 MOVE 0 TO LTI-INSEFF-DATE ALTI-INSEFF-DATE
              ELSE
                MOVE OLT-INSTRM TO LTI-INSEFF-DATE ALTI-INSEFF-DATE.

           MOVE OLT-INSEXP TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD TO LTI-INSEXP-DATE ALTI-INSEXP-DATE.

           IF OLT-INSPREM NOT NUMERIC
              MOVE 0           TO LTI-INSPREM ALTI-INSPREM
           ELSE
              MOVE OLT-INSPREM TO LTI-INSPREM ALTI-INSPREM.
           IF OLT-INSCOVR NOT NUMERIC
              MOVE 0           TO LTI-INSCOVR ALTI-INSCOVR
           ELSE
              MOVE OLT-INSCOVR TO LTI-INSCOVR ALTI-INSCOVR.
           IF OLT-INSCOMM NOT NUMERIC
              MOVE 0           TO LTI-INSCOMM ALTI-INSCOMM
           ELSE
              MOVE OLT-INSCOMM TO LTI-INSCOMM ALTI-INSCOMM.

           IF OLT-ANTICTERM NOT NUMERIC
              MOVE 0             TO LTI-ANTICTERM ALTI-ANTICTERM
           ELSE
              MOVE OLT-ANTICTERM TO LTI-ANTICTERM ALTI-ANTICTERM.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              IF OLT-ANTICERN(SUB) NOT NUMERIC
                 MOVE 0                 TO LTI-ANTICERN(SUB)
                                          ALTI-ANTICERN(SUB)
              ELSE
                 MOVE OLT-ANTICERN(SUB) TO LTI-ANTICERN(SUB)
                                          ALTI-ANTICERN(SUB)
              END-IF
              IF OLT-ANTICADJ(SUB) NOT NUMERIC
                 MOVE 0                 TO LTI-ANTICADJ(SUB)
                                          ALTI-ANTICADJ(SUB)
              ELSE
                 MOVE OLT-ANTICADJ(SUB) TO LTI-ANTICADJ(SUB)
                                          ALTI-ANTICADJ(SUB)
              END-IF
              IF OLT-UFERN(SUB) NOT NUMERIC
                 MOVE 0                 TO LTI-UFERN(SUB)
                                          ALTI-UFERN(SUB)
              ELSE
                 MOVE OLT-UFERN(SUB)    TO LTI-UFERN(SUB)
                                          ALTI-UFERN(SUB)
              END-IF
              IF OLT-ACCERN(SUB) NOT NUMERIC
                 MOVE 0                 TO LTI-ACCERN(SUB)
                                          ALTI-ACCERN(SUB)
              ELSE
                 MOVE OLT-ACCERN(SUB)   TO LTI-ACCERN(SUB)
                                          ALTI-ACCERN(SUB)
              END-IF
           END-PERFORM.

           MOVE OLT-INT-REBATE TO LTI-INT-REBATE ALTI-INT-REBATE.
           IF OLT-INS-PAYMNT-INCR NOT NUMERIC
              MOVE 0                   TO LTI-INS-PAYMNT-INCR
                                         ALTI-INS-PAYMNT-INCR
           ELSE
              MOVE OLT-INS-PAYMNT-INCR TO LTI-INS-PAYMNT-INCR
                                         ALTI-INS-PAYMNT-INCR.
           IF OLT-INS-TOT-ADDON NOT NUMERIC
              MOVE 0                   TO LTI-INS-TOT-ADDON
                                         ALTI-INS-TOT-ADDON
           ELSE
              MOVE OLT-INS-TOT-ADDON   TO LTI-INS-TOT-ADDON
                                         ALTI-INS-TOT-ADDON.
           IF OLT-INT-LAST-EARNED NOT NUMERIC
              MOVE 0                   TO LTI-INT-LAST-EARNED
                                         ALTI-INT-LAST-EARNED
           ELSE
              MOVE OLT-INT-LAST-EARNED TO LTI-INT-LAST-EARNED
                                         ALTI-INT-LAST-EARNED.
           MOVE OLT-INS-REBATE      TO LTI-INS-REBATE ALTI-INS-REBATE.
           IF OLT-RB-WORKER NOT NUMERIC
              MOVE 0                TO LTI-RB-WORKER ALTI-RB-WORKER
           ELSE
              MOVE OLT-RB-WORKER    TO LTI-RB-WORKER  ALTI-RB-WORKER.
           MOVE OLT-ANTIC-START-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD       TO LTI-ANTIC-START-DATE
                                      ALTI-ANTIC-START-DATE.
           MOVE OLT-CANCEL-REASON-CD TO LTI-CANCEL-REASON-CD
                                       ALTI-CANCEL-REASON-CD.

           IF (FILE-OPTION-LT = "Y")
              PERFORM WRITE-LTI1-FILE
           ELSE
              ADD 1 TO ALTI-KEY
              ACCEPT ALTI-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTI-CR
              MOVE X"0A"              TO ALTI-LF
              PERFORM WRITE-ALTI-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTI"                   TO UP1534-CURRENT-FILE
              MOVE LTI1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LT-I-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LT-I-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - L
      *
      *=================================================================
      * LIENHOLDER IS CONVERTING MANY SEQUENCES TO 1 SEQUENCE
      * FORCE 1 TO SEQNO IN NEW FILE
      ******************************************************************
       UPGRADE-FILE-LT-L SECTION.

      * A15 KEY IS ACCTNO, CODE, SEQNO
      * 00000101A001
      * 00000101A002
      * 00000101B001
           IF FILE-OPTION-LT = "A"
      * NEED TO SEE IF NEW LT-L ALREADY EXISTS BECAUSE WE ARE COMBINING
      * MANY SEQUENCES, MUST TEST IF LAST SAVED KEY WAS FROM A "L" RECORD,
      * COULD HAVE BEEN FROM A "B" RECORD..., WITH SAME ACCOUNT #
              IF HOLD-LT-ACCTNO = OLT-ACCTNO AND HOLD-LT-CODE = "L"
                 MOVE HOLD-ALT-KEY TO ALTL-KEY
                 PERFORM READ-ALTL-FILE
                 IF IO-FG = 0
                    GO TO UPGRADE-FILE-LT-L-CONTINUE.

           IF FILE-OPTION-LT NOT = "A"
              MOVE BR-NO                   TO LTL-BRNO
              MOVE OLT-ACCTNO              TO OLD-ACCTNO
              MOVE NEW-ACCTNO              TO LTL-ACCTNO
              MOVE 1                       TO LTL-SEQNO
              PERFORM READ-LTL1-FILE
              IF ( IO-GOOD )
                 GO TO UPGRADE-FILE-LT-L-CONTINUE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LTL-REC DOES NOT EXIST; CREATE NEW LTL-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF FILE-OPTION-LT = "A"
              PERFORM CLEAR-ALTL-FILE
           ELSE
              PERFORM CLEAR-LTL-FILE.

           MOVE OLT-CODE             TO HOLD-LT-CODE.
           MOVE BR-NO                TO LTL-BRNO    ALTL-BRNO.
           MOVE OLT-ACCTNO           TO OLD-ACCTNO  HOLD-LT-ACCTNO.
           MOVE NEW-ACCTNO           TO LTL-ACCTNO  ALTL-ACCTNO.
           MOVE 1                    TO LTL-SEQNO   ALTL-SEQNO.
           IF FILE-OPTION-LT = "Y"
              PERFORM WRITE-LTL1-FILE
           ELSE
              ADD 1        TO ALTL-KEY
              MOVE ALTL-KEY TO HOLD-ALT-KEY
              ACCEPT ALTL-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTL-CR
              MOVE X"0A"              TO ALTL-LF
              PERFORM WRITE-ALTL-FILE.

           IF ( IO-BAD )
              MOVE "LTL"                   TO UP1534-CURRENT-FILE
              MOVE LTL1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 ADD 1                     TO UP1534-RECORD-COUNTER-SKIP
                 GO TO UPGRADE-FILE-LT-L-EXIT
              ELSE
                 GO TO IO-ERROR.

           IF FILE-OPTION-LT = "A"
      * THE KEY WILL STILL BE SET FROM ABOVE WRITE
              PERFORM READ-ALTL-FILE
           ELSE
              MOVE BR-NO                      TO LTL-BRNO
              MOVE OLT-ACCTNO                 TO OLD-ACCTNO
              MOVE NEW-ACCTNO                 TO LTL-ACCTNO
              MOVE 1                          TO LTL-SEQNO
              PERFORM READ-LTL1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTL"                   TO UP1534-CURRENT-FILE
              MOVE LTL1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *-----------------------------------------------------------------
       UPGRADE-FILE-LT-L-CONTINUE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * HERE WITH EITHER AN EXISTING RECORD OR A NEWLY CREATED EMPTY
      * RECORD!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF OLT-SEQNO = 1 OR 2 OR 3
              MOVE OLT-SEQNO TO SUB
              PERFORM UPGRADE-FILE-LT-L-LIEN.

           IF OLT-SEQNO = 4
              MOVE OLT-L-LIEN-COMMENT1     TO LTL-LIEN-COMMENT1
                                             ALTL-LIEN-COMMENT1
              MOVE OLT-L-LIEN-COMMENT2     TO LTL-LIEN-COMMENT2
                                             ALTL-LIEN-COMMENT2
              MOVE OLT-L-LIEN-TITLE-STATE  TO LTL-LIEN-TITLE-STATE
                                             ALTL-LIEN-TITLE-STATE
              MOVE OLT-L-TITLE-STATUS-CODE TO LTL-TITLE-STATUS-CODE
                                             ALTL-TITLE-STATUS-CODE
              IF (FILE-OPTION-LT = "Y")
                 PERFORM REWRITE-LTL1-FILE
              ELSE
                 PERFORM REWRITE-ALTL-FILE.

           IF OLT-SEQNO = 5
              MOVE OLT-L-TITLE-SEND-FLAG  TO LTL-TITLE-SEND-FLAG
                                            ALTL-TITLE-SEND-FLAG
              MOVE OLT-L-TITLE-NAME       TO LTL-TITLE-NAME
                                            ALTL-TITLE-NAME
              MOVE OLT-L-TITLE-ADR        TO LTL-TITLE-ADR
                                            ALTL-TITLE-ADR
              MOVE OLT-L-TITLE-CITY       TO LTL-TITLE-CITY
                                            ALTL-TITLE-CITY
              MOVE OLT-L-TITLE-STATE      TO LTL-TITLE-STATE
                                            ALTL-TITLE-STATE
              MOVE OLT-L-TITLE-ZIP        TO LTL-TITLE-ZIP
                                            ALTL-TITLE-ZIP
              MOVE OLT-L-TITLE-DATE TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD          TO LTL-TITLE-DATE
                                            ALTL-TITLE-DATE
              MOVE OLT-L-TITLE-SENT-BY    TO LTL-TITLE-SENT-BY
                                            ALTL-TITLE-SENT-BY
              MOVE OLT-L-SEND-ASAP        TO LTL-SEND-ASAP
                                            ALTL-SEND-ASAP
              IF OLT-L-TITLE-SEND-FMNO NOT NUMERIC
                 MOVE 0                   TO LTL-TITLE-SEND-FMNO
                                            ALTL-TITLE-SEND-FMNO
              ELSE
                 MOVE OLT-L-TITLE-SEND-FMNO TO LTL-TITLE-SEND-FMNO
                                              ALTL-TITLE-SEND-FMNO
              END-IF
              MOVE OLT-L-TITLE-ADR2       TO LTL-TITLE-ADR2
                                            ALTL-TITLE-ADR2
              IF (FILE-OPTION-LT = "Y")
                 PERFORM REWRITE-LTL1-FILE
              ELSE
                 PERFORM REWRITE-ALTL-FILE.

           IF OLT-SEQNO = 6
              MOVE OLT-L-TITLE-COMMENT1 TO LTL-TITLE-COMMENT1
                                          ALTL-TITLE-COMMENT1
              MOVE OLT-L-TITLE-COMMENT2 TO LTL-TITLE-COMMENT2
                                          ALTL-TITLE-COMMENT2
              MOVE OLT-L-RELEASE-TYPE   TO LTL-RELEASE-TYPE
                                          ALTL-RELEASE-TYPE
              MOVE OLT-L-CARRIER-TYPE   TO LTL-CARRIER-TYPE
                                          ALTL-CARRIER-TYPE
              MOVE OLT-L-CARRIER-ACCTNO TO LTL-CARRIER-ACCTNO
                                          ALTL-CARRIER-ACCTNO
              IF (FILE-OPTION-LT = "Y")
                 PERFORM REWRITE-LTL1-FILE
              ELSE
                 PERFORM REWRITE-ALTL-FILE.

           IF ( IO-BAD )
              MOVE "LTL(L)"                TO UP1534-CURRENT-FILE
              MOVE LTL1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              GO TO IO-ERROR.
       UPGRADE-FILE-LT-L-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - L - L I E N
      *
      *=================================================================
      *    CONVERT LT (C) LIENHOLDER - LIEN
      ******************************************************************
       UPGRADE-FILE-LT-L-LIEN SECTION.

           IF OLT-L-LIEN-TYPE NOT NUMERIC
              MOVE 0               TO LTL-LIEN-TYPE   (SUB)
                                     ALTL-LIEN-TYPE   (SUB)
           ELSE
              MOVE OLT-L-LIEN-TYPE TO LTL-LIEN-TYPE   (SUB)
                                     ALTL-LIEN-TYPE   (SUB).
           MOVE OLT-L-LIEN-NAME    TO LTL-LIEN-NAME   (SUB)
                                     ALTL-LIEN-NAME   (SUB).
           MOVE OLT-L-LIEN-ADR     TO LTL-LIEN-ADR    (SUB)
                                     ALTL-LIEN-ADR    (SUB).
           MOVE OLT-L-LIEN-CITY    TO LTL-LIEN-CITY   (SUB)
                                     ALTL-LIEN-CITY   (SUB).
           MOVE OLT-L-LIEN-STATE   TO LTL-LIEN-STATE  (SUB)
                                     ALTL-LIEN-STATE  (SUB).
           MOVE OLT-L-LIEN-ZIP     TO LTL-LIEN-ZIP    (SUB)
                                     ALTL-LIEN-ZIP    (SUB).

           MOVE OLT-L-LIEN-DATE TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LTL-LIEN-DATE   (SUB)
                                     ALTL-LIEN-DATE   (SUB).

           IF SUB = 1
              MOVE OLT-L-TITLE-NO       TO LTL-TITLE-NO
                                          ALTL-TITLE-NO
              MOVE OLT-L-LIEN-LETTER-SENT
                                        TO LTL-LIEN-LETTER-SENT
                                          ALTL-LIEN-LETTER-SENT
              IF OLT-L-TITLE-RCV-DATE NOT NUMERIC
                  MOVE 0 TO LTL-TITLE-RCV-DATE
                           ALTL-TITLE-RCV-DATE
              ELSE
                 MOVE OLT-L-TITLE-RCV-DATE TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD     TO LTL-TITLE-RCV-DATE
                                          ALTL-TITLE-RCV-DATE
              END-IF
              IF OLT-L-TITLE-LIEN-DATE NOT NUMERIC
                  MOVE 0 TO LTL-TITLE-LIEN-DATE
                           ALTL-TITLE-LIEN-DATE
              ELSE
                 MOVE OLT-L-TITLE-LIEN-DATE  TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD     TO LTL-TITLE-LIEN-DATE
                                          ALTL-TITLE-LIEN-DATE
              END-IF.


           IF (FILE-OPTION-LT = "Y")
              PERFORM REWRITE-LTL1-FILE
           ELSE
              PERFORM REWRITE-ALTL-FILE.

       UPGRADE-FILE-LT-L-LIEN-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L T - P
      *
      *=================================================================
      *    CONVERT LT (P) PAY SCHEDULE
      *
      *    PAYMENT SCHEDULES CAN HAVE MULTIPLE SEQUENCES IN
      *    OLD AND NEW FILE
      *    CONVERT EACH SEQUENCE FROM OLD TO NEW
      ******************************************************************
       UPGRADE-FILE-LT-P SECTION.

           IF FILE-OPTION-LT = "Y"
              PERFORM CLEAR-LTP-FILE
           ELSE
              PERFORM CLEAR-ALTP-FILE.

           MOVE BR-NO      TO LTP-BRNO    ALTP-BRNO.
           MOVE OLT-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO TO LTP-ACCTNO  ALTP-ACCTNO.
           MOVE OLT-SEQNO  TO LTP-SEQNO   ALTP-SEQNO.

           MOVE ZEROES     TO LTP-LTOUCH-DATE ALTP-LTOUCH-DATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 17
             IF OLT-SCHLD-TERM(SUB) NOT NUMERIC
                MOVE 0                   TO LTP-SCHLD-TERM(SUB)
                                           ALTP-SCHLD-TERM(SUB)
             ELSE
                MOVE OLT-SCHLD-TERM(SUB) TO LTP-SCHLD-TERM(SUB)
                                           ALTP-SCHLD-TERM(SUB)
             END-IF
             IF OLT-SCHLD-PAYMNT(SUB) NOT NUMERIC
                MOVE 0                     TO LTP-SCHLD-PAYMNT(SUB)
                                             ALTP-SCHLD-PAYMNT(SUB)
             ELSE
                MOVE OLT-SCHLD-PAYMNT(SUB) TO LTP-SCHLD-PAYMNT(SUB)
                                             ALTP-SCHLD-PAYMNT(SUB)
             END-IF
           END-PERFORM.

           IF (FILE-OPTION-LT = "Y")
              PERFORM WRITE-LTP1-FILE
           ELSE
              ADD 1 TO ALTP-KEY
              ACCEPT ALTP-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALTP-CR
              MOVE X"0A"              TO ALTP-LF
              PERFORM WRITE-ALTP-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE "LTP"                   TO UP1534-CURRENT-FILE
              MOVE LTP1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              MOVE "LT"                    TO UP1534-CURRENT-FILE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LT-P-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LT-P-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L X
      *
      ******************************************************************
       UPGRADE-FILE-LX SECTION.

      * 1/24/2024 I COMMENTED OUT THE ASCII UPGRADE, AS IT WAS NOT WORKING
      *           MISSING RECORDS!
     
           MOVE BR-NO       TO LX-BRNO.
           MOVE OLX-ACCTNO  TO OLD-ACCTNO.
           MOVE NEW-ACCTNO  TO LX-ACCTNO.
           MOVE OLX-SEQNO   TO LX-SEQNO.
           PERFORM READ-LX1-FILE.
           IF IO-FG = 0
              GO TO UPDATE-FILE-LX-CONTINUE.

      * LX-REC DOES NOT EXIST; CREATE NEW BLANK LX-REC

           PERFORM CLEAR-LX-FILE.

           MOVE BR-NO       TO LX-BRNO.
           MOVE OLX-ACCTNO  TO OLD-ACCTNO.
           MOVE NEW-ACCTNO  TO LX-ACCTNO.
           MOVE OLX-SEQNO   TO LX-SEQNO.

           PERFORM WRITE-LX1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LX-EXIT
              ELSE
                 GO TO IO-ERROR.

           MOVE BR-NO       TO LX-BRNO.
           MOVE OLX-ACCTNO  TO OLD-ACCTNO.
           MOVE NEW-ACCTNO  TO LX-ACCTNO.
           MOVE OLX-SEQNO   TO LX-SEQNO.
           PERFORM READ-LX1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              GO TO IO-ERROR.

       UPDATE-FILE-LX-CONTINUE.
           IF OLX-CODE = "A"
              PERFORM BUILD-LXA-REC
           ELSE
           IF OLX-CODE = "2"
              PERFORM MERGE-LXA-REC
           ELSE
           IF OLX-CODE = "M"
              PERFORM BUILD-LXM-REC
           ELSE
           IF OLX-CODE = "Z"
              PERFORM BUILD-LXZ-REC
           ELSE
           IF OLX-CODE = "P"
              PERFORM BUILD-LXP-REC
           ELSE
           IF OLX-CODE = "T"
              PERFORM BUILD-LXT-REC
           ELSE
           IF OLX-CODE = "X"
              PERFORM BUILD-LXX-REC
           ELSE
           IF OLX-CODE = "R"
              PERFORM BUILD-LXR-REC
           ELSE
              GO TO UPGRADE-FILE-LX-EXIT.

           PERFORM REWRITE-LX1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L X G
      *
      ******************************************************************
       UPGRADE-FILE-LXG SECTION.

           PERFORM CLEAR-LXG-FILE.

           MOVE BR-NO       TO LXG-BRNO.
           MOVE OLX-ACCTNO  TO OLD-ACCTNO.
           MOVE NEW-ACCTNO  TO LXG-ACCTNO.
           MOVE OLX-SEQNO   TO LXG-SEQNO.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
             IF OLXG-GLNO(SUB) NOT NUMERIC
               MOVE 0            TO LXG-GLNO(SUB) 
             ELSE
               MOVE OLXG-GLNO(SUB) TO LXG-GLNO(SUB)
             END-IF
             IF OLXG-GLAMT(SUB) NOT NUMERIC
               MOVE 0             TO LXG-GLAMT(SUB) 
             ELSE
               MOVE OLXG-GLAMT(SUB) TO LXG-GLAMT(SUB)
             END-IF.

           PERFORM WRITE-LXG1-FILE.
           IF (IO-BAD)
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE OLX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LXG-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LXG-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - L X E
      *
      ******************************************************************
       UPGRADE-FILE-LXE SECTION.

           PERFORM CLEAR-LXE-FILE.

           MOVE BR-NO       TO LXE-BRNO.
           MOVE OLX-ACCTNO  TO OLD-ACCTNO.
           MOVE NEW-ACCTNO  TO LXE-ACCTNO.
           MOVE OLX-SEQNO   TO LXE-SEQNO.

           MOVE OLXE-WORKER  TO LXE-WORKER.
           MOVE OLXE-WORKER2 TO LXE-WORKER2.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              IF OLXE-EARN(SUB) NOT NUMERIC
                 MOVE 0 TO LXE-EARN(SUB)
              ELSE
                 MOVE OLXE-EARN(SUB) TO LXE-EARN(SUB)
              END-IF
           END-PERFORM.

           PERFORM WRITE-LXE1-FILE.
           IF (IO-BAD)
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE OLX1-KEY                TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO UPGRADE-FILE-LXE-EXIT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

       UPGRADE-FILE-LXE-EXIT.
           EXIT.

      *=================================================================
      *
      *  IN A15, PC-ID ALLOWED FOR A, C AND 5:
      *
      *  PC-ID = "A" FOR SAVED AUTO INSURANCE INFO
      *  PC-ID = "C" FOR SAVED AUTO 1, AUTO 2, HHGS 1 AND HHGS2
      *  PC-ID = "5" FOR SAVED HHGS 3 (LT-SEQ 5) FOR UNITED ACCEPTANCE
      *
      *  IN A30, PC-ID OF 5 WERE MERGED INTO C:
      *
      *  PC-ID = "A" FOR SAVED AUTO INSURANCE INFO
      *  PC-ID = "C" FOR SAVED AUTO 1, AUTO 2, HHGS 1, HHGS 2, HHGS 3
      *
      ******************************************************************
      * UPGRADE-FILE-PC SECTION.

      *     IF ( PC-RECORD-STAT-GOOD )
      *        GO TO UPGRADE-FILE-PC-BEGIN.

      **- - - - - - - - - - - - - - - - - - - - - - - - -{ CLEAR PC-REC }
      **    IF OPC-ID = "5" OR "C", THEN NEED TO SPACE/ZERO
      **    THE PC-LT-RECORD (VIA WK-LT-RECORD) SO IT CAN BE
      **    USED GOING FORWARD.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE SPACES                     TO PC-REC.

      *     IF ( OPC-ID = "5" OR "C" )
      *        MOVE SPACES                  TO WK-LT-RECORD
      *        MOVE ZEROES                  TO WK-MILEAGE-1
      *                                        WK-VALUE-1
      *                                        WK-SELLPR-1
      *                                        WK-MISC-AMT-1
      *                                        WK-VIN-CHG-DATE-1
      *                                        WK-MILEAGE-2
      *                                        WK-VALUE-2
      *                                        WK-SELLPR-2
      *                                        WK-MISC-AMT-2
      *                                        WK-VIN-CHG-DATE-2
      *                                        WK-MILEAGE-3
      *                                        WK-VALUE-3
      *                                        WK-SELLPR-3
      *                                        WK-MISC-AMT-3
      *                                        WK-VIN-CHG-DATE-3
      *        MOVE WK-LT-RECORD            TO PC-LT-RECORD.
      **-----------------------------------------------------------------
      **    BEGIN UPGRADE OF PC-REC STARTING AT THE TOP WITH PC1-KEY
      **-----------------------------------------------------------------
      * UPGRADE-FILE-PC-BEGIN.

      *     IF ( OPC-ID = "5" )
      *        MOVE "C"                     TO PC-ID
      *     ELSE
      *        MOVE OPC-ID                  TO PC-ID.

      *     MOVE OPC-BRANCH                 TO PC-BRANCH.
      *     MOVE OPC-SOC-SEC                TO PC-SOC-SEC.

      **-----------------------------------------------------------------
      **    PC-LT-RECORD FOR OPC-ID = "5"
      **-----------------------------------------------------------------
      * UPGRADE-FILE-PC-ID-5.

      *     IF ( OPC-ID NOT = "5" )
      *        GO TO UPGRADE-FILE-PC-ID-A.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      **    LAYOUT FOR  PC-LT-RECORD IS IN WK-LT-RECORD {A30}.
      **    LAYOUT FOR OPC-LT-RECORD FOR OPC-ID OF "5"
      **     CONTAINS ONLY OWK-FREE-TYPE-3.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE PC-LT-RECORD               TO WK-LT-RECORD.
      *     MOVE OPC-LT-RECORD              TO WK-HHGS-3.

      *     MOVE WK-LT-RECORD               TO PC-LT-RECORD.

      **-----------------------------------------------------------------
      **    PC-LT-RECORD FOR OPC-ID = "A"
      **-----------------------------------------------------------------
      * UPGRADE-FILE-PC-ID-A.

      *     IF ( OPC-ID NOT = "A" )
      *        GO TO UPGRADE-FILE-PC-ID-C.


      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      **    LAYOUT FOR  PC-LT-RECORD IS IN WK-LTA-RECORD {A30}.
      **    LAYOUT FOR OPC-LT-RECORD IS IN OWK-LT-A-RECORD {A15}.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE OPC-LT-RECORD              TO OWK-LT-A-RECORD.
      *     MOVE SPACES                     TO WK-LTA-RECORD.

      *     MOVE OWK-LT-A-DLR-REQ           TO WK-LTA-DLR-REQ.
      *     MOVE OWK-LT-A-INS-TYPE          TO WK-LTA-INS-TYPE.
      *     MOVE OWK-LT-A-INS-CO            TO WK-LTA-INS-CO.
      *     MOVE OWK-LT-A-POLICY-NO         TO WK-LTA-POLICY-NO.
      *     MOVE OWK-LT-A-AGENCY            TO WK-LTA-AGENCY.
      *     MOVE OWK-LT-A-AGENT             TO WK-LTA-AGENT.
      *     MOVE OWK-LT-A-ADR1              TO WK-LTA-ADR1.
      *     MOVE OWK-LT-A-ADR2              TO WK-LTA-ADR2.
      *     MOVE OWK-LT-A-CITY              TO WK-LTA-CITY.
      *     MOVE OWK-LT-A-STATE             TO WK-LTA-STATE.
      *     MOVE OWK-LT-A-ZIP               TO WK-LTA-ZIP.
      *     MOVE OWK-LT-A-PHONE             TO WK-LTA-PHONE.

      *     MOVE OWK-LT-A-EFF-DATE          TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO WK-LTA-EFF-DATE.
      *     MOVE OWK-LT-A-EXP-DATE          TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO WK-LTA-EXP-DATE.

      *     MOVE OWK-LT-A-CAN-DATE          TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO WK-LTA-CAN-DATE.

      *     MOVE OWK-LT-A-CONF-DATE         TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO WK-LTA-CONF-DATE.

      *     MOVE OWK-LT-A-LAST-FORM         TO WK-LTA-LAST-FORM.
      *     MOVE OWK-LT-A-COV-TYPE          TO WK-LTA-COV-TYPE.
      *     MOVE OWK-LT-A-BIL-COV           TO WK-LTA-BIL-COV.
      *     MOVE OWK-LT-A-PDL-COV           TO WK-LTA-PDL-COV.
      *     MOVE OWK-LT-A-PIP-COV           TO WK-LTA-PIP-COV.
      *     MOVE OWK-LT-A-UMB-COV           TO WK-LTA-UMB-COV.
      *     MOVE OWK-LT-A-COL-COV           TO WK-LTA-COL-COV.
      *     MOVE OWK-LT-A-LOSS-PAYEE        TO WK-LTA-LOSS-PAYEE.
      *     MOVE OWK-LT-A-COM-COV           TO WK-LTA-COM-COV.
      *     MOVE SPACES                     TO WK-LTA-TRACK-ONLY.
      *     MOVE SPACES                     TO WK-LTA-INSURANCE.

      *     MOVE SPACES                     TO WK-LTA-TRACK-MONTHS.
      *     MOVE SPACES                     TO WK-LTA-INS-MONTHS.
      *     MOVE SPACES                     TO WK-LTA-CPP-MONTHS.

      *     MOVE WK-LTA-RECORD              TO PC-LT-RECORD.

      **-----------------------------------------------------------------
      **    PC-LT-RECORD FOR OPC-ID = "C"
      **-----------------------------------------------------------------
      * UPGRADE-FILE-PC-ID-C.

      *     IF ( OPC-ID NOT = "C" )
      *        GO TO UPGRADE-FILE-PC-CONTINUE.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      **    LAYOUT FOR  PC-LT-RECORD IS IN  WK-LT-RECORD {A30}.
      **    LAYOUT FOR OPC-LT-RECORD IS IN OWK-LT-RECORD {A15}.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE PC-LT-RECORD               TO WK-LT-RECORD.
      *     MOVE OPC-LT-RECORD              TO OWK-LT-RECORD.

      *     MOVE OWK-FREE-TYPE-1            TO WK-HHGS-1.
      *     MOVE OWK-FREE-TYPE-2            TO WK-HHGS-2.
      **KC> MOVE ***OPC-ID "5"***           TO WK-HHGS-3.

      *     MOVE OWK-DESCRIPTION-1          TO WK-DESC-1.
      *     MOVE OWK-MAKE-1                 TO WK-MAKE-1.
      *     MOVE OWK-MODEL-1                TO WK-MODEL-1.
      *     MOVE OWK-YEAR-1                 TO WK-YEAR-1.
      *     MOVE OWK-STYLE-1                TO WK-STYLE-1.
      *     MOVE OWK-CLASS-1                TO WK-CLASS-1.
      *     MOVE OWK-ID-1                   TO WK-VIN-1.
      *     MOVE OWK-TITLE-NO-1             TO WK-TITLE-NO-1.
      *     MOVE OWK-MILEAGE-1              TO WK-MILEAGE-1.
      *     MOVE OWK-VALUE-1                TO WK-VALUE-1.
      *     MOVE OWK-SELLPR-1               TO WK-SELLPR-1.
      *     MOVE OWK-MISC-AMT-1             TO WK-MISC-AMT-1.
      *     MOVE SPACES                     TO WK-SENT-FLAG-1.
      *     MOVE ZEROES                     TO WK-VIN-CHG-DATE-1.

      *     MOVE OWK-DESCRIPTION-2          TO WK-DESC-2.
      *     MOVE OWK-MAKE-2                 TO WK-MAKE-2.
      *     MOVE OWK-MODEL-2                TO WK-MODEL-2.
      *     MOVE OWK-YEAR-2                 TO WK-YEAR-2.
      *     MOVE OWK-STYLE-2                TO WK-STYLE-2.
      *     MOVE OWK-CLASS-2                TO WK-CLASS-2.
      *     MOVE OWK-ID-2                   TO WK-VIN-2.
      *     MOVE OWK-TITLE-NO-2             TO WK-TITLE-NO-2.
      *     MOVE OWK-MILEAGE-2              TO WK-MILEAGE-2.
      *     MOVE OWK-VALUE-2                TO WK-VALUE-2.
      *     MOVE OWK-SELLPR-2               TO WK-SELLPR-2.
      *     MOVE OWK-MISC-AMT-2             TO WK-MISC-AMT-2.
      *     MOVE SPACES                     TO WK-SENT-FLAG-2.
      *     MOVE ZEROES                     TO WK-VIN-CHG-DATE-2.

      *     MOVE SPACES                     TO WK-DESC-3.
      *     MOVE SPACES                     TO WK-MAKE-3.
      *     MOVE SPACES                     TO WK-MODEL-3.
      *     MOVE SPACES                     TO WK-YEAR-3.
      *     MOVE SPACES                     TO WK-STYLE-3.
      *     MOVE SPACES                     TO WK-CLASS-3.
      *     MOVE SPACES                     TO WK-VIN-3.
      *     MOVE SPACES                     TO WK-TITLE-NO-3.
      *     MOVE ZEROES                     TO WK-MILEAGE-3.
      *     MOVE ZEROES                     TO WK-VALUE-3.
      *     MOVE ZEROES                     TO WK-SELLPR-3.
      *     MOVE ZEROES                     TO WK-MISC-AMT-3.
      *     MOVE SPACES                     TO WK-SENT-FLAG-3.
      *     MOVE ZEROES                     TO WK-VIN-CHG-DATE-3.
      *     MOVE WK-LT-RECORD               TO PC-LT-RECORD.

      **-----------------------------------------------------------------
      * UPGRADE-FILE-PC-CONTINUE.

      *     MOVE OPC-LOANDATE               TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO PC-LOANDATE.

      *     MOVE OPC-ORGTERM                TO PC-ORGTERM.
      *     MOVE OPC-REGPYAMT               TO PC-REGPYAMT.

      *     IF ( OPC2-ID = "5" )
      *        MOVE "C"                     TO PC2-ID
      *     ELSE
      *        MOVE OPC-ID                  TO PC2-ID.

      *     MOVE OPC2-BRANCH                TO PC2-BRANCH.
      *     MOVE OPC2-BWNAME                TO PC2-BWNAME.

      * UPGRADE-FILE-PC-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - R X
      *
      ******************************************************************
       UPGRADE-FILE-RX SECTION.

           MOVE SPACES                     TO RX-REC.
           MOVE RX-PATH-OWNBR              TO RX-BRNO.
           MOVE ORX-ACCTNO                 TO RX-ACCTNO.
           MOVE ORX-DLNO                   TO RX-DLNO.

           MOVE ORX-INTDATE                TO DATE-YYYMMDD.
           PERFORM CONVERT-YYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO RX-INTDATE.

           MOVE ORX-LNAME                  TO RX-LNAME.
           MOVE ORX-FNAME                  TO RX-FNAME.
           MOVE ZEROES                     TO RX-LTOUCH-DATE.

           MOVE ORX-LOANDATE               TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO RX-LOANDATE.

           MOVE ORX-LOANAMT                TO RX-LOANAMT.
           MOVE ORX-PROCEEDS               TO RX-PROCEEDS.
           MOVE ORX-STATUS                 TO RX-STATUS.

       UPGRADE-FILE-RX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - T Y
      *
      ******************************************************************
       UPGRADE-FILE-TY SECTION.

           PERFORM CLEAR-TY-FILE.

           MOVE OTY-BRNO                   TO TY-BRNO.
           MOVE OTY-DATE                   TO DATE-YYYMMDD.
           PERFORM CONVERT-YYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO TY-DATE.
           MOVE OTY-CLASS                  TO TY-CLASS.

           MOVE 0                          TO TY-LTOUCH-DATE.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                   AFTER   S2 FROM 1 BY 1 UNTIL S2 > 11
               IF OTY-NO (S1 S2) NOT NUMERIC
                  MOVE 0              TO TY-NO (S1 S2)
               ELSE
                  MOVE OTY-NO (S1 S2) TO TY-NO (S1 S2)
               END-IF
               IF OTY-AMT(S1 S2) NOT NUMERIC
                  MOVE 0              TO TY-AMT(S1 S2)
               ELSE
                  MOVE OTY-AMT(S1 S2) TO TY-AMT(S1 S2)
               END-IF
               IF OTY-O2 (S1 S2) NOT NUMERIC
                  MOVE 0              TO TY-O2 (S1 S2)
               ELSE
                  MOVE OTY-O2 (S1 S2) TO TY-O2 (S1 S2)
               END-IF
               IF OTY-INT(S1 S2) NOT NUMERIC
                  MOVE 0              TO TY-INT(S1 S2)
               ELSE
                  MOVE OTY-INT(S1 S2) TO TY-INT(S1 S2)
               END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                  AFTER S2 FROM 1 BY 1 UNTIL S2 > 5
               IF OTY-NO-REPO (S1 S2) NOT NUMERIC
                  MOVE 0                   TO TY-NO-REPO (S1 S2)
               ELSE
                  MOVE OTY-NO-REPO (S1 S2) TO TY-NO-REPO (S1 S2)
               END-IF
               IF OTY-AMT-REPO(S1 S2) NOT NUMERIC
                  MOVE 0                   TO TY-AMT-REPO(S1 S2)
               ELSE
                  MOVE OTY-AMT-REPO(S1 S2) TO TY-AMT-REPO(S1 S2)
               END-IF
               IF OTY-O2-REPO (S1 S2) NOT NUMERIC
                  MOVE 0                   TO TY-O2-REPO (S1 S2)
               ELSE
                  MOVE OTY-O2-REPO (S1 S2) TO TY-O2-REPO (S1 S2)
               END-IF
               IF OTY-INT-REPO(S1 S2) NOT NUMERIC
                  MOVE 0                   TO TY-INT-REPO(S1 S2)
               ELSE
                  MOVE OTY-INT-REPO(S1 S2) TO TY-INT-REPO(S1 S2)
               END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                   AFTER S2 FROM 1 BY 1 UNTIL S2 > 10
               IF OTY-NO-PL (S1 S2) NOT NUMERIC
                  MOVE 0                 TO TY-NO-PL (S1 S2)
               ELSE
                  MOVE OTY-NO-PL (S1 S2) TO TY-NO-PL (S1 S2)
               END-IF
               IF OTY-AMT-PL(S1 S2) NOT NUMERIC
                  MOVE 0                 TO TY-AMT-PL(S1 S2)
               ELSE
                  MOVE OTY-AMT-PL(S1 S2) TO TY-AMT-PL(S1 S2)
               END-IF
               IF OTY-O2-PL (S1 S2) NOT NUMERIC
                  MOVE 0                 TO TY-O2-PL (S1 S2)
               ELSE
                  MOVE OTY-O2-PL (S1 S2) TO TY-O2-PL (S1 S2)
               END-IF
               IF OTY-INT-PL(S1 S2) NOT NUMERIC
                  MOVE 0                 TO TY-INT-PL(S1 S2)
               ELSE
                  MOVE OTY-INT-PL(S1 S2) TO TY-INT-PL(S1 S2)
               END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                   AFTER S2 FROM 1 BY 1 UNTIL S2 > 3
               IF OTY-DLRVPRIN(S1 S2) NOT NUMERIC
                  MOVE 0                   TO TY-DLRVPRIN(S1 S2)
               ELSE
                  MOVE OTY-DLRVPRIN(S1 S2) TO TY-DLRVPRIN(S1 S2)
               END-IF
               IF OTY-DLRVCHGS(S1 S2) NOT NUMERIC
                  MOVE 0                    TO TY-DLRVCHGS(S1 S2)
               ELSE
                   MOVE OTY-DLRVCHGS(S1 S2) TO TY-DLRVCHGS(S1 S2)
               END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
               IF OTY-DLPARVHELD(S1) NOT NUMERIC
                  MOVE 0                  TO TY-DLPARVHELD(S1)
               ELSE
                  MOVE OTY-DLPARVHELD(S1) TO TY-DLPARVHELD(S1)
               END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 5
               IF OTY-PL-PRINCOL(S1) NOT NUMERIC
                  MOVE 0                  TO TY-PL-PRINCOL(S1)
               ELSE
                  MOVE OTY-PL-PRINCOL(S1) TO TY-PL-PRINCOL(S1)
               END-IF
               IF OTY-PL-INTCOL(S1) NOT NUMERIC
                  MOVE 0                  TO TY-PL-INTCOL(S1)
               ELSE
                  MOVE OTY-PL-INTCOL(S1)  TO TY-PL-INTCOL(S1)
               END-IF
               IF OTY-PL-LATECOL(S1) NOT NUMERIC
                  MOVE 0                  TO TY-PL-LATECOL(S1)
               ELSE
                  MOVE OTY-PL-LATECOL(S1) TO TY-PL-LATECOL(S1)
               END-IF
               IF OTY-PL-O2COL(S1) NOT NUMERIC
                  MOVE 0                  TO TY-PL-O2COL(S1)
               ELSE
                  MOVE OTY-PL-O2COL(S1)   TO TY-PL-O2COL(S1)
               END-IF
           END-PERFORM.

           IF OTY-AMT-SOLD NOT NUMERIC
              MOVE 0                       TO TY-AMT-SOLD
           ELSE
              MOVE OTY-AMT-SOLD            TO TY-AMT-SOLD.
           IF OTY-AMT-TRANS NOT NUMERIC
              MOVE 0                       TO TY-AMT-TRANS
           ELSE
              MOVE OTY-AMT-TRANS           TO TY-AMT-TRANS.
           IF OTY-AMT-PURCH NOT NUMERIC
              MOVE 0                       TO TY-AMT-PURCH
           ELSE
              MOVE OTY-AMT-PURCH           TO TY-AMT-PURCH.
           IF OTY-NO-SOLD NOT NUMERIC
              MOVE 0                       TO TY-NO-SOLD
           ELSE
              MOVE OTY-NO-SOLD             TO TY-NO-SOLD.
           IF OTY-NO-TRANS NOT NUMERIC
              MOVE 0                       TO TY-NO-TRANS
           ELSE
              MOVE OTY-NO-TRANS            TO TY-NO-TRANS.
           IF OTY-NO-PURCH NOT NUMERIC
              MOVE 0                       TO TY-NO-PURCH
           ELSE
              MOVE OTY-NO-PURCH            TO TY-NO-PURCH.
           IF OTY-OTHCOL NOT NUMERIC
              MOVE 0                       TO TY-OTHCOL
           ELSE
              MOVE OTY-OTHCOL              TO TY-OTHCOL.
           IF OTY-OT2COL NOT NUMERIC
              MOVE 0                       TO TY-OT2COL
           ELSE
              MOVE OTY-OT2COL              TO TY-OT2COL.
           IF OTY-INTCOL NOT NUMERIC
              MOVE 0                       TO TY-INTCOL
           ELSE
              MOVE OTY-INTCOL              TO TY-INTCOL.
           IF OTY-LATECOL NOT NUMERIC
              MOVE 0                       TO TY-LATECOL
           ELSE
              MOVE OTY-LATECOL             TO TY-LATECOL.
           IF OTY-PRINCOL NOT NUMERIC
              MOVE 0                       TO TY-PRINCOL
           ELSE
              MOVE OTY-PRINCOL             TO TY-PRINCOL.
           IF OTY-DEFCOL NOT NUMERIC
              MOVE 0                       TO TY-DEFCOL
           ELSE
              MOVE OTY-DEFCOL              TO TY-DEFCOL.
           IF OTY-RNPRIN NOT NUMERIC
              MOVE 0                       TO TY-RNPRIN
           ELSE
              MOVE OTY-RNPRIN              TO TY-RNPRIN.
           IF OTY-INTREB NOT NUMERIC
              MOVE 0                       TO TY-INTREB
           ELSE
              MOVE OTY-INTREB              TO TY-INTREB.
           IF OTY-CLREB1 NOT NUMERIC
              MOVE 0                       TO TY-CLREB1
           ELSE
              MOVE OTY-CLREB1              TO TY-CLREB1.
           IF OTY-CLREB2 NOT NUMERIC
              MOVE 0                       TO TY-CLREB2
           ELSE
              MOVE OTY-CLREB2              TO TY-CLREB2.
           IF OTY-CLREB3 NOT NUMERIC
              MOVE 0                       TO TY-CLREB3
           ELSE
              MOVE OTY-CLREB3              TO TY-CLREB3.
           IF OTY-CLREB4 NOT NUMERIC
              MOVE 0                       TO TY-CLREB4
           ELSE
              MOVE OTY-CLREB4              TO TY-CLREB4.
           IF OTY-AHREB NOT NUMERIC
              MOVE 0                       TO TY-AHREB
           ELSE
              MOVE OTY-AHREB               TO TY-AHREB.
           IF OTY-PPREB NOT NUMERIC
              MOVE 0                       TO TY-PPREB
           ELSE
              MOVE OTY-PPREB               TO TY-PPREB.
           IF OTY-O1REB NOT NUMERIC
              MOVE 0                       TO TY-O1REB
           ELSE
              MOVE OTY-O1REB               TO TY-O1REB.
           IF OTY-O2REB NOT NUMERIC
              MOVE 0                       TO TY-O2REB
           ELSE
              MOVE OTY-O2REB               TO TY-O2REB.
           IF OTY-O3REB NOT NUMERIC
              MOVE 0                       TO TY-O3REB
           ELSE
              MOVE OTY-O3REB               TO TY-O3REB.
           IF OTY-O4REB NOT NUMERIC
              MOVE 0                       TO TY-O4REB
           ELSE
              MOVE OTY-O4REB               TO TY-O4REB.
           IF OTY-O5REB NOT NUMERIC
              MOVE 0                       TO TY-O5REB
           ELSE
              MOVE OTY-O5REB               TO TY-O5REB.
           IF OTY-O6REB NOT NUMERIC
              MOVE 0                       TO TY-O6REB
           ELSE
              MOVE OTY-O6REB               TO TY-O6REB.
           IF OTY-O7REB NOT NUMERIC
              MOVE 0                       TO TY-O7REB
           ELSE
              MOVE OTY-O7REB               TO TY-O7REB.
           IF OTY-SCREB NOT NUMERIC
              MOVE 0                       TO TY-SCREB
           ELSE
              MOVE OTY-SCREB               TO TY-SCREB.
           IF OTY-MFREB NOT NUMERIC
              MOVE 0                       TO TY-MFREB
           ELSE
              MOVE OTY-MFREB               TO TY-MFREB.
           IF OTY-DFREB NOT NUMERIC
              MOVE 0                       TO TY-DFREB
           ELSE
              MOVE OTY-DFREB               TO TY-DFREB.
           MOVE ZEROES                     TO TY-UN7-REB
                                              TY-UN8-REB
                                              TY-UN9-REB
                                              TY-UN10-REB.

           IF OTY-PART-CHGOFF NOT NUMERIC
              MOVE 0                       TO TY-PART-CHGOFF
           ELSE
              MOVE OTY-PART-CHGOFF         TO TY-PART-CHGOFF.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 7
              IF OTY-INS-NO-ELIG(S1) NOT NUMERIC
                 MOVE 0 TO TY-INS-NO-ELIG(S1)
              ELSE
                 MOVE OTY-INS-NO-ELIG(S1) TO TY-INS-NO-ELIG(S1)
              END-IF
              IF OTY-INS-NO-WROTE(S1) NOT NUMERIC
                 MOVE 0 TO TY-INS-NO-WROTE(S1)
              ELSE
                 MOVE OTY-INS-NO-WROTE(S1) TO TY-INS-NO-WROTE(S1)
              END-IF
              IF OTY-INS-NO-NOTWROTE(S1) NOT NUMERIC
                 MOVE 0                 TO TY-INS-NO-NOTWROTE(S1)
              ELSE
                 MOVE OTY-INS-NO-NOTWROTE(S1) TO
                                           TY-INS-NO-NOTWROTE(S1)
              END-IF
              IF OTY-INS-AMT-WROTE(S1) NOT NUMERIC
                 MOVE 0                 TO TY-INS-AMT-WROTE(S1)
              ELSE
                 MOVE OTY-INS-AMT-WROTE  (S1) TO
                                           TY-INS-AMT-WROTE(S1)
              END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 8 BY 1 UNTIL S1 > 10
                   MOVE 0 TO TY-INS-NO-ELIG    (S1)
                   MOVE 0 TO TY-INS-NO-WROTE   (S1)
                   MOVE 0 TO TY-INS-NO-NOTWROTE(S1)
                   MOVE 0 TO TY-INS-AMT-WROTE  (S1)
           END-PERFORM.

      * NONFILE, AD&D, ROADGARD WERE 8,9,10 IN INS TABLE, NOW THEY
      * ARE 1, 2, 3 IN FEE INS TABLE:

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
              IF OTY-INS-NO-ELIG(S1 + 7) NOT NUMERIC
                 MOVE 0                    TO TY-FEE-NO-ELIG(S1)
              ELSE
                 MOVE OTY-INS-NO-ELIG(S1 + 7)
                                           TO TY-FEE-NO-ELIG(S1)
              END-IF
              IF OTY-INS-NO-WROTE(S1 + 7) NOT NUMERIC
                 MOVE 0                    TO TY-FEE-NO-WROTE(S1)
              ELSE
                 MOVE OTY-INS-NO-WROTE(S1 + 7)
                                           TO TY-FEE-NO-WROTE(S1)
              END-IF
              IF OTY-INS-NO-NOTWROTE(S1 + 7) NOT NUMERIC
                 MOVE 0                    TO TY-FEE-NO-NOTWROTE(S1)
              ELSE
                 MOVE OTY-INS-NO-NOTWROTE(S1 + 7)
                                           TO TY-FEE-NO-NOTWROTE(S1)
              END-IF
              IF OTY-INS-AMT-WROTE(S1 + 7) NOT NUMERIC
                 MOVE 0                    TO TY-FEE-AMT-WROTE(S1)
              ELSE
                 MOVE OTY-INS-AMT-WROTE(S1 + 7)
                                           TO TY-FEE-AMT-WROTE(S1)
              END-IF
           END-PERFORM.

           IF OTY-OTH-NO-COL NOT NUMERIC
              MOVE 0                       TO TY-OTH-NO-COL
           ELSE
              MOVE OTY-OTH-NO-COL          TO TY-OTH-NO-COL.
           IF OTY-OT2-NO-COL NOT NUMERIC
              MOVE 0                       TO TY-OT2-NO-COL
           ELSE
              MOVE OTY-OT2-NO-COL          TO TY-OT2-NO-COL.
           IF OTY-INT-NO-COL NOT NUMERIC
              MOVE 0                       TO TY-INT-NO-COL
           ELSE
              MOVE OTY-INT-NO-COL          TO TY-INT-NO-COL.
           IF OTY-LATE-NO-COL NOT NUMERIC
              MOVE 0                       TO TY-LATE-NO-COL
           ELSE
              MOVE OTY-LATE-NO-COL         TO TY-LATE-NO-COL.
           IF OTY-OTH-NO-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-OTH-NO-WAIVED
           ELSE
              MOVE OTY-OTH-NO-WAIVED       TO TY-OTH-NO-WAIVED.
           IF OTY-OT2-NO-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-OT2-NO-WAIVED
           ELSE
              MOVE OTY-OT2-NO-WAIVED       TO TY-OT2-NO-WAIVED.
           IF OTY-INT-NO-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-INT-NO-WAIVED
           ELSE
              MOVE OTY-INT-NO-WAIVED       TO TY-INT-NO-WAIVED.
           IF OTY-LATE-NO-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-LATE-NO-WAIVED
           ELSE
              MOVE OTY-LATE-NO-WAIVED      TO TY-LATE-NO-WAIVED.
           IF OTY-OTH-AMT-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-OTH-AMT-WAIVED
           ELSE
              MOVE OTY-OTH-AMT-WAIVED      TO TY-OTH-AMT-WAIVED.
           IF OTY-OT2-AMT-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-OT2-AMT-WAIVED
           ELSE
              MOVE OTY-OT2-AMT-WAIVED      TO TY-OT2-AMT-WAIVED.
           IF OTY-INT-AMT-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-INT-AMT-WAIVED
           ELSE
              MOVE OTY-INT-AMT-WAIVED      TO TY-INT-AMT-WAIVED.
           IF OTY-LATE-AMT-WAIVED NOT NUMERIC
              MOVE 0                       TO TY-LATE-AMT-WAIVED
           ELSE
              MOVE OTY-LATE-AMT-WAIVED     TO TY-LATE-AMT-WAIVED.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 8
              IF OTY-CKWRITTEN(S1) NOT NUMERIC
                 MOVE 0                 TO TY-CKWRITTEN(S1)
              ELSE
                 MOVE OTY-CKWRITTEN(S1) TO TY-CKWRITTEN(S1)
              END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 9 BY 1 UNTIL S1 > 16
                 MOVE 0 TO TY-CKWRITTEN(S1)
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                   AFTER S2 FROM 1 BY 1 UNTIL S2 > 10
              IF OTY-UNITS(S1 S2) NOT NUMERIC
                 MOVE 0                 TO TY-UNITS(S1 S2)
              ELSE
                 MOVE OTY-UNITS(S1 S2) TO TY-UNITS(S1 S2)
              END-IF
              IF OTY-OUTBAL(S1 S2) NOT NUMERIC
                 MOVE 0                 TO TY-OUTBAL(S1 S2)
              ELSE
                 MOVE OTY-OUTBAL(S1 S2) TO TY-OUTBAL(S1 S2)
              END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
                   AFTER S2 FROM 1 BY 1 UNTIL S2 > 10
              MOVE 0 TO TY-UNITS-BNKRPT (S1 S2)
              MOVE 0 TO TY-OUTBAL-BNKRPT(S1 S2)
           END-PERFORM.

           IF OTY-SUMWGTTM NOT NUMERIC
              MOVE 0                       TO TY-SUMWGTTM
           ELSE
              MOVE OTY-SUMWGTTM            TO TY-SUMWGTTM.
           IF OTY-SUMWGTAV NOT NUMERIC
              MOVE 0                       TO TY-SUMWGTAV
           ELSE
              MOVE OTY-SUMWGTAV            TO TY-SUMWGTAV.
           IF OTY-SUMWGTTA NOT NUMERIC
              MOVE 0                       TO TY-SUMWGTTA
           ELSE
              MOVE OTY-SUMWGTTA            TO TY-SUMWGTTA.
           IF OTY-ALLOTMENTS NOT NUMERIC
              MOVE 0                       TO TY-ALLOTMENTS
           ELSE
              MOVE OTY-ALLOTMENTS          TO TY-ALLOTMENTS.
           MOVE OTY-BRFG                   TO TY-BRFG.

           IF OTY-DLDISC NOT NUMERIC
              MOVE 0                       TO TY-DLDISC
           ELSE
              MOVE OTY-DLDISC              TO TY-DLDISC.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 02
                     AFTER S2 FROM 1 BY 1 UNTIL S2 > 06
              IF OTY-UNEARNED-AMT(S1 S2) NOT NUMERIC
                 MOVE 0          TO TY-UNEARNED-AMT(S1 S2)
              ELSE
                 MOVE OTY-UNEARNED-AMT(S1 S2) TO
                                    TY-UNEARNED-AMT(S1 S2)
              END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 02
                     AFTER S2 FROM 7 BY 1 UNTIL S2 > 10
                 MOVE 0 TO TY-UNEARNED-AMT(S1 S2)
           END-PERFORM.

           IF OTY-PROCEEDS NOT NUMERIC
              MOVE 0                       TO TY-PROCEEDS
           ELSE
              MOVE OTY-PROCEEDS            TO TY-PROCEEDS.
           IF OTY-LOCKBOX NOT NUMERIC
              MOVE 0                       TO TY-LOCKBOX
           ELSE
              MOVE OTY-LOCKBOX             TO TY-LOCKBOX.

       UPGRADE-FILE-TY-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - A L
      *
      ******************************************************************
       UPGRADE-FILE-AL SECTION.

           PERFORM CLEAR-AL-FILE.

           MOVE OAL-ID       TO AL-ID.
           MOVE OAL-DESC     TO AL-DESC.    
           IF OAL-NO-ACCTS NOT NUMERIC
              MOVE 0         TO AL-NO-ACCTS
           ELSE
           MOVE OAL-NO-ACCTS TO AL-NO-ACCTS.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              IF OAL-ACCT(SUB) NOT NUMERIC
                 MOVE 0             TO AL-ACCT(SUB)
              ELSE
                 MOVE OAL-ACCT(SUB) TO AL-ACCT(SUB)
              END-IF
              IF OAL-PCT(SUB) NOT NUMERIC
                 MOVE 0             TO AL-PCT(SUB)
              ELSE
              MOVE OAL-PCT(SUB)     TO AL-PCT(SUB)
              END-IF
           END-PERFORM.

           MOVE OAL-TYPE        TO AL-TYPE.

       UPGRADE-FILE-AL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C D
      *
      *=================================================================
      *    NOTE: A15 MN/CDMAIN MOVED ALL DESC FIELDS TO CD-DESC
      *          (EXPECT FOR TYPES EA & FC) EVENTHOUGH THERE WAS
      *          A FIELD DEFINED FOR THAT TYPE.  FOR EXAMPLE, CDMAIN
      *          MOVED VDUBUF TO CD-DESC (35 BYTES) EVENTHOUGH THERE
      *          WAS CD-CLDESC (20 BYTES WITH 42 BYTES FOLLOWING IN
      *          FILLER).  SO IN SOME CASES WILL NEED TO USE OCD-DESC
      *          INSTEAD OF OCD-??-DESC WHEN SETTING NEW A30 CD-DESC.
      *
      *          *KC> MOVE OCD-CLDESC                 TO CD-CL-DESC.
      *               MOVE OCD-DESC                   TO CD-CL-DESC.
      *
      ******************************************************************
       UPGRADE-FILE-CD SECTION.

           PERFORM CLEAR-CD-FILE.

      *-----------------------------------------------------------------
      *    { - ACTION CODES
      *-----------------------------------------------------------------
           IF ( OCD-ACTIONTYPE NOT = "{" )
              GO TO UPGRADE-FILE-CD-AT.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ CD-ACTIONKEY }
           MOVE "AC"                       TO CD-TYPE.
           MOVE OCD-ACTIONCODE             TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    AT - ACTIVITY CODES
      *
      *    TYPE "AT" USES THE KEY FROM THE OLD BASE FORMAT.
      *    TYPE "AT" USES THE DESC FROM THE OLD BASE FORMAT.
      *    TYPE "AT" USES SOME FIELDS FROM THE OLD CD-AC-RE-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-AT.

           IF ( OCD-TYPE NOT = "AT" )
              GO TO UPGRADE-FILE-CD-BR.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    THESE FIELDS ARE MATCHING (LOCATION, NAME, SIZE) IN CD-RE-REC
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OCD-ACTIONCD               TO CD-AT-ACTIONCD.
           MOVE OCD-MEMO-REQUIRED          TO CD-AT-MEMO-REQUIRED.
           MOVE OCD-SUPERVISOR-ONLY        TO CD-AT-SUPERVISOR-ONLY.
           MOVE OCD-RESULT-REQUIRED        TO CD-AT-RESULT-REQUIRED.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    BR - BATCH (PAYMENT) REFERENCE CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-BR.

           IF ( OCD-BR-TYPE NOT = "BR" )
              GO TO UPGRADE-FILE-CD-BS.

           MOVE OCD-BR-TYPE                TO CD-TYPE.
           MOVE OCD-BR-REFCD               TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-BR-DESC                TO CD-DESC.

           MOVE OCD-BR-FILE-TYPE           TO CD-BR-FILE-TYPE.
           MOVE OCD-BR-FILE-NAME           TO CD-BR-FILE-NAME.
           MOVE OCD-BR-PAYOFF-FG           TO CD-BR-PAYOFF-FG.
           MOVE OCD-BR-POST-SS-TRCD        TO CD-BR-POST-SS-TRCD.
           IF OCD-BR-GL-BRANCH NOT NUMERIC
              MOVE 0                       TO CD-BR-GL-BRANCH
           ELSE
           MOVE OCD-BR-GL-BRANCH           TO CD-BR-GL-BRANCH.
           IF OCD-BR-GL-ACCT NOT NUMERIC
              MOVE 0                       TO CD-BR-GL-ACCT
           ELSE
           MOVE OCD-BR-GL-ACCT             TO CD-BR-GL-ACCT.
           MOVE OCD-BR-ALLOT-OPTION        TO CD-BR-ALLOT-OPTION.
           MOVE OCD-BR-LBOX-OPTION         TO CD-BR-LBOX-OPTION.
           MOVE OCD-BR-LC-FG               TO CD-BR-LC-FG.
           IF OCD-BR-OT-GL-BRANCH NOT NUMERIC
              MOVE 0                       TO CD-BR-OT-GL-BRANCH
           ELSE
           MOVE OCD-BR-OT-GL-BRANCH        TO CD-BR-OT-GL-BRANCH.
           IF OCD-BR-OT-GL-ACCT NOT NUMERIC
              MOVE 0                       TO CD-BR-OT-GL-ACCT
           ELSE
           MOVE OCD-BR-OT-GL-ACCT          TO CD-BR-OT-GL-ACCT.
           MOVE OCD-BR-MULTIPLE-REFCDS     TO CD-BR-MULTIPLE-REFCDS.
           MOVE OCD-BR-COLLECT-LC          TO CD-BR-COLLECT-LC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    BS - PAYMENT REFERENCE CODES     (LP-REFNO)
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-BS.

           IF ( OCD-BS-TYPE NOT = "BS" )
              GO TO UPGRADE-FILE-CD-BW.

           MOVE OCD-BS-TYPE                TO CD-TYPE.
           MOVE OCD-BS-REFNO               TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    BW - BORROWER HOUSING CODES        (BUYING,OWNS,RENTS,NONE)
      *    A2 - ACTION CODE 2                 (SECURIZATION)
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-BW.

           IF NOT ( OCD-BW-TYPE = "BW" OR "A2" )
              GO TO UPGRADE-FILE-CD-CH.

           MOVE OCD-BW-TYPE                TO CD-TYPE.
           MOVE OCD-BW-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    CH - CHARGE OFF (P&L) REASON CODE
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CH.

           IF ( OCD-BW-TYPE NOT = "CH" )
              GO TO UPGRADE-FILE-CD-CL.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.


      *-----------------------------------------------------------------
      *    CL - CAN LOAN GROUP ID
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CL.

           IF ( OCD-CLTYPE NOT = "CL" )
              GO TO UPGRADE-FILE-CD-CN.

           MOVE OCD-CLTYPE                 TO CD-TYPE.
           MOVE OCD-CLGROUP-ID             TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    CN - COLLECTOR ID
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CN.

           IF ( OCD-CN-TYPE NOT = "CN" )
              GO TO UPGRADE-FILE-CD-CO.

           PERFORM CLEAR-CDB-FILE.

           MOVE OCD-CN-TYPE                TO CDB-TYPE.
           MOVE OCD-CN-BRANCH              TO CDB-BRANCH.
           MOVE OCD-CN-CODE                TO CDB-CODE.
           MOVE 0                          TO CDB-LTOUCH-DATE.
           MOVE OCD-CN-DESC                TO CDB-DESC.

           MOVE OCD-CN-GROUP-ID            TO CDB-CN-GROUP-ID.
      * CLEANSE CD-CN-PHONE     9(10) COMP-3
      *         CD-CN-PHONE-EXT 9(5)  COMP-3
           IF OCD-CN-PHONE =  2020202020 OR 0202020202 OR 
                              202020000  OR
                 (OCD-CN-PHONE NOT NUMERIC)
              MOVE 0                       TO CDB-CN-PHONE
           ELSE
              MOVE OCD-CN-PHONE            TO CDB-CN-PHONE.
           IF OCD-CN-PHONE-EXT =  2020202020 OR 0202020202 OR
                 (OCD-CN-PHONE-EXT NOT NUMERIC)
              MOVE 0                  TO CDB-CN-PHONE-EXT
           ELSE
              MOVE OCD-CN-PHONE-EXT   TO CDB-CN-PHONE-EXT.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    CO - COLLATERAL CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CO.

           IF ( OCD-TYPE NOT = "CO" )
              GO TO UPGRADE-FILE-CD-CT.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           MOVE OCD-GROUP                  TO CD-CO-GROUP.
           MOVE OCD-SECURED                TO CD-CO-SECURED.
           MOVE OCD-TRW                    TO CD-CO-TRW.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    CT - COUNTY INSURANCE TAX RATES FOR KENTUCKY
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CT.

           IF ( OCD-CT-TYPE NOT = "CT" )
              GO TO UPGRADE-FILE-CD-CY.

           MOVE OCD-CT-TYPE                TO CD-TYPE.
           MOVE OCD-CT-STATE               TO CD-CT-STATE.
           MOVE OCD-CT-COUNTY              TO CD-CT-COUNTY.
           MOVE SPACES                     TO CD-CT-FILLER.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-CT-COUNTY-DESC         TO CD-DESC.

           MOVE OCD-CT-BOTH-TAX-FG         TO CD-CT-BOTH-TAX-FG.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 12
              MOVE OCD-CT-INSTAXFRMLA(SUB) TO CD-CT-INSTAXFRMLA(SUB)
              IF ( OCD-CT-INSTAXAMT(SUB) NOT NUMERIC ) OR
                 ( SUB = 11 OR 12                    )
                 MOVE 0                     TO CD-CT-INSTAXAMT(SUB)
              ELSE
                 MOVE OCD-CT-INSTAXAMT(SUB) TO CD-CT-INSTAXAMT  (SUB)
              END-IF
           END-PERFORM.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    CY - CITY INSURANCE TAX RATES FOR KENTUCKY
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-CY.

           IF ( OCD-CY-TYPE NOT = "CY" )
              GO TO UPGRADE-FILE-CD-EA.

           MOVE OCD-CY-TYPE                TO CD-TYPE.
           MOVE OCD-CY-STATE               TO CD-CY-STATE.
           MOVE OCD-CY-CITY                TO CD-CY-CITY.
           MOVE SPACES                     TO CD-CY-FILLER.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-CY-CITY-DESC           TO CD-DESC.
           MOVE OCD-CY-BOTH-TAX-FG         TO CD-CY-BOTH-TAX-FG.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 12
              MOVE OCD-CY-INSTAXFRMLA(SUB) TO CD-CY-INSTAXFRMLA(SUB)
              IF ( OCD-CY-INSTAXAMT(SUB) NOT NUMERIC ) OR
                 ( SUB = 11 OR 12                    )
                 MOVE 0                    TO CD-CY-INSTAXAMT(SUB)
              ELSE
              MOVE OCD-CY-INSTAXAMT  (SUB) TO CD-CY-INSTAXAMT  (SUB)
              END-IF
           END-PERFORM.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    EA - EXTRACTION/ACTION GROUP ID
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-EA.

           IF ( OCD-EA-TYPE NOT = "EA" )
              GO TO UPGRADE-FILE-CD-EL.

           MOVE OCD-EA-TYPE                TO CD-TYPE.
           MOVE OCD-EA-ID                  TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-EA-DESC                TO CD-DESC.

           MOVE OCD-EA-CQ-FG               TO CD-EA-CQ-FG.
           MOVE OCD-EA-GQ-FG               TO CD-EA-GQ-FG.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    EL - EXTENDED LATE CHARGE INFO
      *    
      *    TYPE "EL" HAD NO DESCRIPTION (CD-DESC) IN A15; USE SPACES.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-EL.

           IF ( OCD-EL-TYPE NOT = "EL" )
              GO TO UPGRADE-FILE-CD-FC.

           MOVE OCD-EL-TYPE                TO CD-TYPE.
           IF OCD-EL-CODE NOT NUMERIC
              MOVE 0                       TO CD-EL-CODE
           ELSE
           MOVE OCD-EL-CODE                TO CD-EL-CODE.
           MOVE SPACES                     TO CD-EL-FILLER.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE SPACES                     TO CD-DESC.

           IF OCD-ELGRACE NOT NUMERIC
              MOVE 0                       TO CD-ELGRACE
           ELSE
           MOVE OCD-ELGRACE                TO CD-ELGRACE.
           MOVE OCD-ELGRACECD              TO CD-ELGRACECD.
           MOVE OCD-ELTYPE                 TO CD-ELTYPE.
           IF OCD-ELRATE NOT NUMERIC
              MOVE 0                       TO CD-ELRATE
           ELSE
           MOVE OCD-ELRATE                 TO CD-ELRATE.
           MOVE OCD-ELFRMLA                TO CD-ELFRMLA.
           IF OCD-ELMINCHG NOT NUMERIC
              MOVE 0                       TO CD-ELMINCHG
           ELSE
           MOVE OCD-ELMINCHG               TO CD-ELMINCHG.
           IF OCD-ELMAXAMT NOT NUMERIC
              MOVE 0                       TO CD-ELMAXAMT
           ELSE
           MOVE OCD-ELMAXAMT               TO CD-ELMAXAMT.
           IF OCD-ELDELFAC NOT NUMERIC
              MOVE 0                       TO CD-ELDELFAC
           ELSE
           MOVE OCD-ELDELFAC               TO CD-ELDELFAC.
           IF OCD-ELYRTYPE NOT NUMERIC
              MOVE 0                       TO CD-ELYRTYPE
           ELSE
           MOVE OCD-ELYRTYPE               TO CD-ELYRTYPE.
           MOVE OCD-ELUNITPER-CD           TO CD-ELUNITPER-CD.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    FC - FORM CHARGES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-FC.

           IF ( OCD-FCTYPE NOT = "FC" )
              GO TO UPGRADE-FILE-CD-FU.

           MOVE OCD-FCTYPE                 TO CD-TYPE.
           MOVE OCD-FCFORM-CHG-CD          TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-FCDESC                 TO CD-DESC.
           IF OCD-FCFEEAMT NOT NUMERIC
              MOVE 0                       TO CD-FC-FEEAMT
           ELSE
           MOVE OCD-FCFEEAMT               TO CD-FC-FEEAMT.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    FU - FOLLOW-UP REASON CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-FU.

           IF ( OCD-FU-TYPE NOT = "FU" )
              GO TO UPGRADE-FILE-CD-FZ.

           MOVE OCD-FU-TYPE                TO CD-TYPE.
           MOVE OCD-FU-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    FZ - FROZEN REASON CODE
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-FZ.

           IF ( OCD-FZ-TYPE NOT = "FZ" )
              GO TO UPGRADE-FILE-CD-GC.

           MOVE OCD-FZ-TYPE                TO CD-TYPE.
           MOVE OCD-FZ-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-FZ-DESC                TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    GC - FEE CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-GC.

           IF ( OCD-FEETYPE NOT = "GC" )
              GO TO UPGRADE-FILE-CD-ID.

           MOVE OCD-FEETYPE              TO CDB-TYPE.
           MOVE OCD-FEEBR                TO CDB-BRANCH.
           MOVE OCD-FEECD                TO CDB-CODE.
           MOVE 0                        TO CDB-LTOUCH-DATE.
           MOVE OCD-GLFEE-DESC           TO CDB-DESC.

           IF OCD-GLFEENO NOT NUMERIC
              MOVE 0                     TO CDB-GC-GLFEENO
           ELSE
           MOVE OCD-GLFEENO              TO CDB-GC-GLFEENO.
           MOVE OCD-GLFEEFINCHG          TO CDB-GC-GLFEEFINCHG.
           MOVE OCD-GLFEE-INT-CHARGABLE  TO CDB-GC-GLFEE-INT-CHARGABLE.
           MOVE OCD-FEE-GIFTNET          TO CDB-GC-FEE-GIFTNET.
           IF OCD-FEE-PRODNO NOT NUMERIC
              MOVE 0                     TO CDB-GC-FEE-PRODNO
           ELSE
              MOVE OCD-FEE-PRODNO        TO CDB-GC-FEE-PRODNO.
           IF OCD-FEE-PRICE NOT NUMERIC
              MOVE 0                     TO CDB-GC-FEE-PRICE
           ELSE
              MOVE OCD-FEE-PRICE         TO CDB-GC-FEE-PRICE.
           IF OCD-NEW-PRODNO NOT NUMERIC
              MOVE 0                     TO CDB-GC-NEW-PRODNO
           ELSE
              MOVE OCD-NEW-PRODNO        TO CDB-GC-NEW-PRODNO.
           IF OCD-FEE-MAXAMT NOT NUMERIC
              MOVE 0                     TO CDB-GC-FEE-MAXAMT
           ELSE
           MOVE OCD-FEE-MAXAMT           TO CDB-GC-FEE-MAXAMT.
           IF OCD-ALT-GLFEENO NOT NUMERIC
              MOVE 0                     TO CDB-GC-ALT-GLFEENO
           ELSE
           MOVE OCD-ALT-GLFEENO          TO CDB-GC-ALT-GLFEENO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  THE OCD-COMM FIELDS ARE COMP-6 AND A NUMERIC CHECK DOES NOT
      *  WORK; NEED TO CHECK FOR SPACES
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

           IF ( OCD-COMM-GLFEENO = 20202020202 OR 02020202020)
              MOVE 0                     TO CDB-GC-COMM-GLFEENO
           ELSE
              MOVE OCD-COMM-GLFEENO      TO CDB-GC-COMM-GLFEENO.

           IF ( OCD-COMM-PERCENT = 20.20 OR 02.02)
              MOVE 0                     TO CDB-GC-COMM-PERCENT
           ELSE
              MOVE OCD-COMM-PERCENT      TO CDB-GC-COMM-PERCENT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OCD-FEE-EARNINGS-FG      TO CDB-GC-FEE-EARNINGS-FG.
           IF OCD-BRANCH-COMM-AMOUNT NOT NUMERIC
              MOVE 0                  TO CDB-GC-BRANCH-COMM-AMOUNT
           ELSE
              MOVE OCD-BRANCH-COMM-AMOUNT TO
                                         CDB-GC-BRANCH-COMM-AMOUNT.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    ID - ID TYPE (KNOW YOUR CUSTOMER SCREENS)
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-ID.

           IF ( OCD-ID-TYPE NOT = "ID" )
              GO TO UPGRADE-FILE-CD-JT.

           MOVE OCD-ID-TYPE                TO CD-TYPE.
           MOVE OCD-ID-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-ID-DESC                TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    JT - JOB TYPE DESCRIPTIONS
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-JT.

           IF ( OCD-JT-TYPE NOT = "JT" )
              GO TO UPGRADE-FILE-CD-LO.

           MOVE OCD-JT-TYPE                TO CD-TYPE.
           MOVE OCD-JT-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-JT-DESC                TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    LO - LPO (TFC) LOAN PROCESSING OFFICES
      *
      *    TYPE "LO" USES THE LAYOUT FROM THE OLD CD-BW-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-LO.

           IF ( OCD-BW-TYPE NOT = "LO" )
              GO TO UPGRADE-FILE-CD-LS.

           MOVE OCD-BW-TYPE                TO CD-TYPE.
           MOVE OCD-BW-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    LS - REPO REASON CODE
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-LS.

           IF ( OCD-LR-TYPE NOT = "LS" )
              GO TO UPGRADE-FILE-CD-LV.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    LV - GROUP LEVELS
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-LV.

           IF ( OCD-LVTYPE NOT = "LV" )
              GO TO UPGRADE-FILE-CD-ML.

           MOVE OCD-LVTYPE                 TO CD-TYPE.
           MOVE OCD-LVLEVEL                TO CD-LV-LEVEL.
           MOVE SPACES                     TO CD-LV-FILLER.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    ML - MAIL LIST SOURCE CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-ML.

           IF ( OCD-TYPE NOT = "ML" )
              GO TO UPGRADE-FILE-CD-OR.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    OR - ORIGIN
      *
      *    TYPE "OR" USES THE LAYOUT FROM THE OLD CD-BW-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-OR.

           IF ( OCD-BW-TYPE NOT = "OR" )
              GO TO UPGRADE-FILE-CD-PA.

           MOVE OCD-BW-TYPE                TO CD-TYPE.
           MOVE OCD-BW-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PA - PAYROLL CODES FOR TIMESHEET PROCESSING
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PA.

           IF ( OCD-PA-TYPE NOT = "PA" )
              GO TO UPGRADE-FILE-CD-PC.

           MOVE OCD-PA-TYPE                TO CD-TYPE.
           MOVE OCD-PA-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PC - PROCESSING CODE (TFC)
      *
      *    TYPE "PC" USES THE LAYOUT FROM THE OLD CD-PX-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PC.

           IF ( OCD-TYPE NOT = "PC" )
              GO TO UPGRADE-FILE-CD-PH.

           MOVE OCD-PXTYPE                 TO CD-TYPE.
           MOVE OCD-PXPLTYPE               TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PH - PHONE NUMBER DESCRIPTIONS
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PH.

           IF ( OCD-TYPE NOT = "PH" )
              GO TO UPGRADE-FILE-CD-PL.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PL - POOL ID CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PL.

           IF ( OCD-POOLTYPE NOT = "PL" )
              GO TO UPGRADE-FILE-CD-PO.

           MOVE OCD-POOLTYPE               TO CD-TYPE.
           MOVE OCD-POOLID                 TO CD-PL-POOLID.
           MOVE SPACES                     TO CD-PL-FILLER.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-POOLDESC               TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PO - PAYOFF CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PO.

           IF ( OCD-PO-TYPE NOT = "PO" )
              GO TO UPGRADE-FILE-CD-PS.

           MOVE OCD-PO-TYPE            TO CD-TYPE.
           MOVE OCD-PO-POCD            TO CD-CODE.
           MOVE 0                      TO CD-LTOUCH-DATE.
           MOVE OCD-DESC               TO CD-DESC.

           IF OCD-TITLE-HOLD-DAYS NOT NUMERIC
              MOVE 0                   TO CD-PO-TITLE-HOLD-DAYS
           ELSE
              MOVE OCD-TITLE-HOLD-DAYS TO CD-PO-TITLE-HOLD-DAYS.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PS - PAYMENT RESCHEDULE REASON CODE
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PS.

           IF ( OCD-PS-TYPE NOT = "PS" )
              GO TO UPGRADE-FILE-CD-PU.

           MOVE OCD-PS-TYPE                TO CD-TYPE.
           MOVE OCD-PS-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-PS-DESC                TO CD-DESC.

           MOVE OCD-PS-TDR-FLAG            TO CD-PS-TDR-FLAG.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PU - PURPOSE CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PU.

           IF ( OCD-TYPE NOT = "PU" )
              GO TO UPGRADE-FILE-CD-PX.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    PX - P&L CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-PX.

           IF ( OCD-PXTYPE NOT = "PX" )
              GO TO UPGRADE-FILE-CD-RC.

           MOVE OCD-PXTYPE                 TO CD-TYPE.
           MOVE OCD-PXPLTYPE               TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    RC - REP CODE (TFC)
      *
      *    TYPE "RC" IN THE OLD FORMAT (OCD-RC-REC) USED HASH TO
      *    STORE KEY (OCD-RC-CODE) AND STORES THE ALPHA VERSION
      *    IN OCD-RC-CODE-ALPHA FOR DISPLAY
      *
      *    THE NEW FORMAT REMOVED THE HASH IN THE KEY (CD-RC-CODE) AND
      *    REMOVED THE ALPHA VERSION WHICH NOW CAN USE CD-RC-CODE NOW.
      *
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-RC.

           IF ( OCD-RC-TYPE NOT = "RC" )
              GO TO UPGRADE-FILE-CD-RE.

           MOVE OCD-RC-TYPE                TO CD-TYPE.
           MOVE OCD-RC-CODE-ALPHA          TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-RC-DESC                TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    RE - COLLECTION RESULT CODE
      *
      *    TYPE "RE" USES THE KEY FROM THE OLD BASE FORMAT.
      *    TYPE "RE" USES THE DESC FROM THE OLD BASE FORMAT.
      *    TYPE "RE" USES SOME FIELDS FROM THE OLD CD-AC-RE-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-RE.

           IF ( OCD-TYPE NOT = "RE" )
              GO TO UPGRADE-FILE-CD-SR.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           MOVE OCD-ACTIONCD               TO CD-RE-ACTIONCD.
           MOVE OCD-MEMO-REQUIRED          TO CD-RE-MEMO-REQUIRED.
           MOVE OCD-SUPERVISOR-ONLY        TO CD-RE-SUPERVISOR-ONLY.

           MOVE OCD-RE-ACTIVITY-REQUIRED   TO CD-RE-ACTIVITY-REQUIRED.
           MOVE OCD-RE-RESCHEDULE-REQ      TO CD-RE-RESCHEDULE-REQ.
           IF OCD-RE-RESCHEDULE-TIME NOT NUMERIC
              MOVE 0                       TO CD-RE-RESCHEDULE-TIME
           ELSE
              MOVE OCD-RE-RESCHEDULE-TIME  TO CD-RE-RESCHEDULE-TIME.
           MOVE OCD-RE-WORKED-ACCOUNT      TO CD-RE-WORKED-ACCOUNT.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    SR - SOURCE CODES
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-SR.

           IF ( OCD-TYPE NOT = "SR" )
              GO TO UPGRADE-FILE-CD-TC.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    TC - TRANSACTION REFERENCE CODESS
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-TC.

           IF ( OCD-TC-TYPE NOT = "TC" )
              GO TO UPGRADE-FILE-CD-TS.

           MOVE OCD-TC-TYPE                TO CD-TYPE.
           MOVE OCD-TC-TRCD                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-TC-DESC                TO CD-DESC.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
                 MOVE OCD-TC-REFNO(SUB)  TO CD-TC-REFNO(SUB)
           END-PERFORM.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    TS - TRW SPECIAL CODES
      *
      *    TYPE "TS" USES THE LAYOUT FROM THE OLD CD-PO-REC FORMAT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-TS.

           IF ( OCD-PO-TYPE NOT = "TS" )
              GO TO UPGRADE-FILE-CD-UW.

           MOVE OCD-PO-TYPE                TO CD-TYPE.
           MOVE OCD-PO-POCD                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    UW - UNWIND CODE (REGACC)
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-UW.

           IF ( OCD-UW-TYPE NOT = "UW" )
              GO TO UPGRADE-FILE-CD-XL.

           MOVE OCD-UW-TYPE                TO CD-TYPE.
           MOVE OCD-UW-CODE                TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-UW-DESC                TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    XL - COLLATERA LOCATION (REPO) CHREP4
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-XL.

           IF ( OCD-TYPE NOT = "XL" )
              GO TO UPGRADE-FILE-CD-UNKNOWN.

           MOVE OCD-TYPE                   TO CD-TYPE.
           MOVE OCD-CODE                   TO CD-CODE.
           MOVE 0                          TO CD-LTOUCH-DATE.
           MOVE OCD-DESC                   TO CD-DESC.

           GO TO UPGRADE-FILE-CD-EXIT.

      *-----------------------------------------------------------------
      *    ?? - UNKNOWN CODE - SHOULD NOT REACH HERE.  PUT THIS HERE
      *         JUST IN CASE AND USING THE BASE FORMAT LAYOUT.
      *-----------------------------------------------------------------
       UPGRADE-FILE-CD-UNKNOWN.

           ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
           MOVE OCD1-KEY                TO UP1534-UPDATE-KEY
           MOVE "*N/A*"                 TO UP1534-UPDATE-STAT
           MOVE "E"                     TO UP1534-UPDATE-TYPE
           PERFORM UP1534-CREATE-FILE-UPDATE.

       UPGRADE-FILE-CD-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - C L
      *
      ******************************************************************
       UPGRADE-FILE-CL SECTION.

           PERFORM CLEAR-CL-FILE.

           MOVE OCL-GROUP-LOC              TO CL-GROUP-LOC.
           MOVE OCL-CAN-NO                 TO CL-CAN-NO.

           MOVE ZEROES                     TO CL-LTOUCH-DATE.
           MOVE OCL-DESC                   TO CL-DESC.
           MOVE OCL-GIFTNET                TO CL-GIFTNET.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    OCL-PD-REC CONTAINS A FULL COPY OF THE OPD-REC,
      *    MUST MOVE IT OUT AND CONVERT IT TO NEW PD-REC
      *    THEN MOVE IT BACK TO NEW CL-PD-REC.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OCL-PD-REC                 TO OPD-REC.
           PERFORM UPGRADE-FILE-PD.
           MOVE PD-REC                     TO CL-PD-REC.

       UPGRADE-FILE-CL-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - E A
      *
      ******************************************************************
       UPGRADE-FILE-EA SECTION.

           PERFORM CLEAR-EA-FILE.

           IF OEA-BRANCH NOT NUMERIC
              MOVE 0               TO EA-BRANCH
           ELSE
           MOVE OEA-BRANCH         TO EA-BRANCH.
           IF OEA-CLASS NOT NUMERIC
              MOVE 0               TO EA-CLASS
           ELSE
           MOVE OEA-CLASS          TO EA-CLASS.
           MOVE OEA-GROUP-ID       TO EA-GROUP-ID.
           IF OEA-SEQNO NOT NUMERIC
              MOVE 0               TO EA-SEQNO
           ELSE
           MOVE OEA-SEQNO          TO EA-SEQNO.

           MOVE OEA-DESC           TO EA-DESC.
           IF OEA-PASTDUE-DAY1 NOT NUMERIC
              MOVE 0               TO EA-PASTDUE-DAY1
           ELSE
           MOVE OEA-PASTDUE-DAY1   TO EA-PASTDUE-DAY1.
           IF OEA-PASTDUE-DAY2 NOT NUMERIC
              MOVE 0               TO EA-PASTDUE-DAY2
           ELSE
           MOVE OEA-PASTDUE-DAY2   TO EA-PASTDUE-DAY2.
           IF OEA-PASTDUE-AMT1 NOT NUMERIC
              MOVE 0               TO EA-PASTDUE-AMT1
           ELSE
           MOVE OEA-PASTDUE-AMT1   TO EA-PASTDUE-AMT1.
           IF OEA-PASTDUE-AMT2 NOT NUMERIC
              MOVE 0               TO EA-PASTDUE-AMT2
           ELSE
           MOVE OEA-PASTDUE-AMT2   TO EA-PASTDUE-AMT2.
           IF OEA-ACCT-BAL1 NOT NUMERIC
              MOVE 0               TO EA-ACCT-BAL1
           ELSE
           MOVE OEA-ACCT-BAL1      TO EA-ACCT-BAL1.
           IF OEA-ACCT-BAL2 NOT NUMERIC
              MOVE 0               TO EA-ACCT-BAL2
           ELSE
           MOVE OEA-ACCT-BAL2      TO EA-ACCT-BAL2.
           MOVE OEA-MATURED        TO EA-MATURED.
           MOVE OEA-PROMISED       TO EA-PROMISED.
           MOVE OEA-ACTION         TO EA-ACTION.

           MOVE OEA-LSTFM-DATE1    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO EA-LSTFM-DATE1.

           MOVE OEA-LSTFM-DATE2    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO EA-LSTFM-DATE2.

           IF OEA-LSTFM-NO1 NOT NUMERIC
              MOVE 0               TO EA-LSTFM-NO1
           ELSE
           MOVE OEA-LSTFM-NO1      TO EA-LSTFM-NO1.
           IF OEA-LSTFM-NO2 NOT NUMERIC
              MOVE 0               TO EA-LSTFM-NO2
           ELSE
           MOVE OEA-LSTFM-NO2      TO EA-LSTFM-NO2.
           IF OEA-PASTPROM-DAY1 NOT NUMERIC
              MOVE 0               TO EA-PASTPROM-DAY1
           ELSE
           MOVE OEA-PASTPROM-DAY1  TO EA-PASTPROM-DAY1.
           IF OEA-PASTPROM-DAY2 NOT NUMERIC
              MOVE 0               TO EA-PASTPROM-DAY2
           ELSE
           MOVE OEA-PASTPROM-DAY2  TO EA-PASTPROM-DAY2.
           IF OEA-RECENCY-DAY1 NOT NUMERIC
              MOVE 0               TO EA-RECENCY-DAY1
           ELSE
           MOVE OEA-RECENCY-DAY1   TO EA-RECENCY-DAY1.
           IF OEA-RECENCY-DAY2 NOT NUMERIC
              MOVE 0               TO EA-RECENCY-DAY2
           ELSE
           MOVE OEA-RECENCY-DAY2   TO EA-RECENCY-DAY2.

      * ALPNAME1 AND 2 WENT FROM X(3) TO X(4).
           IF OEA-ALPNAME1 = SPACES
              MOVE SPACES             TO EA-ALPNAME1
           ELSE
              MOVE OEA-ALPNAME1       TO HOLD-A15-ALPNAME
              PERFORM CONVERT-A15-A30-ALPNAME
              MOVE HOLD-A30-ALPNAME   TO EA-ALPNAME1.

           IF OEA-ALPNAME2 = SPACES
              MOVE SPACES             TO EA-ALPNAME2
           ELSE
              MOVE OEA-ALPNAME2       TO HOLD-A15-ALPNAME
              PERFORM CONVERT-A15-A30-ALPNAME
              MOVE HOLD-A30-ALPNAME   TO EA-ALPNAME2.

           MOVE OEA-RECENCYDATE       TO EA-RECENCYDATE.
           IF OEA-DLNO1 NOT NUMERIC
              MOVE 0                  TO EA-DLNO1
           ELSE
           MOVE OEA-DLNO1             TO EA-DLNO1.
           IF OEA-DLNO2 NOT NUMERIC
              MOVE 0                  TO EA-DLNO2
           ELSE
           MOVE OEA-DLNO2             TO EA-DLNO2.
           IF OEA-CONTRACTUAL-DAY1 NOT NUMERIC
              MOVE 0                  TO EA-CONTRACTUAL-DAY1
           ELSE
           MOVE OEA-CONTRACTUAL-DAY1  TO EA-CONTRACTUAL-DAY1.
           IF OEA-CONTRACTUAL-DAY2 NOT NUMERIC
              MOVE 0                  TO EA-CONTRACTUAL-DAY2
           ELSE
           MOVE OEA-CONTRACTUAL-DAY2  TO EA-CONTRACTUAL-DAY2.

           IF OEA-SETFM-NO NOT NUMERIC
              MOVE 0                TO EA-SETFM-NO
           ELSE
           MOVE OEA-SETFM-NO        TO EA-SETFM-NO.
           MOVE OEA-SETACT-CD       TO EA-SETACT-CD.
           MOVE OEA-INC-CNT         TO EA-INC-CNT.
           IF OEA-INC-PROMISED NOT NUMERIC
              MOVE 0                TO EA-INC-PROMISED
           ELSE
           MOVE OEA-INC-PROMISED    TO EA-INC-PROMISED.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              IF OEA-SETFM(SUB) NOT NUMERIC
                 MOVE 0               TO EA-SETFM(SUB)
              ELSE
              MOVE OEA-SETFM(SUB)     TO EA-SETFM(SUB)
              END-IF
           END-PERFORM.

           MOVE OEA-SET-LN-COL      TO EA-SET-LN-COL.
           MOVE OEA-LN-COL-ID       TO EA-LN-COL-ID.
           MOVE OEA-CQ-FG           TO EA-CQ-FG.
           MOVE OEA-COL-POOL        TO EA-COL-POOL.
           MOVE OEA-CPOTS           TO EA-CPOTS.
           MOVE OEA-REPO            TO EA-REPO.
           MOVE OEA-PL              TO EA-PL.
           MOVE OEA-BANKRUPT        TO EA-BANKRUPT.
           MOVE OEA-PL-IN-ACTIVE-BOTH  TO EA-PL-IN-ACTIVE-BOTH.
           MOVE OEA-CONFIDENTIAL-FG    TO EA-CONFIDENTIAL-FG.
           MOVE OEA-1ST-PMT-MISSES     TO EA-1ST-PMT-MISSES.
           MOVE OEA-LEGAL              TO EA-LEGAL.
           MOVE OEA-DEBTAID            TO EA-DEBTAID.
           MOVE OEA-JUDGEMENT          TO EA-JUDGEMENT.
           MOVE OEA-BROKEN-PROM-FG     TO EA-BROKEN-PROM-FG.

      * CLEANSE
      *     EA-PROM-BREAK1         PIC S9(5)      COMP-3.
      *     EA-PROM-BREAK2         PIC S9(5)      COMP-3.
           IF OEA-PROM-BREAK1 NOT NUMERIC OR
                (OEA-PROM-BREAK1 = 20202 OR 02020)
              MOVE 0               TO EA-PROM-BREAK1 
           ELSE
              MOVE OEA-PROM-BREAK1 TO EA-PROM-BREAK1.
           IF OEA-PROM-BREAK2 NOT NUMERIC OR
                (OEA-PROM-BREAK2 = 20202 OR 02020)
              MOVE 0               TO EA-PROM-BREAK2
           ELSE
              MOVE OEA-PROM-BREAK2 TO EA-PROM-BREAK2.

           MOVE OEA-ORIGIN                 TO EA-ORIGIN.

      * CLEANSE 
      *     EA-PL-BEG-DATE         PIC 9(06)      COMP-3.
      *     EA-PL-END-DATE         PIC 9(06)      COMP-3.
           IF OEA-PL-BEG-DATE = 202020 OR 020202 OR
                   (OEA-PL-BEG-DATE NOT NUMERIC)
              MOVE 0                TO EA-PL-BEG-DATE
           ELSE
              MOVE OEA-PL-BEG-DATE  TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO EA-PL-BEG-DATE.

           IF OEA-PL-END-DATE = 202020 OR 020202 OR 
                  (OEA-PL-END-DATE NOT NUMERIC)
              MOVE 0                       TO EA-PL-END-DATE
           ELSE
              MOVE OEA-PL-END-DATE         TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD TO EA-PL-END-DATE.

           MOVE OEA-RPOTS           TO EA-RPOTS.
           MOVE OEA-MISPAYS         TO EA-MISPAYS.
           MOVE OEA-ALLOTMENTS      TO EA-ALLOTMENTS.
      * CLEANSE 
      *    EA-LNDATE-DAYS1        PIC 9(4)       COMP-6.
      *    EA-LNDATE-DAYS2        PIC 9(4)       COMP-6.

           IF OEA-LNDATE-DAYS1 = 2020 OR 0202
             MOVE 0                TO EA-LNDATE-DAYS1
           ELSE
             MOVE OEA-LNDATE-DAYS1 TO EA-LNDATE-DAYS1.

           IF OEA-LNDATE-DAYS2 = 2020 OR 0202
             MOVE 9999             TO EA-LNDATE-DAYS2
           ELSE
             MOVE OEA-LNDATE-DAYS2 TO EA-LNDATE-DAYS2.

      * CLEANSE 
      *    EA-MATURE-DAYS1        PIC 9(4)       COMP-6.
      *    EA-MATURE-DAYS2        PIC 9(4)       COMP-6.
           IF OEA-MATURE-DAYS1 = 2020 OR 0202
              MOVE 0                TO EA-MATURE-DAYS1
           ELSE
              MOVE OEA-MATURE-DAYS1 TO EA-MATURE-DAYS1.

           IF OEA-MATURE-DAYS2 = 2020 OR 0202
              MOVE 9999             TO EA-MATURE-DAYS2
           ELSE
              MOVE OEA-MATURE-DAYS2 TO EA-MATURE-DAYS2.

      * CLEANSE OEA-DAY-OF-MO-DUE1
      *         OEA-DAY-OF-MO-DUE2
           IF OEA-DAY-OF-MO-DUE1 = 20 OR 02
              MOVE 1 TO EA-DAY-OF-MO-DUE1
           ELSE
              MOVE OEA-DAY-OF-MO-DUE1   TO EA-DAY-OF-MO-DUE1.

           IF OEA-DAY-OF-MO-DUE2 = 20 OR 02
              MOVE 31 TO EA-DAY-OF-MO-DUE2
           ELSE
              MOVE OEA-DAY-OF-MO-DUE2   TO EA-DAY-OF-MO-DUE2.

           MOVE OEA-INCL-COLLECTOR   TO EA-INCL-COLLECTOR.
           MOVE OEA-BORR-STATE       TO EA-BORR-STATE.

       UPGRADE-FILE-EA-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - E P
      *
      ******************************************************************
      * UPGRADE-FILE-EP SECTION.

      *     PERFORM CLEAR-EP-FILE.

      *     MOVE OEP-BRNO                   TO EP-BRNO.
      *     MOVE OEP-ACCTNO                 TO OLD-ACCTNO.
      *     MOVE NEW-ACCTNO                 TO EP-ACCTNO.

      *     MOVE 0                          TO EP-LTOUCH-DATE.
      *     MOVE OEP-SSNO                   TO EP-SSNO.
      *     MOVE OEP-NAME-ON-ACCOUNT        TO EP-NAME-ON-ACCOUNT.
      *     MOVE OEP-BANK-ACCTNO            TO EP-BANK-ACCTNO.
      *     MOVE OEP-BANK-ROUTING-NO        TO EP-BANK-ROUTING-NO.
      *     MOVE OEP-ACCT-TYPE              TO EP-ACCT-TYPE.
      *     MOVE OEP-PAYMENT-AMT            TO EP-PAYMENT-AMT.
      *     MOVE OEP-UNITPER-CD             TO EP-UNITPER-CD.
      *     MOVE OEP-PAY-DAY                TO EP-PAY-DAY.

      *     MOVE OEP-BEG-PAY-DATE           TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-BEG-PAY-DATE.

      *     MOVE OEP-END-PAY-DATE           TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-END-PAY-DATE.

      *     MOVE OEP-STOP-FG                TO EP-STOP-FG.
      *     MOVE OEP-PRENOTE-FG             TO EP-PRENOTE-FG.

      *     MOVE OEP-LAST-COMPUTED-DATE     TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-LAST-COMPUTED-DATE.

      *     MOVE OEP-REFCD                  TO EP-REFCD.

      *     MOVE OEP-ALTERNATE-DATE         TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-ALTERNATE-DATE.

      *     MOVE OEP-ALTERNATE-AMT          TO EP-ALTERNATE-AMT.

      *     MOVE OEP-LAST-BATCH-DATE        TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-LAST-BATCH-DATE.

      *     MOVE OEP-LAST-BATCH-AMT         TO EP-LAST-BATCH-AMT.
      *     MOVE OEP-LAST-BATCH-USERID      TO EP-LAST-BATCH-USERID.

      *     MOVE OEP-LAST-NACHA-DATE        TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EP-LAST-NACHA-DATE.

      *     MOVE OEP-LAST-NACHA-AMT         TO EP-LAST-NACHA-AMT.
      *     MOVE OEP-LAST-NACHA-USERID      TO EP-LAST-NACHA-USERID.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
      *         MOVE 0 TO EP-FUTURE-NUMERIC(SUB)
      *                   EP-FUTURE-AMOUNT(SUB)
      *                   EP-FUTURE-DATE(SUB)
      *     END-PERFORM.

      * UPGRADE-FILE-EP-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - E W
      *
      *=================================================================
      *    ****NOTE**** OEW-TRANS-DATE IS STORED IN
      *                 YYMMDD FORMAT.  NEED TO FIRST CONVERT BACK TO
      *                 MMDDYY FORMAT THEN USE
      *                 CONVERT-MMDDYY-TO-YYYYMMDD TO MAKE
      *                 EW-TRANS-DATE IS ACTIVE CCYYMMDD IN A30.
      *
      ******************************************************************
      * UPGRADE-FILE-EW SECTION.

      *     PERFORM CLEAR-EW-FILE.

      *     MOVE OEW-BRNO                   TO EW-BRNO.

      *     MOVE OEW-TRANS-DATE             TO DATE-YYMMDD.
      *     PERFORM CONVERT-YYMMDD-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EW-TRANS-DATE.

      *     MOVE OEW-ACCTNO                 TO OLD-ACCTNO.
      *     MOVE NEW-ACCTNO                 TO EW-ACCTNO.
      *     MOVE OEW-SEQ                    TO EW-SEQ.

      *     MOVE 0                          TO EW-LTOUCH-DATE.
      *     MOVE OEW-NAME                   TO EW-NAME.
      *     MOVE OEW-BANK-ACCTNO            TO EW-BANK-ACCTNO.
      *     MOVE OEW-BANK-ROUTING-NO        TO EW-BANK-ROUTING-NO.
      *     MOVE OEW-ACCT-TYPE              TO EW-ACCT-TYPE.
      *     MOVE OEW-PAYMENT-AMT            TO EW-PAYMENT-AMT.
      *     MOVE OEW-PROGRAM                TO EW-PROGRAM.
      *     MOVE OEW-USERID                 TO EW-USERID.

      *     MOVE OEW-POST-DATE              TO DATE-MMDDYY.
      *     PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *     MOVE DATE-YYYYMMDD              TO EW-POST-DATE.

      *     MOVE OEW-POST-TIME              TO EW-POST-TIME.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
      *         MOVE 0      TO EW-FUTURE-AMOUNT(SUB)
      *         IF SUB NOT > 2
      *            MOVE 0   TO EW-FUTURE-NUMERIC(SUB)
      *                        EW-FUTURE-DATE(SUB)
      *         END-IF
      *     END-PERFORM.

      * UPGRADE-FILE-EW-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - F D
      *
      ******************************************************************
      * UPGRADE-FILE-FD SECTION.

      *     PERFORM CLEAR-FD-FILE.

      *     MOVE OFD-FMNO                   TO FD-FMNO.

      *     MOVE 0                          TO FD-LTOUCH-DATE.
      *     MOVE OFD-DESC                   TO FD-DESC.
      *     MOVE OFD-OPTION                 TO FD-OPTION.
      *     MOVE OFD-FORM-CHG-CD            TO FD-FORM-CHG-CD.
      *     MOVE OFD-PROG-PREFIX            TO FD-PROG-PREFIX.
      *     MOVE OFD-TYPE                   TO FD-TYPE.
      *     MOVE OFD-LNMEMO                 TO FD-LNMEMO.

      *     MOVE OFD-BODY                   TO FD-BODY.
      *     MOVE OFD-TOP                    TO FD-TOP.
      *     MOVE OFD-BOTTOM                 TO FD-BOTTOM.
      *     MOVE OFD-PROG                   TO FD-PROG.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 30
      *        MOVE OFD-PROMPTS(SUB)        TO FD-PROMPTS(SUB)
      *     END-PERFORM.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 50
      *        MOVE OFD-FIELDNO (SUB)       TO FD-FIELDNO (SUB)
      *        MOVE OFD-FIELDROW(SUB)       TO FD-FIELDROW(SUB)
      *        MOVE OFD-FIELDCOL(SUB)       TO FD-FIELDCOL(SUB)
      *        MOVE OFD-FIELDED (SUB)       TO FD-FIELDED (SUB)
      *        MOVE OFD-FIELDKEY(SUB)       TO FD-FIELDKEY(SUB)
      *     END-PERFORM.

      *     MOVE OFD-1STFILE                TO FD-1STFILE.
      *     MOVE OFD-INCR-DELCNT            TO FD-INCR-DELCNT.
      *     MOVE OFD-FMTYPE                 TO FD-FMTYPE.
      *     MOVE OFD-PRCONT                 TO FD-PRCONT.
      *     MOVE OFD-NEXTFM                 TO FD-NEXTFM.
      *     MOVE OFD-VALID-BRANCH           TO FD-VALID-BRANCH.
      *     MOVE OFD-MIN-FORM-SENT-DAYS     TO FD-MIN-FORM-SENT-DAYS.
      *     MOVE OFD-SKIP-BAD-ADR           TO FD-SKIP-BAD-ADR.
      *     MOVE OFD-SECURITY-PROFILE       TO FD-SECURITY-PROFILE.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      **    IF NO FT-REC, SKIP TO EXIT...REMAINING FIELDS ARE
      **    ALPHANUMERIC AND SET TO SPACES AT BEGINNING OF SECTION.
      **- - - - - - - - - - - - - - - - - - - - - - - - -{ MERGE FT-REC }
      *     IF ( OFT-RECORD-STAT-BAD )
      *        GO TO UPGRADE-FILE-FD-EXIT.

      *     MOVE OFT-FORM-RIGHT-TO-CURE     TO FD-FORM-RIGHT-TO-CURE.
      *     MOVE OFT-TEST-WHICH-STATE       TO FD-TEST-WHICH-STATE.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 50
      *             MOVE OFT-STATE(SUB)     TO FD-STATE(SUB)
      *     END-PERFORM.
      *         
      * UPGRADE-FILE-FD-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - F S
      *
      ******************************************************************
      *UPGRADE-FILE-FS SECTION.

      *    MOVE SPACES TO FS-REC.

      *    MOVE OFS-REPORT                 TO FS-REPORT.
      *    MOVE OFS-LINENO                 TO FS-LINENO.

      *    MOVE 0                          TO FS-LTOUCH-DATE.
      *    MOVE OFS-TYPE                   TO FS-TYPE.
      *    IF OFS-LEVEL NOT NUMERIC
      *       MOVE 0                       TO FS-LEVEL
      *    ELSE
      *    MOVE OFS-LEVEL                  TO FS-LEVEL.
      *    IF OFS-CONTROL NOT NUMERIC
      *       MOVE 0                       TO FS-CONTROL
      *    ELSE
      *    MOVE OFS-CONTROL                TO FS-CONTROL.
      *    IF OFS-ACCOUNT NOT NUMERIC
      *       MOVE 0                       TO FS-ACCOUNT
      *    ELSE
      *    MOVE OFS-ACCOUNT                TO FS-ACCOUNT.
      *    MOVE OFS-DESCR                  TO FS-DESCR.
      *    IF OFS-CMONTH NOT NUMERIC
      *       MOVE 0                       TO FS-CMONTH
      *    ELSE
      *    MOVE OFS-CMONTH                 TO FS-CMONTH.
      *    IF OFS-LYMONTH NOT NUMERIC
      *       MOVE 0                       TO FS-LYMONTH
      *    ELSE
      *    MOVE OFS-LYMONTH                TO FS-LYMONTH.
      *    IF OFS-CYTD NOT NUMERIC
      *       MOVE 0                       TO FS-CYTD
      *    ELSE
      *    MOVE OFS-CYTD                   TO FS-CYTD.
      *    IF OFS-LYTD NOT NUMERIC
      *       MOVE 0                       TO FS-LYTD
      *    ELSE
      *    MOVE OFS-LYTD                   TO FS-LYTD.
      *    IF OFS-CMBUD NOT NUMERIC
      *       MOVE 0                       TO FS-CMBUD
      *    ELSE
      *    MOVE OFS-CMBUD                  TO FS-CMBUD.
      *    IF OFS-YTDBUD NOT NUMERIC
      *       MOVE 0                       TO FS-YTDBUD
      *    ELSE
      *    MOVE OFS-YTDBUD                 TO FS-YTDBUD.
      *    IF OFS-ANBUD NOT NUMERIC
      *       MOVE 0                       TO FS-ANBUD
      *    ELSE
      *    MOVE OFS-ANBUD                  TO FS-ANBUD.
      *    IF OFS-REFNO NOT NUMERIC
      *       MOVE 0                       TO FS-REFNO
      *    ELSE
      *    MOVE OFS-REFNO                  TO FS-REFNO.
      *    IF OFS-PERIOD NOT NUMERIC
      *       MOVE 0                       TO FS-PERIOD
      *    ELSE
      *    MOVE OFS-PERIOD                 TO FS-PERIOD.
      *    MOVE OFS-PRNCD                  TO FS-PRNCD.
      *    MOVE OFS-SIGN                   TO FS-SIGN.
      *    MOVE OFS-DRCR                   TO FS-DRCR.
      *    IF OFS-BR NOT NUMERIC
      *       MOVE 0                       TO FS-BR
      *    ELSE
      *       MOVE OFS-BR                  TO FS-BR.
      *    IF OFS-BR2 NOT NUMERIC
      *       MOVE 0                       TO FS-BR2
      *    ELSE
      *       MOVE OFS-BR2                 TO FS-BR2.

      *UPGRADE-FILE-FS-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - G I
      *
      ******************************************************************
       UPGRADE-FILE-GI SECTION.

           PERFORM CLEAR-GI-FILE.

           MOVE OGI-BRANCH     TO GI-BRANCH.
           MOVE OGI-CLASS      TO GI-CLASS.

           MOVE 0              TO GI-LTOUCH-DATE.

           IF OGI-CASH NOT NUMERIC
              MOVE 0                TO GI-CASH
           ELSE
           MOVE OGI-CASH            TO GI-CASH.
           IF OGI-BANK NOT NUMERIC
              MOVE 0                TO GI-BANK
           ELSE
           MOVE OGI-BANK            TO GI-BANK.
           IF OGI-NSF NOT NUMERIC
              MOVE 0                TO GI-NSF
           ELSE
           MOVE OGI-NSF             TO GI-NSF.
           IF OGI-AR NOT NUMERIC
              MOVE 0                TO GI-AR
           ELSE
           MOVE OGI-AR              TO GI-AR.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OGI-PL(SUB) NOT NUMERIC
                 MOVE 0             TO GI-PL(SUB)
              ELSE
                 MOVE OGI-PL(SUB)   TO GI-PL(SUB)
              END-IF
           END-PERFORM.

           IF OGI-DLINSREB NOT NUMERIC
              MOVE 0                TO GI-DLINSREB
           ELSE
           MOVE OGI-DLINSREB        TO GI-DLINSREB.
           IF OGI-ACR-INT-AR-AR NOT NUMERIC
              MOVE 0                TO GI-ACR-INT-AR-AR
           ELSE
           MOVE OGI-ACR-INT-AR-AR   TO GI-ACR-INT-AR-AR.
           IF OGI-OTHBR-REC NOT NUMERIC
              MOVE 0                TO GI-OTHBR-REC
           ELSE
           MOVE OGI-OTHBR-REC       TO GI-OTHBR-REC.
           IF OGI-OTHBR-PAY NOT NUMERIC
              MOVE 0                TO GI-OTHBR-PAY
           ELSE
           MOVE OGI-OTHBR-PAY       TO GI-OTHBR-PAY.

           IF OGI-UNINTCHG NOT NUMERIC
              MOVE 0                TO GI-UNINTCHG
           ELSE
           MOVE OGI-UNINTCHG        TO GI-UNINTCHG.
           IF OGI-UNADDON NOT NUMERIC
              MOVE 0                TO GI-UNADDON
           ELSE
           MOVE OGI-UNADDON         TO GI-UNADDON.
           IF OGI-UNSERCHG NOT NUMERIC
              MOVE 0                TO GI-UNSERCHG
           ELSE
           MOVE OGI-UNSERCHG        TO GI-UNSERCHG.
           IF OGI-UNMAINTFEE NOT NUMERIC
              MOVE 0                TO GI-UNMAINTFEE
           ELSE
           MOVE OGI-UNMAINTFEE      TO GI-UNMAINTFEE.
           IF OGI-UNDLDISC NOT NUMERIC
              MOVE 0                TO GI-UNDLDISC
           ELSE
           MOVE OGI-UNDLDISC        TO GI-UNDLDISC.
           IF OGI-UNOTHER NOT NUMERIC
              MOVE 0                TO GI-UNOTHER
           ELSE
           MOVE OGI-UNOTHER         TO GI-UNOTHER.
           MOVE 0                   TO GI-UN7 
                                       GI-UN8 
                                       GI-UN9 
                                       GI-UN10.


           IF OGI-UNCL1 NOT NUMERIC
              MOVE 0                TO GI-UNCL1
           ELSE
           MOVE OGI-UNCL1           TO GI-UNCL1.
           IF OGI-UNCL2 NOT NUMERIC
              MOVE 0                TO GI-UNCL2
           ELSE
           MOVE OGI-UNCL2           TO GI-UNCL2.
           IF OGI-UNAH NOT NUMERIC
              MOVE 0                TO GI-UNAH
           ELSE
           MOVE OGI-UNAH            TO GI-UNAH.
           IF OGI-UNPP NOT NUMERIC
              MOVE 0                TO GI-UNPP
           ELSE
           MOVE OGI-UNPP            TO GI-UNPP.

           IF OGI-UNO1 NOT NUMERIC
              MOVE 0                TO GI-UNO1
           ELSE
           MOVE OGI-UNO1            TO GI-UNO1.
           IF OGI-UNO2 NOT NUMERIC
              MOVE 0                TO GI-UNO2
           ELSE
           MOVE OGI-UNO2            TO GI-UNO2.
           IF OGI-UNO3 NOT NUMERIC
              MOVE 0                TO GI-UNO3
           ELSE
           MOVE OGI-UNO3            TO GI-UNO3.
           IF OGI-UNO4 NOT NUMERIC
              MOVE 0                TO GI-UNO4
           ELSE
           MOVE OGI-UNO4            TO GI-UNO4.
           IF OGI-UNO5 NOT NUMERIC
              MOVE 0                TO GI-UNO5
           ELSE
           MOVE OGI-UNO5            TO GI-UNO5.
           MOVE 0                   TO GI-UNO6 
                                       GI-UNO7.

           IF OGI-UNINTREPO NOT NUMERIC
              MOVE 0                TO GI-UNINTREPO
           ELSE
           MOVE OGI-UNINTREPO       TO GI-UNINTREPO.
           IF OGI-UNADDONINTREPO NOT NUMERIC
              MOVE 0                TO GI-UNADDONINTREPO
           ELSE
           MOVE OGI-UNADDONINTREPO  TO GI-UNADDONINTREPO.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OGI-PLEXP(SUB) NOT NUMERIC
                  MOVE 0               TO GI-PLEXP(SUB)
              ELSE
              MOVE OGI-PLEXP(SUB)      TO GI-PLEXP(SUB) 
              END-IF
              IF OGI-PLOFFSET(SUB) NOT NUMERIC
                  MOVE 0               TO GI-PLOFFSET(SUB)
              ELSE
              MOVE OGI-PLOFFSET(SUB)   TO GI-PLOFFSET(SUB)
              END-IF
           END-PERFORM.

           IF OGI-DLPARVEX NOT NUMERIC
              MOVE 0                TO GI-DLPARVEX
           ELSE
           MOVE OGI-DLPARVEX        TO GI-DLPARVEX.
           IF OGI-SERVOFF NOT NUMERIC
              MOVE 0                TO GI-SERVOFF
           ELSE
           MOVE OGI-SERVOFF         TO GI-SERVOFF.

           IF OGI-PAYCL1 NOT NUMERIC
              MOVE 0                TO GI-PAYCL1
           ELSE
           MOVE OGI-PAYCL1          TO GI-PAYCL1.
           IF OGI-PAYCL2 NOT NUMERIC
              MOVE 0                TO GI-PAYCL2
           ELSE
           MOVE OGI-PAYCL2          TO GI-PAYCL2.
           IF OGI-PAYAH NOT NUMERIC
              MOVE 0                TO GI-PAYAH
           ELSE
           MOVE OGI-PAYAH           TO GI-PAYAH.
           IF OGI-PAYPP NOT NUMERIC
              MOVE 0                TO GI-PAYPP
           ELSE
           MOVE OGI-PAYPP           TO GI-PAYPP.
           IF OGI-PAYO1 NOT NUMERIC
              MOVE 0                TO GI-PAYO1
           ELSE
           MOVE OGI-PAYO1           TO GI-PAYO1.
           IF OGI-PAYO2 NOT NUMERIC
              MOVE 0                TO GI-PAYO2
           ELSE
           MOVE OGI-PAYO2           TO GI-PAYO2.
           IF OGI-PAYO3 NOT NUMERIC
              MOVE 0                TO GI-PAYO3
           ELSE
           MOVE OGI-PAYO3           TO GI-PAYO3.
           IF OGI-PAYO4 NOT NUMERIC
              MOVE 0                TO GI-PAYO4
           ELSE
           MOVE OGI-PAYO4           TO GI-PAYO4.
           IF OGI-PAYO5 NOT NUMERIC
              MOVE 0                TO GI-PAYO5
           ELSE
           MOVE OGI-PAYO5           TO GI-PAYO5.
           IF OGI-PAYO6 NOT NUMERIC
              MOVE 0                TO GI-PAYO6
           ELSE
           MOVE OGI-PAYO6           TO GI-PAYO6.
           IF OGI-PAYO7 NOT NUMERIC
              MOVE 0                TO GI-PAYO7
           ELSE
           MOVE OGI-PAYO7           TO GI-PAYO7.
           IF OGI-DLPAYABLE NOT NUMERIC
              MOVE 0                TO GI-DLPAYABLE
           ELSE
           MOVE OGI-DLPAYABLE       TO GI-DLPAYABLE.

           IF OGI-DLRVPRIN-1 NOT NUMERIC
              MOVE 0                TO GI-DLRVPRIN-1
           ELSE
           MOVE OGI-DLRVPRIN-1      TO GI-DLRVPRIN-1.
           IF OGI-DLRVPRIN-2 NOT NUMERIC
              MOVE 0                TO GI-DLRVPRIN-2
           ELSE
           MOVE OGI-DLRVPRIN-2      TO GI-DLRVPRIN-2.
           IF OGI-DLRVPRIN-3 NOT NUMERIC
              MOVE 0                TO GI-DLRVPRIN-3
           ELSE
           MOVE OGI-DLRVPRIN-3      TO GI-DLRVPRIN-3.
           IF OGI-DLRVCHGS-1 NOT NUMERIC
              MOVE 0                TO GI-DLRVCHGS-1
           ELSE
           MOVE OGI-DLRVCHGS-1      TO GI-DLRVCHGS-1.
           IF OGI-DLRVCHGS-2 NOT NUMERIC
              MOVE 0                TO GI-DLRVCHGS-2
           ELSE
           MOVE OGI-DLRVCHGS-2      TO GI-DLRVCHGS-2.
           IF OGI-DLRVCHGS-3 NOT NUMERIC
              MOVE 0                TO GI-DLRVCHGS-3
           ELSE
           MOVE OGI-DLRVCHGS-3      TO GI-DLRVCHGS-3.

           IF OGI-DLPARV NOT NUMERIC
              MOVE 0                TO GI-DLPARV
           ELSE
           MOVE OGI-DLPARV          TO GI-DLPARV.
           IF OGI-PAYALLOT NOT NUMERIC
              MOVE 0                TO GI-PAYALLOT
           ELSE
           MOVE OGI-PAYALLOT        TO GI-PAYALLOT.
           IF OGI-DIRECT-PAY NOT NUMERIC
              MOVE 0                TO GI-DIRECT-PAY
           ELSE
           MOVE OGI-DIRECT-PAY      TO GI-DIRECT-PAY.

           IF OGI-ERINTCHG NOT NUMERIC
              MOVE 0                TO GI-ERINTCHG
           ELSE
           MOVE OGI-ERINTCHG        TO GI-ERINTCHG.
           IF OGI-ERADDON NOT NUMERIC
              MOVE 0                TO GI-ERADDON
           ELSE
           MOVE OGI-ERADDON         TO GI-ERADDON.
           IF OGI-ERSERCHG NOT NUMERIC
              MOVE 0                TO GI-ERSERCHG
           ELSE
           MOVE OGI-ERSERCHG        TO GI-ERSERCHG.
           IF OGI-ERMAINTFEE NOT NUMERIC
              MOVE 0                TO GI-ERMAINTFEE
           ELSE
           MOVE OGI-ERMAINTFEE      TO GI-ERMAINTFEE.
           IF OGI-ERDLDISC NOT NUMERIC
              MOVE 0                TO GI-ERDLDISC
           ELSE
           MOVE OGI-ERDLDISC        TO GI-ERDLDISC.
           IF OGI-EROTHER NOT NUMERIC
              MOVE 0                TO GI-EROTHER
           ELSE
           MOVE OGI-EROTHER         TO GI-EROTHER.
           MOVE 0                   TO GI-EARN7 
                                       GI-EARN8 
                                       GI-EARN9 
                                       GI-EARN10.

           IF OGI-LATECHG NOT NUMERIC
              MOVE 0                TO GI-LATECHG
           ELSE
           MOVE OGI-LATECHG         TO GI-LATECHG.
           IF OGI-INTEREST NOT NUMERIC
              MOVE 0                TO GI-INTEREST
           ELSE
           MOVE OGI-INTEREST        TO GI-INTEREST.
           IF OGI-DEFERMENTS NOT NUMERIC
              MOVE 0                TO GI-DEFERMENTS
           ELSE
           MOVE OGI-DEFERMENTS      TO GI-DEFERMENTS.
           IF OGI-SAPRINCIPAL NOT NUMERIC
              MOVE 0                TO GI-SAPRINCIPAL
           ELSE
           MOVE OGI-SAPRINCIPAL     TO GI-SAPRINCIPAL.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OGI-PLINT(SUB) NOT NUMERIC
                 MOVE 0                TO GI-PLINT(SUB)
              ELSE
              MOVE OGI-PLINT(SUB)      TO GI-PLINT(SUB)
              END-IF
              IF OGI-PLREC(SUB) NOT NUMERIC
                 MOVE 0                TO GI-PLREC(SUB)
              ELSE
              MOVE OGI-PLREC(SUB)      TO GI-PLREC(SUB)
              END-IF
              IF OGI-PLNEW-AR(SUB) NOT NUMERIC
                 MOVE 0                TO GI-PLNEW-AR(SUB)
              ELSE
              MOVE OGI-PLNEW-AR(SUB)   TO GI-PLNEW-AR(SUB)
              END-IF
           END-PERFORM.

           IF OGI-CL1 NOT NUMERIC
              MOVE 0                TO GI-CL1
           ELSE
           MOVE OGI-CL1             TO GI-CL1.
           IF OGI-CL2 NOT NUMERIC
              MOVE 0                TO GI-CL2
           ELSE
           MOVE OGI-CL2             TO GI-CL2.
           IF OGI-AH NOT NUMERIC
              MOVE 0                TO GI-AH
           ELSE
           MOVE OGI-AH              TO GI-AH.
           IF OGI-PP NOT NUMERIC
              MOVE 0                TO GI-PP
           ELSE
           MOVE OGI-PP              TO GI-PP.
           IF OGI-O1 NOT NUMERIC
              MOVE 0                TO GI-O1
           ELSE
           MOVE OGI-O1              TO GI-O1.
           IF OGI-O2 NOT NUMERIC
              MOVE 0                TO GI-O2
           ELSE
           MOVE OGI-O2              TO GI-O2.
           IF OGI-O3 NOT NUMERIC
              MOVE 0                TO GI-O3
           ELSE
           MOVE OGI-O3              TO GI-O3.
           IF OGI-O4 NOT NUMERIC
              MOVE 0                TO GI-O4
           ELSE
           MOVE OGI-O4              TO GI-O4.
           IF OGI-O5 NOT NUMERIC
              MOVE 0                TO GI-O5
           ELSE
           MOVE OGI-O5              TO GI-O5.
           IF OGI-O6 NOT NUMERIC
              MOVE 0                TO GI-O6
           ELSE
           MOVE OGI-O6              TO GI-O6.
           IF OGI-O7 NOT NUMERIC
              MOVE 0                TO GI-O7
           ELSE
           MOVE OGI-O7              TO GI-O7.

           IF OGI-REPO-AR NOT NUMERIC
              MOVE 0                TO GI-REPO-AR
           ELSE
           MOVE OGI-REPO-AR         TO GI-REPO-AR.
           IF OGI-REPO-INT NOT NUMERIC
              MOVE 0                TO GI-REPO-INT
           ELSE
           MOVE OGI-REPO-INT        TO GI-REPO-INT.
           IF OGI-ACR-INT-AR NOT NUMERIC
              MOVE 0                TO GI-ACR-INT-AR
           ELSE
           MOVE OGI-ACR-INT-AR      TO GI-ACR-INT-AR.
           IF OGI-CONV-OFFSET NOT NUMERIC
              MOVE 0                TO GI-CONV-OFFSET
           ELSE
           MOVE OGI-CONV-OFFSET     TO GI-CONV-OFFSET.
      * SUB (104)
           IF OGI-PARTIAL-PLEXP NOT NUMERIC
              MOVE 0                 TO GI-PARTIAL-PLEXP
           ELSE
              MOVE OGI-PARTIAL-PLEXP TO GI-PARTIAL-PLEXP.

           IF OGI-PAYLBOX NOT NUMERIC
              MOVE 0                TO GI-PAYLBOX
           ELSE
           MOVE OGI-PAYLBOX         TO GI-PAYLBOX.
           IF OGI-PENALTY-INT NOT NUMERIC
              MOVE 0                TO GI-PENALTY-INT
           ELSE
           MOVE OGI-PENALTY-INT     TO GI-PENALTY-INT.
           IF OGI-PAYTPAY NOT NUMERIC
              MOVE 0                TO GI-PAYTPAY
           ELSE
           MOVE OGI-PAYTPAY         TO GI-PAYTPAY.
           IF OGI-PAYTCOLL NOT NUMERIC
              MOVE 0                TO GI-PAYTCOLL
           ELSE
           MOVE OGI-PAYTCOLL        TO GI-PAYTCOLL.
           IF OGI-PAYMGRAM NOT NUMERIC
              MOVE 0                TO GI-PAYMGRAM
           ELSE
           MOVE OGI-PAYMGRAM        TO GI-PAYMGRAM.
           IF OGI-REPO-ADDON-EXP NOT NUMERIC
              MOVE 0                TO GI-REPO-ADDON-EXP
           ELSE
           MOVE OGI-REPO-ADDON-EXP  TO GI-REPO-ADDON-EXP.
           IF OGI-ACH-BANK NOT NUMERIC
              MOVE 0                TO GI-ACH-BANK
           ELSE
           MOVE OGI-ACH-BANK        TO GI-ACH-BANK.

           IF OGI-LN-APPROVAL-LIMIT NOT NUMERIC
              MOVE 0                  TO GI-LN-APPROVAL-LIMIT
           ELSE
           MOVE OGI-LN-APPROVAL-LIMIT TO GI-LN-APPROVAL-LIMIT.
      
       UPGRADE-FILE-GI-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - G L
      *
      ******************************************************************
       UPGRADE-FILE-GL SECTION.

           IF FILE-OPTION-GL = "A"
              PERFORM CLEAR-AGL-FILE
           ELSE
              MOVE SPACES           TO GL-REC.

           MOVE OGL-FLAG            TO GL-FLAG     AGL-FLAG.

           MOVE OGL-NUMKEY          TO GL-BR-ACCOUNT  AGL-BR-ACCOUNT.

           MOVE 0                   TO GL-LTOUCH-DATE AGL-LTOUCH-DATE.

           MOVE OGL-DESCRIPTION     TO GL-DESCRIPTION AGL-DESCRIPTION.
           IF OGL-CONSOL NOT NUMERIC
              MOVE 0                TO GL-CONSOL      AGL-CONSOL
           ELSE
           MOVE OGL-CONSOL          TO GL-CONSOL      AGL-CONSOL.
           IF OGL-OPENBAL NOT NUMERIC
              MOVE 0                TO GL-OPENBAL     AGL-OPENBAL
           ELSE
           MOVE OGL-OPENBAL         TO GL-OPENBAL     AGL-OPENBAL.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 12
              IF OGL-CYBAL(S1) NOT NUMERIC
                 MOVE 0             TO GL-CYBAL(S1) AGL-CYBAL(S1)
              ELSE
                 MOVE OGL-CYBAL(S1) TO GL-CYBAL(S1) AGL-CYBAL(S1)
              END-IF
              IF OGL-LYBAL(S1) NOT NUMERIC
                 MOVE 0             TO GL-LYBAL(S1) AGL-LYBAL(S1)
              ELSE
                 MOVE OGL-LYBAL(S1) TO GL-LYBAL(S1) AGL-LYBAL(S1)
              END-IF
              IF OGL-CYBUD(S1) NOT NUMERIC
                 MOVE 0             TO GL-CYBUD(S1) AGL-CYBUD(S1)
              ELSE
                 MOVE OGL-CYBUD(S1) TO GL-CYBUD(S1) AGL-CYBUD(S1)
              END-IF
              IF OGL-LYBUD(S1) NOT NUMERIC
                 MOVE 0             TO GL-LYBUD(S1) AGL-LYBUD(S1)
              ELSE
                 MOVE OGL-LYBUD(S1) TO GL-LYBUD(S1) AGL-LYBUD(S1)
              END-IF
              IF OGL-NYBUD(S1) NOT NUMERIC
                 MOVE 0             TO GL-NYBUD(S1) AGL-NYBUD(S1)
              ELSE
                 MOVE OGL-NYBUD(S1) TO GL-NYBUD(S1) AGL-NYBUD(S1)
              END-IF
           END-PERFORM.

           MOVE OGL-TYPE            TO GL-TYPE    AGL-TYPE.
           MOVE OGL-CLEAR           TO GL-CLEAR   AGL-CLEAR.
           IF OGL-NUMBER1 NOT NUMERIC
              MOVE 0                TO GL-NUMBER1 AGL-NUMBER1
           ELSE
           MOVE OGL-NUMBER1         TO GL-NUMBER1 AGL-NUMBER1.
           IF OGL-NUMBER2 NOT NUMERIC
              MOVE 0                TO GL-NUMBER2 AGL-NUMBER2
           ELSE
           MOVE OGL-NUMBER2         TO GL-NUMBER2 AGL-NUMBER2.
           MOVE OGL-FS-FLAG         TO GL-FS-FLAG AGL-FS-FLAG.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 5
             MOVE OGL-REPORTS(S1)   TO GL-REPORTS(S1) AGL-REPORTS(S1)
           END-PERFORM.

           IF OGL-LYOPENBAL NOT NUMERIC
              MOVE 0              TO GL-LYOPENBAL AGL-LYOPENBAL
           ELSE
           MOVE OGL-LYOPENBAL     TO GL-LYOPENBAL AGL-LYOPENBAL.
           MOVE OGL-DLALLOC-GL    TO GL-DLALLOC-GL AGL-DLALLOC-GL.
           MOVE OGL-SPANISH-DESC  TO GL-SPANISH-DESC AGL-SPANISH-DESC.

       UPGRADE-FILE-GL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - I I
      *
      ******************************************************************
       UPGRADE-FILE-II SECTION.

           PERFORM CLEAR-II-FILE.

           MOVE OII-KEY                    TO II-KEY.
           MOVE OII-EMPLOYER-ID            TO II-EMPLOYER-ID.
           MOVE OII-NAME-CONTROL-NO        TO II-NAME-CONTROL-NO.
           MOVE OII-TRANS-CONTROL-CODE     TO II-TRANS-CONTROL-CODE.
           MOVE OII-FOREIGN-CORP           TO II-FOREIGN-CORP.
           MOVE OII-TRANSFER-AGENT-FG      TO II-TRANSFER-AGENT-FG.
           MOVE OII-PAYER-NAME             TO II-PAYER-NAME.
           MOVE OII-SECOND-PAYER           TO II-SECOND-PAYER.
           MOVE OII-PAYER-ADDRESS          TO II-PAYER-ADDRESS.
           MOVE OII-PAYER-CITY             TO II-PAYER-CITY.
           MOVE OII-PAYER-STATE            TO II-PAYER-STATE.
           MOVE OII-PAYER-ZIP              TO II-PAYER-ZIP.
           IF OII-PAYER-PHONE NOT NUMERIC 
              MOVE 0                       TO II-PAYER-PHONE
           ELSE
           MOVE OII-PAYER-PHONE            TO II-PAYER-PHONE.
           MOVE OII-PAYER-EXT              TO II-PAYER-EXT.
           MOVE OII-CONTACT                TO II-CONTACT.
           MOVE OII-CONTACT-EMAIL          TO II-CONTACT-EMAIL.
           IF OII-TAX-YEAR NOT NUMERIC
              MOVE 0                       TO II-TAX-YEAR
           ELSE
              MOVE OII-TAX-YEAR            TO II-TAX-YEAR.
           MOVE OII-CURRENT-LAST           TO II-CURRENT-LAST.
           MOVE OII-LASER-FORM             TO II-LASER-FORM.

       UPGRADE-FILE-II-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - I R
      *
      ******************************************************************
       UPGRADE-FILE-IR SECTION.

           MOVE SPACES                     TO IR-REC.

           MOVE OIR-KEY                    TO IR-KEY.
           MOVE OIR-PER-FG                 TO IR-PER-FG.

           PERFORM VARYING IRIX FROM 1 BY 1 UNTIL IRIX > 120
              IF OIR-INSRATE(IRIX) NOT NUMERIC
                 MOVE 0                  TO IR-INSRATE(IRIX)
              ELSE
                 MOVE OIR-INSRATE(IRIX)  TO IR-INSRATE(IRIX)
              END-IF
           END-PERFORM.

           MOVE OIR-DESC                   TO IR-DESC.

       UPGRADE-FILE-IR-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - J D
      *
      ******************************************************************
      * UPGRADE-FILE-JD SECTION.

      *     IF FILE-OPTION-JD = "A"
      *        PERFORM CLEAR-AJD-FILE
      *     ELSE
      *        MOVE SPACES TO JD-REC.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - -{ JD1-KEY }
      **    *NOTE* JD-DATE IS ALREADY IN CCYYMMDD FORMAT IN A15.
      **- - - - - - - - - - - - - - - - - - - - - - - - - - -{ JD1-KEY }
      *     MOVE OJD-DATE              TO JD-DATE    AJD-DATE.
      *     MOVE OJD-ID                TO JD-ID      AJD-ID.
      *     MOVE OJD-SEQ               TO JD-SEQ     AJD-SEQ.
      *     MOVE OJD-LINE              TO JD-LINE    AJD-LINE.

      *     MOVE 0                     TO JD-LTOUCH-DATE AJD-LTOUCH-DATE.
      *     MOVE OJD-GROUP-FG          TO JD-GROUP-FG    AJD-GROUP-FG.

      *     MOVE OJD-NUMKEY            TO JD-BR-ACCOUNT AJD-BR-ACCOUNT.
      *     MOVE OJD-OFFSET-GROUP-FG   TO JD-OFFSET-GROUP-FG
      *                                  AJD-OFFSET-GROUP-FG.

      *     MOVE OJD-OFFSET-NUMKEY     TO JD-OFFSET-BR-ACCOUNT
      *                                  AJD-OFFSET-BR-ACCOUNT.
      *     MOVE OJD-AMT               TO JD-AMT         AJD-AMT.
      *     MOVE OJD-EXPL              TO JD-EXPL        AJD-EXPL.
      *     MOVE OJD-DRCR-FG           TO JD-DRCR-FG     AJD-DRCR-FG.
      *     MOVE OJD-STATUS            TO JD-STATUS      AJD-STATUS.
      *     MOVE OJD-ORIG-LINE         TO JD-ORIG-LINE   AJD-ORIG-LINE.
      *     MOVE OJD-PARENT-GROUP      TO JD-PARENT-GROUP 
      *                                  AJD-PARENT-GROUP.

      * UPGRADE-FILE-JD-EXIT.
      *     EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - L C
      *
      ******************************************************************
       UPGRADE-FILE-LC SECTION.

           PERFORM CLEAR-LC-FILE.

           MOVE OLC-CODE                   TO LC-CODE.
           MOVE OLC-DESC                   TO LC-DESC.
           MOVE OLC-SMALLOAN               TO LC-SMALLOAN.
           MOVE OLC-SALEFIN                TO LC-SALEFIN.
           MOVE OLC-SERVACCT               TO LC-SERVACCT.
           MOVE OLC-LOANTYPE               TO LC-LOANTYPE.
           MOVE OLC-PROF1                  TO LC-PROF1.
           MOVE OLC-PROF2                  TO LC-PROF2.
           MOVE OLC-SKIP-TRW               TO LC-SKIP-TRW.
           MOVE OLC-DISPLAY-ERN            TO LC-DISPLAY-ERN.
           MOVE OLC-LCARDFG                TO LC-LCARDFG.
           MOVE OLC-CALC-HI-CREDIT         TO LC-CALC-HI-CREDIT.
           MOVE OLC-STOP-ON-DLNO           TO LC-STOP-ON-DLNO.
           MOVE OLC-SALES-FORCED-ENTRY     TO LC-SALES-FORCED-ENTRY.
           MOVE OLC-AFP-CLASS              TO LC-AFP-CLASS.
           MOVE OLC-CON-PDUE-DAYS          TO LC-CON-PDUE-DAYS.
           MOVE OLC-REC-PDUE-DAYS          TO LC-REC-PDUE-DAYS.
           MOVE OLC-GIFTNET                TO LC-GIFTNET.
           MOVE OLC-APP-REQ-FOR-LOAN       TO LC-APP-REQ-FOR-LOAN.
           IF OLC-POOLID NOT NUMERIC
              MOVE 0                       TO LC-POOLID
           ELSE
           MOVE OLC-POOLID                 TO LC-POOLID.
           MOVE OLC-USE-ALT-GL-FEE         TO LC-USE-ALT-GL-FEE.
      * CLEANSE
           IF OLC-PROGRP-CLASS NOT NUMERIC
              MOVE 0                       TO LC-PROGRP-CLASS
           ELSE
              MOVE OLC-PROGRP-CLASS        TO LC-PROGRP-CLASS.
           MOVE OLC-ALLOW-CASH-PROCEEDS    TO LC-ALLOW-CASH-PROCEEDS.

           MOVE SPACES                     TO LC-SALES-FORCED-ENTRY.

       UPGRADE-FILE-LC-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - P E
      *
      ******************************************************************
       UPGRADE-FILE-PE SECTION.

           MOVE SPACES                     TO PE-REC.

           MOVE OPE-DIR                    TO WSS-PROGRAM-DIR-A15.
           MOVE OPE-PGM                    TO WSS-PROGRAM-NAME-A15.
           PERFORM MISC-VERIFY-PROGRAM-NAME.
           MOVE WSS-PROGRAM-NAME-A30       TO PE-PGM.

           MOVE OPE-SEQ                    TO PE-SEQ.
           MOVE OPE-LOGIN                  TO PE-LOGIN.

           MOVE 0                          TO PE-LTOUCH-DATE.

       UPGRADE-FILE-PE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - P W
      *
      ******************************************************************
       UPGRADE-FILE-PW SECTION.

           MOVE SPACES TO PW-REC.
           MOVE 0      TO PW-SEQ.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ PW1-KEY  }
           MOVE OPW-PGM                    TO PW-PGM.
           IF OPW-PGM = "1ONPI0"
              MOVE "DISBI0"                TO PW-PGM
           ELSE
           IF OPW-PGM = "2ONPI0"
              MOVE "CHCKI0"                TO PW-PGM
           ELSE
           IF OPW-PGM = "3ONPI0"
              MOVE "VOIDI0"                TO PW-PGM
           ELSE
           IF OPW-PGM = "4ONPI0"
              MOVE "BNKDI0"                TO PW-PGM
           ELSE
           IF OPW-PGM = "5ONPI0"
              MOVE "BNKWI0"                TO PW-PGM
           ELSE
           IF OPW-PGM = "6ONPI0"
              MOVE "BCHKI0"                TO PW-PGM.


           MOVE OPW-SEQ                    TO PW-SEQ.

           MOVE ZEROES                     TO PW-LTOUCH-DATE.
           MOVE OPW-PASSYN                 TO PW-PASSYN.
           MOVE OPW-PASSWORD               TO PW-PASSWORD.
           MOVE OPW-DESC                   TO PW-DESC.
           MOVE OPW-USER-PROFILE           TO PW-USER-PROFILE.
           MOVE OPW-ASK-FG                 TO PW-ASK-FG.
           MOVE OPW-EXCEPTION-FG           TO PW-EXCEPTION-FG.

       UPGRADE-FILE-PW-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - R B
      *
      ******************************************************************
      *UPGRADE-FILE-RB SECTION.

      *    MOVE SPACES TO RB-REC.

      *    MOVE ORB-TBL-NO                 TO RB-TBL-NO.
      *    MOVE ORB-TERM                   TO RB-TERM.
      *    MOVE ORB-MON-DAY-CD             TO RB-MON-DAY-CD.

      *    PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 75
      *       MOVE ORB-AMT(SUB) TO RB-AMT(SUB)
      *       MOVE ORB-RATE(SUB) TO RB-RATE(SUB)
      *    END-PERFORM.

      *UPGRADE-FILE-RB-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - R C
      *
      ******************************************************************
       UPGRADE-FILE-RC SECTION.

           IF FILE-OPTION-RC = "A"
              PERFORM CLEAR-ARC-FILE
           ELSE
              PERFORM CLEAR-RC-FILE.

           MOVE ORC-STATUS           TO RC-STATUS ARC-STATUS.

           MOVE ORC-BRNO             TO RC-BRNO ARC-BRNO.

      *- - -{ CONVERT TO CCYYMMDD NOW }
           MOVE ORC-TRANS-DATE       TO DATE-YYYMMDD.
           PERFORM CONVERT-YYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD        TO RC-TRANS-DATE ARC-TRANS-DATE.

           MOVE 0                    TO RC-LTOUCH-DATE ARC-LTOUCH-DATE.

           MOVE ORC-RECAP-FG          TO RC-RECAP-FG ARC-RECAP-FG.
           MOVE ORC-GL-FG             TO RC-GL-FG    ARC-GL-FG.
           MOVE ORC-EOD-BATCH-FG      TO RC-EOD-BATCH-FG
                                        ARC-EOD-BATCH-FG.
           MOVE ORC-NIGHTLY-FUNDS-FG  TO RC-NIGHTLY-FUNDS-FG
                                        ARC-NIGHTLY-FUNDS-FG.
           MOVE ORC-EOM1-BATCH-FG     TO RC-EOM1-BATCH-FG
                                        ARC-EOM1-BATCH-FG.
           MOVE ORC-EOM-UPDATE-FG     TO RC-EOM-UPDATE-FG
                                        ARC-EOM-UPDATE-FG.
           MOVE ORC-EOM2-BATCH-FG     TO RC-EOM2-BATCH-FG
                                        ARC-EOM2-BATCH-FG.
           MOVE ORC-BS-P2P3-INBAL-FG  TO RC-BS-P2P3-INBAL-FG
                                        ARC-BS-P2P3-INBAL-FG.

           IF ORC-DEPOSIT NOT NUMERIC
              MOVE 0                  TO RC-DEPOSIT ARC-DEPOSIT
           ELSE
           MOVE ORC-DEPOSIT           TO RC-DEPOSIT ARC-DEPOSIT.
           IF ORC-OVER-SHORT NOT NUMERIC
              MOVE 0                  TO RC-OVER-SHORT ARC-OVER-SHORT
           ELSE
           MOVE ORC-OVER-SHORT        TO RC-OVER-SHORT ARC-OVER-SHORT.
           IF ORC-CHECKS NOT NUMERIC
              MOVE 0                  TO RC-CHECKS ARC-CHECKS
           ELSE
           MOVE ORC-CHECKS            TO RC-CHECKS ARC-CHECKS.

           MOVE ORC-OPENED-DATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-OPENED-DATE ARC-OPENED-DATE.

           IF ORC-OPENED-TIME NOT NUMERIC
              MOVE 0                  TO RC-OPENED-TIME 
                                        ARC-OPENED-TIME
           ELSE
           MOVE ORC-OPENED-TIME       TO RC-OPENED-TIME
                                        ARC-OPENED-TIME.
           MOVE ORC-OP-USERID         TO RC-OP-USERID  ARC-OP-USERID.

           MOVE ORC-CLOSED-DATE       TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-CLOSED-DATE ARC-CLOSED-DATE.
           IF ORC-CLOSED-TIME NOT NUMERIC
              MOVE 0                  TO RC-CLOSED-TIME 
                                        ARC-CLOSED-TIME
           ELSE
           MOVE ORC-CLOSED-TIME       TO RC-CLOSED-TIME
                                        ARC-CLOSED-TIME.
           MOVE ORC-CL-USERID         TO RC-CL-USERID   ARC-CL-USERID.

           MOVE ORC-UPDATED-DATE      TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-UPDATED-DATE
                                        ARC-UPDATED-DATE.
           IF ORC-UPDATED-TIME NOT NUMERIC
              MOVE 0                  TO RC-UPDATED-TIME 
                                        ARC-UPDATED-TIME
           ELSE
           MOVE ORC-UPDATED-TIME      TO RC-UPDATED-TIME
                                        ARC-UPDATED-TIME.

           MOVE ORC-EOD-BATCH-DATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-EOD-BATCH-DATE
                                        ARC-EOD-BATCH-DATE.
           IF ORC-EOD-BATCH-TIME NOT NUMERIC
              MOVE 0                  TO RC-EOD-BATCH-TIME 
                                        ARC-EOD-BATCH-TIME
           ELSE
           MOVE ORC-EOD-BATCH-TIME    TO RC-EOD-BATCH-TIME
                                        ARC-EOD-BATCH-TIME.

           MOVE ORC-FUNDS-DATE        TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-FUNDS-DATE ARC-FUNDS-DATE.
           IF ORC-FUNDS-TIME NOT NUMERIC
              MOVE 0                  TO RC-FUNDS-TIME ARC-FUNDS-TIME
           ELSE
           MOVE ORC-FUNDS-TIME        TO RC-FUNDS-TIME ARC-FUNDS-TIME.

           MOVE ORC-EARNINGS-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-EARNINGS-DATE
                                        ARC-EARNINGS-DATE.
           IF ORC-EARNINGS-TIME NOT NUMERIC
              MOVE 0                  TO RC-EARNINGS-TIME
                                        ARC-EARNINGS-TIME
           ELSE
           MOVE ORC-EARNINGS-TIME     TO RC-EARNINGS-TIME
                                        ARC-EARNINGS-TIME.

           MOVE ORC-EOM-UPDATED-DATE  TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-EOM-UPDATED-DATE
                                        ARC-EOM-UPDATED-DATE.
           IF ORC-EOM-UPDATED-TIME NOT NUMERIC
              MOVE 0                  TO RC-EOM-UPDATED-TIME
                                        ARC-EOM-UPDATED-TIME
           ELSE
           MOVE ORC-EOM-UPDATED-TIME  TO RC-EOM-UPDATED-TIME
                                        ARC-EOM-UPDATED-TIME.

           MOVE ORC-EOM2-BATCH-DATE   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD         TO RC-EOM2-BATCH-DATE
                                        ARC-EOM2-BATCH-DATE.
           IF ORC-EOM2-BATCH-TIME NOT NUMERIC
              MOVE 0                  TO RC-EOM2-BATCH-TIME
                                        ARC-EOM2-BATCH-TIME
           ELSE
           MOVE ORC-EOM2-BATCH-TIME   TO RC-EOM2-BATCH-TIME
                                        ARC-EOM2-BATCH-TIME.

           MOVE ORC-CHECK-DATE     TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO RC-CHECK-DATE ARC-CHECK-DATE.
           IF ORC-CHECK-TIME NOT NUMERIC
              MOVE 0                  TO RC-CHECK-TIME
                                        ARC-CHECK-TIME
           ELSE
           MOVE ORC-CHECK-TIME     TO RC-CHECK-TIME ARC-CHECK-TIME.

           IF ORC-LAST-ACCRUE NOT NUMERIC
              MOVE 0               TO RC-LAST-ACCRUE ARC-LAST-ACCRUE
           ELSE
              MOVE ORC-LAST-ACCRUE TO RC-LAST-ACCRUE
                                     ARC-LAST-ACCRUE.
           MOVE ORC-ERROR-MSG      TO RC-ERROR-MSG   ARC-ERROR-MSG.
           
           IF ORC-BANK-BAL NOT NUMERIC
              MOVE 0               TO RC-BANK-BAL ARC-BANK-BAL
           ELSE
           MOVE ORC-BANK-BAL       TO RC-BANK-BAL ARC-BANK-BAL.

           IF ORC-CHECK-DEPOSIT NOT NUMERIC
              MOVE 0               TO RC-CHECK-DEPOSIT
                                     ARC-CHECK-DEPOSIT
           ELSE
              MOVE ORC-CHECK-DEPOSIT TO RC-CHECK-DEPOSIT
                                       ARC-CHECK-DEPOSIT.

       UPGRADE-FILE-RC-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - S M
      *
      ******************************************************************
       UPGRADE-FILE-SM SECTION.

           MOVE SPACES                     TO SM-REC.

           MOVE OSM-ORGST                  TO SM-SP-ORGST.
           MOVE OSM-SPRCLASS               TO SM-SP-SPRCLASS.
           MOVE OSM-SUBCLASS               TO SM-SP-SUBCLASS.
           MOVE OSM-LAWCODE                TO SM-SP-LAWCODE.
           MOVE OSM-DATE                   TO SM-DATE.
           MOVE OSM-SEQ                    TO SM-SEQ.

           MOVE 0                          TO SM-LTOUCH-DATE.
           MOVE 0                          TO SM-LTOUCH-TIME-HHMM.
           MOVE SPACES                     TO SM-LTOUCH-USERID.
           MOVE OSM-MEMO1                  TO SM-MEMO1.
           MOVE OSM-MEMO2                  TO SM-MEMO2.
           MOVE OSM-MEMO-TYPE              TO SM-MEMO-TYPE.

       UPGRADE-FILE-SM-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - S P
      *
      ******************************************************************
       UPGRADE-FILE-SP SECTION.

           PERFORM CLEAR-SP-FILE.                       

           MOVE OSP-ORGST                  TO SP-ORGST.
           MOVE OSP-SPRCLASS               TO SP-SPRCLASS.
           MOVE OSP-SUBCLASS               TO SP-SUBCLASS.
           MOVE OSP-LAWCODE                TO SP-LAWCODE.
 
           MOVE OSP-DESC                   TO SP-DESC.
           MOVE OSP-NOTES                  TO SP-NOTES.

           MOVE OSP-EFFDATE                TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO SP-EFFDATE.

           MOVE OSP-EXPDATE                TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD              TO SP-EXPDATE.

           IF OSP-EXPD-MONTHS NOT NUMERIC
              MOVE 0                       TO SP-EXPD-MONTHS
           ELSE
           MOVE OSP-EXPD-MONTHS            TO SP-EXPD-MONTHS.
           IF OSP-EXPD-DAYS NOT NUMERIC
              MOVE 0                       TO SP-EXPD-DAYS
           ELSE
           MOVE OSP-EXPD-DAYS              TO SP-EXPD-DAYS.
           MOVE OSP-EXPD-FRMLA             TO SP-EXPD-FRMLA.
           MOVE OSP-EXPD-EXCEPT            TO SP-EXPD-EXCEPT.
           MOVE OSP-EXPR-FRMLA             TO SP-EXPR-FRMLA.
           MOVE OSP-EXPR-REDU-FRMLA        TO SP-EXPR-REDU-FRMLA.

           PERFORM VARYING EXPR FROM 1 BY 1 UNTIL EXPR > 5
             SET OEXPR                     TO EXPR
             IF OSP-EXPR-RATE(OEXPR) NOT NUMERIC
                MOVE 0                     TO SP-EXPR-RATE(EXPR)
             ELSE
             MOVE OSP-EXPR-RATE   (OEXPR)  TO SP-EXPR-RATE   (EXPR)
             END-IF
             IF OSP-EXPR-BREAK(OEXPR) NOT NUMERIC
                MOVE 0                     TO SP-EXPR-BREAK(EXPR)
             ELSE
             MOVE OSP-EXPR-BREAK  (OEXPR)  TO SP-EXPR-BREAK  (EXPR)
             END-IF
             IF OSP-EXPR-YRTYPE(OEXPR) NOT NUMERIC
                MOVE 0                     TO SP-EXPR-YRTYPE(EXPR)
             ELSE
             MOVE OSP-EXPR-YRTYPE (OEXPR)  TO SP-EXPR-YRTYPE (EXPR)
             END-IF
             MOVE OSP-EXPR-INTMETH(OEXPR)  TO SP-EXPR-INTMETH(EXPR)
           END-PERFORM.

           MOVE OSP-EXPR-LCHG              TO SP-EXPR-LCHG.
           MOVE OSP-JUDGFRMLA              TO SP-JUDGFRMLA.
           IF OSP-JUDGRATE NOT NUMERIC
              MOVE 0                       TO SP-JUDGRATE
           ELSE
           MOVE OSP-JUDGRATE               TO SP-JUDGRATE.
           IF OSP-JUDGYRTYPE NOT NUMERIC
              MOVE 0                       TO SP-JUDGYRTYPE
           ELSE
           MOVE OSP-JUDGYRTYPE             TO SP-JUDGYRTYPE.
           MOVE OSP-JUDGINTMETH            TO SP-JUDGINTMETH.
           MOVE OSP-ACC-FRMLA              TO SP-ACC-FRMLA.
           IF OSP-ACC-YRTYPE NOT NUMERIC
              MOVE 0                       TO SP-ACC-YRTYPE
           ELSE
           MOVE OSP-ACC-YRTYPE             TO SP-ACC-YRTYPE.
           MOVE OSP-ACC-INTMETH            TO SP-ACC-INTMETH.

           PERFORM VARYING ASTP FROM 1 BY 1 UNTIL ASTP > 5
             SET OASTP                     TO ASTP
             IF OSP-ACC-RATE(OASTP) NOT NUMERIC
                MOVE 0                     TO SP-ACC-RATE(ASTP)
             ELSE
             MOVE OSP-ACC-RATE (OASTP)     TO SP-ACC-RATE (ASTP)
             END-IF
             IF OSP-ACC-BREAK(OASTP) NOT NUMERIC
                MOVE 0                     TO SP-ACC-BREAK(ASTP)
             ELSE
             MOVE OSP-ACC-BREAK(OASTP)     TO SP-ACC-BREAK(ASTP)
             END-IF
           END-PERFORM.

           MOVE OSP-1098FRMLA              TO SP-1098FRMLA.
           MOVE OSP-DISFRMLA               TO SP-DISFRMLA.
           MOVE OSP-CONTRFRMLA             TO SP-CONTRFRMLA.
           MOVE OSP-BANKRULE               TO SP-BANKRULE.
           IF OSP-CONTPDTH NOT NUMERIC
              MOVE 0                       TO SP-CONTPDTH
           ELSE
           MOVE OSP-CONTPDTH               TO SP-CONTPDTH.
           IF OSP-FINCHG NOT NUMERIC
              MOVE 0                       TO SP-FINCHG
           ELSE
           MOVE OSP-FINCHG                 TO SP-FINCHG.
           MOVE OSP-BANKUNITPER-CD         TO SP-BANKUNITPER-CD.
           MOVE OSP-TRWBANKRULE            TO SP-TRWBANKRULE.
           IF OSP-TRWCONTPDTH NOT NUMERIC
              MOVE 0                       TO SP-TRWCONTPDTH
           ELSE
           MOVE OSP-TRWCONTPDTH            TO SP-TRWCONTPDTH.
           MOVE OSP-TRWBANKUNITPER-CD      TO SP-TRWBANKUNITPER-CD.
           MOVE OSP-RECFRMLA               TO SP-RECFRMLA.
           MOVE OSP-RECPAYCD               TO SP-RECPAYCD.
           IF OSP-RECPDTH NOT NUMERIC
              MOVE 0                       TO SP-RECPDTH
           ELSE
           MOVE OSP-RECPDTH                TO SP-RECPDTH.

           MOVE OSP-DISFRMLA-SPAY-FG       TO SP-DISFRMLA-SPAY-FG.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
            IF OSP-ERNFRMLA(SUB) NOT NUMERIC
               MOVE 0                       TO SP-ERNFRMLA(SUB)
            ELSE
            MOVE OSP-ERNFRMLA         (SUB) TO SP-ERNFRMLA         (SUB)
            END-IF
            IF OSP-ERNAMT(SUB) NOT NUMERIC
               MOVE 0                       TO SP-ERNAMT(SUB)
            ELSE
            MOVE OSP-ERNAMT           (SUB) TO SP-ERNAMT           (SUB)
            END-IF
            IF OSP-ERNPERCT(SUB) NOT NUMERIC
               MOVE 0                       TO SP-ERNPERCT(SUB)
            ELSE
            MOVE OSP-ERNPERCT         (SUB) TO SP-ERNPERCT         (SUB)
            END-IF
            MOVE OSP-ERNPERCD         (SUB) TO SP-ERNPERCD         (SUB)
            MOVE OSP-ERNACCRL-FG      (SUB) TO SP-ERNACCRL-FG      (SUB)
            MOVE OSP-ERNACCRL-START-CD(SUB) TO SP-ERNACCRL-START-CD(SUB)
            MOVE OSP-ERNACCRL-DFCD    (SUB) TO SP-ERNACCRL-DFCD    (SUB)
            IF OSP-ERN-DAYS(SUB) NOT NUMERIC
               MOVE 0                       TO SP-ERN-DAYS(SUB)
            ELSE
            MOVE OSP-ERN-DAYS         (SUB) TO SP-ERN-DAYS         (SUB)
            END-IF
            IF OSP-ERN-TERM(SUB) NOT NUMERIC
               MOVE 0                       TO SP-ERN-TERM(SUB)
            ELSE
            MOVE OSP-ERN-TERM         (SUB) TO SP-ERN-TERM         (SUB)
            END-IF
            MOVE SPACES                     TO SP-ERN-TYPE         (SUB)
           END-PERFORM.

           PERFORM VARYING SUB FROM 7 BY 1 UNTIL SUB > 10
            MOVE ZEROES                     TO SP-ERNFRMLA         (SUB)
            MOVE ZEROES                     TO SP-ERNAMT           (SUB)
            MOVE ZEROES                     TO SP-ERNPERCT         (SUB)
            MOVE SPACES                     TO SP-ERNPERCD         (SUB)
            MOVE SPACES                     TO SP-ERNACCRL-FG      (SUB)
            MOVE SPACES                     TO SP-ERNACCRL-START-CD(SUB)
            MOVE SPACES                     TO SP-ERNACCRL-DFCD    (SUB)
            MOVE ZEROES                     TO SP-ERN-DAYS         (SUB)
            MOVE ZEROES                     TO SP-ERN-TERM         (SUB)
            MOVE SPACES                     TO SP-ERN-TYPE         (SUB)
           END-PERFORM.

           MOVE OSP-ERNACCEL-CD            TO SP-ERNACCEL-CD.
           MOVE OSP-ERNJD-CD               TO SP-ERNJD-CD.
           MOVE OSP-MIDSTRERNCD            TO SP-MIDSTRERNCD.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
             IF ( SUB > 6 )
                MOVE ZEROES                TO SP-EARN-ORDER(SUB)
             ELSE
                IF OSP-EARN-ORDER(SUB) NOT NUMERIC
                   MOVE 0                  TO SP-EARN-ORDER(SUB)
                ELSE
                MOVE OSP-EARN-ORDER(SUB)   TO SP-EARN-ORDER(SUB)
                END-IF
             END-IF
           END-PERFORM.

           MOVE OSP-ERNDELQFRMLA           TO SP-ERNDELQFRMLA.
           IF OSP-ERNDELQ-START NOT NUMERIC
              MOVE 0                       TO SP-ERNDELQ-START
           ELSE
           MOVE OSP-ERNDELQ-START          TO SP-ERNDELQ-START.
           IF OSP-ERNDELQ-STOP NOT NUMERIC
              MOVE 0                       TO SP-ERNDELQ-STOP
           ELSE
           MOVE OSP-ERNDELQ-STOP           TO SP-ERNDELQ-STOP.
           MOVE OSP-1098-INC-LC            TO SP-1098-INC-LC.
           IF OSP-MAX-IB-ACR-DAYS NOT NUMERIC
              MOVE 0                       TO SP-MAX-IB-ACR-DAYS
           ELSE
           MOVE OSP-MAX-IB-ACR-DAYS        TO SP-MAX-IB-ACR-DAYS.

           IF OSP-LCGRACE NOT NUMERIC
              MOVE 0                       TO SP-LCGRACE
           ELSE
           MOVE OSP-LCGRACE                TO SP-LCGRACE.
           MOVE OSP-LCGRACECD              TO SP-LCGRACECD.
           MOVE OSP-LCTYPE                 TO SP-LCTYPE.
           IF OSP-LCRATE NOT NUMERIC
              MOVE 0                       TO SP-LCRATE
           ELSE
           MOVE OSP-LCRATE                 TO SP-LCRATE.
           MOVE OSP-LCFRMLA                TO SP-LCFRMLA.
           IF OSP-LCMINCHG NOT NUMERIC
              MOVE 0                       TO SP-LCMINCHG
           ELSE
           MOVE OSP-LCMINCHG               TO SP-LCMINCHG.
           IF OSP-LCMAXAMT NOT NUMERIC
              MOVE 0                       TO SP-LCMAXAMT
           ELSE
           MOVE OSP-LCMAXAMT               TO SP-LCMAXAMT.
           IF OSP-LCDELFAC NOT NUMERIC
              MOVE 0                       TO SP-LCDELFAC
           ELSE
           MOVE OSP-LCDELFAC               TO SP-LCDELFAC.
           IF OSP-LCYRTYPE NOT NUMERIC
              MOVE 0                       TO SP-LCYRTYPE
           ELSE
           MOVE OSP-LCYRTYPE               TO SP-LCYRTYPE.
           IF OSP-LC-CODE NOT NUMERIC
              MOVE 0                       TO SP-LC-CODE
           ELSE
           MOVE OSP-LC-CODE                TO SP-LC-CODE.
           MOVE OSP-LCUNITPER-CD           TO SP-LCUNITPER-CD.

           IF OSP-DEFFRMLA NOT NUMERIC
              MOVE 0                       TO SP-DEFFRMLA
           ELSE
           MOVE OSP-DEFFRMLA               TO SP-DEFFRMLA.
           MOVE OSP-DEFEXCEPT              TO SP-DEFEXCEPT.
           IF OSP-DEFWORKER NOT NUMERIC
              MOVE 0                       TO SP-DEFWORKER
           ELSE
           MOVE OSP-DEFWORKER              TO SP-DEFWORKER.
           IF OSP-DEFPERCD NOT NUMERIC
              MOVE 0                       TO SP-DEFPERCD
           ELSE
           MOVE OSP-DEFPERCD               TO SP-DEFPERCD.
           IF OSP-DEFBASE NOT NUMERIC
              MOVE 0                       TO SP-DEFBASE
           ELSE
           MOVE OSP-DEFBASE                TO SP-DEFBASE.
           MOVE OSP-DEFPOLCD               TO SP-DEFPOLCD.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
             IF OSP-DEFPOLMX(SUB) NOT NUMERIC
                MOVE 0                     TO SP-DEFPOLMX(SUB)
             ELSE
             MOVE OSP-DEFPOLMX(SUB)        TO SP-DEFPOLMX(SUB)
             END-IF
           END-PERFORM.

           IF OSP-DEFMIN NOT NUMERIC
              MOVE 0                       TO SP-DEFMIN
           ELSE
           MOVE OSP-DEFMIN                 TO SP-DEFMIN.
           IF OSP-DEFMAX NOT NUMERIC
              MOVE 0                       TO SP-DEFMAX
           ELSE
           MOVE OSP-DEFMAX                 TO SP-DEFMAX.
           MOVE OSP-DEFUNITPER-CD          TO SP-DEFUNITPER-CD.

           MOVE 0                          TO SP-ALT-DEFFRMLA
                                              SP-ALT-DEFMIN
                                              SP-ALT-DEFMAX.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 20
             IF OSP-PRFORM(SUB) NOT NUMERIC
                MOVE 0                     TO SP-PRFORM(SUB)
             ELSE
             MOVE OSP-PRFORM(SUB)          TO SP-PRFORM(SUB)
             END-IF
             MOVE OSP-PRFLAG(SUB)          TO SP-PRFLAG(SUB)
           END-PERFORM.
           MOVE OSP-IMED-REC               TO SP-IMED-REC.

           IF OSP-SCFRMLA NOT NUMERIC
              MOVE 0                       TO SP-SCFRMLA
           ELSE
           MOVE OSP-SCFRMLA                TO SP-SCFRMLA.
           IF OSP-SCRATE NOT NUMERIC
              MOVE 0                       TO SP-SCRATE
           ELSE
           MOVE OSP-SCRATE                 TO SP-SCRATE.
           IF OSP-SCMIN NOT NUMERIC
              MOVE 0                       TO SP-SCMIN
           ELSE
           MOVE OSP-SCMIN                  TO SP-SCMIN.
           IF OSP-SCMAX NOT NUMERIC
              MOVE 0                       TO SP-SCMAX
           ELSE
           MOVE OSP-SCMAX                  TO SP-SCMAX.

           IF OSP-MFFRMLA NOT NUMERIC
              MOVE 0                       TO SP-MFFRMLA
           ELSE
           MOVE OSP-MFFRMLA                TO SP-MFFRMLA.
           IF OSP-MFRATE NOT NUMERIC
              MOVE 0                       TO SP-MFRATE
           ELSE
           MOVE OSP-MFRATE                 TO SP-MFRATE.
           IF OSP-MFMIN NOT NUMERIC
              MOVE 0                       TO SP-MFMIN
           ELSE
           MOVE OSP-MFMIN                  TO SP-MFMIN.
           IF OSP-MFMAX NOT NUMERIC
              MOVE 0                       TO SP-MFMAX
           ELSE
           MOVE OSP-MFMAX                  TO SP-MFMAX.

           MOVE OSP-INTMETHOD              TO SP-INTMETHOD.
           IF OSP-YEARTYPE NOT NUMERIC
              MOVE 0                       TO SP-YEARTYPE
           ELSE
           MOVE OSP-YEARTYPE               TO SP-YEARTYPE.
           IF OSP-PYEXFRMLA NOT NUMERIC
              MOVE 0                       TO SP-PYEXFRMLA
           ELSE
           MOVE OSP-PYEXFRMLA              TO SP-PYEXFRMLA.
           IF OSP-PYEXSPCODE NOT NUMERIC
              MOVE 0                       TO SP-PYEXSPCODE
           ELSE
           MOVE OSP-PYEXSPCODE             TO SP-PYEXSPCODE.
           IF OSP-PYEXYEARTP NOT NUMERIC
              MOVE 0                       TO SP-PYEXYEARTP
           ELSE
           MOVE OSP-PYEXYEARTP             TO SP-PYEXYEARTP.
           MOVE OSP-PYEXFMDATE             TO SP-PYEXFMDATE.
           MOVE OSP-PYEXBASECD             TO SP-PYEXBASECD.
           IF OSP-PYEXBASE NOT NUMERIC
              MOVE 0                       TO SP-PYEXBASE
           ELSE
           MOVE OSP-PYEXBASE               TO SP-PYEXBASE.
           IF OSP-PYEXDAYS NOT NUMERIC
              MOVE 0                       TO SP-PYEXDAYS
           ELSE
           MOVE OSP-PYEXDAYS               TO SP-PYEXDAYS.

           IF OSP-CAL-SPFRMLA NOT NUMERIC
              MOVE 0                       TO SP-CAL-SPFRMLA
           ELSE
           MOVE OSP-CAL-SPFRMLA            TO SP-CAL-SPFRMLA.

           PERFORM VARYING CTBL FROM 1 BY 1 UNTIL CTBL > 2
             SET OCTBL                      TO CTBL
             MOVE OSP-CAL-RATETYPE (OCTBL)  TO SP-CAL-RATETYPE (CTBL)
             MOVE OSP-CAL-BREAKTYPE(OCTBL)  TO SP-CAL-BREAKTYPE(CTBL)
             MOVE OSP-CAL-CHGABLE  (OCTBL)  TO SP-CAL-CHGABLE  (CTBL)
             IF OSP-CAL-NORATES(OCTBL) NOT NUMERIC
                MOVE 0                      TO SP-CAL-NORATES(CTBL)
             ELSE
             MOVE OSP-CAL-NORATES  (OCTBL)  TO SP-CAL-NORATES  (CTBL)
             END-IF
             IF OSP-CAL-TBFRMLA(OCTBL) NOT NUMERIC
                MOVE 0                      TO SP-CAL-TBFRMLA(CTBL)
             ELSE
             MOVE OSP-CAL-TBFRMLA  (OCTBL)  TO SP-CAL-TBFRMLA  (CTBL)
             END-IF

             PERFORM VARYING CSTP FROM 1 BY 1 UNTIL CSTP > 5
              SET OCSTP                     TO CSTP
              IF OSP-CAL-RATE(OCTBL OCSTP) NOT NUMERIC
                 MOVE 0                      TO SP-CAL-RATE(CTBL CSTP)
              ELSE
              MOVE OSP-CAL-RATE(OCTBL OCSTP) TO SP-CAL-RATE(CTBL CSTP)
              END-IF
              IF OSP-CAL-BREAK(OCTBL OCSTP) NOT NUMERIC
                 MOVE 0                      TO SP-CAL-BREAK(CTBL CSTP)
              ELSE
              MOVE OSP-CAL-BREAK(OCTBL OCSTP) TO SP-CAL-BREAK(CTBL CSTP)
              END-IF
             END-PERFORM
           END-PERFORM.

           IF OSP-MINSF-FRMLA NOT NUMERIC
              MOVE 0                       TO SP-MINSF-FRMLA
           ELSE
           MOVE OSP-MINSF-FRMLA            TO SP-MINSF-FRMLA.
           IF OSP-MINSF-CHG NOT NUMERIC
              MOVE 0                       TO SP-MINSF-CHG
           ELSE
           MOVE OSP-MINSF-CHG              TO SP-MINSF-CHG.
           IF OSP-MAXAPR-FRMLA NOT NUMERIC
              MOVE 0                       TO SP-MAXAPR-FRMLA
           ELSE
           MOVE OSP-MAXAPR-FRMLA           TO SP-MAXAPR-FRMLA.

           PERFORM VARYING ETBL FROM 1 BY 1 UNTIL ETBL > 2
             SET OETBL                      TO ETBL
             IF OSP-EDT-NOEDITS(OETBL) NOT NUMERIC
                MOVE 0                      TO SP-EDT-NOEDITS(ETBL)
             ELSE
             MOVE OSP-EDT-NOEDITS  (OETBL)  TO SP-EDT-NOEDITS(ETBL)
             END-IF
             PERFORM VARYING ESTP FROM 1 BY 1 UNTIL ESTP > 6
              SET OESTP                     TO ESTP
              MOVE OSP-EDT-TYPE    (OETBL OESTP)
                            TO SP-EDT-TYPE    (ETBL ESTP)
              MOVE OSP-EDT-HL      (OETBL OESTP)
                            TO SP-EDT-HL      (ETBL ESTP)
              MOVE OSP-EDT-COLL    (OETBL OESTP)
                            TO SP-EDT-COLL    (ETBL ESTP)
              MOVE OSP-EDT-CD      (OETBL OESTP)
                            TO SP-EDT-CD      (ETBL ESTP)
              IF OSP-EDT-RATE(OETBL OESTP) NOT NUMERIC
                 MOVE 0     TO SP-EDT-RATE    (ETBL ESTP)
              ELSE
              MOVE OSP-EDT-RATE    (OETBL OESTP)
                            TO SP-EDT-RATE    (ETBL ESTP)
              END-IF
              MOVE OSP-EDT-RATETYPE(OETBL OESTP)
                            TO SP-EDT-RATETYPE(ETBL ESTP)
              IF OSP-EDT-AMT(OETBL OESTP) NOT NUMERIC
                 MOVE 0     TO SP-EDT-AMT     (ETBL ESTP)
              ELSE
              MOVE OSP-EDT-AMT     (OETBL OESTP)
                            TO SP-EDT-AMT     (ETBL ESTP)
              END-IF
              MOVE OSP-EDT-AMTYPE  (OETBL OESTP)
                            TO SP-EDT-AMTYPE  (ETBL ESTP)
              IF OSP-EDT-TERM(OETBL OESTP) NOT NUMERIC
                 MOVE 0     TO SP-EDT-TERM    (ETBL ESTP)
              ELSE
              MOVE OSP-EDT-TERM    (OETBL OESTP)
                            TO SP-EDT-TERM    (ETBL ESTP)
              END-IF
             END-PERFORM
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING ILEV FROM 1 BY 1 UNTIL ILEV > 12
             SET OILEV                     TO ILEV
             IF OSP-INSCOM(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSCOM(ILEV)
             ELSE
             MOVE OSP-INSCOM      (OILEV)  TO SP-INSCOM   (ILEV)
             END-IF
             IF OSP-INSRATECD(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSRATECD(ILEV)
             ELSE
             MOVE OSP-INSRATECD   (OILEV)  TO SP-INSRATECD(ILEV)
             END-IF
             IF OSP-INSJFAC(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSJFAC(ILEV)
             ELSE
             MOVE OSP-INSJFAC     (OILEV)  TO SP-INSJFAC  (ILEV)
             END-IF
             IF OSP-INSDISCNT(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSDISCNT(ILEV)
             ELSE
             MOVE OSP-INSDISCNT   (OILEV)  TO SP-INSDISCNT(ILEV)
             END-IF
             MOVE OSP-INSCHGABL   (OILEV)  TO SP-INSCHGABL(ILEV)
             PERFORM VARYING ISTP FROM 1 BY 1 UNTIL ISTP > 20
              SET OISTP                    TO ISTP
              IF OSP-INSTERM(OILEV OISTP) NOT NUMERIC
                 MOVE 0                     TO SP-INSTERM(ILEV ISTP)
              ELSE
              MOVE OSP-INSTERM(OILEV OISTP) TO SP-INSTERM(ILEV ISTP)
              END-IF
              IF OSP-INSRATE(OILEV OISTP) NOT NUMERIC
                 MOVE 0                     TO SP-INSRATE(ILEV ISTP)
              ELSE
              MOVE OSP-INSRATE(OILEV OISTP) TO SP-INSRATE(ILEV ISTP)
              END-IF
             END-PERFORM

             IF OSP-INSMINPREM(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSMINPREM(ILEV)
             ELSE
             MOVE OSP-INSMINPREM  (OILEV)  TO SP-INSMINPREM  (ILEV)
             END-IF
             IF OSP-INSMINCHGABL(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSMINCHGABL(ILEV)
             ELSE
             MOVE OSP-INSMINCHGABL(OILEV)  TO SP-INSMINCHGABL(ILEV)
             END-IF
             IF OSP-INSMAXCHGABL(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSMAXCHGABL(ILEV)
             ELSE
             MOVE OSP-INSMAXCHGABL(OILEV)  TO SP-INSMAXCHGABL(ILEV)
             END-IF
             IF OSP-INSMAXBENIF(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSMAXBENIF(ILEV)
             ELSE
             MOVE OSP-INSMAXBENIF (OILEV)  TO SP-INSMAXBENIF (ILEV)
             END-IF
             IF OSP-INSMAXTERM(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSMAXTERM(ILEV)
             ELSE
             MOVE OSP-INSMAXTERM  (OILEV)  TO SP-INSMAXTERM  (ILEV)
             END-IF
             MOVE OSP-INSCHGBEN   (OILEV)  TO SP-INSCHGBEN   (ILEV)
             IF OSP-INSEXCEPT(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSEXCEPT(ILEV)
             ELSE
             MOVE OSP-INSEXCEPT   (OILEV)  TO SP-INSEXCEPT   (ILEV)
             END-IF
             IF OSP-INSNOVER(OILEV) NOT NUMERIC
                MOVE 0                     TO SP-INSNOVER(ILEV)
             ELSE
             MOVE OSP-INSNOVER    (OILEV)  TO SP-INSNOVER    (ILEV)
             END-IF

             PERFORM VARYING IVER FROM 1 BY 1 UNTIL IVER > 5
              SET OIVER                    TO IVER
              IF OSP-INSMINAGE(OILEV OIVER) NOT NUMERIC
                 MOVE 0                  TO SP-INSMINAGE(ILEV IVER)
              ELSE
              MOVE OSP-INSMINAGE(OILEV OIVER) TO
                                            SP-INSMINAGE(ILEV IVER)
              END-IF
              IF OSP-INSMAXAGE(OILEV OIVER) NOT NUMERIC
                 MOVE 0                  TO SP-INSMAXAGE(ILEV IVER)
              ELSE
              MOVE OSP-INSMAXAGE(OILEV OIVER) TO
                                            SP-INSMAXAGE(ILEV IVER)
              END-IF
              IF OSP-INSMAXCOV(OILEV OIVER) NOT NUMERIC
                 MOVE 0                  TO SP-INSMAXCOV(ILEV IVER)
              ELSE
              MOVE OSP-INSMAXCOV(OILEV OIVER) TO
                                            SP-INSMAXCOV(ILEV IVER)
              END-IF
              IF OSP-INSMAXTRM(OILEV OIVER) NOT NUMERIC
                 MOVE 0                  TO SP-INSMAXTRM(ILEV IVER)
              ELSE
              MOVE OSP-INSMAXTRM(OILEV OIVER) TO
                                            SP-INSMAXTRM(ILEV IVER)
              END-IF
             END-PERFORM

             MOVE OSP-INSFEECD    (OILEV)  TO SP-INSFEECD    (ILEV)
             MOVE OSP-INSFEE-FRMLA(OILEV)  TO SP-INSFEE-FRMLA(ILEV)
             MOVE OSP-INSCHGABL-FG(OILEV)  TO SP-INSCHGABL-FG(ILEV)
             MOVE OSP-INSREJECT-FG(OILEV)  TO SP-INSREJECT-FG(ILEV)
             MOVE OSP-INSFINCHG   (OILEV)  TO SP-INSFINCHG   (ILEV)

           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 12
               MOVE ZEROES                 TO SP-INSEARN-ORDER(S1)
           END-PERFORM.

           MOVE OSP-INSAH-JOINT-FG         TO SP-INSAH-JOINT-FG.
           MOVE OSP-INS-O1-EDIT            TO SP-INS-O1-EDIT.
           MOVE OSP-INS-O2-EDIT            TO SP-INS-O2-EDIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 16
             MOVE OSP-RBFRMLA     (S1)     TO SP-RBFRMLA     (S1)
              PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 2
                MOVE OSP-RBDTE     (S1 S2)  TO SP-RBDTE     (S1 S2)
                IF OSP-RBDAYS(S1 S2) NOT NUMERIC
                   MOVE 0                   TO SP-RBDAYS    (S1 S2)
                ELSE
                MOVE OSP-RBDAYS    (S1 S2)  TO SP-RBDAYS    (S1 S2)
                END-IF
                IF OSP-RBYRTYPE(S1 S2) NOT NUMERIC
                   MOVE 0                   TO SP-RBYRTYPE  (S1 S2)
                ELSE
                MOVE OSP-RBYRTYPE  (S1 S2)  TO SP-RBYRTYPE  (S1 S2)
                END-IF
              END-PERFORM
             IF OSP-RBMINRET(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBMINRET    (S1)
             ELSE
             MOVE OSP-RBMINRET    (S1)     TO SP-RBMINRET    (S1)
             END-IF
             IF OSP-RBNOMON(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBNOMON    (S1)
             ELSE
             MOVE OSP-RBNOMON     (S1)     TO SP-RBNOMON     (S1)
             END-IF
             IF OSP-RBDEDCHG(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBDEDCHG    (S1)
             ELSE
             MOVE OSP-RBDEDCHG    (S1)     TO SP-RBDEDCHG    (S1)
             END-IF
             IF OSP-RBRECAST(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBRECAST    (S1)
             ELSE
             MOVE OSP-RBRECAST    (S1)     TO SP-RBRECAST    (S1)
             END-IF
             IF OSP-RBEARLY(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBEARLY    (S1)
             ELSE
             MOVE OSP-RBEARLY     (S1)     TO SP-RBEARLY     (S1)
             END-IF
             IF OSP-RBDEFER(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBDEFER    (S1)
             ELSE
             MOVE OSP-RBDEFER     (S1)     TO SP-RBDEFER     (S1)
             END-IF
             IF OSP-RBPCT(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBPCT    (S1)
             ELSE
             MOVE OSP-RBPCT       (S1)     TO SP-RBPCT       (S1)
             END-IF
             IF OSP-RBREDUC(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBREDUC    (S1)
             ELSE
             MOVE OSP-RBREDUC     (S1)     TO SP-RBREDUC     (S1)
             END-IF
             IF OSP-RBMIN(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBMIN    (S1)
             ELSE
             MOVE OSP-RBMIN       (S1)     TO SP-RBMIN       (S1)
             END-IF
             IF OSP-RBSPOPT1(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBSPOPT1    (S1)
             ELSE
             MOVE OSP-RBSPOPT1    (S1)     TO SP-RBSPOPT1    (S1)
             END-IF
             IF OSP-RBSPOPT2(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBSPOPT2    (S1)
             ELSE
             MOVE OSP-RBSPOPT2    (S1)     TO SP-RBSPOPT2    (S1)
             END-IF
             IF OSP-RBMANAGER(S1) NOT NUMERIC
                MOVE 0                     TO SP-RBMANAGER    (S1)
             ELSE
             MOVE OSP-RBMANAGER   (S1)     TO SP-RBMANAGER   (S1)
             END-IF
             MOVE OSP-RBUNITPER-CD(S1)     TO SP-RBUNITPER-CD(S1)
             MOVE OSP-RBFRMLA2    (S1)     TO SP-RBFRMLA2    (S1)
           END-PERFORM.

           PERFORM VARYING S1 FROM 17 BY 1 UNTIL S1 > 22
             MOVE SPACES                   TO SP-RBFRMLA     (S1)
             PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 2
              MOVE SPACES                  TO SP-RBDTE      (S1 S2)
              MOVE ZEROES                  TO SP-RBDAYS     (S1 S2)
                                              SP-RBYRTYPE   (S1 S2)
             END-PERFORM
             MOVE ZEROES                   TO SP-RBMINRET    (S1)
                                              SP-RBNOMON     (S1)
                                              SP-RBDEDCHG    (S1)
                                              SP-RBRECAST    (S1)
                                              SP-RBEARLY     (S1)
                                              SP-RBDEFER     (S1)
                                              SP-RBPCT       (S1)
                                              SP-RBREDUC     (S1)
                                              SP-RBMIN       (S1)
                                              SP-RBSPOPT1    (S1)
                                              SP-RBSPOPT2    (S1)
                                              SP-RBMANAGER   (S1)
             MOVE SPACES                   TO SP-RBUNITPER-CD(S1)
                                              SP-RBFRMLA2    (S1)
           END-PERFORM.

           MOVE OSP-RBCOMCD                TO SP-RBCOMCD.

           MOVE OSP-ADDON-DISFRMLA         TO SP-ADDON-DISFRMLA.
           MOVE OSP-ADDON-WHOLE-FG         TO SP-ADDON-WHOLE-FG.
           MOVE OSP-ADDON-ORG-MATURITY     TO SP-ADDON-ORG-MATURITY.
           MOVE OSP-CONSOLIDATE-RT-FG      TO SP-CONSOLIDATE-RT-FG.
           IF OSP-1STPY-ADDON-DAYS NOT NUMERIC
              MOVE 0                       TO SP-1STPY-ADDON-DAYS
           ELSE
           MOVE OSP-1STPY-ADDON-DAYS       TO SP-1STPY-ADDON-DAYS.
           IF OSP-1STPY-ADDON-YRTYPE NOT NUMERIC
              MOVE 0                       TO SP-1STPY-ADDON-YRTYPE
           ELSE
           MOVE OSP-1STPY-ADDON-YRTYPE     TO SP-1STPY-ADDON-YRTYPE.
           MOVE OSP-ADDON-RATE-FG          TO SP-ADDON-RATE-FG.
           IF OSP-ADDON-RATE NOT NUMERIC
              MOVE 0                       TO SP-ADDON-RATE
           ELSE
           MOVE OSP-ADDON-RATE             TO SP-ADDON-RATE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
             MOVE OSP-FEEFRMLA(SUB)        TO SP-FEEFRMLA(SUB)
             MOVE OSP-FEECD   (SUB)        TO SP-FEECD   (SUB)
             MOVE OSP-FEEID   (SUB)        TO SP-FEEID   (SUB)
           END-PERFORM.

           MOVE OSP-ROUND-PAY-FG           TO SP-ROUND-PAY-FG.
           MOVE OSP-IRREGULAR-PAY-FG       TO SP-IRREGULAR-PAY-FG.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
             MOVE OSP-DLRVCHGS-RB-CD(SUB)  TO SP-DLRVCHGS-RB-CD(SUB)
           END-PERFORM.

           MOVE OSP-PARVHELD-RB-CD         TO SP-PARVHELD-RB-CD.
           MOVE OSP-PARVPAID-RB-CD         TO SP-PARVPAID-RB-CD.
           IF OSP-CONTR-CREDIT NOT NUMERIC
              MOVE 0                       TO SP-CONTR-CREDIT
           ELSE
           MOVE OSP-CONTR-CREDIT           TO SP-CONTR-CREDIT.
           MOVE OSP-CONTR-CREDIT-CD        TO SP-CONTR-CREDIT-CD.

           IF OSP-CONTR-CREDIT-MIN-DEL-PER NOT NUMERIC
              MOVE 0             TO SP-CONTR-CREDIT-MIN-DEL-PER
           ELSE
           MOVE OSP-CONTR-CREDIT-MIN-DEL-PER
                                 TO SP-CONTR-CREDIT-MIN-DEL-PER.
           MOVE OSP-OPT-CAL-CHGABLE        TO SP-OPT-CAL-CHGABLE.
           IF OSP-PBDEL-DAYS NOT NUMERIC
              MOVE 0                       TO SP-PBDEL-DAYS
           ELSE
           MOVE OSP-PBDEL-DAYS             TO SP-PBDEL-DAYS.
           IF OSP-PBINCR-PERCENT NOT NUMERIC
              MOVE 0                       TO SP-PBINCR-PERCENT
           ELSE
           MOVE OSP-PBINCR-PERCENT         TO SP-PBINCR-PERCENT.
           MOVE OSP-CPOT30-CD              TO SP-CPOT30-CD.
           MOVE OSP-CPOTCHGOFF-CD          TO SP-CPOTCHGOFF-CD.
           MOVE OSP-RDPOT30-CD             TO SP-RDPOT30-CD.
           MOVE OSP-RDPOTCHGOFF-CD         TO SP-RDPOTCHGOFF-CD.
           IF OSP-MAX-ALLOW-DELINQ NOT NUMERIC
              MOVE 0                       TO SP-MAX-ALLOW-DELINQ
           ELSE
              MOVE OSP-MAX-ALLOW-DELINQ    TO SP-MAX-ALLOW-DELINQ.
           MOVE OSP-RESCIND-BUS-DAYS       TO SP-RESCIND-BUS-DAYS.
           MOVE OSP-RESCIND-SATURDAY       TO SP-RESCIND-SATURDAY.

           IF OSP-MIN-CREDIT-SCORE NOT NUMERIC
              MOVE 0                       TO SP-MIN-CREDIT-SCORE
           ELSE
           MOVE OSP-MIN-CREDIT-SCORE       TO SP-MIN-CREDIT-SCORE.
           MOVE OSP-DUAL-IN-BRANCH         TO SP-DUAL-IN-BRANCH.
           MOVE OSP-DUAL-IN-STATE          TO SP-DUAL-IN-STATE.
           MOVE OSP-PACESETTER-FG          TO SP-PACESETTER-FG.
           IF OSP-WAGE-ASSIGN-DAYS NOT NUMERIC
              MOVE 0                       TO SP-WAGE-ASSIGN-DAYS
           ELSE
           MOVE OSP-WAGE-ASSIGN-DAYS       TO SP-WAGE-ASSIGN-DAYS.
           MOVE OSP-CAL-PAYMENT-ROUND-FG   TO SP-CAL-PAYMENT-ROUND-FG.
           MOVE OSP-CAN-LOANS-FG           TO SP-CAN-LOANS-FG.
           MOVE OSP-ALLOW-DELINQ-POLCD     TO SP-ALLOW-DELINQ-POLCD.
           IF OSP-YTD-MAX-ALLOW-DELINQ NOT NUMERIC
              MOVE 0                     TO SP-YTD-MAX-ALLOW-DELINQ
           ELSE
              MOVE OSP-YTD-MAX-ALLOW-DELINQ
                                         TO SP-YTD-MAX-ALLOW-DELINQ.
 
           MOVE OSP-LNCOST-FRMLA           TO SP-LNCOST-FRMLA.
           IF OSP-LNCOST-AMT NOT NUMERIC
              MOVE 0                       TO SP-LNCOST-AMT
           ELSE
           MOVE OSP-LNCOST-AMT             TO SP-LNCOST-AMT.
           IF OSP-DLDISC-RVPRIN1-PCNT NOT NUMERIC
              MOVE 0                       TO SP-DLDISC-RVPRIN1-PCNT
           ELSE
           MOVE OSP-DLDISC-RVPRIN1-PCNT    TO SP-DLDISC-RVPRIN1-PCNT.

           IF OSP-RENEWABLE-PAYS NOT NUMERIC
              MOVE 0                       TO SP-RENEWABLE-PAYS
           ELSE
           MOVE OSP-RENEWABLE-PAYS         TO SP-RENEWABLE-PAYS.
           IF OSP-RENEWABLE-DAYS NOT NUMERIC
              MOVE 0                       TO SP-RENEWABLE-DAYS
           ELSE
           MOVE OSP-RENEWABLE-DAYS         TO SP-RENEWABLE-DAYS.
           MOVE OSP-ALLOW-LN-BACK-DATE     TO SP-ALLOW-LN-BACK-DATE.
           IF OSP-DLDISC-RVPRIN1-AF-PCNT NOT NUMERIC
              MOVE 0                TO SP-DLDISC-RVPRIN1-AF-PCNT
           ELSE
           MOVE OSP-DLDISC-RVPRIN1-AF-PCNT
                                    TO SP-DLDISC-RVPRIN1-AF-PCNT.
           MOVE OSP-CAL-MAX-AT-ESTIMATE    TO SP-CAL-MAX-AT-ESTIMATE.

           MOVE OSP-INSAH-RETRO            TO SP-INSAH-RETRO.
           MOVE OSP-INSAH-DAYS-WAIT        TO SP-INSAH-DAYS-WAIT.
           MOVE OSP-ADDON-EXCEPT-FG        TO SP-ADDON-EXCEPT-FG.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
             MOVE OSP-REPO-TRCD  (S1)      TO SP-REPO-TRCD(S1)
             PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 4
               IF OSP-REPO-FMNO(S1 S2) NOT NUMERIC
                  MOVE 0                   TO SP-REPO-FMNO(S1 S2)
               ELSE
               MOVE OSP-REPO-FMNO(S1 S2)   TO SP-REPO-FMNO(S1 S2)
               END-IF
             END-PERFORM
           END-PERFORM.

           MOVE OSP-CANCEL-ADDON-FG        TO SP-CANCEL-ADDON-FG.
           IF OSP-DEFAULT-O2-INS-COMP NOT NUMERIC
              MOVE 0                    TO SP-DEFAULT-O2-INS-COMP
           ELSE
              MOVE OSP-DEFAULT-O2-INS-COMP TO
                                           SP-DEFAULT-O2-INS-COMP.
           MOVE OSP-LC-ON-JUDGEMENTS       TO SP-LC-ON-JUDGEMENTS.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * MOVING OSP-DELQ-IB-AGE TO SP-DELQ-IB-AGE/OSP-DELQ-IB-MAX-DAY TO
      * SP-DELQ-IB-MAX-DAYS CAUSED A DESCREPANCY WHEN RUNNING THE ACCRUAL.

      * THE PROBLEM WAS THE FOLLOWING(THIS IS A15 ACCRUAL TEST)
      *    IF SP-DELQ-IB-AGE-ALP NOT = " "
      *       IF SP-DELQ-IB-AGE NOT = 0
      *          MOVE MONTH-END TO AGEING-DATE
      *          PERFORM COMPUTE-CONTRACTUAL
      *          IF CONTRACTUAL >= SP-DELQ-IB-AGE
      *            MOVE SP-DELQ-IB-MAX-DAYS TO SP-MAX-IB-ACR-DAYS
      *A15 SP-DELQ-IB-AGE-ALP WAS SPACES SO THIS TEST GOT SKIPPED, IN A30
      *THE VALUE OF SP-DELQ-IB-AGE-ALP WAS "O SO THIS GOT EXECUTED SETTING
      *SP-DELQ-IB-MAX-DAYS(224) TO SP-MAX-IB-ACR-DAYS. NOT SURE IF THIS COULD
      *HAVE AN IMPACT OR NOT, BUT A15 SP-DELQ-IB-AGE IS COMP AND A30 IS COMP-3

      *    MOVE OSP-DELQ-IB-AGE            TO SP-DELQ-IB-AGE.
      *    MOVE OSP-DELQ-IB-MAX-DAYS       TO SP-DELQ-IB-MAX-DAYS.

      *SP-DELQ-IB-AGE MUST BE DIVISIBLE BY 30 SO IF ITS NOT, ITS INVALID

      *THIS IS WHAT I CHANGED AS FAR AS SP-DELQ-IB-AGE,SP-DELQ-IB-MAX-DAYS

           MOVE 0                          TO DELQ-IB-MAX-DAYS-REM
                                              TEST-DELQ-IB-AGE.

           IF OSP-DELQ-IB-AGE NOT NUMERIC
              MOVE 0 TO SP-DELQ-IB-AGE TEST-DELQ-IB-AGE
           ELSE
              MOVE OSP-DELQ-IB-AGE TO TEST-DELQ-IB-AGE.
           IF TEST-DELQ-IB-AGE NOT = 0
              DIVIDE TEST-DELQ-IB-AGE BY 30 GIVING TEST-DELQ-IB-AGE    
                                   REMAINDER DELQ-IB-MAX-DAYS-REM
           ELSE
              MOVE 1 TO DELQ-IB-MAX-DAYS-REM.
           IF DELQ-IB-MAX-DAYS-REM NOT = 0
               MOVE 0 TO SP-DELQ-IB-AGE 
               MOVE 0 TO SP-DELQ-IB-MAX-DAYS 
           ELSE
               MOVE OSP-DELQ-IB-AGE      TO SP-DELQ-IB-AGE
               IF OSP-DELQ-IB-MAX-DAYS NOT NUMERIC
                   MOVE 0 TO SP-DELQ-IB-MAX-DAYS
               ELSE
                MOVE OSP-DELQ-IB-MAX-DAYS TO SP-DELQ-IB-MAX-DAYS.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OSP-INSURANCE-WRITTEN      TO SP-INSURANCE-WRITTEN.
           MOVE OSP-INTERIM-COUPON         TO SP-INTERIM-COUPON.
           MOVE OSP-AUTO-ASSESS-LCHG       TO SP-AUTO-ASSESS-LCHG.
      *BOB AT WORLD FOUND 202020 IN SPR'S.
           IF (OSP-MAX-CASH-PROCEEDS NOT NUMERIC) OR
              (OSP-MAX-CASH-PROCEEDS = 202020.20 OR 020202.02)
              MOVE 999999.99              TO SP-MAX-CASH-PROCEEDS
           ELSE                    
              MOVE OSP-MAX-CASH-PROCEEDS  TO SP-MAX-CASH-PROCEEDS.
            
           MOVE OSP-ALLOW-ZERO-PROC        TO SP-ALLOW-ZERO-PROC.
           IF OSP-BANKRULE-RATE NOT NUMERIC
              MOVE 0                       TO SP-BANKRULE-RATE
           ELSE
           MOVE OSP-BANKRULE-RATE          TO SP-BANKRULE-RATE.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 2
             MOVE OSP-AUTO-SEND-TRCD (S1)  TO SP-AUTO-SEND-TRCD(S1)
             PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 4
                IF OSP-AUTO-SEND-FMNO(S1 S2) NOT NUMERIC
                   MOVE 0              TO SP-AUTO-SEND-FMNO(S1 S2)
                ELSE
                   MOVE OSP-AUTO-SEND-FMNO(S1 S2)
                                       TO SP-AUTO-SEND-FMNO(S1 S2)
                END-IF
             END-PERFORM
           END-PERFORM.

           IF OSP-DLDISC-CONV-BF-PCNT NOT NUMERIC
              MOVE 0                    TO SP-DLDISC-CONV-BF-PCNT
           ELSE
           MOVE OSP-DLDISC-CONV-BF-PCNT TO SP-DLDISC-CONV-BF-PCNT.
           MOVE OSP-UNITPER-CD             TO SP-UNITPER-CD.
           MOVE OSP-RENEWAL-EDIT           TO SP-RENEWAL-EDIT.
           MOVE OSP-ROUND-MFEE             TO SP-ROUND-MFEE.
           MOVE OSP-ADV-TO-1ST-NO-CORR     TO SP-ADV-TO-1ST-NO-CORR.
           MOVE OSP-LC-INT-ON-REPO-NON-PL  TO SP-LC-INT-ON-REPO-NON-PL.
      *----BOB FOUND THESE IN A15 WITH 20
      *SP-CONTRACTUAL-SET-NON-ACCRUAL,SP-CONTRACTUAL-RESET-ACCRUAL
      *SP-MONTHS-PAY-NAPP-COUNTER. THESE ARE FIELDS ADDED FOR 
      *REGIONAL ACCEPT AND THE LR TRIAD WAS UPDATED VIA A 
      *CL/RAC347 PROCESS IN THE MONTHLY ACCRUAL
      *REGACC SHOULD HAVE RUN FX/FIXSP7 TO SET THESE FIELDS
      *TEST ON 20 OR 02 FAILED SO CHANGED TO CHECK IF NOT REGACC
      *WHO SHOULD HAVE RAN FIXSP7 TO SET FIELDS IN TRIAD LR
      *THIS FIELD IS 9(3) BUT THE VALUE WAS SPACE FOLLOWED BY 20
           MOVE 0   TO TEST-DIVIDE-BY-30 
                       TEST-DIVIDE-BY-30-REM.
           IF (OSP-CONTRACTUAL-SET-NONACCRUAL NOT NUMERIC) OR
                 (OSP-CONTRACTUAL-SET-NONACCRUAL = 0)
              MOVE 0 TO SP-CONTRACTUAL-SET-NONACCRUAL
           ELSE
              DIVIDE OSP-CONTRACTUAL-SET-NONACCRUAL BY 30
                  GIVING TEST-DIVIDE-BY-30,
                        REMAINDER TEST-DIVIDE-BY-30-REM 
                  IF TEST-DIVIDE-BY-30-REM NOT = 0
                     MOVE 0 TO SP-CONTRACTUAL-SET-NONACCRUAL
                  ELSE
                     MOVE OSP-CONTRACTUAL-SET-NONACCRUAL
                            TO SP-CONTRACTUAL-SET-NONACCRUAL.

      *TEST ON 20 OR 02 FAILED SO CHANGED TO CHECK IF NOT REGACC
      *WHO SHOULD HAVE RAN FIXSP7 TO SET FIELDS IN TRIAD LA
            MOVE 0   TO TEST-DIVIDE-BY-30 
                        TEST-DIVIDE-BY-30-REM.
           IF (OSP-CONTRACTUAL-RESET-ACCRUAL NOT NUMERIC) OR
                 (OSP-CONTRACTUAL-RESET-ACCRUAL = 0)
              MOVE 0 TO SP-CONTRACTUAL-RESET-ACCRUAL
           ELSE
              DIVIDE OSP-CONTRACTUAL-RESET-ACCRUAL BY 30
                                   GIVING TEST-DIVIDE-BY-30
                           REMAINDER TEST-DIVIDE-BY-30-REM  
              IF TEST-DIVIDE-BY-30-REM NOT = 0                     
                  MOVE 0 TO SP-CONTRACTUAL-RESET-ACCRUAL    
              ELSE
                  MOVE OSP-CONTRACTUAL-RESET-ACCRUAL 
                           TO SP-CONTRACTUAL-RESET-ACCRUAL.


           IF (OSP-MONTHS-PAY-NAPP-COUNTER = 20 OR 02) OR
               (OSP-MONTHS-PAY-NAPP-COUNTER NOT NUMERIC)
              MOVE 0 TO SP-MONTHS-PAY-NAPP-COUNTER
           ELSE
              MOVE OSP-MONTHS-PAY-NAPP-COUNTER
                         TO  SP-MONTHS-PAY-NAPP-COUNTER.

           IF OSP-SHORT-PAY-THRESHOLD NOT NUMERIC
              MOVE 0               TO SP-SHORT-PAY-THRESHOLD
            ELSE
              MOVE OSP-SHORT-PAY-THRESHOLD TO
                                      SP-SHORT-PAY-THRESHOLD.
           IF OSP-CASH-AVAIL-PERCENT NOT NUMERIC
              MOVE 0                TO SP-CASH-AVAIL-PERCENT
           ELSE
              MOVE OSP-CASH-AVAIL-PERCENT TO
                                       SP-CASH-AVAIL-PERCENT.

           MOVE OSP-O1-JOINT-FG            TO SP-O1-JOINT-FG.
           
           IF (OSP-NET-BAL-REQ = 202 OR 020) OR
                   OSP-NET-BAL-REQ NOT NUMERIC
              MOVE 0                      TO SP-NET-BAL-REQ
           ELSE
              MOVE OSP-NET-BAL-REQ        TO SP-NET-BAL-REQ.

           IF OSP-AMT-PROCEEDS-REQ NOT NUMERIC
              MOVE 0                      TO SP-AMT-PROCEEDS-REQ
           ELSE
              MOVE OSP-AMT-PROCEEDS-REQ   TO SP-AMT-PROCEEDS-REQ.

           IF OSP-ALT-PREPAY-MONTHS NOT NUMERIC
              MOVE 0                      TO SP-ALT-PREPAY-MONTHS
           ELSE
              MOVE OSP-ALT-PREPAY-MONTHS  TO SP-ALT-PREPAY-MONTHS.

           IF OSP-PERCENT-REGPAY-AVAIL NOT NUMERIC
              MOVE 0                   TO SP-PERCENT-REGPAY-AVAIL
           ELSE
              MOVE OSP-PERCENT-REGPAY-AVAIL 
                                       TO  SP-PERCENT-REGPAY-AVAIL.
           MOVE OSP-NON-LOAN-FLAG         TO SP-NON-LOAN-FLAG.
           MOVE OSP-SKIP-TRW              TO SP-SKIP-TRW.


       UPGRADE-FILE-SP-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - S S
      *
      ******************************************************************
       UPGRADE-FILE-SS SECTION.

           PERFORM CLEAR-SS-FILE.
     
           MOVE OSS-DATE  TO SS-DATE-YYYYMM.
           MOVE OSS-BRNO  TO SS-BRNO.
           MOVE OSS-CLASS TO SS-CLASS.

           PERFORM VARYING S3 FROM 1 BY 1 UNTIL S3 > 5
             AFTER S2 FROM 1 BY 1 UNTIL S2 > 2
              AFTER S1 FROM 1 BY 1 UNTIL S1 > 8
                IF OSS-UNITS(S1 S2 S3) NOT NUMERIC
                   MOVE 0                TO SS-UNITS(S1 S2 S3)
                ELSE
                MOVE OSS-UNITS(S1 S2 S3) TO SS-UNITS(S1 S2 S3)
                END-IF
                IF OSS-OUTBAL(S1 S2 S3) NOT NUMERIC
                   MOVE 0                 TO SS-OUTBAL(S1 S2 S3)
                ELSE
                MOVE OSS-OUTBAL(S1 S2 S3) TO SS-OUTBAL(S1 S2 S3)
                END-IF
                IF S3 < 3
                   IF OSS-NO-PL(S1 S2 S3) NOT NUMERIC
                      MOVE 0                 TO SS-NO-PL(S1 S2 S3)
                   ELSE
                   MOVE OSS-NO-PL(S1 S2 S3)  TO SS-NO-PL(S1 S2 S3)
                   END-IF
                   IF OSS-AMT-PL(S1 S2 S3) NOT NUMERIC
                      MOVE 0                 TO SS-AMT-PL(S1 S2 S3)
                   ELSE
                   MOVE OSS-AMT-PL(S1 S2 S3) TO SS-AMT-PL(S1 S2 S3)
                   END-IF
                END-IF
           END-PERFORM.


       UPGRADE-FILE-SS-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - S T
      *
      ******************************************************************
       UPGRADE-FILE-ST SECTION.

           PERFORM CLEAR-ST-FILE.

           MOVE OST-CODE                   TO ST-CODE.
           MOVE OST-DESC                   TO ST-DESC.
           MOVE OST-REINSTATE-WINDOW       TO ST-REINSTATE-WINDOW.
           MOVE OST-REPO-RENOTICE          TO ST-REPO-RENOTICE.
           MOVE OST-TITLE-RELEASE-TYPE     TO ST-TITLE-RELEASE-TYPE.
           MOVE OST-AUCTION-DATE-REQ       TO ST-AUCTION-DATE-REQ.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ MERGE SU-REC }
           IF ( OSU-RECORD-STAT-BAD )
              GO TO UPGRADE-FILE-ST-EXIT.

           IF OSU-GEOGRAPHIC-CODEX NUMERIC
              MOVE OSU-GEOGRAPHIC-CODE     TO ST-GEOGRAPHIC-CODE.
           MOVE OSU-MAX-LOAN-AVAIL         TO ST-MAX-LOAN-AVAIL.
           MOVE OSU-MAX-TAX-LOAN-AMT       TO ST-MAX-TAX-LOAN-AMT.
           MOVE OSU-NSF-FEE-AMT            TO ST-NSF-FEE-AMT.

      *=================================================================
       UPGRADE-FILE-ST-EXIT.
           EXIT.


      ******************************************************************
      *
      *    U P G R A D E - F I L E - T R W I N F O
      *
      ******************************************************************
       UPGRADE-FILE-TRWINFO SECTION.

           MOVE SPACES TO TRW-INFO-REC.

           MOVE 0      TO TRW-INFO-REPORTER-PHONE
                          TRW-YEARS-STOP-REPORTING.

           MOVE OTRW-INFO-ID            TO TRW-INFO-ID.
           MOVE OTRW-INFO-EQUIFAX-ID    TO TRW-INFO-EQUIFAX-ID.
           MOVE OTRW-INFO-EXPERIAN-ID   TO TRW-INFO-EXPERIAN-ID.
           MOVE OTRW-INFO-TUC-ID        TO TRW-INFO-TUC-ID.

           MOVE OTRW-INFO-REPORTER-NAME    TO TRW-INFO-REPORTER-NAME.
           MOVE OTRW-INFO-REPORTER-ADDRESS TO TRW-INFO-REPORTER-ADDRESS.
           MOVE OTRW-INFO-REPORTER-PHONE   TO TRW-INFO-REPORTER-PHONE.

           MOVE OTRW-INFO-GRANTOR-CODE    TO TRW-INFO-GRANTOR-CODE.
           MOVE OTRW-INFO-CR-LF           TO TRW-INFO-CR-LF.
           MOVE OTRW-INFO-BRNO-ACCTNO     TO TRW-INFO-BRNO-ACCTNO.
           MOVE OTRW-INFO-IDENT-BRNO      TO TRW-INFO-IDENT-BRNO.
           MOVE OTRW-YEARS-STOP-REPORTING TO TRW-YEARS-STOP-REPORTING.
           MOVE OTRW-INVALID-SSNO         TO TRW-INVALID-SSNO.
           MOVE OTRW-INFO-SCHED-PAY       TO TRW-INFO-SCHED-PAY.
           MOVE OTRW-INFO-INNOVIS-ID      TO TRW-INFO-INNOVIS-ID.

       UPGRADE-FILE-TRWINFO-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - T Z
      *
      ******************************************************************
       UPGRADE-FILE-TZ SECTION.

           PERFORM CLEAR-TZ-FILE.

           MOVE OTZ-CODE           TO TZ-CODE.
           MOVE OTZ-PREFIX         TO TZ-PREFIX.
           MOVE OTZ-STATE          TO TZ-STATE.
           MOVE OTZ-DESC           TO TZ-DESC.
           MOVE OTZ-ZONE           TO TZ-ZONE.
           IF OTZ-FACTOR NOT NUMERIC
              MOVE 0               TO TZ-FACTOR
           ELSE
              MOVE OTZ-FACTOR      TO TZ-FACTOR.
           MOVE OTZ-DLS            TO TZ-DLS.
           MOVE 0                  TO TZ-LTOUCH-DATE.

       UPGRADE-FILE-TZ-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - W R
      *
      ******************************************************************
       UPGRADE-FILE-WR SECTION.
       
           IF FILE-OPTION-WR = "A"
              PERFORM CLEAR-AWR-FILE
           ELSE
              PERFORM CLEAR-WR-FILE.

           MOVE OWR-YYYYMM    TO WR-YYYYMM  AWR-YYYYMM.
           MOVE OWR-BRNO      TO WR-BRNO    AWR-BRNO.

           MOVE 0                     TO WR-LTOUCH-DATE
                                        AWR-LTOUCH-DATE.
           IF OWR-CUR-NO-CUST NOT NUMERIC
              MOVE 0                  TO WR-CUR-NO-CUST
                                        AWR-CUR-NO-CUST
           ELSE
           MOVE OWR-CUR-NO-CUST       TO WR-CUR-NO-CUST
                                        AWR-CUR-NO-CUST.
           IF OWR-ELM-NO-CUST NOT NUMERIC
              MOVE 0                  TO WR-ELM-NO-CUST
                                        AWR-ELM-NO-CUST
           ELSE
           MOVE OWR-ELM-NO-CUST       TO WR-ELM-NO-CUST
                                        AWR-ELM-NO-CUST.
           IF OWR-ELY-NO-CUST NOT NUMERIC
              MOVE 0                  TO WR-ELY-NO-CUST
                                        AWR-ELY-NO-CUST
           ELSE
           MOVE OWR-ELY-NO-CUST       TO WR-ELY-NO-CUST
                                        AWR-ELY-NO-CUST.
           IF OWR-OUTS-BALANCE NOT NUMERIC
              MOVE 0                  TO WR-OUTS-BALANCE
                                        AWR-OUTS-BALANCE
           ELSE
           MOVE OWR-OUTS-BALANCE      TO WR-OUTS-BALANCE
                                        AWR-OUTS-BALANCE.
           IF OWR-ELM-OUTS-BALANCE NOT NUMERIC
              MOVE 0                  TO WR-ELM-OUTS-BALANCE
                                        AWR-ELM-OUTS-BALANCE
           ELSE
           MOVE OWR-ELM-OUTS-BALANCE  TO WR-ELM-OUTS-BALANCE
                                        AWR-ELM-OUTS-BALANCE.
           IF OWR-ELY-OUTS-BALANCE NOT NUMERIC
              MOVE 0                  TO WR-ELY-OUTS-BALANCE
                                        AWR-ELY-OUTS-BALANCE
           ELSE
           MOVE OWR-ELY-OUTS-BALANCE  TO WR-ELY-OUTS-BALANCE
                                        AWR-ELY-OUTS-BALANCE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              IF OWR-NO-NB(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-NB(SUB)
                                           AWR-NO-NB(SUB)
              ELSE
              MOVE OWR-NO-NB(SUB)        TO WR-NO-NB(SUB) 
                                           AWR-NO-NB(SUB)
              END-IF

              IF OWR-NO-FB(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-FB(SUB)
                                           AWR-NO-FB(SUB)
              ELSE
              MOVE OWR-NO-FB(SUB)        TO WR-NO-FB(SUB) 
                                           AWR-NO-FB(SUB)
              END-IF

              IF OWR-NO-PB(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-PB(SUB)
                                           AWR-NO-PB(SUB)
              ELSE
              MOVE OWR-NO-PB(SUB)        TO WR-NO-PB(SUB) 
                                           AWR-NO-PB(SUB)
              END-IF

              IF OWR-GROSS-VOLUME(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-GROSS-VOLUME(SUB)
                                           AWR-GROSS-VOLUME(SUB)
              ELSE
              MOVE OWR-GROSS-VOLUME(SUB) TO WR-GROSS-VOLUME(SUB) 
                                           AWR-GROSS-VOLUME(SUB)
              END-IF

              IF OWR-BSR-BONUS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-BSR-BONUS(SUB)
                                           AWR-BSR-BONUS(SUB)
              ELSE
              MOVE OWR-BSR-BONUS(SUB)    TO WR-BSR-BONUS(SUB) 
                                           AWR-BSR-BONUS(SUB)
              END-IF

              IF OWR-INTEREST-ALLOCATION(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-INTEREST-ALLOCATION(SUB)
                                           AWR-INTEREST-ALLOCATION(SUB)
              ELSE
              MOVE OWR-INTEREST-ALLOCATION(SUB)
                                         TO WR-INTEREST-ALLOCATION(SUB) 
                                           AWR-INTEREST-ALLOCATION(SUB)
              END-IF

              IF OWR-OLD-SUPERVISION(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-OLD-SUPERVISION(SUB)
                                           AWR-OLD-SUPERVISION(SUB)
              ELSE
                 MOVE OWR-OLD-SUPERVISION(SUB) 
                                         TO WR-OLD-SUPERVISION(SUB) 
                                           AWR-OLD-SUPERVISION(SUB)
              END-IF

              IF OWR-GEN-RESERVE-ADJ(SUB) NOT NUMERIC
                 MOVE 0                      TO WR-GEN-RESERVE-ADJ(SUB)
                                               AWR-GEN-RESERVE-ADJ(SUB)
              ELSE
              MOVE OWR-GEN-RESERVE-ADJ(SUB)  TO WR-GEN-RESERVE-ADJ(SUB) 
                                               AWR-GEN-RESERVE-ADJ(SUB)
              END-IF

              IF OWR-INTANGIBLE-AMORT(SUB) NOT NUMERIC
                 MOVE 0                      TO WR-INTANGIBLE-AMORT(SUB)
                                               AWR-INTANGIBLE-AMORT(SUB)
              ELSE
              MOVE OWR-INTANGIBLE-AMORT(SUB) TO WR-INTANGIBLE-AMORT(SUB)
                                               AWR-INTANGIBLE-AMORT(SUB)
              END-IF

              IF OWR-ROBBERIES(SUB) NOT NUMERIC
                 MOVE 0                      TO WR-ROBBERIES(SUB)
                                               AWR-ROBBERIES(SUB)
              ELSE
              MOVE OWR-ROBBERIES(SUB)        TO WR-ROBBERIES(SUB) 
                                               AWR-ROBBERIES(SUB)
              END-IF

              IF OWR-RATING-SHEET-INCOME(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-RATING-SHEET-INCOME(SUB)
                                          AWR-RATING-SHEET-INCOME(SUB)
              ELSE
              MOVE OWR-RATING-SHEET-INCOME(SUB)
                                        TO WR-RATING-SHEET-INCOME(SUB) 
                                          AWR-RATING-SHEET-INCOME(SUB)
              END-IF

              IF OWR-INT-FEE-INCOME(SUB) NOT NUMERIC
                 MOVE 0                     TO WR-INT-FEE-INCOME(SUB)
                                              AWR-INT-FEE-INCOME(SUB)
              ELSE
              MOVE OWR-INT-FEE-INCOME(SUB)  TO WR-INT-FEE-INCOME(SUB) 
                                              AWR-INT-FEE-INCOME(SUB)
              END-IF

              IF OWR-INSURANCE-INCOME(SUB) NOT NUMERIC
                 MOVE 0                     TO WR-INSURANCE-INCOME(SUB)
                                              AWR-INSURANCE-INCOME(SUB)
              ELSE
              MOVE OWR-INSURANCE-INCOME(SUB) TO WR-INSURANCE-INCOME(SUB)
                                               AWR-INSURANCE-INCOME(SUB)
              END-IF

              IF OWR-RATING-SHEET-EXPENSES(SUB) NOT NUMERIC
                 MOVE 0              TO WR-RATING-SHEET-EXPENSES(SUB)
                                       AWR-RATING-SHEET-EXPENSES(SUB)
              ELSE
              MOVE OWR-RATING-SHEET-EXPENSES(SUB) 
                                     TO WR-RATING-SHEET-EXPENSES(SUB) 
                                       AWR-RATING-SHEET-EXPENSES(SUB)
              END-IF

              IF OWR-PERSONNEL-EXPENSE(SUB) NOT NUMERIC
                 MOVE 0              TO WR-PERSONNEL-EXPENSE(SUB)
                                       AWR-PERSONNEL-EXPENSE(SUB)
              ELSE
              MOVE OWR-PERSONNEL-EXPENSE(SUB)
                                     TO WR-PERSONNEL-EXPENSE(SUB) 
                                       AWR-PERSONNEL-EXPENSE(SUB)
              END-IF

              IF OWR-CHARGEOFF-EXPENSE(SUB) NOT NUMERIC
                 MOVE 0              TO WR-CHARGEOFF-EXPENSE(SUB)
                                       AWR-CHARGEOFF-EXPENSE(SUB)
              ELSE
              MOVE OWR-CHARGEOFF-EXPENSE(SUB)
                                      TO WR-CHARGEOFF-EXPENSE(SUB) 
                                        AWR-CHARGEOFF-EXPENSE(SUB)
              END-IF

              IF OWR-NO-CHARGEOFFS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NO-CHARGEOFFS(SUB)
                                            AWR-NO-CHARGEOFFS(SUB)
              ELSE
              MOVE OWR-NO-CHARGEOFFS(SUB) TO WR-NO-CHARGEOFFS(SUB) 
                                            AWR-NO-CHARGEOFFS(SUB)
              END-IF

              IF OWR-RECOVERY-INCOME(SUB) NOT NUMERIC
                 MOVE 0                     TO WR-RECOVERY-INCOME(SUB)
                                              AWR-RECOVERY-INCOME(SUB)
              ELSE
              MOVE OWR-RECOVERY-INCOME(SUB) TO WR-RECOVERY-INCOME(SUB)
                                              AWR-RECOVERY-INCOME(SUB)
              END-IF

              IF OWR-BAD-DEBT-INCREASE(SUB) NOT NUMERIC
                 MOVE 0                     TO WR-BAD-DEBT-INCREASE(SUB)
                                              AWR-BAD-DEBT-INCREASE(SUB)
              ELSE
              MOVE OWR-BAD-DEBT-INCREASE(SUB) 
                                          TO WR-BAD-DEBT-INCREASE(SUB) 
                                            AWR-BAD-DEBT-INCREASE(SUB)
              END-IF
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF OWR-NO-30-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-NO-30-DAY-ACCTS
                                          AWR-NO-30-DAY-ACCTS
           ELSE
           MOVE OWR-NO-30-DAY-ACCTS     TO WR-NO-30-DAY-ACCTS
                                          AWR-NO-30-DAY-ACCTS.
           IF OWR-AMT-30-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-AMT-30-DAY-ACCTS
                                          AWR-AMT-30-DAY-ACCTS
           ELSE
           MOVE OWR-AMT-30-DAY-ACCTS    TO WR-AMT-30-DAY-ACCTS
                                          AWR-AMT-30-DAY-ACCTS.
           IF OWR-NO-60-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-NO-60-DAY-ACCTS
                                          AWR-NO-60-DAY-ACCTS
           ELSE
           MOVE OWR-NO-60-DAY-ACCTS     TO WR-NO-60-DAY-ACCTS
                                          AWR-NO-60-DAY-ACCTS.
           IF OWR-AMT-60-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-AMT-60-DAY-ACCTS
                                          AWR-AMT-60-DAY-ACCTS
           ELSE
           MOVE OWR-AMT-60-DAY-ACCTS    TO WR-AMT-60-DAY-ACCTS
                                          AWR-AMT-60-DAY-ACCTS.
           IF OWR-NO-90-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-NO-90-DAY-ACCTS
                                          AWR-NO-90-DAY-ACCTS
           ELSE
           MOVE OWR-NO-90-DAY-ACCTS     TO WR-NO-90-DAY-ACCTS
                                          AWR-NO-90-DAY-ACCTS.
           IF OWR-AMT-90-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-AMT-90-DAY-ACCTS
                                          AWR-AMT-90-DAY-ACCTS
           ELSE
           MOVE OWR-AMT-90-DAY-ACCTS    TO WR-AMT-90-DAY-ACCTS
                                          AWR-AMT-90-DAY-ACCTS.
           IF OWR-ELM-AMT-90-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-ELM-AMT-90-DAY-ACCTS
                                          AWR-ELM-AMT-90-DAY-ACCTS
           ELSE
           MOVE OWR-ELM-AMT-90-DAY-ACCTS
                                        TO WR-ELM-AMT-90-DAY-ACCTS
                                          AWR-ELM-AMT-90-DAY-ACCTS.
           IF OWR-ELY-AMT-90-DAY-ACCTS NOT NUMERIC
              MOVE 0                    TO WR-ELY-AMT-90-DAY-ACCTS
                                          AWR-ELY-AMT-90-DAY-ACCTS
           ELSE
              MOVE OWR-ELY-AMT-90-DAY-ACCTS 
                                        TO WR-ELY-AMT-90-DAY-ACCTS
                                          AWR-ELY-AMT-90-DAY-ACCTS.

           IF OWR-YTD-PCT-TURNOVER NOT NUMERIC
              MOVE 0                    TO WR-YTD-PCT-TURNOVER
                                          AWR-YTD-PCT-TURNOVER
           ELSE
           MOVE OWR-YTD-PCT-TURNOVER    TO WR-YTD-PCT-TURNOVER
                                          AWR-YTD-PCT-TURNOVER.

           IF OWR-YTD-PCT-RATE-SHT-PROFIT NOT NUMERIC
              MOVE 0                  TO WR-YTD-PCT-RATE-SHT-PROFIT
                                        AWR-YTD-PCT-RATE-SHT-PROFIT
           ELSE
           MOVE OWR-YTD-PCT-RATE-SHT-PROFIT 
                                      TO WR-YTD-PCT-RATE-SHT-PROFIT
                                        AWR-YTD-PCT-RATE-SHT-PROFIT.

           IF OWR-YTD-PCT-RS-INC-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-RS-INC-LEDGER
                                         AWR-YTD-PCT-RS-INC-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-RS-INC-LEDGER
                                       TO WR-YTD-PCT-RS-INC-LEDGER
                                         AWR-YTD-PCT-RS-INC-LEDGER.

           IF OWR-YTD-PCT-INT-FEE-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-INT-FEE-LEDGER
                                         AWR-YTD-PCT-INT-FEE-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-INT-FEE-LEDGER
                                       TO WR-YTD-PCT-INT-FEE-LEDGER
                                         AWR-YTD-PCT-INT-FEE-LEDGER.

           IF OWR-YTD-PCT-INS-INC-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-INS-INC-LEDGER
                                         AWR-YTD-PCT-INS-INC-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-INS-INC-LEDGER
                                       TO WR-YTD-PCT-INS-INC-LEDGER
                                         AWR-YTD-PCT-INS-INC-LEDGER.

           IF OWR-YTD-PCT-EXPENSE-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-EXPENSE-LEDGER
                                         AWR-YTD-PCT-EXPENSE-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-EXPENSE-LEDGER 
                                       TO WR-YTD-PCT-EXPENSE-LEDGER
                                         AWR-YTD-PCT-EXPENSE-LEDGER.

           IF OWR-YTD-PCT-BAD-DEBT-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-BAD-DEBT-LEDGER
                                         AWR-YTD-PCT-BAD-DEBT-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-BAD-DEBT-LEDGER
                                       TO WR-YTD-PCT-BAD-DEBT-LEDGER
                                         AWR-YTD-PCT-BAD-DEBT-LEDGER.

           IF OWR-YTD-PCT-NF-BNK-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-NF-BNK-LEDGER
                                         AWR-YTD-PCT-NF-BNK-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-NF-BNK-LEDGER
                                       TO WR-YTD-PCT-NF-BNK-LEDGER
                                         AWR-YTD-PCT-NF-BNK-LEDGER.

           IF OWR-YTD-PCT-PRETAX-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-PRETAX-LEDGER
                                         AWR-YTD-PCT-PRETAX-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-PRETAX-LEDGER
                                       TO WR-YTD-PCT-PRETAX-LEDGER
                                         AWR-YTD-PCT-PRETAX-LEDGER.

           IF OWR-YTD-PCT-DEBT-NF-LEDGER NOT NUMERIC
              MOVE 0                   TO WR-YTD-PCT-DEBT-NF-LEDGER
                                         AWR-YTD-PCT-DEBT-NF-LEDGER
           ELSE
           MOVE OWR-YTD-PCT-DEBT-NF-LEDGER
                                       TO WR-YTD-PCT-DEBT-NF-LEDGER
                                         AWR-YTD-PCT-DEBT-NF-LEDGER.

           IF OWR-WCBC-CUR-NO-CUST NOT NUMERIC
              MOVE 0                    TO WR-WCBC-CUR-NO-CUST
                                          AWR-WCBC-CUR-NO-CUST
           ELSE
           MOVE OWR-WCBC-CUR-NO-CUST    TO WR-WCBC-CUR-NO-CUST
                                          AWR-WCBC-CUR-NO-CUST.

           IF OWR-WCBC-ELM-NO-CUST NOT NUMERIC
              MOVE 0                    TO WR-WCBC-ELM-NO-CUST
                                          AWR-WCBC-ELM-NO-CUST
           ELSE
           MOVE OWR-WCBC-ELM-NO-CUST    TO WR-WCBC-ELM-NO-CUST
                                          AWR-WCBC-ELM-NO-CUST.

           IF OWR-WCBC-ELY-NO-CUST NOT NUMERIC
              MOVE 0                    TO WR-WCBC-ELY-NO-CUST
                                          AWR-WCBC-ELY-NO-CUST
           ELSE
           MOVE OWR-WCBC-ELY-NO-CUST    TO WR-WCBC-ELY-NO-CUST
                                          AWR-WCBC-ELY-NO-CUST.

           IF OWR-WCBC-OUTS-BALANCE NOT NUMERIC
              MOVE 0                    TO WR-WCBC-OUTS-BALANCE
                                          AWR-WCBC-OUTS-BALANCE
           ELSE
           MOVE OWR-WCBC-OUTS-BALANCE   TO WR-WCBC-OUTS-BALANCE
                                          AWR-WCBC-OUTS-BALANCE.

           IF OWR-WCBC-ELM-OUTS-BAL NOT NUMERIC
              MOVE 0                    TO WR-WCBC-ELM-OUTS-BAL
                                          AWR-WCBC-ELM-OUTS-BAL
           ELSE
           MOVE OWR-WCBC-ELM-OUTS-BAL   TO WR-WCBC-ELM-OUTS-BAL
                                          AWR-WCBC-ELM-OUTS-BAL.

           IF OWR-WCBC-ELY-OUTS-BAL NOT NUMERIC
              MOVE 0                    TO WR-WCBC-ELY-OUTS-BAL
                                          AWR-WCBC-ELY-OUTS-BAL
           ELSE
           MOVE OWR-WCBC-ELY-OUTS-BAL   TO WR-WCBC-ELY-OUTS-BAL
                                          AWR-WCBC-ELY-OUTS-BAL.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              IF OWR-WCBC-NO-NB(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-WCBC-NO-NB(SUB)
                                            AWR-WCBC-NO-NB(SUB)
              ELSE
              MOVE OWR-WCBC-NO-NB(SUB)    TO WR-WCBC-NO-NB(SUB) 
                                            AWR-WCBC-NO-NB(SUB)
              END-IF
              IF OWR-WCBC-NO-FB(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-WCBC-NO-FB(SUB)
                                            AWR-WCBC-NO-FB(SUB)
              ELSE
              MOVE OWR-WCBC-NO-FB(SUB)    TO WR-WCBC-NO-FB(SUB) 
                                            AWR-WCBC-NO-FB(SUB)
              END-IF
              IF OWR-WCBC-NO-PB(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-WCBC-NO-PB(SUB)
                                            AWR-WCBC-NO-PB(SUB)
              ELSE
              MOVE OWR-WCBC-NO-PB(SUB)    TO WR-WCBC-NO-PB(SUB)  
                                            AWR-WCBC-NO-PB(SUB)
              END-IF
              IF OWR-WCBC-GROSS-VOLUME(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-WCBC-GROSS-VOLUME(SUB)
                                          AWR-WCBC-GROSS-VOLUME(SUB)
              ELSE
              MOVE OWR-WCBC-GROSS-VOLUME(SUB) 
                                        TO WR-WCBC-GROSS-VOLUME(SUB) 
                                          AWR-WCBC-GROSS-VOLUME(SUB)
              END-IF
              IF OWR-WCBC-LATE-CHGS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-WCBC-LATE-CHGS(SUB)
                                          AWR-WCBC-LATE-CHGS(SUB)
              ELSE
              MOVE OWR-WCBC-LATE-CHGS(SUB)
                                          TO WR-WCBC-LATE-CHGS(SUB) 
                                            AWR-WCBC-LATE-CHGS(SUB)
              END-IF
              IF OWR-WCBC-NET-FIN-CHGS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-WCBC-NET-FIN-CHGS(SUB)
                                          AWR-WCBC-NET-FIN-CHGS(SUB)
              ELSE
              MOVE OWR-WCBC-NET-FIN-CHGS(SUB)
                                        TO WR-WCBC-NET-FIN-CHGS(SUB) 
                                          AWR-WCBC-NET-FIN-CHGS(SUB)
              END-IF
              IF OWR-WCBC-SALES(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-WCBC-SALES(SUB)
                                          AWR-WCBC-SALES(SUB)
              ELSE
              MOVE OWR-WCBC-SALES(SUB)  TO WR-WCBC-SALES(SUB) 
                                          AWR-WCBC-SALES(SUB)
              END-IF
              IF OWR-WCBC-COST-OF-SALES(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-WCBC-COST-OF-SALES(SUB)
                                          AWR-WCBC-COST-OF-SALES(SUB)
              ELSE
              MOVE OWR-WCBC-COST-OF-SALES(SUB)
                                        TO WR-WCBC-COST-OF-SALES(SUB) 
                                          AWR-WCBC-COST-OF-SALES(SUB)
              END-IF
              IF OWR-WCBC-EXPENSES(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-WCBC-EXPENSES(SUB)
                                            AWR-WCBC-EXPENSES(SUB)
              ELSE
              MOVE OWR-WCBC-EXPENSES(SUB) TO WR-WCBC-EXPENSES(SUB)  
                                            AWR-WCBC-EXPENSES(SUB)
              END-IF
              IF OWR-WCBC-RECOVERY-INCOME(SUB) NOT NUMERIC
                 MOVE 0                TO WR-WCBC-RECOVERY-INCOME(SUB)
                                         AWR-WCBC-RECOVERY-INCOME(SUB)
              ELSE
              MOVE OWR-WCBC-RECOVERY-INCOME(SUB)  
                                       TO WR-WCBC-RECOVERY-INCOME(SUB) 
                                         AWR-WCBC-RECOVERY-INCOME(SUB)
              END-IF
              IF OWR-WCBC-CHARGEOFF-EXPENSE(SUB) NOT NUMERIC
                 MOVE 0                TO WR-WCBC-CHARGEOFF-EXPENSE(SUB)
                                         AWR-WCBC-CHARGEOFF-EXPENSE(SUB)
              ELSE
              MOVE OWR-WCBC-CHARGEOFF-EXPENSE(SUB)
                                      TO WR-WCBC-CHARGEOFF-EXPENSE(SUB) 
                                        AWR-WCBC-CHARGEOFF-EXPENSE(SUB)
              END-IF
              IF OWR-WCBC-BAD-DEBT-BNKRPCY(SUB) NOT NUMERIC
                 MOVE 0                TO WR-WCBC-BAD-DEBT-BNKRPCY(SUB)
                                         AWR-WCBC-BAD-DEBT-BNKRPCY(SUB)
              ELSE
              MOVE OWR-WCBC-BAD-DEBT-BNKRPCY(SUB)
                                       TO WR-WCBC-BAD-DEBT-BNKRPCY(SUB) 
                                         AWR-WCBC-BAD-DEBT-BNKRPCY(SUB)
              END-IF
           END-PERFORM.

           IF OWR-WCBC-NO-30-DAY-ACCTS NOT NUMERIC
           MOVE 0                        TO WR-WCBC-NO-30-DAY-ACCTS
                                           AWR-WCBC-NO-30-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-NO-30-DAY-ACCTS TO WR-WCBC-NO-30-DAY-ACCTS
                                           AWR-WCBC-NO-30-DAY-ACCTS.
           IF OWR-WCBC-AMT-30-DAY-ACCTS NOT NUMERIC
           MOVE 0                        TO WR-WCBC-AMT-30-DAY-ACCTS
                                           AWR-WCBC-AMT-30-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-AMT-30-DAY-ACCTS TO WR-WCBC-AMT-30-DAY-ACCTS
                                            AWR-WCBC-AMT-30-DAY-ACCTS.
           IF OWR-WCBC-NO-60-DAY-ACCTS NOT NUMERIC
           MOVE 0                        TO WR-WCBC-NO-60-DAY-ACCTS
                                           AWR-WCBC-NO-60-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-NO-60-DAY-ACCTS TO WR-WCBC-NO-60-DAY-ACCTS
                                           AWR-WCBC-NO-60-DAY-ACCTS.
           IF OWR-WCBC-AMT-60-DAY-ACCTS NOT NUMERIC
           MOVE 0                         TO WR-WCBC-AMT-60-DAY-ACCTS
                                            AWR-WCBC-AMT-60-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-AMT-60-DAY-ACCTS TO WR-WCBC-AMT-60-DAY-ACCTS
                                            AWR-WCBC-AMT-60-DAY-ACCTS.
           IF OWR-WCBC-NO-90-DAY-ACCTS NOT NUMERIC
           MOVE 0                        TO WR-WCBC-NO-90-DAY-ACCTS
                                           AWR-WCBC-NO-90-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-NO-90-DAY-ACCTS TO WR-WCBC-NO-90-DAY-ACCTS
                                           AWR-WCBC-NO-90-DAY-ACCTS.
           IF OWR-WCBC-AMT-90-DAY-ACCTS NOT NUMERIC
           MOVE 0                         TO WR-WCBC-AMT-90-DAY-ACCTS
                                            AWR-WCBC-AMT-90-DAY-ACCTS
           ELSE
           MOVE OWR-WCBC-AMT-90-DAY-ACCTS TO WR-WCBC-AMT-90-DAY-ACCTS
                                            AWR-WCBC-AMT-90-DAY-ACCTS.

           IF OWR-WCBC-ELM-AMT-90-DAYS NOT NUMERIC
           MOVE 0                         TO WR-WCBC-ELM-AMT-90-DAYS
                                            AWR-WCBC-ELM-AMT-90-DAYS
           ELSE
           MOVE OWR-WCBC-ELM-AMT-90-DAYS  TO WR-WCBC-ELM-AMT-90-DAYS
                                            AWR-WCBC-ELM-AMT-90-DAYS.
           IF OWR-WCBC-ELY-AMT-90-DAYS NOT NUMERIC
           MOVE 0                         TO WR-WCBC-ELY-AMT-90-DAYS
                                            AWR-WCBC-ELY-AMT-90-DAYS
           ELSE
           MOVE OWR-WCBC-ELY-AMT-90-DAYS  TO WR-WCBC-ELY-AMT-90-DAYS
                                            AWR-WCBC-ELY-AMT-90-DAYS.

           IF OWR-WCBC-PCT-VOLUME NOT NUMERIC
           MOVE 0                       TO WR-WCBC-PCT-VOLUME
                                          AWR-WCBC-PCT-VOLUME
           ELSE
           MOVE OWR-WCBC-PCT-VOLUME     TO WR-WCBC-PCT-VOLUME
                                          AWR-WCBC-PCT-VOLUME.
           IF OWR-WCBC-GROSS-PROF-PCT NOT NUMERIC
           MOVE 0                       TO WR-WCBC-GROSS-PROF-PCT
                                          AWR-WCBC-GROSS-PROF-PCT
           ELSE
           MOVE OWR-WCBC-GROSS-PROF-PCT TO WR-WCBC-GROSS-PROF-PCT
                                          AWR-WCBC-GROSS-PROF-PCT.
           IF OWR-LARGE-CUR-NO-CUST NOT NUMERIC
           MOVE 0                       TO WR-LARGE-CUR-NO-CUST
                                          AWR-LARGE-CUR-NO-CUST
           ELSE
           MOVE OWR-LARGE-CUR-NO-CUST   TO WR-LARGE-CUR-NO-CUST
                                          AWR-LARGE-CUR-NO-CUST.
           IF OWR-LARGE-ELM-NO-CUST NOT NUMERIC
           MOVE 0                       TO WR-LARGE-ELM-NO-CUST
                                          AWR-LARGE-ELM-NO-CUST
           ELSE
           MOVE OWR-LARGE-ELM-NO-CUST   TO WR-LARGE-ELM-NO-CUST
                                          AWR-LARGE-ELM-NO-CUST.
           IF OWR-LARGE-ELY-NO-CUST NOT NUMERIC
           MOVE 0                       TO WR-LARGE-ELY-NO-CUST
                                          AWR-LARGE-ELY-NO-CUST
           ELSE
           MOVE OWR-LARGE-ELY-NO-CUST   TO WR-LARGE-ELY-NO-CUST
                                          AWR-LARGE-ELY-NO-CUST.
           IF OWR-LARGE-OUTS-BALANCE NOT NUMERIC
           MOVE 0                       TO WR-LARGE-OUTS-BALANCE
                                          AWR-LARGE-OUTS-BALANCE
           ELSE
           MOVE OWR-LARGE-OUTS-BALANCE  TO WR-LARGE-OUTS-BALANCE
                                          AWR-LARGE-OUTS-BALANCE.
           IF OWR-LARGE-ELM-OUTS-BAL NOT NUMERIC
           MOVE 0                       TO WR-LARGE-ELM-OUTS-BAL
                                          AWR-LARGE-ELM-OUTS-BAL
           ELSE
           MOVE OWR-LARGE-ELM-OUTS-BAL  TO WR-LARGE-ELM-OUTS-BAL
                                          AWR-LARGE-ELM-OUTS-BAL.
           IF OWR-LARGE-ELY-OUTS-BAL NOT NUMERIC
           MOVE 0                       TO WR-LARGE-ELY-OUTS-BAL
                                          AWR-LARGE-ELY-OUTS-BAL
           ELSE
           MOVE OWR-LARGE-ELY-OUTS-BAL  TO WR-LARGE-ELY-OUTS-BAL
                                          AWR-LARGE-ELY-OUTS-BAL.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              IF OWR-LARGE-NO-NB(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-LARGE-NO-NB(SUB)
                                             AWR-LARGE-NO-NB(SUB)
              ELSE
              MOVE OWR-LARGE-NO-NB(SUB)    TO WR-LARGE-NO-NB(SUB)
                                             AWR-LARGE-NO-NB(SUB)
              END-IF
              IF OWR-LARGE-NO-FB(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-LARGE-NO-FB(SUB)
                                             AWR-LARGE-NO-FB(SUB)
              ELSE
              MOVE OWR-LARGE-NO-FB(SUB)    TO WR-LARGE-NO-FB(SUB)
                                             AWR-LARGE-NO-FB(SUB)
              END-IF
              IF OWR-LARGE-NO-PB(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-LARGE-NO-PB(SUB)
                                             AWR-LARGE-NO-PB(SUB)
              ELSE
              MOVE OWR-LARGE-NO-PB(SUB)    TO WR-LARGE-NO-PB(SUB)
                                             AWR-LARGE-NO-PB(SUB)
              END-IF
              IF OWR-LARGE-GROSS-VOLUME(SUB) NOT NUMERIC
                 MOVE 0                TO WR-LARGE-GROSS-VOLUME(SUB)
                                         AWR-LARGE-GROSS-VOLUME(SUB)
              ELSE
              MOVE OWR-LARGE-GROSS-VOLUME(SUB)
                                       TO WR-LARGE-GROSS-VOLUME(SUB)
                                         AWR-LARGE-GROSS-VOLUME(SUB)
              END-IF
           END-PERFORM.

           IF OWR-LARGE-NO-30-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-NO-30-DAY-ACCTS
                                    AWR-LARGE-NO-30-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-NO-30-DAY-ACCTS  
                                  TO WR-LARGE-NO-30-DAY-ACCTS
                                    AWR-LARGE-NO-30-DAY-ACCTS.
           IF OWR-LARGE-AMT-30-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-AMT-30-DAY-ACCTS
                                    AWR-LARGE-AMT-30-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-AMT-30-DAY-ACCTS
                                  TO WR-LARGE-AMT-30-DAY-ACCTS
                                    AWR-LARGE-AMT-30-DAY-ACCTS.
           IF OWR-LARGE-NO-60-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-NO-60-DAY-ACCTS
                                    AWR-LARGE-NO-60-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-NO-60-DAY-ACCTS 
                                  TO WR-LARGE-NO-60-DAY-ACCTS
                                    AWR-LARGE-NO-60-DAY-ACCTS.
           IF OWR-LARGE-AMT-60-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-AMT-60-DAY-ACCTS
                                    AWR-LARGE-AMT-60-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-AMT-60-DAY-ACCTS
                                  TO WR-LARGE-AMT-60-DAY-ACCTS
                                    AWR-LARGE-AMT-60-DAY-ACCTS.
           IF OWR-LARGE-NO-90-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-NO-90-DAY-ACCTS
                                    AWR-LARGE-NO-90-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-NO-90-DAY-ACCTS 
                                  TO WR-LARGE-NO-90-DAY-ACCTS
                                    AWR-LARGE-NO-90-DAY-ACCTS.
           IF OWR-LARGE-AMT-90-DAY-ACCTS NOT NUMERIC
              MOVE 0              TO WR-LARGE-AMT-90-DAY-ACCTS
                                    AWR-LARGE-AMT-90-DAY-ACCTS
           ELSE
           MOVE OWR-LARGE-AMT-90-DAY-ACCTS
                                  TO WR-LARGE-AMT-90-DAY-ACCTS
                                    AWR-LARGE-AMT-90-DAY-ACCTS.
           IF OWR-LARGE-ELM-AMT-90-DAYS NOT NUMERIC
              MOVE 0              TO WR-LARGE-ELM-AMT-90-DAYS
                                    AWR-LARGE-ELM-AMT-90-DAYS
           ELSE
           MOVE OWR-LARGE-ELM-AMT-90-DAYS 
                                  TO WR-LARGE-ELM-AMT-90-DAYS
                                    AWR-LARGE-ELM-AMT-90-DAYS.
           IF OWR-LARGE-ELY-AMT-90-DAYS NOT NUMERIC
              MOVE 0              TO WR-LARGE-ELY-AMT-90-DAYS
                                    AWR-LARGE-ELY-AMT-90-DAYS
           ELSE
           MOVE OWR-LARGE-ELY-AMT-90-DAYS 
                                  TO WR-LARGE-ELY-AMT-90-DAYS
                                    AWR-LARGE-ELY-AMT-90-DAYS.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              IF OWR-LIFE-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-LIFE-CLAIMS(SUB)
                                          AWR-LIFE-CLAIMS(SUB)
              ELSE
              MOVE OWR-LIFE-CLAIMS(SUB) TO WR-LIFE-CLAIMS(SUB)
                                          AWR-LIFE-CLAIMS(SUB)
              END-IF
              IF OWR-AH-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-AH-CLAIMS(SUB)
                                          AWR-AH-CLAIMS(SUB)
              ELSE
              MOVE OWR-AH-CLAIMS(SUB)   TO WR-AH-CLAIMS(SUB)
                                          AWR-AH-CLAIMS(SUB)
              END-IF
              IF OWR-FIRE-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-FIRE-CLAIMS(SUB)
                                          AWR-FIRE-CLAIMS(SUB)
              ELSE
              MOVE OWR-FIRE-CLAIMS(SUB) TO WR-FIRE-CLAIMS(SUB)
                                          AWR-FIRE-CLAIMS(SUB)
              END-IF
              IF OWR-AUTO-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-AUTO-CLAIMS(SUB)
                                          AWR-AUTO-CLAIMS(SUB)
              ELSE
              MOVE OWR-AUTO-CLAIMS(SUB) TO WR-AUTO-CLAIMS(SUB)
                                          AWR-AUTO-CLAIMS(SUB)
              END-IF
              IF OWR-UNEMP-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-UNEMP-CLAIMS(SUB)
                                           AWR-UNEMP-CLAIMS(SUB)
              ELSE
              MOVE OWR-UNEMP-CLAIMS(SUB) TO WR-UNEMP-CLAIMS(SUB)
                                           AWR-UNEMP-CLAIMS(SUB)
              END-IF
              IF OWR-AD-D-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-AD-D-CLAIMS(SUB)
                                           AWR-AD-D-CLAIMS(SUB)
              ELSE
              MOVE OWR-AD-D-CLAIMS(SUB)  TO WR-AD-D-CLAIMS(SUB)
                                           AWR-AD-D-CLAIMS(SUB)
              END-IF
              IF OWR-L-PROT-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-L-PROT-CLAIMS(SUB)
                                            AWR-L-PROT-CLAIMS(SUB)
              ELSE
              MOVE OWR-L-PROT-CLAIMS(SUB) TO WR-L-PROT-CLAIMS(SUB)
                                            AWR-L-PROT-CLAIMS(SUB)
              END-IF
              IF OWR-NF-NON-BK-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NF-NON-BK-CLAIMS(SUB)
                                            AWR-NF-NON-BK-CLAIMS(SUB)
              ELSE
              MOVE OWR-NF-NON-BK-CLAIMS(SUB)
                                          TO WR-NF-NON-BK-CLAIMS(SUB)
                                            AWR-NF-NON-BK-CLAIMS(SUB)
              END-IF
              IF OWR-NF-BK-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NF-BK-CLAIMS(SUB)
                                            AWR-NF-BK-CLAIMS(SUB)
              ELSE
              MOVE OWR-NF-BK-CLAIMS(SUB)  TO WR-NF-BK-CLAIMS(SUB)
                                            AWR-NF-BK-CLAIMS(SUB)
              END-IF
              IF OWR-ROAD-GARD-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-ROAD-GARD-CLAIMS(SUB)
                                            AWR-ROAD-GARD-CLAIMS(SUB)
              ELSE
              MOVE OWR-ROAD-GARD-CLAIMS(SUB) 
                                          TO WR-ROAD-GARD-CLAIMS(SUB)
                                            AWR-ROAD-GARD-CLAIMS(SUB)
              END-IF
              IF OWR-NO-LIFE-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NO-LIFE-CLAIMS(SUB)
                                            AWR-NO-LIFE-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-LIFE-CLAIMS(SUB) TO WR-NO-LIFE-CLAIMS(SUB)    
                                             AWR-NO-LIFE-CLAIMS(SUB)
              END-IF
              IF OWR-NO-AH-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NO-AH-CLAIMS(SUB)
                                            AWR-NO-AH-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-AH-CLAIMS(SUB)  TO WR-NO-AH-CLAIMS(SUB)
                                            AWR-NO-AH-CLAIMS(SUB)
              END-IF
              IF OWR-NO-FIRE-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NO-FIRE-CLAIMS(SUB)
                                            AWR-NO-FIRE-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-FIRE-CLAIMS(SUB) TO WR-NO-FIRE-CLAIMS(SUB)
                                             AWR-NO-FIRE-CLAIMS(SUB)
              END-IF
              IF OWR-NO-AUTO-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-NO-AUTO-CLAIMS(SUB)
                                            AWR-NO-AUTO-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-AUTO-CLAIMS(SUB) TO WR-NO-AUTO-CLAIMS(SUB)
                                             AWR-NO-AUTO-CLAIMS(SUB)
              END-IF
              IF OWR-NO-UNEMP-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-UNEMP-CLAIMS(SUB)
                                           AWR-NO-UNEMP-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-UNEMP-CLAIMS(SUB)
                                         TO WR-NO-UNEMP-CLAIMS(SUB)
                                           AWR-NO-UNEMP-CLAIMS(SUB)
              END-IF
              IF OWR-NO-AD-D-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-AD-D-CLAIMS(SUB)
                                           AWR-NO-AD-D-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-AD-D-CLAIMS(SUB)
                                         TO WR-NO-AD-D-CLAIMS(SUB)
                                           AWR-NO-AD-D-CLAIMS(SUB)
              END-IF
              IF OWR-NO-L-PROT-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-L-PROT-CLAIMS(SUB)
                                           AWR-NO-L-PROT-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-L-PROT-CLAIMS(SUB)
                                         TO WR-NO-L-PROT-CLAIMS(SUB)
                                           AWR-NO-L-PROT-CLAIMS(SUB)
              END-IF
              IF OWR-NO-NF-NON-BK-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-NO-NF-NON-BK-CLAIMS(SUB)
                                          AWR-NO-NF-NON-BK-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-NF-NON-BK-CLAIMS(SUB)
                                        TO WR-NO-NF-NON-BK-CLAIMS(SUB)
                                          AWR-NO-NF-NON-BK-CLAIMS(SUB)
              END-IF
              IF OWR-NO-NF-BK-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-NO-NF-BK-CLAIMS(SUB)
                                          AWR-NO-NF-BK-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-NF-BK-CLAIMS(SUB)
                                        TO WR-NO-NF-BK-CLAIMS(SUB)
                                          AWR-NO-NF-BK-CLAIMS(SUB)
              END-IF
              IF OWR-NO-ROAD-GARD-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0                 TO WR-NO-ROAD-GARD-CLAIMS(SUB)
                                          AWR-NO-ROAD-GARD-CLAIMS(SUB)
              ELSE
              MOVE OWR-NO-ROAD-GARD-CLAIMS(SUB)  
                                        TO WR-NO-ROAD-GARD-CLAIMS(SUB)
                                          AWR-NO-ROAD-GARD-CLAIMS(SUB)
              END-IF
              IF OWR-LIFE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-LIFE-PREMS(SUB)
                                            AWR-LIFE-PREMS(SUB)
              ELSE
              MOVE OWR-LIFE-PREMS(SUB)    TO WR-LIFE-PREMS(SUB)
                                            AWR-LIFE-PREMS(SUB)
              END-IF
              IF OWR-AH-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-AH-PREMS(SUB)
                                            AWR-AH-PREMS(SUB)
              ELSE
              MOVE OWR-AH-PREMS(SUB)      TO WR-AH-PREMS(SUB)
                                            AWR-AH-PREMS(SUB)
              END-IF
              IF OWR-FIRE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-FIRE-PREMS(SUB)
                                            AWR-FIRE-PREMS(SUB)
              ELSE
              MOVE OWR-FIRE-PREMS(SUB)    TO WR-FIRE-PREMS(SUB)
                                            AWR-FIRE-PREMS(SUB)
              END-IF
              IF OWR-AUTO-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-AUTO-PREMS(SUB)
                                            AWR-AUTO-PREMS(SUB)
              ELSE
              MOVE OWR-AUTO-PREMS(SUB)    TO WR-AUTO-PREMS (SUB) 
                                            AWR-AUTO-PREMS(SUB)
              END-IF
              IF OWR-UNEMP-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-UNEMP-PREMS(SUB)
                                            AWR-UNEMP-PREMS(SUB)
              ELSE
              MOVE OWR-UNEMP-PREMS(SUB)   TO WR-UNEMP-PREMS (SUB)   
                                            AWR-UNEMP-PREMS(SUB)
              END-IF
              IF OWR-AD-D-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-AD-D-PREMS(SUB)
                                            AWR-AD-D-PREMS(SUB)
              ELSE
              MOVE OWR-AD-D-PREMS(SUB)    TO WR-AD-D-PREMS(SUB)
                                            AWR-AD-D-PREMS(SUB)
              END-IF
              IF OWR-L-PROT-PREMS(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-L-PROT-PREMS(SUB)
                                            AWR-L-PROT-PREMS(SUB)
              ELSE
              MOVE OWR-L-PROT-PREMS(SUB)  TO WR-L-PROT-PREMS(SUB)
                                            AWR-L-PROT-PREMS(SUB)
              END-IF
              IF OWR-NON-FILE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NON-FILE-PREMS(SUB)
                                             AWR-NON-FILE-PREMS(SUB)
              ELSE
              MOVE OWR-NON-FILE-PREMS(SUB) TO WR-NON-FILE-PREMS(SUB)
                                             AWR-NON-FILE-PREMS(SUB)
              END-IF
              IF OWR-ROAD-GARD-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-ROAD-GARD-PREMS(SUB)
                                             AWR-ROAD-GARD-PREMS(SUB)
              ELSE
              MOVE OWR-ROAD-GARD-PREMS(SUB) TO WR-ROAD-GARD-PREMS(SUB)
                                              AWR-ROAD-GARD-PREMS(SUB)
              END-IF
              IF OWR-NO-LIFE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-LIFE-PREMS(SUB)
                                             AWR-NO-LIFE-PREMS(SUB)
              ELSE
              MOVE OWR-NO-LIFE-PREMS(SUB)  TO WR-NO-LIFE-PREMS(SUB)
                                             AWR-NO-LIFE-PREMS(SUB)
              END-IF
              IF OWR-NO-AH-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-AH-PREMS(SUB)
                                             AWR-NO-AH-PREMS(SUB)
              ELSE
              MOVE OWR-NO-AH-PREMS(SUB)    TO WR-NO-AH-PREMS(SUB)
                                             AWR-NO-AH-PREMS(SUB)
              END-IF
              IF OWR-NO-FIRE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-FIRE-PREMS(SUB)
                                             AWR-NO-FIRE-PREMS(SUB)
              ELSE
              MOVE OWR-NO-FIRE-PREMS(SUB)  TO WR-NO-FIRE-PREMS(SUB)
                                             AWR-NO-FIRE-PREMS(SUB)
              END-IF
              IF OWR-NO-AUTO-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-AUTO-PREMS(SUB)
                                             AWR-NO-AUTO-PREMS(SUB)
              ELSE
              MOVE OWR-NO-AUTO-PREMS(SUB)  TO WR-NO-AUTO-PREMS(SUB)
                                             AWR-NO-AUTO-PREMS(SUB)
              END-IF
              IF OWR-NO-UNEMP-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-UNEMP-PREMS(SUB)
                                             AWR-NO-UNEMP-PREMS(SUB)
              ELSE
              MOVE OWR-NO-UNEMP-PREMS(SUB) TO WR-NO-UNEMP-PREMS(SUB)
                                             AWR-NO-UNEMP-PREMS(SUB)
              END-IF
              IF OWR-NO-AD-D-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-AD-D-PREMS(SUB)
                                             AWR-NO-AD-D-PREMS(SUB)
              ELSE
              MOVE OWR-NO-AD-D-PREMS(SUB)  TO WR-NO-AD-D-PREMS(SUB)
                                             AWR-NO-AD-D-PREMS(SUB)
              END-IF
              IF OWR-NO-L-PROT-PREMS(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-NO-L-PROT-PREMS(SUB)
                                             AWR-NO-L-PROT-PREMS(SUB)
              ELSE
              MOVE OWR-NO-L-PROT-PREMS(SUB) TO WR-NO-L-PROT-PREMS(SUB)
                                              AWR-NO-L-PROT-PREMS(SUB)
              END-IF
              IF OWR-NO-NON-FILE-PREMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-NON-FILE-PREMS(SUB)
                                           AWR-NO-NON-FILE-PREMS(SUB)
              ELSE
              MOVE OWR-NO-NON-FILE-PREMS(SUB) 
                                         TO WR-NO-NON-FILE-PREMS(SUB)
                                           AWR-NO-NON-FILE-PREMS(SUB)
              END-IF
              IF OWR-NO-ROAD-GARD-PREMS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NO-ROAD-GARD-PREMS(SUB)
                                           AWR-NO-ROAD-GARD-PREMS(SUB)
              ELSE
              MOVE OWR-NO-ROAD-GARD-PREMS(SUB)   
                                         TO WR-NO-ROAD-GARD-PREMS(SUB)
                                           AWR-NO-ROAD-GARD-PREMS(SUB)
              END-IF
              IF OWR-LIFE-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-LIFE-REFS(SUB)
                                           AWR-LIFE-REFS(SUB)
              ELSE
              MOVE OWR-LIFE-REFS(SUB)    TO WR-LIFE-REFS(SUB)
                                           AWR-LIFE-REFS(SUB)
              END-IF
              IF OWR-AH-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-AH-REFS(SUB)
                                           AWR-AH-REFS(SUB)
              ELSE
              MOVE OWR-AH-REFS(SUB)      TO WR-AH-REFS (SUB)
                                           AWR-AH-REFS(SUB)
              END-IF
              IF OWR-FIRE-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-FIRE-REFS(SUB)
                                           AWR-FIRE-REFS(SUB)
              ELSE
              MOVE OWR-FIRE-REFS(SUB)    TO WR-FIRE-REFS(SUB)
                                           AWR-FIRE-REFS(SUB)
              END-IF
              IF OWR-AUTO-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-AUTO-REFS(SUB)
                                           AWR-AUTO-REFS(SUB)
              ELSE
              MOVE OWR-AUTO-REFS(SUB)    TO WR-AUTO-REFS(SUB)
                                           AWR-AUTO-REFS(SUB)
              END-IF
              IF OWR-UNEMP-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-UNEMP-REFS(SUB)
                                           AWR-UNEMP-REFS(SUB)
              ELSE
              MOVE OWR-UNEMP-REFS(SUB)   TO WR-UNEMP-REFS(SUB)
                                           AWR-UNEMP-REFS(SUB)
              END-IF
              IF OWR-AD-D-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-AD-D-REFS(SUB)
                                           AWR-AD-D-REFS(SUB)
              ELSE
              MOVE OWR-AD-D-REFS(SUB)    TO WR-AD-D-REFS(SUB)
                                           AWR-AD-D-REFS(SUB)
              END-IF
              IF OWR-L-PROT-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-L-PROT-REFS(SUB)
                                           AWR-L-PROT-REFS(SUB)
              ELSE
              MOVE OWR-L-PROT-REFS(SUB)  TO WR-L-PROT-REFS(SUB)
                                           AWR-L-PROT-REFS(SUB)
              END-IF
              IF OWR-NON-FILE-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NON-FILE-REFS(SUB)
                                           AWR-NON-FILE-REFS(SUB)
              ELSE
              MOVE OWR-NON-FILE-REFS(SUB)  TO WR-NON-FILE-REFS(SUB)
                                             AWR-NON-FILE-REFS(SUB)
              END-IF
              IF OWR-ROAD-GARD-REFS(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-ROAD-GARD-REFS(SUB)
                                           AWR-ROAD-GARD-REFS(SUB)
              ELSE
              MOVE OWR-ROAD-GARD-REFS(SUB) TO WR-ROAD-GARD-REFS(SUB)
                                             AWR-ROAD-GARD-REFS(SUB)
              END-IF
              IF OWR-NF-RECOVERIES(SUB) NOT NUMERIC
                 MOVE 0                  TO WR-NF-RECOVERIES(SUB)
                                           AWR-NF-RECOVERIES(SUB)
              ELSE
              MOVE OWR-NF-RECOVERIES(SUB) TO WR-NF-RECOVERIES(SUB)
                                            AWR-NF-RECOVERIES(SUB)
              END-IF
           END-PERFORM.
           

           IF OWR-NONFILE-ENDING-BALANCE NOT NUMERIC
              MOVE 0                 TO WR-NONFILE-ENDING-BALANCE
                                       AWR-NONFILE-ENDING-BALANCE
           ELSE
           MOVE OWR-NONFILE-ENDING-BALANCE  
                                     TO WR-NONFILE-ENDING-BALANCE
                                       AWR-NONFILE-ENDING-BALANCE.

           IF OWR-NO-CUST-1-YR-AGO NOT NUMERIC
              MOVE 0                 TO WR-NO-CUST-1-YR-AGO
                                       AWR-NO-CUST-1-YR-AGO
           ELSE
           MOVE OWR-NO-CUST-1-YR-AGO TO WR-NO-CUST-1-YR-AGO
                                       AWR-NO-CUST-1-YR-AGO.

           IF OWR-OUTS-BAL-1-YR-AGO NOT NUMERIC
              MOVE 0                  TO WR-OUTS-BAL-1-YR-AGO
                                        AWR-OUTS-BAL-1-YR-AGO
           ELSE
           MOVE OWR-OUTS-BAL-1-YR-AGO TO WR-OUTS-BAL-1-YR-AGO
                                        AWR-OUTS-BAL-1-YR-AGO.

           IF OWR-WCBC-NO-CUST-1-YR-AGO NOT NUMERIC
              MOVE 0                 TO WR-WCBC-NO-CUST-1-YR-AGO
                                       AWR-WCBC-NO-CUST-1-YR-AGO
           ELSE
           MOVE OWR-WCBC-NO-CUST-1-YR-AGO 
                                     TO WR-WCBC-NO-CUST-1-YR-AGO
                                       AWR-WCBC-NO-CUST-1-YR-AGO.

           IF OWR-WCBC-OUTS-BAL-1-YR-AGO NOT NUMERIC
              MOVE 0                 TO WR-WCBC-OUTS-BAL-1-YR-AGO
                                       AWR-WCBC-OUTS-BAL-1-YR-AGO
           ELSE
           MOVE OWR-WCBC-OUTS-BAL-1-YR-AGO   
                                     TO WR-WCBC-OUTS-BAL-1-YR-AGO
                                       AWR-WCBC-OUTS-BAL-1-YR-AGO.

           IF OWR-LARGE-NO-CUST-1-YR-AGO NOT NUMERIC
              MOVE 0                 TO WR-LARGE-NO-CUST-1-YR-AGO
                                       AWR-LARGE-NO-CUST-1-YR-AGO
           ELSE
           MOVE OWR-LARGE-NO-CUST-1-YR-AGO 
                                     TO WR-LARGE-NO-CUST-1-YR-AGO
                                       AWR-LARGE-NO-CUST-1-YR-AGO.

           IF OWR-LARGE-OUTS-BAL-1-YR-AGO NOT NUMERIC
              MOVE 0                 TO WR-LARGE-OUTS-BAL-1-YR-AGO
                                       AWR-LARGE-OUTS-BAL-1-YR-AGO
           ELSE
           MOVE OWR-LARGE-OUTS-BAL-1-YR-AGO   
                                     TO WR-LARGE-OUTS-BAL-1-YR-AGO
                                       AWR-LARGE-OUTS-BAL-1-YR-AGO.

           IF OWR-CUR-NO-CONT-SLOW NOT NUMERIC
              MOVE 0                 TO WR-CUR-NO-CONT-SLOW
                                       AWR-CUR-NO-CONT-SLOW
           ELSE
           MOVE OWR-CUR-NO-CONT-SLOW TO WR-CUR-NO-CONT-SLOW
                                       AWR-CUR-NO-CONT-SLOW.

           IF OWR-WCBC-CUR-NO-CONT-SLOW NOT NUMERIC
              MOVE 0                 TO WR-WCBC-CUR-NO-CONT-SLOW
                                       AWR-WCBC-CUR-NO-CONT-SLOW
           ELSE
           MOVE OWR-WCBC-CUR-NO-CONT-SLOW 
                                     TO WR-WCBC-CUR-NO-CONT-SLOW
                                       AWR-WCBC-CUR-NO-CONT-SLOW.

           IF OWR-LARGE-CUR-NO-CONT-SLOW NOT NUMERIC
              MOVE 0                 TO WR-LARGE-CUR-NO-CONT-SLOW
                                       AWR-LARGE-CUR-NO-CONT-SLOW
           ELSE
           MOVE OWR-LARGE-CUR-NO-CONT-SLOW
                                     TO WR-LARGE-CUR-NO-CONT-SLOW
                                       AWR-LARGE-CUR-NO-CONT-SLOW.

           IF OWR-CASHIER-BONUS NOT NUMERIC
              MOVE 0                    TO WR-CASHIER-BONUS
                                          AWR-CASHIER-BONUS
           ELSE
           MOVE OWR-CASHIER-BONUS       TO WR-CASHIER-BONUS
                                          AWR-CASHIER-BONUS.

           IF OWR-ASST-MGR-BONUS NOT NUMERIC
              MOVE 0                    TO WR-ASST-MGR-BONUS
                                          AWR-ASST-MGR-BONUS
           ELSE
           MOVE OWR-ASST-MGR-BONUS      TO WR-ASST-MGR-BONUS
                                          AWR-ASST-MGR-BONUS.

           IF OWR-MGR-BONUS NOT NUMERIC
              MOVE 0                    TO WR-MGR-BONUS
                                          AWR-MGR-BONUS
           ELSE
           MOVE OWR-MGR-BONUS           TO WR-MGR-BONUS
                                          AWR-MGR-BONUS.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 2
              IF OWR-LOTS-NF-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0              TO WR-LOTS-NF-CLAIMS(SUB)
                                       AWR-LOTS-NF-CLAIMS(SUB)
              ELSE
              MOVE OWR-LOTS-NF-CLAIMS(SUB) 
                                     TO WR-LOTS-NF-CLAIMS(SUB) 
                                       AWR-LOTS-NF-CLAIMS(SUB)
              END-IF
              IF OWR-LOTS-NO-NF-CLAIMS(SUB) NOT NUMERIC
                 MOVE 0              TO WR-LOTS-NO-NF-CLAIMS(SUB)
                                       AWR-LOTS-NO-NF-CLAIMS(SUB)
              ELSE
              MOVE OWR-LOTS-NO-NF-CLAIMS(SUB)
                                     TO WR-LOTS-NO-NF-CLAIMS(SUB) 
                                       AWR-LOTS-NO-NF-CLAIMS(SUB)
              END-IF
              IF OWR-LOTS-NON-FILE-PREMS(SUB) NOT NUMERIC
                 MOVE 0              TO WR-LOTS-NON-FILE-PREMS(SUB)
                                       AWR-LOTS-NON-FILE-PREMS(SUB)
              ELSE
              MOVE OWR-LOTS-NON-FILE-PREMS(SUB) 
                                     TO WR-LOTS-NON-FILE-PREMS(SUB) 
                                       AWR-LOTS-NON-FILE-PREMS(SUB)
              END-IF
              IF OWR-LOTS-NO-NON-FILE-PREMS(SUB) NOT NUMERIC
                 MOVE 0            TO WR-LOTS-NO-NON-FILE-PREMS(SUB)
                                     AWR-LOTS-NO-NON-FILE-PREMS(SUB)
              ELSE
              MOVE OWR-LOTS-NO-NON-FILE-PREMS(SUB)
                                   TO WR-LOTS-NO-NON-FILE-PREMS(SUB) 
                                     AWR-LOTS-NO-NON-FILE-PREMS(SUB)
              END-IF
              IF OWR-LOTS-NF-RECOVERIES(SUB) NOT NUMERIC
                 MOVE 0              TO WR-LOTS-NF-RECOVERIES(SUB)
                                       AWR-LOTS-NF-RECOVERIES(SUB)
              ELSE
              MOVE OWR-LOTS-NF-RECOVERIES(SUB)
                                     TO WR-LOTS-NF-RECOVERIES(SUB)  
                                       AWR-LOTS-NF-RECOVERIES(SUB)
              END-IF
              IF OWR-PRETAX-PROFIT(SUB) NOT NUMERIC
                 MOVE 0                   TO WR-PRETAX-PROFIT(SUB)
                                            AWR-PRETAX-PROFIT(SUB)
              ELSE
              MOVE OWR-PRETAX-PROFIT(SUB) TO WR-PRETAX-PROFIT(SUB)
                                            AWR-PRETAX-PROFIT(SUB)
              END-IF
              IF OWR-SUPERVISION(SUB) NOT NUMERIC
                 MOVE 0                    TO WR-SUPERVISION(SUB)
                                             AWR-SUPERVISION(SUB)
              ELSE
              MOVE OWR-SUPERVISION(SUB)    TO WR-SUPERVISION(SUB)
                                             AWR-SUPERVISION(SUB)
              END-IF
              IF OWR-NO-TAX-RETURNS(SUB) NOT NUMERIC
                 MOVE 0              TO WR-NO-TAX-RETURNS(SUB)
                                       AWR-NO-TAX-RETURNS(SUB)
              ELSE
                 MOVE OWR-NO-TAX-RETURNS(SUB)
                                     TO WR-NO-TAX-RETURNS(SUB)
                                       AWR-NO-TAX-RETURNS(SUB)
              END-IF
           END-PERFORM.

           MOVE OWR-MGR-PENALTY-FG      TO WR-MGR-PENALTY-FG
                                          AWR-MGR-PENALTY-FG.


       UPGRADE-FILE-WR-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - A U
      *
      ******************************************************************
       UPGRADE-FILE-AU SECTION.

           PERFORM CLEAR-AU-FILE.

           MOVE OAU-FILE-NAME           TO AU-FILE-NAME.
           MOVE OAU-DATE                TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD           TO AU-DATE.
           MOVE OAU-SEQ                 TO AU-SEQ.
           MOVE OAU-ACTION              TO AU-ACTION.
           MOVE OAU-FILE-TYPE           TO AU-FILE-TYPE.
           IF OAU-BRANCH NOT NUMERIC
              MOVE 0                    TO AU-BRANCH
           ELSE
           MOVE OAU-BRANCH              TO AU-BRANCH.
           MOVE OAU-FILE-KEY            TO AU-FILE-KEY.
           MOVE OAU-FIELD-DESC          TO AU-FIELD-DESC.
           MOVE OAU-ORIG-VALUE          TO AU-ORIG-VALUE.
           MOVE OAU-NEW-VALUE           TO AU-NEW-VALUE.
           MOVE OAU-TICKET              TO AU-TICKET.
           MOVE OAU-PROGRAM             TO AU-PROGRAM.
           IF OAU-TIME NOT NUMERIC
              MOVE 0                    TO AU-TIME
           ELSE
           MOVE OAU-TIME                TO AU-TIME.
           MOVE OAU-USERID              TO AU-USERID.

       UPGRADE-FILE-AU-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - B W
      *
      ******************************************************************
       PROCESS-FILE-BW SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-BW = "N" )
              GO TO PROCESS-FILE-BW-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO BW-PATH-OVERRIDE
                                              BX-PATH-OVERRIDE
                                              BM-PATH-OVERRIDE.
           MOVE "BW"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/BWFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATH: BW }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OBW-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-BW-EXIT.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATH: BM }
      * NEED OBM FOR NEW BORROWER FIELDS

           MOVE "LP/BMFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OBM-PATH.

      *KC  IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *KC     GO TO PROCESS-FILE-BW-EXIT.

           IF ( STAT-BAD )     
              OPEN INPUT OBM-FILE
              PERFORM CLOSE-OBM1-FILE.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATH: BX }
      * NEED OBX FOR NEW BORROWER FIELDS

           MOVE "GB/BXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OBX-PATH.

      *KC  IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *KC     GO TO PROCESS-FILE-BW-EXIT.

           IF ( STAT-BAD )     
              OPEN INPUT OBX-FILE
              PERFORM CLOSE-OBX1-FILE.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATH: BW }
           MOVE "GB/BWFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-BW = "Y")
              MOVE UP1534-FILE-PATH           TO BW-PATH
              PERFORM OPEN-BW1-FILE
           ELSE
              PERFORM LOAD-BW1-FILE
              MOVE UP1534-FILE-PATH TO ABW-PATH-BEG 
                                       ABW-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ABW-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ABW-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ABW-PATH-GROUP 
                                            ABW-DONE-PATH-GROUP
              PERFORM OPEN-ABW-FILE.

      *- - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATH: BX }
      * NEED BX, THIS SECTION PROCESSES BX
           MOVE "GB/BXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-BW = "Y")
              MOVE UP1534-FILE-PATH           TO BX-PATH
              PERFORM OPEN-BX1-FILE
           ELSE
              PERFORM LOAD-BX1-FILE
              MOVE UP1534-FILE-PATH TO ABX-PATH-BEG
                                       ABX-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ABX-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ABX-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ABX-PATH-GROUP 
                                            ABX-DONE-PATH-GROUP
              PERFORM OPEN-ABX-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE ZEROES                     TO OBW-SSNO.
           PERFORM OPEN-OBW1-FILE.
           PERFORM START-OBW1-FILE.

           PERFORM OPEN-OBM1-FILE.
           PERFORM OPEN-OBX1-FILE.

      *=================================================================
       PROCESS-FILE-BW-NEXT.

           PERFORM READ-OBW1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-BW-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OBW-SSNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-BW-NEXT.

           PERFORM UPGRADE-FILE-BW.

           IF (FILE-OPTION-BW = "Y")
              PERFORM WRITE-BW1-FILE
           ELSE
              ADD 1 TO ABW-KEY
              ACCEPT ABW-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ABW-CR
              MOVE X"0A"              TO ABW-LF
              PERFORM WRITE-ABW-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE BW1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-BW-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-BW-NEXT.

      *=================================================================
       PROCESS-FILE-BW-END.

           PERFORM CLOSE-OBW1-FILE.
           MOVE OBW-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-OBM1-FILE.
           MOVE OBM-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-OBX1-FILE.
           MOVE OBX-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-BW = "Y")
              PERFORM CLOSE-BW1-FILE
              PERFORM CLOSE-BX1-FILE
           ELSE
              PERFORM CLOSE-ABW-FILE
              PERFORM CLOSE-ABX-FILE.
              

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "BWFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE BW-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE BW-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-BW-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C A
      *
      ******************************************************************
       PROCESS-FILE-CA SECTION.
           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CA = "N" )
              GO TO PROCESS-FILE-CA-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CA-PATH-OVERRIDE.
           MOVE "CA"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CAFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCA-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CA-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-CA = "Y")
              MOVE UP1534-FILE-PATH           TO CA-PATH
              PERFORM OPEN-CA1-FILE
           ELSE
              PERFORM LOAD-CA1-FILE
              MOVE UP1534-FILE-PATH TO ACA-PATH-BEG
                                       ACA-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ACA-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACA-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACA-PATH-GROUP 
                                            ACA-DONE-PATH-GROUP
              PERFORM OPEN-ACA-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0 TO OCA-BRNO OCA-DATE OCA-TILLNO.
           PERFORM OPEN-OCA1-FILE.
           PERFORM START-OCA1-FILE.

      *=================================================================
       PROCESS-FILE-CA-NEXT.

           PERFORM READ-OCA1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CA-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OCA-BRNO NOT NUMERIC
              ADD 1              TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CA-NEXT.

           MOVE OCA-DATE         TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.

      * BYPASS ALL RECORDS OVER 5 YEARS OLD FROM THE END-OF-MONTH DATE
      * FOR THE CURRENT SYSTEM DATE.
           IF DATE-YYYYMMDD      > WS-PURGE-DATE-YYYYMMDD 
              NEXT SENTENCE
           ELSE  
              ADD 1              TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CA-NEXT.

      * CLEANSE BR 701 HAD DATE 19623897 DRAWER 1 AND 3
      * CLEANSE BR 102 HAD DATE 19623897 DRAWER 1 AND 3
      *    MOVE OCA-DATE              TO DATE-MMDDYY.
      *    IF (DATE-MMDDYY-MM < 1 OR > 12) OR (DATE-MMDDYY-DD > 30)
      *       PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
      *       MOVE DATE-YYYYMMDD TO NUM-DATE
      *       PERFORM TSTDAT
      *       IF NUM-DATE = 0
      *          ADD 1              TO UP1534-RECORD-COUNTER-SKIP
      *          MOVE OCA1-KEY      TO UP1534-UPDATE-KEY
      *          MOVE "CADTE"       TO UP1534-UPDATE-STAT
      *          MOVE "E"           TO UP1534-UPDATE-TYPE
      *          PERFORM UP1534-CREATE-FILE-UPDATE
      *          GO TO PROCESS-FILE-CA-NEXT.

           PERFORM UPGRADE-FILE-CA.

           IF (FILE-OPTION-CA = "Y")
              PERFORM WRITE-CA1-FILE
           ELSE
              ADD 1 TO ACA-KEY
              ACCEPT ACA-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ACA-CR
              MOVE X"0A"              TO ACA-LF
              PERFORM WRITE-ACA-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CA1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-CA-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CA-NEXT.

      *=================================================================
       PROCESS-FILE-CA-END.

           PERFORM CLOSE-OCA1-FILE.
           MOVE OCA-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-CA = "Y")
              PERFORM CLOSE-CA1-FILE
           ELSE
              PERFORM CLOSE-ACA-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CAFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE CA-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE CA-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CA-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C I
      *
      ******************************************************************
       PROCESS-FILE-CI SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CI = "N" )
              GO TO PROCESS-FILE-CI-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CI-PATH-OVERRIDE.
           MOVE "CI"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CIFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCI-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CI-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-CI = "Y")
              MOVE UP1534-FILE-PATH           TO CI-PATH
              PERFORM OPEN-CI1-FILE
           ELSE
              PERFORM LOAD-CI1-FILE
              MOVE UP1534-FILE-PATH TO ACI-PATH-BEG
                                       ACI-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ACI-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACI-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACI-PATH-GROUP 
                                            ACI-DONE-PATH-GROUP
              PERFORM OPEN-ACI-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0                     TO OCI-ACCTNO.
           PERFORM OPEN-OCI1-FILE.
           PERFORM START-OCI1-FILE.


      *=================================================================
       PROCESS-FILE-CI-NEXT.

           PERFORM READ-OCI1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CI-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OCI-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CI-NEXT.

           PERFORM UPGRADE-FILE-CI.

           IF (FILE-OPTION-CI = "Y")
              PERFORM WRITE-CI1-FILE
           ELSE
              ADD 1 TO ACI-KEY
              ACCEPT ACI-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ACI-CR
              MOVE X"0A"              TO ACI-LF
              PERFORM WRITE-ACI-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CI1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-CI-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CI-NEXT.

      *=================================================================
       PROCESS-FILE-CI-END.

           PERFORM CLOSE-OCI1-FILE.
           MOVE OCI-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-CI = "Y")
              PERFORM CLOSE-CI1-FILE
           ELSE
              PERFORM CLOSE-ACI-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CIFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE CI-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE CI-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CI-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C K
      *
      ******************************************************************
       PROCESS-FILE-CK SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CK = "N" )
              GO TO PROCESS-FILE-CK-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CK-PATH-OVERRIDE.
           MOVE "CK"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CKFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCK-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CK-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-CK = "Y")
              MOVE UP1534-FILE-PATH           TO CK-PATH
              PERFORM OPEN-CK1-FILE
           ELSE
              PERFORM LOAD-CK1-FILE
              MOVE UP1534-FILE-PATH TO ACK-PATH-BEG
                                       ACK-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ACK-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ACK-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ACK-PATH-GROUP 
                                            ACK-DONE-PATH-GROUP
              PERFORM OPEN-ACK-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 0 TO OCK-BRNO OCK-NO.
           PERFORM OPEN-OCK1-FILE.
           PERFORM START-OCK1-FILE.

      *=================================================================
       PROCESS-FILE-CK-NEXT.

           PERFORM READ-OCK1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CK-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OCK-BRNO NOT NUMERIC OR
               OCK-NO NOT NUMERIC
              ADD 1   TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CK-NEXT.

           PERFORM UPGRADE-FILE-CK.

           IF (FILE-OPTION-CK = "Y")
              PERFORM WRITE-CK1-FILE
           ELSE
              ADD 1 TO ACK-KEY
              ACCEPT ACK-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ACK-CR
              MOVE X"0A"              TO ACK-LF
              PERFORM WRITE-ACK-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CK1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-CK-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CK-NEXT.

      *=================================================================
       PROCESS-FILE-CK-END.

           PERFORM CLOSE-OCK1-FILE.
           MOVE OCK-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-CK = "Y")
              PERFORM CLOSE-CK1-FILE
           ELSE
              PERFORM CLOSE-ACK-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CKFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE CK-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE CK-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CK-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L O C A L - C P
      *
      *-----------------------------------------------------------------
      *    THIS IS THE LOCAL CP 
      ******************************************************************
       PROCESS-FILE-LOCAL-CP SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CP = "N" )
              GO TO PROCESS-FILE-LOCAL-CP-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CP-PATH-OVERRIDE.
           MOVE "CP"                       TO UP1534-CURRENT-FILE.
           MOVE "SP/CPFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCP-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LOCAL-CP-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CP-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES TO OCP-ID.
           PERFORM OPEN-OCP1-FILE.
           PERFORM START-OCP1-FILE.

           PERFORM OPEN-CP1-FILE.

      *=================================================================
       PROCESS-FILE-LOCAL-CP-NEXT.

           PERFORM READ-OCP1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LOCAL-CP-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM CLEAR-CP-FILE.

      * GLOBAL CP-BRNO IS 0
      * LOCAL  CP-BRNO IS BRANCH
           MOVE BR-NO                      TO CP-BRNO.
           MOVE OCP-ID                     TO CP-ID.
           MOVE OCP-DESC                   TO CP-DESC.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 80
              MOVE OCP-COL-ID(SUB) TO CP-COL-ID(SUB)
           END-PERFORM.
           MOVE OCP-ALPHA-FLAG             TO CP-ALPHA-FLAG.
      * CLEANSE PIC 9(5) C-3
           IF OCP-TOTAL-ACCOUNTS NOT NUMERIC 
              MOVE 0                       TO CP-TOTAL-ACCOUNTS
           ELSE
              MOVE OCP-TOTAL-ACCOUNTS      TO CP-TOTAL-ACCOUNTS.
           IF OCP-COLLECTOR-COUNT NOT NUMERIC
              MOVE 0                       TO CP-COLLECTOR-COUNT
           ELSE
           MOVE OCP-COLLECTOR-COUNT        TO CP-COLLECTOR-COUNT.
           IF OCP-LAST-SUBSCRIPT NOT NUMERIC
              MOVE 0                       TO CP-LAST-SUBSCRIPT
           ELSE
           MOVE OCP-LAST-SUBSCRIPT         TO CP-LAST-SUBSCRIPT.

           PERFORM WRITE-CP1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CP1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LOCAL-CP-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LOCAL-CP-NEXT.

      *=================================================================
       PROCESS-FILE-LOCAL-CP-END.

           PERFORM CLOSE-OCP1-FILE.
           MOVE OCP-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-CP1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CPFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE CP-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE CP-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LOCAL-CP-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - C X
      *
      ******************************************************************
       PROCESS-FILE-CX SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-CX = "N" )
              GO TO PROCESS-FILE-CX-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO CX-PATH-OVERRIDE.
           MOVE "CX"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/CXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OCX-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-CX-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO CX-PATH.
           PERFORM OPEN-CX1-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES TO OCX-REC.
           MOVE ZEROES TO OCX-BRNO OCX-SEQNO.
           PERFORM OPEN-OCX1-FILE.
           PERFORM START-OCX1-FILE.

      *=================================================================
       PROCESS-FILE-CX-NEXT.

           PERFORM READ-OCX1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-CX-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OCX-BRNO NOT NUMERIC OR
               OCX-SEQNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-CX-NEXT.

           PERFORM UPGRADE-FILE-CX.

           PERFORM WRITE-CX1-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE CX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-CX-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-CX-NEXT.

      *=================================================================
       PROCESS-FILE-CX-END.

           PERFORM CLOSE-OCX1-FILE.
           MOVE OCX-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.
           PERFORM CLOSE-CX1-FILE

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "CXFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE CX-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE CX-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-CX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - D L
      *
      ******************************************************************
       PROCESS-FILE-DL SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-DL = "N" )
              GO TO PROCESS-FILE-DL-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO DL-PATH-OVERRIDE.
           MOVE "DL"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/DLFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO ODL-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-DL-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO DL-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE 0                     TO ODL-NUM.
           PERFORM OPEN-ODL1-FILE.
           PERFORM START-ODL1-FILE.

           PERFORM OPEN-DL1-FILE.

      *=================================================================
       PROCESS-FILE-DL-NEXT.

           PERFORM READ-ODL1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-DL-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF ODL-NUM NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-DL-NEXT.
              
           PERFORM CLEAR-DL-FILE.

           MOVE BR-NO           TO DL-BRNO.
           MOVE ODL-NUM         TO DL-NUM.
           MOVE ODL-NAME        TO DL-NAME.
           MOVE ODL-ADR1        TO DL-ADR1.
           MOVE ODL-ADR2        TO DL-ADR2.
           MOVE ODL-CITY        TO DL-CITY.
           MOVE ODL-STATE       TO DL-STATE.
           MOVE ODL-ZIP         TO DL-ZIP.
           MOVE ODL-SHORT       TO DL-SHORT.
           IF ODL-PHONE NOT NUMERIC
              MOVE 0            TO DL-PHONE
           ELSE
              MOVE ODL-PHONE    TO DL-PHONE.
           MOVE ODL-PURPOSE     TO DL-PURPOSE.
           MOVE ODL-MFGCODE     TO DL-MFGCODE.

           MOVE ODL-ORIGDATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD   TO DL-ORIGDATE.

           MOVE ODL-TERMDATE    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD   TO DL-TERMDATE.

           IF ODL-LC-CODE NOT NUMERIC
              MOVE 0            TO DL-LC-CODE
           ELSE
              MOVE ODL-LC-CODE  TO DL-LC-CODE.
           IF ODL-FULLCEIL NOT NUMERIC
              MOVE 0            TO DL-FULLCEIL
           ELSE
              MOVE ODL-FULLCEIL TO DL-FULLCEIL.
           IF ODL-PARTCEIL NOT NUMERIC
              MOVE 0            TO DL-PARTCEIL
           ELSE
              MOVE ODL-PARTCEIL TO DL-PARTCEIL.
           IF ODL-NONCEIL NOT NUMERIC
              MOVE 0            TO DL-NONCEIL
           ELSE
              MOVE ODL-NONCEIL  TO DL-NONCEIL.
           MOVE ODL-SIGN1       TO DL-SIGN1.
           MOVE ODL-SIGN2       TO DL-SIGN2.
           MOVE ODL-SIGN3       TO DL-SIGN3.

           IF ODL-MAXPURTRM NOT NUMERIC
              MOVE 0             TO DL-MAXPURTRM
           ELSE
              MOVE ODL-MAXPURTRM TO DL-MAXPURTRM.
           IF ODL-MAXPURPER NOT NUMERIC
              MOVE 0             TO DL-MAXPURPER
           ELSE
              MOVE ODL-MAXPURPER TO DL-MAXPURPER.
           IF ODL-EARNCD NOT NUMERIC
              MOVE 0             TO DL-EARNCD
           ELSE
              MOVE ODL-EARNCD    TO DL-EARNCD.
           IF ODL-EARNFAC NOT NUMERIC
              MOVE 0             TO DL-EARNFAC
           ELSE
              MOVE ODL-EARNFAC   TO DL-EARNFAC.

           IF ODL-DISC-FRMLA NOT NUMERIC
              MOVE 0              TO DL-DISC-FRMLA
           ELSE
              MOVE ODL-DISC-FRMLA TO DL-DISC-FRMLA.
           MOVE ODL-DISC-CODE   TO DL-DISC-CODE.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
             IF ODL-DISC-TERM(SUB) NOT NUMERIC
                MOVE 0                  TO DL-DISC-TERM(SUB)
             ELSE
                MOVE ODL-DISC-TERM(SUB) TO DL-DISC-TERM(SUB)
             END-IF
             IF ODL-DISC-RATE(SUB) NOT NUMERIC
                MOVE 0                  TO DL-DISC-RATE(SUB)
             ELSE
                MOVE ODL-DISC-RATE(SUB) TO DL-DISC-RATE(SUB)
             END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
              IF ODL-RVPRIN-FRMLA(S1) NOT NUMERIC
                 MOVE 0                    TO DL-RVPRIN-FRMLA(S1)
              ELSE
                 MOVE ODL-RVPRIN-FRMLA(S1) TO DL-RVPRIN-FRMLA(S1)
              END-IF
              IF ODL-RVCHGS-FRMLA(S1) NOT NUMERIC
                 MOVE 0                    TO DL-RVCHGS-FRMLA(S1)
              ELSE
                 MOVE ODL-RVCHGS-FRMLA(S1) TO DL-RVCHGS-FRMLA(S1)
              END-IF
              MOVE ODL-RVPRIN-CODE(S1)        TO DL-RVPRIN-CODE(S1)
              MOVE ODL-RVCHGS-CODE(S1)        TO DL-RVCHGS-CODE(S1)
              IF ODL-RVPRIN-ADDON(S1) NOT NUMERIC
                 MOVE 0                       TO DL-RVPRIN-ADDON(S1)
              ELSE
                 MOVE ODL-RVPRIN-ADDON(S1)    TO DL-RVPRIN-ADDON(S1)
              END-IF
              IF ODL-RVCHGS-ADDON(S1) NOT NUMERIC
                 MOVE 0                    TO DL-RVCHGS-ADDON(S1)
              ELSE
                 MOVE ODL-RVCHGS-ADDON(S1) TO DL-RVCHGS-ADDON(S1)
              END-IF
              PERFORM VARYING S2 FROM 1 BY 1 UNTIL S2 > 6
                 IF ODL-RVPRIN-TERM(S1,S2) NOT NUMERIC
                    MOVE 0              TO DL-RVPRIN-TERM(S1,S2)
                 ELSE
                    MOVE ODL-RVPRIN-TERM(S1,S2)
                                        TO DL-RVPRIN-TERM(S1,S2)
                 END-IF
                 IF ODL-RVCHGS-TERM(S1,S2) NOT NUMERIC
                    MOVE 0              TO DL-RVCHGS-TERM(S1,S2)
                 ELSE
                    MOVE ODL-RVCHGS-TERM(S1,S2)
                                        TO DL-RVCHGS-TERM(S1,S2)
                 END-IF
                 IF ODL-RVPRIN-RATE(S1,S2) NOT NUMERIC
                    MOVE 0              TO DL-RVPRIN-RATE(S1,S2)
                 ELSE
                    MOVE ODL-RVPRIN-RATE(S1,S2)
                                        TO DL-RVPRIN-RATE(S1,S2)
                 END-IF
                 IF ODL-RVCHGS-RATE(S1,S2) NOT NUMERIC
                    MOVE 0              TO DL-RVCHGS-RATE(S1,S2)
                 ELSE
                    MOVE ODL-RVCHGS-RATE(S1,S2)
                                        TO DL-RVCHGS-RATE(S1,S2)
                 END-IF
              END-PERFORM
           END-PERFORM.

           IF ODL-PARVHELD-FRMLA NOT NUMERIC
              MOVE 0                        TO DL-PARVHELD-FRMLA
           ELSE
              MOVE ODL-PARVHELD-FRMLA       TO DL-PARVHELD-FRMLA.
           MOVE ODL-PARVHELD-CODE           TO DL-PARVHELD-CODE.
           IF ODL-PARVHELD-ADDON NOT NUMERIC
              MOVE 0                        TO DL-PARVHELD-ADDON
           ELSE
           MOVE ODL-PARVHELD-ADDON          TO DL-PARVHELD-ADDON.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
              IF ODL-PARVHELD-TERM(SUB) NOT NUMERIC
                 MOVE 0                        TO DL-PARVHELD-TERM(SUB)
              ELSE
                 MOVE ODL-PARVHELD-TERM(SUB)   TO DL-PARVHELD-TERM(SUB)
              END-IF
              IF ODL-PARVPAID-TERM(SUB) NOT NUMERIC
                 MOVE 0                        TO DL-PARVPAID-TERM(SUB)
              ELSE
                 MOVE ODL-PARVPAID-TERM(SUB)   TO DL-PARVPAID-TERM(SUB)
              END-IF
              IF ODL-PARVHELD-RATE(SUB) NOT NUMERIC
                 MOVE 0                        TO DL-PARVHELD-RATE(SUB)
              ELSE
                 MOVE ODL-PARVHELD-RATE(SUB)   TO DL-PARVHELD-RATE(SUB)
              END-IF
              IF ODL-PARVPAID-RATE(SUB) NOT NUMERIC
                 MOVE 0                        TO DL-PARVPAID-RATE(SUB)
              ELSE
                 MOVE ODL-PARVPAID-RATE(SUB)   TO DL-PARVPAID-RATE(SUB)
              END-IF
           END-PERFORM.

           IF ODL-PARVPAID-FRMLA NOT NUMERIC
              MOVE 0                        TO DL-PARVPAID-FRMLA
           ELSE
              MOVE ODL-PARVPAID-FRMLA       TO DL-PARVPAID-FRMLA.
           MOVE ODL-PARVPAID-CODE           TO DL-PARVPAID-CODE.
           IF ODL-PARVPAID-ADDON NOT NUMERIC
              MOVE 0                        TO DL-PARVPAID-ADDON
           ELSE
              MOVE ODL-PARVPAID-ADDON       TO DL-PARVPAID-ADDON.

           IF ODL-SVACCT-FRMLA NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-FRMLA
           ELSE
              MOVE ODL-SVACCT-FRMLA         TO DL-SVACCT-FRMLA.
           MOVE ODL-SVCODE                  TO DL-SVCODE.
           IF ODL-SVACCT-AMT NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-AMT
           ELSE
              MOVE ODL-SVACCT-AMT           TO DL-SVACCT-AMT.
           IF ODL-SVACCT-RATE NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-RATE
           ELSE
              MOVE ODL-SVACCT-RATE          TO DL-SVACCT-RATE.
           IF ODL-SVACCT-LCHGPER NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-LCHGPER
           ELSE
              MOVE ODL-SVACCT-LCHGPER       TO DL-SVACCT-LCHGPER.
           IF ODL-SVACCT-INTPER NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-INTPER
           ELSE
              MOVE ODL-SVACCT-INTPER        TO DL-SVACCT-INTPER.
           IF ODL-SVACCT-DEFPER NOT NUMERIC
              MOVE 0                        TO DL-SVACCT-DEFPER
           ELSE
              MOVE ODL-SVACCT-DEFPER        TO DL-SVACCT-DEFPER.
           IF ODL-FULLCEIL-BAL NOT NUMERIC
              MOVE 0                        TO DL-FULLCEIL-BAL
           ELSE
              MOVE ODL-FULLCEIL-BAL         TO DL-FULLCEIL-BAL.
           IF ODL-PARTCEIL-BAL NOT NUMERIC
              MOVE 0                        TO DL-PARTCEIL-BAL
           ELSE
              MOVE ODL-PARTCEIL-BAL         TO DL-PARTCEIL-BAL.
           IF ODL-NONCEIL-BAL NOT NUMERIC
              MOVE 0                        TO DL-NONCEIL-BAL
           ELSE
              MOVE ODL-NONCEIL-BAL          TO DL-NONCEIL-BAL.
           MOVE ODL-AFP-DEALER              TO DL-AFP-DEALER.
           MOVE ODL-RECOURSE-FRMLA          TO DL-RECOURSE-FRMLA.
           IF ODL-FAX-NUMBER NOT NUMERIC
              MOVE 0                        TO DL-FAX-NUMBER
           ELSE
              MOVE ODL-FAX-NUMBER           TO DL-FAX-NUMBER.
           MOVE ODL-PARVPAID-FRMLA-IB       TO DL-PARVPAID-FRMLA-IB.
           MOVE ODL-PARVPAID-CODE-IB        TO DL-PARVPAID-CODE-IB.
           MOVE ODL-LPO                     TO DL-LPO.
           MOVE ODL-ACH-FG                  TO DL-ACH-FG.
           IF ODL-BANK-ROUTING-NO NOT NUMERIC
              MOVE 0                        TO DL-BANK-ROUTING-NO
           ELSE
              MOVE ODL-BANK-ROUTING-NO      TO DL-BANK-ROUTING-NO.
           MOVE ODL-BANK-ACCTNO             TO DL-BANK-ACCTNO.
           MOVE ODL-ACH-PRENOTE-FG          TO DL-ACH-PRENOTE-FG.
      * CLEANSE  DL-SAL-MISC-PCT            PIC 99V99 COMP-3.
      *          DL-SAL-MISC-PCT2           PIC 99V99 COMP-3.
           IF ODL-SAL-MISC-PCT = 20.20 OR 02.02 OR
                 (ODL-SAL-MISC-PCT NOT NUMERIC)
              MOVE 0                        TO DL-SAL-MISC-PCT
           ELSE
              MOVE ODL-SAL-MISC-PCT         TO DL-SAL-MISC-PCT.
           IF ODL-SAL-MISC-PCT2 = 20.20 OR 02.02 OR
                 (ODL-SAL-MISC-PCT2 NOT NUMERIC)
              MOVE 0                        TO DL-SAL-MISC-PCT2
           ELSE
              MOVE ODL-SAL-MISC-PCT2        TO DL-SAL-MISC-PCT2.

           MOVE ODL-WAIVE-ACH-FEE           TO DL-WAIVE-ACH-FEE.
           MOVE ODL-TRACK-CHANGE-FLAG       TO DL-TRACK-CHANGE-FLAG.
           MOVE SPACES                      TO DL-DBA-NAME.

           PERFORM WRITE-DL1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE DL1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-DL-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-DL-NEXT.

      *=================================================================
       PROCESS-FILE-DL-END.

           PERFORM CLOSE-ODL1-FILE.
           MOVE ODL-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-DL1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "DLFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE DL-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE DL-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-DL-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - D M
      *
      ******************************************************************
      * PROCESS-FILE-DM SECTION.

      *     MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *     IF ( FILE-OPTION-DM = "N" )
      *        GO TO PROCESS-FILE-DM-EXIT.

      **- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *     MOVE "Y"                        TO DM-PATH-OVERRIDE.
      *     MOVE "DM"                       TO UP1534-CURRENT-FILE.
      *     MOVE "LP/DMFILE"                TO UP1534-FILE-INPUT.
      *     MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *     MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *     PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *     PERFORM UP1534-VPI-START.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *     MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *     PERFORM UP1534-MV15-OLD-TO-NEW.
      *     MOVE UP1534-MV15-NEW-PATH       TO ODM-PATH.

      *     IF ( STAT-BAD )     
      *        MOVE STAT                    TO UPGRADE-STAT
      *        PERFORM UP1534-CREATE-FILE-ERROR
      *        GO TO PROCESS-FILE-DM-EXIT.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *     MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO DM-PATH.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE ZEROES                     TO ODM-DL-NUM
      *                                        ODM-DATE
      *                                        ODM-SEQ.
      *     PERFORM OPEN-ODM1-FILE.
      *     PERFORM START-ODM1-FILE.

      *     PERFORM OPEN-DM1-FILE.

      **=================================================================
      * PROCESS-FILE-DM-NEXT.

      *     PERFORM READ-ODM1-FILE-NEXT.
      *     IF ( IO-BAD )
      *        GO TO PROCESS-FILE-DM-END.

      *     ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *     MOVE "Y" TO RECORDS-FOUND.
      *     PERFORM UP1534-VPI-DISPLAY.

      *     MOVE SPACES TO DM-REC.

      *     MOVE BR-NO TO  DM-BRNO.
      ** USING DEALER FILE FIELDS JUST TO FORMAT THE DEALER NO.
      *     MOVE ODM-DL-NUM TO DL-NUM.
      *     MOVE DL-DLNO    TO DM-DL-DLNO.
      *     MOVE ODM-DATE   TO DM-DATE.
      *     MOVE ODM-SEQ    TO DM-SEQ.

      *     MOVE ODM-MEMO      TO DM-MEMO.
      *     MOVE ODM-MEMO-TYPE TO DM-MEMO-TYPE.

      *     PERFORM WRITE-DM1-FILE.
      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE DM1-KEY                 TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           GO TO PROCESS-FILE-DM-NEXT
      *        ELSE
      *           GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *     GO TO PROCESS-FILE-DM-NEXT.

      **=================================================================
      * PROCESS-FILE-DM-END.

      *     PERFORM CLOSE-ODM1-FILE.
      *     MOVE ODM-PATH TO UP1534-MV15-NEW-PATH.
      *     PERFORM UP1534-MV15-NEW-TO-OLD.

      *     PERFORM CLOSE-DM1-FILE.

      *     PERFORM UP1534-CREATE-FILE-TOTALS.
      *     MOVE "DMFILE"                   TO HOLD-SORT-FILENAME.
      *     MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *     MOVE DM-PATH-OWNST              TO HOLD-SORT-STATE.
      *     MOVE DM-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *     PERFORM UPDATE-SORT-MODULE.

      * PROCESS-FILE-DM-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - D S
      *
      ******************************************************************
      *PROCESS-FILE-DS SECTION.

      *    MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *    IF ( FILE-OPTION-DS = "N" )
      *       GO TO PROCESS-FILE-DS-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *    MOVE "Y"                        TO DS-PATH-OVERRIDE.
      *    MOVE "DS"                       TO UP1534-CURRENT-FILE.
      *    MOVE "LP/DSFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *    MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *    PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *    PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO ODS-PATH.

      *    IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *       GO TO PROCESS-FILE-DS-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *    MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO DS-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE ZEROES                     TO ODS-DATE
      *                                       ODS-BRANCH
      *                                       ODS-DLNO
      *                                       ODS-CLASS.
      *    PERFORM OPEN-ODS1-FILE.
      *    PERFORM START-ODS1-FILE.

      *    PERFORM OPEN-DS1-FILE.

      *=================================================================
      *PROCESS-FILE-DS-NEXT.

      *    PERFORM READ-ODS1-FILE-NEXT.
      *    IF ( IO-BAD )
      *       GO TO PROCESS-FILE-DS-END.

      *    ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *    MOVE "Y" TO RECORDS-FOUND.
      *    PERFORM UP1534-VPI-DISPLAY.

      *    PERFORM UPGRADE-FILE-DS.

      *    PERFORM WRITE-DS1-FILE.
      *    IF ( IO-BAD )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       MOVE DS1-KEY                 TO UP1534-UPDATE-KEY
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
      *       IF ( FILE-STAT-DISP = "22,00" )
      *          GO TO PROCESS-FILE-DS-NEXT
      *       ELSE
      *          GO TO IO-ERROR.

      *    ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *    GO TO PROCESS-FILE-DS-NEXT.

      *=================================================================
      *PROCESS-FILE-DS-END.

      *    PERFORM CLOSE-ODS1-FILE.
      *    MOVE ODS-PATH TO UP1534-MV15-NEW-PATH.
      *    PERFORM UP1534-MV15-NEW-TO-OLD.

      *    PERFORM CLOSE-DS1-FILE.

      *    PERFORM UP1534-CREATE-FILE-TOTALS.
      *    MOVE "DSFILE"                   TO HOLD-SORT-FILENAME.
      *    MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *    MOVE DS-PATH-OWNST              TO HOLD-SORT-STATE.
      *    MOVE DS-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *    PERFORM UPDATE-SORT-MODULE.

      *PROCESS-FILE-DS-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - D T
      *
      ******************************************************************
       PROCESS-FILE-DT SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-DT = "N" )
              GO TO PROCESS-FILE-DT-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO DT-PATH-OVERRIDE.
           MOVE "DT"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/DTFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO ODT-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-DT-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO DT-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES                     TO ODT-DLNO
                                              ODT-CLASS
                                              ODT-ACCTNO
                                              ODT-DATE
                                              ODT-SEQ.
           PERFORM OPEN-ODT1-FILE.
           PERFORM START-ODT1-FILE.

           PERFORM OPEN-DT1-FILE.

      *=================================================================
       PROCESS-FILE-DT-NEXT.

           PERFORM READ-ODT1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-DT-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF ODT-NUM NOT NUMERIC OR
               ODT-CLASS NOT NUMERIC OR
                ODT-ACCTNO NOT NUMERIC OR
                 ODT-DATE NOT NUMERIC OR
                  ODT-SEQ NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-DT-NEXT.

           PERFORM UPGRADE-FILE-DT.

           PERFORM WRITE-DT1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE DT1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-DT-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-DT-NEXT.

      *=================================================================
       PROCESS-FILE-DT-END.

           PERFORM CLOSE-ODT1-FILE.
           MOVE ODT-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-DT1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "DTFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE DT-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE DT-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-DT-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - E S
      *
      ******************************************************************
      * PROCESS-FILE-ES SECTION.

      *     MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *     IF ( FILE-OPTION-ES = "N" )
      *        GO TO PROCESS-FILE-ES-EXIT.

      **- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *     MOVE "Y"                        TO ES-PATH-OVERRIDE
      *     MOVE "ES"                       TO UP1534-CURRENT-FILE.
      *     MOVE "LP/ESFILE"                TO UP1534-FILE-INPUT.
      *     MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *     MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *     PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *     PERFORM UP1534-VPI-START.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *     MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *     PERFORM UP1534-MV15-OLD-TO-NEW.
      *     MOVE UP1534-MV15-NEW-PATH       TO OES-PATH.

      *     IF ( STAT-BAD )     
      *        MOVE STAT                    TO UPGRADE-STAT
      *        PERFORM UP1534-CREATE-FILE-ERROR
      *        GO TO PROCESS-FILE-ES-EXIT.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *     MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO ES-PATH.

      **- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
      *     MOVE ZEROES                     TO OES-ACCTNO.
      *     PERFORM OPEN-OES1-FILE.
      *     PERFORM START-OES1-FILE.

      *     PERFORM OPEN-ES1-FILE.

      **=================================================================
      * PROCESS-FILE-ES-NEXT.

      *     PERFORM READ-OES1-FILE-NEXT.
      *     IF ( IO-BAD )
      *        GO TO PROCESS-FILE-ES-END.

      *     ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *     MOVE "Y" TO RECORDS-FOUND.
      *     PERFORM UP1534-VPI-DISPLAY.

      *     PERFORM UPGRADE-FILE-ES.

      *     PERFORM WRITE-ES1-FILE.
      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE ES1-KEY                 TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           GO TO PROCESS-FILE-ES-NEXT
      *        ELSE
      *           GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *     GO TO PROCESS-FILE-ES-NEXT.

      **=================================================================
      * PROCESS-FILE-ES-END.

      *     PERFORM CLOSE-OES1-FILE.
      *     MOVE OES-PATH TO UP1534-MV15-NEW-PATH.
      *     PERFORM UP1534-MV15-NEW-TO-OLD.

      *     PERFORM CLOSE-ES1-FILE.

      *     PERFORM UP1534-CREATE-FILE-TOTALS.
      *     MOVE "ESFILE"                   TO HOLD-SORT-FILENAME.
      *     MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *     MOVE ES-PATH-OWNST              TO HOLD-SORT-STATE.
      *     MOVE ES-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *     PERFORM UPDATE-SORT-MODULE.

      * PROCESS-FILE-ES-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - G B
      *
      ******************************************************************
       PROCESS-FILE-GB SECTION.
           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-GB = "N" )
              GO TO PROCESS-FILE-GB-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO GB-PATH-OVERRIDE.
           MOVE "GB"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/GBFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OGB-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-GB-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO GB-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE 1             TO OGB-KEY.
           PERFORM OPEN-OGB-FILE.
           PERFORM START-OGB-FILE.

           PERFORM OPEN-GB-FILE.

      *=================================================================
       PROCESS-FILE-GB-NEXT.

           PERFORM READ-OGB-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-GB-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM CLEAR-GB-FILE.

           MOVE BR-NO               TO GB-BRNO.
           MOVE OGB-KEY             TO GB-NO.

           MOVE OGB-COMPANY-NAME    TO GB-COMPANY-NAME.
           MOVE OGB-ADDR-1          TO GB-ADDR-1.
           MOVE OGB-ADDR-2          TO GB-ADDR-2.
           MOVE OGB-CITY            TO GB-CITY.
           MOVE OGB-STATE           TO GB-STATE.
           MOVE OGB-ZIP             TO GB-ZIP.
           IF OGB-PHONE NOT NUMERIC
              MOVE 0                TO GB-PHONE
           ELSE
              MOVE OGB-PHONE        TO GB-PHONE.
           IF OGB-NEXT-SF NOT NUMERIC
              MOVE 0                TO GB-NEXT-SF
           ELSE
              MOVE OGB-NEXT-SF      TO GB-NEXT-SF.
           IF OGB-NEXT-SMALL NOT NUMERIC
              MOVE 0                TO GB-NEXT-SMALL
           ELSE
              MOVE OGB-NEXT-SMALL   TO GB-NEXT-SMALL.
           IF OGB-NEXT-OTHER NOT NUMERIC
              MOVE 0                TO GB-NEXT-OTHER
           ELSE
              MOVE OGB-NEXT-OTHER   TO GB-NEXT-OTHER.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 16
               IF OGB-HOLIDAY(SUB) NOT NUMERIC
                  MOVE 0                TO GB-HOLIDAY(SUB)
               ELSE
                  MOVE OGB-HOLIDAY(SUB) TO GB-HOLIDAY(SUB)
               END-IF
           END-PERFORM.

           IF OGB-RPT-LINES NOT NUMERIC
              MOVE 0                  TO GB-RPT-LINES
           ELSE
              MOVE OGB-RPT-LINES      TO GB-RPT-LINES.
           MOVE OGB-CHECK-PROG        TO GB-CHECK-PROG.
           MOVE OGB-OTHER-BRANCH-POST TO GB-OTHER-BRANCH-POST.
           IF OGB-LAST-ACCRUE NOT NUMERIC
              MOVE 0                  TO GB-LAST-ACCRUE
           ELSE
              MOVE OGB-LAST-ACCRUE    TO GB-LAST-ACCRUE.
           MOVE OGB-AUTO-DEPOSIT      TO GB-AUTO-DEPOSIT.
           MOVE OGB-UUCP-HOME         TO GB-UUCP-HOME.

           PERFORM WRITE-GB-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE GB-KEY                  TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-GB-NEXT
              ELSE
                 GO TO IO-ERROR.
           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-GB-NEXT.

       PROCESS-FILE-GB-END.

           PERFORM CLOSE-OGB-FILE.
           MOVE OGB-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-GB-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "GBFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE GB-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE GB-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-GB-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - I C
      *
      ******************************************************************
       PROCESS-FILE-IC SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-IC = "N" )
              GO TO PROCESS-FILE-IC-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO IC-PATH-OVERRIDE.
           MOVE "IC"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/ICFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OIC-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-IC-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO IC-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES                     TO OIC-CODE.
           PERFORM OPEN-OIC1-FILE.
           PERFORM START-OIC1-FILE.

           PERFORM OPEN-IC1-FILE.

      *=================================================================
       PROCESS-FILE-IC-NEXT.

           PERFORM READ-OIC1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-IC-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF OIC-CODE NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-IC-NEXT.

           MOVE BR-NO                      TO IC-BRNO.
           MOVE OIC-CODE                   TO IC-CODE.
           MOVE OIC-NAME                   TO IC-NAME.
           MOVE OIC-ADDR1                  TO IC-ADDR1.
           MOVE OIC-ADDR2                  TO IC-ADDR2.
           MOVE OIC-CITY                   TO IC-CITY.
           MOVE OIC-STATE                  TO IC-STATE.
           MOVE OIC-ZIP                    TO IC-ZIP.
           IF OIC-PHONE NOT NUMERIC
              MOVE 0                       TO IC-PHONE
           ELSE
           MOVE OIC-PHONE                  TO IC-PHONE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 13
             IF OIC-COMMRATE(SUB) NOT NUMERIC
                MOVE 0                     TO IC-COMMRATE(SUB)
             ELSE
             MOVE OIC-COMMRATE(SUB)        TO IC-COMMRATE(SUB)
             END-IF
           END-PERFORM.

           MOVE 0 TO IC-COMMRATE(14).

           PERFORM WRITE-IC1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE IC1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-IC-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-IC-NEXT.

      *=================================================================
       PROCESS-FILE-IC-END.

           PERFORM CLOSE-OIC1-FILE.
           MOVE OIC-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-IC1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "ICFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE IC-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE IC-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-IC-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - I X
      *
      ******************************************************************
       PROCESS-FILE-IX SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-IX = "N" )
              GO TO PROCESS-FILE-IX-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO IX-PATH-OVERRIDE.
           MOVE "IX"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/IXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OIX-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-IX-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-IX = "Y")
              MOVE UP1534-FILE-PATH        TO IX-PATH
              PERFORM OPEN-IX1-FILE
           ELSE
              PERFORM LOAD-IX1-FILE
              MOVE UP1534-FILE-PATH TO AIX-PATH-BEG
                                       AIX-DONE-PATH-BEG
              CALL "C$TOLOWER" USING AIX-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING AIX-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO AIX-PATH-GROUP 
                                            AIX-DONE-PATH-GROUP
              PERFORM OPEN-AIX-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OIX1-KEY.
           PERFORM OPEN-OIX1-FILE.
           PERFORM START-OIX1-FILE.

      *=================================================================
       PROCESS-FILE-IX-NEXT.

           PERFORM READ-OIX1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-IX-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF OIX-LT-ID-ACCTNO NOT NUMERIC OR
               OIX-LT-ID-SEQNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-IX-NEXT.

           IF (FILE-OPTION-IX = "Y")
              MOVE SPACES    TO IX-REC
           ELSE
              MOVE ALL X"09" TO AIX-REC.

           MOVE BR-NO            TO IX-BRNO     AIX-BRNO.
           MOVE OIX-CODE         TO IX-CODE     AIX-CODE.
           MOVE OIX-LT-ID-ACCTNO TO OLD-ACCTNO.
           MOVE NEW-ACCTNO       TO IX-ACCTNO   AIX-ACCTNO.
           MOVE OIX-LT-ID-SEQNO  TO IX-SEQNO    AIX-SEQNO.

           MOVE OIX-LT-ID        TO IX-VIN      AIX-VIN.

           IF (FILE-OPTION-IX = "Y")
              PERFORM WRITE-IX1-FILE
           ELSE
              ADD 1 TO AIX-KEY
              ACCEPT AIX-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO AIX-CR
              MOVE X"0A"              TO AIX-LF
              PERFORM WRITE-AIX-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE IX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-IX-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-IX-NEXT.

      *=================================================================
       PROCESS-FILE-IX-END.

           PERFORM CLOSE-OIX1-FILE.
           MOVE OIX-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-IX = "Y")
              PERFORM CLOSE-IX1-FILE
           ELSE
              PERFORM CLOSE-AIX-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "IXFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE IX-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE IX-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-IX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L E
      *
      ******************************************************************
       PROCESS-FILE-LE SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LE = "N" )
              GO TO PROCESS-FILE-LE-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LE-PATH-OVERRIDE.
           MOVE "LE"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LEFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLE-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LE-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LE = "Y")
               MOVE UP1534-FILE-PATH           TO LE-PATH
               PERFORM OPEN-LE1-FILE
           ELSE
               PERFORM LOAD-LE1-FILE
              MOVE UP1534-FILE-PATH TO ALE-PATH-BEG
                                       ALE-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALE-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALE-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALE-PATH-GROUP 
                                            ALE-DONE-PATH-GROUP
              PERFORM OPEN-ALE-FILE.


           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLE1-KEY.
           MOVE ZEROES                     TO OLE-ACCTNO
                                              OLE-OSACCTNO.

           PERFORM OPEN-OLE1-FILE.
           PERFORM START-OLE1-FILE.


      *=================================================================
       PROCESS-FILE-LE-NEXT.

           PERFORM READ-OLE1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LE-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF OLE-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LE-NEXT.

           IF OLE-TYPE NOT = "R"          *> SKIP PER MULLEN; 2024-0206
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LE-NEXT.

           PERFORM UPGRADE-FILE-LE.

           IF (FILE-OPTION-LE = "Y")
              PERFORM WRITE-LE1-FILE
           ELSE
              ADD 1 TO ALE-KEY
              ACCEPT ALE-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALE-CR
              MOVE X"0A"              TO ALE-LF
              PERFORM WRITE-ALE-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LE1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LE-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LE-NEXT.

      *=================================================================
       PROCESS-FILE-LE-END.

           PERFORM CLOSE-OLE1-FILE.
           MOVE OLE-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-LE = "Y")
              PERFORM CLOSE-LE1-FILE
           ELSE
              PERFORM CLOSE-ALE-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LEFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LE-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LE-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L H
      *
      ******************************************************************
       PROCESS-FILE-LH SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LH = "N" )
              GO TO PROCESS-FILE-LH-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LH-PATH-OVERRIDE.
           MOVE "LH"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LHFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLH-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LH-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LH = "Y")
               MOVE UP1534-FILE-PATH           TO LH-PATH
               PERFORM OPEN-LH1-FILE
           ELSE
               PERFORM LOAD-LH1-FILE
              MOVE UP1534-FILE-PATH TO ALH-PATH-BEG
                                       ALH-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALH-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALH-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALH-PATH-GROUP 
                                            ALH-DONE-PATH-GROUP
              PERFORM OPEN-ALH-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLH1-KEY.
           MOVE ZEROES                     TO OLH-SSNO
                                              OLH-ACCTNO.
           PERFORM OPEN-OLH1-FILE.
           PERFORM START-OLH1-FILE.

      *=================================================================
       PROCESS-FILE-LH-NEXT.

           PERFORM READ-OLH1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LH-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF OLH-SSNO NOT NUMERIC OR
               OLH-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LH-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JKC 2024-0503 FOUND RECORDS WITH ZERO ACCOUNT NUMBERS;
      * PER KEVIN MULLEN WE CAN SKIP LOADING THESE RECORDS IN DATABASE;
      * 6 RECORDS AS OF 2024-0331 WILL BE SKIPPED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLH-ACCTNO TO OLD-ACCTNO.

           IF NEW-ACCTNO = 0
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LH-NEXT.

           IF OLH-LOANDATE = 0
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE OLH1-KEY                TO UP1534-UPDATE-KEY
              MOVE "LNDTE"                 TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              GO TO PROCESS-FILE-LH-NEXT.

           MOVE ZEROES                     TO HOLD-LH1-KEY.

           IF FILE-OPTION-LH = "A"
              PERFORM CLEAR-ALH-FILE
           ELSE
              PERFORM CLEAR-LH-FILE.

           MOVE BR-NO              TO LH-BRNO   ALH-BRNO.
           MOVE OLH-SSNO           TO LH-SSNO   ALH-SSNO.
           MOVE OLH-ACCTNO         TO OLD-ACCTNO.
           MOVE NEW-ACCTNO         TO LH-ACCTNO ALH-ACCTNO.

           IF OLH-CLASS NOT NUMERIC
              MOVE 0               TO LH-CLASS   ALH-CLASS
           ELSE
              MOVE OLH-CLASS       TO LH-CLASS   ALH-CLASS.
           IF OLH-LAWCD NOT NUMERIC
              MOVE 0               TO LH-LAWCD   ALH-LAWCD
           ELSE
              MOVE OLH-LAWCD       TO LH-LAWCD   ALH-LAWCD.
           MOVE OLH-COLLCD         TO LH-COLLCD  ALH-COLLCD.
           MOVE OLH-MAKERCD        TO LH-MAKERCD ALH-MAKERCD.
           MOVE OLH-POCD           TO LH-POCD    ALH-POCD.

           IF OLH-LOANDATE NOT NUMERIC
              MOVE 0               TO LH-LOANDATE ALH-LOANDATE
           ELSE
              MOVE OLH-LOANDATE    TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LH-LOANDATE ALH-LOANDATE.
           IF OLH-PLDATE NOT NUMERIC
              MOVE 0               TO LH-PLDATE ALH-PLDATE
           ELSE
              MOVE OLH-PLDATE      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD      TO LH-PLDATE   ALH-PLDATE.
           IF OLH-JDDATE NOT NUMERIC
              MOVE 0               TO LH-JDDATE ALH-JDDATE
           ELSE
              MOVE OLH-JDDATE      TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LH-JDDATE   ALH-JDDATE.
      * CLEANSE BR 802 590528525 10046-01 2/29/1998
           IF OLH-PAIDOFF NOT NUMERIC
              MOVE 0 TO LH-POFFDATE ALH-POFFDATE
           ELSE
              MOVE OLH-PAIDOFF     TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD   TO LH-POFFDATE ALH-POFFDATE.

           IF OLH-LNAMT NOT NUMERIC
              MOVE 0               TO LH-LNAMT     ALH-LNAMT
           ELSE
              MOVE OLH-LNAMT       TO LH-LNAMT     ALH-LNAMT.
           IF OLH-ORGTERM NOT NUMERIC
              MOVE 0               TO LH-ORGTERM   ALH-ORGTERM
           ELSE
              MOVE OLH-ORGTERM     TO LH-ORGTERM   ALH-ORGTERM.
           IF OLH-POTERMS NOT NUMERIC
              MOVE 0               TO LH-POTERMS   ALH-POTERMS
           ELSE
              MOVE OLH-POTERMS     TO LH-POTERMS   ALH-POTERMS.
           IF OLH-PYPROFILE NOT NUMERIC
              MOVE 0               TO LH-PYPROFILE ALH-PYPROFILE
           ELSE
              MOVE OLH-PYPROFILE   TO LH-PYPROFILE ALH-PYPROFILE.
           IF OLH-DLNO NOT NUMERIC
              MOVE 0               TO LH-DLNO      ALH-DLNO
           ELSE
              MOVE OLH-DLNO        TO LH-DLNO      ALH-DLNO.
           MOVE OLH-STATUS         TO LH-STATUS    ALH-STATUS.
           MOVE OLH-ARCHIVE-FG     TO LH-ARCHIVE-FG ALH-ARCHIVE-FG.

           IF (FILE-OPTION-LH = "Y")
              PERFORM WRITE-LH1-FILE
           ELSE
              ADD 1 TO ALH-KEY
              ACCEPT ALH-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"      TO ALH-CR
              MOVE X"0A"      TO ALH-LF
              PERFORM WRITE-ALH-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LH1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LH-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LH-NEXT.

      *=================================================================
       PROCESS-FILE-LH-END.

           PERFORM CLOSE-OLH1-FILE.
           MOVE OLH-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-LH = "Y")
              PERFORM CLOSE-LH1-FILE
           ELSE
              PERFORM CLOSE-ALH-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LHFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LH-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LH-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LH-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L N
      *
      ******************************************************************
       PROCESS-FILE-LN SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LN = "N" )
              GO TO PROCESS-FILE-LN-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LN-PATH-OVERRIDE.
           MOVE "LN"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LNFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLN-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LN-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LN = "Y")
              MOVE UP1534-FILE-PATH           TO LN-PATH
              PERFORM OPEN-LN1-FILE
           ELSE
              PERFORM LOAD-LN1-FILE
              MOVE UP1534-FILE-PATH TO ALN-PATH-BEG
                                       ALN-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALN-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALN-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALN-PATH-GROUP 
                                            ALN-DONE-PATH-GROUP
              PERFORM OPEN-ALN-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLN1-KEY.
           MOVE ZEROES                     TO OLN-ACCTNO.
           PERFORM OPEN-OLN1-FILE.
           PERFORM START-OLN1-FILE.

      *=================================================================
       PROCESS-FILE-LN-NEXT.

           PERFORM READ-OLN1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LN-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           IF OLN-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LN-NEXT.

           PERFORM UP1534-VPI-DISPLAY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JKC 2024-0503 FOUND RECORDS WITH ZERO ACCOUNT NUMBERS;
      * PER KEVIN MULLEN WE CAN SKIP LOADING THESE RECORDS IN DATABASE;
      * 4 RECORDS AS OF 2024-0331 WILL BE SKIPPED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLN-ACCTNO TO OLD-ACCTNO.

           IF NEW-ACCTNO = 0
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LN-NEXT.

           PERFORM UPGRADE-FILE-LN.

           IF (FILE-OPTION-LN = "Y")
              PERFORM WRITE-LN1-FILE
           ELSE
              ADD 1 TO ALN-KEY
              ACCEPT ALN-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALN-CR
              MOVE X"0A"              TO ALN-LF
              PERFORM WRITE-ALN-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LN1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LN-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LN-NEXT.

      *=================================================================
       PROCESS-FILE-LN-END.

           PERFORM CLOSE-OLN1-FILE.
           MOVE OLN-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-LN = "Y")
              PERFORM CLOSE-LN1-FILE
           ELSE
              PERFORM CLOSE-ALN-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LNFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LN-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LN-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LN-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L P
      *
      ******************************************************************
       PROCESS-FILE-LP SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LP = "N" )
              GO TO PROCESS-FILE-LP-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LP-PATH-OVERRIDE.
           MOVE "LP"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/LPFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLP-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LP-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LP = "Y")
              MOVE UP1534-FILE-PATH           TO LP-PATH
              PERFORM OPEN-LP1-FILE
           ELSE
              PERFORM LOAD-LP1-FILE
              MOVE UP1534-FILE-PATH TO ALP-PATH-BEG 
                                       ALP-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALP-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALP-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALP-PATH-GROUP 
                                            ALP-DONE-PATH-GROUP
              PERFORM OPEN-ALP-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES                     TO OLP1-KEY.
           MOVE ZEROES                     TO OLP-ACCTNO
                                              OLP-SEQNO.
           PERFORM OPEN-OLP1-FILE.
           PERFORM START-OLP1-FILE.

      *=================================================================
       PROCESS-FILE-LP-NEXT.

           PERFORM READ-OLP1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LP-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF (OLP-ACCTNO NOT NUMERIC) OR (OLP-SEQNO NOT NUMERIC)
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LP-NEXT.

           PERFORM UPGRADE-FILE-LP.

           IF (FILE-OPTION-LP = "Y")
              PERFORM WRITE-LP1-FILE
           ELSE
              ADD 1 TO ALP-KEY
              ACCEPT ALP-LTOUCH-DATE FROM CENTURY-DATE
              MOVE X"0D"              TO ALP-CR
              MOVE X"0A"              TO ALP-LF
              PERFORM WRITE-ALP-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE LP1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-LP-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-LP-NEXT.

      *=================================================================
       PROCESS-FILE-LP-END.

           PERFORM CLOSE-OLP1-FILE.
           MOVE OLP-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-LP = "Y")
              PERFORM CLOSE-LP1-FILE
           ELSE
              PERFORM CLOSE-ALP-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LPFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LP-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LP-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LP-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L S
      *
      ******************************************************************
       PROCESS-FILE-LS SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LS = "N" )
              GO TO PROCESS-FILE-LS-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LSD-PATH-OVERRIDE
                                              LSF-PATH-OVERRIDE
                                              LSG-PATH-OVERRIDE
                                              LSJ-PATH-OVERRIDE
                                              LSL-PATH-OVERRIDE
                                              LSM-PATH-OVERRIDE
                                              LSP-PATH-OVERRIDE
                                              LSR-PATH-OVERRIDE
                                              LSX-PATH-OVERRIDE.

           MOVE "LS"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LSFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLS-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LS-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

           MOVE "LP/LSDFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSD-PATH.

           MOVE "LP/LSFFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSF-PATH.

           MOVE "LP/LSGFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSG-PATH.

           MOVE "LP/LSJFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSJ-PATH.

           MOVE "LP/LSLFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSL-PATH.

           MOVE "LP/LSMFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSM-PATH.

           MOVE "LP/LSPFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSP-PATH.

           MOVE "LP/LSRFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSR-PATH.

           MOVE "LP/LSXFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO LSX-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLS1-KEY.
           MOVE ZEROES                     TO OLS-ACCTNO.
           PERFORM OPEN-OLS1-FILE.
           PERFORM START-OLS1-FILE.

           PERFORM OPEN-LSD1-FILE.
           PERFORM OPEN-LSF1-FILE.
           PERFORM OPEN-LSG1-FILE.
           PERFORM OPEN-LSJ1-FILE.
           PERFORM OPEN-LSL1-FILE.
           PERFORM OPEN-LSM1-FILE.
           PERFORM OPEN-LSP1-FILE.
           PERFORM OPEN-LSR1-FILE.
           PERFORM OPEN-LSX1-FILE.

      *=================================================================
       PROCESS-FILE-LS-NEXT.

           PERFORM READ-OLS1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LS-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.
           IF OLS-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LS-NEXT.

           PERFORM UPGRADE-FILE-LS.

           GO TO PROCESS-FILE-LS-NEXT.

      *=================================================================
       PROCESS-FILE-LS-END.

           PERFORM CLOSE-OLS1-FILE.
           MOVE OLS-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-LSD1-FILE.
           PERFORM CLOSE-LSF1-FILE.
           PERFORM CLOSE-LSG1-FILE.
           PERFORM CLOSE-LSJ1-FILE.
           PERFORM CLOSE-LSL1-FILE.
           PERFORM CLOSE-LSM1-FILE.
           PERFORM CLOSE-LSP1-FILE.
           PERFORM CLOSE-LSR1-FILE.
           PERFORM CLOSE-LSX1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LSFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LSD-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LSD-PATH-OWNBR             TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LS-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L T
      *
      ******************************************************************
       PROCESS-FILE-LT SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LT = "N" )
              GO TO PROCESS-FILE-LT-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LTB-PATH-OVERRIDE
                                              LTC-PATH-OVERRIDE
                                              LTD-PATH-OVERRIDE
                                              LTF-PATH-OVERRIDE
                                              LTI-PATH-OVERRIDE
                                              LTL-PATH-OVERRIDE
                                              LTP-PATH-OVERRIDE.

           MOVE "LT"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/LTFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLT-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LT-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.

      *KC  MOVE "LP/LTAFILE"               TO UP1534-FILE-INPUT.
      *KC  PERFORM UP1534-LOAD-FILE-PATH.
      *KC  IF (FILE-OPTION-LT = "Y")
      *KC     MOVE UP1534-FILE-PATH        TO LTA-PATH
      *KC     PERFORM OPEN-LTA1-FILE
      *KC  ELSE
      *KC     PERFORM LOAD-LTA1-FILE
      *KC     MOVE UP1534-FILE-PATH TO ALTA-PATH-BEG
      *KC                              ALTA-DONE-PATH-BEG
      *KC     CALL "C$TOLOWER" USING ALTA-FILENAME, VALUE 06
      *KC     CALL "C$TOLOWER" USING ALTA-DONE-FILENAME, VALUE 11
      *KC     MOVE HOLD-ASCII-PATH-GROUP TO ALTA-PATH-GROUP 
      *KC                                   ALTA-DONE-PATH-GROUP
      *KC     PERFORM OPEN-ALTA-FILE.

           MOVE "LP/LTBFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTB-PATH
              PERFORM OPEN-LTB1-FILE
           ELSE
              PERFORM LOAD-LTB1-FILE
              MOVE UP1534-FILE-PATH TO ALTB-PATH-BEG
                                       ALTB-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTB-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTB-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTB-PATH-GROUP 
                                            ALTB-DONE-PATH-GROUP
              PERFORM OPEN-ALTB-FILE.

           MOVE "LP/LTCFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTC-PATH
              PERFORM OPEN-LTC1-FILE
           ELSE
              PERFORM LOAD-LTC1-FILE
              MOVE UP1534-FILE-PATH TO ALTC-PATH-BEG
                                       ALTC-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTC-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTC-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTC-PATH-GROUP 
                                            ALTC-DONE-PATH-GROUP
              PERFORM OPEN-ALTC-FILE.

           MOVE "LP/LTDFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTD-PATH
              PERFORM OPEN-LTD1-FILE
           ELSE
              PERFORM LOAD-LTD1-FILE
              MOVE UP1534-FILE-PATH TO ALTD-PATH-BEG
                                       ALTD-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTD-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTD-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTD-PATH-GROUP 
                                            ALTD-DONE-PATH-GROUP
              PERFORM OPEN-ALTD-FILE.

           MOVE "LP/LTFFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTF-PATH
              PERFORM OPEN-LTF1-FILE
           ELSE
              PERFORM LOAD-LTF1-FILE
              MOVE UP1534-FILE-PATH TO ALTF-PATH-BEG
                                       ALTF-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTF-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTF-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTF-PATH-GROUP 
                                            ALTF-DONE-PATH-GROUP
              PERFORM OPEN-ALTF-FILE.

           MOVE "LP/LTIFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTI-PATH
              PERFORM OPEN-LTI1-FILE
           ELSE
              PERFORM LOAD-LTI1-FILE
              MOVE UP1534-FILE-PATH TO ALTI-PATH-BEG
                                       ALTI-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTI-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTI-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTI-PATH-GROUP 
                                            ALTI-DONE-PATH-GROUP
              PERFORM OPEN-ALTI-FILE.

           MOVE "LP/LTLFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTL-PATH
              PERFORM OPEN-LTL1-FILE
           ELSE
              PERFORM LOAD-LTL1-FILE
              MOVE UP1534-FILE-PATH TO ALTL-PATH-BEG
                                       ALTL-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTL-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTL-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTL-PATH-GROUP 
                                            ALTL-DONE-PATH-GROUP
              PERFORM OPEN-ALTL-FILE.

           MOVE "LP/LTPFILE"               TO UP1534-FILE-INPUT.
           PERFORM UP1534-LOAD-FILE-PATH.
           IF (FILE-OPTION-LT = "Y")
              MOVE UP1534-FILE-PATH        TO LTP-PATH
              PERFORM OPEN-LTP1-FILE
           ELSE
              PERFORM LOAD-LTP1-FILE
              MOVE UP1534-FILE-PATH TO ALTP-PATH-BEG
                                       ALTP-DONE-PATH-BEG
              CALL "C$TOLOWER" USING ALTP-FILENAME, VALUE 06
              CALL "C$TOLOWER" USING ALTP-DONE-FILENAME, VALUE 11
              MOVE HOLD-ASCII-PATH-GROUP TO ALTP-PATH-GROUP 
                                            ALTP-DONE-PATH-GROUP
              PERFORM OPEN-ALTP-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLT1-KEY.
           MOVE ZEROES                     TO OLT-ACCTNO
                                              OLT-SEQNO.

           MOVE 0 TO HOLD-ALT-KEY HOLD-LT-ACCTNO.
           MOVE SPACES TO HOLD-LT-CODE.

           PERFORM OPEN-OLT1-FILE.
           PERFORM START-OLT1-FILE.

      *=================================================================
       PROCESS-FILE-LT-NEXT.

           PERFORM READ-OLT1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LT-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF ( OLT-CODE = "A" )
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LT-NEXT.

           IF OLT-ACCTNO NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LT-NEXT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JKC 2024-0503 FOUND RECORDS WITH ZERO ACCOUNT NUMBERS;
      * PER KEVIN MULLEN WE CAN SKIP LOADING THESE RECORDS IN DATABASE;
      * 1 RECORDS AS OF 2024-0331 WILL BE SKIPPED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OLT-ACCTNO TO OLD-ACCTNO.

           IF NEW-ACCTNO = 0
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-LT-NEXT.

           PERFORM UPGRADE-FILE-LT.

           GO TO PROCESS-FILE-LT-NEXT.

      *=================================================================
       PROCESS-FILE-LT-END.

           PERFORM CLOSE-OLT1-FILE.
           MOVE OLT-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           IF (FILE-OPTION-LT = "Y")
      *KC     PERFORM CLOSE-LTA1-FILE
              PERFORM CLOSE-LTB1-FILE
              PERFORM CLOSE-LTC1-FILE
              PERFORM CLOSE-LTD1-FILE
              PERFORM CLOSE-LTF1-FILE
              PERFORM CLOSE-LTI1-FILE
              PERFORM CLOSE-LTL1-FILE
              PERFORM CLOSE-LTP1-FILE
           ELSE
      *KC     PERFORM CLOSE-ALTA-FILE
              PERFORM CLOSE-ALTB-FILE
              PERFORM CLOSE-ALTC-FILE
              PERFORM CLOSE-ALTD-FILE
              PERFORM CLOSE-ALTF-FILE
              PERFORM CLOSE-ALTI-FILE
              PERFORM CLOSE-ALTL-FILE
              PERFORM CLOSE-ALTP-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LTFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LTC-PATH-OWNST             TO HOLD-SORT-STATE.
           MOVE LTC-PATH-OWNBR             TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LT-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - L X
      *
      ******************************************************************
       PROCESS-FILE-LX SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-LX = "N" )
              GO TO PROCESS-FILE-LX-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO LX-PATH-OVERRIDE
                                              LXE-PATH-OVERRIDE
                                              LXG-PATH-OVERRIDE.

           MOVE "LX"                       TO UP1534-CURRENT-FILE.
           MOVE "GB/LXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OLX-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-LX-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH        TO LX-PATH.
           PERFORM OPEN-LX1-FILE.

           MOVE "GB/LXEFILE"               TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH        TO LXE-PATH.
           PERFORM OPEN-LXE1-FILE.

           MOVE "GB/LXGFILE"               TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH        TO LXG-PATH.
           PERFORM OPEN-LXG1-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OLX1-KEY.
           MOVE ZEROES                     TO OLX-ACCTNO
                                              OLX-SEQNO.
           PERFORM OPEN-OLX1-FILE.
           PERFORM START-OLX1-FILE.

      *=================================================================
       PROCESS-FILE-LX-NEXT.

           PERFORM READ-OLX1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-LX-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.

           PERFORM UP1534-VPI-DISPLAY.

           IF ( OLX-CODE = "G" )
              PERFORM UPGRADE-FILE-LXG
           ELSE
           IF ( OLX-CODE = "E" )
              PERFORM UPGRADE-FILE-LXE
           ELSE
              PERFORM UPGRADE-FILE-LX.

           GO TO PROCESS-FILE-LX-NEXT.

      *=================================================================
       PROCESS-FILE-LX-END.

           PERFORM CLOSE-OLX1-FILE.
           MOVE OLX-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-LX1-FILE.
           PERFORM CLOSE-LXE1-FILE.
           PERFORM CLOSE-LXG1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "LXFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE LX-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE LX-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-LX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - M P
      *
      ******************************************************************
      * PROCESS-FILE-MP SECTION.

      *     MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *     IF ( FILE-OPTION-MP = "N" )
      *        GO TO PROCESS-FILE-MP-EXIT.

      **- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *     MOVE "Y"                        TO MP-PATH-OVERRIDE.
      *     MOVE "MP"                       TO UP1534-CURRENT-FILE.
      *     MOVE "GB/MPFILE"                TO UP1534-FILE-INPUT.
      *     MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *     MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *     PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *     PERFORM UP1534-VPI-START.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *     MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *     PERFORM UP1534-MV15-OLD-TO-NEW.
      *     MOVE UP1534-MV15-NEW-PATH       TO OMP-PATH.

      *     IF ( STAT-BAD )     
      *        MOVE STAT                    TO UPGRADE-STAT
      *        PERFORM UP1534-CREATE-FILE-ERROR
      *        GO TO PROCESS-FILE-MP-EXIT.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *     MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO MP-PATH.

      **- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
      *     MOVE SPACES                     TO OMP1-KEY.
      *     MOVE ZEROES                     TO OMP-ACCTNO
      *                                        OMP-SEQNO.

      *     PERFORM OPEN-OMP1-FILE.
      *     PERFORM START-OMP1-FILE.

      *     PERFORM OPEN-MP1-FILE.

      **=================================================================
      * PROCESS-FILE-MP-NEXT.

      *     PERFORM READ-OMP1-FILE-NEXT.
      *     IF ( IO-BAD )
      *        GO TO PROCESS-FILE-MP-END.

      *     ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *     MOVE "Y" TO RECORDS-FOUND.
      *     PERFORM UP1534-VPI-DISPLAY.

      *     PERFORM UPGRADE-FILE-MP.

      *     PERFORM WRITE-MP1-FILE.
      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE MP1-KEY                 TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           GO TO PROCESS-FILE-MP-NEXT
      *        ELSE
      *           GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *     GO TO PROCESS-FILE-MP-NEXT.

      **=================================================================
      * PROCESS-FILE-MP-END.

      *     PERFORM CLOSE-OMP1-FILE.
      *     MOVE OMP-PATH TO UP1534-MV15-NEW-PATH.
      *     PERFORM UP1534-MV15-NEW-TO-OLD.

      *     PERFORM CLOSE-MP1-FILE.

      *     PERFORM UP1534-CREATE-FILE-TOTALS.
      *     MOVE "MPFILE"                   TO HOLD-SORT-FILENAME.
      *     MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *     MOVE MP-PATH-OWNST              TO HOLD-SORT-STATE.
      *     MOVE MP-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *     PERFORM UPDATE-SORT-MODULE.

      * PROCESS-FILE-MP-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - P A
      *
      ******************************************************************
      *PROCESS-FILE-PA SECTION.

      *    MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *    IF ( FILE-OPTION-PA = "N" )
      *       GO TO PROCESS-FILE-PA-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *    MOVE "Y"                        TO PA-PATH-OVERRIDE.
      *    MOVE "PA"                       TO UP1534-CURRENT-FILE.
      *    MOVE "LP/PAFILE"                TO UP1534-FILE-INPUT.
      *    MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *    MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *    PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *    PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *    MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *    PERFORM UP1534-MV15-OLD-TO-NEW.
      *    MOVE UP1534-MV15-NEW-PATH       TO OPA-PATH.

      *    IF ( STAT-BAD )     
      *       MOVE STAT                    TO UPGRADE-STAT
      *       PERFORM UP1534-CREATE-FILE-ERROR
      *       GO TO PROCESS-FILE-PA-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *    MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *    PERFORM UP1534-LOAD-FILE-PATH.
      *    MOVE UP1534-FILE-PATH           TO PA-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE SPACES                     TO OPA1-KEY.
      *    MOVE ZEROES                     TO OPA-NUMBER.
      *    PERFORM OPEN-OPA1-FILE.
      *    PERFORM START-OPA1-FILE.

      *    PERFORM OPEN-PA1-FILE.

      *=================================================================
      *PROCESS-FILE-PA-NEXT.

      *    PERFORM READ-OPA1-FILE-NEXT.
      *    IF ( IO-BAD )
      *       GO TO PROCESS-FILE-PA-END.

      *    ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *    MOVE "Y" TO RECORDS-FOUND.
      *    PERFORM UP1534-VPI-DISPLAY.

      *    IF OPA-NUMBER NOT NUMERIC
      *       ADD 1 TO UP1534-RECORD-COUNTER-SKIP
      *       GO TO PROCESS-FILE-PA-NEXT.

      *    PERFORM CLEAR-PA-FILE.

      *    MOVE BR-NO          TO PA-BRNO.
      *    MOVE OPA-NUMBER     TO PA-NUMBER.

      *    MOVE OPA-NAME      TO PA-NAME.
      *    MOVE OPA-ADR1      TO PA-ADR1.
      *    MOVE OPA-ADR2      TO PA-ADR2.
      *    MOVE OPA-CITY      TO PA-CITY.
      *    MOVE OPA-STATE     TO PA-STATE.
      *    MOVE OPA-ZIP       TO PA-ZIP.
      *    IF OPA-LCHECK NOT NUMERIC
      *       MOVE 0          TO PA-LCHECK
      *    ELSE
      *       MOVE OPA-LCHECK TO PA-LCHECK.

      *    MOVE OPA-LCDATE TO DATE-MMDDYY.
      *    PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
      *    PERFORM TEST-INVALID-DATE.
      *    MOVE DATE-YYYYMMDD   TO PA-LCDATE.

      *    IF OPA-LAMT NOT NUMERIC
      *       MOVE 0            TO PA-LAMT
      *    ELSE
      *       MOVE OPA-LAMT     TO PA-LAMT.
      *    IF OPA-YTD-PAID NOT NUMERIC
      *       MOVE 0            TO PA-YTD-PAID
      *    ELSE
      *       MOVE OPA-YTD-PAID TO PA-YTD-PAID.
      *    IF OPA-LYTD-PAID NOT NUMERIC
      *       MOVE 0             TO PA-LYTD-PAID
      *    ELSE
      *       MOVE OPA-LYTD-PAID TO PA-LYTD-PAID.
      *    MOVE OPA-SORTKEY     TO PA-SORTKEY.
      *    MOVE OPA-CUSNO       TO PA-CUSNO
      *    MOVE OPA-CONTACT     TO PA-CONTACT
      *    IF OPA-PHONE NOT NUMERIC
      *       MOVE 0            TO PA-PHONE
      *    ELSE
      *       MOVE OPA-PHONE    TO PA-PHONE.
      *    IF OPA-FAX NOT NUMERIC
      *       MOVE 0            TO PA-FAX
      *    ELSE
      *       MOVE OPA-FAX      TO PA-FAX.
      *    MOVE OPA-1099-FLAG   TO PA-1099-FLAG
      *    MOVE OPA-1099-ID     TO PA-1099-ID
      *    MOVE OPA-LEGAL-NAME1 TO PA-LEGAL-NAME1
      *    MOVE OPA-LEGAL-NAME2 TO PA-LEGAL-NAME2
      *    IF OPA-VAT-PERC NOT NUMERIC
      *       MOVE 0            TO PA-VAT-PERC
      *    ELSE
      *       MOVE OPA-VAT-PERC TO PA-VAT-PERC.
      *    MOVE OPA-RFC         TO PA-RFC
      *    MOVE OPA-CURP        TO PA-CURP.
      *    
      *    PERFORM WRITE-PA1-FILE.
      *    IF ( IO-BAD )
      *       ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *       MOVE PA1-KEY                 TO UP1534-UPDATE-KEY
      *       MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *       MOVE "E"                     TO UP1534-UPDATE-TYPE
      *       PERFORM UP1534-CREATE-FILE-UPDATE
      *       IF ( FILE-STAT-DISP = "22,00" )
      *          GO TO PROCESS-FILE-PA-NEXT
      *       ELSE
      *          GO TO IO-ERROR.

      *    ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *    GO TO PROCESS-FILE-PA-NEXT.

      *=================================================================
      *PROCESS-FILE-PA-END.

      *    PERFORM CLOSE-OPA1-FILE.
      *    MOVE OPA-PATH TO UP1534-MV15-NEW-PATH.
      *    PERFORM UP1534-MV15-NEW-TO-OLD.

      *    PERFORM CLOSE-PA1-FILE.

      *    PERFORM UP1534-CREATE-FILE-TOTALS.
      *    MOVE "PAFILE"                   TO HOLD-SORT-FILENAME.
      *    MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *    MOVE PA-PATH-OWNST              TO HOLD-SORT-STATE.
      *    MOVE PA-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *    PERFORM UPDATE-SORT-MODULE.

      *PROCESS-FILE-PA-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - P C
      *
      ******************************************************************
      * PROCESS-FILE-PC SECTION.

      *     MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *     IF ( FILE-OPTION-PC = "N" )
      *        GO TO PROCESS-FILE-PC-EXIT.

      **- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *     MOVE "Y"                        TO PC-PATH-OVERRIDE.
      *     MOVE "PC"                       TO UP1534-CURRENT-FILE.
      *     MOVE "LP/PCFILE"                TO UP1534-FILE-INPUT.
      *     MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *     MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *     PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *     PERFORM UP1534-VPI-START.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *     MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *     PERFORM UP1534-MV15-OLD-TO-NEW.
      *     MOVE UP1534-MV15-NEW-PATH       TO OPC-PATH.

      *     IF ( STAT-BAD )     
      *        MOVE STAT                    TO UPGRADE-STAT
      *        PERFORM UP1534-CREATE-FILE-ERROR
      *        GO TO PROCESS-FILE-PC-EXIT.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *     MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO PC-PATH.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE SPACES                     TO OPC1-KEY.
      *     MOVE SPACES                     TO OPC-BRANCH
      *                                        OPC-SOC-SEC.
      *     PERFORM OPEN-OPC1-FILE.
      *     PERFORM START-OPC1-FILE.

      *     PERFORM OPEN-PC1-FILE.

      **=================================================================
      * PROCESS-FILE-PC-NEXT.

      *     PERFORM READ-OPC1-FILE-NEXT.
      *     IF ( IO-BAD )
      *        GO TO PROCESS-FILE-PC-END.

      *     ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *     MOVE "Y" TO RECORDS-FOUND.
      *     PERFORM UP1534-VPI-DISPLAY.

      *     IF ( OPC-ID = "5" )
      *        MOVE "C"                     TO PC-ID
      *     ELSE
      *        MOVE OPC-ID                  TO PC-ID.

      *     MOVE OPC-BRANCH                 TO PC-BRANCH.
      *     MOVE OPC-SOC-SEC                TO PC-SOC-SEC.
      *     PERFORM READ-PC1-FILE.

      *     IF ( IO-BAD )
      *        MOVE STAT---BAD              TO PC-RECORD-STAT
      *     ELSE
      *        MOVE STAT---GOOD             TO PC-RECORD-STAT.

      **- - - - - - - - - - - - - - - - - - - - - - - - -{ VALID RECORD }
      *     PERFORM UPGRADE-FILE-PC.

      *     IF ( PC-RECORD-STAT-BAD )
      *        PERFORM WRITE-PC1-FILE
      *     ELSE
      *        PERFORM REWRITE-PC1-FILE.

      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE PC1-KEY                 TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           GO TO PROCESS-FILE-PC-NEXT
      *        ELSE
      *           GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *     GO TO PROCESS-FILE-PC-NEXT.

      **=================================================================
      * PROCESS-FILE-PC-END.

      *     PERFORM CLOSE-OPC1-FILE.
      *     MOVE OPC-PATH TO UP1534-MV15-NEW-PATH.
      *     PERFORM UP1534-MV15-NEW-TO-OLD.

      *     PERFORM CLOSE-PC1-FILE.

      *     PERFORM UP1534-CREATE-FILE-TOTALS.
      *     MOVE "PCFILE"                   TO HOLD-SORT-FILENAME.
      *     MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *     MOVE PC-PATH-OWNST              TO HOLD-SORT-STATE.
      *     MOVE PC-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *     PERFORM UPDATE-SORT-MODULE.

      * PROCESS-FILE-PC-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - P D
      *
      ******************************************************************
      * PROCESS-FILE-PD SECTION.

      *     MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

      *     IF ( FILE-OPTION-PD = "N" )
      *        GO TO PROCESS-FILE-PD-EXIT.

      **- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
      *     MOVE "Y"                        TO PD-PATH-OVERRIDE.
      *     MOVE "PD"                       TO UP1534-CURRENT-FILE.
      *     MOVE "LP/PDFILE"                TO UP1534-FILE-INPUT.
      *     MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
      *     MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

      *     PERFORM UP1534-LOAD-FILE-BEG-TIME.
      *     PERFORM UP1534-VPI-START.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
      *     MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
      *     PERFORM UP1534-MV15-OLD-TO-NEW.
      *     MOVE UP1534-MV15-NEW-PATH       TO OPD-PATH.

      *     IF ( STAT-BAD )     
      *        MOVE STAT                    TO UPGRADE-STAT
      *        PERFORM UP1534-CREATE-FILE-ERROR
      *        GO TO PROCESS-FILE-PD-EXIT.

      **- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
      *     MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
      *     PERFORM UP1534-LOAD-FILE-PATH.
      *     MOVE UP1534-FILE-PATH           TO PD-PATH.

      **- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     MOVE SPACES                     TO OPD1-KEY.
      *     MOVE ZEROES                     TO OPD-BRANCH
      *                                        OPD-SOC-SEC.
      *     PERFORM OPEN-OPD1-FILE.
      *     PERFORM START-OPD1-FILE.

      *     PERFORM OPEN-PD1-FILE.

      **=================================================================
      * PROCESS-FILE-PD-NEXT.

      *     PERFORM READ-OPD1-FILE-NEXT.
      *     IF ( IO-BAD )
      *        GO TO PROCESS-FILE-PD-END.

      *     ADD  01  TO UP1534-RECORD-COUNTER-READ.
      *     MOVE "Y" TO RECORDS-FOUND.
      *     PERFORM UP1534-VPI-DISPLAY.


      *     PERFORM UPGRADE-FILE-PD.

      ** THE UPGRADE-FILE-PD SHARES THE ROUTINE WITH CANNED LOANS
      ** I WASNT SURE THOSE WERE STORED THE SAME WAY SO I AM ONLY FIXING
      ** WHAT I KNOW IS WRONG;


      ** ALL THIS BELOW HERE WORKS
      *     IF OPD-CKNO NOT NUMERIC OR
      *         (OPD-CKNO = 202020 OR 020202)
      *        MOVE 0 TO PD-CKNO.

      *     IF (OPD-PRPAID-AHEAD NOT NUMERIC) OR
      *         (OPD-PRPAID-AHEAD = 2020202.02 OR 0202020.20)
      *        MOVE 0 TO PD-PRPAID-AHEAD.

      *     IF OPD-GIFTNET-OUR-PO NOT NUMERIC OR
      *         (OPD-GIFTNET-OUR-PO = 202020 OR 020202)
      *        MOVE 0 TO PD-GIFTNET-OUR-PO.

      *     IF OPD-ACCTNO NOT NUMERIC
      *        MOVE 0 TO PD-ACCTNO.

      *     MOVE 0 TO PD-MONTHEND-BAL.

      *     IF (OPD-DLCOMM-O3-CMSI NOT NUMERIC) OR 
      *          (OPD-DLCOMM-O3-CMSI = 2020.20 OR 0202.02)
      *        MOVE 0 TO PD-DLCOMM-O3-CMSI.
      *     IF (OPD-DLCOMM-PP-CMSI NOT NUMERIC) OR
      *          (OPD-DLCOMM-PP-CMSI = 2020.20 OR 0202.02) OR
      *            OPD-DLCOMM-PP-CMSI = 20.20
      *        MOVE 0 TO PD-DLCOMM-PP-CMSI.

      *     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
      *        IF OPD-EARN-ORDER(SUB) NOT NUMERIC
      *           MOVE 0 TO PD-EARN-ORDER(SUB)
      *        END-IF
      *     END-PERFORM.

      *     PERFORM WRITE-PD1-FILE.
      *     IF ( IO-BAD )
      *        ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
      *        MOVE PD1-KEY                 TO UP1534-UPDATE-KEY
      *        MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
      *        MOVE "E"                     TO UP1534-UPDATE-TYPE
      *        PERFORM UP1534-CREATE-FILE-UPDATE
      *        IF ( FILE-STAT-DISP = "22,00" )
      *           GO TO PROCESS-FILE-PD-NEXT
      *        ELSE
      *           GO TO IO-ERROR.

      *     ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

      *     GO TO PROCESS-FILE-PD-NEXT.

      **=================================================================
      * PROCESS-FILE-PD-END.

      *     PERFORM CLOSE-OPD1-FILE.
      *     MOVE OPD-PATH TO UP1534-MV15-NEW-PATH.
      *     PERFORM UP1534-MV15-NEW-TO-OLD.

      *     PERFORM CLOSE-PD1-FILE.

      *     PERFORM UP1534-CREATE-FILE-TOTALS.
      *     MOVE "PDFILE"                   TO HOLD-SORT-FILENAME.
      *     MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
      *     MOVE PD-PATH-OWNST              TO HOLD-SORT-STATE.
      *     MOVE PD-PATH-OWNBR              TO HOLD-SORT-BRNO.
      *     PERFORM UPDATE-SORT-MODULE.

      * PROCESS-FILE-PD-EXIT.
      *     EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - R X
      *
      ******************************************************************
       PROCESS-FILE-RX SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-RX = "N" )
              GO TO PROCESS-FILE-RX-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO RX-PATH-OVERRIDE.
           MOVE "RX"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/RXFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO ORX-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-RX-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO RX-PATH.
           PERFORM OPEN-RX1-FILE.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ OPEN & START FILES }
           MOVE SPACES TO ORX-REC.
           MOVE ZEROES TO ORX-ACCTNO.
           PERFORM OPEN-ORX1-FILE.
           PERFORM START-ORX1-FILE.

      *=================================================================
       PROCESS-FILE-RX-NEXT.

           PERFORM READ-ORX1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-RX-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           PERFORM UPGRADE-FILE-RX.

           PERFORM WRITE-RX1-FILE.

           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE RX1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-RX-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-RX-NEXT.

      *=================================================================
       PROCESS-FILE-RX-END.

           PERFORM CLOSE-ORX1-FILE.
           MOVE ORX-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.
           PERFORM CLOSE-RX1-FILE

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "RXFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE RX-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE RX-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-RX-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - F I L E - T Y
      *
      ******************************************************************
       PROCESS-FILE-TY SECTION.

           MOVE UPGRADE-STAT---GOOD        TO UPGRADE-STAT.

           IF ( FILE-OPTION-TY = "N" )
              GO TO PROCESS-FILE-TY-EXIT.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "Y"                        TO TY-PATH-OVERRIDE.
           MOVE "TY"                       TO UP1534-CURRENT-FILE.
           MOVE "LP/TYFILE"                TO UP1534-FILE-INPUT.
           MOVE UP1534-FILE-TYPE---LOCAL   TO UP1534-FILE-TYPE.
           MOVE ZEROES                     TO UP1534-RECORD-COUNTERS.

           PERFORM UP1534-LOAD-FILE-BEG-TIME.
           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP SOURCE PATHS }
           MOVE UP1534-FILE-ORDER---SOURCE TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO UP1534-MV15-OLD-PATH.
           PERFORM UP1534-MV15-OLD-TO-NEW.
           MOVE UP1534-MV15-NEW-PATH       TO OTY-PATH.

           IF ( STAT-BAD )     
              MOVE STAT                    TO UPGRADE-STAT
              PERFORM UP1534-CREATE-FILE-ERROR
              GO TO PROCESS-FILE-TY-EXIT.

      *- - - - - - - - - - - - - - - - - - - - - -{ SETUP TARGET PATHS }
           MOVE UP1534-FILE-ORDER---TARGET TO UP1534-FILE-ORDER.
           PERFORM UP1534-LOAD-FILE-PATH.
           MOVE UP1534-FILE-PATH           TO TY-PATH.

           PERFORM MISC-TRACE-FILE-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *     PER KEVIN, CHANGED PROCESSING TYFILE RECORDS TO ONLY
      *     UPGRADE RECORDS FROM 2023 ONWARD; ONLY REALLY NEED ONE
      *     FISCAL YEAR OF TYFILE RECORDS; THE VERY OLD RECORDS WE
      *     HAVE BEEN UPGRADING ARE BELIEVED FROM CLOSED BRANCHES.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES                     TO OTY1-KEY.
           MOVE ZEROES                     TO OTY-BRNO
           MOVE 1230000                    TO OTY-DATE.
           MOVE ZEROES                     TO OTY-CLASS.
           PERFORM OPEN-OTY1-FILE.
           PERFORM START-OTY1-FILE.

           PERFORM OPEN-TY1-FILE.

      *=================================================================
       PROCESS-FILE-TY-NEXT.

           PERFORM READ-OTY1-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PROCESS-FILE-TY-END.

           ADD  01  TO UP1534-RECORD-COUNTER-READ.
           MOVE "Y" TO RECORDS-FOUND.
           PERFORM UP1534-VPI-DISPLAY.

           IF OTY-BRNO NOT NUMERIC OR
               OTY-DATE NOT NUMERIC OR
                OTY-CLASS NOT NUMERIC
              ADD 1 TO UP1534-RECORD-COUNTER-SKIP
              GO TO PROCESS-FILE-TY-NEXT.

           PERFORM UPGRADE-FILE-TY.
           
           PERFORM WRITE-TY1-FILE.
           IF ( IO-BAD )
              ADD 1                        TO UP1534-RECORD-COUNTER-SKIP
              MOVE TY1-KEY                 TO UP1534-UPDATE-KEY
              MOVE FILE-STAT-DISP          TO UP1534-UPDATE-STAT
              MOVE "E"                     TO UP1534-UPDATE-TYPE
              PERFORM UP1534-CREATE-FILE-UPDATE
              IF ( FILE-STAT-DISP = "22,00" )
                 GO TO PROCESS-FILE-TY-NEXT
              ELSE
                 GO TO IO-ERROR.

           ADD 1 TO UP1534-RECORD-COUNTER-WRITE.

           GO TO PROCESS-FILE-TY-NEXT.

      *=================================================================
       PROCESS-FILE-TY-END.

           PERFORM CLOSE-OTY1-FILE.
           MOVE OTY-PATH TO UP1534-MV15-NEW-PATH.
           PERFORM UP1534-MV15-NEW-TO-OLD.

           PERFORM CLOSE-TY1-FILE.

           PERFORM UP1534-CREATE-FILE-TOTALS.
           MOVE "TYFILE"                   TO HOLD-SORT-FILENAME.
           MOVE UP1534-MV15-OLD-PATH       TO HOLD-SORT-FILEPATH.
           MOVE TY-PATH-OWNST              TO HOLD-SORT-STATE.
           MOVE TY-PATH-OWNBR              TO HOLD-SORT-BRNO.
           PERFORM UPDATE-SORT-MODULE.

       PROCESS-FILE-TY-EXIT.
           EXIT.

      ******************************************************************
      * CONVERT "  A" TO "   A"
      *         "BAC" TO " BAC"
      * CANT LEAVE SPACES AT THE END IN A30
      ******************************************************************
       CONVERT-A15-A30-ALPNAME SECTION.

           MOVE HOLD-A15-ALPNAME TO HOLD-A30-ALPNAME.
          
      * "AAA" TO "AAAA"
           IF HOLD-A15-ALPNAME = "AAA"
              MOVE "AAAA" TO HOLD-A30-ALPNAME
              GO TO EXIT-CONVERT-A15-A30-ALPNAME.
      * "~~~" TO "~~~~"
           IF HOLD-A15-ALPNAME = "~~~"
              MOVE "~~~~" TO HOLD-A30-ALPNAME
              GO TO EXIT-CONVERT-A15-A30-ALPNAME.
      * "ZZZ" TO "ZZZZ"
           IF HOLD-A15-BYTE(1) = LITTLE-Z AND
               HOLD-A15-BYTE(2) = LITTLE-Z AND
                HOLD-A15-BYTE(3) = LITTLE-Z 
              MOVE LITTLE-Z TO HOLD-A30-BYTE(1)
                               HOLD-A30-BYTE(2)
                               HOLD-A30-BYTE(3)
                               HOLD-A30-BYTE(4)
              GO TO EXIT-CONVERT-A15-A30-ALPNAME.
      * "  A" TO "   A"
      * "  J" TO "   J"
      * " AH" TO "  AH"
           IF HOLD-A15-BYTE(1) = SPACES
              MOVE HOLD-A15-ALPNAME TO HOLD-A30-ALPNAME
              CALL "C$JUSTIFY" USING HOLD-A30-ALPNAME, "R"
              GO TO EXIT-CONVERT-A15-A30-ALPNAME.
 
      * IF ALL 3 BYTES ARE FILLED WITH OTHER TYPE LETTER COMBOS,
      * TRY TO FIGURE IT OUT, THEN JUST GIVE UP AND MOVE AND JUSTIFY
      * "A~~" TO "A~~~"
      * "BZZ" TO "BZZZ"
           IF HOLD-A15-BYTE(3) = LITTLE-Z
              MOVE LITTLE-Z  TO HOLD-A30-BYTE(4) 
           ELSE
           IF HOLD-A15-BYTE(3) = "~"
              MOVE "~" TO HOLD-A30-BYTE(4) 
           ELSE
              MOVE HOLD-A15-ALPNAME TO HOLD-A30-ALPNAME
              CALL "C$JUSTIFY" USING HOLD-A30-ALPNAME, "R".

       EXIT-CONVERT-A15-A30-ALPNAME.
           EXIT.

      ******************************************************************
      *
      *    P R I N T - R E P O R T - M O D U L E
      *
      ******************************************************************
       PRINT-REPORT-MODULE SECTION.

      *- - - - - - - - - - - - - - - - - - -{ SET CURRENT FILE WORKERS }
           MOVE "REPORT"                   TO UP1534-CURRENT-FILE.
           MOVE UP1534-FILE-TYPE---GLOBAL  TO UP1534-FILE-TYPE.

           PERFORM UP1534-VPI-START.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ OPEN PRINTER }
           PERFORM OPEN-PR-FILE.

      *- - - - - - - - - - - - - - - - - - - - -{ SETUP 'REPORT' FILE  }
           MOVE ZEROES                     TO UP1534-REPORT-KEY.

           PERFORM OPEN-REPORT-FILE.
           PERFORM START-REPORT-FILE.

      *=================================================================
       PRINT-REPORT-NEXT-LINE.

           PERFORM READ-REPORT-FILE-NEXT.
           IF ( IO-BAD )
              GO TO PRINT-REPORT-MODULE-END.

           PERFORM UP1534-VPI-DISPLAY.

           MOVE REPORT-DETAIL-LINE         TO DETAIL-LINE.
           MOVE REPORT-LN-FEED             TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           GO TO PRINT-REPORT-NEXT-LINE.

      *=================================================================
       PRINT-REPORT-MODULE-END.

           PERFORM CLOSE-REPORT-FILE.
           PERFORM PRINT-RANGES.

       PRINT-REPORT-MODULE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    W R I T E - D E T A I L - L I N E
      *
      ******************************************************************
       WRITE-DETAIL-LINE SECTION.

           ADD LN-FEED LN-COUNT GIVING LN-WK.

           IF ( EXT-CONAME-RPT-LINES > ZEROES )
              IF ( LN-WK GREATER THAN EXT-CONAME-RPT-LINES )
                 PERFORM WRITE-HEADER-LINES
              ELSE
                 NEXT SENTENCE
           ELSE
           IF ( LN-WK GREATER THAN 60 )
              PERFORM WRITE-HEADER-LINES.

           MOVE DETAIL-LINE                TO PR-REC.
           PERFORM WRITE-PR-REC.

           ADD LN-FEED                     TO LN-COUNT.
           MOVE 01                         TO LN-FEED.
           MOVE SPACES                     TO DETAIL-LINE.

       EXIT-WRITE-DETAIL-LINE.
           EXIT.

      ******************************************************************
      *
      *    P R I N T - R A N G E S
      *
      ******************************************************************
       PRINT-RANGES SECTION.

           MOVE 99 TO LN-COUNT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( GROUP-FLAG = "Y" )
              MOVE "GROUP ID NAME                    :" TO R1-DESC
              MOVE ENT-GROUP                            TO R1-FIELD
              MOVE 2                                    TO LN-FEED
              PERFORM WRITE-DETAIL-LINE
           ELSE
              MOVE "BEGINNING BRANCH NUMBER          :" TO R1-DESC
              MOVE BEG-BRANCH                           TO R1-NUMERIC
              MOVE 2                                    TO LN-FEED
              PERFORM WRITE-DETAIL-LINE
              MOVE "ENDING BRANCH NUMBER             :" TO R1-DESC
              MOVE END-BRANCH                           TO R1-NUMERIC
              MOVE 1                                    TO LN-FEED
              PERFORM WRITE-DETAIL-LINE.

           MOVE "DATABASE NAME                    :" TO R1-DESC.
           MOVE EXT-ACUSQL-DB-NAME                   TO R1-FIELD.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "SERVER NAME                      :" TO R1-DESC.
           MOVE EXT-ACUSQL-SERVER-NAME               TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "SOURCE PATH                      :" TO R1-DESC.
           MOVE SOURCE-PATH                          TO R1-FIELD.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TARGET PATH                      :" TO R1-DESC.
           MOVE TARGET-PATH                          TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "*********[ GLOBAL FILES ]*********" TO DETAIL-LINE.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "AL-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-AL                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CD-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CD                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CL-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CL                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CP-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-GLOBAL-CP                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "EA-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-EA                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "EP-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-EP                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "EW-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-EW                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "FD-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-FD                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "FS-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-FS                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "GI-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-GI                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "GL-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-GL                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "II-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-II                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "IR-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-IR                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "JD-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-JD                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "LC-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LC                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "PE-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-PE                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "PW-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-PW                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "RB-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-RB                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "RC-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-RC                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "SM-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-SM                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "SP-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-SP                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "SS-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-SS                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "ST-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-ST                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TRW-INFO-FILE (Y/N)              :" TO R1-DESC.
           MOVE FILE-OPTION-TRWINFO                  TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TZ-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-TZ                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "WR-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-WR                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "*********[ LOCAL FILES ]**********" TO DETAIL-LINE.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "BW-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-BW                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CA-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CA                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CI-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CI                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CK-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CK                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CX-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CX                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "CP-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-CP                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "DL-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-DL                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "DM-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-DM                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "DS-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-DS                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "DT-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-DT                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "ES-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-ES                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "GB-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-GB                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "IC-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-IC                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "IX-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-IX                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LE-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LE                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LH-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LH                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LN-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LN                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LP-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LP                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LS-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LS                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LT-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LT                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "LX-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-LX                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *    MOVE "PA-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-PA                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "PC-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-PC                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

      *    MOVE "PD-FILE (Y/N)                    :" TO R1-DESC.
      *    MOVE FILE-OPTION-PD                       TO R1-FIELD.
      *    MOVE 1                                    TO LN-FEED.
      *    PERFORM WRITE-DETAIL-LINE.

           MOVE "RX-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-RX                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TY-FILE (Y/N)                    :" TO R1-DESC.
           MOVE FILE-OPTION-TY                       TO R1-FIELD.
           MOVE 1                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "STARTING TIME OF THE UPGRADE     :" TO R1-DESC.
           MOVE STARTING-TIME                        TO R1-FIELD.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "ENDING   TIME OF THE UPGRADE     :" TO R1-DESC.
           PERFORM GET-TIME.
           MOVE TIME-EDIT                            TO R1-FIELD.
           MOVE 2                                    TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

      *=================================================================
       EXIT-PRINT-RANGES.
           EXIT.

      ******************************************************************
      *
      *    W R I T E - H E A D E R - L I N E S
      *
      ******************************************************************
       WRITE-HEADER-LINES SECTION.

           ADD 01                          TO PAGE-NUMBER.
           MOVE PAGE-NUMBER                TO H1-PAGE-NO.
           PERFORM GET-TIME.
           MOVE TIME-EDIT                  TO H1-TIME.
           MOVE HEADER-LINE-1              TO PR-REC.
           MOVE 99                         TO LN-FEED.
           PERFORM WRITE-PR-REC.
           MOVE HEADER-LINE-2              TO PR-REC.
           MOVE 01                         TO LN-FEED.
           PERFORM WRITE-PR-REC.

           MOVE ALL "-"                    TO PR-REC.
           MOVE 02                         TO LN-FEED.
           PERFORM WRITE-PR-REC.

           MOVE 04                         TO LN-COUNT.
           MOVE 01                         TO LN-FEED.

       EXIT-WRITE-HEADER-LINES.
           EXIT.

      ******************************************************************
      *
      *    S C A N - G R - F I L E
      *
      ******************************************************************
       SCAN-GR-FILE SECTION.

           MOVE "WI/GRSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH GRSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF GRSCAN-STATUS NOT = "00"
              MOVE 9 TO IO-FG
              GO TO EXIT-SCAN-GR-FILE.

           MOVE "S  A000BEG-BRANCH." TO VDU.
           MOVE GRSCAN-KEY           TO VDUBUF GR1-KEY.
           PERFORM SCREENIO.

           MOVE "00"       TO VDUSTATUS.
           MOVE ZEROES     TO IO-FG.
           MOVE GRSCAN-KEY TO VDUBUF.

       EXIT-SCAN-GR-FILE.
           EXIT.

      ******************************************************************
      *
      * CREATE DONE TAGS FOR EACH GLOBAL ASCII FILE THAT WAS SELECTED
      *
      *=================================================================
      * NOTE: NEED TO CHECK IF THE 'DONE-PATH-BEG' IN NOT EQUAL
      *       SPACES; IT WILL BE EQUAL SPACES IF A GIVEN FILE'S SOURCE
      *       FILE WAS NOT FOUND;  IF THE SOURCE FILE IS FOUND THEN IT
      *       WILL POPULATE THE 'DONE-PATH-GROUP'; NEED THIS CHECK
      *       BECAUSE IT WILL STOP EXECUTION WITH A FILE IO-ERROR WINDOW
      ******************************************************************
       CREATE-GLOBAL-DONE-TAGS SECTION.

           IF ( FILE-OPTION-GL        = "A"    ) AND
              ( AGL-DONE-PATH-BEG NOT = SPACES )
              PERFORM OPEN-AGL-DONE-FILE
              PERFORM CLOSE-AGL-DONE-FILE.

           IF ( FILE-OPTION-RC        = "A"    ) AND
              ( ARC-DONE-PATH-BEG NOT = SPACES )
              PERFORM OPEN-ARC-DONE-FILE
              PERFORM CLOSE-ARC-DONE-FILE.

           IF ( FILE-OPTION-WR        = "A"    ) AND
              ( AWR-DONE-PATH-BEG NOT = SPACES )
              PERFORM OPEN-AWR-DONE-FILE
              PERFORM CLOSE-AWR-DONE-FILE.

      ******************************************************************
      *
      * CREATE DONE TAGS FOR EACH LOCAL ASCII FILE THAT WAS SELECTED
      *
      *=================================================================
      * NOTE: NEED TO CHECK IF THE 'DONE-PATH-GROUP' IN NOT EQUAL
      *       SPACES; IT WILL BE EQUAL SPACES IF A GIVEN FILE'S SOURCE
      *       FILE WAS NOT FOUND;  IF THE SOURCE FILE IS FOUND THEN IT
      *       WILL POPULATE THE 'DONE-PATH-GROUP'; NEED THIS CHECK
      *       BECAUSE IT WILL STOP EXECUTION WITH A FILE IO-ERROR WINDOW
      ******************************************************************
       CREATE-DONE-TAGS SECTION.

           IF ( FILE-OPTION-BW          = "A"    ) AND 
              ( ABW-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ABW-DONE-FILE
              PERFORM CLOSE-ABW-DONE-FILE
              IF ( ABX-DONE-PATH-GROUP NOT = SPACES )
                 PERFORM OPEN-ABX-DONE-FILE
                 PERFORM CLOSE-ABX-DONE-FILE.

           IF ( FILE-OPTION-CA          = "A"    ) AND
              ( ACA-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ACA-DONE-FILE
              PERFORM CLOSE-ACA-DONE-FILE.

           IF ( FILE-OPTION-CI          = "A"    ) AND
              ( ACI-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ACI-DONE-FILE
              PERFORM CLOSE-ACI-DONE-FILE.

           IF ( FILE-OPTION-CK          = "A"    ) AND
              ( ACK-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ACK-DONE-FILE
              PERFORM CLOSE-ACK-DONE-FILE.

           IF ( FILE-OPTION-IX          = "A"    ) AND
              ( AIX-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-AIX-DONE-FILE
              PERFORM CLOSE-AIX-DONE-FILE.

           IF ( FILE-OPTION-LE          = "A"    ) AND
              ( ALE-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALE-DONE-FILE
              PERFORM CLOSE-ALE-DONE-FILE.

           IF ( FILE-OPTION-LH          = "A"    ) AND
              ( ALH-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALH-DONE-FILE
              PERFORM CLOSE-ALH-DONE-FILE.

           IF ( FILE-OPTION-LN          = "A"    ) AND
              ( ALN-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALN-DONE-FILE
              PERFORM CLOSE-ALN-DONE-FILE.

           IF ( FILE-OPTION-LP          = "A"    ) AND
              ( ALP-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALP-DONE-FILE
              PERFORM CLOSE-ALP-DONE-FILE.

      *KC  IF ( FILE-OPTION-LT           = "A"    ) AND
      *KC     ( ALTA-DONE-PATH-GROUP NOT = SPACES )
      *KC     PERFORM OPEN-ALTA-DONE-FILE
      *KC     PERFORM CLOSE-ALTA-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTB-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTB-DONE-FILE
              PERFORM CLOSE-ALTB-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTC-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTC-DONE-FILE
              PERFORM CLOSE-ALTC-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTD-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTD-DONE-FILE
              PERFORM CLOSE-ALTD-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTF-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTF-DONE-FILE
              PERFORM CLOSE-ALTF-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTI-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTI-DONE-FILE
              PERFORM CLOSE-ALTI-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTL-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTL-DONE-FILE
              PERFORM CLOSE-ALTL-DONE-FILE.

           IF ( FILE-OPTION-LT           = "A"    ) AND
              ( ALTP-DONE-PATH-GROUP NOT = SPACES )
              PERFORM OPEN-ALTP-DONE-FILE
              PERFORM CLOSE-ALTP-DONE-FILE.

       EXIT-CREATE-DONE-TAGS.
           EXIT.

      ****************************************
       TEST-INVALID-DATE SECTION.
      ****************************************
           IF DATE-YYYYMMDD NOT NUMERIC
              MOVE 0     TO DATE-YYYYMMDD
              GO TO EXIT-TEST-INVALID-DATE
           ELSE
           IF DATE-YYYYMMDD = 0 OR 20202020
              MOVE 0     TO DATE-YYYYMMDD
              GO TO EXIT-TEST-INVALID-DATE.

      * CANT FIX BAD YEAR
           IF (DATE-YYYYMMDD-YYYY = 0) AND
               (DATE-YYYYMMDD-MM NOT = 0 OR DATE-YYYYMMDD-DD NOT = 0)
              MOVE 0 TO DATE-YYYYMMDD
              GO TO EXIT-TEST-INVALID-DATE.

      * 20000003  00/03/00 A15

      * 19638133
      * 19750000
      * 19970229

      * CANT FIX A BAD MONTH, SO FORCE IT TO 12 IF ONLY THING IS WRONG
      * DONT CARE IF DAY IS INVALID, IT WILL GET FIXED IN THE NEXT 'IF'
           IF (DATE-YYYYMMDD-YYYY NOT = 0) AND
                (DATE-YYYYMMDD-MM < 1 OR > 12) 
              MOVE 12 TO DATE-YYYYMMDD-MM.

           IF (DATE-YYYYMMDD-DD < 1 OR > 31) OR
              ((DATE-YYYYMMDD-MM = 02) AND (DATE-YYYYMMDD-DD > 28)) OR
              ((DATE-YYYYMMDD-DD > 30) AND
                            (DATE-YYYYMMDD-MM = 4 OR 6 OR 9 OR 11))
                 MOVE 33            TO DATE-YYYYMMDD-DD
                 MOVE DATE-YYYYMMDD TO NDTE-DATE
                 PERFORM NEW-DATE-CALCULATION
                 MOVE NDTE-DATE     TO DATE-YYYYMMDD.

       EXIT-TEST-INVALID-DATE.
           EXIT.

      ******************************************************************
      *
      *    U P G R A D E - F I L E - P D
      *
      * USED FOR CANNED LOANS! CLFILE
      ******************************************************************
       UPGRADE-FILE-PD SECTION.
           PERFORM CLEAR-PD-FILE.

      * PD-REC
           MOVE OPD-ID                    TO PD-ID.
           IF OPD-BRANCH NOT NUMERIC
              MOVE 0                      TO PD-BRANCH
           ELSE
              MOVE OPD-BRANCH             TO PD-BRANCH.
           IF OPD-SOC-SEC NOT NUMERIC
              MOVE 0                      TO PD-SOC-SEC
           ELSE
              MOVE OPD-SOC-SEC            TO PD-SOC-SEC.

      * PD-RECORD (MATCHES LOAN FILE)
           IF OPD-OWNBR NOT NUMERIC
              MOVE 0                      TO PD-OWNBR
           ELSE
              MOVE OPD-OWNBR              TO PD-OWNBR.
           IF OPD-NUMBER NOT NUMERIC
              MOVE 0                      TO PD-ACCTNO
           ELSE
              MOVE OPD-NUMBER             TO PD-ACCTNO.
           IF OPD-CLASS NOT NUMERIC
              MOVE 0                      TO PD-CLASS
           ELSE
           MOVE OPD-CLASS                 TO PD-CLASS.
           IF OPD-SUBCLASS NOT NUMERIC
              MOVE 0                      TO PD-SUBCLASS
           ELSE
           MOVE OPD-SUBCLASS              TO PD-SUBCLASS.
           IF OPD-LAWCODE NOT NUMERIC
              MOVE 0                      TO PD-LAWCODE
           ELSE
           MOVE OPD-LAWCODE               TO PD-LAWCODE.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
              IF OPD-SSNO(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-SSNO(SUB)
              ELSE
              MOVE OPD-SSNO   (SUB)       TO PD-SSNO   (SUB)
              END-IF
              MOVE OPD-MAKERCD(SUB)       TO PD-MAKERCD(SUB)
           END-PERFORM.

           MOVE OPD-ORGST                 TO PD-ORGST.
           IF OPD-ORGBR NOT NUMERIC
              MOVE 0                      TO PD-ORGBR
           ELSE
           MOVE OPD-ORGBR                 TO PD-ORGBR.
           MOVE OPD-OWNST                 TO PD-OWNST.
           IF OPD-SPRCLASS NOT NUMERIC
              MOVE 0                      TO PD-SPRCLASS
           ELSE
           MOVE OPD-SPRCLASS              TO PD-SPRCLASS.
           MOVE OPD-CONVERCD              TO PD-CONVERCD.
           MOVE OPD-MIDSTREAM             TO PD-MIDSTREAM.

           MOVE OPD-PURCD                 TO PD-PURCD.
           MOVE OPD-SRCD                  TO PD-SRCD.
           MOVE OPD-COLLCD                TO PD-COLLCD.
           MOVE OPD-COLLID                TO PD-COLLID.
           MOVE OPD-POCD                  TO PD-POCD.
           MOVE OPD-PLCD                  TO PD-PLCD.
           MOVE OPD-PLTYPE                TO PD-PLTYPE.
           MOVE OPD-CONFIDENTCD           TO PD-CONFIDENTCD.
           MOVE OPD-ALLOTCD               TO PD-ALLOTCD.
           MOVE OPD-RECASTCD              TO PD-RECASTCD.
           MOVE OPD-SKIP-TRW              TO PD-SKIP-TRW.
           MOVE OPD-STATUSFG              TO PD-STATUSFG.
           MOVE OPD-SMALLOAN              TO PD-SMALLOAN.
           MOVE OPD-SALEFIN               TO PD-SALEFIN.
           MOVE OPD-SERVACCT              TO PD-SERVACCT.
           MOVE OPD-LOANTYPE              TO PD-LOANTYPE.
           MOVE OPD-ADDON-FG              TO PD-ADDON-FG.
           MOVE OPD-PAY-SCHLD-FG          TO PD-PAY-SCHLD-FG.
           IF OPD-LC-CODE NOT NUMERIC
              MOVE 0                      TO PD-LC-CODE
           ELSE
           MOVE OPD-LC-CODE               TO PD-LC-CODE.
           MOVE OPD-CAN-LOAN-NO           TO PD-CAN-LOAN-NO.
           MOVE OPD-STATFLAGS             TO PD-STATFLAGS.

           MOVE OPD-ENTDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-ENTDATE.

           MOVE OPD-LOANDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LOANDATE.

           MOVE OPD-PURDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PURDATE.

           MOVE OPD-INTDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-INTDATE.

           MOVE OPD-CASHDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-CASHDATE.


           MOVE 0                         TO PD-FILEDATE
                                             PD-RESCISSION-DATE
                                             PD-PART-RECOURSE-DATE.

      * REDEFINES FILEDATE, RESCISSION-DATE, PART-RECOURSE-DATE

           MOVE OPD-FILEDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.

           IF OPD-RESCISSION = "Y"
              MOVE DATE-YYYYMMDD       TO PD-RESCISSION-DATE
           ELSE
              MOVE DATE-YYYYMMDD       TO PD-FILEDATE.

           MOVE OPD-ORIG-1STPAY              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-ORIG-1STPYDATE.

           MOVE OPD-1STPYDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-1STPYDATE.

           MOVE OPD-JDDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-JDDATE.

           MOVE OPD-PLDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PLDATE.

           MOVE OPD-ACCELDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-ACCELDATE.

           MOVE OPD-REDUDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-REDUDATE.

           MOVE OPD-POFFDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-POFFDATE.

           MOVE OPD-LEGALDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LEGALDATE.

           MOVE OPD-BNKRPTDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-BNKRPTDATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    A15: OPD-BNKRPT-DISMISSAL IS A REDEFINE OF OPD-CYCLE-DATE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES                    TO PD-BNKRPT-DISMISS-DATE.

           IF OPD-BNKRPT-DISMISSAL NUMERIC
              IF OPD-BNKRPT-DISMISSAL NOT = 202020 AND NOT = 020202
                                  AND NOT = SPACES
                 MOVE OPD-BNKRPT-DISMISSAL TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 MOVE DATE-YYYYMMDD TO PD-BNKRPT-DISMISS-DATE.
                
           MOVE OPD-DEBTAIDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-DEBTAIDATE.

           MOVE OPD-REPODATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-REPODATE.

           MOVE OPD-REDEEMDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-REDEEMDATE.

           MOVE OPD-SOLDDATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-SOLDDATE.

           MOVE OPD-INS-CONFIRMATION              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-INS-CONFIRM-DATE.

           MOVE OPD-PRIOR-RN-FOR10              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PRIOR-RN-FOR10-DATE.

           MOVE OPD-LAST-RN-FOR10              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LAST-RN-FOR10-DATE.

           MOVE OPD-TRW-DOFD              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-TRW-DOFD-DATE.

           MOVE OPD-LAST-PYPA-DATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LAST-PYPA-DATE.

           MOVE OPD-FOLLOWUP-DATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-FOLLOWUP-DATE.

      * START THE METRO2 FIELD WITH DATE-PAID-LAST
           MOVE OPD-DATE-PAID-LAST          TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-METRO2-LAST-PMT-DATE.

           MOVE OPD-LAST-ACCRUAL-DATE              TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LAST-ACCRUAL-DATE.


           IF OPD-APRATE NOT NUMERIC
              MOVE 0                      TO PD-APRATE
           ELSE
           MOVE OPD-APRATE                TO PD-APRATE.
           IF OPD-EFFRATE NOT NUMERIC
              MOVE 0                      TO PD-EFFRATE
           ELSE
           MOVE OPD-EFFRATE               TO PD-EFFRATE.
           IF OPD-SMPRATE NOT NUMERIC
              MOVE 0                      TO PD-SMPRATE
           ELSE
           MOVE OPD-SMPRATE               TO PD-SMPRATE.
           IF OPD-YLDRATE NOT NUMERIC
              MOVE 0                      TO PD-YLDRATE
           ELSE
           MOVE OPD-YLDRATE               TO PD-YLDRATE.
           IF OPD-OVRDRATE NOT NUMERIC
              MOVE 0                      TO PD-OVRDRATE
           ELSE
           MOVE OPD-OVRDRATE              TO PD-OVRDRATE.
           IF OPD-ENDORATE NOT NUMERIC
              MOVE 0                      TO PD-ENDORATE
           ELSE
           MOVE OPD-ENDORATE              TO PD-ENDORATE.
           IF OPD-JDRATE NOT NUMERIC
              MOVE 0                      TO PD-JDRATE
           ELSE
           MOVE OPD-JDRATE                TO PD-JDRATE.
           IF OPD-ACCRATE NOT NUMERIC
              MOVE 0                      TO PD-ACCRATE
           ELSE
           MOVE OPD-ACCRATE               TO PD-ACCRATE.
           IF OPD-REDURATE NOT NUMERIC
              MOVE 0                      TO PD-REDURATE
           ELSE
           MOVE OPD-REDURATE              TO PD-REDURATE.
           IF OPD-CONRATE NOT NUMERIC
              MOVE 0                      TO PD-CONRATE
           ELSE
           MOVE OPD-CONRATE               TO PD-CONRATE.
           IF OPD-SERVPER NOT NUMERIC
              MOVE 0                      TO PD-SERVPER
           ELSE
           MOVE OPD-SERVPER               TO PD-SERVPER.

           IF OPD-SELLPR NOT NUMERIC
              MOVE 0                      TO PD-SELLPR
           ELSE
           MOVE OPD-SELLPR                TO PD-SELLPR.
           IF OPD-DOWNPY NOT NUMERIC
              MOVE 0                      TO PD-DOWNPY
           ELSE
           MOVE OPD-DOWNPY                TO PD-DOWNPY.
           IF OPD-TRADEIN NOT NUMERIC
              MOVE 0                      TO PD-TRADEIN
           ELSE
           MOVE OPD-TRADEIN               TO PD-TRADEIN.
           IF OPD-LNAMT NOT NUMERIC
              MOVE 0                      TO PD-LNAMT
           ELSE
           MOVE OPD-LNAMT                 TO PD-LNAMT.
           IF OPD-FINCHG NOT NUMERIC
              MOVE 0                      TO PD-FINCHG
           ELSE
           MOVE OPD-FINCHG                TO PD-FINCHG.
           IF OPD-INTCHG NOT NUMERIC
              MOVE 0                      TO PD-INTCHG
           ELSE
           MOVE OPD-INTCHG                TO PD-INTCHG.
           IF OPD-SERCHG NOT NUMERIC
              MOVE 0                      TO PD-SERCHG
           ELSE
           MOVE OPD-SERCHG                TO PD-SERCHG.
           IF OPD-EXTCHG NOT NUMERIC
              MOVE 0                      TO PD-EXTCHG
           ELSE
           MOVE OPD-EXTCHG                TO PD-EXTCHG.
           IF OPD-MAINTFEE NOT NUMERIC
              MOVE 0                      TO PD-MAINTFEE
           ELSE
           MOVE OPD-MAINTFEE              TO PD-MAINTFEE.
           IF OPD-POINTS NOT NUMERIC
              MOVE 0                      TO PD-POINTS
           ELSE
           MOVE OPD-POINTS                TO PD-POINTS.
           IF OPD-PROCEEDS NOT NUMERIC
              MOVE 0                      TO PD-PROCEEDS
           ELSE
           MOVE OPD-PROCEEDS              TO PD-PROCEEDS.

           IF OPD-ORGTERM NOT NUMERIC
              MOVE 0                      TO PD-ORGTERM
           ELSE
           MOVE OPD-ORGTERM               TO PD-ORGTERM.
           IF OPD-1STPYAMT NOT NUMERIC
              MOVE 0                      TO PD-1STPYAMT
           ELSE
           MOVE OPD-1STPYAMT              TO PD-1STPYAMT.
           IF OPD-NOREGPY NOT NUMERIC
              MOVE 0                      TO PD-NOREGPY
           ELSE
           MOVE OPD-NOREGPY               TO PD-NOREGPY.
           IF OPD-REGPYAMT NOT NUMERIC
              MOVE 0                      TO PD-REGPYAMT
           ELSE
           MOVE OPD-REGPYAMT              TO PD-REGPYAMT.
           IF OPD-LASTPYAMT NOT NUMERIC
              MOVE 0                      TO PD-LASTPYAMT
           ELSE
           MOVE OPD-LASTPYAMT             TO PD-LASTPYAMT.
           IF OPD-PROCASH NOT NUMERIC
              MOVE 0                      TO PD-PROCASH
           ELSE
           MOVE OPD-PROCASH               TO PD-PROCASH.

           IF OPD-TILLNO = "1"
              MOVE 1  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "2"
              MOVE 2  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "3"
              MOVE 3  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "4"
              MOVE 4  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "5"
              MOVE 5  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "6"
              MOVE 6  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "7"
              MOVE 7  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "8"
              MOVE 8  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "9"
              MOVE 9  TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "A"
              MOVE 10 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "B"
              MOVE 11 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "C"
              MOVE 12 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "D"
              MOVE 13 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "E"
              MOVE 14 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "F"
              MOVE 15 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "G"
              MOVE 16 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "H"
              MOVE 17 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "I"
              MOVE 18 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "J"
              MOVE 19 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "K"
              MOVE 20 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "L"
              MOVE 21 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "M"
              MOVE 22 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "N"
              MOVE 23 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "O"
              MOVE 24 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "P"
              MOVE 25 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "Q"
              MOVE 26 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "R"
              MOVE 27 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "S"
              MOVE 28 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "T"
              MOVE 29 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "U"
              MOVE 30 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "V"
              MOVE 31 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "W"
              MOVE 32 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "X"
              MOVE 33 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "Y"
              MOVE 34 TO PD-TILLNO
           ELSE
           IF OPD-TILLNO = "Z"
              MOVE 35 TO PD-TILLNO.

           MOVE OPD-STATE-FLAG            TO PD-STATE-FLAG.
           IF OPD-STATE-WORKER NOT NUMERIC
              MOVE 0                      TO PD-STATE-WORKER
           ELSE
           MOVE OPD-STATE-WORKER          TO PD-STATE-WORKER.
           IF OPD-STATE-WORKER2 NOT NUMERIC
              MOVE 0                      TO PD-STATE-WORKER2
           ELSE
           MOVE OPD-STATE-WORKER2         TO PD-STATE-WORKER2.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              MOVE OPD-FEECODE  (SUB)     TO PD-FEECODE  (SUB)
              IF OPD-FEEAMT(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-FEEAMT(SUB)
              ELSE
              MOVE OPD-FEEAMT   (SUB)     TO PD-FEEAMT   (SUB)
              END-IF
              MOVE OPD-FEEOURS  (SUB)     TO PD-FEEOURS  (SUB)
              MOVE OPD-FEEFINCHG(SUB)     TO PD-FEEFINCHG(SUB)
           END-PERFORM.

           MOVE OPD-INSURED               TO PD-INSURED.
           MOVE OPD-INSTYPES              TO PD-INSTYPES.
           MOVE OPD-INSELIGIBLE           TO PD-INSELIGIBLE.


           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 8
              IF OPD-INSCOMP(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSCOMP(SUB)
              ELSE
              MOVE OPD-INSCOMP      (SUB) TO PD-INSCOMP      (SUB)
              END-IF
              MOVE OPD-INSOURS      (SUB) TO PD-INSOURS      (SUB)
              MOVE OPD-INSEFF       (SUB) TO PD-INSEFF-DATE  (SUB)
              IF OPD-INSEFF(SUB) > 900
                 MOVE OPD-INSEFF(SUB) TO DATE-MMDDYY
                 PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
                 PERFORM TEST-INVALID-DATE
                 MOVE DATE-YYYYMMDD TO PD-INSEFF-DATE(SUB)
              END-IF
              MOVE OPD-INSEXP       (SUB) TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD          TO PD-INSEXP-DATE  (SUB)
              IF OPD-INSPREM(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSPREM(SUB)
              ELSE
              MOVE OPD-INSPREM      (SUB) TO PD-INSPREM      (SUB)
              END-IF
              IF OPD-INSCOVR(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSCOVR(SUB)
              ELSE
              MOVE OPD-INSCOVR      (SUB) TO PD-INSCOVR      (SUB)
              END-IF
              IF OPD-INSCOMM(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSCOMM(SUB)
              ELSE
              MOVE OPD-INSCOMM      (SUB) TO PD-INSCOMM      (SUB)
              END-IF
              IF OPD-INSANTICERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSANTICERN(SUB)
              ELSE
              MOVE OPD-INSANTICERN  (SUB) TO PD-INSANTICERN  (SUB)
              END-IF
              IF OPD-INSANTICADJ(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSANTICADJ(SUB)
              ELSE
              MOVE OPD-INSANTICADJ  (SUB) TO PD-INSANTICADJ  (SUB)
              END-IF
              IF OPD-INSUFERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSUFERN(SUB)
              ELSE
              MOVE OPD-INSUFERN     (SUB) TO PD-INSUFERN     (SUB)
              END-IF
              IF OPD-INSACCERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSACCERN(SUB)
              ELSE
              MOVE OPD-INSACCERN    (SUB) TO PD-INSACCERN    (SUB)
              END-IF
              IF OPD-INSEARN-ORDER(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-INSEARN-ORDER(SUB)
              ELSE
              MOVE OPD-INSEARN-ORDER(SUB) TO PD-INSEARN-ORDER(SUB)
              END-IF
              MOVE OPD-INSFINCHG    (SUB) TO PD-INSFINCHG    (SUB)
           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * THIS WILL MOVE THE MMYY FROM THE OLD TO THE NEW UNTIL WE CHANGE
      * THE WAY IT WORKS IN A30.
           IF OPD-PYMMYY-RECDEL NOT NUMERIC
              MOVE 0                      TO PD-PY-YYYYMM-RECDEL
           ELSE
              MOVE OPD-PYMMYY-RECDEL      TO DATE-MMYY
              PERFORM CONVERT-MMYY-TO-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMM
              MOVE DATE-YYYYMM            TO PD-PY-YYYYMM-RECDEL.
           IF OPD-MTD-PAYS-RECDEL NOT NUMERIC
              MOVE 0                      TO PD-MTD-PAYS-RECDEL
           ELSE
           MOVE OPD-MTD-PAYS-RECDEL       TO PD-MTD-PAYS-RECDEL.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OPD-GARNISH-EXTR IS A REDEFINE OF OPD-GIFTNET-EXTR
      *          IN A15.  PD-GIFTNET-EXTR WAS REMOVED IN A30.
      *          PD-GARNISH-EXTR IS USED FOR MODERN FINANCE.
      *          2017-0609, BETH & JAY DISCUSSED AND MOVING 
      *          OPD-GARNISH-EXTR TO PD-GARNISH-EXTR JUST IN CASE
      *          EVENTHOUGH MAY NEVER BE USED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE OPD-GIFTNET-EXTR          TO PD-GIFTNET-EXTR.
           MOVE OPD-GARNISH-EXTR          TO PD-GARNISH-EXTR.

           MOVE OPD-SHIP-SAME-FG          TO PD-SHIP-SAME-FG.
           IF OPD-AD-D-INS-COVR NOT NUMERIC
              MOVE 0                      TO PD-AD-D-INS-COVR
           ELSE
           MOVE OPD-AD-D-INS-COVR         TO PD-AD-D-INS-COVR.
           IF OPD-TOT-PARTIAL-CHGOFF NOT NUMERIC
              MOVE 0                      TO PD-TOT-PARTIAL-CHGOFF
           ELSE
           MOVE OPD-TOT-PARTIAL-CHGOFF    TO PD-TOT-PARTIAL-CHGOFF.
           MOVE OPD-LPO                   TO PD-LPO.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NOTE: OPD-EMP-ID IS A REDEFINES OF OPD-REP-CD IN A15.
      *          PD-EMP-ID WAS SEPERATED FROM PD-REP-CD IN A30.
           PERFORM TEST-INVALID-DATE.
      *          PD-EMP-ID IS POPULATED FROM OPD-EMP-ID IF WORLD.
      *          PD-REP-CD IS POPULATED FROM OPD-REP-CD NOT WORLD.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( OPD-EMP-ID NUMERIC )
              MOVE OPD-EMP-ID             TO PD-EMP-ID
           ELSE
              MOVE OPD-REP-CD             TO PD-REP-CD.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE OPD-PROCESS-CD            TO PD-PROCESS-CD.
           IF OPD-WCBC-CREDITLIM NOT NUMERIC
              MOVE 0                      TO PD-WCBC-CREDITLIM
           ELSE
              MOVE OPD-WCBC-CREDITLIM     TO PD-WCBC-CREDITLIM.
           MOVE OPD-FOLLOWUP-CD           TO PD-FOLLOWUP-CD.
           MOVE OPD-MIP-FG                TO PD-MIP-FG.

           IF OPD-MIP-MTD-CLAHPAID NOT NUMERIC
              MOVE 0                      TO PD-MIP-MTD-CLAHPAID 
           ELSE
              MOVE OPD-MIP-MTD-CLAHPAID   TO PD-MIP-MTD-CLAHPAID.

           IF OPD-MIP-CLPDTH NOT NUMERIC
              MOVE 0 TO PD-MIP-CLPDTH-DATE
           ELSE
              MOVE OPD-MIP-CLPDTH         TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD          TO PD-MIP-CLPDTH-DATE.

           IF OPD-MIP-TOT-CLPAID NOT NUMERIC OR
               OPD-MIP-TOT-CLPAID = 0202020.20 OR 2020202.02
              MOVE 0 TO PD-MIP-TOT-CLPAID PD-IL-GROSS-INCOME
           ELSE
              MOVE OPD-MIP-TOT-CLPAID     TO PD-MIP-TOT-CLPAID.

           IF OPD-MIP-AHPDTH NOT NUMERIC
              MOVE 0 TO PD-MIP-AHPDTH-DATE
           ELSE
              MOVE OPD-MIP-AHPDTH         TO DATE-MMDDYY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD          TO PD-MIP-AHPDTH-DATE.

           IF OPD-MIP-TOT-AHPAID NOT NUMERIC OR
               OPD-MIP-TOT-AHPAID = 0202020.20 OR 2020202.02
              MOVE 0 TO PD-MIP-TOT-AHPAID PD-IL-GROSS-INCOME2
           ELSE
              MOVE OPD-MIP-TOT-AHPAID     TO PD-MIP-TOT-AHPAID.

           MOVE OPD-RESCISSION            TO PD-RESCISSION.
           MOVE OPD-INTERIM-TRW           TO PD-INTERIM-TRW.
           IF OPD-DLNO NOT NUMERIC
              MOVE 0                      TO PD-DLNO
           ELSE
           MOVE OPD-DLNO                  TO PD-DLNO.
           IF OPD-DLPOOL NOT NUMERIC
              MOVE 0                      TO PD-DLPOOL
           ELSE
           MOVE OPD-DLPOOL                TO PD-DLPOOL.
           MOVE OPD-DLRECOURSE            TO PD-DLRECOURSE.
           IF OPD-DLPARTRCAMT NOT NUMERIC
              MOVE 0                      TO PD-DLPARTRCAMT
           ELSE
           MOVE OPD-DLPARTRCAMT           TO PD-DLPARTRCAMT.
           IF OPD-ORIGPURAMT NOT NUMERIC
              MOVE 0                      TO PD-ORIGPURAMT
           ELSE
           MOVE OPD-ORIGPURAMT            TO PD-ORIGPURAMT.
           IF OPD-PURBAL NOT NUMERIC
              MOVE 0                      TO PD-PURBAL
           ELSE
           MOVE OPD-PURBAL                TO PD-PURBAL.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              IF OPD-DLRVPRIN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-DLRVPRIN(SUB)
              ELSE
               MOVE OPD-DLRVPRIN(SUB)     TO PD-DLRVPRIN(SUB)
              END-IF
              IF OPD-DLRVCHGS(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-DLRVCHGS(SUB)
              ELSE
               MOVE OPD-DLRVCHGS(SUB)     TO PD-DLRVCHGS(SUB)
              END-IF
           END-PERFORM.

           IF OPD-DLPARVHELD NOT NUMERIC
              MOVE 0                      TO PD-DLPARVHELD
           ELSE
           MOVE OPD-DLPARVHELD            TO PD-DLPARVHELD.
           IF OPD-DLPARVPAID NOT NUMERIC
              MOVE 0                      TO PD-DLPARVPAID
           ELSE
           MOVE OPD-DLPARVPAID            TO PD-DLPARVPAID.
           IF OPD-DLDISC NOT NUMERIC
              MOVE 0                      TO PD-DLDISC
           ELSE
           MOVE OPD-DLDISC                TO PD-DLDISC.

           IF OPD-LCPDTH NOT NUMERIC
              MOVE 0 TO                   PD-LCPDTH-DATE
           ELSE
              MOVE OPD-LCPDTH                TO DATE-MMDDYY
              IF (DATE-MMDDYY-MM = 0) AND (DATE-MMDDYY-YY = 0) 
                 MOVE OPD-LOANDATE TO OPD-LCPDTH DATE-MMDDYY
              END-IF
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              PERFORM TEST-INVALID-DATE
              MOVE DATE-YYYYMMDD             TO PD-LCPDTH-DATE.

           MOVE OPD-INTPDTH            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-INTPDTH-DATE.

           IF OPD-CURBAL NOT NUMERIC
              MOVE 0                      TO PD-CURBAL
           ELSE
           MOVE OPD-CURBAL                TO PD-CURBAL.
           IF OPD-INTBAL NOT NUMERIC
              MOVE 0                      TO PD-INTBAL
           ELSE
           MOVE OPD-INTBAL                TO PD-INTBAL.
           IF OPD-LCBAL NOT NUMERIC
              MOVE 0                      TO PD-LCBAL
           ELSE
           MOVE OPD-LCBAL                 TO PD-LCBAL.
           IF OPD-OTHBAL NOT NUMERIC
              MOVE 0                      TO PD-OTHBAL
           ELSE
           MOVE OPD-OTHBAL                TO PD-OTHBAL.
           IF OPD-OT2BAL NOT NUMERIC
              MOVE 0                      TO PD-OT2BAL
           ELSE
           MOVE OPD-OT2BAL                TO PD-OT2BAL.
           IF OPD-LCPAID NOT NUMERIC
              MOVE 0                      TO PD-LCPAID
           ELSE
           MOVE OPD-LCPAID                TO PD-LCPAID.
           IF OPD-LCPARTIALS NOT NUMERIC
              MOVE 0                      TO PD-LCPARTIALS
           ELSE
           MOVE OPD-LCPARTIALS            TO PD-LCPARTIALS.
           IF OPD-STMT-COUNTER NOT NUMERIC
              MOVE 0                      TO PD-STMT-COUNTER
           ELSE
           MOVE OPD-STMT-COUNTER          TO PD-STMT-COUNTER.
           IF OPD-PRIOR-STMT-COUNTER NOT NUMERIC
              MOVE 0                      TO PD-PRIOR-STMT-COUNTER
           ELSE
           MOVE OPD-PRIOR-STMT-COUNTER    TO PD-PRIOR-STMT-COUNTER.

           MOVE SPACES                    TO PD-FROZEN-REASON.
      *    MOVE OPD-COUPON-STATEMENT      TO PD-COUPON-STATEMENT.
           IF OPD-MONTHEND-BAL NOT NUMERIC
              MOVE 0                      TO PD-MONTHEND-BAL
           ELSE
           MOVE OPD-MONTHEND-BAL          TO PD-MONTHEND-BAL.

           IF OPD-ANTICTERM NOT NUMERIC
              MOVE 0                      TO PD-ANTICTERM
           ELSE
           MOVE OPD-ANTICTERM             TO PD-ANTICTERM.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
              IF OPD-ANTICERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-ANTICERN(SUB)
              ELSE
              MOVE OPD-ANTICERN  (SUB)    TO PD-ANTICERN  (SUB)
              END-IF
              IF OPD-ANTICADJ(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-ANTICADJ(SUB)
              ELSE
              MOVE OPD-ANTICADJ  (SUB)    TO PD-ANTICADJ  (SUB)
              END-IF
              IF OPD-UFERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-UFERN(SUB)
              ELSE
              MOVE OPD-UFERN     (SUB)    TO PD-UFERN     (SUB)
              END-IF
              IF OPD-ACCERN(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-ACCERN(SUB)
              ELSE
              MOVE OPD-ACCERN    (SUB)    TO PD-ACCERN    (SUB)
              END-IF
              IF OPD-EARN-ORDER(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-EARN-ORDER(SUB)
              ELSE
                 MOVE OPD-EARN-ORDER(SUB) TO PD-EARN-ORDER(SUB)
              END-IF
           END-PERFORM.

           IF OPD-LMO-PRIOR-UNEARNED NOT NUMERIC
              MOVE 0                      TO PD-LMO-PRIOR-INTEREST
           ELSE
           MOVE OPD-LMO-PRIOR-UNEARNED    TO PD-LMO-PRIOR-INTEREST.
           IF OPD-PRIOR-UNEARNED NOT NUMERIC
              MOVE 0                      TO PD-PRIOR-UNEARNED
           ELSE
           MOVE OPD-PRIOR-UNEARNED        TO PD-PRIOR-UNEARNED.
           MOVE OPD-ERNDELQ-STOP          TO PD-ERNDELQ-STOP.
           IF OPD-NONACRERN NOT NUMERIC
              MOVE 0                      TO PD-NONACRERN
           ELSE
           MOVE OPD-NONACRERN             TO PD-NONACRERN.
           IF OPD-PRIOR-NONACRERN NOT NUMERIC
              MOVE 0                      TO PD-PRIOR-NONACRERN
           ELSE
           MOVE OPD-PRIOR-NONACRERN       TO PD-PRIOR-NONACRERN.

           MOVE OPD-ERN-IB-PDTH            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-ERN-IB-PDTH-DATE.

           IF OPD-ERN-IB-PRINBAL NOT NUMERIC
              MOVE 0                      TO PD-ERN-IB-PRINBAL
           ELSE
           MOVE OPD-ERN-IB-PRINBAL        TO PD-ERN-IB-PRINBAL.
           IF OPD-ERN-IB-INTOWE NOT NUMERIC
              MOVE 0                      TO PD-ERN-IB-INTOWE
           ELSE
           MOVE OPD-ERN-IB-INTOWE         TO PD-ERN-IB-INTOWE.
           IF OPD-TOTERN NOT NUMERIC
              MOVE 0                      TO PD-TOTERN
           ELSE
           MOVE OPD-TOTERN                TO PD-TOTERN.
           IF OPD-TOTOTH NOT NUMERIC
              MOVE 0                      TO PD-TOTOTH
           ELSE
           MOVE OPD-TOTOTH                TO PD-TOTOTH.
           IF OPD-TOTINT NOT NUMERIC
              MOVE 0                      TO PD-TOTINT
           ELSE
           MOVE OPD-TOTINT                TO PD-TOTINT.
           IF OPD-TOTLCHG NOT NUMERIC
              MOVE 0                      TO PD-TOTLCHG
           ELSE
           MOVE OPD-TOTLCHG               TO PD-TOTLCHG.
           IF OPD-TOTDEF NOT NUMERIC
              MOVE 0                      TO PD-TOTDEF
           ELSE
           MOVE OPD-TOTDEF                TO PD-TOTDEF.
           IF OPD-TOTSERACCT NOT NUMERIC
              MOVE 0                      TO PD-TOTSERACCT
           ELSE
           MOVE OPD-TOTSERACCT            TO PD-TOTSERACCT.
           IF OPD-LCWAIVERS NOT NUMERIC
              MOVE 0                      TO PD-LCWAIVERS
           ELSE
           MOVE OPD-LCWAIVERS             TO PD-LCWAIVERS.
           IF OPD-INTWAIVERS NOT NUMERIC
              MOVE 0                      TO PD-INTWAIVERS
           ELSE
           MOVE OPD-INTWAIVERS            TO PD-INTWAIVERS.
           IF OPD-TOTPAYMNTD NOT NUMERIC
              MOVE 0                      TO PD-TOTPAYMNTD
           ELSE
           MOVE OPD-TOTPAYMNTD            TO PD-TOTPAYMNTD.
           IF OPD-TOTEXCPAYMNTD NOT NUMERIC
              MOVE 0                      TO PD-TOTEXCPAYMNTD
           ELSE
           MOVE OPD-TOTEXCPAYMNTD         TO PD-TOTEXCPAYMNTD.
           IF OPD-TOTNODEF NOT NUMERIC
              MOVE 0                      TO PD-TOTNODEF
           ELSE
           MOVE OPD-TOTNODEF              TO PD-TOTNODEF.
           IF OPD-YTDNODEF NOT NUMERIC
              MOVE 0                      TO PD-YTDNODEF
           ELSE
           MOVE OPD-YTDNODEF              TO PD-YTDNODEF.
           IF OPD-TOTNODEFACT NOT NUMERIC
              MOVE 0                      TO PD-TOTNODEFACT
           ELSE
              MOVE OPD-TOTNODEFACT        TO PD-TOTNODEFACT.
           IF OPD-YTDNODEFACT NOT NUMERIC
              MOVE 0                      TO PD-YTDNODEFACT
           ELSE
              MOVE OPD-YTDNODEFACT        TO PD-YTDNODEFACT.
           IF OPD-TOTNOALDEL NOT NUMERIC
              MOVE 0                      TO PD-TOTNOALDEL
           ELSE
           MOVE OPD-TOTNOALDEL            TO PD-TOTNOALDEL.
           IF OPD-YTDNOALDEL NOT NUMERIC
              MOVE 0                      TO PD-YTDNOALDEL
           ELSE
           MOVE OPD-YTDNOALDEL            TO PD-YTDNOALDEL.
           IF OPD-YTDINTPD NOT NUMERIC
              MOVE 0                      TO PD-YTDINTPD
           ELSE
           MOVE OPD-YTDINTPD              TO PD-YTDINTPD.
           IF OPD-LYRINTPD NOT NUMERIC
              MOVE 0                      TO PD-LYRINTPD
           ELSE
           MOVE OPD-LYRINTPD              TO PD-LYRINTPD.
           IF OPD-TOTINTPD NOT NUMERIC
              MOVE 0                      TO PD-TOTINTPD
           ELSE
           MOVE OPD-TOTINTPD              TO PD-TOTINTPD.
           IF OPD-RECASTINT NOT NUMERIC
              MOVE 0                      TO PD-RECASTINT
           ELSE
           MOVE OPD-RECASTINT             TO PD-RECASTINT.
           IF OPD-RECASTPRIN NOT NUMERIC
              MOVE 0                      TO PD-RECASTPRIN
           ELSE
           MOVE OPD-RECASTPRIN            TO PD-RECASTPRIN.

           MOVE OPD-CL-REBATE             TO PD-CL-REBATE.
           MOVE OPD-AH-REBATE             TO PD-AH-REBATE.
           MOVE OPD-PP-REBATE             TO PD-PP-REBATE.
           MOVE OPD-INT-REBATE            TO PD-INT-REBATE.
           MOVE OPD-SC-REBATE             TO PD-SC-REBATE.
           MOVE OPD-MF-REBATE             TO PD-MF-REBATE.
           MOVE OPD-DF-REBATE             TO PD-DF-REBATE.
           MOVE OPD-EX-REBATE             TO PD-EX-REBATE.
           MOVE OPD-O1-REBATE             TO PD-O1-REBATE.
           MOVE OPD-O2-REBATE             TO PD-O2-REBATE.
           MOVE OPD-O3-REBATE             TO PD-O3-REBATE.
           MOVE OPD-O4-REBATE             TO PD-O4-REBATE.
           MOVE OPD-O5-REBATE             TO PD-O5-REBATE.

           MOVE OPD-PLREASON              TO PD-PLREASON.
           MOVE OPD-COLLECTOR             TO PD-COLLECTOR.
           MOVE OPD-ACTIONCD              TO PD-ACTIONCD.
           MOVE OPD-ACTIONCD2             TO PD-ACTIONCD2.
           MOVE OPD-ATCODE                TO PD-ATCODE.
           MOVE OPD-RECODE                TO PD-RECODE.

           IF OPD-PROMDAYS-PASTDUE NOT NUMERIC
              MOVE 0                      TO PD-PROMDAYS-PASTDUE
           ELSE
           MOVE OPD-PROMDAYS-PASTDUE      TO PD-PROMDAYS-PASTDUE.
           MOVE OPD-PROMID                TO PD-PROMID.

           MOVE OPD-PROMDATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PROMDATE.

           IF OPD-PROMAMT NOT NUMERIC
              MOVE 0                      TO PD-PROMAMT
           ELSE
           MOVE OPD-PROMAMT               TO PD-PROMAMT.

           MOVE OPD-PROMDATE2             TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PROMDATE2.

           MOVE OPD-DATE-PAID-LAST            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-DATE-PAID-LAST.

           IF OPD-AMT-PAID-LAST NOT NUMERIC
              MOVE 0                      TO PD-AMT-PAID-LAST
           ELSE
           MOVE OPD-AMT-PAID-LAST         TO PD-AMT-PAID-LAST.
           IF OPD-LASTCFORMNO NOT NUMERIC
              MOVE 0                      TO PD-LASTCFORMNO
           ELSE
           MOVE OPD-LASTCFORMNO           TO PD-LASTCFORMNO.
           MOVE OPD-LASTCFORMDATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LASTCFORMDATE.
           IF OPD-DELCNT NOT NUMERIC
              MOVE 0                      TO PD-DELCNT
           ELSE
           MOVE OPD-DELCNT                TO PD-DELCNT.
           IF OPD-DELCNT2 NOT NUMERIC
              MOVE 0                      TO PD-DELCNT2
           ELSE
           MOVE OPD-DELCNT2               TO PD-DELCNT2.
           IF OPD-CREDITLIM NOT NUMERIC
              MOVE 0                      TO PD-CREDITLIM
           ELSE
           MOVE OPD-CREDITLIM             TO PD-CREDITLIM.
           IF OPD-CRSCORE NOT NUMERIC
              MOVE 0                      TO PD-CRSCORE
           ELSE
           MOVE OPD-CRSCORE               TO PD-CRSCORE.
           IF OPD-LASTSFORMNO NOT NUMERIC
              MOVE 0                      TO PD-LASTSFORMNO
           ELSE
           MOVE OPD-LASTSFORMNO           TO PD-LASTSFORMNO.
           MOVE OPD-LASTSFORMDATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-LASTSFORMDATE.
           IF OPD-SOLCNT NOT NUMERIC
              MOVE 0                      TO PD-SOLCNT
           ELSE
           MOVE OPD-SOLCNT                TO PD-SOLCNT.
           MOVE OPD-MESSAGE               TO PD-MESSAGE.

           IF OPD-OLDACCTNO NOT NUMERIC
              MOVE 0                      TO PD-OLDACCTNO
           ELSE
              MOVE OPD-OLDACCTNO           TO OLD-ACCTNO
              MOVE NEW-ACCTNO              TO PD-OLDACCTNO.

           IF OPD-PRLNNO NOT NUMERIC
              MOVE 0                      TO PD-PRLNNO
           ELSE
              MOVE OPD-PRLNNO                TO OLD-ACCTNO
              MOVE NEW-ACCTNO                TO PD-PRLNNO.

           IF OPD-PRBAL NOT NUMERIC
              MOVE 0                      TO PD-PRBAL
           ELSE
           MOVE OPD-PRBAL                 TO PD-PRBAL.
           IF OPD-PRINTDUE NOT NUMERIC
              MOVE 0                      TO PD-PRINTDUE
           ELSE
           MOVE OPD-PRINTDUE              TO PD-PRINTDUE.
           IF OPD-PRFINCHGRB NOT NUMERIC
              MOVE 0                      TO PD-PRFINCHGRB
           ELSE
           MOVE OPD-PRFINCHGRB            TO PD-PRFINCHGRB.
           IF OPD-PRINSRB NOT NUMERIC
              MOVE 0                      TO PD-PRINSRB
           ELSE
           MOVE OPD-PRINSRB               TO PD-PRINSRB.
           MOVE OPD-PRPOCD                TO PD-PRPOCD.
           MOVE OPD-PRPODATE            TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD             TO PD-PRPODATE.
           IF OPD-PRDELINQAMT NOT NUMERIC
              MOVE 0                      TO PD-PRDELINQAMT
           ELSE
           MOVE OPD-PRDELINQAMT           TO PD-PRDELINQAMT.
           IF OPD-PRLNAMT NOT NUMERIC
              MOVE 0                      TO PD-PRLNAMT
           ELSE
           MOVE OPD-PRLNAMT               TO PD-PRLNAMT.
           IF OPD-PRPDUE-DAYS NOT NUMERIC
              MOVE 0                      TO PD-PRPDUE-DAYS
           ELSE
           MOVE OPD-PRPDUE-DAYS           TO PD-PRPDUE-DAYS.

           IF OPD-PRDLDISC-UNEARN NOT NUMERIC
              MOVE 0                      TO PD-PRDLDISC-UNEARN
           ELSE
           MOVE OPD-PRDLDISC-UNEARN       TO PD-PRDLDISC-UNEARN.
           IF OPD-PRCONPROFILE NOT NUMERIC
              MOVE 0                      TO PD-PRCONPROFILE
           ELSE
           MOVE OPD-PRCONPROFILE          TO PD-PRCONPROFILE.
           IF OPD-SUM-ORIGPURAMT NOT NUMERIC
              MOVE 0                      TO PD-SUM-ORIGPURAMT
           ELSE
           MOVE OPD-SUM-ORIGPURAMT        TO PD-SUM-ORIGPURAMT.
           IF OPD-SUM-LNAMT NOT NUMERIC
              MOVE 0                      TO PD-SUM-LNAMT
           ELSE
           MOVE OPD-SUM-LNAMT             TO PD-SUM-LNAMT.
           IF OPD-SUM-FINCHG NOT NUMERIC
              MOVE 0                      TO PD-SUM-FINCHG
           ELSE
           MOVE OPD-SUM-FINCHG            TO PD-SUM-FINCHG.
           IF OPD-SUM-INTCHG NOT NUMERIC
              MOVE 0                      TO PD-SUM-INTCHG
           ELSE
           MOVE OPD-SUM-INTCHG            TO PD-SUM-INTCHG.
           IF OPD-SUM-ORGTERM NOT NUMERIC
              MOVE 0                      TO PD-SUM-ORGTERM
           ELSE
           MOVE OPD-SUM-ORGTERM           TO PD-SUM-ORGTERM.
           IF OPD-SUM-REGPYAMT NOT NUMERIC
              MOVE 0                      TO PD-SUM-REGPYAMT
           ELSE
           MOVE OPD-SUM-REGPYAMT          TO PD-SUM-REGPYAMT.
           IF OPD-SUM-EXTCHG NOT NUMERIC
              MOVE 0                      TO PD-SUM-EXTCHG
           ELSE
           MOVE OPD-SUM-EXTCHG            TO PD-SUM-EXTCHG.
           IF OPD-SUM-SERCHG NOT NUMERIC
              MOVE 0                      TO PD-SUM-SERCHG
           ELSE
           MOVE OPD-SUM-SERCHG            TO PD-SUM-SERCHG.
           IF OPD-SUM-MAINTFEE NOT NUMERIC
              MOVE 0                      TO PD-SUM-MAINTFEE
           ELSE
           MOVE OPD-SUM-MAINTFEE          TO PD-SUM-MAINTFEE.

           MOVE OPD-UNITPER-CD            TO PD-UNITPER-CD.
           IF OPD-UNITPER-FREQ NOT NUMERIC
              MOVE 0                      TO PD-UNITPER-FREQ
           ELSE
           MOVE OPD-UNITPER-FREQ          TO PD-UNITPER-FREQ.
           IF OPD-DAYS-IN-UNITPER NOT NUMERIC
              MOVE 0                      TO PD-DAYS-IN-UNITPER
           ELSE
           MOVE OPD-DAYS-IN-UNITPER       TO PD-DAYS-IN-UNITPER.
           IF OPD-UNITPER-PER-YEAR NOT NUMERIC
              MOVE 0                      TO PD-UNITPER-PER-YEAR
           ELSE
           MOVE OPD-UNITPER-PER-YEAR      TO PD-UNITPER-PER-YEAR.
           MOVE OPD-REPOCD                TO PD-REPOCD.
           MOVE OPD-BR-TFR-FG             TO PD-BR-TFR-FG.
           IF OPD-O3INS-DLPROC NOT NUMERIC
              MOVE 0                      TO PD-O3INS-DLPROC
           ELSE
           MOVE OPD-O3INS-DLPROC          TO PD-O3INS-DLPROC.
           IF OPD-INSPREM-DLADJ NOT NUMERIC
              MOVE 0                      TO PD-INSPREM-DLADJ
           ELSE
           MOVE OPD-INSPREM-DLADJ         TO PD-INSPREM-DLADJ.
           IF OPD-PLAMT NOT NUMERIC
              MOVE 0                      TO PD-PLAMT
           ELSE
           MOVE OPD-PLAMT                 TO PD-PLAMT.
           IF OPD-MTD-PRIN NOT NUMERIC
              MOVE 0                      TO PD-MTD-PRIN
           ELSE
           MOVE OPD-MTD-PRIN              TO PD-MTD-PRIN.
           IF OPD-MTD-LC NOT NUMERIC
              MOVE 0                      TO PD-MTD-LC
           ELSE
           MOVE OPD-MTD-LC                TO PD-MTD-LC.
           IF OPD-MTD-INT NOT NUMERIC
              MOVE 0                      TO PD-MTD-INT
           ELSE
           MOVE OPD-MTD-INT               TO PD-MTD-INT.
           IF OPD-MTD-OT NOT NUMERIC
              MOVE 0                      TO PD-MTD-OT
           ELSE
           MOVE OPD-MTD-OT                TO PD-MTD-OT.
           IF OPD-MTD-EX NOT NUMERIC
              MOVE 0                      TO PD-MTD-EX
           ELSE
           MOVE OPD-MTD-EX                TO PD-MTD-EX.
           IF OPD-BNKRPT-CHAPTER NOT NUMERIC
              MOVE 0                      TO PD-BNKRPT-CHAPTER
           ELSE
           MOVE OPD-BNKRPT-CHAPTER        TO PD-BNKRPT-CHAPTER.
           MOVE OPD-BMO-CON-STATUS        TO PD-BMO-CON-STATUS.
           MOVE OPD-BMO-REC-STATUS        TO PD-BMO-REC-STATUS.

           IF ( OPD-APPNO = ZEROES )
              MOVE ZEROES                 TO PD-APP-NUMBER
           ELSE
              MOVE OPD-APPNO              TO WSS-MA-APPNO
              MOVE 01                     TO WSS-MA-SEQNO
              MOVE WSS-MA-APP-NUMBER      TO PD-APP-NUMBER.

           MOVE OPD-GIFTNET               TO PD-GIFTNET.
           IF OPD-GIFTNET-OUR-PO NOT NUMERIC OR
               (OPD-GIFTNET-OUR-PO = 202020)
              MOVE 0                      TO PD-GIFTNET-OUR-PO
           ELSE
              MOVE OPD-GIFTNET-OUR-PO     TO PD-GIFTNET-OUR-PO.
           MOVE OPD-PROC-DISBURSED        TO PD-PROC-DISBURSED.
           IF OPD-NOODDPY NOT NUMERIC
              MOVE 0                      TO PD-NOODDPY
           ELSE
           MOVE OPD-NOODDPY               TO PD-NOODDPY.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 5
              IF OPD-CONPROFILE(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-CONPROFILE(SUB)
              ELSE
              MOVE OPD-CONPROFILE(SUB)    TO PD-CONPROFILE(SUB)
              END-IF
              IF OPD-RECPROFILE(SUB) NOT NUMERIC
                 MOVE 0                   TO PD-RECPROFILE(SUB)
              ELSE
              MOVE OPD-RECPROFILE(SUB)    TO PD-RECPROFILE(SUB)
              END-IF
           END-PERFORM.
           MOVE OPD-TRW-STATUS            TO PD-TRW-STATUS.
           MOVE OPD-ORIGIN                TO PD-ORIGIN.
           MOVE OPD-PO-TRCD               TO PD-PO-TRCD.

           IF OPD-NEXIS-CRSCORE NOT NUMERIC
              MOVE 0                      TO PD-NEXIS-CRSCORE
           ELSE
              MOVE OPD-NEXIS-CRSCORE      TO PD-NEXIS-CRSCORE.
           MOVE OPD-TRW-B-CONSUMER-IND    TO PD-TRW-B-CONSUMER-IND.

      *?   MOVE OPD-PARVHELD-PAID-FG      TO PD-PARVHELD-PAID-FG.

           MOVE OPD-ACCT-FROZEN           TO PD-ACCT-FROZEN.
           MOVE OPD-TRW-SPECIAL-CODE      TO PD-TRW-SPECIAL-CODE.

           MOVE OPD-CREATION-STATUS       TO PD-CREATION-STATUS.
           IF OPD-TOTNOLCHG NOT NUMERIC
              MOVE 0                      TO PD-TOTNOLCHG
           ELSE
              MOVE OPD-TOTNOLCHG          TO PD-TOTNOLCHG.
           MOVE OPD-LBOX                  TO PD-LBOX.
 
           IF OPD-EXTRA-PRIN-LFP NOT NUMERIC
              MOVE 0                      TO PD-EXTRA-PRIN-LFP
           ELSE
           MOVE OPD-EXTRA-PRIN-LFP        TO PD-EXTRA-PRIN-LFP.
           IF OPD-REMAIN-INT-SINCE-LFP NOT NUMERIC
              MOVE 0                      TO PD-REMAIN-INT-SINCE-LFP
           ELSE
           MOVE OPD-REMAIN-INT-SINCE-LFP  TO PD-REMAIN-INT-SINCE-LFP.
           IF OPD-REMAIN-PRIN-SINCE-LFP NOT NUMERIC
              MOVE 0                      TO PD-REMAIN-PRIN-SINCE-LFP
           ELSE
           MOVE OPD-REMAIN-PRIN-SINCE-LFP TO PD-REMAIN-PRIN-SINCE-LFP.

           MOVE OPD-INTERIM-COUPON        TO PD-INTERIM-COUPON.
           IF OPD-DLCOMM-O3-CMSI NOT NUMERIC
              MOVE 0                      TO PD-DLCOMM-O3-CMSI
           ELSE
           MOVE OPD-DLCOMM-O3-CMSI        TO PD-DLCOMM-O3-CMSI.
           IF OPD-DLCOMM-PP-CMSI NOT NUMERIC
              MOVE 0                      TO PD-DLCOMM-PP-CMSI
           ELSE
           MOVE OPD-DLCOMM-PP-CMSI        TO PD-DLCOMM-PP-CMSI.
           MOVE OPD-TRW-J-CONSUMER-IND    TO PD-TRW-J-CONSUMER-IND.
           MOVE OPD-ACH                   TO PD-ACH.

      *?   MOVE OPD-1099-C-FG             TO PD-1099-C-FG.
      *?   MOVE OPD-TRW-COMPLIANCE-CODE   TO PD-TRW-COMPLIANCE-CODE.
      *?   MOVE OPD-UNWIND-REASON-CODE    TO PD-UNWIND-REASON-CODE.

      *- - - - - - - - - - - - - - - - - - - - - -{ NEW FIELDS SKIPPED }
      *        05  PD-PBI-PBD-FG               PIC X.
      *        05  PD-OLD-ACCT-FORMAT-FG       PIC X.
      *        05  PD-PAPERLESS-STMT-FG        PIC X.
      *        05  PD-APPROVED-BY-USER         PIC X(10).
      *        05  PD-APPROVED-BY-CODE         PIC X(3).
      *        05  PD-APPROVED-BY-DATE         PIC 9(8)     COMP-3.
      *        05  PD-APPROVED-BY-TIME         PIC 9(6)     COMP-3.
      *        05  PD-TAX-AMT                  PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT1              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT2              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT3              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT4              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT5              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT6              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT7              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT8              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT9              PIC S9(7)V99 COMP-3.
      *        05  PD-FUTURE-AMT10             PIC S9(7)V99 COMP-3.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES                     TO PD-LTOUCH-DATE.
           MOVE ZEROES                     TO PD-LTOUCH-TIME.

      *  ^^^^^^^END OF PD-RECORD FIELDS^^^^^^
      * OPD-REST-OF-REC.

           MOVE OPD-MSG1                  TO PD-MSG1.
           MOVE OPD-MSG2                  TO PD-MSG2.
           MOVE OPD-DLPAID                TO PD-DLPAID.
           IF OPD-CKNO NOT NUMERIC
              MOVE 0                      TO PD-CKNO
           ELSE
           MOVE OPD-CKNO                  TO PD-CKNO.

      * OPD-FREE-SPACE.
      *   MOVE REDEFINES FIELDS INDIVIDUALLY AS SOME OF THE SIZES HAVE CHANGED
      *    MOVE OPD-FREE1                 TO PD-FREE1.
      *    MOVE OPD-FREE2                 TO PD-FREE2.

      * VVVVVV  OPD-NEW-FIELDS REDEFINES PD-FREE-SPACE.
           IF OPD-FINAMT NOT NUMERIC
              MOVE 0                      TO PD-FINAMT
           ELSE
           MOVE OPD-FINAMT                TO PD-FINAMT.
           MOVE OPD-PROCEEDS-FG           TO PD-PROCEEDS-FG.
           MOVE OPD-POINTS-FG             TO PD-POINTS-FG.
           MOVE OPD-OVRDRATE-FG           TO PD-OVRDRATE-FG.
           MOVE OPD-SERCHG-FG             TO PD-SERCHG-FG.
           MOVE OPD-MAINTFEE-FG           TO PD-MAINTFEE-FG.
           MOVE OPD-EXTCHG-FG             TO PD-EXTCHG-FG.
           MOVE OPD-REGPYAMT-FG           TO PD-REGPYAMT-FG.

      * IS COMP IN A15 AND "NOT NUMERIC" DOES NOT WORK. NEED TO TEST
      * FOR SPACES AND OTHER ODD VALUE
           IF OPD-PRPAID-AHEAD = 2020202.02 OR 0202020.20 OR
                               -2020202.02 OR -0202020.20 OR
                                 5389762.88
              MOVE 0                      TO PD-PRPAID-AHEAD
           ELSE
              MOVE OPD-PRPAID-AHEAD       TO PD-PRPAID-AHEAD.
           IF OPD-RESTRICT-ADJ = 2020202.02 OR 0202020.20 OR
                               -2020202.02 OR -0202020.20 OR
                                 5389762.88
              MOVE 0                      TO PD-RESTRICT-ADJ
           ELSE
              MOVE OPD-RESTRICT-ADJ       TO PD-RESTRICT-ADJ.
           IF OPD-DUAL-LOAN-ADJ = 2020202.02 OR 0202020.20 OR
                               -2020202.02 OR -0202020.20 OR
                                 5389762.88
              MOVE 0                      TO PD-DUAL-LOAN-ADJ
           ELSE
              MOVE OPD-DUAL-LOAN-ADJ      TO PD-DUAL-LOAN-ADJ.
           IF OPD-CAN-LOAN-MAX NOT NUMERIC
              MOVE 0                      TO PD-CAN-LOAN-MAX
           ELSE
           MOVE OPD-CAN-LOAN-MAX          TO PD-CAN-LOAN-MAX.
           IF OPD-PERDOWN NOT NUMERIC
              MOVE 0                      TO PD-PERDOWN
           ELSE
           MOVE OPD-PERDOWN               TO PD-PERDOWN.

           MOVE OPD-SELLPR-FG             TO PD-SELLPR-FG.
           MOVE OPD-DOWNPY-FG             TO PD-DOWNPY-FG.
           MOVE OPD-PERDOWN-FG            TO PD-PERDOWN-FG.
           MOVE OPD-SELL-DOWN-FG          TO PD-SELL-DOWN-FG.
           MOVE OPD-BALLOON-FG            TO PD-BALLOON-FG.
           MOVE OPD-BALLOON-LAST-FG       TO PD-BALLOON-LAST-FG.

           MOVE OPD-DLDISC-FG             TO PD-DLDISC-FG.
           MOVE OPD-DLPARVHELD-FG         TO PD-DLPARVHELD-FG.
           MOVE OPD-DLPARVPAID-FG         TO PD-DLPARVPAID-FG.
           MOVE OPD-ONE-MTH-NO-DAY-EXT-SW TO PD-ONE-MTH-NO-DAY-EXT-SW.
           MOVE OPD-ASSIGN-RN-ACCTNO      TO PD-ASSIGN-RN-ACCTNO.
           IF OPD-APR-FINAMT NOT NUMERIC
              MOVE 0                      TO PD-APR-FINAMT
           ELSE
           MOVE OPD-APR-FINAMT            TO PD-APR-FINAMT.
           MOVE OPD-DLCOMM-PP-CMSI-FG     TO PD-DLCOMM-PP-CMSI-FG.
           MOVE OPD-DLCOMM-O3-CMSI-FG     TO PD-DLCOMM-O3-CMSI-FG.

      * ^^^^^^  END OPD-NEW-FIELDS REDEFINES PD-FREE-SPACE.

      * VVVVVV ADITIONAL FIELDS MAPPED TO WK-REC
           IF OPD-POSTING-BR NOT NUMERIC
              MOVE 0                      TO PD-POSTING-BR
           ELSE
           MOVE OPD-POSTING-BR            TO PD-POSTING-BR.
           MOVE OPD-OTHBR-FG              TO PD-OTHBR-FG.
           IF OPD-APPROVAL-LIMIT NOT NUMERIC
              MOVE 0                      TO PD-APPROVAL-LIMIT
           ELSE
           MOVE OPD-APPROVAL-LIMIT        TO PD-APPROVAL-LIMIT.
           MOVE OPD-APPROVAL-USERID       TO PD-APPROVAL-USERID.
           IF OPD-MIN-CRED-SCORE NOT NUMERIC
              MOVE 0                      TO PD-MIN-CRED-SCORE
           ELSE
           MOVE OPD-MIN-CRED-SCORE        TO PD-MIN-CRED-SCORE.
           MOVE OPD-CRED-SCORE-USERID     TO PD-CRED-SCORE-USERID.
      * ^^^^^^ ADITIONAL FIELDS MAPPED TO WK-REC

      * PD2 KEY
           MOVE OPD2-ID                   TO PD2-ID.
           IF OPD2-BRANCH NOT NUMERIC
              MOVE 0                      TO PD2-BRANCH
           ELSE
           MOVE OPD2-BRANCH               TO PD2-BRANCH.
           MOVE OPD2-BWNAME               TO PD2-BWNAME.

      *  FIELDS FROM  NEW FIELDS REDEFINITION THAT HAVE OCCURS
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 20
              IF SUB <= 10
                 MOVE OPD-FEECD(SUB)        TO PD-FEECD(SUB)
                 MOVE OPD-INS-FG(SUB)       TO PD-INS-FG(SUB)
                 MOVE OPD-INS-TERM-SW(SUB)  TO PD-INS-TERM-SW(SUB)
                 MOVE OPD-COVERAGE-SW(SUB)  TO PD-COVERAGE-SW(SUB)
                 MOVE OPD-PREMIUM-SW(SUB)   TO PD-PREMIUM-SW(SUB)
              END-IF
              IF SUB <= 3
                 MOVE OPD-DLRVPRIN-FG(SUB) TO PD-DLRVPRIN-FG(SUB)
                 MOVE OPD-DLRVCHGS-FG(SUB) TO PD-DLRVCHGS-FG(SUB)
              END-IF
              IF SUB <= 2
                 MOVE OPD-FEECD-FG(SUB) TO PD-FEECD-FG(SUB)
              END-IF
           END-PERFORM.

       UPGRADE-FILE-PD-EXIT.
           EXIT.

      ******************************************************************
      *
      *    E X T R A C T - R O U T I N E
      *
      ******************************************************************
       EXTRACT-ROUTINE SECTION.

           MOVE MKTEMP-BUF                 TO MSEXCEL-PATH.
           MOVE "UP1534-MSEXCEL-"          TO MSEXCEL-PATH-PREFIX.
           MOVE PROCESS-ID-BUF             TO MSEXCEL-PATH-SUFFIX.
           INSPECT MSEXCEL-PATH-SUFFIX REPLACING ALL SPACES BY "9".
           MOVE ".TXT"                     TO MSEXCEL-PATH-EXT.
           CALL "C$TOLOWER" USING MSEXCEL-PATH-EXT, VALUE 04.
           PERFORM OPEN-MSEXCEL-FILE-OUTPUT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES TO SORT-FILENAME
                          SORT-FILEPATH
                          SORT-STATE
           MOVE ZEROES TO SORT-BRNO.

           PERFORM CLOSE-SORT-FILE.
           PERFORM OPEN-SORT-FILE.
           PERFORM START-SORT-FILE.

      *=================================================================
       EXTRACT-ROUTINE-READ-NEXT.

           PERFORM READ-SORT-FILE-NEXT.

           IF ( IO-BAD )
              GO TO EXTRACT-ROUTINE-END.

           MOVE SORT-TIME-BEG              TO EDF-SORT-TIME-BEG.
           MOVE SORT-TIME-END              TO EDF-SORT-TIME-END.
           MOVE SORT-TIME-ELAPSED          TO EDF-SORT-TIME-ELAPSED.

           MOVE SPACES                     TO MSEXCEL-REC.

           STRING SORT-FILENAME,         HEX-TAB,
                  SORT-FILEPATH,         HEX-TAB,
                  SORT-STATE,            HEX-TAB,
                  SORT-BRNO,             HEX-TAB,
                  SORT-RECS-READ,        HEX-TAB,
                  SORT-RECS-WRITE,       HEX-TAB,
                  SORT-RECS-SKIP,        HEX-TAB,
                  EDF-SORT-TIME-BEG,     HEX-TAB,
                  EDF-SORT-TIME-END,     HEX-TAB,
                  EDF-SORT-TIME-ELAPSED, HEX-CARRIAGE-RETURN
                  DELIMITED BY "  " INTO MSEXCEL-REC.

           PERFORM WRITE-MSEXCEL-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

           GO TO EXTRACT-ROUTINE-READ-NEXT.

      *=================================================================
       EXTRACT-ROUTINE-END.
           PERFORM CLOSE-MSEXCEL-FILE.
           PERFORM CLOSE-SORT-FILE.
           PERFORM REMOVE-SORT-FILE.

       EXTRACT-ROUTINE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P D A T E - S O R T - M O D U L E
      *
      *=================================================================
      * IN  : HOLD-SORT-KEY
      *       UP1534-RECORD-COUNTER-READ
      *       UP1534-RECORD-COUNTER-WRITE
      *       UP1534-RECORD-COUNTER-SKIP
      *       UP1534-TIME-BEG ***
      *       UP1534-TIME-END ***
      *       UP1534-TIME-ELAPSED ***
      *       *** = SET WITHIN UP1534-CREATE-FILE-TOTALS SECTION
      * OUT : NOTHING
      * DESC: UPDATE THE SORT-FILE.  THE SORT FILE IS USED TO 
      *       CREATE THE MSEXCEL-FILE WHICH CAN BE IMPORTED INTO
      *       MS EXCEL.
      *
      *       THIS CREATES A DETAIL RECORD FOR EACH FILE UPGRADED.
      *       IT ALSO CREATES/UPDATES A TOTAL RECORD FOR ALL
      *       FILES (GLOBAL, ALL MACHINES; LOCAL, ALL BRANCHES).
      *
      *       FOR TIMES, THE INPUT IS IN A STANDARD FORMAT (HH:MM:SS)
      *       BUT BEFORE UPDATED IN THE SORT-REC THEY NEED TO BE
      *       CONVERTED.  THEY NEED TO BE CONVERTED TO SECONDS THEN
      *       DIVIDED BY 86400 (TOTAL OF SECOND FOR 24 HOURS).
      *       FOR EXAMPLE, 12:34:56 IS 45296 SECONDS WHICH DIVIDED BY
      *       86400 SECONDS IS 0.5242592 WHICH WITHIN MS EXCEL YOU CAN
      *       FORMAT THE WHOLE COLUMN TO A CUSTOM FORMAT OF HH:MM:SS.
      ******************************************************************
       UPDATE-SORT-MODULE SECTION.

           CALL "C$TOUPPER" USING HOLD-SORT-STATE, VALUE 02.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ FILE DETAIL }
           MOVE SPACES TO SORT-REC.
           MOVE HOLD-SORT-FILENAME          TO SORT-FILENAME.
           MOVE HOLD-SORT-FILEPATH          TO SORT-FILEPATH.
           MOVE HOLD-SORT-STATE             TO SORT-STATE.
           MOVE HOLD-SORT-BRNO              TO SORT-BRNO.
           MOVE UP1534-RECORD-COUNTER-READ  TO SORT-RECS-READ.
           MOVE UP1534-RECORD-COUNTER-WRITE TO SORT-RECS-WRITE.
           MOVE UP1534-RECORD-COUNTER-SKIP  TO SORT-RECS-SKIP.

           MOVE UP1534-TIME-BEG             TO WSS-MSEXCEL-TIME-INPUT.
           PERFORM MISC-CONVERT-MSEXCEL-TIME.
           MOVE WSS-MSEXCEL-TIME-OUTPUT     TO SORT-TIME-BEG.

           MOVE UP1534-TIME-END             TO WSS-MSEXCEL-TIME-INPUT.
           PERFORM MISC-CONVERT-MSEXCEL-TIME.
           MOVE WSS-MSEXCEL-TIME-OUTPUT     TO SORT-TIME-END.

           MOVE UP1534-TIME-ELAPSED         TO WSS-MSEXCEL-TIME-INPUT.
           PERFORM MISC-CONVERT-MSEXCEL-TIME.
           MOVE WSS-MSEXCEL-TIME-OUTPUT     TO SORT-TIME-ELAPSED.

           PERFORM WRITE-SORT-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

      *- - - - - - - - - - - - - - - - - - - - - - - - - -{ FILE TOTAL }
           MOVE HOLD-SORT-FILENAME         TO SAVE-SORT-FILENAME.
           MOVE SPACES                     TO SAVE-SORT-FILEPATH.
           MOVE SPACES                     TO SAVE-SORT-STATE.
           MOVE 9999                       TO SAVE-SORT-BRNO.
           MOVE SAVE-SORT-KEY              TO SORT-KEY.
           PERFORM READ-SORT-FILE.

           IF ( IO-BAD )
              PERFORM UPDATE-SORT-FILE-WRITE.

           PERFORM UPDATE-SORT-REWRITE.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ BRANCH TOTAL }
           IF ( HOLD-SORT-BRNO = ZEROES )
              GO TO UPDATE-SORT-GRAND-TOTAL.

           MOVE "~ALL~"                    TO SAVE-SORT-FILENAME.
           MOVE "~BRANCH TOTAL~"           TO SAVE-SORT-FILEPATH.
           MOVE SPACES                     TO SAVE-SORT-STATE.
           MOVE HOLD-SORT-BRNO             TO SAVE-SORT-BRNO.
           MOVE SAVE-SORT-KEY              TO SORT-KEY.
           PERFORM READ-SORT-FILE.

           IF ( IO-BAD )
              PERFORM UPDATE-SORT-FILE-WRITE.

           PERFORM UPDATE-SORT-REWRITE.

      *- - - - - - - - - - - - - - - - - - - - - - - - -{ STATE TOTAL }
           IF ( HOLD-SORT-STATE = SPACES )
              GO TO UPDATE-SORT-GRAND-TOTAL.

           MOVE "~~ALL~~"                  TO SAVE-SORT-FILENAME.
           MOVE "~~STATE TOTAL~~"          TO SAVE-SORT-FILEPATH.
           MOVE HOLD-SORT-STATE            TO SAVE-SORT-STATE.
           MOVE ZEROES                     TO SAVE-SORT-BRNO.
           MOVE SAVE-SORT-KEY              TO SORT-KEY.
           PERFORM READ-SORT-FILE.

           IF ( IO-BAD )
              PERFORM UPDATE-SORT-FILE-WRITE.

           PERFORM UPDATE-SORT-REWRITE.

      *--------------------------------------------------{ GRAND TOTAL }
       UPDATE-SORT-GRAND-TOTAL.

           MOVE "~~~ALL~~~"                TO SAVE-SORT-FILENAME.
           MOVE "~~~GRAND TOTAL~~~"        TO SAVE-SORT-FILEPATH.
           MOVE "~~"                       TO SAVE-SORT-STATE.
           MOVE 9999                       TO SAVE-SORT-BRNO.
           MOVE SAVE-SORT-KEY              TO SORT-KEY.
           PERFORM READ-SORT-FILE.

           IF ( IO-BAD )
              PERFORM UPDATE-SORT-FILE-WRITE.

           PERFORM UPDATE-SORT-REWRITE.

      *=================================================================
       UPDATE-SORT-MODULE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P D A T E - S O R T - R E W R I T E
      *
      *=================================================================
      * IN  : SORT-REC
      *       UP1534-RECORD-COUNTER-READ
      *       UP1534-RECORD-COUNTER-WRITE
      *       UP1534-RECORD-COUNTER-SKIP
      *       UP1534-TIME-BEG
      *       UP1534-TIME-END
      *       UP1534-TIME-ELAPSED
      * OUT : SORT-REC
      * DESC: STANDARD ROUTINE TO ADD TO TOTALS THEN REWRITE EXISTING
      *       SORT-REC. 
      ******************************************************************
       UPDATE-SORT-REWRITE SECTION.

           COMPUTE SORT-RECS-READ = SORT-RECS-READ
                                  + UP1534-RECORD-COUNTER-READ.
           COMPUTE SORT-RECS-WRITE = SORT-RECS-WRITE
                                  + UP1534-RECORD-COUNTER-WRITE.
           COMPUTE SORT-RECS-SKIP = SORT-RECS-SKIP
                                  + UP1534-RECORD-COUNTER-SKIP.


      *KC  MOVE UP1534-TIME-BEG             TO WSS-MSEXCEL-TIME-INPUT.
      *KC  PERFORM MISC-CONVERT-MSEXCEL-TIME.
      *KC  COMPUTE SORT-TIME-BEG = SORT-TIME-BEG
      *KC                        + WSS-MSEXCEL-TIME-OUTPUT.

      *KC  MOVE UP1534-TIME-END             TO WSS-MSEXCEL-TIME-INPUT.
      *KC  PERFORM MISC-CONVERT-MSEXCEL-TIME.
      *KC  COMPUTE SORT-TIME-END = SORT-TIME-END
      *KC                        + WSS-MSEXCEL-TIME-OUTPUT.

           MOVE UP1534-TIME-ELAPSED         TO WSS-MSEXCEL-TIME-INPUT.
           PERFORM MISC-CONVERT-MSEXCEL-TIME.
           COMPUTE SORT-TIME-ELAPSED = SORT-TIME-ELAPSED
                                     + WSS-MSEXCEL-TIME-OUTPUT.

           PERFORM REWRITE-SORT-FILE.

      *=================================================================
       UPDATE-SORT-REWRITE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    U P D A T E - S O R T - W R I T E 
      *
      *=================================================================
      * IN  : SAVE-SORT-KEY
      * OUT : SORT-REC
      * DESC: STANDARD ROUTINE TO CREATE (WRITE) SORT-REC
      ******************************************************************
       UPDATE-SORT-FILE-WRITE SECTION.

           MOVE SPACES                     TO SORT-REC.
           MOVE SAVE-SORT-KEY              TO SORT-KEY.
           MOVE ZEROES                     TO SORT-RECS-READ
                                              SORT-RECS-WRITE
                                              SORT-RECS-SKIP
                                              SORT-TIME-BEG
                                              SORT-TIME-END
                                              SORT-TIME-ELAPSED.
           PERFORM WRITE-SORT-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

      *=================================================================
       UPDATE-SORT-FILE-WRIT-EXIT.
           EXIT.

      ******************************************************************
       FORM-RESET SECTION.
      ******************************************************************
     
           MOVE EXT-CONAME-SYSDATE         TO UP1534-SYSDATE.
           DISPLAY UP1534-SCREEN        UPON EXT-EOBUF-WINDOW-HANDLE.
           MOVE UP1534-FORM-FIELDS         TO WR-BUF.
           MOVE UP1534-FORM-LIST           TO WR-LIST.
           PERFORM CALL-WRFORM.
     
       FORM-RESET-EXIT.
           EXIT.
     
      ******************************************************************
       SETUP-LINK-INFO SECTION.
      ******************************************************************
     
           MOVE UP1534-HELP--FILE          TO HELP-LINK-FILE.
           MOVE UP1534-HELP--DIR           TO HELP-LINK-DIR.
     
       SETUP-LINK-INFO-EXIT.
           EXIT.

      ******************************************************************
       VDU-CONVERT-FIELD SECTION.
      ******************************************************************
     
           MOVE STAT---GOOD                TO STAT.
           MOVE VDU-FIELD-TO-CONVERT       TO VDU-ALP-FIELD.
     
           EVALUATE TRUE
              COPY "LIBUP/UP1534_EVA.CPY".
              WHEN OTHER       MOVE   "2A" TO STAT
           END-EVALUATE.
     
       VDU-CONVERT-FIELD-EXIT.
           EXIT.


      ******************************************************************
      *
      *    C O P Y - L I B R A R Y - S E C T I O N S
      *
      ******************************************************************
       COPY "LIBCL/TRACE.CPY".
       COPY "LIBGB/BRSECURE.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBGB/GPENV.CPY".
       COPY "LIBGB/GRSERCH.CPY".
       COPY "LIBGB/GRWORK.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBGB/TIMEIO.CPY".
       COPY "LIBLP/LPTBNO.CPY".             *> NEEDED FOR LIBLP/LPSP1IN
       COPY "LIBUP/UP1534.CPY".
      *COPY "LIBUP/UPGRADE_PD.CPY".         *> UPGRADE-FILE-PD SECTION.

      *===================================[ TARGET FILE CLEAR ROUTINES ]
       COPY "LIBGB/GBAUCL.CPY".
       COPY "LIBLP/LPPDCL.CPY".
       COPY "LIBLP/LPLSMCL.CPY".
       COPY "LIBLP/LPCDBCL.CPY".
       COPY "LIBLP/LPCDCL.CPY".
       COPY "LIBLP/LPCLCL.CPY".
       COPY "LIBSP/SPCPCL.CPY".
       COPY "LIBLP/LPEACL.CPY".
       COPY "LIBGL/GLALCL.CPY".
       COPY "LIBUP/UPAGLCL.CPY".
      *COPY "LIBSP/SPEPCL.CPY".
      *COPY "LIBSP/SPEWCL.CPY".
      *COPY "LIBLP/LPFDCLR.CPY".
       COPY "LIBGL/GLGICL.CPY".
       COPY "LIBLP/LPLCCL.CPY".
       COPY "LIBSP/SPIICL.CPY".
       COPY "LIBGB/GBRCCL.CPY".
       COPY "LIBUP/UPARCCL.CPY".
       COPY "LIBLP/LPSPCL.CPY".
       COPY "LIBLP/LPSSCL.CPY".
       COPY "LIBLP/LPSTCL.CPY".
       COPY "LIBLP/LPTZCL.CPY".
       COPY "LIBSP/SPWRCL.CPY".
       COPY "LIBUP/UPAWRCL.CPY".
       COPY "LIBLP/LPBWCL.CPY".
       COPY "LIBUP/UPABWCL.CPY".
       COPY "LIBLP/LPBXCL.CPY".
       COPY "LIBUP/UPABXCL.CPY".
       COPY "LIBLP/LPCACL.CPY".
       COPY "LIBUP/UPACACL.CPY".
       COPY "LIBLP/LPCICL.CPY".
       COPY "LIBUP/UPACICL.CPY".
       COPY "LIBLP/LPCKCL.CPY".
       COPY "LIBUP/UPACKCL.CPY".
       COPY "LIBLP/LPCXCL.CPY".
       COPY "LIBLP/LPDLCL.CPY".
      *COPY "LIBLP/LPDSCL.CPY".
       COPY "LIBLP/LPDTCL.CPY".
      *COPY "LIBLP/LPESCL.CPY".
       COPY "LIBGB/GBGBCL.CPY".
       COPY "LIBLP/LPLECL.CPY".
       COPY "LIBUP/UPALECL.CPY".
       COPY "LIBLP/LPLHCL.CPY".
       COPY "LIBUP/UPALHCL.CPY".
       COPY "LIBLP/LPLNCL.CPY".
       COPY "LIBUP/UPALNCL.CPY".
       COPY "LIBLP/LPLPCL.CPY".
       COPY "LIBLP/LPLXGCL.CPY".
       COPY "LIBLP/LPLXECL.CPY".
       COPY "LIBUP/UPALPCL.CPY".
       COPY "LIBLP/LPLSDCL.CPY".
       COPY "LIBLP/LPLSFCL.CPY".
       COPY "LIBLP/LPLSGCL.CPY".
       COPY "LIBLP/LPLSJCL.CPY".
       COPY "LIBLP/LPLSLCL.CPY".
       COPY "LIBLP/LPLSPCL.CPY".
       COPY "LIBLP/LPLSRCL.CPY".
       COPY "LIBLP/LPLSXCL.CPY".
      *COPY "LIBLP/LPLTACL.CPY".
      *COPY "LIBUP/UPALTACL.CPY".
       COPY "LIBLP/LPLTBCL.CPY".
       COPY "LIBUP/UPALTBCL.CPY".
       COPY "LIBLP/LPLTCCL.CPY".
       COPY "LIBUP/UPALTCCL.CPY".
       COPY "LIBLP/LPLTDCL.CPY".
       COPY "LIBUP/UPALTDCL.CPY".
       COPY "LIBLP/LPLTFCL.CPY".
       COPY "LIBUP/UPALTFCL.CPY".
       COPY "LIBLP/LPLTICL.CPY".
       COPY "LIBUP/UPALTICL.CPY".
       COPY "LIBLP/LPLTLCL.CPY".
       COPY "LIBUP/UPALTLCL.CPY".
       COPY "LIBLP/LPLTPCL.CPY".
       COPY "LIBUP/UPALTPCL.CPY".
       COPY "LIBLP/LPLXCL.CPY".
      *COPY "LIBUP/UPALXCL.CPY".
       COPY "LIBLP/LPTYCL.CPY".

      ******************************************************************
      *
      *     M I S C E L L A N E O U S - P A R A G R A P H S  
      *
      ******************************************************************
       MISC-ROUTINES SECTION.
       TEST-OLT-A-NON-NUMERIC.
           IF OLT-A-BIL-COV NOT NUMERIC
              MOVE 0               TO OLT-A-BIL-COV.
           IF OLT-A-PDL-COV NOT NUMERIC
              MOVE 0               TO OLT-A-PDL-COV.
           IF OLT-A-PIP-COV NOT NUMERIC
              MOVE 0               TO OLT-A-PIP-COV.
           IF OLT-A-UMB-COV NOT NUMERIC
              MOVE 0               TO OLT-A-UMB-COV.
           IF OLT-A-COL-COV NOT NUMERIC
              MOVE 0               TO OLT-A-COL-COV.
           IF OLT-A-COM-COV NOT NUMERIC
              MOVE 0               TO OLT-A-COM-COV.
       TEST-OLT-B-NON-NUMERIC.
           IF OLT-B-REAFF-BALANCE NOT NUMERIC
              MOVE 0 TO OLT-B-REAFF-BALANCE.
           IF OLT-B-REAFF-PAYAMT NOT NUMERIC
              MOVE 0 TO OLT-B-REAFF-PAYAMT.
           IF OLT-B-REAFF-NO-PAYS NOT NUMERIC
              MOVE 0 TO OLT-B-REAFF-NO-PAYS.
           IF OLT-B-INTRATE NOT NUMERIC
              MOVE 0 TO OLT-B-INTRATE.
           IF OLT-B-GROSS-BAL NOT NUMERIC
              MOVE 0 TO OLT-B-GROSS-BAL.
       CONVERT-YYYMMDD-TO-MMDDYY.
           MOVE DATE-YYYMMDD-MM  TO DATE-MMDDYY-MM.
           MOVE DATE-YYYMMDD-DD  TO DATE-MMDDYY-DD.
           MOVE DATE-YYYMMDD-YYY TO DATE-MMDDYY-YY.
       CONVERT-YYYMM-TO-MMDDYY.
           MOVE DATE-YYYMM-MM  TO DATE-MMDDYY-MM.
           MOVE ZEROES         TO DATE-MMDDYY-DD.
           MOVE DATE-YYYMM-YYY TO DATE-MMDDYY-YY.
       COPY "LIBGB/GETPR.CPY".
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/DACCESS.CPY".
       COPY "LIBGB/GETENV.CPY".
       COPY "LIBGB/MKTEMP.CPY".
       COPY "LIBGB/RMFILE.CPY".
       COPY "LIBGB/SYSTEM.CPY".
       TEST-OLT-C-NON-NUMERIC.
           IF OLT-VIN-CHG-DATE NOT NUMERIC
              MOVE 0 TO OLT-VIN-CHG-DATE.
           IF OLT-MILEAGE NOT NUMERIC OR
               (OLT-MILEAGE = 2020202 OR 0202020)
              MOVE 0 TO OLT-MILEAGE.
           IF OLT-VALUE NOT NUMERIC OR (OLT-VALUE = 20202.02)
              MOVE 0 TO OLT-VALUE.
           IF OLT-SELLPR NOT NUMERIC OR (OLT-SELLPR = 20202.02)
              MOVE 0 TO OLT-SELLPR.
           IF OLT-MISC-AMT NOT NUMERIC OR (OLT-MISC-AMT = 20202.02)
              MOVE 0 TO OLT-MISC-AMT.
       SET-LTB-CHAPTER.
      * CLEANSE LTB-CHAPTER 161 11307
           IF OLT-B-CHAPTER-X = SPACES
              MOVE 0             TO LTB-CHAPTER ALTB-CHAPTER
           ELSE
              MOVE OLT-B-CHAPTER TO LTB-CHAPTER ALTB-CHAPTER.

       BUILD-LXA-REC.
           MOVE "A"       TO LXA-CODE.
           MOVE OLXA-SRCD TO LXA-SRCD.
      * 4 THRU 9 ARE CLEARED
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 3
              MOVE OLXA-START-PMT(SUB)  TO LXA-START-PMT(SUB)
              MOVE OLXA-END-PMT(SUB)    TO LXA-END-PMT(SUB)
              MOVE OLXA-NET-CHANGE(SUB) TO LXA-NET-CHANGE(SUB)
           END-PERFORM.

           MOVE OLXA-LN-INSCOMP  TO LXA-LN-INSCOMP.
           MOVE OLXA-LN-INSOURS  TO LXA-LN-INSOURS.
           MOVE OLXA-LN-INSEFF   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LXA-LN-INSEFF-DATE.
           MOVE OLXA-LN-INSEXP   TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD    TO LXA-LN-INSEXP-DATE.
           MOVE OLXA-LN-INSPREM  TO LXA-LN-INSPREM.
           MOVE OLXA-LN-INSCOVR  TO LXA-LN-INSCOVR.
           MOVE OLXA-LN-INSCOMM  TO LXA-LN-INSCOMM.
           MOVE OLXA-LN-INS-REBATE TO LXA-LN-INS-REBATE.
           MOVE OLXA-LN-INSCODES TO LXA-LN-INSCODES.

      *=================================================================
       MERGE-LXA-REC.

           MOVE "A"       TO LXA-CODE.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
                 COMPUTE SUB2 = SUB + 3
                 MOVE OLX2-START-PMT (SUB) TO LXA-START-PMT (SUB2)
                 MOVE OLX2-END-PMT   (SUB) TO LXA-END-PMT   (SUB2)
                 MOVE OLX2-NET-CHANGE(SUB) TO LXA-NET-CHANGE(SUB2)
           END-PERFORM.

      *=================================================================
       BUILD-LXM-REC.

           MOVE "M"                TO LXM-CODE.
           MOVE OLXM-MIP-CLPAID    TO LXM-MIP-CLPAID.
           MOVE OLXM-MIP-CLPDTH    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LXM-MIP-CLPDTH-DATE.
           MOVE OLXM-MIP-AHPAID    TO LXM-MIP-AHPAID.
           MOVE OLXM-MIP-AHPDTH    TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           PERFORM TEST-INVALID-DATE.
           MOVE DATE-YYYYMMDD      TO LXM-MIP-AHPDTH-DATE.
                                  
      *=================================================================
       BUILD-LXZ-REC.

           MOVE "Z"               TO LXZ-CODE.
           MOVE OLXZ-POST-REGPY   TO LXZ-POST-REGPY.
           MOVE OLXZ-POST-EXTRA-PRIN TO LXZ-POST-EXTRA-PRIN.
           MOVE OLXZ-POST-OTH     TO LXZ-POST-OTH.
           MOVE OLXZ-POST-LCHG    TO LXZ-POST-LCHG.
           MOVE OLXZ-PDUE-APINT   TO LXZ-PDUE-APINT.
           MOVE OLXZ-PDUE-APPRIN  TO LXZ-PDUE-APPRIN.
           MOVE OLXZ-CUR-APINT    TO LXZ-CUR-APINT.
           MOVE OLXZ-CUR-APPRIN   TO LXZ-CUR-APPRIN.

      *=================================================================
      * A15 WE HAD LXT-EARN ONLY FOR BOTH "P" AND "T". OCCURS 12
      *
      * A30 WE HAD LXT-EARN ONLY FOR BOTH "P" AND "T". OCCURS 20
      *  T   1 - 10  ANTIC          P   1 - 10 ACCRERN
      *  T  11 - 20 ANTIC-ADJ       P  11 - 20 UFERN(UPFRONT)
      *
      *LXP-EARN CHANGED FROM OCCURS 12 TO OCCURS 20 BUT KM DIDNT WANT
      *CHANGED IN A30, WORLD DOESNT USE SO CORRECTING IN A32. 7-10 AND
      *17 -20 SHOULD BE 0, 7 SHOULD MOVE TO 11, 8 TO 12, ETC
      *=================================================================
       BUILD-LXP-REC.

           MOVE "P"       TO LXP-CODE.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 20
              IF ( SUB < 7 )
                MOVE OLXT-EARN(SUB)     TO LXP-EARN(SUB)
              ELSE
                 IF ( SUB < 13 )
                    MOVE OLXT-EARN(SUB) TO LXP-EARN(SUB + 4)
                 ELSE
                    MOVE 0              TO LXP-EARN(SUB)
                 END-IF
              END-IF
           END-PERFORM.

      *=================================================================
      * A15 WE HAD LXT-EARN ONLY FOR BOTH "P" AND "T". OCCURS 12
      *
      * A30 WE HAD LXT-EARN ONLY FOR BOTH "P" AND "T". OCCURS 20
      *  T   1 - 10  ANTIC          P   1 - 10 ACCRERN
      *  T  11 - 20 ANTIC-ADJ       P  11 - 20 UFERN(UPFRONT)
      *LXT-EARN CHANGED FROM OCCURS 12 TO OCCURS 20 BUT KM DIDNT WANT
      *CHANGED IN A30, WORLD DOESNT USE SO CORRECTING IN A32. 7-10 AND
      *17 -20 SHOULD BE 0, 7 SHOULD MOVE TO 11, 8 TO 12, ETC
      *=================================================================
       BUILD-LXT-REC.

           MOVE "T"       TO LXT-CODE.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 20
              IF ( SUB < 7 )
                MOVE OLXT-EARN(SUB)  TO LXT-EARN(SUB)
              ELSE
                 IF ( SUB < 13 )
                    MOVE OLXT-EARN(SUB) TO LXT-EARN(SUB + 4)
                 ELSE
                    MOVE 0              TO LXT-EARN(SUB)
                 END-IF
              END-IF
           END-PERFORM.

      *=================================================================
       BUILD-LXX-REC.

           MOVE "X"       TO LXX-CODE.
           MOVE OLXX-INS-TAX-COUNTY-CD TO LXX-INS-TAX-COUNTY-CD.
           MOVE OLXX-INS-TAX-CITY-CD   TO LXX-INS-TAX-CITY-CD.

      *=================================================================
       BUILD-LXR-REC.

           MOVE "R"          TO LXR-CODE.
           MOVE OLXR-REB-AMT TO LXR-REB-AMT.

      *=================================================================
       INVALID-FILE-PATH-MESSAGE.
           MOVE MESSAGE-INVALID-FILE-PATH TO MESS.
           PERFORM SEND-MESS.

      *-----------------------------------------------------------------
       INVALID-YN-MESSAGE.
           MOVE MESSAGE-INVALID-YN TO MESS.
           PERFORM SEND-MESS.

      *-----------------------------------------------------------------
       SEND-STARTING-TIME.
           PERFORM GET-TIME.
           MOVE "[ "      TO STARTING-TIME-RIGHT.
           MOVE TIME-EDIT TO STARTING-TIME.
           MOVE " ]"      TO STARTING-TIME-LEFT.

           IF ( EXT-ROUTE-BUF = "00" )
              MOVE STARTING-TIME-BUF       TO WR-BUF
              MOVE STARTING-TIME-LIST      TO WR-LIST
              PERFORM CALL-WRFORM.

      *-----------------------------------------------------------------
       SEND-LEGEND.
           MOVE LEGEND                     TO WR-BUF.
           MOVE LEGEND-LIST                TO WR-LIST.
           PERFORM CALL-WRFORM.

      *-----------------------------------------------------------------
       SEND-FIL.
           MOVE "FIL"                      TO GETENV-BUF.
           PERFORM GETENV-CALL.

           MOVE SPACES                     TO UP1534-FILE-PATH.
           STRING "/", GETENV-BUF
                  DELIMITED BY "  "      INTO UP1534-FILE-PATH.
           MOVE UP1534-FILE-PATH-MACHINE   TO CURRENT-MACHINE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    CHECK TO SEE IF THE SOURCE & TARGET PATHS ARE SET FROM BATCH.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SOURCE-PATH = SPACES )
              MOVE UP1534-FILE-PATH        TO SOURCE-PATH
           ELSE
              MOVE SOURCE-PATH             TO DIR-ACCESS-BUF
              PERFORM DIR-ACCESS-CALL
              IF ( STAT-BAD )
                 MOVE UP1534-FILE-PATH     TO SOURCE-PATH.
           IF ( TARGET-PATH = SPACES )
              MOVE UP1534-FILE-PATH        TO TARGET-PATH
           ELSE
              MOVE TARGET-PATH             TO DIR-ACCESS-BUF
              PERFORM DIR-ACCESS-CALL
              IF ( STAT-BAD )
                 MOVE UP1534-FILE-PATH     TO TARGET-PATH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE "CURRENT FIL: "            TO FIL-PROMPT.
           MOVE UP1534-FILE-PATH           TO FIL-INFO.

           MOVE FIL-BUF                    TO WR-BUF.
           MOVE FIL-LIST                   TO WR-LIST.
           PERFORM CALL-WRFORM.

      *-----------------------------------------------------------------
      * IN  : WSS-MSEXCEL-TIME-INPUT
      * OUT : WSS-MSEXCEL-TIME-OUTPUT
      * DESC: CONVERT INPUT TIME IN STANDARD FORMAT (HH:MM:SS) TO 
      *       TO MS EXCEL DATE FORMAT. IT NEEDS TO BE CONVERTED TO
      *       SECONDS THEN DIVIDED BY 86400 (TOTAL OF SECOND FOR
      *       24 HOURS).  FOR EXAMPLE, 12:34:56 IS 45296 SECONDS WHICH
      *       DIVIDED BY 86400 SECONDS IS 0.5242592 WHICH WITHIN
      *       MS EXCEL YOU CAN FORMAT THE WHOLE COLUMN TO A
      *       CUSTOM FORMAT OF HH:MM:SS.
      *-----------------------------------------------------------------
       MISC-CONVERT-MSEXCEL-TIME.

           COMPUTE WSS-MSEXCEL-TIME-OUTPUT =
                     (( WSS-MSEXCEL-TIME-INPUT-HH * 3600 )
                   +  ( WSS-MSEXCEL-TIME-INPUT-MM * 60   )
                   +    WSS-MSEXCEL-TIME-INPUT-SS         )
                   / 86400.

      *-----------------------------------------------------------------
      * IN  : SAVE-A15-FILE-PATH-OLD
      *       SAVE-A15-FILE-PATH-NEW
      * OUT : NOTHING
      * DESC: MOVE A15 FILE (OLD) TO AN ANOTHER FILE (NEW; ADD "O" TO
      *       FRONT; OXXFILE) FOR A VARIETY FILE EXTENSION (.D01, .D02,
      *       .VIX, .V01).
      *       DO NOT NEED TO CHECK STAT ON THE MOVE (SYSTEM-CALL) SINCE
      *       THAT FILE EXTENSION MAY NOT EXIST.
      *-----------------------------------------------------------------
       MISC-MV15-OLD-TO-NEW.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".D01"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".D02"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".VIX"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".V01"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".V02"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

      *-----------------------------------------------------------------
      * IN  : SAVE-A15-FILE-PATH-OLD
      *       SAVE-A15-FILE-PATH-NEW
      * OUT : NOTHING
      * DESC: MOVE NEW A15 FILE ("O" AT THE FRONT; OXXFILE) BACK TO
      *       ORIGINAL FILE (OLD; NO "O" AT FRONT; XXFILE) FOR A VARIETY
      *       FILE EXTENSION (.D01, .D02, .VIX, .V01).
      *       DO NOT NEED TO CHECK STAT ON THE MOVE (SYSTEM-CALL) SINCE
      *       THAT FILE EXTENSION MAY NOT EXIST.
      *-----------------------------------------------------------------
       MISC-MV15-NEW-TO-OLD.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".D01"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".D02"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".VIX"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".V01"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

           MOVE MV-CMD                     TO SYSTEM-BUF.
           MOVE ".V02"                     TO SAVE-A15-FILE-EXT.
           CALL "C$TOLOWER" USING SAVE-A15-FILE-EXT, VALUE 4.
           STRING SAVE-A15-FILE-PATH-NEW, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE1.
           STRING SAVE-A15-FILE-PATH-OLD, SAVE-A15-FILE-EXT
                        DELIMITED BY " " INTO MV-FILE2.
           PERFORM SYSTEM-CALL.

      *=================================================================
      *  IN  : WSS-PROGRAM-DIR-A15
      *        WSS-PROGRAM-NAME-A15
      *  OUT : WSS-PROGRAM-NAME-A30
      *  DESC: CONVERT A15 XX-PROGRAM FIELDS TO A30 XX-PROGRAM FIELDS
      *        IF NEEDED; NO LONGER USING DIRECTORIES IN /USR/A30/CO
      *        WHICH MEANS CANNOT HAVE DUPLICATE PROGRAM NAMES THUS
      *        THIS WILL SET THOSE TO THEIR NEW A30 PROGRAM NAMES.
      *=================================================================
       MISC-VERIFY-PROGRAM-NAME.

           MOVE WSS-PROGRAM-NAME-A15       TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "ATMAIN" )
              MOVE "APATMN"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CKLIST" )
              MOVE "APCKLS"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CKMAIN" )
              MOVE "APCKMN"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CKSCAN" )
              MOVE "APCKSC"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CLRCHK" )
              MOVE "APCLCK"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "FX"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "PAYSCH" )
              MOVE "PAYSC2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CHCRED" )
              MOVE "CHCRE2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CHLEGL" )
              MOVE "CHLEG2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "FOLLOW" )
              MOVE "FOLRPT"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "NP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "TRSCAN" )
              MOVE "TRSCN2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "NP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "TRCMAN" )
              MOVE "TRCMN2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "MN"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "TRMNMU" )
              MOVE "MNTRMU"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "NP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "LEDGER" )
              MOVE "NPLEDG"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "WI"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "GLSCAN" )
              MOVE "GLSCN2"                TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "BYINQ3" )
              MOVE "BYINQ"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "DSINQ3" )
              MOVE "DSINQ"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "MN"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "FDDBMN" )
              MOVE "FDBMAN"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "MN"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "FDDBLS" )
              MOVE "FDBLST"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "SP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "1099MI" )
              MOVE "MI1099"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CKPR01" )
              MOVE "CKPRNT"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "AP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "CKPR03" )
              MOVE "CKPRNT"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "1ONPI" )
              MOVE "DISBI0"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "2ONPI" )
              MOVE "CHCKI0"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "3ONPI" )
              MOVE "VOIDI0"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "4ONPI" )
              MOVE "BNKDI0"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "5ONPI" )
              MOVE "BNKWI0"                 TO WSS-PROGRAM-NAME-A30.

           IF ( WSS-PROGRAM-DIR-A15  = "LP"     ) AND
              ( WSS-PROGRAM-NAME-A15 = "6ONPI" )
              MOVE "BCHKI0"                 TO WSS-PROGRAM-NAME-A30.

      *=================================================================
       MISC-TRACE-END-PROGRAM.

           MOVE ZEROES TO EXT-TCLP-TRACE-LEVEL.
           MOVE SPACES TO EXT-TCLP-TRACE-FORM-PATH
                          EXT-TCLP-TRACE-MESS.

           MOVE "N"    TO EXT-TCLP-TRACE-SKIP-YN.   *> LOG EVENT
           MOVE "N"    TO EXT-TCLP-TRACE.           *> DISABLE TRACE

      *-----------------------------------------------------------------
       MISC-TRACE-FILE-START.

           STRING "+ FILE: ", UP1534-CURRENT-FILE, "[", BR-NO, "]"
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

      *-----------------------------------------------------------------
      *    FORCE UPGRADE PROGRAM TO USE TRACE LOGIC; LOG SETTINGS
      *-----------------------------------------------------------------
       MISC-TRACE-INITIALIZATION.

           MOVE ZEROES TO EXT-TCLP-TRACE-LEVEL.
           MOVE SPACES TO EXT-TCLP-TRACE-FORM-PATH
                          EXT-TCLP-TRACE-MESS.

           MOVE "N"    TO EXT-TCLP-TRACE-SKIP-YN.   *> LOG EVENT
           MOVE "Y"    TO EXT-TCLP-TRACE.           *> ENABLE NON-BRANCH

           MOVE ALL "="                    TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           ACCEPT DATE-YYYYMMDD FROM CENTURY-DATE.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-MMSDDSYY.

           STRING "OTIS SESSION STARTED /", FORM-REL,
                  " | ", DATE-MMSDDSYY
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "DATABASE NAME = ", EXT-ACUSQL-DB-NAME
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "SQL SERVER    = ", EXT-ACUSQL-SERVER-NAME
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "BATCH CODE    = ", EXT-EOBUF-PCODE
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE EXT-EOBUF-DATE1            TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-MMSDDSYY.
           STRING "BEG DATE      = ", DATE-MMSDDSYY
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE EXT-EOBUF-DATE2            TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-MMSDDSYY.
           STRING "END DATE      = ", DATE-MMSDDSYY
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "SOURCE PATH   = ", SOURCE-PATH
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "TARGET PATH   = ", TARGET-PATH
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "BEG BRANCH    = ", BEG-BRANCH
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "END BRANCH    = ", END-BRANCH
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "GROUP FLAG    = ", GROUP-FLAG
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING "ENT GROUP     = ", ENT-GROUP
                  DELIMITED BY SIZE      INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME              TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

      ******************************************************************
      *
      *    I O - R O U T I N E S
      *
      ******************************************************************
       IO-ROUTINE SECTION.
      *COPY "LIBGB/CONNECT_SQL.CPY".  *> HARDCODED FOR ERROR TAG FILE%%%
      * COPYMEMBER: LIBGB/CONNECT_SQL.CPY
      ******************************************************************
      *
      * IDENTIFICATION: LIBGB/CONNECT_SQL
      * DESCRIPTION   : SQL SERVER CONNECTION ROUTINES
      *
      * NEEDED COPYS  : LIBGB/FILEWK
      *                 LIBGB/DECLARE   -OR-
      *                 LIBGB/DECLAREOD -OR-
      *                 LIBGB/DECLRP
      *
      *=================================================================
      * REV:
      * JKC 2021-0115 ***NEW***
      * JKC 2021-0223 CLEANING UP SOME OF THE CODE.
      * JKC 2021-0324 ADDED SQL-GET-DATE & SQL-SET-DATE.
      * JKC 2021-0430 CHANGES MADE WHILE WORKING ON DECLARE ROUTINES.
      * JKC 2021-0511 CHANGED NAME FROM SQLCONNECT TO CONNECT_SQL
      * JKC 2021-0714 ADDED DISPLAY OF PROGRAM NAME IN SQL-ERROR;
      *               FORM-PATHNAME(16:6)
      * JKC 2020-0726 ADDED EXT-SQL-CONNECT-STAT FOR CHECKING IF 
      *               CONNECTION TO SQL SERVER HAS ALREADY BEEN MADE;
      *               USED TO ONLY CONNECT ONE-TIME INSTEAD OF MULTIPLE
      *               TIMES IN EVERY PROGRAM.
      *
      * JKC 2021-0816 CHANGED SQL-GET-DATE AND SQL-SET-DATE TO CHECK
      *               FOR ZERO DATES & '1900-01-01'.
      *
      * JKC 2021-0817 UPDATED FROM XPC/IOCONN.PRE FOR LATEST CHANGES.
      * JKC 2021-0927 CHANGED SQL-ERROR SECTION TO ALWAYS DISPLAY
      *               E-KEYX NO MATTER WHAT IO TYPE (E-MSG4).
      *
      * JKC 2022-0209 MADE CHANGE TO SET SQL CONNECTION FIELDS AT THE
      *               START OF THE 'SQL-CONNECT' PARAGRAPH FOR POTENTIAL
      *               FUTURE USE OF HAVING MULTIPLE CONNECTIONS.
      *               DID SOME CLEANUP OF UNNEED CODE THAT WAS USED
      *               FOR A TWO-STEP COMPILE PROCESS; WE USE A ONE-STEP
      *               COMPILE GOING FORWARD AT THIS POINT.
      *
      * JKC 2022-0214 MADE CHANGE TO SQL-DISCONNECT TO 
      *               `MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT`
      *               DUE TO ISSUE FOUND WITH CLOSING CURSORS VIA
      *               SQL-ERROR;
      *               IN SQL-IO-VALIDATION ROUTINE ADDED A CHECK TO SEE
      *               IF THE SQL CONNECTION (EXT-ACUSQL-CONNECT-STAT)
      *               IS OPEN (GOOD) THEN `PERFORM CLOSE-FILES`;
      *               NEED TO ONLY CLOSE FILES/TABLES WHEN THERE IS
      *               AN SQL CONNECTION OTHERWISE YOU CAN GET INTO
      *               AN INIFITE LOOP DUE TO THE SQL-DISCONNECT IN
      *               SQL-ERROR WHICH THEN YOU CANNOT CLOSE CURSORS
      *               IF THE CONNECTION HAS BEEN CLOSED.
      *
      * JKC 2022-0622 MOVED THIS FROM LIBIO TO LIBGB; LIBIO WAS REMOVED
      * BAH 2022.0627 RENAMED EXT-ACUSQL-ODBC-NAME TO EXT-ACUSQL-DSN-NAME

      * JKC 2022-0804 REMOVED `SQL-CONNECT-VERIFY' PARAGRAPH; REPLACED
      *          IT WITH `SELECT 1 INTO :QGP-KEY`.
      *
      * JKC 2022-0805 CHANGED :QGP-KEY TO BE :SQL-CONNECT-VERIFY.
      *
      ******************************************************************
      *
      *    S Q L - C O N N E C T
      *
      *=================================================================
      * IN  : EXT-ACUSQL-CONNECT-WORKERS
      * OUT : SQL-CONNECT-WORKERS
      *       IO-FG    [0 = GOOD; 9 = BAD]
      * DESC: MAKE CONNECTION TO THE SQL SERVER:
      *       1. CHECK CONNECTION STATUS
      *          A. BAD THEN MAKE CONNECTION
      *          B. GOOD THEN CONTINUE
      *       2. VERIFY CONNECTION
      *          A. BAD THEN CONTINUE
      *          B. GOOD THEN EXIT PARAGRAPH
      *       3. MAKE CONNECTION
      *       4. VERIFY CONNECTIONSTATUS
      *          A. BAD THEN ERROR PROCEDURE
      *          B. GOOD THEN EXIT PARAGRAPH
      ******************************************************************
       SQL-CONNECT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEED TO SET THE SQL CONNECTION FIELDS RIGHT AWAY;
      *    IF WE MAKE MULTIPLE CONNNECTIONS FOR EACH/SEPERATE TABLES
      *    THEN THESE SQL CONNECTION FIELDS NEED TO BE SET SO THAT
      *    THEY CAN BE USED FOR EACH IO ROUTINE NEEDED;
      *    SQL CONNECTION FIELDS WERE ONLY BEING POPULATED WHEN
      *    GOING INTO 'SQL-CONNECT-MAKE' WHICH MAY NOT BE DONE IF
      *    THE CONNECT STAT WAS GOOD.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE EXT-ACUSQL-DSN-NAME  TO SQL-CONNECT-SERVER.
           MOVE EXT-ACUSQL-LOGIN     TO SQL-CONNECT-USERID.
           MOVE EXT-ACUSQL-PSWD      TO SQL-CONNECT-PSWD.
      *??? MOVE "WAAZA34SQL-DEV'     TO SQL-CONNECT-SERVER
      *??? MOVE "DB_OWNER"    	     TO SQL-CONNECT-OWNER
      *??? MOVE "OTIS"               TO SQL-CONNECT-DATABASE

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( EXT-ACUSQL-CONNECT-STAT-BAD )
              PERFORM SQL-CONNECT-MAKE
              IF ( SQLCODE < 0 )
                 PERFORM SQL-CONNECT-ERROR
                 EXIT PARAGRAPH.

           EXEC SQL              *> VERIFY SQL SERVER CONNECTION EXISTS
                SELECT 1 INTO :SQL-CONNECT-VERIFY
           END-EXEC.

           IF ( SQLCODE = 0 )
              PERFORM SQL-CONNECT-WHENEVER
              MOVE STAT---GOOD TO EXT-ACUSQL-CONNECT-STAT
              EXIT PARAGRAPH.

           PERFORM SQL-CONNECT-MAKE.

           IF ( SQLCODE < 0 )
              PERFORM SQL-CONNECT-ERROR
              MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT
              EXIT PARAGRAPH.

           PERFORM SQL-CONNECT-WHENEVER.
           MOVE STAT---GOOD TO EXT-ACUSQL-CONNECT-STAT.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - E R R O R
      *
      *=================================================================
      * IN  : SQLCA WORKERS
      * OUT : NONE
      * DESC: PROCESS ERROR FOR SQL SERVER CONNECTION
      ******************************************************************
       SQL-CONNECT-ERROR.

           MOVE "CONNECTION"            TO E-MSG.
           MOVE "SQL SERVER CONNECTION" TO E-FILE.
           PERFORM SQL-ERROR.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - M A K E
      *
      *=================================================================
      * IN  : SQL-CONNECT-WORKERS
      * OUT : SQLCA WORKERS
      * DESC: MAKE CONNECTION TO THE SQL SERVER
      ******************************************************************
       SQL-CONNECT-MAKE.

           EXEC SQL
                CONNECT TO :SQL-CONNECT-SERVER AS C1
                      USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - C O N N E C T - W H E N E V E R
      *
      *=================================================================
      * IN  : NONE
      * OUT : NONE
      * DESC: DECLARE PROCEDURE FOR SQL ERRORS WHEN THEY OCCUR
      *       GPFILE SINCE IT SHOULD BE QUICK WITH ONLY HAVING ONE ROW.
      * NOTE: WHENEVER SQLERROR DOES NOT CATCH ALL ERRORS (LIKE A
      *          CASTING ERROR) SO WE STILL DO THE SQL-IO-VALIDATION
      *          AFTER EACH EXEC SQL IN ALL IO COPY MEMBERS!!!
      ******************************************************************
       SQL-CONNECT-WHENEVER.

           EXEC SQL WHENEVER SQLERROR
              PERFORM SQL-IO-VALIDATION
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - D I S C O N N E C T
      *
      *=================================================================
      * IN  : NOTHING
      * OUT : SQL-CONNECT-WORKERS
      * DESC: MAKE CONNECTION TO THE SQL SERVER
      *=================================================================
      * ***NOTE*** NEED TO HAVE SQL-DISCONNECT IN LIBGB/CONNECT_SQL AND
      *            LIBGB/DISCONNECT_SQL
      ******************************************************************
       SQL-DISCONNECT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEED TO HAVE WHENEVER SQLERROR NOT CALL TO SQL-IO-VALIDATION
      *    FOR CLOSING THE CONNECTION. THE USE IN LIBGB/DISCONNECT_SQL
      *    WILL NOT HAVE SQL-IO-VALIDATION SO NEED TO SHUT IT OFF
      *    (CONTINUE) AND DISCONNECT THEN PUT BACK.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           
           EXEC SQL WHENEVER SQLERROR CONTINUE END-EXEC.

           EXEC SQL COMMIT END-EXEC.
           EXEC SQL DISCONNECT ALL END-EXEC.

      *KC  IF ( SQLCODE < 0 )     *> NO NEED TO CHECK SINCE EXITING
      *KC     PERFORM SQL-ERROR.  *> APPLICATION VIA `STOP RUN`

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    NEED THE FOLLOWING FOR LIBGB/CONNECT_SQL
      *    NEED TO COMMENT OUT THE FOLLOWING FOR LIBGB/DISCONNECT_SQL
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SPACES     TO SQL-CONNECT-WORKERS.
           MOVE STAT---BAD TO EXT-ACUSQL-CONNECT-STAT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    DECLARE PROCEDURE FOR SQL ERRORS WHEN THEY OCCUR
      *    NOTE: WHENEVER SQLERROR DOES NOT CATCH ALL ERRORS (LIKE A
      *          CASTING ERROR) SO WE STILL DO THE SQL-IO-VALIDATION
      *          AFTER EACH EXEC SQL IN ALL IO COPY MEMBERS!!!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           
           EXEC SQL WHENEVER SQLERROR
              PERFORM SQL-IO-VALIDATION
           END-EXEC.

      ******************************************************************
      *
      *    S Q L - D E B U G
      *
      *=================================================================
      * IN  : SQLCA
      * OUT : NOTHING
      * DESC: DISPLAY MESSAGE BOX OF SQLCA SETTINGS FOR DEBUG
      ******************************************************************
       SQL-DEBUG.

           MOVE SPACES                TO SQL-DEBUG-BUF
           MOVE "CODE : "             TO SQL-DEBUG-01-SQLCODEX
           MOVE SQLCODE               TO SQL-DEBUG-01-SQLCODE
           MOVE "CABC : "             TO SQL-DEBUG-01-SQLCABCX
           MOVE SQLCABC               TO SQL-DEBUG-01-SQLCABC
           MOVE "CAID: "              TO SQL-DEBUG-01-SQLCAIDX
           MOVE SQLCAID               TO SQL-DEBUG-01-SQLCAID
           MOVE "STATE: "             TO SQL-DEBUG-02-SQLSTATEX
           MOVE SQLSTATE              TO SQL-DEBUG-02-SQLSTATE
           MOVE "ERRML: "             TO SQL-DEBUG-02-SQLERRMLX
           MOVE SQLERRML              TO SQL-DEBUG-02-SQLERRML
           MOVE "ERRPL: "             TO SQL-DEBUG-02-SQLERRPLX
           MOVE SQLERRPL              TO SQL-DEBUG-02-SQLERRPL
           MOVE "WARN: "              TO SQL-DEBUG-02-SQLWARNX
           MOVE SQLWARN0              TO SQL-DEBUG-02-SQLWARN0
           MOVE SQLWARN1              TO SQL-DEBUG-02-SQLWARN1
           MOVE SQLWARN2              TO SQL-DEBUG-02-SQLWARN2
           MOVE SQLWARN3              TO SQL-DEBUG-02-SQLWARN3
           MOVE SQLWARN4              TO SQL-DEBUG-02-SQLWARN4
           MOVE SQLWARN5              TO SQL-DEBUG-02-SQLWARN5
           MOVE SQLWARN6              TO SQL-DEBUG-02-SQLWARN6
           MOVE SQLWARN7              TO SQL-DEBUG-02-SQLWARN7
           MOVE SQLWARN8              TO SQL-DEBUG-02-SQLWARN8
           MOVE SQLWARN9              TO SQL-DEBUG-02-SQLWARN9
           MOVE SQLWARNA              TO SQL-DEBUG-02-SQLWARNA
           MOVE "ERRD : "             TO SQL-DEBUG-03-SQLERRDX
           MOVE SQLERRD(1)            TO SQL-DEBUG-03-SQLERRD-1
           MOVE SQLERRD(2)            TO SQL-DEBUG-03-SQLERRD-2
           MOVE SQLERRD(3)            TO SQL-DEBUG-03-SQLERRD-3
           MOVE SQLERRD(4)            TO SQL-DEBUG-04-SQLERRD-4
           MOVE SQLERRD(5)            TO SQL-DEBUG-04-SQLERRD-5
           MOVE SQLERRD(6)            TO SQL-DEBUG-04-SQLERRD-6
           STRING "------------------------------",
                  "[ ERRMC ]",
                  "-------------------------------"
                  DELIMITED BY SIZE INTO SQL-DEBUG-05
           MOVE SQLERRMC              TO SQL-DEBUG-06
           STRING "------------------------------",
                  "[ ERRPC ]",
                  "-------------------------------"
                  DELIMITED BY SIZE INTO SQL-DEBUG-07
           MOVE SQLERRPC              TO SQL-DEBUG-08.

           DISPLAY MESSAGE BOX SQL-DEBUG-01, X"0A"
                               SQL-DEBUG-02, X"0A"
                               SQL-DEBUG-03, X"0A"
                               SQL-DEBUG-04, X"0A"
                               SQL-DEBUG-05, X"0A"
                               SQL-DEBUG-06, X"0A"
                               SQL-DEBUG-07, X"0A"
                               SQL-DEBUG-08.

      ******************************************************************
      *
      *    S Q L - E R R O R
      *
      *=================================================================
      * IN  : E-MSG
      *       E-KEY
      *       SQLCA
      *       SQL-CONNECT-WORKERS
      * OUT : IO-FG   [0=GOOD; BAD!=0]
      * DESC: DISPLAY MESSAGE BOX OF SQL SERVER CONNECTION ERROR;
      *       DISCONNECT FROM SERVER
      ******************************************************************
       SQL-ERROR.

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE MKTEMP-BUF                 TO UPERROR-PATH.
           MOVE "UP1534-ERROR-"            TO UPERROR-PATH-PREFIX.
           MOVE PROCESS-ID-BUF             TO UPERROR-PATH-MKTEMP.
           PERFORM OPEN-UPERROR-FILE-OUTPUT.

           PERFORM GET-TIME.
           MOVE TIME-EDIT                            TO R1-FIELD.

           MOVE SPACES                     TO UPERROR-REC.

           STRING "TIME:",               HEX-TAB,
                  TIME-EDIT,             HEX-CARRIAGE-RETURN
                  DELIMITED BY "  " INTO UPERROR-REC.

           PERFORM WRITE-UPERROR-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE SPACES TO SQL-ERROR-BUF.

           STRING "STOP!!!  ",
                  "CALL HOME OFFICE FOR IT SUPPORT IMMEDIATELY!!!"
                  DELIMITED BY SIZE INTO SQL-ERROR-01.

           STRING "STOP!!!  ",
                  "AN ERROR HAS OCCURED --- DO NOT PROCEED!!!"
                  DELIMITED BY SIZE INTO SQL-ERROR-02.

           STRING E-MSG, " --- FILE: ", E-FILE,
                  " --- PROGRAM: ", E-PROG
                  DELIMITED BY "  " INTO SQL-ERROR-04.
           MOVE SQL-ERROR-04 TO UPERROR-MESS.
           PERFORM SQL-ERROR-UP1534-CAT.

           MOVE "CODE: "  TO SQL-ERROR-05-SQLCODEX.
           MOVE SQLCODE   TO SQL-ERROR-05-SQLCODE.
           MOVE "STATE: " TO SQL-ERROR-05-SQLSTATEX.
           MOVE SQLSTATE  TO SQL-ERROR-05-SQLSTATE.
           MOVE "ERRML: " TO SQL-ERROR-05-SQLERRMLX.
           MOVE SQLERRML  TO SQL-ERROR-05-SQLERRML.
           MOVE "ERRPC: " TO SQL-ERROR-05-SQLERRPLX.
           MOVE SQLERRPL  TO SQL-ERROR-05-SQLERRPL.
           MOVE SQL-ERROR-05 TO UPERROR-MESS.
           PERFORM SQL-ERROR-UP1534-CAT.

           MOVE "KEY : "  TO SQL-ERROR-06-KEYX.
           MOVE E-KEYX    TO SQL-ERROR-06-KEY.
           MOVE SQL-ERROR-06 TO UPERROR-MESS.
           PERFORM SQL-ERROR-UP1534-CAT.

           MOVE SQLERRMC  TO SQL-ERROR-07.
           MOVE SQL-ERROR-07 TO UPERROR-MESS.
           PERFORM SQL-ERROR-UP1534-CAT.

           MOVE SQLERRPC  TO SQL-ERROR-08.
           MOVE SQL-ERROR-08 TO UPERROR-MESS.
           PERFORM SQL-ERROR-UP1534-CAT.

           DISPLAY MESSAGE BOX SQL-ERROR-01, X"0A"
                               SQL-ERROR-02, X"0A"
                               SQL-ERROR-03, X"0A"
                               SQL-ERROR-04, X"0A"
                               SQL-ERROR-05, X"0A"
                               SQL-ERROR-06, X"0A"
                               SQL-ERROR-07, X"0A"
                               SQL-ERROR-08.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  NOTE: WE ARE DOING A SQL-DISCONNECT AT THE END OF SQL-ERROR
      *        TO FORCE PROGRAMS TO STOP EXECUTING.  FOR EXAMPLE,
      *        LP/ACRERN CALLS TO LP/AC1ERN WHICH IF AC1ERN ERRORS
      *        WE WANT WHEN RETURNING BACK TO ACRERN TO HAVE THE
      *        CONNECTION CLOSED ("THE CONNECTION DOES NOT EXIST") THUS
      *        CAUSING AN ERROR ON ANY IO OPERATIONS (BLOCK UPDATES;
      *        WRITE/REWRITE).
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM SQL-DISCONNECT.
           MOVE 9 TO IO-FG.          

      *-----------------------------------------------------------------
       SQL-ERROR-UP1534-CAT.

           MOVE SPACES                     TO UPERROR-REC.

           STRING UPERROR-MESS,          HEX-CARRIAGE-RETURN
                  DELIMITED BY "  " INTO UPERROR-REC.

           PERFORM WRITE-UPERROR-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

      ******************************************************************
      *
      *    S Q L - D A T E - D E C R E M E N T
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: TAKE INPUT DATE THEN DECREMENT IT BY ONE DAY THEN
      *       FORMAT IT THEN RETURN IT BACK;
      *       TO GET A START NOT GREATER THAN TO WORK IN SQL LIKE IT
      *       DOES IN VISION FILES FOR MULTIPLE SCAN PAGES, NEED TO
      *       SUBTRACT ONE TO THE WHERE SCAN BEG (WSBEG).
      ******************************************************************
       SQL-DATE-DECREMENT.
           MOVE SQL-DATE-YYYYMMDD          TO NDTE-DATE.
           MOVE -1                         TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE                  TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.

      ******************************************************************
      *
      *    S Q L - D A T E - I N C R E M E N T
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: TAKE INPUT DATE THEN INCREMENT IT BY ONE DAY THEN
      *       FORMAT IT THEN RETURN IT BACK;
      *       TO GET A START TO WORK IN SQL LIKE IT DOES IN VISION FILES
      *       FOR MULTIPLE SCAN PAGES, NEED TO ADD ONE TO THE
      *       WHERE SCAN BEG (WSBEG).
      ******************************************************************
       SQL-DATE-INCREMENT.
           MOVE SQL-DATE-YYYYMMDD          TO NDTE-DATE.
           MOVE 1                          TO NDTE-HOLD.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE                  TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.

      ******************************************************************
      *
      *    S Q L - G E T - D A T E
      *
      *=================================================================
      * IN  : SQL-DATE-YYYY-MM-DD
      * OUT : SQL-DATE-YYYYMMDD
      * DESC: CONVERT DATE FROM YYYY-MM-DD TO YYYYMMDD FORMAT;
      *       NEEDED FOR 'GET' FIELDS ROUTINES.
      ******************************************************************
       SQL-GET-DATE.

           IF ( SQL-DATE-YYYY-MM-DD = "1900-01-01" )
              MOVE ZEROES TO SQL-DATE-YYYYMMDD
           ELSE
              INSPECT SQL-DATE-YYYY-MM-DD REPLACING ALL SPACES BY ZEROES
              MOVE SQL-DATE-YYYY-MM-DD-YYYY TO SQL-DATE-YYYYMMDD-YYYY
              MOVE SQL-DATE-YYYY-MM-DD-MM   TO SQL-DATE-YYYYMMDD-MM
              MOVE SQL-DATE-YYYY-MM-DD-DD   TO SQL-DATE-YYYYMMDD-DD.

      ******************************************************************
      *
      *    S Q L - S E T - D A T E
      *
      *=================================================================
      * IN  : SQL-DATE-YYYYMMDD
      * OUT : SQL-DATE-YYYY-MM-DD
      * DESC: CONVERT DATE FROM YYYYMMDD TO YYYY-MM-DD FORMAT;
      *       NEEDED FOR 'SET' FIELDS ROUTINES.
      ******************************************************************
       SQL-SET-DATE.

           IF ( SQL-DATE-YYYYMMDD = ZEROES )
              MOVE "1900-01-01" TO SQL-DATE-YYYY-MM-DD
           ELSE
              MOVE SQL-DATE-YYYYMMDD TO SQL-DATE-YYYY-MM-DD-NUM
              INSPECT SQL-DATE-YYYY-MM-DD-NUM REPLACING ALL "/" BY "-".

      ******************************************************************
      *
      *    S Q L - T E X T - D E C R E M E N T
      *
      *=================================================================
      * IN  : SQL-TEXT
      * OUT : SQL-TEXT
      * DESC: USED TO DECREMENT THE LAST CHARACTER OF A STRING SO THAT
      *       A START-NOT-GREATER PARAGRAPH (DECLARE CURSOR) WORKS LIKE
      *       A VISION FILE IN A MULTI-PAGE SCAN WINDOW;
      *       FIND THE LAST CHARACTER IN A TEXT STRING THEN DECREMENT
      *       IT BY ONE.  USING SQL-TEXT-ASCII WORKERS, WORK BACKWARDS:
      *
      *         " "     BECOMES " " (REMAINS SPACE; FIRST CHARACTER)
      *         "!"     BECOMES " "
      *         "1"     BECOMES "0"
      *         "B"     BECOMES "A" (UPPER B AND A)
      *         "~"     BECOMES "}"
      *
      *         "   "   BECOMES "   " (REMAINS SPACES; NO WHERE TO GO)
      *         "!  "   BECOMES "   "
      *         " ! "   BECOMES "   "
      *         "012"   BECOMES "011"
      *         "ABC"   BECOMES "ABB" (UPPER)
      *         "~~ "   BECOMES "~} "
      *         "~~!"   BECOMES "~~ "
      *         "~~~"   BECOMES "~~}"
      *
      ******************************************************************
       SQL-TEXT-DECREMENT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF TEXT FIELD IS SPACES, THEN KEEP IT SPACES (NO WHERE TO GO)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT = SPACES )
              MOVE ZEROES TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    FIND THE LAST CHARACTER IN THE SIZE OF THE TEXT STRING BY
      *    SEARCHING FOR THE LAST CHARACTER THAT IS NOT A SPACE THEN
      *    USE THAT SUBSCRIPT TO SET SQL-TEXT-SIZE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE ZEROES TO SQL-TEXT-SIZE.

           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-MAX BY -1
                        UNTIL SQL-TEXT-S1 <= ZEROES

                   IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                      MOVE SQL-TEXT-S1 TO SQL-TEXT-SIZE
                      MOVE ZEROES      TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

           IF ( SQL-TEXT-SIZE = ZEROES )
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    CHANGE LAST CHARACTER FOUND BACKWARDS
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SQL-TEXTX(SQL-TEXT-SIZE) TO SQL-TEXT-CURRENT.
           PERFORM SQL-TEXT-FIND-ASCII.
           MOVE SQL-TEXT-BEFORE          TO SQL-TEXTX(SQL-TEXT-SIZE).

      ******************************************************************
      *
      *    S Q L - T E X T - I N C R E M E N T
      *
      *=================================================================
      * IN  : SQL-TEXT
      *       SQL-TEXT-SIZE [SIZE OF THE COBOL FIELD SIZE = PIC X(##)]
      * OUT : SQL-TEXT
      * DESC: USED TO INCREMENT TEXT STRING.  NEED THE SIZE OF THE COBOL
      *       FIELD TO KNOW WHICH CHARACTER NEEDS TO BE INCREMENTED TO.
      *
      *       IF THE LAST CHARACTER (SQL-TEXT-SIZE) IS NOT SPACE, THEN
      *       INCREMENT THAT CHARACTER:
      *
      *         " "     BECOMES "!"
      *         "/"     BECOMES "0"
      *         "9"     BECOMES ":"
      *         "@"     BECOMES "A" (UPPER A)
      *         "Z"     BECOMES "[" (UPPER Z)
      *         "`"     BECOMES "A" (LOWER A)
      *         "Z"     BECOMES "{" (LOWER Z)
      *         "~"     BECOMES "~" (~ REMAINS ~; LAST CHARACTER)
      *
      *         "AB!"   BECOMES "AB"" (UPPER AB)
      *         "AB/"   BECOMES "AB0" (UPPER AB)
      *         "AB9"   BECOMES "AB:" (UPPER AB)
      *         "AB@"   BECOMES "ABA" (UPPER ABA)
      *         "ABZ"   BECOMES "AB[" (UPPER ABZ)
      *         "AB`"   BECOMES "ABA" (UPPER AB LOWER A)
      *         "ABZ"   BECOMES "AB{" (UPPER AB LOWER Z)
      *         "AB~"   BECOMES "AC " (UPPER AB~ || UPPER AC)
      *         "AZZ"   BECOMES "AZ[" (UPPER AZZ)
      *         "AZ~"   BECOMES "A[ " (UPPER AZ~)
      *         "A~~"   BECOMES "B  " (UPPER A~~)
      *         "~~~"   REMAINS "~~~" (NO WHERE TO GO TO)
      *
      *         "AB!  " BECOMES "AB!! " (UPPER AB)
      *         "AB/  " BECOMES "AB/! " (UPPER AB)
      *         "AB9  " BECOMES "AB9! " (UPPER AB)
      *         "AB@  " BECOMES "AB@! " (UPPER AB)
      *         "ABZ  " BECOMES "ABZ! " (UPPER ABZ)
      *         "AB`  " BECOMES "AB`! " (UPPER AB)
      *         "AB~  " BECOMES "AB~! " (UPPER AB)
      *         "~~~  " BECOMES "~~~! "
      *
      *         "A !"   BECOMES "A "" (UPPER A)
      *         "A /"   BECOMES "A 0" (UPPER A)
      *         "A 9"   BECOMES "A :" (UPPER A)
      *         "A @"   BECOMES "A A" (UPPER A A)
      *         "A Z"   BECOMES "A [" (UPPER ABZ)
      *         "A `"   BECOMES "A A" (UPPER A SPACE LOWER A)
      *         "A ~"   BECOMES "A! " (UPPER A)
      *         "~  "   BECOMES "~! " 
      *         "~~ "   BECOMES "~~!" 
      *
      ******************************************************************
       SQL-TEXT-INCREMENT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF TEXT FIELD IS SPACES, THEN MAKE IT A LEADING ! ("!     ")
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT = SPACES )
              MOVE SQL-TEXT-ASCIIX(2) TO SQL-TEXT        *> ! CHARACTER
              MOVE ZEROES             TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF SQL-TEXT-SIZE IS NOT SET THEN FIND THE SIZE OF THE TEXT
      *    STRING BY SEARCHING FOR THE LAST CHARACTER THAT IS NOT A
      *    SPACE THEN USE THAT SUBSCRIPT TO SET SQL-TEXT-SIZE.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-SIZE NOT NUMERIC ) OR
              ( SQL-TEXT-SIZE = ZEROES    )
              MOVE 01 TO SQL-TEXT-SIZE
              PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-MAX BY -1
                        UNTIL SQL-TEXT-S1 <= ZEROES

                      IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                         MOVE SQL-TEXT-S1 TO SQL-TEXT-SIZE
                         MOVE ZEROES      TO SQL-TEXT-S1
                      END-IF

              END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF TEXT SIZE = 1, INCREMENT EXECPT IF A `~`
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-SIZE = 1 )
              IF ( SQL-TEXTX(1) = "~" )
                 MOVE ZEROES         TO SQL-TEXT-SIZE
                 EXIT PARAGRAPH
              ELSE
                 MOVE SQL-TEXTX(1)   TO SQL-TEXT-CURRENT
                 PERFORM SQL-TEXT-FIND-ASCII
                 MOVE SQL-TEXT-AFTER TO SQL-TEXTX(1)
                 MOVE ZEROES         TO SQL-TEXT-SIZE
                 EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    FIND LAST CHARACTER THAT IS NOT A SPACE FROM THE SIZE OF
      *    STRING; NEED TO KNOW IF THE LAST CHARACTER IS ALSO THE
      *    LAST IN THE SIZE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE SQL-TEXT-SIZE TO SQL-TEXT-LAST.

           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-SIZE BY -1
                     UNTIL SQL-TEXT-S1 <= 0

                   IF ( SQL-TEXTX(SQL-TEXT-S1) NOT = SPACES )
                      MOVE SQL-TEXT-S1 TO SQL-TEXT-LAST
                      MOVE ZEROES      TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF LAST CHARACTER (NON-SPACE; SQL-TEXT-LAST) IS ALSO THE
      *    LAST POSITON OF THE STRING (SQL-TEXT-SIZE), THEN INCREMENT
      *    THAT POSITION EXCEPT IF A `~`
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-LAST                = SQL-TEXT-SIZE ) AND
              ( SQL-TEXTX(SQL-TEXT-LAST) NOT = "~"           )
              MOVE SQL-TEXTX(SQL-TEXT-LAST) TO SQL-TEXT-CURRENT
              PERFORM SQL-TEXT-FIND-ASCII
              MOVE SQL-TEXT-AFTER TO SQL-TEXTX(SQL-TEXT-LAST)
              MOVE ZEROES         TO SQL-TEXT-SIZE
              EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF LAST CHARACTER (NON-SPACE; SQL-TEXT-LAST) IS ***NOT*** THE
      *    LAST POSITON OF THE STRING (SQL-TEXT-SIZE), THEN:
      *     - IF CHARACTER IS NOT `~`, THEN INCREMENT THAT POSITION
      *     - IF CHARACTER IS `~`, THEN INCREMENT THE NEXT POSITION
      *       (SHOULD BE A SPACE; BECOMES A "!")
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-LAST NOT = SQL-TEXT-SIZE )
              IF ( SQL-TEXTX(SQL-TEXT-LAST) NOT = "~" )
                 MOVE SQL-TEXTX(SQL-TEXT-LAST) TO SQL-TEXT-CURRENT
                 PERFORM SQL-TEXT-FIND-ASCII
                 MOVE SQL-TEXT-AFTER TO SQL-TEXTX(SQL-TEXT-LAST)
              ELSE 
                 MOVE SQL-TEXT-ASCIIX(2) TO SQL-TEXTX(SQL-TEXT-LAST + 1)
                 MOVE ZEROES             TO SQL-TEXT-SIZE
                 EXIT PARAGRAPH.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    LAST CHARACTER (SQL-TEXT-LAST) IS EQUAL TO LAST POSITION OF
      *    THE LAST POSITION OF THE STRING (SQL-TEXT-SIZE) AND IS EQUAL
      *    TO A `~`.  NEED TO MAKE THAT POSITION A SPACE, THEN WORK
      *    BACKWARDS AND INCREMENT THAT POSITION UNLESS IT ALSO IS A
      *    `~` WHICH IF SO MAKE IT ALSO A SPACE AND REPEAT BACKWARDS
      *    TILL NON ~ CHARACTER FOUND:
      *
      *         "AZ~"   BECOMES "A[ " (UPPER AZ~)
      *         "A~~"   BECOMES "B  " (UPPER A~~)
      *         "A ~"   BECOMES "A! " (UPPER A)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM VARYING SQL-TEXT-S1 FROM SQL-TEXT-LAST BY -1
                     UNTIL SQL-TEXT-S1 <= 0

                   IF ( SQL-TEXTX(SQL-TEXT-S1) = "~" )
                      MOVE SPACES TO SQL-TEXTX(SQL-TEXT-S1)
                   ELSE
                      MOVE SQL-TEXTX(SQL-TEXT-S1) TO SQL-TEXT-CURRENT
                      PERFORM SQL-TEXT-FIND-ASCII
                      MOVE SQL-TEXT-AFTER TO SQL-TEXTX(SQL-TEXT-S1)
                      MOVE ZEROES         TO SQL-TEXT-S1
                   END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF SQL-TEXT EQUAL SPACES, THEN FILL IT WITH ALL `~`;
      *    THE PREVIOUS `PERFORM VARYING` CLEARED (SPACES) TO SQL-TEXT
      *    SO NEED TO POPULATE IT WITH `~` SINCE THERE NEEDS TO GET TO
      *    MAX VALUE TO SIGNAL THERE WAS NO WHERE TO GO:
      *
      *         "~~~"   REMAINS "~~~" (NO WHERE TO GO TO)
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT = SPACES )
              MOVE ALL "~" TO SQL-TEXT.

      ******************************************************************
      *
      *    S Q L - T E X T - F I N D - A S C I I
      *
      *=================================================================
      * IN  : SQL-TEXT-CURRENT
      * OUT : SQL-TEXT-AFTER
      *       SQL-TEXT-BEFORE
      * DESC: FIND THE CURRENT CHARACTER IN SQL-TEXT-ASCII THEN RETURN
      *       BACK THE CHARACTER BEFORE & AFTER THE CURRENT CHARACTER.
      ******************************************************************
       SQL-TEXT-FIND-ASCII.

           MOVE ZEROES TO SQL-TEXT-S4.

           PERFORM VARYING SQL-TEXT-S3 FROM 1 BY 1
                     UNTIL SQL-TEXT-S3 > SQL-TEXT-ASCII-MAX

                  IF ( SQL-TEXT-ASCIIX(SQL-TEXT-S3) = SQL-TEXT-CURRENT )
                     MOVE SQL-TEXT-S3        TO SQL-TEXT-S4
                     MOVE SQL-TEXT-ASCII-MAX TO SQL-TEXT-S3
                  END-IF

           END-PERFORM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SQL-TEXT-S4 = ZEROES )
              MOVE SPACES TO SQL-TEXT-AFTER
                             SQL-TEXT-BEFORE
              EXIT PARAGRAPH.

           IF ( SQL-TEXT-S4 = 1 )
              MOVE SQL-TEXT-ASCIIX(2)               TO SQL-TEXT-AFTER
              MOVE SPACES                           TO SQL-TEXT-BEFORE
           ELSE
           IF ( SQL-TEXT-S4 = SQL-TEXT-ASCII-MAX )
              MOVE SPACES                           TO SQL-TEXT-AFTER
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 - 1) TO SQL-TEXT-BEFORE
           ELSE
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 + 1) TO SQL-TEXT-AFTER
              MOVE SQL-TEXT-ASCIIX(SQL-TEXT-S4 - 1) TO SQL-TEXT-BEFORE.


      *=================================================================
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBGB/GBGRGS_SQL.CPY".

       COPY "LIBGB/GBPRINT.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBGB/GBGR1RN.CPY".

       COPY "LIBSP/SPIOSORT.CPY".

      * FILES FOR SQL ASCII
       COPY "LIBUP/UPABWI.CPY".
       COPY "LIBUP/UPABXI.CPY".
       COPY "LIBUP/UPACAI.CPY".
       COPY "LIBUP/UPACII.CPY".
       COPY "LIBUP/UPACKI.CPY".
       COPY "LIBUP/UPAGLI.CPY".
       COPY "LIBUP/UPAIXI.CPY".
       COPY "LIBUP/UPALNI.CPY".
       COPY "LIBUP/UPALEI.CPY".
       COPY "LIBUP/UPALHI.CPY".
       COPY "LIBUP/UPALPI.CPY".
      *COPY "LIBUP/UPALXI.CPY".
      *COPY "LIBUP/UPALXEI.CPY".
      *COPY "LIBUP/UPALXGI.CPY".
      *COPY "LIBUP/UPALTAI.CPY".
       COPY "LIBUP/UPALTBI.CPY".
       COPY "LIBUP/UPALTCI.CPY".
       COPY "LIBUP/UPALTDI.CPY".
       COPY "LIBUP/UPALTFI.CPY".
       COPY "LIBUP/UPALTII.CPY".
       COPY "LIBUP/UPALTLI.CPY".
       COPY "LIBUP/UPALTPI.CPY".
       COPY "LIBUP/UPARCI.CPY".
       COPY "LIBUP/UPAWRI.CPY".

       COPY "LIBUP/UP1534_IO.CPY".
       COPY "LIBUP/UP1534_SPIOREPORT.CPY".

      *=================================================================
      * COPYMEMBER: LIBGB/GBBRRN
      *=================================================================
       OPEN-OBR-FILE.
           PERFORM OPEN-IT.
           MOVE OBR-PATH TO E-FILE.
           OPEN INPUT OBR-FILE.
           IF IO-FG = 8
              GO TO OPEN-OBR-FILE.
           IF IO-FG = 7
              CLOSE OBR-FILE
              GO TO OPEN-OBR-FILE.

      *-----------------------------------------------------------------
       READ-OBR-FILE-NEXT.
           PERFORM READ-IT.
           MOVE OBR-PATH TO E-FILE.
           MOVE OBR-KEY TO E-KEYX.
           READ OBR-FILE NEXT.
           IF IO-FG = 8
              GO TO READ-OBR-FILE-NEXT.

      *-----------------------------------------------------------------
       START-OBR-FILE.
           PERFORM START-IT.
           MOVE OBR-PATH TO E-FILE.
           MOVE OBR-KEY TO E-KEYX.
           START OBR-FILE KEY NOT < OBR-KEY.

      *-----------------------------------------------------------------
       CLOSE-OBR-FILE.
           PERFORM CLOSE-IT.
           CLOSE OBR-FILE.

      *=================================================================
       OPEN-MSEXCEL-FILE-OUTPUT.
           PERFORM OPEN-IT.
           MOVE MSEXCEL-PATH TO E-FILE.
           OPEN OUTPUT MSEXCEL-FILE.

           IF ( IO-FG = 8 )
              GO TO OPEN-MSEXCEL-FILE-OUTPUT.

           IF ( IO-FG = 7 )
              CLOSE MSEXCEL-FILE
              GO TO OPEN-MSEXCEL-FILE-OUTPUT.

      *-----------------------------------------------------------------
       READ-MSEXCEL-FILE.
           PERFORM READ-IT.
           MOVE MSEXCEL-PATH TO E-FILE.
           READ MSEXCEL-FILE.

           IF ( IO-FG = 8 )
              GO TO READ-MSEXCEL-FILE.

      *-----------------------------------------------------------------
       WRITE-MSEXCEL-FILE.
           PERFORM WRITE-IT.
           MOVE MSEXCEL-PATH TO E-FILE.
           WRITE MSEXCEL-REC.

           IF ( IO-FG = 8 )
              GO TO WRITE-MSEXCEL-FILE.

      *-----------------------------------------------------------------
       CLOSE-MSEXCEL-FILE.
           PERFORM CLOSE-IT.
           CLOSE MSEXCEL-FILE.

      *=================================================================
       OPEN-UPERROR-FILE-OUTPUT.
           PERFORM OPEN-IT.
           MOVE UPERROR-PATH TO E-FILE.
           OPEN OUTPUT UPERROR-FILE.

           IF ( IO-FG = 8 )
              GO TO OPEN-UPERROR-FILE-OUTPUT.

           IF ( IO-FG = 7 )
              CLOSE UPERROR-FILE
              GO TO OPEN-UPERROR-FILE-OUTPUT.

      *-----------------------------------------------------------------
       READ-UPERROR-FILE.
           PERFORM READ-IT.
           MOVE UPERROR-PATH TO E-FILE.
           READ UPERROR-FILE.

           IF ( IO-FG = 8 )
              GO TO READ-UPERROR-FILE.

      *-----------------------------------------------------------------
       WRITE-UPERROR-FILE.
           PERFORM WRITE-IT.
           MOVE UPERROR-PATH TO E-FILE.
           WRITE UPERROR-REC.

           IF ( IO-FG = 8 )
              GO TO WRITE-UPERROR-FILE.

      *-----------------------------------------------------------------
       CLOSE-UPERROR-FILE.
           PERFORM CLOSE-IT.
           CLOSE UPERROR-FILE.

      *===========================================[ NOTE: MUST BE LAST ]
       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO ERRCD.
 
      ******************************************************************
      *
      *    E N D - P R O G R A M 
      *
      ******************************************************************
       END-PROGRAM SECTION.

           PERFORM CLOSE-FILES.
           PERFORM MISC-TRACE-END-PROGRAM.             *> DISABLE TRACE

           MOVE SORT-PATH TO ACCESS-BUF.
           PERFORM REMOVE-WORKFILE.

           IF EXIT-PRIOR-TO-EXECUTION
              GO TO EXIT-PROG.

           IF ( EXT-ROUTE-BUF = "00" )
              PERFORM PRU-OUT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVING REPORT FILE IN /USR/TMP TO /USR/TMP/UP1534.MKTEMP
      *    SAVING REPORT FILE IN CASE OF ANY OF THE UPGRADE PROGRAMS
      *    BOMB OUT SO YOU CAN SEE WHICH FILE WAS PROCESSED LAST.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    MOVE "MV "                      TO SAVE-REPORT-CMD.
      *    CALL "C$TOLOWER" USING SAVE-REPORT-CMD, VALUE 03.

      *    MOVE UP1534-REPORT-PATH         TO MKTEMP-BUF
      *                                       SAVE-REPORT-SOURCE
      *                                       SAVE-REPORT-TARGET.

      *    MOVE "UP1534."                  TO SAVE-REPORT-TARGET-NEW.
      *    CALL "C$TOLOWER" USING SAVE-REPORT-TARGET-NEW, VALUE 07.

      *    MOVE MKTEMP-NAME                TO SAVE-REPORT-TARGET-MKTEMP.

      *    MOVE SAVE-REPORT-COMMAND        TO SYSTEM-BUF.
      *    PERFORM SYSTEM-CALL.

      *-----------------------------------------------------------------
       EXIT-PROG.

           IF ( SV-BEG-BRANCH NOT = 9999 )
              IF ( EXT-EOBUF-GROUP-FG = "Y" )
                 MOVE SV-BEG-BRANCH        TO BEG-BRANCH
                 MOVE SV-END-BRANCH        TO END-BRANCH
                 MOVE SV-GROUP-FLAG        TO GROUP-FLAG
                 MOVE SV-ENT-GROUP         TO ENT-GROUP
              ELSE
                 MOVE SV-BEG-BRANCH        TO BEG-BRANCH
                 MOVE SV-END-BRANCH        TO END-BRANCH.

           IF ( EXT-ROUTE-BUF = "00" )
              MOVE EXIT-PATH               TO FORM-NAM
              MOVE FORM-PATH               TO FORM-PATHNAME.

      *-----------------------------------------------------------------
       STOP-RUN.

           IF ( EXT-ROUTE-BUF = "00" OR "40" OR "50" )
              PERFORM FORM-RESET
              DESTROY UP1534-SCREEN
              DESTROY EXT-EOBUF-WINDOW-HANDLE.
           EXIT PROGRAM.
 
