      * COPYMEMBER: LIBSP/SP01VCQ
      ******************************************************************
      *               (VCQ)
      *    VISION VERSION OF THE DAILY COLLECTOR QUEUE FILE
      *
      * VCQ-KEY: VCQ-BRNO, VCQ-COLLID, VCQ-REV-BEHAVIOR-RISK, 
      *          VCQ-SEQ-FG, VCQ-DATE, VCQ-START-TIME, VCQ-REV-DEL,
      *          VCQ-MISC-KEY-FLD, VCQ-REV-PDUE-DAYS, VCQ-REV-BAL,
      *          VCQ-SEQ
      *
      *=================================================================
      * THERE ARE TWO PURPOSES FOR THE VCQFILE:
      *
      *  1. FOR SCAN PAGE FUNCTIONALITY THAT CANNOT BE ACHIEVED FOR THE
      *     CQ2-KEY IN SQL BUT CAN BE DONE IN VISION.  DUE TO THE 
      *     COMPLEXITY OF THE CQ2-KEY, IT IS HARD TO NAVIGATE WITH A
      *     PAGE UP & PAGE DOWN WITHIN A SCAN WINDOW (WI/CQSCAN)
      *
      *  2. FOR DEALING WITH THE COLLECTION WORK SCREEN (SPINQ & XPINQ)
      *     WORKING WITH THE CQ2-KEY AND ITS DUPLICATES.  THIS IS
      *     BECAUSE IT REQUIRES A START-GREATER FUNCTION. DUE TO THE
      *     COMPLEXITY OF THE CQ2-KEY, GETTING A PROPER SQL WHERE
      *     CONSTRAINT TO WORK IN A START-GREATER USAGE IS VERY
      *     DIFFICULT.  IT IS EASIER TO USE THE VCQFILE.
      *
      * WITHIN THE CQ2-KEY, CQ-SEQ WAS ADDED BY BARB BACK IN A30 IN
      * ATTEMPT TO WORK WITH THE CQ2-KEY DUPLICATES.  CINDY ALSO TRIED
      * WORKING WITH CQ-SEQ FOR THE DUPLICATES WITHIN S35.  THEIR
      * EFFORTS DID NOT WORK AND NEVER FOUND A RESOLUTION.
      *
      * IN SEPTEMBER 2023, STEVE AND JAY WORKED ON CREATING THE VCQFILE
      * TO DEAL WITH THE NAVIGATION WITHIN THE SCAN WINDOW.  THIS
      * RESOLVED IT.
      *
      * IN MARCH 2025, BETH AND JAY WORKED ON THE ISSUES THAT S35
      * USER TESTING WAS GETTING (LOCKING, DISPLAY OUT OF ORDER,
      * NOT GETTING THE NEXT ACCOUNT WHEN SKIPPING).  THEY FOUND
      * CQ-SEQ WAS ALWAYS ZEROES AND NO LOGIC THAT WOULD INCREMENT IT.
      * NOW IN THE COLLECTION WORK SCREEN (SPINQ & XPINQ; LIBSP/SPINQ2),
      * AT THE START, IT WILL LOAD ALL CQ-REC FOR THAT GIVEN BRANCH
      * INTO THE USER'S VCQFILE THEN IT WILL GO THROUGH IT USING
      * VCQ2-KEY LOOKING FOR DUPLICATES AND ADDING ONE TO VCQ-SEQ IF IT
      * IS A DUPLICATE (LIBSP/SPFRVCQ).  FURTHER INTO THE PROGRAM, IT
      * WILL USE MOSTLY THE VCQFILE BUT AT TIMES WILL STILL READ THE
      * CQFILE (SQL) FOR THE MATCHING RECORD (VCQ-CQ-REC) TO ENSURE IT
      * WAS NOT WORKED (CQ-WORKED-FG = "Y") OR IS CURRENTLY BEING WORKED
      * BY ANOTHER USER (CQ-IN-PROCESS = "Y") SINCE LOADED INTO THE
      * VCQFILE.  THE REWRITE-CQ-FILE SECTION WAS CREATED TO UPDATE
      * THE CQ-REC AND VCQ-REC FOR CHANGES MADE.  THIS SECTION WILL:
      *
      *  1. MOVE CQ-REC TO HOLD-CQ-REC
      *  2. MOVE ZEROES TO CQ-SEQ
      *  3. READ CQFILE TO GET CQ-REC
      *  4. MOVE VCQ-SEQ INTO CQ-SEQ OF RECENT READ CQ-REC
      *  5. CHECK IF CQ-REC (SQL) EQUALS VCQ-CQ-REC
      *     A. IF EQUAL, MOVE HOLD-CQ-REC BACK TO CQ-REC
      *     B. IF NOT EQUAL, DISPLAY MESSAGE & FORCE EXIT OF PROGRAM
      *  6. REWRITE CQ-REC AND VCQ-REC
      *
      * THIS SECTION NEEDS TO ENSURE THAT THE GIVEN CQ-REC HAS NOT BEEN
      * ALTERED BY ANOTHER USER WHILE THE GIVEN USER WAS WORKING IT.
      * IF THE CQ-REC HAD BEEN ALTERED, WE NEED TO MESSAGE THE CURRENT
      * USER THAT A CHANGE HAD BEEN MADE AND NEED RESTART THE COLLECTION
      * WORK SCREEN IN ORDER TO RELOAD THE VCQFILE TO GET IT RESYNC WITH
      * THE LATEST DATA.
      *
      *=================================================================
      * REV:
      * SMR 2023-0925 ***NEW***
      * SMR 2025-0318 ADDED VCQ2-KEY
      * JKC 2025.0324 S35Q-191 MASSIVE FIX FOR COLLECTIONS; FOR USING
      *         A IDENTICAL A15 VISION STRUCTURE FOR THE VCQFILE; FIX
      *         HANDLING DUPLICATE CQ2-KEY WITHIN THE VCQFILE WHICH YOU
      *         CAN READ LIBSP/SP01VCQ FOR MORE DETAIL INFORMATION.
      *
      ******************************************************************
       78  VCQ-SIZE                                  VALUE 166.
       78  VCQ-CQ-SIZE                               VALUE 125.
       01  VCQ-REC.
           03  VCQ1-KEY.
               05  VCQ-BRNO                      PIC 9(4).
               05  VCQ-ACCTNO                    PIC 9(8)    COMP-3.
           03  VCQ2-KEY.
               05  VCQ-COLLID                    PIC XXX.
               05  VCQ-REV-BEHAVIOR-RISK         PIC 9.
               05  VCQ-SEQ-FG                    PIC X.
               05  FILLER                        PIC X.
               05  VCQ-DATE                      PIC 9(8)    COMP-3.
               05  VCQ-START-TIME                PIC S9(4)   COMP-3.
               05  VCQ-SEQ-FIELDS.
                   07  VCQ-REV-DEL               PIC 9(5).
                   07  VCQ-MISC-KEY-FLD          PIC X(3).
                   07  VCQ-REV-PDUE-DAYS REDEFINES VCQ-MISC-KEY-FLD 
                                                 PIC 9(5)    COMP-3.
                   07  VCQ-REV-BAL               PIC 9(7).
                   07  VCQ-SEQ                   PIC 9(3).
           03  VCQ-CQ-REC                        PIC X(VCQ-CQ-SIZE).

