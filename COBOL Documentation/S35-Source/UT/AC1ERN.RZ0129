       IDENTIFICATION DIVISION.
       PROGRAM-ID.    AC1ERN.
       DATE-WRITTEN.  09-12-86.
      ******************************************************************
      *
      *   IDENTIFICATION:  LP/AC1ERN.C
      *
      *   DESCRIPTION   :  MONTHLY EARNINGS ACCRUAL - IB ACCRUAL
      *
      *=================================================================
      * REV:
      * CS         ADDED REPORT TO BOTTOM OF EACH BRANCH'S IB REPORT OF
      *            ALL ACCOUNTS EXCEEDING MAX-IB-ACR-DAYS. PR#1377
      * JTG 950829 CHANGED (MERCURY), TO SKIP REPO ACCOUNTS ON
      *            IB ACCRUAL
      * MJD 950911 CHANGED FILE PATHS. THE FILE NAMES ARE NOW:
      *            EX:  ACR0895D.UNEARNED     AC20895D.NONACCRU
      *                 ACR0895R.IBACCRUE     AC20895R.PLUNEARN
      * MJD 951107 FIXED REPORT TO BREAK ON CLASS.
      * MJD 960716 ADDED LIBLP/LPUPWK(W) TO CORRESPOND WITH
      *            CHANGES MADE TO LIBGB/AGEING.
      * JTG 961030 ADDED LPREGZW & LPREGZ, RE: LPCERN A50 FORMULAS
      * BAH 961205 ADDED A HOLD-LT-KEY BECAUSE GET-LT-P RECORD OPENS
      *            AND CLOSES LT FILE IF THE ADDON HAS A PAYMENT
      *            SCHEDULE, BECAUSE ERNDELQFRMLA COMPUTES
      *            CONTRACTUAL ROUTINE FOR START AND STOP
      *            POINTS !! (COLTN)
      * MJD 961210 CHANGED TO PERFORM LPSTAT-DISPLAY AFTER
      *            READING BWFILE.
      * BAH 961213 SKIP LOANS IN RESCISSION AND LOANS THAT HAVE BEEN
      *            RESCINDED
      * GLF 970507 ADDED COPY MEMBERS: SETCTBLW AND SETCTBL
      * BAH 970804 IB TOTALS WERE NOT GETTING CLEARED BEFORE STARTING
      *            THE IB REPORTS IN THE END-ROUTINE (T-ACCRUED,
      *            T-INTBAL, T-INT-SINCE-1STPY AND T-TRUE-ACCRUE
      *            ...KEVIN (CAVCO))
      * GLF 970904 REPLACED 'IO' ON GP-FILE WITH GET 'GPENV'
      * MJD        INCREASED WORKERS FROM S9(7)V99 TO S9(9)V99 FOR
      *            GT-AMT CHANGE
      * JTG 971106 INCREASED WORKERS FROM S9(7)V99 TO S9(9)V99
      *            AND DISPLAYS TO Z(8)9.99-
      * JTG 971202 CORRECTED CALL TO SET-PY-RATE TO HANDLE YEAR 2000
      *            RE: ESTABLISH NO LIMIT ON SP-MAX-IB-ACR-DAYS
      *                CBC CAPITAL SINGLE PAY LOAN 12 MONTHS
      * JTG 980417 CORRECTED LOGIC FOR EXPIRED ACCOUNTS, CASTLE #180
      * JTG 980731 CHANGED TO SKIP VOIDED & INRECESSION LOANS
      * JTG 990203 CORRECTED LOGIC FOR IB ACCRUAL, COMPARE AGAINST
      *            MAX DAYS WAS COMPARING AGAINST TRUE-ACCRUE
      *            INSTEAD OF INDU-INTEREST
      * JTG 990226 ADDED SKIP OF REVOLVING ACCOUNTS
      * JTG 990326 ADDED AERN-LAST-ACCRUAL-DATE
      *                  AERN-NEW-LAST-ACCRUAL-DATE
      *                RE: SP-ERNDELQFRMLA 'C' TFC #005
      * CS  990419 ADDED TEST OF GP-IB-ACCRUE-EARN-ON-REPO TO
      *            DETERMINE IF IB REPO ACCOUNTS SHOULD BE INCLUDED
      *            IN THE ACCRUAL
      * BLV 990512 MOVE FLDVAL OF SCREEN-LIST TO BEGINNING OF PROG
      *            INSTEAD OF INITIALIZATION - BRANCH WHICH DIDN'T
      *            PASS FILE ACCESS CHECK WAS GOING TO END-PROGRAM &
      *            XFERRING BACK BAD REPORT LINES, CAUSING 1 ACCT
      *            PER PAGE & TONS OF ACU_TCLP ENTRIES
      * JTG 990611 ADDED LOGIC TO PASS BR-MACHINE AND BR-DATA-PATH
      *            TO RVCALCW
      * JTG 990719 ADDED SET OF RVCALC-PRINT-A-STATEMENT-FG
      * JTG 990727 ADDED GP-I-AM-MERC TEST TO PUT OLD LOGIC CHANGED
      *            ON 1999.0203
      *            RE: CORRECTED LOGIC FOR IB ACCRUAL, COMPARE
      *                AGAINST MAX DAYS WAS COMPARING AGAINST
      *                TRUE-ACCRUE INSTEAD OF INDU-INTEREST
      * MJD 990810 ADDED GP-INCL-OTH-IN-EARNED FLAG. IF "Y" THEN
      *            INCLUDE EARNINGS BUCKET 6 (OTHER) IN ACCUMULATED
      *            TOTALS OTHERWISE EXCLUDE BUCKET 6.
      * CS  010306 ADDED WK3 FOR INTEREST BEARING ACCOUNTS WHERE TRUE
      *            INTEREST ACCRUED IS GREATER THAN W-MAX.
      * JTG 000504 CORRECTED LOGIC ABOVE FOR GP-INCL-OTH-IN-EARNED FLAG.
      *            NEEDED ADDITIONAL TEST FOR WHEN ACCOUNT HAS LN-ANTICERN(6)
      *            AND GP-INCL-OTH-IN-EARNED = "N", STILL NEED TO TAKE
      *            AN ACCRUAL OF LOAN COSTS.
      * JTG 000107 MOVE "N" TO RVCALC-UPDATE-FILES WAS CHANGED TO "A"
      *            TO LET RVCALC.C KNOW IT WAS CALLED FROM AC1ERN.C
      * JTG 000718 CORRECTED LOGIC FOR IB ACCRUAL, TO NEVER TAKE MORE THAT
      *            THE SPR MAX IB DAYS, EVEN WHEN LN-INTBAL + NEW ASSESS IS
      *            MORE THAN MAX            ALL, MERCURY, JIM R, JTG, CINDY
      * JTG 001221 ADDED DUMMY CODE TO ALLOW DEBUGGER HALT ON MOVE:  JTG 001221
      *  CS 010122 ADDED CALCULATION OF LN-LMO-PRIOR-INTEREST (MERC 240)
      *  CS 010227 ADDED SUMMARY OPTION TO AC1DAY,MAKING IT NECESSARY TO
      *            NOT PRINT CLASS TOTALS IF RUNNING AC1DAY WITH SUMMARY OPTION
      *  CS 010308 ADDED WK3-FILE FOR IB ACCOUNTS EXCEEDING SP-MAX-IB-ACR-DAYS
      *            TO PRINT REPORT AT END OF BRANCH IB ACCRUAL REPORT.(PRINT-IB
      *            EXCEPTIONS). PR#1377
      * JTG 010919 ADDED LOGIC FOR PAYOFF ON SP-CAL-RATETYPE(Z)LENDMARK PR#1045
      * GLB 011010 BUG; LN-INTBAL RETURNING FROM RVCALC ALREADY UPDATED,
      *            NEEDED TO SUBTRACT OUT CURRENT INTEREST
      * JTG 020204 CORRECTED IB ACCRUAL LOGIC FOR ESTABLISHING THE MAXIMUM
      *            IB ACCRUAL PER SP-MAX-IB-ACR-DAYS. LOGIC DID NOT TAKE INTO
      *            ACCOUNT LOANS THAT WERE GOING TO EXPIRE AND SHOULD ESTABLISH
      *            MAXIMUM FROM EXPIRATION AND NOT LN-INTPDTH-DATE   MERC
      * JTG 020829 CHANGED TO CALL NEW RVCAL2.C PROGRAM          LENDMARK #1877
      * BAH 020920 GOT RID OF AC1DVR COPY MEMBERS !!!!!!!!!!!!!
      * BAH 020920 CHANGED TO COPY & CALL WITH RVCAL2-WORKERS!
      * JTG 020829 PUT BACK CALL TO CALL RVCALC.C PROGRAM        LENDMARK #1877
      *            MUST ESTABLISH LOCAL-PATHS FOR CALL ???WKRS
      * JTG 020925 CHANGED TO COPY & CALL RVCAL2-WORKERS
      *            ESTABLISHED LOCAL-PATHS FOR CALL
      * CS  021118 AMOUNTS ON THE DETAIL REPORT WERE NOT SIGNED AND DID NOT
      *             REFLECT NEGATIVE AMOUNTS CAUSING THE DETAIL/TOTALS TO NOT
      *            MATCH   [CAROLINA FINANCE]
      * JTG 030409 UPDATING TRIAD LOAN TRAILER, LRFILE, REGACC PR#26
      * GLB 030425 RENAME RVCAL2W TO RVCALCW
      * GLB 030425 CALL RVCALC INSTEAD OF RVCAL2
      * JTG 030520 ADDED SET OF LR-ALL-PATH FOR UPDATING TRIAD LOAN TRAILER
      *            LRFILE,                                      REGACC PR#26
      * JTG 040812 ADDED LOGIC FOR NEW SPR FIELDS SP-DELQ-IB-AGE AND
      *            SP-DELQ-IB-MAX-DAYS, THE IB ACCRUAL WILL DETERMINE IF AN
      *            ACCOUNT HAS REACHED THE CONTRACTUAL AGE OF 'SP-DELQ-IB-AGE
      *            AND IF SO FORCE THE MAXIMUM ACCRUAL DAYS TO THE VALUE
      *            OF SP-DELQ-IB-MAX-DAYS                     LENDMARK #2344
      * JTG 050425 CORRECTED LOGIC FOR NEW SPR FIELDS SP-DELQ-IB-AGE AND
      *            SP-DELQ-IB-MAX-DAYS. THE ROUTINE USED THE NORMAL FIELD
      *            SPR PAGE 14 ( 8. IB ACCRU MAX DAYS ) ( SP-MAX-IB-ACR-DAYS )
      *            TO PERFORM LOGIC TO COMPUTE IB ACCRUED INTEREST. FOR EACH
      *            ACCOUNT TESTED AGAINST SP-DELQ-IB-AGE, WHEN CONTRACTUAL
      *            EXCEEDED THIS SP-DELQ-IB-MAX-DAYS WAS MOVED TO
      *            SP-MAX-IB-ACR-DAYS.
      *
      *            THIS WAS NOT RESET AFTER EACH ACCOUNT'S CONTRACTUAL AGE
      *            WAS TESTED AND WHEN SP-DELQ-IB-MAX-DAYS = 0
      *            THE NEXT ACCOUNT WOULD BE SKIPPED SINCE MAX DAYS WERE ZERO.
      *                                                           LENDMARK #2344
      * JTG 050627 ADDED CHANGES FOR REPORTING AND TAKING FEE CODE EARNINGS
      *            CREATED CD-FEE-EARNINGS-FG                     LENDMARK #2542
      * JTG 051024 CORRECTED LOGIC FOR COMPUTING ADDON EARNINGS, WHEN ACCOUNT
      *            HAS NO ADDON BUT PREVIOUS ACCOUNT DID, ACCRUAL WAS PASSING
      *            ADDON EARNINGS TO ACCOUNT WITH NO ADDON.       LENDMARK #2542
      *  CS 060206 CORRECTED ABOVE #2542 ADDON EARNINGS PASSED TO NEXT ACCOUNT
      *            102405 FIX DID NOT ALWAYS MOVE ZERO TO ADDON [MULLEN]
      *  CS 080211 1098 INTEREST(LN-TOTINTPD) SHOULD ONLY BE INTEREST, NOT
      *            SERVICE AND MAINT FEE PR#617 ST.LOUIS
      *  CS 081107 ADDED TEST GP-INCL-OTH-IN-EARNED-R. IF 'R' EXCLUDE OTHER
      *            AND MAINTFEE(ANTICERN(4) FROM EARNED/UNEARNED REGACC P#210
      * BAH 090514 CHANGED A REFERENCE OF LN-OWNBR = 99 TO LN-OWNBR = 9999
      * BLM 100122 REMOVED RM-CMD FROM ACRERN.CMD, CHANGE TO REMOVE-WORKFILE
      *            LOGIC IN LIBGB/RMFILE & RM.CMD, NEED TO REMOVE .VIX FILES
      *  CS 100129 PER DISCUSSSION WITH JR,JUDY,LORI, LN/BW INTYTD SHOULD ONLY
      *            BE INTEREST. WHEN I MADE CHANGE #671 I MISSED CHANGING THE
      *            BORROWER RECORD  PR#671
      * BLM 100803 ADDED BACK READ OF LC BEFORE CHECKING LC-SERVACCT IN
      *            ACCRUE-IB SECTION.  IT WAS CHECKING THE SERVICE ACCT
      *            FLAG IN LCFILE WITHOUT READING LCFILE & PICKING UP
      *            FLAG FROM LAST ACCOUNT IN HEADING ROUTINE.  IF LAST
      *            CLASS FROM PREVIOUS REPORT WAS SERVICE ACCT CLASS,
      *            NO IB ACCOUNTS WOULD BE PROCESSED!  UNITED
      * BAH 110301 WHEN READ OF LC WAS ADDED BACK IN FROM ABOVE CHANGE, IT
      *            MESSED UP PAGE BREAK ON CLASS, CANT PERFORM GET-LC CAUSE
      *            IT MOVES TO HOLD-CLASS, JUST PERFORM READ-LC1-FILE
      *            ACE FINANCIAL, PL# 727
      * BAH 110907 EXPANDED WK3-CONTRACTUAL-STATUS AND IBE-CONT-STATUS, WAS
      *            TRUNCATING 1500, REGENCY REGWAN PL# 748
      *  CS 111014 ADD UPDATE OF ACCRUAL EARNINGS FILE IF GP-USE-ACCRUAL-EARN-
      *            FILE = Y. THE ACCRUAL WILL UPDATE THIS FILE. ON IB LOANS
      *            WILL READ FOR A RECORD FOR PRIOR MONTH AND UPDATE THE ACCRUED
      *            AMOUNT FROM LAST MONTH REC TO THIS MONTH TO AE-ACC-AMT-LMO.
      *            TO MAP TO GL, THIS AMOUNT WILL NEED TO BE REVERSED OUT JUST
      *            AS THE IB ACCRUAL PROCESS DOES   REGACC PR#299
      *  CS 120130 MOVED THE UPDATE OF THE AE IF INTEREST BEARING TO AFTER
      *            WRITE OF DETAIL-LINE.   REGACC PR#299
      *  ************COMMENT ONLY ON IB ACCRUAL W-MAX CALC**************
      *  CS 120529 REGENCY WAS QUESTIONING AN I.B. ACCRUAL AMOUNT THAT HAD
      *            INTEREST OWING, ACCRUAL WAS FOR APRIL 30TH, AND THE INTEREST
      *            PAID THRU IS 4/30/12.  WE TAKE LN-INTPDTH-DATE, INCREMENT SP-MAX-
      *            IB-ACR-DAYS(INCREMENT DAYS) TO COME UP WITH A THRU DATE. IN
      *            EXAMPLE SP-MAX-IB-ACR-DAYS IS 90 SO THRU DATE IS 7/29. THEN
      *            WHEN WE ARE CALCULATING W-MAX CHARGE, WE USE THE YEAR TYPE
      *           (360) IDENTIFIED IN SPR TO CALCULATE ELAPSED TIME BETWEEN THE
      *            4/30 - 7/29 AND ITS 89 DAYS NOT THE 90 DAYS CUSTOMER IS
      *            EXPECTING. PR#774
      *  121119 CS ADDDED TEST FOR LPAERN-ERNDELQ-STOP = "R" WORLD PR#828
      * BLM 130208 WORLD DOES NOT WANT TO GENERATE PL OR NONACC REPORTS, SO
      *            IF I AM WORLD: DON'T CALL AC2, DON'T CREATE PL-WX-REC,
      *            DONT'CRAETE-NON-WX-REC, DON'T CREATE WX IN TMP & DON'T
      *            OPEN, CLOSE, REMOVE WXFILE.  WORLD PR# 853
      *  CS 131022 FIXED THE CORRECT ACCRUAL DATE GOING TO LOAN RECORD
      *  CS 131205 IF GP-USE-ACCRUAL-EARN-FILE IS 'R' UPDATE THE LR-FILE AND
      *            AE-FILE WITH INTERNAL STOP/START ACCRUAL INFO.REGACC PR#347
      *  CS 140417 A30**FIXED TYPO ON OPEN-LR1-FILE WAS OPEN-LR1-1ILE
      *  CS 140429 A30 CHANGED RESERVED WORDS INT/DISC PREFACED BY WS-
      * BLM 140205 FIXED TO RUN IN BATCH PROCESSING, REGACC PR# 349
      *  CS 141215 FIXED BUG IF GP-LR-TRAILER-TRIAD IS 'Y' BUT GP-USE-ACCRUAL
      *            EARN-FILE WAS NOT 'Y' OR 'R' THE TRIAD FILE WAS NOT OPENED.
      *            IT WAS BEING OPENED WHERE USE-ACCRUAL-EARN-FILE WAS TESTED 
      *            INSTEAD OF WITHIN UPDATE-TRIAD-TRAILER SECTION. SUPPORT
      *                                                      PL869
      *   CS 150721 CHANGED WKRS-KEY (RVCALC) TO INCLUDE A SEQUENCE, NECESSARY
      *             FOR DUPLCIATE SPECIAL PROGRAM WKRS-KEY, ALSO ADDED WKRS-
      *             RT-SEQ   REGENCY PL887
      *  BAH 160125 REMOVED HOLD-LT-KEY, SEPARATE FILES NOW.
      *  BAH 160125 SPLIT OUT LTFILE, PD0003
      *   CS 160202 CHANGED WK-CLASS, WX-CLASS TO 9(3)
      *   CS 160223 CHANGED AE-YYMMDD TO AE-DATE
      *
      * KEC 2016.0309 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CD-GROUP, CD-SECURED & CD-TRW TO BE
      *         CD-CO-GROUP, CD-CO-SECURED & CD-CO-TRW.
      *  CS 160513 SET AE-BRNO FROM LN-OWNBR
      * KEC 2016.0914 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         SET LR-BRNO USING LN-OWNBR.
      * KEC 2016.1115 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED LTR-SEQNO TO LTR1-KEY.
      * KEC 2016.1209 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          CHANGED AE-DATE AS ACTIVE CCYYMMDD.
      *  CS 170118 LTR-PATH NOT SET UP, ADDED AN OPEN-LTR1-FILE AT END-ROUTINE
      *            WHICH THEN PERFORMS IB-ACCRUE.
      * BAH 170316 ACTIVATE 8 DIGIT DATES, PD0006
      * KEC 2017.0606 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          ADDED 'LN' FILE PREFIX FOR WORKING STORAGE FIELDS.
      * KEC 2018.0423 PR#00000 PARADATA A30 JAY & BETH
      *         REMOVED USE OF LOCAL-PRINT-FG SINCE NOT USED;
      *         LOCAL-PRINT-FG NOT BEING SET; IN EOBUF WHICH IS EXTERNAL
      *         WHERE IF NOT BEING SET WILL CAUSE ISSUES FROM THAT
      *         LOCAL-PRINT-FG BYTE POSITION COULD BE SET FROM PREVIOUS
      *         PROGRAM WITH EOBUF THAT SET SOMETHING IN THAT BYTE.
      *
      * KEC 2018.0426 PR#00000 PARADATA A30 JAY & BETH
      *         REMOVED USE OF ENT-GROUP AND/OR GROUP-FLAG.
      *         THIS WAS DONE IN RELATION TO THE EOBUF EXTERNAL ISSUE
      *         WHICH IF NOT BEING SET WILL CAUSE ISSUES FROM THOSE
      *         BYTE POSITIONS COULD BE SET FROM PREVIOUS
      *         PROGRAM WITH EOBUF THAT SET SOMETHING IN THOSE BYTES.
      * 181009  CHANGED MOVE OF SP-PATH TO SP-SELECT-PATH  
      * BAH 181203 GLOBAL BWFILE
      * BAH 181203 GLOBAL LNFILE, REMOVED AEFILE, SOMEONE MOVED ALL THE
      *            COPY MEMBERS BACK IN OCTOBER BUT NEVER COMMENTED THEM OUT
      *  CS 190103 GLOBAL LTIFILE, COMMENT LOCAL-LTI-PATH,LOCAL-LTP-PATH
      *            KEN AND I LOOKED AND COULDNT SEE IN USE
      *  CS 190111 GLOBAL LTI
      * KEC 2019-0131 CC32 - REMOVED THE REVOLVING CREDIT USAGE.
      * BAH 20190625 REMOVED LN-REVOLVING, PT0153
      * BAH 20190703 REMOVED LTR PT0150
      * BAH 20190709 REMOVED GP-LR-TRAILER-TRIAD, PT0151 
      * BAH 20190924 REMOVED ACCESS-CALL LNFILE, GB, BW, LTI, LTP, SP, LC
      * BAH 20211020 START-LN3-FILE NEEDED 0 TO LN-ACCTNO, CAUSED ERROR
      *              COMMENTED OUT START-LN3-FILE-GREATER TO REPOSITION!
      * RMZ 20231208 PERFORMANCE TUNING - ADDED STORED PROCEDURES
      * JKC 20240729 S35Q-100 FIXED ISSUE WHEN PASSING A DATE TO AN SSP
      *         THAT WHERE THE DATE IS A PIC X INSTEAD OF PIC 9 WHICH
      *         SENDS TO THE SSP A SUPPRESSED SINGLE DIGIT; FOR EXAMPLE,
      *         FOR A SINGLE DIGIT MONTH, A ' 6' INSTEAD OF '06' IS
      *         SENT TO THE SSP WHICH DOES NOT FIND THE ROWS EXPECTED.
      * RMZ 20240806 ADDED LTOUCH-DATE TO UPDATE SCRIPTS. (S35Q-108)
      *
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBGB/GBFSPR.CPY".
      *COPY "LIBLP/LPFSAE.CPY".
       COPY "LIBLP/LPFSVSP.CPY".
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           SELECT WK-FILE ASSIGN WK-BUF
                  ORGANIZATION INDEXED
                  ACCESS DYNAMIC
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  RECORD KEY WK1-KEY
                  ALTERNATE RECORD KEY WK2-KEY WITH DUPLICATES
                  FILE STATUS FILE-STAT.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           SELECT WX-FILE ASSIGN WX-BUF
                  ORGANIZATION INDEXED
                  ACCESS DYNAMIC
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  RECORD KEY WX1-KEY
                  FILE STATUS FILE-STAT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *CS
           SELECT WK3-FILE ASSIGN WK3-PATH
                  ORGANIZATION INDEXED
                  ACCESS DYNAMIC
                  LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                  RECORD KEY WK3-KEY
                  FILE STATUS FILE-STAT.

       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.
       COPY "LIBGB/GBFDPR.CPY".
      *COPY "LIBLP/LPFDAE.CPY".
       COPY "LIBLP/LPFDVSP.CPY".

      ******************************************************************
      *
      *    W O R K - F I L E (WK)
      *
      *-----------------------------------------------------------------
      *    SUMMARY TOTALS WORK RECORD
      ******************************************************************
       FD  WK-FILE
           LABEL RECORDS ARE STANDARD.

      *-----------------------------------------------------------------
       01  WK-REC.
           03  WK1-KEY.
               05  WK-BRANCH                       PIC 9(4).
               05  WK2-KEY.
                   07  WK-CLASS                    PIC 9(3).
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           03  WK-NOACCTS OCCURS 2                 PIC 9(6)      COMP-3.
           03  WK-UNEARN                           PIC S9(9)V99  COMP-3.
           03  WK-INT                              PIC S9(9)V99  COMP-3.
           03  WK-ADDON                            PIC S9(9)V99  COMP-3.
           03  WK-SRV                              PIC S9(9)V99  COMP-3.
           03  WK-MFEE                             PIC S9(9)V99  COMP-3.
           03  WK-DISC                             PIC S9(9)V99  COMP-3.
           03  WK-OTHER                            PIC S9(9)V99  COMP-3.
           03  WK-CASH-EARN                        PIC S9(9)V99  COMP-3.
           03  WK-ENDING                           PIC S9(9)V99  COMP-3.
           03  WK-ACCRUED                          PIC S9(9)V99  COMP-3.
           03  WK-INT-SINCE-LSTPY                  PIC S9(9)V99  COMP-3.
           03  WK-INTBAL                           PIC S9(9)V99  COMP-3.
           03  WK-TRUE-ACCRUE                      PIC S9(9)V99  COMP-3.

      ******************************************************************
      *
      *    W O R K - F I L E (WX)
      *
      *-----------------------------------------------------------------
      *    KEY FILE FOR NON ACCRUAL INCOME & PL UNEARNED REPORTS
      *        WX-TYPE:  N - NON ACCRUAL REPORT
      *                  P - P&L UNEARNED REPORT
      ******************************************************************
       FD  WX-FILE
           LABEL RECORDS ARE STANDARD.

      *-----------------------------------------------------------------
       01  WX-REC.
           03  WX1-KEY.
               05  WX-TYPE                        PIC X.
               05  WX-OWNBR                       PIC 9(4)       COMP-3.
               05  WX-CLASS                       PIC 9(3).
               05  WX-ACCTNO                      PIC 9(8)       COMP-3.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           03  WX-LN-NONACRERN                    PIC S9(9)V99   COMP-3.
           03  WX-LN-PRIOR-UNEARNED               PIC S9(9)V99   COMP-3.
           03  WX-EARNINGS-WORKERS.
               05  WX-EARN-TOT-ANTICERN           PIC S9(9)V99   COMP-3.
               05  WX-EARN-TOT-ANTICADJ           PIC S9(9)V99   COMP-3.
               05  WX-EARN-TOT-ACCERN             PIC S9(9)V99   COMP-3.
               05  WX-EARN-TOT-UFERN              PIC S9(9)V99   COMP-3.
               05  WX-EARN-TOT-UNEARN             PIC S9(9)V99   COMP-3.
               05  WX-EARN-UNEARN             OCCURS 6 TIMES
                                                  PIC S9(9)V99   COMP-3.
               05  WX-EARN                        PIC 9.


      ******************************************************************
      *
      *    W O R K - F I L E (WK3)
      *
      *-----------------------------------------------------------------
      *    KEY FILE FOR IB ACCRUAL EXCEPTIONS WHERE THE TRUE ACCRUED
      *             INTEREST IS GREATER THAN THE MAXIMUM ALLOWED PER
      *             SPR-MAX-IB-ACR-DAYS
      ******************************************************************
      *CS
       FD  WK3-FILE
           LABEL RECORDS ARE STANDARD.

      *-----------------------------------------------------------------
       01  WK3-REC.
           03  WK3-KEY.
               05  WK3-BRANCH                     PIC 9(5)       COMP-3.
                   88  WK3-GRAND-TOTALS               VALUE 99999.
               05  WK3-CLASS                      PIC 9(3)       COMP-3.
                   88  WK3-BRANCH-TOTALS              VALUE 999.
               05  WK3-ACCTNO                     PIC 9(8).
                   88  WK3-CLASS-TOTALS               VALUE 99999999.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           03  WK3-LNAME                          PIC X(16).
           03  WK3-FNAME                          PIC X(16).
           03  WK3-INT-PAID-THRU-DATE             PIC 9(8).
           03  WK3-INT-SINCE-LSTPY                PIC S9(9)V99  COMP-3.
           03  WK3-INT-OWED                       PIC S9(9)V99  COMP-3.
           03  WK3-TRUE-ACCRUE-AMOUNT             PIC S9(9)V99  COMP-3.
           03  WK3-INCOME-ACCRUE-AMOUNT           PIC S9(9)V99  COMP-3.
           03  WK3-BALANCE                        PIC S9(9)V99  COMP-3.
           03  WK3-CONTRACTUAL-PAID-THRU-DATE     PIC 9(8).
           03  WK3-CONTRACTUAL-STATUS             PIC 9(4).
           03  WK3-NUMBER-ACCTS                   PIC 9(7).

      ******************************************************************
      *
      *    W O R K I N G - S T O R A G E - S E C T I O N
      *
      ******************************************************************
       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(37) VALUE
           "@(#)LP/AC1ERN S35 01/29/25-11:30:48 >".
      *=================================================================
      *    F I L E - W O R K E R S
      *=================================================================
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".
       COPY "LIBGB/GB01GB.CPY".
       COPY "LIBGB/GB01GB_SQL.CPY".
       COPY "LIBGB/GBWSGB.CPY".

       COPY "LIBLP/LP01BW.CPY".
       COPY "LIBLP/LP01BW_SQL.CPY".
       COPY "LIBLP/LPWSBW.CPY".
       COPY "LIBLP/LP01CD.CPY".
       COPY "LIBLP/LP01CD_SQL.CPY".
       COPY "LIBLP/LPWSCD.CPY".
       COPY "LIBLP/LP01LC.CPY".
       COPY "LIBLP/LP01LC_SQL.CPY".
       COPY "LIBLP/LPWSLC.CPY".
       COPY "LIBLP/LP01LN.CPY".
       COPY "LIBLP/LP01LN_SQL.CPY".
       COPY "LIBLP/LPWSLN.CPY".
       COPY "LIBLP/LP01LTI.CPY".
       COPY "LIBLP/LP01LTI_SQL.CPY".
       COPY "LIBLP/LPWSLTI.CPY".
       COPY "LIBLP/LP01LTP.CPY".
       COPY "LIBLP/LP01LTP_SQL.CPY".
       COPY "LIBLP/LPWSLTP.CPY".
       COPY "LIBLP/LP01SP.CPY".
       COPY "LIBLP/LP01SPA.CPY".
       COPY "LIBLP/LP01SPB.CPY".
       COPY "LIBLP/LP01SPC.CPY".
       COPY "LIBLP/LP01SP_SQL.CPY".
       COPY "LIBLP/LPWSSP.CPY".
      *COPY "LIBLP/LPWSAE.CPY".

       COPY "LIBLP/LPWSVSP.CPY".

      * - - - - - - - - - - - - - - - - - - - - - - - - - -
      * THE FOLLOWING COPYS ARE FOR CALL TO RVCAL2.C
      * GLB 04/25/03 NOW USING RVCALCW NOT RVCALC2
      * THE FOLLOWING COPYS ARE FOR CALL TO RVCALC.C
      * - - - - - - - - - - - - - - - - - - - - - - - - - -
       COPY "LIBLP/LPWSDL.CPY".
       COPY "LIBLP/LPWSLP.CPY".

      * N O T E:       LOCAL-FILE-PATHS EXIST IN LP/RVNWUP.C
      *                SO IF YOU CHANGE THIS CHANGE LP/RVNWUP.C
      *01  LOCAL-FILE-PATHS.
      *    03  LOCAL-BW-PATH              PIC X(35).
      *    03  LOCAL-DL-PATH              PIC X(35).
      *    03  LOCAL-LP-PATH              PIC X(35).
      *-----------------------------------------------------------------
       01  PR-IFN                              PIC X(02)   VALUE "PR".
       01  WK-BUF                              PIC X(35)   VALUE SPACES.
       01  WK3-PATH                            PIC X(35)   VALUE "WK3".
       01  WK1-IFN                             PIC X(03)   VALUE "WK1".
       01  WK2-IFN                             PIC X(03)   VALUE "WK2".
       01  WX-BUF                              PIC X(35)   VALUE SPACES.
       01  WX1-IFN                             PIC X(03)   VALUE "WX1".
       01  WK3-IFN                             PIC X(3)    VALUE "WK3".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.            
       01  QWS-END-YEAR         PIC X(2).             
       01  QWS-END-MONTH        PIC X(2).                   
       01  QWS-LTI-ROWCOUNT     PIC 9(9)     VALUE 0.
       EXEC SQL END DECLARE SECTION END-EXEC.

       01  LN3-CONN-OPEN-SW1    PIC X        VALUE "N".
       01  LN3-CONN-OPEN-SW2    PIC X        VALUE "N". 

       01  WS-END-MMYY.
           03  WS-END-YEAR         PIC 9(2).
           03  WS-END-YEAR-A REDEFINES WS-END-YEAR
                                   PIC X(2).
           03  WS-END-MONTH        PIC 9(2).
           03  WS-END-MONTH-A REDEFINES WS-END-MONTH
                                   PIC X(2).

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
       01  Z-ADDON                   PIC 9(7).99-  VALUE ZEROES.
       01  Z-WS-INT                  PIC 9(7).99-  VALUE ZEROES.
       01  Z-BW-INTYTD               PIC 9(7).99-  VALUE ZEROES.
       01  Z-BW-RE-INTYTD            PIC 9(7).99-  VALUE ZEROES.
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      *=================================================================
      *
      *    M I S C E L L A N E O U S - W O R K E R S
      *
      *=================================================================
       01  ACCRUED                 PIC S9(7)V99  COMP VALUE ZEROES.
       01  ADDON                   PIC S9(7)V99  COMP VALUE ZEROES.
       01  ADDON-EARNINGS          PIC S9(7)V99  COMP VALUE ZEROES.
       01  WS-DISC                 PIC S9(7)V99  COMP VALUE ZEROES.
       01  EARNED                  PIC S9(7)V99  COMP VALUE ZEROES.
       01  ENDING                  PIC S9(7)V99  COMP VALUE ZEROES.
       01  ENDING-INT              PIC S9(6)V99  COMP VALUE ZEROES.
       01  WS-INT                  PIC S9(7)V99  COMP VALUE ZEROES.
       01  INT-SINCE-LSTPY         PIC S9(7)V99  COMP VALUE ZEROES.
       01  INTBAL                  PIC S9(7)V99  COMP VALUE ZEROES.
       01  MFEE                    PIC S9(7)V99  COMP VALUE ZEROES.
       01  SRV                     PIC S9(7)V99  COMP VALUE ZEROES.
       01  TRUE-ACCRUE             PIC S9(7)V99  COMP VALUE ZEROES.
       01  UNEARN                  PIC S9(7)V99  COMP VALUE ZEROES.
       01  W-OTHER                 PIC S9(7)V99  COMP VALUE ZEROES.
       01  WK-WORKER               PIC S9(7)V99  COMP VALUE ZEROES.

      *-----------------------------------------------------------------
       01  BR-TOTALS                   PIC X(01)     VALUE "N".
       01  COMPUTE-EARNINGS-DONE       PIC X(01)     VALUE SPACES.

      *-----------------------------------------------------------------
       01  END-DATE-MMYY               PIC 9(04)     VALUE ZEROES.
       01  FILLER                      REDEFINES END-DATE-MMYY.
           03  END-MONTH               PIC 9(02).
           03  END-YEAR                PIC 9(02).

      *-----------------------------------------------------------------
       01  HALT-LN-ACCTNO              PIC 9(8)      VALUE 0.
       01  FIRST-NAME                  PIC X(16)     VALUE SPACES.
       01  FIRST-TIME                  PIC X(01)     VALUE "Y".
       01  FIRST-TIME-MKTEMP-AC1DAY    PIC X(01)     VALUE "Y".
       01  FIRST-TIME-WX               PIC X(01)     VALUE "Y".
       01  HOLD-LN-COUNT               PIC 9(2)      VALUE ZEROS.
       01  HOLD-LN-CLASS               PIC 9(3)      VALUE ZEROES.
       01  HOLD-LN-INTPDTH-DATE        PIC 9(8)      VALUES ZEROS.

       01  HOLD-WK3-KEY.
           03  HOLD-WK3-BRANCH                PIC 9(5)       COMP-3.
               88  HOLD-WK3-GRAND-TOTALS         VALUE 99999.
           03  HOLD-WK3-CLASS                 PIC 9(3)       COMP-3.
               88  HOLD-WK3-BRANCH-TOTALS              VALUE 999.
           03  HOLD-WK3-ACCTNO                PIC 9(8).
               88  HOLD-WK3-CLASS-TOTALS          VALUE 99999999.

       01  HOLD-SP-MAX-IB-ACR-DAYS     PIC 9(03)     VALUE ZEROES.

       01  IB-FLAG                     PIC X(01)     VALUE "Y".

       01  LAST-DATE-MMYY              PIC 9(04)     VALUE ZEROES.
       01  FILLER                      REDEFINES LAST-DATE-MMYY.
           03  LAST-MONTH              PIC 9(02).
           03  LAST-YEAR               PIC 9(02).

      *-----------------------------------------------------------------
       01  LEV                         PIC 9(06)     COMP VALUE ZEROES.
       01  MESS-LIST                   PIC X(05)     VALUE "MESS.".

      *-----------------------------------------------------------------
       01  MONTH-DATE                  PIC 9(08)     VALUE ZEROES.

      *-----------------------------------------------------------------
       01  MONTH-END-DATE              PIC 9(08)     VALUE ZEROES.
       01  MSEL-BUF                    PIC X(70)     VALUE SPACES.
       01  MSEL-LIST                   PIC X(05)     VALUE "MSEL.".
       01  NAME-WORKER                 PIC X(34)     VALUE SPACES.
       01  ONE                         PIC S9(1)     VALUE ZEROES.
       01  PROCESSING-PROGRAM          PIC X(06)     VALUE "AC1DAY".

      *-----------------------------------------------------------------
       01  SAVE-PLCD                   PIC X(02)     VALUE SPACES.
       01  SAVE-PLDATE                 PIC 9(08)     VALUE ZEROES.
       01  SUB                         PIC 9(06)     COMP VALUE ZEROES.
       01  SUMMARY-FG                  PIC X(01)     VALUE "N".

      *-----------------------------------------------------------------
       01  W-LOAN-NUM.
           03  FILLER                  PIC X(03)     VALUE SPACES.
           03  LOAN-NUM                PIC X(13)     VALUE SPACES.

      *-----------------------------------------------------------------
       01  W-MAX                       PIC S9(9)V99  COMP  VALUE ZEROES.

      *----------------------------------------------------------------
       01  SUM-ONLY                    PIC X           VALUE "N".
       01  FIRST-TIME-PRINT-IB-EXCEPTIONS PIC X        VALUE "Y".
       01  IB-EXCEPTION-HEAD-PRINT-FG     PIC X        VALUE "N".
      *01  NORMAL-IB-FG                PIC X           VALUE " ".

      *=================================================================
      *
      *    T O T A L S - T A B L E - W O R K E R S
      *
      *-----------------------------------------------------------------
      *    TOTALS SUB 1 = CLASS
      *               2 = BRANCH
      *=================================================================
       01  TOTALS-TABLE.
           03  TOTAL-TBL               OCCURS 2.
               05  T-ACCRUED           PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-ADDON             PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-CASH-EARN         PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-DISC              PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-ENDING            PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-INT               PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-INT-SINCE-LSTPY   PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-INTBAL            PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-MFEE              PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-NOACCTS           PIC 9(06)     COMP  VALUE ZEROES.
               05  T-OTHER             PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-SRV               PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-TRUE-ACCRUE       PIC S9(9)V99  COMP  VALUE ZEROES.
               05  T-UNEARN            PIC S9(9)V99  COMP  VALUE ZEROES.

      ******************************************************************
      *
      *    S C R E E N - W O R K E R S
      *
      ******************************************************************
       COPY "LIBGB/EOBUF_EXT.CPY".
      *-----------------------------------------------------------------
           03  BEG-BRANCH              PIC 9(04).
           03  END-BRANCH              PIC 9(04).
           03  EOM-DATE                PIC 9(08).

      *=================================================================
      *
      *    S C R E E N - W O R K E R S
      *
      *=================================================================
       01  DISPLAY-MESS.
           03  FILLER                  PIC X(16)     VALUE
                                                     "IN PROGRESS.....".
           03  DISPLAY-MESS-BR         PIC 9(04).
           03  FILLER                  PIC X(01)     VALUE SPACES.
           03  DISPLAY-MESS-CL         PIC 9(02)     BLANK ZEROES.
           03  FILLER                  PIC X(01)     VALUE SPACES.
           03  DISPLAY-MESS-LN         PIC 9(06)     BLANK ZEROES.

       01  DISPLAY-LIST                PIC X(06)     VALUE "MESSX.".

      *-----------------------------------------------------------------

      *-----------------------------------------------------------------
      *01  PRU-BUF.
      *    03  Q-BUF        PIC X(01)         VALUE SPACES.
      *    03  C-BUF        PIC X(01)         VALUE SPACES.
      *    03  P-BUF        PIC X(02)         VALUE SPACES.
      *
      *01  PRU-LIST         PIC X(17)         VALUE "QUEUE COPIES PRU.".
      *
      *-----------------------------------------------------------------
      *01  SCREEN-BUF                  VALUE SPACES.
      *    03  CONAME                  PIC X(40).
      *    03  SYSDATE                 PIC X(08).
      *    03  USERID.
      *        05  FILLER              PIC X(01).
      *        05  USER-BRANCH         PIC 9(04).
      *        05  USER-NAME           PIC X(05).
      *    03  EXT-CONAME-RPT-LINES            PIC 9(02).
      *
      *01  SCREEN-LIST.
      *    03  FILLER PIC X(29) VALUE "CONAME SYSDATE USERID RPTLNS.".
      *
      ******************************************************************
      *
      *    P R I N T - W O R K E R S
      *
      ******************************************************************
       01  PRINT-LINE-WORKERS.
           03  LN-COUNT                PIC 9(03)     VALUE 99.
           03  LN-FEED                 PIC 9(02)     VALUE ZEROES.
           03  PAGE-NUMBER             PIC 9(04)     VALUE ZEROES.

       01  PRINT-PATH.
           03  PRINT-ALL-BASE          PIC X(09).
           03  FILLER                  PIC X(01)     VALUE "/".
           03  PRINT-ALL-MACHINE       PIC X(02)     VALUE SPACES.
           03  FILLER                  PIC X(01)     VALUE "/".
           03  PRINT-ALL-DATA          PIC X(06)     VALUE SPACES.
           03  PRINT-ALL-PATH          PIC X(07)     VALUE "/ED/ACR".
           03  PRINT-ENDDATE           PIC 9(04)     VALUE ZEROES.
           03  PRINT-ID                PIC X(01)     VALUE SPACES.
           03  FILLER                  PIC X(01)     VALUE ".".
           03  PRINT-DESC              PIC X(08)     VALUE " ".

      *=================================================================
      *
      *    H E A D E R - W O R K E R S
      *
      *=================================================================
       01  HEAD1.
           03  H-DATE                     PIC X(08) VALUE SPACES.
           03  FILLER                     PIC X(02) VALUE SPACES.
           03  H-HR                       PIC 9(02) VALUE ZEROES.
           03  FILLER                     PIC X(01) VALUE ":".
           03  H-MIN                      PIC 9(02) VALUE ZEROES.
           03  FILLER                     PIC X(30) VALUE SPACES.
           03  H-NAME                     PIC X(40) VALUE SPACES.
           03  FILLER                     PIC X(38) VALUE SPACES.
           03  FILLER                     PIC X(05) VALUE "PAGE ".
           03  H-PAGE-NO                  PIC ZZZ9.

      *-----------------------------------------------------------------
       01  HEAD2.
           03  FILLER                      PIC X(10)  VALUE "USER ID:".
           03  H-USERID                    PIC X(10)  VALUE SPACES.
           03  FILLER                      PIC X(17)  VALUE SPACES.
           03  H-TITLE                     PIC X(35)  VALUE
                                  "UNEARNED / EARNED ACCRUAL REPORT   ".
           03  H-DAY-OR-MONTH              PIC X(05)  VALUE "MONTH".
           03  FILLER                      PIC X(09)  VALUE " ENDING: ".
           03  H-ENDDATE                   PIC X(08).
           03  H-MESS                      PIC X(38)  VALUE SPACES.

      *-----------------------------------------------------------------
       01  HEAD3.
           03  FILLER                     PIC X(08) VALUE "BRANCH :".
           03  FILLER                     PIC X(02) VALUE SPACES.
           03  H-BRNO                     PIC 9(04) VALUE ZEROES.
           03  H-BRNOX                    REDEFINES H-BRNO
                                          PIC X(04).
           03  FILLER                     PIC X(01) VALUE SPACES.
           03  H-BRDESC                   PIC X(20) VALUE SPACES.
           03  FILLER                     PIC X(97) VALUE SPACES.

      *-----------------------------------------------------------------
       01  HEAD4.
           03  FILLER                     PIC X(08) VALUE "CLASS  :".
           03  FILLER                     PIC X(02) VALUE SPACES.
           03  H-LCNO                     PIC 9(02) VALUE ZEROES.
           03  FILLER                     PIC X(01) VALUE SPACES.
           03  H-LCDESC                   PIC X(20) VALUE SPACES.
           03  FILLER                     PIC X(81) VALUE SPACES.
           03  H-CLRIT                    PIC X(07) VALUE "MTD-NON".
           03  FILLER                     PIC X(11) VALUE SPACES.
      *----------------------------------------------------------------
       01  ORIGINAL-HEAD5-AC1DAY           PIC X(132).
       01  ORIGINAL-HEAD5-AC1ERN           PIC X(132).
       01  ORIGINAL-HEAD6                  PIC X(132).
      *-----------------------------------------------------------------
       01  HEAD5-AC1DAY.
           03  FILLER                      PIC X(29)   VALUE SPACES.
           03  FILLER                      PIC X(30)   VALUE
                       "ANTICIPATED      BEGIN   -----".
           03  FILLER                      PIC X(46)   VALUE
                       "----------- DAILY ACCRUAL EARNINGS -----------".
           03  FILLER                      PIC X(28)   VALUE
                       "-----    ACCRUAL    ENDING  ".

      *-----------------------------------------------------------------
       01  HEAD5-AC1ERN.
           03  FILLER                      PIC X(29)   VALUE SPACES.
           03  FILLER                      PIC X(30)   VALUE
                       "ANTICIPATED      BEGIN   -----".
           03  FILLER                      PIC X(46)   VALUE
                       "---------- MONTHLY ACCRUAL EARNINGS ----------".
           03  FILLER                      PIC X(28)   VALUE
                       "-----    ACCRUAL    ENDING  ".

      *-----------------------------------------------------------------
       01  HEAD6.
           03  FILLER                     PIC X(28) VALUE
                                         "ACCOUNT NO.   BORROWER      ".

           03  FILLER                     PIC X(45) VALUE
                        "TERM EARNINGS  UNEARNED  INTEREST    ADDONS  ".

           03  HEAD6-2.
               05  FILLER                 PIC X(30) VALUE
                                       "  SERCHG  MAINTFEE   DL DISC  ".

               05  FILLER                 PIC X(28) VALUE
                                         "   OTHER  EARNINGS  UNEARNED".

      *-----------------------------------------------------------------
       01  IB-HEAD2.
           03  IB-TITLE                   PIC X(49) VALUE
                    "ACCRUED INTEREST FOR I/B LOANS     MONTH ENDING: ".

           03  IB-MESS                    PIC X(38) VALUE
                               "     * - EXCEEDS MAX ACCRUE DAYS      ".

      *-----------------------------------------------------------------
       01  IB-HEAD5.
           03  FILLER                     PIC X(29) VALUE SPACES.
           03  FILLER                     PIC X(48) VALUE
                 "               ACCRUED     ACCRUED FROM    +    ".
           03  FILLER                     PIC X(43) VALUE
                  " INTEREST     =        TRUE         ACCRUED".

      *--------------------------------------------------------------
       01 IB-HEAD5-IBE.
           03  FILLER                     PIC X(29) VALUE SPACES.
           03  FILLER                     PIC X(50) VALUE
                     "         ACRRUED    ACCRD FROM     INTEREST".
           03  FILLER                     PIC X(48) VALUE
              "  TRUE      ACCRUED                CONTRACT    C".
           03  FILLER                     PIC X(5) VALUE
             "ONT  ".

      *-----------------------------------------------------------------
       01  IB-HEAD6.
           03  FILLER                     PIC X(29) VALUE
                                         "ACCOUNT NO.   BORROWER      ".
           03  FILLER                     PIC X(48) VALUE
                 "                  FROM     LAST ASSESSED        ".
           03  FILLER                     PIC X(43) VALUE
                       "     OWED          ASSESSED          AMOUNT".

      *-------------------------------------------------------------
      *CS
       01 IB-HEAD6-IBE.
           03  FILLER                     PIC X(29) VALUE
                                         "ACCOUNT NO.   BORROWER      ".
           03  FILLER                     PIC X(31) VALUE
                     "         FROM        LAST ASSD ".
           03  FILLER                     PIC X(39) VALUE
                             "        OWED         ASSD       AMOUNT ".
           03  FILLER                     PIC X(33) VALUE
                             "     BALANCE  PAID THRU  STATUS  ".
      *-----------------------------------------------------------------
       01  IB-SUMMARY2.
           03  FILLER                     PIC X(32) VALUE SPACES.
           03  FILLER                     PIC X(36) VALUE
                                 "      TOTAL ACCRUED            TOTAL".
           03  FILLER                     PIC X(36) VALUE
                                 "       TOTAL TRUE      TOTAL ACCRUED".

      *-----------------------------------------------------------------
       01  IB-SUMMARY3.
           03  FILLER                     PIC X(32) VALUE
                                     "CLASS               ACCTS       ".
           03  FILLER                     PIC X(36) VALUE
                                 " FROM LAST ASSESSED         INT OWED".
           03  FILLER                     PIC X(36) VALUE
                                 "         ASSESSED             AMOUNT".

      *-----------------------------------------------------------------
       01  SUMMARY1.
           03  FILLER                     PIC X(11) VALUE "* SUMMARY *".
           03  FILLER                     PIC X(100) VALUE SPACES.
           03  S-CLRIT                    PIC X(07) VALUE "MTD-NON".

      *-----------------------------------------------------------------
       01  SUMMARY2-AC1DAY.
           03  FILLER                      PIC X(19)   VALUE SPACES.
           03  FILLER                      PIC X(14)   VALUE
                                                       "NO      BEGIN ".
           03  FILLER                      PIC X(44)   VALUE
                         "      --------------------- DAILY ACCRUAL EA".
           03  FILLER                      PIC X(32)   VALUE
                         "RNINGS --------------------- ".
           03  FILLER                      PIC X(22)   VALUE
                         "   ACCRUAL      ENDING".

      *-----------------------------------------------------------------
       01  SUMMARY2-AC1ERN.
           03  FILLER                      PIC X(19)   VALUE SPACES.
           03  FILLER                      PIC X(14)   VALUE
                                                       "NO      BEGIN ".
           03  FILLER                      PIC X(44)   VALUE
                         "      -------------------- MONTHLY ACCRUAL E".
           03  FILLER                      PIC X(32)   VALUE
                         "ARNINGS -------------------- ".
           03  FILLER                      PIC X(22)   VALUE
                         "   ACCRUAL      ENDING".

      *-----------------------------------------------------------------
       01  SUMMARY3.
           03  FILLER PIC X(32) VALUE
                                     "CLASS           ACCTS   UNEARNED".
           03  FILLER PIC X(52) VALUE
                 "     INTEREST      ADDONS      SERCHG    MAINTFEE   ".
           03  FILLER PIC X(47) VALUE
                      "   DL DISC       OTHER    EARNINGS     UNEARNED".

      *=================================================================
      *
      *    D E T A I L - L I N E
      *
      *=================================================================
       01  DETAIL-LINE                        PIC X(132)   VALUE SPACES.

      *-----------------------------------------------------------------
       01  D-LINE1                            REDEFINES DETAIL-LINE.
           03  D-LOAN-NUM                     PIC X(13).
           03  FILLER                         PIC X(01).
           03  D-BWNAME                       PIC X(13).
           03  FILLER                         PIC X(01).

           03  ANTIC-REPORT.
               05  D-ANTERM                   PIC ZZ9        BLANK ZERO.
               05  FILLER                     PIC X(01).
               05  D-ANTIC                    PIC Z(05)9.99- BLANK ZERO.
               05  D-UNEARN                   PIC Z(05)9.99- BLANK ZERO.
               05  D-INT                      PIC Z(05)9.99- BLANK ZERO.
               05  D-ADDON                    PIC Z(05)9.99- BLANK ZERO.
               05  D-SRV                      PIC Z(05)9.99- BLANK ZERO.
               05  D-MFEE                     PIC Z(05)9.99- BLANK ZERO.
               05  D-DISC                     PIC Z(05)9.99- BLANK ZERO.
               05  D-OTHER                    PIC Z(05)9.99- BLANK ZERO.
               05  D-CASH-EARN                PIC Z(05)9.99- BLANK ZERO.
               05  D-ENDING                   PIC Z(05)9.99- BLANK ZERO.

           03  IB-REPORT                      REDEFINES ANTIC-REPORT.
               05  FILLER                     PIC X(15).
               05  D-FROM                     PIC 99/99/99.
               05  FILLER                     PIC X(05).
               05  D-INT-SINCE-LSTPY          PIC Z,ZZZ,ZZ9.99-.
               05  FILLER                     PIC X(05).
               05  D-INTBAL                   PIC Z,ZZZ,ZZ9.99-.
               05  FILLER                     PIC X(05).
               05  D-TRUE-ACCRUE              PIC Z,ZZZ,ZZ9.99-.
               05  FILLER                     PIC X(05).
               05  D-ACCRUED                  PIC ZZZ,ZZ9.99-.
               05  FILLER                     PIC X(03).
               05  D-MAX                      PIC X(01).

           03  IB-EXCEPTION-REPORT             REDEFINES ANTIC-REPORT.
               05  FILLER                     PIC X(10).
               05  IBE-INTEREST-PDTH-DT       PIC 99/99/99.
               05  FILLER                     PIC X(1).
               05  IBE-INT-SINCE-LSTPY        PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  IBE-INT-OWED               PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  IBE-TRUE-ACCRUE            PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(3).
               05  IBE-INCOME-ACCRUE          PIC ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  IBE-BALANCE                PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(3).
               05  IBE-CONT-PDTH-DT           PIC 99/99/99.
               05  FILLER                     PIC X(4).
               05  IBE-CONT-STATUS            PIC ZZZ9.
               05  FILLER                     PIC X(02).


      *-----------------------------------------------------------------
       01  CLASS-TOTAL                        REDEFINES DETAIL-LINE.
           03  D-TAG                          PIC X(25).
           03  D-T-NOACCTS-T                  PIC Z(05)9.
           03  D-T-TAG-T                      PIC X(01).
           03  FILLER                         PIC X(07).

           03  D-T-ANTIC.
               05  D-T-UNEARN-T               PIC Z(08)9.99- BLANK ZERO.
               05  FILLER                     PIC X(07).
               05  D-T-ADDON-T                PIC Z(08)9.99- BLANK ZERO.
               05  FILLER                     PIC X(07).
               05  D-T-MFEE-T                 PIC Z(08)9.99- BLANK ZERO.
               05  FILLER                     PIC X(07).
               05  D-T-OTHER-T                PIC Z(08)9.99- BLANK ZERO.
               05  FILLER                     PIC X(07).
               05  D-T-ENDING-T               PIC Z(08)9.99- BLANK ZERO.

           03  D-T-IB                         REDEFINES D-T-ANTIC.
               05  FILLER                     PIC X(16).
               05  D-T-INT-SINCE-LSTPY-T      PIC ZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(04).
               05  D-T-INTBAL-T               PIC ZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(04).
               05  D-T-TRUE-ACCRUE-T          PIC ZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(01).
               05  D-T-ACCRUED-T              PIC ZZZ,ZZZ,ZZ9.99-.

           03  D-T-IB-EXCEPTION-REPORT    REDEFINES D-T-ANTIC.
               05  FILLER                     PIC X(08).
               05  D-T-IBE-INT-SINCE-LSTPY    PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(01).
               05  D-T-IBE-INT-OWED           PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  D-T-IBE-TRUE-ACCRUE        PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  D-T-IBE-INCOME-ACCRUE      PIC Z,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(1).
               05  D-T-IBE-BALANCE            PIC Z,ZZZ,ZZ9.99.

      *-----------------------------------------------------------------
       01  CLASS-TOTAL-2                      REDEFINES DETAIL-LINE.
           03  FILLER                         PIC X(49).
           03  D-T-INT-T                      PIC Z(08)9.99- BLANK ZERO.
           03  FILLER                         PIC X(07).
           03  D-T-SRV-T                      PIC Z(08)9.99- BLANK ZERO.
           03  FILLER                         PIC X(07).
           03  D-T-DISC-T                     PIC Z(08)9.99- BLANK ZERO.
           03  FILLER                         PIC X(07).
           03  D-T-CASH-EARN-T                PIC Z(08)9.99- BLANK ZERO.

      *-----------------------------------------------------------------
       01  TOTAL-LINE                         REDEFINES DETAIL-LINE.
           03  D-T-DESC                       PIC X(20).

           03  FILLER                         REDEFINES D-T-DESC.
               05  FILLER                     PIC X(03).
               05  D-T-CLASS                  PIC 9(02).
               05  FILLER                     PIC X(08).
               05  D-T-NOACCTS                PIC Z(05)9.
               05  D-T-TAG                    PIC X(01).

           03  D-T-ANT.
               05  D-T-UNEARN                 PIC Z(08)9.99- BLANK ZERO.
               05  D-T-INT                    PIC Z(08)9.99- BLANK ZERO.
               05  D-T-ADDON                  PIC Z(07)9.99- BLANK ZERO.
               05  D-T-SRV                    PIC Z(07)9.99- BLANK ZERO.
               05  D-T-MFEE                   PIC Z(07)9.99- BLANK ZERO.
               05  D-T-DISC                   PIC Z(08)9.99- BLANK ZERO.
               05  D-T-OTHER                  PIC Z(07)9.99- BLANK ZERO.
               05  D-T-CASH-EARN              PIC Z(07)9.99- BLANK ZERO.
               05  D-T-ENDING                 PIC Z(08)9.99- BLANK ZERO.

           03  D-T-INTR                       REDEFINES D-T-ANT.
               05  FILLER                     PIC X(13).
               05  D-T-INT-SINCE-LSTPY        PIC ZZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(03).
               05  D-T-INTBAL                 PIC ZZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(03).
               05  D-T-TRUE-ACCRUE            PIC ZZZ,ZZZ,ZZ9.99.
               05  FILLER                     PIC X(05).
               05  D-T-ACCRUED                PIC ZZZ,ZZZ,ZZ9.99.


      ******************************************************************
      *
      *    C O P Y - L I B R A R Y - W O R K E R S
      *
      ******************************************************************

       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBGB/DACCESSW.CPY".
       COPY "LIBGB/AGEINGW.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBGB/GETENVW.CPY".
       COPY "LIBGB/GETPRW.CPY".
       COPY "LIBGB/GPENVW.CPY".
       COPY "LIBGB/MKTEMPW_CMD.CPY".
       COPY "LIBGB/RBACTW.CPY".
       COPY "LIBGB/REBATEW.CPY".
       COPY "LIBGB/PASSWDW.CPY".
       COPY "LIBGB/SCREENW.CPY".
       COPY "LIBGB/SPPDTHW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/MESSWK.CPY".
       COPY "LIBGB/SYSTEMW.CPY".
       COPY "LIBLP/LPAERNW.CPY".
       COPY "LIBLP/LPAMTSW.CPY".
       COPY "LIBLP/LPAPRSW.CPY".
       COPY "LIBLP/LPAPRZW.CPY".
       COPY "LIBLP/LPCEPPW.CPY".
       COPY "LIBLP/LPCERNW.CPY".
       COPY "LIBLP/LPEADJW.CPY".
       COPY "LIBLP/LPEARNW.CPY".
       COPY "LIBLP/LPIBPCW.CPY".
       COPY "LIBLP/LPITRMW.CPY".
       COPY "LIBLP/LPMDTEW.CPY".
       COPY "LIBLP/LPPDUEW.CPY".
       COPY "LIBLP/LPRATEW.CPY".
       COPY "LIBLP/LPREGZW.CPY".
       COPY "LIBLP/LPSTATW.CPY".
       COPY "LIBLP/LPUERNW.CPY".
       COPY "LIBLP/LPUPERW.CPY".
       COPY "LIBLP/LPUPWKW.CPY".
       COPY "LIBLP/LPXDTEW.CPY".
       COPY "LIBLP/RANGE_CMD.CPY".
       COPY "LIBLP/SETCTBLW.CPY".
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBLP/ARRAYSPW.CPY".
       COPY "LIBLP/ARRAYLCW.CPY".   
       COPY "LIBGB/HELPLINK.CPY".
       COPY "LIBGB/PRU_LNK.CPY".

      ******************************************************************
      *
      *    L I N K A G E - S E C T I O N
      *
      ******************************************************************
       COPY "LIBGB/GETFMW.CPY".
      *-----------------------------------------------------------------
       01  IB-ACCRUALS-DONE          PIC X(01).

       01  AC1-WORKER.
           03  HOLD-BR               PIC 9(04).
           03  HOLD-DATE-MMYY        PIC 9(04).
           03  XWK-BUF               PIC X(35).
           03  XWT-BUF               PIC X(35).
           03  XWKSP-PATH            PIC X(35).
           03  WX-RUNTYPE            PIC X(01).

      ******************************************************************
      *
      *    P R O C E D U R E - D I V I S I O N
      *
      ******************************************************************
       PROCEDURE DIVISION
            USING FORM-PATHNAME IB-ACCRUALS-DONE AC1-WORKER
                  EXIT-PATHNAME.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
                 WK-FILE WX-FILE WK3-FILE VSP-FILE PR-FILE.
       COPY "LIBGB/DECLRP.CPY".
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-LTP1-FILE.
           PERFORM CLOSE-LTI1-FILE.
           PERFORM CLOSE-LN3-FILE.
           PERFORM CLOSE-LN3-CONNECTION.
           PERFORM CLOSE-LN1-FILE.
           PERFORM CLOSE-LC1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-BR-FILE.
      *    PERFORM SQL-CLOSE-UPDATE-CONNECTION.
           PERFORM CLOSE-PR-FILE.
           CLOSE WK-FILE WX-FILE VSP-FILE WK3-FILE.
       COPY "LIBGB/DECLRP2.CPY".

      ******************************************************************
      *
      *    M A I N - P R O G R A M
      *
      ******************************************************************
       MAIN-PROGRAM SECTION.

           PERFORM SQL-CONNECT.

      D    STOP MESS.

           PERFORM INITIALIZATION-AC1ERN.

           PERFORM PRIMARY-DRIVER-MODULE.

       MAIN-PROGRAM-EXIT.
           GO TO END-PROGRAM.

      ******************************************************************
       INITIALIZATION-AC1ERN SECTION.
      ******************************************************************

           MOVE "AC1ERN" TO PROCESSING-PROGRAM.
           MOVE HEAD5-AC1DAY TO ORIGINAL-HEAD5-AC1DAY.
           MOVE HEAD5-AC1ERN TO ORIGINAL-HEAD5-AC1ERN.
           MOVE HEAD6        TO ORIGINAL-HEAD6.

           PERFORM OPEN-BR-FILE.
           PERFORM OPEN-SP1-FILE.
           PERFORM OPEN-LC1-FILE.
           PERFORM OPEN-CD1-FILE.

      D    STOP XWKSP-PATH.
           MOVE XWKSP-PATH TO VSP-PATH.
           PERFORM CREATE-VSP-FILE.
           MOVE VSP-PATH   TO XWKSP-PATH.

       INITIALIZATION-AC1ERN-EXIT.
           EXIT.

      ******************************************************************
       PRIMARY-DRIVER-MODULE SECTION.
      ******************************************************************

           MOVE FORM-PATHNAME TO FORM-PATH.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE "MONTH" TO H-DAY-OR-MONTH
              MOVE "N"     TO SUM-ONLY
           ELSE
              MOVE "  DAY" TO H-DAY-OR-MONTH.

           MOVE ORIGINAL-HEAD5-AC1DAY TO HEAD5-AC1DAY.
           MOVE ORIGINAL-HEAD5-AC1ERN TO HEAD5-AC1ERN.
           MOVE ORIGINAL-HEAD6        TO HEAD6.

           MOVE HOLD-BR TO BR-NO.
           PERFORM READ-BR-FILE.
           IF ( IO-BAD )
              GO TO IO-ERROR.

           MOVE EXT-FILPATH-BASE           TO FILPATH-BASE
                                              PRINT-ALL-BASE.
           MOVE BR-MACHINE                 TO FILPATH-MACHINE
                                              PRINT-ALL-MACHINE.
           MOVE BR-DATA-PATH               TO FILPATH-DATA
                                              PRINT-ALL-DATA.

           MOVE "B"                        TO BW-PATH-OVERRIDE
                                              GB-PATH-OVERRIDE
                                              LN-PATH-OVERRIDE
                                              LTI-PATH-OVERRIDE
                                              LTP-PATH-OVERRIDE.

           MOVE BR-NO TO DISPLAY-MESS-BR.

           PERFORM GET-GPENV.

      *    PERFORM OPEN-GB-FILE.
      *    MOVE BR-NO TO GB-BRNO.
      *    MOVE 1     TO GB-NO.
      *    PERFORM READ-GB-FILE.
      *    IF ( IO-BAD )
      *       GO TO IO-ERROR.
      *    PERFORM CLOSE-GB-FILE.

      *    MOVE GB-LAST-ACCRUE TO LAST-DATE-MMYY.
           MOVE HOLD-DATE-MMYY TO END-DATE-MMYY.
           MOVE XWK-BUF TO WK-BUF.

       RETRY-INIT.

           PERFORM INITIALIZATION.
           IF ( EXT-EOBUF-ERRCD = "X" )
              MOVE "MONTH IS NOT CURRENT OR PREVIOUS ACCRUAL MONTH"
                   TO MESS
              PERFORM SEND-MESS
              GO TO RETRY-INIT.

           IF ( EXT-EOBUF-ERRCD NOT = SPACE )
              GO TO PRIMARY-DRIVER-MODULE-EXIT.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE "MONTHLY ACCRUAL REPORT & UPDATE BR:&&&&"
                   TO ERRLOGW-EOM-MSG
              INSPECT ERRLOGW-EOM-MSG REPLACING FIRST "&&&&" BY BR-NO
              MOVE "MONTHLY ACCRUAL INCOME REPORT & UPDATE" TO MESS
           ELSE
              MOVE "DAILY ACCRUAL REPORT BR:&&&&" TO ERRLOGW-EOM-MSG
              INSPECT ERRLOGW-EOM-MSG REPLACING FIRST "&&&&" BY BR-NO
              MOVE "DAILY ACCRUAL INCOME REPORT" TO MESS.

           PERFORM LOG-ERROR.
           PERFORM SEND-LEGEND.
           PERFORM SEND-ACCOUNT.

       NEXT-LN.

           PERFORM READ-LN3-FILE-NEXT-SSP1. *> SSP - LN,BW,CD 

           IF ( IO-BAD ) OR ( LN-OWNBR NOT = LN-PATH-OWNBR )
      *       PERFORM OPEN-GB-FILE
      *       MOVE LN-OWNBR       TO GB-BRNO
      *       MOVE 1              TO GB-NO
      *       PERFORM READ-GB-FILE
      *       MOVE END-MONTH      TO LAST-MONTH
      *       MOVE END-YEAR       TO LAST-YEAR
      *       MOVE LAST-DATE-MMYY TO GB-LAST-ACCRUE
      *       PERFORM REWRITE-GB-FILE
      *       PERFORM CLOSE-GB-FILE
      *       GO TO END-ROUTINE.

              PERFORM OPEN-GB-FILE
              MOVE BR-NO          TO GB-BRNO 
              MOVE 1              TO GB-NO 
              MOVE END-MONTH      TO LAST-MONTH
              MOVE END-YEAR       TO LAST-YEAR
              MOVE LAST-DATE-MMYY TO GB-LAST-ACCRUE
              PERFORM REWRITE-GB-FILE *> EMBEDDED - GBFILE
              PERFORM CLOSE-GB-FILE
              GO TO END-ROUTINE.

      *0912 UNLOCK LN-FILE.

      * DUMMY CODE TO ALLOW DEBUGGER HALT ON MOVE:  JTG 001221
           IF LN-ACCTNO = HALT-LN-ACCTNO
              MOVE " " TO MESS.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SKIP LOANS IN RESCISSION AND LOANS THAT HAVE BEEN RESCINDED
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( LN-POCD-INRESCISSION ) OR
              ( LN-POCD-RESCIND      )
              GO TO NEXT-LN.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * POCD - **  IS A DELETED CONTRACT
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( LN-POCD = "**" )
              MOVE LN-POFFDATE TO NUM-DATE
              IF ( LN-SALEFIN = "Y" )
                 MOVE LN-PURDATE  TO SYS-DATE
              ELSE
                 MOVE LN-LOANDATE TO SYS-DATE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SKIP LOAN IF NOT DELETED THIS MONTH:
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF (  LN-POCD = "**"         )  AND
              (( NUM-YR NOT = END-YEAR  )  OR
               ( NUM-MO NOT = END-MONTH ))
               GO TO NEXT-LN.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SKIP LOAN IF BOOKED AND DELETED THIS MONTH:
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( LN-POCD = "**" ) AND
              ( NUM-YR = S-YY  ) AND
              ( NUM-MO = S-MM  )
              GO TO NEXT-LN.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    TEST FOR ENTRY ON PL UNEARNED REPORT
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF ( LN-PLCD NOT = SPACES )
      *       IF NOT GP-I-AM-WORLD
      *          PERFORM CREATE-PL-WX-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    TEST FOR ENTRY ON NON ACCRUAL EARNING REPORT
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    IF NOT GP-I-AM-WORLD
      *       PERFORM CREATE-NON-WX-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( LN-SERVACCT       = "Y"    ) AND
              ( LN-PRIOR-UNEARNED = 0      ) AND
              ( LN-NONACRERN      = 0      )
              GO TO NEXT-LN.

           IF ( LN-PLDATE     NOT = 0      ) AND
              ( LN-PRIOR-UNEARNED = 0      ) AND
              ( LN-NONACRERN      = 0      )
              GO TO NEXT-LN.

           IF ( LN-CURBAL         = 0      ) AND
              ( LN-PRIOR-UNEARNED = 0      ) AND
              ( LN-NONACRERN      = 0      )
              GO TO NEXT-LN.
           IF ( COMPUTE-EARNINGS-DONE = SPACES )
              PERFORM COMPUTE-EARNINGS.

      * JTG 000504 CORRECTED LOGIC ABOVE FOR GP-INCL-OTH-IN-EARNED FLAG.
      *            NEEDED ADDITIONAL TEST FOR WHEN ACCOUNT HAS LN-ANTICERN(6)
      *            AND GP-INCL-OTH-IN-EARNED = "N", STILL NEED TO TAKE
      *            AN ACCRUAL OF LOAN COSTS.
           IF ( LN-LOANTYPE       = "I"  ) AND
              ( LN-POCD       NOT = "**" ) AND
              ( EARN-TOT-ANTICERN = 0    ) AND
              ( EARN-TOT-ANTICADJ = 0    )
              IF ( GP-INCL-OTH-IN-EARNED = "Y" )
                 GO TO NEXT-LN
              ELSE
                 IF ( LN-ANTICERN(6) = 0 AND LN-ANTICERN(4) = 0 )
                    GO TO NEXT-LN.

      *    IF ( LN-LOANTYPE       = "I"    ) AND
      *       ( LN-POCD       NOT = "**"   ) AND
      *       ( EARN-TOT-ANTICERN = 0      ) AND
      *       ( EARN-TOT-ANTICADJ = 0      )
      *       GO TO NEXT-LN.

           IF ( FIRST-TIME = "Y" )
              MOVE LN-CLASS TO HOLD-LN-CLASS LC-CODE
              PERFORM SET-CLASS-HEADINGS
              PERFORM SET-BRANCH-HEADINGS.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  FIRST-TIME SET TO "N" IN THE DETAIL-LINE-PROCESS-SECTION.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( LN-CLASS NOT = HOLD-LN-CLASS )
              PERFORM CLASS-TOTALS
              MOVE LN-CLASS TO HOLD-LN-CLASS
              PERFORM SET-CLASS-HEADINGS.

      *M   PERFORM SEND-ACCOUNT.

           PERFORM DETAIL-LINE-PROCESS.

           GO TO NEXT-LN.

      *=================================================================
       END-ROUTINE.

           IF ( FIRST-TIME NOT = "Y" )
              MOVE "Y" TO BR-TOTALS
              PERFORM CLASS-TOTALS
              PERFORM BRANCH-TOTALS.

      *M----->PERFORM SUMMARY-TOTALS.
      *M----->PERFORM CORPORATE-TOTALS.


           PERFORM CLOSE-PROCESSING-FILES.

           IF ( IB-ACCRUALS-DONE NOT = "Y" )
              GO TO RUN-AC2ERN-REPORTS.

           MOVE "N" TO SUMMARY-FG.

      *- - - - - - - - - - - - - - - - - - - - -{ SET 'PRINT' WORKERS  }
           PERFORM SET-PRINT-IB-D.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE PRINT-PATH TO PRU-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM OPEN-WK1-FILE.

           MOVE ZEROES TO T-NOACCTS        (1)   T-NOACCTS        (2)
                          T-UNEARN         (1)   T-UNEARN         (2)
                          T-INT            (1)   T-INT            (2)
                          T-ADDON          (1)   T-ADDON          (2)
                          T-SRV            (1)   T-SRV            (2)
                          T-MFEE           (1)   T-MFEE           (2)
                          T-DISC           (1)   T-DISC           (2)
                          T-OTHER          (1)   T-OTHER          (2)
                          T-CASH-EARN      (1)   T-CASH-EARN      (2)
                          T-ENDING         (1)   T-ENDING         (2)
                          T-ACCRUED        (1)   T-ACCRUED        (2)
                          T-INT-SINCE-LSTPY(1)   T-INT-SINCE-LSTPY(2)
                          T-INTBAL         (1)   T-INTBAL         (2)
                          T-TRUE-ACCRUE    (1)   T-TRUE-ACCRUE    (2).

           PERFORM OPEN-BW1-FILE.
           PERFORM OPEN-LN1-FILE.
      * THESE MUST STAY HERE FOR THE IB ACCRUAL
      *    PERFORM OPEN-LC1-FILE.
           PERFORM OPEN-SP1-FILE.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE 0      TO PAGE-NUMBER.

           MOVE "Y"                  TO FIRST-TIME.

           MOVE MONTH-END-DATE       TO H-ENDDATE.
           MOVE EXT-CONAME-CONAME    TO H-NAME.
           MOVE EXT-CONAME-SYSDATE   TO H-DATE.
           MOVE EXT-CONAME-USER-ID   TO H-USERID.
           MOVE SPACES               TO H-CLRIT S-CLRIT.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE "IB ACCRUAL REPORT & UPDATE BR:&&&&"
                   TO ERRLOGW-EOM-MSG
              INSPECT ERRLOGW-EOM-MSG REPLACING FIRST "&&&&" BY BR-NO
              MOVE "INTEREST BEARING ACCRUAL REPORT & UPDATE" TO MESS
           ELSE
              MOVE "IB ACCRUAL REPORT BR:&&&&" TO ERRLOGW-EOM-MSG
              INSPECT ERRLOGW-EOM-MSG REPLACING FIRST "&&&&" BY BR-NO
              MOVE "INTEREST BEARING ACCRUAL REPORT" TO MESS.

           PERFORM LOG-ERROR.
           PERFORM SEND-LEGEND.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              PERFORM OPEN-PR-FILE.

           MOVE 99     TO LN-COUNT.
           MOVE "Y"    TO IB-FLAG.

           MOVE 0      TO LN-CLASS LN-ACCTNO.
 
           MOVE LN-PATH-OWNBR TO LN-OWNBR
                                 QLN3-WBEG-OWNBR.          

           PERFORM START-LN3-FILE-SSP2. *> SSP - LN,BW,CD 

           PERFORM ACCRUE-IB UNTIL IB-FLAG = "N".

           IF ( FIRST-TIME NOT = "Y" )
              MOVE "Y" TO BR-TOTALS
              PERFORM CLASS-TOTALS
              PERFORM BRANCH-TOTALS
              PERFORM PRINT-IB-EXCEPTIONS
              PERFORM CLOSE-FILES.

      *-----------------------------------------------------------------
      *    GO RUN ... NON ACCRUAL EARNINGS REPORT & PL UNEARNED REPORT
      *-----------------------------------------------------------------
       RUN-AC2ERN-REPORTS.

           GO TO PRIMARY-DRIVER-MODULE-EXIT.

      *    IF ( FIRST-TIME-WX = "N" )
      *       MOVE "B"         TO WX-RUNTYPE
      *       MOVE "LP/AC2ERN" TO FORM-NAM
      *       IF ( PROCESSING-PROGRAM = "AC1ERN" )
      *          CALL FORM-PROGX
      *                   USING FORM-PATH WX-BUF AC1-WORKER
      *          CANCEL FORM-PROGX
      *       END-IF
      *       MOVE WX-BUF TO ACCESS-BUF
      *       PERFORM REMOVE-WORKFILE.

       PRIMARY-DRIVER-MODULE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    A C C R U E - I B
      *
      *-----------------------------------------------------------------
      *    IB INTEREST ACCRUE
      ******************************************************************
       ACCRUE-IB SECTION.
           
           PERFORM READ-LN3-FILE-NEXT-SSP2. *> SSP - LN,BW,CD
      D    STOP LN-ACCTNO.
   
       NEW-BRANCH-LOOP.
           IF ( IO-BAD ) OR ( LN-OWNBR NOT = LN-PATH-OWNBR )
              MOVE "N" TO IB-FLAG
              GO TO EXIT-ACCRUE-IB.

      * SKIP LOANS PAIDOFF
      * OR IN P&L
      * OR IN RESCISSION
      * OR LOANS THAT HAVE BEEN RESCINDED
      * OR VOIDED LOANS

           IF ( LN-CURBAL     = 0      ) OR
              ( LN-PLDATE NOT = 0      ) OR
              ( LN-PLCD NOT   = SPACES ) OR
              ( LN-POCD-INRESCISSION   ) OR
              ( LN-POCD-RESCIND        ) OR
              ( LN-POCD       = "**"   )
              GO TO EXIT-ACCRUE-IB.

           PERFORM GET-SP.

           IF ( SP-MAX-IB-ACR-DAYS = 0      )
              GO TO EXIT-ACCRUE-IB.

      *  USED TO ALWAYS SKIP REPO ACCOUNTS ON IB ACCRUAL, FROM A60
      *  FORWARD.  AUTOMOTIVE CREDIT WANTED TO TAKE EARNINGS TILL
      *  ACCOUNT CHARGED OFF MERCURY, SKIP REPO ACCOUNTS:

           IF ( GP-IB-ACCRUE-EARN-ON-REPO NOT = "Y"        ) AND
              ( LN-REPOCD                     = "X" OR "S" )
              GO TO EXIT-ACCRUE-IB.

           MOVE MONTH-END-DATE TO IBPC-DATE.
           PERFORM IBPC-TEST.

           IF (  IBPC-FG           = "I"  ) OR
              (( IBPC-FG           = "P" )  AND
               ( IBPC-EXPIRED-FLAG = "E" ))
              NEXT SENTENCE
           ELSE
              GO TO EXIT-ACCRUE-IB.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * 8/3/10: ADDED BACK READ OF LC BEFORE CHECKING LC-SERVACCT.
      * WAS CHECKING WITHOUT READING LCFILE & PICKING UP SERVICE FLAG
      * FROM LAST ACCOUNT IN HEADING ROUTINE.  IF LAST CLASS FROM
      * HEADING ROUTINE WAS SERVICE ACCT CLASS, ALL CLASSES WOULD
      * BE SKIPPED IN THIS IB ROUTINE, NO IB LOANS WOULD BE
      * PROCESSED!  BARB & CINDY

      * DO "NOT" PERFORM GET-LC BECAUSE IT MOVES TO HOLD-LN-CLASS WHICH THEN
      * MESSES UP THE PAGE BREAK ON CLASS !!!

           MOVE LN-CLASS TO LC-CODE.
      *    PERFORM READ-LC1-FILE.
           PERFORM ARRAYLC-READ.
           IF ( IO-BAD )
              GO TO EXIT-ACCRUE-IB.

           IF ( LC-SERVACCT = "Y" )
              IF ( LN-CLASS = 99 )
                 MOVE "N" TO IB-FLAG
                 GO TO EXIT-ACCRUE-IB
              ELSE
      * DATABASE DOESNT NEED THIS, TOO SLOW
      *          MOVE 0      TO LN-ACCTNO
      *          ADD  1      TO LN-CLASS
      *          PERFORM START-LN3-FILE
                 PERFORM READ-LN3-FILE-NEXT-SSP2 *> SSP - LN,BW,CD 
                 GO TO NEW-BRANCH-LOOP.

           IF FIRST-TIME = "Y"
              MOVE LN-CLASS TO HOLD-LN-CLASS
              PERFORM SET-IB-CLASS-HEADINGS
              PERFORM SET-IB-BRANCH-HEADINGS
              IF ( GP-IB-ACCRUALS-DONE NOT = "Y" )
                 IF ( LN-OWNBR NOT = 9999 )
      * BAH COMMENTED OUT 10/13/2020, MAKES NO SENSE TO START WITH NEXT BRANCH
      *     WHEN THIS IS RAN FOR ONE BRANCH AT A TIME.
      *             ADD  1      TO LN-OWNBR
      *             MOVE 1      TO LN-CLASS
      *             MOVE 0      TO LN-ACCTNO
      *             PERFORM START-LN3-FILE
                    PERFORM READ-LN3-FILE-NEXT-SSP2 *> SSP - LN,BW,CD 
                    GO TO NEW-BRANCH-LOOP
                 ELSE
                    MOVE "N" TO IB-FLAG
                    GO TO EXIT-ACCRUE-IB.

           IF ( LN-CLASS NOT = HOLD-LN-CLASS )
              PERFORM CLASS-TOTALS
              MOVE LN-CLASS TO HOLD-LN-CLASS
              PERFORM SET-IB-CLASS-HEADINGS.

           PERFORM IB-DETAIL-LINE-PROCESS.

       EXIT-ACCRUE-IB.
           EXIT.

      ******************************************************************
      * P R O C E S S   I B   E X C E P T I O N S
      *
      * IB LOANS EXCEEDING SP-MAX-IB-ACR-DAYS
      ******************************************************************
       PRINT-IB-EXCEPTIONS SECTION.

           MOVE "Y" TO IB-EXCEPTION-HEAD-PRINT-FG.

           MOVE 99 TO LN-COUNT.

           MOVE "Y" TO FIRST-TIME-PRINT-IB-EXCEPTIONS.
           MOVE ZERO TO HOLD-LN-CLASS.

           MOVE BR-NO TO WK3-BRANCH.
           MOVE ZEROS TO WK3-CLASS.
           MOVE ZEROS TO WK3-ACCTNO.

           PERFORM OPEN-WK3-FILE.
           PERFORM START-WK3-FILE.

       PRINT-IB-EXCEPTIONS-NEXT.

           PERFORM READ-WK3-FILE-NEXT.
           IF ( IO-BAD                 ) OR
              ( WK3-BRANCH NOT = BR-NO ) OR
              ( WK3-BRANCH-TOTALS      )
              GO TO PRINT-IB-EXCEPTIONS-END.

           MOVE "N" TO FIRST-TIME-PRINT-IB-EXCEPTIONS.

           IF WK3-CLASS NOT = HOLD-LN-CLASS
              MOVE WK3-CLASS TO HOLD-LN-CLASS
              PERFORM SET-CLASS-HEADINGS.

           IF ( WK3-CLASS-TOTALS )
              PERFORM PRINT-IB-EXCEPTIONS-CLASS
           ELSE
              PERFORM PRINT-IB-EXCEPTIONS-DETAIL.

           GO TO PRINT-IB-EXCEPTIONS-NEXT.

       PRINT-IB-EXCEPTIONS-END.

           IF ( FIRST-TIME-PRINT-IB-EXCEPTIONS = "N" )
              PERFORM PRINT-IB-EXCEPTIONS-BRANCH.

           CLOSE WK3-FILE.

       PRINT-IB-EXCEPTIONS-EXIT.
            EXIT.

      ******************************************************************
       PRINT-IB-EXCEPTIONS-BRANCH SECTION.
      ******************************************************************
           MOVE HOLD-LN-COUNT           TO LN-COUNT.

           MOVE "BRANCH TOTALS:"         TO D-TAG.
           MOVE WK3-NUMBER-ACCTS         TO D-T-NOACCTS-T.
           MOVE "#"                      TO D-T-TAG-T.
           MOVE WK3-INT-SINCE-LSTPY      TO D-T-IBE-INT-SINCE-LSTPY.
           MOVE WK3-INT-OWED             TO D-T-IBE-INT-OWED.
           MOVE WK3-TRUE-ACCRUE-AMOUNT   TO D-T-IBE-TRUE-ACCRUE.
           MOVE WK3-INCOME-ACCRUE-AMOUNT TO D-T-IBE-INCOME-ACCRUE.
           MOVE WK3-BALANCE              TO D-T-IBE-BALANCE.

           MOVE 2 TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "N" TO IB-EXCEPTION-HEAD-PRINT-FG.

      ******************************************************************
       PRINT-IB-EXCEPTIONS-CLASS SECTION.
      ******************************************************************
           MOVE "CLASS TOTALS:"          TO D-TAG.
           MOVE WK3-NUMBER-ACCTS         TO D-T-NOACCTS-T.
           MOVE "#"                      TO D-T-TAG-T.
           MOVE WK3-INT-SINCE-LSTPY      TO D-T-IBE-INT-SINCE-LSTPY.
           MOVE WK3-INT-OWED             TO D-T-IBE-INT-OWED.
           MOVE WK3-TRUE-ACCRUE-AMOUNT   TO D-T-IBE-TRUE-ACCRUE.
           MOVE WK3-INCOME-ACCRUE-AMOUNT TO D-T-IBE-INCOME-ACCRUE.
           MOVE WK3-BALANCE              TO D-T-IBE-BALANCE.

           MOVE 2 TO LN-FEED.
           PERFORM WRITE-DETAIL-LINE.

           MOVE LN-COUNT                 TO HOLD-LN-COUNT.
           MOVE 99                       TO LN-COUNT.

      ******************************************************************
       PRINT-IB-EXCEPTIONS-DETAIL SECTION.
      ******************************************************************
           MOVE WK3-ACCTNO            TO D-LOAN-NUM.

           STRING WK3-LNAME,", ",WK3-FNAME DELIMITED BY "   "
              INTO D-BWNAME.

           MOVE WK3-INT-PAID-THRU-DATE         TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY                    TO IBE-INTEREST-PDTH-DT.
           MOVE WK3-INT-SINCE-LSTPY            TO IBE-INT-SINCE-LSTPY.
           MOVE WK3-INT-OWED                   TO IBE-INT-OWED.
           MOVE WK3-TRUE-ACCRUE-AMOUNT         TO IBE-TRUE-ACCRUE.
           MOVE WK3-INCOME-ACCRUE-AMOUNT       TO IBE-INCOME-ACCRUE.
           MOVE WK3-BALANCE                    TO IBE-BALANCE.
           MOVE WK3-CONTRACTUAL-PAID-THRU-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY                    TO IBE-CONT-PDTH-DT.
           MOVE WK3-CONTRACTUAL-STATUS         TO IBE-CONT-STATUS.

           PERFORM WRITE-DETAIL-LINE.


      ******************************************************************
       INITIALIZATION SECTION.
      ******************************************************************

           MOVE SPACES TO MESS EXT-EOBUF-ERRCD.
           PERFORM SEND-LEGEND.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    CALCULATE 'MONTH-END-DATE' ONLY IF UPDATING FILES; OTHERWISE
      *    SET 'MONTH-END' TO DATE ENTERED.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE END-MONTH TO DATE-MMDDYY-MM
              MOVE END-YEAR  TO DATE-MMDDYY-YY
              MOVE 01        TO DATE-MMDDYY-DD
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              MOVE 50        TO DATE-YYYYMMDD-DD
              MOVE DATE-YYYYMMDD TO NDTE-DATE
              PERFORM NEW-DATE-CALCULATION
              MOVE NDTE-DATE TO MONTH-END-DATE MONTH-DATE
           ELSE
              MOVE EOM-DATE  TO MONTH-END-DATE.

      *- - - - - - - - - - - - - - - - - - - - -{ SET 'PRINT' WORKERS  }
           PERFORM SET-PRINT-D.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE PRINT-PATH TO PRU-FILE.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    CREATE KEY FILE FOR AC2ERN.C REPORTS:
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *    ***NOTE*** ONLY CREATE 'WX' ONLY ONCE FOR "AC1DAY"
      *
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( PROCESSING-PROGRAM       = "AC1DAY" ) AND
              ( FIRST-TIME-MKTEMP-AC1DAY = "N"      )
              GO TO INITIALIZATION-CONTINUE.

           MOVE "N"            TO FIRST-TIME-MKTEMP-AC1DAY.
      *    IF NOT GP-I-AM-WORLD
      *       MOVE MKTEMP-DEFAULT TO MKTEMP-BUF
      *       PERFORM MKTEMP-CALL
      *       MOVE MKTEMP-BUF     TO WX-BUF
      *       PERFORM OPEN-WX1-FILE-OUTPUT
      *       PERFORM CLOSE-WX1-FILE
      *       PERFORM OPEN-WX1-FILE.

           MOVE MKTEMP-DEFAULT TO MKTEMP-BUF.
           PERFORM MKTEMP-CALL.
           MOVE MKTEMP-BUF     TO WK3-PATH.
           PERFORM OPEN-WK3-FILE-OUTPUT.
           PERFORM CLOSE-WK3-FILE.
           PERFORM OPEN-WK3-FILE.


      *-----------------------------------------------------------------
       INITIALIZATION-CONTINUE.

      *--->PERFORM CLOSE-WK1-FILE.
           PERFORM OPEN-WK1-FILE.

           PERFORM OPEN-BW1-FILE.
           PERFORM OPEN-LN3-FILE.
           PERFORM OPEN-LN1-FILE.
      *    PERFORM OPEN-LC1-FILE.
           PERFORM ARRAYLC-LOAD.
           PERFORM OPEN-SP1-FILE.
      *    PERFORM ARRAYSP-LOAD.
      *    PERFORM SQL-OPEN-UPDATE-CONNECTION.

      *    IF GP-USE-ACCRUAL-EARN-FILE = "Y" OR "R"
      *       PERFORM OPEN-AE1-FILE.

           MOVE ZEROES TO T-NOACCTS        (1)   T-NOACCTS        (2)
                          T-UNEARN         (1)   T-UNEARN         (2)
                          T-INT            (1)   T-INT            (2)
                          T-ADDON          (1)   T-ADDON          (2)
                          T-SRV            (1)   T-SRV            (2)
                          T-MFEE           (1)   T-MFEE           (2)
                          T-DISC           (1)   T-DISC           (2)
                          T-OTHER          (1)   T-OTHER          (2)
                          T-CASH-EARN      (1)   T-CASH-EARN      (2)
                          T-ENDING         (1)   T-ENDING         (2)
                          T-ACCRUED        (1)   T-ACCRUED        (2)
                          T-INT-SINCE-LSTPY(1)   T-INT-SINCE-LSTPY(2)
                          T-INTBAL         (1)   T-INTBAL         (2)
                          T-TRUE-ACCRUE    (1)   T-TRUE-ACCRUE    (2).

           MOVE LN-PATH-OWNBR TO LN-OWNBR
                                 QLN3-WBEG-OWNBR.
           MOVE 0             TO LN-CLASS LN-ACCTNO.
  
           PERFORM START-LN3-FILE-SSP1. *> SSP - LN,BW,CD 

           MOVE MONTH-END-DATE       TO H-ENDDATE.
           MOVE EXT-CONAME-CONAME    TO H-NAME.
           MOVE EXT-CONAME-SYSDATE   TO H-DATE.
           MOVE EXT-CONAME-USER-ID   TO H-USERID.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              PERFORM OPEN-PR-FILE.

           PERFORM OPEN-LTI1-FILE.
           PERFORM READ-LTI1-ROWCOUNT. *> EMBEDDED - LTI COUNT
           PERFORM CLOSE-LTI1-FILE.

           GO TO EXIT-INITIALIZE.

       EXIT-INITIALIZE.
           EXIT.

      ******************************************************************
      *
      *    D E T A I L - L I N E - P R O C E S S
      *
      ******************************************************************
       DETAIL-LINE-PROCESS SECTION.

           IF ( FIRST-TIME = "Y" )
              MOVE 1 TO LN-FEED
              MOVE EXT-CONAME-RPT-LINES TO LN-COUNT
              MOVE "N" TO FIRST-TIME.

           PERFORM GET-SP.

      * COMPUTE NEW ACCRUAL EARNINGS NUMBERS:
      
           IF ( LN-POCD = "**" )
              MOVE 0      TO WS-INT
                             SRV
                             MFEE
                             WS-DISC
                             W-OTHER
                             ADDON
                             EARN-TOT-UNEARN
           ELSE
              MOVE MONTH-END-DATE       TO AERN-ENDDATE
              MOVE LN-LAST-ACCRUAL-DATE TO AERN-LAST-ACCRUAL-DATE
              PERFORM COMPUTE-AERNINGS
              MOVE AERN-EARNINGS(1)     TO WS-INT

      * ROUTINE NOW CLEARS ADDON AMOUNT, WHEN LN-ANTICERN(2) = 0.
      * WITHOUT THIS CLEAR, ADDON FIELD IS PASSED TO NEXT
      * SEQUENTIAL ACCOUNT IN ACCRUAL (BUG)
      
              IF LN-ANTICERN(2) = 0
                 MOVE 0                 TO ADDON
              END-IF

      * THIS LOGIC IS FOR ACCOUNTS THAT HAVE ADDON ANTICIPATED UNEARNED,
      * THE RESULT OF POSTING FEES FLAGGED AS EARNING FEE CODES.
      * EARNINGS WERE COMPUTED ON THE ANTIC UNEARNED AERN-EARNINGS(2)
      * AND IS PASSED TO 'ADDON'

              IF ( LN-ADDON-FG NOT = "Y"      ) AND
                 ( LN-INT-REBATE = " " OR "C" ) AND
                 ( LN-ANTICERN(2) NOT = 0     )
                 MOVE AERN-EARNINGS(2)  TO ADDON
              END-IF

              MOVE AERN-EARNINGS(3)     TO SRV
              MOVE AERN-EARNINGS(4)     TO MFEE
              MOVE AERN-EARNINGS(5)     TO WS-DISC
              MOVE AERN-EARNINGS(6)     TO W-OTHER
              IF LN-ADDON-FG = "Y"
                 MOVE ZEROS TO ADDON
                 IF LN-INT-REBATE = SPACES OR "C"
                    PERFORM COMPUTE-ADDON-EARNINGS
                    MOVE ADDON-EARNINGS TO ADDON.

           MOVE LN-PRIOR-UNEARNED TO UNEARN.

           COMPUTE ENDING = EARN-TOT-UNEARN
                          - WS-INT
                          - ADDON
                          - SRV
                          - WS-DISC.

           IF NOT (GP-INCL-OTH-IN-EARNED-N OR GP-INCL-OTH-IN-EARNED-R)
              SUBTRACT W-OTHER FROM ENDING.

           IF NOT(GP-INCL-OTH-IN-EARNED-R)
              SUBTRACT MFEE FROM ENDING.

           COMPUTE ENDING-INT = EARN-UNEARN(1) - WS-INT.

           ADD EARN-TOT-ANTICADJ EARN-TOT-ANTICERN GIVING WK-WORKER.
           MOVE WK-WORKER TO D-ANTIC.

           PERFORM PROCESS-BORROWER.
           PERFORM LPSTAT-DISPLAY.
           MOVE LPS-DISPLAY-LNNO TO W-LOAN-NUM.
           MOVE LOAN-NUM         TO D-LOAN-NUM.
           MOVE LN-ANTICTERM     TO D-ANTERM.
           MOVE UNEARN           TO D-UNEARN.
           MOVE WS-INT           TO D-INT.
           MOVE ADDON            TO D-ADDON.
           MOVE SRV              TO D-SRV.
           MOVE MFEE             TO D-MFEE.
           MOVE WS-DISC          TO D-DISC.
           MOVE W-OTHER          TO D-OTHER.
           MOVE LN-NONACRERN     TO D-CASH-EARN.
           MOVE ENDING           TO D-ENDING.

           IF SUM-ONLY = "N"
              PERFORM WRITE-DETAIL-LINE
           ELSE
              MOVE SPACES TO DETAIL-LINE.

           MOVE 1 TO LEV.
           PERFORM UPDATE-WK-FILE.

           ADD 1            TO T-NOACCTS  (1) T-NOACCTS  (2).
           ADD UNEARN       TO T-UNEARN   (1) T-UNEARN   (2).
           ADD WS-INT       TO T-INT      (1) T-INT      (2).
           ADD ADDON        TO T-ADDON    (1) T-ADDON    (2).
           ADD SRV          TO T-SRV      (1) T-SRV      (2).
           ADD MFEE         TO T-MFEE     (1) T-MFEE     (2).
           ADD WS-DISC      TO T-DISC     (1) T-DISC     (2).
           ADD W-OTHER      TO T-OTHER    (1) T-OTHER    (2).
           ADD LN-NONACRERN TO T-CASH-EARN(1) T-CASH-EARN(2).
           ADD ENDING       TO T-ENDING   (1) T-ENDING   (2).

      * REWRITE LN1 WITH NEW LN-ACCERN(1) LN-TOTERN LN-YTDINTPD
      * AND LN-TOTINTPD:

           PERFORM UPDATE-LN1-FILE.

      *    IF GP-USE-ACCRUAL-EARN-FILE = "Y" OR "R"
      *       MOVE "N" TO NORMAL-IB-FG
      *       PERFORM UPDATE-AE1-FILE.

      * REPOSITION LN3 - THIS RECORD HAS ALREADY BEEN READ
      * SO IO-FG CHECK'S BRANCH IS VALID.

      *    PERFORM START-LN3-FILE-GREATER.

       END-DETAIL-LN-PROCESS.
           EXIT.

      ******************************************************************
      *
      *    I B - D E T A I L - L I N E - P R O C E S S
      *
      ******************************************************************
       IB-DETAIL-LINE-PROCESS SECTION.
           IF ( FIRST-TIME = "Y" )
              MOVE 1            TO LN-FEED
              MOVE EXT-CONAME-RPT-LINES TO LN-COUNT
              MOVE "N"          TO FIRST-TIME.

      *----------------  DETERMINE ASSESSMENT  ------------------------
           MOVE 0      TO D-ACCRUED
                          D-TRUE-ACCRUE
                          D-INTBAL
                          D-INT-SINCE-LSTPY
                          W-MAX.

           IF ( SP-CAL-RATETYPE(1) = "Z" )
              PERFORM GET-IB-RATETYPE-Z
           ELSE
              PERFORM GET-IB-NORMAL.


      *----------------  DETERMINE ASSESSMENT  ------------------------

           PERFORM PROCESS-BORROWER.
           PERFORM LPSTAT-DISPLAY.
           MOVE LPS-DISPLAY-LNNO TO W-LOAN-NUM.
           MOVE LOAN-NUM         TO D-LOAN-NUM.

           PERFORM WRITE-DETAIL-LINE.

      *    IF GP-USE-ACCRUAL-EARN-FILE = "Y" OR "R"
      *       MOVE "I" TO NORMAL-IB-FG
      *       PERFORM UPDATE-AE1-FILE.


           MOVE 2 TO LEV.
           PERFORM UPDATE-WK-FILE.

           ADD 1               TO T-NOACCTS        (1) T-NOACCTS    (2).
           ADD ACCRUED         TO T-ACCRUED        (1) T-ACCRUED    (2).
           ADD TRUE-ACCRUE     TO T-TRUE-ACCRUE    (1) T-TRUE-ACCRUE(2).
           ADD INTBAL          TO T-INTBAL         (1) T-INTBAL     (2).
           ADD INT-SINCE-LSTPY TO T-INT-SINCE-LSTPY(1)
                                  T-INT-SINCE-LSTPY(2).

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    REPOSITION LN3 - THIS RECORD HAS ALREADY BEEN READ
      *     SO IO-FG CHECK'S BRANCH IS VALID.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

      *    PERFORM START-LN3-FILE.
      *    PERFORM READ-LN3-FILE-NEXT.
      *    IF ( IO-BAD ) OR ( LN-OWNBR NOT = LN-PATH-OWNBR )
      *       GO TO IO-ERROR.

       END-IB-DETAIL-LN-PROCESS.
           EXIT.

      ******************************************************************
      *
      *    G E T - I B - N O R M A L
      *
      *-----------------------------------------------------------------
      *    NORMAL ACCOUNT  IB SETUP FOR ACTUAL
      ******************************************************************
       GET-IB-NORMAL SECTION.
           IF ( LN-INTPDTH-DATE = 0      )
              MOVE LN-INTDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY     TO D-FROM
           ELSE
              MOVE LN-INTPDTH-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO D-FROM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JTG 040812 ADDED LOGIC FOR NEW SPR FIELDS SP-DELQ-IB-AGE AND
      *            SP-DELQ-IB-MAX-DAYS, THE IB ACCRUAL WILL DETERMINE IF AN
      *            ACCOUNT HAS REACHED THE CONTRACTUAL AGE OF 'SP-DELQ-IB-AGE
      *            AND IF SO FORCE THE MAXIMUM ACCRUAL DAYS TO THE VALUE
      *            OF SP-DELQ-IB-MAX-DAYS                        LENDMARK #2344
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *IN A15 IF A FIX WAS NEVER RUN TO CLEAR THIS FIELDS, ITS 224, I DONT KNOW
      *WHY BUT SP-DELQ-IB-AGE-ALP IN A15 IS SPACES WHEN SP-DELQ-IB-AGE IS 224.
      *IN A30, ITS NEVER GOING TO BE A SPACES
      *    IF SP-DELQ-IB-AGE-ALP NOT = " "
              IF SP-DELQ-IB-AGE NOT = 0
                 MOVE MONTH-END-DATE TO AGEING-DATE
                 PERFORM COMPUTE-CONTRACTUAL
                 IF CONTRACTUAL >= SP-DELQ-IB-AGE
                    MOVE SP-DELQ-IB-MAX-DAYS TO SP-MAX-IB-ACR-DAYS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    THIS ROUTINE WILL ESTABLISH THE MAXIMUM INTEREST ASSESS
      *    FROM THE LAST ACCRUED DATE, PER SP-MAX-IB-ACR-DAYS:
      *
      *         RE: MOVE 1 TO INDU-MAX-ACCRUE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SP-MAX-IB-ACR-DAYS NOT = 0      )
              IF ( LN-INTPDTH-DATE = 0      )
                 MOVE LN-INTDATE TO NDTE-DATE HOLD-LN-INTPDTH-DATE
              ELSE
                 MOVE LN-INTPDTH-DATE TO NDTE-DATE HOLD-LN-INTPDTH-DATE
              END-IF
              MOVE SP-MAX-IB-ACR-DAYS TO NDTE-HOLD
              PERFORM INCREMENT-DAYS
              MOVE NDTE-DATE          TO RATE-DATE
              MOVE LN-MAKERCD(1)      TO RATE-MAKERCD
              MOVE "PY"               TO RATE-LPTRCD
              MOVE 1                  TO INDU-MAX-ACCRUE
              PERFORM SET-PY-RATE
              MOVE INDU-INTEREST      TO W-MAX.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    THIS ROUTINE WILL ESTABLISH THE ACCRUED INTEREST ASSESS
      *    FROM THE LAST ACCRUED DATE
      *
      *         RE: MOVE 0 TO INDU-MAX-ACCRUE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE MONTH-END-DATE TO RATE-DATE.
           MOVE LN-MAKERCD(1)  TO RATE-MAKERCD.
           MOVE "PY"           TO RATE-LPTRCD.
           MOVE 0              TO INDU-MAX-ACCRUE.
           PERFORM SET-PY-RATE.
           MOVE INDU-INTEREST TO D-INT-SINCE-LSTPY INT-SINCE-LSTPY.
           MOVE LN-INTBAL     TO D-INTBAL          INTBAL.

           COMPUTE TRUE-ACCRUE
                   D-TRUE-ACCRUE = LN-INTBAL + INDU-INTEREST.

           IF ( SP-MAX-IB-ACR-DAYS NOT = 999   ) AND
              ( TRUE-ACCRUE            > W-MAX )
              MOVE W-MAX TO ACCRUED D-ACCRUED
              MOVE "*" TO D-MAX
              PERFORM UPDATE-WK3-FILE
           ELSE
              MOVE TRUE-ACCRUE TO ACCRUED D-ACCRUED.

       EXIT-GET-IB-NORMAL.
           EXIT.

      ******************************************************************
      *
      *    G E T - I B - R A T E T Y P E - Z
      *
      *-----------------------------------------------------------------
      *    RATETYPE-Z ACCOUNT IB SETUP FOR ACTUAL
      ******************************************************************
       GET-IB-RATETYPE-Z SECTION.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    DETERMINE OF ACCRUAL DATE IS PRIOR TO PAID THRU DATE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE LN-1STPYDATE   TO PDTH-DATE-WORK.
           PERFORM PAID-THRU-CALCULATION.
           MOVE PDTH-DATE-FULL TO NUM-DATE.
           MOVE MONTH-END-DATE TO SYS-DATE.
           IF ( LN-INTPDTH-DATE = 0      )
              MOVE LN-INTDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO D-FROM
           ELSE
              MOVE LN-INTPDTH-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO D-FROM.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * JTG 040812 ADDED LOGIC FOR NEW SPR FIELDS SP-DELQ-IB-AGE AND
      *            SP-DELQ-IB-MAX-DAYS, THE IB ACCRUAL WILL DETERMINE IF AN
      *            ACCOUNT HAS REACHED THE CONTRACTUAL AGE OF 'SP-DELQ-IB-AGE
      *            AND IF SO FORCE THE MAXIMUM ACCRUAL DAYS TO THE VALUE
      *            OF SP-DELQ-IB-MAX-DAYS                        LENDMARK #2344
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF SP-DELQ-IB-AGE-ALP NOT = " "
              IF SP-DELQ-IB-AGE NOT = 0
                 MOVE MONTH-END-DATE TO AGEING-DATE
                 PERFORM COMPUTE-CONTRACTUAL
                 IF CONTRACTUAL >= SP-DELQ-IB-AGE
                    MOVE SP-DELQ-IB-MAX-DAYS TO SP-MAX-IB-ACR-DAYS.
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    THIS ROUTINE WILL ESTABLISH THE MAXIMUM INTEREST ASSESS
      *    FROM THE LAST ACCRUED DATE, PER SP-MAX-IB-ACR-DAYS:
      *
      *         RE: MOVE 1 TO INDU-MAX-ACCRUE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           IF ( SP-MAX-IB-ACR-DAYS NOT = 0      )
              IF ( LN-INTPDTH-DATE = 0      )
                 MOVE LN-INTDATE TO NDTE-DATE HOLD-LN-INTPDTH-DATE
              ELSE
                 MOVE LN-INTPDTH-DATE TO NDTE-DATE HOLD-LN-INTPDTH-DATE
              END-IF
              MOVE SP-MAX-IB-ACR-DAYS TO NDTE-HOLD
              PERFORM INCREMENT-DAYS
              MOVE NDTE-DATE          TO RATE-DATE
              MOVE LN-MAKERCD(1)      TO RATE-MAKERCD
              MOVE "PY"               TO RATE-LPTRCD
              MOVE 1                  TO INDU-MAX-ACCRUE
              PERFORM SET-PY-RATE
              MOVE INDU-INTEREST      TO W-MAX.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *    THIS ROUTINE WILL ESTABLISH THE ACCRUED INTEREST ASSESS
      *    FROM THE LAST ACCRUED DATE
      *
      *         RE: MOVE 0 TO INDU-MAX-ACCRUE
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE MONTH-END-DATE TO RATE-DATE.
           MOVE LN-MAKERCD(1) TO RATE-MAKERCD.
           MOVE "PY"          TO RATE-LPTRCD.
           MOVE 0             TO INDU-MAX-ACCRUE.
           PERFORM SET-PY-RATE.
           MOVE INDU-INTEREST TO D-INT-SINCE-LSTPY INT-SINCE-LSTPY.
           MOVE LN-INTBAL     TO D-INTBAL          INTBAL.

           COMPUTE TRUE-ACCRUE
                   D-TRUE-ACCRUE = LN-INTBAL + INDU-INTEREST.

           IF ( SP-MAX-IB-ACR-DAYS NOT = 999   ) AND
              ( TRUE-ACCRUE            > W-MAX )
              MOVE W-MAX TO ACCRUED D-ACCRUED
              MOVE "*" TO D-MAX
              PERFORM UPDATE-WK3-FILE
           ELSE
              MOVE TRUE-ACCRUE TO ACCRUED D-ACCRUED.

       EXIT-GET-IB-RATETYPE-Z.
           EXIT.

      ******************************************************************
      *
      *    U P D A T E - W K - F I L E
      *
      ******************************************************************
       UPDATE-WK-FILE SECTION.
      *-----------------------------------------------------------------
       UPDATE-WK.

           MOVE LN-OWNBR TO WK-BRANCH.
           MOVE LN-CLASS TO WK-CLASS.

           PERFORM READ-WK1-FILE.

           IF ( IO-GOOD )
              GO TO UPDATE-WK-FIELDS.

           MOVE SPACES   TO WK-REC.
           MOVE LN-OWNBR TO WK-BRANCH.
           MOVE LN-CLASS TO WK-CLASS.
           MOVE ZEROES   TO WK-NOACCTS(1)
                            WK-NOACCTS(2)
                            WK-UNEARN
                            WK-INT
                            WK-ADDON
                            WK-SRV
                            WK-MFEE
                            WK-DISC
                            WK-OTHER
                            WK-CASH-EARN
                            WK-ENDING
                            WK-ACCRUED
                            WK-TRUE-ACCRUE
                            WK-INTBAL
                            WK-INT-SINCE-LSTPY.

           PERFORM WRITE-WK1-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

           GO TO UPDATE-WK.

      *=================================================================
       UPDATE-WK-FIELDS.

           ADD 1 TO WK-NOACCTS(LEV).

           IF ( PRINT-ID = "D" )
              ADD UNEARN       TO WK-UNEARN
              ADD WS-INT          TO WK-INT
              ADD ADDON        TO WK-ADDON
              ADD SRV          TO WK-SRV
              ADD MFEE         TO WK-MFEE
              ADD WS-DISC         TO WK-DISC
              ADD W-OTHER      TO WK-OTHER
              ADD LN-NONACRERN TO WK-CASH-EARN
              ADD ENDING       TO WK-ENDING
           ELSE
              ADD ACCRUED         TO WK-ACCRUED
              ADD TRUE-ACCRUE     TO WK-TRUE-ACCRUE
              ADD INTBAL          TO WK-INTBAL
              ADD INT-SINCE-LSTPY TO WK-INT-SINCE-LSTPY.

           PERFORM REWRITE-WK1-FILE.

           IF ( IO-BAD )
              GO TO IO-ERROR.

       END-UPDATE-WK-FILE.
           EXIT.

      *****************************************************************
      * U P D A T E    W K - 3
      *
      ******************************************************************
       UPDATE-WK3-FILE SECTION.

           MOVE LN-SSNO(1) TO BW-SSNO.
      *    PERFORM READ-BW1-FILE.
      *    IF (IO-BAD)
           IF BW-LNAME = SPACES
              MOVE "NO RECORD" TO WK3-LNAME.

           MOVE BW-LNAME TO WK3-LNAME.
           MOVE BW-FNAME TO WK3-FNAME.
      *- - - - - - - - - - - - - - - - - - - - - - - -{ UPDATE: DETAIL }
           MOVE LN-OWNBR  TO HOLD-WK3-BRANCH.
           MOVE LN-CLASS  TO HOLD-WK3-CLASS.
           MOVE LN-ACCTNO TO HOLD-WK3-ACCTNO.
           PERFORM UPDATE-WK3-FIND.
           PERFORM UPDATE-WK3-RECORD.

      *- - - - - - - - - - - - - - - - - - - - - - - -{ UPDATE: CLASS  }
           MOVE LN-OWNBR  TO HOLD-WK3-BRANCH.
           MOVE LN-CLASS  TO HOLD-WK3-CLASS.
           MOVE 99999999  TO HOLD-WK3-ACCTNO.
           PERFORM UPDATE-WK3-FIND.
           PERFORM UPDATE-WK3-RECORD.

      *- - - - - - - - - - - - - - - - - - - - - - - -{ UPDATE: BRANCH }
           MOVE LN-OWNBR  TO HOLD-WK3-BRANCH.
           MOVE 999       TO HOLD-WK3-CLASS.
           MOVE 99999999  TO HOLD-WK3-ACCTNO.
           PERFORM UPDATE-WK3-FIND.
           PERFORM UPDATE-WK3-RECORD.

      *- - - - - - - - - - - - - - - - - - - - - - - -{ UPDATE: GRAND  }
           MOVE 99999     TO HOLD-WK3-BRANCH.
           MOVE 999       TO HOLD-WK3-CLASS.
           MOVE 99999999  TO HOLD-WK3-ACCTNO.
           PERFORM UPDATE-WK3-FIND.
           PERFORM UPDATE-WK3-RECORD.

           GO TO UPDATE-WK3-FILE-EXIT.

      *=================================================================
       UPDATE-WK3-FIND.

           MOVE HOLD-WK3-KEY TO WK3-KEY.
           PERFORM READ-WK3-FILE.

           IF ( IO-BAD )
              MOVE SPACES       TO WK3-REC
              MOVE HOLD-WK3-KEY TO WK3-KEY
              MOVE ZEROS        TO WK3-BALANCE
                                   WK3-CONTRACTUAL-PAID-THRU-DATE
                                   WK3-INT-SINCE-LSTPY
                                   WK3-INT-PAID-THRU-DATE
                                   WK3-INCOME-ACCRUE-AMOUNT
                                   WK3-TRUE-ACCRUE-AMOUNT
                                   WK3-CONTRACTUAL-STATUS
                                   WK3-INT-OWED
                                   WK3-NUMBER-ACCTS
              PERFORM WRITE-WK3-FILE

              IF ( IO-BAD )
                 GO TO IO-ERROR.

      *=================================================================
       UPDATE-WK3-RECORD.

           IF ( NOT WK3-GRAND-TOTALS ) AND
              ( NOT WK3-BRANCH-TOTALS) AND
              ( NOT WK3-CLASS-TOTALS )

              MOVE LN-ACCTNO         TO WK3-ACCTNO

      *       MOVE LN-SSNO(1) TO BW-SSNO
      *       PERFORM READ-BW1-FILE
              MOVE BW-LNAME          TO WK3-LNAME
              MOVE BW-FNAME          TO WK3-FNAME

              MOVE HOLD-LN-INTPDTH-DATE TO WK3-INT-PAID-THRU-DATE

              MOVE LN-1STPYDATE      TO PDTH-DATE-WORK
              PERFORM PAID-THRU-CALCULATION
              MOVE PDTH-DATE-FULL    TO WK3-CONTRACTUAL-PAID-THRU-DATE
              MOVE MONTH-END-DATE    TO AGEING-DATE
              PERFORM COMPUTE-CONTRACTUAL
              MOVE CONTRACTUAL    TO WK3-CONTRACTUAL-STATUS.

           ADD  INT-SINCE-LSTPY   TO WK3-INT-SINCE-LSTPY.
           ADD  INTBAL            TO WK3-INT-OWED.
           ADD  TRUE-ACCRUE       TO WK3-TRUE-ACCRUE-AMOUNT.
           ADD  ACCRUED           TO WK3-INCOME-ACCRUE-AMOUNT.
           ADD  LN-CURBAL         TO WK3-BALANCE.

           ADD 1   TO WK3-NUMBER-ACCTS.

           PERFORM REWRITE-WK3-FILE.

      *=================================================================
       UPDATE-WK3-FILE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R O C E S S - B O R R O W E R
      *
      ******************************************************************
       PROCESS-BORROWER SECTION.

           MOVE LN-SSNO(1) TO BW-SSNO. 
      *    PERFORM READ-BW1-FILE.
      *    IF ( IO-BAD )
           IF BW-LNAME = SPACES
              MOVE "**NOT ON FILE**" TO D-BWNAME
              GO TO END-PROCESS-BORROWER.

           MOVE BW-LNAME TO NAME-WORKER.
           MOVE BW-FNAME TO FIRST-NAME.

           INSPECT NAME-WORKER REPLACING FIRST "  " BY ",?".
           INSPECT NAME-WORKER REPLACING FIRST "                "
                   BY FIRST-NAME.

           INSPECT NAME-WORKER REPLACING ALL "?" BY " ".

           MOVE NAME-WORKER TO D-BWNAME.

           IF ( SP-1098FRMLA = "B" )
              PERFORM GET-COLLATERAL
              PERFORM UPDATE-BW1-FILE.
      *    ELSE
      *       UNLOCK BW-FILE.

       END-PROCESS-BORROWER.
           EXIT.

      ******************************************************************
      *
      *    H E A D - P A G E
      *
      ******************************************************************
       HEAD-PAGE SECTION.

           ADD  1           TO PAGE-NUMBER.
           MOVE PAGE-NUMBER TO H-PAGE-NO.
           PERFORM GET-TIME.
           MOVE T-HH        TO H-HR.
           MOVE T-MM        TO H-MIN.

           IF ( SUMMARY-FG = "Y" )
              GO TO HEAD-SUMMARY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 01 }
           MOVE HEAD1 TO PR-REC.
           MOVE 99 TO LN-FEED.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 02 }
           IF PRINT-ID = "D"
              MOVE "UNEARNED / EARNED ACCRUAL REPORT" TO H-TITLE
              MOVE SPACES                                TO H-MESS
           ELSE
              IF IB-EXCEPTION-HEAD-PRINT-FG = "Y"
                 MOVE "IB LOANS EXCEEDING MAX ACCRUE DAYS"
                                                    TO H-TITLE
                 MOVE SPACES                        TO H-MESS
              ELSE
                 MOVE IB-TITLE                      TO H-TITLE
                 MOVE IB-MESS                       TO H-MESS.

           MOVE HEAD2 TO PR-REC.
           MOVE 1 TO LN-FEED.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 03 }
           MOVE HEAD3 TO PR-REC.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 04 }
           MOVE HEAD4 TO PR-REC.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 05 }
           IF PRINT-ID = "D"
              IF (PROCESSING-PROGRAM = "AC1ERN")
                 MOVE ORIGINAL-HEAD5-AC1ERN TO PR-REC
              ELSE
                 MOVE ORIGINAL-HEAD5-AC1DAY TO PR-REC
           ELSE
              IF IB-EXCEPTION-HEAD-PRINT-FG = "Y"
                 MOVE IB-HEAD5-IBE TO PR-REC
              ELSE
                 MOVE IB-HEAD5     TO PR-REC.
           PERFORM WRITE-PR-REC.


      *CS  IF ( PROCESSING-PROGRAM = "AC1ERN" )
      *CS     MOVE HEAD5-AC1ERN TO PR-REC
      *CS  ELSE
      *CS     MOVE HEAD5-AC1DAY TO PR-REC.

      *CS  PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 06 }

           IF PRINT-ID = "D"
               MOVE ORIGINAL-HEAD6 TO PR-REC
           ELSE
               IF IB-EXCEPTION-HEAD-PRINT-FG = "Y"
                  MOVE IB-HEAD6-IBE TO PR-REC
               ELSE
                  MOVE IB-HEAD6      TO PR-REC.

           PERFORM WRITE-PR-REC.


      *CS  MOVE HEAD6 TO PR-REC.
      *CS  PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE 6 TO LN-COUNT.
           MOVE 2 TO LN-FEED.
           GO TO END-HEAD-PAGE.

      *-----------------------------------------------------------------
       HEAD-SUMMARY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 01 }
           MOVE HEAD1 TO PR-REC.
           MOVE 99 TO LN-FEED.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 02 }
           MOVE HEAD2 TO PR-REC.
           MOVE 1 TO LN-FEED.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 03 }
           MOVE SUMMARY1 TO PR-REC.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 04 }
           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              MOVE SUMMARY2-AC1ERN TO PR-REC
           ELSE
              MOVE SUMMARY2-AC1DAY TO PR-REC.

           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - -{ LINE: 05 }
           MOVE SUMMARY3 TO PR-REC.
           PERFORM WRITE-PR-REC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE 5 TO LN-COUNT.
           MOVE 2 TO LN-FEED.

       END-HEAD-PAGE.
           EXIT.

      ******************************************************************
      *
      *    W R I T E - D E T A I L - L I N E
      *
      ******************************************************************
       WRITE-DETAIL-LINE SECTION.

           ADD LN-FEED TO LN-COUNT.

           IF ( LN-COUNT > EXT-CONAME-RPT-LINES ) PERFORM HEAD-PAGE.

           MOVE DETAIL-LINE TO PR-REC.
           PERFORM WRITE-PR-REC.

           MOVE 1 TO LN-FEED.
           MOVE SPACES TO DETAIL-LINE.

       WRITE-DETAIL-LINE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    C L A S S - T O T A L S
      *
      ******************************************************************
       CLASS-TOTALS SECTION.

      *SUM-ONLY OPTION AVAILABLE IF RUNNING DAILY ACCRUAL (AC1DAY WITH
      *SUMMARY PRINT OPTION.  IF SUM-ONLY = "Y" TOTALS ARE HANDLED IN AC1DAY)

           MOVE 1               TO SUB.

           IF SUM-ONLY = "Y"
              GO TO END-CLASS-TOTALS.

           MOVE 3               TO LN-FEED.
           MOVE "CLASS TOTALS:" TO D-TAG.
      *CS  MOVE 1               TO SUB.
           PERFORM PRINT-TOTALS.

           IF ( BR-TOTALS = "N" )
              MOVE EXT-CONAME-RPT-LINES TO LN-COUNT
              MOVE 1            TO LN-FEED.

      *=================================================================
       END-CLASS-TOTALS.

           MOVE ZEROES TO T-NOACCTS  (1)           T-UNEARN         (1)
                          T-INT      (1)           T-ADDON          (1)
                          T-SRV      (1)           T-MFEE           (1)
                          T-DISC     (1)           T-OTHER          (1)
                          T-CASH-EARN(1)           T-ENDING         (1)
                          T-ACCRUED  (1)           T-TRUE-ACCRUE    (1)
                          T-INTBAL   (1)           T-INT-SINCE-LSTPY(1).

       EXIT-CLASS-TOTALS.
           EXIT.

      ******************************************************************
      *
      *    B R A N C H - T O T A L S
      *
      ******************************************************************
       BRANCH-TOTALS SECTION.

      *SUM-ONLY OPTION AVAILABLE IF RUNNING DAILY ACCRUAL (AC1DAY WITH
      *SUMMARY PRINT OPTION.  IF SUM-ONLY = "Y" TOTALS ARE HANDLED IN AC1DAY)

           MOVE 2 TO SUB.

           IF SUM-ONLY  = "Y"
                 GO TO END-BRANCH-TOTALS.

           MOVE 2 TO LN-FEED.

           IF ( SUMMARY-FG = "N" )
              MOVE "BRANCH TOTALS:" TO D-TAG
              PERFORM PRINT-TOTALS
           ELSE
              MOVE "   ---- TOTAL:" TO D-TAG
              PERFORM PRINT-SUM-BRANCH.

           IF ( SUMMARY-FG  = "N" )
              MOVE EXT-CONAME-RPT-LINES TO LN-COUNT
              MOVE 1 TO LN-FEED.

           MOVE "N" TO BR-TOTALS.



      *=================================================================
       END-BRANCH-TOTALS.

           MOVE ZEROES TO T-NOACCTS  (2)         T-UNEARN         (2)
                          T-INT      (2)         T-ADDON          (2)
                          T-SRV      (2)         T-MFEE           (2)
                          T-DISC     (2)         T-OTHER          (2)
                          T-CASH-EARN(2)         T-ENDING         (2)
                          T-ACCRUED  (2)         T-TRUE-ACCRUE    (2)
                          T-INTBAL   (2)         T-INT-SINCE-LSTPY(2).

      *-----------------------------------------------------------------
       EXIT-BRANCH-TOTALS.
           EXIT.

      ******************************************************************
      *
      *    P R I N T - T O T A L S
      *
      ******************************************************************
       PRINT-TOTALS SECTION.

           IF ( PRINT-ID = "S" OR "D" )
              MOVE T-NOACCTS  (SUB) TO D-T-NOACCTS-T
              MOVE "#"              TO D-T-TAG-T
              MOVE T-UNEARN   (SUB) TO D-T-UNEARN-T
              MOVE T-ADDON    (SUB) TO D-T-ADDON-T
              MOVE T-MFEE     (SUB) TO D-T-MFEE-T
              MOVE T-OTHER    (SUB) TO D-T-OTHER-T
              MOVE T-ENDING   (SUB) TO D-T-ENDING-T
              PERFORM WRITE-DETAIL-LINE
              MOVE T-INT      (SUB) TO D-T-INT-T
              MOVE T-SRV      (SUB) TO D-T-SRV-T
              MOVE T-DISC     (SUB) TO D-T-DISC-T
              MOVE T-CASH-EARN(SUB) TO D-T-CASH-EARN-T
           ELSE
              MOVE T-NOACCTS        (SUB) TO D-T-NOACCTS-T
              MOVE "#"                    TO D-T-TAG-T
              MOVE T-ACCRUED        (SUB) TO D-T-ACCRUED-T
              MOVE T-TRUE-ACCRUE    (SUB) TO D-T-TRUE-ACCRUE-T
              MOVE T-INTBAL         (SUB) TO D-T-INTBAL-T
              MOVE T-INT-SINCE-LSTPY(SUB) TO D-T-INT-SINCE-LSTPY-T.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM WRITE-DETAIL-LINE.

       PRINT-TOTALS-EXIT.
           EXIT.

      ******************************************************************
      *
      *    P R I N T - S U M - B R A N C H
      *
      ******************************************************************
       PRINT-SUM-BRANCH SECTION.

           MOVE T-NOACCTS(SUB) TO D-T-NOACCTS.
           MOVE "#"            TO D-T-TAG.

           IF ( PRINT-ID = "S" OR "D" )
              MOVE T-UNEARN   (SUB) TO D-T-UNEARN
              MOVE T-ADDON    (SUB) TO D-T-ADDON
              MOVE T-MFEE     (SUB) TO D-T-MFEE
              MOVE T-OTHER    (SUB) TO D-T-OTHER
              MOVE T-INT      (SUB) TO D-T-INT
              MOVE T-SRV      (SUB) TO D-T-SRV
              MOVE T-DISC     (SUB) TO D-T-DISC
              MOVE T-CASH-EARN(SUB) TO D-T-CASH-EARN
              MOVE T-ENDING   (SUB) TO D-T-ENDING
           ELSE
              MOVE T-ACCRUED        (SUB) TO D-T-ACCRUED
              MOVE T-TRUE-ACCRUE    (SUB) TO D-T-TRUE-ACCRUE
              MOVE T-INTBAL         (SUB) TO D-T-INTBAL
              MOVE T-INT-SINCE-LSTPY(SUB) TO D-T-INT-SINCE-LSTPY.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           PERFORM WRITE-DETAIL-LINE.

       PRINT-SUM-BRANCH-EXIT.
           EXIT.

      ******************************************************************
      *
      *    C R E A T E - P L - W X - R E C
      *
      *-----------------------------------------------------------------
      *    CREATE KEY FILE RECORD FOR PL UNEARNED REPORT
      ******************************************************************
      *CREATE-PL-WX-REC SECTION.

      *    IF LN-PLDATE > MONTH-END-DATE
      *       GO TO CREATE-PL-WX-REC-EXIT.

      *    MOVE MONTH-END-DATE TO NUM-DATE.
      *    MOVE 1              TO NUM-DA.
      *    IF LN-PLDATE < NUM-DATE
      *       GO TO CREATE-PL-WX-REC-EXIT.

      *    MOVE "P"               TO WX-TYPE.
      *    MOVE LN-OWNBR          TO WX-OWNBR.
      *    MOVE LN-CLASS          TO WX-CLASS.
      *    MOVE LN-ACCTNO         TO WX-ACCTNO.
      *    MOVE LN-NONACRERN      TO WX-LN-NONACRERN.
      *    MOVE LN-PRIOR-UNEARNED TO WX-LN-PRIOR-UNEARNED.
      *    MOVE LN-PLCD           TO SAVE-PLCD.
      *    MOVE LN-PLDATE         TO SAVE-PLDATE.
      *    MOVE SPACES            TO LN-PLCD.
      *    MOVE 0                 TO LN-PLDATE.
      *    PERFORM COMPUTE-EARNINGS.
      *    MOVE SAVE-PLCD         TO LN-PLCD.
      *    MOVE SAVE-PLDATE       TO LN-PLDATE.
      *    MOVE EARNINGS-WORKERS  TO WX-EARNINGS-WORKERS.

      *    PERFORM WRITE-WX1-FILE.

      *    IF ( IO-BAD )
      *       GO TO IO-ERROR.

      *    MOVE "N" TO FIRST-TIME-WX.

      *CREATE-PL-WX-REC-EXIT.
      *    EXIT.

      ******************************************************************
      *
      *    C R E A T E - N O N - W X - R E C
      *
      *-----------------------------------------------------------------
      *    CREATE KEY FILE RECORD FOR NON ACCRUAL REPORT
      ******************************************************************
      *CREATE-NON-WX-REC SECTION.

      *    MOVE SPACES TO COMPUTE-EARNINGS-DONE.

      *    IF ( LN-NONACRERN NOT = 0      ) OR (LN-POCD = "**")
      *       MOVE "N"               TO WX-TYPE
      *       MOVE LN-OWNBR          TO WX-OWNBR
      *       MOVE LN-CLASS          TO WX-CLASS
      *       MOVE LN-ACCTNO         TO WX-ACCTNO
      *       MOVE LN-NONACRERN      TO WX-LN-NONACRERN
      *       MOVE LN-PRIOR-UNEARNED TO WX-LN-PRIOR-UNEARNED
      *       PERFORM COMPUTE-EARNINGS
      *       MOVE "Y"               TO COMPUTE-EARNINGS-DONE
      *       MOVE EARNINGS-WORKERS  TO WX-EARNINGS-WORKERS
      *       PERFORM WRITE-WX1-FILE
      *       IF ( IO-BAD )
      *          GO TO IO-ERROR
      *       ELSE
      *          MOVE "N" TO FIRST-TIME-WX.

      *CREATE-NON-WX-REC-EXIT.
      *    EXIT.

      ******************************************************************
      *    LOG ERROR IN GLOBAL LG DIRECTORY
      ******************************************************************
       LOG-ERROR SECTION.

           MOVE "A"           TO ERRLOGW-ACTION.
           MOVE BR-NO         TO ERRLOGW-BRNO.
           MOVE FORM-PATHNAME TO ERRLOGW-PROGX.
           MOVE "CL/ERRLOG"   TO FORM-NAM.

           CALL FORM-PROGX USING FORM-PATH ERRLOGW-AREA.
           CANCEL FORM-PROGX.


      ******************************************************************
      *
      *    C O M P U T E - A D D O N - E A R N I N G S
      *
      *-----------------------------------------------------------------
      *    COMPUTE NEW ACCRUAL EARNINGS NUMBERS
      ******************************************************************
       COMPUTE-ADDON-EARNINGS SECTION.

           IF QWS-LTI-ROWCOUNT = 0             
              GO TO END-COMPUTE-ADDON-EARNINGS.

           MOVE 0      TO ADDON-EARNINGS.

           PERFORM OPEN-LTI1-FILE.

           MOVE LTI-PATH-OWNBR  TO LTI-BRNO
                                   QLTI1-WBEG-BRNO
                                   QLTI1-WEND-BRNO.
           MOVE LN-ACCTNO       TO LTI-ACCTNO
                                   QLTI1-WBEG-ACCTNO
                                   QLTI1-WEND-ACCTNO.
           MOVE 0               TO LTI-SEQNO
                                   QLTI1-WBEG-SEQNO.
           MOVE ALL "9"         TO QLTI1-WEND-SEQNO.

           PERFORM START-LTI1-FILE.

       COMPUTE-ADDON-EARNINGS-NEXT.

           PERFORM READ-LTI1-FILE-NEXT. 
           IF ( IO-BAD )
              GO TO END-COMPUTE-ADDON-EARNINGS.
           
           IF (LTI-BRNO NOT = LTI-PATH-OWNBR) OR
                 ( LTI-ACCTNO NOT = LN-ACCTNO )
              GO TO END-COMPUTE-ADDON-EARNINGS.

           IF NOT (LTI-INT-REBATE = SPACES OR "C")
              GO TO COMPUTE-ADDON-EARNINGS-NEXT.

           IF ( LTI-INSPREM < 0      )
              MOVE -1 TO ONE
           ELSE
              MOVE +1 TO ONE.

           MOVE LTI-ORIG-1STPYDATE   TO AERN-LN-ORIG-1STPYDATE.
           MOVE LTI-ANTIC-START-DATE TO AERN-LN-LOANDATE
                                        AERN-LN-PURDATE
                                        AERN-LN-INTDATE.

           SUBTRACT LTI-PRIOR-NODEF FROM LN-TOTNODEF
                                  GIVING AERN-LN-TOTNODEF.

           MOVE LTI-ANTICTERM  TO AERN-LN-ANTICTERM.
           MOVE "N"            TO AERN-LN-SALEFIN.
           MOVE LTI-INT-REBATE TO AERN-LN-REBATE.

           MULTIPLY ONE BY LTI-ANTICERN(1) GIVING AERN-LN-ANTICERN.
           MULTIPLY ONE BY LTI-ANTICADJ(1) GIVING AERN-LN-ANTICADJ.
           MULTIPLY ONE BY LTI-UFERN   (1) GIVING AERN-LN-UFERN.
           MULTIPLY ONE BY LTI-ACCERN  (1) GIVING AERN-LN-ACCERN.

           MOVE MONTH-END-DATE       TO AERN-ENDDATE.
           MOVE LN-LAST-ACCRUAL-DATE TO AERN-LAST-ACCRUAL-DATE.
           MOVE "Y"                  TO AERN-ADDON-FG.
           MOVE 2                    TO AERN.

           PERFORM COMPUTE-AERNINGS.

           MULTIPLY ONE BY AERN-EARNINGS(2).
           ADD AERN-EARNINGS(2) TO ADDON-EARNINGS
                                   LTI-ACCERN(1).

           MOVE AERN-EARNINGS(2) TO LTI-INT-LAST-EARNED.
           PERFORM REWRITE-LTI1-FILE.

           GO TO COMPUTE-ADDON-EARNINGS-NEXT.

       END-COMPUTE-ADDON-EARNINGS.

           PERFORM CLOSE-LTI1-FILE.

       EXIT-COMPUTE-ADDON-EARNINGS.
           EXIT.

      ******************************************************************
      *
      *    C L O S E - P R O C E S S I N G - F I L E S
      *
      *-----------------------------------------------------------------
      *    MUST *NOT* CLOSE THE BR-FILE, GR-FILE & PR-FILE FOR "AC1DAY".
      ******************************************************************
       CLOSE-PROCESSING-FILES SECTION.

           IF ( PROCESSING-PROGRAM = "AC1ERN" )
              PERFORM CLOSE-BR-FILE
              PERFORM CLOSE-PR-FILE.

           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-LC1-FILE.
           PERFORM CLOSE-LN1-FILE.
           PERFORM CLOSE-LTI1-FILE.
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-WK1-FILE.
      *    IF NOT GP-I-AM-WORLD
      *       PERFORM CLOSE-WX1-FILE.
      *    IF GP-USE-ACCRUAL-EARN-FILE = "Y" OR "R"
      *       PERFORM CLOSE-AE1-FILE.

       CLOSE-PROCESSING-FILE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    C O P Y - L I B R A R Y - S E C T I O N S
      *
      ******************************************************************
       COPY "LIBGB/AGEING.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBLP/ARRAYSP.CPY".
       COPY "LIBLP/ARRAYLC.CPY".
       COPY "LIBGB/GPENV.CPY".
       COPY "LIBGB/REBATE.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBGB/SPPDTH.CPY".
       COPY "LIBGB/TIMEIO.CPY".
       COPY "LIBLP/LPAERN.CPY".
       COPY "LIBLP/LPAMTS.CPY".
       COPY "LIBLP/LPAPRS.CPY".
       COPY "LIBLP/LPAPRZ.CPY".
       COPY "LIBLP/LPCEPP.CPY".
       COPY "LIBLP/LPCERN.CPY".
       COPY "LIBLP/LPEADJ.CPY".
       COPY "LIBLP/LPEARN.CPY".
       COPY "LIBLP/LPIBPC.CPY".
       COPY "LIBLP/LPITRM.CPY".
       COPY "LIBLP/LPMDTE.CPY".
       COPY "LIBLP/LPPDUE.CPY".
       COPY "LIBLP/LPRATE.CPY".
       COPY "LIBLP/LPREGZ.CPY".
       COPY "LIBLP/LPSTAT.CPY".
       COPY "LIBLP/LPUERN.CPY".
       COPY "LIBLP/LPUPER.CPY".
       COPY "LIBLP/LPUPWK.CPY".
       COPY "LIBLP/LPXDTE.CPY".
       COPY "LIBGB/RBACT.CPY".
       COPY "LIBLP/SETCTBL.CPY".
       COPY "LIBLP/LPFRVSP.CPY".
       COPY "LIBCL/TRACE.CPY".

      ******************************************************************
      *
      *    M I S C E L L A N E O U S - P A R A G R A P H S
      *
      ******************************************************************
       MISC-PARAGRAPHS SECTION.
       COPY "LIBGB/DACCESS.CPY".
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/GETENV.CPY".
       COPY "LIBGB/GETPR.CPY".
       COPY "LIBGB/MKTEMP.CPY".
       COPY "LIBGB/SYSTEM.CPY".
       COPY "LIBGB/RMFILE.CPY".
       SETUP-LINK-INFO.
       FORM-RESET.
       VDU-CONVERT-FIELD.

      *-----------------------------------------------------------------
       GET-COLLATERAL.

           MOVE LN-COLLCD TO CD-CODE.
           MOVE "CO"      TO CD-TYPE.
      *    PERFORM READ-CD1-FILE.
      *    IF ( IO-BAD )
      *       MOVE SPACES TO CD-CO-SECURED.

      *-----------------------------------------------------------------
       GET-LC.

           MOVE LC-CODE TO HOLD-LN-CLASS.
      *    PERFORM READ-LC1-FILE.
           PERFORM ARRAYLC-READ. 
           IF ( IO-BAD )
              MOVE "*** NOT FOUND ***" TO LC-DESC.

      *-----------------------------------------------------------------
       GET-SP.
           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.

           IF ( LPWSSP-SP1-KEY NOT = SP1-KEY )
              MOVE SP1-KEY TO LPWSSP-SP1-KEY VSP1-KEY
      *       PERFORM READ-SP1-FILE
      *       PERFORM ARRAYSP-READ 
              PERFORM OPEN-VSP1-FILE
              PERFORM READ-VSP1-FILE
              PERFORM CLOSE-VSP1-FILE
              IF IO-BAD
                 GO TO IO-ERROR
              ELSE
                 MOVE VSP-SP-REC         TO SP-REC
                 MOVE SP-MAX-IB-ACR-DAYS TO HOLD-SP-MAX-IB-ACR-DAYS
           ELSE
              MOVE HOLD-SP-MAX-IB-ACR-DAYS TO SP-MAX-IB-ACR-DAYS.

      *=================================================================
       SEND-ACCOUNT.

           MOVE 0            TO DISPLAY-MESS-CL DISPLAY-MESS-LN.
           MOVE DISPLAY-MESS TO MESS.

           MOVE DISPLAY-MESS TO WR-BUF.
           MOVE DISPLAY-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

      *-----------------------------------------------------------------
       SEND-LEGEND.

           MOVE MESS TO WR-BUF.
           MOVE MESS-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

      *-----------------------------------------------------------------
       SEND-MSEL.

           MOVE MSEL-BUF TO WR-BUF.
           MOVE MSEL-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

      *=================================================================
       SET-BRANCH-HEADINGS.

           MOVE BR-NO   TO H-BRNO.
           MOVE BR-NAME TO H-BRDESC.

      *-----------------------------------------------------------------
       SET-CLASS-HEADINGS.

           MOVE HOLD-LN-CLASS TO H-LCNO LC-CODE.
           PERFORM GET-LC.
           MOVE LC-DESC   TO H-LCDESC.

      *-----------------------------------------------------------------
       SET-IB-BRANCH-HEADINGS.

           MOVE BR-NO   TO H-BRNO.
           MOVE BR-NAME TO H-BRDESC.

      *-----------------------------------------------------------------
       SET-IB-CLASS-HEADINGS.

           MOVE HOLD-LN-CLASS TO H-LCNO LC-CODE.
           PERFORM GET-LC.
           MOVE LC-DESC   TO H-LCDESC.

      *-----------------------------------------------------------------
       SET-PRINT-D.

           MOVE "/ED/ACR"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "D"        TO PRINT-ID.
           MOVE "UNEARNED" TO PRINT-DESC.

      *-----------------------------------------------------------------
       SET-PRINT-IB-D.

           MOVE "/ED/ACR"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "R"        TO PRINT-ID.
           MOVE "IBACCRUE" TO PRINT-DESC.
           MOVE IB-TITLE   TO H-TITLE.
           MOVE IB-MESS    TO H-MESS.
           MOVE IB-HEAD5   TO HEAD5-AC1DAY HEAD5-AC1ERN.
           MOVE IB-HEAD6   TO HEAD6.

      *-----------------------------------------------------------------
       SET-PRINT-NON-D.

           MOVE "/ED/AC2"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "D"        TO PRINT-ID.
           MOVE "NONACCRU" TO PRINT-DESC.

      *-----------------------------------------------------------------
       SET-PRINT-NON-S.

           MOVE "/ED/AC2"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "S"        TO PRINT-ID.
           MOVE "NONACCRU" TO PRINT-DESC.

      *-----------------------------------------------------------------
       SET-PRINT-PL-D.

           MOVE "/ED/AC2"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "R"        TO PRINT-ID.
           MOVE "PLUNEARN" TO PRINT-DESC.

      *-----------------------------------------------------------------
       SET-PRINT-PL-S.

           MOVE "/ED/AC2"  TO PRINT-ALL-PATH.
           MOVE END-DATE-MMYY   TO PRINT-ENDDATE.
           MOVE "T"        TO PRINT-ID.
           MOVE "PLUNEARN" TO PRINT-DESC.

      *-----------------------------------------------------------------
      *    TRANSFER TO /USR/PD/(DAY)/(BRNO)(STEP)(NAME)
      *-----------------------------------------------------------------
      *SET-TRANSFER.

      *    MOVE PRINT-PATH   TO UUCP-FILE.
      *    MOVE GB-UUCP-HOME TO UUCP-HOME.
      *    MOVE TRANS-DA     TO UUCP-DAY.
      *KC->MOVE USER-BRANCH  TO UUCP-BRNO.
      *    MOVE EXT-CONAME-USER-LOC TO UUCP-BRNO.
      *    MOVE SPACES       TO SYSTEM-BUF.

      *=================================================================
       UPDATE-BW1-FILE.

XXX   *    IF LN-ACCTNO = 119465 AND
XXX        IF BW-SSNO   = 436175464      
XXX   D         STOP MESS
XXX             MOVE SPACES TO MESS
                MOVE "REGGIE@STUPID.COM" TO BW-EMAIL.  

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE ALL "="                 TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE ADDON         TO Z-ADDON.
           MOVE WS-INT        TO Z-WS-INT.
           MOVE BW-INTYTD     TO Z-BW-INTYTD.
           MOVE BW-RE-INTYTD  TO Z-BW-RE-INTYTD.

           STRING LN-ACCTNO, " | ",
                  LN-COLLCD, " | ",
                  CD-CO-SECURED, " | ",
                  Z-BW-RE-INTYTD, " | ",
                  Z-BW-INTYTD
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING Z-ADDON, " | ",
                  Z-WS-INT, " | ",
                  BW-OWNBR, " | ",
                  BW-SSNO, " | ",
                  BW-EMAIL
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE ALL "- "                TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING QBW-OWNBR, " | ",
                  QBW-SSNO, " | ",
                  QBW-RE-INTYTD, " | ",
                  QBW-INTYTD, " | ",
                  QBW-EMAIL
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           IF ( CD-CO-SECURED = "R" )
              COMPUTE BW-RE-INTYTD = BW-RE-INTYTD
                                   + WS-INT
                                   + ADDON
      *#671                        + SRV
      *#671                        + MFEE
           ELSE
              COMPUTE BW-INTYTD = BW-INTYTD
                                + WS-INT
                                + ADDON.
      *#671                     + SRV
      *#671                     + MFEE.

           PERFORM REWRITE-BW1-FILE. *> EMBEDDED - BWFILE

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE ALL "-"                 TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE ADDON         TO Z-ADDON.
           MOVE WS-INT        TO Z-WS-INT.
           MOVE BW-INTYTD     TO Z-BW-INTYTD.
           MOVE BW-RE-INTYTD  TO Z-BW-RE-INTYTD.

           STRING LN-ACCTNO, " | ",
                  LN-COLLCD, " | ",
                  CD-CO-SECURED, " | ",
                  Z-BW-RE-INTYTD, " | ",
                  Z-BW-INTYTD
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING Z-ADDON, " | ",
                  Z-WS-INT, " | ",
                  BW-OWNBR, " | ",
                  BW-SSNO, " | ",
                  BW-EMAIL
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           MOVE ALL "- "                TO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.

           STRING QBW-OWNBR, " | ",
                  QBW-SSNO, " | ",
                  QBW-RE-INTYTD, " | ",
                  QBW-INTYTD, " | ",
                  QBW-EMAIL
                  DELIMITED BY "  "   INTO EXT-TCLP-TRACE-MESS.
           MOVE FORM-PATHNAME           TO EXT-TCLP-TRACE-FORM-PATH.
           PERFORM TRACE-SEND-MESS.
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      *-----------------------------------------------------------------
       UPDATE-LN1-FILE.

           IF LN-REC NOT = HOLD-LN-REC
              PERFORM READ-LN1-FILE *> EMBEDDED - LNFILE 
              IF ( IO-BAD )
                 GO TO IO-ERROR.

           ADD WS-INT  TO LN-ACCERN(1) LN-TOTERN.
           ADD ADDON   TO LN-ACCERN(2) LN-TOTERN.
           ADD SRV     TO LN-ACCERN(3) LN-TOTERN.
           ADD MFEE    TO LN-ACCERN(4).
           ADD WS-DISC TO LN-ACCERN(5) LN-TOTERN.
           ADD W-OTHER TO LN-ACCERN(6).

           IF NOT(GP-INCL-OTH-IN-EARNED-N OR GP-INCL-OTH-IN-EARNED-R)
              ADD W-OTHER      TO LN-TOTERN.

      *REGACC DOES NOT WANT TO INCLUDE MFEE.. THEY USE TO AMORTIZE THE
      *PARTICIPATION EXPENSE
           IF NOT( GP-INCL-OTH-IN-EARNED-R )
              ADD MFEE TO LN-TOTERN.

           IF ( SP-1098FRMLA = "B" )
              ADD WS-INT   TO LN-YTDINTPD LN-TOTINTPD
              ADD ADDON TO LN-YTDINTPD LN-TOTINTPD.
      *PR#617 1098 INTEREST SHOULD ONLY BE INTEREST
      *       ADD SRV   TO LN-YTDINTPD LN-TOTINTPD
      *       ADD MFEE  TO LN-YTDINTPD LN-TOTINTPD.

           MOVE AERN-ERNDELQ-STOP          TO LN-ERNDELQ-STOP.
      *????
           IF AERN-ERNDELQ-STOP = "R"
              MOVE "C" TO LN-ERNDELQ-STOP.

           MOVE AERN-NEW-LAST-ACCRUAL-DATE TO LN-LAST-ACCRUAL-DATE.
           MOVE ENDING                     TO LN-PRIOR-UNEARNED.

      *CS 03/12/01 MERC-NEEDS PRIOR MONTH INTEREST COMPONENT ONLY

           MOVE ENDING-INT                 TO LN-LMO-PRIOR-INTEREST.

           MOVE LN-NONACRERN               TO LN-PRIOR-NONACRERN.
           MOVE 0                          TO LN-NONACRERN.

           PERFORM REWRITE-LN1-FILE. *> EMBEDDED - LNFILE
           IF ( IO-BAD )
              GO TO IO-ERROR.

      *-----------------------------------------------------------------------
      *    DUMMY SECTION TO INCLUDE IN COPY MEMBERS THAT NEED TO BE
      *    REFLECTED IN 'WHAT' COMMANDS FOR SUPPORT
      *-----------------------------------------------------------------------
       SCCS-COPY-ROUTINE SECTION. MOVE
           "@(#)LIBLP/AC1DVR A15 08/29/02-10:37:02 COPY MEMBER >"
              TO MESS.

      ******************************************************************
       IO-ROUTINE SECTION.
      ******************************************************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBLP/LPSPGS_SQL.CPY".
       COPY "LIBLP/LPLTPGS_SQL.CPY".
       COPY "LIBLP/LPLTIGS_SQL.CPY".
       COPY "LIBLP/LPLNGS_SQL.CPY".
       COPY "LIBLP/LPLCGS_SQL.CPY".
       COPY "LIBLP/LPCDGS_SQL.CPY".
       COPY "LIBLP/LPBWGS_SQL.CPY".
       COPY "LIBGB/GBGBGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBGB/GBPRINT.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBLP/LPVSP1IN.CPY".
      * COPY "LIBGB/GBGBIN.CPY".
      * COPYMEMBER: LIBGB/GBGBIN
       LOAD-GB-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( GB-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( GB-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO GB-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO GB-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO GB-ALL-DATA
              MOVE GB-ALL-PATH             TO GB-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( GB-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO GB-ALL-BASE
              MOVE FILPATH-MACHINE         TO GB-ALL-MACHINE
              MOVE FILPATH-DATA            TO GB-ALL-DATA
              MOVE GB-ALL-PATH             TO GB-PATH.

      *-----------------------------------------------------------------
       OPEN-GB-FILE.
           PERFORM LOAD-GB-FILE.
           PERFORM OPEN-IT.
           MOVE GB-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-GB-FILE.
           PERFORM START-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.

           IF ( GB-CURSOR-STAT-GOOD )
              PERFORM CLOSE-GB-FILE.

           IF ( QGB-WEND-NO = ZEROES    ) OR
              ( QGB-WEND-NO NOT NUMERIC )
              MOVE GB-PATH-OWNBR    TO QGB-WBEG-BRNO
              MOVE GB-PATH-OWNBR    TO QGB-WEND-BRNO
              MOVE GB-NO            TO QGB-WBEG-NO
              MOVE 9                TO QGB-WEND-NO.

           EXEC SQL
            DECLARE GB_CURSOR CURSOR FOR
            SELECT GBFILE.GB_BRNO,
                   GBFILE.GB_NO,
                   CAST(GBFILE.GB_LTOUCH_DATE AS VARCHAR(10)),
                   GBFILE.GB_COMPANY_NAME,
                   GBFILE.GB_ADDR_1,
                   GBFILE.GB_ADDR_2,
                   GBFILE.GB_CITY,
                   GBFILE.GB_STATE,
                   GBFILE.GB_ZIP,
                   GBFILE.GB_PHONE,
                   GBFILE.GB_NEXT_SF,
                   GBFILE.GB_NEXT_SMALL,
                   GBFILE.GB_NEXT_OTHER,
                   GBFILE.GB_HOLIDAY_1,
                   GBFILE.GB_HOLIDAY_2,
                   GBFILE.GB_HOLIDAY_3,
                   GBFILE.GB_HOLIDAY_4,
                   GBFILE.GB_HOLIDAY_5,
                   GBFILE.GB_HOLIDAY_6,
                   GBFILE.GB_HOLIDAY_7,
                   GBFILE.GB_HOLIDAY_8,
                   GBFILE.GB_HOLIDAY_9,
                   GBFILE.GB_HOLIDAY_10,
                   GBFILE.GB_HOLIDAY_11,
                   GBFILE.GB_HOLIDAY_12,
                   GBFILE.GB_HOLIDAY_13,
                   GBFILE.GB_HOLIDAY_14,
                   GBFILE.GB_HOLIDAY_15,
                   GBFILE.GB_HOLIDAY_16,
                   GBFILE.GB_RPT_LINES,
                   GBFILE.GB_CHECK_PROG,
                   GBFILE.GB_OTHER_BRANCH_POST,
                   GBFILE.GB_LAST_ACCRUE,
                   GBFILE.GB_AUTO_DEPOSIT,
                   GBFILE.GB_UUCP_HOME,
                   GBFILE.GB_EOM_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOM_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOM_UPDATE_TIME,
                   GBFILE.GB_EOM_UPDATE_USERID,
                   GBFILE.GB_FISCAL_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYF_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYF_UPDATE_TIME,
                   GBFILE.GB_EOYF_UPDATE_USERID,
                   GBFILE.GB_CALENDAR_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYC_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYC_UPDATE_TIME,
                   GBFILE.GB_EOYC_UPDATE_USERID
            FROM DBO.GBFILE
            WHERE GBFILE.GB_BRNO = :QGB-WBEG-BRNO
              AND GBFILE.GB_NO >= :QGB-WBEG-NO
              AND GBFILE.GB_NO <= :QGB-WEND-NO
            ORDER BY GBFILE.GB_BRNO,
                     GBFILE.GB_NO
           END-EXEC.

           EXEC SQL
               OPEN GB_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QGB-WBEG-BRNO 
                          QGB-WEND-BRNO
                          QGB-WBEG-NO
                          QGB-WEND-NO.

           MOVE STAT---GOOD TO GB-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-GB-FILE.
           PERFORM READ-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO. 
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           INITIALIZE QGB-REC.

           MOVE GB-BRNO   TO QGB-BRNO.
           MOVE GB-NO     TO QGB-NO.

           EXEC SQL
            SELECT GBFILE.GB_BRNO,
                   GBFILE.GB_NO,
                   CAST(GBFILE.GB_LTOUCH_DATE AS VARCHAR(10)),
                   GBFILE.GB_COMPANY_NAME,
                   GBFILE.GB_ADDR_1,
                   GBFILE.GB_ADDR_2,
                   GBFILE.GB_CITY,
                   GBFILE.GB_STATE,
                   GBFILE.GB_ZIP,
                   GBFILE.GB_PHONE,
                   GBFILE.GB_NEXT_SF,
                   GBFILE.GB_NEXT_SMALL,
                   GBFILE.GB_NEXT_OTHER,
                   GBFILE.GB_HOLIDAY_1,
                   GBFILE.GB_HOLIDAY_2,
                   GBFILE.GB_HOLIDAY_3,
                   GBFILE.GB_HOLIDAY_4,
                   GBFILE.GB_HOLIDAY_5,
                   GBFILE.GB_HOLIDAY_6,
                   GBFILE.GB_HOLIDAY_7,
                   GBFILE.GB_HOLIDAY_8,
                   GBFILE.GB_HOLIDAY_9,
                   GBFILE.GB_HOLIDAY_10,
                   GBFILE.GB_HOLIDAY_11,
                   GBFILE.GB_HOLIDAY_12,
                   GBFILE.GB_HOLIDAY_13,
                   GBFILE.GB_HOLIDAY_14,
                   GBFILE.GB_HOLIDAY_15,
                   GBFILE.GB_HOLIDAY_16,
                   GBFILE.GB_RPT_LINES,
                   GBFILE.GB_CHECK_PROG,
                   GBFILE.GB_OTHER_BRANCH_POST,
                   GBFILE.GB_LAST_ACCRUE,
                   GBFILE.GB_AUTO_DEPOSIT,
                   GBFILE.GB_UUCP_HOME,
                   GBFILE.GB_EOM_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOM_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOM_UPDATE_TIME,
                   GBFILE.GB_EOM_UPDATE_USERID,
                   GBFILE.GB_FISCAL_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYF_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYF_UPDATE_TIME,
                   GBFILE.GB_EOYF_UPDATE_USERID,
                   GBFILE.GB_CALENDAR_EOY_TAG_CCYYMM,
                   CAST(GBFILE.GB_EOYC_UPDATE_DATE AS VARCHAR(10)),
                   GBFILE.GB_EOYC_UPDATE_TIME,
                   GBFILE.GB_EOYC_UPDATE_USERID
            INTO :QGB-REC
            FROM DBO.GBFILE
            WHERE GBFILE.GB_BRNO = :QGB-BRNO
              AND GBFILE.GB_NO = :QGB-NO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GB-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-GB-FIELDS.

      *-----------------------------------------------------------------
       READ-GB-FILE-NEXT.
           PERFORM READ-IT.
           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           INITIALIZE QGB-REC.

           IF ( GB-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH GB_CURSOR INTO :QGB-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GB-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-GB-FIELDS.

      *-----------------------------------------------------------------
       WRITE-GB-FILE.

           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           ACCEPT GB-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM WRITE-IT.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           PERFORM SET-GB-FIELDS.

           EXEC SQL
            INSERT INTO DBO.GBFILE
             (GBFILE.GB_BRNO,
              GBFILE.GB_NO,
              GBFILE.GB_LTOUCH_DATE,
              GBFILE.GB_COMPANY_NAME,
              GBFILE.GB_ADDR_1,
              GBFILE.GB_ADDR_2,
              GBFILE.GB_CITY,
              GBFILE.GB_STATE,
              GBFILE.GB_ZIP,
              GBFILE.GB_PHONE,
              GBFILE.GB_NEXT_SF,
              GBFILE.GB_NEXT_SMALL,
              GBFILE.GB_NEXT_OTHER,
              GBFILE.GB_HOLIDAY_1,
              GBFILE.GB_HOLIDAY_2,
              GBFILE.GB_HOLIDAY_3,
              GBFILE.GB_HOLIDAY_4,
              GBFILE.GB_HOLIDAY_5,
              GBFILE.GB_HOLIDAY_6,
              GBFILE.GB_HOLIDAY_7,
              GBFILE.GB_HOLIDAY_8,
              GBFILE.GB_HOLIDAY_9,
              GBFILE.GB_HOLIDAY_10,
              GBFILE.GB_HOLIDAY_11,
              GBFILE.GB_HOLIDAY_12,
              GBFILE.GB_HOLIDAY_13,
              GBFILE.GB_HOLIDAY_14,
              GBFILE.GB_HOLIDAY_15,
              GBFILE.GB_HOLIDAY_16,
              GBFILE.GB_RPT_LINES,
              GBFILE.GB_CHECK_PROG,
              GBFILE.GB_OTHER_BRANCH_POST,
              GBFILE.GB_LAST_ACCRUE,
              GBFILE.GB_AUTO_DEPOSIT,
              GBFILE.GB_UUCP_HOME,
              GBFILE.GB_EOM_TAG_CCYYMM,
              GBFILE.GB_EOM_UPDATE_DATE,
              GBFILE.GB_EOM_UPDATE_TIME,
              GBFILE.GB_EOM_UPDATE_USERID,
              GBFILE.GB_FISCAL_EOY_TAG_CCYYMM,
              GBFILE.GB_EOYF_UPDATE_DATE,
              GBFILE.GB_EOYF_UPDATE_TIME,
              GBFILE.GB_EOYF_UPDATE_USERID,
              GBFILE.GB_CALENDAR_EOY_TAG_CCYYMM,
              GBFILE.GB_EOYC_UPDATE_DATE,
              GBFILE.GB_EOYC_UPDATE_TIME,
              GBFILE.GB_EOYC_UPDATE_USERID)
            VALUES
             (:QGB-BRNO,
              :QGB-NO,
              :QGB-LTOUCH-DATE,
              :QGB-COMPANY-NAME,
              :QGB-ADDR-1,
              :QGB-ADDR-2,
              :QGB-CITY,
              :QGB-STATE,
              :QGB-ZIP,
              :QGB-PHONE,
              :QGB-NEXT-SF,
              :QGB-NEXT-SMALL,
              :QGB-NEXT-OTHER,
              :QGB-HOLIDAY-1,
              :QGB-HOLIDAY-2,
              :QGB-HOLIDAY-3,
              :QGB-HOLIDAY-4,
              :QGB-HOLIDAY-5,
              :QGB-HOLIDAY-6,
              :QGB-HOLIDAY-7,
              :QGB-HOLIDAY-8,
              :QGB-HOLIDAY-9,
              :QGB-HOLIDAY-10,
              :QGB-HOLIDAY-11,
              :QGB-HOLIDAY-12,
              :QGB-HOLIDAY-13,
              :QGB-HOLIDAY-14,
              :QGB-HOLIDAY-15,
              :QGB-HOLIDAY-16,
              :QGB-RPT-LINES,
              :QGB-CHECK-PROG,
              :QGB-OTHER-BRANCH-POST,
              :QGB-LAST-ACCRUE,
              :QGB-AUTO-DEPOSIT,
              :QGB-UUCP-HOME,
              :QGB-EOM-TAG-CCYYMM,
              :QGB-EOM-UPDATE-DATE,
              :QGB-EOM-UPDATE-TIME,
              :QGB-EOM-UPDATE-USERID,
              :QGB-FISCAL-EOY-TAG-CCYYMM,
              :QGB-EOYF-UPDATE-DATE,
              :QGB-EOYF-UPDATE-TIME,
              :QGB-EOYF-UPDATE-USERID,
              :QGB-CALENDAR-EOY-TAG-CCYYMM,
              :QGB-EOYC-UPDATE-DATE,
              :QGB-EOYC-UPDATE-TIME,
              :QGB-EOYC-UPDATE-USERID)
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO WRITE-GB-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       REWRITE-GB-FILE.

           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           ACCEPT GB-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           PERFORM SET-GB-FIELDS.

           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. *> USE UPDATE_CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.GBFILE
             SET
              GBFILE.GB_BRNO        = :QGB-BRNO,
              GBFILE.GB_NO          = :QGB-NO,
              GBFILE.GB_LAST_ACCRUE = :QGB-LAST-ACCRUE,
              GBFILE.GB_LTOUCH_DATE = :QGB-LTOUCH-DATE
           WHERE GBFILE.GB_BRNO     = :QGB-BRNO
             AND GBFILE.GB_NO       = :QGB-NO
           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-GB-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

           MOVE  '1' TO SQL-UPDATE-CONN-USE-SW. *> USE C1 CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *-----------------------------------------------------------------
       DELETE-GB-FILE.

           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           PERFORM DELETE-IT.
           MOVE GB-PATH-SQL    TO E-FILE.
           MOVE GB-KEY         TO E-KEYX.
           PERFORM SET-GB-FIELDS.

           EXEC SQL
            DELETE FROM DBO.GBFILE
             WHERE GBFILE.GB_BRNO = :QGB-BRNO
               AND GBFILE.GB_NO = :QGB-NO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-GB-FILE.

      *-----------------------------------------------------------------
       CLOSE-GB-FILE.

           PERFORM CLOSE-IT.

           IF ( GB-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE GB_CURSOR
              END-EXEC
              MOVE STAT---BAD TO GB-CURSOR-STAT.


      * COPY "LIBLP/LPBW1IN.CPY".
      * COPYMEMBER: LIBLP/LPBW1IN
       LOAD-BW1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( BW-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( BW-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO BW-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO BW-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO BW-ALL-DATA
              MOVE BW-ALL-PATH             TO BW-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( BW-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO BW-ALL-BASE
              MOVE FILPATH-MACHINE         TO BW-ALL-MACHINE
              MOVE FILPATH-DATA            TO BW-ALL-DATA
              MOVE BW-ALL-PATH             TO BW-PATH.

      *-----------------------------------------------------------------
       OPEN-BW1-FILE.
           PERFORM LOAD-BW1-FILE.
           PERFORM OPEN-IT.
           MOVE BW-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       REWRITE-BW1-FILE. *> EMBEDDED - BWFILE

           MOVE BW-PATH-OWNBR TO BW-OWNBR. 
           ACCEPT BW-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE BW-PATH-SQL TO E-FILE.

      *    MOVE SPACES         TO BW-VISION-KEY2
      *                           BW-VISION-KEY3
      *                           BW-VISION-KEY4.
      *    STRING BW-OWNBR, BW-LNAME, BW-FNAME
      *           DELIMITED BY SIZE INTO BW-VISION-KEY2.
      *    STRING BW-OWNBR, BW-SPSSNO
      *           DELIMITED BY SIZE INTO BW-VISION-KEY3.
      *    STRING BW-OWNBR, BW-SPLNAME, BW-SPFNAME
      *           DELIMITED BY SIZE INTO BW-VISION-KEY4.
      *    MOVE BW1-KEY        TO E-KEYX BW-VISION-KEY1.

           MOVE BW1-KEY        TO E-KEYX.
           PERFORM SET-BW-FIELDS.

           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. *> USE UPDATE_CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.BWFILE
             SET  BWFILE.BW_OWNBR       = :QBW-OWNBR,
                  BWFILE.BW_SSNO        = :QBW-SSNO,
                  BWFILE.BW_LNAME       = :QBW-LNAME,
                  BWFILE.BW_FNAME       = :QBW-FNAME,
                  BWFILE.BW_INTYTD      = :QBW-INTYTD,
                  BWFILE.BW_RE_INTYTD   = :QBW-RE-INTYTD,
                  BWFILE.BW_SOLICIT     = :QBW-SOLICIT,
                  BWFILE.BW_LTOUCH_DATE = :QBW-LTOUCH-DATE
           WHERE  BWFILE.BW_OWNBR       = :QBW-OWNBR
             AND  BWFILE.BW_SSNO        = :QBW-SSNO
           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-BW1-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

           MOVE '1' TO SQL-UPDATE-CONN-USE-SW. *> USE C1 CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.
 
      *-----------------------------------------------------------------
       CLOSE-BW1-FILE.
           PERFORM CLOSE-IT.


       COPY "LIBGB/GBWK3IN.CPY".
       COPY "LIBLP/LPCD1RN.CPY".
       COPY "LIBLP/LPLC1RN.CPY".

      * COPY "LIBLP/LPLN1IN.CPY".
      * COPYMEMBER: LIBLP/LPLN1IN
      ************************************************************
      *                (LPLN1IN)
      * REV:
      *  JTG 081497 CHANGED LN-SALEFIN TO LN-GIFTNET WORLD A90
      *  BLV 020698 ADDED LN-SALEFIN BACK TO BICREA CALL
      *  MJD 030398 ADDED LN-PLCD AND LN-CONVERCD TO BICREA CALL
      *  BAH 121023 ADDED FILPATH
      *  BAH 04/22/2016 ADDED LN-SMALLOAN TO BICREA CALL, REGENCY PR#5030
      *  BAH 20180316 ADDED LN-PLDATE TO BICREA CALL, WORLD #1308
      *  BAH 181130 GLOBAL LNFILE, L2G
      ************************************************************
       UPDATE-BI-FILE.
           IF IO-FG = 0
              MOVE "CL/BICREA" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH
                                   STAT
                                   LN-ACCTNO
                                   LN-BWTABLE
                                   LN-OWNBR
                                   LN-ORGST
                                   LN-SALEFIN
                                   LN-GIFTNET
                                   LN-ENTDATE
                                   LN-POFFDATE
                                   LN-PLCD
                                   LN-CONVERCD
                                   "000000000"
                                   LN-SMALLOAN
                                   LN-PLDATE
             CANCEL FORM-PROGX.
       LOAD-LN1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LN-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LN-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LN-ALL-BASE
              MOVE FILPATH-MACHINE         TO LN-ALL-MACHINE
              MOVE FILPATH-DATA            TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH.

      *-----------------------------------------------------------------
       OPEN-LN1-FILE.
           PERFORM LOAD-LN1-FILE.
           PERFORM OPEN-IT.
           MOVE LN-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       READ-LN1-FILE. *> EMBEDDED - LNFILE
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.
           INITIALIZE QLN-REC.

           MOVE LN-OWNBR  TO QLN-OWNBR.
           MOVE LN-ACCTNO TO QLN-ACCTNO.

           EXEC SQL
            SELECT LNFILE.LN_OWNBR,
                   LNFILE.LN_ACCTNO,
                   LNFILE.LN_CLASS,
                   LNFILE.LN_SUBCLASS,
                   LNFILE.LN_LAWCODE,
                   LNFILE.LN_SSNO1,
                   LNFILE.LN_MAKERCD1,
                   LNFILE.LN_SSNO2,
                   LNFILE.LN_MAKERCD2,
                   LNFILE.LN_SSNO3,
                   LNFILE.LN_MAKERCD3,
                   LNFILE.LN_SSNO4,
                   LNFILE.LN_MAKERCD4,
                   LNFILE.LN_ORGST,
                   LNFILE.LN_ORGBR,
                   LNFILE.LN_OWNST,
                   LNFILE.LN_SPRCLASS,
                   LNFILE.LN_CONVERCD,
                   LNFILE.LN_MIDSTREAM,
                   LNFILE.LN_PURCD,
                   LNFILE.LN_SRCD,
                   LNFILE.LN_COLLCD,
                   LNFILE.LN_COLLID,
                   LNFILE.LN_POCD,
                   LNFILE.LN_PLCD,
                   LNFILE.LN_PLTYPE,
                   LNFILE.LN_CONFIDENTCD,
                   LNFILE.LN_ALLOTCD,
                   LNFILE.LN_RECASTCD,
                   LNFILE.LN_SKIP_TRW,
                   LNFILE.LN_STATUSFG,
                   LNFILE.LN_SMALLOAN,
                   LNFILE.LN_SALEFIN,
                   LNFILE.LN_SERVACCT,
                   LNFILE.LN_LOANTYPE,
                   LNFILE.LN_ADDON_FG,
                   LNFILE.LN_PAY_SCHLD_FG,
                   LNFILE.LN_LC_CODE,
                   LNFILE.LN_CAN_LOAN_NO,
                   LNFILE.LN_STATFLAGS,
                   CAST(LNFILE.LN_ENTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_LOANDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PURDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_CASHDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_FILEDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_RESCISSION_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PART_RECOURSE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ORIG_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_1STPYDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_JDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PLDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PL_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_ACCELDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDUDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_POFFDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_PO_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LEGALDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPTDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISMISS_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DEBTAIDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_REPODATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_REDEEMDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_SOLDDATE AS VARCHAR(10)),
                   CAST(LNFILE.LN_INS_CONFIRM_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_RN_FOR10_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_TRW_DOFD_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_PYPA_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_BT_TRDATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_METRO2_LAST_PMT_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_FOLLOWUP_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_LAST_ACCRUAL_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APRATE,
                   LNFILE.LN_EFFRATE,
                   LNFILE.LN_SMPRATE,
                   LNFILE.LN_YLDRATE,
                   LNFILE.LN_OVRDRATE,
                   LNFILE.LN_ENDORATE,
                   LNFILE.LN_JDRATE,
                   LNFILE.LN_ACCRATE,
                   LNFILE.LN_REDURATE,
                   LNFILE.LN_CONRATE,
                   LNFILE.LN_SERVPER,
                   LNFILE.LN_SELLPR,
                   LNFILE.LN_DOWNPY,
                   LNFILE.LN_TRADEIN,
                   LNFILE.LN_LNAMT,
                   LNFILE.LN_FINCHG,
                   LNFILE.LN_INTCHG,
                   LNFILE.LN_SERCHG,
                   LNFILE.LN_EXTCHG,
                   LNFILE.LN_MAINTFEE,
                   LNFILE.LN_POINTS,
                   LNFILE.LN_PROCEEDS,
                   LNFILE.LN_ORGTERM,
                   LNFILE.LN_1STPYAMT,
                   LNFILE.LN_NOREGPY,
                   LNFILE.LN_REGPYAMT,
                   LNFILE.LN_LASTPYAMT,
                   LNFILE.LN_PROCASH,
                   LNFILE.LN_TILLNO,
                   LNFILE.LN_STATE_FLAG,
                   LNFILE.LN_STATE_WORKER,
                   LNFILE.LN_STATE_WORKER2,
                   LNFILE.LN_FEECODE_1,
                   LNFILE.LN_FEEAMT_1,
                   LNFILE.LN_FEEOURS_1,
                   LNFILE.LN_FEEFINCHG_1,
                   LNFILE.LN_FEECODE_2,
                   LNFILE.LN_FEEAMT_2,
                   LNFILE.LN_FEEOURS_2,
                   LNFILE.LN_FEEFINCHG_2,
                   LNFILE.LN_FEECODE_3,
                   LNFILE.LN_FEEAMT_3,
                   LNFILE.LN_FEEOURS_3,
                   LNFILE.LN_FEEFINCHG_3,
                   LNFILE.LN_FEECODE_4,
                   LNFILE.LN_FEEAMT_4,
                   LNFILE.LN_FEEOURS_4,
                   LNFILE.LN_FEEFINCHG_4,
                   LNFILE.LN_FEECODE_5,
                   LNFILE.LN_FEEAMT_5,
                   LNFILE.LN_FEEOURS_5,
                   LNFILE.LN_FEEFINCHG_5,
                   LNFILE.LN_FEECODE_6,
                   LNFILE.LN_FEEAMT_6,
                   LNFILE.LN_FEEOURS_6,
                   LNFILE.LN_FEEFINCHG_6,
                   LNFILE.LN_FEECODE_7,
                   LNFILE.LN_FEEAMT_7,
                   LNFILE.LN_FEEOURS_7,
                   LNFILE.LN_FEEFINCHG_7,
                   LNFILE.LN_FEECODE_8,
                   LNFILE.LN_FEEAMT_8,
                   LNFILE.LN_FEEOURS_8,
                   LNFILE.LN_FEEFINCHG_8,
                   LNFILE.LN_FEECODE_9,
                   LNFILE.LN_FEEAMT_9,
                   LNFILE.LN_FEEOURS_9,
                   LNFILE.LN_FEEFINCHG_9,
                   LNFILE.LN_FEECODE_10,
                   LNFILE.LN_FEEAMT_10,
                   LNFILE.LN_FEEOURS_10,
                   LNFILE.LN_FEEFINCHG_10,
                   LNFILE.LN_FEECODE_11,
                   LNFILE.LN_FEEAMT_11,
                   LNFILE.LN_FEEOURS_11,
                   LNFILE.LN_FEEFINCHG_11,
                   LNFILE.LN_FEECODE_12,
                   LNFILE.LN_FEEAMT_12,
                   LNFILE.LN_FEEOURS_12,
                   LNFILE.LN_FEEFINCHG_12,
                   LNFILE.LN_FEECODE_13,
                   LNFILE.LN_FEEAMT_13,
                   LNFILE.LN_FEEOURS_13,
                   LNFILE.LN_FEEFINCHG_13,
                   LNFILE.LN_FEECODE_14,
                   LNFILE.LN_FEEAMT_14,
                   LNFILE.LN_FEEOURS_14,
                   LNFILE.LN_FEEFINCHG_14,
                   LNFILE.LN_FEECODE_15,
                   LNFILE.LN_FEEAMT_15,
                   LNFILE.LN_FEEOURS_15,
                   LNFILE.LN_FEEFINCHG_15,
                   LNFILE.LN_FEECODE_16,
                   LNFILE.LN_FEEAMT_16,
                   LNFILE.LN_FEEOURS_16,
                   LNFILE.LN_FEEFINCHG_16,
                   LNFILE.LN_FEECODE_17,
                   LNFILE.LN_FEEAMT_17,
                   LNFILE.LN_FEEOURS_17,
                   LNFILE.LN_FEEFINCHG_17,
                   LNFILE.LN_FEECODE_18,
                   LNFILE.LN_FEEAMT_18,
                   LNFILE.LN_FEEOURS_18,
                   LNFILE.LN_FEEFINCHG_18,
                   LNFILE.LN_FEECODE_19,
                   LNFILE.LN_FEEAMT_19,
                   LNFILE.LN_FEEOURS_19,
                   LNFILE.LN_FEEFINCHG_19,
                   LNFILE.LN_FEECODE_20,
                   LNFILE.LN_FEEAMT_20,
                   LNFILE.LN_FEEOURS_20,
                   LNFILE.LN_FEEFINCHG_20,
                   LNFILE.LN_INSURED,
                   LNFILE.LN_INSTYPES,
                   LNFILE.LN_INSELIGIBLE,
                   LNFILE.LN_INSCOMP_1,
                   LNFILE.LN_INSOURS_1,
                   CAST(LNFILE.LN_INSEFF_DATE_1
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_1
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_1,
                   LNFILE.LN_INSCOVR_1,
                   LNFILE.LN_INSCOMM_1,
                   LNFILE.LN_INSANTICERN_1,
                   LNFILE.LN_INSANTICADJ_1,
                   LNFILE.LN_INSUFERN_1,
                   LNFILE.LN_INSACCERN_1,
                   LNFILE.LN_INSEARN_ORDER_1,
                   LNFILE.LN_INSFINCHG_1,
                   LNFILE.LN_INSCOMP_2,
                   LNFILE.LN_INSOURS_2,
                   CAST(LNFILE.LN_INSEFF_DATE_2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_2
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_2,
                   LNFILE.LN_INSCOVR_2,
                   LNFILE.LN_INSCOMM_2,
                   LNFILE.LN_INSANTICERN_2,
                   LNFILE.LN_INSANTICADJ_2,
                   LNFILE.LN_INSUFERN_2,
                   LNFILE.LN_INSACCERN_2,
                   LNFILE.LN_INSEARN_ORDER_2,
                   LNFILE.LN_INSFINCHG_2,
                   LNFILE.LN_INSCOMP_3,
                   LNFILE.LN_INSOURS_3,
                   CAST(LNFILE.LN_INSEFF_DATE_3
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_3
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_3,
                   LNFILE.LN_INSCOVR_3,
                   LNFILE.LN_INSCOMM_3,
                   LNFILE.LN_INSANTICERN_3,
                   LNFILE.LN_INSANTICADJ_3,
                   LNFILE.LN_INSUFERN_3,
                   LNFILE.LN_INSACCERN_3,
                   LNFILE.LN_INSEARN_ORDER_3,
                   LNFILE.LN_INSFINCHG_3,
                   LNFILE.LN_INSCOMP_4,
                   LNFILE.LN_INSOURS_4,
                   CAST(LNFILE.LN_INSEFF_DATE_4
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_4
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_4,
                   LNFILE.LN_INSCOVR_4,
                   LNFILE.LN_INSCOMM_4,
                   LNFILE.LN_INSANTICERN_4,
                   LNFILE.LN_INSANTICADJ_4,
                   LNFILE.LN_INSUFERN_4,
                   LNFILE.LN_INSACCERN_4,
                   LNFILE.LN_INSEARN_ORDER_4,
                   LNFILE.LN_INSFINCHG_4,
                   LNFILE.LN_INSCOMP_5,
                   LNFILE.LN_INSOURS_5,
                   CAST(LNFILE.LN_INSEFF_DATE_5
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_5
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_5,
                   LNFILE.LN_INSCOVR_5,
                   LNFILE.LN_INSCOMM_5,
                   LNFILE.LN_INSANTICERN_5,
                   LNFILE.LN_INSANTICADJ_5,
                   LNFILE.LN_INSUFERN_5,
                   LNFILE.LN_INSACCERN_5,
                   LNFILE.LN_INSEARN_ORDER_5,
                   LNFILE.LN_INSFINCHG_5,
                   LNFILE.LN_INSCOMP_6,
                   LNFILE.LN_INSOURS_6,
                   CAST(LNFILE.LN_INSEFF_DATE_6
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_6
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_6,
                   LNFILE.LN_INSCOVR_6,
                   LNFILE.LN_INSCOMM_6,
                   LNFILE.LN_INSANTICERN_6,
                   LNFILE.LN_INSANTICADJ_6,
                   LNFILE.LN_INSUFERN_6,
                   LNFILE.LN_INSACCERN_6,
                   LNFILE.LN_INSEARN_ORDER_6,
                   LNFILE.LN_INSFINCHG_6,
                   LNFILE.LN_INSCOMP_7,
                   LNFILE.LN_INSOURS_7,
                   CAST(LNFILE.LN_INSEFF_DATE_7
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_7
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_7,
                   LNFILE.LN_INSCOVR_7,
                   LNFILE.LN_INSCOMM_7,
                   LNFILE.LN_INSANTICERN_7,
                   LNFILE.LN_INSANTICADJ_7,
                   LNFILE.LN_INSUFERN_7,
                   LNFILE.LN_INSACCERN_7,
                   LNFILE.LN_INSEARN_ORDER_7,
                   LNFILE.LN_INSFINCHG_7,
                   LNFILE.LN_INSCOMP_8,
                   LNFILE.LN_INSOURS_8,
                   CAST(LNFILE.LN_INSEFF_DATE_8
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_8
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_8,
                   LNFILE.LN_INSCOVR_8,
                   LNFILE.LN_INSCOMM_8,
                   LNFILE.LN_INSANTICERN_8,
                   LNFILE.LN_INSANTICADJ_8,
                   LNFILE.LN_INSUFERN_8,
                   LNFILE.LN_INSACCERN_8,
                   LNFILE.LN_INSEARN_ORDER_8,
                   LNFILE.LN_INSFINCHG_8,
                   LNFILE.LN_INSCOMP_9,
                   LNFILE.LN_INSOURS_9,
                   CAST(LNFILE.LN_INSEFF_DATE_9
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_9
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_9,
                   LNFILE.LN_INSCOVR_9,
                   LNFILE.LN_INSCOMM_9,
                   LNFILE.LN_INSANTICERN_9,
                   LNFILE.LN_INSANTICADJ_9,
                   LNFILE.LN_INSUFERN_9,
                   LNFILE.LN_INSACCERN_9,
                   LNFILE.LN_INSEARN_ORDER_9,
                   LNFILE.LN_INSFINCHG_9,
                   LNFILE.LN_INSCOMP_10,
                   LNFILE.LN_INSOURS_10,
                   CAST(LNFILE.LN_INSEFF_DATE_10
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INSEXP_DATE_10
                                                  AS VARCHAR(10)),
                   LNFILE.LN_INSPREM_10,
                   LNFILE.LN_INSCOVR_10,
                   LNFILE.LN_INSCOMM_10,
                   LNFILE.LN_INSANTICERN_10,
                   LNFILE.LN_INSANTICADJ_10,
                   LNFILE.LN_INSUFERN_10,
                   LNFILE.LN_INSACCERN_10,
                   LNFILE.LN_INSEARN_ORDER_10,
                   LNFILE.LN_INSFINCHG_10,
                   LNFILE.LN_PY_YYYYMM_RECDEL,
                   LNFILE.LN_MTD_PAYS_RECDEL,
                   LNFILE.LN_GARNISH_EXTR,
                   LNFILE.LN_SHIP_SAME_FG,
                   LNFILE.LN_AD_D_INS_COVR,
                   LNFILE.LN_TOT_PARTIAL_CHGOFF,
                   LNFILE.LN_LPO,
                   LNFILE.LN_REP_CD,
                   LNFILE.LN_EMP_ID,
                   LNFILE.LN_PROCESS_CD,
                   LNFILE.LN_WCBC_CREDITLIM,
                   LNFILE.LN_FOLLOWUP_CD,
                   LNFILE.LN_MIP_FG,
                   LNFILE.LN_MIP_MTD_CLAHPAID,
                   CAST(LNFILE.LN_MIP_CLPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_CLPAID,
                   CAST(LNFILE.LN_MIP_AHPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_MIP_TOT_AHPAID,
                   LNFILE.LN_IL_GROSS_INCOME,
                   LNFILE.LN_IL_GROSS_INCOME2,
                   LNFILE.LN_RESCISSION,
                   LNFILE.LN_INTERIM_TRW,
                   LNFILE.LN_DLNO,
                   LNFILE.LN_DLPOOL,
                   LNFILE.LN_DLRECOURSE,
                   LNFILE.LN_DLPARTRCAMT,
                   LNFILE.LN_ORIGPURAMT,
                   LNFILE.LN_PURBAL,
                   LNFILE.LN_DLRVPRIN_1,
                   LNFILE.LN_DLRVPRIN_2,
                   LNFILE.LN_DLRVPRIN_3,
                   LNFILE.LN_DLRVCHGS_1,
                   LNFILE.LN_DLRVCHGS_2,
                   LNFILE.LN_DLRVCHGS_3,
                   LNFILE.LN_DLPARVHELD,
                   LNFILE.LN_DLPARVPAID,
                   LNFILE.LN_DLDISC,
                   CAST(LNFILE.LN_LCPDTH_DATE
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_INTPDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_CURBAL,
                   LNFILE.LN_INTBAL,
                   LNFILE.LN_LCBAL,
                   LNFILE.LN_OTHBAL,
                   LNFILE.LN_OT2BAL,
                   LNFILE.LN_LCPAID,
                   LNFILE.LN_LCPARTIALS,
                   LNFILE.LN_STMT_COUNTER,
                   LNFILE.LN_PRIOR_STMT_COUNTER,
                   LNFILE.LN_FROZEN_REASON,
                   LNFILE.LN_COUPON_STATEMENT,
                   LNFILE.LN_MONTHEND_BAL,
                   LNFILE.LN_ANTICTERM,
                   LNFILE.LN_ANTICERN_1,
                   LNFILE.LN_ANTICADJ_1,
                   LNFILE.LN_UFERN_1,
                   LNFILE.LN_ACCERN_1,
                   LNFILE.LN_EARN_ORDER_1,
                   LNFILE.LN_ANTICERN_2,
                   LNFILE.LN_ANTICADJ_2,
                   LNFILE.LN_UFERN_2,
                   LNFILE.LN_ACCERN_2,
                   LNFILE.LN_EARN_ORDER_2,
                   LNFILE.LN_ANTICERN_3,
                   LNFILE.LN_ANTICADJ_3,
                   LNFILE.LN_UFERN_3,
                   LNFILE.LN_ACCERN_3,
                   LNFILE.LN_EARN_ORDER_3,
                   LNFILE.LN_ANTICERN_4,
                   LNFILE.LN_ANTICADJ_4,
                   LNFILE.LN_UFERN_4,
                   LNFILE.LN_ACCERN_4,
                   LNFILE.LN_EARN_ORDER_4,
                   LNFILE.LN_ANTICERN_5,
                   LNFILE.LN_ANTICADJ_5,
                   LNFILE.LN_UFERN_5,
                   LNFILE.LN_ACCERN_5,
                   LNFILE.LN_EARN_ORDER_5,
                   LNFILE.LN_ANTICERN_6,
                   LNFILE.LN_ANTICADJ_6,
                   LNFILE.LN_UFERN_6,
                   LNFILE.LN_ACCERN_6,
                   LNFILE.LN_EARN_ORDER_6,
                   LNFILE.LN_ANTICERN_7,
                   LNFILE.LN_ANTICADJ_7,
                   LNFILE.LN_UFERN_7,
                   LNFILE.LN_ACCERN_7,
                   LNFILE.LN_EARN_ORDER_7,
                   LNFILE.LN_ANTICERN_8,
                   LNFILE.LN_ANTICADJ_8,
                   LNFILE.LN_UFERN_8,
                   LNFILE.LN_ACCERN_8,
                   LNFILE.LN_EARN_ORDER_8,
                   LNFILE.LN_ANTICERN_9,
                   LNFILE.LN_ANTICADJ_9,
                   LNFILE.LN_UFERN_9,
                   LNFILE.LN_ACCERN_9,
                   LNFILE.LN_EARN_ORDER_9,
                   LNFILE.LN_ANTICERN_10,
                   LNFILE.LN_ANTICADJ_10,
                   LNFILE.LN_UFERN_10,
                   LNFILE.LN_ACCERN_10,
                   LNFILE.LN_EARN_ORDER_10,
                   LNFILE.LN_LMO_PRIOR_INTEREST,
                   LNFILE.LN_PRIOR_UNEARNED,
                   LNFILE.LN_ERNDELQ_STOP,
                   LNFILE.LN_NONACRERN,
                   LNFILE.LN_PRIOR_NONACRERN,
                   CAST(LNFILE.LN_ERN_IB_PDTH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_ERN_IB_PRINBAL,
                   LNFILE.LN_ERN_IB_INTOWE,
                   LNFILE.LN_TOTERN,
                   LNFILE.LN_TOTOTH,
                   LNFILE.LN_TOTINT,
                   LNFILE.LN_TOTLCHG,
                   LNFILE.LN_TOTDEF,
                   LNFILE.LN_TOTSERACCT,
                   LNFILE.LN_LCWAIVERS,
                   LNFILE.LN_INTWAIVERS,
                   LNFILE.LN_TOTPAYMNTD,
                   LNFILE.LN_TOTEXCPAYMNTD,
                   LNFILE.LN_TOTNODEF,
                   LNFILE.LN_YTDNODEF,
                   LNFILE.LN_TOTNODEFACT,
                   LNFILE.LN_YTDNODEFACT,
                   LNFILE.LN_TOTNOALDEL,
                   LNFILE.LN_YTDNOALDEL,
                   LNFILE.LN_YTDINTPD,
                   LNFILE.LN_LYRINTPD,
                   LNFILE.LN_TOTINTPD,
                   LNFILE.LN_RECASTINT,
                   LNFILE.LN_RECASTPRIN,
                   LNFILE.LN_CL_REBATE,
                   LNFILE.LN_AH_REBATE,
                   LNFILE.LN_PP_REBATE,
                   LNFILE.LN_INT_REBATE,
                   LNFILE.LN_SC_REBATE,
                   LNFILE.LN_MF_REBATE,
                   LNFILE.LN_DF_REBATE,
                   LNFILE.LN_EX_REBATE,
                   LNFILE.LN_O1_REBATE,
                   LNFILE.LN_O2_REBATE,
                   LNFILE.LN_O3_REBATE,
                   LNFILE.LN_O4_REBATE,
                   LNFILE.LN_O5_REBATE,
                   LNFILE.LN_O6_REBATE,
                   LNFILE.LN_O7_REBATE,
                   LNFILE.LN_UN_O7_REB,
                   LNFILE.LN_UN_O8_REB,
                   LNFILE.LN_UN_O9_REB,
                   LNFILE.LN_UN_O10_REB,
                   LNFILE.LN_PLREASON,
                   LNFILE.LN_COLLECTOR,
                   LNFILE.LN_ACTIONCD,
                   LNFILE.LN_ACTIONCD2,
                   LNFILE.LN_ATCODE,
                   LNFILE.LN_RECODE,
                   LNFILE.LN_ESCROW_FG,
                   LNFILE.LN_PROMDAYS_PASTDUE,
                   LNFILE.LN_PROMID,
                   CAST(LNFILE.LN_PROMDATE AS VARCHAR(10)),
                   LNFILE.LN_PROMAMT,
                   CAST(LNFILE.LN_PROMDATE2
                                                  AS VARCHAR(10)),
                   CAST(LNFILE.LN_DATE_PAID_LAST
                                                  AS VARCHAR(10)),
                   LNFILE.LN_AMT_PAID_LAST,
                   LNFILE.LN_LASTCFORMNO,
                   CAST(LNFILE.LN_LASTCFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_DELCNT,
                   LNFILE.LN_DELCNT2,
                   LNFILE.LN_CREDITLIM,
                   LNFILE.LN_CRSCORE,
                   LNFILE.LN_LASTSFORMNO,
                   CAST(LNFILE.LN_LASTSFORMDATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_SOLCNT,
                   LNFILE.LN_MESSAGE,
                   LNFILE.LN_OLDACCTNO,
                   LNFILE.LN_PRLNNO,
                   LNFILE.LN_PRBAL,
                   LNFILE.LN_PRINTDUE,
                   LNFILE.LN_PRFINCHGRB,
                   LNFILE.LN_PRINSRB,
                   LNFILE.LN_PRPOCD,
                   CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)),
                   LNFILE.LN_PRDELINQAMT,
                   LNFILE.LN_PRLNAMT,
                   LNFILE.LN_PRPDUE_DAYS,
                   LNFILE.LN_PRDLDISC_UNEARN,
                   LNFILE.LN_PRCONPROFILE,
                   LNFILE.LN_SUM_ORIGPURAMT,
                   LNFILE.LN_SUM_LNAMT,
                   LNFILE.LN_SUM_FINCHG,
                   LNFILE.LN_SUM_INTCHG,
                   LNFILE.LN_SUM_ORGTERM,
                   LNFILE.LN_SUM_REGPYAMT,
                   LNFILE.LN_SUM_EXTCHG,
                   LNFILE.LN_SUM_SERCHG,
                   LNFILE.LN_SUM_MAINTFEE,
                   LNFILE.LN_UNITPER_CD,
                   LNFILE.LN_UNITPER_FREQ,
                   LNFILE.LN_DAYS_IN_UNITPER,
                   LNFILE.LN_UNITPER_PER_YEAR,
                   LNFILE.LN_REPOCD,
                   LNFILE.LN_BR_TFR_FG,
                   LNFILE.LN_O3INS_DLPROC,
                   LNFILE.LN_INSPREM_DLADJ,
                   LNFILE.LN_PLAMT,
                   LNFILE.LN_MTD_PRIN,
                   LNFILE.LN_MTD_LC,
                   LNFILE.LN_MTD_INT,
                   LNFILE.LN_MTD_OT,
                   LNFILE.LN_MTD_EX,
                   LNFILE.LN_BNKRPT_CHAPTER,
                   LNFILE.LN_BMO_CON_STATUS,
                   LNFILE.LN_BMO_REC_STATUS,
                   LNFILE.LN_APP_NUMBER,
                   LNFILE.LN_GIFTNET,
                   LNFILE.LN_GIFTNET_OUR_PO,
                   LNFILE.LN_PROC_DISBURSED,
                   LNFILE.LN_NOODDPY,
                   LNFILE.LN_CONPROFILE_1,
                   LNFILE.LN_CONPROFILE_2,
                   LNFILE.LN_CONPROFILE_3,
                   LNFILE.LN_CONPROFILE_4,
                   LNFILE.LN_CONPROFILE_5,
                   LNFILE.LN_RECPROFILE_1,
                   LNFILE.LN_RECPROFILE_2,
                   LNFILE.LN_RECPROFILE_3,
                   LNFILE.LN_RECPROFILE_4,
                   LNFILE.LN_RECPROFILE_5,
                   LNFILE.LN_TRW_STATUS,
                   LNFILE.LN_ORIGIN,
                   LNFILE.LN_PO_TRCD,
                   LNFILE.LN_NEXIS_CRSCORE,
                   LNFILE.LN_TRW_B_CONSUMER_IND,
                   LNFILE.LN_PARVHELD_PAID_FG,
                   LNFILE.LN_ACCT_FROZEN,
                   LNFILE.LN_TRW_SPECIAL_CODE,
                   LNFILE.LN_CREATION_STATUS,
                   LNFILE.LN_TOTNOLCHG,
                   LNFILE.LN_LBOX,
                   LNFILE.LN_EXTRA_PRIN_LFP,
                   LNFILE.LN_REMAIN_INT_SINCE_LFP,
                   LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
                   LNFILE.LN_INTERIM_COUPON,
                   LNFILE.LN_DLCOMM_O3_CMSI,
                   LNFILE.LN_DLCOMM_PP_CMSI,
                   LNFILE.LN_TRW_J_CONSUMER_IND,
                   LNFILE.LN_ACH,
                   LNFILE.LN_1099_C_FG,
                   LNFILE.LN_TRW_COMPLIANCE_CODE,
                   LNFILE.LN_UNWIND_REASON_CODE,
                   LNFILE.LN_PBI_PBD_FG,
                   LNFILE.LN_OLD_ACCT_FORMAT_FG,
                   LNFILE.LN_APPROVED_BY_USER,
                   LNFILE.LN_APPROVED_BY_CODE,
                   CAST(LNFILE.LN_APPROVED_BY_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_APPROVED_BY_TIME,
                   CAST(LNFILE.LN_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   LNFILE.LN_LTOUCH_TIME
            INTO :QLN-REC
            FROM DBO.LNFILE
            WHERE LNFILE.LN_OWNBR  = :QLN-OWNBR
              AND LNFILE.LN_ACCTNO = :QLN-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS.

      *-----------------------------------------------------------------
       REWRITE-LN1-FILE. *> EMBEDDED - LNFILE

           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           ACCEPT LN-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE LN1-KEY        TO E-KEYX.
           PERFORM SET-LN-FIELDS.

           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. *> USE UPDATE_CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.LNFILE
             SET
              LNFILE.LN_ACCERN_1           = :QLN-ACCERN-1, 
              LNFILE.LN_ACCERN_2           = :QLN-ACCERN-2,
              LNFILE.LN_ACCERN_3           = :QLN-ACCERN-3,
              LNFILE.LN_ACCERN_4           = :QLN-ACCERN-4,
              LNFILE.LN_ACCERN_5           = :QLN-ACCERN-5,
              LNFILE.LN_ACCERN_6           = :QLN-ACCERN-6,
              LNFILE.LN_TOTERN             = :QLN-TOTERN,
              LNFILE.LN_YTDINTPD           = :QLN-YTDINTPD,
              LNFILE.LN_TOTINTPD           = :QLN-TOTINTPD,
              LNFILE.LN_ERNDELQ_STOP       = :QLN-ERNDELQ-STOP,
              LNFILE.LN_LAST_ACCRUAL_DATE  = :QLN-LAST-ACCRUAL-DATE,
              LNFILE.LN_PRIOR_UNEARNED     = :QLN-PRIOR-UNEARNED, 
              LNFILE.LN_LMO_PRIOR_INTEREST = :QLN-LMO-PRIOR-INTEREST,
              LNFILE.LN_NONACRERN          = :QLN-NONACRERN,
              LNFILE.LN_PRIOR_NONACRERN    = :QLN-PRIOR-NONACRERN,
              LNFILE.LN_LTOUCH_DATE        = :QLN-LTOUCH-DATE       
            WHERE LNFILE.LN_OWNBR          = :QLN-OWNBR
              AND LNFILE.LN_ACCTNO         = :QLN-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-LN1-FILE.

           IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION
              IF LN-BI-FG = "Y"
                 MOVE "R" TO STAT
                 PERFORM UPDATE-BI-FILE.

           MOVE '1' TO SQL-UPDATE-CONN-USE-SW. *> USE C1 CONNECT    
           PERFORM SQL-SWAP-UPDATE-CONNECTION.


      *-----------------------------------------------------------------
       CLOSE-LN1-FILE.
           PERFORM CLOSE-IT.


      * COPY "LIBLP/LPLN3RN.CPY".
      * COPYMEMBER: LIBLP/LPLN3RN
      *-----------------------------------------------------------------
      *    STILL NEED TO LOAD THE FILE PATH WORKERS
      *-----------------------------------------------------------------
       LOAD-LN3-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LN-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LN-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LN-ALL-BASE
              MOVE FILPATH-MACHINE         TO LN-ALL-MACHINE
              MOVE FILPATH-DATA            TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH.

      *-----------------------------------------------------------------
       OPEN-LN3-FILE.
           PERFORM LOAD-LN3-FILE.
           PERFORM OPEN-IT.
           MOVE LN-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

           IF LN3-CONN-OPEN-SW1 = "N" 
              MOVE "Y"         TO LN3-CONN-OPEN-SW1
              EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS LN3_CONNECT1 
                       USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
              END-EXEC.

           IF LN3-CONN-OPEN-SW2 = "N" 
              MOVE "Y"         TO LN3-CONN-OPEN-SW2
              EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS LN3_CONNECT2 
                       USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
              END-EXEC.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-LN3-FILE-SSP1. *> SSP -LN,BW,CD 
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

      *  STORED PROCEDURE:
      *
      *    IF ( LN3-CURSOR-STAT-GOOD )
      *       PERFORM CLOSE-LN3-FILE.
      *  (SELECT LNFILE.LN_OWNBR,
      *          LNFILE.LN_ACCTNO,
      *          LNFILE.LN_CLASS,
      *          LNFILE.LN_SUBCLASS,
      *          LNFILE.LN_LAWCODE,
      *          LNFILE.LN_SSNO1,
      *          LNFILE.LN_MAKERCD1, 
      *          LNFILE.LN_SSNO2,
      *          LNFILE.LN_MAKERCD2, 
      *          LNFILE.LN_SSNO3,
      *          LNFILE.LN_MAKERCD3, 
      *          LNFILE.LN_SSNO4,
      *          LNFILE.LN_MAKERCD4, 
      *          LNFILE.LN_ORGST, 
      *          LNFILE.LN_SPRCLASS,
      *          LNFILE.LN_CONVERCD, 
      *          LNFILE.LN_COLLCD, 
      *          LNFILE.LN_POCD, 
      *          LNFILE.LN_PLCD, 
      *          LNFILE.LN_STATUSFG, 
      *          LNFILE.LN_SALEFIN, 
      *          LNFILE.LN_SERVACCT, 
      *          LNFILE.LN_LOANTYPE, 
      *          LNFILE.LN_ADDON_FG, 
      *          LNFILE.LN_PAY_SCHLD_FG, 
      *          LNFILE.LN_STATFLAGS, 
      *          CAST(LNFILE.LN_ENTDATE           
      *                             AS VARCHAR(10)) AS LN_ENTDATE, 
      *          CAST(LNFILE.LN_LOANDATE
      *                             AS VARCHAR(10)) AS LN_LOANDATE, 
      *          CAST(LNFILE.LN_PURDATE
      *                             AS VARCHAR(10)) AS LN_PURDATE, 
      *          CAST(LNFILE.LN_INTDATE
      *                             AS VARCHAR(10)) AS LN_INTDATE, 
      *          CAST(LNFILE.LN_CASHDATE
      *                             AS VARCHAR(10)) AS LN_CASHDATE, 
      *          CAST(LNFILE.LN_ORIG_1STPYDATE	   
      *                             AS VARCHAR(10)) AS LN_ORIG_1STPYDATE, 
      *          CAST(LNFILE.LN_1STPYDATE
      *                             AS VARCHAR(10)) AS LN_1STPYDATE, 
      *          CAST(LNFILE.LN_JDDATE
      *                             AS VARCHAR(10)) AS LN_JDDATE, 
      *          CAST(LNFILE.LN_PLDATE
      *                             AS VARCHAR(10)) AS LN_PLDATE, 
      *          CAST(LNFILE.LN_ACCELDATE
      *                             AS VARCHAR(10)) AS LN_ACCELDATE, 
      *          CAST(LNFILE.LN_REDUDATE
      *                             AS VARCHAR(10)) AS LN_REDUDATE, 
      *          CAST(LNFILE.LN_POFFDATE
      *                             AS VARCHAR(10)) AS LN_POFFDATE, 
      *          CAST(LNFILE.LN_LAST_ACCRUAL_DATE 
      *                             AS VARCHAR(10)) AS LN_LAST_ACCRUAL_DATE, 
      *          LNFILE.LN_APRATE,
      *          LNFILE.LN_EFFRATE,
      *          LNFILE.LN_SMPRATE,
      *          LNFILE.LN_OVRDRATE,
      *          LNFILE.LN_ENDORATE,
      *          LNFILE.LN_JDRATE,
      *          LNFILE.LN_ACCRATE,
      *          LNFILE.LN_REDURATE,
      *          LNFILE.LN_DOWNPY,
      *          LNFILE.LN_LNAMT,
      *          LNFILE.LN_FINCHG,
      *          LNFILE.LN_INTCHG,
      *          LNFILE.LN_SERCHG,
      *          LNFILE.LN_EXTCHG,
      *          LNFILE.LN_MAINTFEE,
      *          LNFILE.LN_POINTS,
      *          LNFILE.LN_ORGTERM,
      *          LNFILE.LN_1STPYAMT,
      *          LNFILE.LN_NOREGPY,
      *          LNFILE.LN_REGPYAMT,
      *          LNFILE.LN_LASTPYAMT,
      *          LNFILE.LN_FEECODE_1, 
      *          LNFILE.LN_FEECODE_2, 
      *          LNFILE.LN_FEECODE_3, 
      *          LNFILE.LN_FEECODE_4, 
      *          LNFILE.LN_FEECODE_5, 
      *          LNFILE.LN_FEECODE_6, 
      *          LNFILE.LN_FEECODE_7, 
      *          LNFILE.LN_FEECODE_8, 
      *          LNFILE.LN_FEECODE_9, 
      *          LNFILE.LN_FEECODE_10, 
      *          LNFILE.LN_FEECODE_11, 
      *          LNFILE.LN_FEECODE_12, 
      *          LNFILE.LN_FEECODE_13, 
      *          LNFILE.LN_FEECODE_14, 
      *          LNFILE.LN_FEECODE_15, 
      *          LNFILE.LN_FEECODE_16, 
      *          LNFILE.LN_FEECODE_17, 
      *          LNFILE.LN_FEECODE_18, 
      *          LNFILE.LN_FEECODE_19, 
      *          LNFILE.LN_FEECODE_20, 
      *          LNFILE.LN_FEEAMT_1,
      *          LNFILE.LN_FEEAMT_2,
      *          LNFILE.LN_FEEAMT_3,
      *          LNFILE.LN_FEEAMT_4,
      *          LNFILE.LN_FEEAMT_5,
      *          LNFILE.LN_FEEAMT_6,
      *          LNFILE.LN_FEEAMT_7,
      *          LNFILE.LN_FEEAMT_8,
      *          LNFILE.LN_FEEAMT_9,
      *          LNFILE.LN_FEEAMT_10,
      *          LNFILE.LN_FEEAMT_11,
      *          LNFILE.LN_FEEAMT_12,
      *          LNFILE.LN_FEEAMT_13,
      *          LNFILE.LN_FEEAMT_14,
      *          LNFILE.LN_FEEAMT_15,
      *          LNFILE.LN_FEEAMT_16,
      *          LNFILE.LN_FEEAMT_17,
      *          LNFILE.LN_FEEAMT_18,
      *          LNFILE.LN_FEEAMT_19,
      *          LNFILE.LN_FEEAMT_20,
      *          LNFILE.LN_FEEOURS_1, 
      *          LNFILE.LN_FEEOURS_2, 
      *          LNFILE.LN_FEEOURS_3, 
      *          LNFILE.LN_FEEOURS_4, 
      *          LNFILE.LN_FEEOURS_5, 
      *          LNFILE.LN_FEEOURS_6, 
      *          LNFILE.LN_FEEOURS_7, 
      *          LNFILE.LN_FEEOURS_8, 
      *          LNFILE.LN_FEEOURS_9, 
      *          LNFILE.LN_FEEOURS_10, 
      *          LNFILE.LN_FEEOURS_11, 
      *          LNFILE.LN_FEEOURS_12, 
      *          LNFILE.LN_FEEOURS_13, 
      *          LNFILE.LN_FEEOURS_14, 
      *          LNFILE.LN_FEEOURS_15, 
      *          LNFILE.LN_FEEOURS_16, 
      *          LNFILE.LN_FEEOURS_17, 
      *          LNFILE.LN_FEEOURS_18, 
      *          LNFILE.LN_FEEOURS_19, 
      *          LNFILE.LN_FEEOURS_20, 
      *          LNFILE.LN_FEEFINCHG_1, 
      *          LNFILE.LN_FEEFINCHG_2, 
      *          LNFILE.LN_FEEFINCHG_3, 
      *          LNFILE.LN_FEEFINCHG_4, 
      *          LNFILE.LN_FEEFINCHG_5, 
      *          LNFILE.LN_FEEFINCHG_6, 
      *          LNFILE.LN_FEEFINCHG_7, 
      *          LNFILE.LN_FEEFINCHG_8, 
      *          LNFILE.LN_FEEFINCHG_9, 
      *          LNFILE.LN_FEEFINCHG_10, 
      *          LNFILE.LN_FEEFINCHG_11, 
      *          LNFILE.LN_FEEFINCHG_12, 
      *          LNFILE.LN_FEEFINCHG_13, 
      *          LNFILE.LN_FEEFINCHG_14, 
      *          LNFILE.LN_FEEFINCHG_15, 
      *          LNFILE.LN_FEEFINCHG_16, 
      *          LNFILE.LN_FEEFINCHG_17, 
      *          LNFILE.LN_FEEFINCHG_18, 
      *          LNFILE.LN_FEEFINCHG_19, 
      *          LNFILE.LN_FEEFINCHG_20, 
      *          LNFILE.LN_INSURED, 
      *          LNFILE.LN_INSTYPES, 
      *          LNFILE.LN_INSCOMP_1,
      *          LNFILE.LN_INSCOMP_2,
      *          LNFILE.LN_INSCOMP_3,
      *          LNFILE.LN_INSCOMP_4,
      *          LNFILE.LN_INSCOMP_5,
      *          LNFILE.LN_INSCOMP_6,
      *          LNFILE.LN_INSCOMP_7,
      *          LNFILE.LN_INSCOMP_8,
      *          LNFILE.LN_INSCOMP_9,
      *          LNFILE.LN_INSCOMP_10,
      *          LNFILE.LN_INSOURS_1, 
      *          LNFILE.LN_INSOURS_2, 
      *          LNFILE.LN_INSOURS_3, 
      *          LNFILE.LN_INSOURS_4, 
      *          LNFILE.LN_INSOURS_5, 
      *          LNFILE.LN_INSOURS_6, 
      *          LNFILE.LN_INSOURS_7, 
      *          LNFILE.LN_INSOURS_8, 
      *          LNFILE.LN_INSOURS_9, 
      *          LNFILE.LN_INSOURS_10, 
      *          CAST(LNFILE.LN_INSEFF_DATE_1  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_1, 
      *          CAST(LNFILE.LN_INSEFF_DATE_2  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_2, 
      *          CAST(LNFILE.LN_INSEFF_DATE_3  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_3, 
      *          CAST(LNFILE.LN_INSEFF_DATE_4  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_4, 
      *          CAST(LNFILE.LN_INSEFF_DATE_5  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_5, 
      *          CAST(LNFILE.LN_INSEFF_DATE_6  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_6, 
      *          CAST(LNFILE.LN_INSEFF_DATE_7  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_7, 
      *          CAST(LNFILE.LN_INSEFF_DATE_8  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_8, 
      *          CAST(LNFILE.LN_INSEFF_DATE_9  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_9, 
      *          CAST(LNFILE.LN_INSEFF_DATE_10 
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_10, 
      *          CAST(LNFILE.LN_INSEXP_DATE_1  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_1, 
      *          CAST(LNFILE.LN_INSEXP_DATE_2  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_2, 
      *          CAST(LNFILE.LN_INSEXP_DATE_3  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_3, 
      *          CAST(LNFILE.LN_INSEXP_DATE_4  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_4, 
      *          CAST(LNFILE.LN_INSEXP_DATE_5  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_5, 
      *          CAST(LNFILE.LN_INSEXP_DATE_6  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_6, 
      *          CAST(LNFILE.LN_INSEXP_DATE_7  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_7, 
      *          CAST(LNFILE.LN_INSEXP_DATE_8  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_8, 
      *          CAST(LNFILE.LN_INSEXP_DATE_9  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_9, 
      *          CAST(LNFILE.LN_INSEXP_DATE_10 
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_10, 
      *          LNFILE.LN_INSPREM_1,
      *          LNFILE.LN_INSPREM_2,
      *          LNFILE.LN_INSPREM_3,
      *          LNFILE.LN_INSPREM_4,
      *          LNFILE.LN_INSPREM_5,
      *          LNFILE.LN_INSPREM_6,
      *          LNFILE.LN_INSPREM_7,
      *          LNFILE.LN_INSPREM_8,
      *          LNFILE.LN_INSPREM_9,
      *          LNFILE.LN_INSPREM_10,
      *          LNFILE.LN_INSCOVR_1,
      *          LNFILE.LN_INSCOVR_2,
      *          LNFILE.LN_INSCOVR_3,
      *          LNFILE.LN_INSCOVR_4,
      *          LNFILE.LN_INSCOVR_5,
      *          LNFILE.LN_INSCOVR_6,
      *          LNFILE.LN_INSCOVR_7,
      *          LNFILE.LN_INSCOVR_8,
      *          LNFILE.LN_INSCOVR_9,
      *          LNFILE.LN_INSCOVR_10,
      *          LNFILE.LN_INSFINCHG_1, 
      *          LNFILE.LN_INSFINCHG_2, 
      *          LNFILE.LN_INSFINCHG_3, 
      *          LNFILE.LN_INSFINCHG_4, 
      *          LNFILE.LN_INSFINCHG_5, 
      *          LNFILE.LN_INSFINCHG_6, 
      *          LNFILE.LN_INSFINCHG_7, 
      *          LNFILE.LN_INSFINCHG_8, 
      *          LNFILE.LN_INSFINCHG_9, 
      *          LNFILE.LN_INSFINCHG_10, 
      *          LNFILE.LN_PY_YYYYMM_RECDEL,
      *          LNFILE.LN_MTD_PAYS_RECDEL,
      *          LNFILE.LN_ORIGPURAMT,
      *          LNFILE.LN_PURBAL,
      *          LNFILE.LN_DLDISC,
      *          CAST(LNFILE.LN_INTPDTH_DATE 
      *                             AS VARCHAR(10)) AS LN_INTPDTH_DATE, 
      *          LNFILE.LN_CURBAL,
      *          LNFILE.LN_INTBAL,
      *          LNFILE.LN_OT2BAL,
      *          LNFILE.LN_ANTICTERM,
      *          LNFILE.LN_ANTICERN_1,
      *          LNFILE.LN_ANTICERN_2,
      *          LNFILE.LN_ANTICERN_3,
      *          LNFILE.LN_ANTICERN_4,
      *          LNFILE.LN_ANTICERN_5,
      *          LNFILE.LN_ANTICERN_6,
      *          LNFILE.LN_ANTICERN_7,
      *          LNFILE.LN_ANTICERN_8,
      *          LNFILE.LN_ANTICERN_9,
      *          LNFILE.LN_ANTICERN_10,
      *          LNFILE.LN_ANTICADJ_1,
      *          LNFILE.LN_ANTICADJ_2,
      *          LNFILE.LN_ANTICADJ_3,
      *          LNFILE.LN_ANTICADJ_4,
      *          LNFILE.LN_ANTICADJ_5,
      *          LNFILE.LN_ANTICADJ_6,
      *          LNFILE.LN_ANTICADJ_7,
      *          LNFILE.LN_ANTICADJ_8,
      *          LNFILE.LN_ANTICADJ_9,
      *          LNFILE.LN_ANTICADJ_10,
      *          LNFILE.LN_UFERN_1,
      *          LNFILE.LN_UFERN_2,
      *          LNFILE.LN_UFERN_3,
      *          LNFILE.LN_UFERN_4,
      *          LNFILE.LN_UFERN_5,
      *          LNFILE.LN_UFERN_6,
      *          LNFILE.LN_UFERN_7,
      *          LNFILE.LN_UFERN_8,
      *          LNFILE.LN_UFERN_9,
      *          LNFILE.LN_UFERN_10,
      *          LNFILE.LN_ACCERN_1,
      *          LNFILE.LN_ACCERN_2,
      *          LNFILE.LN_ACCERN_3,
      *          LNFILE.LN_ACCERN_4,
      *          LNFILE.LN_ACCERN_5,
      *          LNFILE.LN_ACCERN_6,
      *          LNFILE.LN_ACCERN_7,
      *          LNFILE.LN_ACCERN_8,
      *          LNFILE.LN_ACCERN_9,
      *          LNFILE.LN_ACCERN_10,
      *          LNFILE.LN_LMO_PRIOR_INTEREST,
      *          LNFILE.LN_PRIOR_UNEARNED,
      *          LNFILE.LN_ERNDELQ_STOP, 
      *          LNFILE.LN_NONACRERN,
      *          LNFILE.LN_PRIOR_NONACRERN,
      *          CAST(LNFILE.LN_ERN_IB_PDTH_DATE 
      *                             AS VARCHAR(10)) AS LN_ERN_IB_PDTH_DATE, 
      *          LNFILE.LN_ERN_IB_PRINBAL,
      *          LNFILE.LN_ERN_IB_INTOWE,
      *          LNFILE.LN_TOTERN,
      *          LNFILE.LN_TOTINT,
      *          LNFILE.LN_TOTLCHG,
      *          LNFILE.LN_TOTDEF,
      *          LNFILE.LN_TOTPAYMNTD,
      *          LNFILE.LN_TOTEXCPAYMNTD,
      *          LNFILE.LN_TOTNODEF,
      *          LNFILE.LN_TOTNOALDEL,
      *          LNFILE.LN_YTDINTPD,
      *          LNFILE.LN_TOTINTPD,
      *          LNFILE.LN_CL_REBATE, 
      *          LNFILE.LN_AH_REBATE, 
      *          LNFILE.LN_PP_REBATE, 
      *          LNFILE.LN_INT_REBATE, 
      *          LNFILE.LN_SC_REBATE, 
      *          LNFILE.LN_MF_REBATE, 
      *          LNFILE.LN_DF_REBATE, 
      *          LNFILE.LN_EX_REBATE, 
      *          LNFILE.LN_O1_REBATE, 
      *          LNFILE.LN_O2_REBATE, 
      *          LNFILE.LN_O3_REBATE, 
      *          LNFILE.LN_O4_REBATE, 
      *          LNFILE.LN_O5_REBATE, 
      *          LNFILE.LN_O6_REBATE, 
      *          LNFILE.LN_O7_REBATE, 
      *          LNFILE.LN_UN_O7_REB, 
      *          LNFILE.LN_UN_O8_REB, 
      *          LNFILE.LN_UN_O9_REB, 
      *          LNFILE.LN_UN_O10_REB, 
      *          CAST(LNFILE.LN_DATE_PAID_LAST 
      *                             AS VARCHAR(10)) AS LN_DATE_PAID_LAST, 
      *          LNFILE.LN_CREDITLIM,
      *          LNFILE.LN_OLDACCTNO,
      *          LNFILE.LN_PRLNNO,
      *          LNFILE.LN_SUM_LNAMT,
      *          LNFILE.LN_SUM_FINCHG,
      *          LNFILE.LN_SUM_INTCHG,
      *          LNFILE.LN_SUM_ORGTERM,
      *          LNFILE.LN_SUM_EXTCHG,
      *          LNFILE.LN_UNITPER_CD, 
      *          LNFILE.LN_UNITPER_FREQ,
      *          LNFILE.LN_REPOCD, 
      *          LNFILE.LN_CONPROFILE_1,
      *          LNFILE.LN_CONPROFILE_2,
      *          LNFILE.LN_CONPROFILE_3,
      *          LNFILE.LN_CONPROFILE_4,
      *          LNFILE.LN_CONPROFILE_5,
      *          ISNULL(BWFILE.BW_OWNBR, 0)        AS BW_OWNBR,
      *          ISNULL(BWFILE.BW_SSNO, 0)         AS BW_SSNO,
      *          ISNULL(BWFILE.BW_LNAME, ' ')      AS BW_LNAME,
      *          ISNULL(BWFILE.BW_FNAME, ' ')      AS BW_FNAME,
      *          ISNULL(BWFILE.BW_INTYTD, 0)       AS BW_INTYTD,
      *          ISNULL(BWFILE.BW_RE_INTYTD, 0)    AS BW_RE_INTYTD,
      *          ISNULL(BWFILE.BW_SOLICIT, ' ')    AS BW_SOLICIT,
      *          ISNULL(CDFILE.CD_TYPE, ' ')       AS CD_TYPE,
      *          ISNULL(CDFILE.CD_CODE, ' ')       AS CD_CODE,
      *          ISNULL(CDFILE.CD_CO_SECURED, ' ') AS CD_CO_SECURED 
      *
      *     FROM DBO.LNFILE  LNFILE
      * 
      *     LEFT OUTER JOIN
      *          DBO.BWFILE  BWFILE
      *       ON (LNFILE.LN_SSNO1 = BWFILE.BW_SSNO      
      *      AND  LNFILE.LN_OWNBR = BWFILE.BW_OWNBR)
      *
      *     LEFT OUTER JOIN
      *          DBO.CDFILE  CDFILE
      *       ON (LNFILE.LN_COLLCD = CDFILE.CD_CODE      
      *      AND  CDFILE.CD_TYPE   = 'CO') 
      *
      *    WHERE (     LNFILE.LN_OWNBR   = @QLN3_WBEG_OWNBR ) 
      *      AND NOT 
      *          (     LNFILE.LN_POCD IN ('*I', '*R') ) 
      *      AND NOT 
      *          ((    LNFILE.LN_POCD = '**') 
      *          AND  (SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 3, 2)
      *           !=   @QWS_END_YEAR
      *           OR   SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 6, 2)
      *           !=   @QWS_END_MONTH) )
      *      AND NOT  
      *          ((    LNFILE.LN_POCD    = '**'
      *          AND   LNFILE.LN_SALEFIN = 'Y') 
      *          AND  (SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 3, 2)
      *           !=   SUBSTRING(CAST(LN_PURDATE  AS VARCHAR(10)), 3, 2)
      *           OR   SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 6, 2)
      *           !=   SUBSTRING(CAST(LN_PURDATE  AS VARCHAR(10)), 6, 2)) )  
      *       AND NOT 
      *           ((    LNFILE.LN_POCD     = '**'
      *           AND   LNFILE.LN_SALEFIN != 'Y') 
      *           AND  (SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 3, 2)
      *            !=   SUBSTRING(CAST(LN_LOANDATE AS VARCHAR(10)), 3, 2)
      *            OR   SUBSTRING(CAST(LN_POFFDATE AS VARCHAR(10)), 6, 2)
      *            !=   SUBSTRING(CAST(LN_LOANDATE AS VARCHAR(10)), 6, 2)) )  
      *       AND NOT 
      *             (   LNFILE.LN_SERVACCT        = 'Y'    
      *           AND   LNFILE.LN_PRIOR_UNEARNED  = 0       
      *           AND   LNFILE.LN_NONACRERN       = 0 )      
      *       AND NOT   
      *             (   LNFILE.LN_PLDATE         != '1900-01-01'       
      *           AND   LNFILE.LN_PRIOR_UNEARNED  = 0       
      *           AND   LNFILE.LN_NONACRERN       = 0 )      
      *       AND NOT 
      *             (    LNFILE.LN_CURBAL         = 0      
      *           AND    LNFILE.LN_PRIOR_UNEARNED = 0      
      *           AND    LNFILE.LN_NONACRERN      = 0 )) TEMP1;
      *
      *           IF ( QLN3-WEND-ACCTNO = ZEROES    ) OR
      *              ( QLN3-WEND-ACCTNO NOT NUMERIC )
      *              MOVE LN-OWNBR             TO QLN3-WBEG-OWNBR
      *              MOVE LN-OWNBR             TO QLN3-WEND-OWNBR
      *              MOVE LN-CLASS             TO QLN3-WBEG-CLASS
      *              MOVE ALL "9"              TO QLN3-WEND-CLASS
      *              MOVE LN-ACCTNO            TO QLN3-WBEG-ACCTNO
      *              MOVE ALL "9"              TO QLN3-WEND-ACCTNO.
      *


           MOVE END-MONTH               TO WS-END-MONTH.
           MOVE END-YEAR                TO WS-END-YEAR.
           
           MOVE WS-END-MONTH-A          TO QWS-END-MONTH.
           MOVE WS-END-YEAR-A           TO QWS-END-YEAR.


           EXEC SQL SET CONNECTION LN3_CONNECT1 END-EXEC.

           EXEC SQL
            DECLARE LN3_CURSOR1 CURSOR FOR
                :LN3-RETURN-CODE = EXEC SSP_AC1ERN_LNFILE_SELECT1
              ( :QLN3-WBEG-OWNBR, 
                :QWS-END-YEAR,  
                :QWS-END-MONTH )
           END-EXEC.
 
           EXEC SQL
               OPEN LN3_CURSOR1
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLN3-WBEG-OWNBR
                          QLN3-WEND-OWNBR
                          QLN3-WBEG-CLASS
                          QLN3-WEND-CLASS
                          QLN3-WBEG-ACCTNO
                          QLN3-WEND-ACCTNO.

           MOVE STAT---GOOD TO LN3-CURSOR-STAT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-LN3-FILE-SSP2. *> SSP - LN,BW,CD
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

      *    IF ( LN3-CURSOR-STAT-GOOD )
      *       PERFORM CLOSE-LN3-FILE.

           IF ( QLN3-WEND-ACCTNO = ZEROES    ) OR
              ( QLN3-WEND-ACCTNO NOT NUMERIC )
              MOVE LN-OWNBR             TO QLN3-WBEG-OWNBR
              MOVE LN-OWNBR             TO QLN3-WEND-OWNBR
              MOVE LN-CLASS             TO QLN3-WBEG-CLASS
              MOVE ALL "9"              TO QLN3-WEND-CLASS
              MOVE LN-ACCTNO            TO QLN3-WBEG-ACCTNO
              MOVE ALL "9"              TO QLN3-WEND-ACCTNO.
   
      *    MOVE END-MONTH               TO QWS-END-MONTH.
      *    MOVE END-YEAR                TO QWS-END-YEAR.


      *  STORED PROCEDURE:
      *
      *  (SELECT LNFILE.LN_OWNBR,
      *          LNFILE.LN_ACCTNO,
      *          LNFILE.LN_CLASS,
      *          LNFILE.LN_SUBCLASS,
      *          LNFILE.LN_LAWCODE,
      *          LNFILE.LN_SSNO1,
      *          LNFILE.LN_MAKERCD1, 
      *          LNFILE.LN_SSNO2,
      *          LNFILE.LN_MAKERCD2, 
      *          LNFILE.LN_SSNO3,
      *          LNFILE.LN_MAKERCD3, 
      *          LNFILE.LN_SSNO4,
      *          LNFILE.LN_MAKERCD4, 
      *          LNFILE.LN_ORGST, 
      *          LNFILE.LN_SPRCLASS,
      *          LNFILE.LN_CONVERCD, 
      *          LNFILE.LN_COLLCD, 
      *          LNFILE.LN_POCD, 
      *          LNFILE.LN_PLCD, 
      *          LNFILE.LN_STATUSFG, 
      *          LNFILE.LN_SALEFIN, 
      *          LNFILE.LN_SERVACCT, 
      *          LNFILE.LN_LOANTYPE, 
      *          LNFILE.LN_ADDON_FG, 
      *          LNFILE.LN_PAY_SCHLD_FG, 
      *          LNFILE.LN_STATFLAGS, 
      *          CAST(LNFILE.LN_ENTDATE           
      *                             AS VARCHAR(10)) AS LN_ENTDATE, 
      *          CAST(LNFILE.LN_LOANDATE
      *                             AS VARCHAR(10)) AS LN_LOANDATE, 
      *          CAST(LNFILE.LN_PURDATE
      *                             AS VARCHAR(10)) AS LN_PURDATE, 
      *          CAST(LNFILE.LN_INTDATE
      *                             AS VARCHAR(10)) AS LN_INTDATE, 
      *          CAST(LNFILE.LN_CASHDATE
      *                             AS VARCHAR(10)) AS LN_CASHDATE, 
      *          CAST(LNFILE.LN_ORIG_1STPYDATE	   
      *                             AS VARCHAR(10)) AS LN_ORIG_1STPYDATE, 
      *          CAST(LNFILE.LN_1STPYDATE
      *                             AS VARCHAR(10)) AS LN_1STPYDATE, 
      *          CAST(LNFILE.LN_JDDATE
      *                             AS VARCHAR(10)) AS LN_JDDATE, 
      *          CAST(LNFILE.LN_PLDATE
      *                             AS VARCHAR(10)) AS LN_PLDATE, 
      *          CAST(LNFILE.LN_ACCELDATE
      *                             AS VARCHAR(10)) AS LN_ACCELDATE, 
      *          CAST(LNFILE.LN_REDUDATE
      *                             AS VARCHAR(10)) AS LN_REDUDATE, 
      *          CAST(LNFILE.LN_POFFDATE
      *                             AS VARCHAR(10)) AS LN_POFFDATE, 
      *          CAST(LNFILE.LN_LAST_ACCRUAL_DATE 
      *                             AS VARCHAR(10)) AS LN_LAST_ACCRUAL_DATE, 
      *          LNFILE.LN_APRATE,
      *          LNFILE.LN_EFFRATE,
      *          LNFILE.LN_SMPRATE,
      *          LNFILE.LN_OVRDRATE,
      *          LNFILE.LN_ENDORATE,
      *          LNFILE.LN_JDRATE,
      *          LNFILE.LN_ACCRATE,
      *          LNFILE.LN_REDURATE,
      *          LNFILE.LN_DOWNPY,
      *          LNFILE.LN_LNAMT,
      *          LNFILE.LN_FINCHG,
      *          LNFILE.LN_INTCHG,
      *          LNFILE.LN_SERCHG,
      *          LNFILE.LN_EXTCHG,
      *          LNFILE.LN_MAINTFEE,
      *          LNFILE.LN_POINTS,
      *          LNFILE.LN_ORGTERM,
      *          LNFILE.LN_1STPYAMT,
      *          LNFILE.LN_NOREGPY,
      *          LNFILE.LN_REGPYAMT,
      *          LNFILE.LN_LASTPYAMT,
      *          LNFILE.LN_FEECODE_1, 
      *          LNFILE.LN_FEECODE_2, 
      *          LNFILE.LN_FEECODE_3, 
      *          LNFILE.LN_FEECODE_4, 
      *          LNFILE.LN_FEECODE_5, 
      *          LNFILE.LN_FEECODE_6, 
      *          LNFILE.LN_FEECODE_7, 
      *          LNFILE.LN_FEECODE_8, 
      *          LNFILE.LN_FEECODE_9, 
      *          LNFILE.LN_FEECODE_10, 
      *          LNFILE.LN_FEECODE_11, 
      *          LNFILE.LN_FEECODE_12, 
      *          LNFILE.LN_FEECODE_13, 
      *          LNFILE.LN_FEECODE_14, 
      *          LNFILE.LN_FEECODE_15, 
      *          LNFILE.LN_FEECODE_16, 
      *          LNFILE.LN_FEECODE_17, 
      *          LNFILE.LN_FEECODE_18, 
      *          LNFILE.LN_FEECODE_19, 
      *          LNFILE.LN_FEECODE_20, 
      *          LNFILE.LN_FEEAMT_1,
      *          LNFILE.LN_FEEAMT_2,
      *          LNFILE.LN_FEEAMT_3,
      *          LNFILE.LN_FEEAMT_4,
      *          LNFILE.LN_FEEAMT_5,
      *          LNFILE.LN_FEEAMT_6,
      *          LNFILE.LN_FEEAMT_7,
      *          LNFILE.LN_FEEAMT_8,
      *          LNFILE.LN_FEEAMT_9,
      *          LNFILE.LN_FEEAMT_10,
      *          LNFILE.LN_FEEAMT_11,
      *          LNFILE.LN_FEEAMT_12,
      *          LNFILE.LN_FEEAMT_13,
      *          LNFILE.LN_FEEAMT_14,
      *          LNFILE.LN_FEEAMT_15,
      *          LNFILE.LN_FEEAMT_16,
      *          LNFILE.LN_FEEAMT_17,
      *          LNFILE.LN_FEEAMT_18,
      *          LNFILE.LN_FEEAMT_19,
      *          LNFILE.LN_FEEAMT_20,
      *          LNFILE.LN_FEEOURS_1, 
      *          LNFILE.LN_FEEOURS_2, 
      *          LNFILE.LN_FEEOURS_3, 
      *          LNFILE.LN_FEEOURS_4, 
      *          LNFILE.LN_FEEOURS_5, 
      *          LNFILE.LN_FEEOURS_6, 
      *          LNFILE.LN_FEEOURS_7, 
      *          LNFILE.LN_FEEOURS_8, 
      *          LNFILE.LN_FEEOURS_9, 
      *          LNFILE.LN_FEEOURS_10, 
      *          LNFILE.LN_FEEOURS_11, 
      *          LNFILE.LN_FEEOURS_12, 
      *          LNFILE.LN_FEEOURS_13, 
      *          LNFILE.LN_FEEOURS_14, 
      *          LNFILE.LN_FEEOURS_15, 
      *          LNFILE.LN_FEEOURS_16, 
      *          LNFILE.LN_FEEOURS_17, 
      *          LNFILE.LN_FEEOURS_18, 
      *          LNFILE.LN_FEEOURS_19, 
      *          LNFILE.LN_FEEOURS_20, 
      *          LNFILE.LN_FEEFINCHG_1, 
      *          LNFILE.LN_FEEFINCHG_2, 
      *          LNFILE.LN_FEEFINCHG_3, 
      *          LNFILE.LN_FEEFINCHG_4, 
      *          LNFILE.LN_FEEFINCHG_5, 
      *          LNFILE.LN_FEEFINCHG_6, 
      *          LNFILE.LN_FEEFINCHG_7, 
      *          LNFILE.LN_FEEFINCHG_8, 
      *          LNFILE.LN_FEEFINCHG_9, 
      *          LNFILE.LN_FEEFINCHG_10, 
      *          LNFILE.LN_FEEFINCHG_11, 
      *          LNFILE.LN_FEEFINCHG_12, 
      *          LNFILE.LN_FEEFINCHG_13, 
      *          LNFILE.LN_FEEFINCHG_14, 
      *          LNFILE.LN_FEEFINCHG_15, 
      *          LNFILE.LN_FEEFINCHG_16, 
      *          LNFILE.LN_FEEFINCHG_17, 
      *          LNFILE.LN_FEEFINCHG_18, 
      *          LNFILE.LN_FEEFINCHG_19, 
      *          LNFILE.LN_FEEFINCHG_20, 
      *          LNFILE.LN_INSURED, 
      *          LNFILE.LN_INSTYPES, 
      *          LNFILE.LN_INSCOMP_1,
      *          LNFILE.LN_INSCOMP_2,
      *          LNFILE.LN_INSCOMP_3,
      *          LNFILE.LN_INSCOMP_4,
      *          LNFILE.LN_INSCOMP_5,
      *          LNFILE.LN_INSCOMP_6,
      *          LNFILE.LN_INSCOMP_7,
      *          LNFILE.LN_INSCOMP_8,
      *          LNFILE.LN_INSCOMP_9,
      *          LNFILE.LN_INSCOMP_10,
      *          LNFILE.LN_INSOURS_1, 
      *          LNFILE.LN_INSOURS_2, 
      *          LNFILE.LN_INSOURS_3, 
      *          LNFILE.LN_INSOURS_4, 
      *          LNFILE.LN_INSOURS_5, 
      *          LNFILE.LN_INSOURS_6, 
      *          LNFILE.LN_INSOURS_7, 
      *          LNFILE.LN_INSOURS_8, 
      *          LNFILE.LN_INSOURS_9, 
      *          LNFILE.LN_INSOURS_10, 
      *          CAST(LNFILE.LN_INSEFF_DATE_1  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_1, 
      *          CAST(LNFILE.LN_INSEFF_DATE_2  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_2, 
      *          CAST(LNFILE.LN_INSEFF_DATE_3  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_3, 
      *          CAST(LNFILE.LN_INSEFF_DATE_4  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_4, 
      *          CAST(LNFILE.LN_INSEFF_DATE_5  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_5, 
      *          CAST(LNFILE.LN_INSEFF_DATE_6  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_6, 
      *          CAST(LNFILE.LN_INSEFF_DATE_7  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_7, 
      *          CAST(LNFILE.LN_INSEFF_DATE_8  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_8, 
      *          CAST(LNFILE.LN_INSEFF_DATE_9  
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_9, 
      *          CAST(LNFILE.LN_INSEFF_DATE_10 
      *                             AS VARCHAR(10)) AS LN_INSEFF_DATE_10, 
      *          CAST(LNFILE.LN_INSEXP_DATE_1  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_1, 
      *          CAST(LNFILE.LN_INSEXP_DATE_2  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_2, 
      *          CAST(LNFILE.LN_INSEXP_DATE_3  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_3, 
      *          CAST(LNFILE.LN_INSEXP_DATE_4  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_4, 
      *          CAST(LNFILE.LN_INSEXP_DATE_5  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_5, 
      *          CAST(LNFILE.LN_INSEXP_DATE_6  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_6, 
      *          CAST(LNFILE.LN_INSEXP_DATE_7  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_7, 
      *          CAST(LNFILE.LN_INSEXP_DATE_8  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_8, 
      *          CAST(LNFILE.LN_INSEXP_DATE_9  
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_9, 
      *          CAST(LNFILE.LN_INSEXP_DATE_10 
      *                             AS VARCHAR(10)) AS LN_INSEXP_DATE_10, 
      *          LNFILE.LN_INSPREM_1,
      *          LNFILE.LN_INSPREM_2,
      *          LNFILE.LN_INSPREM_3,
      *          LNFILE.LN_INSPREM_4,
      *          LNFILE.LN_INSPREM_5,
      *          LNFILE.LN_INSPREM_6,
      *          LNFILE.LN_INSPREM_7,
      *          LNFILE.LN_INSPREM_8,
      *          LNFILE.LN_INSPREM_9,
      *          LNFILE.LN_INSPREM_10,
      *          LNFILE.LN_INSCOVR_1,
      *          LNFILE.LN_INSCOVR_2,
      *          LNFILE.LN_INSCOVR_3,
      *          LNFILE.LN_INSCOVR_4,
      *          LNFILE.LN_INSCOVR_5,
      *          LNFILE.LN_INSCOVR_6,
      *          LNFILE.LN_INSCOVR_7,
      *          LNFILE.LN_INSCOVR_8,
      *          LNFILE.LN_INSCOVR_9,
      *          LNFILE.LN_INSCOVR_10,
      *          LNFILE.LN_INSFINCHG_1, 
      *          LNFILE.LN_INSFINCHG_2, 
      *          LNFILE.LN_INSFINCHG_3, 
      *          LNFILE.LN_INSFINCHG_4, 
      *          LNFILE.LN_INSFINCHG_5, 
      *          LNFILE.LN_INSFINCHG_6, 
      *          LNFILE.LN_INSFINCHG_7, 
      *          LNFILE.LN_INSFINCHG_8, 
      *          LNFILE.LN_INSFINCHG_9, 
      *          LNFILE.LN_INSFINCHG_10, 
      *          LNFILE.LN_PY_YYYYMM_RECDEL,
      *          LNFILE.LN_MTD_PAYS_RECDEL,
      *          LNFILE.LN_ORIGPURAMT,
      *          LNFILE.LN_PURBAL,
      *          LNFILE.LN_DLDISC,
      *          CAST(LNFILE.LN_INTPDTH_DATE 
      *                             AS VARCHAR(10)) AS LN_INTPDTH_DATE, 
      *          LNFILE.LN_CURBAL,
      *          LNFILE.LN_INTBAL,
      *          LNFILE.LN_OT2BAL,
      *          LNFILE.LN_ANTICTERM,
      *          LNFILE.LN_ANTICERN_1,
      *          LNFILE.LN_ANTICERN_2,
      *          LNFILE.LN_ANTICERN_3,
      *          LNFILE.LN_ANTICERN_4,
      *          LNFILE.LN_ANTICERN_5,
      *          LNFILE.LN_ANTICERN_6,
      *          LNFILE.LN_ANTICERN_7,
      *          LNFILE.LN_ANTICERN_8,
      *          LNFILE.LN_ANTICERN_9,
      *          LNFILE.LN_ANTICERN_10,
      *          LNFILE.LN_ANTICADJ_1,
      *          LNFILE.LN_ANTICADJ_2,
      *          LNFILE.LN_ANTICADJ_3,
      *          LNFILE.LN_ANTICADJ_4,
      *          LNFILE.LN_ANTICADJ_5,
      *          LNFILE.LN_ANTICADJ_6,
      *          LNFILE.LN_ANTICADJ_7,
      *          LNFILE.LN_ANTICADJ_8,
      *          LNFILE.LN_ANTICADJ_9,
      *          LNFILE.LN_ANTICADJ_10,
      *          LNFILE.LN_UFERN_1,
      *          LNFILE.LN_UFERN_2,
      *          LNFILE.LN_UFERN_3,
      *          LNFILE.LN_UFERN_4,
      *          LNFILE.LN_UFERN_5,
      *          LNFILE.LN_UFERN_6,
      *          LNFILE.LN_UFERN_7,
      *          LNFILE.LN_UFERN_8,
      *          LNFILE.LN_UFERN_9,
      *          LNFILE.LN_UFERN_10,
      *          LNFILE.LN_ACCERN_1,
      *          LNFILE.LN_ACCERN_2,
      *          LNFILE.LN_ACCERN_3,
      *          LNFILE.LN_ACCERN_4,
      *          LNFILE.LN_ACCERN_5,
      *          LNFILE.LN_ACCERN_6,
      *          LNFILE.LN_ACCERN_7,
      *          LNFILE.LN_ACCERN_8,
      *          LNFILE.LN_ACCERN_9,
      *          LNFILE.LN_ACCERN_10,
      *          LNFILE.LN_LMO_PRIOR_INTEREST,
      *          LNFILE.LN_PRIOR_UNEARNED,
      *          LNFILE.LN_ERNDELQ_STOP, 
      *          LNFILE.LN_NONACRERN,
      *          LNFILE.LN_PRIOR_NONACRERN,
      *          CAST(LNFILE.LN_ERN_IB_PDTH_DATE 
      *                             AS VARCHAR(10)) AS LN_ERN_IB_PDTH_DATE, 
      *          LNFILE.LN_ERN_IB_PRINBAL,
      *          LNFILE.LN_ERN_IB_INTOWE,
      *          LNFILE.LN_TOTERN,
      *          LNFILE.LN_TOTINT,
      *          LNFILE.LN_TOTLCHG,
      *          LNFILE.LN_TOTDEF,
      *          LNFILE.LN_TOTPAYMNTD,
      *          LNFILE.LN_TOTEXCPAYMNTD,
      *          LNFILE.LN_TOTNODEF,
      *          LNFILE.LN_TOTNOALDEL,
      *          LNFILE.LN_YTDINTPD,
      *          LNFILE.LN_TOTINTPD,
      *          LNFILE.LN_CL_REBATE, 
      *          LNFILE.LN_AH_REBATE, 
      *          LNFILE.LN_PP_REBATE, 
      *          LNFILE.LN_INT_REBATE, 
      *          LNFILE.LN_SC_REBATE, 
      *          LNFILE.LN_MF_REBATE, 
      *          LNFILE.LN_DF_REBATE, 
      *          LNFILE.LN_EX_REBATE, 
      *          LNFILE.LN_O1_REBATE, 
      *          LNFILE.LN_O2_REBATE, 
      *          LNFILE.LN_O3_REBATE, 
      *          LNFILE.LN_O4_REBATE, 
      *          LNFILE.LN_O5_REBATE, 
      *          LNFILE.LN_O6_REBATE, 
      *          LNFILE.LN_O7_REBATE, 
      *          LNFILE.LN_UN_O7_REB, 
      *          LNFILE.LN_UN_O8_REB, 
      *          LNFILE.LN_UN_O9_REB, 
      *          LNFILE.LN_UN_O10_REB, 
      *          CAST(LNFILE.LN_DATE_PAID_LAST 
      *                             AS VARCHAR(10)) AS LN_DATE_PAID_LAST, 
      *          LNFILE.LN_CREDITLIM,
      *          LNFILE.LN_OLDACCTNO,
      *          LNFILE.LN_PRLNNO,
      *          LNFILE.LN_SUM_LNAMT,
      *          LNFILE.LN_SUM_FINCHG,
      *          LNFILE.LN_SUM_INTCHG,
      *          LNFILE.LN_SUM_ORGTERM,
      *          LNFILE.LN_SUM_EXTCHG,
      *          LNFILE.LN_UNITPER_CD, 
      *          LNFILE.LN_UNITPER_FREQ,
      *          LNFILE.LN_REPOCD, 
      *          LNFILE.LN_CONPROFILE_1,
      *          LNFILE.LN_CONPROFILE_2,
      *          LNFILE.LN_CONPROFILE_3,
      *          LNFILE.LN_CONPROFILE_4,
      *          LNFILE.LN_CONPROFILE_5,
      *          ISNULL(BWFILE.BW_OWNBR, 0)        AS BW_OWNBR,
      *          ISNULL(BWFILE.BW_SSNO, 0)         AS BW_SSNO,
      *          ISNULL(BWFILE.BW_LNAME, ' ')      AS BW_LNAME,
      *          ISNULL(BWFILE.BW_FNAME, ' ')      AS BW_FNAME,
      *          ISNULL(BWFILE.BW_INTYTD, 0)       AS BW_INTYTD,
      *          ISNULL(BWFILE.BW_RE_INTYTD, 0)    AS BW_RE_INTYTD,
      *          ISNULL(BWFILE.BW_SOLICIT, ' ')    AS BW_SOLICIT,
      *          ISNULL(CDFILE.CD_TYPE, ' ')       AS CD_TYPE,
      *          ISNULL(CDFILE.CD_CODE, ' ')       AS CD_CODE,
      *          ISNULL(CDFILE.CD_CO_SECURED, ' ') AS CD_CO_SECURED 
      *
      *     FROM DBO.LNFILE  LNFILE
      *
      *     LEFT OUTER JOIN
      *          DBO.BWFILE  BWFILE
      *       ON (LNFILE.LN_OWNBR  = BWFILE.BW_OWNBR
      *      AND  LNFILE.LN_SSNO1  = BWFILE.BW_SSNO) 
      *
      *     LEFT OUTER JOIN
      *          DBO.CDFILE  CDFILE
      *       ON (LNFILE.LN_COLLCD = CDFILE.CD_CODE      
      *      AND  CDFILE.CD_TYPE                 = 'CO') 
      *
      *    WHERE LNFILE.LN_OWNBR   = @QLN3_WBEG_OWNBR 
      *      AND NOT
      *        ( LNFILE.LN_CURBAL    = 0      
      *       OR LNFILE.LN_PLDATE   != '1900-01-01'      
      *       OR LNFILE.LN_PLCD     != ' '
      *       OR LNFILE.LN_POCD     IN ('*I', '*R', '**')) ) TEMP2;  


           EXEC SQL SET CONNECTION LN3_CONNECT2 END-EXEC.

           EXEC SQL
            DECLARE LN3_CURSOR2 CURSOR FOR              
                :LN3-RETURN-CODE = EXEC SSP_AC1ERN_LNFILE_SELECT2
              ( :QLN3-WBEG-OWNBR )
           END-EXEC.
 
           EXEC SQL
               OPEN LN3_CURSOR2
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLN3-WBEG-OWNBR
                          QLN3-WEND-OWNBR
                          QLN3-WBEG-CLASS
                          QLN3-WEND-CLASS
                          QLN3-WBEG-ACCTNO
                          QLN3-WEND-ACCTNO.

           MOVE STAT---GOOD TO LN3-CURSOR-STAT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       READ-LN3-FILE-NEXT-SSP1. *> EMBEDDED - LN,BW,CD
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.
           INITIALIZE QLN-REC.
           INITIALIZE QBW-REC.
           INITIALIZE QCD-REC.

           EXEC SQL SET CONNECTION LN3_CONNECT1 END-EXEC.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL
                FETCH LN3_CURSOR1 
                 INTO 
                  :QLN-OWNBR,
                  :QLN-ACCTNO,
                  :QLN-CLASS,
                  :QLN-SUBCLASS,
                  :QLN-LAWCODE,
                  :QLN-SSNO1,
                  :QLN-MAKERCD1, 
                  :QLN-SSNO2,
                  :QLN-MAKERCD2, 
                  :QLN-SSNO3,
                  :QLN-MAKERCD3, 
                  :QLN-SSNO4,
                  :QLN-MAKERCD4, 
                  :QLN-ORGST, 
                  :QLN-SPRCLASS,
                  :QLN-CONVERCD, 
                  :QLN-COLLCD, 
                  :QLN-POCD, 
                  :QLN-PLCD, 
                  :QLN-STATUSFG, 
                  :QLN-SALEFIN, 
                  :QLN-SERVACCT, 
                  :QLN-LOANTYPE, 
                  :QLN-ADDON-FG, 
                  :QLN-PAY-SCHLD-FG, 
                  :QLN-STATFLAGS, 
                  :QLN-ENTDATE,
                  :QLN-LOANDATE, 
                  :QLN-PURDATE, 
                  :QLN-INTDATE,
                  :QLN-CASHDATE, 
                  :QLN-ORIG-1STPYDATE,
                  :QLN-1STPYDATE, 
                  :QLN-JDDATE,
                  :QLN-PLDATE, 
                  :QLN-ACCELDATE, 
                  :QLN-REDUDATE, 
                  :QLN-POFFDATE,
                  :QLN-LAST-ACCRUAL-DATE, 
                  :QLN-APRATE,
                  :QLN-EFFRATE,
                  :QLN-SMPRATE,
                  :QLN-OVRDRATE,
                  :QLN-ENDORATE,
                  :QLN-JDRATE,
                  :QLN-ACCRATE,
                  :QLN-REDURATE,
                  :QLN-DOWNPY,
                  :QLN-LNAMT,
                  :QLN-FINCHG,
                  :QLN-INTCHG,
                  :QLN-SERCHG,
                  :QLN-EXTCHG,
                  :QLN-MAINTFEE,
                  :QLN-POINTS,
                  :QLN-ORGTERM,
                  :QLN-1STPYAMT,
                  :QLN-NOREGPY,
                  :QLN-REGPYAMT,
                  :QLN-LASTPYAMT,
                  :QLN-FEECODE-1, 
                  :QLN-FEECODE-2, 
                  :QLN-FEECODE-3, 
                  :QLN-FEECODE-4, 
                  :QLN-FEECODE-5, 
                  :QLN-FEECODE-6, 
                  :QLN-FEECODE-7, 
                  :QLN-FEECODE-8, 
                  :QLN-FEECODE-9, 
                  :QLN-FEECODE-10, 
                  :QLN-FEECODE-11, 
                  :QLN-FEECODE-12, 
                  :QLN-FEECODE-13, 
                  :QLN-FEECODE-14, 
                  :QLN-FEECODE-15, 
                  :QLN-FEECODE-16, 
                  :QLN-FEECODE-17, 
                  :QLN-FEECODE-18, 
                  :QLN-FEECODE-19, 
                  :QLN-FEECODE-20, 
                  :QLN-FEEAMT-1,
                  :QLN-FEEAMT-2,
                  :QLN-FEEAMT-3,
                  :QLN-FEEAMT-4,
                  :QLN-FEEAMT-5,
                  :QLN-FEEAMT-6,
                  :QLN-FEEAMT-7,
                  :QLN-FEEAMT-8,
                  :QLN-FEEAMT-9,
                  :QLN-FEEAMT-10,
                  :QLN-FEEAMT-11,
                  :QLN-FEEAMT-12,
                  :QLN-FEEAMT-13,
                  :QLN-FEEAMT-14,
                  :QLN-FEEAMT-15,
                  :QLN-FEEAMT-16,
                  :QLN-FEEAMT-17,
                  :QLN-FEEAMT-18,
                  :QLN-FEEAMT-19,
                  :QLN-FEEAMT-20,
                  :QLN-FEEOURS-1, 
                  :QLN-FEEOURS-2, 
                  :QLN-FEEOURS-3, 
                  :QLN-FEEOURS-4, 
                  :QLN-FEEOURS-5, 
                  :QLN-FEEOURS-6, 
                  :QLN-FEEOURS-7, 
                  :QLN-FEEOURS-8, 
                  :QLN-FEEOURS-9, 
                  :QLN-FEEOURS-10, 
                  :QLN-FEEOURS-11, 
                  :QLN-FEEOURS-12, 
                  :QLN-FEEOURS-13, 
                  :QLN-FEEOURS-14, 
                  :QLN-FEEOURS-15, 
                  :QLN-FEEOURS-16, 
                  :QLN-FEEOURS-17, 
                  :QLN-FEEOURS-18, 
                  :QLN-FEEOURS-19, 
                  :QLN-FEEOURS-20, 
                  :QLN-FEEFINCHG-1, 
                  :QLN-FEEFINCHG-2, 
                  :QLN-FEEFINCHG-3, 
                  :QLN-FEEFINCHG-4, 
                  :QLN-FEEFINCHG-5, 
                  :QLN-FEEFINCHG-6, 
                  :QLN-FEEFINCHG-7, 
                  :QLN-FEEFINCHG-8, 
                  :QLN-FEEFINCHG-9, 
                  :QLN-FEEFINCHG-10, 
                  :QLN-FEEFINCHG-11, 
                  :QLN-FEEFINCHG-12, 
                  :QLN-FEEFINCHG-13, 
                  :QLN-FEEFINCHG-14, 
                  :QLN-FEEFINCHG-15, 
                  :QLN-FEEFINCHG-16, 
                  :QLN-FEEFINCHG-17, 
                  :QLN-FEEFINCHG-18, 
                  :QLN-FEEFINCHG-19, 
                  :QLN-FEEFINCHG-20, 
                  :QLN-INSURED, 
                  :QLN-INSTYPES, 
                  :QLN-INSCOMP-1,
                  :QLN-INSCOMP-2,
                  :QLN-INSCOMP-3,
                  :QLN-INSCOMP-4,
                  :QLN-INSCOMP-5,
                  :QLN-INSCOMP-6,
                  :QLN-INSCOMP-7,
                  :QLN-INSCOMP-8,
                  :QLN-INSCOMP-9,
                  :QLN-INSCOMP-10,
                  :QLN-INSOURS-1, 
                  :QLN-INSOURS-2, 
                  :QLN-INSOURS-3, 
                  :QLN-INSOURS-4, 
                  :QLN-INSOURS-5, 
                  :QLN-INSOURS-6, 
                  :QLN-INSOURS-7, 
                  :QLN-INSOURS-8, 
                  :QLN-INSOURS-9, 
                  :QLN-INSOURS-10, 
                  :QLN-INSEFF-DATE-1, 
                  :QLN-INSEFF-DATE-2, 
                  :QLN-INSEFF-DATE-3, 
                  :QLN-INSEFF-DATE-4, 
                  :QLN-INSEFF-DATE-5, 
                  :QLN-INSEFF-DATE-6, 
                  :QLN-INSEFF-DATE-7, 
                  :QLN-INSEFF-DATE-8, 
                  :QLN-INSEFF-DATE-9, 
                  :QLN-INSEFF-DATE-10, 
                  :QLN-INSEXP-DATE-1, 
                  :QLN-INSEXP-DATE-2, 
                  :QLN-INSEXP-DATE-3, 
                  :QLN-INSEXP-DATE-4, 
                  :QLN-INSEXP-DATE-5, 
                  :QLN-INSEXP-DATE-6, 
                  :QLN-INSEXP-DATE-7, 
                  :QLN-INSEXP-DATE-8, 
                  :QLN-INSEXP-DATE-9, 
                  :QLN-INSEXP-DATE-10, 
                  :QLN-INSPREM-1,
                  :QLN-INSPREM-2,
                  :QLN-INSPREM-3,
                  :QLN-INSPREM-4,
                  :QLN-INSPREM-5,
                  :QLN-INSPREM-6,
                  :QLN-INSPREM-7,
                  :QLN-INSPREM-8,
                  :QLN-INSPREM-9,
                  :QLN-INSPREM-10,
                  :QLN-INSCOVR-1,
                  :QLN-INSCOVR-2,
                  :QLN-INSCOVR-3,
                  :QLN-INSCOVR-4,
                  :QLN-INSCOVR-5,
                  :QLN-INSCOVR-6,
                  :QLN-INSCOVR-7,
                  :QLN-INSCOVR-8,
                  :QLN-INSCOVR-9,
                  :QLN-INSCOVR-10,
                  :QLN-INSFINCHG-1, 
                  :QLN-INSFINCHG-2, 
                  :QLN-INSFINCHG-3, 
                  :QLN-INSFINCHG-4, 
                  :QLN-INSFINCHG-5, 
                  :QLN-INSFINCHG-6, 
                  :QLN-INSFINCHG-7, 
                  :QLN-INSFINCHG-8, 
                  :QLN-INSFINCHG-9, 
                  :QLN-INSFINCHG-10, 
                  :QLN-PY-YYYYMM-RECDEL,
                  :QLN-MTD-PAYS-RECDEL,
                  :QLN-ORIGPURAMT,
                  :QLN-PURBAL,
                  :QLN-DLDISC,
                  :QLN-INTPDTH-DATE, 
                  :QLN-CURBAL,
                  :QLN-INTBAL,
                  :QLN-OT2BAL,
                  :QLN-ANTICTERM,
                  :QLN-ANTICERN-1,
                  :QLN-ANTICERN-2,
                  :QLN-ANTICERN-3,
                  :QLN-ANTICERN-4,
                  :QLN-ANTICERN-5,
                  :QLN-ANTICERN-6,
                  :QLN-ANTICERN-7,
                  :QLN-ANTICERN-8,
                  :QLN-ANTICERN-9,
                  :QLN-ANTICERN-10,
                  :QLN-ANTICADJ-1,
                  :QLN-ANTICADJ-2,
                  :QLN-ANTICADJ-3,
                  :QLN-ANTICADJ-4,
                  :QLN-ANTICADJ-5,
                  :QLN-ANTICADJ-6,
                  :QLN-ANTICADJ-7,
                  :QLN-ANTICADJ-8,
                  :QLN-ANTICADJ-9,
                  :QLN-ANTICADJ-10,
                  :QLN-UFERN-1,
                  :QLN-UFERN-2,
                  :QLN-UFERN-3,
                  :QLN-UFERN-4,
                  :QLN-UFERN-5,
                  :QLN-UFERN-6,
                  :QLN-UFERN-7,
                  :QLN-UFERN-8,
                  :QLN-UFERN-9,
                  :QLN-UFERN-10,
                  :QLN-ACCERN-1,
                  :QLN-ACCERN-2,
                  :QLN-ACCERN-3,
                  :QLN-ACCERN-4,
                  :QLN-ACCERN-5,
                  :QLN-ACCERN-6,
                  :QLN-ACCERN-7,
                  :QLN-ACCERN-8,
                  :QLN-ACCERN-9,
                  :QLN-ACCERN-10,
                  :QLN-LMO-PRIOR-INTEREST,
                  :QLN-PRIOR-UNEARNED,
                  :QLN-ERNDELQ-STOP, 
                  :QLN-NONACRERN,
                  :QLN-PRIOR-NONACRERN,
                  :QLN-ERN-IB-PDTH-DATE, 
                  :QLN-ERN-IB-PRINBAL,
                  :QLN-ERN-IB-INTOWE,
                  :QLN-TOTERN,
                  :QLN-TOTINT,
                  :QLN-TOTLCHG,
                  :QLN-TOTDEF,
                  :QLN-TOTPAYMNTD,
                  :QLN-TOTEXCPAYMNTD,
                  :QLN-TOTNODEF,
                  :QLN-TOTNOALDEL,
                  :QLN-YTDINTPD,
                  :QLN-TOTINTPD,
                  :QLN-CL-REBATE, 
                  :QLN-AH-REBATE, 
                  :QLN-PP-REBATE, 
                  :QLN-INT-REBATE, 
                  :QLN-SC-REBATE, 
                  :QLN-MF-REBATE, 
                  :QLN-DF-REBATE, 
                  :QLN-EX-REBATE, 
                  :QLN-O1-REBATE, 
                  :QLN-O2-REBATE, 
                  :QLN-O3-REBATE, 
                  :QLN-O4-REBATE, 
                  :QLN-O5-REBATE, 
                  :QLN-O6-REBATE, 
                  :QLN-O7-REBATE, 
                  :QLN-UN-O7-REB, 
                  :QLN-UN-O8-REB, 
                  :QLN-UN-O9-REB, 
                  :QLN-UN-O10-REB, 
                  :QLN-DATE-PAID-LAST, 
                  :QLN-CREDITLIM,
                  :QLN-OLDACCTNO,
                  :QLN-PRLNNO,
                  :QLN-SUM-LNAMT,
                  :QLN-SUM-FINCHG,
                  :QLN-SUM-INTCHG,
                  :QLN-SUM-ORGTERM,
                  :QLN-SUM-EXTCHG,
                  :QLN-UNITPER-CD, 
                  :QLN-UNITPER-FREQ,
                  :QLN-REPOCD, 
                  :QLN-CONPROFILE-1,
                  :QLN-CONPROFILE-2,
                  :QLN-CONPROFILE-3,
                  :QLN-CONPROFILE-4,
                  :QLN-CONPROFILE-5,
                  :QBW-OWNBR,  
                  :QBW-SSNO,  
                  :QBW-LNAME, 
                  :QBW-FNAME, 
                  :QBW-INTYTD,  
                  :QBW-RE-INTYTD,  
                  :QBW-SOLICIT, 
                  :QCD-TYPE, 
                  :QCD-CODE, 
                  :QCD-CO-SECURED     
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN3-FILE-NEXT-SSP1.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS
              MOVE LN-REC TO HOLD-LN-REC
              PERFORM GET-BW-FIELDS
              PERFORM GET-CD-FIELDS.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       READ-LN3-FILE-NEXT-SSP2. *> EMBEDDED - LN,BW,CD
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.
           INITIALIZE QLN-REC.
           INITIALIZE QBW-REC.
           INITIALIZE QCD-REC.

           EXEC SQL SET CONNECTION LN3_CONNECT2 END-EXEC.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL
                FETCH LN3_CURSOR2 
                 INTO 
                  :QLN-OWNBR,
                  :QLN-ACCTNO,
                  :QLN-CLASS,
                  :QLN-SUBCLASS,
                  :QLN-LAWCODE,
                  :QLN-SSNO1,
                  :QLN-MAKERCD1, 
                  :QLN-SSNO2,
                  :QLN-MAKERCD2, 
                  :QLN-SSNO3,
                  :QLN-MAKERCD3, 
                  :QLN-SSNO4,
                  :QLN-MAKERCD4, 
                  :QLN-ORGST, 
                  :QLN-SPRCLASS,
                  :QLN-CONVERCD, 
                  :QLN-COLLCD, 
                  :QLN-POCD, 
                  :QLN-PLCD, 
                  :QLN-STATUSFG, 
                  :QLN-SALEFIN, 
                  :QLN-SERVACCT, 
                  :QLN-LOANTYPE, 
                  :QLN-ADDON-FG, 
                  :QLN-PAY-SCHLD-FG, 
                  :QLN-STATFLAGS, 
                  :QLN-ENTDATE,
                  :QLN-LOANDATE, 
                  :QLN-PURDATE, 
                  :QLN-INTDATE,
                  :QLN-CASHDATE, 
                  :QLN-ORIG-1STPYDATE,
                  :QLN-1STPYDATE, 
                  :QLN-JDDATE,
                  :QLN-PLDATE, 
                  :QLN-ACCELDATE, 
                  :QLN-REDUDATE, 
                  :QLN-POFFDATE,
                  :QLN-LAST-ACCRUAL-DATE, 
                  :QLN-APRATE,
                  :QLN-EFFRATE,
                  :QLN-SMPRATE,
                  :QLN-OVRDRATE,
                  :QLN-ENDORATE,
                  :QLN-JDRATE,
                  :QLN-ACCRATE,
                  :QLN-REDURATE,
                  :QLN-DOWNPY,
                  :QLN-LNAMT,
                  :QLN-FINCHG,
                  :QLN-INTCHG,
                  :QLN-SERCHG,
                  :QLN-EXTCHG,
                  :QLN-MAINTFEE,
                  :QLN-POINTS,
                  :QLN-ORGTERM,
                  :QLN-1STPYAMT,
                  :QLN-NOREGPY,
                  :QLN-REGPYAMT,
                  :QLN-LASTPYAMT,
                  :QLN-FEECODE-1, 
                  :QLN-FEECODE-2, 
                  :QLN-FEECODE-3, 
                  :QLN-FEECODE-4, 
                  :QLN-FEECODE-5, 
                  :QLN-FEECODE-6, 
                  :QLN-FEECODE-7, 
                  :QLN-FEECODE-8, 
                  :QLN-FEECODE-9, 
                  :QLN-FEECODE-10, 
                  :QLN-FEECODE-11, 
                  :QLN-FEECODE-12, 
                  :QLN-FEECODE-13, 
                  :QLN-FEECODE-14, 
                  :QLN-FEECODE-15, 
                  :QLN-FEECODE-16, 
                  :QLN-FEECODE-17, 
                  :QLN-FEECODE-18, 
                  :QLN-FEECODE-19, 
                  :QLN-FEECODE-20, 
                  :QLN-FEEAMT-1,
                  :QLN-FEEAMT-2,
                  :QLN-FEEAMT-3,
                  :QLN-FEEAMT-4,
                  :QLN-FEEAMT-5,
                  :QLN-FEEAMT-6,
                  :QLN-FEEAMT-7,
                  :QLN-FEEAMT-8,
                  :QLN-FEEAMT-9,
                  :QLN-FEEAMT-10,
                  :QLN-FEEAMT-11,
                  :QLN-FEEAMT-12,
                  :QLN-FEEAMT-13,
                  :QLN-FEEAMT-14,
                  :QLN-FEEAMT-15,
                  :QLN-FEEAMT-16,
                  :QLN-FEEAMT-17,
                  :QLN-FEEAMT-18,
                  :QLN-FEEAMT-19,
                  :QLN-FEEAMT-20,
                  :QLN-FEEOURS-1, 
                  :QLN-FEEOURS-2, 
                  :QLN-FEEOURS-3, 
                  :QLN-FEEOURS-4, 
                  :QLN-FEEOURS-5, 
                  :QLN-FEEOURS-6, 
                  :QLN-FEEOURS-7, 
                  :QLN-FEEOURS-8, 
                  :QLN-FEEOURS-9, 
                  :QLN-FEEOURS-10, 
                  :QLN-FEEOURS-11, 
                  :QLN-FEEOURS-12, 
                  :QLN-FEEOURS-13, 
                  :QLN-FEEOURS-14, 
                  :QLN-FEEOURS-15, 
                  :QLN-FEEOURS-16, 
                  :QLN-FEEOURS-17, 
                  :QLN-FEEOURS-18, 
                  :QLN-FEEOURS-19, 
                  :QLN-FEEOURS-20, 
                  :QLN-FEEFINCHG-1, 
                  :QLN-FEEFINCHG-2, 
                  :QLN-FEEFINCHG-3, 
                  :QLN-FEEFINCHG-4, 
                  :QLN-FEEFINCHG-5, 
                  :QLN-FEEFINCHG-6, 
                  :QLN-FEEFINCHG-7, 
                  :QLN-FEEFINCHG-8, 
                  :QLN-FEEFINCHG-9, 
                  :QLN-FEEFINCHG-10, 
                  :QLN-FEEFINCHG-11, 
                  :QLN-FEEFINCHG-12, 
                  :QLN-FEEFINCHG-13, 
                  :QLN-FEEFINCHG-14, 
                  :QLN-FEEFINCHG-15, 
                  :QLN-FEEFINCHG-16, 
                  :QLN-FEEFINCHG-17, 
                  :QLN-FEEFINCHG-18, 
                  :QLN-FEEFINCHG-19, 
                  :QLN-FEEFINCHG-20, 
                  :QLN-INSURED, 
                  :QLN-INSTYPES, 
                  :QLN-INSCOMP-1,
                  :QLN-INSCOMP-2,
                  :QLN-INSCOMP-3,
                  :QLN-INSCOMP-4,
                  :QLN-INSCOMP-5,
                  :QLN-INSCOMP-6,
                  :QLN-INSCOMP-7,
                  :QLN-INSCOMP-8,
                  :QLN-INSCOMP-9,
                  :QLN-INSCOMP-10,
                  :QLN-INSOURS-1, 
                  :QLN-INSOURS-2, 
                  :QLN-INSOURS-3, 
                  :QLN-INSOURS-4, 
                  :QLN-INSOURS-5, 
                  :QLN-INSOURS-6, 
                  :QLN-INSOURS-7, 
                  :QLN-INSOURS-8, 
                  :QLN-INSOURS-9, 
                  :QLN-INSOURS-10, 
                  :QLN-INSEFF-DATE-1, 
                  :QLN-INSEFF-DATE-2, 
                  :QLN-INSEFF-DATE-3, 
                  :QLN-INSEFF-DATE-4, 
                  :QLN-INSEFF-DATE-5, 
                  :QLN-INSEFF-DATE-6, 
                  :QLN-INSEFF-DATE-7, 
                  :QLN-INSEFF-DATE-8, 
                  :QLN-INSEFF-DATE-9, 
                  :QLN-INSEFF-DATE-10, 
                  :QLN-INSEXP-DATE-1, 
                  :QLN-INSEXP-DATE-2, 
                  :QLN-INSEXP-DATE-3, 
                  :QLN-INSEXP-DATE-4, 
                  :QLN-INSEXP-DATE-5, 
                  :QLN-INSEXP-DATE-6, 
                  :QLN-INSEXP-DATE-7, 
                  :QLN-INSEXP-DATE-8, 
                  :QLN-INSEXP-DATE-9, 
                  :QLN-INSEXP-DATE-10, 
                  :QLN-INSPREM-1,
                  :QLN-INSPREM-2,
                  :QLN-INSPREM-3,
                  :QLN-INSPREM-4,
                  :QLN-INSPREM-5,
                  :QLN-INSPREM-6,
                  :QLN-INSPREM-7,
                  :QLN-INSPREM-8,
                  :QLN-INSPREM-9,
                  :QLN-INSPREM-10,
                  :QLN-INSCOVR-1,
                  :QLN-INSCOVR-2,
                  :QLN-INSCOVR-3,
                  :QLN-INSCOVR-4,
                  :QLN-INSCOVR-5,
                  :QLN-INSCOVR-6,
                  :QLN-INSCOVR-7,
                  :QLN-INSCOVR-8,
                  :QLN-INSCOVR-9,
                  :QLN-INSCOVR-10,
                  :QLN-INSFINCHG-1, 
                  :QLN-INSFINCHG-2, 
                  :QLN-INSFINCHG-3, 
                  :QLN-INSFINCHG-4, 
                  :QLN-INSFINCHG-5, 
                  :QLN-INSFINCHG-6, 
                  :QLN-INSFINCHG-7, 
                  :QLN-INSFINCHG-8, 
                  :QLN-INSFINCHG-9, 
                  :QLN-INSFINCHG-10, 
                  :QLN-PY-YYYYMM-RECDEL,
                  :QLN-MTD-PAYS-RECDEL,
                  :QLN-ORIGPURAMT,
                  :QLN-PURBAL,
                  :QLN-DLDISC,
                  :QLN-INTPDTH-DATE, 
                  :QLN-CURBAL,
                  :QLN-INTBAL,
                  :QLN-OT2BAL,
                  :QLN-ANTICTERM,
                  :QLN-ANTICERN-1,
                  :QLN-ANTICERN-2,
                  :QLN-ANTICERN-3,
                  :QLN-ANTICERN-4,
                  :QLN-ANTICERN-5,
                  :QLN-ANTICERN-6,
                  :QLN-ANTICERN-7,
                  :QLN-ANTICERN-8,
                  :QLN-ANTICERN-9,
                  :QLN-ANTICERN-10,
                  :QLN-ANTICADJ-1,
                  :QLN-ANTICADJ-2,
                  :QLN-ANTICADJ-3,
                  :QLN-ANTICADJ-4,
                  :QLN-ANTICADJ-5,
                  :QLN-ANTICADJ-6,
                  :QLN-ANTICADJ-7,
                  :QLN-ANTICADJ-8,
                  :QLN-ANTICADJ-9,
                  :QLN-ANTICADJ-10,
                  :QLN-UFERN-1,
                  :QLN-UFERN-2,
                  :QLN-UFERN-3,
                  :QLN-UFERN-4,
                  :QLN-UFERN-5,
                  :QLN-UFERN-6,
                  :QLN-UFERN-7,
                  :QLN-UFERN-8,
                  :QLN-UFERN-9,
                  :QLN-UFERN-10,
                  :QLN-ACCERN-1,
                  :QLN-ACCERN-2,
                  :QLN-ACCERN-3,
                  :QLN-ACCERN-4,
                  :QLN-ACCERN-5,
                  :QLN-ACCERN-6,
                  :QLN-ACCERN-7,
                  :QLN-ACCERN-8,
                  :QLN-ACCERN-9,
                  :QLN-ACCERN-10,
                  :QLN-LMO-PRIOR-INTEREST,
                  :QLN-PRIOR-UNEARNED,
                  :QLN-ERNDELQ-STOP, 
                  :QLN-NONACRERN,
                  :QLN-PRIOR-NONACRERN,
                  :QLN-ERN-IB-PDTH-DATE, 
                  :QLN-ERN-IB-PRINBAL,
                  :QLN-ERN-IB-INTOWE,
                  :QLN-TOTERN,
                  :QLN-TOTINT,
                  :QLN-TOTLCHG,
                  :QLN-TOTDEF,
                  :QLN-TOTPAYMNTD,
                  :QLN-TOTEXCPAYMNTD,
                  :QLN-TOTNODEF,
                  :QLN-TOTNOALDEL,
                  :QLN-YTDINTPD,
                  :QLN-TOTINTPD,
                  :QLN-CL-REBATE, 
                  :QLN-AH-REBATE, 
                  :QLN-PP-REBATE, 
                  :QLN-INT-REBATE, 
                  :QLN-SC-REBATE, 
                  :QLN-MF-REBATE, 
                  :QLN-DF-REBATE, 
                  :QLN-EX-REBATE, 
                  :QLN-O1-REBATE, 
                  :QLN-O2-REBATE, 
                  :QLN-O3-REBATE, 
                  :QLN-O4-REBATE, 
                  :QLN-O5-REBATE, 
                  :QLN-O6-REBATE, 
                  :QLN-O7-REBATE, 
                  :QLN-UN-O7-REB, 
                  :QLN-UN-O8-REB, 
                  :QLN-UN-O9-REB, 
                  :QLN-UN-O10-REB, 
                  :QLN-DATE-PAID-LAST, 
                  :QLN-CREDITLIM,
                  :QLN-OLDACCTNO,
                  :QLN-PRLNNO,
                  :QLN-SUM-LNAMT,
                  :QLN-SUM-FINCHG,
                  :QLN-SUM-INTCHG,
                  :QLN-SUM-ORGTERM,
                  :QLN-SUM-EXTCHG,
                  :QLN-UNITPER-CD, 
                  :QLN-UNITPER-FREQ,
                  :QLN-REPOCD, 
                  :QLN-CONPROFILE-1,
                  :QLN-CONPROFILE-2,
                  :QLN-CONPROFILE-3,
                  :QLN-CONPROFILE-4,
                  :QLN-CONPROFILE-5,
                  :QBW-OWNBR,  
                  :QBW-SSNO,  
                  :QBW-LNAME, 
                  :QBW-FNAME, 
                  :QBW-INTYTD,  
                  :QBW-RE-INTYTD,  
                  :QBW-SOLICIT, 
                  :QCD-TYPE, 
                  :QCD-CODE, 
                  :QCD-CO-SECURED 
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN3-FILE-NEXT-SSP2.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS
              PERFORM GET-BW-FIELDS
              PERFORM GET-CD-FIELDS.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       CLOSE-LN3-FILE.

           PERFORM CLOSE-IT.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION LN3_CONNECT1 END-EXEC
              EXEC SQL
                   CLOSE LN3_CURSOR1
              END-EXEC
              EXEC SQL SET CONNECTION LN3_CONNECT2 END-EXEC
              EXEC SQL
                   CLOSE LN3_CURSOR2
              END-EXEC
              MOVE STAT---BAD TO LN3-CURSOR-STAT
              EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       CLOSE-LN3-CONNECTION.

           IF LN3-CONN-OPEN-SW1 = "Y"
              EXEC SQL SET CONNECTION LN3_CONNECT1 END-EXEC
              EXEC SQL COMMIT END-EXEC
              EXEC SQL DISCONNECT LN3_CONNECT1 END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE "N" TO LN3-CONN-OPEN-SW1.

           IF LN3-CONN-OPEN-SW2 = "Y"
              EXEC SQL SET CONNECTION LN3_CONNECT2 END-EXEC
              EXEC SQL COMMIT END-EXEC
              EXEC SQL DISCONNECT LN3_CONNECT2 END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE "N" TO LN3-CONN-OPEN-SW2.


       COPY "LIBLP/LPLTI1IN.CPY".

      *-----------------------------------------------------------------
       READ-LTI1-ROWCOUNT. *> EMBEDDED - LTIFILE TOTALS
           PERFORM READ-IT.
           MOVE LTI-PATH-OWNBR  TO LTI-BRNO. 
           MOVE LTI-PATH-SQL    TO E-FILE.
           MOVE SPACES          TO E-KEYX.
           MOVE BR-NO           TO QLTI-BRNO.
 
           EXEC SQL
            SELECT COUNT(*)
              INTO :QWS-LTI-ROWCOUNT
              FROM DBO.LTIFILE
             WHERE LTIFILE.LTI_BRNO = :QLTI-BRNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LTI1-ROWCOUNT.   

      *-----------------------------------------------------------------

       COPY "LIBLP/LPLTP1RN.CPY".
       COPY "LIBLP/LPSP1RN.CPY".
      *=================================================================
      *    'IO' ROUTINES FOR "WK1"
      *=================================================================
       OPEN-WK1-FILE-OUTPUT.
           PERFORM OPEN-IT.
           MOVE WK1-IFN TO E-FILE.
           OPEN OUTPUT WK-FILE.
           IF IO-LOCKED
             GO TO OPEN-WK1-FILE-OUTPUT.
           IF IO-ALREADY-OPEN
             CLOSE WK-FILE
             GO TO OPEN-WK1-FILE-OUTPUT.
           UNLOCK WK-FILE.
      *-----------------------------------------------------------------
       OPEN-WK1-FILE.
           PERFORM OPEN-IT.
           MOVE WK1-IFN TO E-FILE.
           OPEN I-O WK-FILE.
           IF ( IO-LOCKED )
              GO TO OPEN-WK1-FILE.
           IF ( IO-ALREADY-OPEN )
              CLOSE WK-FILE
              GO TO OPEN-WK1-FILE.
           UNLOCK WK-FILE.
      *-----------------------------------------------------------------
       READ-WK1-FILE.
           PERFORM READ-IT.
           MOVE WK1-IFN TO E-FILE.
           MOVE WK1-KEY TO E-KEYX.
           READ WK-FILE.
           IF ( IO-LOCKED )
              GO TO READ-WK1-FILE.
      *-----------------------------------------------------------------
       READ-WK1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE WK1-IFN TO E-FILE.
           MOVE WK1-KEY TO E-KEYX.
           READ WK-FILE NEXT.
           IF ( IO-LOCKED )
             GO TO READ-WK1-FILE-NEXT.
      *-----------------------------------------------------------------
       START-WK1-FILE.
           PERFORM START-IT.
           MOVE WK1-IFN TO E-FILE.
           MOVE WK1-KEY TO E-KEYX.
           START WK-FILE KEY NOT < WK1-KEY.
           UNLOCK WK-FILE.
      *-----------------------------------------------------------------
       WRITE-WK1-FILE.
           PERFORM WRITE-IT.
           MOVE WK1-IFN TO E-FILE.
           MOVE WK1-KEY TO E-KEYX.
           WRITE WK-REC.
           IF ( IO-LOCKED )
              GO TO WRITE-WK1-FILE.
           UNLOCK WK-FILE.
      *-----------------------------------------------------------------
       REWRITE-WK1-FILE.
           PERFORM REWRITE-IT.
           MOVE WK1-IFN TO E-FILE.
           MOVE WK1-KEY TO E-KEYX.
           REWRITE WK-REC.
           IF ( IO-LOCKED )
              GO TO REWRITE-WK1-FILE.
           UNLOCK WK-FILE.
      *-----------------------------------------------------------------
       CLOSE-WK1-FILE.
           PERFORM CLOSE-IT.
           CLOSE WK-FILE.

      *=================================================================
      *    'IO' ROUTINES FOR "WK2"
      *=================================================================
       OPEN-WK2-FILE.

           PERFORM OPEN-IT.
           MOVE WK2-IFN TO E-FILE.
           OPEN I-O WK-FILE.
           IF ( IO-LOCKED ) GO TO OPEN-WK2-FILE.

           IF ( IO-ALREADY-OPEN ) CLOSE WK-FILE
                            GO TO OPEN-WK2-FILE.

           UNLOCK WK-FILE.

      *-----------------------------------------------------------------
       READ-WK2-FILE-NEXT.

           PERFORM READ-IT.
           MOVE WK2-IFN TO E-FILE.
           MOVE WK2-KEY TO E-KEYX.
           READ WK-FILE NEXT.

           IF ( IO-LOCKED ) GO TO READ-WK2-FILE-NEXT.

      *-----------------------------------------------------------------
       START-WK2-FILE.

           PERFORM START-IT.
           MOVE WK2-IFN TO E-FILE.
           MOVE WK2-KEY TO E-KEYX.
           START WK-FILE KEY NOT < WK2-KEY.
           UNLOCK WK-FILE.

      *-----------------------------------------------------------------
       CLOSE-WK2-FILE.
           PERFORM CLOSE-IT.
           CLOSE WK-FILE.

      *=================================================================
      *    'IO' ROUTINES FOR "WX1"
      *=================================================================
       OPEN-WX1-FILE-OUTPUT.

           PERFORM OPEN-IT.
           MOVE WX1-IFN TO E-FILE.
           OPEN OUTPUT WX-FILE.

           IF ( IO-LOCKED ) GO TO OPEN-WX1-FILE-OUTPUT.

           IF ( IO-ALREADY-OPEN ) CLOSE WX-FILE
                            GO TO OPEN-WX1-FILE-OUTPUT.

           UNLOCK WX-FILE.

      *-----------------------------------------------------------------
       OPEN-WX1-FILE.

           PERFORM OPEN-IT.
           MOVE WX1-IFN TO E-FILE.
           OPEN I-O WX-FILE.

           IF ( IO-LOCKED ) GO TO OPEN-WX1-FILE.

           IF ( IO-ALREADY-OPEN ) CLOSE WX-FILE
                            GO TO OPEN-WX1-FILE.

           UNLOCK WX-FILE.

      *-----------------------------------------------------------------
       READ-WX1-FILE.

           PERFORM READ-IT.
           MOVE WX1-IFN TO E-FILE.
           MOVE WX1-KEY TO E-KEYX.
           READ WX-FILE.

           IF ( IO-LOCKED ) GO TO READ-WX1-FILE.

      *-----------------------------------------------------------------
       READ-WX1-FILE-NEXT.

           PERFORM READ-IT.
           MOVE WX1-IFN TO E-FILE.
           MOVE WX1-KEY TO E-KEYX.
           READ WX-FILE NEXT.

           IF ( IO-LOCKED ) GO TO READ-WX1-FILE-NEXT.

      *-----------------------------------------------------------------
       START-WX1-FILE.

           PERFORM START-IT.
           MOVE WX1-IFN TO E-FILE.
           MOVE WX1-KEY TO E-KEYX.
           START WX-FILE KEY NOT < WX1-KEY.
           UNLOCK WX-FILE.

      *-----------------------------------------------------------------
       WRITE-WX1-FILE.

           PERFORM WRITE-IT.
           MOVE WX1-IFN TO E-FILE.
           MOVE WX1-KEY TO E-KEYX.
           WRITE WX-REC.

           IF ( IO-LOCKED ) GO TO WRITE-WX1-FILE.

           UNLOCK WX-FILE.

      *-----------------------------------------------------------------
       CLOSE-WX1-FILE.

           PERFORM CLOSE-IT.
           CLOSE WX-FILE.

       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO EXT-EOBUF-ERRCD.

      ******************************************************************
      *
      *    E N D - P R O G R A M
      *
      ******************************************************************
       END-PROGRAM SECTION.
       END-RUN.

           PERFORM CLOSE-FILES.

       EXIT-PROG.

      *    IF NOT GP-I-AM-WORLD
      *       MOVE WX-BUF TO ACCESS-BUF
      *       PERFORM REMOVE-WORKFILE.

           MOVE WK3-PATH TO ACCESS-BUF.
           PERFORM REMOVE-WORKFILE.

       STOP-RUN.
           EXIT PROGRAM.
