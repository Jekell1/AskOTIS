      * COPYMEMBER: LIBLP/LPTRJGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - TRJFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD TRJ-REC FROM QTRJ-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-TRJ-FIELDS.
           MOVE QTJ-BRNO TO TJ-BRNO.

           IF ( QTJ-DATE = "1900-01-01" )
              MOVE ZEROES TO TJ-DATE
           ELSE
              MOVE QTJ-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TJ-DATE.

           MOVE QTJ-CLASS TO TJ-CLASS.
           MOVE QTJ-ACCTNO TO TJ-ACCTNO.
           MOVE QTJ-LAWCODE TO TJ-LAWCODE.
           MOVE QTJ-LINE TO TJ-LINE.

           IF ( QTJ-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO TJ-LTOUCH-DATE
           ELSE
              MOVE QTJ-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TJ-LTOUCH-DATE.

           MOVE QTJ-SSNO-1 TO TJ-SSNO(1).
           MOVE QTJ-MAKERCD-1 TO TJ-MAKERCD(1).
           MOVE QTJ-SSNO-2 TO TJ-SSNO(2).
           MOVE QTJ-MAKERCD-2 TO TJ-MAKERCD(2).
           MOVE QTJ-SSNO-3 TO TJ-SSNO(3).
           MOVE QTJ-MAKERCD-3 TO TJ-MAKERCD(3).
           MOVE QTJ-SSNO-4 TO TJ-SSNO(4).
           MOVE QTJ-MAKERCD-4 TO TJ-MAKERCD(4).
           MOVE QTJ-REF-FRLC TO TJ-REF-FRLC.
           MOVE QTJ-REF-X TO TJ-REF-X.
           MOVE QTJ-REF-TOLC TO TJ-REF-TOLC.
           MOVE QTJ-FRLC TO TJ-FRLC.
           MOVE QTJ-TOLC TO TJ-TOLC.
           MOVE QTJ-PURCD TO TJ-PURCD.
           MOVE QTJ-SRCD TO TJ-SRCD.
           MOVE QTJ-COLLCD TO TJ-COLLCD.
           MOVE QTJ-SERVACCT TO TJ-SERVACCT.
           MOVE QTJ-LOANTYPE TO TJ-LOANTYPE.
           MOVE QTJ-SUBCLASS TO TJ-SUBCLASS.

           IF ( QTJ-LOANDATE = "1900-01-01" )
              MOVE ZEROES TO TJ-LOANDATE
           ELSE
              MOVE QTJ-LOANDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TJ-LOANDATE.

           MOVE QTJ-PROCEEDS TO TJ-PROCEEDS.
           MOVE QTJ-LNAMT TO TJ-LNAMT.
           MOVE QTJ-FINCHG TO TJ-FINCHG.
           MOVE QTJ-INTCHG TO TJ-INTCHG.
           MOVE QTJ-SERCHG TO TJ-SERCHG.
           MOVE QTJ-EXTCHG TO TJ-EXTCHG.
           MOVE QTJ-MAINTFEE TO TJ-MAINTFEE.
           MOVE QTJ-ORGTERM TO TJ-ORGTERM.
           MOVE QTJ-INSURED TO TJ-INSURED.
           MOVE QTJ-INSUNEARN-1 TO TJ-INSUNEARN(1).
           MOVE QTJ-INSUNEARN-2 TO TJ-INSUNEARN(2).
           MOVE QTJ-INSUNEARN-3 TO TJ-INSUNEARN(3).
           MOVE QTJ-INSUNEARN-4 TO TJ-INSUNEARN(4).
           MOVE QTJ-INSUNEARN-5 TO TJ-INSUNEARN(5).
           MOVE QTJ-INSUNEARN-6 TO TJ-INSUNEARN(6).
           MOVE QTJ-INSUNEARN-7 TO TJ-INSUNEARN(7).
           MOVE QTJ-INSUNEARN-8 TO TJ-INSUNEARN(8).
           MOVE QTJ-INSUNEARN-9 TO TJ-INSUNEARN(9).
           MOVE QTJ-INSUNEARN-10 TO TJ-INSUNEARN(10).
           MOVE QTJ-DLNO TO TJ-DLNO.
           MOVE QTJ-DLRV TO TJ-DLRV.
           MOVE QTJ-DLSPRV TO TJ-DLSPRV.
           MOVE QTJ-DLDISC TO TJ-DLDISC.
           MOVE QTJ-DLPARV TO TJ-DLPARV.
           MOVE QTJ-DLRECOURSE TO TJ-DLRECOURSE.
           MOVE QTJ-DLPARTRCAMT TO TJ-DLPARTRCAMT.
           MOVE QTJ-PURBAL TO TJ-PURBAL.
           MOVE QTJ-UNEARN-1 TO TJ-UNEARN(1).
           MOVE QTJ-UNEARN-2 TO TJ-UNEARN(2).
           MOVE QTJ-UNEARN-3 TO TJ-UNEARN(3).
           MOVE QTJ-UNEARN-4 TO TJ-UNEARN(4).
           MOVE QTJ-UNEARN-5 TO TJ-UNEARN(5).
           MOVE QTJ-UNEARN-6 TO TJ-UNEARN(6).
           MOVE QTJ-UNEARN-7 TO TJ-UNEARN(7).
           MOVE QTJ-UNEARN-8 TO TJ-UNEARN(8).
           MOVE QTJ-UNEARN-9 TO TJ-UNEARN(9).
           MOVE QTJ-UNEARN-10 TO TJ-UNEARN(10).
           MOVE QTJ-PRLNNO TO TJ-PRLNNO.
           MOVE QTJ-DLRVPRIN-1 TO TJ-DLRVPRIN(1).
           MOVE QTJ-DLRVPRIN-2 TO TJ-DLRVPRIN(2).
           MOVE QTJ-DLRVPRIN-3 TO TJ-DLRVPRIN(3).
           MOVE QTJ-DLRVCHGS-1 TO TJ-DLRVCHGS(1).
           MOVE QTJ-DLRVCHGS-2 TO TJ-DLRVCHGS(2).
           MOVE QTJ-DLRVCHGS-3 TO TJ-DLRVCHGS(3).
           MOVE QTJ-DLPARVPAID TO TJ-DLPARVPAID.
           MOVE QTJ-DLPARVHELD TO TJ-DLPARVHELD.
           MOVE QTJ-USERID TO TJ-USERID.

           IF ( QTJ-POSTDATE = "1900-01-01" )
              MOVE ZEROES TO TJ-POSTDATE
           ELSE
              MOVE QTJ-POSTDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TJ-POSTDATE.

           MOVE QTJ-POSTTIME TO TJ-POSTTIME.
           MOVE QTJ-PLCD TO TJ-PLCD.
           MOVE QTJ-PLTYPE TO TJ-PLTYPE.
           MOVE QTJ-REPOCD TO TJ-REPOCD.
 
      *-----------------------------------------------------------------
      *    LOAD QTRJ-REC FROM TRJ-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-TRJ-FIELDS.
           MOVE TJ-BRNO TO QTJ-BRNO.

           IF ( TJ-DATE = ZEROES )
              MOVE "1900-01-01" TO QTJ-DATE
           ELSE
              MOVE TJ-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTJ-DATE.

           MOVE TJ-CLASS TO QTJ-CLASS.
           MOVE TJ-ACCTNO TO QTJ-ACCTNO.
           MOVE TJ-LAWCODE TO QTJ-LAWCODE.
           MOVE TJ-LINE TO QTJ-LINE.

           IF ( TJ-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QTJ-LTOUCH-DATE
           ELSE
              MOVE TJ-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTJ-LTOUCH-DATE.

           MOVE TJ-SSNO(1) TO QTJ-SSNO-1.
           MOVE TJ-MAKERCD(1) TO QTJ-MAKERCD-1.
           MOVE TJ-SSNO(2) TO QTJ-SSNO-2.
           MOVE TJ-MAKERCD(2) TO QTJ-MAKERCD-2.
           MOVE TJ-SSNO(3) TO QTJ-SSNO-3.
           MOVE TJ-MAKERCD(3) TO QTJ-MAKERCD-3.
           MOVE TJ-SSNO(4) TO QTJ-SSNO-4.
           MOVE TJ-MAKERCD(4) TO QTJ-MAKERCD-4.
           MOVE TJ-REF-FRLC TO QTJ-REF-FRLC.
           MOVE TJ-REF-X TO QTJ-REF-X.
           MOVE TJ-REF-TOLC TO QTJ-REF-TOLC.
           MOVE TJ-FRLC TO QTJ-FRLC.
           MOVE TJ-TOLC TO QTJ-TOLC.
           MOVE TJ-PURCD TO QTJ-PURCD.
           MOVE TJ-SRCD TO QTJ-SRCD.
           MOVE TJ-COLLCD TO QTJ-COLLCD.
           MOVE TJ-SERVACCT TO QTJ-SERVACCT.
           MOVE TJ-LOANTYPE TO QTJ-LOANTYPE.
           MOVE TJ-SUBCLASS TO QTJ-SUBCLASS.

           IF ( TJ-LOANDATE = ZEROES )
              MOVE "1900-01-01" TO QTJ-LOANDATE
           ELSE
              MOVE TJ-LOANDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTJ-LOANDATE.

           MOVE TJ-PROCEEDS TO QTJ-PROCEEDS.
           MOVE TJ-LNAMT TO QTJ-LNAMT.
           MOVE TJ-FINCHG TO QTJ-FINCHG.
           MOVE TJ-INTCHG TO QTJ-INTCHG.
           MOVE TJ-SERCHG TO QTJ-SERCHG.
           MOVE TJ-EXTCHG TO QTJ-EXTCHG.
           MOVE TJ-MAINTFEE TO QTJ-MAINTFEE.
           MOVE TJ-ORGTERM TO QTJ-ORGTERM.
           MOVE TJ-INSURED TO QTJ-INSURED.
           MOVE TJ-INSUNEARN(1) TO QTJ-INSUNEARN-1.
           MOVE TJ-INSUNEARN(2) TO QTJ-INSUNEARN-2.
           MOVE TJ-INSUNEARN(3) TO QTJ-INSUNEARN-3.
           MOVE TJ-INSUNEARN(4) TO QTJ-INSUNEARN-4.
           MOVE TJ-INSUNEARN(5) TO QTJ-INSUNEARN-5.
           MOVE TJ-INSUNEARN(6) TO QTJ-INSUNEARN-6.
           MOVE TJ-INSUNEARN(7) TO QTJ-INSUNEARN-7.
           MOVE TJ-INSUNEARN(8) TO QTJ-INSUNEARN-8.
           MOVE TJ-INSUNEARN(9) TO QTJ-INSUNEARN-9.
           MOVE TJ-INSUNEARN(10) TO QTJ-INSUNEARN-10.
           MOVE TJ-DLNO TO QTJ-DLNO.
           MOVE TJ-DLRV TO QTJ-DLRV.
           MOVE TJ-DLSPRV TO QTJ-DLSPRV.
           MOVE TJ-DLDISC TO QTJ-DLDISC.
           MOVE TJ-DLPARV TO QTJ-DLPARV.
           MOVE TJ-DLRECOURSE TO QTJ-DLRECOURSE.
           MOVE TJ-DLPARTRCAMT TO QTJ-DLPARTRCAMT.
           MOVE TJ-PURBAL TO QTJ-PURBAL.
           MOVE TJ-UNEARN(1) TO QTJ-UNEARN-1.
           MOVE TJ-UNEARN(2) TO QTJ-UNEARN-2.
           MOVE TJ-UNEARN(3) TO QTJ-UNEARN-3.
           MOVE TJ-UNEARN(4) TO QTJ-UNEARN-4.
           MOVE TJ-UNEARN(5) TO QTJ-UNEARN-5.
           MOVE TJ-UNEARN(6) TO QTJ-UNEARN-6.
           MOVE TJ-UNEARN(7) TO QTJ-UNEARN-7.
           MOVE TJ-UNEARN(8) TO QTJ-UNEARN-8.
           MOVE TJ-UNEARN(9) TO QTJ-UNEARN-9.
           MOVE TJ-UNEARN(10) TO QTJ-UNEARN-10.
           MOVE TJ-PRLNNO TO QTJ-PRLNNO.
           MOVE TJ-DLRVPRIN(1) TO QTJ-DLRVPRIN-1.
           MOVE TJ-DLRVPRIN(2) TO QTJ-DLRVPRIN-2.
           MOVE TJ-DLRVPRIN(3) TO QTJ-DLRVPRIN-3.
           MOVE TJ-DLRVCHGS(1) TO QTJ-DLRVCHGS-1.
           MOVE TJ-DLRVCHGS(2) TO QTJ-DLRVCHGS-2.
           MOVE TJ-DLRVCHGS(3) TO QTJ-DLRVCHGS-3.
           MOVE TJ-DLPARVPAID TO QTJ-DLPARVPAID.
           MOVE TJ-DLPARVHELD TO QTJ-DLPARVHELD.
           MOVE TJ-USERID TO QTJ-USERID.

           IF ( TJ-POSTDATE = ZEROES )
              MOVE "1900-01-01" TO QTJ-POSTDATE
           ELSE
              MOVE TJ-POSTDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTJ-POSTDATE.

           MOVE TJ-POSTTIME TO QTJ-POSTTIME.
           MOVE TJ-PLCD TO QTJ-PLCD.
           MOVE TJ-PLTYPE TO QTJ-PLTYPE.
           MOVE TJ-REPOCD TO QTJ-REPOCD.
 
