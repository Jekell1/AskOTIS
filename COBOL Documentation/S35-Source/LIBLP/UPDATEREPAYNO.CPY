      **********************************************
      * /USR/DATA/R1/FTP/OUT/PAYS/NO.BRNO.NUMBER
      *                              1234.123456
      * THERE IS A PROCESS SCANNING THIS DIRECTORY TO SEND
      * THESE IMMEDIATELY TO REPAY 
      *
      * REV:
      * 2023.1218 BAH MOVE LN-OWNBR TO REPAY PATH BRNO, MUST BE OWNING BRANCH
      *               FOR INTERBRANCH PAYMENTS #1629A
      * BAH 2024.0130 ONLY CALL CRNOR2 IF NOTICE RECORD NOT FOUND
      * BAH 2024.0201 REMOVED NO-FMNO NO-PRINTED AND NO-WAGE-ASSING-DELINQ
      *               REPLACED THEM WITH FILLER TO NOT OFFSET THE FIELDS
      **********************************************
       UPDATE-REPAY-NO-FILE SECTION.
      **********************************************
           MOVE "UPDATING REPAY NO FILE.........." TO MESS.
           PERFORM SEND-LEGEND.

      * USR/DATA/R1/
           MOVE FIL-BASE  TO REPAY-NO-PATH-BASE.
           CALL "C$TOLOWER" USING REPAY-NO-PATH-DIR,VALUE 8.
           MOVE LN-OWNBR  TO REPAY-NO-PATH-BRNO.
           MOVE LN-ACCTNO TO REPAY-NO-PATH-NUMBER.

           MOVE REPAY-NO-DIR TO DIR-ACCESS-BUF.
           PERFORM DIR-ACCESS-CALL.
           IF STAT NOT = "00"
              GO TO EXIT-UPDATE-REPAY-NO-FILE.

           PERFORM OPEN-REPAY-NO-FILE-OUTPUT.

           PERFORM OPEN-NO1-FILE.
       
           MOVE SPACES TO XNO-REC.

           MOVE LN-OWNBR           TO NO-BRNO XNO-BRNO.
           MOVE LN-ACCTNO          TO NO-ACCTNO XNO-ACCTNO.
           PERFORM READ-NO1-FILE.
           IF IO-FG NOT = 0
              MOVE TRANS-DATE     TO CRNOR2-SYSDATE
              MOVE "CL/CRNOR2"    TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH CRNOR2-LINK NO-REC
                                    POFF-WORKERS LN-REC
              CANCEL FORM-PROGX.
           PERFORM CLOSE-NO1-FILE.

           MOVE NO-TDUE-DATE          TO XNO-TDUE.
           MOVE NO-TDUELC             TO XNO-TDUELC.
           INSPECT XNO-TDUELC REPLACING LEADING "+" BY " ".
           MOVE NO-TDUEAMT            TO XNO-TDUEAMT.
           INSPECT XNO-TDUEAMT REPLACING LEADING "+" BY " ".
           MOVE NO-TDUEPRIN           TO XNO-TDUEPRIN.
           INSPECT XNO-TDUEPRIN REPLACING LEADING "+" BY " ".
           MOVE NO-TDUETBAL           TO XNO-TDUETBAL.
           INSPECT XNO-TDUETBAL REPLACING LEADING "+" BY " ".
           MOVE NO-TDUEPOFF           TO XNO-TDUEPOFF.
           INSPECT XNO-TDUEPOFF REPLACING LEADING "+" BY " ".

           MOVE NO-LDUE-DATE          TO XNO-LDUE.
           MOVE NO-LDUELC             TO XNO-LDUELC.
           INSPECT XNO-LDUELC REPLACING LEADING "+" BY " ".
           MOVE NO-LDUEAMT            TO XNO-LDUEAMT.
           INSPECT XNO-LDUEAMT REPLACING LEADING "+" BY " ".
           MOVE NO-DATE-PAID-LAST     TO XNO-DATE-PAID-LAST.
           MOVE NO-AMT-PAID-LAST      TO XNO-AMT-PAID-LAST.
           INSPECT XNO-AMT-PAID-LAST REPLACING LEADING "+" BY " ".
           MOVE NO-LSTLPKEY           TO XNO-LSTLPKEY.

           MOVE NO-NXDUE-DATE         TO XNO-NXDUE.
           MOVE NO-NXDUEAMT           TO XNO-NXDUEAMT.
           INSPECT XNO-NXDUEAMT REPLACING LEADING "+" BY " ".
           MOVE NO-NXDUELC            TO XNO-NXDUELC.
           INSPECT XNO-NXDUELC REPLACING LEADING "+" BY " ".
           MOVE NO-TRUCONTR           TO XNO-TRUCONTR.
           MOVE NO-RECENCY            TO XNO-RECENCY.
           MOVE NO-PDTH-DATE          TO XNO-PDTH.
           MOVE NO-LCPDTH-DATE        TO XNO-LCPDTH.
           MOVE NO-LCHG-INTDUE        TO XNO-LCHG-INTDUE.
           INSPECT XNO-LCHG-INTDUE REPLACING LEADING "+" BY " ".
           MOVE NO-AVAILCREDIT        TO XNO-AVAILCREDIT.
           INSPECT XNO-AVAILCREDIT REPLACING LEADING "+" BY " ".
           MOVE NO-TDUEDELINQ         TO XNO-TDUEDELINQ.
           INSPECT XNO-TDUEDELINQ REPLACING LEADING "+" BY " ".
           MOVE NO-DEFERMENT          TO XNO-DEFERMENT.
           INSPECT XNO-DEFERMENT REPLACING LEADING "+" BY " ".
           MOVE NO-TRUE-DUE-DATE      TO XNO-TRUE-DUE-DATE.
           MOVE NO-SCHED-PAYMENT      TO XNO-SCHED-PAYMENT.
           INSPECT XNO-SCHED-PAYMENT REPLACING LEADING "+" BY " ".
           MOVE NO-TDUECONTR          TO XNO-TDUECONTR.
           INSPECT XNO-TDUECONTR REPLACING LEADING "+" BY " ".
           MOVE NO-LDUECONTR          TO XNO-LDUECONTR.
           INSPECT XNO-LDUECONTR REPLACING LEADING "+" BY " ".
           MOVE NO-NXDUECONTR         TO XNO-NXDUECONTR.
           INSPECT XNO-NXDUECONTR REPLACING LEADING "+" BY " ".
           MOVE NO-CURRENT-AVAIL      TO XNO-CURRENT-AVAIL.
           INSPECT XNO-CURRENT-AVAIL REPLACING LEADING "+" BY " ".
           MOVE NO-LATE-CHG           TO XNO-LATE-CHG.
           INSPECT XNO-LATE-CHG REPLACING LEADING "+" BY " ".
           MOVE NO-PAST-DUE-DAYS      TO XNO-PAST-DUE-DAYS.
           MOVE X"0D"                 TO XNO-CR.
           MOVE X"0A"                 TO XNO-LF.

           MOVE XNO-REC TO REPAY-NO-REC.
           PERFORM WRITE-REPAY-NO-FILE.

       EXIT-UPDATE-REPAY-NO-FILE.
           EXIT.
