      * COPYMEMBER: LIBLP/LPDL1IN
       LOAD-DL1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( DL-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( DL-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO DL-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO DL-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO DL-ALL-DATA
              MOVE DL-ALL-PATH             TO DL-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( DL-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO DL-ALL-BASE
              MOVE FILPATH-MACHINE         TO DL-ALL-MACHINE
              MOVE FILPATH-DATA            TO DL-ALL-DATA
              MOVE DL-ALL-PATH             TO DL-PATH.

      *-----------------------------------------------------------------
       OPEN-DL1-FILE.
           PERFORM LOAD-DL1-FILE.
           PERFORM OPEN-IT.
           MOVE DL-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       START-DL1-FILE.
           PERFORM START-IT.
           MOVE DL-PATH-OWNBR  TO DL-BRNO.
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.

           IF ( DL1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-DL1-FILE.

      D    STOP MESS.
           IF ( QDL1-WEND-NUM = ZEROES    ) OR
              ( QDL1-WEND-NUM NOT NUMERIC )
              MOVE DL-PATH-OWNBR        TO QDL1-WBEG-BRNO
              MOVE DL-PATH-OWNBR        TO QDL1-WEND-BRNO
              MOVE DL-NUM               TO QDL1-WBEG-NUM
              MOVE ALL "9"              TO QDL1-WEND-NUM.

           EXEC SQL
            DECLARE DL1_CURSOR CURSOR FOR
            SELECT DLFILE.DL_BRNO,
                   DLFILE.DL_NUM,
                   CAST(DLFILE.DL_LTOUCH_DATE AS VARCHAR(10)),
                   DLFILE.DL_NAME,
                   DLFILE.DL_ADR1,
                   DLFILE.DL_ADR2,
                   DLFILE.DL_CITY,
                   DLFILE.DL_STATE,
                   DLFILE.DL_ZIP,
                   DLFILE.DL_SHORT,
                   DLFILE.DL_PHONE,
                   DLFILE.DL_PURPOSE,
                   DLFILE.DL_MFGCODE,
                   CAST(DLFILE.DL_ORIGDATE AS VARCHAR(10)),
                   CAST(DLFILE.DL_TERMDATE AS VARCHAR(10)),
                   DLFILE.DL_LC_CODE,
                   DLFILE.DL_FULLCEIL,
                   DLFILE.DL_PARTCEIL,
                   DLFILE.DL_NONCEIL,
                   DLFILE.DL_SIGN1,
                   DLFILE.DL_SIGN2,
                   DLFILE.DL_SIGN3,
                   DLFILE.DL_MAXPURTRM,
                   DLFILE.DL_MAXPURPER,
                   DLFILE.DL_EARNCD,
                   DLFILE.DL_EARNFAC,
                   DLFILE.DL_DISC_FRMLA,
                   DLFILE.DL_DISC_CODE,
                   DLFILE.DL_DISC_TERM_1,
                   DLFILE.DL_DISC_RATE_1,
                   DLFILE.DL_DISC_TERM_2,
                   DLFILE.DL_DISC_RATE_2,
                   DLFILE.DL_DISC_TERM_3,
                   DLFILE.DL_DISC_RATE_3,
                   DLFILE.DL_DISC_TERM_4,
                   DLFILE.DL_DISC_RATE_4,
                   DLFILE.DL_DISC_TERM_5,
                   DLFILE.DL_DISC_RATE_5,
                   DLFILE.DL_DISC_TERM_6,
                   DLFILE.DL_DISC_RATE_6,
                   DLFILE.DL_RVPRIN_FRMLA_1,
                   DLFILE.DL_RVPRIN_CODE_1,
                   DLFILE.DL_RVPRIN_ADDON_1,
                   DLFILE.DL_RVPRIN_TERM_1_1,
                   DLFILE.DL_RVPRIN_RATE_1_1,
                   DLFILE.DL_RVPRIN_TERM_1_2,
                   DLFILE.DL_RVPRIN_RATE_1_2,
                   DLFILE.DL_RVPRIN_TERM_1_3,
                   DLFILE.DL_RVPRIN_RATE_1_3,
                   DLFILE.DL_RVPRIN_TERM_1_4,
                   DLFILE.DL_RVPRIN_RATE_1_4,
                   DLFILE.DL_RVPRIN_TERM_1_5,
                   DLFILE.DL_RVPRIN_RATE_1_5,
                   DLFILE.DL_RVPRIN_TERM_1_6,
                   DLFILE.DL_RVPRIN_RATE_1_6,
                   DLFILE.DL_RVPRIN_FRMLA_2,
                   DLFILE.DL_RVPRIN_CODE_2,
                   DLFILE.DL_RVPRIN_ADDON_2,
                   DLFILE.DL_RVPRIN_TERM_2_1,
                   DLFILE.DL_RVPRIN_RATE_2_1,
                   DLFILE.DL_RVPRIN_TERM_2_2,
                   DLFILE.DL_RVPRIN_RATE_2_2,
                   DLFILE.DL_RVPRIN_TERM_2_3,
                   DLFILE.DL_RVPRIN_RATE_2_3,
                   DLFILE.DL_RVPRIN_TERM_2_4,
                   DLFILE.DL_RVPRIN_RATE_2_4,
                   DLFILE.DL_RVPRIN_TERM_2_5,
                   DLFILE.DL_RVPRIN_RATE_2_5,
                   DLFILE.DL_RVPRIN_TERM_2_6,
                   DLFILE.DL_RVPRIN_RATE_2_6,
                   DLFILE.DL_RVPRIN_FRMLA_3,
                   DLFILE.DL_RVPRIN_CODE_3,
                   DLFILE.DL_RVPRIN_ADDON_3,
                   DLFILE.DL_RVPRIN_TERM_3_1,
                   DLFILE.DL_RVPRIN_RATE_3_1,
                   DLFILE.DL_RVPRIN_TERM_3_2,
                   DLFILE.DL_RVPRIN_RATE_3_2,
                   DLFILE.DL_RVPRIN_TERM_3_3,
                   DLFILE.DL_RVPRIN_RATE_3_3,
                   DLFILE.DL_RVPRIN_TERM_3_4,
                   DLFILE.DL_RVPRIN_RATE_3_4,
                   DLFILE.DL_RVPRIN_TERM_3_5,
                   DLFILE.DL_RVPRIN_RATE_3_5,
                   DLFILE.DL_RVPRIN_TERM_3_6,
                   DLFILE.DL_RVPRIN_RATE_3_6,
                   DLFILE.DL_RVCHGS_FRMLA_1,
                   DLFILE.DL_RVCHGS_CODE_1,
                   DLFILE.DL_RVCHGS_ADDON_1,
                   DLFILE.DL_RVCHGS_TERM_1_1,
                   DLFILE.DL_RVCHGS_RATE_1_1,
                   DLFILE.DL_RVCHGS_TERM_1_2,
                   DLFILE.DL_RVCHGS_RATE_1_2,
                   DLFILE.DL_RVCHGS_TERM_1_3,
                   DLFILE.DL_RVCHGS_RATE_1_3,
                   DLFILE.DL_RVCHGS_TERM_1_4,
                   DLFILE.DL_RVCHGS_RATE_1_4,
                   DLFILE.DL_RVCHGS_TERM_1_5,
                   DLFILE.DL_RVCHGS_RATE_1_5,
                   DLFILE.DL_RVCHGS_TERM_1_6,
                   DLFILE.DL_RVCHGS_RATE_1_6,
                   DLFILE.DL_RVCHGS_FRMLA_2,
                   DLFILE.DL_RVCHGS_CODE_2,
                   DLFILE.DL_RVCHGS_ADDON_2,
                   DLFILE.DL_RVCHGS_TERM_2_1,
                   DLFILE.DL_RVCHGS_RATE_2_1,
                   DLFILE.DL_RVCHGS_TERM_2_2,
                   DLFILE.DL_RVCHGS_RATE_2_2,
                   DLFILE.DL_RVCHGS_TERM_2_3,
                   DLFILE.DL_RVCHGS_RATE_2_3,
                   DLFILE.DL_RVCHGS_TERM_2_4,
                   DLFILE.DL_RVCHGS_RATE_2_4,
                   DLFILE.DL_RVCHGS_TERM_2_5,
                   DLFILE.DL_RVCHGS_RATE_2_5,
                   DLFILE.DL_RVCHGS_TERM_2_6,
                   DLFILE.DL_RVCHGS_RATE_2_6,
                   DLFILE.DL_RVCHGS_FRMLA_3,
                   DLFILE.DL_RVCHGS_CODE_3,
                   DLFILE.DL_RVCHGS_ADDON_3,
                   DLFILE.DL_RVCHGS_TERM_3_1,
                   DLFILE.DL_RVCHGS_RATE_3_1,
                   DLFILE.DL_RVCHGS_TERM_3_2,
                   DLFILE.DL_RVCHGS_RATE_3_2,
                   DLFILE.DL_RVCHGS_TERM_3_3,
                   DLFILE.DL_RVCHGS_RATE_3_3,
                   DLFILE.DL_RVCHGS_TERM_3_4,
                   DLFILE.DL_RVCHGS_RATE_3_4,
                   DLFILE.DL_RVCHGS_TERM_3_5,
                   DLFILE.DL_RVCHGS_RATE_3_5,
                   DLFILE.DL_RVCHGS_TERM_3_6,
                   DLFILE.DL_RVCHGS_RATE_3_6,
                   DLFILE.DL_PARVHELD_FRMLA,
                   DLFILE.DL_PARVHELD_CODE,
                   DLFILE.DL_PARVHELD_ADDON,
                   DLFILE.DL_PARVHELD_TERM_1,
                   DLFILE.DL_PARVHELD_RATE_1,
                   DLFILE.DL_PARVHELD_TERM_2,
                   DLFILE.DL_PARVHELD_RATE_2,
                   DLFILE.DL_PARVHELD_TERM_3,
                   DLFILE.DL_PARVHELD_RATE_3,
                   DLFILE.DL_PARVHELD_TERM_4,
                   DLFILE.DL_PARVHELD_RATE_4,
                   DLFILE.DL_PARVHELD_TERM_5,
                   DLFILE.DL_PARVHELD_RATE_5,
                   DLFILE.DL_PARVHELD_TERM_6,
                   DLFILE.DL_PARVHELD_RATE_6,
                   DLFILE.DL_PARVPAID_FRMLA,
                   DLFILE.DL_PARVPAID_CODE,
                   DLFILE.DL_PARVPAID_ADDON,
                   DLFILE.DL_PARVPAID_TERM_1,
                   DLFILE.DL_PARVPAID_RATE_1,
                   DLFILE.DL_PARVPAID_TERM_2,
                   DLFILE.DL_PARVPAID_RATE_2,
                   DLFILE.DL_PARVPAID_TERM_3,
                   DLFILE.DL_PARVPAID_RATE_3,
                   DLFILE.DL_PARVPAID_TERM_4,
                   DLFILE.DL_PARVPAID_RATE_4,
                   DLFILE.DL_PARVPAID_TERM_5,
                   DLFILE.DL_PARVPAID_RATE_5,
                   DLFILE.DL_PARVPAID_TERM_6,
                   DLFILE.DL_PARVPAID_RATE_6,
                   DLFILE.DL_SVACCT_FRMLA,
                   DLFILE.DL_SVCODE,
                   DLFILE.DL_SVACCT_AMT,
                   DLFILE.DL_SVACCT_RATE,
                   DLFILE.DL_SVACCT_LCHGPER,
                   DLFILE.DL_SVACCT_INTPER,
                   DLFILE.DL_SVACCT_DEFPER,
                   DLFILE.DL_FULLCEIL_BAL,
                   DLFILE.DL_PARTCEIL_BAL,
                   DLFILE.DL_NONCEIL_BAL,
                   DLFILE.DL_AFP_DEALER,
                   DLFILE.DL_RECOURSE_FRMLA,
                   DLFILE.DL_FAX_NUMBER,
                   DLFILE.DL_PARVPAID_FRMLA_IB,
                   DLFILE.DL_PARVPAID_CODE_IB,
                   DLFILE.DL_LPO,
                   DLFILE.DL_ACH_FG,
                   DLFILE.DL_BANK_ROUTING_NO,
                   DLFILE.DL_BANK_ACCTNO,
                   DLFILE.DL_ACH_PRENOTE_FG,
                   DLFILE.DL_SAL_MISC_PCT,
                   DLFILE.DL_SAL_MISC_PCT2,
                   DLFILE.DL_WAIVE_ACH_FEE,
                   DLFILE.DL_TRACK_CHANGE_FLAG,
                   DLFILE.DL_DBA_NAME
            FROM DBO.DLFILE
            WHERE DLFILE.DL_BRNO = :QDL1-WBEG-BRNO
              AND DLFILE.DL_NUM >= :QDL1-WBEG-NUM
              AND DLFILE.DL_NUM <= :QDL1-WEND-NUM
            ORDER BY DLFILE.DL_BRNO,
                     DLFILE.DL_NUM
           END-EXEC.

           EXEC SQL
               OPEN DL1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QDL1-WBEG-BRNO 
                          QDL1-WEND-BRNO
                          QDL1-WBEG-NUM
                          QDL1-WEND-NUM.

           MOVE STAT---GOOD TO DL1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-DL1-FILE.
           PERFORM READ-IT.
           MOVE DL-PATH-OWNBR  TO DL-BRNO. 
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.
           INITIALIZE QDL-REC.

      D    STOP MESS.
           MOVE DL-BRNO   TO QDL-BRNO.
           MOVE DL-NUM   TO QDL-NUM.

           EXEC SQL
            SELECT DLFILE.DL_BRNO,
                   DLFILE.DL_NUM,
                   CAST(DLFILE.DL_LTOUCH_DATE
                                                  AS VARCHAR(10)),
                   DLFILE.DL_NAME,
                   DLFILE.DL_ADR1,
                   DLFILE.DL_ADR2,
                   DLFILE.DL_CITY,
                   DLFILE.DL_STATE,
                   DLFILE.DL_ZIP,
                   DLFILE.DL_SHORT,
                   DLFILE.DL_PHONE,
                   DLFILE.DL_PURPOSE,
                   DLFILE.DL_MFGCODE,
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                   CAST(DLFILE.DL_ORIGDATE AS VARCHAR(10)),
      *            DLFILE.DL_ORIGDATE AS DATE,
      *            DLFILE.DL_ORIGDATE,
                   CAST(DLFILE.DL_TERMDATE AS VARCHAR(10)),
                   DLFILE.DL_LC_CODE,
                   DLFILE.DL_FULLCEIL,
                   DLFILE.DL_PARTCEIL,
                   DLFILE.DL_NONCEIL,
                   DLFILE.DL_SIGN1,
                   DLFILE.DL_SIGN2,
                   DLFILE.DL_SIGN3,
                   DLFILE.DL_MAXPURTRM,
                   DLFILE.DL_MAXPURPER,
                   DLFILE.DL_EARNCD,
                   DLFILE.DL_EARNFAC,
                   DLFILE.DL_DISC_FRMLA,
                   DLFILE.DL_DISC_CODE,
                   DLFILE.DL_DISC_TERM_1,
                   DLFILE.DL_DISC_RATE_1,
                   DLFILE.DL_DISC_TERM_2,
                   DLFILE.DL_DISC_RATE_2,
                   DLFILE.DL_DISC_TERM_3,
                   DLFILE.DL_DISC_RATE_3,
                   DLFILE.DL_DISC_TERM_4,
                   DLFILE.DL_DISC_RATE_4,
                   DLFILE.DL_DISC_TERM_5,
                   DLFILE.DL_DISC_RATE_5,
                   DLFILE.DL_DISC_TERM_6,
                   DLFILE.DL_DISC_RATE_6,
                   DLFILE.DL_RVPRIN_FRMLA_1,
                   DLFILE.DL_RVPRIN_CODE_1,
                   DLFILE.DL_RVPRIN_ADDON_1,
                   DLFILE.DL_RVPRIN_TERM_1_1,
                   DLFILE.DL_RVPRIN_RATE_1_1,
                   DLFILE.DL_RVPRIN_TERM_1_2,
                   DLFILE.DL_RVPRIN_RATE_1_2,
                   DLFILE.DL_RVPRIN_TERM_1_3,
                   DLFILE.DL_RVPRIN_RATE_1_3,
                   DLFILE.DL_RVPRIN_TERM_1_4,
                   DLFILE.DL_RVPRIN_RATE_1_4,
                   DLFILE.DL_RVPRIN_TERM_1_5,
                   DLFILE.DL_RVPRIN_RATE_1_5,
                   DLFILE.DL_RVPRIN_TERM_1_6,
                   DLFILE.DL_RVPRIN_RATE_1_6,
                   DLFILE.DL_RVPRIN_FRMLA_2,
                   DLFILE.DL_RVPRIN_CODE_2,
                   DLFILE.DL_RVPRIN_ADDON_2,
                   DLFILE.DL_RVPRIN_TERM_2_1,
                   DLFILE.DL_RVPRIN_RATE_2_1,
                   DLFILE.DL_RVPRIN_TERM_2_2,
                   DLFILE.DL_RVPRIN_RATE_2_2,
                   DLFILE.DL_RVPRIN_TERM_2_3,
                   DLFILE.DL_RVPRIN_RATE_2_3,
                   DLFILE.DL_RVPRIN_TERM_2_4,
                   DLFILE.DL_RVPRIN_RATE_2_4,
                   DLFILE.DL_RVPRIN_TERM_2_5,
                   DLFILE.DL_RVPRIN_RATE_2_5,
                   DLFILE.DL_RVPRIN_TERM_2_6,
                   DLFILE.DL_RVPRIN_RATE_2_6,
                   DLFILE.DL_RVPRIN_FRMLA_3,
                   DLFILE.DL_RVPRIN_CODE_3,
                   DLFILE.DL_RVPRIN_ADDON_3,
                   DLFILE.DL_RVPRIN_TERM_3_1,
                   DLFILE.DL_RVPRIN_RATE_3_1,
                   DLFILE.DL_RVPRIN_TERM_3_2,
                   DLFILE.DL_RVPRIN_RATE_3_2,
                   DLFILE.DL_RVPRIN_TERM_3_3,
                   DLFILE.DL_RVPRIN_RATE_3_3,
                   DLFILE.DL_RVPRIN_TERM_3_4,
                   DLFILE.DL_RVPRIN_RATE_3_4,
                   DLFILE.DL_RVPRIN_TERM_3_5,
                   DLFILE.DL_RVPRIN_RATE_3_5,
                   DLFILE.DL_RVPRIN_TERM_3_6,
                   DLFILE.DL_RVPRIN_RATE_3_6,
                   DLFILE.DL_RVCHGS_FRMLA_1,
                   DLFILE.DL_RVCHGS_CODE_1,
                   DLFILE.DL_RVCHGS_ADDON_1,
                   DLFILE.DL_RVCHGS_TERM_1_1,
                   DLFILE.DL_RVCHGS_RATE_1_1,
                   DLFILE.DL_RVCHGS_TERM_1_2,
                   DLFILE.DL_RVCHGS_RATE_1_2,
                   DLFILE.DL_RVCHGS_TERM_1_3,
                   DLFILE.DL_RVCHGS_RATE_1_3,
                   DLFILE.DL_RVCHGS_TERM_1_4,
                   DLFILE.DL_RVCHGS_RATE_1_4,
                   DLFILE.DL_RVCHGS_TERM_1_5,
                   DLFILE.DL_RVCHGS_RATE_1_5,
                   DLFILE.DL_RVCHGS_TERM_1_6,
                   DLFILE.DL_RVCHGS_RATE_1_6,
                   DLFILE.DL_RVCHGS_FRMLA_2,
                   DLFILE.DL_RVCHGS_CODE_2,
                   DLFILE.DL_RVCHGS_ADDON_2,
                   DLFILE.DL_RVCHGS_TERM_2_1,
                   DLFILE.DL_RVCHGS_RATE_2_1,
                   DLFILE.DL_RVCHGS_TERM_2_2,
                   DLFILE.DL_RVCHGS_RATE_2_2,
                   DLFILE.DL_RVCHGS_TERM_2_3,
                   DLFILE.DL_RVCHGS_RATE_2_3,
                   DLFILE.DL_RVCHGS_TERM_2_4,
                   DLFILE.DL_RVCHGS_RATE_2_4,
                   DLFILE.DL_RVCHGS_TERM_2_5,
                   DLFILE.DL_RVCHGS_RATE_2_5,
                   DLFILE.DL_RVCHGS_TERM_2_6,
                   DLFILE.DL_RVCHGS_RATE_2_6,
                   DLFILE.DL_RVCHGS_FRMLA_3,
                   DLFILE.DL_RVCHGS_CODE_3,
                   DLFILE.DL_RVCHGS_ADDON_3,
                   DLFILE.DL_RVCHGS_TERM_3_1,
                   DLFILE.DL_RVCHGS_RATE_3_1,
                   DLFILE.DL_RVCHGS_TERM_3_2,
                   DLFILE.DL_RVCHGS_RATE_3_2,
                   DLFILE.DL_RVCHGS_TERM_3_3,
                   DLFILE.DL_RVCHGS_RATE_3_3,
                   DLFILE.DL_RVCHGS_TERM_3_4,
                   DLFILE.DL_RVCHGS_RATE_3_4,
                   DLFILE.DL_RVCHGS_TERM_3_5,
                   DLFILE.DL_RVCHGS_RATE_3_5,
                   DLFILE.DL_RVCHGS_TERM_3_6,
                   DLFILE.DL_RVCHGS_RATE_3_6,
                   DLFILE.DL_PARVHELD_FRMLA,
                   DLFILE.DL_PARVHELD_CODE,
                   DLFILE.DL_PARVHELD_ADDON,
                   DLFILE.DL_PARVHELD_TERM_1,
                   DLFILE.DL_PARVHELD_RATE_1,
                   DLFILE.DL_PARVHELD_TERM_2,
                   DLFILE.DL_PARVHELD_RATE_2,
                   DLFILE.DL_PARVHELD_TERM_3,
                   DLFILE.DL_PARVHELD_RATE_3,
                   DLFILE.DL_PARVHELD_TERM_4,
                   DLFILE.DL_PARVHELD_RATE_4,
                   DLFILE.DL_PARVHELD_TERM_5,
                   DLFILE.DL_PARVHELD_RATE_5,
                   DLFILE.DL_PARVHELD_TERM_6,
                   DLFILE.DL_PARVHELD_RATE_6,
                   DLFILE.DL_PARVPAID_FRMLA,
                   DLFILE.DL_PARVPAID_CODE,
                   DLFILE.DL_PARVPAID_ADDON,
                   DLFILE.DL_PARVPAID_TERM_1,
                   DLFILE.DL_PARVPAID_RATE_1,
                   DLFILE.DL_PARVPAID_TERM_2,
                   DLFILE.DL_PARVPAID_RATE_2,
                   DLFILE.DL_PARVPAID_TERM_3,
                   DLFILE.DL_PARVPAID_RATE_3,
                   DLFILE.DL_PARVPAID_TERM_4,
                   DLFILE.DL_PARVPAID_RATE_4,
                   DLFILE.DL_PARVPAID_TERM_5,
                   DLFILE.DL_PARVPAID_RATE_5,
                   DLFILE.DL_PARVPAID_TERM_6,
                   DLFILE.DL_PARVPAID_RATE_6,
                   DLFILE.DL_SVACCT_FRMLA,
                   DLFILE.DL_SVCODE,
                   DLFILE.DL_SVACCT_AMT,
                   DLFILE.DL_SVACCT_RATE,
                   DLFILE.DL_SVACCT_LCHGPER,
                   DLFILE.DL_SVACCT_INTPER,
                   DLFILE.DL_SVACCT_DEFPER,
                   DLFILE.DL_FULLCEIL_BAL,
                   DLFILE.DL_PARTCEIL_BAL,
                   DLFILE.DL_NONCEIL_BAL,
                   DLFILE.DL_AFP_DEALER,
                   DLFILE.DL_RECOURSE_FRMLA,
                   DLFILE.DL_FAX_NUMBER,
                   DLFILE.DL_PARVPAID_FRMLA_IB,
                   DLFILE.DL_PARVPAID_CODE_IB,
                   DLFILE.DL_LPO,
                   DLFILE.DL_ACH_FG,
                   DLFILE.DL_BANK_ROUTING_NO,
                   DLFILE.DL_BANK_ACCTNO,
                   DLFILE.DL_ACH_PRENOTE_FG,
                   DLFILE.DL_SAL_MISC_PCT,
                   DLFILE.DL_SAL_MISC_PCT2,
                   DLFILE.DL_WAIVE_ACH_FEE,
                   DLFILE.DL_TRACK_CHANGE_FLAG,
                   DLFILE.DL_DBA_NAME
            INTO :QDL-REC
            FROM DBO.DLFILE
            WHERE DLFILE.DL_BRNO = :QDL-BRNO
              AND DLFILE.DL_NUM = :QDL-NUM
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-DL1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-DL-FIELDS.

      *-----------------------------------------------------------------
       READ-DL1-FILE-NEXT.
           PERFORM READ-IT.
           MOVE DL-PATH-OWNBR  TO DL-BRNO.
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.
           INITIALIZE QDL-REC.

           IF ( DL1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH DL1_CURSOR INTO :QDL-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-DL1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-DL-FIELDS.

      *-----------------------------------------------------------------
       WRITE-DL1-FILE.

           MOVE DL-PATH-OWNBR  TO DL-BRNO.
           ACCEPT DL-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM WRITE-IT.
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.
           PERFORM SET-DL-FIELDS.

           EXEC SQL
            INSERT INTO DBO.DLFILE
             (DLFILE.DL_BRNO,
              DLFILE.DL_NUM,
              DLFILE.DL_LTOUCH_DATE,
              DLFILE.DL_NAME,
              DLFILE.DL_ADR1,
              DLFILE.DL_ADR2,
              DLFILE.DL_CITY,
              DLFILE.DL_STATE,
              DLFILE.DL_ZIP,
              DLFILE.DL_SHORT,
              DLFILE.DL_PHONE,
              DLFILE.DL_PURPOSE,
              DLFILE.DL_MFGCODE,
              DLFILE.DL_ORIGDATE,
              DLFILE.DL_TERMDATE,
              DLFILE.DL_LC_CODE,
              DLFILE.DL_FULLCEIL,
              DLFILE.DL_PARTCEIL,
              DLFILE.DL_NONCEIL,
              DLFILE.DL_SIGN1,
              DLFILE.DL_SIGN2,
              DLFILE.DL_SIGN3,
              DLFILE.DL_MAXPURTRM,
              DLFILE.DL_MAXPURPER,
              DLFILE.DL_EARNCD,
              DLFILE.DL_EARNFAC,
              DLFILE.DL_DISC_FRMLA,
              DLFILE.DL_DISC_CODE,
              DLFILE.DL_DISC_TERM_1,
              DLFILE.DL_DISC_RATE_1,
              DLFILE.DL_DISC_TERM_2,
              DLFILE.DL_DISC_RATE_2,
              DLFILE.DL_DISC_TERM_3,
              DLFILE.DL_DISC_RATE_3,
              DLFILE.DL_DISC_TERM_4,
              DLFILE.DL_DISC_RATE_4,
              DLFILE.DL_DISC_TERM_5,
              DLFILE.DL_DISC_RATE_5,
              DLFILE.DL_DISC_TERM_6,
              DLFILE.DL_DISC_RATE_6,
              DLFILE.DL_RVPRIN_FRMLA_1,
              DLFILE.DL_RVPRIN_CODE_1,
              DLFILE.DL_RVPRIN_ADDON_1,
              DLFILE.DL_RVPRIN_TERM_1_1,
              DLFILE.DL_RVPRIN_RATE_1_1,
              DLFILE.DL_RVPRIN_TERM_1_2,
              DLFILE.DL_RVPRIN_RATE_1_2,
              DLFILE.DL_RVPRIN_TERM_1_3,
              DLFILE.DL_RVPRIN_RATE_1_3,
              DLFILE.DL_RVPRIN_TERM_1_4,
              DLFILE.DL_RVPRIN_RATE_1_4,
              DLFILE.DL_RVPRIN_TERM_1_5,
              DLFILE.DL_RVPRIN_RATE_1_5,
              DLFILE.DL_RVPRIN_TERM_1_6,
              DLFILE.DL_RVPRIN_RATE_1_6,
              DLFILE.DL_RVPRIN_FRMLA_2,
              DLFILE.DL_RVPRIN_CODE_2,
              DLFILE.DL_RVPRIN_ADDON_2,
              DLFILE.DL_RVPRIN_TERM_2_1,
              DLFILE.DL_RVPRIN_RATE_2_1,
              DLFILE.DL_RVPRIN_TERM_2_2,
              DLFILE.DL_RVPRIN_RATE_2_2,
              DLFILE.DL_RVPRIN_TERM_2_3,
              DLFILE.DL_RVPRIN_RATE_2_3,
              DLFILE.DL_RVPRIN_TERM_2_4,
              DLFILE.DL_RVPRIN_RATE_2_4,
              DLFILE.DL_RVPRIN_TERM_2_5,
              DLFILE.DL_RVPRIN_RATE_2_5,
              DLFILE.DL_RVPRIN_TERM_2_6,
              DLFILE.DL_RVPRIN_RATE_2_6,
              DLFILE.DL_RVPRIN_FRMLA_3,
              DLFILE.DL_RVPRIN_CODE_3,
              DLFILE.DL_RVPRIN_ADDON_3,
              DLFILE.DL_RVPRIN_TERM_3_1,
              DLFILE.DL_RVPRIN_RATE_3_1,
              DLFILE.DL_RVPRIN_TERM_3_2,
              DLFILE.DL_RVPRIN_RATE_3_2,
              DLFILE.DL_RVPRIN_TERM_3_3,
              DLFILE.DL_RVPRIN_RATE_3_3,
              DLFILE.DL_RVPRIN_TERM_3_4,
              DLFILE.DL_RVPRIN_RATE_3_4,
              DLFILE.DL_RVPRIN_TERM_3_5,
              DLFILE.DL_RVPRIN_RATE_3_5,
              DLFILE.DL_RVPRIN_TERM_3_6,
              DLFILE.DL_RVPRIN_RATE_3_6,
              DLFILE.DL_RVCHGS_FRMLA_1,
              DLFILE.DL_RVCHGS_CODE_1,
              DLFILE.DL_RVCHGS_ADDON_1,
              DLFILE.DL_RVCHGS_TERM_1_1,
              DLFILE.DL_RVCHGS_RATE_1_1,
              DLFILE.DL_RVCHGS_TERM_1_2,
              DLFILE.DL_RVCHGS_RATE_1_2,
              DLFILE.DL_RVCHGS_TERM_1_3,
              DLFILE.DL_RVCHGS_RATE_1_3,
              DLFILE.DL_RVCHGS_TERM_1_4,
              DLFILE.DL_RVCHGS_RATE_1_4,
              DLFILE.DL_RVCHGS_TERM_1_5,
              DLFILE.DL_RVCHGS_RATE_1_5,
              DLFILE.DL_RVCHGS_TERM_1_6,
              DLFILE.DL_RVCHGS_RATE_1_6,
              DLFILE.DL_RVCHGS_FRMLA_2,
              DLFILE.DL_RVCHGS_CODE_2,
              DLFILE.DL_RVCHGS_ADDON_2,
              DLFILE.DL_RVCHGS_TERM_2_1,
              DLFILE.DL_RVCHGS_RATE_2_1,
              DLFILE.DL_RVCHGS_TERM_2_2,
              DLFILE.DL_RVCHGS_RATE_2_2,
              DLFILE.DL_RVCHGS_TERM_2_3,
              DLFILE.DL_RVCHGS_RATE_2_3,
              DLFILE.DL_RVCHGS_TERM_2_4,
              DLFILE.DL_RVCHGS_RATE_2_4,
              DLFILE.DL_RVCHGS_TERM_2_5,
              DLFILE.DL_RVCHGS_RATE_2_5,
              DLFILE.DL_RVCHGS_TERM_2_6,
              DLFILE.DL_RVCHGS_RATE_2_6,
              DLFILE.DL_RVCHGS_FRMLA_3,
              DLFILE.DL_RVCHGS_CODE_3,
              DLFILE.DL_RVCHGS_ADDON_3,
              DLFILE.DL_RVCHGS_TERM_3_1,
              DLFILE.DL_RVCHGS_RATE_3_1,
              DLFILE.DL_RVCHGS_TERM_3_2,
              DLFILE.DL_RVCHGS_RATE_3_2,
              DLFILE.DL_RVCHGS_TERM_3_3,
              DLFILE.DL_RVCHGS_RATE_3_3,
              DLFILE.DL_RVCHGS_TERM_3_4,
              DLFILE.DL_RVCHGS_RATE_3_4,
              DLFILE.DL_RVCHGS_TERM_3_5,
              DLFILE.DL_RVCHGS_RATE_3_5,
              DLFILE.DL_RVCHGS_TERM_3_6,
              DLFILE.DL_RVCHGS_RATE_3_6,
              DLFILE.DL_PARVHELD_FRMLA,
              DLFILE.DL_PARVHELD_CODE,
              DLFILE.DL_PARVHELD_ADDON,
              DLFILE.DL_PARVHELD_TERM_1,
              DLFILE.DL_PARVHELD_RATE_1,
              DLFILE.DL_PARVHELD_TERM_2,
              DLFILE.DL_PARVHELD_RATE_2,
              DLFILE.DL_PARVHELD_TERM_3,
              DLFILE.DL_PARVHELD_RATE_3,
              DLFILE.DL_PARVHELD_TERM_4,
              DLFILE.DL_PARVHELD_RATE_4,
              DLFILE.DL_PARVHELD_TERM_5,
              DLFILE.DL_PARVHELD_RATE_5,
              DLFILE.DL_PARVHELD_TERM_6,
              DLFILE.DL_PARVHELD_RATE_6,
              DLFILE.DL_PARVPAID_FRMLA,
              DLFILE.DL_PARVPAID_CODE,
              DLFILE.DL_PARVPAID_ADDON,
              DLFILE.DL_PARVPAID_TERM_1,
              DLFILE.DL_PARVPAID_RATE_1,
              DLFILE.DL_PARVPAID_TERM_2,
              DLFILE.DL_PARVPAID_RATE_2,
              DLFILE.DL_PARVPAID_TERM_3,
              DLFILE.DL_PARVPAID_RATE_3,
              DLFILE.DL_PARVPAID_TERM_4,
              DLFILE.DL_PARVPAID_RATE_4,
              DLFILE.DL_PARVPAID_TERM_5,
              DLFILE.DL_PARVPAID_RATE_5,
              DLFILE.DL_PARVPAID_TERM_6,
              DLFILE.DL_PARVPAID_RATE_6,
              DLFILE.DL_SVACCT_FRMLA,
              DLFILE.DL_SVCODE,
              DLFILE.DL_SVACCT_AMT,
              DLFILE.DL_SVACCT_RATE,
              DLFILE.DL_SVACCT_LCHGPER,
              DLFILE.DL_SVACCT_INTPER,
              DLFILE.DL_SVACCT_DEFPER,
              DLFILE.DL_FULLCEIL_BAL,
              DLFILE.DL_PARTCEIL_BAL,
              DLFILE.DL_NONCEIL_BAL,
              DLFILE.DL_AFP_DEALER,
              DLFILE.DL_RECOURSE_FRMLA,
              DLFILE.DL_FAX_NUMBER,
              DLFILE.DL_PARVPAID_FRMLA_IB,
              DLFILE.DL_PARVPAID_CODE_IB,
              DLFILE.DL_LPO,
              DLFILE.DL_ACH_FG,
              DLFILE.DL_BANK_ROUTING_NO,
              DLFILE.DL_BANK_ACCTNO,
              DLFILE.DL_ACH_PRENOTE_FG,
              DLFILE.DL_SAL_MISC_PCT,
              DLFILE.DL_SAL_MISC_PCT2,
              DLFILE.DL_WAIVE_ACH_FEE,
              DLFILE.DL_TRACK_CHANGE_FLAG,
              DLFILE.DL_DBA_NAME)
            VALUES
             (:QDL-BRNO,
              :QDL-NUM,
              :QDL-LTOUCH-DATE,
              :QDL-NAME,
              :QDL-ADR1,
              :QDL-ADR2,
              :QDL-CITY,
              :QDL-STATE,
              :QDL-ZIP,
              :QDL-SHORT,
              :QDL-PHONE,
              :QDL-PURPOSE,
              :QDL-MFGCODE,
              :QDL-ORIGDATE,
              :QDL-TERMDATE,
              :QDL-LC-CODE,
              :QDL-FULLCEIL,
              :QDL-PARTCEIL,
              :QDL-NONCEIL,
              :QDL-SIGN1,
              :QDL-SIGN2,
              :QDL-SIGN3,
              :QDL-MAXPURTRM,
              :QDL-MAXPURPER,
              :QDL-EARNCD,
              :QDL-EARNFAC,
              :QDL-DISC-FRMLA,
              :QDL-DISC-CODE,
              :QDL-DISC-TERM-1,
              :QDL-DISC-RATE-1,
              :QDL-DISC-TERM-2,
              :QDL-DISC-RATE-2,
              :QDL-DISC-TERM-3,
              :QDL-DISC-RATE-3,
              :QDL-DISC-TERM-4,
              :QDL-DISC-RATE-4,
              :QDL-DISC-TERM-5,
              :QDL-DISC-RATE-5,
              :QDL-DISC-TERM-6,
              :QDL-DISC-RATE-6,
              :QDL-RVPRIN-FRMLA-1,
              :QDL-RVPRIN-CODE-1,
              :QDL-RVPRIN-ADDON-1,
              :QDL-RVPRIN-TERM-1-1,
              :QDL-RVPRIN-RATE-1-1,
              :QDL-RVPRIN-TERM-1-2,
              :QDL-RVPRIN-RATE-1-2,
              :QDL-RVPRIN-TERM-1-3,
              :QDL-RVPRIN-RATE-1-3,
              :QDL-RVPRIN-TERM-1-4,
              :QDL-RVPRIN-RATE-1-4,
              :QDL-RVPRIN-TERM-1-5,
              :QDL-RVPRIN-RATE-1-5,
              :QDL-RVPRIN-TERM-1-6,
              :QDL-RVPRIN-RATE-1-6,
              :QDL-RVPRIN-FRMLA-2,
              :QDL-RVPRIN-CODE-2,
              :QDL-RVPRIN-ADDON-2,
              :QDL-RVPRIN-TERM-2-1,
              :QDL-RVPRIN-RATE-2-1,
              :QDL-RVPRIN-TERM-2-2,
              :QDL-RVPRIN-RATE-2-2,
              :QDL-RVPRIN-TERM-2-3,
              :QDL-RVPRIN-RATE-2-3,
              :QDL-RVPRIN-TERM-2-4,
              :QDL-RVPRIN-RATE-2-4,
              :QDL-RVPRIN-TERM-2-5,
              :QDL-RVPRIN-RATE-2-5,
              :QDL-RVPRIN-TERM-2-6,
              :QDL-RVPRIN-RATE-2-6,
              :QDL-RVPRIN-FRMLA-3,
              :QDL-RVPRIN-CODE-3,
              :QDL-RVPRIN-ADDON-3,
              :QDL-RVPRIN-TERM-3-1,
              :QDL-RVPRIN-RATE-3-1,
              :QDL-RVPRIN-TERM-3-2,
              :QDL-RVPRIN-RATE-3-2,
              :QDL-RVPRIN-TERM-3-3,
              :QDL-RVPRIN-RATE-3-3,
              :QDL-RVPRIN-TERM-3-4,
              :QDL-RVPRIN-RATE-3-4,
              :QDL-RVPRIN-TERM-3-5,
              :QDL-RVPRIN-RATE-3-5,
              :QDL-RVPRIN-TERM-3-6,
              :QDL-RVPRIN-RATE-3-6,
              :QDL-RVCHGS-FRMLA-1,
              :QDL-RVCHGS-CODE-1,
              :QDL-RVCHGS-ADDON-1,
              :QDL-RVCHGS-TERM-1-1,
              :QDL-RVCHGS-RATE-1-1,
              :QDL-RVCHGS-TERM-1-2,
              :QDL-RVCHGS-RATE-1-2,
              :QDL-RVCHGS-TERM-1-3,
              :QDL-RVCHGS-RATE-1-3,
              :QDL-RVCHGS-TERM-1-4,
              :QDL-RVCHGS-RATE-1-4,
              :QDL-RVCHGS-TERM-1-5,
              :QDL-RVCHGS-RATE-1-5,
              :QDL-RVCHGS-TERM-1-6,
              :QDL-RVCHGS-RATE-1-6,
              :QDL-RVCHGS-FRMLA-2,
              :QDL-RVCHGS-CODE-2,
              :QDL-RVCHGS-ADDON-2,
              :QDL-RVCHGS-TERM-2-1,
              :QDL-RVCHGS-RATE-2-1,
              :QDL-RVCHGS-TERM-2-2,
              :QDL-RVCHGS-RATE-2-2,
              :QDL-RVCHGS-TERM-2-3,
              :QDL-RVCHGS-RATE-2-3,
              :QDL-RVCHGS-TERM-2-4,
              :QDL-RVCHGS-RATE-2-4,
              :QDL-RVCHGS-TERM-2-5,
              :QDL-RVCHGS-RATE-2-5,
              :QDL-RVCHGS-TERM-2-6,
              :QDL-RVCHGS-RATE-2-6,
              :QDL-RVCHGS-FRMLA-3,
              :QDL-RVCHGS-CODE-3,
              :QDL-RVCHGS-ADDON-3,
              :QDL-RVCHGS-TERM-3-1,
              :QDL-RVCHGS-RATE-3-1,
              :QDL-RVCHGS-TERM-3-2,
              :QDL-RVCHGS-RATE-3-2,
              :QDL-RVCHGS-TERM-3-3,
              :QDL-RVCHGS-RATE-3-3,
              :QDL-RVCHGS-TERM-3-4,
              :QDL-RVCHGS-RATE-3-4,
              :QDL-RVCHGS-TERM-3-5,
              :QDL-RVCHGS-RATE-3-5,
              :QDL-RVCHGS-TERM-3-6,
              :QDL-RVCHGS-RATE-3-6,
              :QDL-PARVHELD-FRMLA,
              :QDL-PARVHELD-CODE,
              :QDL-PARVHELD-ADDON,
              :QDL-PARVHELD-TERM-1,
              :QDL-PARVHELD-RATE-1,
              :QDL-PARVHELD-TERM-2,
              :QDL-PARVHELD-RATE-2,
              :QDL-PARVHELD-TERM-3,
              :QDL-PARVHELD-RATE-3,
              :QDL-PARVHELD-TERM-4,
              :QDL-PARVHELD-RATE-4,
              :QDL-PARVHELD-TERM-5,
              :QDL-PARVHELD-RATE-5,
              :QDL-PARVHELD-TERM-6,
              :QDL-PARVHELD-RATE-6,
              :QDL-PARVPAID-FRMLA,
              :QDL-PARVPAID-CODE,
              :QDL-PARVPAID-ADDON,
              :QDL-PARVPAID-TERM-1,
              :QDL-PARVPAID-RATE-1,
              :QDL-PARVPAID-TERM-2,
              :QDL-PARVPAID-RATE-2,
              :QDL-PARVPAID-TERM-3,
              :QDL-PARVPAID-RATE-3,
              :QDL-PARVPAID-TERM-4,
              :QDL-PARVPAID-RATE-4,
              :QDL-PARVPAID-TERM-5,
              :QDL-PARVPAID-RATE-5,
              :QDL-PARVPAID-TERM-6,
              :QDL-PARVPAID-RATE-6,
              :QDL-SVACCT-FRMLA,
              :QDL-SVCODE,
              :QDL-SVACCT-AMT,
              :QDL-SVACCT-RATE,
              :QDL-SVACCT-LCHGPER,
              :QDL-SVACCT-INTPER,
              :QDL-SVACCT-DEFPER,
              :QDL-FULLCEIL-BAL,
              :QDL-PARTCEIL-BAL,
              :QDL-NONCEIL-BAL,
              :QDL-AFP-DEALER,
              :QDL-RECOURSE-FRMLA,
              :QDL-FAX-NUMBER,
              :QDL-PARVPAID-FRMLA-IB,
              :QDL-PARVPAID-CODE-IB,
              :QDL-LPO,
              :QDL-ACH-FG,
              :QDL-BANK-ROUTING-NO,
              :QDL-BANK-ACCTNO,
              :QDL-ACH-PRENOTE-FG,
              :QDL-SAL-MISC-PCT,
              :QDL-SAL-MISC-PCT2,
              :QDL-WAIVE-ACH-FEE,
              :QDL-TRACK-CHANGE-FLAG,
              :QDL-DBA-NAME)
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO WRITE-DL1-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       REWRITE-DL1-FILE.

           MOVE DL-PATH-OWNBR  TO DL-BRNO.
           ACCEPT DL-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.
           PERFORM SET-DL-FIELDS.

           EXEC SQL
            UPDATE DBO.DLFILE
             SET
              DLFILE.DL_BRNO = :QDL-BRNO,
              DLFILE.DL_NUM = :QDL-NUM,
              DLFILE.DL_LTOUCH_DATE =
                 :QDL-LTOUCH-DATE,
              DLFILE.DL_NAME = :QDL-NAME,
              DLFILE.DL_ADR1 = :QDL-ADR1,
              DLFILE.DL_ADR2 = :QDL-ADR2,
              DLFILE.DL_CITY = :QDL-CITY,
              DLFILE.DL_STATE = :QDL-STATE,
              DLFILE.DL_ZIP = :QDL-ZIP,
              DLFILE.DL_SHORT = :QDL-SHORT,
              DLFILE.DL_PHONE = :QDL-PHONE,
              DLFILE.DL_PURPOSE = :QDL-PURPOSE,
              DLFILE.DL_MFGCODE = :QDL-MFGCODE,
              DLFILE.DL_ORIGDATE = :QDL-ORIGDATE,
              DLFILE.DL_TERMDATE = :QDL-TERMDATE,
              DLFILE.DL_LC_CODE = :QDL-LC-CODE,
              DLFILE.DL_FULLCEIL = :QDL-FULLCEIL,
              DLFILE.DL_PARTCEIL = :QDL-PARTCEIL,
              DLFILE.DL_NONCEIL = :QDL-NONCEIL,
              DLFILE.DL_SIGN1 = :QDL-SIGN1,
              DLFILE.DL_SIGN2 = :QDL-SIGN2,
              DLFILE.DL_SIGN3 = :QDL-SIGN3,
              DLFILE.DL_MAXPURTRM = :QDL-MAXPURTRM,
              DLFILE.DL_MAXPURPER = :QDL-MAXPURPER,
              DLFILE.DL_EARNCD = :QDL-EARNCD,
              DLFILE.DL_EARNFAC = :QDL-EARNFAC,
              DLFILE.DL_DISC_FRMLA = :QDL-DISC-FRMLA,
              DLFILE.DL_DISC_CODE = :QDL-DISC-CODE,
              DLFILE.DL_DISC_TERM_1 = :QDL-DISC-TERM-1,
              DLFILE.DL_DISC_RATE_1 = :QDL-DISC-RATE-1,
              DLFILE.DL_DISC_TERM_2 = :QDL-DISC-TERM-2,
              DLFILE.DL_DISC_RATE_2 = :QDL-DISC-RATE-2,
              DLFILE.DL_DISC_TERM_3 = :QDL-DISC-TERM-3,
              DLFILE.DL_DISC_RATE_3 = :QDL-DISC-RATE-3,
              DLFILE.DL_DISC_TERM_4 = :QDL-DISC-TERM-4,
              DLFILE.DL_DISC_RATE_4 = :QDL-DISC-RATE-4,
              DLFILE.DL_DISC_TERM_5 = :QDL-DISC-TERM-5,
              DLFILE.DL_DISC_RATE_5 = :QDL-DISC-RATE-5,
              DLFILE.DL_DISC_TERM_6 = :QDL-DISC-TERM-6,
              DLFILE.DL_DISC_RATE_6 = :QDL-DISC-RATE-6,
              DLFILE.DL_RVPRIN_FRMLA_1 = :QDL-RVPRIN-FRMLA-1,
              DLFILE.DL_RVPRIN_CODE_1 = :QDL-RVPRIN-CODE-1,
              DLFILE.DL_RVPRIN_ADDON_1 = :QDL-RVPRIN-ADDON-1,
              DLFILE.DL_RVPRIN_TERM_1_1 = :QDL-RVPRIN-TERM-1-1,
              DLFILE.DL_RVPRIN_RATE_1_1 = :QDL-RVPRIN-RATE-1-1,
              DLFILE.DL_RVPRIN_TERM_1_2 = :QDL-RVPRIN-TERM-1-2,
              DLFILE.DL_RVPRIN_RATE_1_2 = :QDL-RVPRIN-RATE-1-2,
              DLFILE.DL_RVPRIN_TERM_1_3 = :QDL-RVPRIN-TERM-1-3,
              DLFILE.DL_RVPRIN_RATE_1_3 = :QDL-RVPRIN-RATE-1-3,
              DLFILE.DL_RVPRIN_TERM_1_4 = :QDL-RVPRIN-TERM-1-4,
              DLFILE.DL_RVPRIN_RATE_1_4 = :QDL-RVPRIN-RATE-1-4,
              DLFILE.DL_RVPRIN_TERM_1_5 = :QDL-RVPRIN-TERM-1-5,
              DLFILE.DL_RVPRIN_RATE_1_5 = :QDL-RVPRIN-RATE-1-5,
              DLFILE.DL_RVPRIN_TERM_1_6 = :QDL-RVPRIN-TERM-1-6,
              DLFILE.DL_RVPRIN_RATE_1_6 = :QDL-RVPRIN-RATE-1-6,
              DLFILE.DL_RVPRIN_FRMLA_2 = :QDL-RVPRIN-FRMLA-2,
              DLFILE.DL_RVPRIN_CODE_2 = :QDL-RVPRIN-CODE-2,
              DLFILE.DL_RVPRIN_ADDON_2 = :QDL-RVPRIN-ADDON-2,
              DLFILE.DL_RVPRIN_TERM_2_1 = :QDL-RVPRIN-TERM-2-1,
              DLFILE.DL_RVPRIN_RATE_2_1 = :QDL-RVPRIN-RATE-2-1,
              DLFILE.DL_RVPRIN_TERM_2_2 = :QDL-RVPRIN-TERM-2-2,
              DLFILE.DL_RVPRIN_RATE_2_2 = :QDL-RVPRIN-RATE-2-2,
              DLFILE.DL_RVPRIN_TERM_2_3 = :QDL-RVPRIN-TERM-2-3,
              DLFILE.DL_RVPRIN_RATE_2_3 = :QDL-RVPRIN-RATE-2-3,
              DLFILE.DL_RVPRIN_TERM_2_4 = :QDL-RVPRIN-TERM-2-4,
              DLFILE.DL_RVPRIN_RATE_2_4 = :QDL-RVPRIN-RATE-2-4,
              DLFILE.DL_RVPRIN_TERM_2_5 = :QDL-RVPRIN-TERM-2-5,
              DLFILE.DL_RVPRIN_RATE_2_5 = :QDL-RVPRIN-RATE-2-5,
              DLFILE.DL_RVPRIN_TERM_2_6 = :QDL-RVPRIN-TERM-2-6,
              DLFILE.DL_RVPRIN_RATE_2_6 = :QDL-RVPRIN-RATE-2-6,
              DLFILE.DL_RVPRIN_FRMLA_3 = :QDL-RVPRIN-FRMLA-3,
              DLFILE.DL_RVPRIN_CODE_3 = :QDL-RVPRIN-CODE-3,
              DLFILE.DL_RVPRIN_ADDON_3 = :QDL-RVPRIN-ADDON-3,
              DLFILE.DL_RVPRIN_TERM_3_1 = :QDL-RVPRIN-TERM-3-1,
              DLFILE.DL_RVPRIN_RATE_3_1 = :QDL-RVPRIN-RATE-3-1,
              DLFILE.DL_RVPRIN_TERM_3_2 = :QDL-RVPRIN-TERM-3-2,
              DLFILE.DL_RVPRIN_RATE_3_2 = :QDL-RVPRIN-RATE-3-2,
              DLFILE.DL_RVPRIN_TERM_3_3 = :QDL-RVPRIN-TERM-3-3,
              DLFILE.DL_RVPRIN_RATE_3_3 = :QDL-RVPRIN-RATE-3-3,
              DLFILE.DL_RVPRIN_TERM_3_4 = :QDL-RVPRIN-TERM-3-4,
              DLFILE.DL_RVPRIN_RATE_3_4 = :QDL-RVPRIN-RATE-3-4,
              DLFILE.DL_RVPRIN_TERM_3_5 = :QDL-RVPRIN-TERM-3-5,
              DLFILE.DL_RVPRIN_RATE_3_5 = :QDL-RVPRIN-RATE-3-5,
              DLFILE.DL_RVPRIN_TERM_3_6 = :QDL-RVPRIN-TERM-3-6,
              DLFILE.DL_RVPRIN_RATE_3_6 = :QDL-RVPRIN-RATE-3-6,
              DLFILE.DL_RVCHGS_FRMLA_1 = :QDL-RVCHGS-FRMLA-1,
              DLFILE.DL_RVCHGS_CODE_1 = :QDL-RVCHGS-CODE-1,
              DLFILE.DL_RVCHGS_ADDON_1 = :QDL-RVCHGS-ADDON-1,
              DLFILE.DL_RVCHGS_TERM_1_1 = :QDL-RVCHGS-TERM-1-1,
              DLFILE.DL_RVCHGS_RATE_1_1 = :QDL-RVCHGS-RATE-1-1,
              DLFILE.DL_RVCHGS_TERM_1_2 = :QDL-RVCHGS-TERM-1-2,
              DLFILE.DL_RVCHGS_RATE_1_2 = :QDL-RVCHGS-RATE-1-2,
              DLFILE.DL_RVCHGS_TERM_1_3 = :QDL-RVCHGS-TERM-1-3,
              DLFILE.DL_RVCHGS_RATE_1_3 = :QDL-RVCHGS-RATE-1-3,
              DLFILE.DL_RVCHGS_TERM_1_4 = :QDL-RVCHGS-TERM-1-4,
              DLFILE.DL_RVCHGS_RATE_1_4 = :QDL-RVCHGS-RATE-1-4,
              DLFILE.DL_RVCHGS_TERM_1_5 = :QDL-RVCHGS-TERM-1-5,
              DLFILE.DL_RVCHGS_RATE_1_5 = :QDL-RVCHGS-RATE-1-5,
              DLFILE.DL_RVCHGS_TERM_1_6 = :QDL-RVCHGS-TERM-1-6,
              DLFILE.DL_RVCHGS_RATE_1_6 = :QDL-RVCHGS-RATE-1-6,
              DLFILE.DL_RVCHGS_FRMLA_2 = :QDL-RVCHGS-FRMLA-2,
              DLFILE.DL_RVCHGS_CODE_2 = :QDL-RVCHGS-CODE-2,
              DLFILE.DL_RVCHGS_ADDON_2 = :QDL-RVCHGS-ADDON-2,
              DLFILE.DL_RVCHGS_TERM_2_1 = :QDL-RVCHGS-TERM-2-1,
              DLFILE.DL_RVCHGS_RATE_2_1 = :QDL-RVCHGS-RATE-2-1,
              DLFILE.DL_RVCHGS_TERM_2_2 = :QDL-RVCHGS-TERM-2-2,
              DLFILE.DL_RVCHGS_RATE_2_2 = :QDL-RVCHGS-RATE-2-2,
              DLFILE.DL_RVCHGS_TERM_2_3 = :QDL-RVCHGS-TERM-2-3,
              DLFILE.DL_RVCHGS_RATE_2_3 = :QDL-RVCHGS-RATE-2-3,
              DLFILE.DL_RVCHGS_TERM_2_4 = :QDL-RVCHGS-TERM-2-4,
              DLFILE.DL_RVCHGS_RATE_2_4 = :QDL-RVCHGS-RATE-2-4,
              DLFILE.DL_RVCHGS_TERM_2_5 = :QDL-RVCHGS-TERM-2-5,
              DLFILE.DL_RVCHGS_RATE_2_5 = :QDL-RVCHGS-RATE-2-5,
              DLFILE.DL_RVCHGS_TERM_2_6 = :QDL-RVCHGS-TERM-2-6,
              DLFILE.DL_RVCHGS_RATE_2_6 = :QDL-RVCHGS-RATE-2-6,
              DLFILE.DL_RVCHGS_FRMLA_3 = :QDL-RVCHGS-FRMLA-3,
              DLFILE.DL_RVCHGS_CODE_3 = :QDL-RVCHGS-CODE-3,
              DLFILE.DL_RVCHGS_ADDON_3 = :QDL-RVCHGS-ADDON-3,
              DLFILE.DL_RVCHGS_TERM_3_1 = :QDL-RVCHGS-TERM-3-1,
              DLFILE.DL_RVCHGS_RATE_3_1 = :QDL-RVCHGS-RATE-3-1,
              DLFILE.DL_RVCHGS_TERM_3_2 = :QDL-RVCHGS-TERM-3-2,
              DLFILE.DL_RVCHGS_RATE_3_2 = :QDL-RVCHGS-RATE-3-2,
              DLFILE.DL_RVCHGS_TERM_3_3 = :QDL-RVCHGS-TERM-3-3,
              DLFILE.DL_RVCHGS_RATE_3_3 = :QDL-RVCHGS-RATE-3-3,
              DLFILE.DL_RVCHGS_TERM_3_4 = :QDL-RVCHGS-TERM-3-4,
              DLFILE.DL_RVCHGS_RATE_3_4 = :QDL-RVCHGS-RATE-3-4,
              DLFILE.DL_RVCHGS_TERM_3_5 = :QDL-RVCHGS-TERM-3-5,
              DLFILE.DL_RVCHGS_RATE_3_5 = :QDL-RVCHGS-RATE-3-5,
              DLFILE.DL_RVCHGS_TERM_3_6 = :QDL-RVCHGS-TERM-3-6,
              DLFILE.DL_RVCHGS_RATE_3_6 = :QDL-RVCHGS-RATE-3-6,
              DLFILE.DL_PARVHELD_FRMLA = :QDL-PARVHELD-FRMLA,
              DLFILE.DL_PARVHELD_CODE = :QDL-PARVHELD-CODE,
              DLFILE.DL_PARVHELD_ADDON = :QDL-PARVHELD-ADDON,
              DLFILE.DL_PARVHELD_TERM_1 = :QDL-PARVHELD-TERM-1,
              DLFILE.DL_PARVHELD_RATE_1 = :QDL-PARVHELD-RATE-1,
              DLFILE.DL_PARVHELD_TERM_2 = :QDL-PARVHELD-TERM-2,
              DLFILE.DL_PARVHELD_RATE_2 = :QDL-PARVHELD-RATE-2,
              DLFILE.DL_PARVHELD_TERM_3 = :QDL-PARVHELD-TERM-3,
              DLFILE.DL_PARVHELD_RATE_3 = :QDL-PARVHELD-RATE-3,
              DLFILE.DL_PARVHELD_TERM_4 = :QDL-PARVHELD-TERM-4,
              DLFILE.DL_PARVHELD_RATE_4 = :QDL-PARVHELD-RATE-4,
              DLFILE.DL_PARVHELD_TERM_5 = :QDL-PARVHELD-TERM-5,
              DLFILE.DL_PARVHELD_RATE_5 = :QDL-PARVHELD-RATE-5,
              DLFILE.DL_PARVHELD_TERM_6 = :QDL-PARVHELD-TERM-6,
              DLFILE.DL_PARVHELD_RATE_6 = :QDL-PARVHELD-RATE-6,
              DLFILE.DL_PARVPAID_FRMLA = :QDL-PARVPAID-FRMLA,
              DLFILE.DL_PARVPAID_CODE = :QDL-PARVPAID-CODE,
              DLFILE.DL_PARVPAID_ADDON = :QDL-PARVPAID-ADDON,
              DLFILE.DL_PARVPAID_TERM_1 = :QDL-PARVPAID-TERM-1,
              DLFILE.DL_PARVPAID_RATE_1 = :QDL-PARVPAID-RATE-1,
              DLFILE.DL_PARVPAID_TERM_2 = :QDL-PARVPAID-TERM-2,
              DLFILE.DL_PARVPAID_RATE_2 = :QDL-PARVPAID-RATE-2,
              DLFILE.DL_PARVPAID_TERM_3 = :QDL-PARVPAID-TERM-3,
              DLFILE.DL_PARVPAID_RATE_3 = :QDL-PARVPAID-RATE-3,
              DLFILE.DL_PARVPAID_TERM_4 = :QDL-PARVPAID-TERM-4,
              DLFILE.DL_PARVPAID_RATE_4 = :QDL-PARVPAID-RATE-4,
              DLFILE.DL_PARVPAID_TERM_5 = :QDL-PARVPAID-TERM-5,
              DLFILE.DL_PARVPAID_RATE_5 = :QDL-PARVPAID-RATE-5,
              DLFILE.DL_PARVPAID_TERM_6 = :QDL-PARVPAID-TERM-6,
              DLFILE.DL_PARVPAID_RATE_6 = :QDL-PARVPAID-RATE-6,
              DLFILE.DL_SVACCT_FRMLA = :QDL-SVACCT-FRMLA,
              DLFILE.DL_SVCODE = :QDL-SVCODE,
              DLFILE.DL_SVACCT_AMT = :QDL-SVACCT-AMT,
              DLFILE.DL_SVACCT_RATE = :QDL-SVACCT-RATE,
              DLFILE.DL_SVACCT_LCHGPER = :QDL-SVACCT-LCHGPER,
              DLFILE.DL_SVACCT_INTPER = :QDL-SVACCT-INTPER,
              DLFILE.DL_SVACCT_DEFPER = :QDL-SVACCT-DEFPER,
              DLFILE.DL_FULLCEIL_BAL = :QDL-FULLCEIL-BAL,
              DLFILE.DL_PARTCEIL_BAL = :QDL-PARTCEIL-BAL,
              DLFILE.DL_NONCEIL_BAL = :QDL-NONCEIL-BAL,
              DLFILE.DL_AFP_DEALER = :QDL-AFP-DEALER,
              DLFILE.DL_RECOURSE_FRMLA = :QDL-RECOURSE-FRMLA,
              DLFILE.DL_FAX_NUMBER = :QDL-FAX-NUMBER,
              DLFILE.DL_PARVPAID_FRMLA_IB =
                   :QDL-PARVPAID-FRMLA-IB,
              DLFILE.DL_PARVPAID_CODE_IB = :QDL-PARVPAID-CODE-IB,
              DLFILE.DL_LPO = :QDL-LPO,
              DLFILE.DL_ACH_FG = :QDL-ACH-FG,
              DLFILE.DL_BANK_ROUTING_NO = :QDL-BANK-ROUTING-NO,
              DLFILE.DL_BANK_ACCTNO = :QDL-BANK-ACCTNO,
              DLFILE.DL_ACH_PRENOTE_FG = :QDL-ACH-PRENOTE-FG,
              DLFILE.DL_SAL_MISC_PCT = :QDL-SAL-MISC-PCT,
              DLFILE.DL_SAL_MISC_PCT2 = :QDL-SAL-MISC-PCT2,
              DLFILE.DL_WAIVE_ACH_FEE = :QDL-WAIVE-ACH-FEE,
              DLFILE.DL_TRACK_CHANGE_FLAG =
                   :QDL-TRACK-CHANGE-FLAG,
              DLFILE.DL_DBA_NAME = :QDL-DBA-NAME
             WHERE DLFILE.DL_BRNO = :QDL-BRNO
               AND DLFILE.DL_NUM = :QDL-NUM
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-DL1-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       DELETE-DL1-FILE.

           MOVE DL-PATH-OWNBR  TO DL-BRNO.
           PERFORM DELETE-IT.
           MOVE DL-PATH-SQL    TO E-FILE.
           MOVE DL1-KEY        TO E-KEYX.
           PERFORM SET-DL-FIELDS.

           EXEC SQL
            DELETE FROM DBO.DLFILE
             WHERE DLFILE.DL_BRNO = :QDL-BRNO
               AND DLFILE.DL_NUM = :QDL-NUM
           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-DL1-FILE.

      *-----------------------------------------------------------------
       CLOSE-DL1-FILE.

           PERFORM CLOSE-IT.

           IF ( DL1-CURSOR-STAT-GOOD )
              EXEC SQL
                   CLOSE DL1_CURSOR
              END-EXEC
              MOVE STAT---BAD TO DL1-CURSOR-STAT.

