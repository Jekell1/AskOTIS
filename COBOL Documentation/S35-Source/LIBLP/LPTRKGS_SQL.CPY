      * COPYMEMBER: LIBLP/LPTRKGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - TRKFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD TRK-REC FROM QTRK-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-TRK-FIELDS.
           MOVE QTK-BRNO TO TK-BRNO.

           IF ( QTK-DATE = "1900-01-01" )
              MOVE ZEROES TO TK-DATE
           ELSE
              MOVE QTK-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TK-DATE.

           MOVE QTK-CLASS TO TK-CLASS.
           MOVE QTK-ACCTNO TO TK-ACCTNO.
           MOVE QTK-LAWCODE TO TK-LAWCODE.
           MOVE QTK-LINE TO TK-LINE.

           IF ( QTK-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO TK-LTOUCH-DATE
           ELSE
              MOVE QTK-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TK-LTOUCH-DATE.

           MOVE QTK-SSNO-1 TO TK-SSNO(1).
           MOVE QTK-MAKERCD-1 TO TK-MAKERCD(1).
           MOVE QTK-SSNO-2 TO TK-SSNO(2).
           MOVE QTK-MAKERCD-2 TO TK-MAKERCD(2).
           MOVE QTK-SSNO-3 TO TK-SSNO(3).
           MOVE QTK-MAKERCD-3 TO TK-MAKERCD(3).
           MOVE QTK-SSNO-4 TO TK-SSNO(4).
           MOVE QTK-MAKERCD-4 TO TK-MAKERCD(4).
           MOVE QTK-REF-FRTO TO TK-REF-FRTO.
           MOVE QTK-REFBR TO TK-REFBR.
           MOVE QTK-PURCD TO TK-PURCD.
           MOVE QTK-SRCD TO TK-SRCD.
           MOVE QTK-COLLCD TO TK-COLLCD.
           MOVE QTK-SERVACCT TO TK-SERVACCT.
           MOVE QTK-LOANTYPE TO TK-LOANTYPE.
           MOVE QTK-SUBCLASS TO TK-SUBCLASS.
           MOVE QTK-REPOCD TO TK-REPOCD.
           MOVE QTK-PLCD TO TK-PLCD.
           MOVE QTK-PLTYPE TO TK-PLTYPE.

           IF ( QTK-LOANDATE = "1900-01-01" )
              MOVE ZEROES TO TK-LOANDATE
           ELSE
              MOVE QTK-LOANDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TK-LOANDATE.

           MOVE QTK-PROCEEDS TO TK-PROCEEDS.
           MOVE QTK-LNAMT TO TK-LNAMT.
           MOVE QTK-FINCHG TO TK-FINCHG.
           MOVE QTK-INTCHG TO TK-INTCHG.
           MOVE QTK-SERCHG TO TK-SERCHG.
           MOVE QTK-EXTCHG TO TK-EXTCHG.
           MOVE QTK-MAINTFEE TO TK-MAINTFEE.
           MOVE QTK-ORGTERM TO TK-ORGTERM.
           MOVE QTK-INSURED TO TK-INSURED.
           MOVE QTK-INSUNEARN-1 TO TK-INSUNEARN(1).
           MOVE QTK-INSUNEARN-2 TO TK-INSUNEARN(2).
           MOVE QTK-INSUNEARN-3 TO TK-INSUNEARN(3).
           MOVE QTK-INSUNEARN-4 TO TK-INSUNEARN(4).
           MOVE QTK-INSUNEARN-5 TO TK-INSUNEARN(5).
           MOVE QTK-INSUNEARN-6 TO TK-INSUNEARN(6).
           MOVE QTK-INSUNEARN-7 TO TK-INSUNEARN(7).
           MOVE QTK-INSUNEARN-8 TO TK-INSUNEARN(8).
           MOVE QTK-INSUNEARN-9 TO TK-INSUNEARN(9).
           MOVE QTK-INSUNEARN-10 TO TK-INSUNEARN(10).
           MOVE QTK-INSEARNED-1 TO TK-INSEARNED(1).
           MOVE QTK-INSEARNED-2 TO TK-INSEARNED(2).
           MOVE QTK-INSEARNED-3 TO TK-INSEARNED(3).
           MOVE QTK-INSEARNED-4 TO TK-INSEARNED(4).
           MOVE QTK-INSEARNED-5 TO TK-INSEARNED(5).
           MOVE QTK-INSEARNED-6 TO TK-INSEARNED(6).
           MOVE QTK-INSEARNED-7 TO TK-INSEARNED(7).
           MOVE QTK-INSEARNED-8 TO TK-INSEARNED(8).
           MOVE QTK-INSEARNED-9 TO TK-INSEARNED(9).
           MOVE QTK-INSEARNED-10 TO TK-INSEARNED(10).
           MOVE QTK-DLNO TO TK-DLNO.
           MOVE QTK-DLRV TO TK-DLRV.
           MOVE QTK-DLSPRV TO TK-DLSPRV.
           MOVE QTK-DLDISC TO TK-DLDISC.
           MOVE QTK-DLPARV TO TK-DLPARV.
           MOVE QTK-DLRECOURSE TO TK-DLRECOURSE.
           MOVE QTK-DLPARTRCAMT TO TK-DLPARTRCAMT.
           MOVE QTK-PURBAL TO TK-PURBAL.
           MOVE QTK-UNEARN-1 TO TK-UNEARN(1).
           MOVE QTK-UNEARN-2 TO TK-UNEARN(2).
           MOVE QTK-UNEARN-3 TO TK-UNEARN(3).
           MOVE QTK-UNEARN-4 TO TK-UNEARN(4).
           MOVE QTK-UNEARN-5 TO TK-UNEARN(5).
           MOVE QTK-UNEARN-6 TO TK-UNEARN(6).
           MOVE QTK-UNEARN-7 TO TK-UNEARN(7).
           MOVE QTK-UNEARN-8 TO TK-UNEARN(8).
           MOVE QTK-UNEARN-9 TO TK-UNEARN(9).
           MOVE QTK-UNEARN-10 TO TK-UNEARN(10).
           MOVE QTK-PRLNNO TO TK-PRLNNO.
           MOVE QTK-DLRVPRIN-1 TO TK-DLRVPRIN(1).
           MOVE QTK-DLRVPRIN-2 TO TK-DLRVPRIN(2).
           MOVE QTK-DLRVPRIN-3 TO TK-DLRVPRIN(3).
           MOVE QTK-DLRVCHGS-1 TO TK-DLRVCHGS(1).
           MOVE QTK-DLRVCHGS-2 TO TK-DLRVCHGS(2).
           MOVE QTK-DLRVCHGS-3 TO TK-DLRVCHGS(3).
           MOVE QTK-DLPARVPAID TO TK-DLPARVPAID.
           MOVE QTK-DLPARVHELD TO TK-DLPARVHELD.
           MOVE QTK-USERID TO TK-USERID.

           IF ( QTK-POSTDATE = "1900-01-01" )
              MOVE ZEROES TO TK-POSTDATE
           ELSE
              MOVE QTK-POSTDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TK-POSTDATE.

           MOVE QTK-POSTTIME TO TK-POSTTIME.
           MOVE QTK-EARNED-1 TO TK-EARNED(1).
           MOVE QTK-EARNED-2 TO TK-EARNED(2).
           MOVE QTK-EARNED-3 TO TK-EARNED(3).
           MOVE QTK-EARNED-4 TO TK-EARNED(4).
           MOVE QTK-EARNED-5 TO TK-EARNED(5).
           MOVE QTK-EARNED-6 TO TK-EARNED(6).
           MOVE QTK-EARNED-7 TO TK-EARNED(7).
           MOVE QTK-EARNED-8 TO TK-EARNED(8).
           MOVE QTK-EARNED-9 TO TK-EARNED(9).
           MOVE QTK-EARNED-10 TO TK-EARNED(10).
 
      *-----------------------------------------------------------------
      *    LOAD QTRK-REC FROM TRK-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-TRK-FIELDS.
           MOVE TK-BRNO TO QTK-BRNO.

           IF ( TK-DATE = ZEROES )
              MOVE "1900-01-01" TO QTK-DATE
           ELSE
              MOVE TK-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTK-DATE.

           MOVE TK-CLASS TO QTK-CLASS.
           MOVE TK-ACCTNO TO QTK-ACCTNO.
           MOVE TK-LAWCODE TO QTK-LAWCODE.
           MOVE TK-LINE TO QTK-LINE.

           IF ( TK-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QTK-LTOUCH-DATE
           ELSE
              MOVE TK-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTK-LTOUCH-DATE.

           MOVE TK-SSNO(1) TO QTK-SSNO-1.
           MOVE TK-MAKERCD(1) TO QTK-MAKERCD-1.
           MOVE TK-SSNO(2) TO QTK-SSNO-2.
           MOVE TK-MAKERCD(2) TO QTK-MAKERCD-2.
           MOVE TK-SSNO(3) TO QTK-SSNO-3.
           MOVE TK-MAKERCD(3) TO QTK-MAKERCD-3.
           MOVE TK-SSNO(4) TO QTK-SSNO-4.
           MOVE TK-MAKERCD(4) TO QTK-MAKERCD-4.
           MOVE TK-REF-FRTO TO QTK-REF-FRTO.
           MOVE TK-REFBR TO QTK-REFBR.
           MOVE TK-PURCD TO QTK-PURCD.
           MOVE TK-SRCD TO QTK-SRCD.
           MOVE TK-COLLCD TO QTK-COLLCD.
           MOVE TK-SERVACCT TO QTK-SERVACCT.
           MOVE TK-LOANTYPE TO QTK-LOANTYPE.
           MOVE TK-SUBCLASS TO QTK-SUBCLASS.
           MOVE TK-REPOCD TO QTK-REPOCD.
           MOVE TK-PLCD TO QTK-PLCD.
           MOVE TK-PLTYPE TO QTK-PLTYPE.

           IF ( TK-LOANDATE = ZEROES )
              MOVE "1900-01-01" TO QTK-LOANDATE
           ELSE
              MOVE TK-LOANDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTK-LOANDATE.

           MOVE TK-PROCEEDS TO QTK-PROCEEDS.
           MOVE TK-LNAMT TO QTK-LNAMT.
           MOVE TK-FINCHG TO QTK-FINCHG.
           MOVE TK-INTCHG TO QTK-INTCHG.
           MOVE TK-SERCHG TO QTK-SERCHG.
           MOVE TK-EXTCHG TO QTK-EXTCHG.
           MOVE TK-MAINTFEE TO QTK-MAINTFEE.
           MOVE TK-ORGTERM TO QTK-ORGTERM.
           MOVE TK-INSURED TO QTK-INSURED.
           MOVE TK-INSUNEARN(1) TO QTK-INSUNEARN-1.
           MOVE TK-INSUNEARN(2) TO QTK-INSUNEARN-2.
           MOVE TK-INSUNEARN(3) TO QTK-INSUNEARN-3.
           MOVE TK-INSUNEARN(4) TO QTK-INSUNEARN-4.
           MOVE TK-INSUNEARN(5) TO QTK-INSUNEARN-5.
           MOVE TK-INSUNEARN(6) TO QTK-INSUNEARN-6.
           MOVE TK-INSUNEARN(7) TO QTK-INSUNEARN-7.
           MOVE TK-INSUNEARN(8) TO QTK-INSUNEARN-8.
           MOVE TK-INSUNEARN(9) TO QTK-INSUNEARN-9.
           MOVE TK-INSUNEARN(10) TO QTK-INSUNEARN-10.
           MOVE TK-INSEARNED(1) TO QTK-INSEARNED-1.
           MOVE TK-INSEARNED(2) TO QTK-INSEARNED-2.
           MOVE TK-INSEARNED(3) TO QTK-INSEARNED-3.
           MOVE TK-INSEARNED(4) TO QTK-INSEARNED-4.
           MOVE TK-INSEARNED(5) TO QTK-INSEARNED-5.
           MOVE TK-INSEARNED(6) TO QTK-INSEARNED-6.
           MOVE TK-INSEARNED(7) TO QTK-INSEARNED-7.
           MOVE TK-INSEARNED(8) TO QTK-INSEARNED-8.
           MOVE TK-INSEARNED(9) TO QTK-INSEARNED-9.
           MOVE TK-INSEARNED(10) TO QTK-INSEARNED-10.
           MOVE TK-DLNO TO QTK-DLNO.
           MOVE TK-DLRV TO QTK-DLRV.
           MOVE TK-DLSPRV TO QTK-DLSPRV.
           MOVE TK-DLDISC TO QTK-DLDISC.
           MOVE TK-DLPARV TO QTK-DLPARV.
           MOVE TK-DLRECOURSE TO QTK-DLRECOURSE.
           MOVE TK-DLPARTRCAMT TO QTK-DLPARTRCAMT.
           MOVE TK-PURBAL TO QTK-PURBAL.
           MOVE TK-UNEARN(1) TO QTK-UNEARN-1.
           MOVE TK-UNEARN(2) TO QTK-UNEARN-2.
           MOVE TK-UNEARN(3) TO QTK-UNEARN-3.
           MOVE TK-UNEARN(4) TO QTK-UNEARN-4.
           MOVE TK-UNEARN(5) TO QTK-UNEARN-5.
           MOVE TK-UNEARN(6) TO QTK-UNEARN-6.
           MOVE TK-UNEARN(7) TO QTK-UNEARN-7.
           MOVE TK-UNEARN(8) TO QTK-UNEARN-8.
           MOVE TK-UNEARN(9) TO QTK-UNEARN-9.
           MOVE TK-UNEARN(10) TO QTK-UNEARN-10.
           MOVE TK-PRLNNO TO QTK-PRLNNO.
           MOVE TK-DLRVPRIN(1) TO QTK-DLRVPRIN-1.
           MOVE TK-DLRVPRIN(2) TO QTK-DLRVPRIN-2.
           MOVE TK-DLRVPRIN(3) TO QTK-DLRVPRIN-3.
           MOVE TK-DLRVCHGS(1) TO QTK-DLRVCHGS-1.
           MOVE TK-DLRVCHGS(2) TO QTK-DLRVCHGS-2.
           MOVE TK-DLRVCHGS(3) TO QTK-DLRVCHGS-3.
           MOVE TK-DLPARVPAID TO QTK-DLPARVPAID.
           MOVE TK-DLPARVHELD TO QTK-DLPARVHELD.
           MOVE TK-USERID TO QTK-USERID.

           IF ( TK-POSTDATE = ZEROES )
              MOVE "1900-01-01" TO QTK-POSTDATE
           ELSE
              MOVE TK-POSTDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTK-POSTDATE.

           MOVE TK-POSTTIME TO QTK-POSTTIME.
           MOVE TK-EARNED(1) TO QTK-EARNED-1.
           MOVE TK-EARNED(2) TO QTK-EARNED-2.
           MOVE TK-EARNED(3) TO QTK-EARNED-3.
           MOVE TK-EARNED(4) TO QTK-EARNED-4.
           MOVE TK-EARNED(5) TO QTK-EARNED-5.
           MOVE TK-EARNED(6) TO QTK-EARNED-6.
           MOVE TK-EARNED(7) TO QTK-EARNED-7.
           MOVE TK-EARNED(8) TO QTK-EARNED-8.
           MOVE TK-EARNED(9) TO QTK-EARNED-9.
           MOVE TK-EARNED(10) TO QTK-EARNED-10.
 
