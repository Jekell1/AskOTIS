      * COPYMEMBER: LIBLP/LPLSLGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN STATUS - MISCELLANEOUS
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      * BAH 20220923 ADDED LSM-MISPAY-90-DATE #1570
      * BAH 20240116 ADDED LSM-SECOND-BEN FIELDS #1637
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LSM-REC FROM QLSM-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LSM-FIELDS.
           MOVE QLSM-BRNO TO LSM-BRNO.
           MOVE QLSM-ACCTNO TO LSM-ACCTNO.
           MOVE QLSM-SEQNO TO LSM-SEQNO.

           IF ( QLSM-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LSM-LTOUCH-DATE
           ELSE
              MOVE QLSM-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSM-LTOUCH-DATE.

           MOVE QLSM-MISC-FIELD-1 TO LSM-MISC-FIELD(1).
           MOVE QLSM-MISC-FIELD-2 TO LSM-MISC-FIELD(2).
           MOVE QLSM-MISC-FIELD-3 TO LSM-MISC-FIELD(3).
           MOVE QLSM-MISC-FIELD-4 TO LSM-MISC-FIELD(4).
           MOVE QLSM-MISC-FIELD-5 TO LSM-MISC-FIELD(5).
           MOVE QLSM-MISC-FIELD-6 TO LSM-MISC-FIELD(6).
           MOVE QLSM-MISC-FIELD-7 TO LSM-MISC-FIELD(7).
           MOVE QLSM-MISC-FIELD-8 TO LSM-MISC-FIELD(8).
           MOVE QLSM-MISC-FIELD-9 TO LSM-MISC-FIELD(9).
           MOVE QLSM-MISC-FIELD-10 TO LSM-MISC-FIELD(10).
           MOVE QLSM-MISC-FIELD-11 TO LSM-MISC-FIELD(11).
           MOVE QLSM-MISC-FIELD-12 TO LSM-MISC-FIELD(12).
           MOVE QLSM-MISC-FIELD-13 TO LSM-MISC-FIELD(13).
           MOVE QLSM-MISC-FIELD-14 TO LSM-MISC-FIELD(14).
           MOVE QLSM-MISC-FIELD-15 TO LSM-MISC-FIELD(15).
           MOVE QLSM-MISC-FIELD-16 TO LSM-MISC-FIELD(16).
           MOVE QLSM-MISC-FIELD-17 TO LSM-MISC-FIELD(17).
           MOVE QLSM-MISC-FIELD-18 TO LSM-MISC-FIELD(18).
           MOVE QLSM-MISC-FIELD-19 TO LSM-MISC-FIELD(19).
           MOVE QLSM-MISC-FIELD-20 TO LSM-MISC-FIELD(20).
           MOVE QLSM-MISC-FIELD-21 TO LSM-MISC-FIELD(21).
           MOVE QLSM-MISC-FIELD-22 TO LSM-MISC-FIELD(22).
           MOVE QLSM-MISC-FIELD-23 TO LSM-MISC-FIELD(23).
           MOVE QLSM-MISC-FIELD-24 TO LSM-MISC-FIELD(24).
           MOVE QLSM-MISC-FIELD-25 TO LSM-MISC-FIELD(25).
           MOVE QLSM-MISC-FIELD-26 TO LSM-MISC-FIELD(26).
           MOVE QLSM-MISC-FIELD-27 TO LSM-MISC-FIELD(27).
           MOVE QLSM-MISC-FIELD-28 TO LSM-MISC-FIELD(28).
           MOVE QLSM-MISC-FIELD-29 TO LSM-MISC-FIELD(29).
           MOVE QLSM-MISC-FIELD-30 TO LSM-MISC-FIELD(30).
           MOVE QLSM-MISC-FIELD-31 TO LSM-MISC-FIELD(31).
           MOVE QLSM-MISC-FIELD-32 TO LSM-MISC-FIELD(32).

           MOVE QLSM-TRANS-FROM-BRNO   TO LSM-TRANS-FROM-BRNO.
           MOVE QLSM-TRANS-FROM-ACCTNO TO LSM-TRANS-FROM-ACCTNO.
           MOVE QLSM-TRANS-FROM-DATE   TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD      TO LSM-TRANS-FROM-DATE.
           MOVE QLSM-MISPAY-90-DATE    TO SQL-DATE-YYYY-MM-DD.
           PERFORM SQL-GET-DATE.
           MOVE SQL-DATE-YYYYMMDD      TO LSM-MISPAY-90-DATE.
           MOVE QLSM-SECOND-BEN-NAME     TO LSM-SECOND-BEN-NAME.
           MOVE QLSM-SECOND-BEN-ADR      TO LSM-SECOND-BEN-ADR.
           MOVE QLSM-SECOND-BEN-CITY     TO LSM-SECOND-BEN-CITY.
           MOVE QLSM-SECOND-BEN-STATE    TO LSM-SECOND-BEN-STATE.
           MOVE QLSM-SECOND-BEN-ZIP      TO LSM-SECOND-BEN-ZIP.
           MOVE QLSM-SECOND-BEN-PHONE    TO LSM-SECOND-BEN-PHONE.
           MOVE QLSM-SECOND-BEN-RELATION TO LSM-SECOND-BEN-RELATION.

 
      *-----------------------------------------------------------------
      *    LOAD QLSM-REC FROM LSM-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LSM-FIELDS.
           MOVE LSM-BRNO TO QLSM-BRNO.
           MOVE LSM-ACCTNO TO QLSM-ACCTNO.
           MOVE LSM-SEQNO TO QLSM-SEQNO.

           IF ( LSM-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLSM-LTOUCH-DATE
           ELSE
              MOVE LSM-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSM-LTOUCH-DATE.

           MOVE LSM-MISC-FIELD(1) TO QLSM-MISC-FIELD-1.
           MOVE LSM-MISC-FIELD(2) TO QLSM-MISC-FIELD-2.
           MOVE LSM-MISC-FIELD(3) TO QLSM-MISC-FIELD-3.
           MOVE LSM-MISC-FIELD(4) TO QLSM-MISC-FIELD-4.
           MOVE LSM-MISC-FIELD(5) TO QLSM-MISC-FIELD-5.
           MOVE LSM-MISC-FIELD(6) TO QLSM-MISC-FIELD-6.
           MOVE LSM-MISC-FIELD(7) TO QLSM-MISC-FIELD-7.
           MOVE LSM-MISC-FIELD(8) TO QLSM-MISC-FIELD-8.
           MOVE LSM-MISC-FIELD(9) TO QLSM-MISC-FIELD-9.
           MOVE LSM-MISC-FIELD(10) TO QLSM-MISC-FIELD-10.
           MOVE LSM-MISC-FIELD(11) TO QLSM-MISC-FIELD-11.
           MOVE LSM-MISC-FIELD(12) TO QLSM-MISC-FIELD-12.
           MOVE LSM-MISC-FIELD(13) TO QLSM-MISC-FIELD-13.
           MOVE LSM-MISC-FIELD(14) TO QLSM-MISC-FIELD-14.
           MOVE LSM-MISC-FIELD(15) TO QLSM-MISC-FIELD-15.
           MOVE LSM-MISC-FIELD(16) TO QLSM-MISC-FIELD-16.
           MOVE LSM-MISC-FIELD(17) TO QLSM-MISC-FIELD-17.
           MOVE LSM-MISC-FIELD(18) TO QLSM-MISC-FIELD-18.
           MOVE LSM-MISC-FIELD(19) TO QLSM-MISC-FIELD-19.
           MOVE LSM-MISC-FIELD(20) TO QLSM-MISC-FIELD-20.
           MOVE LSM-MISC-FIELD(21) TO QLSM-MISC-FIELD-21.
           MOVE LSM-MISC-FIELD(22) TO QLSM-MISC-FIELD-22.
           MOVE LSM-MISC-FIELD(23) TO QLSM-MISC-FIELD-23.
           MOVE LSM-MISC-FIELD(24) TO QLSM-MISC-FIELD-24.
           MOVE LSM-MISC-FIELD(25) TO QLSM-MISC-FIELD-25.
           MOVE LSM-MISC-FIELD(26) TO QLSM-MISC-FIELD-26.
           MOVE LSM-MISC-FIELD(27) TO QLSM-MISC-FIELD-27.
           MOVE LSM-MISC-FIELD(28) TO QLSM-MISC-FIELD-28.
           MOVE LSM-MISC-FIELD(29) TO QLSM-MISC-FIELD-29.
           MOVE LSM-MISC-FIELD(30) TO QLSM-MISC-FIELD-30.
           MOVE LSM-MISC-FIELD(31) TO QLSM-MISC-FIELD-31.
           MOVE LSM-MISC-FIELD(32) TO QLSM-MISC-FIELD-32.
 
           MOVE LSM-TRANS-FROM-BRNO   TO QLSM-TRANS-FROM-BRNO.
           MOVE LSM-TRANS-FROM-ACCTNO TO QLSM-TRANS-FROM-ACCTNO.
           MOVE LSM-TRANS-FROM-DATE   TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD   TO QLSM-TRANS-FROM-DATE.
           MOVE LSM-MISPAY-90-DATE   TO SQL-DATE-YYYYMMDD.
           PERFORM SQL-SET-DATE.
           MOVE SQL-DATE-YYYY-MM-DD   TO QLSM-MISPAY-90-DATE.
           MOVE LSM-SECOND-BEN-NAME     TO QLSM-SECOND-BEN-NAME.
           MOVE LSM-SECOND-BEN-ADR      TO QLSM-SECOND-BEN-ADR.
           MOVE LSM-SECOND-BEN-CITY     TO QLSM-SECOND-BEN-CITY.
           MOVE LSM-SECOND-BEN-STATE    TO QLSM-SECOND-BEN-STATE.
           MOVE LSM-SECOND-BEN-ZIP      TO QLSM-SECOND-BEN-ZIP.
           MOVE LSM-SECOND-BEN-PHONE    TO QLSM-SECOND-BEN-PHONE.
           MOVE LSM-SECOND-BEN-RELATION TO QLSM-SECOND-BEN-RELATION.
