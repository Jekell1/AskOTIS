      * COPYMEMBER: LIBLP/LPTRBGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - TRBFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD TRB-REC FROM QTRB-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-TRB-FIELDS.
           MOVE QTB-BRNO TO TB-BRNO.

           IF ( QTB-DATE = "1900-01-01" )
              MOVE ZEROES TO TB-DATE
           ELSE
              MOVE QTB-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TB-DATE.

           MOVE QTB-CLASS TO TB-CLASS.
           MOVE QTB-ACCTNO TO TB-ACCTNO.
           MOVE QTB-LAWCODE TO TB-LAWCODE.
           MOVE QTB-LINE TO TB-LINE.

           IF ( QTB-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO TB-LTOUCH-DATE
           ELSE
              MOVE QTB-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TB-LTOUCH-DATE.

           MOVE QTB-SSNO-1 TO TB-SSNO(1).
           MOVE QTB-MAKERCD-1 TO TB-MAKERCD(1).
           MOVE QTB-SSNO-2 TO TB-SSNO(2).
           MOVE QTB-MAKERCD-2 TO TB-MAKERCD(2).
           MOVE QTB-SSNO-3 TO TB-SSNO(3).
           MOVE QTB-MAKERCD-3 TO TB-MAKERCD(3).
           MOVE QTB-SSNO-4 TO TB-SSNO(4).
           MOVE QTB-MAKERCD-4 TO TB-MAKERCD(4).
           MOVE QTB-REF-FRTO TO TB-REF-FRTO.
           MOVE QTB-REFBR TO TB-REFBR.
           MOVE QTB-PURCD TO TB-PURCD.
           MOVE QTB-SRCD TO TB-SRCD.
           MOVE QTB-COLLCD TO TB-COLLCD.
           MOVE QTB-SERVACCT TO TB-SERVACCT.
           MOVE QTB-LOANTYPE TO TB-LOANTYPE.
           MOVE QTB-SUBCLASS TO TB-SUBCLASS.

           IF ( QTB-LOANDATE = "1900-01-01" )
              MOVE ZEROES TO TB-LOANDATE
           ELSE
              MOVE QTB-LOANDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TB-LOANDATE.

           MOVE QTB-PROCEEDS TO TB-PROCEEDS.
           MOVE QTB-LNAMT TO TB-LNAMT.
           MOVE QTB-FINCHG TO TB-FINCHG.
           MOVE QTB-INTCHG TO TB-INTCHG.
           MOVE QTB-SERCHG TO TB-SERCHG.
           MOVE QTB-EXTCHG TO TB-EXTCHG.
           MOVE QTB-MAINTFEE TO TB-MAINTFEE.
           MOVE QTB-ORGTERM TO TB-ORGTERM.
           MOVE QTB-INSURED TO TB-INSURED.
           MOVE QTB-INSUNEARN-1 TO TB-INSUNEARN(1).
           MOVE QTB-INSUNEARN-2 TO TB-INSUNEARN(2).
           MOVE QTB-INSUNEARN-3 TO TB-INSUNEARN(3).
           MOVE QTB-INSUNEARN-4 TO TB-INSUNEARN(4).
           MOVE QTB-INSUNEARN-5 TO TB-INSUNEARN(5).
           MOVE QTB-INSUNEARN-6 TO TB-INSUNEARN(6).
           MOVE QTB-INSUNEARN-7 TO TB-INSUNEARN(7).
           MOVE QTB-INSUNEARN-8 TO TB-INSUNEARN(8).
           MOVE QTB-INSUNEARN-9 TO TB-INSUNEARN(9).
           MOVE QTB-INSUNEARN-10 TO TB-INSUNEARN(10).
           MOVE QTB-DLNO TO TB-DLNO.
           MOVE QTB-DLRV TO TB-DLRV.
           MOVE QTB-DLSPRV TO TB-DLSPRV.
           MOVE QTB-DLDISC TO TB-DLDISC.
           MOVE QTB-DLPARV TO TB-DLPARV.
           MOVE QTB-DLRECOURSE TO TB-DLRECOURSE.
           MOVE QTB-DLPARTRCAMT TO TB-DLPARTRCAMT.
           MOVE QTB-PURBAL TO TB-PURBAL.
           MOVE QTB-UNEARN-1 TO TB-UNEARN(1).
           MOVE QTB-UNEARN-2 TO TB-UNEARN(2).
           MOVE QTB-UNEARN-3 TO TB-UNEARN(3).
           MOVE QTB-UNEARN-4 TO TB-UNEARN(4).
           MOVE QTB-UNEARN-5 TO TB-UNEARN(5).
           MOVE QTB-UNEARN-6 TO TB-UNEARN(6).
           MOVE QTB-UNEARN-7 TO TB-UNEARN(7).
           MOVE QTB-UNEARN-8 TO TB-UNEARN(8).
           MOVE QTB-UNEARN-9 TO TB-UNEARN(9).
           MOVE QTB-UNEARN-10 TO TB-UNEARN(10).
           MOVE QTB-REF-ACCTNO TO TB-REF-ACCTNO.
           MOVE QTB-DLRVPRIN-1 TO TB-DLRVPRIN(1).
           MOVE QTB-DLRVPRIN-2 TO TB-DLRVPRIN(2).
           MOVE QTB-DLRVPRIN-3 TO TB-DLRVPRIN(3).
           MOVE QTB-DLRVCHGS-1 TO TB-DLRVCHGS(1).
           MOVE QTB-DLRVCHGS-2 TO TB-DLRVCHGS(2).
           MOVE QTB-DLRVCHGS-3 TO TB-DLRVCHGS(3).
           MOVE QTB-DLPARVPAID TO TB-DLPARVPAID.
           MOVE QTB-DLPARVHELD TO TB-DLPARVHELD.
           MOVE QTB-USERID TO TB-USERID.

           IF ( QTB-POSTDATE = "1900-01-01" )
              MOVE ZEROES TO TB-POSTDATE
           ELSE
              MOVE QTB-POSTDATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO TB-POSTDATE.

           MOVE QTB-POSTTIME TO TB-POSTTIME.
           MOVE QTB-PLCD TO TB-PLCD.
           MOVE QTB-PLTYPE TO TB-PLTYPE.
           MOVE QTB-REPOCD TO TB-REPOCD.
           MOVE QTB-ACTIONCD2 TO TB-ACTIONCD2.
 
      *-----------------------------------------------------------------
      *    LOAD QTRB-REC FROM TRB-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-TRB-FIELDS.
           MOVE TB-BRNO TO QTB-BRNO.

           IF ( TB-DATE = ZEROES )
              MOVE "1900-01-01" TO QTB-DATE
           ELSE
              MOVE TB-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTB-DATE.

           MOVE TB-CLASS TO QTB-CLASS.
           MOVE TB-ACCTNO TO QTB-ACCTNO.
           MOVE TB-LAWCODE TO QTB-LAWCODE.
           MOVE TB-LINE TO QTB-LINE.

           IF ( TB-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QTB-LTOUCH-DATE
           ELSE
              MOVE TB-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTB-LTOUCH-DATE.

           MOVE TB-SSNO(1) TO QTB-SSNO-1.
           MOVE TB-MAKERCD(1) TO QTB-MAKERCD-1.
           MOVE TB-SSNO(2) TO QTB-SSNO-2.
           MOVE TB-MAKERCD(2) TO QTB-MAKERCD-2.
           MOVE TB-SSNO(3) TO QTB-SSNO-3.
           MOVE TB-MAKERCD(3) TO QTB-MAKERCD-3.
           MOVE TB-SSNO(4) TO QTB-SSNO-4.
           MOVE TB-MAKERCD(4) TO QTB-MAKERCD-4.
           MOVE TB-REF-FRTO TO QTB-REF-FRTO.
           MOVE TB-REFBR TO QTB-REFBR.
           MOVE TB-PURCD TO QTB-PURCD.
           MOVE TB-SRCD TO QTB-SRCD.
           MOVE TB-COLLCD TO QTB-COLLCD.
           MOVE TB-SERVACCT TO QTB-SERVACCT.
           MOVE TB-LOANTYPE TO QTB-LOANTYPE.
           MOVE TB-SUBCLASS TO QTB-SUBCLASS.

           IF ( TB-LOANDATE = ZEROES )
              MOVE "1900-01-01" TO QTB-LOANDATE
           ELSE
              MOVE TB-LOANDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTB-LOANDATE.

           MOVE TB-PROCEEDS TO QTB-PROCEEDS.
           MOVE TB-LNAMT TO QTB-LNAMT.
           MOVE TB-FINCHG TO QTB-FINCHG.
           MOVE TB-INTCHG TO QTB-INTCHG.
           MOVE TB-SERCHG TO QTB-SERCHG.
           MOVE TB-EXTCHG TO QTB-EXTCHG.
           MOVE TB-MAINTFEE TO QTB-MAINTFEE.
           MOVE TB-ORGTERM TO QTB-ORGTERM.
           MOVE TB-INSURED TO QTB-INSURED.
           MOVE TB-INSUNEARN(1) TO QTB-INSUNEARN-1.
           MOVE TB-INSUNEARN(2) TO QTB-INSUNEARN-2.
           MOVE TB-INSUNEARN(3) TO QTB-INSUNEARN-3.
           MOVE TB-INSUNEARN(4) TO QTB-INSUNEARN-4.
           MOVE TB-INSUNEARN(5) TO QTB-INSUNEARN-5.
           MOVE TB-INSUNEARN(6) TO QTB-INSUNEARN-6.
           MOVE TB-INSUNEARN(7) TO QTB-INSUNEARN-7.
           MOVE TB-INSUNEARN(8) TO QTB-INSUNEARN-8.
           MOVE TB-INSUNEARN(9) TO QTB-INSUNEARN-9.
           MOVE TB-INSUNEARN(10) TO QTB-INSUNEARN-10.
           MOVE TB-DLNO TO QTB-DLNO.
           MOVE TB-DLRV TO QTB-DLRV.
           MOVE TB-DLSPRV TO QTB-DLSPRV.
           MOVE TB-DLDISC TO QTB-DLDISC.
           MOVE TB-DLPARV TO QTB-DLPARV.
           MOVE TB-DLRECOURSE TO QTB-DLRECOURSE.
           MOVE TB-DLPARTRCAMT TO QTB-DLPARTRCAMT.
           MOVE TB-PURBAL TO QTB-PURBAL.
           MOVE TB-UNEARN(1) TO QTB-UNEARN-1.
           MOVE TB-UNEARN(2) TO QTB-UNEARN-2.
           MOVE TB-UNEARN(3) TO QTB-UNEARN-3.
           MOVE TB-UNEARN(4) TO QTB-UNEARN-4.
           MOVE TB-UNEARN(5) TO QTB-UNEARN-5.
           MOVE TB-UNEARN(6) TO QTB-UNEARN-6.
           MOVE TB-UNEARN(7) TO QTB-UNEARN-7.
           MOVE TB-UNEARN(8) TO QTB-UNEARN-8.
           MOVE TB-UNEARN(9) TO QTB-UNEARN-9.
           MOVE TB-UNEARN(10) TO QTB-UNEARN-10.
           MOVE TB-REF-ACCTNO TO QTB-REF-ACCTNO.
           MOVE TB-DLRVPRIN(1) TO QTB-DLRVPRIN-1.
           MOVE TB-DLRVPRIN(2) TO QTB-DLRVPRIN-2.
           MOVE TB-DLRVPRIN(3) TO QTB-DLRVPRIN-3.
           MOVE TB-DLRVCHGS(1) TO QTB-DLRVCHGS-1.
           MOVE TB-DLRVCHGS(2) TO QTB-DLRVCHGS-2.
           MOVE TB-DLRVCHGS(3) TO QTB-DLRVCHGS-3.
           MOVE TB-DLPARVPAID TO QTB-DLPARVPAID.
           MOVE TB-DLPARVHELD TO QTB-DLPARVHELD.
           MOVE TB-USERID TO QTB-USERID.

           IF ( TB-POSTDATE = ZEROES )
              MOVE "1900-01-01" TO QTB-POSTDATE
           ELSE
              MOVE TB-POSTDATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QTB-POSTDATE.

           MOVE TB-POSTTIME TO QTB-POSTTIME.
           MOVE TB-PLCD TO QTB-PLCD.
           MOVE TB-PLTYPE TO QTB-PLTYPE.
           MOVE TB-REPOCD TO QTB-REPOCD.
           MOVE TB-ACTIONCD2 TO QTB-ACTIONCD2.
 
