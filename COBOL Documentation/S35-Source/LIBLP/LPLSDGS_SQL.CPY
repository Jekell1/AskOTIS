      * COPYMEMBER: LIBLP/LPLSDGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - LOAN STATUS - DEFICIENCY LETTER
      *
      *=================================================================
      * REV:
      * AMM 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD LSD-REC FROM QLSD-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-LSD-FIELDS.
           MOVE QLSD-BRNO TO LSD-BRNO.
           MOVE QLSD-ACCTNO TO LSD-ACCTNO.
           MOVE QLSD-SEQNO TO LSD-SEQNO.

           IF ( QLSD-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO LSD-LTOUCH-DATE
           ELSE
              MOVE QLSD-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSD-LTOUCH-DATE.


           IF ( QLSD-STOLEN-DATE = "1900-01-01" )
              MOVE ZEROES TO LSD-STOLEN-DATE
           ELSE
              MOVE QLSD-STOLEN-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSD-STOLEN-DATE.

           MOVE QLSD-GAP-INS-PAID TO LSD-GAP-INS-PAID.
           MOVE QLSD-OTHER-EXPENSE TO LSD-OTHER-EXPENSE.
           MOVE QLSD-MISC-AMT-EXPENSE TO LSD-MISC-AMT-EXPENSE.
           MOVE QLSD-MISC-DESC-EXPENSE TO LSD-MISC-DESC-EXPENSE.
           MOVE QLSD-TOT-EXPENSE TO LSD-TOT-EXPENSE.
           MOVE QLSD-INT-REB TO LSD-INT-REB.
           MOVE QLSD-CPP-REB TO LSD-CPP-REB.
           MOVE QLSD-GAP-REB TO LSD-GAP-REB.
           MOVE QLSD-WARRANTY-REB TO LSD-WARRANTY-REB.
           MOVE QLSD-MISC-AMT-CREDIT TO LSD-MISC-AMT-CREDIT.
           MOVE QLSD-MISC-DESC-CREDIT TO LSD-MISC-DESC-CREDIT.
           MOVE QLSD-TOT-CREDITS TO LSD-TOT-CREDITS.
           MOVE QLSD-PAID-TO-OTHER TO LSD-PAID-TO-OTHER.
           MOVE QLSD-AMT-FROM-OWING TO LSD-AMT-FROM-OWING.
           MOVE QLSD-AMT-OF-SURPLUS TO LSD-AMT-OF-SURPLUS.
           MOVE QLSD-AMT-OF-DEFICIENCY TO LSD-AMT-OF-DEFICIENCY.
           MOVE QLSD-SEND-FMNO TO LSD-SEND-FMNO.
           MOVE QLSD-INSURANCE-PROCEEDS TO LSD-INSURANCE-PROCEEDS.

           IF ( QLSD-DATE-CHECK-RECV = "1900-01-01" )
              MOVE ZEROES TO LSD-DATE-CHECK-RECV
           ELSE
              MOVE QLSD-DATE-CHECK-RECV TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSD-DATE-CHECK-RECV.

           MOVE QLSD-INSURANCE-CHECK TO LSD-INSURANCE-CHECK.
           MOVE QLSD-WHO-ADJUSTED TO LSD-WHO-ADJUSTED.
           MOVE QLSD-INS-COMPANY TO LSD-INS-COMPANY.

           IF ( QLSD-DEF-LETTER-SENT-DATE = "1900-01-01" )
              MOVE ZEROES TO LSD-DEF-LETTER-SENT-DATE
           ELSE
              MOVE QLSD-DEF-LETTER-SENT-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSD-DEF-LETTER-SENT-DATE.


           IF ( QLSD-SALES-DATE = "1900-01-01" )
              MOVE ZEROES TO LSD-SALES-DATE
           ELSE
              MOVE QLSD-SALES-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO LSD-SALES-DATE.

           MOVE QLSD-AUCTION TO LSD-AUCTION.
           MOVE QLSD-AUCTN-TIME TO LSD-AUCTN-TIME.
           MOVE QLSD-AUCTN-ADR TO LSD-AUCTN-ADR.
           MOVE QLSD-AUCTN-CITY TO LSD-AUCTN-CITY.
           MOVE QLSD-AUCTN-STATE TO LSD-AUCTN-STATE.
           MOVE QLSD-AUCTN-ZIP TO LSD-AUCTN-ZIP.
           MOVE QLSD-AUCTN-PHONE TO LSD-AUCTN-PHONE.
           MOVE QLSD-REPO-CHARGE TO LSD-REPO-CHARGE.
           MOVE QLSD-STORAGE-CHARGE TO LSD-STORAGE-CHARGE.
           MOVE QLSD-REPAIR-CHARGE TO LSD-REPAIR-CHARGE.
           MOVE QLSD-OTHER-CHARGE TO LSD-OTHER-CHARGE.
           MOVE QLSD-STORAGE-RATE TO LSD-STORAGE-RATE.
           MOVE QLSD-EST-REBATE TO LSD-EST-REBATE.
           MOVE QLSD-MINIMUM-BID TO LSD-MINIMUM-BID.
           MOVE QLSD-MAY-REINSTATE TO LSD-MAY-REINSTATE.
           MOVE QLSD-MAY-NOT-REINSTATE TO LSD-MAY-NOT-REINSTATE.
           MOVE QLSD-IN-PAST-12MONTHS TO LSD-IN-PAST-12MONTHS.
           MOVE QLSD-2X-DURING-CONTRACT TO LSD-2X-DURING-CONTRACT.
           MOVE QLSD-OTHER TO LSD-OTHER.
           MOVE QLSD-OTHER-COMMENTS1 TO LSD-OTHER-COMMENTS1.
           MOVE QLSD-OTHER-COMMENTS2 TO LSD-OTHER-COMMENTS2.
           MOVE QLSD-CA-PYMTS-AS-AGREED TO LSD-CA-PYMTS-AS-AGREED.
           MOVE QLSD-CA-KEEP-INS TO LSD-CA-KEEP-INS.
           MOVE QLSD-CA-KEEP-LIEN-FREE TO LSD-CA-KEEP-LIEN-FREE.
           MOVE QLSD-CA-OTHER TO LSD-CA-OTHER.
           MOVE QLSD-CA-OTHER-DESC TO LSD-CA-OTHER-DESC.
           MOVE QLSD-CURE TO LSD-CURE.
 
      *-----------------------------------------------------------------
      *    LOAD QLSD-REC FROM LSD-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-LSD-FIELDS.
           MOVE LSD-BRNO TO QLSD-BRNO.
           MOVE LSD-ACCTNO TO QLSD-ACCTNO.
           MOVE LSD-SEQNO TO QLSD-SEQNO.

           IF ( LSD-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QLSD-LTOUCH-DATE
           ELSE
              MOVE LSD-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSD-LTOUCH-DATE.


           IF ( LSD-STOLEN-DATE = ZEROES )
              MOVE "1900-01-01" TO QLSD-STOLEN-DATE
           ELSE
              MOVE LSD-STOLEN-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSD-STOLEN-DATE.

           MOVE LSD-GAP-INS-PAID TO QLSD-GAP-INS-PAID.
           MOVE LSD-OTHER-EXPENSE TO QLSD-OTHER-EXPENSE.
           MOVE LSD-MISC-AMT-EXPENSE TO QLSD-MISC-AMT-EXPENSE.
           MOVE LSD-MISC-DESC-EXPENSE TO QLSD-MISC-DESC-EXPENSE.
           MOVE LSD-TOT-EXPENSE TO QLSD-TOT-EXPENSE.
           MOVE LSD-INT-REB TO QLSD-INT-REB.
           MOVE LSD-CPP-REB TO QLSD-CPP-REB.
           MOVE LSD-GAP-REB TO QLSD-GAP-REB.
           MOVE LSD-WARRANTY-REB TO QLSD-WARRANTY-REB.
           MOVE LSD-MISC-AMT-CREDIT TO QLSD-MISC-AMT-CREDIT.
           MOVE LSD-MISC-DESC-CREDIT TO QLSD-MISC-DESC-CREDIT.
           MOVE LSD-TOT-CREDITS TO QLSD-TOT-CREDITS.
           MOVE LSD-PAID-TO-OTHER TO QLSD-PAID-TO-OTHER.
           MOVE LSD-AMT-FROM-OWING TO QLSD-AMT-FROM-OWING.
           MOVE LSD-AMT-OF-SURPLUS TO QLSD-AMT-OF-SURPLUS.
           MOVE LSD-AMT-OF-DEFICIENCY TO QLSD-AMT-OF-DEFICIENCY.
           MOVE LSD-SEND-FMNO TO QLSD-SEND-FMNO.
           MOVE LSD-INSURANCE-PROCEEDS TO QLSD-INSURANCE-PROCEEDS.

           IF ( LSD-DATE-CHECK-RECV = ZEROES )
              MOVE "1900-01-01" TO QLSD-DATE-CHECK-RECV
           ELSE
              MOVE LSD-DATE-CHECK-RECV TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSD-DATE-CHECK-RECV.

           MOVE LSD-INSURANCE-CHECK TO QLSD-INSURANCE-CHECK.
           MOVE LSD-WHO-ADJUSTED TO QLSD-WHO-ADJUSTED.
           MOVE LSD-INS-COMPANY TO QLSD-INS-COMPANY.

           IF ( LSD-DEF-LETTER-SENT-DATE = ZEROES )
              MOVE "1900-01-01" TO QLSD-DEF-LETTER-SENT-DATE
           ELSE
              MOVE LSD-DEF-LETTER-SENT-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSD-DEF-LETTER-SENT-DATE.


           IF ( LSD-SALES-DATE = ZEROES )
              MOVE "1900-01-01" TO QLSD-SALES-DATE
           ELSE
              MOVE LSD-SALES-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QLSD-SALES-DATE.

           MOVE LSD-AUCTION TO QLSD-AUCTION.
           MOVE LSD-AUCTN-TIME TO QLSD-AUCTN-TIME.
           MOVE LSD-AUCTN-ADR TO QLSD-AUCTN-ADR.
           MOVE LSD-AUCTN-CITY TO QLSD-AUCTN-CITY.
           MOVE LSD-AUCTN-STATE TO QLSD-AUCTN-STATE.
           MOVE LSD-AUCTN-ZIP TO QLSD-AUCTN-ZIP.
           MOVE LSD-AUCTN-PHONE TO QLSD-AUCTN-PHONE.
           MOVE LSD-REPO-CHARGE TO QLSD-REPO-CHARGE.
           MOVE LSD-STORAGE-CHARGE TO QLSD-STORAGE-CHARGE.
           MOVE LSD-REPAIR-CHARGE TO QLSD-REPAIR-CHARGE.
           MOVE LSD-OTHER-CHARGE TO QLSD-OTHER-CHARGE.
           MOVE LSD-STORAGE-RATE TO QLSD-STORAGE-RATE.
           MOVE LSD-EST-REBATE TO QLSD-EST-REBATE.
           MOVE LSD-MINIMUM-BID TO QLSD-MINIMUM-BID.
           MOVE LSD-MAY-REINSTATE TO QLSD-MAY-REINSTATE.
           MOVE LSD-MAY-NOT-REINSTATE TO QLSD-MAY-NOT-REINSTATE.
           MOVE LSD-IN-PAST-12MONTHS TO QLSD-IN-PAST-12MONTHS.
           MOVE LSD-2X-DURING-CONTRACT TO QLSD-2X-DURING-CONTRACT.
           MOVE LSD-OTHER TO QLSD-OTHER.
           MOVE LSD-OTHER-COMMENTS1 TO QLSD-OTHER-COMMENTS1.
           MOVE LSD-OTHER-COMMENTS2 TO QLSD-OTHER-COMMENTS2.
           MOVE LSD-CA-PYMTS-AS-AGREED TO QLSD-CA-PYMTS-AS-AGREED.
           MOVE LSD-CA-KEEP-INS TO QLSD-CA-KEEP-INS.
           MOVE LSD-CA-KEEP-LIEN-FREE TO QLSD-CA-KEEP-LIEN-FREE.
           MOVE LSD-CA-OTHER TO QLSD-CA-OTHER.
           MOVE LSD-CA-OTHER-DESC TO QLSD-CA-OTHER-DESC.
           MOVE LSD-CURE TO QLSD-CURE.
 

