      * COPYMEMBER: LIBLP/LPRBGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - RBFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0510 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD RB-REC FROM QRB-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-RB-FIELDS.
           MOVE QRB-TBL-NO TO RB-TBL-NO.
           MOVE QRB-TERM TO RB-TERM.
           MOVE QRB-MON-DAY-CD TO RB-MON-DAY-CD.
           MOVE QRB-AMT-1 TO RB-AMT(1).
           MOVE QRB-RATE-1 TO RB-RATE(1).
           MOVE QRB-AMT-2 TO RB-AMT(2).
           MOVE QRB-RATE-2 TO RB-RATE(2).
           MOVE QRB-AMT-3 TO RB-AMT(3).
           MOVE QRB-RATE-3 TO RB-RATE(3).
           MOVE QRB-AMT-4 TO RB-AMT(4).
           MOVE QRB-RATE-4 TO RB-RATE(4).
           MOVE QRB-AMT-5 TO RB-AMT(5).
           MOVE QRB-RATE-5 TO RB-RATE(5).
           MOVE QRB-AMT-6 TO RB-AMT(6).
           MOVE QRB-RATE-6 TO RB-RATE(6).
           MOVE QRB-AMT-7 TO RB-AMT(7).
           MOVE QRB-RATE-7 TO RB-RATE(7).
           MOVE QRB-AMT-8 TO RB-AMT(8).
           MOVE QRB-RATE-8 TO RB-RATE(8).
           MOVE QRB-AMT-9 TO RB-AMT(9).
           MOVE QRB-RATE-9 TO RB-RATE(9).
           MOVE QRB-AMT-10 TO RB-AMT(10).
           MOVE QRB-RATE-10 TO RB-RATE(10).
           MOVE QRB-AMT-11 TO RB-AMT(11).
           MOVE QRB-RATE-11 TO RB-RATE(11).
           MOVE QRB-AMT-12 TO RB-AMT(12).
           MOVE QRB-RATE-12 TO RB-RATE(12).
           MOVE QRB-AMT-13 TO RB-AMT(13).
           MOVE QRB-RATE-13 TO RB-RATE(13).
           MOVE QRB-AMT-14 TO RB-AMT(14).
           MOVE QRB-RATE-14 TO RB-RATE(14).
           MOVE QRB-AMT-15 TO RB-AMT(15).
           MOVE QRB-RATE-15 TO RB-RATE(15).
           MOVE QRB-AMT-16 TO RB-AMT(16).
           MOVE QRB-RATE-16 TO RB-RATE(16).
           MOVE QRB-AMT-17 TO RB-AMT(17).
           MOVE QRB-RATE-17 TO RB-RATE(17).
           MOVE QRB-AMT-18 TO RB-AMT(18).
           MOVE QRB-RATE-18 TO RB-RATE(18).
           MOVE QRB-AMT-19 TO RB-AMT(19).
           MOVE QRB-RATE-19 TO RB-RATE(19).
           MOVE QRB-AMT-20 TO RB-AMT(20).
           MOVE QRB-RATE-20 TO RB-RATE(20).
           MOVE QRB-AMT-21 TO RB-AMT(21).
           MOVE QRB-RATE-21 TO RB-RATE(21).
           MOVE QRB-AMT-22 TO RB-AMT(22).
           MOVE QRB-RATE-22 TO RB-RATE(22).
           MOVE QRB-AMT-23 TO RB-AMT(23).
           MOVE QRB-RATE-23 TO RB-RATE(23).
           MOVE QRB-AMT-24 TO RB-AMT(24).
           MOVE QRB-RATE-24 TO RB-RATE(24).
           MOVE QRB-AMT-25 TO RB-AMT(25).
           MOVE QRB-RATE-25 TO RB-RATE(25).
           MOVE QRB-AMT-26 TO RB-AMT(26).
           MOVE QRB-RATE-26 TO RB-RATE(26).
           MOVE QRB-AMT-27 TO RB-AMT(27).
           MOVE QRB-RATE-27 TO RB-RATE(27).
           MOVE QRB-AMT-28 TO RB-AMT(28).
           MOVE QRB-RATE-28 TO RB-RATE(28).
           MOVE QRB-AMT-29 TO RB-AMT(29).
           MOVE QRB-RATE-29 TO RB-RATE(29).
           MOVE QRB-AMT-30 TO RB-AMT(30).
           MOVE QRB-RATE-30 TO RB-RATE(30).
           MOVE QRB-AMT-31 TO RB-AMT(31).
           MOVE QRB-RATE-31 TO RB-RATE(31).
           MOVE QRB-AMT-32 TO RB-AMT(32).
           MOVE QRB-RATE-32 TO RB-RATE(32).
           MOVE QRB-AMT-33 TO RB-AMT(33).
           MOVE QRB-RATE-33 TO RB-RATE(33).
           MOVE QRB-AMT-34 TO RB-AMT(34).
           MOVE QRB-RATE-34 TO RB-RATE(34).
           MOVE QRB-AMT-35 TO RB-AMT(35).
           MOVE QRB-RATE-35 TO RB-RATE(35).
           MOVE QRB-AMT-36 TO RB-AMT(36).
           MOVE QRB-RATE-36 TO RB-RATE(36).
           MOVE QRB-AMT-37 TO RB-AMT(37).
           MOVE QRB-RATE-37 TO RB-RATE(37).
           MOVE QRB-AMT-38 TO RB-AMT(38).
           MOVE QRB-RATE-38 TO RB-RATE(38).
           MOVE QRB-AMT-39 TO RB-AMT(39).
           MOVE QRB-RATE-39 TO RB-RATE(39).
           MOVE QRB-AMT-40 TO RB-AMT(40).
           MOVE QRB-RATE-40 TO RB-RATE(40).
           MOVE QRB-AMT-41 TO RB-AMT(41).
           MOVE QRB-RATE-41 TO RB-RATE(41).
           MOVE QRB-AMT-42 TO RB-AMT(42).
           MOVE QRB-RATE-42 TO RB-RATE(42).
           MOVE QRB-AMT-43 TO RB-AMT(43).
           MOVE QRB-RATE-43 TO RB-RATE(43).
           MOVE QRB-AMT-44 TO RB-AMT(44).
           MOVE QRB-RATE-44 TO RB-RATE(44).
           MOVE QRB-AMT-45 TO RB-AMT(45).
           MOVE QRB-RATE-45 TO RB-RATE(45).
           MOVE QRB-AMT-46 TO RB-AMT(46).
           MOVE QRB-RATE-46 TO RB-RATE(46).
           MOVE QRB-AMT-47 TO RB-AMT(47).
           MOVE QRB-RATE-47 TO RB-RATE(47).
           MOVE QRB-AMT-48 TO RB-AMT(48).
           MOVE QRB-RATE-48 TO RB-RATE(48).
           MOVE QRB-AMT-49 TO RB-AMT(49).
           MOVE QRB-RATE-49 TO RB-RATE(49).
           MOVE QRB-AMT-50 TO RB-AMT(50).
           MOVE QRB-RATE-50 TO RB-RATE(50).
           MOVE QRB-AMT-51 TO RB-AMT(51).
           MOVE QRB-RATE-51 TO RB-RATE(51).
           MOVE QRB-AMT-52 TO RB-AMT(52).
           MOVE QRB-RATE-52 TO RB-RATE(52).
           MOVE QRB-AMT-53 TO RB-AMT(53).
           MOVE QRB-RATE-53 TO RB-RATE(53).
           MOVE QRB-AMT-54 TO RB-AMT(54).
           MOVE QRB-RATE-54 TO RB-RATE(54).
           MOVE QRB-AMT-55 TO RB-AMT(55).
           MOVE QRB-RATE-55 TO RB-RATE(55).
           MOVE QRB-AMT-56 TO RB-AMT(56).
           MOVE QRB-RATE-56 TO RB-RATE(56).
           MOVE QRB-AMT-57 TO RB-AMT(57).
           MOVE QRB-RATE-57 TO RB-RATE(57).
           MOVE QRB-AMT-58 TO RB-AMT(58).
           MOVE QRB-RATE-58 TO RB-RATE(58).
           MOVE QRB-AMT-59 TO RB-AMT(59).
           MOVE QRB-RATE-59 TO RB-RATE(59).
           MOVE QRB-AMT-60 TO RB-AMT(60).
           MOVE QRB-RATE-60 TO RB-RATE(60).
           MOVE QRB-AMT-61 TO RB-AMT(61).
           MOVE QRB-RATE-61 TO RB-RATE(61).
           MOVE QRB-AMT-62 TO RB-AMT(62).
           MOVE QRB-RATE-62 TO RB-RATE(62).
           MOVE QRB-AMT-63 TO RB-AMT(63).
           MOVE QRB-RATE-63 TO RB-RATE(63).
           MOVE QRB-AMT-64 TO RB-AMT(64).
           MOVE QRB-RATE-64 TO RB-RATE(64).
           MOVE QRB-AMT-65 TO RB-AMT(65).
           MOVE QRB-RATE-65 TO RB-RATE(65).
           MOVE QRB-AMT-66 TO RB-AMT(66).
           MOVE QRB-RATE-66 TO RB-RATE(66).
           MOVE QRB-AMT-67 TO RB-AMT(67).
           MOVE QRB-RATE-67 TO RB-RATE(67).
           MOVE QRB-AMT-68 TO RB-AMT(68).
           MOVE QRB-RATE-68 TO RB-RATE(68).
           MOVE QRB-AMT-69 TO RB-AMT(69).
           MOVE QRB-RATE-69 TO RB-RATE(69).
           MOVE QRB-AMT-70 TO RB-AMT(70).
           MOVE QRB-RATE-70 TO RB-RATE(70).
           MOVE QRB-AMT-71 TO RB-AMT(71).
           MOVE QRB-RATE-71 TO RB-RATE(71).
           MOVE QRB-AMT-72 TO RB-AMT(72).
           MOVE QRB-RATE-72 TO RB-RATE(72).
           MOVE QRB-AMT-73 TO RB-AMT(73).
           MOVE QRB-RATE-73 TO RB-RATE(73).
           MOVE QRB-AMT-74 TO RB-AMT(74).
           MOVE QRB-RATE-74 TO RB-RATE(74).
           MOVE QRB-AMT-75 TO RB-AMT(75).
           MOVE QRB-RATE-75 TO RB-RATE(75).

           IF ( QRB-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO RB-LTOUCH-DATE
           ELSE
              MOVE QRB-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO RB-LTOUCH-DATE.

 
      *-----------------------------------------------------------------
      *    LOAD QRB-REC FROM RB-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-RB-FIELDS.
           MOVE RB-TBL-NO TO QRB-TBL-NO.
           MOVE RB-TERM TO QRB-TERM.
           MOVE RB-MON-DAY-CD TO QRB-MON-DAY-CD.
           MOVE RB-AMT(1) TO QRB-AMT-1.
           MOVE RB-RATE(1) TO QRB-RATE-1.
           MOVE RB-AMT(2) TO QRB-AMT-2.
           MOVE RB-RATE(2) TO QRB-RATE-2.
           MOVE RB-AMT(3) TO QRB-AMT-3.
           MOVE RB-RATE(3) TO QRB-RATE-3.
           MOVE RB-AMT(4) TO QRB-AMT-4.
           MOVE RB-RATE(4) TO QRB-RATE-4.
           MOVE RB-AMT(5) TO QRB-AMT-5.
           MOVE RB-RATE(5) TO QRB-RATE-5.
           MOVE RB-AMT(6) TO QRB-AMT-6.
           MOVE RB-RATE(6) TO QRB-RATE-6.
           MOVE RB-AMT(7) TO QRB-AMT-7.
           MOVE RB-RATE(7) TO QRB-RATE-7.
           MOVE RB-AMT(8) TO QRB-AMT-8.
           MOVE RB-RATE(8) TO QRB-RATE-8.
           MOVE RB-AMT(9) TO QRB-AMT-9.
           MOVE RB-RATE(9) TO QRB-RATE-9.
           MOVE RB-AMT(10) TO QRB-AMT-10.
           MOVE RB-RATE(10) TO QRB-RATE-10.
           MOVE RB-AMT(11) TO QRB-AMT-11.
           MOVE RB-RATE(11) TO QRB-RATE-11.
           MOVE RB-AMT(12) TO QRB-AMT-12.
           MOVE RB-RATE(12) TO QRB-RATE-12.
           MOVE RB-AMT(13) TO QRB-AMT-13.
           MOVE RB-RATE(13) TO QRB-RATE-13.
           MOVE RB-AMT(14) TO QRB-AMT-14.
           MOVE RB-RATE(14) TO QRB-RATE-14.
           MOVE RB-AMT(15) TO QRB-AMT-15.
           MOVE RB-RATE(15) TO QRB-RATE-15.
           MOVE RB-AMT(16) TO QRB-AMT-16.
           MOVE RB-RATE(16) TO QRB-RATE-16.
           MOVE RB-AMT(17) TO QRB-AMT-17.
           MOVE RB-RATE(17) TO QRB-RATE-17.
           MOVE RB-AMT(18) TO QRB-AMT-18.
           MOVE RB-RATE(18) TO QRB-RATE-18.
           MOVE RB-AMT(19) TO QRB-AMT-19.
           MOVE RB-RATE(19) TO QRB-RATE-19.
           MOVE RB-AMT(20) TO QRB-AMT-20.
           MOVE RB-RATE(20) TO QRB-RATE-20.
           MOVE RB-AMT(21) TO QRB-AMT-21.
           MOVE RB-RATE(21) TO QRB-RATE-21.
           MOVE RB-AMT(22) TO QRB-AMT-22.
           MOVE RB-RATE(22) TO QRB-RATE-22.
           MOVE RB-AMT(23) TO QRB-AMT-23.
           MOVE RB-RATE(23) TO QRB-RATE-23.
           MOVE RB-AMT(24) TO QRB-AMT-24.
           MOVE RB-RATE(24) TO QRB-RATE-24.
           MOVE RB-AMT(25) TO QRB-AMT-25.
           MOVE RB-RATE(25) TO QRB-RATE-25.
           MOVE RB-AMT(26) TO QRB-AMT-26.
           MOVE RB-RATE(26) TO QRB-RATE-26.
           MOVE RB-AMT(27) TO QRB-AMT-27.
           MOVE RB-RATE(27) TO QRB-RATE-27.
           MOVE RB-AMT(28) TO QRB-AMT-28.
           MOVE RB-RATE(28) TO QRB-RATE-28.
           MOVE RB-AMT(29) TO QRB-AMT-29.
           MOVE RB-RATE(29) TO QRB-RATE-29.
           MOVE RB-AMT(30) TO QRB-AMT-30.
           MOVE RB-RATE(30) TO QRB-RATE-30.
           MOVE RB-AMT(31) TO QRB-AMT-31.
           MOVE RB-RATE(31) TO QRB-RATE-31.
           MOVE RB-AMT(32) TO QRB-AMT-32.
           MOVE RB-RATE(32) TO QRB-RATE-32.
           MOVE RB-AMT(33) TO QRB-AMT-33.
           MOVE RB-RATE(33) TO QRB-RATE-33.
           MOVE RB-AMT(34) TO QRB-AMT-34.
           MOVE RB-RATE(34) TO QRB-RATE-34.
           MOVE RB-AMT(35) TO QRB-AMT-35.
           MOVE RB-RATE(35) TO QRB-RATE-35.
           MOVE RB-AMT(36) TO QRB-AMT-36.
           MOVE RB-RATE(36) TO QRB-RATE-36.
           MOVE RB-AMT(37) TO QRB-AMT-37.
           MOVE RB-RATE(37) TO QRB-RATE-37.
           MOVE RB-AMT(38) TO QRB-AMT-38.
           MOVE RB-RATE(38) TO QRB-RATE-38.
           MOVE RB-AMT(39) TO QRB-AMT-39.
           MOVE RB-RATE(39) TO QRB-RATE-39.
           MOVE RB-AMT(40) TO QRB-AMT-40.
           MOVE RB-RATE(40) TO QRB-RATE-40.
           MOVE RB-AMT(41) TO QRB-AMT-41.
           MOVE RB-RATE(41) TO QRB-RATE-41.
           MOVE RB-AMT(42) TO QRB-AMT-42.
           MOVE RB-RATE(42) TO QRB-RATE-42.
           MOVE RB-AMT(43) TO QRB-AMT-43.
           MOVE RB-RATE(43) TO QRB-RATE-43.
           MOVE RB-AMT(44) TO QRB-AMT-44.
           MOVE RB-RATE(44) TO QRB-RATE-44.
           MOVE RB-AMT(45) TO QRB-AMT-45.
           MOVE RB-RATE(45) TO QRB-RATE-45.
           MOVE RB-AMT(46) TO QRB-AMT-46.
           MOVE RB-RATE(46) TO QRB-RATE-46.
           MOVE RB-AMT(47) TO QRB-AMT-47.
           MOVE RB-RATE(47) TO QRB-RATE-47.
           MOVE RB-AMT(48) TO QRB-AMT-48.
           MOVE RB-RATE(48) TO QRB-RATE-48.
           MOVE RB-AMT(49) TO QRB-AMT-49.
           MOVE RB-RATE(49) TO QRB-RATE-49.
           MOVE RB-AMT(50) TO QRB-AMT-50.
           MOVE RB-RATE(50) TO QRB-RATE-50.
           MOVE RB-AMT(51) TO QRB-AMT-51.
           MOVE RB-RATE(51) TO QRB-RATE-51.
           MOVE RB-AMT(52) TO QRB-AMT-52.
           MOVE RB-RATE(52) TO QRB-RATE-52.
           MOVE RB-AMT(53) TO QRB-AMT-53.
           MOVE RB-RATE(53) TO QRB-RATE-53.
           MOVE RB-AMT(54) TO QRB-AMT-54.
           MOVE RB-RATE(54) TO QRB-RATE-54.
           MOVE RB-AMT(55) TO QRB-AMT-55.
           MOVE RB-RATE(55) TO QRB-RATE-55.
           MOVE RB-AMT(56) TO QRB-AMT-56.
           MOVE RB-RATE(56) TO QRB-RATE-56.
           MOVE RB-AMT(57) TO QRB-AMT-57.
           MOVE RB-RATE(57) TO QRB-RATE-57.
           MOVE RB-AMT(58) TO QRB-AMT-58.
           MOVE RB-RATE(58) TO QRB-RATE-58.
           MOVE RB-AMT(59) TO QRB-AMT-59.
           MOVE RB-RATE(59) TO QRB-RATE-59.
           MOVE RB-AMT(60) TO QRB-AMT-60.
           MOVE RB-RATE(60) TO QRB-RATE-60.
           MOVE RB-AMT(61) TO QRB-AMT-61.
           MOVE RB-RATE(61) TO QRB-RATE-61.
           MOVE RB-AMT(62) TO QRB-AMT-62.
           MOVE RB-RATE(62) TO QRB-RATE-62.
           MOVE RB-AMT(63) TO QRB-AMT-63.
           MOVE RB-RATE(63) TO QRB-RATE-63.
           MOVE RB-AMT(64) TO QRB-AMT-64.
           MOVE RB-RATE(64) TO QRB-RATE-64.
           MOVE RB-AMT(65) TO QRB-AMT-65.
           MOVE RB-RATE(65) TO QRB-RATE-65.
           MOVE RB-AMT(66) TO QRB-AMT-66.
           MOVE RB-RATE(66) TO QRB-RATE-66.
           MOVE RB-AMT(67) TO QRB-AMT-67.
           MOVE RB-RATE(67) TO QRB-RATE-67.
           MOVE RB-AMT(68) TO QRB-AMT-68.
           MOVE RB-RATE(68) TO QRB-RATE-68.
           MOVE RB-AMT(69) TO QRB-AMT-69.
           MOVE RB-RATE(69) TO QRB-RATE-69.
           MOVE RB-AMT(70) TO QRB-AMT-70.
           MOVE RB-RATE(70) TO QRB-RATE-70.
           MOVE RB-AMT(71) TO QRB-AMT-71.
           MOVE RB-RATE(71) TO QRB-RATE-71.
           MOVE RB-AMT(72) TO QRB-AMT-72.
           MOVE RB-RATE(72) TO QRB-RATE-72.
           MOVE RB-AMT(73) TO QRB-AMT-73.
           MOVE RB-RATE(73) TO QRB-RATE-73.
           MOVE RB-AMT(74) TO QRB-AMT-74.
           MOVE RB-RATE(74) TO QRB-RATE-74.
           MOVE RB-AMT(75) TO QRB-AMT-75.
           MOVE RB-RATE(75) TO QRB-RATE-75.

           IF ( RB-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QRB-LTOUCH-DATE
           ELSE
              MOVE RB-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QRB-LTOUCH-DATE.

 
