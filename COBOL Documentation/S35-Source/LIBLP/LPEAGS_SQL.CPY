      * COPYMEMBER: LIBLP/LPEAGS_SQL
      ******************************************************************
      *
      * DESCRIPTION: SQL GET & SET - EAFILE
      *
      *=================================================================
      * REV:
      * BAH 2021-0507 ***NEW***
      *
      ******************************************************************
      *-----------------------------------------------------------------
      *    LOAD EA-REC FROM QEA-REC; FOR READ & READ-NEXT
      *-----------------------------------------------------------------
       GET-EA-FIELDS.
           MOVE QEA-BRANCH TO EA-BRANCH.
           MOVE QEA-CLASS TO EA-CLASS.
           MOVE QEA-GROUP-ID TO EA-GROUP-ID.
           MOVE QEA-SEQNO TO EA-SEQNO.

           IF ( QEA-LTOUCH-DATE = "1900-01-01" )
              MOVE ZEROES TO EA-LTOUCH-DATE
           ELSE
              MOVE QEA-LTOUCH-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO EA-LTOUCH-DATE.

           MOVE QEA-DESC TO EA-DESC.
           MOVE QEA-PASTDUE-DAY1 TO EA-PASTDUE-DAY1.
           MOVE QEA-PASTDUE-DAY2 TO EA-PASTDUE-DAY2.
           MOVE QEA-PASTDUE-AMT1 TO EA-PASTDUE-AMT1.
           MOVE QEA-PASTDUE-AMT2 TO EA-PASTDUE-AMT2.
           MOVE QEA-ACCT-BAL1 TO EA-ACCT-BAL1.
           MOVE QEA-ACCT-BAL2 TO EA-ACCT-BAL2.
           MOVE QEA-MATURED TO EA-MATURED.
           MOVE QEA-PROMISED TO EA-PROMISED.
           MOVE QEA-ACTION TO EA-ACTION.

           IF ( QEA-LSTFM-DATE1 = "1900-01-01" )
              MOVE ZEROES TO EA-LSTFM-DATE1
           ELSE
              MOVE QEA-LSTFM-DATE1 TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO EA-LSTFM-DATE1.


           IF ( QEA-LSTFM-DATE2 = "1900-01-01" )
              MOVE ZEROES TO EA-LSTFM-DATE2
           ELSE
              MOVE QEA-LSTFM-DATE2 TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO EA-LSTFM-DATE2.

           MOVE QEA-LSTFM-NO1 TO EA-LSTFM-NO1.
           MOVE QEA-LSTFM-NO2 TO EA-LSTFM-NO2.
           MOVE QEA-PASTPROM-DAY1 TO EA-PASTPROM-DAY1.
           MOVE QEA-PASTPROM-DAY2 TO EA-PASTPROM-DAY2.
           MOVE QEA-RECENCY-DAY1 TO EA-RECENCY-DAY1.
           MOVE QEA-RECENCY-DAY2 TO EA-RECENCY-DAY2.
           MOVE QEA-ALPNAME1 TO EA-ALPNAME1.
           MOVE QEA-ALPNAME2 TO EA-ALPNAME2.
           MOVE QEA-RECENCYDATE TO EA-RECENCYDATE.
           MOVE QEA-DLNO1 TO EA-DLNO1.
           MOVE QEA-DLNO2 TO EA-DLNO2.
           MOVE QEA-CONTRACTUAL-DAY1 TO EA-CONTRACTUAL-DAY1.
           MOVE QEA-CONTRACTUAL-DAY2 TO EA-CONTRACTUAL-DAY2.
           MOVE QEA-SETFM-NO TO EA-SETFM-NO.
           MOVE QEA-SETACT-CD TO EA-SETACT-CD.
           MOVE QEA-INC-CNT TO EA-INC-CNT.
           MOVE QEA-INC-PROMISED TO EA-INC-PROMISED.
           MOVE QEA-SETFM-1 TO EA-SETFM(1).
           MOVE QEA-SETFM-2 TO EA-SETFM(2).
           MOVE QEA-SETFM-3 TO EA-SETFM(3).
           MOVE QEA-SET-LN-COL TO EA-SET-LN-COL.
           MOVE QEA-LN-COL-ID TO EA-LN-COL-ID.
           MOVE QEA-CQ-FG TO EA-CQ-FG.
           MOVE QEA-COL-POOL TO EA-COL-POOL.
           MOVE QEA-CPOTS TO EA-CPOTS.
           MOVE QEA-REPO TO EA-REPO.
           MOVE QEA-PL TO EA-PL.
           MOVE QEA-BANKRUPT TO EA-BANKRUPT.
           MOVE QEA-PL-IN-ACTIVE-BOTH TO EA-PL-IN-ACTIVE-BOTH.
           MOVE QEA-CONFIDENTIAL-FG TO EA-CONFIDENTIAL-FG.
           MOVE QEA-1ST-PMT-MISSES TO EA-1ST-PMT-MISSES.
           MOVE QEA-LEGAL TO EA-LEGAL.
           MOVE QEA-DEBTAID TO EA-DEBTAID.
           MOVE QEA-JUDGEMENT TO EA-JUDGEMENT.
           MOVE QEA-BROKEN-PROM-FG TO EA-BROKEN-PROM-FG.
           MOVE QEA-PROM-BREAK1 TO EA-PROM-BREAK1.
           MOVE QEA-PROM-BREAK2 TO EA-PROM-BREAK2.
           MOVE QEA-ORIGIN TO EA-ORIGIN.

           IF ( QEA-PL-BEG-DATE = "1900-01-01" )
              MOVE ZEROES TO EA-PL-BEG-DATE
           ELSE
              MOVE QEA-PL-BEG-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO EA-PL-BEG-DATE.


           IF ( QEA-PL-END-DATE = "1900-01-01" )
              MOVE ZEROES TO EA-PL-END-DATE
           ELSE
              MOVE QEA-PL-END-DATE TO SQL-DATE-YYYY-MM-DD
              PERFORM SQL-GET-DATE
              MOVE SQL-DATE-YYYYMMDD TO EA-PL-END-DATE.

           MOVE QEA-RPOTS TO EA-RPOTS.
           MOVE QEA-MISPAYS TO EA-MISPAYS.
           MOVE QEA-ALLOTMENTS TO EA-ALLOTMENTS.
           MOVE QEA-LNDATE-DAYS1 TO EA-LNDATE-DAYS1.
           MOVE QEA-LNDATE-DAYS2 TO EA-LNDATE-DAYS2.
           MOVE QEA-MATURE-DAYS1 TO EA-MATURE-DAYS1.
           MOVE QEA-MATURE-DAYS2 TO EA-MATURE-DAYS2.
           MOVE QEA-DAY-OF-MO-DUE1 TO EA-DAY-OF-MO-DUE1.
           MOVE QEA-DAY-OF-MO-DUE2 TO EA-DAY-OF-MO-DUE2.
           MOVE QEA-INCL-COLLECTOR TO EA-INCL-COLLECTOR.
           MOVE QEA-BORR-STATE TO EA-BORR-STATE.
 
      *-----------------------------------------------------------------
      *    LOAD QEA-REC FROM EA-REC; FOR WRITE & REWRITE
      *-----------------------------------------------------------------
       SET-EA-FIELDS.
           MOVE EA-BRANCH TO QEA-BRANCH.
           MOVE EA-CLASS TO QEA-CLASS.
           MOVE EA-GROUP-ID TO QEA-GROUP-ID.
           MOVE EA-SEQNO TO QEA-SEQNO.

           IF ( EA-LTOUCH-DATE = ZEROES )
              MOVE "1900-01-01" TO QEA-LTOUCH-DATE
           ELSE
              MOVE EA-LTOUCH-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QEA-LTOUCH-DATE.

           MOVE EA-DESC TO QEA-DESC.
           MOVE EA-PASTDUE-DAY1 TO QEA-PASTDUE-DAY1.
           MOVE EA-PASTDUE-DAY2 TO QEA-PASTDUE-DAY2.
           MOVE EA-PASTDUE-AMT1 TO QEA-PASTDUE-AMT1.
           MOVE EA-PASTDUE-AMT2 TO QEA-PASTDUE-AMT2.
           MOVE EA-ACCT-BAL1 TO QEA-ACCT-BAL1.
           MOVE EA-ACCT-BAL2 TO QEA-ACCT-BAL2.
           MOVE EA-MATURED TO QEA-MATURED.
           MOVE EA-PROMISED TO QEA-PROMISED.
           MOVE EA-ACTION TO QEA-ACTION.

           IF ( EA-LSTFM-DATE1 = ZEROES )
              MOVE "1900-01-01" TO QEA-LSTFM-DATE1
           ELSE
              MOVE EA-LSTFM-DATE1 TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QEA-LSTFM-DATE1.


           IF ( EA-LSTFM-DATE2 = ZEROES )
              MOVE "1900-01-01" TO QEA-LSTFM-DATE2
           ELSE
              MOVE EA-LSTFM-DATE2 TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QEA-LSTFM-DATE2.

           MOVE EA-LSTFM-NO1 TO QEA-LSTFM-NO1.
           MOVE EA-LSTFM-NO2 TO QEA-LSTFM-NO2.
           MOVE EA-PASTPROM-DAY1 TO QEA-PASTPROM-DAY1.
           MOVE EA-PASTPROM-DAY2 TO QEA-PASTPROM-DAY2.
           MOVE EA-RECENCY-DAY1 TO QEA-RECENCY-DAY1.
           MOVE EA-RECENCY-DAY2 TO QEA-RECENCY-DAY2.
           MOVE EA-ALPNAME1 TO QEA-ALPNAME1.
           MOVE EA-ALPNAME2 TO QEA-ALPNAME2.
           MOVE EA-RECENCYDATE TO QEA-RECENCYDATE.
           MOVE EA-DLNO1 TO QEA-DLNO1.
           MOVE EA-DLNO2 TO QEA-DLNO2.
           MOVE EA-CONTRACTUAL-DAY1 TO QEA-CONTRACTUAL-DAY1.
           MOVE EA-CONTRACTUAL-DAY2 TO QEA-CONTRACTUAL-DAY2.
           MOVE EA-SETFM-NO TO QEA-SETFM-NO.
           MOVE EA-SETACT-CD TO QEA-SETACT-CD.
           MOVE EA-INC-CNT TO QEA-INC-CNT.
           MOVE EA-INC-PROMISED TO QEA-INC-PROMISED.
           MOVE EA-SETFM(1) TO QEA-SETFM-1.
           MOVE EA-SETFM(2) TO QEA-SETFM-2.
           MOVE EA-SETFM(3) TO QEA-SETFM-3.
           MOVE EA-SET-LN-COL TO QEA-SET-LN-COL.
           MOVE EA-LN-COL-ID TO QEA-LN-COL-ID.
           MOVE EA-CQ-FG TO QEA-CQ-FG.
           MOVE EA-COL-POOL TO QEA-COL-POOL.
           MOVE EA-CPOTS TO QEA-CPOTS.
           MOVE EA-REPO TO QEA-REPO.
           MOVE EA-PL TO QEA-PL.
           MOVE EA-BANKRUPT TO QEA-BANKRUPT.
           MOVE EA-PL-IN-ACTIVE-BOTH TO QEA-PL-IN-ACTIVE-BOTH.
           MOVE EA-CONFIDENTIAL-FG TO QEA-CONFIDENTIAL-FG.
           MOVE EA-1ST-PMT-MISSES TO QEA-1ST-PMT-MISSES.
           MOVE EA-LEGAL TO QEA-LEGAL.
           MOVE EA-DEBTAID TO QEA-DEBTAID.
           MOVE EA-JUDGEMENT TO QEA-JUDGEMENT.
           MOVE EA-BROKEN-PROM-FG TO QEA-BROKEN-PROM-FG.
           MOVE EA-PROM-BREAK1 TO QEA-PROM-BREAK1.
           MOVE EA-PROM-BREAK2 TO QEA-PROM-BREAK2.
           MOVE EA-ORIGIN TO QEA-ORIGIN.

           IF ( EA-PL-BEG-DATE = ZEROES )
              MOVE "1900-01-01" TO QEA-PL-BEG-DATE
           ELSE
              MOVE EA-PL-BEG-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QEA-PL-BEG-DATE.


           IF ( EA-PL-END-DATE = ZEROES )
              MOVE "1900-01-01" TO QEA-PL-END-DATE
           ELSE
              MOVE EA-PL-END-DATE TO SQL-DATE-YYYYMMDD
              PERFORM SQL-SET-DATE
              MOVE SQL-DATE-YYYY-MM-DD TO QEA-PL-END-DATE.

           MOVE EA-RPOTS TO QEA-RPOTS.
           MOVE EA-MISPAYS TO QEA-MISPAYS.
           MOVE EA-ALLOTMENTS TO QEA-ALLOTMENTS.
           MOVE EA-LNDATE-DAYS1 TO QEA-LNDATE-DAYS1.
           MOVE EA-LNDATE-DAYS2 TO QEA-LNDATE-DAYS2.
           MOVE EA-MATURE-DAYS1 TO QEA-MATURE-DAYS1.
           MOVE EA-MATURE-DAYS2 TO QEA-MATURE-DAYS2.
           MOVE EA-DAY-OF-MO-DUE1 TO QEA-DAY-OF-MO-DUE1.
           MOVE EA-DAY-OF-MO-DUE2 TO QEA-DAY-OF-MO-DUE2.
           MOVE EA-INCL-COLLECTOR TO QEA-INCL-COLLECTOR.
           MOVE EA-BORR-STATE TO QEA-BORR-STATE.
 
