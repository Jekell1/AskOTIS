       IDENTIFICATION DIVISION.
       PROGRAM-ID.      ZONPC0.
       DATE-WRITTEN.    100997.
      *************************************************************************
      *                 (LP)
      *  DESCRIPTION:   BALLOON DIRECT INPUT (NON SALES FINANCE)
      * REV:
      *  JTG 062195 EXPANDED FOR 10 INSURANCES
      *  MJD 081195 ADDED LOGIC FOR GP-THE-ONLY-SF-SRCD.
      *  JTG 093095 ADDED LOGIC FOR GP-DEFAULT-O3-INS-COMPANY
      *  JTG 011796 CHANGED SO O2 & O3 INS. DON'T COMPUTE DEFAULT EXPIRATION
      *             DATE UNLESS INITIAL INPUT
      *  MJD 040896 ADDED TEST OF LC-AFP-CLASS AND DL-AFP-DEALER.
      *  MJD 041996 ADDED GP-DLR-DISP-TYPE.
      *  BAH 062896 ADDED INSEXP(5) AND INSEXP(6) TO MAKE-DATES-CURRENT
      *             SO WHEN YOU RECALL A QUOTE, IT UPDATES THOSE DATES.PL#96
      *  JTG 111296 CHANGED LN-INSTBL (LEVEL'S 9 & 10) TO FILLER
      *  BLV 112296 CHANGED COMPUTE-INSCOMM TO 8 TIMES, NOT 10
      *  JTG 042197 ADDED 'LPZ3CL' ROUTINE TO CLEAR CIP/COP/CEP WORKERS
      *  JTG 042497 CHANGED TO DISPLAY UNIT PERIOD INFO IN ALL CASES
      *             EX. PD-INTDATE CHANGE, PD-1STPYDATE CHANGE,
      *                 PD-ORGTERM CHANGE, PD-UNITPER-CD CHANGE
      *  JTG 053097 CORRECTED BAD EDIT ON SPR'S (RE: AL P $100) EDIT WAS
      *             BEING TESTED BEFORE INPUT OF SELLING PRICE
      *  MJD 060397 ADDED TO SCSCAN-TRANS-DATE.
      *  JTG 070197 CHANGED LOAN CLASS SCAN & QUOTE RECALL TO ALLOW
      *             SERVICE ACCOUNTS
      *  JTG 071797 CORRECTED BAD EDIT ON SPR'S (RE: AH P) EDIT WAS
      *             BEING TESTED BEFORE INPUT OF DOWN PAYMENT #P137
      *  BLV 072497 DON'T ALLOW PRINCIPAL 1 IF GP-DLRVPRIN-1-FG NOT "Y"
      *  JTG 081497 ADDED SET OF PD-GIFTNET WORLD A90
      *  JTG 082197 CHANGED TO USE 'LPZ3CL' TO CLEAR-CALC-AREA-Z3
      *  JTG 090497 CHANGED COPY 'LIBWI/FEEET1W' TO 'LIBWI/FEEENTW'
      *                          'LIBWI/FEEENT1' TO 'LIBWI/FEEENT'
      *                          'LIBWI/FEEENTPD1' TO 'LIBWI/FEEENTPD'
      *  GLF 090997 REPLACED 'IO' ON GP-FILE WITH GET 'GPENV'
      *  JTG 111097 ALLOWED CHANGE TO 13. 1STPYDATE, IF NON CAN
      *  JTG 120597 CHANGED TO ALLOW F5 PAYOFF FROM PRIOR LOAN NO INPUT
      *  JTG 120597 CHANGED TO COPY LPAPRSPD (NEW) AND NOT LPAPRSJG
      *  JTG 121197 CORRECTED F6 SCAN FROM FEEENT WINDOW, RE: CODE-SCAN SECTION
      *  JTG 121597 ADDED TEST FOR CIP-NO-OF-TIMES-CALLED < 800, TO ALLOW RESET
      *             OF CEP FIELDS, WDT # 148, CASTLE #163 RE: RATE OVERRIDE
      *  JTG 020498 SET CIP-CAN-LOAN-NO, RE: LOGIC TO FORCE ONE CALENDAR MONTH
      *             SEE CALCZ3.C
      *  BLV 020598 CHANGED CANNED LOAN OPTION FROM F5 TO F2
      *  KEC 031298 PREVENTED USE OF 'F5-CREATE BORROWER' ON ELE = 1
      *              WITH A LOAN APPLICATION.
      *   CS 031398 ADDED TEST OF LC-APP-REQ-FOR-LOAN IF BR-APP-REQUIRED-
      *             FOR INPUT = Y
      *  KEC 031698 REVISED THE LOAN APPROVAL CHECKS/WINDOW SO TO
      *              INCORPORATE 'GR-LN-APPROVAL-LIMIT'.
      *  JTG 032498 CHANGED TO LET SINGLE PAYS WORK WITH 'B'-BALLOON
      *  BAH 040698 GP-DEFAULT-O3-INS-COMPANY 0 WAS NOT ALLOWING ANY INS CO.
      *  JTG 040698 CORRECTED BUG RE: NOT RECALCULATING AFTER DETERMINING
      *             RESTRICTION FOR GA,SC
      *   CS 041798 MOVE BW-ORIGIN TO PD-ORIGIN TO UPDATE LN-ORIGIN
      *  JTG 042298 PUT EDIT ON FEE CODES WHEN CAN LOAN IS SELECTED, WORLD
      *   CS 042898 ADDED NEW RENEWAL CODES "RB" AND "RO"
      *  JTG 061798 CHANGED TEST ON SRCD AGAINST PRIOR LOAN PD-PO-TRCD
      *             AND PUT BACK STOP SO 'SC' IS ONLY VALID SF RENEWAL
      *  KEC 072098 ADDED CHECK FOR NEW FLAG ON 'SPR' CAN-LOAN FLAG
      *              ( SP-CAN-LOANS-FG ).  FOR WORLD          PR#: 00187
      *  JTG 081898 REMOVED SETUP OF DEFAULT SOURCE CODE AS 'NB', MERCURY C.S.
      *  JTG 081898 ALLOWED 'PB' ON BANKRUPT ACCOUNTS IF GP-I-AM-WORLD <JGW
      *             ALSO ALLOWED RECALL OF LOANS WITH PRIOR-LOAN-NOT-VALID <JGV
      *  KEC 090498 ADDED 'MOVE LC-LOANTYPE TO PD-LOANTYPE';
      *              FOR REGENCY REVOLVING.
      *  JTG 092598 CHANGED CALL FROM LONPZ3 TO CALCZ3
      *  JTG 101398 ADDED SET OF LCSCAN-REVOLVING = 'N' AND STOPPED ENTRY
      *             OF REVOLVING CLASSES, REGENCY REVOL
      *  JTG 101298 SET PDSCAN-REVOLVING = 'N', REGENCY REVOL
      *  JTG 110598 CORRECTED DISPLAY-APP-BW-LISTWAS MISSING '.' END OF LIST
      *             ALLOWED RECALL WITH ERROR-IN-PRIOR-LOAN WILL BE CAUGHT IN
      *             ATTEMPT TO UPDATE
      *  KEC 111898 BECAUSE IT IS CLEARING OUT PD-POCD SET IN THE
      *             'RESCISSION-ROUTINE'.  IT APPEARED THAT THE RE-READ OF THE
      *             'PD' RECORD IF THE PD-PRLNNO NOT = ZEROES WAS NOT
      *             ACCOMPLISHING ANYTHING!!!
      * JTG 122198 REPLACED SP-SCFRMLA = 1 OR 8 OR 28 TESTS
      *            WITH 88 SP-SCFRMLA-POINTS
      * JTG 990113 ADDED SP-EDT-TYPE 'P' POINTS,                    REGENCY #012
      * JTG 990210 ADDED THE SET OF CIP-RETURN-CODE TO 'A', SO IF A SAVED
      *            LOAN OR QUOTE IS RECALLED AND IT DOES NOT REQUIRE A
      *            RECALCULATION IT CAN BE SAVED OR UPDATED
      * GLF 990312 ADDED WI/TFCCDS FOR TFC ENTRY OF LPO,REP CODE,PROCESS CODE
      * JTG 990402 ADDED TO RECOMPUTE PRIOR LOAN PAYOFF WHEN CHANGE IN
      *            COLLATERAL CAUSES CHANGE IN RESCISSION/NONRESCISSION STATUS
      * KEC 1999.0407 ADDED 'IF ( PD-PRLNNO = ZEROES ) GO TO D12-EXIT'
      *                TO 'D12-PROCESS-PRIOR-LN' SECTION FOR A PROBLEM
      *                LORI FOUND ON REGENCY.  PROBLEM WAS IT WAS SAYING
      *                'PRIOR LOAN INVALID' BUT IT WAS NOT RENEWAL LOAN
      *                AND THERE IS NO PRIOR LOAN.
      * KEC 1999.0413 ADDED CHECK OF 'SPR' FOR SELECTING A CAN LOAN.
      * JTG 990413 ADDED CHECK OF 'SPR' FOR SELECTING A NON CAN LOAN.
      * JTG 990525 FIXED BUG IN UPDATE SECTION, WAS ALTERING PD-PROCEEDS WITH
      *            RENEWAL MONIES WHICH WAS READJUSTED IN LONPC2.C, MULTIPLE
      *            ADJUSTEMENTS OCCURED WHEN LNVERI.C FOUND AN ERROR FORCING
      *            OPERATOR TO DO ANOTHER 'U' UPDATE
      * MJD 990618 ADDED OPTION TO EFFECTIVE DATE A LOAN TO SYSTEM DATE IF
      *            SYSTEM DATE NOT = TRANS-DATE.
      * BAH 990716 ADDED NEW PASSWORD OPTION 6 (INSCO-SEQ) TO CHANGE DEFAULT
      *            INSURANCE COMPANY ON CL,AH,PP,O1, REGENCY PR# 56
      * GLF 990803 ADDED GP-VALID-BDATE. IF "Y" AND THERE IS NOT A VALID
      *            BIRTH DATE FOR SSNO BEING ENTERED, DO NOT ALLOW ENTRY
      *            OF THE SSNO, REGENCY #57
      * MJD 990806 ADDED GP-INCL-OTH-IN-EARNED FLAG. IF "Y" THEN INCLUDE
      *            EARNINGS BUCKET 6 (OTHER) IN ACCUMULATED TOTALS
      *            OTHERWISE EXCLUDE BUCKET 6.
      * MJD 991005 ADDED LN-PRIOR-RN-FOR10-DATE AND LN-LAST-RN-FOR10-DATE.
      *            (REGMGM PR#942)
      * JTG 991020 ALLOWED FAILURE OF PERFORM TEST-SP-EFF-EXP, SINCE ERROR
      *            WILL NOW BE CAUGHT IN ATTEMPT TO UPDATE
      * MJD 991109 FORCE INPUT OR EXP DATE ON O3 BY DAFAULTING TO 00/00/00
      *            INSTEAD OF MATURITY DATE
      *            IF A SAVERD LOAN IS RECALLED, DO NOT RESET EXP DATE
      *            ON O3 INS (REGACC PR #985)
      * JTG 991203 ADDED SP-ALLOW-LN-BACK-DATE, REGMGM# 1029
      *            ALLOW EFFECTIVE DATE OF LOAN TO BE PRIOR TO TRANS-DATE
      *            WHEN SPR FLAG IS SET:
      * JTG 991208 CORRECTED COMPOUND IF SP-ALLOW-LN-BACK-DATE, REGMGM# 1029
      *            NOTE:
      *                  ......NEVER USE AN END-IF TO END AN IF CONTAINING A
      *                        NEXT SENTENCE
      *            EX:
      *               IF J > K
      *                 IF X < Y
      *                    IF A > B
      *                       NEXT SENTENCE
      *                    ELSE
      *                       MOVE C TO B   THIS ENDS IF A > B
      *                                          DO TO NEXT SENTENCE IN IF <---
      *                    END-IF           THIS ENDS IF X < Y
      *                                          DO TO LAST IF ENDING WITH ELSE
      *                 END-IF              AND THIS END-IF ENDS IF J > K
      *                 MOVE 3 TO P
      *                 ETC.
      * KEC 2000.1221 {PR#00000} ADDED CHECK TO NOT ALLOW OUTSIDE VENDOR
      *             LOAN APPLICATION TO BE USE IN THE F5-KEY SCAN.
      * JTG 000113 ADDED SP-INSREJECT-FG OPTION 'C', WHICH WILL CAUSE WRITING
      *            NO. OF MONTHS INSURANCE NOT IN VIOLATION, WISCONSIN #1032
      *
      * KEC 2000.0128 {PR#00000} ADDED NEW ROUTINE FOR VERIFYING THE
      *                LOAN APPLICATION BEFORE UPDATING THE LOAN;
      *                LIBLP/VERIFYAPP(W)
      * MJD 000207 ADDED GP-OT-INS-TERM (TFC PR#48) IF 'Y' THEN ALLOW
      *            ALLOW TERM ENTRY FOR O2O3O4O5 INSURANCE.
      * MJD 000224 ADDED PASSWORD CHECK FOR REGMGM. IF THEY ENTER
      *            A PD-OVRDRATE-FG NOT = TO "A" THEN CALL VERIFY-PASSWORD.
      *            (REGMGM PR# 1006)
      * MJD 000228 ADDED GP-ADV-TO-1ST-NO-CORR = "A" . IF DATE OF THE LOAN
      *            IS ON THE 26 THRU 31 THEN ADVANCE THE FIRST PAYMENT
      *            DUE DATE TO THE FIRST OF THE SECOND MONTH FOLLOWING THE
      *            DATE OF THE LOAN. (REGMGM PR#1099)
      * BLV 000313 ADD ENTRY OF WCBC-CREDITLIM IF LC-CALC-HI-CREDIT = W,
      *            WORLD PR# 225
      * JTG 000315  CORRECTED BUG WITH SRCD EX. FB AND PRIOR ACCOUNT NO. ENTRY
      *             WISC #71249 J006
      * BAH 000503 ADDED PERFORM LOAN-CALCULATIONS AT THE TOP OF
      *            B90-DISPLAY-FIELDS, LNAPPROVAL USES LPDAMTS FIELDS AND
      *            WAS CAUSING JUNK IN THE APPROVAL WINDOW FINANCED AMOUNT.
      * MJD 000518 ADDED SCFRMLA 39 - IN THIS PROGRAM IT FOLLOES THE SAME
      *            LOGIC AS 33 (SUPPORT PR#1181)
      * KEC 000530 {PR#00048} TFC [JUDY BRANIFF];
      *            ADDED THE FOLLOWING 'IF' CONDITION FOR ENTERING THE
      *            INSURANCE TERM (GP-OT-INS-TERM = "Y"):
      *                  IF ( VDUNUM0 > 360 )
      *                     GO TO ENTER-IC-TERM.
      * MJD 000605 CHANGED PROCEED-VALIDATION LOGIC TO WORK LIKE XONPC0.
      *            SKIP THE TEST ON PROCEEDS AMOUNT LOW. (AS PER JOHN)
      * MJD 000616 CHANGED OVER-SEQ TO TEST PASSWORD ON CL,AH,PP,01,MAINT FEE,
      *            1ST PY EXT, EXT LC INFO. THIS WILL MAKE IT CONSISTENT WITH
      *            XONPC0.
      * KEC 000629 {PR#01225} WORLD ACCEPTANCE [JOHN]
      *             ADDED LOGIC FOR TENNESSEE RATE TYPE 'M' FLAT MONTHLY
      *             CHARGE.
      * BAH 000726 1STPYDATE WAS LOCKED OUT OF CHANGING IN SET-NON-APPLICATION
      *            IF YOU HAD AN APP, THIS WAS A TOTAL OVERSIGHT...WAS NOT IN
      *            XONPC0, SO I REMOVED IT..PL# 293
      * MJD 000914 ADDED LOGIC TO ASK LOCK BOX QUESTION  (MFC PR#227)
      * BAH 010518 ADDED SCFRMLA 42 (SUNBELT) LIKE 18 BUT 360 YEAR, PR# 1484
      * BAH 010607 ADDED SP-SCFRMLA = 43 FOR FCF "NC", PR# 1506
      * JTG 011001 DON'T ALLOW A FIRST PAY DAY OF 31 WHEN SEMI MONTHLY PAPER
      *            ADDED 9 1STPYDATE < 30 DAYS FROM LOAN DATE     FFG PR#333
      * JTG 020104 ADDED RENEWAL VERIFY OF PAYOFF AMOUNT          WORLD PR#286
      * JTG 020111 ADDED LOGIC FOR TESTING CALCZ3.C BY SETTING ENV
      *            VARIABLE "CALL_TESTZ3" WHICH MAKES THE CALL TO
      *            "LP/TESTZ3" INSTEAD OF "LP/CALCZ3"
      * JTG 010831 TESTED COP-RETURN-CODE = 'V' FOR DISPLAY OF ERROR IN CALC
      *                                                        LENDMARK PR#J021
      * JTG 020220 ADDED "CT" COUNTY TAX CODE KENTUCKY AND PERCENTS
      *            ADDED "CY" CITY   TAX CODE KENTUCKY AND PERCENTS  WORLD #288
      * BAH 020418 ADDED NCSCHG-SCFRMLA TO PASS SP-SCFRMLA FOR 45, HCRED #1776
      *
      * KEC 020624 {PR#01823} REGIONAL ACCEPTANCE <A15> [KEVIN MULLEN]
      *            ADDED LOGIC FOR USING 'CD-GC-FEE-MAXAMT'
      * JTG 020624 CHANGED TO VALIDATE 'KY' WHEN BORROWER IS ENTERED WORLD #288
      * BAH 020729 WHEN JTG DID THE 011001 CHANGE AND ADDED SEQ 9, THAT DIDNT
      *            MATCH XONPC0, CHANGED IT TO SEQ 1 SO IT MATCHES, BECAUSE
      *            VERIFY-PASSWORD USES XONPC0 AS THE BASE PROGRAM.....
      * KEC 020806 {DR#00009} PARADATA <A15> [KEN]
      *            ADDED PD-RESCISSION AND PD-RESCISSION-DATE.
      * BAH 020807 ADDED SP-MFFRMLA 4 FOR "TN" MAINTFEE RESTRICTIONS, REGWAN
      *            PR# 1867
      * BLV 020820 IF GP-ENTER-LPO-FG = "Y", OPEN TFC WINDOW FOR ENTRY OF
      *            LPO, SOAUTO PR# 1885
      * KEC 020925 {PR#00000} CITIZENS S&L <A15> [JUDY]
      *            ADDED A PD-POCD-INRESCISSION TO:
      *              IF NOT ( QUOTE-ONLY OR PD-POCD-INRESCISSION )
      *            THIS IS TO SKIP DOING 'VERIFY-LOAN-RN-PAYOFF'.
      * CS  021003 DONT ALLOW A FIRST PAY DAY OF 14,15, OR 31 IF SEMI-MONTHLY
      *            PER JTG. CAUSED LATE CHARGE PROBLEMS AT FFG
      * JTG 021125 CLEARED TO BW-1-INFO FIELDS                      WORLD #288
      *            MUST CLEAR/RESET THESE FIELDS WHICH ARE PASSED TO THE CALCZL
      *            TO DETERMINE KY SALES TAX. PROBLEM WITH CAN LOAN'S QUOTES
      *            WHICH INITIALLY DON'T HAVE BORROWERS.
      *  BLV 021211 CHECK OF PD-FEECODE FOR INSURANCE SALES TAX WAS CHECKING
      *             T5 TWICE & MISSING T4, WORLD PR# 288
      *  JTG 030116 CHANGED TO RECOMPUTE LOAN INS. TAXES AT LOAN UPDATE
      *             CHANGED TO VALIDATE CITY-COUNTY WHEN BW-SSNO(1) ENTERED
      *                                                          [WORLD PR#288]
      *  JTG 030218 MOVED 'PERFORM VERIFY-LOAN-RN-PAYOFF' TEST SO NO OTHER
      *             OPERATOR INPUT WILL OCCUR BEFORE DOING UPDATE OF LOAN
      *                                                             WORLD PR#286
      *  JTG 030311 ADDED GP-FORCE-INPUT-PP-COVERAGE                WORLD #319
      *  JTG 030324 REMOVED F7 EXIT AT "ENTER EXHIBIT A COVERAGE:"  WORLD #319
      *             AND ALLOWED COVERAGE IN EXCESS OF COMPUTED
      *  JTG 030506 CREATED FORMULA 12 LIKE 2 BUT SPREADS EXTENSION CHARGE
      *             OVER PAYMENTS  88  SP-PYEXFRMLA-SAME2-SPREAD VALUE 12.
      *                                                           CITIZENS #2006
      *  BAH 030619 ADDED CIP-PRIOR-SUB-CLASS FOR SCFRMLA 46, LENDMARK PR# 2101
      *             AND PASS-PRIOR-SUB-CLASS (PAYOFX)
      *  JTG 030910 CHANGED FOR REGENCY TO PASSWORD PROTEST RENEWALS OF LOAN
      *             CLASS 16 & 17 INTO ANY CLASS BUT CLASS 17
      *             ADDED PASSX-CURRENT-PD-CLASS TO HOLD PD-CLASS OF
      *             LOAN BEING MADE                                REGENCY #2135
      *  JTG 030929 MODIFIED SCFRMLA 13 TO ONLY TAKE THE DUAL LOAN
      *             ADJUSTMENT INTO ACCOUNT WHEN THE LOANS'S CLASSES
      *             ARE THE SAME                               LENDMARK#2149
      * JTG 031001 CREATED 01  SCHG-WORKERS-2 FOR PASS FOR SCFRMLA 13
      *                                                       LENDMARK #2149
      * JTG 031015 CHANGED FOR REGENCY TO PASSWORD PROTEST RENEWALS OF LOAN
      *            CLASS 16 & 17 INTO ANY CLASS BUT CLASS (17 , 50-79)
      *            ADDED PASSX-CURRENT-PD-CLASS TO HOLD PD-CLASS OF
      *            LOAN BEING MADE  (2135)                        REGENCY #2172
      *  BAH 031023 ADDED GP-DEFAULT-O3-INSOURS, LENDMARK PR# 2180
      *  JTG 040213 ALLOWED NON MONTHLY CAN LOANS (NMQUOT.C) WORLD J043
      *  BAH 040304 ADDED SP-DEFAULT-O2-INS-COMP FOR LENDMARK PR# 2258
      *  BAH 040430 CLASS RENEWAL PASSWORDS BECAUSE OF TICO CONVERSION,
      *             SHARING THE RENEWAL-SEQ PASSWORD OPTION, REGWAN PR# 2286
      *  JTG 041206 PASSWORD PROTECTED FIELDS 27, 28, 29, 30
      *             CL, AH, PP, O1 FIELDS IN XONPC0, ZONPC0, LNQUOT AND BLQUOT
      *                                                              WORLD #J051
      *  JTG 041209 N O T E:  N O  PASSWORD TEST ON ABOVE
      *                       IF CHANGING 'PP' AND PD-ORGST = "GA"
      *                              AND GP-FORCE-INPUT-PP-COVERAGE = 'Y'
      *                                                              WORLD #J051
      *  BAH 050222 WHEN ENTERRING SUB CLASS, YOU DONT KNOW THE LOANDATE YET TO
      *             CHECK IF SPR IS EXPIRED, SO IT WAS JUST GRABBING THE FIRST
      *             LAWCODE FOUND TO DISPLAY THE DESCRIPTION, WHICH ISNT
      *             CORRECT IF THEY EXPIRE AND BUILD A NEW ONE WITH A DIFFERENT
      *             DESCRIPTION, VERY CONFUSING...AT LEAST SKIP EXPIRED SPR.
      *             RIVERSIDE PL# 467
      *  CS  050330 ADDED CHECK ON SP-INSURANCE-WRITTEN, IF THIS FLAG IS SET TO
      *             "N", ACCESS IS DENIED TO ALL INSURANCES INCLUDING O2 & O3.
      *             COULD NOT USE 'NNN' AS BASIS FOR FREEING UP FEE CODES AS
      *             WORLD HAS THE BR-FORCE.. SET TO 'Y', USES 'NNN' BUT WRITES
      *             O2 & O3.  ALSO THIS STOPS OPERATOR(LENDMARK) FROM ACCIDENTLY      *             WRITING INSURANCE (CALCULATING A SALES TAX) THEY SHOULDN'T.
      *             IT ALSO WORKS IN CONJUCTION WITH BR-FORCE-VALID-CITY-COUNTY
      *             IN DETERMINING IF FEE CODES 16 -18 ARE FREE OR LOCKED.
      *             IF BR-FORCE-VALID-CITY-COUNTY IS "Y" & SP-INSURANCE-WRITTEN
      *             IS "N" ALL 10 FEE CODES ARE FREE.  IF BR-FORCE... 'Y' &
      *             SP-INSURANCE-WRITTEN "Y", FEE CODES 16 -18 ARE LOCKED
      *                                                  LENDMARK PR#2479
      *             BR-FOCE-VALID-CITY-COUNTY = BR-FORCE
      *             SP-INSURANCE-WRITTEN      = INSURANCE
      *             NO INSURANCE MEANS 'N' TO CL/AH/PP/O1,O2,O3
      *
      *    BR-FORCE | INSURANCE |
      *      'Y'    |    'Y'    | FEES 16 -18 LOCKED
      *      'Y'    |    'N'    | ALL FEES UNLOCKED, NO INSURANCE ENTRY ALLOWED
      *      'N'    |    'N'    | ALL FEES UNLOCKED, NO INSURANCE ENTRY ALLOWED
      *      'N'    |" " OR "Y" | ALL FEES UNLOCKED
      *  CS 050407  FIXED DISPLAY OF FEES ON F3 RECALL LOAN.  WAS DISPLAYING
      *             BLANKS... ALTHOUGH THEY WERE INCLUDED IN CALCULATIONS.
      *             PERFORM SETUP-FEES-FOR-DISPLAY WAS INCLUDED IN A 'IF' &
      *             SHOULD BE OUTSIDE OF THE IF CONDITION
      *  CS 050426  ZERO OUT ALL FIELDS IF INSURANCE PREMIUM IS ZERO... PREVIOUS
      *             WE COMPUTED A COMMISSION EVEN IF THE PREMIUM WAS ZERO WHEN
      *             USING A FLAT COMMISSION AMOUNT [PR#479 NSA]
      *  BAH 050513 IF GP-I-AM-WDT, ONLY CLASS 7 CAN RENEW INTO CLASS 7 AND
      *             CLASS 7 CAN NOT RENEW INTO ANYTHING ELSE, PR# 2528 FINMGM
      *  BAH 050520 SCFRMLA 29, ENTER AS "NB" FIRST TIME THRU, GO UP AND
      *             CHANGE TO "PB", WAS NOT PERFORMING D17 TO GET RESTRICTION
      *               REGMGM, PL# 494
      *
      * KEC 050524 {PR#02516} PREMIER ADVISORY <A15> [JUDY]
      *            ADDED PRIOR TO 'PERFORM VERIFY-LOAN-APPROVAL':
      *
      *    IF ( MA-EXISTS-YES )
      *       MOVE LNAPPROVAL---CREATION-APP  TO LNAPPROVAL-CREATION
      *    ELSE
      *       MOVE LNAPPROVAL---CREATION-LONP TO LNAPPROVAL-CREATION.
      *
      * JTG 050819 CHANGED SAVE LOAN, ETC TO USE PD-ANTICERN(4) FOR DISPLAY
      *            OF MAINTENANCE FEES INSTEAD OF THE STORED TRUNCTATED
      *            PD-MAINTFEE * PD-ORGTERM WHICH DOSEN'T EQUAL THE COMPUTED
      *            'VAT' VALUE ADDED TAX IN PD-ANTICERN(4)           WORLD #0408
      * BAH 051128 UNDO CHANGE FROM 050222 PL# 467, WOULD NOT LET YOU BOOK A
      *            LOAN WITH AN EXPIRED SPR, AND YOU SHOULD BE ABLE TO.
      *            INSTEAD OF SKIPPING EXPIRED SPR IN READ-NEXT, JUST REDISPLAY
      *            THE SUBCLASS DESCRIPTION AFTER ENTERING THE LOANDATE.
      *  CS 060504 UNCOMMENTED 'GET PRIOR COLLATERAL' WHICH CARRIES OVER THE
      *            COLLATERAL ON A RENEWAL NOT SURE WHY IT WAS TAKEN OUT!
      *                                                     PR#2782 KRUSE
      *  JTG 060504 CHANGED LOGIC FOR SINGLE PAYS LOANS > 11 MONTHS
      *             TO YIELD REMAINING DAYS FROM UPER-INTDATE PLUS
      *             FULL UNIT PERIODS TO UPER-1STPYDATE
      *             ADDED NEW LOAN CALCULATION FOR RICHARD        LENDMARK #2709
      *
      *             STOPPED OPTION TO CALCULATE BALLOONS ON SINGLE PAYS
      *                                                           LENDMARK #2709
      *  BAH 060629 WAS MISSING JOINT INSURED EDITS ON BORROWER, REGENCY #535
      *  BLF & CS 060707 FIX TO LOAD SSNO'S 2-4 TO NCSCHG WORKERS BEFORE
      *             CALLING NCSC23 SO COMAKERS ARE CHECKED FOR RESTRICTION
      *             PR#545
      *  KEC 060721 PR#00127 REGIONAL ACCEPT. ADDED LOGIC FOR "AUTOPC".
      *  BAH 061113 ADDED GP-VALIDATE-ENDORSER-AGE FOR VERIFY-TERMCEIL
      *             TO ONLY TEST "E" ENDORSERS IF THIS NEW FLAG IS SET
      *             COLTN PL# 558
      *  MJD 061221 ADDED TEST OF PRIOR LOANS SCFRMLA IF 48. REGENCY PR#2880
      *  BAH 070103 IF BORROWER WAS NOT FOUND, THE CURSER WOULD STILL MOVE TO
      *             THE NEXT FIELD, THESE 2 FLAGS WERE NOT BEING SET;
      *             MOVE "Y" TO BW-ERROR-YN MOVE "N" TO BW-EXISTS-YN IN THE
      *             GET-BORR-NAME MISC PARAGRAPH. BARNETT PL# 565
      * BAH 070227 ADDED VERIFY-MAKER-SUB TO KNOW WHEN YOU ARE TESTING COMAKER
      *            JOINT INSURANCE IN LPSPED VERIFY-TERMCEIL SUPPORT PL#580
      *
      * JTG 070326 WORLD SPR'S ARE FLAGGED WITH GP-ADV-TO-1ST-NO-CORR = "Y"
      *            WHICH WILL ADVANCE TO THE NEXT MONTH IF THE DEFAULT
      *            PAYMENT DUE DATE FALLS ON A NON EXISTING DAY
      *            THIS CHANGE OVERRIDES THIS OPTION FOR LOANS BOOKED WHEN
      *            GP-I-AM-WORLD AND PD-ORGST = "TN" AND PD-CLASS = 01 AND
      *            PD-ORGTERM = 12                                   WORLD 0532
      * BAH 070730 ADDED SCFRMLA 49 FOR REGMGM PR# 3017
      * BAH 071114 GET-BW1-FOR-SPEDT HAD 'GO TO' IN IT AND IT WAS NOT A
      *            SECTION, TRIST/LORI PL# 610
      *  CS 080305 ADDED TEST-INS-FEECD SECTION WHICH TIES THE FEE IDENTIFIED
      *            IN THE SPR ON THE INSURANCE PAGES TO THE ACTUAL INSURANCES
      *            WRITTEN. REGMGM WAS IN TROUBLE WITH AUDITORS FOR CHARGING
      *            THE SP-INSFEES WHEN THEY DIDNT WRITE THE INSURANCE
      *                                                   REGMGM PR#3106
      *  CS 080428 CHANGED TEST-INS-FEECD TO CHECK-FEECODE AND COMPLETELY
      *            CHANGED HOW IT WORKS, IT NOW CATCHES FEES YOU CANT WRITE
      *            & WHAT FEES YOU NEED TO WRITE REGARDING INSURANCE
      *            ORIG FEES PR#3106 REGMGM
      *  CS 080429 WAS NOT SETTING IO-FG TO 9 IF NCINS-ERRCD NOT = SPACES, WAS
      *            GIVING ERROR MSG BUT CONTINUING UPDATE, ALSO WHEN GP-RENEWAL
      *            COLLATERAL 'Y' WAS CHANGING THE SOURCE CODE NOT COLLATERAL
      * MJD 081117 MADE CHANGED TO MAKE GP-ADV-TO-1ST-NO-CORR WORK
      *            WITH CANS.  THE LOAN CALCULATOR WILL DEFAULT 1ST
      *            PAYMENT TO ONE MONTH FROM INT DTE IF A CAN LOAN.  THAT IS
      *            OK FOR THE CAN LOAN BUILDER BUT WHEN BOOKING THE LOAN WE
      *            NEED TO MAKE SURE 1ST PAYMENT IS ADVANCED CORRECTLY IF
      *            THE GP FLAG IS SET TO DO SO.   THE CALCULATOR DOES NOT
      *            DIFFERENTIATE BETWEEN CAN LOAN BUILDER OR LOAN ENTRY
      *            THAT I CAN FIND SO I AM MANIPULATING THE CAN LOAN
      *            NUMBER HERE.                          REGMGM PR#3265
      * MJD 090721 FOUND SOME ISSUES WITH REGIONAL MANAGMENT
      *            (AND POSSIBLY ALL), AS PER JIM EXCLUDING
      *            REGMG, TN, CLASS 2 UNTIL FURTHUR RESOLUTION CAN BE
      *            FOUND.   IT DOES NOT APPEAR TO BE CALCULATING
      *            CORRECTLY FOR THESE AND HAVE NOT YET DETERMINED
      *            WHY.
      * BAH 090904 ALLOW SP-INSMAXCHGABL-OVRIDE TO WORK WITH O1, FINMGM PR# 3447
      *  CS 100708 ADDED IF GP-I-AM-WORLD COMPARE PAYCODE ENTERED TO
      *            SP-DL-UNITPER-CD, MUST MATCH. IF WORLD, DONT ALLOW MONTHLY'S
      *            FROM BALLOON   WORLD PL#692
      *  CS 101716 ADDED TEST-GP-ALLOW-MF-ON-IB(SAME AS TEST IN XONPC0) TO ALLOW
      *            MAINTFEE ON IB ACCOUNTS PR#692
      * MJD 100715 FIXED TO CORRECTLY ALLOW MAINTFEE'S OVER 99.99 FOR MEXICO.
      *  CS 100805 ADDED TESTS ON SP-UNITPER-CD, IF ITS NOT A SPACE(ALLOWS FOR
      *            ALL PAY FREQUENCIES) THE PAYFREQ OF THE LOAN MUST MATCH
      *            SP-UNITPER-CD.    PL#692
      * MJD 100809 CHANGE UPDATE TO SUM-MAINTFEE TO BE TOTAL MAINT FEES
      *            RATHER THEN THE MONTHLY CHARGE WHEN CALCULATING
      *            FOR MEXICO MAINT FEE FORMULA 05.  NOT SURE WHY
      *            THIS PROGRAM UPDATED DIFFERENTLY THEN XONPC0.  WORLD #692
      * BAH 110106 ADDED SCFRMLA 50 FOR WORLD "IL" PR# 731
      * BAH 110118 ADDED SP-RENEWAL-EDIT "A" WORLD "IL" PR# 734
      * BAH 110127 RENAMED CASCHG-ORGST TO CASCHG-SCFRMLA, REGMGM PR# 3721
      * BAH 110216 CHANGE TO SCFRMLA 50 FOR 3/21/11, WORLD PR# 731
      * BAH 110321 RENEWAL-EDIT "A", ONLY DO 75 DAY TEST IF PRIOR LOAN
      *            WAS MADE 3/21/11 OR LATER WHEN LAW IN EFFECT, WORLD 734
      * BAH 110321 SCFRMLA 50 FOR NEW LOANS, EXIT WITH 100.00 IN
      *            CIP-RESTRICT-ADJ SO CALCZL WILL BE CORRECT, WORLD 731
      * BAH 110523 PASSWORD PROTECT ADDON SOURCE CODES, ET, LP, NP, RT, ST
      *            AND RB, REGMGM PR# 3792
      * BAH 110601 ADDED SP-SCFRMLA 52 AND 53 FOR MULLEN PR# 3799
      * BAH 110622 WAS ALLOWING INSURANCE SALES TAX FEE CODES
      * BAH 110916 REPLACED 1 RRFORM WITH SCREEN IN SEND-MESS-X
      * BAH 111109 CHANGE SCFRMLA 47 TO BE MORE LIKE 49, CALL CASC16 TO CHECK
      *            ONLY 1 WITHIN 12 MONTH PERIOD, BAY PR# 3898
      * MJD 111209 ADDED LOGIC FOR SP-ADV-TO-1ST-NO-CORR
      *            IF SET THIS WILL OVERIDE THE GP FLAG.             71226 #3879
      * BAH 111229 ADDED PP-PREM-SEQ TO PASSWORD CHANGING PP PREM REGWAN PR#3935
      * BAH 120809 ADDED 25. END: ENDORSER RATE FOR MEXICO TO DISCLOSE
      *            THEIR APR, THEY WILL JUST INPUT IT; WORLD PR# 818
      * BAH 130208 RENAMED CLASS17-SEQ TO RENEWAL-SEQ TO SHARE WITH OTHERS
      *            ADDED A RENEWAL-SEQ CASE FOR REGMGM, PR# 4209
      * BAH 130314 PR# 4209 SHOULD ONLY BE FOR "TN", REGMGM PR# 4209A
      * MJD 130603 ADDED LOGIC FOR SP-SCFRMLA = 54.  FUNCTIONS THE SAME AS 12
      *            BUT INCLUDES AN EXTRA 4% ADDED IN AT THE END BASED
      *            ON TOTAL NOTE                                     WORLD #0874
      * BAH 130814 ADDED SCFRMLA = 55, CROSS BETWEEN 23 AND 32, WORLD PR# 918
      * BAH 130916 ADDED SP-RENEWAL-EDIT "B" AND "C" FOR WORLD, PR# 923
      * BAH 130923 ADDED LT-SEQ 5 FOR A 3RD HHGS COLLATERAL WDT & UNITED PR#4095
      * BAH 131213 ADDED SP-SCFRMLA 56, LIKE 6 WITH RESTRICTIONS, WORLD PR# 953
      *            ALSO ADDED NCSCHG-ORGST AND NCSCHG-CLASS
      * KEC 140211 {PR#00967} WORLD <A15> [JIM ROSENAUER]
      *            ADDED LOGIC FOR WORLD TO DO LOAN APPS.
      *            ADDED LIBLP/WRLDAPP(W)
      *            ADDED LOANAPP-* FIELDS
      *            MODIFIED EXISTING FIELDS FOR WORLD'S NEEDS.
      * BAH 140814 SET LPLOAN-CALLED-FROM FOR LNVERI, CAUSING MISSING FIELD
      * BAH 140814 ADDED TEST FOR LPSMNU IN HELP
      *  CS 141112 AT END OF BORROWER-CREATE SECTION, FORCED BWCREA-NO TO 
      *            VDUNUM0 WHICH IS MOVED TO NUM-BW AND THEN TO PD-SSNO,
      *            BW-SSNO. WHEN YOU F5-BORROWER-CREATE AND COME BACK TO
      *            ENTRY, DIDNT HAVE THE RIGHT VALUE FOR VDUNUM0
      * BAH 150508 ADDED SCFRMLA 57, COMBO OF 23 AND 46, NSA PR# 4747
      * KEC 150604 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *            REMOVED THE USE OF 'INDEXED BY' ON OCCURS
      *            WITHIN LIBCL/NCINSW FOR USE WITH MICROFOCUS.
      *            NO CHANGES MADE WITHIN THIS PROGRAM.
      * BAH 150702 ADDED SET OF BWCREA-ERRCD TO "S" FOR SPANISH SCREENS,
      *            WORLD PR# 1083A (ORIGINALLY PR#414)
      *  CS 150814 IF GP-I-AM-EXCEL, TEST THE FEECODE AMOUNT AGAINST CD-
      *            GC-BRANCH-COMM-AMOUNT  EXCEL PR#4821
      * BAH 151104 ADDED SP-RENEWAL-EDIT "D" AND "E" FOR REGMGM PR#4885
      * BAH 160118 SPLIT OUT LTFILE, PD0003
      *
      * KEC 2016.0310 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CD-GROUP, CD-SECURED & CD-TRW TO BE
      *         CD-CO-GROUP, CD-CO-SECURED & CD-CO-TRW.
      * KEC 2016.0315 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CD-FEE???? TO CD-GC-????.
      * KEC 2016.0325 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CDSCAN-WINDOW-BUF TO HAVE MATCHING CD1-KEY
      *         LAYOUTS (FOR EACH CODE TYPE; CD-TYPE).
      *         CDSCAN-CD1-KEY IS THE NEW (PRIMARY) WITH REDEFINES OF
      *         CDSCAN-??-KEY (NEW).
      * KEC 2016.0329 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED ELSCAN WORKERS TO MATCH CD1-KEY FOR EL LAYOUT.
      * BAH 160509 ADDED SP-SCFRMLA 58, WORLD PR#1154
      * KEC 2016.0516 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED USE OF APPNO TO APP-NUMBER FOR MA1-KEY USAGE.
      *  CS 160609 IF BW-STATE = KY, CHECK FOR TAX RATE OF 99.99
      *            FOR PP2 AND O1, IF RATE IS 99.99 PROMPT FOR
      *            PASSWORD.  REGENCY PR#5087
      * KEC 2016.0621 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         REMOVED USE OF THE MX-FILE [LIBLA/LAFDMX].
      *         REMOVED USE OF OLD STATUS ROUTINES [LIBLA/MASTATUS(W)].
      *         ADDED USE OF NEW MA-STATUS-INFO FIELDS; AS WELL AS
      *         ADDED USE OF NEW ROUTINES [LIBLA/LAFRMA & LAWSMA].
      *  CS 160805 CHANGED SCSCAN-KEY TO SCSCAN-SP1-KEY
      *            REMOVED CHECK-FOR-MORELN
      *            COMMENT TESTS ON PD-GIFTNET-EXTR
      * BAH 160811 ADDED PASSWORD OPT 25 TO PROTECT 3RD AND 4TH BORROWERS
      *            COSIGNER-3-AND-4-SEQ, WORLD PR#1175
      * BAH 160812 AFTER ENTERING SUBCLASS, READ EFFECTIVE SPR, NOT JUST
      *            THE FIRST ONE IN THE CLASS, IF CAN LOAN ONLY WAS SET
      *            THE USER WAS STUCK. WORLD PR#1176
      * KEC 2016.0818 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         REMOVED USE OF THE BA-FILE [LIBLA/LAFDMX].
      *         REVISED LA-REC LAYOUT.
      * MJD 160824 ADDED LC-CALC-HI-CREDIT = "L"              61000/1180
      * BLM 160824 ADDED UPDATE OF SAVE-PRPDUE-DAYS & SAVE-PRLNAMT WHICH ARE NOW
      *            USED IN LNAPPROVAL FOR WORLD, WORLD PR# 1182
      * MJD 160922 ALLOW PMT FREQ OF "M" IF GP-I-AM-WORLD AND 
      *            SP-ORGST NOT = "MX"                                61000#1191
      * BAH 161005 ADDED PASSWORD BW-BDATE-0-SEQ TO ASK FOR PASSWORD IF
      *            ANY BORROWER ON THE LOAN DOES NOT HAVE A BIRTHDATE
      *            ON A SAVE OR UPDATE, REGMGM PR#5178
      *  CS 161206 IN VERIFY-REQD-FLDS, PRIOR TO READING THE BORROWER(TO CHECK
      *            FOR BIRTHDATE) IF IO-FG IS BAD MOVE "Y" TO BAD-FG, THEN
      *            READ THE BW, AFTER THE READ OF THE BW, IF BAD-FG IS "Y"
      *            MOVE 9 TO IO-FG,THIS WILL PRESERVE THE CHECK ON IO-BAD
      *            AFTER PERFORM VERIFY-REQD-FLDS AND GO TO MODIFY-ROUTINE.
      *                                                      PL958
      * BAH 170119 FIXED VERIFY-REQD-FLDS AGAIN FROM PL958, IF FIRST BW HAS
      *            0 BDATE THEN NEXT BW HAS VALID BDATE, IT WAS ALLOWING IT
      *            BECAUSE OF THE STUPID IO-FG TEST IN THERE, SO I EXIT THE
      *            PERFORM VARYING AS SOON AS YOU FAIL AND DONT TRY THE NEXT
      *            BORROWER! PL958
      * KEC 2017.0227 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED PROCEEDS-LOW, PROCEEDS-HIGH, POINTS-LOW,
      *          POINTS-HIGH TO MATCH SIZE OF SP-EDT-AMT 9(7)V99.
      *  CS 170525 ACTIVATE 8 DIGIT DATES
      *
      * KEC 2017.0602 {PR#00000} PARADATA <A30> [JAY CISZEWSKI]
      *          RENAMED INTERNAL LN-ACCTNO TO BE WSS-LN-ACCTNO TO 
      *          REMOVE CONFUSION SINCE IT IS NOT IN LN-REC.
      * BAH 171228 OPERATIONS WANTS ALL BRANCHES TO HAVE ABILITY TO ADJUST PP
      *            INSURANCE WHEN BUILDING A LOAN, NOT JUST "GA", WORLD #1292
      * KEC 180827 LOAN APP MODULE REMOVAL FROM A30 [LARM30]
      * BAH 181011 ADDED TXSCHG-CLASS FOR SCFRMLA 58, WAS NOT TESTING
      *            CLASS, #1341
      * BAH 2019.0529 ADDED SP-SCFRMLA 59 KY HB225 WORLD PR#1374
      * BAH 20190625 REMOVED LC-REVOLVING, LCSCAN-REVOLVING PT#0153
      *  CS 20190815 WHEN F3-APPROVAL OF LOAN, ZONPC WAS NOT BEING SET
      *              TO "ZONPC" SO YOU WERE LOCKED UP                   
      * BAH 2019.1209 NEW SP-DUAL-IN-STATE VALUE "C" FOR CLASS, STOP LOANS
      *              WITHIN SAME CLASS (TAX ADVANCE LOANS), #1407
      * BAH 2020.0617 CHANGED PC-LT-RECORD TO PC-LTC-RECORD, ADDED LPPCCL CLEAR
      * BAH 2020.1207 CHANGE VIA-QUOTE-SCAN, DONT MOVE IN THE PDSCAN-NAME,
      *              YOU HIT END OF FILE WHEN ONLY 1 QUOTE IN THE PDFILE.
      *              MOVE SPACES TO PD2-BWNAME AND ADD A CHECK OF THE
      *              PD2-BWNAME MATCHES THE PDSCAN-BWNAME OR GO GET NEXT.
      * BAH 2021.0713 PASSWORD FIELD 31, OTHER 2 INSURANCE #1504
      * BAH 2022.0314 REMOVED EXT-SPANISH-FORMS AND ALL MX FORMS
      * BAH 2023.0314 FIXED CHECK ON SP-EDT-NOEDITS CINDY FOUND, OUT OF BOUNDS
      * BAH 2024.0315 REMOVED BISCAN-LIASMLN AND BISCAN-PRLOANS
      * BAH 2024.0401 REMOVED CASCHG-YEARTYPE, CASCHG-ERRCD
      * BAH 2024.1010 ADDED SP-SCFRMLA 63 "WI" #1682 S35Q-141
      * BAH 2025.0407 CLEAR 3RD LEVEL OF AUTO COLLATERAL, WK-AUTO-3 S35Q-194
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBLP/LPFSWK.CPY".
       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.

       COPY "LIBLP/LPFDWK.CPY".

       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(41) VALUE
           "@(#)LP/ZONPC0.CBL S35 04/16/24-11:55:47 >".
      **********************************
      *       F I L E   P A T H S      *
      **********************************
       COPY "LIBGB/GB01GB.CPY".
       COPY "LIBGB/GB01GB_SQL.CPY".
       COPY "LIBGB/GBWSGB.CPY".
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".
       COPY "LIBGB/GB01GR.CPY".
       COPY "LIBGB/GB01GR_SQL.CPY".
       COPY "LIBGB/GBWSGR.CPY".
       COPY "LIBLP/LP01CL.CPY".
       COPY "LIBLP/LP01CL_SQL.CPY".
       COPY "LIBLP/LPWSCL.CPY".
       COPY "LIBLP/LP01LC.CPY".
       COPY "LIBLP/LP01LC_SQL.CPY".
       COPY "LIBLP/LPWSLC.CPY".
       COPY "LIBLP/LP01DL.CPY".
       COPY "LIBLP/LP01DL_SQL.CPY".
       COPY "LIBLP/LPWSDL.CPY".
       COPY "LIBLP/LP01SP.CPY".
       COPY "LIBLP/LP01SPA.CPY".
       COPY "LIBLP/LP01SPB.CPY".
       COPY "LIBLP/LP01SPC.CPY".
       COPY "LIBLP/LP01SP_SQL.CPY".
       COPY "LIBLP/LPWSSP.CPY".
       COPY "LIBLP/LP01BW.CPY".
       COPY "LIBLP/LP01BW_SQL.CPY".
       COPY "LIBLP/LPWSBW.CPY".
       COPY "LIBGL/GL01GI.CPY".
       COPY "LIBGL/GL01GI_SQL.CPY".
       COPY "LIBGL/GLWSGI.CPY".
       COPY "LIBLP/LP01CD.CPY".
       COPY "LIBLP/LP01CD_SQL.CPY".
       COPY "LIBLP/LPWSCD.CPY".
       COPY "LIBLP/LP01CDB.CPY".
       COPY "LIBLP/LP01CDB_SQL.CPY".
       COPY "LIBLP/LPWSCDB.CPY".
       COPY "LIBLP/LP01IC.CPY".
       COPY "LIBLP/LP01IC_SQL.CPY".
       COPY "LIBLP/LPWSIC.CPY".
       COPY "LIBLP/LP01PD.CPY".
       COPY "LIBLP/LP01PD_SQL.CPY".
       COPY "LIBLP/LPWSPD.CPY".
       COPY "LIBLP/LP01PC.CPY".
       COPY "LIBLP/LP01PC_SQL.CPY".
       COPY "LIBLP/LPWSPC.CPY".
       COPY "LIBLP/LP01LTC.CPY".
       COPY "LIBLP/LP01LTC_SQL.CPY".
       COPY "LIBLP/LPWSLTC.CPY".

       01  WK-IFN            PIC X(2) VALUE "WK".
       01  WK-KEY            PIC 9(2).
       01  CASE-BUF          PIC X(4).
       01  THE-CAN-GROUP-ID  PIC X(4)  VALUE " ".
       01  BAD-FG            PIC X   VALUE SPACES.
      *-----------------------------------------------------------------
      *    U S E R I D
      *-----------------------------------------------------------------
       01  USERID-GROUP-NAME.
           03  USER-GROUP           PIC X(3).
           03  FILLER               PIC X(2).


       01  ANTIC              PIC S9(6)V99 COMP.
       01  NEW-PD-RECORD-FG   PIC X        VALUE " ".
       01  MSEL-LIST          PIC X(5)     VALUE "MSEL.".
       01  WSEL-LIST          PIC X(5)     VALUE "WSEL.".
       01  ONE                PIC S9.
       01  ELE                PIC 9(6) COMP.
       78  CL-ELE             VALUE 27.
       78  AH-ELE             VALUE 28.
       78  PP-ELE             VALUE 29.
       78  O1-ELE             VALUE 30.
       78  O2-ELE             VALUE 31.
       78  O3-ELE             VALUE 32.
       01  SCHG18-UPDATE-FG   PIC X       VALUE " ".

      * NOTE: DO NOT COMP OR COMP-3 HOLD-RECALL-SSNO
       01  HOLD-RECALL-SSNO   PIC 9(9).
      * NOTE: DO NOT COMP OR COMP-3 HOLD-RECALL-SSNO

       01  HOLD-2.
           03  HOLD-2X        OCCURS 2 PIC X.
       01  HOLD-7.
           03  HOLD-7X        OCCURS 7 PIC X.
       01  HOLD-9.
           03  HOLD-9X        OCCURS 9 PIC X.

       01  SAVED-PD-PRIOR-RN-FOR10-DATE    PIC 9(08) COMP-3.
       01  SAVED-PD-LAST-RN-FOR10-DATE     PIC 9(08) COMP-3.

       01  SAVED-PRIOR-COLLCD   PIC X(2).
       01  SAVED-PRIOR-COLLID   PIC X(20).


       01  ISUB            PIC 9    VALUE ZEROS.

       01  FEECODE-TABLE   VALUE " ".
           03  FEECODE     OCCURS 4 TIMES
                           PIC XX.
       01  FEECODE-STATUS.
           03  FEECODE-STAT        PIC X(2)  OCCURS 3.

       01  FOUND-FEECODE-STATUS.
           03  FOUND-FEECODE-STAT  PIC X(2)  OCCURS 3.

       01  INSFEECD-TABLE    VALUE SPACES.
           03  INSFEECD      OCCURS 3 TIMES PIC XX.

       01  S1                PIC 99   VALUE ZEROS.
       01  S2                PIC 99   VALUE ZEROS.

       01  CDCODE-FEE-FG   PIC 9.
       01  LEGEND          PIC X(70).

       01  ACTION.
           03  CHKEY       PIC X(4).
           03  CHNO        PIC 9(2).
       01  IO-TYPE         PIC X(3).
       01  NEW-FLAG        PIC 9.
       01  ERRORS-EXIST    PIC X  VALUE " ".
       01  RESCISSION-FLAG PIC X  VALUE " ".
       01  FIRST-TIME      PIC 9  VALUE 0.
       01  FIRST-ELE       PIC 99 VALUE 0.
       01  NOREG-FG        PIC X  VALUE " ".
       01  SAVE-SSNO       PIC 9(10) COMP.
       01  SAVE-MAINTFEE   PIC 9(6)V99 COMP.
       01  ADV-TO-1ST-NO-CORR  PIC X VALUE " ".


       01  SUB             PIC 9(6) COMP.
       01  SUB2            PIC 9(6) COMP.
       01  XAGE-SUB        PIC 9(6) COMP.
       01  XAGE-MAX        PIC 9.
       01  OVER-20         PIC 99.
       01  WSS-LN-ACCTNO   PIC 9(8) COMP.
       01  I-LEVEL         PIC 99   COMP.
       01  INSPECT-W       PIC X(86).
       01  INSPECT-X REDEFINES INSPECT-W.
           03  INSPECT-Z   PIC X OCCURS 86 TIMES.
       01  INSPECT-X-LIST  PIC X(8)     VALUE "201 202.".
       01  ADD-ON          PIC X(25).
       01  OVERRIDES-OK    PIC X        VALUE "N".
       01  APR-OK          PIC X        VALUE "N".
       01  DEFAULT-APR-FG  PIC X.
       01  INITIAL-CAN-ENTRY-FG PIC X   VALUE " ".
       01  CAN-LOAN-NO     PIC XX       VALUE " ".
       01  HOLD-BW-NAME    PIC X(24) VALUE SPACES.
       01  F3-COLLATERAL   PIC X        VALUE " ".
           88  F3-YES                   VALUE "Y".
       01  BORR-CHG-FG     PIC X        VALUE " ".
           88  RECALL-UPDATE            VALUE "Y".
       01  QUOTE-ID-FG     PIC X        VALUE " ".
           88  QUOTE-ONLY               VALUE "Q".
           88  QUOTE-CHANGED-TO-LOAN    VALUE "L".
       01  PRIOR-LOAN-STAT PIC X.
           88  ERROR-IN-PRIOR-LOAN      VALUE "E".

       01  WS-SRCD-ERRCD    PIC 9.
      *--------------------------------------------------- LEGENDS -----
       01  LEGEND-01.
           03  FILLER      PIC X(52)  VALUE
               "F1, F2-CANNED LNS, F3-LOANS, F4-QUOTES, F7, ENTER #:".

       01  LEGEND-01-NO-CAN.
           03  FILLER      PIC X(52)  VALUE
               "F1, F3-LOANS, F4-QUOTES, F7-MENU, ENTER #:          ".

       01  LEGEND-01-CAN-ONLY.
           03  FILLER      PIC X(52)  VALUE
               "F2-CANNED LNS, F3-LOANS, F4-QUOTES, F7-MENU,ENTER #:".


       01  ALP-BW.
           03  ALP-BW123   PIC X(3).
           03  ALP-HYPHEN1 PIC X.
           03  ALP-BW45    PIC X(2).
           03  ALP-HYPHEN2 PIC X.
           03  ALP-BW6789  PIC X(4).
       01  NUM-BW          PIC 9(9).
       01  NUM-BWX REDEFINES NUM-BW.
           03  NUM-BW123   PIC X(3).
           03  NUM-BW45    PIC X(2).
           03  NUM-BW6789  PIC X(4).
       01  BW-ALP-TABLE.
           03  BW-ALP-TBL  OCCURS 70 TIMES
                           PIC X.
       01  W-LNNO        PIC 9(8).

       01  RESCISSION-LIST   PIC X(5)    VALUE "R1:R.".
       01  LC-INFO-LIST      PIC X(10)   VALUE "43P:S 430.".
       01  LC-INFO-BUF       PIC X(18).
       01  P230-LIST         PIC X(19)   VALUE "P230:S 230 231 232.".
       01  P230-BUF.
           03  FILLER        PIC X(16)   VALUE "23 COLLATERAL ID".
           03  FILLER        PIC X(60)   VALUE ALL "_".

       01  SRCD-WORKER        PIC S9(7)V99 COMP.
       01  SAVE-PRLNAMT       PIC 9(6)V99 VALUE 0.
       01  SAVE-PRPDUE-DAYS   PIC S9(5) VALUE 0.

      ********************************
      *   S C R E E N   B U F F E R  *
      ********************************
       01  DISPLAY-BUF1        VALUE " ".
           03  D-LCNO          PIC Z(8)9.
           03  D-LC-DESC       PIC X(16).
           03  D-010-040       OCCURS 3.
               05  D-010       PIC X(11).
               05  D-011       PIC X(33).
               05  D-012       PIC X(1).
           03  D-LOANAMT       PIC Z(6)9.99- BLANK ZERO.
           03  D-ANTIC         PIC Z(6)9.99- BLANK ZERO.
           03  D-050           PIC XX.
           03  D-051           PIC 9(4)      BLANK ZERO.
           03  D-052           PIC Z9.
           03  D-053           PIC X(12).
           03  D-060           PIC 99/99/99  BLANK ZERO.
           03  D-061           PIC 99/99/99  BLANK ZERO.
           03  D-070           PIC X(3).
           03  D-071           PIC X(15).
           03  D-080           PIC X(2).
           03  D-081           PIC X(15).
           03  D-090           PIC X(2).
           03  D-091           PIC X(15).
           03  D-100           PIC X.
           03  D-101           PIC 999.
           03  D-102           PIC X.
           03  D-110           PIC 9(6)      BLANK ZERO.
           03  FILLER          PIC X(3).
           03  D-111           PIC Z(5)9.99- BLANK ZERO.
           03  D-120           PIC ZZ9.
           03  D-130           PIC 99/99/99  BLANK ZERO.
           03  D-140           PIC Z(5)9.99- BLANK ZERO.
           03  D-141           PIC X.
           03  D-170           PIC Z(5)9.99- BLANK ZERO.
           03  D-171           PIC X.
           03  D-180           PIC X(3).
           03  D-181           PIC Z9.99     BLANK ZERO.
           03  D-182           PIC X.
           03  D-190           PIC Z(3)9.99  BLANK ZERO.
           03  FILLER          PIC X.
           03  D-220           PIC 9(4).99   BLANK ZERO.
           03  FILLER          PIC X(2).

       01  DISPLAY-BUF2        REDEFINES DISPLAY-BUF1.
           03  D-200           PIC Z(3)9.99  BLANK ZERO.
           03  D-201           PIC X.
           03  D-210           PIC Z(3)9.99  BLANK ZERO.
           03  D-211           PIC X.
           03  D-230           PIC X(20).
           03  D-231           PIC X(20).
           03  D-232           PIC X(20).
           03  D-250           PIC ZZ9.999   BLANK ZERO.
           03  D-260           PIC ZZ9.999   BLANK ZERO.
           03  D-261           PIC X.
           03  D-262           PIC ZZ9.999   BLANK ZERO.
           03  D-263           PIC ZZ9.999   BLANK ZERO.
           03  D-270-300      OCCURS 4.
               05  D-1COMP     PIC 99        BLANK ZERO.
               05  D-1OUR      PIC X.
               05  D-1TERM     PIC ZZ9       BLANK ZERO.
               05  D-1COVR     PIC Z(5)9.99  BLANK ZERO.
               05  D-1PREM     PIC Z(3)9.99  BLANK ZERO.
               05  D-INS-FG    PIC X.
           03  D-310-320      OCCURS 2.
               05  D-2COMP     PIC 99        BLANK ZERO.
               05  D-2OUR      PIC X.
               05  D-2EXP      PIC 9(6)      BLANK ZERO.
               05  D-2TERM   REDEFINES D-2EXP
                               PIC Z(6)      BLANK ZERO.
               05  D-2COVR     PIC Z(5)9.99  BLANK ZERO.
               05  D-2PREM     PIC Z(3)9.99  BLANK ZERO.
           03  D-340           PIC Z(5)9.99  BLANK ZERO.
           03  D-341           PIC X.
           03  D-350           PIC Z(5)9.99  BLANK ZERO.
           03  D-351           PIC X.
           03  D-360           PIC Z(5)9.99  BLANK ZERO.
           03  D-361           PIC X.
           03  D-370           PIC Z(6)9.99  BLANK ZERO.
           03  D-380           PIC Z(6)9.99  BLANK ZERO.
           03  D-381           PIC X.
           03  D-390           PIC Z(6)9.99  BLANK ZERO.
           03  D-400           PIC Z(5)9.99  BLANK ZERO.
           03  D-410           PIC Z(5)9.99- BLANK ZERO.
           03  D-420           PIC Z(5)9.99  BLANK ZERO.
           03  D-421           PIC X.
           03  FILLER          PIC X(131).

       01  DEF-BUF             REDEFINES DISPLAY-BUF1.
           03  DEF-ORGST        PIC XX.
           03  DEF-ORGBR        PIC 9(4).
           03  DEF-LOANDATE     PIC 99/99/99.
           03  DEF-INTDATE      PIC 99/99/99.
           03  DEF-PURCD        PIC XXX.
           03  DEF-UNITPER-CD   PIC X.
           03  DEF-UNITPER-FREQ PIC ZZ9.
           03  DEF-BALLBL       PIC X.
           03  FILLER           PIC X(350).

       01  DF2-BUF             REDEFINES DISPLAY-BUF1.
           03  DF2-SELLPR            PIC Z(5)9.99- BLANK ZERO.
           03  DF2-SELLPR-FG         PIC X.
           03  DF2-BALLOON           PIC Z(5)9.99- BLANK ZERO.
           03  DF2-BALLOON-FG        PIC X.
           03  DF2-POINTS            PIC Z9.99     BLANK ZERO.
           03  DF2-POINTS-FG         PIC X.
           03  DF2-FEE-1             PIC Z(3)9.99  BLANK ZERO.
           03  DF2-FEE-1-FG          PIC X.
           03  DF2-FEE-2             PIC Z(3)9.99  BLANK ZERO.
           03  DF2-FEE-2-FG          PIC X.
           03  DF2-ENDORATE          PIC ZZ9.999   BLANK ZERO.
           03  DF2-OVRDRATE          PIC ZZ9.999   BLANK ZERO.
           03  DF2-OVRDRATE-FG       PIC X.
           03  DF2-EFFRATE           PIC ZZ9.999   BLANK ZERO.
           03  DF2-APRATE            PIC ZZ9.999   BLANK ZERO.
           03  DF2-LNAMT             PIC Z(6)9.99- BLANK ZERO.
           03  DF2-ANTIC             PIC Z(6)9.99- BLANK ZERO.
           03  DF2-INS-INFO          OCCURS 4.
               05  DF2-INSCOMP       PIC 99        BLANK ZERO.
               05  DF2-INSOURS       PIC X.
               05  DF2-INSTERM       PIC ZZ9       BLANK ZERO.
               05  DF2-INSCOVR       PIC Z(5)9.99  BLANK ZERO.
               05  DF2-INSPREM       PIC Z(3)9.99  BLANK ZERO.
               05  DF2-INS-FG        PIC X.
           03  DF2-SERCHG            PIC Z(5)9.99  BLANK ZERO.
           03  DF2-SERCHG-FG         PIC X.
           03  DF2-MAINTFEE          PIC Z(5)9.99  BLANK ZERO.
           03  DF2-MAINTFEE-FG       PIC X.
           03  DF2-EXTCHG            PIC Z(5)9.99  BLANK ZERO.
           03  DF2-EXTCHG-FG         PIC X.
           03  DF2-INTCHG            PIC Z(6)9.99  BLANK ZERO.
           03  DF2-APR-FINAMT        PIC Z(6)9.99  BLANK ZERO.
           03  DF2-PROCEEDS-FG       PIC X.
           03  DF2-TREPAY            PIC Z(6)9.99  BLANK ZERO.
           03  DF2-1STPYAMT          PIC Z(5)9.99  BLANK ZERO.
           03  DF2-LASTPYAMT         PIC Z(5)9.99- BLANK ZERO.
           03  DF2-REGPYAMT          PIC Z(5)9.99  BLANK ZERO.
           03  DF2-REGPYAMT-FG       PIC X.
           03  DF2-RETURN-CODE       PIC X.
           03  DF2-LOOP-COUNT        PIC Z(3).
           03  FILLER                PIC X(88).

       01  DEF-LIST               PIC X(32)  VALUE
           "050 051 060 061 070 100 101 102.".

       01  FEE-LIST               PIC X(8)   VALUE
           "190 191.".

       01  DISPLAY-LIST1.
           03  FILLER             PIC X(49)  VALUE
           "LNKEY LCDESC 010 011 012 020 021 022 030 031 032 ".
           03  FILLER             PIC X(38)  VALUE
           "LOANAMT ANTIC 050 051 052 053 060 061 ".
           03  FILLER             PIC X(24)  VALUE
           "070 071 080 081 090 091 ".
           03  FILLER             PIC X(43)  VALUE
           "100 101 102 110 110SEQ 111 120 130 140 141 ".
           03  FILLER             PIC X(36)  VALUE
           "170 171 180 181 182 190 191 220 430.".

       01  DISPLAY-LIST2.
           03  FILLER          PIC X(36)  VALUE
           "200 201 210 211 230 231 232 250 260 ".
           03  FILLER          PIC X(32)  VALUE
           "261 262 263 270 271 272 273 274 ".
           03  FILLER          PIC X(56)  VALUE
           "275 280 281 282 283 284 285 290 291 292 293 294 295 300 ".
           03  FILLER          PIC X(56)  VALUE
           "301 302 303 304 305 310 311 312 313 314 320 321 322 323 ".
           03  FILLER          PIC X(56)  VALUE
           "324 340 341 350 351 360 361 370 380 381 390 400 410 420 ".
           03  FILLER          PIC X(4)   VALUE
           "421.".

       01  DF2-LIST.
           03  FILLER          PIC X(36)  VALUE
           "140 141 170 171 181 182 200 201 210 ".
           03  FILLER          PIC X(24)  VALUE
           "211 250 260 261 262 263 ".
           03  FILLER          PIC X(22)  VALUE
           "LOANAMT ANTIC 270 271 ".
           03  FILLER          PIC X(56)  VALUE
           "272 273 274 275 280 281 282 283 284 285 290 291 292 293 ".
           03  FILLER          PIC X(56)  VALUE
           "294 295 300 301 302 303 304 305 340 341 350 351 360 361 ".
           03  FILLER          PIC X(40)  VALUE
           "370 380 381 390 400 410 420 421 440 450.".

       01  PROMPT-BUF.
           03  FILLER       PIC X(13)  VALUE "LOAN AMOUNT :".
           03  FILLER       PIC X(13)  VALUE "ANTIC EARN  :".
           03  FILLER       PIC X(31)  VALUE
               "CO O EX/TRM  COVERAGE PREMIUM X".
           03  FILLER       PIC X(27)  VALUE
               "---OUTPUT------------------".
           03  FILLER       PIC X(6)   VALUE "27 CL:".
           03  FILLER       PIC X(6)   VALUE "28 AH:".
           03  FILLER       PIC X(6)   VALUE "29 PP:".
           03  FILLER       PIC X(6)   VALUE "30 O1:".
           03  FILLER       PIC X(6)   VALUE "31 O2:".
           03  FILLER       PIC X(6)   VALUE "32 O3:".
           03  FILLER       PIC X(15)  VALUE "34 SERVICE CHG:".
           03  FILLER       PIC X(15)  VALUE "35 MAINT FEES :".
           03  FILLER       PIC X(15)  VALUE "36 1ST PY EXT :".
           03  FILLER       PIC X(15)  VALUE "   INT CHARGE :".
           03  FILLER       PIC X(15)  VALUE "   AMT FINANCD:".
           03  FILLER       PIC X(15)  VALUE "   TOT REPYBLE:".
           03  FILLER       PIC X(15)  VALUE "   1ST PAYMENT:".
           03  FILLER       PIC X(15)  VALUE "   LAST   ""  :".
           03  FILLER       PIC X(15)  VALUE "42 REG PAYMENT:".
           03  PROMPT-200   PIC X(2)   VALUE "20".
           03  PROMPT-201   PIC X(13)  VALUE "FEE1        :".
           03  PROMPT-210   PIC X(2)   VALUE "21".
           03  PROMPT-211   PIC X(13)  VALUE "FEE2        :".
           03  FILLER       PIC X(16)  VALUE "23 COLLATERAL ID".
           03  FILLER       PIC X(7)   VALUE "25 END:".
           03  FILLER       PIC X(17)  VALUE "-----RATES-----FG".
           03  FILLER       PIC X(7)   VALUE "26 OVR:".
           03  FILLER       PIC X(7)   VALUE "   EFF:".
           03  FILLER       PIC X(7)   VALUE "   APR:".
           03  FILLER       PIC X(7)   VALUE "       ".

       01  PROMPT-LIST.
           03  FILLER          PIC X(42)  VALUE
             "PLOANAMT:S PANTIC:S INSPROMPT:S OUTPROMPT ".
           03  FILLER          PIC X(49)  VALUE
             "P270:S P280:S P290:S P300:S P310:S P320:S P340:S ".
           03  FILLER          PIC X(21)  VALUE
             "P350:S P360:S P370:S ".
           03  FILLER          PIC X(49)  VALUE
             "P380:S P390:S P400:S P410:S P420:S P200:S P201:S ".
           03  FILLER          PIC X(28)  VALUE
             "P210:S P211:S P230:S P250:S ".
           03  FILLER          PIC X(30)  VALUE
             "PRATES:S P260:S P262:S P263:S.".


      ********************************
      *   E L E M E N T   S P E C S  *
      ********************************
       01  MAX             PIC 99   VALUE 43.
       01  SPEC-TABLE.
      * 1  PD-SSNO(1)
           03  FILLER      PIC X(8) VALUE "ERNX110 ".
      * 2  PD-SSNO(2)
           03  FILLER      PIC X(8) VALUE "ERNX110 ".
      * 3  PD-SSNO(3)
           03  FILLER      PIC X(8) VALUE "ERNX110 ".
      * 4  PD-SSNO(4)
           03  FILLER      PIC X(8) VALUE "ERNX110 ".
      * 5  PD-ORGST
           03  FILLER      PIC X(8) VALUE "E  A020 ".
      * 6  PD-LOANDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 7  PD-PURCD
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 8  PD-COLLCD
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 9  PD-SRCD
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 10 PD-UNITPER-CD
           03  FILLER      PIC X(8) VALUE "E  A010N".
      * 11 PD-PRLNNO
           03  FILLER      PIC X(8) VALUE "ENNN060 ".
      * 12 PD-ORGTERM
           03  FILLER      PIC X(8) VALUE "ENNN030 ".
      * 13 PD-1STPYDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 14 PD-PROCEEDS
           03  FILLER      PIC X(8) VALUE "ENNS062 ".
      * 15 OPEN
           03  FILLER      PIC X(8) VALUE "ENNS032N".
      * 16 OPEN
           03  FILLER      PIC X(8) VALUE "ENNS032N".
      * 17 PD-LASTPYAMT
           03  FILLER      PIC X(8) VALUE "ENNS062 ".
      * 18 PD-INSURED
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 19 PD-FEEAMTS(X)
           03  FILLER      PIC X(8) VALUE "E  A020 ".
      * 20 PD-FEEAMT(1)?
           03  FILLER      PIC X(8) VALUE "ENNN042 ".
      * 21 PD-FEEAMT(2)?
           03  FILLER      PIC X(8) VALUE "ENNN042 ".
      * 22 PD-DLNO
           03  FILLER      PIC X(8) VALUE "ENNN042 ".
      * 23 COLLATERAL ID
           03  FILLER      PIC X(8) VALUE "E  A200 ".
      * 24 OPEN.........
           03  FILLER      PIC X(8) VALUE "ENNN052N".
      * 25 PD-ENDORATE
           03  FILLER      PIC X(8) VALUE "ENNN033 ".
      * 26 PD-OVRDRATE
           03  FILLER      PIC X(8) VALUE "ENNN033 ".
      * 27 PD-INSCOMP(1)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 28 PD-INSCOMP(2)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 29 PD-INSCOMP(3)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 30 PD-INSCOMP(4)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 31 PD-INSCOMP(5)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 32 PD-INSCOMP(6)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 33 OPEN
           03  FILLER      PIC X(8) VALUE "E  A020N".
      * 34 PD-SERCHG
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 35 PD-MAINTFEE
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 36 PD-EXTCHG
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 37 PD-INTCHG
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 38 PD-FINAMT
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 39 PD-LOANAMT
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 40 PD-1STPYAMT
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 41 PD-LASTPYAMT
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 42 PD-REGPYAMT
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 43 PD-LC-CODE
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
       01  SPEC-TABLE2     REDEFINES SPEC-TABLE.
           03  SPEC-REC    OCCURS 43 TIMES.
               05  SPEC    PIC X(7).
               05  CHFG    PIC X.

       01  PRIOR-LNAMT           PIC S9(7)V99 COMP.
       01  PRIOR-BNKRPTDATE      PIC 9(8)     COMP.
       01  DO-STATE-CY-EXIST-FG  PIC X        VALUE "N".
       01  DO-STATE-CT-EXIST-FG  PIC X        VALUE "N".
       01  ALLOW-BW-UPDATE-FG    PIC X        VALUE "N".
       01  ALLOW-CITY-SCAN-FG    PIC X        VALUE "N".
       01  ALLOW-COUNTY-SCAN-FG  PIC X        VALUE "N".


       01  DATE-STAT             PIC X.
       01  COUNTER               PIC 99.
       01  COMPARE-TO-HOLDERS.
           03  PROCEEDS-FG-HLDR              PIC X.
           03  PROCEEDS-HLDR                 PIC S9(9)V99 COMP.
           03  SELLPR-HLDR                   PIC S9(9)V99 COMP.
           03  AMT-HOLDER                    PIC S9(9)V99 COMP.
           03  MAINTFEE-HLDR                 PIC S9(6)V99 COMP.
           03  TOTAL-GL-HLDR                 PIC S9(5)V99 COMP.
           03  TOTAL-GL-HLDR-SALESTAX        PIC S9(5)V99 COMP.
           03  TOTAL-GL-FINCHG-HLDR          PIC S9(5)V99 COMP.
           03  TOTAL-GL-FINCHG-HLDR-SALESTAX PIC S9(5)V99 COMP.
           03  INSPREM-HLDR                  PIC S9(4)V99 COMP.
           03  INSTERM-HLDR                  PIC 9(3)     COMP.
           03  INSOURS-HLDR                  PIC X.
           03  CALC-FG-HLDR                  PIC X.
           03  INSCODES-HLDR                 PIC XXX.
           03  INSCOMP-HLDR                  PIC 99       COMP.

       01  HOLD-WORKER          PIC S9(9)V99 COMP.

       01  HOLD-AMT-EXCEEDED    PIC Z(9).99.
       01  HOLD-TERM-EXCEEDED  REDEFINES HOLD-AMT-EXCEEDED
                                PIC Z(11)9.
       01  HOLD-RATE-EXCEEDED  REDEFINES HOLD-AMT-EXCEEDED
                                PIC Z(4).9999.
       01  AMT-EXCEEDED-LIT    REDEFINES HOLD-AMT-EXCEEDED
                                PIC X(12).

       01  TYPE-OF-AMT-EXCEEDED PIC X(15).
       01  DATE-HOLDER          PIC 9(8).

       01  SAVE-QUOTE-SSN       PIC 9(10)  COMP.
       01  SCREEN-LINES.
           03  SCREEN-LINE1     PIC X(20).
           03  SCREEN-LINE2     PIC X(20).
           03  SCREEN-LINE3     PIC X(20).
       01  MSG-LINES REDEFINES SCREEN-LINES.
           03  MSG-LINE1        PIC X(30).
           03  MSG-LINE2        PIC X(30).
       01  SAVE-PD2-KEY.
           03  SAVE-PD2-KEY-ID  PIC X.
           03  SAVE-PD2-KEY-BR  PIC 9(4).
           03  SAVE-PD2-KEY-NAM PIC X(33).
       01  SAVE-BW-1-INFO.
           03  SAVE-BW-1-STATE         PIC XX.
           03  SAVE-BW-1-CITY-TAX-CD   PIC XXX.
           03  SAVE-BW-1-COUNTY        PIC XXX.
       01  BW-1-INFO.
           03  BW-1-STATE              PIC XX.
           03  BW-1-CITY-TAX-CD        PIC XXX.
           03  BW-1-COUNTY             PIC XXX.

       01  SAVE-PD-REC          PIC X(PD-SIZE).

       01  PASSX-CURRENT-PD-CLASS      PIC 9(3).

       01  TERM-LOW             PIC 9(3)    COMP.
       01  TERM-HIGH            PIC 9(3)    COMP.
       01  PROCEEDS-LOW         PIC 9(7)V99 COMP.
       01  PROCEEDS-HIGH        PIC 9(7)V99 COMP.
       01  POINTS-LOW           PIC 9(7)V99 COMP.
       01  POINTS-HIGH          PIC 9(7)V99 COMP.

       01  GA-SCHG-PATH.
           03  FILLER         PIC X(7)     VALUE "CL/GASC".
           03  GA-SCHG-NO     PIC 99.
       01  SC-SCHG-PATH.
           03  FILLER         PIC X(7)     VALUE "CL/SCSC".
           03  SC-SCHG-NO     PIC 99.

       01  WS-SYSTEM-DATEX    PIC X(08).
       01  WS-SYSTEM-DATE REDEFINES WS-SYSTEM-DATEX PIC 9(8).

      *-----------------------------------------------------------------
       01  WS-MESSAGES.
           03  MESSAGE-CANNOT-CHANGE-SSNO.
               05  FILLER                       PIC X(43)  VALUE
                   "CANNOT CHANGE THIS NUMBER --- 'F1' TO CLEAR".
           03  MESSAGE-MUST-CREATE-BW-1.
               05  FILLER                       PIC X(38)  VALUE
                   "MUST CREATE BORROWER BEFORE CONTINUING".

           03  MESSAGE-INVALID-SPR-CAN-LOAN.
               05  FILLER PIC X(25) VALUE "INVALID: STATE PARA. DOES".
               05  FILLER PIC X(25) VALUE " NOT ALLOW CAN LOANS!    ".

           03  MESSAGE-INVALID-SPR-CL.
               05  FILLER PIC X(25) VALUE "INVALID SUB CLASS NUMBER:".
               05  FILLER PIC X(25) VALUE " FOR CAN LOANS ONLY!     ".

           03  MESSAGE-INVALID-SPR-NON-CL.
               05  FILLER PIC X(25) VALUE "INVALID SUB CLASS NUMBER:".
               05  FILLER PIC X(25) VALUE " FOR NON CAN LOANS ONLY! ".

           03  MESS-INVALID-SPR-PAY-FREQ-WORLD.
               05  FILLER PIC X(25) VALUE "INVALID SPR: PAY FREQUENC".
               05  FILLER PIC X(25) VALUE "Y!                     ".

           03  MESS-INVALID-SPR-PAY-FREQ.
               05  FILLER PIC X(25) VALUE "INVALID-SPR: PAY FREQ".


           03  MESSAGE-INVALID-FEE-NC.
               05  FILLER PIC X(09) VALUE
               "FEE CODE ".
               05  INVALID-FEE PIC X(2).
               05  FILLER PIC X(32) VALUE
               " NOT VALID PER INSURANCE WRITTEN".

           03  MESSAGE-VALID-FEES-NC.
               05  FILLER  PIC X(09) VALUE
               "FEE CODE ".
               05  VALID-FEE PIC X(2).
               05  FILLER    PIC X(30) VALUE
               " ALLOWED PER INSURANCE WRITTEN".

      *----------------------------------------------------------------
      * REPLACED SEVERAL OCCURANCES OF IO-FG WITH BW-ERROR-YN. IO-FG WAS
      * USED AS AN ERROR FLAG UNRELATED TO I/O. ADDING LA-FILE READ
      * CHANGED IO-FG WHICH AFFECTED FLOW OF PROGRAM.
      *----------------------------------------------------------------
       01  BW-ERROR-YN                   PIC X        VALUE "N".
           88  BW-ERROR-NO                            VALUE "N".
           88  BW-ERROR-YES                           VALUE "Y".

       01  W-VDUSTATUS        PIC XX.
       01  HOLD-PRIOR-PO-TRCD PIC XX.
       01  HOLD-MA-CLASS      PIC 9(3).
       01  FIND-LOANS-FG      PIC X         VALUE " ".
       01  LOAN-RECALL-FG     PIC X         VALUE " ".
       01  TEST-COLLCD     PIC XX.
           88  AUTO-COLLCD VALUE "AU" "AC" "AL" "RP" "HP" "AW".
       01  ALLOW-NON-CANS     PIC X         VALUE "N".

       COPY "LIBCL/CASCHGW.CPY".
       COPY "LIBCL/GASCHGW.CPY".
       COPY "LIBCL/SCSCHGW.CPY".
       COPY "LIBCL/NCSCHGW.CPY".
       COPY "LIBCL/TXSCHGW.CPY".
       COPY "LIBCL/WISCHGW.CPY".
       COPY "LIBCL/MFEE04W.CPY".
       COPY "LIBCL/NCINSW.CPY".
       COPY "LIBLP/PAYOFXW.CPY".
       COPY "LIBLP/LPWKPATH.CPY".
       COPY "LIBGB/SYSTEMW.CPY".
       COPY "LIBWI/PFSWINDOWSW.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/MESSWK.CPY".
       COPY "LIBGB/GETENVW.CPY".
       COPY "LIBGB/GPENVW.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBLP/LPUPERW.CPY".
       COPY "LIBLP/LPUPWKW.CPY".
       COPY "LIBLP/UPERTSTW.CPY".
       COPY "LIBLP/LPANTIW.CPY".
       COPY "LIBLP/LPMENUW.CPY".
       COPY "LIBLP/LPWKCIP.CPY".
       COPY "LIBLP/LPWKCEP.CPY".
       COPY "LIBLP/LPWKCOP.CPY".
       COPY "LIBGB/GRWORKW.CPY".
       COPY "LIBLP/LPAMTSW.CPY".
       COPY "LIBLP/LPSPEDW.CPY".
       COPY "LIBCL/FINDLNW.CPY".
       COPY "LIBLP/LPBAGEW.CPY".
       COPY "LIBLP/RESCINDW.CPY".
       COPY "LIBWI/LNAPPROVALW.CPY".

       COPY "LIBWI/FEEENTW.CPY".
       COPY "LIBWI/SCHG33W.CPY".
       COPY "LIBWI/LNSCN2W.CPY".
       COPY "LIBWI/LNSCANW.CPY".
       COPY "LIBWI/ELSCANW.CPY".
       01  WINDOW-WORKERS.
           03  WINDOW-LPO          PIC X(4).
           03  WINDOW-REP          PIC X(8).
           03  WINDOW-PROCESS      PIC X(1).
       COPY "LIBWI/LCSCANW.CPY".
       COPY "LIBWI/PDSCANW.CPY".
       COPY "LIBWI/SCSCANW.CPY".
       COPY "LIBWI/BLINPCW.CPY".
       COPY "LIBWI/CLSCANW.CPY".
       COPY "LIBWI/BWCREAW.CPY".
       COPY "LIBWI/BWSCANW.CPY".
       COPY "LIBWI/CDSCANW.CPY".
       COPY "LIBWI/CDBSCNW.CPY".
       COPY "LIBLP/LPAPRZW.CPY".
       COPY "LIBWI/AUTOPCW.CPY".
       COPY "LIBWI/LTCREAW.CPY".
       COPY "LIBWI/DLSCANW.CPY".
       COPY "LIBLP/INSELIGW.CPY".
       COPY "LIBLP/RNFOR10W.CPY".
       COPY "LIBCL/BISCANW.CPY".
       COPY "LIBCL/BICLASW.CPY".
       COPY "LIBWI/PPCOVRW.CPY".
       COPY "LIBWI/W12EQ2W.CPY".

      *
      * PLEASE BE AWARE THAT VERIFY-PASSWD USES "XONPC0" AS THE BASE,
      * SO THESE PASSWD SEQUENCES MUST MATCH XONPC0 !!!!!!!
      *
       COPY "LIBGB/PASSWDW.CPY".
       78  CAN-SEQ             VALUE 00.
       78  1STPY30-SEQ         VALUE 01.
       78  APPROVAL-SEQ        VALUE 02.
       78  APR-SEQ             VALUE 03.
       78  OVER-SEQ            VALUE 04.
       78  APPROVAL-SEQ2       VALUE 05.
       78  INSCO-SEQ           VALUE 06.
       78  CL-AH-PP-O1-SEQ     VALUE 12.
      *  PASSWORD SPECIFIC CLASS RENEWALS FOR REGENCY
       78  SRCD-SEQ            VALUE 20.
       78  PP-PREM-SEQ         VALUE 21.
       78  CITY-COUNTY-TAX-SEQ VALUE 24.
       78  COSIGNER-3-AND-4-SEQ VALUE 25.
       78  BW-BDATE-0-SEQ       VALUE 26.
       78  O2-SEQ               VALUE 27.


 
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBGB/HELPLINK.CPY".
       COPY "LIBGB/SCREENW.CPY".
       COPY "LIBLP/ZONPC_DEF.CPY".
       COPY "LIBLP/LPSMNU_DEF.CPY".
       COPY "LIBLP/LPLNMU_DEF.CPY".
       COPY "LIBLP/LPCAMU_DEF.CPY".
       COPY "LIBLP/LPVDMU_DEF.CPY".
       COPY "LIBWI/GLIMI2_DEF.CPY".
       COPY "LIBWI/GLIMI3_DEF.CPY".
       COPY "LIBWI/FEEENT_DEF.CPY".
       COPY "LIBLP/ZONPC_WKS.CPY".
       COPY "LIBLP/LPSMNU_WKS.CPY".
       COPY "LIBLP/LPLNMU_WKS.CPY".
       COPY "LIBLP/LPCAMU_WKS.CPY".
       COPY "LIBLP/LPVDMU_WKS.CPY".
       COPY "LIBWI/GLIMI2_WKS.CPY".
       COPY "LIBWI/GLIMI3_WKS.CPY".
       COPY "LIBWI/FEEENT_WKS.CPY".

       COPY "LIBGB/GETFMW.CPY".
       COPY "LIBLP/LPLOANW.CPY".
       COPY "LIBLP/LPPFBUF.CPY".

       SCREEN SECTION.
       COPY "LIBLP/ZONPC_SCN.CPY".
       COPY "LIBLP/LPSMNU_SCN.CPY".
       COPY "LIBLP/LPLNMU_SCN.CPY".
       COPY "LIBLP/LPCAMU_SCN.CPY".
       COPY "LIBLP/LPVDMU_SCN.CPY".
       COPY "LIBWI/GLIMI2_SCN.CPY".
       COPY "LIBWI/GLIMI3_SCN.CPY".
       COPY "LIBWI/FEEENT_SCN.CPY".

       PROCEDURE DIVISION
            USING FORM-PATHNAME EXIT-PATHNAME PROG-BUF UPDATE-BUF.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
               WK-FILE.
       COPY "LIBGB/DECLARE.CPY".
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-PD2-FILE.
           PERFORM CLOSE-PD1-FILE.
           PERFORM CLOSE-PC2-FILE.
           PERFORM CLOSE-PC1-FILE.
           PERFORM CLOSE-LTC1-FILE.
           PERFORM CLOSE-LC1-FILE.
           PERFORM CLOSE-IC1-FILE.
           PERFORM CLOSE-DL1-FILE.
           PERFORM CLOSE-CL1-FILE.
           PERFORM CLOSE-CDB1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-GI1-FILE.
           PERFORM CLOSE-GR1-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-BR-FILE.
           CLOSE WK-FILE.
      *    CALL XFER USING STAT PROG-LIST PROG-BUF.
      *    CALL XFER USING STAT LONPC2-LIST LONPC2-BUF.
      *    CALL XFER USING STAT ASSIGN-RN-ACCTNO-LIST
      *                         ASSIGN-RN-ACCTNO-FG.
       COPY "LIBGB/DECLAR2.CPY".

      ***********************************
      *   C O N T R O L   M O D U L E   *
      ***********************************
       A00-MAIN-PROGRAM SECTION.

           PERFORM SQL-CONNECT.

      D    STOP MESS.
           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "ZONPC" TO VDU-FORM-NAME.

           MOVE USER-PID TO TEMP-PID.
           MOVE " " TO ERRCD.

      * CLEARED FOR 'SC' TEST ON RENEWALS FOR LESS THAN 10%:
           MOVE " " TO SCHG18-UPDATE-FG.

           MOVE BRANCH TO BR-NO.
           PERFORM GET-BR.

           PERFORM GET-GPENV.

           PERFORM ESTABLISH-CLFILE-INDEX-BY.


           PERFORM X00-RESTORE-SCREEN.
           PERFORM X01-CREATE-TRAILER.

           IF ROUTE-CD = "1"
              MOVE " " TO ROUTE-CD
              MOVE 2 TO NEW-FLAG
              PERFORM TEST-GET-SP
              GO TO A00-ENTER-LOAN.
           IF NEW-FLAG = 1
              PERFORM B90-DISPLAY-FIELDS
              PERFORM TEST-GET-SP
              GO TO A00-ENTER-LOAN.

       A00-MAIN-MODULE.

           MOVE SPACES TO WS-APPROVAL-FG.

      * MUST CLEAR/RESET THESE FIELDS WHICH ARE PASSED TO THE CALCZL
      * TO DETERMINE KY SALES TAX. PROBLEM WITH CAN LOAN'S QUOTES
      * WHICH INITIALLY DON'T HAVE BORROWERS.

           MOVE " " TO BW-1-INFO.

           MOVE " " TO CAN-LOAN-NO.
           MOVE " " TO LOAN-RECALL-FG.

      * CLEAR REQUIRED RE: (GA) SP-SCFRMLA = 12 OR 13 OR 54
           MOVE 0 TO SPDUAL-LIAB.

           PERFORM FORM-RESET.

           MOVE " " TO MESS.
           PERFORM MSG-LINE.

           IF BR-LC-CODE = "Y"
              MOVE " " TO CHFG(43)
              MOVE "43 LC CODE     :__" TO LC-INFO-BUF
           ELSE
              MOVE "N" TO CHFG(43)
              MOVE " " TO LC-INFO-BUF.
           MOVE LC-INFO-BUF TO WR-BUF.
           MOVE LC-INFO-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           PERFORM B00-ENTER-KEYS.
           IF IO-TYPE = "CLR"
              GO TO A00-MAIN-MODULE.
           IF IO-TYPE = "END"
              GO TO END-ROUTINE.

       A00-ENTER-LOAN.
           PERFORM C00-ENTRY-MODULE.
           IF IO-TYPE = "END"
              GO TO END-ROUTINE.
           GO TO A00-MAIN-MODULE.


      *************************************************
       B00-ENTER-KEYS SECTION.
      *************************************************

           MOVE 0 TO NEW-FLAG
                     ELE.
           MOVE " " TO IO-TYPE
                       FIND-LOANS-FG.
           PERFORM B80-NEW-RECORD-SETUP.

           IF BR-CAN-LOANS-FG NOT = "N"
              PERFORM B01-RECALL-LOAN
              IF IO-TYPE = "ENT"
                 PERFORM LOAN-CLASS-PROMPT
                 GO TO B00-ENTER-LC-CODE
              ELSE
                 IF IO-TYPE = "KEY"
                    GO TO B00-MENU-KEY
                 ELSE
                    GO TO B00-EXIT
           ELSE
              PERFORM LOAN-CLASS-PROMPT.

       B00-ENTER-LC-CODE.

           MOVE "F1-RECALL,F3-LOANS,F4-QUOTE,F5-APPS,F6-SCAN,F7-MENU"
                                                            TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "EN N090LNKEY." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              PERFORM ALARM
              PERFORM B01-RECALL-LOAN
              IF IO-TYPE = "ENT"
                 PERFORM LOAN-CLASS-PROMPT
                 GO TO B00-ENTER-LC-CODE
              ELSE
                 IF IO-TYPE = "KEY"
                    GO TO B00-MENU-KEY
                 ELSE
                    GO TO B00-EXIT.

           IF VDUSTATUS = "1>"
              GO TO B00-MENU-KEY.
           IF VDUSTATUS = "18"
              MOVE "Q" TO PDSCAN-ID
              PERFORM QUOTE-SCAN
              IF IO-FG NOT = 0
                 GO TO B00-ENTER-LC-CODE
              ELSE
                 PERFORM B03-VIA-QUOTE-SCAN
                 IF IO-TYPE = "GET"
                    GO TO B00-ENTER-LC-CODE
                 ELSE
                    GO TO B00-EXIT.
           IF VDUSTATUS = "16"
              PERFORM LOAN-SCAN
              IF IO-FG NOT = 0
                 GO TO B00-ENTER-LC-CODE
              ELSE
                 PERFORM B02-VIA-LOAN-SCAN
                 IF IO-TYPE = "GET"
                    GO TO B00-ENTER-LC-CODE
                 ELSE
                    GO TO B00-EXIT.

           IF VDUSTATUS = "1<"
              PERFORM CLASS-SCAN
              IF IO-FG NOT = 0
                 GO TO B00-ENTER-LC-CODE.
           IF VDUSTATUS NOT = "00"
              GO TO B00-ENTER-LC-CODE.
           IF VDUNUM0 = 0 OR > 99
              GO TO B00-ENTER-LC-CODE.
           MOVE VDUNUM0 TO LC-CODE HOLD-MA-CLASS.
           PERFORM GET-LC.

           IF IO-FG = 9
              PERFORM NOT-FOUND
              GO TO B00-ENTER-LC-CODE.

           MOVE "S  A000LCDESC." TO VDU.
           MOVE LC-DESC TO VDUBUF.
           PERFORM SCREENIO.

           IF ( LC-SALEFIN = "Y"   )
              PERFORM NOT-DIRECT
              GO TO B00-ENTER-LC-CODE.

           IF LC-GIFTNET = "Y"
              MOVE "WCBC CLASSES ARE NOT ALLOWED" TO MESS
              PERFORM SEND-MESS
              GO TO B00-ENTER-LC-CODE.

           MOVE BRANCH TO GI-BRANCH.
           MOVE LC-CODE TO GI-CLASS.
           PERFORM GET-GI.
           IF IO-FG = 9
              MOVE "G/L INTERFACE RECORD NOT FOUND" TO MESS
              PERFORM SEND-MESS
              GO TO B00-ENTER-LC-CODE.

           MOVE LC-CODE     TO PD-CLASS
                               PD-SPRCLASS.
           MOVE LC-SMALLOAN TO PD-SMALLOAN.
           MOVE LC-SALEFIN  TO PD-SALEFIN.
           MOVE LC-SERVACCT TO PD-SERVACCT.
           MOVE LC-LOANTYPE TO PD-LOANTYPE.
           MOVE LC-GIFTNET  TO PD-GIFTNET.
           MOVE 1 TO PD-STMT-COUNTER.
           GO TO B00-EXIT.

      * END KEY ENTRY:
       B00-MENU-KEY.
           DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN.
           DESTROY ZONPC-SCREEN.

           PERFORM MENU-SELECTION.
           MOVE 0 TO ELE.
           PERFORM X03-SAVE-SCREEN.
           IF MENU-FG = 99
              GO TO B00-ENTER-KEYS.
           MOVE "END" TO IO-TYPE.

       B00-EXIT.
           EXIT.

      *****************************************
       B01-RECALL-LOAN SECTION.
      *****************************************
       B01-GET-KEY.

           MOVE " " TO IO-TYPE.
           IF BR-CAN-LOANS-FG = "O"
              MOVE LEGEND-01-CAN-ONLY TO LEGEND
           ELSE
              IF BR-CAN-LOANS-FG = "N"
                 MOVE LEGEND-01-NO-CAN TO LEGEND
              ELSE
                 MOVE LEGEND-01 TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "S  A110KEYTYPE:S." TO VDU.
           MOVE "RECALL NO#:" TO VDUBUF.
           PERFORM SCREENIO.

           MOVE " " TO CAN-LOAN-NO.
           MOVE " " TO PD2-BWNAME.
           MOVE "E  A020LNKEY." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              IF BR-CAN-LOANS-FG = "Y"
                 IF ALLOW-NON-CANS NOT = "Y"
                    MOVE CAN-SEQ TO PASSWDW-SEQ
                    MOVE "TO ALLOW 'NON' CAN LOANS....:"
                                         TO PASSWDW-PROMPT2
                    PERFORM VERIFY-PASSWORD
                    IF PASSWDW-STAT NOT = "OK"
                       GO TO B01-GET-KEY
                    ELSE
                       MOVE "Y" TO ALLOW-NON-CANS.
           IF VDUSTATUS = "10"
              IF BR-CAN-LOANS-FG NOT = "O"
                 PERFORM ALARM
                 MOVE "ENT" TO IO-TYPE
                 GO TO B01-EXIT.
           IF VDUSTATUS = "1>"
              MOVE "KEY" TO IO-TYPE
              GO TO B01-EXIT.
           IF VDUSTATUS = "16"
              PERFORM LOAN-SCAN
              IF IO-FG NOT = 0
                 GO TO B01-GET-KEY
              ELSE
                 PERFORM B02-VIA-LOAN-SCAN
                 IF IO-TYPE = "GET"
                    GO TO B01-GET-KEY
                 ELSE
                    GO TO B01-EXIT.
           IF VDUSTATUS = "18"
              MOVE "Q" TO PDSCAN-ID
              PERFORM QUOTE-SCAN
              IF IO-FG NOT = 0
                 GO TO B01-GET-KEY
              ELSE
                 PERFORM B03-VIA-QUOTE-SCAN
                 IF IO-TYPE = "GET"
                    GO TO B01-GET-KEY
                 ELSE
                    GO TO B01-EXIT.
           IF VDUSTATUS = "12"
              IF BR-CAN-LOANS-FG NOT = "N"
                 PERFORM CAN-LOAN-SCAN
                 IF IO-FG NOT = 0
                    GO TO B01-GET-KEY
                 ELSE
                    MOVE CLSCAN-CAN-NO TO CAN-LOAN-NO
                    PERFORM B04-VIA-CAN-LOAN-SCAN
                    IF IO-TYPE = "GET"
                       GO TO B01-GET-KEY
                    ELSE
                       GO TO B01-EXIT.
           IF VDUSTATUS NOT = "00"
              GO TO B01-GET-KEY.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 9
               MOVE VDUTAB(SUB) TO HOLD-9X(SUB)
               IF SUB < 3
                  MOVE VDUTAB(SUB) TO HOLD-2X(SUB)
               ELSE
                  SUBTRACT 2 FROM SUB GIVING SUB2
                  MOVE VDUTAB(SUB) TO HOLD-7X(SUB2)
               END-IF
           END-PERFORM.

      * TEST FOR FULL 9 DIGIT SSNO ENTERED:
           IF HOLD-9 NUMERIC
              MOVE HOLD-9 TO HOLD-RECALL-SSNO
              PERFORM B02-VIA-LOAN-SCAN
              IF IO-TYPE = "GET"
                 GO TO B01-GET-KEY
              ELSE
                 GO TO B01-EXIT.

      * TEST FOR TWO DIGIT & ALL SPACES,  CAN LOAN NUMBER ENTERED:
           IF BR-CAN-LOANS-FG NOT = "N"
              IF HOLD-7 NOT = " "
                 GO TO B01-GET-KEY
              END-IF
              MOVE SPACES TO PDSCAN-BWNAME
              MOVE HOLD-2 TO CAN-LOAN-NO
              PERFORM B04-VIA-CAN-LOAN-SCAN
              IF IO-TYPE = "GET"
                 GO TO B01-GET-KEY
              END-IF
           ELSE
              GO TO B01-GET-KEY.

       B01-EXIT.
           EXIT.

      **************************************
       B02-VIA-LOAN-SCAN SECTION.
      **************************************
           PERFORM B80-NEW-RECORD-SETUP.
           MOVE " " TO IO-TYPE.

      * LOOK FOR SCRATCH SAVED F3 COLLATERAL RECORD
           MOVE "C"              TO PC-ID.
           MOVE BRANCH           TO PC-BRANCH.
           MOVE HOLD-RECALL-SSNO TO PC-SOC-SEC.
           PERFORM OPEN-PC1-FILE.
           PERFORM READ-PC1-FILE.
           PERFORM CLOSE-PC1-FILE.
           IF IO-FG = 0
              MOVE "Y" TO F3-COLLATERAL
              PERFORM RECALL-COLLATERAL.

           MOVE "L" TO PD-ID.
           MOVE BRANCH TO PD-BRANCH.
           MOVE HOLD-RECALL-SSNO TO PD-SOC-SEC.
           PERFORM GET-PD1.
           IF IO-FG = 9
              PERFORM NOT-FOUND
              MOVE "GET" TO IO-TYPE
              GO TO B02-EXIT.
           IF PD-CAN-LOAN-MAX NOT = 0
              MOVE "ZZ" TO CAN-LOAN-NO.

           PERFORM B90-DISPLAY-FIELDS.

      * CITIZENS TEST   ?????? WORLD A90
           MOVE CIP-CALCULATION-INPUT-AREA
                      TO COP-CALCULATION-OUTPUT-AREA.

           MOVE SPACES TO INSPECT-X.
           PERFORM X02-RESTORE-TRAILER-REC.
           PERFORM LOAN-CLASS-PROMPT.
           IF ( LC-SALEFIN = "Y"   )
              PERFORM NOT-DIRECT
              MOVE "CLR" TO IO-TYPE
              GO TO B02-EXIT.

           IF PRIOR-LOAN-NOT-VALID
              PERFORM SEND-PRIOR-MESS.

           IF ERROR-IN-PRIOR-LOAN
              MOVE 0 TO IO-FG
              PERFORM PRIOR-LN-ERROR-MSG.

           MOVE 2 TO NEW-FLAG.
           MOVE "SN N090LNKEY." TO VDU.
           MOVE PD-CLASS TO VDUNUM0.
           PERFORM SCREENIO.
           PERFORM GET-SP.

           PERFORM TEST-SP-EFF-EXP.
      *JTG IF IO-FG = 9                    WILL BE CAUGHT IN ATTEMPT TO UPDATE
      *JTG    MOVE "CLR" IO-TYPES
      *JTG    GO TO B02-EXIT.

      * THIS WILL DISPLAY ERROR MESSAGE ONLY. UPDATE WILL STOP THEM
           IF SP-RENEWAL-EDIT = "B" OR "C"
              PERFORM SRCD-VALIDATION.

           PERFORM VALID-INS-TYPES-ELIG.
           IF IO-FG = 0
              PERFORM D16-TEST-NC-ORIG-FEES.

           IF SP-SCFRMLA = 4 OR 12 OR 13 OR 16 OR 23 OR 29 OR 43
                             OR 45 OR 48 OR 49 OR 50 OR 52 OR 53
                             OR 54 OR 55 OR 56 OR 57 OR 58 OR 59
              PERFORM D17-TEST-FOR-GEORGIA-SCHG
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED.
      *       MOVE 0 TO CIP-NO-OF-TIMES-CALLED.

           IF SP-SCFRMLA = 63
              PERFORM TEST-FOR-WI-SCHG
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED.

           IF SP-SCFRMLA = 18 OR 42
              PERFORM D18-TEST-FOR-SC-SCHG
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED.
      *       MOVE 0 TO CIP-NO-OF-TIMES-CALLED.

           IF SP-MFFRMLA = 4
              PERFORM D18-TEST-FOR-MFEE
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED.

           PERFORM CALL-LOAN-CALCULATIONS.

           MOVE "X" TO WS-APPROVAL-FG.
           MOVE "L" TO LOAN-RECALL-FG.

       B02-EXIT.
           EXIT.

      **************************************
       B03-VIA-QUOTE-SCAN SECTION.
      **************************************
           PERFORM B80-NEW-RECORD-SETUP.
           MOVE " " TO IO-TYPE.
           MOVE "Q" TO QUOTE-ID-FG.
           MOVE " " TO PRIOR-LOAN-STAT
                       PASS-STAT-FG.

           PERFORM OPEN-PD1-FILE.

           MOVE SPACES        TO PD2-KEY.
           MOVE "Q"           TO PD2-ID
                                 SAVE-PD2-KEY-ID.
           MOVE BRANCH        TO PD2-BRANCH
                                 SAVE-PD2-KEY-BR.

      * IF YOU MOVE THE NAME IN, YOU WILL NOT EVER GET THE LAST RECORD FOR
      * SOME REASON, ON AZURE. IF "TOMMY TESTER" IS ONLY QUOTE, YOU CAN
      * SELECT IT IN SCAN WINDOW, BUT THEN GET RECORD NOT FOUND. NOW ADD
      * ANOTHER QUOTE "BETH", YOU CAN PULL UP BETH, BUT NOT TOMMY. YOU GET
      * IO-FG = 9. IF WE MOVE SPACES AND START, YOU WILL GET IT! BIZARRE
      * PROBLEM. SO I ADDED CHECKING THAT THE NAME MATCHES WHAT YOU SELECT.

      *    MOVE PDSCAN-BWNAME TO PD2-BWNAME.

           MOVE SPACES        TO PD2-BWNAME.

           PERFORM START-PD2-FILE.

       B03-VIA-QUOTE-SCAN-NEXT.
           PERFORM READ-PD2-FILE-NEXT.
           IF (IO-FG = 9) OR (PD2-ID NOT = "Q")
                           OR (PD2-BRANCH NOT = BRANCH)
              PERFORM NOT-FOUND
              PERFORM CLOSE-PD1-FILE
              MOVE "GET" TO IO-TYPE
              GO TO B03-EXIT.

           IF (PD2-BWNAME NOT = PDSCAN-BWNAME)
              GO TO B03-VIA-QUOTE-SCAN-NEXT.

           IF PD-CAN-LOAN-MAX NOT = 0
              MOVE "ZZ" TO CAN-LOAN-NO.

           IF PD-PRLNNO NOT = 0
              PERFORM CLOSE-PD1-FILE.

           MOVE PD-LOANDATE TO DATE-HOLDER.
           PERFORM B90-DISPLAY-FIELDS.

      * CITIZENS TEST
           MOVE CIP-CALCULATION-INPUT-AREA
                          TO COP-CALCULATION-OUTPUT-AREA.


           MOVE PD-SOC-SEC TO SAVE-QUOTE-SSN.
           MOVE "S  A330011." TO VDU.
           MOVE PD2-BWNAME TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A010012." TO VDU.
           MOVE PD-MAKERCD(1) TO VDUBUF.
           PERFORM SCREENIO.

      *??  MOVE PD2-KEY TO SAVE-PD2-KEY.
           PERFORM LOAN-CLASS-PROMPT.
           IF ( LC-SALEFIN = "Y"   )
              PERFORM NOT-DIRECT
              MOVE "CLR" TO IO-TYPE
              GO TO B03-EXIT.

           IF PRIOR-LOAN-NOT-VALID
              PERFORM SEND-PRIOR-MESS.

           IF ERROR-IN-PRIOR-LOAN
              MOVE 0 TO IO-FG
              PERFORM PRIOR-LN-ERROR-MSG.

           MOVE 2 TO NEW-FLAG.
           MOVE "SN N090LNKEY." TO VDU.
           MOVE PD-CLASS TO VDUNUM0.
           PERFORM SCREENIO.
           PERFORM GET-SP.
           PERFORM TEST-SP-EFF-EXP.

      * THIS WILL DISPLAY ERROR MESSAGE ONLY. UPDATE WILL STOP THEM
           IF SP-RENEWAL-EDIT = "B" OR "C"
              PERFORM SRCD-VALIDATION.

           PERFORM VALID-INS-TYPES-ELIG.
           IF DATE-HOLDER NOT = TRANS-DATE
                     OR SP-LAWCODE NOT = PD-LAWCODE
                      OR NOT PD-ONE-MTH-NO-DAY-EXT
                       OR PD-PRLNNO NOT = 0
              PERFORM D17-TEST-FOR-GEORGIA-SCHG
              PERFORM D18-TEST-FOR-SC-SCHG
              PERFORM TEST-FOR-WI-SCHG
              PERFORM D18-TEST-FOR-MFEE
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *       MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              PERFORM CALL-LOAN-CALCULATIONS.
           IF ERROR-IN-PRIOR-LOAN
              PERFORM PRIOR-LN-ERROR-MSG.

      * COLLATERAL:
           PERFORM OPEN-PC1-FILE.

           MOVE SPACES           TO PC2-KEY.

           MOVE BRANCH           TO PC2-BRANCH
                                    QPC2-WBEG-BRANCH
                                    QPC2-WEND-BRANCH.
           MOVE "C"              TO PC2-ID
                                    QPC2-WBEG-ID
                                    QPC2-WEND-ID.
           MOVE SAVE-PD2-KEY-NAM TO PC2-BWNAME
                                    QPC2-WBEG-BWNAME.
           MOVE ALL "Z"          TO QPC2-WEND-BWNAME.
          

           PERFORM START-PC2-FILE.
       B03-NEXT-COLLATERAL.
           PERFORM READ-PC2-FILE-NEXT.
           IF IO-FG = 9 OR (PC2-ID NOT = "C") OR
                           (PC2-BRANCH NOT = BRANCH) OR
                           (PC2-BWNAME NOT = SAVE-PD2-KEY-NAM)
              GO TO B03-EXIT.

           IF PC-LOANDATE NOT = DATE-HOLDER
                    OR PC-ORGTERM NOT = PD-ORGTERM
                     OR PC-REGPYAMT NOT = PD-REGPYAMT
              GO TO B03-NEXT-COLLATERAL.

           MOVE "Y" TO F3-COLLATERAL.
           PERFORM RECALL-COLLATERAL.

       B03-EXIT.
           PERFORM CLOSE-PC1-FILE.
           PERFORM CLOSE-PD1-FILE.

      **************************************
       B04-VIA-CAN-LOAN-SCAN SECTION.
      **************************************
           PERFORM OPEN-CL1-FILE.
           PERFORM SET-CLFILE-INDEX-BY.
           MOVE CAN-LOAN-NO TO CL-CAN-NO.
           PERFORM READ-CL1-FILE.
           PERFORM CLOSE-CL1-FILE.
           IF IO-FG = 9
              PERFORM NOT-FOUND
              MOVE "GET" TO IO-TYPE
              GO TO B04-EXIT.

           IF CL-GIFTNET = "Y"
              MOVE "THIS ORDER HAS NOT BEEN SENT TO WCBC" TO MESS
              PERFORM SEND-MESS
              MOVE "GET" TO IO-TYPE
              GO TO B04-EXIT.

           PERFORM B80-NEW-RECORD-SETUP.
           MOVE CL-PD-REC TO PD-REC.

      * CHECK 'CL' FOR ANY 'SPR' CHANGES
      
           PERFORM GET-SP.
           IF ( IO-BAD )
              MOVE "GET" TO IO-TYPE
              GO TO B04-EXIT.

           IF ( SP-CAN-LOANS-NO )
              MOVE MESSAGE-INVALID-SPR-CAN-LOAN TO MESS
              PERFORM SEND-MESS
              MOVE "GET" TO IO-TYPE
              GO TO B04-EXIT.

      * VERIFY THAT ALL THE FEECODES WITHIN THE CAN LOAN
      * EXIST FOR THE POSTING BRANCH
      
           MOVE 0 TO IO-FG.
           PERFORM VARYING SUB FROM 1 BY 1
                   UNTIL (SUB > 10 OR IO-FG = 9)
              IF PD-FEECODE(SUB) NOT = " "
                 MOVE PD-FEECODE(SUB) TO CDB-CODE
                 PERFORM GET-CODE
              END-IF
           END-PERFORM.
           IF IO-FG = 9
              PERFORM MISSING-FEECODE
              MOVE "GET" TO IO-TYPE
              GO TO B04-EXIT.
      *----------------------------------------------------

           MOVE BRANCH TO PD2-BRANCH
                          PD-BRANCH
                          PD-POSTING-BR
                          PD-OWNBR
                          PD-ORGBR.

           MOVE " " TO IO-TYPE.

           MOVE SPACES TO PD2-KEY.
           MOVE "Q"    TO QUOTE-ID-FG
                          PD2-ID
                          SAVE-PD2-KEY-ID.
           MOVE PD2-BRANCH TO SAVE-PD2-KEY-BR.
           MOVE " " TO PD2-BWNAME.

           MOVE CAN-LOAN-NO TO PD-CAN-LOAN-NO.

           MOVE " " TO PRIOR-LOAN-STAT
                       PASS-STAT-FG.
           MOVE PD-PROCEEDS TO PD-CAN-LOAN-MAX.

           MOVE PD-LOANDATE TO DATE-HOLDER.
           PERFORM B90-DISPLAY-FIELDS.

           MOVE "S  A330011." TO VDU.
           MOVE CL-DESC TO VDUBUF.
           PERFORM SCREENIO.

           PERFORM LOAN-CLASS-PROMPT.
           IF ( LC-SALEFIN = "Y"   ) 
              PERFORM NOT-DIRECT
              MOVE "CLR" TO IO-TYPE
              GO TO B04-EXIT.

           IF PRIOR-LOAN-NOT-VALID
              PERFORM SEND-PRIOR-MESS.

           IF ERROR-IN-PRIOR-LOAN
              MOVE 0 TO IO-FG
              PERFORM PRIOR-LN-ERROR-MSG.

           MOVE 2 TO NEW-FLAG.
           MOVE "SN N090LNKEY." TO VDU.
           MOVE PD-CLASS TO VDUNUM0.
           PERFORM SCREENIO.
           PERFORM GET-SP.

           PERFORM TEST-SP-EFF-EXP.
      *JTG IF IO-FG = 9
      *JTG    MOVE "CLR" TO IO-TYPE         WILL BE CAUGHT IN ATTEMPT TO UPDATE
      *JTG    GO TO B04-EXIT.

      * THIS WILL DISPLAY ERROR MESSAGE ONLY. UPDATE WILL STOP THEM
           IF SP-RENEWAL-EDIT = "B" OR "C"
              PERFORM SRCD-VALIDATION.

           PERFORM VALID-INS-TYPES-ELIG.
           IF DATE-HOLDER NOT = TRANS-DATE
                     OR SP-LAWCODE NOT = PD-LAWCODE
                      OR NOT PD-ONE-MTH-NO-DAY-EXT
              PERFORM D17-TEST-FOR-GEORGIA-SCHG
              PERFORM D18-TEST-FOR-SC-SCHG
              PERFORM TEST-FOR-WI-SCHG
              PERFORM D18-TEST-FOR-MFEE
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
              PERFORM CALL-LOAN-CALCULATIONS.
      *------------------------------------------------
           IF ERROR-IN-PRIOR-LOAN
              PERFORM PRIOR-LN-ERROR-MSG.

           IF (GP-ENTER-LPO-FG = "Y")
              MOVE PD-LPO TO WINDOW-LPO
              MOVE PD-REP-CD TO WINDOW-REP
              MOVE PD-PROCESS-CD TO WINDOW-PROCESS
              MOVE "WI/TFCCDS" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH WINDOW-WORKERS
              CANCEL FORM-PROGX
              MOVE WINDOW-LPO TO PD-LPO
              MOVE WINDOW-REP TO PD-REP-CD
              MOVE WINDOW-PROCESS TO PD-PROCESS-CD.

       B04-EXIT.
           EXIT.

      *********************************
       B80-NEW-RECORD-SETUP SECTION.
      *********************************
           MOVE 1 TO NEW-FLAG.

           PERFORM CLEAR-PD-FILE.

      * CANT BE IN COPY MEMBER BECAUSE THESE ARE IN REDEFINE OF
      * FREE TYPE WHICH MUST BE SPACES IN "LONPB0"

           MOVE 0 TO PD-PRPAID-AHEAD PD-DUAL-LOAN-ADJ.
           MOVE " " TO DISPLAY-BUF1
                        SCREEN-LINES
                         PD2-KEY
                          SAVE-PD2-KEY
                           PRIOR-LOAN-STAT
                             PASS-STAT-FG
                              NEW-PD-RECORD-FG.


           MOVE TRANS-DATE TO PD-LOANDATE
                              DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO DEF-LOANDATE.

           MOVE BR-STATE TO DEF-ORGST
                            PD-ORGST
                            PD-OWNST.
           MOVE BRANCH TO DEF-ORGBR
                          PD-ORGBR
                          PD-OWNBR.

           IF BR-DEFAULT-LN-PURCD = " "
              MOVE "___" TO DEF-PURCD
              MOVE " " TO CHFG(7)
           ELSE
              MOVE "PU"                TO CD-TYPE
              MOVE "N" TO CHFG(7)
              MOVE BR-DEFAULT-LN-PURCD TO DEF-PURCD
                                          PD-PURCD
                                          CD-CODE
              MOVE 7 TO ELE
              PERFORM SEND-CD-DESC
              IF IO-FG = 9
                 MOVE " " TO CHFG(7).


      * IF I DONT DO WEEKLY/BIWEEKLY
           IF BR-UNITPER-FG NOT = "Y"
              MOVE "M" TO BR-DEFAULT-LN-UNITPER-CD
              MOVE BR-DEFAULT-LN-UNITPER-CD TO DEF-UNITPER-CD
                                               PD-UNITPER-CD
           ELSE
              IF BR-DEFAULT-LN-UNITPER-CD = " "
                 MOVE "_" TO DEF-UNITPER-CD
              ELSE
                 IF NOT (BR-DEFAULT-LN-UNITPER-CD = "M"
                                                  OR "W"
                                                   OR "B"
                                                    OR "S")
                    MOVE "M" TO BR-DEFAULT-LN-UNITPER-CD
                    MOVE BR-DEFAULT-LN-UNITPER-CD TO DEF-UNITPER-CD
                                                     PD-UNITPER-CD
                 ELSE
                    MOVE BR-DEFAULT-LN-UNITPER-CD TO DEF-UNITPER-CD
                                                     PD-UNITPER-CD.

           MOVE 1 TO DEF-UNITPER-FREQ
                     PD-UNITPER-FREQ.
           MOVE "B" TO DEF-BALLBL
                       PD-BALLOON-LAST-FG.

           MOVE DEF-BUF TO WR-BUF.
           MOVE DEF-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           IF BR-STOP-ON-COLL = "Y"
              MOVE P230-BUF TO WR-BUF
              MOVE P230-LIST TO WR-LIST
              PERFORM CALL-WRFORM.

           MOVE 0 TO PD-LASTPYAMT.
           MOVE "I" TO PD-BALLOON-FG.
           MOVE "N" TO CHFG(10).

           MOVE 999.99 TO PD-SERVPER.
           MOVE 9999.99 TO PD-DLNO.
           MOVE 999.999 TO PD-ENDORATE
                           PD-OVRDRATE.

           MOVE "C" TO PD-OVRDRATE-FG
                       PD-INS-FG(1)
                       PD-INS-FG(2)
                       PD-INS-FG(3)
                       PD-INS-FG(4)
                       PD-SERCHG-FG
                       PD-MAINTFEE-FG
                       PD-EXTCHG-FG
                       PD-REGPYAMT-FG
                       PD-DLRVPRIN-FG(1)
                       PD-DLRVPRIN-FG(2)
                       PD-DLRVPRIN-FG(3)
                       PD-DLRVCHGS-FG(1)
                       PD-DLRVCHGS-FG(2)
                       PD-DLRVCHGS-FG(3)
                       PD-DLPARVHELD-FG
                       PD-DLPARVPAID-FG
                       PD-DLDISC-FG.
           MOVE 0 TO TOTAL-GL-HLDR
                     TOTAL-GL-HLDR-SALESTAX
                     TOTAL-GL-FINCHG-HLDR
                     TOTAL-GL-FINCHG-HLDR-SALESTAX
                     TERM-LOW
                     TERM-HIGH
                     PROCEEDS-LOW
                     PROCEEDS-HIGH
                     POINTS-LOW
                     POINTS-HIGH
                     PRIOR-LNAMT.

           MOVE " " TO QUOTE-ID-FG.
           MOVE "N" TO STAT.
           MOVE "Y" TO DEFAULT-APR-FG.
           PERFORM PROTECT-FIELDS.
           MOVE 9999.99 TO PD-DLNO
                           DL-DLNO.
           PERFORM GET-DL1.
           IF BR-LC-CODE = "Y"
              MOVE "SNNN020430." TO VDU
              MOVE DL-LC-CODE TO VDUNUM0
                                 PD-LC-CODE
              PERFORM SCREENIO.
           MOVE 0 TO ELE
                     PRIOR-LNAMT
                     PD-CAN-LOAN-MAX.
           MOVE CAN-LOAN-NO TO PD-CAN-LOAN-NO.
           PERFORM CLEAR-CALC-AREA-Z3.

      * ADDED THE SET OF CIP-RETURN-CODE TO 'A', SO IF A SAVED LOAN OR QUOTE
      * IS RECALLED AND IT DOES NOT REQUIRE A RECALCULATION IT CAN BE SAVED
      * OR UPDATED: JTG 990210
           MOVE "A" TO CIP-RETURN-CODE.

           PERFORM X01-CREATE-TRAILER.


      *************************************************
      *   ENTRY-MODULE
      *   NEW-FLAG = 0 - MODIFY EXISTING RECORD
      *              1 - INITIAL NEW RECORD ENTRY
      *              2 - MODIFY NEW RECORD
      *************************************************
       C00-ENTRY-MODULE SECTION.
      *************************************************

           MOVE "S  A000MSEL." TO VDU.
           PERFORM SCREENIO.
           MOVE " " TO IO-TYPE.
           MOVE 1 TO ONE.
           MOVE FIRST-ELE TO ELE.
           MOVE 0 TO FIRST-ELE.

           IF CAN-LOAN-NO NOT = " "
              IF PD-GIFTNET NOT = "Y"
                 PERFORM FORCE-CAN-LOAN-NUMBERS.
           IF LOAN-RECALL-FG = " "
              IF CAN-LOAN-NO NOT = " "
                 MOVE "Y" TO INITIAL-CAN-ENTRY-FG
              ELSE
                 MOVE " " TO INITIAL-CAN-ENTRY-FG.

      *-------------------------------------------------------
       CREATE-ROUTINE.
           IF NEW-FLAG NOT = 1
              GO TO MODIFY-ROUTINE.

           ADD ONE TO ELE.
           IF ELE < 1
              MOVE 1 TO ELE ONE.
           IF ELE NOT > MAX
              GO TO ENTER-ELE.

           MOVE 2 TO NEW-FLAG.
           PERFORM SETUP-CALC-AREA.
           PERFORM D17-TEST-FOR-GEORGIA-SCHG.
           PERFORM D18-TEST-FOR-SC-SCHG.
           PERFORM TEST-FOR-WI-SCHG.
           PERFORM D18-TEST-FOR-MFEE.
           PERFORM CALL-LOAN-CALCULATIONS.

      *-----------------------------------------------------------
       MODIFY-ROUTINE.
           IF INITIAL-CAN-ENTRY-FG = "Y"
              MOVE " " TO INITIAL-CAN-ENTRY-FG
              MOVE ZEROS TO CHKEY
              MOVE 1 TO ELE
              GO TO CAN-INITIAL-START.

           IF (BORR-CHG-FG = "Y" AND NOT QUOTE-ONLY)
               MOVE " " TO BORR-CHG-FG
               PERFORM D16-TEST-NC-ORIG-FEES
               PERFORM D17-TEST-FOR-GEORGIA-SCHG
               PERFORM D18-TEST-FOR-SC-SCHG
               PERFORM TEST-FOR-WI-SCHG
               PERFORM D18-TEST-FOR-MFEE
               PERFORM CALL-LOAN-CALCULATIONS.

           MOVE " " TO STAT.
           PERFORM UNPROTECT-FIELDS.

           IF PD-GIFTNET = "Y"
              MOVE "F4-MEMO, FIELD #, U-UPDATE:" TO LEGEND
           ELSE
              IF WS-APPROVAL-FG = " "
                 IF SP-PYEXFRMLA-SAME2-SPREAD
                    MOVE
                   "F4-MEMO,F5-SPREAD,FIELD #,DELETE,S-SAVE,U-UPDATE:"
                                                           TO LEGEND
                 ELSE
                    MOVE "F4-MEMO,FIELD #,DELETE,S-SAVE,U-UPDATE:"
                                                           TO LEGEND
              ELSE
                 IF SP-PYEXFRMLA-SAME2-SPREAD
                    MOVE
                   "F3-APPR,F4-MEMO,F5-SPREAD,FIELD #,DELETE,S,U-UPD:"
                                                            TO LEGEND
                 ELSE
                    MOVE
                   "F3-APPRVL,F4-MEMO,FIELD #,DELETE,S-SAVE,U-UPDATE:"
                                                            TO LEGEND.

           PERFORM SEND-LEGEND.
           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.

      * FOR F3 - APPROVAL OF A LOAN
      
           IF ( VDUSTATUS = "16" )
              IF NOT ( QUOTE-ONLY ) AND ( WS-APPROVAL-FG NOT = SPACES )
                 PERFORM APPROVAL-LIMIT-WINDOW
                 MOVE "ZONPC"      TO VDU-FORM-NAME
                 IF ( WS-APPROVAL-FG = "S" )
                    PERFORM D09-WRITE-SCRATCH
                    MOVE "CLR" TO IO-TYPE
                    GO TO ENTRY-MODULE-EXIT
                 ELSE
                 IF ( WS-APPROVAL-FG = "X" )
                    GO TO MODIFY-ROUTINE
                 ELSE
                    GO TO MODIFY-ROUTINE
              ELSE
                 GO TO MODIFY-ROUTINE.

           IF VDUSTATUS = "18"
              PERFORM D07-MEMO-ENTRY
              GO TO MODIFY-ROUTINE.

      * F5 - 1STPYEXT FORMULA 12 SPREAD WINDOW
      
           IF ( VDUSTATUS = "1:"          ) AND
              ( PD-GIFTNET NOT = "Y"      ) AND
              ( SP-PYEXFRMLA-SAME2-SPREAD )
                PERFORM W12EQ2-WINDOW
                GO TO MODIFY-ROUTINE.

           IF VDUSTATUS NOT = "00"
              GO TO MODIFY-ROUTINE.

           MOVE VDUBUF TO ACTION.
           IF ACTION = "DELETE"
              PERFORM D10-DELETE-SCRATCH
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.

           IF NOT ( ACTION = "     U"  OR  "     S")
              GO TO BYPASS-UPDATE.

           IF ACTION = "     S"
              IF PD-GIFTNET = "Y"
                 GO TO MODIFY-ROUTINE.
           IF ACTION = "     S" OR
              ACTION = "     U"
              IF NOT COP-CALCULATION-OK
                 PERFORM ERROR-IN-CALCULATIONS-MSG
                 GO TO MODIFY-ROUTINE
              ELSE
              IF NOT QUOTE-ONLY
                 PERFORM VERIFY-REQD-FLDS
                 IF IO-FG = 9
                    MOVE 0 TO IO-FG
                    GO TO MODIFY-ROUTINE
                 ELSE
                    IF PRIOR-LOAN-NOT-POSTED AND
                        NOT PD-POCD-INRESCISSION
                       MOVE "INITIATE RENEWAL IN TRANSACTION POSTING"
                         TO MESS
                       PERFORM SEND-MESS
                       GO TO MODIFY-ROUTINE.

           IF ACTION = "     S" OR
              ACTION = "     U"
              IF PRIOR-LOAN-NOT-VALID
                 PERFORM SEND-PRIOR-MESS
                 GO TO MODIFY-ROUTINE
              END-IF
              IF ERROR-IN-PRIOR-LOAN
                 PERFORM PRIOR-LN-ERROR-MSG
                 GO TO MODIFY-ROUTINE
              END-IF
              PERFORM TEST-SP-EFF-EXP
              IF IO-FG = 9
                 MOVE 0 TO IO-FG
                 GO TO MODIFY-ROUTINE
              END-IF
              IF NOT QUOTE-ONLY
                 PERFORM VERIFY-AGAINST-SPEDT
                 IF VALID-LOAN = "N"
                    GO TO MODIFY-ROUTINE.

           IF ACTION = "     S" OR "     U"
              IF SP-RENEWAL-EDIT = "B" OR "C"
                 PERFORM SRCD-VALIDATION
                 IF WS-SRCD-ERRCD NOT = 0
                    GO TO MODIFY-ROUTINE.

           IF ACTION = "     S"
                   OR ACTION = "     U"
              IF SCHG18-UPDATE-FG = "N"
                 MOVE "RENEWAL IS FOR LESS THAN 10% AND RESTRICTED"
                                                         TO MESS
                 PERFORM SEND-MESS
                 GO TO MODIFY-ROUTINE.

           IF ACTION = "     S" OR "     U"
              IF NOT QUOTE-ONLY
                 MOVE BW-1-INFO  TO SAVE-BW-1-INFO
                 MOVE PD-SSNO(1) TO BW-SSNO
                 PERFORM GET-BW1
                 PERFORM SET-CY-CT-SCAN
                 IF ALLOW-CITY-SCAN-FG = "Y" OR
                    ALLOW-CITY-SCAN-FG = "Y"
                    PERFORM VALIDATE-REQUIRED-FIELD
                    IF ALLOW-BW-UPDATE-FG NOT = "Y"
                       GO TO MODIFY-ROUTINE
                    ELSE
                       IF BW-1-INFO NOT = SAVE-BW-1-INFO
                          PERFORM CALL-LOAN-CALCULATIONS
                          IF ( NOT COP-CALCULATION-OK ) AND
                             ( PD-GIFTNET NOT = "Y"   )
                             PERFORM ERROR-IN-CALCULATIONS-MSG
                             GO TO MODIFY-ROUTINE
                          ELSE
                             MOVE "LOAN HAS CHANGED, PLEASE REVIEW!"
                                                             TO MESS
                             PERFORM SEND-MESS
                             GO TO MODIFY-ROUTINE.

           IF ACTION = "     S"
              PERFORM D09-WRITE-SCRATCH
              PERFORM REMOVE-QUOTE-IF-LOAN
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.

           IF NOT ( ACTION = "     U" )
              GO TO BYPASS-UPDATE.

      * DETERMINE IF GP-FORCE-INPUT-PP-COVERAGE = 'Y'   AND
      *              PD-INSTYPES-PP OR PD-INSTYPES-PP2  AND
      *              COP-COVERAGE-SW(3) NOT = 'C'
      *              THAN
      *              POP WINDOW AND ASK FOR (EXHIBIT A) PERSONAL PROPERTY VALUE
      *              SET CIP WITH NEW COVERAGE AND RECOMPUTE LOAN
      *              ASKING THE OPERATOR TO REVIEW THE LOAN SINCE
      *              "PP COVERAGE HAS CHANGED, PLEASE REVIEW!"
      *           NOTE:
      *                 WHEN (EXHIBIT A) ENTERED IS EQUAL OR GREATER
      *                 THAN COMPUTED, LOAN WILL BE UPDATED AS IS AND
      *                 NOT RECOMPUTED.
      
           IF ACTION = "     U"
              IF NOT QUOTE-ONLY
                 IF (GP-FORCE-INPUT-PP-COVERAGE = "Y" ) AND
                    (PD-INSTYPES-PP OR PD-INSTYPES-PP2) AND
                    (COP-COVERAGE-SW(3) NOT = "C"     )
                    MOVE PD-INSCOVR(3)    TO PPCOVR-COMPUTED
                    MOVE 0                TO PPCOVR-EXHIBIT-A
                    MOVE "WI/PPCOVR"  TO FORM-NAM
                    CALL FORM-PROGX USING FORM-PATH PPCOVR-WORKERS
                    CANCEL FORM-PROGX
                    IF PPCOVR-EXHIBIT-A < PD-INSCOVR(3)
                       MOVE PPCOVR-EXHIBIT-A TO PD-INSCOVR(3)
                                                CIP-INS-COVERAGE(3)
                       MOVE "I"              TO PD-INS-FG(3)
                                                CIP-INS-SW(3)
                       MOVE " "              TO PD-COVERAGE-SW(3)
                                                CIP-COVERAGE-SW(3)
                       PERFORM CALL-LOAN-CALCULATIONS
                       IF ( NOT COP-CALCULATION-OK ) AND
                          ( PD-GIFTNET NOT = "Y"   )
                          PERFORM ERROR-IN-CALCULATIONS-MSG
                          GO TO MODIFY-ROUTINE
                       ELSE
                          MOVE
                          "PP COVERAGE HAS CHANGED, PLEASE REVIEW!"
                                                            TO MESS
                          PERFORM SEND-MESS
                          GO TO MODIFY-ROUTINE.

      * CHECK IF PRIMARY BORROWER MEETS MINIMUM CREDIT SCORE
      
           MOVE BW-CREDIT-SCORE TO PD-CRSCORE.
           IF ACTION = "     U"
             IF NOT QUOTE-ONLY
               IF BR-CREDIT-SCORING-FG = "Y"
                 MOVE PD-SSNO(1) TO BW-SSNO
                 PERFORM GET-BW1
                 IF IO-BAD
                    MOVE 0 TO BW-CREDIT-SCORE
                 END-IF
                 IF BW-CREDIT-SCORE < SP-MIN-CREDIT-SCORE
                   IF BW-CREDIT-SCORE < PD-MIN-CRED-SCORE
                     IF ( PD-MIN-CRED-SCORE = 9999 )
                        MOVE MSG-SCORE-NEED-APPROVAL-04 TO MESS
                        PERFORM SEND-MESS
                        MOVE BW-CREDIT-SCORE TO MSG-BW-SCORE2
                        MOVE SP-MIN-CREDIT-SCORE TO MSG-SP-SCORE
                        MOVE MSG-SCORE-NEED-APPROVAL-05 TO MESS
                        PERFORM SEND-MESS
                        MOVE MSG-SCORE-NEED-APPROVAL-03 TO MESS
                        PERFORM SEND-MESS
                        GO TO MODIFY-ROUTINE
                     ELSE
                        MOVE MSG-SCORE-NEED-APPROVAL-01 TO MESS
                        PERFORM SEND-MESS
                        MOVE BW-CREDIT-SCORE TO MSG-BW-SCORE
                        MOVE PD-MIN-CRED-SCORE TO MSG-PD-SCORE
                        MOVE MSG-SCORE-NEED-APPROVAL-02 TO MESS
                        PERFORM SEND-MESS
                        MOVE MSG-SCORE-NEED-APPROVAL-03 TO MESS
                        PERFORM SEND-MESS
                        GO TO MODIFY-ROUTINE.

      * CHECK IF AMOUNT IS GREATER THAN APPROVAL LIMIT

           IF ( ACTION = "     U" )
              IF NOT ( QUOTE-ONLY )
                 PERFORM VERIFY-LOAN-APPROVAL
                 IF ( LNAPPROVAL-STATUS-UNAPPROVED )
                    GO TO MODIFY-ROUTINE.

           IF ACTION = "     U"
              IF NOT QUOTE-ONLY
                 PERFORM UPDATE-OVR-RATE
                 PERFORM D08-TEST-ALLOT-LBOX
                 IF IO-TYPE = "RTN"
                    MOVE SPACES TO IO-TYPE
                    GO TO MODIFY-ROUTINE
                 ELSE
                    PERFORM D06-ENTER-HI-CREDIT
                    IF IO-TYPE = "RTN"
                       MOVE SPACES TO IO-TYPE
                       GO TO MODIFY-ROUTINE
                    ELSE
                       PERFORM UPDATE-CONTINUE
                       IF ERRORS-EXIST = "Y"
                          MOVE SPACES TO IO-TYPE
                          GO TO MODIFY-ROUTINE
                       ELSE
                          GO TO ENTRY-MODULE-EXIT.

      *-----------------------------------------------------------------
       BYPASS-UPDATE.

           INSPECT ACTION REPLACING ALL " " BY "0".
           IF CHNO NOT NUMERIC
              GO TO MODIFY-ROUTINE.
           IF CHNO = 0
              GO TO MODIFY-ROUTINE.
           IF CHNO > MAX
              GO TO MODIFY-ROUTINE.
           MOVE CHNO TO ELE.

           IF ELE = 26
              IF SP-CAL-FLAT-MONTHLY(1)
                 MOVE "FLATMONTHLY_OVR" TO GETENV-BUF
                 PERFORM GETENV-CALL
                 IF STAT NOT = "00"
                    MOVE
                    "RATE OVERRIDES NOT ALLOWED WITH FLAT MONTHLY"
                                                           TO MESS
                 PERFORM SEND-MESS
                 GO TO MODIFY-ROUTINE.
       CAN-INITIAL-START.
      *    IF ELE NOT = 18, LNQUOT
              MOVE "Y" TO DEFAULT-APR-FG.

      * JTG 990402 UNSTARED SINCE I CHANGED F-08 TO HANDLE SITUATION BELOW
      * TO CHANGE THE COLLATERAL CODE, BECAUSE IF THEY TAKE IT OUT OF
      * RESCISSION, THE PB PRIOR ACCOUNT NUMBER WILL STILL BE THERE AND
      * IS NOT PAID OUT !!!
      *    IF PD-POCD-INRESCISSION
      *       IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
      *          IF ELE = 9
      *             GO TO MODIFY-ROUTINE.

           IF CAN-LOAN-NO NOT = " "
              IF NOT (ELE = 1  OR  2 OR  3 OR  4 OR  7 OR  8 OR  9
                         OR 10 OR 11 OR 18 OR 19 OR 20 OR 21 OR 23
                         OR 27 OR 28 OR 29 OR 30 OR 31 OR 32)
                 GO TO MODIFY-ROUTINE
              ELSE
                 NEXT SENTENCE
           ELSE
      *       ----------------------------------------------------------
      *       PASSWORD ON CL,AH,PP,01,MAINT FEE, 1ST PY EXT, EXT LC INFO
      *       ----------------------------------------------------------
              IF ELE = 27 OR 28 OR 29 OR 30 OR 35 OR 36 OR 43
                 IF OVERRIDES-OK = "N"
                    MOVE OVER-SEQ TO PASSWDW-SEQ
                    MOVE "TO ALLOW OVERRIDES........:"
                                         TO PASSWDW-PROMPT2
                    PERFORM VERIFY-PASSWORD
                    IF PASSWDW-STAT NOT = "OK"
                       MOVE "N" TO OVERRIDES-OK
                       GO TO MODIFY-ROUTINE
                    ELSE
                       MOVE "Y" TO OVERRIDES-OK.

      *    ----------------------------------------------------------------
      *    PASSWORD ON CL, AH, PP, 01         WORLD #J051
      *
      *    N O T E:  NO  PASSWORD TEST
      *              IF CHANGING 'PP' AND GP-FORCE-INPUT-PP-COVERAGE = 'Y'
      *    ----------------------------------------------------------------
      *    IF NOT ( ELE = 29 AND
      *             PD-ORGST = "GA" AND
      *             GP-FORCE-INPUT-PP-COVERAGE = "Y"
      *           )

           IF NOT ( ELE = 29 AND GP-FORCE-INPUT-PP-COVERAGE = "Y" )
              IF ELE = 27 OR 28 OR 29 OR 30
                 MOVE CL-AH-PP-O1-SEQ TO PASSWDW-SEQ
                 MOVE "TO ALLOW INS. OVERRIDES ..:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    GO TO MODIFY-ROUTINE.

      * PASSWORD OTHER 2 O2 INSURANCE
           IF ELE = 31
              IF CHFG(ELE) NOT = "N"
                 MOVE O2-SEQ TO PASSWDW-SEQ
                 MOVE "TO CHANGE OTHER 2 INSURANCE:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    GO TO MODIFY-ROUTINE.

      * OVERRIDE CALCULATED APR RATE
           IF ELE = 26
              IF APR-OK = "N"
                 MOVE APR-SEQ TO PASSWDW-SEQ
                 MOVE "TO OVERRIDE RATES.........:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    MOVE "N" TO APR-OK
                    GO TO MODIFY-ROUTINE
                 ELSE
                    MOVE "Y" TO APR-OK.

       ENTER-ELE.
           IF PD-GIFTNET = "Y"
              IF NOT (ELE = 2 OR 3 OR 4 OR 7 OR 8 OR 23)
                 GO TO MODIFY-ROUTINE.
           IF ELE = 4
              GO TO CREATE-ROUTINE.


           MOVE "F1, F5-CREATE BORR, F6-SCAN BY NAME, ENTER BORROWER #:"
                TO LEGEND.

           IF ( ELE < 5 )
              PERFORM SEND-LEGEND.

           IF ELE < 5
              MOVE
             "F1, F5-CREATE BORR, F6-SCAN BY NAME, ENTER BORROWER #:"
                                                            TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 5
              IF NEW-FLAG NOT = 1
                 GO TO MODIFY-ROUTINE
              ELSE
                 IF CHFG(5) = "N"
                    GO TO F-052.
           IF ELE = 6
              IF CHFG(6) = "N"
                 MOVE "S  8000060." TO VDU
                 MOVE TRANS-DATE TO PD-LOANDATE VDU-DATE-YYYYMMDD
                 PERFORM SCREENIO
                 MOVE " " TO CHFG(6)
                 PERFORM DEFAULT-INT-PMT-DATES
                 IF IO-FG = 9
                    MOVE 0 TO IO-FG
                    GO TO ENTER-ELE
                 ELSE
                    IF AMT-HOLDER = 0
                       GO TO CONT1-F-06
                    ELSE
                       GO TO CREATE-ROUTINE.
           IF ELE = 10
              IF CHFG(10) = "N"
                 MOVE BR-DEFAULT-LN-UNITPER-CD TO VDUBUF
                 GO TO GOTO-FIELD.

           IF ELE = 17
              IF CHFG(17) = "N"
                 MOVE " " TO CHFG(17)
                 MOVE 0 TO PD-LASTPYAMT
                           CIP-BALLOON
                 MOVE "I" TO PD-BALLOON-FG
                             CIP-BALLOON-SW
                 GO TO CREATE-ROUTINE.
           IF ELE = 5
              MOVE "F1, ENTER THE STATE OF ORIGINATION:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 6
              MOVE "F1, ENTER THE DATE OF THE LOAN:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 7
              MOVE "F1, F6-PURPOSE SCAN, ENTER PURPOSE CODE:"
                                                       TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 8
              MOVE
              "F1, F6-COLLATERAL SCAN, ENTER COLLATERAL CODE:"
                                                    TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 9
              MOVE "F1, F6-SOURCE SCAN, ENTER SOURCE CODE:"
                                                       TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 10
              IF BR-UNITPER-Y-D-FG = "Y"
                 MOVE
                 "F1, ENTER THE PAYMENT PERIOD (M, W, S, Y OR D):"
                                                         TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 MOVE
                 "F1, ENTER THE PAYMENT PERIOD (M, W, S OR B):"
                                                         TO LEGEND
                 PERFORM SEND-LEGEND.
           IF ELE = 11
              IF PD-PRLNNO NOT = 0
                 MOVE "N" TO FIND-LOANS-FG
              END-IF
              IF (NOT (PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"))
                            AND GP-STOP-ON-PRIOR-FG = "N"
                 GO TO CREATE-ROUTINE
              ELSE
                PERFORM D01-FIND-PRIOR-LOANS
                IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
                   MOVE " " TO CHFG(11)
                   MOVE
                   "F1, F5-PAYOFF, F6-SCAN, ENTER LOAN NO. RENEWED:"
                                                            TO LEGEND
                   PERFORM SEND-LEGEND
                ELSE
                   IF QUOTE-ONLY
                      MOVE "N" TO CHFG(11)
                   ELSE
                      MOVE
            "F1, F6-SCAN, ENTER A PRIOR LOAN NO. FOR REFERENCE ONLY:"
                                                            TO LEGEND
                      PERFORM SEND-LEGEND.

           IF ELE = 12
              MOVE " " TO CHFG(11)
              MOVE "F1, ENTER TERM OF THE LOAN:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 13
              MOVE "F1, ENTER FIRST PAYMENT DUE DATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 14
              MOVE " " TO CHFG(11)
              IF CAN-LOAN-NO = " "
                 MOVE " " TO CHFG(13)
              END-IF
              IF (PD-SRCD = "RN")
                 AND (NEW-FLAG = 1)
                 MOVE "N" TO CHFG(14)
              ELSE
                 IF CAN-LOAN-NO NOT = " "
                    MOVE "N" TO CHFG(14)
                 ELSE
                    IF PD-GIFTNET NOT = "Y"
                       MOVE " " TO CHFG(14)
                       MOVE "F1, ENTER LOAN PROCEEDS:" TO LEGEND
                       PERFORM SEND-LEGEND.
           IF ELE = 17
              IF PD-BALLOON-LAST-FG = "B"
                 MOVE "F1, ENTER THE BALLOON AMOUNT:" TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 MOVE "F1, ENTER THE AMOUNT OF LAST PAYMENT:"
                                                        TO LEGEND
                 PERFORM SEND-LEGEND.
           IF ELE = 18
              IF GP-ENTER-LPO-FG NOT = "Y"
                 MOVE "F1, ENTER INSURANCE CODES (EX. MGG):"
                                                        TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 MOVE "F1,F3-LPO,ENTER INSURANCE CODES (EX. MGG):"
                                                        TO LEGEND
                 PERFORM SEND-LEGEND
                 IF VDUSTATUS = "16"
                    MOVE PD-LPO TO WINDOW-LPO
                    MOVE PD-REP-CD TO WINDOW-REP
                    MOVE PD-PROCESS-CD TO WINDOW-PROCESS
                    MOVE "WI/TFCCDS" TO FORM-NAM
                    CALL FORM-PROGX USING FORM-PATH WINDOW-WORKERS
                    CANCEL FORM-PROGX
                    MOVE WINDOW-LPO TO PD-LPO
                    MOVE WINDOW-REP TO PD-REP-CD
                    MOVE WINDOW-PROCESS TO PD-PROCESS-CD.
           IF ELE = 19
              IF NEW-FLAG = 1
                 MOVE
                   "F1, F3-ENTER FEES, (RTN)-BYPASS ENTRY:" TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 PERFORM DO-FEEENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 20 OR 21
              MOVE "F1, ENTER FEE AMOUNT:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 22
              MOVE "F1, F6-DEALER SCAN, ENTER DEALER NO:" TO LEGEND
              PERFORM SEND-LEGEND.

      * SET UP OPTION BAR FOR COLLATERAL
      
           IF ELE = 23
              MOVE VDUSTATUS TO W-VDUSTATUS
              IF BR-TRAILER-REC = "Y"
                 MOVE
                   "F1, ENTER COLLATERAL ID, F3-EXPANDED COLLATERAL"
                                                             TO LEGEND
                  PERFORM SEND-LEGEND
                  MOVE W-VDUSTATUS TO VDUSTATUS
               ELSE
                  MOVE "F1, ENTER COLLATERAL ID" TO LEGEND
                  PERFORM SEND-LEGEND
                  MOVE W-VDUSTATUS TO VDUSTATUS.

      * IF EXPANDED COLLATERAL OPTION = "Y"  AND ( F3
      *               OR AUTO-COLLID = "AU","AC","AL","RP","HP" OR "AW")
      *               OR LA-REC WITH COLLATERAL EXISTS )
      *     THEN OPEN COLLATERAL WINDOW.
      
           IF ELE = 23
              MOVE PD-COLLCD TO TEST-COLLCD
              IF BR-TRAILER-REC = "Y"
                      AND ( VDUSTATUS = "16" OR AUTO-COLLCD )
              MOVE "Y" TO F3-COLLATERAL
              MOVE WK-HHGS-1 TO INSPECT-X
              PERFORM COLLATERAL-CREATE
              PERFORM X02-RESTORE-TRAILER-REC.

           IF NEW-FLAG = 1
              IF ELE = 25
                 GO TO CREATE-ROUTINE.

           IF NEW-FLAG = 1
              IF ELE > 25 AND ELE < 33
                 GO TO CREATE-ROUTINE.
           IF ELE = 31
              IF SP-DEFAULT-O2-INS-COMP NUMERIC  AND
                  SP-DEFAULT-O2-INS-COMP NOT = 0
                 MOVE "SN N020310." TO VDU
                 MOVE SP-DEFAULT-O2-INS-COMP TO VDUNUM0
                 PERFORM SCREENIO.
           IF ELE = 32
              IF GP-DEFAULT-O3-INS-COMPANY NOT = 0
                 MOVE "SN N020320." TO VDU
                 MOVE GP-DEFAULT-O3-INS-COMPANY TO VDUNUM0
                 PERFORM SCREENIO
              END-IF
              IF GP-DEFAULT-O3-INSOURS NOT = " "
                 MOVE "S  A010321." TO VDU
                 MOVE GP-DEFAULT-O3-INSOURS TO VDUBUF
                 PERFORM SCREENIO.

           IF ELE = 34
              IF SP-SCFRMLA = 0
                 GO TO CREATE-ROUTINE
              ELSE
                 IF SP-SCFRMLA = 33 OR 39
                    MOVE "F1, F3-CHANGE POINTS/ORIG.FEE CHARGES:"
                                                        TO LEGEND
                 ELSE
                    MOVE "F1, ENTER THE SERVICE CHARGE:" TO LEGEND
                 END-IF
                 PERFORM SEND-LEGEND.
           IF ELE = 35
              IF SP-MFFRMLA = 0
                 GO TO CREATE-ROUTINE
              ELSE
                 MOVE "F1, ENTER THE MAINTENANCE FEE:" TO LEGEND
                 PERFORM SEND-LEGEND.
           IF ELE = 36
              IF SP-PYEXFRMLA = 0
                 GO TO CREATE-ROUTINE
              ELSE
                 MOVE "F1, ENTER THE FIRST PAYMENT EXTENSION:"
                                                         TO LEGEND
                 PERFORM SEND-LEGEND.
           IF ELE = 42
              MOVE "F1, ENTER THE REGULAR PAYMENT AMOUNT:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 43
              IF BR-LC-CODE = "Y"
                 MOVE "F1, F6-SCAN, ENTER A LATE CHARGE CODE:"
                                                           TO LEGEND
                 PERFORM SEND-LEGEND.

      * SET CERTAIN FIELDS UNTOUCHABLE FOR APPLICATION.

           IF CHKEY NOT = ZEROS
              IF CHFG (ELE) = " "
                 IF NEW-FLAG NOT = 1
                    GO TO MODIFY-ROUTINE.

           IF CHFG(ELE) = "N"
              IF NEW-FLAG = 1
                 GO TO CREATE-ROUTINE
              ELSE
                 GO TO MODIFY-ROUTINE.

           MOVE SPEC(ELE) TO VDU.
           MOVE ELE TO VDUROW.
           MOVE 0 TO VDUCOL.
           MOVE "." TO VDUDECIMAL.
           PERFORM SCREENIO.

       TEST-F1.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.
       TEST-F7.
           IF VDUSTATUS NOT = "1>"
              GO TO TEST-F3.
           IF MENU-FG = 99
              GO TO ENTER-ELE.
           MOVE "END" TO IO-TYPE.
           GO TO END-ROUTINE.
       TEST-F3.
           IF VDUSTATUS NOT = "16"
              GO TO TEST-UP.
           IF NEW-FLAG = 1
              IF ELE = 19
                 PERFORM DO-FEEENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 34
              IF SP-SCFRMLA = 33 OR 39
                 MOVE SP-SCMIN            TO SCHG33-SP-SCMIN
                 MOVE SP-SCMAX            TO SCHG33-SP-SCMAX
                 SUBTRACT PD-STATE-WORKER FROM PD-SERCHG
                                          GIVING SCHG33-CUR-POINTS
                 MOVE PD-STATE-WORKER TO SCHG33-CUR-ORIGFEE
                 MOVE "WI/SCHG33" TO FORM-NAM
                 CALL FORM-PROGX USING FORM-PATH SCHG33-WORKERS
                 CANCEL FORM-PROGX
                 IF SCHG33-RTNCD NOT = " "
                    GO TO ENTER-ELE
                 END-IF
                 ADD SCHG33-CHGTO-POINTS
                     SCHG33-CHGTO-ORIGFEE  GIVING PD-SERCHG
                 MOVE SCHG33-CHGTO-ORIGFEE TO PD-STATE-WORKER

                 MOVE "S  A010341." TO VDU
                 MOVE "I" TO VDUBUF PD-SERCHG-FG
                 PERFORM SCREENIO

                 MOVE PD-SERCHG       TO CIP-SERVICE-CHG
                 MOVE PD-STATE-WORKER TO CIP-STATE-WORKER
                 MOVE PD-SERCHG-FG    TO CIP-SERVICE-CHG-SW
                 PERFORM CALL-LOAN-CALCULATIONS
                 GO TO CREATE-ROUTINE.
       TEST-UP.
           IF VDUSTATUS NOT = "1U"
              GO TO TEST-DN.
           IF ELE = 6
              MOVE " " TO CHFG(5).
           IF ELE = 7
              MOVE " " TO DATE-STAT.
           IF ELE = 23
              MOVE " " TO CHFG(22).
           IF NEW-FLAG = 1
              MOVE -1 TO ONE
              GO TO CREATE-ROUTINE.
       TEST-DN.
           IF VDUSTATUS NOT = "1D"
              GO TO TEST-F5.
           MOVE 1 TO ONE.
           GO TO GOTO-FIELD.

      *-----------------------------------------------------------------
       TEST-F4.

           IF ( NOT F4-KEY ) GO TO TEST-F5.

           IF ( ELE = 23 )
              PERFORM AUTOPC-ROUTINE.

       TEST-F5.
           IF ( NOT F5-KEY ) GO TO TEST-F6.

      * CANNOT USE 'F5' IF APPLICATION IS BEING USED WITH LOAN.
      * WILL AUTOMATICALLY WILL GO TO 'BORROWER-CREATE'
      
           IF ELE < 5
              PERFORM BORROWER-CREATE
              IF IO-FG = 0
                 GO TO GOTO-FIELD.

           IF ELE = 11
              MOVE VDUNUM0 TO W-LNNO
              MOVE "LP/RONPF" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH W-LNNO "Y"
              CANCEL FORM-PROGX.

           MOVE 1 TO ONE.
           GO TO GOTO-FIELD.

       TEST-F6.

           IF ( NOT F6-KEY ) GO TO TEST-00.

           IF ELE < 5
              PERFORM BORROWER-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.

           IF (ELE = 7 OR 8 OR 9)
               MOVE 0 TO CDCODE-FEE-FG
               PERFORM CODE-SCAN
               IF IO-FG = 0
                  GO TO GOTO-FIELD
               ELSE
                  GO TO ENTER-ELE.
           IF ELE = 11
              PERFORM BWLN-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                GO TO ENTER-ELE.
           IF ELE = 22
              PERFORM DEALER-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
           IF ELE = 43
              PERFORM ELCODE-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
       TEST-00.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-ELE.
       GOTO-FIELD.
           MOVE 1 TO ONE.
           IF ELE > 20
              GO TO GOTO-FIELD-20.
           GO TO F-01 F-02 F-03 F-04 F-05 F-06 F-07 F-08 F-09 F-10
                 F-11 F-12 F-13 F-14 F-15 F-16 F-17 F-18 F-19 F-20
                 DEPENDING ON ELE.
       GOTO-FIELD-20.
           SUBTRACT 20 FROM ELE GIVING OVER-20.
           GO TO F-21 F-22 F-23 F-24 F-25 F-26 F-27 F-28 F-29 F-30
                 F-31 F-32 F-33 F-34 F-35 F-36 F-37 F-38 F-39 F-40
                 F-41 F-42 F-43
                 DEPENDING ON OVER-20.
           GO TO ENTRY-MODULE-EXIT.

      *************************************
      *    S E T   E L E M E N T S        *
      *************************************
       F-01.
           PERFORM D00-BORROWER-ENTRY.

           IF ( BW-ERROR-YES )
              GO TO ENTER-ELE.

           MOVE PD-SSNO(1) TO BW-SSNO.
           PERFORM GET-BW1.
           PERFORM SET-CY-CT-SCAN.
           IF ALLOW-CITY-SCAN-FG   = "Y" OR
              ALLOW-COUNTY-SCAN-FG = "Y"
              PERFORM VALIDATE-REQUIRED-FIELD
              IF ALLOW-BW-UPDATE-FG NOT = "Y"
                 GO TO ENTER-ELE.

           IF ( ( BW-LIASMLN     = ZEROES     ) AND
                ( BW-PRLOANS     = ZEROES     ) AND
                ( BW-REFDATE NOT = TRANS-DATE ) ) OR
              ( ( BW-LIASMLN     = ZEROES     ) AND
                ( BW-PRLOANS NOT = ZEROES     ) )
                MOVE BW-SSNO TO BISCAN-SSNO
                MOVE 1 TO BISCAN-CALL-CODE
                PERFORM CALL-SCAN
           ELSE
      * TEST IF ANOTHER LOAN WAS ALREADY MADE TODAY
              MOVE BW-SSNO TO BISCAN-SSNO
              MOVE 5       TO BISCAN-CALL-CODE
              PERFORM CALL-SCAN.

           GO TO CREATE-ROUTINE.

      *-----------------------------------------------------------------
       F-02.
           PERFORM D00-BORROWER-ENTRY.

           IF ( BW-ERROR-YES )
              GO TO ENTER-ELE.

           IF ( BW-SSNO NOT = ZEROES )
              MOVE BW-SSNO TO BISCAN-SSNO
              IF ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS     = ZEROES     ) AND
                   ( BW-REFDATE NOT = TRANS-DATE ) ) OR
                 ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS NOT = ZEROES     ) )
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 1 TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN
              ELSE
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 5       TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN.

           GO TO CREATE-ROUTINE.

      *-----------------------------------------------------------------
       F-03.
           PERFORM D00-BORROWER-ENTRY.

           IF ( BW-ERROR-YES )
              GO TO ENTER-ELE.

           IF ( BW-SSNO NOT = ZEROES )
              MOVE BW-SSNO TO BISCAN-SSNO
              IF ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS     = ZEROES     ) AND
                   ( BW-REFDATE NOT = TRANS-DATE ) ) OR
                 ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS NOT = ZEROES     ) )
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 1 TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN
              ELSE
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 5       TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN.

           PERFORM E01-BW-CHECK-ENDORSER.
           GO TO CREATE-ROUTINE.

      *-----------------------------------------------------------------
       F-04.
           PERFORM D00-BORROWER-ENTRY.

           IF ( BW-ERROR-YES )
              GO TO ENTER-ELE.

           IF ( BW-SSNO NOT = ZEROES )
              MOVE BW-SSNO TO BISCAN-SSNO
              IF ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS     = ZEROES     ) AND
                   ( BW-REFDATE NOT = TRANS-DATE ) ) OR
                 ( ( BW-LIASMLN     = ZEROES     ) AND
                   ( BW-PRLOANS NOT = ZEROES     ) )
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 1 TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN
              ELSE
                 MOVE BW-SSNO TO BISCAN-SSNO
                 MOVE 5       TO BISCAN-CALL-CODE
                 PERFORM CALL-SCAN.

           PERFORM E01-BW-CHECK-ENDORSER.
           GO TO CREATE-ROUTINE.

      *-----------------------------------------------------------------
       F-05.
           MOVE VDUBUF TO PD-ORGST
                          PD-OWNST.

      *-----------------------------------------------------------------
       F-052.
           MOVE SPACES                              TO CHFG(5).
           MOVE "^-BACK, F6-SCAN, ENTER SUB CLASS:" TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "ENNN020052." TO VDU.
           PERFORM SCREENIO.

           IF ( UP-KEY ) GO TO ENTER-ELE.

           IF ( F6-KEY ) PERFORM SUBCLASS-SCAN
                         IF ( IO-FG NOT = ZEROES )
                            GO TO F-052.

           IF NOT ( DOWN-KEY OR ENTER-KEY ) GO TO F-052.

           MOVE PD-ORGST    TO SP-ORGST.
           MOVE PD-SPRCLASS TO SP-SPRCLASS.
           MOVE VDUNUM0     TO PD-SUBCLASS SP-SUBCLASS.
           MOVE ZEROES      TO SP-LAWCODE.
           PERFORM OPEN-SP1-FILE.
           PERFORM START-SP1-FILE.
       F-052-NEXT-SP.
           PERFORM READ-SP1-FILE-NEXT.
           IF NOT (( SP-ORGST    = PD-ORGST    ) AND
                   ( SP-SPRCLASS = PD-SPRCLASS ) AND
                   ( SP-SUBCLASS = PD-SUBCLASS ))
              MOVE 9 TO IO-FG.

           IF ( IO-FG NOT = ZEROES )
              PERFORM SP-INVALID
              GO TO F-052.

      * TEST EFFECTIVE DATE BASED ON SYSTEM DATE, DONT HAVE LOANDATE YET
      * WAS NOT TESTING FOR EFFECTIVE SPR AND IF FIRST SUBCLASS HAS CAN
      * LOAN ONLY, USER WAS STUCK
           IF SP-EFFDATE > TRANS-DATE
              GO TO F-052-NEXT-SP
           ELSE
              IF SP-EXPDATE NOT = 0
                 IF SP-EXPDATE NOT > TRANS-DATE
                    GO TO F-052-NEXT-SP.

      * CHECK 'SPR' CAN LOANS FLAG!!!
      
           IF (( SP-CAN-LOANS-ONLY ) AND ( CAN-LOAN-NO     = SPACES ))
              MOVE MESSAGE-INVALID-SPR-CL TO MESS
              PERFORM SEND-MESS
              GO TO F-052.

           IF (( SP-CAN-LOANS-NO   ) AND ( CAN-LOAN-NO NOT = SPACES ))
              MOVE MESSAGE-INVALID-SPR-NON-CL TO MESS
              PERFORM SEND-MESS
              GO TO F-052.

           MOVE "S  A015053." TO VDU.
           MOVE SP-DESC       TO VDUBUF.
           PERFORM SCREENIO.


           GO TO CREATE-ROUTINE.

      *-----------------------------------------------------------------
       F-06.
           MOVE VDU-DATE-YYYYMMDD TO PD-LOANDATE.
           IF VDU-DATE-YYYYMMDD  = 0
              GO TO ENTER-ELE.

           PERFORM D05-CHECK-SP-EFFDATE.
           IF IO-FG = 9
              PERFORM SP-INVALID
              GO TO ENTER-ELE.

           IF SP-UNITPER-CD = " "
              MOVE MESS-INVALID-SPR-PAY-FREQ-WORLD   TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

           IF SP-UNITPER-CD = "M" AND SP-ORGST = "MX"
              MOVE MESS-INVALID-SPR-PAY-FREQ-WORLD   TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

           MOVE SP-LAWCODE TO PD-LAWCODE.

      * IF COMING FROM MODIFY ROUTINE, AND YOUR COLLATERAL IS SET AS
      * RESCISSION, YOU MUST RECALC INTDATE AND 1STPYDATE
           IF NEW-FLAG NOT = 1
              IF PD-POCD-INRESCISSION
                 PERFORM RESCISSION-ROUTINE.

           IF PD-INTDATE = 0
              MOVE "S  8000061." TO VDU
              MOVE PD-LOANDATE TO VDU-DATE-YYYYMMDD
                                  PD-INTDATE
              PERFORM SCREENIO.

           IF PD-1STPYDATE NOT = 0
               PERFORM SPTEST-EXTDATE-VALID
               IF LIMIT-ERROR = "Y"
                 GO TO ENTER-ELE
              ELSE
                 GO TO CONT1-F-06.
           PERFORM SET-1ST-PAY-DATE.
           PERFORM SPTEST-EXTDATE-VALID.
           IF LIMIT-ERROR = "Y"
              GO TO ENTER-ELE.
           IF DATE-STAT = "N"
              IF NEW-FLAG NOT = 1
      * CITIZENS TEST
                 MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *A90?      MOVE 0 TO CIP-NO-OF-TIMES-CALLED
                 MOVE PD-LOANDATE TO CIP-LOANDATE
                 MOVE PD-INTDATE TO CIP-INTDATE
                 MOVE PD-1STPYDATE TO CIP-1STPYDATE
                 PERFORM CALL-LOAN-CALCULATIONS.
           IF DATE-STAT = "N"
              GO TO CREATE-ROUTINE.
       CONT1-F-06.
      * IF COMING FROM MODIFY ROUTINE, AND YOUR COLLATERAL IS SET AS
      * RESCISSION, INTDATE HAS BEEN CALC'D FOR YOU ABOVE...
           IF NEW-FLAG NOT = 1
              IF PD-POCD-INRESCISSION
                 GO TO CONT2-F-06.

           MOVE "^-BACK, ENTER THE INTEREST DATE OF THE LOAN:"
                                                         TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "ERNM060061." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT1-F-06.
           IF VDUNUM0 = 0
              GO TO CONT1-F-06.
           MOVE PD-INTDATE TO HOLD-WORKER.
           MOVE VDU-DATE-YYYYMMDD TO PD-INTDATE.

           IF PD-INTDATE < PD-LOANDATE
              MOVE "MUST NOT BE PRIOR TO THE LOAN DATE" TO MESS
              PERFORM SEND-MESS
              MOVE HOLD-WORKER TO PD-INTDATE
              GO TO CONT1-F-06.

           IF NEW-FLAG NOT = 1
              IF PD-1STPYDATE NOT > PD-INTDATE
                 MOVE
                 "INTEREST DATE MUST BE PRIOR TO FIRST PAYMENT DATE"
                                                           TO MESS
                 PERFORM SEND-MESS
                 MOVE HOLD-WORKER TO PD-INTDATE
                 GO TO CONT1-F-06.

           PERFORM SPTEST-EXTDATE-VALID.
           IF LIMIT-ERROR = "Y"
              MOVE HOLD-WORKER TO PD-INTDATE
              GO TO CONT1-F-06.

           IF NEW-FLAG NOT = 1
              IF HOLD-WORKER NOT = PD-INTDATE
                 PERFORM SET-UNITPER-INFO.

       CONT2-F-06.
           IF NEW-FLAG NOT = 1
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *A90?   MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              MOVE PD-LOANDATE TO CIP-LOANDATE
              MOVE PD-INTDATE TO CIP-INTDATE
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-07.
           MOVE "PU"   TO CD-TYPE.
           MOVE VDUBUF TO PD-PURCD
                          CD-CODE.
           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-08.
           MOVE "CO"   TO CD-TYPE.
           MOVE VDUBUF TO CD-CODE PD-COLLCD.
           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           MOVE CD-CO-SECURED TO SPTEST-CD-SECURED.
           IF CD-CO-SECURED = "R"
              PERFORM RESCISSION-ROUTINE
      * JTG ADDED TO RECOMPUTE PRIOR LOAN PAYOFF AS OF NEW 1ST PAY RESCISSION
              PERFORM D12-PROCESS-PRIOR-LN
              MOVE "SNNN062111." TO VDU
              MOVE PRIOR-LNAMT TO VDUNUM2
              PERFORM SCREENIO
           ELSE
           IF PD-POCD = "*I"
              MOVE "R1." TO MESS
              PERFORM RESET-MESS
              MOVE "S  8000061." TO VDU
              MOVE PD-LOANDATE TO PD-INTDATE VDU-DATE-YYYYMMDD
              PERFORM SCREENIO
              MOVE "  "   TO PD-POCD
              MOVE "N"    TO PD-RESCISSION
              MOVE ZEROES TO PD-RESCISSION-DATE
      * JTG ADDED TO RECOMPUTE PRIOR LOAN PAYOFF AS OF NEW 1ST PAY RESCISSION
              PERFORM D12-PROCESS-PRIOR-LN
              MOVE "SNNN062111." TO VDU
              MOVE PRIOR-LNAMT TO VDUNUM2
              PERFORM SCREENIO
              PERFORM SET-FIRST-PAY-DATE.

           GO TO CREATE-ROUTINE.
       F-09.
           MOVE "SR"   TO CD-TYPE.
           MOVE VDUBUF TO PD-SRCD
                          CD-CODE.
           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.

           IF PD-SRCD = "LR"
              MOVE "'LR' SOURCE CODE NOT ALLOWED" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

           IF NOT (PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO")
              IF SP-SCFRMLA = 63
                 MOVE 0 TO WISCHG-PRIOR-SERCHG
                           CIP-RESTRICT-SERCHG.

           IF GP-THE-ONLY-SF-SRCD NOT = " "
              IF PD-SRCD = GP-THE-ONLY-SF-SRCD
                 MOVE "INVALID FOR DIRECT LOANS" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           IF PD-SRCD = "ET" OR "LP" OR "NP" OR "RT" OR "ST" OR "RB"
              MOVE SRCD-SEQ TO PASSWDW-SEQ
              MOVE "TO USE THIS SRCD" TO PASSWDW-PROMPT2
              PERFORM VERIFY-PASSWORD
              IF PASSWDW-STAT NOT = "OK"
                 MOVE "INVALID SOURCE CODE" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           IF SP-RENEWAL-EDIT = "B"
              IF PD-SRCD = "PB" OR "RN"
                 MOVE "PB RENEWALS ARE NOT ALLOWED IN THIS SUB-CLASS"
                          TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           IF SP-RENEWAL-EDIT = "C"
              IF PD-SRCD = "NB" OR "FB" OR "CP" OR "DM" OR "ML" OR
                             "RF" OR "TX"
                 MOVE "NB & FB LOANS ARE NOT ALLOWED IN THIS SUB-CLASS"
                            TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           IF CIP-SOURCE-CD = "RN" OR "SC" OR "PB"
                                 OR "RB" OR "RO" OR " "
              IF NOT (PD-SRCD = "RN" OR "SC" OR "PB"
                                   OR "RB" OR "RO")
                 PERFORM BLANK-PRIOR-LOAN.

           MOVE PD-SRCD TO CIP-SOURCE-CD.
           IF NEW-FLAG NOT = 1
              PERFORM VERIFY-PROCEEDS-DOWN
              IF IO-FG = 9
                 GO TO ENTER-ELE
              END-IF
              PERFORM VERIFY-PROCEEDS
              MOVE 0 TO IO-FG
              IF PD-SRCD = "RN" OR "SC" OR "PB" OR "RB" OR "RO"
                 MOVE 11 TO ELE
                 GO TO ENTER-ELE.

           IF NEW-FLAG NOT = 1
              PERFORM VALID-INS-TYPES-ELIG
              PERFORM D16-TEST-NC-ORIG-FEES.

           GO TO CREATE-ROUTINE.
       F-10.
           IF SP-UNITPER-CD NOT = " "
              IF VDUBUF NOT = SP-UNITPER-CD
                 MOVE MESS-INVALID-SPR-PAY-FREQ TO MESS
                 PERFORM SEND-MESS
                 MOVE " " TO CHFG(10)
                 GO TO ENTER-ELE.

           MOVE VDUBUF TO PD-UNITPER-CD
                          UPERTST-UNITPER-CD.

           PERFORM UPERTST-UNITPER-CODE.
           IF UPERTST-ERRCD NOT = " "
              MOVE " " TO CHFG(10)
              GO TO ENTER-ELE.
           IF CHFG(10) = "N"
              MOVE " " TO CHFG(10)
              GO TO CREATE-ROUTINE.
           IF BR-UNITPER-Y-D-FG NOT = "Y"
              MOVE "SNNN030101." TO VDU
              MOVE 1 TO PD-UNITPER-FREQ
                        VDUNUM0
              PERFORM SCREENIO
              PERFORM SET-1ST-PAY-DATE
              IF NEW-FLAG NOT = 1
                       OR PD-ORGTERM = 1
                 PERFORM SET-UNITPER-INFO
                 GO TO F-102
              ELSE
                 GO TO F-102.

       F-101.
           PERFORM ALARM.
           MOVE
           "F1, ^, ENTER THE FREQUENCY (EX. 2 = EVERY TWO MONTHS!):"
                                                         TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "ENNN030101." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-101.
           MOVE VDUNUM0 TO PD-UNITPER-FREQ
                           UPERTST-UNITPER-FREQ.
           MOVE PD-UNITPER-CD TO UPERTST-UNITPER-CD.
           PERFORM UPERTST-UNITPER-FREQUENCY.
           IF UPERTST-ERRCD NOT = " "
              GO TO F-101.

           PERFORM SET-1ST-PAY-DATE.
           IF NOT (PD-UNITPER-CD = "M"
                         AND PD-UNITPER-FREQ = 1)
              PERFORM UPERTST-SET-MESS
              MOVE UPERTST-MESS TO MESS
              PERFORM SEND-MESS.
           IF NEW-FLAG NOT = 1
                    OR PD-ORGTERM = 1
              PERFORM SET-UNITPER-INFO.

       F-102.
           PERFORM ALARM.
           IF NEW-FLAG NOT = 1
                   AND PD-ORGTERM = 1
              MOVE "F1, ^, L-LAST PAYMENT" TO LEGEND
           ELSE
              MOVE "F1, ^, B-BALLOON OR L-LAST PAYMENT??" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "E  A010102." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              IF BR-UNITPER-Y-D-FG NOT = "Y"
                 GO TO ENTER-ELE
              ELSE
                 GO TO F-101.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO ENTRY-MODULE-EXIT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-102.
           IF NOT (VDUBUF = "B" OR "L")
              GO TO F-102.
           MOVE VDUBUF TO PD-BALLOON-LAST-FG.
           PERFORM DISPLAY-BALLOON-LAST.
           PERFORM SET-1ST-PAY-DATE.
           IF NEW-FLAG NOT = 1
      *       IF PD-ORGTERM = 1
      *              AND PD-BALLOON-LAST-FG = "B"
      *          STRING "SINGLE PAYS MUST HAVE LAST "
      *                 "PAYMENT FLAG SET, NOT BALLOON FLAG!"
      *                 "                              "
      *                 DELIMITED BY SIZE INTO MESS
      *          PERFORM SEND-MESS
      *          GO TO F-102
      *       END-IF
              MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.

       F-11.
      *    ------------------------------------------------------------
      *    IF COMING FROM LOAN SCAN, ACCT AND SEQNO IN VDUNUM0
      *    ------------------------------------------------------------
           MOVE VDUNUM0 TO W-LNNO.
           IF NOT (PD-SRCD = "RN" OR "PB" OR "SC" OR "RB" OR "RO")
              IF VDUNUM0 = 0
                 MOVE "S  A060110." TO VDU
                 PERFORM SCREENIO
                 MOVE "S  A090111." TO VDU
                 PERFORM SCREENIO
                 MOVE 0 TO PD-PRLNNO   PD-PRBAL
                           PD-PRINTDUE PD-PRFINCHGRB
                           PD-PRINSRB  PD-PRPAID-AHEAD
                 GO TO CREATE-ROUTINE
              ELSE
                 GO TO CREATE-ROUTINE
           ELSE
              IF VDUNUM0 = 0
                 MOVE "PRIOR LOAN NO. REQUIRED FOR LOAN RENEWALS"
                       TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           MOVE W-LNNO TO PD-PRLNNO.

           IF SP-SCFRMLA = 4 OR 12 OR 13 OR 16 OR 23 OR 29 OR 43
                             OR 45 OR 48 OR 49 OR 50 OR 52 OR 53
                             OR 54 OR 55 OR 56 OR 57 OR 58 OR 59
              PERFORM D17-TEST-FOR-GEORGIA-SCHG
           ELSE
              IF SP-SCFRMLA = 18 OR 42
                 PERFORM D18-TEST-FOR-SC-SCHG
              ELSE
              IF SP-SCFRMLA = 63
                 PERFORM TEST-FOR-WI-SCHG.

           IF SP-MFFRMLA = 4
              PERFORM D18-TEST-FOR-MFEE.

           PERFORM D12-PROCESS-PRIOR-LN.

           IF PRIOR-LOAN-NOT-VALID
              MOVE 0 TO IO-FG
              PERFORM SEND-PRIOR-MESS
              GO TO ENTER-ELE.

           IF ERROR-IN-PRIOR-LOAN
              MOVE 0 TO IO-FG
              PERFORM PRIOR-LOAN-ERROR-MSG
              GO TO ENTER-ELE.

           MOVE "SNNN062111." TO VDU.
           MOVE PRIOR-LNAMT TO VDUNUM2.
           PERFORM SCREENIO.

           IF GP-RENEWAL-COLLATERAL = "Y"
              PERFORM GET-PRIOR-COLLATERAL.

           GO TO CREATE-ROUTINE.
       F-12.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.
           MOVE PD-ORGTERM TO HOLD-WORKER.
           MOVE VDUNUM0 TO PD-ORGTERM
                           PD-SUM-ORGTERM
                           PD-ANTICTERM.
      *    IF PD-ORGTERM = 1
      *       IF PD-BALLOON-LAST-FG NOT = "L"
      *          STRING "SINGLE PAYS MUST HAVE LAST "
      *                 "PAYMENT FLAG SET, NOT BALLOON FLAG!"
      *                 "                              "
      *                 DELIMITED BY SIZE INTO MESS
      *          PERFORM SEND-MESS
      *          MOVE HOLD-WORKER TO PD-ORGTERM
      *          GO TO ENTER-ELE.
           PERFORM SP-EDT-TABLE-LOOKUP.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              MOVE HOLD-WORKER TO PD-ORGTERM
              GO TO ENTER-ELE.

           IF HOLD-WORKER NOT = PD-ORGTERM
              PERFORM SET-UNITPER-INFO.

           IF NEW-FLAG NOT = 1
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *A90?   MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              MOVE PD-1STPYDATE TO CIP-1STPYDATE
              MOVE PD-ORGTERM TO CIP-TERM
              PERFORM CALL-LOAN-CALCULATIONS.

           GO TO CREATE-ROUTINE.
       F-13.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.
           MOVE PD-1STPYDATE TO HOLD-WORKER.
           MOVE VDU-DATE-YYYYMMDD TO PD-ORIG-1STPYDATE
                                     PD-1STPYDATE.

           PERFORM SPTEST-EXTDATE-VALID.
           IF LIMIT-ERROR = "Y"
              GO TO ENTER-ELE.

           IF PD-1STPYDATE NOT > PD-INTDATE
              MOVE "MUST BE AFTER THE INTEREST DATE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

      * DO NOT ALLOW A FIRST PAYMENT DATE < 30 DAYS FROM LOAN DATE
      * OR < THAN 1 UNIT PERIOD FROM INT DATE
           MOVE PD-INTDATE      TO NDTE-DATE.
           MOVE 1               TO NDTE-HOLD.
           MOVE PD-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           IF PD-1STPYDATE < NDTE-DATE
              MOVE 1STPY30-SEQ TO PASSWDW-SEQ
              MOVE "1ST PAY < 30 DAYS FROM LNDATE"
                                        TO PASSWDW-PROMPT2
              PERFORM VERIFY-PASSWORD
              IF PASSWDW-STAT NOT = "OK"
                 GO TO ENTER-ELE.

      *  JTG 011001 DON'T ALLOW A FIRST PAY DAY OF 31 WHEN SEMI MONTHLY PAPER
      *                                                            FFG PR#333
      *  CS  021001 PER JOHN DON'T ALLOW A FIRST PAY DAY OF 14 OR 15 EITHER IF
      *      SEMI-MONTHLY.  FEB CAUSED THE CYCLE DATES FOR LATE CHARGES TO BE
      *      OUT OF SYNC. FOR EXAMPLE: WITH PAYDATE OF 15 LCPDTH GOES TO 2/28/YY      *      MARCH WENT TO 3/13/YY INSTEAD OF 3/15/YY [DISCOVERED AT FFG]


           IF PD-UNITPER-CD = "S"
              IF PD-1STPYDA = 14 OR 15 OR 31
                 PERFORM INVALID-DUE-DAY
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

      *
           IF HOLD-WORKER NOT = PD-1STPYDATE
              PERFORM SET-UNITPER-INFO.
           IF NEW-FLAG NOT = 1
              MOVE PD-1STPYDATE TO CIP-1STPYDATE
              MOVE PD-ORGTERM   TO CIP-TERM
      * CITIZENS TEST
              MOVE 800          TO CIP-NO-OF-TIMES-CALLED
      * A90?  NO MOVE STATEMENT IN A10/LNQUOT.C
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-14.
           MOVE VDUNUM2 TO PD-SELLPR
                           PD-PROCEEDS.

      * SP-EDT-TABLE-LOOKUP:
           PERFORM SP-EDT-TABLE-LOOKUP.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.

           PERFORM VERIFY-PROCEEDS.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.

           IF NEW-FLAG = 1
      *       MOVE PD-SELLPR TO PD-PROCEEDS
              MOVE "I" TO PD-SELLPR-FG
                          PD-PROCEEDS-FG
              GO TO CREATE-ROUTINE.
       F-141.
           MOVE "^-BACK, ENTER 'C' TO CALCULATE THE PROCEEDS:"
                                                     TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "S  A010141." TO VDU.
           MOVE "I" TO VDUBUF.
           PERFORM SCREENIO.

           MOVE "E  A010141." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUBUF = "I" OR "C")
              PERFORM ICE-OR-A-MSG
              GO TO F-141.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-141.

           IF NOT (VDUBUF = PD-SELLPR-FG)
              IF VDUBUF = "I"
                 PERFORM SETUP-BLINPC-BUF
                 MOVE " " TO BLINPC-SELLPR-FG
                 PERFORM BLINPC-CALC-WINDOW
                 IF BLINPC-STATUS NOT = "00"
                    GO TO F-141
                 ELSE
                    PERFORM AFTER-SELLPR-CALC-OPT
              ELSE
                 IF VDUBUF = "C"
                    MOVE "I" TO PD-REGPYAMT-FG
                                PD-BALLOON-FG
                    MOVE "C" TO PD-SELLPR-FG
                                PD-PROCEEDS-FG
                 ELSE
                    PERFORM ICE-OR-A-MSG
                    GO TO F-141.

           MOVE PD-SELLPR TO CIP-SELLPR
                             CIP-PROCEEDS.
           MOVE PD-REGPYAMT-FG TO CIP-REGPYAMT-SW.
           MOVE PD-PROCEEDS-FG TO CIP-PROCEEDS-SW.
           MOVE PD-BALLOON-FG TO CIP-BALLOON-SW.
           PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-15.
           GO TO CREATE-ROUTINE.
       F-16.
           GO TO CREATE-ROUTINE.
       F-17.
           IF PD-ORGTERM = 1
              IF VDUNUM2 NOT = 0
                 MOVE "ENTER ZERO FOR SINGLE PAY LOANS!!" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           IF (PD-BALLOON-LAST-FG = "L") AND
              (PD-ORGTERM NOT = 1)
              IF VDUNUM2 = 0
                 GO TO ENTER-ELE.
           MOVE VDUNUM2 TO PD-LASTPYAMT
                           CIP-BALLOON.
           IF NEW-FLAG = 1
              MOVE "I" TO PD-BALLOON-FG
                          CIP-BALLOON-SW
              GO TO CREATE-ROUTINE.
       F-171.
           MOVE "S  A010171." TO VDU.
           MOVE "I" TO VDUBUF
           PERFORM SCREENIO.

           MOVE "E  A010171." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-171.

           IF NOT (VDUBUF = PD-BALLOON-FG)
              IF VDUBUF = "I"
                 PERFORM SETUP-BLINPC-BUF
                 MOVE " " TO BLINPC-BALLOON-FG
                 PERFORM BLINPC-CALC-WINDOW
                 IF BLINPC-STATUS NOT = "00"
                    GO TO F-171
                 ELSE
                    PERFORM AFTER-BALLO-CALC-OPT
              ELSE
                 IF VDUBUF = "C"
                    MOVE "I" TO PD-REGPYAMT-FG
                                PD-PROCEEDS-FG
                    MOVE "C" TO PD-BALLOON-FG
                 ELSE
                    PERFORM ICE-OR-A-MSG
                    GO TO F-171.
           IF NEW-FLAG NOT = 1
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *       MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              MOVE PD-LASTPYAMT TO CIP-BALLOON
              MOVE PD-BALLOON-FG TO CIP-BALLOON-SW
              MOVE PD-PROCEEDS-FG TO CIP-PROCEEDS-SW
              MOVE PD-REGPYAMT-FG TO CIP-REGPYAMT-SW
              PERFORM CALL-LOAN-CALCULATIONS.

           GO TO CREATE-ROUTINE.
       F-18.
           IF (GP-ENTER-LPO-FG = "Y")
              IF NEW-FLAG = 1
                 MOVE PD-LPO TO WINDOW-LPO
                 MOVE PD-REP-CD TO WINDOW-REP
                 MOVE PD-PROCESS-CD TO WINDOW-PROCESS
                 MOVE "WI/TFCCDS" TO FORM-NAM
                 CALL FORM-PROGX USING FORM-PATH WINDOW-WORKERS
                 CANCEL FORM-PROGX
                 MOVE WINDOW-LPO TO PD-LPO
                 MOVE WINDOW-REP TO PD-REP-CD
                 MOVE WINDOW-PROCESS TO PD-PROCESS-CD.
           MOVE PD-INSCODES TO INSCODES-HLDR.
           MOVE " " TO CHFG(27) CHFG(28) CHFG(29)
                       CHFG(30) CHFG(31) CHFG(32).
           MOVE VDUBUF TO PD-INSCODES.

           IF SP-INSURANCE-WRITTEN = "N"
               IF PD-INSURED NOT = "N"
                  IF PD-INSTYPES NOT = "N"
                      MOVE "INSURANCE NOT ALLOWED PER SPR"
                                                 TO MESS
                      PERFORM SEND-MESS
                      GO TO ENTER-ELE.


           IF PD-INSURED NOT = "M"
              IF PD-INSURED NOT = "J"
                 IF PD-INSURED NOT = "N"
                    IF PD-INSURED NOT = "S"
                       MOVE "ENTER 'N','M','S',OR 'J'" TO MESS
                       PERFORM SEND-MESS
                       MOVE INSCODES-HLDR TO PD-INSCODES
                       GO TO ENTER-ELE.
           IF NOT PD-INSTYPES-VALID
              MOVE INSCODES-HLDR TO PD-INSCODES
              GO TO ENTER-ELE.
           IF NOT PD-INSELIGIBLE-VALID
              MOVE INSCODES-HLDR TO PD-INSCODES
              GO TO ENTER-ELE.
      * ADDED TO PREVENT ENTRY OF MNN, ETC.
           IF PD-INSTYPES = "N"
              IF PD-INSURED NOT = "N"
                 MOVE INSCODES-HLDR TO PD-INSCODES
                 GO TO ENTER-ELE.
           PERFORM VALID-INS-TYPES-ELIG.
           IF IO-FG = 9
              MOVE INSCODES-HLDR TO PD-INSCODES
              GO TO ENTER-ELE.

           IF CHFG(27) = "N"
              MOVE 0 TO PD-INSCOMP(1) PD-INSTRM(1) PD-INSCOVR(1)
                        PD-INSPREM(1) PD-INSCOMM(1)
              MOVE " " TO PD-INSOURS(1)
              MOVE "270 271 272 273 274 275." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(28) = "N"
              MOVE 0 TO PD-INSCOMP(2) PD-INSTRM(2) PD-INSCOVR(2)
                        PD-INSPREM(2) PD-INSCOMM(2)
              MOVE " " TO PD-INSOURS(2)
              MOVE "280 281 282 283 284 285." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(29) = "N"
              MOVE 0 TO PD-INSCOMP(3) PD-INSTRM(3) PD-INSCOVR(3)
                        PD-INSPREM(3) PD-INSCOMM(3)
              MOVE " " TO PD-INSOURS(3)
              MOVE "290 291  293 294 295." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(30) = "N"
              MOVE 0 TO PD-INSCOMP(4) PD-INSTRM(4) PD-INSCOVR(4)
                        PD-INSPREM(4) PD-INSCOMM(4)
              MOVE " " TO PD-INSOURS(4)
              MOVE "300 301 302 303 304 305." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(31) = "N"
              MOVE 0 TO PD-INSCOMP(5) PD-INSTRM(5) PD-INSCOVR(5)
                        PD-INSPREM(5) PD-INSCOMM(5)
              MOVE " " TO PD-INSOURS(5)
              MOVE "310 311 312 313 314 315." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(32) = "N"
              MOVE 0 TO PD-INSCOMP(6) PD-INSTRM(6) PD-INSCOVR(6)
                        PD-INSPREM(6) PD-INSCOMM(6)
              MOVE " " TO PD-INSOURS(6)
              MOVE "320 321 322 323 324 325." TO MESS
              PERFORM RESET-MESS.
           IF NOT SP-SCFRMLA-POINTS
              IF NEW-FLAG = 1
                 MOVE "I" TO PD-POINTS-FG
                 GO TO CREATE-ROUTINE
              ELSE
                 GO TO CONT2-F-18.
       CONT1-F-18.
           MOVE "^-BACK, ENTER NO OF POINTS (99.99):" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "ENNN022181." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT1-F-18.
           MOVE VDUNUM2 TO PD-POINTS.
           PERFORM SP-EDT-TABLE-LOOKUP.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO CONT1-F-18.
           IF PD-POINTS = 0
              MOVE "S  A050181." TO VDU
              PERFORM SCREENIO.
           IF NEW-FLAG = 1
              MOVE "I" TO PD-POINTS-FG
              GO TO CREATE-ROUTINE.
       CONT2-F-18.
           MOVE "S  A010182." TO VDU.
           MOVE "I" TO VDUBUF PD-POINTS-FG.
           PERFORM SCREENIO.

           MOVE "E  A010182." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              IF SP-SCFRMLA-POINTS
                 GO TO CONT1-F-18.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT2-F-18.
           MOVE VDUBUF TO PD-POINTS-FG.
           IF NOT (PD-POINTS-FG = "I" OR "C")
              PERFORM ICE-OR-A-MSG
              GO TO CONT2-F-18.
           IF NEW-FLAG NOT = 1
              IF PD-INSCODES NOT = INSCODES-HLDR
                 MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              ELSE
                 MOVE 800 TO CIP-NO-OF-TIMES-CALLED
              END-IF
              MOVE PD-INSURED TO CIP-INS-WHO
              MOVE PD-INSTYPES TO CIP-INS-TYPE
              MOVE PD-INSELIGIBLE TO CIP-INS-ELIG
              MOVE PD-POINTS TO CIP-POINTS
              MOVE PD-POINTS-FG TO CIP-POINTS-SW
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-19.
           GO TO CREATE-ROUTINE.
       F-20.
           MOVE PD-FEEAMT(1) TO AMT-HOLDER.
           MOVE VDUNUM2 TO PD-FEEAMT(1).
           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF PD-FEEAMT(1) = AMT-HOLDER
              GO TO CREATE-ROUTINE.
       CONT-F-20.
           MOVE "S  A010201." TO VDU.
           MOVE "I" TO VDUBUF PD-FEECD-FG(1).
           PERFORM SCREENIO.

           MOVE "E  A010201." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-20.
           MOVE VDUBUF TO PD-FEECD-FG(1).
           IF PD-FEECD-FG(1) NOT = "I"
              IF PD-FEECD-FG(1) NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO CONT-F-20.
           IF NEW-FLAG NOT = 1
              MOVE PD-FEEAMT(1) TO CIP-FEE-CHG(1)
              MOVE PD-FEECD-FG(1) TO CIP-FEE-CHG-SW(1)
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-21.
           MOVE PD-FEEAMT(2) TO AMT-HOLDER.
           MOVE VDUNUM2 TO PD-FEEAMT(2).
           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF PD-FEEAMT(2) = AMT-HOLDER
              GO TO CREATE-ROUTINE.
       CONT-F-21.
           MOVE "S  A010211." TO VDU.
           MOVE "I" TO VDUBUF PD-FEECD-FG(2).
           PERFORM SCREENIO.

           MOVE "E  A010211." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-21.
           MOVE VDUBUF TO PD-FEECD-FG(2).
           IF PD-FEECD-FG(2) NOT = "I"
              IF PD-FEECD-FG(2) NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO CONT-F-21.
           IF NEW-FLAG NOT = 1
              MOVE PD-FEEAMT(2) TO CIP-FEE-CHG(2)
              MOVE PD-FEECD-FG(2) TO CIP-FEE-CHG-SW(2)
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-22.
           MOVE VDUNUM2 TO PD-DLNO
                           DL-DLNO.
           PERFORM GET-DL1.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           IF DL-TERMDATE NOT = 0
              IF DL-TERMDATE <= PD-LOANDATE
                 MOVE "DEALER HAS BEEN TERMINATED" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           MOVE "SIGN:" TO INSPECT-W.
           MOVE DL-SIGN1 TO ADD-ON.
           PERFORM ADD-IT2.
           MOVE DL-SIGN2 TO ADD-ON.
           PERFORM ADD-IT2.
           MOVE DL-SIGN3 TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO MESS.
           PERFORM MSG-LINE.
           IF BR-LC-CODE = "Y"
              MOVE "SNNN020430." TO VDU
              MOVE DL-LC-CODE TO VDUNUM0 PD-LC-CODE
              PERFORM SCREENIO.
           GO TO CREATE-ROUTINE.
       F-23.
           MOVE VDUBUF TO PD-COLLID.
           IF PD-COLLID = " "
              MOVE SPACES TO WK-HHGS-1
              MOVE "230 231 232." TO MESS
              PERFORM RESET-MESS
              GO TO CREATE-ROUTINE.
           IF F3-YES
              GO TO CREATE-ROUTINE.
       CONT1-F-23.
           MOVE "E  A200231." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT1-F-23.
           MOVE VDUBUF TO SCREEN-LINE1 WK-HHGS-1.
           IF SCREEN-LINE1 = " "
              MOVE "231 232." TO MESS
              PERFORM RESET-MESS
              GO TO CREATE-ROUTINE.
       CONT2-F-23.
           MOVE "E  A200232." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO CONT1-F-23.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT2-F-23.
           MOVE VDUBUF TO SCREEN-LINE2.
           IF SCREEN-LINE2 = " "
              MOVE "232." TO MESS
              PERFORM RESET-MESS
              GO TO F-23-EXIT.
           STRING SCREEN-LINE1,SCREEN-LINE2
                  DELIMITED BY "   " INTO WK-HHGS-1.
       F-23-EXIT.
           MOVE MSG-LINE1 TO PD-MSG1.
           MOVE MSG-LINE2 TO PD-MSG2.
           GO TO CREATE-ROUTINE.
       F-24.
       F-25.
           MOVE VDUNUM3 TO PD-ENDORATE.
           GO TO CREATE-ROUTINE.
       F-26.
           MOVE VDUNUM3 TO PD-OVRDRATE.
       CONT-F-26.
           MOVE "E  A010261." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-26.
           MOVE VDUBUF TO PD-OVRDRATE-FG.

           IF SP-CAL-FLAT-MONTHLY(1)
              IF PD-OVRDRATE-FG = "E"
                 MOVE "EFFECTIVE RATE OVERRIDE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
                 GO TO CONT-F-26.
           IF (NOT (PD-OVRDRATE-FG = "C" OR "E" OR "A"))
              PERFORM ICE-OR-A-MSG
              GO TO CONT-F-26.

           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF NEW-FLAG NOT = 1
              MOVE PD-OVRDRATE TO CIP-OVR-RATE
              MOVE PD-OVRDRATE-FG TO CIP-OVR-RATE-SW
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-27.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-28.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-29.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-30.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-31.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-32.
           PERFORM D03-INSURANCE-ENTRY.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-33.
           GO TO CREATE-ROUTINE.
       F-34.
           MOVE PD-SERCHG TO AMT-HOLDER.
           MOVE VDUNUM2 TO PD-SERCHG
                           PD-SUM-SERCHG.
           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF PD-SERCHG = AMT-HOLDER
              GO TO CREATE-ROUTINE.
       CONT-F-34.
           MOVE "S  A010341." TO VDU.
           MOVE "I" TO VDUBUF PD-SERCHG-FG.
           PERFORM SCREENIO.

           MOVE "E  A010341." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-34.
           MOVE VDUBUF TO PD-SERCHG-FG.
           IF PD-SERCHG-FG NOT = "I"
              IF PD-SERCHG-FG NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO CONT-F-34.
           IF NEW-FLAG NOT = 1
              MOVE PD-SERCHG TO CIP-SERVICE-CHG
              MOVE PD-SERCHG-FG TO CIP-SERVICE-CHG-SW
              PERFORM CALL-LOAN-CALCULATIONS.
           IF NEW-FLAG NOT = 1
      *       --> NOTE: SCFRMLA 33 AND 39 HAVE 2 COMPONENTS, MUST USE F3
      *                 TO INDICATE DISTRIBUTION, RE: WI/SCHG33.C
              IF (PD-SERCHG-FG = "I") AND
                 (SP-SCFRMLA = 33 OR 39 )
                 MOVE "MUST USE F3 FOR DISTRIBUTION WINDOW" TO MESS
                 PERFORM SEND-MESS
                 MOVE "SNNN062340." TO VDU
                 MOVE AMT-HOLDER    TO PD-SERCHG
                                       VDUNUM2
                 PERFORM SCREENIO
                 GO TO ENTER-ELE
              ELSE
                 MOVE PD-SERCHG TO CIP-SERVICE-CHG
                 MOVE PD-SERCHG-FG TO CIP-SERVICE-CHG-SW
                 PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-35.
           MOVE VDUNUM2 TO SAVE-MAINTFEE.
           DIVIDE VDUNUM2 BY PD-ORGTERM GIVING PD-MAINTFEE ROUNDED.
           IF SP-MFFRMLA-05
              COMPUTE PD-SUM-MAINTFEE = PD-MAINTFEE * PD-ORGTERM
           ELSE
              MOVE PD-MAINTFEE TO PD-SUM-MAINTFEE.
           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF VDUNUM2 = MAINTFEE-HLDR
              GO TO CREATE-ROUTINE.
       CONT-F-35.
           MOVE "S  A010351." TO VDU.
           MOVE "I" TO VDUBUF PD-MAINTFEE-FG.
           PERFORM SCREENIO.

           MOVE "E  A010351." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-35.
           MOVE VDUBUF TO PD-MAINTFEE-FG.
           IF PD-MAINTFEE-FG NOT = "I"
              IF PD-MAINTFEE-FG NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO CONT-F-35.
           IF NEW-FLAG NOT = 1
              IF SP-MFFRMLA-05
                 MOVE SAVE-MAINTFEE TO CIP-MAINT-FEES
              ELSE
                 MULTIPLY PD-MAINTFEE BY PD-ORGTERM GIVING
                    CIP-MAINT-FEES ROUNDED.
              MOVE PD-MAINTFEE-FG TO CIP-MAINT-FEES-SW
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-36.
           MOVE PD-EXTCHG TO AMT-HOLDER.
           MOVE VDUNUM2 TO PD-EXTCHG
                           PD-SUM-EXTCHG.
           PERFORM VALIDATE-FIELDS-AGAINST-MAX.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO ENTER-ELE.
           IF PD-EXTCHG = AMT-HOLDER
              GO TO CREATE-ROUTINE.
       CONT-F-36.
           MOVE "S  A010361." TO VDU.
           MOVE "I" TO VDUBUF PD-EXTCHG-FG.
           PERFORM SCREENIO.

           MOVE "E  A010361." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-36.
           MOVE VDUBUF TO PD-EXTCHG-FG.
           IF PD-EXTCHG-FG NOT = "I"
              IF PD-EXTCHG-FG NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO CONT-F-36.
           IF NEW-FLAG NOT = 1
              MOVE PD-EXTCHG TO CIP-1ST-PY-EXT
              MOVE PD-EXTCHG-FG TO CIP-1ST-PY-EXT-SW
              PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-37.
           MOVE VDUNUM2 TO PD-INTCHG
                           PD-SUM-INTCHG.
           GO TO CREATE-ROUTINE.
       F-38.
           MOVE VDUNUM2 TO PD-FINAMT.
           GO TO CREATE-ROUTINE.
       F-39.
           GO TO CREATE-ROUTINE.
       F-40.
           GO TO CREATE-ROUTINE.
       F-41.
           GO TO CREATE-ROUTINE.
       F-42.
           MOVE PD-REGPYAMT TO AMT-HOLDER.
           IF VDUNUM2 = AMT-HOLDER AND COP-TERM = 1
              GO TO CREATE-ROUTINE.
           MOVE VDUNUM2     TO PD-REGPYAMT
                               PD-SUM-REGPYAMT.
           IF VDUNUM2 = 0
              GO TO ENTER-ELE.
       F-421.
           MOVE "S  A010421." TO VDU.
           MOVE "I" TO VDUBUF
           PERFORM SCREENIO.

           MOVE "E  A010421." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-421.
           IF NOT (VDUBUF = PD-REGPYAMT-FG)
              IF VDUBUF = "I"
                 PERFORM SETUP-BLINPC-BUF
                 MOVE " " TO BLINPC-REGPYAMT-FG
                 PERFORM BLINPC-CALC-WINDOW
                 IF BLINPC-STATUS NOT = "00"
                    GO TO F-421
                 ELSE
                    PERFORM AFTER-REGPY-CALC-OPT
              ELSE
                 IF VDUBUF = "C"
                    MOVE "I" TO PD-PROCEEDS-FG
                                PD-BALLOON-FG
                    MOVE "C" TO PD-REGPYAMT-FG
                 ELSE
                    PERFORM ICE-OR-A-MSG
                    GO TO F-421.

      * CITIZENS TEST
           MOVE 800 TO CIP-NO-OF-TIMES-CALLED.
      *    MOVE 0 TO CIP-NO-OF-TIMES-CALLED.
           MOVE PD-REGPYAMT TO CIP-REGPYAMT.
           MOVE PD-REGPYAMT-FG TO CIP-REGPYAMT-SW.
           MOVE PD-PROCEEDS-FG TO CIP-PROCEEDS-SW.
           MOVE PD-BALLOON-FG TO CIP-BALLOON-SW.
           PERFORM CALL-LOAN-CALCULATIONS.
           GO TO CREATE-ROUTINE.
       F-43.
           MOVE "EL"    TO CD-TYPE.
           MOVE VDUNUM0 TO PD-LC-CODE CD-EL-CODE.
           MOVE SPACES  TO CD-EL-FILLER.
           PERFORM GET-CD.
           IF IO-FG NOT = 0 AND PD-LC-CODE NOT = 0
              MOVE "INVALID CODE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.

       ENTRY-MODULE-EXIT.
           EXIT.

      *************************************************
       SET-UNITPER-INFO SECTION.
      *************************************************
           IF PD-ORGTERM > 1
              IF PD-UNITPER-CD = "D"
                 MOVE "M" TO PD-UNITPER-CD
                 MOVE 1 TO PD-UNITPER-FREQ
                 MOVE "NOTE: ------> SWITCHING BACK TO MONTHLY PAPER!!"
                                                          TO MESS
                 PERFORM SEND-MESS.

           MOVE PD-UNITPER-CD TO UPER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO UPER-UNITPER-FREQ.
           MOVE PD-INTDATE TO UPER-INTDATE.
           MOVE PD-ORIG-1STPYDATE TO UPER-1STPYDATE.
           MOVE PD-ORGTERM TO UPER-TERM.
           PERFORM UPER-CALCULATION.

           MOVE UPER-UNITPER-PER-YEAR TO PD-UNITPER-PER-YEAR.
           MOVE UPER-DAYS-IN-UNITPER TO PD-DAYS-IN-UNITPER.
           IF PD-ORGTERM = 1
              MOVE UPER-SINGLE-PAY-CD TO PD-UNITPER-CD
              MOVE UPER-SINGLE-PAY-FREQ TO PD-UNITPER-FREQ.

           MOVE "S  A010100." TO VDU.
           MOVE PD-UNITPER-CD TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "SN N030101." TO VDU.
           MOVE PD-UNITPER-FREQ TO VDUNUM0.
           PERFORM SCREENIO.

           IF PD-ORGTERM = 1
              MOVE "DEFAULTS FOR SINGLE PAY LOANS SET!!" TO MESS
              PERFORM SEND-MESS.

       SET-UNITPER-INFO-EXIT.
           EXIT.

      *************************************************
       AUTOPC-ROUTINE SECTION.
      *************************************************

           MOVE "A"                        TO AUTOPC-PC-ID.
           MOVE BRANCH                     TO AUTOPC-PC-BRANCH.
           MOVE PD-SSNO(1)                 TO AUTOPC-PC-SOC-SEC.
           MOVE "WI/AUTOPC" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH AUTOPC-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       AUTOPC-ROUTINE-EXIT.
           EXIT.

      ***********************************
       COLLATERAL-CREATE SECTION.
      ***********************************

           MOVE TEMP-PATH TO LTCREA-PATH.
           MOVE "WI/LTCREA" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LTCREA-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           MOVE "Y" TO F3-COLLATERAL.

       EXIT-COLLATERAL-CREATE.
           EXIT.

      ***********************************
       D00-BORROWER-ENTRY SECTION.
      ***********************************

      * --------SET BORR-CHG-FG ------------------
      *  1. FOR GEORGIA SERVICE CHARGE CALC.
      *  2. FOR NORTH CAROLINA ORIG. FEE TEST.

           IF NEW-FLAG NOT = 1
              MOVE "Y" TO BORR-CHG-FG.

           MOVE "N" TO BW-ERROR-YN.

           MOVE VDUNUM0 TO NUM-BW.
           MOVE NUM-BW TO PD-SSNO(ELE)
                          BW-SSNO.

           IF NUM-BW NOT = 0
              PERFORM UNPROTECT-BR-CONDITIONAL-FLDS
              GO TO D00-GET-BORROWER.

           IF ELE = 1
              MOVE "Y" TO BW-ERROR-YN
              GO TO D00-EXIT.

           MOVE 0 TO BW-SSNO.
           MOVE " " TO INSPECT-W.
       D00-NEXT-BW-CLEAR.
           MOVE 0 TO PD-SSNO(ELE).
           MOVE " " TO PD-MAKERCD(ELE).
      * ONLY HAVE 3 IN BALLOON, STILL NEED TO CLEAR PD THOUGH
           IF ELE < 4
              PERFORM SEND-BW-NO-NAME
              PERFORM SEND-BW-MAKERCD
              ADD 1 TO ELE
              GO TO D00-NEXT-BW-CLEAR.

           PERFORM E01-BW-CHECK-ENDORSER.
           MOVE "N" TO BW-ERROR-YN.
           GO TO D00-EXIT.

      * ONLY HERE IF YOU ENTERED A SSNO, NOT 0
       D00-GET-BORROWER.
           IF ELE = 3 OR 4
              MOVE COSIGNER-3-AND-4-SEQ TO PASSWDW-SEQ
              MOVE "TO ADD/CHANGE COSIGNER....:" TO PASSWDW-PROMPT2
              PERFORM VERIFY-PASSWORD
              IF PASSWDW-STAT NOT = "OK"
                 MOVE "Y" TO BW-ERROR-YN
                 GO TO D00-EXIT.

           PERFORM E00-BW-TABLE-CHECK.
           IF BW-ERROR-YES
              GO TO D00-EXIT.

           PERFORM OPEN-BW1-FILE.
           PERFORM GET-BORR-NAME.
           PERFORM CLOSE-BW1-FILE.
           PERFORM SEND-BW-NAME.

      * IF REQUIRED, GET APPLICATION TO MAKE LOAN.

           IF ( BW-ERROR-YES )
              GO TO D00-EXIT
           ELSE
             IF GP-VALID-BDATE = "Y"
                MOVE BW-BDATE TO NUM-DATE
                PERFORM TSTDAT
                IF NUM-DATE = 0
                   MOVE "BORROWER HAS AN INVALID BIRTHDATE" TO MESS
                   PERFORM SEND-MESS
                   MOVE "Y" TO BW-ERROR-YN
                   GO TO D00-EXIT.

           MOVE " " TO CHFG(2) CHFG(3) CHFG(4) CHFG(6)
                       CHFG(7) CHFG(8) CHFG(9).
           IF ELE = 1
                  AND QUOTE-ONLY
              MOVE "L" TO QUOTE-ID-FG.
           IF ELE = 1
              MOVE "M" TO PD-MAKERCD(1)
              PERFORM SEND-BW-MAKERCD
              MOVE BW-CONFIDENTIAL TO PD-CONFIDENTCD
              MOVE BW-ORIGIN TO PD-ORIGIN
              GO TO D00-EXIT.

       D00-ENTER-MAKER-CODE.
           MOVE "E  A010  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "Y" TO BW-ERROR-YN
              GO TO D00-EXIT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D00-ENTER-MAKER-CODE.
           IF VDUBUF NOT = "J"
              IF VDUBUF NOT = "E"
                 MOVE "(M-MAKER),J-JOINT,E-ENDORSER" TO MESS
                 PERFORM SEND-MESS
                 GO TO D00-ENTER-MAKER-CODE.
           MOVE VDUBUF TO PD-MAKERCD(ELE).

           GO TO D00-EXIT.

       D00-EXIT.
           EXIT.

      ****************************************
       D01-FIND-PRIOR-LOANS SECTION.
      ****************************************

      * FIND LOANS WITH SSNO(1)
           IF FIND-LOANS-FG = "N"
              GO TO D01-EXIT.

      * FIND ALL LOANS WITH THIS SSNO:
           MOVE PD-SSNO(1) TO FIND-SSNO.
           MOVE TRANS-DATE TO FIND-TRANS-DATE.
           MOVE PD-GIFTNET TO FIND-GIFTNET.
           MOVE "CL/FINDLN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH FINDLN-WORKERS.
           CANCEL FORM-PROGX.
           MOVE 1 TO SUB.

           MOVE "SN N060110." TO VDU.
           MOVE FOUND-NUMBER(SUB) TO VDUNUM0.
           PERFORM SCREENIO.

       D01-EXIT.
           EXIT.


      ***********************************
       D03-INSURANCE-ENTRY SECTION.
      ***********************************
           MOVE 0 TO IO-FG.
           SUBTRACT 26 FROM ELE GIVING I-LEVEL.
           MOVE PD-INSCOMP(I-LEVEL) TO INSCOMP-HLDR.
           MOVE VDUNUM0 TO PD-INSCOMP(I-LEVEL)
                           IC-CODE.
           IF IC-CODE = 0
              IF I-LEVEL > 4
                 GO TO D02-ENTER-IC-OURS
              ELSE
                 MOVE 9 TO IO-FG
                 GO TO D03-EXIT.

      * TEST PASSWD TO CHANGE DEFAULT INSURANCE COMPANY ON CL,AH,PP,O1
           IF I-LEVEL < 5
              IF IC-CODE NOT = INSCOMP-HLDR
                 MOVE INSCO-SEQ TO PASSWDW-SEQ
                 MOVE "TO CHANGE INS. COMPANY....:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    MOVE INSCOMP-HLDR TO PD-INSCOMP(I-LEVEL)
                    MOVE "SNNN020  0." TO VDU
                    MOVE ELE TO VDUROW
                    MOVE INSCOMP-HLDR TO VDUNUM0
                    PERFORM SCREENIO
                    MOVE 9 TO IO-FG
                    GO TO D03-EXIT.

           PERFORM OPEN-IC1-FILE.
           PERFORM READ-IC1-FILE.
           PERFORM CLOSE-IC1-FILE.
           IF IO-FG = 9
              MOVE "INVALID COMPANY" TO MESS
              PERFORM SEND-MESS
              MOVE INSCOMP-HLDR TO PD-INSCOMP(I-LEVEL)
              MOVE "SNNN020  0." TO VDU
              MOVE ELE TO VDUROW
              MOVE INSCOMP-HLDR TO VDUNUM0
              PERFORM SCREENIO
              GO TO D03-EXIT.

           IF I-LEVEL > 4
              IF PD-INSEXP-DATE(I-LEVEL) = 0
                 IF GP-OT-INS-TERM = "Y"
                    MOVE "I" TO PD-INS-FG(I-LEVEL)
                    MOVE "SNNN060  2." TO VDU
                    MOVE ELE TO VDUROW
                    MOVE PD-ORGTERM TO PD-INSTRM(I-LEVEL) VDUNUM0
                    PERFORM SCREENIO
                 ELSE
                    MOVE PD-INTDATE TO NDTE-DATE
                    MOVE PD-ORGTERM TO NDTE-HOLD
                    MOVE PD-UNITPER-CD TO DATER-UNITPER-CD
                    MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ
                    PERFORM INCREMENT-UNITPER
                    MOVE "SNNN060  2." TO VDU
                    MOVE ELE TO VDUROW
                    MOVE NDTE-DATE TO DATE-YYYYMMDD
                                      PD-INSEXP-DATE(I-LEVEL)
                    PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
                    MOVE DATE-MMDDYY TO VDUNUM0
                    PERFORM SCREENIO.

       D02-ENTER-IC-OURS.
           IF IC-CODE = 0
              MOVE " " TO PD-INSOURS(I-LEVEL)
              GO TO D03-SEND-IC-OURS.

           MOVE "SPACE = Y" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "R  A010  1." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE 9 TO IO-FG
              GO TO D03-EXIT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D02-ENTER-IC-OURS.
           IF VDUBUF = " "
              MOVE "Y" TO VDUBUF.
           IF VDUBUF NOT = "Y"
              IF VDUBUF NOT = "M"
                 MOVE "Y-YES, M-MEMO" TO MESS
                 PERFORM SEND-MESS
                 GO TO D02-ENTER-IC-OURS.
           IF GP-DEFAULT-O3-INSOURS NOT = " "
              IF ELE = 32
                 IF GP-DEFAULT-O3-INSOURS NOT = VDUBUF
                    MOVE " " TO MESS
                    STRING "INSURANCE OURS MUST BE '"
                               GP-DEFAULT-O3-INSOURS
                                "', PLEASE CHANGE!"
                           DELIMITED BY SIZE INTO MESS
                    PERFORM SEND-MESS
                    GO TO D02-ENTER-IC-OURS.
           MOVE PD-INSOURS(I-LEVEL) TO INSOURS-HLDR.
           MOVE VDUBUF TO PD-INSOURS(I-LEVEL).

       D03-SEND-IC-OURS.
           MOVE "S  A010  1." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INSOURS(I-LEVEL) TO VDUBUF.
           PERFORM SCREENIO.

           PERFORM RESET-LEGEND.
           IF IC-CODE NOT = 0
              IF SP-DEFAULT-O2-INS-COMP NUMERIC AND
                   SP-DEFAULT-O2-INS-COMP NOT = 0
                 IF ELE = 31
                   IF PD-INSOURS(I-LEVEL) = "Y"
                    IF IC-CODE NOT = SP-DEFAULT-O2-INS-COMP
                       MOVE " " TO MESS
                       STRING "INSURANCE COMPANY MUST BE "
                               SP-DEFAULT-O2-INS-COMP
                                ", PLEASE CHANGE!"
                           DELIMITED BY SIZE INTO MESS
                       PERFORM SEND-MESS
                       MOVE 9 TO IO-FG
                       GO TO D03-EXIT.
           IF IC-CODE NOT = 0 AND GP-DEFAULT-O3-INS-COMPANY NOT = 0
              IF ELE = 32
                 IF PD-INSOURS(I-LEVEL) = "Y"
                    IF IC-CODE NOT = GP-DEFAULT-O3-INS-COMPANY
                       MOVE " " TO MESS
                       STRING "INSURANCE COMPANY MUST BE "
                               GP-DEFAULT-O3-INS-COMPANYX
                                ", PLEASE CHANGE!"
                           DELIMITED BY SIZE INTO MESS
                       PERFORM SEND-MESS
                       MOVE 9 TO IO-FG
                       GO TO D03-EXIT.

       D03-ENTER-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM NOT = "Y"
              GO TO D03-ENTER-IC-EXP.
           IF IC-CODE = 0
              MOVE 0 TO PD-INSTRM(I-LEVEL)
              GO TO D03-SEND-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM = "Y"
              MOVE "RNNN060  2." TO VDU
           ELSE
              MOVE "RNNN030  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1U"
              GO TO D02-ENTER-IC-OURS.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D03-ENTER-IC-TERM.
           IF ( VDUNUM0 > 360 )
              GO TO D03-ENTER-IC-TERM.
           MOVE PD-INSTRM(I-LEVEL) TO INSTERM-HLDR.
           MOVE VDUNUM0 TO PD-INSTRM(I-LEVEL).
       D03-SEND-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM = "Y"
              MOVE "SN N060  2." TO VDU
           ELSE
              MOVE "SN N030  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INSTRM(I-LEVEL) TO VDUNUM0.
           PERFORM SCREENIO.
           GO TO D03-ENTER-IC-COVR.

       D03-ENTER-IC-EXP.
           IF IC-CODE = 0
              MOVE 0 TO PD-INSEXP-DATE(I-LEVEL)
              GO TO D03-SEND-IC-EXP.

           MOVE "RNNN060  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO D02-ENTER-IC-OURS.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D03-ENTER-IC-EXP.
           IF VDUNUM0 = 0
              GO TO D03-ENTER-IC-EXP.
      * NOT ENTERED AS A DATE FORMAT
           MOVE VDUNUM0 TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO PD-INSEXP-DATE(I-LEVEL)
                                 NUM-DATE.
           PERFORM TSTDAT.
           IF NUM-DATE = 0
              MOVE "INVALID DATE" TO MESS
              PERFORM SEND-MESS
              GO TO D03-ENTER-IC-EXP.
       D03-SEND-IC-EXP.
           MOVE "SNNN060  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INSEXP-DATE(I-LEVEL) TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO VDUNUM0.
           PERFORM SCREENIO.

       D03-ENTER-IC-COVR.
           IF IC-CODE = 0
              MOVE 0 TO PD-INSCOVR(I-LEVEL)
              GO TO D03-SEND-IC-COVR.
           MOVE "RNNN062  3." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO D03-ENTER-IC-TERM.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D03-ENTER-IC-COVR.
           MOVE PD-INSCOVR(I-LEVEL) TO AMT-HOLDER.
           MOVE VDUNUM2 TO PD-INSCOVR(I-LEVEL).
       D03-SEND-IC-COVR.
           MOVE "SN N062  3." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INSCOVR(I-LEVEL) TO VDUNUM2.
           PERFORM SCREENIO.
       D03-ENTER-IC-PREM.
           IF IC-CODE = 0
              MOVE 0 TO PD-INSPREM(I-LEVEL)
              GO TO D03-SEND-IC-PREM.
           MOVE "RNNN042  4." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO D03-ENTER-IC-COVR.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D03-ENTER-IC-PREM.

      * REGWAN PR# 3935
      * TEST PASSWD TO CHANGE CALCULATED PREMIUM ON PP
           IF I-LEVEL = 3
              IF VDUNUM2 NOT = PD-INSPREM(I-LEVEL)
                 MOVE PP-PREM-SEQ TO PASSWDW-SEQ
                 MOVE "TO CHANGE INS. PREMIUM...:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    MOVE "SN N042  4." TO VDU
                    MOVE ELE TO VDUROW
                    MOVE PD-INSPREM(I-LEVEL) TO VDUNUM2
                    PERFORM SCREENIO
                    MOVE 9 TO IO-FG
                    GO TO D03-ENTER-IC-PREM.

           MOVE PD-INSPREM(I-LEVEL) TO INSPREM-HLDR.
           MOVE VDUNUM2 TO PD-INSPREM(I-LEVEL).
       D03-SEND-IC-PREM.
           MOVE "SN N042  4." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INSPREM(I-LEVEL) TO VDUNUM2.
           PERFORM SCREENIO.
           IF I-LEVEL > 4
              IF GP-OT-INS-TERM NOT = "Y"
                 MOVE "I" TO PD-INS-FG(I-LEVEL)
                 MOVE PD-INTDATE              TO NUM-DATE
                 MOVE PD-INSEXP-DATE(I-LEVEL) TO SYS-DATE
                 PERFORM TIM360
                 MOVE ELAPSED-MONTHS TO PD-INSTRM(I-LEVEL)
              END-IF
              GO TO D03-CALC-ON-INS-ENTRY.
       D03-SEND-IC-CALC-FG.
           MOVE "S  A010  5." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-INS-FG(I-LEVEL) TO CALC-FG-HLDR.
           IF NOT (PD-INSCOMP(I-LEVEL) = INSCOMP-HLDR
                      AND PD-INSOURS(I-LEVEL) = INSOURS-HLDR
                       AND PD-INSTRM(I-LEVEL) = INSTERM-HLDR
                        AND PD-INSCOVR(I-LEVEL) = AMT-HOLDER
                         AND PD-INSPREM(I-LEVEL) = INSPREM-HLDR
                  )
              MOVE "I" TO VDUBUF PD-INS-FG(I-LEVEL)
           ELSE
              MOVE CALC-FG-HLDR TO VDUBUF
                                   PD-INS-FG(I-LEVEL).
           PERFORM SCREENIO.

       D03-ENTER-IC-CALC-FG.
           MOVE "E  A010  5." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO D03-ENTER-IC-PREM.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO D03-ENTER-IC-CALC-FG.
           MOVE VDUBUF TO PD-INS-FG(I-LEVEL).
           IF PD-INS-FG(I-LEVEL) NOT = "I"
              IF PD-INS-FG(I-LEVEL) NOT = "C"
                 PERFORM ICE-OR-A-MSG
                 GO TO D03-ENTER-IC-CALC-FG.

       D03-CALC-ON-INS-ENTRY.
           PERFORM D15-VALIDATE-CEP-MAX.
           IF IO-FG = 9
                 OR NEW-FLAG = 1
              GO TO D03-EXIT.

      *IF PREMIUM IS ZERO.. ZERO OUT ALL ASSOCIATED FIELDS FOR INSURANCE
           IF PD-INSPREM(I-LEVEL) = ZEROS
              MOVE ZEROS TO PD-INSCOMP(I-LEVEL)
                            PD-INSEFF-DATE(I-LEVEL)
                            PD-INSEXP-DATE(I-LEVEL)
                            PD-INSCOVR(I-LEVEL)
                            PD-INSCOMM(I-LEVEL)
              MOVE SPACES TO PD-INSOURS(I-LEVEL).

           MOVE PD-INSCOMP(I-LEVEL) TO CIP-INS-CO(I-LEVEL).
           MOVE PD-INSOURS(I-LEVEL) TO CIP-INS-USE-SW(I-LEVEL).
           MOVE PD-INSTRM(I-LEVEL) TO CIP-INS-TERM(I-LEVEL).
           MOVE PD-INSCOVR(I-LEVEL) TO CIP-INS-COVERAGE(I-LEVEL).
           MOVE PD-INSPREM(I-LEVEL) TO CIP-INS-PREMIUM(I-LEVEL).
           MOVE PD-INS-FG(I-LEVEL) TO CIP-INS-SW(I-LEVEL).
           MOVE PD-INS-TERM-SW(I-LEVEL) TO CIP-INS-TERM-SW(I-LEVEL).
           MOVE PD-COVERAGE-SW(I-LEVEL) TO CIP-COVERAGE-SW(I-LEVEL).
           MOVE PD-PREMIUM-SW(I-LEVEL) TO CIP-PREMIUM-SW(I-LEVEL).
           IF I-LEVEL > 4
              MOVE 0 TO CIP-NO-OF-TIMES-CALLED.
           PERFORM CALL-LOAN-CALCULATIONS.

       D03-EXIT.
           EXIT.


      *************************************************
       CHECK-FEECODES SECTION.
      *************************************************

      *FEECODE TABLE IS SET UP FROM THE INSURANCE YOU WRITE
      *(INSELIG) AND PASSED TO NCISA WHICH DETERMINES THE FEE
      *CODES THAT ARE IN VIOLATION.

      *MMM   (NO FEE CODES ENTERED)
      *FEECODE(1) = 92          NCINS-BAD-FEECODE = 92
      *FEECODE(2) = 93          NCINS-BAD-FEECODE = 93
      *FEECODE(3) = 94
      *ADVISE WRITE FEECODE 94 & NO UPDATE UNTIL FIXED
      *-------------------------------------------------
      *MGG   (FEE CODES 92,93,94 ENTERED)
      *FEECODE(1) = 92          NCINS-BAD-FEECODE = 92
      *FEECODE(2) = 93          NCINS-BAD-FEECODE = 93
      *ADVISE CAN'T WRITE 92 & 93, STOP FROM USING FEECODE 94 BECAUSE
      *NO PROPERTY WRITTEN
      *-------------------------------------------------
      *MGG   (NO FEE CODES ENTERED)
      *FEECODE(1) = 92          NCINS-BAD-FEECODE =
      *FEECODE(2) = 93          NCINS-BAD-FEECODE =
      *ADIVSE WRITE 92 & 93, STOP FROM USING FEECODE 94 BECAUSE
      *NO PROPERTY WRITTEN
      *-------------------------------------------------
      *FINDS FEE CODES FOR CL/AH/PP EVEN IF THEY DID NOT WRITE THE
      *INSURANCE. INSELIG ONLY PASSES THE FEE CODES ASSOCIATED WITH THE
      *INSURANCE WRITTEN TO NCINSA(N.C. RESTRICTION)

      * SET RESTRICTED FEES

           PERFORM VARYING ISUB FROM 1 BY 1 UNTIL ISUB > 7
             IF ISUB NOT > 4
               IF SP-INSFEE-FRMLA(ISUB) = "A"
                 IF INSFEECD(1)  = SPACES
                   MOVE SP-INSFEECD(ISUB) TO INSFEECD(1)
                END-IF
               END-IF
             END-IF
             IF ISUB = 5
                IF SP-INSFEE-FRMLA(ISUB) = "A"
                   MOVE SP-INSFEECD(5)      TO INSFEECD(2)
                END-IF
             END-IF
             IF ISUB > 5
                IF SP-INSFEE-FRMLA(ISUB) = "A"
                   IF INSFEECD(3) = SPACES
                      MOVE SP-INSFEECD(ISUB)  TO INSFEECD(3)
                   END-IF
                END-IF
             END-IF
           END-PERFORM.

      * SET BAD FEES STATUS

           MOVE ALL STAT---GOOD TO FEECODE-STATUS.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
              AFTER S2 FROM 1 BY 1 UNTIL S2 > 3
              IF FEECODE(S1) = NCINS-BAD-FEECODE(S2)
                 MOVE STAT---BAD TO FEECODE-STAT(S1)
              END-IF
           END-PERFORM.

      * NOT ALLOWED FEES

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
              AFTER S2 FROM 1 BY 1 UNTIL S2 > 10
              IF FEECODE(S1) = SPACES
                 IF PD-FEECODE(S2) =  INSFEECD(S1)
                    MOVE PD-FEECODE(S2) TO INVALID-FEE
                    MOVE MESSAGE-INVALID-FEE-NC TO MESS
                    PERFORM SEND-MESS
                    MOVE 9 TO IO-FG
                 END-IF
              END-IF
           END-PERFORM.

      * THESE FEES NEED ADDED BASED ON INSURANCE CODES
      * ALLOWED FEES

           MOVE ALL STAT---BAD TO FOUND-FEECODE-STATUS.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
             AFTER S2 FROM 1 BY 1 UNTIL S2 > 10
              IF FEECODE-STAT(S1) = STAT---GOOD
                 IF PD-FEECODE(S2) = FEECODE(S1)
                    MOVE STAT---GOOD TO FOUND-FEECODE-STAT(S1)
                 END-IF
              END-IF
           END-PERFORM.

           PERFORM VARYING S1 FROM 1 BY 1 UNTIL S1 > 3
             IF  FEECODE-STAT(S1) = STAT---GOOD
                IF FEECODE-STAT(S1) NOT = FOUND-FEECODE-STAT(S1)
                  MOVE FEECODE(S1) TO VALID-FEE
                  MOVE MESSAGE-VALID-FEES-NC TO MESS
                  PERFORM SEND-MESS
                  MOVE 9 TO IO-FG
                END-IF
             END-IF
           END-PERFORM.

       CHECK-FEECODES-EXIT.
           EXIT.


      *****************************************
       D05-CHECK-SP-EFFDATE SECTION.
      *****************************************
           MOVE PD-ORGST TO SP-ORGST.
           MOVE PD-SPRCLASS TO SP-SPRCLASS.
           MOVE PD-SUBCLASS TO SP-SUBCLASS.
           MOVE 0 TO SP-LAWCODE.

           PERFORM OPEN-SP1-FILE.
           PERFORM START-SP1-FILE.
       D05-CHECK-SP-EFFDATE-NEXT.
           PERFORM READ-SP1-FILE-NEXT.
           IF IO-FG = 9
              GO TO D05-EXIT.
           IF SP-ORGST NOT = PD-ORGST
              OR SP-SPRCLASS NOT = PD-SPRCLASS
                 OR SP-SUBCLASS NOT = PD-SUBCLASS
              MOVE 9 TO IO-FG
              GO TO D05-EXIT.

           MOVE PD-LOANDATE TO NUM-DATE.
           MOVE SP-EFFDATE TO SYS-DATE.
           IF SP-EFFDATE > PD-LOANDATE
              GO TO D05-CHECK-SP-EFFDATE-NEXT
           ELSE
              IF SP-EXPDATE = 0
                 GO TO D05-EXIT.

           IF SP-EXPDATE NOT > PD-LOANDATE
              GO TO D05-CHECK-SP-EFFDATE-NEXT.

       D05-EXIT.
           PERFORM CLOSE-SP1-FILE.

      ************************************
       D06-ENTER-HI-CREDIT SECTION.
      ************************************

           MOVE " " TO IO-TYPE.

           IF BR-AVAIL-CREDIT NOT = "Y" AND NOT = "S"
              MOVE 0 TO PD-CREDITLIM PD-WCBC-CREDITLIM
              GO TO D06-EXIT.

           IF LC-CALC-HI-CREDIT NOT = "W"
              MOVE 0 TO PD-WCBC-CREDITLIM
              GO TO SKIP-WCBC-CREDITLIM.

       ENTER-WCBC-CREDITLIM.
           MOVE "SN N060SEL." TO VDU.
           MOVE 0 TO VDUNUM0.
           PERFORM SCREENIO.

           MOVE "^-BACK, ENTER WCBC CREDIT LIMIT:" TO MESS.
           PERFORM SEND-LEGEND.

           MOVE "EN N060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO D06-EXIT.
           IF VDUSTATUS NOT = "00"
              PERFORM SCREENIO
              GO TO ENTER-WCBC-CREDITLIM.

           MOVE VDUNUM0 TO PD-WCBC-CREDITLIM.

           MOVE 0 TO PD-CREDITLIM.
           GO TO D06-EXIT.

       SKIP-WCBC-CREDITLIM.

           IF LC-CALC-HI-CREDIT = "C" OR "L" OR SPACE
              MOVE 0 TO PD-CREDITLIM
              GO TO D06-EXIT.

           MOVE "SN N060SEL." TO VDU.
           MOVE 0 TO VDUNUM0.
           PERFORM SCREENIO.

           MOVE "^-BACK, ENTER CREDIT LIMIT:" TO LEGEND.
           PERFORM SEND-LEGEND.

           MOVE "EN N060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO D06-EXIT.
           IF VDUSTATUS NOT = "00"
              PERFORM SCREENIO
              GO TO SKIP-WCBC-CREDITLIM.

           MOVE VDUNUM0 TO PD-CREDITLIM.

       D06-EXIT.
           EXIT.

      *********************************
       D07-MEMO-ENTRY SECTION.
      *********************************
           PERFORM SEND-MEMO.

       D07-ENTER-MEMO.
           MOVE "E  A300M2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS NOT = "00"
              GO TO D07-ENTER-MEMO.
           MOVE VDUBUF TO PD-MESSAGE.
           IF PD-MESSAGE = " "
              MOVE "M1 M2." TO MESS
              PERFORM RESET-MESS.

      ******************************************************************
       D08-TEST-ALLOT-LBOX SECTION.
      ******************************************************************

      * IF ANSWER TO "Y" TO ALLOTMENT THEN DO NOT ASK LOCK BOX QUESTION.

           PERFORM D08-UNDER-LBOX.
           IF IO-TYPE = "RTN"
              GO TO D08-TEST-ALLOT-LBOX-EXIT.

           IF PD-LBOX NOT = "Y"
              PERFORM D08-UNDER-ALLOTMENT.

       D08-TEST-ALLOT-LBOX-EXIT.
           EXIT.

      ****************************************
       D08-UNDER-ALLOTMENT SECTION.
      ****************************************
       D08-ACCT-ALLOT.
           MOVE " " TO PD-ALLOTCD
                       IO-TYPE.
           IF BR-ALLOTMNTS NOT = "Y"
              GO TO D08-EXIT.

           MOVE "^-BACK, ACCOUNT UNDER ALLOTMENT PLAN ?"
                    TO LEGEND
           PERFORM SEND-LEGEND.

           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO D08-EXIT.
           IF VDUSTATUS NOT = "00"
              GO TO D08-ACCT-ALLOT.

           MOVE VDUBUF TO ACTION.
           IF ACTION = "     Y"
              MOVE "Y" TO PD-ALLOTCD
           ELSE
              IF ACTION NOT = "     N"
                 GO TO D08-ACCT-ALLOT.

           MOVE " " TO LEGEND.
           PERFORM SEND-LEGEND.

       D08-EXIT.
           EXIT.

      ****************************************
       D08-UNDER-LBOX SECTION.
      ****************************************
       D08-ACCT-LBOX.
           MOVE " " TO PD-LBOX
                       IO-TYPE.
           IF BR-LBOX NOT = "Y"
              GO TO D08-UNDER-LBOX-EXIT.

           MOVE "^-BACK, ACCOUNT UNDER LOCK BOX PLAN ?"
                    TO LEGEND
           PERFORM SEND-LEGEND.

           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO D08-UNDER-LBOX-EXIT.
           IF VDUSTATUS NOT = "00"
              GO TO D08-ACCT-LBOX.

           MOVE VDUBUF TO ACTION.
           IF ACTION = "     Y"
              MOVE "Y" TO PD-LBOX
           ELSE
              IF ACTION NOT = "     N"
                 GO TO D08-ACCT-LBOX.

           MOVE " " TO LEGEND.
           PERFORM SEND-LEGEND.

       D08-UNDER-LBOX-EXIT.
           EXIT.

      ********************************************
       GET-PRIOR-COLLATERAL SECTION.
      ********************************************

           PERFORM OPEN-LTC1-FILE.
           MOVE PD-OWNBR  TO LTC-BRNO.
           MOVE PD-PRLNNO TO LTC-ACCTNO
                             WSS-LN-ACCTNO.
           MOVE 1         TO LTC-SEQNO.
           PERFORM READ-LTC1-FILE.
      *    UNLOCK LTC-FILE.
           IF IO-FG NOT = 0
              MOVE SPACES TO WK-AUTO-1
              MOVE 0 TO WK-MILEAGE-1 WK-VALUE-1
                        WK-SELLPR-1 WK-MISC-AMT-1 WK-VIN-CHG-DATE-1
              MOVE SPACES TO WK-AUTO-2
              MOVE 0 TO WK-MILEAGE-2 WK-VALUE-2
                        WK-SELLPR-2 WK-MISC-AMT-2 WK-VIN-CHG-DATE-2
              MOVE SPACES TO WK-AUTO-3
              MOVE 0 TO WK-MILEAGE-3 WK-VALUE-3
                        WK-SELLPR-3 WK-MISC-AMT-3 WK-VIN-CHG-DATE-3
              MOVE SPACES TO WK-HHGS-1
              MOVE SPACES TO WK-HHGS-2
              MOVE SPACES TO WK-HHGS-3
           ELSE
              MOVE LTC-AUTO(1) TO WK-AUTO-1
              MOVE LTC-AUTO(2) TO WK-AUTO-2
              MOVE SPACES      TO WK-AUTO-3
              MOVE 0 TO WK-MILEAGE-3 WK-VALUE-3
                        WK-SELLPR-3 WK-MISC-AMT-3 WK-VIN-CHG-DATE-3
              MOVE LTC-HHGS(1) TO WK-HHGS-1
              MOVE LTC-HHGS(2) TO WK-HHGS-2
              MOVE LTC-HHGS(3) TO WK-HHGS-3.

           PERFORM CLOSE-LTC1-FILE.

           PERFORM OPEN-WK-FILE.
           MOVE 6 TO WK-KEY.
           PERFORM WRITE-WK-FILE.
           IF IO-FG = 9
              PERFORM REWRITE-WK-FILE.
           PERFORM CLOSE-WK-FILE.

           PERFORM X02-DISPLAY-TRAILER-REC.

           MOVE "S  A020080." TO VDU.
           MOVE SAVED-PRIOR-COLLCD TO PD-COLLCD VDUBUF.
           PERFORM SCREENIO.

           MOVE "CO"      TO CD-TYPE.
           MOVE PD-COLLCD TO CD-CODE.
           PERFORM GET-CD.
           MOVE "S  A020081." TO VDU.
           MOVE CD-DESC       TO VDUBUF.
           PERFORM SCREENIO.

           MOVE "S  A200200." TO VDU.
           MOVE SAVED-PRIOR-COLLID TO PD-COLLID VDUBUF.
           PERFORM SCREENIO.

       GET-PRIOR-COLLATERAL-EXIT.
           EXIT.

      ******************************************************
       SET-CY-CT-SCAN SECTION.
      ******************************************************

      * SET FLAGS TO ALLOW OR DISALLOW SCAN ON CITY & COUNTY
      * DEPENDING IF THE STATE IS IN CODE FILE (TYPE CY & CT)

           IF BR-FORCE-VALID-CITY-COUNTY NOT = "Y"
              MOVE "N" TO ALLOW-CITY-SCAN-FG
           ELSE
              MOVE SPACES TO CD-CY-CITY
              PERFORM DO-STATE-CY-EXIST
              IF DO-STATE-CY-EXIST-FG = "Y"
                 MOVE "Y" TO ALLOW-CITY-SCAN-FG
              ELSE
                 MOVE "N" TO ALLOW-CITY-SCAN-FG.

           MOVE "N" TO ALLOW-COUNTY-SCAN-FG.
           IF BR-FORCE-VALID-CITY-COUNTY = "Y"
              MOVE SPACES TO CD-CT-COUNTY
              PERFORM DO-STATE-CT-EXIST
              IF DO-STATE-CT-EXIST-FG = "Y"
                 MOVE "Y" TO ALLOW-COUNTY-SCAN-FG.
       SET-CY-CT-SCAN-EXIT.
           EXIT.

      ********************************************************
       VALIDATE-REQUIRED-FIELD SECTION.
      ***********************************************************

      * MUST VERIFY IF BR-FORCE-VALID-CITY-COUNTY = "Y", THAT THE
      * FIELD ENTRIES IN CITY & COUNTY EXIST IN THE CODE-FILE FOR
      * TYPES CT & CY

           MOVE "N" TO ALLOW-BW-UPDATE-FG.
           IF BR-FORCE-VALID-CITY-COUNTY NOT = "Y"
              MOVE "Y" TO ALLOW-BW-UPDATE-FG
              GO TO VALIDATE-REQUIRED-FIELD-EXIT.

           MOVE BW-CITY-TAX-CD  TO CD-CY-CITY.
           PERFORM DO-STATE-CY-EXIST.
           IF DO-STATE-CY-EXIST-FG NOT = "Y" OR
              CD-CY-CITY NOT = BW-CITY-TAX-CD
              MOVE "N" TO ALLOW-BW-UPDATE-FG
              MOVE "CITY NOT ON FILE FOR STATE" TO MESS
              PERFORM SEND-MESS
              GO TO VALIDATE-REQUIRED-FIELD-EXIT.
           IF BW-STATE = "KY"
             IF PD-INSTYPES-PP2  
                IF (CD-CY-INSTAXFRMLA(7) = "F"
                   AND CD-CY-INSTAXAMT(7) = 99.99)
                     MOVE CITY-COUNTY-TAX-SEQ TO PASSWDW-SEQ
                     MOVE "TO USE 99.99 PP2 CITY TAX RATE" 
                                                  TO PASSWDW-PROMPT2
                     PERFORM VERIFY-PASSWORD
                     IF PASSWDW-STAT NOT = "OK"
                        MOVE 9 TO IO-FG
                        MOVE
                  "PASSWORD REQUIRED TO USE THIS CITY TAX RATE" TO MESS
                        PERFORM SEND-MESS
                        MOVE "N" TO ALLOW-BW-UPDATE-FG
                        GO TO VALIDATE-REQUIRED-FIELD-EXIT.
    
           IF BW-STATE = "KY"
             IF PD-INSTYPES-O1 
                IF (CD-CY-INSTAXFRMLA(8) = "F"
                   AND CD-CY-INSTAXAMT(8) = 99.99)
                     MOVE CITY-COUNTY-TAX-SEQ TO PASSWDW-SEQ
                     MOVE "TO USE 99.99 O1 CITY TAX RATE" 
                                                  TO PASSWDW-PROMPT2
                     PERFORM VERIFY-PASSWORD
                     IF PASSWDW-STAT NOT = "OK"
                       MOVE 9 TO IO-FG
                       MOVE
                  "PASSWORD REQUIRED TO USE THIS CITY TAX RATE" TO MESS
                      PERFORM SEND-MESS
                      MOVE "N" TO ALLOW-BW-UPDATE-FG
                      GO TO VALIDATE-REQUIRED-FIELD-EXIT.

       CHECK-FOR-VALID-COUNTY.
           IF ALLOW-COUNTY-SCAN-FG NOT = "Y"
              GO TO VALIDATE-REQUIRED-FIELD-EXIT.

           MOVE BW-COUNTY TO CD-CT-COUNTY.
           PERFORM DO-STATE-CT-EXIST.

           IF DO-STATE-CT-EXIST-FG NOT = "Y" OR
              CD-CT-COUNTY NOT = BW-COUNTY
              MOVE "N" TO ALLOW-BW-UPDATE-FG
              MOVE "COUNTY NOT ON FILE FOR STATE" TO MESS
              PERFORM SEND-MESS
              GO TO VALIDATE-REQUIRED-FIELD-EXIT.

           IF BW-STATE = "KY"
             IF PD-INSTYPES-PP2  
                IF (CD-CY-INSTAXFRMLA(7) = "F"
                   AND CD-CY-INSTAXAMT(7) = 99.99)
                     MOVE CITY-COUNTY-TAX-SEQ TO PASSWDW-SEQ
                     MOVE "TO USE 99.99 PP2 CITY TAX RATE" 
                                                  TO PASSWDW-PROMPT2
                     PERFORM VERIFY-PASSWORD
                     IF PASSWDW-STAT NOT = "OK"
                        MOVE 9 TO IO-FG
                        MOVE
                  "PASSWORD REQUIRED TO USE THIS CITY TAX RATE" TO MESS
                        PERFORM SEND-MESS
                        MOVE "N" TO ALLOW-BW-UPDATE-FG
                        GO TO VALIDATE-REQUIRED-FIELD-EXIT.
    
           IF BW-STATE = "KY"
             IF PD-INSTYPES-O1 
                IF (CD-CY-INSTAXFRMLA(8) = "F"
                   AND CD-CY-INSTAXAMT(8) = 99.99)
                     MOVE CITY-COUNTY-TAX-SEQ TO PASSWDW-SEQ
                     MOVE "TO USE 99.99 O1 CITY TAX RATE" 
                                                  TO PASSWDW-PROMPT2
                     PERFORM VERIFY-PASSWORD
                     IF PASSWDW-STAT NOT = "OK"
                       MOVE 9 TO IO-FG
                       MOVE
                  "PASSWORD REQUIRED TO USE THIS CITY TAX RATE" TO MESS
                      PERFORM SEND-MESS
                      MOVE "N" TO ALLOW-BW-UPDATE-FG
                      GO TO VALIDATE-REQUIRED-FIELD-EXIT.

       VALIDATE-REQUIRED-FIELD-END.
           MOVE "Y" TO ALLOW-BW-UPDATE-FG.

       VALIDATE-REQUIRED-FIELD-EXIT.
           EXIT.

      ******************************************************************
       DO-STATE-CY-EXIST SECTION.
      ******************************************************************

      * DETERMINE IF A VALID CD-CY-REC EXISTS FOR THE BORROWERS STATE

           MOVE " " TO DO-STATE-CY-EXIST-FG.

           PERFORM OPEN-CD1-FILE.

      * SETUP CD-CY-CITY BEFORE PERFORM DO-STATE-CY-EXIST

           MOVE "CY"       TO CD-TYPE.
           MOVE BW-STATE   TO CD-CY-STATE.
           MOVE SPACES     TO CD-CY-FILLER.
           PERFORM START-CD1-FILE.
           PERFORM READ-CD1-FILE-NEXT.
           IF IO-BAD
              GO TO DO-STATE-CY-EXIST-EXIT.

           IF CD-TYPE = "CY" AND CD-CY-STATE = BW-STATE
              MOVE "Y" TO DO-STATE-CY-EXIST-FG.
   
       DO-STATE-CY-EXIST-EXIT.
           PERFORM CLOSE-CD1-FILE.

      ******************************************************************
       DO-STATE-CT-EXIST SECTION.
      ******************************************************************

      * DETERMINE IF A VALID CD-CT-REC EXISTS FOR THE BORROWERS STATE
           MOVE " " TO DO-STATE-CT-EXIST-FG.

           PERFORM OPEN-CD1-FILE.

      * SETUP CD-CT-COUNTY BEFORE PERFORM DO-STATE-CT-EXIST
           MOVE "CT"       TO CD-TYPE.
           MOVE BW-STATE   TO CD-CT-STATE.
           MOVE SPACES     TO CD-CT-FILLER.
           PERFORM START-CD1-FILE.
           PERFORM READ-CD1-FILE-NEXT.
           IF IO-BAD
              GO TO DO-STATE-CT-EXIST-EXIT.

           IF CD-TYPE = "CT" AND CD-CT-STATE = BW-STATE
              MOVE "Y" TO DO-STATE-CT-EXIST-FG.
   
       DO-STATE-CT-EXIST-EXIT.
           PERFORM CLOSE-CD1-FILE.

      ***********************************
       D09-WRITE-SCRATCH SECTION.
      ***********************************
           MOVE "LOAN TEMP SAVE IN PROGRESS.........." TO LEGEND.
           PERFORM SEND-LEGEND.

           PERFORM OPEN-PD1-FILE.
           MOVE PD-RECORD  TO WK-SAVE-RECORD.
           MOVE PD-SSNO(1) TO SAVE-SSNO.
           PERFORM SET-SCRATCH-KEY.
           IF QUOTE-ONLY
              MOVE "Q" TO PD-ID
              MOVE PD2-KEY TO SAVE-PD2-KEY.

           PERFORM READ-PD1-FILE.
           MOVE WK-SAVE-RECORD TO PD-RECORD.
           IF QUOTE-ONLY
              MOVE "Q" TO PD-ID
              MOVE SAVE-PD2-KEY TO PD2-KEY.

           MOVE PD-ID        TO PD2-ID.
           MOVE PD-BRANCH    TO PD2-BRANCH.
           MOVE HOLD-BW-NAME TO PD2-BWNAME.
           IF IO-FG = 9
              MOVE "Y" TO NEW-PD-RECORD-FG
              GO TO D09-CREATE-NEW-SCRATCH
           ELSE
              MOVE " " TO NEW-PD-RECORD-FG.
           PERFORM REWRITE-PD1-FILE.
           GO TO D09-EXIT.

       D09-CREATE-NEW-SCRATCH.
           PERFORM SET-SCRATCH-KEY.
           IF QUOTE-ONLY
              MOVE "Q" TO PD-ID.
           PERFORM WRITE-PD1-FILE.
           IF IO-FG = 9
              MOVE "RECORD EXISTS FOR RECALL # " TO MESS
              PERFORM SEND-MESS
              MOVE "PLEASE RE-ENTER RECALL # AND RE-INPUT" TO MESS
              PERFORM SEND-MESS.

       D09-EXIT.
           IF F3-YES
              PERFORM E02-CREATE-LT-SCRATCH.
           PERFORM CLOSE-PD1-FILE.

      ***********************************
       D10-DELETE-SCRATCH SECTION.
      ***********************************
           MOVE "LOAN TEMP DELETE IN PROGRESS........" TO LEGEND.
           PERFORM SEND-LEGEND.

           PERFORM OPEN-PD1-FILE.
           MOVE PD-SSNO(1) TO SAVE-SSNO.
           PERFORM SET-SCRATCH-KEY.
           IF QUOTE-ONLY
                 OR QUOTE-CHANGED-TO-LOAN
              MOVE "Q" TO PD-ID.

           PERFORM READ-PD1-FILE.
           IF IO-FG = 0
              PERFORM DELETE-PD1-FILE.

           MOVE PD-SSNO(1) TO PC-SOC-SEC.
           MOVE BRANCH     TO PC-BRANCH
                              PC2-BRANCH.
           MOVE "C"        TO PC-ID.
           PERFORM OPEN-PC1-FILE.
           PERFORM READ-PC1-FILE.
           IF IO-FG = 0
              PERFORM DELETE-PC1-FILE.

           PERFORM CLOSE-PC1-FILE.
           PERFORM CLOSE-PD1-FILE.


      *****************************************
       D12-PROCESS-PRIOR-LN SECTION.
      *****************************************
           MOVE " " TO PASS-STAT-FG.

           IF ( PD-PRLNNO = 0 ) OR
              ( NOT ( PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO" ))
                GO TO D12-EXIT.

           MOVE " " TO RESCISSION-FLAG.
           MOVE PD-PRLNNO TO W-LNNO PASS-PRLNNO.
           MOVE TRANS-DATE TO PASS-TRANS-DATE.
           IF PD-POCD-INRESCISSION
      * NEED THIS FLAG TO TEST IF READ ON PD1 IS SUCCESSFUL, THEY
      * MANUALLY PAID OUT THE PRIOR LOAN, NOT ALLOWED, BUT THEN
      * YOU LOSE THE PD-POCD TO TEST IF ENTERING A RESCISSION LOAN...
              MOVE "Y" TO RESCISSION-FLAG
              MOVE PD-INTDATE TO PASS-TRANS-DATE.

           MOVE PD-SRCD TO PASS-CURRENT-PD-SRCD.
           MOVE PD-CLASS TO PASSX-CURRENT-PD-CLASS.
           MOVE PD-REC TO WK-SAVE-RECORD.
           MOVE " " TO SAVED-PRIOR-COLLCD
                       SAVED-PRIOR-COLLID.
           MOVE 0 TO SAVED-PD-PRIOR-RN-FOR10-DATE
                     SAVED-PD-LAST-RN-FOR10-DATE.

           MOVE "R" TO PD-ID.
           MOVE BRANCH TO PD-BRANCH.
           MOVE PD-PRLNNO TO PD-SOC-SEC.
           PERFORM GET-PD1.
           IF IO-FG = 9
              IF NOT (QUOTE-ONLY OR PD-POCD-INRESCISSION)
                 GO TO D12-END
              ELSE
                 GO TO D12-GET-PAYOFF
           ELSE
      * IF MAKING A RESCISSION LOAN, AND YOU FIND THE PD FOR A MANUAL
      * PAYOFF, DONT ALLOW IT....
              IF RESCISSION-FLAG = "Y"
                 MOVE "Z" TO PASS-STAT-FG
                 GO TO D12-END.

           MOVE PD-PRPDUE-DAYS TO SAVE-PRPDUE-DAYS.
           MOVE PD-PRLNAMT TO SAVE-PRLNAMT.


      * WORLD PR# 734
      * IF LOAN BEING PAID OFF IS LESS THAN 75 DAYS OLD, YOU CAN NOT RENEW!
           IF SP-RENEWAL-EDIT = "A"
      * ONLY TEST IF PRIOR LOAN WAS MADE 3/21/11 OR LATER WHEN LAW IN EFFECT
      * PD-LOANDATE = LOANDATE OF LOAN TO BE RENEWED
              IF PD-LOANDATE >= 20110321
      * PD-LOANDATE = LOANDATE OF LOAN TO BE RENEWED
                 MOVE PD-LOANDATE TO NUM-DATE
                 MOVE TRANS-DATE  TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS < 75
                    MOVE 9 TO IO-FG
                    MOVE "LESS THAN 75 DAYS" TO MESS
                    PERFORM SEND-MESS
                    GO TO D12-END.


           COMPUTE PRIOR-LNAMT ROUNDED =
                (PD-PRBAL + PD-PRINTDUE)
                              - (PD-PRFINCHGRB + PD-PRINSRB).

           IF PD-PLDATE NOT = 0
                     OR PD-CURBAL = 0
              MOVE "Z" TO PASS-STAT-FG
              GO TO D12-END.

           IF PASS-CURRENT-PD-SRCD = "SC"
              IF PD-SALEFIN NOT = "Y"
                        OR PD-SERVACCT NOT = "N"
                 MOVE "S" TO PASS-STAT-FG
                 GO TO D12-END.
      *--------------------------------------------------------
      *    IF RENEWAL IS FOR A SALES FINANCE ACCOUNT,
      *       ONLY ALLOW 'SC'
      *--------------------------------------------------------
           IF PD-SALEFIN = "Y" AND
              PASS-CURRENT-PD-SRCD NOT = "SC"
              MOVE "N" TO PASS-STAT-FG
              GO TO D12-END.

      *---------------------------------------------------------------
      *    INSURE THAT TRCD OF RENEWED LOAN MATCHS THE SOURCE CODE
      *    OF THIS LOAN BEING BOOKED NOW
      *---------------------------------------------------------------
           MOVE PD-PO-TRCD TO HOLD-PRIOR-PO-TRCD.
           IF PD-PO-TRCD NOT = PASS-CURRENT-PD-SRCD
              MOVE "J" TO PASS-STAT-FG
              GO TO D12-END.

           MOVE PD-SSNO(1) TO SAVE-SSNO.

           MOVE PD-ORGST TO CIP-PRIOR-LOAN-STATE.
           MOVE PD-CLASS TO CIP-PRIOR-LOAN-CLASS.
           MOVE PD-SUBCLASS TO CIP-PRIOR-SUB-CLASS.
           MOVE PD-PRBAL TO CIP-PRBAL.
           MOVE PD-PRINTDUE TO CIP-PRINTDUE.

           MOVE PD-PRFINCHGRB TO CIP-PRFINCHGRB.
           MOVE PD-PRINSRB TO CIP-PRINSRB.
           MOVE PD-LOANDATE TO CIP-PRIOR-LOAN-DATE.
           MOVE PD-PRPAID-AHEAD TO CIP-PRPAID-AHEAD.

           MOVE PD-COLLCD TO SAVED-PRIOR-COLLCD.
           MOVE PD-COLLID TO SAVED-PRIOR-COLLID.
           MOVE PD-PRIOR-RN-FOR10-DATE TO SAVED-PD-PRIOR-RN-FOR10-DATE.
           MOVE PD-LAST-RN-FOR10-DATE  TO SAVED-PD-LAST-RN-FOR10-DATE.

           MOVE PD-BNKRPTDATE TO PRIOR-BNKRPTDATE.

           GO TO D12-END.

       D12-GET-PAYOFF.
           MOVE 0 TO IO-FG.

           MOVE "LP/PAYOFX" TO FORM-NAM.
           MOVE "CALCULATING - PLEASE WAIT" TO LEGEND.
           PERFORM SEND-LEGEND.
           CALL FORM-PROGX USING FORM-PATH PASS-PAYOFF-FLDS.
           CANCEL FORM-PROGX.

           PERFORM D17-TEST-FOR-GEORGIA-SCHG.
           PERFORM D18-TEST-FOR-SC-SCHG.
           PERFORM TEST-FOR-WI-SCHG.
           PERFORM D18-TEST-FOR-MFEE.
           PERFORM RESET-LEGEND.

           IF ERROR-IN-PAYOFF
              MOVE 9 TO IO-FG
              GO TO D12-END.

      * PL# 395, NEEDED THIS FOR RESCISSION CATCH, LONPFA CATCHES OTHERS
           IF PASS-PRFINCHGRB > 99999.99
              MOVE "MUST DO MANUAL 'RI' OR RENEWAL WONT WORK" TO MESS
              PERFORM SEND-MESS
              MOVE 9 TO IO-FG
              GO TO D12-END.

           COMPUTE PRIOR-LNAMT ROUNDED =
                (PASS-PRBAL + PASS-PRINTDUE)
                        - (PASS-PRFINCHGRB + PASS-PRINSRB).

           MOVE PASS-PRIOR-LOAN-STATE TO CIP-PRIOR-LOAN-STATE.
           MOVE PASS-PRIOR-LOAN-CLASS TO CIP-PRIOR-LOAN-CLASS.
           MOVE PASS-PRIOR-SUB-CLASS TO CIP-PRIOR-SUB-CLASS.
           MOVE PASS-PRBAL TO CIP-PRBAL.
           MOVE PASS-PRINTDUE TO CIP-PRINTDUE.

           MOVE PASS-PRFINCHGRB TO CIP-PRFINCHGRB.
           MOVE PASS-PRINSRB TO CIP-PRINSRB.
           MOVE PASS-PRIOR-LOAN-DATE TO CIP-PRIOR-LOAN-DATE.

           IF PASS-CDEL-ARREARAGE > 0
              MOVE PASS-CDEL-ARREARAGE TO CIP-PRPAID-AHEAD
           ELSE
              MOVE 0 TO CIP-PRPAID-AHEAD.

           MOVE PASS-SSNO TO SAVE-SSNO.

       D12-END.
           MOVE WK-SAVE-RECORD TO PD-REC.
           IF IO-FG = 9
              MOVE "E" TO PRIOR-LOAN-STAT
              GO TO D12-EXIT.

           MOVE CIP-PRBAL TO PD-PRBAL.
           MOVE CIP-PRINTDUE TO PD-PRINTDUE.
           MOVE CIP-PRFINCHGRB TO PD-PRFINCHGRB.
           MOVE CIP-PRINSRB TO PD-PRINSRB.
           MOVE CIP-PRPAID-AHEAD TO PD-PRPAID-AHEAD.
           IF NOT PRIOR-LOAN-NOT-VALID
              IF CAN-LOAN-NO NOT = " "
                 IF PRIOR-LNAMT > PD-CAN-LOAN-MAX
                    MOVE "PRIOR LOAN AMOUNT EXCEEDS CANNED LOAN MAX"
                                                          TO MESS
                    PERFORM SEND-MESS
                    MOVE 9 TO IO-FG
                    GO TO D12-END
                 ELSE
                    MOVE "SNNN062120." TO VDU
                    SUBTRACT PRIOR-LNAMT FROM PD-CAN-LOAN-MAX
                                            GIVING VDUNUM2
                                                   PD-PROCEEDS
                                                   CIP-PROCEEDS
                    PERFORM SCREENIO
                 END-IF
              END-IF
              IF NEW-FLAG NOT = 1
      *          MOVE 0 TO CIP-NO-OF-TIMES-CALLED
      * WORLD A90 MOVES A 1 TO CIP-NO-TIMES-CALLED???????????
                 MOVE 800 TO CIP-NO-OF-TIMES-CALLED
                 PERFORM CALL-LOAN-CALCULATIONS.

           MOVE " " TO PRIOR-LOAN-STAT.

       D12-EXIT.
           EXIT.

      *****************************************
       D15-VALIDATE-CEP-MAX SECTION.
      *****************************************
           MOVE 0 TO IO-FG.
           IF NEW-FLAG = 1
              GO TO D15-EXIT.

           IF ELE = 21
              IF PD-OVRDRATE-FG = "E"
                        AND PD-OVRDRATE > CEP-EFF-RATE
                 MOVE "EFF. RATE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-EFF-RATE TO HOLD-RATE-EXCEEDED
                 GO TO D15-EXCEEDS-MAX.
           IF ELE = 21
              IF PD-OVRDRATE-FG = "A"
                        AND PD-OVRDRATE > CEP-APR-RATE
                 MOVE "APR RATE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-APR-RATE TO HOLD-RATE-EXCEEDED
                 GO TO D15-EXCEEDS-MAX.
           IF ELE = 27 OR 28 OR 29 OR 30
              SUBTRACT 26 FROM ELE GIVING I-LEVEL
              IF PD-INS-FG(I-LEVEL) NOT = "C"
               IF PD-INSTRM(I-LEVEL) > CEP-INS-TERM(I-LEVEL)
                  MOVE "INS. TERM" TO TYPE-OF-AMT-EXCEEDED
                  MOVE CEP-INS-TERM(I-LEVEL) TO HOLD-TERM-EXCEEDED
                  GO TO D15-EXCEEDS-MAX
               ELSE
               IF PD-INSPREM(I-LEVEL) > CEP-INS-PREMIUM(I-LEVEL)
                  MOVE "INS. PREMIUM" TO TYPE-OF-AMT-EXCEEDED
                  MOVE CEP-INS-PREMIUM(I-LEVEL) TO HOLD-AMT-EXCEEDED
                  GO TO D15-EXCEEDS-MAX
               ELSE
      * PERSONAL PROPERTY MUST CHECK SP-INSMAXCHGABL FOR 888888
               IF ELE NOT = 29 AND NOT = 30
                 IF PD-INSCOVR(I-LEVEL) > CEP-INS-COVERAGE(I-LEVEL)
                   MOVE "INS. COVERAGE" TO TYPE-OF-AMT-EXCEEDED
                   MOVE CEP-INS-COVERAGE(I-LEVEL) TO HOLD-AMT-EXCEEDED
                   GO TO D15-EXCEEDS-MAX
                 ELSE
                   NEXT SENTENCE
               ELSE
                 PERFORM D15-TEST-PP
      * PERSONAL PROPERTY OF 888888, SKIP MAX TEST
                 IF NOT SP-INSMAXCHGABL-OVRIDE(ILEV)
                  IF PD-INSCOVR(I-LEVEL) > CEP-INS-COVERAGE(I-LEVEL)
                   MOVE "INS. COVERAGE" TO TYPE-OF-AMT-EXCEEDED
                   MOVE CEP-INS-COVERAGE(I-LEVEL) TO HOLD-AMT-EXCEEDED
                   GO TO D15-EXCEEDS-MAX.

           IF ELE = 34
              IF PD-SERCHG > CEP-SERVICE-CHG
                 MOVE "SERVICE CHG" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-SERVICE-CHG TO HOLD-AMT-EXCEEDED
                 GO TO D15-EXCEEDS-MAX.
           IF ELE = 35
              MULTIPLY PD-MAINTFEE BY PD-ORGTERM GIVING AMT-HOLDER
                 ROUNDED
              IF AMT-HOLDER > CEP-MAINT-FEES
                 MOVE "MAINT. FEE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-MAINT-FEES TO HOLD-AMT-EXCEEDED
                 GO TO D15-EXCEEDS-MAX.
           IF ELE = 36
              IF PD-EXTCHG > CEP-1ST-PY-EXT
                 MOVE "EXT. CHG" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-1ST-PY-EXT TO HOLD-AMT-EXCEEDED
                 GO TO D15-EXCEEDS-MAX.

           GO TO D15-EXIT.

       D15-TEST-PP.
           IF PD-INSTYPES-PP
              SET ILEV TO 6
           ELSE
              SET ILEV TO 7.
           IF ELE = 30
              SET ILEV TO 8.

       D15-EXCEEDS-MAX.
           UNSTRING AMT-EXCEEDED-LIT DELIMITED BY ALL " "
                                 INTO MESS AMT-EXCEEDED-LIT.
           STRING TYPE-OF-AMT-EXCEEDED DELIMITED BY "  "
                       " EXCEEDS CURRENT MAXIMUM OF ",
                       AMT-EXCEEDED-LIT DELIMITED BY SIZE INTO MESS.
           PERFORM SEND-MESS.
           MOVE " " TO MESS AMT-EXCEEDED-LIT.
           MOVE 9 TO IO-FG.

       D15-EXIT.
           EXIT.

      *****************************************
       D16-TEST-NC-ORIG-FEES SECTION.
      *****************************************

      * TEST FOR NORTH CAROLINA VALID INS.ORIG FEE

           MOVE " " TO NCINS-ERRCD
                       NCINS-TYPE-CD
                       NCINS-BAD-FEECODE-TABLE.

           IF (QUOTE-ONLY)
               OR (NOT
                      (
                        (SP-INSFEE-FRMLA(1) = "A")
                          OR (SP-INSFEE-FRMLA(2) = "A")
                           OR (SP-INSFEE-FRMLA(3) = "A")
                            OR (SP-INSFEE-FRMLA(4) = "A")
                             OR (SP-INSFEE-FRMLA(5) = "A")
                              OR (SP-INSFEE-FRMLA(6) = "A")
                               OR (SP-INSFEE-FRMLA(7) = "A")
                      )
                  )
              GO TO D16-EXIT.

           MOVE TRANS-DATE TO NCINS-TRANS-DATE.

           MOVE PD-PRLNNO TO NCINS-PRIOR-ACCTNO.
           MOVE PD-ORGST TO NCINS-ORGST.
           MOVE PD-SSNO(1) TO NCINS-LN-SSNO(1).
           MOVE PD-SSNO(2) TO NCINS-LN-SSNO(2).
           MOVE PD-SSNO(3) TO NCINS-LN-SSNO(3).
           MOVE PD-SSNO(4) TO NCINS-LN-SSNO(4).

           MOVE FEECODE(1) TO NCINS-FEECODE(1).
           MOVE FEECODE(2) TO NCINS-FEECODE(2).
           MOVE FEECODE(3) TO NCINS-FEECODE(3).

           MOVE PD-FEECODE(1) TO NCINS-PD-FEECODE(1).
           MOVE PD-FEECODE(2) TO NCINS-PD-FEECODE(2).
           MOVE PD-FEECODE(3) TO NCINS-PD-FEECODE(3).
           MOVE PD-FEECODE(4) TO NCINS-PD-FEECODE(4).
           MOVE PD-FEECODE(5) TO NCINS-PD-FEECODE(5).
           MOVE PD-FEECODE(6) TO NCINS-PD-FEECODE(6).
           MOVE PD-FEECODE(7) TO NCINS-PD-FEECODE(7).
           MOVE PD-FEECODE(8) TO NCINS-PD-FEECODE(8).
           MOVE PD-FEECODE(9) TO NCINS-PD-FEECODE(9).
           MOVE PD-FEECODE(10) TO NCINS-PD-FEECODE(10).

           MOVE "A" TO NCINS-NO.
           MOVE NCINS-PATH TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH NCINS-WORKERS.
           CANCEL FORM-PROGX.

       D16-EXIT.
           EXIT.

      *****************************************
       D17-TEST-FOR-GEORGIA-SCHG SECTION.
      *****************************************

      * TEST FOR GEORGIA SERVICE CHARGE
           IF (QUOTE-ONLY)
              GO TO D17-EXIT.

      * WORLD 1154
           IF SP-SCFRMLA = 58
              GO TO TEST-FOR-TEXAS-SCHG.

           IF (SP-SCFRMLA = 4 OR 16 OR 29 OR 47 OR 49 OR 52 OR 53 OR 59)
              GO TO D17-TEST-FOR-CALIF-SCHG.

           IF (SP-SCFRMLA = 23 OR 43 OR 45 OR 48 OR 50 OR 55
                                OR 56 OR 57)
              GO TO D17-TEST-FOR-NC-SCHG.

           IF NOT (SP-SCFRMLA = 12 OR 13 OR 54)
              GO TO D17-EXIT.

           MOVE " " TO SCHG-UPDATE-FG.
           MOVE 0 TO SCHG-NEW-ACCTNO.
           MOVE PD-SSNO(1) TO SCHG-LN-SSNO(1).
           MOVE PD-SSNO(2) TO SCHG-LN-SSNO(2).
           MOVE PD-SSNO(3) TO SCHG-LN-SSNO(3).
           MOVE PD-SSNO(4) TO SCHG-LN-SSNO(4).
           MOVE TRANS-DATE TO SCHG-TRANS-DATE.
           IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
              MOVE PD-PRLNNO TO SCHG-PRIOR-ACCTNO
           ELSE
              MOVE 0 TO SCHG-PRIOR-ACCTNO.
           MOVE PD-ORGST TO SCHG-ORGST.
           MOVE PD-CLASS TO SCHG-LN-CLASS.
           MOVE SP-SCFRMLA TO GA-SCHG-NO.
           MOVE GA-SCHG-PATH TO FORM-NAM.
           IF GA-SCHG-NO = 13
              CALL FORM-PROGX USING FORM-PATH SCHG-WORKERS
                                             SCHG-WORKERS-2
           ELSE
              CALL FORM-PROGX USING FORM-PATH SCHG-WORKERS.
           CANCEL FORM-PROGX.
           MOVE SCHG-RESTRICT-ADJ  TO CIP-RESTRICT-ADJ
                                      PD-RESTRICT-ADJ.
           MOVE SCHG-DUAL-LOAN-ADJ TO CIP-DUAL-LOAN-ADJ
                                      PD-DUAL-LOAN-ADJ.
           MOVE SCHG-DUAL-LIAB TO SPDUAL-LIAB.

           GO TO D17-EXIT.

      ***************************************************************
      * WORLD, TX CLASS 5 (58)
      ***************************************************************
       TEST-FOR-TEXAS-SCHG.
           IF NOT (SP-SCFRMLA = 58)
              GO TO D17-EXIT.

            MOVE SP-SCFRMLA   TO TXSCHG-SCFRMLA.
            IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
               MOVE PD-PRLNNO TO TXSCHG-PRIOR-ACCTNO
            ELSE
               MOVE 0         TO TXSCHG-PRIOR-ACCTNO.
            MOVE PD-LOANDATE  TO TXSCHG-LOANDATE.
            MOVE PD-SSNO(1)   TO TXSCHG-SSNO.
            MOVE PD-ORGST     TO TXSCHG-ORGST.
            MOVE PD-CLASS     TO TXSCHG-CLASS.
            MOVE " "          TO TXSCHG-RESTRICTED.

            MOVE "CL/TXSCHG" TO FORM-NAM.
            CALL FORM-PROGX USING FORM-PATH TXSCHG-WORKERS.
            CANCEL FORM-PROGX.

      *  USE CIP-RESTRICT-ADJ TO FLAG CALCZL THAT YOU CANT TAKE
      *  ANOTHER SERVICE CHARGE IF ANYTHING IN HERE

            IF TXSCHG-RESTRICTED = "Y"
      *  RESTRICTED FLAG = "Y" MEANS THAT YOU CANT TAKE ANOTHER CHARGE
                MOVE 50.00  TO CIP-RESTRICT-ADJ
            ELSE
                MOVE 0      TO CIP-RESTRICT-ADJ.

            GO TO D17-EXIT.


      * COSMO, CA 2-8-95 (4)
      * MULLEN, CA 12-11-95 (16)
      * MULLEN, CA 12-30-97 (29)
      * BAY,       11-09-11 (47) ADDED 12 MONTH CHECK
      * REGMGM, TX 07-30-07 (49)
      * MULLEN, CA 06-02-11 (52,53)
      * WORLD,  KY 05-29-19 (59)
       D17-TEST-FOR-CALIF-SCHG.
           IF NOT (SP-SCFRMLA = 4 OR 16 OR 29 OR 47 OR 49 OR 52 OR 53 OR
                                                             59)
              GO TO D17-EXIT.

           MOVE SP-SCFRMLA   TO CASCHG-SCFRMLA.
           IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
              MOVE PD-PRLNNO TO CASCHG-PRIOR-ACCTNO
           ELSE
              MOVE 0         TO CASCHG-PRIOR-ACCTNO.
           MOVE PD-LOANDATE  TO CASCHG-LOANDATE.
           MOVE " "          TO CASCHG-RESTRICTED.

           MOVE "CL/CASC16"  TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CASCHG-WORKERS.
           CANCEL FORM-PROGX.

      * USE CIP-RESTRICT-ADJ TO FLAG CALCZ3 THAT YOU CANT TAKE
      * ANOTHER SERVICE CHARGE IF ANYTHING IN HERE
           IF CASCHG-RESTRICTED = "Y"
      * RESTRICTED FLAG = "Y" MEANS THAT YOU CANT TAKE ANOTHER CHARGE
              MOVE 50.00  TO CIP-RESTRICT-ADJ
           ELSE
              MOVE 0 TO CIP-RESTRICT-ADJ.

           GO TO D17-EXIT.

       D17-TEST-FOR-NC-SCHG.
           IF NOT (SP-SCFRMLA = 23 OR 43 OR 45 OR 48 OR 50
                                    OR 55 OR 56 OR 57)
              GO TO D17-EXIT.

           MOVE 0 TO NCSCHG-LN-ACCTNO.
           IF SP-SCFRMLA = 48
              IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
                 MOVE PD-PRLNNO TO NCSCHG-LN-ACCTNO.

           IF SP-SCFRMLA = 50
              IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
                 MOVE PD-PRLNNO TO NCSCHG-LN-ACCTNO
              ELSE
      * IF SCFRMLA 50 AND NOT A RENEWAL, THEN NO RESTRICTION TEST
      *   IS EVEN NECESSARY, SO SKIP IT, SCHG WILL BE $100
                 MOVE 100.00 TO CIP-RESTRICT-ADJ
                 GO TO D17-EXIT.

           MOVE PD-SSNO(1) TO NCSCHG-LN-SSNO.
           MOVE PD-SSNO(2) TO NCSCHG-LN-SSNO-2.
           MOVE PD-SSNO(3) TO NCSCHG-LN-SSNO-3.
           MOVE PD-SSNO(4) TO NCSCHG-LN-SSNO-4.
           MOVE PD-ORGST   TO NCSCHG-ORGST.
           MOVE PD-CLASS   TO NCSCHG-CLASS.
           MOVE TRANS-DATE TO NCSCHG-TRANS-DATE.
           MOVE " "        TO NCSCHG-RESTRICTED.
           MOVE 0          TO NCSCHG-NO-SERCHG.
           MOVE SP-SCFRMLA TO NCSCHG-SCFRMLA.

           MOVE "CL/NCSC23" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH NCSCHG-WORKERS.
           CANCEL FORM-PROGX.

      * USE CIP-RESTRICT-ADJ TO FLAG CALCZ3 THAT YOU CANT TAKE
      * ANOTHER SERVICE CHARGE IF ANYTHING IN THERE
           IF NCSCHG-RESTRICTED = "Y"
      * RESTRICTED FLAG = "Y" MEANS THAT YOU CANT TAKE ANOTHER CHARGE
              MOVE 50.00  TO CIP-RESTRICT-ADJ
           ELSE
              MOVE 0 TO CIP-RESTRICT-ADJ.

      * NCSCHG-RESTRICTED "1" = CHARGE $100
      * NCSCHG-RESTRICTED "2" = CHARGE $50
      * NCSCHG-RESTRICTED "3" = CHARGE $25
           IF SP-SCFRMLA = 50
              MOVE 100.00 TO CIP-RESTRICT-ADJ
              IF NCSCHG-RESTRICTED = "3"
                 MOVE 25.00 TO CIP-RESTRICT-ADJ
              ELSE
              IF NCSCHG-RESTRICTED = "2"
                 MOVE 50.00 TO CIP-RESTRICT-ADJ.

       D17-EXIT.
           EXIT.

      *****************************************
       D18-TEST-FOR-MFEE SECTION.
      *****************************************

      * TEST FOR TENNESSEE MAINTFEE RESTRICTIONS, CAN NOT CHARGE A
      * MAINTFEE IF AN OPEN LOAN EXIST WITH A MAINTFEE ALREADY
           IF (QUOTE-ONLY)
                  OR (NOT (SP-MFFRMLA = 4))
              MOVE 0 TO CIP-MFEE-RESTRICT
              GO TO D18-MFEE-EXIT.

           MOVE PD-SSNO(1) TO MFEE04-LN-SSNO(1).
           MOVE PD-SSNO(2) TO MFEE04-LN-SSNO(2).
           MOVE PD-SSNO(3) TO MFEE04-LN-SSNO(3).
           MOVE PD-SSNO(4) TO MFEE04-LN-SSNO(4).
           MOVE TRANS-DATE TO MFEE04-TRANS-DATE.

           IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
              MOVE PD-PRLNNO TO MFEE04-PRIOR-ACCTNO
           ELSE
              MOVE 0 TO MFEE04-PRIOR-ACCTNO.

           MOVE SP-MFFRMLA TO MFEE04-MFFRMLA.
           MOVE "Y" TO MFEE04-CHARGE-MFEE.

           MOVE "CL/MFEE04" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH MFEE04-WORKERS.
           CANCEL FORM-PROGX.

           IF MFEE04-CHARGE-MFEE = "Y"
              MOVE 0 TO CIP-MFEE-RESTRICT
           ELSE
              MOVE 50.00 TO CIP-MFEE-RESTRICT.

       D18-MFEE-EXIT.
           EXIT.

      *********************************************
      *    TEST FOR WISCONSIN SERVICE CHARGE
      *********************************************
       TEST-FOR-WI-SCHG SECTION.
           IF (QUOTE-ONLY) OR SP-SCFRMLA NOT = 63
              GO TO TEST-FOR-WI-EXIT.

           MOVE 0 TO WISCHG-PRIOR-SERCHG
                     CIP-RESTRICT-SERCHG.

           IF NOT (PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO")
              GO TO TEST-FOR-WI-EXIT.

           MOVE PD-SSNO(1)  TO WISCHG-LN-SSNO(1).
           MOVE PD-SSNO(2)  TO WISCHG-LN-SSNO(2).
           MOVE PD-SSNO(3)  TO WISCHG-LN-SSNO(3).
           MOVE PD-SSNO(4)  TO WISCHG-LN-SSNO(4).
           MOVE PD-LOANDATE TO WISCHG-TRANS-DATE.
           MOVE PD-PRLNNO   TO WISCHG-PRIOR-ACCTNO.
           MOVE PD-ORGST    TO WISCHG-ORGST.
           MOVE SP-SCFRMLA  TO WISCHG-SCFRMLA.

           MOVE "CL/WISCHG" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH WISCHG-WORKERS.
           CANCEL FORM-PATH.

      * COMES OUT WITH PRIOR SERCHG IF RESTRICTED AND IT MUST
      * BE SUBTRACTED FROM NEW SERCHG
           MOVE WISCHG-PRIOR-SERCHG TO CIP-RESTRICT-SERCHG.

       TEST-FOR-WI-EXIT.
           EXIT.

      *********************************************
       D18-TEST-FOR-SC-SCHG SECTION.
      *********************************************

           IF (QUOTE-ONLY)
                  OR (NOT (SP-SCFRMLA = 18 OR 42))
              GO TO D18-EXIT.

           MOVE " "        TO SCSCHG-UPDATE-FG.
           MOVE 0          TO SCSCHG-NEW-ACCTNO.
           MOVE PD-SSNO(1) TO SCSCHG-LN-SSNO(1).
           MOVE PD-SSNO(2) TO SCSCHG-LN-SSNO(2).
           MOVE PD-SSNO(3) TO SCSCHG-LN-SSNO(3).
           MOVE PD-SSNO(4) TO SCSCHG-LN-SSNO(4).
           MOVE TRANS-DATE TO SCSCHG-TRANS-DATE.
           IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
              MOVE PD-PRLNNO TO SCSCHG-PRIOR-ACCTNO
           ELSE
              MOVE 0         TO SCSCHG-PRIOR-ACCTNO.
           MOVE PD-ORGST     TO SCSCHG-ORGST.
           MOVE SP-SCFRMLA   TO SC-SCHG-NO SCSCHG-SCFRMLA.
           IF SP-SCFRMLA = 42
              MOVE 18        TO SC-SCHG-NO.

           MOVE SC-SCHG-PATH TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH SCSCHG-WORKERS.
           CANCEL FORM-PROGX.
           MOVE SCSCHG-PRIOR-CASHADV   TO CIP-PRIOR-CASHADV.
           MOVE SCSCHG-RESTRICT-SERCHG TO CIP-RESTRICT-SERCHG.
           MOVE SCSCHG-RESTRICT-HIGH-CASHADV
                                       TO CIP-RESTRICT-HIGH-CASHADV.
           MOVE 0 TO SPDUAL-LIAB.

       D18-EXIT.
           EXIT.

      *****************************************************
       D19-TEST-FOR-LESS-10 SECTION.
      *****************************************************

      * TEST FOR SOUTH CAROLINA RENEWAL RESTRICTION, ONLY ONE RENEWAL
      * FOR < 10% ALLOWED IN A 15 MONTH PERIOD

           MOVE " " TO SCHG18-UPDATE-FG.
           IF (QUOTE-ONLY)
                  OR (NOT (SP-SCFRMLA = 18 OR 42))
                   OR (NOT (PD-SRCD = "PB" OR "RN" OR "RB" OR "RO"))
              GO TO D19-EXIT.

           IF GP-RN-FOR10-LN = "Y"
             MOVE PD-PRIOR-RN-FOR10-DATE TO SAVED-PD-PRIOR-RN-FOR10-DATE
             MOVE PD-LAST-RN-FOR10-DATE  TO SAVED-PD-LAST-RN-FOR10-DATE.

           PERFORM COMPUTE-RNFOR10.
           IF RNFOR10-FG NOT = "Y"
              GO TO D19-EXIT.

           IF GP-RN-FOR10-LN = "Y"
              PERFORM D19-TEST-FOR-LESS-10-LN
           ELSE
              PERFORM D19-TEST-FOR-LESS-10-BW
                   VARYING SUB FROM 1 BY 1
                     UNTIL SUB > 4.
       D19-EXIT.
           EXIT.

      *********************************************
       D19-TEST-FOR-LESS-10-LN SECTION.
      *********************************************
           IF PD-LAST-RN-FOR10-DATE NOT = 0
              MOVE PD-LAST-RN-FOR10-DATE TO NUM-DATE
              MOVE TRANS-DATE            TO SYS-DATE
              PERFORM TIM360
              IF ELAPSED-MONTHS < 15
                 MOVE "N" TO SCHG18-UPDATE-FG
                 MOVE PD-LAST-RN-FOR10-DATE TO NUM-DATE
                 MOVE NUM-MO TO ALP-MO
                 MOVE NUM-DA TO ALP-DA
                 MOVE NUM-YR TO ALP-YR
                 MOVE "ERROR" TO ERRMSG-HEAD
                 MOVE "RENEWAL < 10%" TO ERRMSG-MSG1
                 MOVE " " TO MESS
                 STRING "LAST RENEWAL FOR LESS THAN 10% WAS ON : "
                  ALP-DATE "   " DELIMITED BY SIZE INTO MESS
                 MOVE MESS TO ERRMSG-MSG2
                 MOVE SPACES TO ERRMSG-MSG3
                 PERFORM CALL-ERRMSG.

      *********************************************
       D19-TEST-FOR-LESS-10-BW SECTION.
      *********************************************
           IF PD-SSNO(SUB) NOT = 0
              MOVE PD-SSNO(SUB) TO BW-SSNO
              PERFORM GET-BW1
              IF IO-FG = 0
                 IF (BW-LAST-RN-FOR10-DATE NOT = 0)
                    MOVE BW-LAST-RN-FOR10-DATE TO NUM-DATE
                    MOVE TRANS-DATE            TO SYS-DATE
                    PERFORM TIM360
                    IF ELAPSED-MONTHS < 15
                       MOVE "N" TO SCHG18-UPDATE-FG
                       MOVE BW-LAST-RN-FOR10-DATE TO NUM-DATE
                       MOVE NUM-MO TO ALP-MO
                       MOVE NUM-DA TO ALP-DA
                       MOVE NUM-YR TO ALP-YR
                       MOVE "ERROR" TO ERRMSG-HEAD
                       MOVE "RENEWAL < 10%" TO ERRMSG-MSG1
                       MOVE " " TO MESS
                       STRING "LAST RENEWAL FOR LESS THAN 10% WAS ON : "
                        ALP-DATE "   " DELIMITED BY SIZE INTO MESS
                       MOVE MESS TO ERRMSG-MSG2
                       MOVE SPACES TO ERRMSG-MSG3
                       PERFORM CALL-ERRMSG.

      *********************************
       E00-BW-TABLE-CHECK SECTION.
      *********************************
           IF ELE NOT = 1
              SUBTRACT 1 FROM ELE GIVING I-LEVEL
              IF PD-SSNO(I-LEVEL) = 0
                 MOVE "Y" TO BW-ERROR-YN
                 MOVE "ENTER SERIALLY" TO MESS
                 PERFORM SEND-MESS
                 GO TO E00-EXIT.

           MOVE 4 TO I-LEVEL.
       E00-NEXT-BW-LEVEL.
           IF PD-SSNO(I-LEVEL) = PD-SSNO(ELE)
                           AND I-LEVEL NOT = ELE
              MOVE "Y" TO BW-ERROR-YN
              MOVE "NO DUPLICATES" TO MESS
              PERFORM SEND-MESS
              GO TO E00-EXIT.
           SUBTRACT 1 FROM I-LEVEL.
           IF I-LEVEL > 0
              GO TO E00-NEXT-BW-LEVEL.

       E00-EXIT.
           EXIT.

      *********************************
       E01-BW-CHECK-ENDORSER SECTION.
      *********************************
           MOVE 0 TO I-LEVEL.
       E01-NEXT-ENDORSER.
           ADD 1 TO I-LEVEL.
           IF PD-MAKERCD(I-LEVEL) = "E"
              MOVE " " TO CHFG(20)
           ELSE
              IF I-LEVEL < 4
                 GO TO E01-NEXT-ENDORSER.

      ***********************************
       E02-CREATE-LT-SCRATCH SECTION.
      ***********************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           PERFORM CLOSE-WK-FILE.
           IF IO-FG NOT = 0
              GO TO E02-EXIT.

           PERFORM OPEN-PC1-FILE.
          
           PERFORM CLEAR-PC-FILE.

           MOVE "C"        TO PC-ID.
           MOVE PD-SSNO(1) TO PC-SOC-SEC.
           MOVE BRANCH     TO PC-BRANCH
                              PC2-BRANCH.
           IF QUOTE-ONLY
              MOVE SAVE-PD2-KEY TO PC2-KEY
              MOVE "C"          TO PC2-ID.

           MOVE WK-HHGS-1    TO PC-LTC-HHGS(1).
           MOVE WK-HHGS-2    TO PC-LTC-HHGS(2).
           MOVE WK-HHGS-3    TO PC-LTC-HHGS(3).
           MOVE WK-AUTO-1    TO PC-LTC-AUTO(1).
           MOVE WK-AUTO-2    TO PC-LTC-AUTO(2).
           MOVE WK-AUTO-3    TO PC-LTC-AUTO(3).

           MOVE PD-LOANDATE  TO PC-LOANDATE.
           MOVE PD-ORGTERM   TO PC-ORGTERM.
           MOVE PD-REGPYAMT  TO PC-REGPYAMT.
           PERFORM WRITE-PC1-FILE.
           IF IO-FG NOT = 0
              PERFORM REWRITE-PC1-FILE.

       E02-EXIT.
           PERFORM CLOSE-PC1-FILE.

      **************************************
       X00-RESTORE-SCREEN SECTION.
      **************************************
           MOVE 2 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           IF NEW-PROG-FORM NOT = OLD-PROG-FORM
              MOVE OLD-PROG-FORM TO WK-OLD-PROG-FORM.
           MOVE NEW-PROG-FORM TO OLD-PROG-FORM.
           IF IO-FG = 0
              GO TO X00-RESTORE-CLEAR.
           MOVE " " TO WK-SAVE-RECORD.
           MOVE 0 TO WK-ELE.
           PERFORM WRITE-WK-FILE.
           IF IO-FG = 9
              GO TO IO-ERROR.
           GO TO X00-EXIT.

       X00-RESTORE-CLEAR.
           IF WK-ELE NOT = 0
              SUBTRACT 1 FROM WK-ELE GIVING FIRST-ELE.
           MOVE WK-SAVE-RECORD TO PD-RECORD.
           MOVE 0 TO WK-ELE.
           PERFORM REWRITE-WK-FILE.

       X00-EXIT.
           IF FIRST-ELE = 0
              MOVE 0 TO NEW-FLAG
           ELSE
              MOVE 1 TO NEW-FLAG.
           PERFORM CLOSE-WK-FILE.

      ****************************************
       X01-CREATE-TRAILER SECTION.
      ****************************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           MOVE " " TO WK-SAVE-RECORD.
           IF IO-FG = 0
              PERFORM REWRITE-WK-FILE
           ELSE
              MOVE 0 TO WK-ELE
              PERFORM WRITE-WK-FILE
              IF IO-FG = 9
                 GO TO IO-ERROR.

           PERFORM CLOSE-WK-FILE.
           MOVE " " TO F3-COLLATERAL.


      ****************************************
       X02-RESTORE-TRAILER-REC SECTION.
      ****************************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           PERFORM CLOSE-WK-FILE.
           PERFORM X02-DISPLAY-TRAILER-REC.

       X02-DISPLAY-TRAILER-REC.
      * INSPECT-X HOLDS FREE FROM BEFORE CALL
           IF INSPECT-X NOT = WK-HHGS-1
              MOVE WK-HHGS-1 TO INSPECT-X
              MOVE INSPECT-X TO WR-BUF
              MOVE INSPECT-X-LIST TO WR-LIST
              PERFORM CALL-WRFORM
              MOVE WK-HHGS-1 TO PD-HOLD-COLLATERAL.

      *************************************
       X03-SAVE-SCREEN SECTION.
      *************************************
           MOVE 2 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           IF IO-FG = 9
              GO TO IO-ERROR.

           IF MENU-RESUME = "Y"
              MOVE "N" TO MENU-RESUME
              IF WK-OLD-PROG-FORM = "  "
                 MOVE 99 TO MENU-FG
                 GO TO X03-EXIT
              ELSE
                 MOVE WK-OLD-PROG-FORM TO NEW-PROG-FORM
                                          OLD-PROG-FORM
                 MOVE " " TO WK-OLD-PROG-FORM.

           MOVE ELE TO WK-ELE.
           MOVE PD-RECORD TO WK-SAVE-RECORD.
           PERFORM REWRITE-WK-FILE.

       X03-EXIT.
           PERFORM CLOSE-WK-FILE.

      *************************************
       SUBCLASS-SCAN SECTION.
      *************************************
           MOVE SPACES     TO SCSCAN-SP1-KEY.
           MOVE PD-ORGST   TO SCSCAN-ORGST.
           MOVE PD-CLASS   TO SCSCAN-SPRCLASS.
           MOVE 0          TO SCSCAN-SUBCLASS
                              SCSCAN-LAWCODE.
           MOVE "Y"        TO SCSCAN-LAST-LAW.
           MOVE TRANS-DATE TO SCSCAN-TRANS-DATE.
           MOVE "WI/SCSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH SCSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF SCSCAN-STATUS NOT = "00" OR SCSCAN-SP1-KEY = " "
              MOVE 9 TO IO-FG
              GO TO EXIT-SUBCLASS-SCAN
           ELSE
              MOVE 0 TO IO-FG.
           MOVE "SNNN020052." TO VDU.
           MOVE SCSCAN-SP-SUBCLASS TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE SCSCAN-SP-SUBCLASS TO VDUNUM0.

       EXIT-SUBCLASS-SCAN.
           EXIT.

      *************************************
       BORROWER-CREATE SECTION.
      *************************************
           IF VDUBUF = " "
                    AND PD-SSNO(ELE) NOT = 0
              MOVE PD-SSNO(ELE) TO BWCREA-NO
           ELSE
              MOVE VDUNUM0 TO BWCREA-NO.

           MOVE PD-SSNO(1) TO BWCREA-SSNO(1).
           MOVE PD-SSNO(2) TO BWCREA-SSNO(2).
           MOVE PD-SSNO(3) TO BWCREA-SSNO(3).
           MOVE PD-SSNO(4) TO BWCREA-SSNO(4).
           MOVE BWCREA-NO TO BWCREA-SSNO(ELE).

           MOVE "N"                       TO BWCREA-ALLOW-CHG.
           MOVE TRANS-DATE                TO BWCREA-TRANS-DATE.
           MOVE BRANCH                    TO BWCREA-BRANCH.
           MOVE "WI/BWCREA" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWCREA-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF BWCREA-STATUS NOT = "00" OR BWCREA-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BORROWER-CREATE.

           MOVE BWCREA-NO TO BW-SSNO.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           MOVE BWCREA-NO TO VDUNUM0.
           MOVE 0 TO IO-FG.

       EXIT-BORROWER-CREATE.
           EXIT.


      **********************************************
       BORROWER-SCAN SECTION.
      **********************************************
           MOVE 0   TO BWSCAN-NO.
           MOVE "S" TO BWSCAN-SCAN-TYPE.
           MOVE "WI/BWSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF BWSCAN-STATUS NOT = "00" OR BWSCAN-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BORROWER-SCAN.
           MOVE BWSCAN-NO TO BW-SSNO.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           MOVE ALP-BW TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-BORROWER-SCAN.
           EXIT.

      *************************************
       BWLN-SCAN SECTION.
      *************************************
           MOVE TRANS-DATE TO DATE-YYYYMMDD
           PERFORM CONVERT-YYYYMMDD-TO-ALPDATE.
           IF PD-SSNO(2) NOT = 0
              GO TO BWLN-SCAN-LNSCAN.

           MOVE PD-SSNO(1) TO LNSCN2-KEY.
           MOVE ALP-DATE   TO LNSCN2-SYSDATE.
           MOVE "WI/LNSCN2 " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LNSCN2-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           IF LNSCN2-STATUS NOT = "00" OR LNSCN2-ACCTNO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BWLN-SCAN.

           MOVE "SN N060110." TO VDU.
           MOVE LNSCN2-ACCTNO TO VDUNUM0.
           PERFORM SCREENIO.

           GO TO EXIT-BWLN-SCAN.

       BWLN-SCAN-LNSCAN.
           MOVE 0          TO LNSCAN-NO.
           MOVE PD-SSNO(1) TO LNSCAN-SSNO(1).
           MOVE PD-SSNO(2) TO LNSCAN-SSNO(2).
           MOVE PD-SSNO(3) TO LNSCAN-SSNO(3).
           MOVE PD-SSNO(4) TO LNSCAN-SSNO(4).
           MOVE ALP-DATE   TO LNSCAN-SYSDATE.

           MOVE "WI/LNSCAN " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LNSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           IF LNSCAN-STATUS NOT = "00" OR LNSCAN-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BWLN-SCAN.

           MOVE "SN N060110." TO VDU.
           MOVE LNSCAN-NO TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE LNSCAN-NO TO VDUNUM0.
           MOVE 0 TO IO-FG.
       EXIT-BWLN-SCAN.
           EXIT.


      ******************************************************************
       ELCODE-SCAN SECTION.
      ******************************************************************

           MOVE "EL"   TO ELSCAN-TYPE.
           MOVE ZEROES TO ELSCAN-CODE.
           MOVE "WI/ELSCAN " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ELSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           IF ( ELSCAN-STATUS NOT = "00") OR (ELSCAN-CODE = 0 )
               MOVE 9 TO IO-FG
               GO TO EXIT-ELCODE-SCAN.

           MOVE "SNNN020430." TO VDU.
           MOVE ELSCAN-CODE   TO VDUNUM0.
           PERFORM SCREENIO.

           MOVE ZEROES        TO IO-FG.
           MOVE ELSCAN-CODE   TO VDUNUM0.

       EXIT-ELCODE-SCAN.
           EXIT.

      ******************************************************************
       FEECODE-SCAN SECTION.
      ******************************************************************
           MOVE "GC"   TO CDBSCN-TYPE.
           MOVE BRANCH TO CDBSCN-BRANCH.
           MOVE SPACES TO CDBSCN-CODE.

           MOVE "WI/CDBSCN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CDBSCN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF ( CDBSCN-STATUS    NOT = "00"    ) OR
              ((CDBSCN-TYPE = "GC") AND (CDBSCN-CODE = SPACES))
              MOVE 9 TO IO-FG
              GO TO EXIT-FEECODE-SCAN.

      * PERFORMED FROM FEEENT WINDOW:
           MOVE "S  A020  0." TO VDU.
           MOVE FW-ELE TO VDUROW.
           MOVE CDBSCN-CODE TO VDUBUF.
           PERFORM SCREENIO.

           MOVE CDBSCN-CODE TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-FEECODE-SCAN.
           EXIT.

      ******************************************************************
       CODE-SCAN SECTION.
      ******************************************************************

           MOVE SPACES TO CDSCAN-CODE.

           IF ELE = 7
              MOVE "PU"   TO CDSCAN-TYPE
           ELSE
           IF ELE = 8
              MOVE "CO"   TO CDSCAN-TYPE
           ELSE
           IF ELE = 9
              MOVE "SR"   TO CDSCAN-TYPE
           ELSE
              PERFORM FEECODE-SCAN
              GO TO EXIT-CODE-SCAN.

           MOVE "WI/CDSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CDSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF ( CDSCAN-STATUS    NOT = "00"    ) OR
              (( CDSCAN-TYPE = "PU" ) AND ( CDSCAN-CODE = SPACES )) OR
              (( CDSCAN-TYPE = "CO" ) AND ( CDSCAN-CODE = SPACES )) OR
              (( CDSCAN-TYPE = "SR" ) AND ( CDSCAN-CODE = SPACES ))
              MOVE 9 TO IO-FG
              GO TO EXIT-CODE-SCAN.

           MOVE "S  A020  0." TO VDU
           MOVE ELE TO VDUROW
           MOVE CDSCAN-CODE TO VDUBUF
           PERFORM SCREENIO.

           MOVE CDSCAN-CODE TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-CODE-SCAN.
           EXIT.

      **********************************************
       QUOTE-SCAN SECTION.
      **********************************************
           MOVE BRANCH TO PDSCAN-BRANCH.
           MOVE SPACES TO PDSCAN-VERIFY.
           MOVE "N"    TO PDSCAN-SALEFIN.
           MOVE "Y"    TO PDSCAN-BALLOON.
           MOVE SPACES TO PDSCAN-BWNAME.
           MOVE "WI/PDSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH PDSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           MOVE PDSCAN-BWNAME TO VDUBUF.
           IF PDSCAN-STATUS NOT = "00" OR PDSCAN-BWNAME = SPACES
              MOVE 9 TO IO-FG
           ELSE
              MOVE 0 TO IO-FG.

       EXIT-QUOTE-SCAN.
           EXIT.

      *************************************
       LOAN-SCAN SECTION.
      *************************************
           MOVE "L"    TO PDSCAN-ID.
           MOVE BRANCH TO PDSCAN-BRANCH.
           MOVE " "    TO PDSCAN-VERIFY.
           MOVE "N"    TO PDSCAN-SALEFIN.
           MOVE "Y"    TO PDSCAN-BALLOON.
           MOVE 0      TO PDSCAN-NO.
           MOVE "WI/PDSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH PDSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF PDSCAN-STATUS NOT = "00" OR PDSCAN-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-LOAN-SCAN.

           MOVE "SN N090LNKEY." TO VDU.
           MOVE PDSCAN-NO TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE 0 TO IO-FG.
           MOVE PDSCAN-NO TO HOLD-RECALL-SSNO.

       EXIT-LOAN-SCAN.
           EXIT.

      *************************************
       CAN-LOAN-SCAN SECTION.
      *************************************
           PERFORM SET-CLFILE-INDEX-BY.

           MOVE "Y" TO CLSCAN-NON-MONTHLY.
           MOVE 1   TO CLSCAN-SCAN-TYPE.
           MOVE "WI/CLSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CLSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF CLSCAN-STATUS NOT = "00" OR CLSCAN-CAN-NO = " "
               MOVE 9 TO IO-FG
            ELSE
               MOVE 0 TO IO-FG.

       EXIT-CAN-LOAN-SCAN.
           EXIT.


      *************************************
       CLASS-SCAN SECTION.
      *************************************
           MOVE 0      TO LCSCAN-KEY.
           MOVE SPACES TO LCSCAN-VERIFY.
           MOVE "N" TO LCSCAN-SALEFIN.
           MOVE "WI/LCSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LCSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF LCSCAN-STATUS NOT = "00" OR LCSCAN-KEY = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-CLASS-SCAN.

           MOVE "SN N090LNKEY." TO VDU.
           MOVE LCSCAN-KEY TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE LCSCAN-KEY TO VDUNUM0.
           MOVE 0 TO IO-FG.

       EXIT-CLASS-SCAN.
           EXIT.

      *************************************
       DEALER-SCAN SECTION.
      *************************************
           MOVE 0 TO DLSCAN-NUM.
           MOVE "WI/DLSCAN " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH DLSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF DLSCAN-STATUS NOT = "00" OR DLSCAN-NUM = " "
              MOVE 9 TO IO-FG
              GO TO EXIT-DEALER-SCAN.
           MOVE "SN N042190." TO VDU.
           MOVE DLSCAN-DLNO TO VDUNUM2.
           PERFORM SCREENIO.
           MOVE DLSCAN-DLNO TO VDUNUM2.
           MOVE 0 TO IO-FG.

       EXIT-DEALER-SCAN.
           EXIT.

      ***************************************************
       VERIFY-PASSWORD SECTION.
      ***************************************************
           MOVE " " TO PASSWDW-STAT.
           MOVE "XONPC0" TO PASSWDW-PGM.
           MOVE "PLEASE ENTER THE PASSWORD," TO PASSWDW-PROMPT1.
           MOVE "CL/PASSWD" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH PASSWDW-BUF.
           CANCEL FORM-PROGX.

      *****************************************
       MAKE-DATES-CURRENT SECTION.
      *****************************************

      * SET NEW INTEREST DATE:
           MOVE PD-LOANDATE TO NUM-DATE.
           MOVE PD-INTDATE TO SYS-DATE.
           PERFORM TIM.
           MOVE ELAPSED-DAYS TO NDTE-HOLD.
           MOVE TRANS-DATE   TO NDTE-DATE.
           PERFORM INCREMENT-DAYS.
           MOVE NDTE-DATE TO PD-INTDATE DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-061.

      * SET NEW LOAN DATE:
           MOVE TRANS-DATE TO PD-LOANDATE DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-060.

      * SET NEW 1ST PAY DATE:
           MOVE PD-INTDATE TO NDTE-DATE
                              SYS-DATE.
           MOVE 1 TO NDTE-HOLD.
           MOVE PD-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           MOVE NDTE-DATE TO NUM-DATE.

      * WORLD OPTION TO ADVANCE TO 1ST OF NEXT MONTH
      * IF NO CORRESPONDING DAY IN NEW MONTH:
           PERFORM SET-ADV-TO-1ST-NO-CORR.
           IF ADV-TO-1ST-NO-CORR = "Y"
              IF NOT ( GP-I-AM-WORLD     AND
                       PD-ORGST   = "TN" AND
                       PD-CLASS   = 01   AND
                       PD-ORGTERM = 12
                     )
                 IF PD-UNITPER-CD = "M" AND PD-UNITPER-FREQ = 1
                    IF S-DD > NDTE-DD
                       MOVE 1 TO NDTE-DD
                                 NDTE-HOLD
                       PERFORM INCREMENT-MONTHS
                       MOVE NDTE-DATE TO NUM-DATE.

      * IF DATE OF THE LOAN IS ON THE 26 THRU 31 THEN ADVANCE THE
      *   FIRST PAYMENT DUE DATE TO THE FIRST OF THE SECOND MONTH
      *   FOLLOWING THE DATE OF THE LOAN. (REGMGM PR#1099)
           IF ADV-TO-1ST-NO-CORR = "A"
              IF PD-UNITPER-CD = "M" AND PD-UNITPER-FREQ = 1
                 IF S-DD > 25
                    MOVE 1 TO NDTE-DD
                              NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                    MOVE NDTE-DATE TO NUM-DATE.

      * TEST IF ORIGINAL SAVED QUOTE HAVING AN EXTENDED FIRST PAY
           IF NUM-DATE > PD-1STPYDATE
              MOVE NUM-DATE TO PD-1STPYDATE
                               PD-ORIG-1STPYDATE.
           MOVE PD-1STPYDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-130.

      * SET INSURANCE EXPIRATION DATES, IF NECESSARY
      * 06/27/96 BAH
           MOVE 5 TO SUB.
       MAKE-NEXT-INS-CURRENT.
           IF PD-INSEXP-DATE(SUB) NOT = 0 AND PD-INSPREM(SUB) NOT = 0
              MOVE PD-INTDATE TO NDTE-DATE
              MOVE PD-ORGTERM TO NDTE-HOLD
              MOVE PD-UNITPER-CD TO DATER-UNITPER-CD
              MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ
              PERFORM INCREMENT-UNITPER
              MOVE "SNNN060  2." TO VDU
              COMPUTE VDUROW = SUB + 26
              MOVE NDTE-DATE TO PD-INSEXP-DATE(SUB)
                                DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO VDUNUM0                              
              PERFORM SCREENIO.
           IF SUB < 6
              ADD 1 TO SUB
              GO TO MAKE-NEXT-INS-CURRENT.

       MAKE-DATES-CURRENT-EXIT.
           EXIT.


      **********************************************
       TEST-SP-EFF-EXP SECTION.
      **********************************************
           MOVE 0 TO IO-FG.

           IF SP-EFFDATE NOT > PD-LOANDATE
              IF SP-EXPDATE = 0
                 GO TO TEST-SP-EFF-EXP-EXIT
              ELSE
                 IF SP-EXPDATE > PD-LOANDATE
                    GO TO TEST-SP-EFF-EXP-EXIT.

           MOVE "LOAN DATE, DOSN'T MATCH SPR LAWCODE!!!!!"
                                                          TO MESS.
           PERFORM SEND-MESS.
           MOVE "SAVED LOAN OR CAN LOAN MUST BE REBUILT!" TO MESS.
           PERFORM SEND-MESS.
           MOVE 9 TO IO-FG.

       TEST-SP-EFF-EXP-EXIT.
           EXIT.

      ******************************************************************
       CALL-SCAN SECTION.
      ******************************************************************

      * NO DUAL LOANS WITHIN THE SAME CLASS (TAX ADVANCE)
           IF (SP-DUAL-IN-STATE = "C") OR (SP-DUAL-IN-BRANCH = "C")
              MOVE 0                 TO BISCAN-CALL-CODE
      * USE BISCAN-SSNO BECAUSE IT GETS SET PROPERLY THROUGHOUT THE PROGRAM
              MOVE BISCAN-SSNO       TO BICLAS-SSNO
              MOVE PD-OWNBR          TO BICLAS-BRANCH
              MOVE PD-CLASS          TO BICLAS-CLASS
              MOVE "CL/BICLAS"       TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH BICLAS-WORKERS
              CANCEL FORM-PROGX
              IF BICLAS-RESTRICTED = "Y"
                 MOVE SPACES TO MESS
                 STRING "SAME CLASS LOAN STILL OPEN IN BRANCH; ",
                        BICLAS-BRANCH INTO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO BISCAN-CALL-CODE
                 GO TO EXIT-CALL-SCAN
              ELSE
                 GO TO EXIT-CALL-SCAN.

           MOVE SP-DUAL-IN-STATE  TO BISCAN-STATE-FG.
           MOVE SP-DUAL-IN-BRANCH TO BISCAN-BRANCH-FG.
           MOVE PD-OWNBR          TO BISCAN-BRANCH.
           MOVE PD-ORGST          TO BISCAN-STATE.
           MOVE TRANS-DATE        TO BISCAN-TRANS-DATE.
           MOVE "CL/BISCAN"       TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BISCAN-WORKERS.
           CANCEL FORM-PROGX.

       EXIT-CALL-SCAN.
           EXIT.

      ************************************************
       DO-FEEENT-WINDOW SECTION.
      ************************************************
           MOVE SP-FEEFRMLA(1) TO FW-PROTECT-FEE1-FG.
           MOVE SP-FEEFRMLA(2) TO FW-PROTECT-FEE2-FG.

           PERFORM FEEENT-WIN.
           MOVE "ZONPC" TO VDU-FORM-NAME.
           PERFORM COMPUTE-GL-FEEAMT.
           PERFORM SP-EDT-TABLE-LOOKUP.
           IF IO-FG = 9
              MOVE 0 TO IO-FG
              GO TO DO-FEEENT-WINDOW.
           PERFORM SETUP-FEES-FOR-DISPLAY.
           MOVE D-190 TO WR-BUF.
           MOVE FEE-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
           MOVE TOTAL-GL-HLDR TO CIP-GL-AMOUNT-TOTAL.
           IF BR-FORCE-VALID-CITY-COUNTY = "Y"
              SUBTRACT TOTAL-GL-HLDR-SALESTAX
                            FROM CIP-GL-AMOUNT-TOTAL.
           MOVE TOTAL-GL-FINCHG-HLDR TO CIP-GL-AMOUNT-TOTAL-FINCHG.
           IF NEW-FLAG NOT = 1
              PERFORM CALL-LOAN-CALCULATIONS.

      **************************************************
       SETUP-BLINPC-BUF SECTION.
      **************************************************

      * SETUP BLINPC CALCULATE OPTION WINDOW BUFFER

           MOVE SPACES             TO BLINPC-BUF.
           MOVE PD-BALLOON-LAST-FG TO BLINPC-BALLOON-LAST-FG.
           MOVE PD-REGPYAMT-FG     TO BLINPC-REGPYAMT-FG.
           MOVE PD-BALLOON-FG      TO BLINPC-BALLOON-FG.

      * ON SINGLE PAY LOANS STOP OPTION TO SELECT CALCULATE BALLOON
           IF COP-TERM = 1
              MOVE " "             TO BLINPC-BALLOON-FG.

           MOVE PD-SELLPR-FG TO BLINPC-SELLPR-FG.

           MOVE PD-SELLPR TO BLINPC-SELLPR.
           MOVE PD-LASTPYAMT TO BLINPC-LASTPYAMT.
           MOVE COP-REGPYAMT TO BLINPC-REGPYAMT.



      *****************************************************************
      *                    COMBINATION CHART                          |
      *                                                               |
      *  NOTE:                                                        |
      *       FLAGS ARE IN STATUS, PER CHART, WHEN THIS ROUTINE       |
      *       IS PERFORMED.                                           |
      *----------------------------------------------------------------
      *             | COMBO 1     | COMBO 2         | COMBO 3         |
      *-------------|--------------------------------------------------
      *             |  REALLY ---->  REALLY --> THIS|  REALLY --> THIS|
      *             |--------------------------------------------------
      * SELLPR-FG   | I OR I OR C | I OR I OR C | I | I OR C OR C | C |
      * BALLOON-FG  | I           | C           |C/I| I           | I |
      * REGPYAMT-FG | C           | I           |I/C| I           | I |
      *****************************************************************
       AFTER-BALLO-CALC-OPT SECTION.
      *****************************************************************

      * SELLING PRICE    (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "P"
              MOVE "C" TO PD-SELLPR-FG
                          PD-PROCEEDS-FG
              MOVE "I" TO PD-BALLOON-FG.

      * REGULAR PAYMENT   (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "R"
              MOVE "C" TO PD-REGPYAMT-FG
              MOVE "I" TO PD-BALLOON-FG.

       AFTER-BALLO-CALC-OPT-EXIT.
           EXIT.

      *****************************************************************
       AFTER-REGPY-CALC-OPT SECTION.
      *****************************************************************

      * LOAN PROCEEDS    (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "P"
              MOVE "C" TO PD-SELLPR-FG
                          PD-PROCEEDS-FG
              MOVE "I" TO PD-REGPYAMT-FG.

      * BALLOON OR LAST PAYMENT   (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "B" OR "L"
              MOVE "C" TO PD-BALLOON-FG
              MOVE "I" TO PD-REGPYAMT-FG.

       AFTER-REGPY-CALC-OPT-EXIT.
           EXIT.

      *****************************************************************
       AFTER-SELLPR-CALC-OPT SECTION.
      *****************************************************************

      * REGULAR PAYMENT    (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "R"
              MOVE "I" TO PD-SELLPR-FG
                          PD-PROCEEDS-FG
              MOVE "C" TO PD-REGPYAMT-FG.

      * BALLOON OR LAST PAYMENT   (CALCULATE)

           IF BLINPC-CALC-SELECT-KEY = "B" OR "L"
              MOVE "I" TO PD-SELLPR-FG
                          PD-PROCEEDS-FG
              MOVE "C" TO PD-BALLOON-FG.

       AFTER-REGPY-CALC-OPT-EXIT.
           EXIT.

      ****************************************
       B90-DISPLAY-FIELDS SECTION.
      ****************************************

           MOVE " " TO DISPLAY-BUF1.
           PERFORM GET-SP.
      * NEEDED FOR LNAPPROVAL
           PERFORM LOAN-CALCULATIONS.

           MOVE PD-CLASS TO LC-CODE D-LCNO.
           PERFORM GET-LC.
           MOVE LC-DESC TO D-LC-DESC.
           PERFORM OPEN-BW1-FILE.
           MOVE 1 TO ELE.
       DISP-NEXT-BW.
           MOVE PD-SSNO(ELE) TO BW-SSNO.
           PERFORM NUMBW-TO-ALPBW.
           MOVE " " TO BW-LNAME BW-FNAME.
           IF BW-SSNO NOT = 0 AND NOT QUOTE-ONLY
              PERFORM GET-BORR-NAME
              MOVE ALP-BW TO D-010(ELE)
              MOVE INSPECT-W TO D-011(ELE)
              MOVE PD-MAKERCD(ELE) TO D-012(ELE).
           IF ELE < 3
              ADD 1 TO ELE
              GO TO DISP-NEXT-BW.
           PERFORM CLOSE-BW1-FILE.

           MOVE PD-LNAMT TO D-LOANAMT.
      *    MOVE PD-PROCEEDS TO D-DLCK.
           COMPUTE ANTIC = PD-ANTICERN(1) + PD-ANTICERN(2)
                         + PD-ANTICERN(3) + PD-ANTICERN(4)
                         + PD-ANTICERN(5).
           IF NOT GP-INCL-OTH-IN-EARNED-N
              ADD PD-ANTICERN(6) TO ANTIC.
           MOVE ANTIC TO D-ANTIC.
           MOVE PD-ORGST TO D-050.
           MOVE PD-ORGBR TO D-051.
           MOVE PD-SUBCLASS TO D-052.
           MOVE SP-DESC TO D-053.
           PERFORM MAKE-DATES-CURRENT.

           MOVE "PU" TO CD-TYPE.
           MOVE PD-PURCD TO D-070 CD-CODE.
           PERFORM GET-CD.
           MOVE CD-DESC TO D-071.

           MOVE "CO"      TO CD-TYPE.
           MOVE PD-COLLCD TO CD-CODE  D-080.
           PERFORM GET-CD.
           MOVE CD-DESC   TO D-081.
           MOVE CD-CO-SECURED TO SPTEST-CD-SECURED.

           MOVE "SR"    TO CD-TYPE.
           MOVE PD-SRCD TO D-090 CD-CODE.
           PERFORM GET-CD.
           MOVE CD-DESC TO D-091.

           MOVE PD-UNITPER-CD TO D-100.
           MOVE PD-UNITPER-FREQ TO D-101.
           MOVE PD-BALLOON-LAST-FG TO D-102.
           PERFORM DISPLAY-BALLOON-LAST.

           MOVE PD-PRLNNO TO W-LNNO D-110.

           IF ( SPTEST-CD-SECURED = "R" )
              PERFORM RESCISSION-ROUTINE.

           IF PD-PRLNNO NOT  = 0
              PERFORM D12-PROCESS-PRIOR-LN
              IF ERROR-IN-PRIOR-LOAN
                 MOVE 9999999.99 TO D-111
              ELSE
                 MOVE PRIOR-LNAMT TO D-111.

           MOVE PD-ORGTERM TO D-120.

           MOVE PD-ORIG-1STPYDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-130.

           MOVE PD-SELLPR TO D-140.
           MOVE PD-SELLPR-FG TO D-141.

      *    MOVE    ---OPEN TO D-160.

      *  DEFENSE IF
           IF PD-ORGTERM = 1
              MOVE 0 TO PD-LASTPYAMT D-170
              MOVE "I" TO PD-BALLOON-FG D-171
           ELSE
              IF PD-BALLOON-LAST-FG = "L"
                 MOVE PD-LASTPYAMT TO D-170
              ELSE
                 SUBTRACT PD-REGPYAMT FROM PD-LASTPYAMT
                                             GIVING D-170
              END-IF
              MOVE PD-BALLOON-FG TO D-171.

           MOVE PD-INSCODES TO D-180.

           MOVE PD-POINTS TO D-181.
           MOVE PD-POINTS-FG TO D-182.
           IF PD-POINTS = 0
              MOVE " " TO D-182.

           PERFORM SETUP-FEES-FOR-DISPLAY.

           MOVE PD-DLNO TO D-220
                           DL-DLNO.
           PERFORM GET-DL1.

           MOVE DISPLAY-BUF1 TO WR-BUF.
           MOVE DISPLAY-LIST1 TO WR-LIST.
           PERFORM CALL-WRFORM.

           IF PD-POCD-INRESCISSION
              MOVE " * RESCISSION *" TO WR-BUF
              MOVE RESCISSION-LIST TO WR-LIST
              PERFORM CALL-WRFORM.

           MOVE 0 TO COUNTER
                     TOTAL-GL-HLDR
                     TOTAL-GL-FINCHG-HLDR
           PERFORM COMPUTE-GL-FEEAMT.
           MOVE 800 TO CIP-NO-OF-TIMES-CALLED.
           PERFORM SETUP-CALC-AREA.

       DISP-INTERMEDIATE-FIELDS.
           PERFORM DISPLAY-PROMPTS.
           MOVE " " TO DISPLAY-BUF2.
           MOVE PD-COLLID TO D-230.

           PERFORM MOVE-MSG.

           MOVE PD-ENDORATE TO D-250.
           MOVE PD-OVRDRATE TO D-260
                               CIP-OVR-RATE.
           MOVE PD-OVRDRATE-FG TO D-261
                                  CIP-OVR-RATE-SW.
           MOVE PD-EFFRATE TO D-262
                              CIP-EFF-RATE
                              CEP-EFF-RATE.
           MOVE PD-APRATE TO D-263
                             CIP-APR-RATE
                             CEP-APR-RATE.

           PERFORM VARYING ELE FROM 1 BY 1 UNTIL ELE > 4
              MOVE PD-INSCOMP(ELE)     TO D-1COMP(ELE)
                                          CIP-INS-CO(ELE)
              MOVE PD-INSPREM(ELE)     TO D-1PREM(ELE)
                                          CIP-INS-PREMIUM(ELE)
                                          CEP-INS-PREMIUM(ELE)
              MOVE PD-INSTRM(ELE)      TO D-1TERM(ELE)
                                          CIP-INS-TERM(ELE)
                                          CEP-INS-TERM(ELE)
              MOVE PD-INSCOVR(ELE)     TO D-1COVR(ELE)
                                          CIP-INS-COVERAGE(ELE)
                                          CEP-INS-COVERAGE(ELE)
              MOVE PD-INSOURS(ELE)     TO D-1OUR(ELE)
                                          CIP-INS-USE-SW(ELE)
              MOVE PD-INS-FG(ELE)      TO D-INS-FG(ELE)
                                          CIP-INS-SW(ELE)
              MOVE PD-INSFINCHG(ELE)   TO CIP-INSFINCHG-SW(ELE)
              MOVE PD-INS-TERM-SW(ELE) TO CIP-INS-TERM-SW(ELE)
              MOVE PD-COVERAGE-SW(ELE) TO CIP-COVERAGE-SW(ELE)
              MOVE PD-PREMIUM-SW(ELE)  TO CIP-PREMIUM-SW(ELE)
           END-PERFORM.

           MOVE 1 TO SUB.
           MOVE 5 TO ELE.
       DISP-NEXT-2IC.
           MOVE PD-INSCOMP(ELE)     TO D-2COMP(SUB)
                                       CIP-INS-CO(ELE).
           MOVE PD-INSPREM(ELE)     TO D-2PREM(SUB)
                                       CIP-INS-PREMIUM(ELE)
                                       CEP-INS-PREMIUM(ELE).
           MOVE PD-INSTRM(ELE)      TO CIP-INS-TERM(ELE)
                                       CEP-INS-TERM(ELE).
           IF GP-OT-INS-TERM = "Y"
              MOVE PD-INSTRM(ELE)      TO D-2TERM(SUB)
           ELSE
              MOVE PD-INSEXP-DATE(ELE) TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY         TO D-2EXP(SUB).
           MOVE PD-INSCOVR(ELE)     TO D-2COVR(SUB)
                                       CIP-INS-COVERAGE(ELE)
                                       CEP-INS-COVERAGE(ELE).
           MOVE PD-INSOURS(ELE)     TO D-2OUR(SUB)
                                       CIP-INS-USE-SW(ELE).
           MOVE PD-INS-FG(ELE)      TO CIP-INS-SW(ELE).
           MOVE PD-INSFINCHG(ELE)   TO CIP-INSFINCHG-SW(ELE).
           MOVE PD-INS-TERM-SW(ELE) TO CIP-INS-TERM-SW(ELE).
           MOVE PD-COVERAGE-SW(ELE) TO CIP-COVERAGE-SW(ELE).
           MOVE PD-PREMIUM-SW(ELE)  TO CIP-PREMIUM-SW(ELE).
           IF ELE < 6
              ADD 1 TO ELE SUB
              GO TO DISP-NEXT-2IC.

           MOVE 1 TO ELE.

       DISP-OUTPUT-FIELDS.
           IF SP-FEEFRMLA(1) NOT = " "
              MOVE PD-FEEAMT(1) TO D-200
                                   CIP-FEE-CHG(1)
                                   CEP-FEE-CHG(1)
              MOVE PD-FEECD-FG(1) TO D-201
                                      CIP-FEE-CHG-SW(1).

           IF SP-FEEFRMLA(2) NOT = " "
              MOVE PD-FEEAMT(2) TO D-210
                                   CIP-FEE-CHG(2)
                                   CEP-FEE-CHG(2)
              MOVE PD-FEECD-FG(2) TO D-211
                                      CIP-FEE-CHG-SW(2).

           MOVE PD-SERCHG TO D-340
                             CIP-SERVICE-CHG
                             CEP-SERVICE-CHG.
           MOVE PD-STATE-WORKER TO CIP-STATE-WORKER.
           MOVE PD-SERCHG-FG TO D-341 CIP-SERVICE-CHG-SW.
           MULTIPLY PD-MAINTFEE BY PD-ORGTERM GIVING D-350
                 CIP-MAINT-FEES CEP-MAINT-FEES ROUNDED.
           MOVE PD-MAINTFEE-FG TO D-351 CIP-MAINT-FEES-SW.
           MOVE PD-EXTCHG TO D-360 CIP-1ST-PY-EXT CEP-1ST-PY-EXT.
           MOVE PD-EXTCHG-FG TO D-361 CIP-1ST-PY-EXT-SW.
           MOVE PD-INTCHG TO D-370 CIP-INT-CHARGE.
           MOVE PD-APR-FINAMT TO D-380
                                 CIP-APR-FINANCD.
           MOVE PD-FINAMT TO CIP-AMT-FINANCD.
           MOVE PD-PROCEEDS-FG TO D-381.
           MOVE PD-LNAMT TO CIP-LOAN-AMOUNT.
           IF PD-LOANTYPE = "P"
              MOVE PD-LNAMT TO D-390
           ELSE
              MOVE TOTAL-REPAY TO D-390.
           ADD PD-ANTICERN(1)
                PD-ANTICERN(2)
                 PD-ANTICERN(3)
                  PD-ANTICERN(4)
                   PD-ANTICERN(5) GIVING CIP-ANTIC-EARNS.
           IF NOT GP-INCL-OTH-IN-EARNED-N
              ADD PD-ANTICERN(6) TO CIP-ANTIC-EARNS.

      * SETUP FIRST PAYMENT AMOUNT:
           MOVE PD-1STPYAMT TO D-400.
           IF PD-1STPYAMT = PD-REGPYAMT
              MOVE 0 TO CIP-ODD-1ST-PMT.

      * SETUP LAST PAYMENT AMOUNT:
           MOVE PD-LASTPYAMT TO D-410.
           IF PD-BALLOON-LAST-FG = "L"
              MOVE PD-LASTPYAMT TO CIP-BALLOON
           ELSE
      *       DEFENSE IF
              IF PD-ORGTERM = 1
                 MOVE 0 TO PD-LASTPYAMT CIP-BALLOON
              ELSE
                 SUBTRACT PD-REGPYAMT FROM PD-LASTPYAMT
                                         GIVING CIP-BALLOON.
           MOVE PD-BALLOON-FG TO CIP-BALLOON-SW.

      * SETUP REGUALR PAYMENT AMOUNT:
           MOVE PD-REGPYAMT TO D-420
                               CIP-REGPYAMT.
           MOVE PD-REGPYAMT-FG TO D-421
                                  CIP-REGPYAMT-SW.

           IF PD-LOANTYPE = "I"
              MOVE PD-SERCHG TO PD-ANTICERN(3)
              MOVE 0 TO PD-ANTICERN(1)
                        PD-ANTICERN(2)
                        PD-ANTICERN(4)
                        PD-ANTICERN(5)
                        PD-ANTICERN(6)
              IF GP-ALLOW-MF-ON-IB = "Y"
                 COMPUTE PD-ANTICERN(4) = PD-ORGTERM * PD-MAINTFEE
              ELSE
                 MOVE 0 TO PD-ANTICERN(4)
              END-IF

           ELSE
              ADD PD-INTCHG PD-EXTCHG GIVING PD-ANTICERN(1)
              MOVE PD-SERCHG TO PD-ANTICERN(3)
              COMPUTE PD-ANTICERN(4) = PD-ORGTERM * PD-MAINTFEE
              MOVE 0 TO PD-ANTICERN(5)
                        PD-ANTICERN(6).

            MOVE PD-ANTICERN(1) TO WK-ANTICERN(1).
            MOVE PD-ANTICERN(2) TO WK-ANTICERN(2).
            MOVE PD-ANTICERN(3) TO WK-ANTICERN(3).
            MOVE PD-ANTICERN(4) TO WK-ANTICERN(4).
            MOVE PD-ANTICERN(5) TO WK-ANTICERN(5).
            MOVE PD-ANTICERN(6) TO WK-ANTICERN(6).
            PERFORM ADJUST-ANTICERN.
            MOVE WK-ANTICERN(1) TO PD-ANTICERN(1).
            MOVE WK-ANTICERN(2) TO PD-ANTICERN(2).
            MOVE WK-ANTICERN(3) TO PD-ANTICERN(3).
            MOVE WK-ANTICERN(4) TO PD-ANTICERN(4).
            MOVE WK-ANTICERN(5) TO PD-ANTICERN(5).
            MOVE WK-ANTICERN(6) TO PD-ANTICERN(6).

           MOVE DISPLAY-BUF2 TO WR-BUF.
           MOVE DISPLAY-LIST2 TO WR-LIST.
           PERFORM CALL-WRFORM.

      *    PERFORM VALID-INS-TYPES-ELIG.
      *    IF IO-FG = 9
      *       GO TO XXXXXXXXXXXX.

           IF PD-MESSAGE NOT = " "
              PERFORM SEND-MEMO
              PERFORM ALARM.


       EXIT-DISPLAY-FIELDS.
           EXIT.

      ************************************
       SETUP-FEES-FOR-DISPLAY SECTION.
      ************************************
           ADD PD-FEEAMT(1) PD-FEEAMT(2)
               PD-FEEAMT(3) PD-FEEAMT(4)
               PD-FEEAMT(5) PD-FEEAMT(6)
               PD-FEEAMT(7) PD-FEEAMT(8)
               PD-FEEAMT(9) PD-FEEAMT(10)
                                  GIVING HOLD-WORKER.
           IF SP-FEEFRMLA(1) NOT = " "
              SUBTRACT PD-FEEAMT(1) FROM HOLD-WORKER
              MOVE PD-FEEAMT(1) TO D-200
              MOVE PD-FEECD-FG(1) TO D-201.
           IF SP-FEEFRMLA(2) NOT = " "
              SUBTRACT PD-FEEAMT(2) FROM HOLD-WORKER
              MOVE PD-FEEAMT(2) TO D-210
              MOVE PD-FEECD-FG(2) TO D-211.
           MOVE HOLD-WORKER TO D-190.


      ***********************************
       DELETE-SCRATCH SECTION.
      ***********************************
           MOVE "LOAN TEMP DELETE IN PROGRESS........" TO LEGEND.
           PERFORM SEND-LEGEND.
           PERFORM OPEN-PD1-FILE.
           MOVE PD-SSNO(1) TO SAVE-SSNO.
           PERFORM SET-SCRATCH-KEY.
           IF QUOTE-ONLY OR
              QUOTE-CHANGED-TO-LOAN
              MOVE "Q" TO PD-ID.
           PERFORM READ-PD1-FILE.
           IF IO-FG = 0
              PERFORM DELETE-PD1-FILE.
           PERFORM CLOSE-PD1-FILE.

      ***********************************************
       DEFAULT-INT-PMT-DATES SECTION.
      ***********************************************
           PERFORM D05-CHECK-SP-EFFDATE.
           IF IO-FG = 9
              PERFORM SP-INVALID
              GO TO EXIT-DEFAULT-INT-PMT-DATES.

           MOVE SP-LAWCODE TO PD-LAWCODE.
           IF PD-INTDATE = 0
              MOVE "S  8000061." TO VDU
              MOVE PD-LOANDATE TO VDU-DATE-YYYYMMDD PD-INTDATE
              PERFORM SCREENIO.
           IF PD-1STPYDATE NOT = 0
              MOVE 0 TO AMT-HOLDER
              GO TO EXIT-DEFAULT-INT-PMT-DATES.

           MOVE 1 TO AMT-HOLDER.
           PERFORM SET-1ST-PAY-DATE.

       EXIT-DEFAULT-INT-PMT-DATES.
           EXIT.


      *************************
       VALIDATION SECTION.
      *************************
           IF ELE = 20
              IF PD-FEEAMT(1) > CEP-FEE-CHG(1)
                 MOVE SP-FEEID(1) TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-FEE-CHG(1) TO HOLD-AMT-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 21
              IF PD-FEEAMT(2) > CEP-FEE-CHG(2)
                 MOVE SP-FEEID(2) TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-FEE-CHG(2) TO HOLD-AMT-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 26
              IF PD-OVRDRATE-FG = "E"
                         AND PD-OVRDRATE > CEP-EFF-RATE
                 MOVE "EFF. RATE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-EFF-RATE TO HOLD-RATE-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 26
              IF PD-OVRDRATE-FG = "A"
                         AND PD-OVRDRATE > CEP-APR-RATE
                 MOVE "APR RATE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-APR-RATE TO HOLD-RATE-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 27 OR 28 OR 29 OR 30
              SUBTRACT 26 FROM ELE GIVING I-LEVEL
              IF PD-INSTRM(I-LEVEL) > CEP-INS-TERM(I-LEVEL)
                MOVE "INS. TERM" TO TYPE-OF-AMT-EXCEEDED
                MOVE CEP-INS-TERM(I-LEVEL) TO HOLD-TERM-EXCEEDED
                GO TO VALIDATE-EXCEEDS-MAX
              ELSE
              IF PD-INSPREM(I-LEVEL) > CEP-INS-PREMIUM(I-LEVEL)
                MOVE "INS. PREMIUM" TO TYPE-OF-AMT-EXCEEDED
                MOVE CEP-INS-PREMIUM(I-LEVEL) TO HOLD-AMT-EXCEEDED
                GO TO VALIDATE-EXCEEDS-MAX
              ELSE
      * PERSONAL PROPERTY MUST CHECK SP-INSMAXCHGABL FOR 888888
              IF ELE NOT = 29
                IF PD-INSCOVR(I-LEVEL) > CEP-INS-COVERAGE(I-LEVEL)
                  MOVE "INS. COVERAGE" TO TYPE-OF-AMT-EXCEEDED
                  MOVE CEP-INS-COVERAGE(I-LEVEL) TO HOLD-AMT-EXCEEDED
                  GO TO VALIDATE-EXCEEDS-MAX
                ELSE
                  NEXT SENTENCE
              ELSE
                PERFORM VALIDATE-TEST-PP
      * PERSONAL PROPERTY OF 888888, SKIP MAX TEST
                IF NOT SP-INSMAXCHGABL-OVRIDE(ILEV)
                 IF PD-INSCOVR(I-LEVEL) > CEP-INS-COVERAGE(I-LEVEL)
                  MOVE "INS. COVERAGE" TO TYPE-OF-AMT-EXCEEDED
                  MOVE CEP-INS-COVERAGE(I-LEVEL) TO HOLD-AMT-EXCEEDED
                  GO TO VALIDATE-EXCEEDS-MAX.

           IF ELE = 34
              IF PD-SERCHG > CEP-SERVICE-CHG
                 MOVE "SERVICE CHG" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-SERVICE-CHG TO HOLD-AMT-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 35
              IF SP-MFFRMLA-05
                 MOVE SAVE-MAINTFEE TO AMT-HOLDER
              ELSE
                 MULTIPLY PD-MAINTFEE BY PD-ORGTERM GIVING AMT-HOLDER
                    ROUNDED
              END-IF
              IF AMT-HOLDER > CEP-MAINT-FEES
                 MOVE "MAINT. FEE" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-MAINT-FEES TO HOLD-AMT-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.
           IF ELE = 36
              IF PD-EXTCHG > CEP-1ST-PY-EXT
                 MOVE "EXT. CHG" TO TYPE-OF-AMT-EXCEEDED
                 MOVE CEP-1ST-PY-EXT TO HOLD-AMT-EXCEEDED
                 GO TO VALIDATE-EXCEEDS-MAX.

           GO TO EXIT-VALIDATION.

       VALIDATE-TEST-PP.
           IF PD-INSTYPES-PP
              SET ILEV TO 6
           ELSE
              SET ILEV TO 7.

       VALIDATE-EXCEEDS-MAX.
           UNSTRING AMT-EXCEEDED-LIT DELIMITED BY ALL " "
              INTO MESS AMT-EXCEEDED-LIT.
           STRING TYPE-OF-AMT-EXCEEDED DELIMITED BY "  "
              " EXCEEDS CURRENT MAXIMUM OF ",
              AMT-EXCEEDED-LIT DELIMITED BY SIZE INTO MESS.
           PERFORM SEND-MESS.
           MOVE " " TO MESS AMT-EXCEEDED-LIT.
           MOVE 9 TO IO-FG.

       EXIT-VALIDATION.
           EXIT.

      ***********************************************************************
      *    VERIFY LOAN RENEWAL AMOUNT HAS NOT CHANGED
      *
      *
      *  N O T E:   THIS TEST MUST BE DONE, SUCH THAT NO OTHER OPERATOR INPUT
      *             WILL OCCUR BEFORE DOING UPDATE OF THE LOAN (LONPB2.C)
      *
      *    WHEN RENEWAL, CHECK IF RENEWED AMOUNT HAS CHANGED EX. OPERATOR
      *    REVERSED PAYOFF AND POSTED MONEY AND RE-POSTED RENEWAL PAYOFF
      *    FROM ANOTHER SCREEN
      *                                                      WORLD PR#286
      ***********************************************************************
       VERIFY-LOAN-RN-PAYOFF SECTION.
      ***********************************************************************

           IF NOT (QUOTE-ONLY OR PD-POCD-INRESCISSION)
              IF PD-SRCD = "PB" OR "RN" OR "SC" OR "RB" OR "RO"
                 MOVE PD-REC    TO SAVE-PD-REC
                 MOVE "Y"       TO ERRORS-EXIST
   
                 MOVE "R"       TO PD-ID
                 MOVE BRANCH    TO PD-BRANCH
                 MOVE PD-PRLNNO TO PD-SOC-SEC
                 PERFORM GET-PD1
                 IF IO-GOOD
                    COMPUTE VDUNUM2 ROUNDED =
                      (PD-PRBAL + PD-PRINTDUE)
                                    - (PD-PRFINCHGRB + PD-PRINSRB)
                    IF VDUNUM2 = PRIOR-LNAMT
                       MOVE "N" TO ERRORS-EXIST
                    ELSE
                       MOVE "RENEWAL PAYOFF HAS CHANGED" TO MESS
                       PERFORM SEND-MESS
                    END-IF
                 END-IF
                 MOVE SAVE-PD-REC TO PD-REC.
   
       VERIFY-LOAN-RN-PAYOFF-EXIT.
           EXIT.

      *********************************
       SRCD-VALIDATION SECTION.
      *********************************

      * SP-RENEWAL-EDIT = "B" OR "C"
      * "B" = NO PB OR RN RENEWALS FOR THIS SPR
      * "C" = NO NEW LOANS FOR THIS SPR

           MOVE 0 TO WS-SRCD-ERRCD.

           IF SP-RENEWAL-EDIT = "B"
              IF PD-SRCD = "PB" OR "RN"
                 MOVE "PB RENEWALS ARE NOT ALLOWED IN THIS SUB-CLASS"
                          TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO WS-SRCD-ERRCD.

           IF SP-RENEWAL-EDIT = "C"
              IF PD-SRCD = "NB" OR "FB" OR "CP" OR "DM" OR "ML" OR
                             "RF" OR "TX"
                 MOVE "NB & FB LOANS ARE NOT ALLOWED IN THIS SUB-CLASS"
                            TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO WS-SRCD-ERRCD.

       EXIT-SRCD-VALIDATION.
           EXIT.

      ***********************************************************************
       W12EQ2-WINDOW SECTION.
      ***********************************************************************

      * FORMULA 12 LIKE 2 BUT SPREADS 1STPAY EXTENSION CHARGE
      * OVER PAYMENTS (CITIZENS #2006)

           MOVE PD-OVRDRATE         TO W12EQ2-OVRDRATE.
           MOVE PD-OVRDRATE-FG      TO W12EQ2-OVRDRATE-FG.
           MOVE PD-EFFRATE          TO W12EQ2-EFFRATE.
           MOVE PD-EXTCHG           TO W12EQ2-EXTCHG.
    
           MOVE PD-ORGTERM          TO W12EQ2-ORGTERM.
           MOVE PD-1STPYAMT         TO W12EQ2-1STPYAMT.
           MOVE PD-REGPYAMT         TO W12EQ2-REGPYAMT.
           MOVE PD-LASTPYAMT        TO W12EQ2-LASTPYAMT.
           PERFORM GET-W12EQ2-NEW-PAYMENTS.
    
           MOVE PD-APR-FINAMT       TO APR-FINANCED.
           MOVE PD-INTDATE          TO APR-INTDATE.
           MOVE PD-1STPYDATE        TO APR-1STPYDATE.
           MOVE PD-ORGTERM          TO APR-ORGTERM.
           MOVE W12EQ2-1STPYAMT     TO APR-1STPYAMT.
           MOVE W12EQ2-REGPYAMT     TO APR-REGPYAMT.
           MOVE W12EQ2-LASTPYAMT    TO APR-LASTPYAMT.
           MOVE PD-UNITPER-CD       TO APR-UNITPER-CD.
           MOVE PD-UNITPER-FREQ     TO APR-UNITPER-FREQ.
           MOVE SP-DISFRMLA         TO APR-DISFRMLA.
           PERFORM APR-REGZ.
           MOVE APR-APR             TO W12EQ2-APRATE.

           MOVE "WI/W12EQ2"  TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH W12EQ2-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
    
       W12EQ2-WINDOW-EXIT.
           EXIT.

      *****************************
       SP-EDT-TABLE-LOOKUP SECTION.
      *****************************
           SET ETBL TO 1.
           MOVE 0 TO COUNTER.
           IF ELE = 14 OR 19 OR 20 OR 21
              MOVE 999 TO TERM-LOW
              MOVE 999999.99 TO PROCEEDS-LOW
              MOVE 0 TO TERM-HIGH PROCEEDS-HIGH
              COMPUTE AMT-HOLDER ROUNDED =
                   PRIOR-LNAMT + PD-PROCEEDS + TOTAL-GL-HLDR
              GO TO PROCEEDS-VALIDATION.

           IF ELE = 18
              MOVE 999999.99 TO POINTS-LOW
              GO TO POINTS-VALIDATION.

           IF PD-ORGTERM < 1
           IF PD-ORGTERM < 1
              GO TO OUT-OF-RANGE-MSG.

       TERM-VALIDATION.
           ADD 1 TO COUNTER.

           IF COUNTER > SP-EDT-NOEDITS(ETBL)
              GO TO TERM-TABLE2.

           IF SP-EDT-TYPE(ETBL,COUNTER) = "T"
              IF SP-EDT-HL(ETBL,COUNTER) = "L"
                 IF SP-EDT-TERM(ETBL,COUNTER) < TERM-LOW
                    MOVE SP-EDT-TERM(ETBL,COUNTER) TO TERM-LOW
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF SP-EDT-TERM(ETBL,COUNTER) > TERM-HIGH
                    MOVE SP-EDT-TERM(ETBL,COUNTER) TO TERM-HIGH.

           IF COUNTER NOT > SP-EDT-NOEDITS(ETBL)
              GO TO TERM-VALIDATION.

       TERM-TABLE2.
           IF (SP-EDT-NOEDITS(ETBL) NOT < 6) AND (ETBL NOT = 2)
              MOVE 0 TO COUNTER
              SET ETBL TO 2
              GO TO TERM-VALIDATION.

           IF ((PD-ORGTERM < TERM-LOW) AND (TERM-LOW NOT = 999))
                  OR
              ((PD-ORGTERM > TERM-HIGH) AND (TERM-HIGH NOT = 0))
              GO TO OUT-OF-RANGE-MSG.

           GO TO EXIT-SP-EDT-TABLE-LOOKUP.

       POINTS-VALIDATION.
           ADD 1 TO COUNTER.

           IF COUNTER > SP-EDT-NOEDITS(ETBL)
              GO TO POINTS-TABLE2.

           IF SP-EDT-TYPE(ETBL COUNTER) = "P"
              IF SP-EDT-HL(ETBL COUNTER) = "L"
                 IF SP-EDT-AMT(ETBL COUNTER) < POINTS-LOW
                    MOVE SP-EDT-AMT(ETBL COUNTER) TO POINTS-LOW
                 END-IF
              ELSE
              IF SP-EDT-HL(ETBL COUNTER) = "H"
                 IF SP-EDT-AMT(ETBL COUNTER) > POINTS-HIGH
                    MOVE SP-EDT-AMT(ETBL COUNTER) TO POINTS-HIGH.

           IF COUNTER NOT > SP-EDT-NOEDITS(ETBL)
              GO TO POINTS-VALIDATION.

       POINTS-TABLE2.
           IF SP-EDT-NOEDITS(ETBL) NOT < 6 AND ETBL NOT = 2
              MOVE 0 TO COUNTER
              SET ETBL TO 2
              GO TO POINTS-VALIDATION.
           IF ( (PD-POINTS < POINTS-LOW    ) AND
                (POINTS-LOW NOT = 999999.99)
              ) OR
              ( (PD-POINTS > POINTS-HIGH   ) AND
                (POINTS-HIGH NOT = 0       )
              )
              GO TO POINTS-OUT-OF-RANGE-MSG.

           MOVE 0 TO COUNTER.
           GO TO EXIT-SP-EDT-TABLE-LOOKUP.

       POINTS-OUT-OF-RANGE-MSG.
           MOVE "THE NO. OF POINTS IS OUT OF SP RANGE" TO MESS.
           PERFORM SEND-MESS.
           MOVE 9 TO IO-FG.
           GO TO EXIT-SP-EDT-TABLE-LOOKUP.

       PROCEEDS-VALIDATION.
           ADD 1 TO COUNTER.

           IF COUNTER > SP-EDT-NOEDITS(ETBL)
              GO TO PROCEEDS-TABLE2.

      *--->IF SP-EDT-TYPE(ETBL,COUNTER) = "A"
      *       IF SP-EDT-HL(ETBL,COUNTER) = "L"
      *          IF SP-EDT-AMTYPE(ETBL,COUNTER) = "P"
      *             IF SP-EDT-AMT(ETBL,COUNTER) < PROCEEDS-LOW
      *--------------->MOVE SP-EDT-AMT(ETBL,COUNTER) TO PROCEEDS-LOW.
           IF SP-EDT-TYPE(ETBL,COUNTER) = "A"
              IF SP-EDT-HL(ETBL,COUNTER) = "H"
      *--------->IF SP-EDT-AMTYPE(ETBL,COUNTER) = "P"
                    IF SP-EDT-AMT(ETBL,COUNTER) > PROCEEDS-HIGH
                       MOVE SP-EDT-AMT(ETBL,COUNTER) TO PROCEEDS-HIGH.

           IF COUNTER NOT > SP-EDT-NOEDITS(ETBL)
              GO TO PROCEEDS-VALIDATION.

       PROCEEDS-TABLE2.
           IF SP-EDT-NOEDITS(ETBL) NOT < 6 AND ETBL NOT = 2
              MOVE 0 TO COUNTER
              SET ETBL TO 2
              GO TO PROCEEDS-VALIDATION.

      *--->IF ((AMT-HOLDER < PROCEEDS-LOW)
      *                 AND (PROCEEDS-LOW NOT = 999999.99))
      *---------->OR ((AMT-HOLDER > PROCEEDS-HIGH)
           IF ((AMT-HOLDER > PROCEEDS-HIGH)
                               AND (PROCEEDS-HIGH NOT = 0))
              GO TO PROCEEDS-OUT-OF-RANGE-MSG.

           MOVE 0 TO AMT-HOLDER COUNTER.
           GO TO EXIT-SP-EDT-TABLE-LOOKUP.

       PROCEEDS-OUT-OF-RANGE-MSG.
           MOVE "PRIOR LOAN BAL + PROCEEDS + G/L FEES OUT OF SP RANGE"
                                                               TO MESS.
           PERFORM SEND-MESS.
           MOVE 9 TO IO-FG.
           GO TO EXIT-SP-EDT-TABLE-LOOKUP.

       OUT-OF-RANGE-MSG.
           MOVE "VALUE OUT OF RANGE SET IN SP RECORD" TO MESS.
           PERFORM SEND-MESS.
           MOVE 9 TO IO-FG.

       EXIT-SP-EDT-TABLE-LOOKUP.
           EXIT.

      *****************************
       DISPLAY-PROMPTS SECTION.
      *****************************
           IF SP-FEEFRMLA(1) = " "
              MOVE " " TO PROMPT-200
                          PROMPT-201
           ELSE
              MOVE "20" TO PROMPT-200
              STRING SP-FEEID(1) "     :" DELIMITED BY SIZE
                         INTO PROMPT-201.

           IF SP-FEEFRMLA(2) = " "
              MOVE " " TO PROMPT-210
                          PROMPT-211
           ELSE
              MOVE "21" TO PROMPT-210
              STRING SP-FEEID(2) "     :" DELIMITED BY SIZE
                          INTO PROMPT-211.

      *    IF GP-DLR-DISP-TYPE = "C"
      *       MOVE "DLCOMM :" TO PROMPT-251
      *    ELSE
      *       MOVE "DLDISC :" TO PROMPT-251.

           MOVE PROMPT-BUF TO WR-BUF.
           MOVE PROMPT-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

       DISPLAY-PROMPTS-EXIT.
           EXIT.

      ******************************************
       CALL-LOAN-CALCULATIONS SECTION.
      ******************************************

           MOVE PD-UNITPER-CD TO CIP-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO CIP-UNITPER-FREQ.
           MOVE PD-BALLOON-LAST-FG TO CIP-BALLOON-LAST-FG.
           PERFORM MATURITY-DATE-CALCULATION.
           MOVE NDTE-DATE TO CIP-MATURITY-DATE.

           MOVE PD-SELLPR-FG TO CIP-SELLPR-FG.
           MOVE "I" TO CIP-DOWNPY-FG
                       CIP-PERDOWN-FG.
           MOVE PD-SELLPR TO CIP-SELLPR.
           MOVE 0 TO CIP-DOWNPY
                     CIP-PERDOWN.
           MOVE TOTAL-GL-HLDR TO CIP-GL-AMOUNT-TOTAL.
           IF BR-FORCE-VALID-CITY-COUNTY = "Y"
              SUBTRACT TOTAL-GL-HLDR-SALESTAX
                            FROM CIP-GL-AMOUNT-TOTAL.
           MOVE TOTAL-GL-FINCHG-HLDR TO CIP-GL-AMOUNT-TOTAL-FINCHG.

           MOVE "CALCULATING - PLEASE WAIT" TO LEGEND.
           PERFORM SEND-LEGEND.

      * SETUP VERIFY-REJECT-TERMS RE: SP-INSREJECT-FG = "C":
           PERFORM ESTABLISH-REJECT-TERMS.

      *-----------------------------------------------------------------
      * THE LOAN CALCULATOR WILL DEFAULT 1ST PAYMENT TO ONE MONTH FROM INT
      * IF A CAN LOAN.  THAT IS OK FOR THE CAN LOAN BUILDER BUT WHEN
      * BOOKING THE LOAN WE NEED TO MAKE SURE 1ST PAYMENT IS ADVANCED
      * CORRECTLY IF THE GP FLAG IS SET TO DO SO.   THE CALCULATOR DOES
      * NOT DIFFERENTIATE BETWEEN CAN LOAN BUILDER OR LOAN RNTRY THAT
      * I CAN FIND SO I AM MANIPULATING THE CAN LOAN NUMBER HERE.
      * I CAN FIND SO I AM MANIPULATING THE CAN LOAN NUMBER HERE.
      * SOME ISSUES WITH REGIONAL MANAGMENT (AND POSSIBLY ALL),
      * AS PER JIM EXCLUDING THEN UNTIL RESOLUTION CAN BE FOUND.
      *-----------------------------------------------------------------
           PERFORM SET-ADV-TO-1ST-NO-CORR.
           IF ADV-TO-1ST-NO-CORR NOT = "A"
              MOVE CAN-LOAN-NO TO CIP-CAN-LOAN-NO.

      *----------------------------------------------------------
      *    ENVIRONMENT VARIABLE 'CALL_TESTZ3' IS USED TO CALL
      *    ANOTHER VERSION OF CALCZ3,
      *    NOTE:
      *         HELPFULL WHEN TRYING TO RUN CALCZ3.C IN DEBUG
      *         FROM TWO TERMINALS AT THE SAME TIME.
      *         THE DEBUGGER DOSN'T ACT CORRECTLY WITH TWO
      *         SESSIONS RUN TOGETHER
      *         OR
      *         WHEN MAKING LARGE CHANGES TO CALCZ3.C
      *
      *    MOVE "CALL_TESTZ3" TO GETENV-BUF.
      *    PERFORM GETENV-CALL.
      *    IF STAT = "00"
      *       MOVE "LP/TESTZ3" TO FORM-NAM
      *    ELSE
      *----------------------------------------------------------

           MOVE "LP/CALCZ3" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH
                                CIP-CALCULATION-INPUT-AREA
                                CEP-CALCULATION-EDIT-AREA
                                COP-CALCULATION-OUTPUT-AREA
                                SP-REC
                                BR-REC BW-1-STATE BW-1-CITY-TAX-CD
                                BW-1-COUNTY.
           CANCEL FORM-PROGX.

           MOVE COP-PRLOAN-RESTRICTED TO PRLOAN-RESTRICTED.
           MOVE COP-PROCEEDS TO PD-PROCEEDS
                                PROCEEDS-HLDR.

           MOVE COP-SELLPR-FG TO PD-SELLPR-FG.
           MOVE "I" TO PD-DOWNPY-FG.
           MOVE "I" TO PD-PERDOWN-FG.
           MOVE COP-SELLPR TO PD-SELLPR.
           MOVE 0 TO PD-DOWNPY.
           MOVE 0 TO PD-PERDOWN.

           MOVE COP-PROCEEDS-SW TO PD-PROCEEDS-FG
                                   PROCEEDS-FG-HLDR
                                   DF2-PROCEEDS-FG.

           MOVE PD-SELLPR TO DF2-SELLPR
                             SELLPR-HLDR.
           MOVE PD-SELLPR-FG TO DF2-SELLPR-FG.

           MOVE COP-BALLOON TO DF2-BALLOON.
           MOVE COP-BALLOON-SW TO PD-BALLOON-FG
                                 DF2-BALLOON-FG.

           MOVE COP-POINTS TO PD-POINTS DF2-POINTS.
           MOVE COP-POINTS-SW TO PD-POINTS-FG DF2-POINTS-FG.
           IF COP-POINTS = 0
              MOVE " " TO DF2-POINTS-FG.

           MOVE PD-ENDORATE TO DF2-ENDORATE.
           MOVE COP-OVR-RATE TO PD-OVRDRATE DF2-OVRDRATE.
           MOVE COP-OVR-RATE-SW TO PD-OVRDRATE-FG DF2-OVRDRATE-FG.
           MOVE COP-EFF-RATE TO PD-EFFRATE DF2-EFFRATE.
           MOVE COP-SIM-RATE TO PD-SMPRATE.
           MOVE COP-APR-RATE TO PD-APRATE DF2-APRATE.
           MOVE COP-TOT-REPYBLE TO DF2-TREPAY.
           PERFORM MOVE-INSURANCE-TO-PDREC
                VARYING COUNTER FROM 1 BY 1
                   UNTIL COUNTER > 4.

           IF SP-FEEFRMLA(1) = " "
              MOVE 0 TO DF2-FEE-1
              MOVE " " TO DF2-FEE-1-FG
           ELSE
              MOVE SP-FEECD(1) TO PD-FEECODE(1)
              MOVE COP-FEE-CHG(1) TO PD-FEEAMT(1)
                                     DF2-FEE-1
              MOVE COP-FEE-CHG-SW(1) TO PD-FEECD-FG(1)
                                        DF2-FEE-1-FG
              IF NOT (BR-OUR-FEE = "Y" OR "N")
                 MOVE "Y" TO PD-FEEOURS(1)
              ELSE
                 MOVE BR-OUR-FEE TO PD-FEEOURS(1).

           IF SP-FEEFRMLA(2) = " "
              MOVE 0 TO DF2-FEE-2
              MOVE " " TO DF2-FEE-2-FG
           ELSE
              MOVE SP-FEECD(2) TO PD-FEECODE(2)
              MOVE COP-FEE-CHG(2) TO PD-FEEAMT(2)
                                     DF2-FEE-2
              MOVE COP-FEE-CHG-SW(2) TO PD-FEECD-FG(2)
                                        DF2-FEE-2-FG
              IF NOT (BR-OUR-FEE = "Y" OR "N")
                 MOVE "Y" TO PD-FEEOURS(2)
              ELSE
                 MOVE BR-OUR-FEE TO PD-FEEOURS(2).

           MOVE COP-SERVICE-CHG TO PD-SERCHG
                                   PD-SUM-SERCHG
                                   DF2-SERCHG.
           MOVE COP-STATE-WORKER TO PD-STATE-WORKER.
           MOVE COP-SERVICE-CHG-SW TO PD-SERCHG-FG DF2-SERCHG-FG.
           MOVE COP-MAINT-FEES TO DF2-MAINTFEE MAINTFEE-HLDR.
           DIVIDE COP-MAINT-FEES BY COP-TERM GIVING
              PD-MAINTFEE ROUNDED.
           IF SP-MFFRMLA-05
              MOVE COP-MAINT-FEES TO PD-SUM-MAINTFEE
           ELSE
              MOVE PD-MAINTFEE TO PD-SUM-MAINTFEE.
           MOVE COP-MAINT-FEES-SW TO PD-MAINTFEE-FG DF2-MAINTFEE-FG.
           MOVE COP-1ST-PY-EXT TO PD-EXTCHG
                                  PD-SUM-EXTCHG
                                  DF2-EXTCHG.

           MOVE COP-1ST-PY-EXT-SW TO PD-EXTCHG-FG DF2-EXTCHG-FG.
           MOVE COP-INT-CHARGE TO PD-INTCHG
                                  PD-SUM-INTCHG
                                  DF2-INTCHG.
           MOVE COP-APR-FINANCD TO PD-APR-FINAMT DF2-APR-FINAMT.
           MOVE COP-AMT-FINANCD TO PD-FINAMT.
           MOVE COP-LOAN-AMOUNT TO PD-LNAMT
                                   PD-SUM-LNAMT
                                   PD-PURBAL
                                   PD-ORIGPURAMT
                                   PD-SUM-ORIGPURAMT
                                   DF2-LNAMT.
           IF PD-LOANTYPE = "I"
              MOVE PD-SERCHG TO PD-ANTICERN(3)
              MOVE 0 TO PD-ANTICERN(1)
                        PD-ANTICERN(2)
              IF GP-ALLOW-MF-ON-IB = "Y"
                 MOVE COP-MAINT-FEES TO PD-ANTICERN(4)
              ELSE
                 MOVE 0 TO PD-ANTICERN(4)
              END-IF
           ELSE
              ADD COP-INT-CHARGE COP-1ST-PY-EXT GIVING PD-ANTICERN(1)
              MOVE COP-SERVICE-CHG TO PD-ANTICERN(3)
              MOVE COP-MAINT-FEES TO PD-ANTICERN(4).
           MOVE 0 TO PD-ANTICERN(5) PD-ANTICERN(6).

            MOVE PD-ANTICERN(1) TO WK-ANTICERN(1).
            MOVE PD-ANTICERN(2) TO WK-ANTICERN(2).
            MOVE PD-ANTICERN(3) TO WK-ANTICERN(3).
            MOVE PD-ANTICERN(4) TO WK-ANTICERN(4).
            MOVE PD-ANTICERN(5) TO WK-ANTICERN(5).
            MOVE PD-ANTICERN(6) TO WK-ANTICERN(6).
            PERFORM ADJUST-ANTICERN.
            MOVE WK-ANTICERN(1) TO PD-ANTICERN(1).
            MOVE WK-ANTICERN(2) TO PD-ANTICERN(2).
            MOVE WK-ANTICERN(3) TO PD-ANTICERN(3).
            MOVE WK-ANTICERN(4) TO PD-ANTICERN(4).
            MOVE WK-ANTICERN(5) TO PD-ANTICERN(5).
            MOVE WK-ANTICERN(6) TO PD-ANTICERN(6).

           MOVE COP-REGPYAMT TO PD-REGPYAMT
                                PD-SUM-REGPYAMT
                                DF2-REGPYAMT.
           MOVE COP-REGPYAMT-SW TO PD-REGPYAMT-FG
                                   DF2-REGPYAMT-FG.

           IF COP-ODD-1ST-PMT = 0
              MOVE PD-REGPYAMT TO PD-1STPYAMT
                                  DF2-1STPYAMT
           ELSE
              MOVE COP-ODD-1ST-PMT TO PD-1STPYAMT
                                      DF2-1STPYAMT.

           IF COP-BALLOON-LAST-FG = "L"
              MOVE COP-BALLOON TO PD-LASTPYAMT
                                 DF2-LASTPYAMT
           ELSE
      *       DEFENSE IF
              IF PD-ORGTERM = 1
                 MOVE 0 TO PD-LASTPYAMT DF2-LASTPYAMT
              ELSE
                 ADD COP-REGPYAMT COP-BALLOON GIVING PD-LASTPYAMT
                                                     DF2-LASTPYAMT.

           SUBTRACT 1 FROM PD-ORGTERM GIVING PD-NOREGPY.
           IF PD-LASTPYAMT NOT = 0
              SUBTRACT 1 FROM PD-NOREGPY.

           MOVE COP-FINCHG TO PD-FINCHG
                              PD-SUM-FINCHG.
           MOVE COP-RETURN-CODE TO DF2-RETURN-CODE.
           MOVE COP-LOOP-COUNT TO DF2-LOOP-COUNT.

           IF COP-1ST-PMT-MTHS = 1 AND
              COP-1ST-PMT-DAYS = 0
              MOVE "Y" TO PD-ONE-MTH-NO-DAY-EXT-SW
           ELSE
              MOVE " " TO PD-ONE-MTH-NO-DAY-EXT-SW.

           PERFORM DISPLAY-PROMPTS.
           COMPUTE ANTIC = PD-ANTICERN(1) + PD-ANTICERN(2)
                         + PD-ANTICERN(3) + PD-ANTICERN(4)
                         + PD-ANTICERN(5).
           IF NOT GP-INCL-OTH-IN-EARNED-N
              ADD PD-ANTICERN(6) TO ANTIC.
           MOVE ANTIC TO DF2-ANTIC.

           MOVE DF2-BUF TO WR-BUF.
           MOVE DF2-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

      * DETERMINE IF INSURANCE SALES TAX EXISTS
      * IF SO:
      *       SET SALES TAX AS FEE CODES

           IF ((BR-FORCE-VALID-CITY-COUNTY = "Y") AND
               (SP-INSURANCE-WRITTEN NOT = "N"))

              IF COP-INS-TAX(1) = 0
                 MOVE " "            TO PD-FEECODE(5)
                 MOVE " "            TO PD-FEEOURS(5)
                 MOVE " "            TO PD-FEEFINCHG(5)
                 MOVE 0              TO PD-FEEAMT(5)
              ELSE
                 MOVE "TC"           TO PD-FEECODE(5)
                 MOVE "Y"            TO PD-FEEOURS(5)
                 MOVE "N"            TO PD-FEEFINCHG(5)
                 MOVE COP-INS-TAX(1) TO PD-FEEAMT(5)
              END-IF
   
              IF COP-INS-TAX(2) = 0
                 MOVE " "            TO PD-FEECODE(6)
                 MOVE " "            TO PD-FEEOURS(6)
                 MOVE " "            TO PD-FEEFINCHG(6)
                 MOVE 0              TO PD-FEEAMT(6)
              ELSE
                 MOVE "TA"           TO PD-FEECODE(6)
                 MOVE "Y"            TO PD-FEEOURS(6)
                 MOVE "N"            TO PD-FEEFINCHG(6)
                 MOVE COP-INS-TAX(2) TO PD-FEEAMT(6)
              END-IF
   
              IF COP-INS-TAX(3) = 0
                 MOVE " "            TO PD-FEECODE(7)
                 MOVE " "            TO PD-FEEOURS(7)
                 MOVE " "            TO PD-FEEFINCHG(7)
                 MOVE 0              TO PD-FEEAMT(7)
              ELSE
                 MOVE "TP"           TO PD-FEECODE(7)
                 MOVE "Y"            TO PD-FEEOURS(7)
                 MOVE "N"            TO PD-FEEFINCHG(7)
                 MOVE COP-INS-TAX(3) TO PD-FEEAMT(7)
              END-IF
   
              IF COP-INS-TAX(4) = 0
                 MOVE " "            TO PD-FEECODE(8)
                 MOVE " "            TO PD-FEEOURS(8)
                 MOVE " "            TO PD-FEEFINCHG(8)
                 MOVE 0              TO PD-FEEAMT(8)
              ELSE
                 MOVE "T1"           TO PD-FEECODE(8)
                 MOVE "Y"            TO PD-FEEOURS(8)
                 MOVE "N"            TO PD-FEEFINCHG(8)
                 MOVE COP-INS-TAX(4) TO PD-FEEAMT(8)
              END-IF
   
              IF COP-INS-TAX(5) = 0
                 MOVE " "            TO PD-FEECODE(9)
                 MOVE " "            TO PD-FEEOURS(9)
                 MOVE " "            TO PD-FEEFINCHG(9)
                 MOVE 0              TO PD-FEEAMT(9)
              ELSE
                 MOVE "T2"           TO PD-FEECODE(9)
                 MOVE "Y"            TO PD-FEEOURS(9)
                 MOVE "N"            TO PD-FEEFINCHG(9)
                 MOVE COP-INS-TAX(5) TO PD-FEEAMT(9)
              END-IF
   
              IF COP-INS-TAX(6) = 0
                 MOVE " "            TO PD-FEECODE(10)
                 MOVE " "            TO PD-FEEOURS(10)
                 MOVE " "            TO PD-FEEFINCHG(10)
                 MOVE 0              TO PD-FEEAMT(10)
              ELSE
                 MOVE "T3"           TO PD-FEECODE(10)
                 MOVE "Y"            TO PD-FEEOURS(10)
                 MOVE "N"            TO PD-FEEFINCHG(10)
                 MOVE COP-INS-TAX(6) TO PD-FEEAMT(10)
              END-IF.
   
           PERFORM SETUP-FEES-FOR-DISPLAY.
           MOVE D-190 TO WR-BUF.
           MOVE FEE-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           PERFORM RESET-LEGEND.
           MOVE COP-CALCULATION-OUTPUT-AREA TO
                CIP-CALCULATION-INPUT-AREA.
           PERFORM VERIFY-SETUP-PAYMENTS.
           IF NOREG-FG NOT = " "
              PERFORM ERROR-IN-CALCULATIONS-MSG
           ELSE
              IF COP-CALCULATION-OK
                 PERFORM VERIFY-AGAINST-SPEDT
              ELSE
                 PERFORM ERROR-IN-CALCULATIONS-MSG.

           MOVE 0 TO IO-FG.


      ******************************************************************
       CHECK-FOR-PASSWORD SECTION.
      ******************************************************************

      * CHECKING TO SEE IF LOGIN ID IS A GROUP MEMBER

           MOVE CASE-BUF TO USER-GROUP WGR-WORD.
           PERFORM CHECK-MEMBER.

           IF ( WGR-ERR > 0 )
              GO TO PASSWORD-REQUIRED-BR.

      * CHECKING TO SEE IF BRANCH ENTERED IS WITHIN THE MEMBER.

           PERFORM OPEN-GR1-FILE.
           MOVE USER-GROUP TO GR-ID.
           PERFORM SEARCH-GR-INIT.
           MOVE BRANCH TO WGR-SRESULT.
           PERFORM SEARCH-GR-VERIFY.

           IF ( WGR-ERR > 0 )
              GO TO PASSWORD-REQUIRED-BR.

      *  CHECK FOR SEQUENCE 2 PASSWORD - MERCURY HAS SECRETARY LOGINS
      *  SUCH AS P0158VP1 WHO NEED TO RUN REPORTS FOR VP'S BUT SHOULDN'T
      *  BE ALLOWED TO APPROVE; PASSWD = LONPB0 SEQ 2

           MOVE APPROVAL-SEQ2 TO PASSWDW-SEQ.
           PERFORM VERIFY-PASSWORD.

           IF ( PASSWDW-STAT NOT = "OK" )
              MOVE MESSAGE-NEED-PASSWORD TO MESS
              PERFORM SEND-MESS.

           GO TO EXIT-CHECK-FOR-PASSWORD.

      * LOGIN ID OR BRANCH ENTERED IS NOT VALID,
      * MUST ENTER PASSWORD TO MAKE CHANGE TO LIMIT.

       PASSWORD-REQUIRED-BR.

           MOVE APPROVAL-SEQ TO PASSWDW-SEQ.
           PERFORM VERIFY-PASSWORD.

           IF ( PASSWDW-STAT NOT = "OK" )
              MOVE MESSAGE-NEED-PASSWORD TO MESS
              PERFORM SEND-MESS.

       EXIT-CHECK-FOR-PASSWORD.
           EXIT.


      ******************************************************************
       GET-SYSTEM-DATE SECTION.
      ******************************************************************
           MOVE "SYSDATE_YYMMDD" TO GETENV-BUF.
           PERFORM GETENV-CALL.
           IF STAT = "00"
              MOVE GETENV-BUF TO DATE-YYMMDD-ALP
              PERFORM CONVERT-YYMMDD-TO-YYYYMMDD
              MOVE DATE-YYYYMMDD TO WS-SYSTEM-DATE
           ELSE
              ACCEPT WS-SYSTEM-DATEX FROM CENTURY-DATE.

      ******************************
       GET-BW1-FOR-SPEDT SECTION.
      ******************************
           MOVE 4 TO XAGE-MAX.

           IF PD-SSNO(1) = 0
              MOVE 0               TO BW-BDATE
                                      BW-REFDATE
              MOVE 0               TO BW-CREDIT-SCORE
              MOVE BW-BDATE        TO VERIFY-AGE
              MOVE BW-REFDATE      TO VERIFY-REFDATE
              MOVE 1 TO VERIFY-MAKER-SUB
              PERFORM VERIFY-TERMCEIL
              GO TO DONE-WITH-BW1-SPEDT.

      * IF MAKER INSURANCE, TEST PRIMARY MAKER'S AGE EDITS...
      
           IF PD-INSURED = "M"
              IF PD-SSNO(1) NOT = BW-SSNO
                 MOVE PD-SSNO(1) TO BW-SSNO
                 PERFORM GET-BW1
                 IF IO-FG = 9
                    MOVE 0 TO BW-BDATE BW-REFDATE
                 END-IF
              END-IF
              MOVE BW-BDATE   TO VERIFY-AGE
              MOVE BW-REFDATE TO VERIFY-REFDATE
              MOVE 1          TO VERIFY-MAKER-SUB
              PERFORM VERIFY-TERMCEIL
              GO TO DONE-WITH-BW1-SPEDT.

      * IF SECONDARY (SPOUSE) INSURANCE, TEST SECOND MAKER'S AGE EDITS...
      
           IF PD-INSURED = "S"
              IF PD-SSNO(2) NOT = BW-SSNO
                 MOVE PD-SSNO(2) TO BW-SSNO
                 PERFORM GET-BW1
                 IF IO-FG = 9
                    MOVE 0 TO BW-BDATE BW-REFDATE
                 END-IF
              END-IF
              MOVE BW-BDATE   TO VERIFY-AGE
              MOVE BW-REFDATE TO VERIFY-REFDATE
      * THIS IS USED TO SIGNAL TESTING A JOINT MAKER
              MOVE 1          TO VERIFY-MAKER-SUB
              PERFORM VERIFY-TERMCEIL
              GO TO DONE-WITH-BW1-SPEDT.

      * IF JOINT INSURANCE, AND GP FLAG SET, TEST ENDORSERS ALONG
      *        WITH THE JOINT MAKERS
      
           IF PD-INSURED = "J" AND
                              (GP-VALIDATE-ENDORSER-AGE = "Y" OR " ")
              PERFORM VARYING XAGE-SUB FROM 1 BY 1 UNTIL
                                               XAGE-SUB > XAGE-MAX
                 IF PD-MAKERCD(XAGE-SUB) = "M" OR "J" OR "E"
                    IF PD-SSNO(XAGE-SUB) NOT = BW-SSNO
                       MOVE PD-SSNO(XAGE-SUB) TO BW-SSNO
                       PERFORM GET-BW1
                       IF IO-FG = 9
                          MOVE 0 TO BW-BDATE BW-REFDATE
                       END-IF
                    END-IF
                    MOVE BW-BDATE   TO VERIFY-AGE
                    MOVE BW-REFDATE TO VERIFY-REFDATE
                    MOVE XAGE-SUB   TO VERIFY-MAKER-SUB
                    PERFORM VERIFY-TERMCEIL
                    IF VERIFY-REJECT-TERM-FG = "Y"
                       PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
                          IF VERIFY-REJECT-TERM(SUB) NOT = 0
                             IF (CIP-INS-REJECT-TERM(SUB) = 0)
                               OR
                                (VERIFY-REJECT-TERM(SUB) <
                                      CIP-INS-REJECT-TERM(SUB)
                                )
                                MOVE VERIFY-REJECT-TERM(SUB)
                                         TO CIP-INS-REJECT-TERM(SUB)
                             END-IF
                          END-IF
                       END-PERFORM
                    END-IF
                 END-IF
              END-PERFORM.

      * IF JOINT INSURANCE, AND GP FLAG NOT SET, JUST TEST JOINT
      
           IF PD-INSURED = "J" AND GP-VALIDATE-ENDORSER-AGE = "N"
              PERFORM VARYING XAGE-SUB FROM 1 BY 1 UNTIL
                                               XAGE-SUB > XAGE-MAX
                 IF PD-MAKERCD(XAGE-SUB) = "M" OR "J"
                    IF PD-SSNO(XAGE-SUB) NOT = BW-SSNO
                       MOVE PD-SSNO(XAGE-SUB) TO BW-SSNO
                       PERFORM GET-BW1
                       IF IO-FG = 9
                          MOVE 0 TO BW-BDATE BW-REFDATE
                       END-IF
                    END-IF
                    MOVE BW-BDATE   TO VERIFY-AGE
                    MOVE BW-REFDATE TO VERIFY-REFDATE
                    MOVE XAGE-SUB   TO VERIFY-MAKER-SUB
                    PERFORM VERIFY-TERMCEIL
                    IF VERIFY-REJECT-TERM-FG = "Y"
                       PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
                          IF VERIFY-REJECT-TERM(SUB) NOT = 0
                             IF (CIP-INS-REJECT-TERM(SUB) = 0)
                               OR
                                (VERIFY-REJECT-TERM(SUB) <
                                      CIP-INS-REJECT-TERM(SUB)
                                )
                                MOVE VERIFY-REJECT-TERM(SUB)
                                         TO CIP-INS-REJECT-TERM(SUB)
                             END-IF
                          END-IF
                       END-PERFORM
                    END-IF
                 END-IF
              END-PERFORM.

       DONE-WITH-BW1-SPEDT.
           IF VERIFY-REJECT-TERM-FG = "Y"
              IF PD-INSURED NOT = "J"
                 PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
                    MOVE VERIFY-REJECT-TERM(SUB)
                            TO CIP-INS-REJECT-TERM(SUB)
                 END-PERFORM.

       EXIT-BW1-SPEDT.
           EXIT.

       COPY "LIBLP/INSELIG.CPY".
       COPY "LIBLP/RESCIND.CPY".
       COPY "LIBLP/LPANTI.CPY".
       COPY "LIBLP/LPMENU.CPY".
       COPY "LIBWI/PFSWINDOWS.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBLP/LPUPER.CPY".
       COPY "LIBLP/LPUPWK.CPY".
       COPY "LIBLP/UPERTST.CPY".
       COPY "LIBLP/LPDAMTS.CPY".
       COPY "LIBLP/LPSPEDP.CPY".
       COPY "LIBLP/LPPDCL.CPY".
       COPY "LIBLP/LPPCCL.CPY".
       COPY "LIBGB/GRWORK.CPY".
       COPY "LIBGB/GRSERCH.CPY".
       COPY "LIBWI/LNAPPROVAL.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBGB/GPENV.CPY".
       COPY "LIBLP/LPBAGE.CPY".
       COPY "LIBLP/LPAPRZ.CPY".
       COPY "LIBWI/FEEENT.CPY".
       COPY "LIBWI/FEEENTPD.CPY".
       COPY "LIBLP/RNFOR10PD.CPY".
       COPY "LIBLP/LPZ3CL.CPY".
       COPY "LIBWI/W12EQ2PMT.CPY".

      ******************************************************
       FORM-RESET SECTION.
      ******************************************************
           MOVE LPLOAN-SYSDATE TO ZONPC-SYSDATE.
      * NEED TO CLEAR SCREEN ON F1
           DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN.
           DISPLAY ZONPC-SCREEN UPON TCLP-MAIN-WINDOW-HANDLE.
           MOVE ZONPC-FORM-FIELDS TO WR-BUF.
           MOVE ZONPC-FORM-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       FORM-RESET-EXIT.
           EXIT.

      *****************************************************
       SETUP-LINK-INFO SECTION.
      *****************************************************
           IF VDU-FORM-NAME = "LPSMNU"
              MOVE LPSMNU-HELP--FILE TO HELP-LINK-FILE
              MOVE LPSMNU-HELP--DIR  TO HELP-LINK-DIR
           ELSE
              MOVE ZONPC-HELP--FILE TO HELP-LINK-FILE
              MOVE ZONPC-HELP--DIR TO HELP-LINK-DIR.

      *****************************************************
       VDU-CONVERT-FIELD SECTION.
      *****************************************************
           MOVE "00" TO STAT.
           MOVE VDU-FIELD-TO-CONVERT TO VDU-ALP-FIELD.
           EVALUATE TRUE
              COPY "LIBLP/ZONPC_EVA.CPY".
              COPY "LIBLP/LPSMNU_EVA.CPY".
              COPY "LIBLP/LPLNMU_EVA.CPY".
              COPY "LIBLP/LPCAMU_EVA.CPY".
              COPY "LIBLP/LPVDMU_EVA.CPY".
              COPY "LIBWI/GLIMI2_EVA.CPY".
              COPY "LIBWI/GLIMI3_EVA.CPY".
              COPY "LIBWI/FEEENT_EVA.CPY".
              WHEN OTHER       MOVE   "2A" TO STAT
           END-EVALUATE.

      *********************************
       MISC-PARAGRAPHS SECTION.
      *********************************
       COPY "LIBGB/GETENV.CPY".
       COPY "LIBGB/SYSTEM.CPY".
       BLINPC-CALC-WINDOW.
           MOVE "WI/BLINPC" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BLINPC-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       UPDATE-BW-INFO.
           MOVE PD-SSNO(1) TO BWCREA-SSNO(1) BWCREA-NO.
           MOVE ZEROES     TO BWCREA-SSNO(2) BWCREA-SSNO(3)
                              BWCREA-SSNO(4).

      * THIS ALLOWS BWCREA TO KNOW YOU CAME FROM THIS SECTION AND YOU CAN
      * PRESS <RETURN> IN BWCREA TO GET BACK HERE.
           MOVE "Y"        TO BWCREA-ALLOW-CHG.
           MOVE TRANS-DATE TO BWCREA-TRANS-DATE.
           MOVE BRANCH     TO BWCREA-BRANCH.
           MOVE "WI/BWCREA" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWCREA-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       ESTABLISH-CLFILE-INDEX-BY.
           MOVE BR-CAN-GROUP-ID TO THE-CAN-GROUP-ID.
       SET-CLFILE-INDEX-BY.
           MOVE THE-CAN-GROUP-ID TO CL-GROUP-ID  CLSCAN-GROUP-ID.
      *----------------------------------------------------------------
      *    IF MAKING CHANGES, CALCULATE PROCEEDS AND NOT PYAMT
      * REV:
      *  JTG 022797 SKIPPED THIS WHEN STATE IS 'NM', SINCE CAN LOANS
      *             FOR THIS STATE, WHEN RECALCULATED CAUSE ROUNDING
      *             ON THE PROCEEDS & PAYMENT
      *  JTG 031297 SKIPPED THIS WHEN STATE IS 'TX'
      *-----------------------------------------------------------------
       FORCE-CAN-LOAN-NUMBERS.
           IF NOT (SP-ORGST = "NM" OR "TX")
              MOVE "S  A010141." TO VDU
              MOVE "C" TO VDUBUF PD-PROCEEDS-FG
                          CIP-PROCEEDS-SW
              PERFORM SCREENIO
              MOVE "S  A010421." TO VDU
              MOVE "I" TO VDUBUF PD-REGPYAMT-FG
                                 CIP-REGPYAMT-SW
              PERFORM SCREENIO.

      *-------------------------------------------------------------
      *    GET BRANCH RECORD
      *-------------------------------------------------------------
       GET-BR.
           MOVE BRANCH TO BR-NO.
           PERFORM OPEN-BR-FILE.
           PERFORM READ-BR-FILE.
           PERFORM CLOSE-BR-FILE.
      *---------------------------------------------
      *   THIS IS TEMPORARY UNTIL WE HAVE A CAN LOAN BALLOON BUILDER
      *    MOVE "N" TO  BR-CAN-LOANS-FG.
      *--------------------------------------------------------------

       GET-GI.
           PERFORM OPEN-GI1-FILE.
           PERFORM READ-GI1-FILE.
           PERFORM CLOSE-GI1-FILE.

      *----------------------------------------------------------------
      *   INVALID DUE DAY FOR SEMI MONTHLY ACCOUNTS
      *---------------------------------------------------------------
       INVALID-DUE-DAY.
           IF PD-1STPYDA = 31
              MOVE " 31ST OF MONTH INVALID FOR SEMI-MONTHLY PAPER"
                                                           TO MESS
           ELSE
              STRING
            PD-1STPYDA,"TH OF MONTH INVALID FOR SEMI-MONTHLY PAPER"
                                       DELIMITED BY "  " INTO MESS.

      *-----------------------------------------------------------------
       PRIOR-LOAN-ERROR-MSG.
           IF ERROR-IN-PAYOFF
              MOVE "PRIOR LOAN INVALID" TO MESS
              PERFORM SEND-MESS
           ELSE
              MOVE "INITIATE RENEWAL IN TRANSACTION POSTING" TO MESS
              PERFORM SEND-MESS.

      *-----------------------------------------------------------------
       GET-GB.
           PERFORM OPEN-GB-FILE.
           MOVE BRANCH TO GB-BRNO.
           MOVE 1      TO GB-NO.
           PERFORM READ-GB-FILE.
           PERFORM CLOSE-GB-FILE.

      *-----------------------------------------------------------------
       RESCISSION-ROUTINE.
           IF SP-RESCIND-BUS-DAYS-VALID
              IF SP-RESCIND-BUS-DAYS > "0"
                 MOVE "*I" TO PD-POCD
                 MOVE "Y"  TO PD-RESCISSION
                 MOVE " * RESCISSION *" TO WR-BUF
                 MOVE RESCISSION-LIST TO WR-LIST
                 PERFORM CALL-WRFORM
                 PERFORM GET-GB
                 MOVE PD-LOANDATE TO RESCIND-LOANDATE
                 PERFORM RESCIND-CALCULATION
                 MOVE "S  8000061." TO VDU
                 MOVE RESCIND-OUTDATE TO PD-INTDATE
                                         PD-RESCISSION-DATE
                                         VDU-DATE-YYYYMMDD
                 PERFORM SCREENIO
      * NOT TESTING LIMIT-ERROR FOR SPR EXTENSION PERIOD TEST
                 PERFORM SET-FIRST-PAY-DATE.

       SET-FIRST-PAY-DATE.
           MOVE PD-INTDATE TO NDTE-DATE.
           MOVE 1 TO NDTE-HOLD.
           MOVE PD-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           IF PD-UNITPER-CD = "S"
              IF NDTE-DD = 14 OR 15
                 MOVE 16 TO NDTE-DD.
           MOVE "S  8000130." TO VDU.
           MOVE NDTE-DATE TO VDU-DATE-YYYYMMDD
                             PD-1STPYDATE
                             PD-ORIG-1STPYDATE.
           PERFORM SCREENIO.
           PERFORM SPTEST-EXTDATE-VALID.
           IF NEW-FLAG NOT = 1
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
              MOVE PD-LOANDATE TO CIP-LOANDATE
              MOVE PD-INTDATE TO CIP-INTDATE
              MOVE PD-1STPYDATE TO CIP-1STPYDATE
              PERFORM CALL-LOAN-CALCULATIONS.

       RESET-TITLE.

       SET-1ST-PAY-DATE.
           MOVE PD-INTDATE TO NDTE-DATE
                              SYS-DATE.
           MOVE 1 TO NDTE-HOLD.
           MOVE PD-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.

      * WORLD OPTION TO ADVANCE TO 1ST OF NEXT MONTH
      * IF NO CORRESPONDING DAY IN NEW MONTH:
           PERFORM SET-ADV-TO-1ST-NO-CORR.
           IF ADV-TO-1ST-NO-CORR = "Y"
              IF NOT ( GP-I-AM-WORLD     AND
                       PD-ORGST   = "TN" AND
                       PD-CLASS   = 01   AND
                       PD-ORGTERM = 12
                     )
                 IF PD-UNITPER-CD = "M" AND PD-UNITPER-FREQ = 1
                    IF S-DD > NDTE-DD
                       MOVE 1 TO NDTE-DD
                                 NDTE-HOLD
                       PERFORM INCREMENT-MONTHS
                       MOVE NDTE-DATE TO NUM-DATE.
      * WORLD OPTION TO ADVANCE TO 1ST OF NEXT MONTH
      * IF NO CORRESPONDING DAY IN NEW MONTH:

      * IF DATE OF THE LOAN IS ON THE 26 THRU 31 THEN ADVANCE THE
      *   FIRST PAYMENT DUE DATE TO THE FIRST OF THE SECOND MONTH
      *   FOLLOWING THE DATE OF THE LOAN. (REGMGM PR#1099)
           IF ADV-TO-1ST-NO-CORR = "A"
              IF PD-UNITPER-CD = "M" AND PD-UNITPER-FREQ = 1
                 IF S-DD > 25
                    MOVE 1 TO NDTE-DD
                              NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                    MOVE NDTE-DATE TO NUM-DATE.


      *  JTG 011001 DON'T ALLOW A FIRST PAY DAY OF 31 WHEN SEMI MONTHLY PAPER
      *                                                            FFG PR#333
      *  CS  021001 PER JOHN DON'T ALLOW A FIRST PAY DAY OF 14 OR 15 EITHER IF
      *      SEMI-MONTHLY.  FEB CAUSED THE CYCLE DATES FOR LATE CHARGES TO BE
      *      OUT OF SYNC. FOR EXAMPLE: WITH PAYDATE OF 15 LCPDTH GOES TO 2/28/YY      *      MARCH WENT TO 3/13/YY INSTEAD OF 3/15/YY [DISCOVERED AT FFG]

           IF PD-UNITPER-CD = "S"
              IF NDTE-DD = 14 OR 15
                 MOVE 16 TO NDTE-DD.

           MOVE "S  8000130." TO VDU.
           MOVE NDTE-DATE TO PD-1STPYDATE
                             PD-ORIG-1STPYDATE
                             CIP-1STPYDATE
                             VDU-DATE-YYYYMMDD.
           PERFORM SCREENIO.

       DISPLAY-BALLOON-LAST.
           MOVE "S  A160P170:P." TO VDU.
           IF PD-BALLOON-LAST-FG = "B"
              MOVE "17 BALLOON AMT :" TO VDUBUF
           ELSE
              MOVE "17 LAST PAYMENT:" TO VDUBUF.
           PERFORM SCREENIO.


       SEND-BW-MAKERCD.
           MOVE "S  A010  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE PD-MAKERCD(ELE) TO VDUBUF.
           PERFORM SCREENIO.
       PRIOR-LN-ERROR-MSG.
           IF ERROR-IN-PAYOFF
              MOVE "PRIOR LOAN INVALID" TO MESS
              PERFORM SEND-MESS
           ELSE
              MOVE "INITIATE RENEWAL IN TRANSACTION POSTING"
                                                      TO MESS
              PERFORM SEND-MESS.

      *-----------------------------------------------------------------
       RECALL-COLLATERAL.
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.

           MOVE PC-LTC-HHGS(1) TO WK-HHGS-1.
           MOVE PC-LTC-HHGS(2) TO WK-HHGS-2.
           MOVE PC-LTC-HHGS(3) TO WK-HHGS-3.
           MOVE PC-LTC-AUTO(1) TO WK-AUTO-1.
           MOVE PC-LTC-AUTO(2) TO WK-AUTO-2.
           MOVE PC-LTC-AUTO(3) TO WK-AUTO-3.

           PERFORM REWRITE-WK-FILE.

      *-----------------------------------------------------------------
       TEST-GET-SP.
           MOVE 1 TO FIRST-TIME.
           IF FIRST-ELE > 5
              PERFORM GET-SP.

      *-----------------------------------------------------------------
       GET-CODE.
           MOVE "GC"     TO CDB-TYPE.
           MOVE PD-OWNBR TO CDB-BRANCH.
      *--> SET BEFORE       CDB-CODE.
           PERFORM OPEN-CDB1-FILE.
           PERFORM READ-CDB1-FILE.
           PERFORM CLOSE-CDB1-FILE.
           IF IO-FG = 9
              MOVE " * NOT ON FILE * " TO CDB-DESC.
       GET-LC.
           PERFORM OPEN-LC1-FILE.
           PERFORM READ-LC1-FILE.
           PERFORM CLOSE-LC1-FILE.
           IF IO-FG = 9
              MOVE "INVALID" TO LC-DESC.

       GET-CD.
           PERFORM OPEN-CD1-FILE.
           PERFORM READ-CD1-FILE.
           PERFORM CLOSE-CD1-FILE.
           IF IO-FG = 9
              MOVE " INVALID CODE" TO CD-DESC.
      *-----------------------------------------------------------------------
       GET-BW1.
           PERFORM OPEN-BW1-FILE.
           PERFORM READ-BW1-FILE.
           PERFORM CLOSE-BW1-FILE.
           IF IO-GOOD
              IF BW-SSNO = PD-SSNO(1)
                 MOVE BW-STATE       TO BW-1-STATE
                 MOVE BW-CITY-TAX-CD TO BW-1-CITY-TAX-CD
                 MOVE BW-COUNTY      TO BW-1-COUNTY.
      *-----------------------------------------------------------------------
       GET-BORR-NAME.
           PERFORM READ-BW1-FILE.
           IF IO-BAD
              MOVE " " TO BW-FNAME
              MOVE "NOT FOUND" TO BW-LNAME
              MOVE "Y" TO BW-ERROR-YN
           ELSE
              IF BW-SSNO = PD-SSNO(1)
                 MOVE BW-STATE       TO BW-1-STATE
                 MOVE BW-CITY-TAX-CD TO BW-1-CITY-TAX-CD
                 MOVE BW-COUNTY      TO BW-1-COUNTY.
           PERFORM APPEND-BW-NAMES.
       GET-PD1.
           PERFORM OPEN-PD1-FILE.
           PERFORM READ-PD1-FILE.
           PERFORM CLOSE-PD1-FILE.
       GET-DL1.
           PERFORM OPEN-DL1-FILE.
           PERFORM READ-DL1-FILE.
           PERFORM CLOSE-DL1-FILE.
           IF IO-FG = 9
              MOVE "NOT ON FILE" TO DL-SHORT.
       GET-SP.
           MOVE PD-ORGST TO SP-ORGST.
           MOVE PD-SPRCLASS TO SP-SPRCLASS.
           MOVE PD-SUBCLASS TO SP-SUBCLASS.
           MOVE PD-LAWCODE TO SP-LAWCODE.
           PERFORM OPEN-SP1-FILE.
           PERFORM READ-SP1-FILE.
           IF IO-FG = 9
              MOVE "STATE PARA DELETED" TO MESS
              PERFORM SEND-MESS
              GO TO IO-ERROR.
           PERFORM CLOSE-SP1-FILE.

       MATURITY-DATE-CALCULATION.
           MOVE PD-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE PD-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           MOVE PD-1STPYDATE TO NDTE-DATE.
           COMPUTE NDTE-HOLD = (PD-ORGTERM - 1).
           PERFORM INCREMENT-UNITPER.
       REMOVE-SCRATCH-IF-RECALL.
           IF RECALL-UPDATE
              PERFORM DELETE-SCRATCH.
      *-----------------------------------------------------------------
       UPDATE-CONTINUE.
           IF PD-SRCD = "FB"
              PERFORM UPDATE-BW-INFO.

           PERFORM X03-SAVE-SCREEN.
           MOVE " " TO ERRORS-EXIST.

           MOVE "ZONPC0" TO LPLOAN-CALLED-FROM.
           MOVE "CL/LNVERI" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ERRORS-EXIST PROG-BUF.
           CANCEL FORM-PROGX.

           IF ERRORS-EXIST NOT = "Y"

      * N O T E:   THE FOLLOWING TEST MUST BE DONE, SUCH THAT NO OTHER
      *            OPERATOR INPUT WILL OCCUR BEFORE DOING UPDATE OF
      *            THE LOAN (VIA LONPC2.C)
      *
      *   WHEN RENEWAL, CHECK IF RENEWED AMOUNT HAS CHANGED EX. OPERATOR
      *   REVERSED PAYOFF AND POSTED MONEY AND RE-POSTED RENEWAL PAYOFF
      *   FROM ANOTHER SCREEN          WORLD #286

              PERFORM VERIFY-LOAN-RN-PAYOFF
              IF ERRORS-EXIST NOT = "Y"
                 MOVE MENU-PROG-FORM(3) TO NEW-PROG-FORM
                 MOVE 2 TO NEW-PROG-SUB
                 MOVE "P" TO ERRCD
                 PERFORM REMOVE-QUOTE-IF-LOAN
                 MOVE "END" TO IO-TYPE.


      *----------------------------------------------------------------------
      * SITUATIONS:        ACTION QUOTE-ID-FG     PD-ID   PD-REC
      *
      * 1. SELECT QUOTE                Q             Q     READ-PD-REC
      *    ENTER SSNO                  L             Q
      *    SAVE LOAN           S       L             L     REWRITE PD-REC
      *
      * 2. SELECT QUOTE                Q             Q     READ-PD-REC
      *    ENTER SSNO                  L             Q
      *    UPDATE LOAN         U       L             Q     DELETE PD-REC
      *
      * 3. SELECT SAVE LOAN                          L     READ-PD-REC
      *    SAVE AS SAVED LOAN  S                     L     DELETE PD-REC
      *
      * 4. SELECT SAVE LOAN                          L     READ-PD-REC
      *    UPDATE LOAN         U                     L     DELETE PD-REC
      *
      * 5. NEW ENTRY OF LOAN
      *    UPDATE LOAN         U                           NO PD-REC EXISTS
      *
      * 6. NEW ENTRY OF LOAN
      *    SAVE AS SAVED LOAN  S                    L      WRITE PD-REC
      *                                                      AND SET
      *                                                   NEW-PD-RECORD-FG - "Y"
      *----------------------------------------------------------------------
       REMOVE-QUOTE-IF-LOAN.
           IF QUOTE-CHANGED-TO-LOAN
              IF CAN-LOAN-NO = " "
                 MOVE SAVE-QUOTE-SSN TO PD-SSNO(1)
                 PERFORM D10-DELETE-SCRATCH
              END-IF
           ELSE
      *        THIS CONDITION WILL ONLY OCCUR WHEN RECALLED SAVED LOAN
      *        IS MADE INTO A LOAN:
              IF NEW-PD-RECORD-FG = " " AND PD-ID = "L"
                                        AND ACTION = "     U"
                 PERFORM D10-DELETE-SCRATCH.

       UPDATE-OVR-RATE.
           IF PD-LOANTYPE = "P" OR
              COP-OVR-RATE-SW = "C"
              MOVE 999.999 TO PD-OVRDRATE
           ELSE
              IF COP-OVR-RATE-SW = "E"
                 MOVE COP-OVR-RATE TO PD-OVRDRATE
              ELSE
                 MOVE COP-EFF-RATE TO PD-OVRDRATE.

       MOVE-MSG.
           MOVE PD-MSG1 TO MSG-LINE1.
           MOVE PD-MSG2 TO MSG-LINE2.
           MOVE SCREEN-LINE1 TO D-231.
           MOVE SCREEN-LINE2 TO D-232.

       VALIDATE-FIELDS-AGAINST-MAX.
           MOVE 0 TO IO-FG.
           IF NEW-FLAG NOT = 1
              PERFORM VALIDATION.

       VERIFY-REQD-FLDS.
           MOVE 0 TO IO-FG.
           MOVE SPACES TO BAD-FG.
           IF ACTION = "     U"
              IF NOT (PD-LOANDATE = TRANS-DATE
                          OR PD-INTDATE = TRANS-DATE)
      * ALLOW EFFECTIVE DATE OF LOAN TO BE UP TO
      * 30 DAYS PRIOR TO TRANS-DATE WHEN SPR FLAG IS SET:
      * EX. REGMGM SENDS ADVERTISING CHECKS IN MAIL, CUSTOMER
      * CASHS CHECK ON 122099 AT BACK. REGMGM IS INFORMED OF
      * TRANSACTION ON 12/28/99 SO WHEN THEY OPEN UP FOR 12/28/99
      * THE NEED TO MAKE LOAN FOR 12/20/99 (DAY CHECK CASHED):
                 IF SP-ALLOW-LN-BACK-DATE = "Y"
                    MOVE PD-LOANDATE TO NUM-DATE
                    MOVE TRANS-DATE  TO SYS-DATE
                    PERFORM TIM365
                    IF ( ELAPSED-DAYS >= 0 AND <= 30 )
                       NEXT SENTENCE
                    ELSE
                       MOVE 9 TO IO-FG
                       MOVE "BACK DATING ONLY ALLOWED WITHIN 30 DAYS"
                                                              TO MESS
                       PERFORM SEND-MESS
                 ELSE
      * ALLOW EFFECTIVE DATE OF LOAN TO VARY FROM TRANS-DATE ONLY
      * EFFECTIVE DATE IS EQUEL TO THE SYSTEM DATE:
      * FOR EX., REGMGM CLOSES DAY IN AFTERNOON & OPENS NEXT DAY, SO
      * NEED TO HAVE LOAN DATE EQUAL TO SYSTEM DATE, NOT TRANS-DATE:
      * SYS-DATE = 5/21/00, THEY CLOSE & OPEN 5/22/00, SO ALLOW
      * DISCREPANCY BETWEEN LOAN & TRANS DATE AS LONG AS LOAN DATE
      * IS = TO SYSTEM-DATE
                 IF BR-ALLOW-SYS-AS-EFFDATE = "Y"
                    PERFORM GET-SYSTEM-DATE
                    IF WS-SYSTEM-DATE NOT > TRANS-DATE
                       IF WS-SYSTEM-DATE NOT = PD-LOANDATE
                          MOVE 9 TO IO-FG
                          MOVE SPACES TO MESS
                          STRING
                               "LOAN OR INT. DATE MUST EQUAL "
                               "TRANS OR SYSTEM DATE"
                               DELIMITED BY SIZE INTO MESS
                          PERFORM SEND-MESS
                       END-IF
                    ELSE
                       MOVE 9 TO IO-FG
                       MOVE SPACES TO MESS
                       STRING
                          "LOAN OR INTEREST DATE MUST"
                          " EQUAL TRANSACTION DATE"
                          DELIMITED BY SIZE INTO MESS
                       PERFORM SEND-MESS
                 ELSE
                    MOVE 9 TO IO-FG
                    MOVE
                    "LOAN OR INTEREST DATE MUST EQUAL TRANSACTION DATE"
                                                              TO MESS
                    PERFORM SEND-MESS.

           IF ( SP-CAN-LOANS-ONLY ) AND
              ( CAN-LOAN-NO = " " )
              MOVE
              " THIS SPR IS FOR CAN LOANS ONLY, UPDATE NOT ALLOWED!"
                                                             TO MESS
              PERFORM SEND-MESS
              IF ACTION = "     U"
                 MOVE 9 TO IO-FG.

           PERFORM VERIFY-SETUP-PAYMENTS.
           IF NOREG-FG NOT = " "
              MOVE 9 TO IO-FG.

           PERFORM VERIFY-PROCEEDS.
           IF NOT GP-INCL-OTH-IN-EARNED-N
              IF PD-ANTICERN(1) < 0
                     OR PD-ANTICERN(2) < 0
                      OR PD-ANTICERN(3) < 0
                       OR PD-ANTICERN(4) < 0
                        OR PD-ANTICERN(5) < 0
                         OR PD-ANTICERN(6) < 0
                 MOVE "ANTICIPATED EARNINGS CAN'T BE LESS THAN ZERO!"
                                                             TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG
              END-IF
           ELSE
              IF PD-ANTICERN(1) < 0
                     OR PD-ANTICERN(2) < 0
                      OR PD-ANTICERN(3) < 0
                       OR PD-ANTICERN(4) < 0
                        OR PD-ANTICERN(5) < 0
                 MOVE "ANTICIPATED EARNINGS CAN'T BE LESS THAN ZERO!"
                                                             TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG.

           PERFORM D16-TEST-NC-ORIG-FEES.

           IF PD-ORGST = "NC"
              PERFORM CHECK-FEECODES.
           IF NCINS-ERRCD NOT = " "
              MOVE 9 TO IO-FG.

      *NEED TO KNOW IF IO IS BAD THRU THIS POINT, THE READ OF THE
      *BORROWER FOR THE BIRTHDATE IS GOING TO SET IO-FG TO GOOD IF THE
      *BORROWER EXISTS WIPING OUT ANY OF THE OTHER BAD SETTING OF IO-FG.
      *IF IO-BAD, MOVING "Y" TO BAD FLAG AND THEN AT THE END OF THE
      *VERIFY, IF BAD-FLAG IS "Y", RESETTING IO-FG TO 9
           IF IO-BAD
              MOVE "Y"     TO BAD-FG.

      * 5178 ASK FOR PASSWORD IF ANY BORROWER ON THE LOAN DOES NOT HAVE
      *      A BIRTHDATE
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
              IF PD-SSNO(SUB) NOT = 0
                 MOVE PD-SSNO(SUB) TO BW-SSNO
                 PERFORM GET-BW1
                 IF IO-FG = 0
                    IF BW-BDATE = 0 
                       MOVE BW-BDATE-0-SEQ TO PASSWDW-SEQ
                       MOVE "ZERO BIRTHDATE......:" TO PASSWDW-PROMPT2
                       PERFORM VERIFY-PASSWORD
                       IF PASSWDW-STAT NOT = "OK"
                          MOVE 5 TO SUB
                          MOVE 9 TO IO-FG
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-PERFORM.
           
           IF BAD-FG = "Y"
              MOVE 9 TO IO-FG.

      * SP-EDT-TABLE-LOOKUP:
           IF IO-FG = 0
      *       VALIDIATE TERM:
              MOVE 0 TO ELE
              PERFORM SP-EDT-TABLE-LOOKUP
      *       VALIDIATE PROCEEDS:
              IF IO-FG = 0
                 MOVE 11 TO ELE
                 PERFORM SP-EDT-TABLE-LOOKUP.
           IF IO-FG = 0
              IF NOT COP-CALCULATION-OK
                 PERFORM ERROR-IN-CALCULATIONS-MSG
                 MOVE 9 TO IO-FG.

       VERIFY-PROCEEDS.
           MOVE 0 TO IO-FG.
           IF PD-SRCD = "RN"
              IF PD-PROCEEDS NOT = 0
                 MOVE "PROCEEDS MUST BE ZERO FOR RENEWALS" TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG.
           IF PD-SRCD = "PB" OR "SC"
              IF PD-PROCEEDS < 0
                 MOVE "PROCEEDS < ZERO - INVALID" TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG.

      * REGMGM 4885
      * "D" PROCEEDS OF NEW LOAN HAS TO BE AT LEAST X% OF THE PAYOFF AMT
      *     PROCEEDS OF NEW LOAN HAVE TO BE > THAN SP-AMT-PROCEEDS-REQ
           IF (PD-SRCD = "PB" OR "SC") AND (SP-RENEWAL-EDIT = "D")
              IF PD-PROCEEDS < (PRIOR-LNAMT * (SP-NET-BAL-REQ/100))
                 MOVE "PROCEEDS NOT > THAN PERCENT REQUIRED" TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG
              ELSE
                 IF PD-PROCEEDS < SP-AMT-PROCEEDS-REQ
                    MOVE "PROCEEDS NOT > THAN MINIMUM" TO MESS
                    PERFORM SEND-MESS
                    MOVE 9 TO IO-FG.

      * REGMGM 4885
      * "E" PROCEEDS OF NEW LOAN HAS TO BE AT LEAST X% OF THE PAYOFF AMT
      *     PROCEEDS OF NEW LOAN HAVE TO BE < THAN SP-AMT-PROCEEDS-REQ
           IF (PD-SRCD = "PB" OR "SC") AND (SP-RENEWAL-EDIT = "E")
              IF PD-PROCEEDS > (PRIOR-LNAMT * (SP-NET-BAL-REQ/100))
                 MOVE "PROCEEDS NOT < THAN PERCENT REQUIRED" TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG
              ELSE
                 IF PD-PROCEEDS > SP-AMT-PROCEEDS-REQ
                    MOVE "PROCEEDS ARE > THAN MAXIMUM" TO MESS
                    PERFORM SEND-MESS
                    MOVE 9 TO IO-FG.

       VERIFY-PROCEEDS-DOWN.
      *    IF PD-SELLPR NOT > PD-DOWNPY
      *       MOVE "DOWN PAYMENT CAN'T BE MORE THAN SELL PRICE!"
      *                                                    TO MESS
      *       PERFORM SEND-MESS
      *       MOVE 9 TO IO-FG
      *    ELSE
           IF PD-SELLPR NOT > 0
              MOVE "SELLING PRICE MUST BE MORE THAN ZERO!"
                                                     TO MESS
              PERFORM SEND-MESS.
      *    ELSE
      *    IF PD-DOWNPY < 0
      *       MOVE "DOWN PAYMENT CAN'T BE NEGATIVE!"
      *                                              TO MESS
      *       PERFORM SEND-MESS
      *       MOVE 9 TO IO-FG
      *    ELSE
      *    IF PD-PERDOWN < 0
      *       MOVE "PERCENT DOWN CAN'T BE NEGATIVE!"
      *                                              TO MESS
      *       PERFORM SEND-MESS
      *       MOVE 9 TO IO-FG.

       COMPUTE-GL-FEEAMT.
           MOVE 0 TO TOTAL-GL-HLDR
                     TOTAL-GL-HLDR-SALESTAX
                     TOTAL-GL-FINCHG-HLDR
                     TOTAL-GL-FINCHG-HLDR-SALESTAX.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 10
              IF ( SUB < 3 AND SP-FEEFRMLA(SUB) = " " ) OR
                 ( SUB > 2 )
                 IF PD-FEEOURS(SUB) NOT = "M"
                    ADD PD-FEEAMT(SUB)    TO TOTAL-GL-HLDR
                    IF PD-FEEFINCHG(SUB) = "Y"
                       ADD PD-FEEAMT(SUB) TO TOTAL-GL-FINCHG-HLDR
                    END-IF
      *            ACCUMULATE INS. SALES TAX
                    IF BR-FORCE-VALID-CITY-COUNTY = "Y"
                       IF PD-FEECODE(SUB) = "TC" OR "TA" OR "TP"
                                         OR "T1" OR "T2" OR "T3"
                                         OR "T4" OR "T5"
                          ADD PD-FEEAMT(SUB) TO TOTAL-GL-HLDR-SALESTAX
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-PERFORM.

      *COMPUTE-GL-FEEAMT.
      *    ADD 1 TO COUNTER.
      *    IF COUNTER < 3
      *       IF SP-FEEFRMLA(COUNTER) NOT = " "
      *          GO TO COMPUTE-GL-FEEAMT.
      *    IF COUNTER NOT > 10
      *       IF PD-FEEOURS(COUNTER) NOT = "M"
      *          ADD PD-FEEAMT(COUNTER) TO TOTAL-GL-HLDR
      *          IF PD-FEEFINCHG(COUNTER) = "Y"
      *             ADD PD-FEEAMT(COUNTER) TO TOTAL-GL-FINCHG-HLDR
      *          END-IF
      *       END-IF
      *       GO TO COMPUTE-GL-FEEAMT.
      *    MOVE 0 TO COUNTER.

       BLANK-PRIOR-LOAN.
           MOVE " " TO PRIOR-LOAN-STAT PASS-STAT-FG.
           MOVE 0 TO CIP-PRIOR-LOAN-CLASS
                      CIP-PRIOR-SUB-CLASS
                       CIP-PRBAL
                        CIP-PRINTDUE
                         CIP-PRFINCHGRB
                          CIP-PRINSRB
                           CIP-PRPAID-AHEAD
                            CIP-PRIOR-LOAN-DATE
                             PRIOR-LNAMT
                              PD-PRLNNO
                               PD-PRBAL
                                PD-PRINTDUE
                                 PD-PRFINCHGRB
                                  PD-PRINSRB
                                   PD-PRPAID-AHEAD.
           MOVE " " TO CIP-PRIOR-LOAN-STATE.
           MOVE PD-SRCD TO CIP-SOURCE-CD.

           MOVE "SNNN060110." TO VDU.
           MOVE PD-PRLNNO TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN062111." TO VDU.
           MOVE PRIOR-LNAMT TO VDUNUM2.
           PERFORM SCREENIO.

           IF NEW-FLAG NOT = 1
      * CITIZENS TEST
              MOVE 800 TO CIP-NO-OF-TIMES-CALLED
      *       MOVE 0 TO CIP-NO-OF-TIMES-CALLED
              PERFORM CALL-LOAN-CALCULATIONS.

       SETUP-CALC-AREA.
           MOVE "C" TO CIP-OVR-RATE-SW
                       CIP-INS-SW(1)
                       CIP-INS-SW(2)
                       CIP-INS-SW(3)
                       CIP-INS-SW(4)
                       CIP-FEE-CHG-SW(1)
                       CIP-FEE-CHG-SW(2)
                       CIP-SERVICE-CHG-SW
                       CIP-MAINT-FEES-SW
                       CIP-1ST-PY-EXT-SW
                       CIP-REGPYAMT-SW.
           MOVE "I" TO CIP-INS-SW(5)
                       CIP-INS-SW(6).

           MOVE PD-LOANTYPE TO CIP-LOANTYPE.
           MOVE PD-SMALLOAN TO CIP-SMALLOAN.
           MOVE PD-SALEFIN TO CIP-SALEFIN.
           MOVE PD-SERVACCT TO CIP-SERVACCT.

           MOVE PD-LOANDATE TO CIP-LOANDATE.
           MOVE PD-INTDATE TO CIP-INTDATE.
           MOVE PD-FILEDATE TO CIP-FILEDATE.
           MOVE PD-1STPYDATE TO CIP-1STPYDATE.
           MOVE PD-ORGTERM TO CIP-TERM.

           MOVE PD-PURCD TO CIP-PURPOSE-CD.
           MOVE PD-COLLCD TO CIP-COLLTRL-CD.
           MOVE PD-SRCD TO CIP-SOURCE-CD.
           SUBTRACT PD-DOWNPY FROM PD-SELLPR
                             GIVING PD-PROCEEDS
                                    CIP-PROCEEDS.
           MOVE PD-PROCEEDS-FG TO CIP-PROCEEDS-SW.

           MOVE PD-INSURED TO CIP-INS-WHO.
           MOVE PD-INSTYPES TO CIP-INS-TYPE.
           MOVE PD-INSELIGIBLE TO CIP-INS-ELIG.
           MOVE PD-POINTS TO CIP-POINTS.
           MOVE PD-POINTS-FG TO CIP-POINTS-SW.
           MOVE TOTAL-GL-HLDR TO CIP-GL-AMOUNT-TOTAL.
           IF BR-FORCE-VALID-CITY-COUNTY = "Y"
              SUBTRACT TOTAL-GL-HLDR-SALESTAX
                            FROM CIP-GL-AMOUNT-TOTAL.
           MOVE TOTAL-GL-FINCHG-HLDR TO CIP-GL-AMOUNT-TOTAL-FINCHG.

       MOVE-INSURANCE-TO-PDREC.
           MOVE COP-INS-CO(COUNTER) TO PD-INSCOMP(COUNTER)
                                       DF2-INSCOMP(COUNTER).
           MOVE COP-INS-USE-SW(COUNTER) TO PD-INSOURS(COUNTER)
                                           DF2-INSOURS(COUNTER).
           MOVE COP-INS-TERM(COUNTER) TO PD-INSTRM(COUNTER)
                                         DF2-INSTERM(COUNTER).
           MOVE COP-INS-COVERAGE(COUNTER) TO PD-INSCOVR(COUNTER)
                                             DF2-INSCOVR(COUNTER).
           MOVE COP-INS-PREMIUM(COUNTER) TO PD-INSPREM(COUNTER)
                                            DF2-INSPREM(COUNTER).
           MOVE COP-INS-SW(COUNTER) TO PD-INS-FG(COUNTER)
                                       DF2-INS-FG(COUNTER).
           MOVE COP-INSFINCHG-SW(COUNTER) TO PD-INSFINCHG(COUNTER).
           MOVE COP-INS-TERM-SW(COUNTER) TO PD-INS-TERM-SW(COUNTER).
           MOVE COP-COVERAGE-SW(COUNTER) TO PD-COVERAGE-SW(COUNTER).
           MOVE COP-PREMIUM-SW(COUNTER) TO PD-PREMIUM-SW(COUNTER).

       ICE-OR-A-MSG.
           IF ELE = 26
      *<1225J>
              IF SP-CAL-FLAT-MONTHLY(1)
                 MOVE "MUST BE 'C' OR 'A'" TO MESS
              ELSE
                 MOVE "MUST BE 'C', 'E', OR 'A'" TO MESS
              END-IF
      *<1225J>
           ELSE
              MOVE "MUST BE 'I' OR 'C'" TO MESS.
           PERFORM SEND-MESS.

       VERIFY-SETUP-PAYMENTS.
           MOVE " " TO NOREG-FG.
           SUBTRACT 1 FROM PD-ORGTERM GIVING PD-NOREGPY.
           IF PD-LASTPYAMT NOT = 0
              SUBTRACT 1 FROM PD-NOREGPY.
           IF PD-ORGTERM = 1
              IF PD-LASTPYAMT NOT = 0
                 MOVE "E" TO NOREG-FG
                 MOVE "LAST PAYMENT MUST BE ZERO" TO MESS
                 PERFORM SEND-MESS.
           IF PD-ORGTERM > 1
              IF NOT (PD-1STPYAMT > 0
                          AND PD-REGPYAMT > 0
                            AND PD-LASTPYAMT > 0
                     )
                 MOVE "E" TO NOREG-FG
                 MOVE
            "FIRST, REGULAR AND LAST PAYMENT MUST BE GREATER ZERO"
                                                               TO MESS
                 PERFORM SEND-MESS.

       ERROR-IN-CALCULATIONS-MSG.
           IF COP-RETURN-CODE = "V"
              MOVE "ERROR IN CALCULATIONS - AMOUNT EXCEEDS MAX"
                                                        TO MESS
           ELSE
              MOVE "ERROR IN CALCULATIONS - INACCURATE RESULTS"
                                                        TO MESS.
           PERFORM SEND-MESS.
           MOVE "X" TO COP-RETURN-CODE.

       SEND-CD-DESC.
           PERFORM GET-CD.
           MOVE "S  A000  1." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE CD-DESC TO VDUBUF.
           PERFORM SCREENIO.
       APPEND-BW-NAMES.
           MOVE BW-LNAME TO INSPECT-W.
           MOVE BW-FNAME TO ADD-ON.
           INSPECT INSPECT-W REPLACING FIRST "   " BY ", +".
           INSPECT INSPECT-W REPLACING FIRST
              "+                        " BY ADD-ON.
      *-----------------------------------------------------------------
       ADD-IT.
           INSPECT INSPECT-W REPLACING FIRST "  " BY " +".
           INSPECT INSPECT-W REPLACING FIRST
              "+                        " BY ADD-ON.
       ADD-IT2.
           PERFORM ADD-IT.
           MOVE "/" TO ADD-ON.
           PERFORM ADD-IT.

       NUMBW-TO-ALPBW.
           MOVE " " TO ALP-BW.
           IF BW-SSNO NOT = 0
              MOVE BW-SSNO TO NUM-BW
              MOVE NUM-BW123 TO ALP-BW123
              MOVE NUM-BW45 TO ALP-BW45
              MOVE NUM-BW6789 TO ALP-BW6789
              MOVE "-" TO ALP-HYPHEN1 ALP-HYPHEN2.

       SEND-BW-NO-NAME.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           PERFORM SEND-BW-NAME.

       SEND-BW-NAME.
           MOVE "S  A330  1." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE INSPECT-W TO VDUBUF HOLD-BW-NAME.
           PERFORM SCREENIO.
           IF ELE = 1
              MOVE INSPECT-W TO PD2-BWNAME.

       SEND-MEMO.
           MOVE "S  A060M1." TO VDU.
           MOVE "MEMO: " TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A300M2." TO VDU.
           MOVE PD-MESSAGE TO VDUBUF.
           PERFORM SCREENIO.
       NOT-FOUND.
           MOVE "RECORD NOT FOUND" TO MESS.
           PERFORM SEND-MESS.
       MISSING-FEECODE.
           STRING "YOUR BRANCH IS MISSING A FEE "
                  "CODES NEEDED FOR THIS CAN LOAN!      "
                  DELIMITED BY SIZE INTO MESS.
           PERFORM SEND-MESS.
           MOVE " PLEASE INFORM HOME OFFICE!!" TO MESS
           PERFORM SEND-MESS.
       SP-INVALID.
           MOVE "ENTRY INCONSISTENT WITH STATE PARAMETERS" TO MESS.
           PERFORM SEND-MESS.
       NOT-DIRECT.
           MOVE "INVALID FOR BALLOON (DIRECT) LOAN ENTRY!" TO MESS.
           PERFORM SEND-MESS.
       MSG-LINE.
           PERFORM CALL-TMMSG.
       SEND-MESS-X.
           PERFORM SEND-LEGEND.
           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
       SEND-WSEL-LEGEND.
           MOVE MESS TO WR-BUF.
           MOVE WSEL-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       SEND-LEGEND.
           MOVE LEGEND TO WR-BUF.
           MOVE MSEL-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       RESET-LEGEND.
           MOVE " " TO LEGEND.
           PERFORM SEND-LEGEND.
       LOAN-CLASS-PROMPT.
           MOVE "S  A110KEYTYPE." TO VDU.
           MOVE "LOAN CLASS:" TO VDUBUF.
           PERFORM SCREENIO.
       SET-SCRATCH-KEY.
           MOVE SAVE-SSNO TO PD-SOC-SEC.
           MOVE BRANCH    TO PD-BRANCH PD2-BRANCH.
           MOVE "L"       TO PD-ID.
      *-----------------------------------------------------------------
       VERIFY-AGAINST-SPEDT.
           MOVE "Y" TO VALID-LOAN.
           MOVE PD-EFFRATE TO VERIFY-TERMCEIL-EFF.
           MOVE PD-APRATE  TO VERIFY-TERMCEIL-APR.
           MOVE "Y"        TO VERIFY-TERMCEIL-EFF-FG.
           MOVE " "        TO VERIFY-REJECT-TERM-FG.
           MOVE TRANS-DATE TO VERIFY-TODAY-DATE.
           PERFORM GET-BW1-FOR-SPEDT.

           PERFORM VERIFY-TERMCEIL.

           IF COP-OTINS-COV-ERR
              MOVE "INSURANCE COVERAGE ERROR" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

      *-----------------------------------------------------------------
       ESTABLISH-REJECT-TERMS.
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 4
              MOVE 0 TO CIP-INS-REJECT-TERM(SUB)
           END-PERFORM.

           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 12
               IF SP-INSREJECT-FG(SUB) = "C"
                  MOVE 98 TO SUB
               END-IF
           END-PERFORM.
           IF SUB = 99
              PERFORM MATURITY-DATE-CALCULATION
              MOVE NDTE-DATE  TO VERIFY-TODAY-DATE
              MOVE "Y"        TO VERIFY-TERMCEIL-EFF-FG
              MOVE "Y"        TO VERIFY-REJECT-TERM-FG
              PERFORM GET-BW1-FOR-SPEDT.

      *-----------------------------------------------------------------
       UNPROTECT-BR-CONDITIONAL-FLDS.
           IF NOT QUOTE-ONLY
              IF BR-STOP-ON-COLL = "Y"
                 MOVE " " TO CHFG(23).

       PROTECT-FIELDS.
           MOVE STAT TO CHFG(5)  CHFG(22) CHFG(23) CHFG(26)
                        CHFG(34) CHFG(35) CHFG(36) CHFG(42).

           IF SP-FEEFRMLA(1) = " "
              MOVE "N" TO CHFG(20)
           ELSE
              MOVE " " TO CHFG(20).
           IF SP-FEEFRMLA(2) = " "
              MOVE "N" TO CHFG(21)
           ELSE
              MOVE " " TO CHFG(21).

           MOVE STAT TO DATE-STAT.

       UNPROTECT-FIELDS.
           MOVE STAT TO CHFG(10) CHFG(11) CHFG(19) CHFG(22) CHFG(23)
                        CHFG(26) CHFG(34) CHFG(35) CHFG(36) CHFG(42).

           IF SP-FEEFRMLA(1) = " "
              MOVE "N" TO CHFG(20)
           ELSE
              MOVE " " TO CHFG(20).
           IF SP-FEEFRMLA(2) = " "
              MOVE "N" TO CHFG(21)
           ELSE
              MOVE " " TO CHFG(21).

           IF CAN-LOAN-NO NOT = " "
              MOVE "N" TO CHFG(42).

           MOVE STAT TO DATE-STAT.

       SEND-PRIOR-MESS.
           IF PASS-STAT-FG = "Z"
              MOVE "PRIOR LOAN PAID OFF OR BALANCE EXPENSED" TO MESS
              PERFORM SEND-MESS
           ELSE
           IF PASS-STAT-FG = "S"
              MOVE "PRIOR LOAN NOT SALES FINANCE" TO MESS
              PERFORM SEND-MESS
           ELSE
           IF PASS-STAT-FG = "J"
              STRING "PRIOR LOAN PAID OFF USING TRANSACTION CODE '"
                     HOLD-PRIOR-PO-TRCD
                     "'                            "
                 DELIMITED BY SIZE INTO MESS
              PERFORM SEND-MESS
           ELSE
              MOVE "PRIOR LOAN IS SALES FINANCE - NOT ALLOWED"
                 TO MESS
              PERFORM SEND-MESS.

      *-----------------------------------------------------------------
      * SET ADV-TO-1ST-NO-CORR. IF THE SP FLAG IS SET, ALLOW IT TO
      * OVERRIDE THE GP FOR SPECIFIC CLASSES.
      *-----------------------------------------------------------------
       SET-ADV-TO-1ST-NO-CORR.
           IF NOT (SP-ADV-TO-1ST-NO-CORR = "N" OR " ")
              MOVE SP-ADV-TO-1ST-NO-CORR TO ADV-TO-1ST-NO-CORR
           ELSE
              MOVE GP-ADV-TO-1ST-NO-CORR TO ADV-TO-1ST-NO-CORR.

      *********************************
       IO-ROUTINE SECTION.
      *********************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBLP/LPSPGS_SQL.CPY".
       COPY "LIBLP/LPPDGS_SQL.CPY".
       COPY "LIBLP/LPPCGS_SQL.CPY".
       COPY "LIBLP/LPLTCGS_SQL.CPY".
       COPY "LIBLP/LPLCGS_SQL.CPY".
       COPY "LIBLP/LPICGS_SQL.CPY".
       COPY "LIBLP/LPDLGS_SQL.CPY".
       COPY "LIBLP/LPCLGS_SQL.CPY".
       COPY "LIBLP/LPCDBGS_SQL.CPY".
       COPY "LIBLP/LPCDGS_SQL.CPY".
       COPY "LIBLP/LPBWGS_SQL.CPY".
       COPY "LIBGL/GLGIGS_SQL.CPY".
       COPY "LIBGB/GBGRGS_SQL.CPY".
       COPY "LIBGB/GBGBGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBLP/LPLC1RN.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBGB/GBGBIN.CPY".
       COPY "LIBGB/GBGR1RN.CPY".
       COPY "LIBLP/LPDL1RN.CPY".
       COPY "LIBLP/LPCL1RN.CPY".
       COPY "LIBLP/LPPD1IN.CPY".
       COPY "LIBLP/LPPD2IN.CPY".
       COPY "LIBLP/LPPC1IN.CPY".
       COPY "LIBLP/LPPC2IN.CPY".
       COPY "LIBLP/LPSP1RN.CPY".
       COPY "LIBLP/LPBW1RN.CPY".
       COPY "LIBLP/LPCD1RN.CPY".
       COPY "LIBLP/LPCDB1RN.CPY".
       COPY "LIBLP/LPIC1RN.CPY".
       COPY "LIBGL/GLGI1RN.CPY".
       COPY "LIBLP/LPLTC1RN.CPY".
       COPY "LIBLP/LPWKI.CPY".
       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO ERRCD.

      *********************************
       END-ROUTINE SECTION.
      *********************************

           PERFORM CLOSE-FILES.
       EXIT-PROG.
           PERFORM CLOSE-WINDOW UNTIL WINDOWS-OPEN = 0.
       STOP-RUN.
           EXIT PROGRAM.
