       IDENTIFICATION DIVISION.
       PROGRAM-ID.       CQRUN.
       DATE-WRITTEN.   4/16/96.
      **************************************************************
      *    DIR :  LP
      *    DESC:  COLLECTOR QUEUE EXTRACTION RUN
      *
      * REV :
      *  042296 BLL TEST RANGES FOR EA-PL, EA-REPO, EA-BANKRUPT
      *  060496 BLL FIX EA GROUP SCAN; WASN'T FINING RECORDS
      *  062496 KEC ADDED CHECKS FOR EA-PL-IN-ACTIVE-BOTH.
      *  071696 BAH ADDED TEST OF GP-ALLOW-MORE-COLLECT TO ALLOW MORE THAN
      *             ONE COLLECTION TYPE FORM REQUEST, PR # E128
      *  MJD 071696 ADDED LIBLP/LPUPWK FOR CHANGES IN LIBLP/AGEING
      *  BLL 080696 FIXED TO WORK IN BATCH
      *  KEC 111496 CHANGED LN-POCD FOR RESCISSION.
      *  BLV 120596 PURGE RESCHEDULED RECS OLDER THAN EXTRACTION DATE
      *  BLV 012097 FIXED BUG-WAS PURGING ALL RESCHEDULES REGARDLESS
      *             OF FLAG
      *  CLS 031097 ADDED TEST OF EA-CONFIDENTIAL-FG,EA-1ST-PMT-MISSES
      *  BLV 031097 FIX EA GROUP SCAN
      *  BLV 041497 CHECK BR-COL-QUEUE-LOW-TO-HI TO PUT QUEUE IN ORDER
      *             OF DELINQUENCY INSTEAD OF REVERSE DELINQUENCY
      *  GLF 050797 ADDED COPY MEMBERS: SETCTBLW AND SETCTBL
      *  MJD 051597 ADDED LPPOF2 COPY MEMBER (PREVIOUSLY WAS PART OF LPPOFF)
      *  JTG 052097 ADDED 'LIBLP/ADDONSPR' TO GET CORRECT SPR RE: INS RB
      *  BLV 070197 OPTION TO BREAK OUT BROKEN PROMISES WITH PAST
      *             PROMISE RANGE & THEY WILL APPEAR 1ST IN QUEUE
      *   CS 070197 ADDED EA-LEGAL,EA-DEBTAID,EA-JUDGEMENT
      *  BLV 072197 CHANGE CQ2-KEY, ADD CQ-SEQ-FG, ALWAYS FILL IN
      *             CQ-DATE, OPTION TO KEEP UNWORKED ACCOUNTS IN QUEUE
      *  JTG 072897 ADDED LPWDEL/W  MERCURY #E135
      *  BLV 081197 WAS MISSING REMOVE RESCHEDULE & UNWORKED INFO
      *             IN DISPLAY PARAMETERS
      *  BLV 081997 FIXED CLEAR ON CP-FILE
      *  BLV 110597 CHECK BR-MIDSTREAM-1STPAY-FG TO DETERMINE
      *             1ST PAY MISSES FOR MIDSTREAM ACCOUNTS
      *  JTG 111797 ADDED LOGIC FOR LIBLP/DEFPOL RE: BR-NODEF-1ST-X-MONTHS #167
      *  BLV 010798 ALLOW BRANCH RANGE OR GROUP
      *  GLF 012298 REMOVED GLOBAL FILE AND RELACED 'IO' ON GP WITH GET GPENV
      *  GLF 022098 DELETED BR-SECURITY-OK AND ADDED LIBGB/BRSECUREW.
      *   CS 022798 ADDED READ OF EA-FILE BEFORE PROCESSING BRANCH SO WE
      *             ARE ONLY PROCESSING BRANCHES THAT MEET THE GROUP ID.
      *  BAH 041598 COMMENTED OUT CS CHANGE FROM 022798
      *   CS 042198 ADDED TEST OF EA-ORIGIN
      *  BLV 082498 ADDED QUEUE KEY SEQUENCING FOR MISPAYS
      *  BLV 990630 TFC PR#35 - IF NON-MONTHLY POT30 & I-AM-TFC, MOVE 0 TO
      *             PAST DUE DAYS IN CQ KEY- THESE WILL ORDER BY DESCENDING BAL
      *  GLF 990924 REPLACED IO-FG NUMBERS WITH IO-FG 88 LEVEL PER DEVELOPMENT
      *             MEETING (082599)
      * KEC 2000.0427 {PR#01138} REGIONAL ACCEPTANCE; KEVIN MULLEN
      *                ADDED EA-PL-BEG-DATE AND EA-PL-END-DATE
      *  BLV 000817 ADDED LOGIC FOR QUEUING BY TIME ZONE, TFC PR #25
      *  BLV 000817 TWEAK LOGIC FOR QUEUING BY TIME ZONE, ADD UPDATE OF
      *             CQ-TIME-ZONE-ERROR, TFC PR #25
      *  BLV 001020 TEST FOR SKIP, INCLUDE, ONLY OF RECENCY POTS, MISPAYS,
      *             (EA-RPOTS, EA-MISPAYS), WORLD PR #244
      *  BLV 001020 IF I-AM-WORLD, SEQUENCE QUEUE BY RENEWABILITY BY HIGHEST
      *             AVAILABLE CREDIT
      *  BLV 001127 ADD GQFILE, GLOBAL QUEUING, LPCPUPD MAY UPDATE GQFILE,
      *             TFC PR# 60
      *  BLV 001208 IF GLOBAL QUEUING, SET UP COLLECTOR POOL GLOBAL PATH
      *             INSTEAD OF LOCAL (CP-ALL-PATH), TFC PR# 60
      *  BLV 010102 STARRED OFF THE REWRITE OF THE LOAN FILE - I THINK IT MUST
      *             HAVE BEEN LEFT OVER FROM CPRUN - I CAN'T FIND ANYTHING
      *             HERE THAT IS BEING UPDATED TO THE LOAN FILE
      *  BLV 010105 ADDED ROUTINE TO INITIALIZATION TO PURGE GQFILE IF DOING
      *             GLOBAL QUEUING
      *  BLV 010209 ALTERED TFC PR#35 - IT WAS IF NON-MONTHLY POT30 & I-AM-TFC,       
      *             MOVE 0 TO PAST DUE DAYS IN CQ KEY- THESE WILL ORDER BY
      *             DESCENDING BAL, CHANGED TO NOT CHECK NON-MONTHLY, DO FOR
      *             ALL POTS FOR TFC, PER JUDY & TRACY AT TFC
      *  BLV 010418 FIX PROBLEM IN INITIALIZING GQ-KEY IN PURGE-GQ-RECORDS
      *             ROUTINE, WAS LOCKING UP TESTING AT TFC
      *   CS 010507 ADDED TEST FOR ALLOTMENTS, ACE PR# 1472
      *  BLV 011011 ADD TEST ON BEG & ENDING DAYS SINCE LOAN DATE, BEG & ENDING
      *             DAYS UNTIL MATURITY, REGWAN PR# 1587
      *  BLV 011210 IF BR-COL-QUEUE-PAST-DUE = "Y", ORDER QUEUE BY
      *             PAST DUE DAYS AFTER AGEING CATEGORY, REGACC PR# 1677
      *  BAH 020516 ADDED TEST OF FD-SMARTPORT = "E" FOR CREATING ALL FORM
      *             REQUESTS IN THE CORPORATE BRNO AND THEN THEY WILL PRINT
      *             THEM INTO AN ASCII FILE EXTRACT, REGACC PR# 1800(LPCPUPD)
      *  BLV 020821 CHANGED TO ONLY OPEN LNFILE TO INPUT, & FIX LOCKING
      *             PROBLEMS WITH CP-FILE, PROBLEMS AT TFC
      *  BLV 021030 CHECK DAY OF MONTH DUE DAY RANGE, REGACC PR# 0009,
      *             WILL IGNORE THESE PARAMETERS IF THEY = 20, 20...EVEN
      *             THOUGH THAT COULD BE A VALID RANGE
      *  BLV 030403 TFC USES LAST DAY OF MONTH FOR EXTRACTIONS, SOME-
      *             TO DO WITH THEIR AGEING, SO IT MESSES UP DAYLIGHT
      *             SAVINGS START/STOP, JUST USE SYSTEM DATE FOR
      *             DAYLIGHT SAVINGS ROUTINE IF I-AM-TFC
      *  BLV 030630 IF REGACC, USE LNDATE-DAYS & MATURE DAYS PARAMETERS FOR
      *             TRIAD RANGES, RAW SCORE & DELQ SEEN ID, REGACC PR# 0033
      *  BAH 040812 ADDED TEST OF BW-CONFIDENTIAL, THIS FLAG OVERRIDES THE
      *             LOAN FLAG, IF THE LOAN IS "N", BUT THE BW IS "Y", THEN
      *             ITS CONFIDENTIAL ! PR# 2343
      *  BLF 050418 IF I-AM-WAGNER & BR-RECDEL-NOT-REC = Y, USE CALENDAR
      *             RECENCY, WAGNER PL# 478
      *   CS 050502 USING CALANDAR RECENCY, 1ST PAY DEFAULTS WERE BEING SKIPPED
      *             WAS: IF LN-DATE-PAID-LAST = 0, IF RECENCY 0 GO TO EXIT
      *             USING TRUE DAYS, RECENCY OF 0 IS TODAY... USING CALANDAR
      *             IT MANY DAYS, CHANGED TO IGNORE THE TEST ON LN-DATE-PAID-
      *             LAST IF BR-RECDEL-NOT-REC = Y AND GP-I-AM-WAGNER  [PR#478]
      *  BLF 050512 IF I-AM-WAGNER & BR-RECDEL-NOT-REC = Y, USE CALENDAR
      *             RECENCY, FIX IN RECENCY POTS SECTION, WAGER PR# 478
      *  BAH 050721 ADDED LITTLE-Z TEST AND ALPNAME2 = "~~~" FOR WORLD MEXICO
      *             PR# 416
      *  BLF 060228 ADDED TEST ON EA-INCL-COLLECTOR, LENDMARK PR# 2719
      *  KEC 070202 {PR#00000} REGIONAL ACCEPTANCE <A15> [K.MULLEN]
      *             ADDED GETTING BX-REC FOR TRIAD.
      *             ADDED BR-REC FOR BETH.
      * BLF 070906  IF BR-COLL-QUEUE-CON-REC = "N", MOVE 0 TO CQ- OR GQ-REV-DEL,
      *             SO NO DELINQUENCY IN QUEUE ORDERING (CHANGE TO
      *             LIBLP/LPCPUPD), PCCREDIT PR# 3054
      * BLM 081009  UPDATE QUEUE GROUP ID TO HEADER REC IN GQFILE, GQ-GROUP-ID,
      *             REGACC PR# 220
      * BAH 091002 ADDED FD-SKIP-BAD-ADR TO TEST PRIMARY MAKER ONLY IF BAD
      *            ADDRESS FLAG SET, DO NOT CREATE FORM REQUEST REGACC PR# 256
      *            CHANGE IS IN LPCPUPD
      * BLM 100304 IF I-AM-UNITED & CELL-PHONE NOT 2020, INCLUDE CELL PHONE
      *            WHEN CHECKING TIME ZONES FOR TIME ZONE QUEUING,
      *            UNITED PR# 3474
      *  CS 110228 ADD FD-SKIP-BAD-ADR = 'M' CHANGE IN LIBLP/LPCPUPD
      *            ADDED S1-SUBSCRIPT TO THIS PROGRAM.  MODERN PR#3720
      * BLM 120626 NOTE:  INVESTIGATED WORLD GETTING WRITE ERRORS OF 22 ON
      *            CQFILE.  AT FIRST I THOUGHT THIS WAS CREATE-CQ-HEADERS
      *            WHICH WRITES CQ IF COLL ID CHANGES OR IF IT HITS END-OF-
      *            FILE.  I THOUGHT IF THERE WAS ONLY 1 RECORD FOR A COLL
      *            ID & IT WAS LAST, THIS COULD CAUSE A 22, BUT I COULDN'T
      *            DUPLICATE IT.  AND THE EXAMPLES AT WORLD DIDN'T MATCH
      *            THIS THEORY.  I WAS ABLE TO DUPLICATE THE 22 BY RUNNING
      *            THE QUEUE CREATE AT THE SAME TIME ON 2 DIFFERENT TERMINALS.
      *            PUT ONE IN DEBUG & THE OTHER GOT A BUNCH OF RECORD LOCKED
      *            BY ANOTHER USER AS WELL AS THE 22.  SO I GUESS THEY
      *            SHOULDN'T RUN THIS AT THE SAME TIME.
      * BLM 130618 IF I'M A POT & GP-I-AM-GLFIN, MOVE 0 TO AW-REV-PDUE-DAYS
      *            SO POTS WILL ORDER BY BALANCE, NOT PAST DUE DAYS FOR
      *            GL FINANCIAL, GL FINANCIAL PR# 4308
      *  CS 140910 SET CP-PATH FOR GLOBAL QUEUEING, MOVE EXT-FILPATH-BASE,
      *            EXT-FILPATH-MACHINE TO CP-GLOBAL-BASE,CP-GLOBAL-MACHINE,
      *            CP-PATH-OVERRIDE TO "Y" IF GLOBAL QUEUEING.
      *
      * KEC 2016.0121 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         FIXED KEYS & RECS FOR FD-REC.
      *         ADDED NEW FDB-FILE; WAS IN FD-FILE.
      *         REMOVED FT-FILE; MERGED INTO FD-FILE.
      *
      * BAH 160125 SPLIT OUT LTFILE, PD0003
      *
      * KEC 2016.0217 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         FIXED KEYS & RECS FOR FD-REC.
      *         CHANGED FMNO/FORMNO/NEXTFM/SETFM FROM 3 TO 4 BYTES.
      *
      * KEC 2016.0301 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED EA-ALPNAME1 & EA-ALPNAME2 3 TO 4 BYTES.
      *
      * KEC 2016.0310 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED CD-EA-FILLER FOR CHANGE TO CD-EA-REC.
      * KEC 2016.0324 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CDSCAN-WINDOW-BUF TO HAVE MATCHING CD1-KEY
      *         LAYOUTS (FOR EACH CODE TYPE; CD-TYPE).
      *         CDSCAN-CD1-KEY IS THE NEW (PRIMARY) WITH REDEFINES OF
      *         CDSCAN-??-KEY (NEW).
      * BLM 160915 FIX CQ-DATE, GQ-DATE, CQ-SEQ, PD0003
      *
      * KEC 2016.1005 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         ADDED SETTING CQ-BRNO.
      *
      * BAH 170525 ACTIVATE 8 DIGIT DATES, PD0006
      * BAH 180313 BR-01 WAS RESETTING FIELD, NEEDED TO KEEP ENTRY FOR
      *            BATCH, CHANGED TO "R  A000BR1.".
      * BAH 180314 WAS MISSING THE FOLLOWING CHANGE FROM BLM DATED 131030;
      *            IF I-AM-REGACC, USE 2 CHARACTERS OF EA-ORIGIN FIELD TO
      *            TEST AGAINST REPO DISPOSITION (LS-Y-DISPOSAL-HOLD)
      *            INSTEAD OF ORIGIN, REGACC PR# 344
      * BAH 181003 GLOBAL BWFILE
      * KEC 2018-1026 CONVERTED CPFILE FOR A32 & A34; 
      *               CP-PATH-OVERRIDE TO "G" IF GLOBAL QUEUEING.
      * BAH 181205 GLOBAL LNFILE
      * BAH 190122 SPLIT CDFILE
      *  CS 190130 GLOBAL CQFILE
      *            SEE SPCQ2RN/SPCQ2IN FOR CQ2-KEY
      *  CS 190301 MADE SEVERAL CHANGES, NEEDED SAVE-COLLID 
      *            REPLACED MOVE OF CQ2-KEY TO HOLD-CQ2 WITH SAVE-CQ2-KEY
      *            AND MOVE OF HOLD-CQ2-KEY TO CQ2-KEY WITH LOAD-CQ2-KEY
      *            TURNS OUT WE DID NEED TO RESTART CQ
      * BAH 190311 MOVED FM-BRNO2 INTO LPWSFM-EDIT-FM-INITKEY TO REMOVE THE
      *            REDEFINE IN THE FM-REC
      *  CS 190314 SPLIT OUT THE CQFILE INTO DETAIL(CQ-FILE) AND SUMMARY,
      *            (PREVIOUS CALLED HEADER) AND THE GQFILE INTO GQFILE
      *            (DETAIL) AND HEADER (GQSFILE)
      *  190327 CS GQS-BRNO IS ALWAYS POPULATED WITH ZERO, PER KEN REMOVE
      *            FROM FILE LAYOUT
      *  190329 CS IN THE MIDDLE OF BRANCH LOGIC THERE WAS AS IF IF GLOBAL
      *            QUEUING, PURGE GQS. THE PURGE OF GQS NEEDS TO HAPPEN
      *            IN INITIALIZATION
      * BAH 20190705 REMOVED LRR AND LRB PT0151
      * BAH 20190920 REMOVED ACCESS-CALL ON LNFILE
      * BAH 20200709 MOVED OPENS FROM LPCPUPD TO HERE #TST001
      *  CS 20210506 REMOVE KEEP-CQ-FUTURE-KEY1,KEY2
      * BAH 20220818 REMOVED GLOBRD, READ GB-FILE INSTEAD
      * BAH 20220907 HARD CODED START
      * BAH 20221129 NEED DEFINITION OF RECENCY TO BE RECDEL BASED ON WAC'S
      *              RECDEL METHOD "D", NOT STANDARD EXACT DAYS SINCE LAST
      *              TRANSACTION.  MOVE RECDEL TO RECENCY #1580
      ****** ******
      * BAH 20230725 BUG IN THE EAFILE UPGRADE PUTS 1 AND 1 IN THE
      *              FIELD 13 DAY OF MO DU:, THIS SHOULD BE 1 AND 31
      ****** ******
      * MB  20231207 PERFORMANCE TUNING - CREATED STORED PROCEDURE TO 
      *                RETRIEVE LN3 ROWS WITH BW DATA
      *               ADDED STATE PARAMETER ARRAY PROCESSING
      *               EMBEDDED ALL INSERT/DELETE/UPDATE QUERIES TO USE
      *                 UPDATE_CONNECT CONNECTION
      *
      * SMR 2024-0219 ADDED VGQFILE LOGIC TO RESOLVE DIFFICULTY WITH
      *          THE GQ2-KEY WORKING WITH A SCAN WINDOW AND/OR USING A
      *          START-GREATER IO PARAGRAPH.  USING A TEMPORARY VISION
      *          GQFILE HELPS KEEP THE SAME EXPECT RESULTS FROM A15.
      * MB 20240506 CONTINUED PERFORMANCE TUNING.  S35Q-9
      *              CHANGED TO LOAD ALL EXTRACTION 
      *              ACTIONS IN TABLE FOR BRANCH.  PROCESSING WAS READING ALL
      *              EAFILE (FOR ACCOUNT/CLASS) FOR EACH BRANCH/ACCOUNT.    
      * BAH 2025.0313 ADDED REMOVE-VGQ1-FILE IN END-PROGRAM S35Q-177
      * JKC 2025-0424 S35Q-200 ADDED NEW LOGIC FOR UPDATE THE VCQFILE;
      *      THE ORIGINAL VCQFILE WAS CREATED ONE PER USER PUT INTO
      *      /USR/TMP; THE NEW VCQFILE IS CREATED FOR ONE PER BRANCH
      *      PUT INTO /USR/DATA/R#/WK/VCQ#### WHICH WAS DONE FOR
      *      POTENTIALLY AVOID ISSUES WITH A VCQFILE ONE PER USER.
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBGB/GBFSPR.CPY".
       COPY "LIBSP/SPFSVCQ.CPY".
       COPY "LIBSP/SPFSVGQ.CPY".

       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.
       COPY "LIBGB/GBFDPR.CPY".
       COPY "LIBSP/SPFDVCQ.CPY".
       COPY "LIBSP/SPFDVGQ.CPY".

       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(40) VALUE
           "@(#)LP/CQRUN.CBL J35 04/24/25-14:53:00 >".
      ****************************
      *     F I L E   I F N      *
      ****************************
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".
       COPY "LIBGB/GB01GB.CPY".
       COPY "LIBGB/GB01GB_SQL.CPY".
       COPY "LIBGB/GBWSGB.CPY".
       COPY "LIBGB/GB01GR.CPY".
       COPY "LIBGB/GB01GR_SQL.CPY".
       COPY "LIBGB/GBWSGR.CPY".
       COPY "LIBLP/LP01LN.CPY".
       COPY "LIBLP/LP01LN_SQL.CPY".
       COPY "LIBLP/LPWSLN.CPY".
       COPY "LIBLP/LP01EA.CPY".
       COPY "LIBLP/LP01EA_SQL.CPY".
       COPY "LIBLP/LPWSEA.CPY".
       COPY "LIBLP/LP01SP.CPY".
       COPY "LIBLP/LP01SPA.CPY".
       COPY "LIBLP/LP01SPB.CPY".
       COPY "LIBLP/LP01SPC.CPY".
       COPY "LIBLP/LP01SP_SQL.CPY".
       COPY "LIBLP/LPWSSP.CPY".
       COPY "LIBLP/LP01BW.CPY".
       COPY "LIBLP/LP01BW_SQL.CPY".
       COPY "LIBLP/LPWSBW.CPY".
       COPY "LIBLP/LP01FD.CPY".
       COPY "LIBLP/LP01FD_SQL.CPY".
       COPY "LIBLP/LPWSFD.CPY".
       COPY "LIBLP/LP01LTI.CPY".
       COPY "LIBLP/LP01LTI_SQL.CPY".
       COPY "LIBLP/LPWSLTI.CPY".
       COPY "LIBLP/LP01LTP.CPY".
       COPY "LIBLP/LP01LTP_SQL.CPY".
       COPY "LIBLP/LPWSLTP.CPY".
       COPY "LIBSP/SP01CQS.CPY".
       COPY "LIBSP/SP01CQS_SQL.CPY".
       COPY "LIBSP/SPWSCQS.CPY".
       COPY "LIBSP/SP01CQ.CPY".
       COPY "LIBSP/SP01CQ_SQL.CPY".
       COPY "LIBSP/SPWSCQ.CPY".
       COPY "LIBSP/SPWSVCQ.CPY".
       COPY "LIBSP/SP01GQ.CPY".
       COPY "LIBSP/SP01GQ_SQL.CPY".
       COPY "LIBSP/SPWSGQ.CPY".
       COPY "LIBSP/SPWSVGQ.CPY".
       COPY "LIBSP/SP01GQS.CPY".
       COPY "LIBSP/SP01GQS_SQL.CPY".
       COPY "LIBSP/SPWSGQS.CPY".
       COPY "LIBSP/SP01CP.CPY".
       COPY "LIBSP/SP01CP_SQL.CPY".
       COPY "LIBSP/SPWSCP.CPY".
       COPY "LIBLP/LP01CD.CPY".
       COPY "LIBLP/LP01CD_SQL.CPY".
       COPY "LIBLP/LPWSCD.CPY".
       COPY "LIBLP/LP01FM.CPY".
       COPY "LIBLP/LP01FM_SQL.CPY".
       COPY "LIBLP/LPWSFM.CPY".
       COPY "LIBLP/LP01LP.CPY".
       COPY "LIBLP/LP01LP_SQL.CPY".
       COPY "LIBLP/LPWSLP.CPY".
       COPY "LIBLP/LP01TZ.CPY".
       COPY "LIBLP/LP01TZ_SQL.CPY".
       COPY "LIBLP/LPWSTZ.CPY".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.
       01  WS-EA1-ROWCOUNT             PIC 9(5).
       01  PASS-BEG-CLASS              PIC 9(3).
       01  PASS-END-CLASS              PIC 9(3).
       01  PASS-GROUP-ID               PIC X(6).
       EXEC SQL END DECLARE SECTION END-EXEC.
 
       01  CP1-CONN-OPEN-SW            PIC X         VALUE "N".
       01  GQ1-CONN-OPEN-SW            PIC X         VALUE "N".
       01  CQ1-CONN-OPEN-SW            PIC X         VALUE "N".
       01  LN3-CONN-OPEN-SW            PIC X         VALUE "N".

       01  WS-EAFILE-LOOP-CTR          PIC 9(9)       VALUE 0.
       01  WS-EAFILE-ROW-CTR           PIC 9(9)       VALUE 0.
       01  WS-EAFILE-TBL.
          03  WS-EAFILE-TBL-DATA       OCCURS 1 TO 5000 TIMES 
                                       DEPENDING ON WS-EA1-ROWCOUNT.
             05  WS-EAFILE-TBL-CLASS   PIC 9(3).
             05  WS-EAFILE-TBL-REC     PIC X(EA-SIZE).

       01  PR-IFN               PIC X(2)      VALUE "PR".

       01  HOLD-BR-KEY          PIC 9(4)      VALUE 0.
       01  HOLD-FM1-KEY         PIC X(28)     VALUE SPACES.
       01  HOLD-BW-SSNO         PIC 9(9)      COMP-3 VALUE 0.

       01  HOLD-PHONE        PIC 9(10).
       01  HOLD-PHONEX REDEFINES HOLD-PHONE.
           03  HOLD-AC       PIC 9(3).
           03  HOLD-PREFIX   PIC 9(3).
           03  HOLD-4567     PIC 9(4).


       01  SAVE-CQ-SEQ                   PIC 9(3) VALUE 0.
       01  SAVE-GQ-SEQ                   PIC 9(3) VALUE 0.
       01  FIRST-TIME-CQ        PIC X         VALUE "Y".
       01  GQ-FIRST-TIME        PIC X         VALUE "Y".
       01  TOTAL-CQS-RECS       PIC 9(5)      VALUE 0.
       01  TOTAL-GQS-RECS       PIC 9(5)      VALUE 0.       
       01  TOTAL-CQS-TIMED      PIC 9(5)      VALUE 0.
       01  TOTAL-GQS-TIMED      PIC 9(5)      VALUE 0.
       01  SAVE-COLLID          PIC XXX.
       01  COL-COUNT            PIC 99        VALUE 0.
       01  LITTLE-ZX.
           03  FILLER           PIC X VALUE X"7A".
           03  FILLER           PIC X VALUE X"7A".
           03  FILLER           PIC X VALUE X"7A".
           03  FILLER           PIC X VALUE X"7A".
       01  LITTLE-Z  REDEFINES LITTLE-ZX PIC X(4).
       01  SUB                  PIC 9(6)      COMP-3 VALUE 0.
       01  SUB1                 PIC 9(6)      COMP-3 VALUE 0.
       01  LN-ACCUM-BAL         PIC S9(7)V99  COMP-3 VALUE 0.
       01  WORK-LNAME           PIC XXXX.
       01  HOLD-LOAN-DATE       PIC 9(8)      COMP-3 VALUE 0.

       01  WK-RENEWABLE-PAYS    PIC 9(4).
       01  WK-RENEWABLE-DAYS    PIC 9(4).

       01  RTN-FG               PIC XXX.
       01  UPD-FLAG             PIC X         VALUE "N".
       01  GLOBAL-QUEUING-FG    PIC X         VALUE "N".

       01  DATE-TABLE3.
           03  X-CONTRACT       PIC X.
           03  X-RECENCY        PIC X.
           03  X-PDAYS          PIC X.
           03  X-ARREAR         PIC X.

      **********************
      *   LINE WORKERS     *
      **********************
       01  LN-FEED          PIC 99       VALUE 0.

       COPY "LIBGB/EOBUF_EXT.CPY".
           03  BEG-BRANCH         PIC 9(4).
           03  END-BRANCH         PIC 9(4).
           03  BEG-CLASS          PIC 9(3).
           03  END-CLASS          PIC 9(3).
           03  BEG-GROUP-ID       PIC X(6).
           03  CLEAR-AWFILE       PIC X.
           03  EXTRDATE           PIC 9(8).
           03  REMOVE-RESCHED-FG  PIC X.
           03  RESCHED-DAYS       PIC 99.
           03  REMOVE-UNWORKED-FG PIC X.
           03  REPLACE-COL-FG     PIC X.
           03  GROUP-FLAG         PIC X.
           03  ENT-GROUP          PIC X(4).

       01  VERSION-CONTROL      PIC X VALUE "C".


       01  SV-BEG-BR           PIC 9999  VALUE 9999.
       01  SV-END-BR           PIC 9999  VALUE 9999.

       01  MESS-LIST            PIC X(5) VALUE "MESS.".

       01  HOLD-DATE            PIC 9(8) COMP-3 VALUE 0.

       01  WK-FORMNO            PIC 9(4) COMP-3 VALUE 0.
       01  CQ1-EXISTS           PIC X           VALUE SPACES.
       01  GQ1-EXISTS           PIC X           VALUE SPACES.
       01  FIRST-TIME           PIC X           VALUE "Y".

       01  TEST-ACTION-TABLE1.
           03  TEST-ACTION-TAB1 PIC X     OCCURS 4.
       01  TEST-ACTION-TABLE2.
           03  TEST-ACTION-TAB2 PIC X     OCCURS 4.
       01  TEST-LIMIT           PIC 9     VALUE 4.

       01  TEST-COLLECTOR-TABLE1.
           03  TEST-COLLECTOR-TAB1 PIC X     OCCURS 3.
       01  TEST-COLLECTOR-TABLE2.
           03  TEST-COLLECTOR-TAB2 PIC X     OCCURS 3.

       COPY "LIBCL/VCQUPD_LNK.CPY".
       COPY "LIBWI/GRSCANW.CPY".
       COPY "LIBGB/BRSECUREW.CPY".
       COPY "LIBGB/GETPRW.CPY".
       COPY "LIBGB/SPPDTHW.CPY".
       COPY "LIBWI/CDSCANW.CPY".
       COPY "LIBLP/LPLCASW.CPY".
       COPY "LIBLP/LPLCHGW.CPY".
       COPY "LIBLP/LPSCHDW.CPY".
       COPY "LIBLP/LPLCAPW.CPY".
       COPY "LIBLP/LPCPAW.CPY".
       COPY "LIBLP/DEFPOLW.CPY".
       COPY "LIBLP/LPPOFFW.CPY".
       COPY "LIBLP/ADDONSPRW.CPY".
       COPY "LIBLP/LPITRMW.CPY".
       COPY "LIBLP/LPAVCRW.CPY".
       COPY "LIBGB/REBATEW.CPY".
       COPY "LIBLP/LPAPRSW.CPY".
       COPY "LIBLP/LPAPRZW.CPY".
       COPY "LIBLP/LPUPERW.CPY".
       COPY "LIBLP/LPMDTEW.CPY".
       COPY "LIBLP/LPXDTEW.CPY".
       COPY "LIBLP/LPIBPCW.CPY".
       COPY "LIBLP/LPRATEW.CPY".
       COPY "LIBLP/LPPDUEW.CPY".
       COPY "LIBLP/LPCDELW.CPY".
       COPY "LIBLP/LPAMTSW.CPY".
       COPY "LIBGB/AGEINGW.CPY".
       COPY "LIBLP/LPUPWKW.CPY".
       COPY "LIBLP/LPCEPPW.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/MESSWK.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBLP/SETCTBLW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBGB/MKTEMPW_CMD.CPY".
       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBGB/GETENVW.CPY".
       COPY "LIBGB/RBACTW.CPY".
       COPY "LIBGB/GRWORKW.CPY".
       COPY "LIBGB/PASSWDW.CPY".
       COPY "LIBGB/GETDLSW.CPY".
       COPY "LIBGB/GPENVW.CPY".
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBGB/PRU_LNK.CPY".
       COPY "LIBGB/SCREENW.CPY".

       COPY "LIBLP/CQRUN_DEF.CPY".
       COPY "LIBLP/CQRUN_WKS.CPY".
       COPY "LIBGB/HELPLINK.CPY".

       COPY "LIBLP/ARRAYSPW.CPY". 

      /***************************************
      *     P R O G R A M   C O N T R O L    *
      ****************************************
       COPY "LIBGB/GETFMW.CPY".
       SCREEN SECTION.
       COPY "LIBLP/CQRUN_SCN.CPY".
       PROCEDURE DIVISION
             USING FORM-PATHNAME EXIT-PATHNAME.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON PR-FILE VCQ-FILE VGQ-FILE.
       COPY "LIBGB/DECLRP.CPY".
           PERFORM CLOSE-GQS1-FILE.
           PERFORM CLOSE-GQ2-FILE.
           PERFORM CLOSE-GQ1-FILE.
           PERFORM CLOSE-VCQ1-FILE.
           PERFORM CLOSE-VGQ1-FILE.
           PERFORM CLOSE-CQS1-FILE.
           PERFORM CLOSE-CQ2-FILE.
           PERFORM CLOSE-CQ1-FILE.
           PERFORM CLOSE-CP1-FILE.
           PERFORM CLOSE-TZ1-FILE.
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-LTP1-FILE.
           PERFORM CLOSE-LTI1-FILE.
           PERFORM CLOSE-LP1-FILE.
           PERFORM CLOSE-LN3-FILE.
           PERFORM CLOSE-FM1-FILE.
           PERFORM CLOSE-FD1-FILE.
           PERFORM CLOSE-EA1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-GR1-FILE.
           PERFORM CLOSE-BR-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-PR-FILE.
           PERFORM SQL-CLOSE-UPDATE-CONNECTION.
           PERFORM CLOSE-LN3-CONNECTION.
           PERFORM CLOSE-CQ1-CONNECTION.
           PERFORM CLOSE-GQ1-CONNECTION.
           PERFORM CLOSE-CP1-CONNECTION.
           
       COPY "LIBGB/DECLRP2.CPY".

      ********************************
      *  MAIN MODULE:
      ********************************
       MAIN-MODULE SECTION.

           PERFORM SQL-CONNECT.

      D    STOP MESS.
           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "CQRUN" TO FORM-PROG VDU-FORM-NAME.

           PERFORM GET-GPENV.

           PERFORM INITIALIZATION.
           IF RTN-FG = "END"
              GO TO EXIT-PROG.

           IF GROUP-FLAG = "N"
              MOVE BEG-BRANCH TO BR-NO
              PERFORM START-BR-FILE
              GO TO NEXT-BRANCH-NO.

           MOVE ENT-GROUP TO GR-ID.
           PERFORM SEARCH-GR-INIT.

      *----------------------------------------------------------------
       NEXT-GROUP-LOC.
           IF GROUP-FLAG NOT = "Y"
              GO TO NEXT-BRANCH-NO.

           PERFORM SEARCH-GR-NEXT.
           IF WGR-SRESULT = 0
              GO TO END-ROUTINE.

           MOVE WGR-SRESULT TO BR-NO.
           PERFORM READ-BR-FILE.
           IF IO-BAD
              GO TO IO-ERROR.

           IF BR-COLLECTOR-QUEUE NOT = "Y"
              GO TO NEXT-GROUP-LOC.

           GO TO MOVE-BRANCH-PATH-INFO.

       NEXT-BRANCH-NO.
           PERFORM READ-BR-FILE-NEXT.
           IF IO-BAD OR BR-NO > END-BRANCH
              GO TO END-ROUTINE.

       MOVE-BRANCH-PATH-INFO.

           IF EXT-ROUTE-BUF = "00"
              STRING "PROCESSING....." , BR-NO
                          DELIMITED "  " INTO WR-BUF
              MOVE MESS-LIST TO WR-LIST
              PERFORM CALL-WRFORM.

      * CHECK EA TO SEE IF ANY CLASS & GROUP MATCHES FOR THIS BRANCH

      *    MOVE BR-NO        TO EA-BRANCH
      *                         QEA1-WBEG-BRANCH
      *                         QEA1-WEND-BRANCH.
      *    MOVE BEG-CLASS    TO EA-CLASS
      *                         QEA1-WBEG-CLASS.
      *    MOVE END-CLASS    TO QEA1-WEND-CLASS.
      *    MOVE BEG-GROUP-ID TO EA-GROUP-ID
      *                         QEA1-WBEG-GROUP-ID
      *                         QEA1-WEND-GROUP-ID.
      *     MOVE 0            TO EA-SEQNO
      *                          QEA1-WBEG-SEQNO.
      *     MOVE ALL "9"      TO QEA1-WEND-SEQNO.
      *      PERFORM START-EA1-FILE.

      * COUNT ROWS IN EAFILE TO SEE IF WE NEED TO PROCESS THIS BRANCH MB 20231207
           MOVE BR-NO        TO QEA1-WBEG-BRANCH.
           MOVE BEG-CLASS    TO QEA1-WBEG-CLASS.
           MOVE END-CLASS    TO QEA1-WEND-CLASS.
           MOVE BEG-GROUP-ID TO QEA1-WBEG-GROUP-ID.
           MOVE 0            TO WS-EA1-ROWCOUNT.
           PERFORM COUNT-EA1-FILE.
           IF WS-EA1-ROWCOUNT = 0
               GO TO NEXT-GROUP-LOC.
      * THIS REPLACED WITH ABOVE COUNT  MB 20231207
      * FIND-EA1FILE-NEXT.
      *     PERFORM READ-EA1-FILE-NEXT.
      *     IF IO-BAD
      *        GO TO NEXT-GROUP-LOC.
      *
      *   EA-BRANCH NOT = BRANCH NUMBER GET NEW BRANCH
      *     IF EA-BRANCH NOT = BR-NO
      *         GO TO NEXT-GROUP-LOC.
      *
      *   EA-CLASS IS GREATER THAN ENDING CLASS, GET NEW BRANCH
      *     IF EA-CLASS > END-CLASS
      *         GO TO NEXT-GROUP-LOC.
      *
      *   TEST FOR EA WITHIN CLASS RANGE AND GROUP-ID
      *     IF EA-CLASS  NOT < BEG-CLASS
      *        IF EA-CLASS  NOT > END-CLASS
      *           IF EA-GROUP-ID = BEG-GROUP-ID
      *              GO TO BEGIN-PROCESS.
      *
      *     GO TO FIND-EA1FILE-NEXT.

      *  EA EXISTS FOR CLASS AND GROUP ID
       BEGIN-PROCESS.

           MOVE EXT-FILPATH-BASE           TO FILPATH-BASE.
           MOVE BR-MACHINE                 TO FILPATH-MACHINE.
           MOVE BR-DATA-PATH               TO FILPATH-DATA.

           MOVE "B"                        TO BW-PATH-OVERRIDE
                                              CP-PATH-OVERRIDE
                                              CQ-PATH-OVERRIDE
                                              CQS-PATH-OVERRIDE
                                              FM-PATH-OVERRIDE
                                              GQ-PATH-OVERRIDE
                                              GQS-PATH-OVERRIDE
                                              LN-PATH-OVERRIDE
                                              LP-PATH-OVERRIDE
                                              LTI-PATH-OVERRIDE
                                              LTP-PATH-OVERRIDE
                                              GB-PATH-OVERRIDE.

           IF ( GLOBAL-QUEUING-FG = "Y" )
              MOVE EXT-FILPATH-BASE        TO CP-GLOBAL-BASE
              MOVE EXT-FILPATH-MACHINE     TO CP-GLOBAL-MACHINE
              MOVE "G"                     TO CP-PATH-OVERRIDE
              MOVE CP-GLOBAL-PATH          TO CP-PATH.

      * CQS - SUMMARY
      * CQ  - DETAIL
      * GQ  - DETAIL
           IF GLOBAL-QUEUING-FG NOT = "Y"
              PERFORM PURGE-CQS-RECORDS
              PERFORM PURGE-CQ-RECORDS
              PERFORM INITIALIZE-COLLECTOR-POOLS
           ELSE
              PERFORM PURGE-GQ-RECORDS.

      * NEED FOR LCAS ROUTINES (REPLACES GLOBRD)
           PERFORM OPEN-GB-FILE.
           MOVE GB-PATH-OWNBR TO GB-BRNO.
           MOVE 1             TO GB-NO.
           PERFORM READ-GB-FILE.
           PERFORM CLOSE-GB-FILE.
           IF IO-BAD
              GO TO END-OF-GROUP.

           PERFORM OPEN-LN3-FILE.
           PERFORM OPEN-BW1-FILE.
           PERFORM OPEN-CP1-FILE.
           PERFORM OPEN-CQ1-FILE.
           PERFORM OPEN-CQS1-FILE.
           PERFORM OPEN-EA1-FILE.

      ********************************
      *  START NEW BRANCH:
      ********************************
      ******************************************************************
      * LN3 CURSOR RETREIVES LN AND BW DATA TOGETHER FOR SINGLE BRANCH
      *  ORDER BY LN-CLASS, LN-ACCTNO 
      ******************************************************************
       START-NEW-BRANCH.
      * FIRST LOAD ALL EXTRACTION ACTIONS FOR BRANCH INTO WS-EAFILE-TBL  MB 20231207
           INITIALIZE WS-EAFILE-TBL.
           MOVE 0 TO WS-EAFILE-ROW-CTR
                     WS-EAFILE-LOOP-CTR.
           PERFORM LOAD-EXTRACTION-TABLE.

           MOVE BR-NO     TO LN-OWNBR
                             QLN3-WBEG-OWNBR
                             QLN3-WEND-OWNBR.
           MOVE BEG-CLASS TO LN-CLASS
                             QLN3-WBEG-CLASS.
           MOVE END-CLASS TO QLN3-WEND-CLASS.
      *     MOVE 0         TO LN-ACCTNO
      *                       QLN3-WBEG-ACCTNO.
      *     MOVE ALL "9"   TO QLN3-WEND-ACCTNO.

           PERFORM START-LN3-FILE.  *> SSP - LN, BW 

       READ-LN3FILE-NEXT.
           PERFORM READ-LN3-FILE-NEXT.  *> SSP - LN, BW 
           IF IO-BAD          *> OR (LN-OWNBR NOT = LN-PATH-OWNBR)
              GO TO END-OF-GROUP.

      * THIS ALSO CHECKED IN STORED PROCEDURE
      *  POCD - **  IS A DELETED CONTRACT
           IF ( LN-POCD-NONLOAN )
              GO TO READ-LN3FILE-NEXT.

      * THIS ALSO CHECKED IN STORED PROCEDURE
           IF LN-OWNBR > BR-NO
              GO TO END-OF-GROUP.

      * THIS ALSO CHECKED IN STORED PROCEDURE
           IF LN-CLASS > END-CLASS
              GO TO END-OF-GROUP.

      * CLEAR LOAN FIELDS FOR COMPARE:
           MOVE " "       TO DATE-TABLE3.

      * READ BORROWER, DONT NEED TO READ FOR EVERY EA, JUST EVERY LOAN
      * BW DATA IN LN3 CURSOR FOR LN_SSNO1. IF ROW NOT FOUND BW-OWNBR = 0 
      *    PERFORM GET-MAKER.
           IF BW-OWNBR = 0 
              MOVE ZEROES TO BW-SCORE-TABLE
              MOVE SPACES TO BW-ZIP
              MOVE "A"    TO BW-LNAME.

           MOVE 0 TO WS-EAFILE-LOOP-CTR.

      * THE EAFILE IS TRICKY. ONCE YOU FIND THE FIRST EAFILE THAT THE
      * LOAN MATCHES ALL THE RANGES FOR, THAT IS THE LAST EAFILE ROW THAT
      * YOU CAN READ. IT STAMPS THE LOAN WITH THAT COLLECTOR AND MOVES
      * ON TO THE NEXT LOAN.
      *    MOVE LN-OWNBR     TO EA-BRANCH
      *                        QEA1-WBEG-BRANCH
      *                        QEA1-WEND-BRANCH.
      *    MOVE LN-CLASS     TO EA-CLASS
      *                        QEA1-WBEG-CLASS
      *                        QEA1-WEND-CLASS.
      *    MOVE BEG-GROUP-ID TO EA-GROUP-ID
      *                        QEA1-WBEG-GROUP-ID
      *                        QEA1-WEND-GROUP-ID.
      *    MOVE 0            TO EA-SEQNO
      *                        QEA1-WBEG-SEQNO.
      *    MOVE ALL "9"      TO QEA1-WEND-SEQNO.
      *    PERFORM START-EA1-FILE.


      ***  EAFILE DATA NOW LOADED INTO WS-EAFILE-TBL. 05/2024  ***
      ***  TABLE WILL CONTAIN ALL CLASSES FOR BRANCH           ***
       READ-EA1FILE-NEXT.
      *    PERFORM READ-EA1-FILE-NEXT.
      *    IF IO-BAD
      *      GO TO READ-LN3FILE-NEXT.
      *    IF EA-BRANCH NOT = LN-OWNBR
      *       GO TO READ-LN3FILE-NEXT.
      *    IF EA-CLASS NOT = LN-CLASS
      *       GO TO READ-LN3FILE-NEXT.
      *    IF EA-GROUP-ID NOT = BEG-GROUP-ID
      *       GO TO READ-LN3FILE-NEXT.

           ADD 1 TO WS-EAFILE-LOOP-CTR.

           IF WS-EAFILE-LOOP-CTR > WS-EAFILE-ROW-CTR
              GO TO READ-LN3FILE-NEXT.

           IF WS-EAFILE-TBL-CLASS(WS-EAFILE-LOOP-CTR) NOT = LN-CLASS
              GO TO READ-EA1FILE-NEXT.

           MOVE WS-EAFILE-TBL-REC(WS-EAFILE-LOOP-CTR) TO EA-REC.

           IF EA-CQ-FG NOT = "Y"
              GO TO READ-EA1FILE-NEXT.

      *  2/28/06, ADDED EA-INCL-COLLECTOR, OLD RECORDS WOULD HAVE
      *           SPACES, SO FORCE ??? TO INCLUDE, BARB

           IF EA-INCL-COLLECTOR = SPACES
              MOVE "???" TO EA-INCL-COLLECTOR.
           PERFORM TEST-EA1-FIELDS.

           IF RTN-FG = "NL"
              GO TO READ-LN3FILE-NEXT.
           IF RTN-FG NOT = "AW"
              GO TO READ-EA1FILE-NEXT.
      *  SETUP ACTION WORK RECORD:
           MOVE SPACES TO AW-WORKERS.
           MOVE LN-OWNBR        TO AW-LN-BRNO.
           MOVE LN-ACCTNO       TO AW-ACCTNO.
           MOVE EA-LN-COL-ID    TO AW-COLCTID.
           MOVE EA-SET-LN-COL   TO AW-SET-LN-COL.
           MOVE EA-SETACT-CD    TO AW-SETACTCD.
           MOVE EA-SETFM-NO     TO AW-SETFMNO.
           MOVE EA-INC-CNT      TO AW-INCCNT.
           MOVE HOLD-DATE       TO AW-TODAYDUE-DATE.
           MOVE EA-INC-PROMISED TO AW-INCPROM.
           MOVE 0 TO AW-SETFM(1) AW-SETFM(2) AW-SETFM(3).
           MOVE "Y"             TO AW-CQ-FG.
           MOVE 0               TO AW-REV-PDUE-DAYS.
           IF X-CONTRACT NOT = "Y"
              PERFORM COMPUTE-CONTRACT-SUB.

       CREATE-DELINQUENCY-KEY.
           PERFORM CREATE-RENEWABILITY-KEY.

           GO TO EXIT-DELINQUENCY-KEY.

      *    IF BR-COL-QUEUE-LOW-TO-HI = "Y"
      *       MOVE CONTRACTUAL TO AW-REV-DEL
      *       MOVE 0 TO AW-REV-PDUE-DAYS
      *       IF CPOT30 = "Y"
      *          MOVE 15 TO AW-REV-DEL
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          MOVE PDUE-DAYS TO AW-REV-PDUE-DAYS
      *       END-IF
      *       IF CPOT30 = "M"
      *          MOVE 20 TO AW-REV-DEL
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          MOVE PDUE-DAYS TO AW-REV-PDUE-DAYS
      *       END-IF
      *       IF (BR-COL-QUEUE-PAST-DUE = "Y" AND CPOT30 = " ")
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          MOVE PDUE-DAYS TO AW-REV-PDUE-DAYS
      *       END-IF
      *    ELSE
      *       COMPUTE AW-REV-DEL = 99000 - CONTRACTUAL
      *       MOVE 0 TO AW-REV-PDUE-DAYS
      *       IF CPOT30 = "Y"
      *          MOVE 98985 TO AW-REV-DEL
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          COMPUTE AW-REV-PDUE-DAYS =
      *             99999 - PDUE-DAYS
      *       END-IF
      *       IF CPOT30 = "M"
      *          MOVE 98980 TO AW-REV-DEL
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          COMPUTE AW-REV-PDUE-DAYS =
      *             99999 - PDUE-DAYS
      *       END-IF
      *       IF (BR-COL-QUEUE-PAST-DUE = "Y" AND CPOT30 = " ")
      *          IF X-PDAYS NOT = "Y"
      *             PERFORM COMPUTE-PASTDUE
      *          END-IF
      *          COMPUTE AW-REV-PDUE-DAYS = 99999 - PDUE-DAYS
      *       END-IF.
      *    IF LN-UNITPER-CD NOT = "M"
      *       IF CPOT30 = "Y"
      *          IF (GP-I-AM-TFC OR GP-I-AM-GLFIN)
      *             MOVE 0 TO AW-REV-PDUE-DAYS.

       EXIT-DELINQUENCY-KEY.
           MOVE "N" TO AW-CQ-SEQ-FG.
           IF EA-BROKEN-PROM-FG = "Y"
              IF LN-PROMDATE NOT = 0
                 MOVE LN-PROMDATE TO NUM-DATE
                 MOVE HOLD-DATE TO SYS-DATE
                 PERFORM TIM
                 IF ELAPSED-DAYS NOT LESS EA-PROM-BREAK1
                    IF ELAPSED-DAYS NOT GREATER EA-PROM-BREAK2
                       MOVE "B" TO AW-CQ-SEQ-FG.

           MOVE 0 TO AW-CQ-BEHAVIOR-RISK.

       SETUP-CQ.
      * FOR NOW, USE LOAN COLLECTOR UNLESS ITS BLANK, THEN USE POOL
      *    IF EA-CQ-FG = "L"
              IF LN-COLLECTOR NOT = "   "
                 MOVE LN-COLLECTOR TO AW-CQ-COL-ID AW-COLCTID
                 GO TO EXIT-SETUP-CQ.

      * IF NO LOAN COLLECTOR, GET ONE FROM POOL
           MOVE EA-COL-POOL TO CP-ID.
           PERFORM READ-CP1-FILE.   *>  EMBEDDED CP
           IF IO-BAD
      *       UNLOCK CP-FILE
              GO TO EXIT-SETUP-CQ.

      * PROCESS ONLY UPDATES CP-LAST-SUBSCRIPT

           IF CP-COLLECTOR-COUNT = 1
      *       UNLOCK CP-FILE
              MOVE CP-COL-ID(1) TO AW-CQ-COL-ID AW-COLCTID
              GO TO EXIT-SETUP-CQ.

           IF CP-LAST-SUBSCRIPT < CP-COLLECTOR-COUNT
              ADD 1 TO CP-LAST-SUBSCRIPT
           ELSE
              MOVE 1 TO CP-LAST-SUBSCRIPT.

           MOVE CP-COL-ID(CP-LAST-SUBSCRIPT) TO AW-CQ-COL-ID AW-COLCTID.

      * PROCESS ONLY UPDATES CP-LAST-SUBSCRIPT
           PERFORM REWRITE-CP1-FILE-LAST-SUB.

       EXIT-SETUP-CQ.
           IF GP-TIME-ZONE-Q = "Y"
              PERFORM GET-TIME-ZONE
           ELSE
              MOVE 0 TO AW-START-TIME.
           MOVE LN-OWNBR TO AW-LN-BRNO.

      * NO AUTOMATIC UPDATE, CREATE AW-RECORD:
      *    IF BR-EXTRACT-AUTO-UPD NOT = "Y"
      *       PERFORM WRITE-AW1-FILE
      *       IF IO-BAD
      *          PERFORM REWRITE-AW1-FILE
      *          IF IO-BAD
      *             GO TO IO-ERROR
      *          ELSE
      *             GO TO READ-LN3FILE-NEXT
      *       ELSE
      *          GO TO READ-LN3FILE-NEXT.

      * AUTOMATIC UPDATE:
      * IF RANGES ARE "ALL", THE SP RECORD MAY NOT HAVE BEEN READ!!
           PERFORM READ-SP-RECORD.
           MOVE "N" TO UPD-FLAG.

           PERFORM EXTRACTION-UPDATE.

      *    PERFORM REWRITE-LN3-FILE.
      *    IF IO-BAD
      *       GO TO IO-ERROR.

           GO TO READ-LN3FILE-NEXT.

       END-OF-GROUP.
           IF GLOBAL-QUEUING-FG NOT = "Y"
              PERFORM CREATE-CQS-RECORD.

      *    PERFORM CLOSE-AW1-FILE.
           PERFORM CLOSE-LN3-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-CP1-FILE.
           PERFORM CLOSE-CQ1-FILE.

           MOVE "C"       TO VCQUPD-ACTION.            *> CREATE
           MOVE BR-NO     TO VCQUPD-BRNO.
           MOVE SPACES    TO VCQUPD-CQ-REC.
           MOVE SPACES    TO VCQUPD-VCQ-REC.
           PERFORM UPDATE-VCQ1-FILE-VCQUPD.

           GO TO NEXT-GROUP-LOC.

       END-ROUTINE.
           IF GLOBAL-QUEUING-FG = "Y"
              PERFORM CREATE-GQS-RECORD.

           GO TO END-PROGRAM.

      *********************************************
       INITIALIZATION SECTION.
      *********************************************
           MOVE CQRUN-QUEUE-POS  TO Q-POS.
           MOVE CQRUN-COPIES-POS TO C-POS.
           MOVE CQRUN-PRU-POS    TO P-POS.
           MOVE SPACES TO Q-BUF C-BUF P-BUF.

       COPY "LIBGB/EOINIT.CPY".

           MOVE EXTRDATE TO HOLD-DATE.

           IF EXT-ROUTE-BUF = "00"
              MOVE "COLLECTOR QUEUE CREATION IN PROGRESS..." TO WR-BUF
              MOVE MESS-LIST TO WR-LIST
              PERFORM CALL-WRFORM.

           IF ( BEG-BRANCH = 0 AND END-BRANCH = 0 )
              MOVE BEG-BRANCH TO SV-BEG-BR
              MOVE END-BRANCH TO SV-END-BR
              MOVE EXT-CONAME-USER-LOC TO BEG-BRANCH END-BRANCH.

           MOVE "EA"         TO CD-TYPE.
           MOVE BEG-GROUP-ID TO CD-CODE.
           PERFORM OPEN-CD1-FILE.
           PERFORM READ-CD1-FILE.
           PERFORM CLOSE-CD1-FILE.
           IF ( IO-BAD )
              GO TO INITIALIZATION-END.

           IF CD-EA-CQ-FG NOT = "Y"
              GO TO INITIALIZATION-END.

           MOVE CD-EA-GQ-FG TO GLOBAL-QUEUING-FG.

           IF GLOBAL-QUEUING-FG = "Y"
              PERFORM CREATE-VGQ-FILE
              PERFORM OPEN-GQ1-FILE
              PERFORM OPEN-GQS1-FILE.

           PERFORM OPEN-BR-FILE.
           PERFORM OPEN-GR1-FILE.
      * MUST LEAVE SP1-FILE OPEN BECAUSE ADDONSPR READS IT
           PERFORM OPEN-SP1-FILE.
           PERFORM OPEN-EA1-FILE.
           PERFORM OPEN-FD1-FILE.
           PERFORM OPEN-FM1-FILE.

           PERFORM ARRAYSP-LOAD.
           PERFORM SQL-OPEN-UPDATE-CONNECTION.

      * 4/3/03 HEY, TFC USES LAST DAY OF MONTH FOR CPRUN, CQRUN
      * EXTRACT DATE, SO IT MESSES UP DAYLIGHT SAVINGS, USE
      * SYSTEM DATE FOR THEM:

           IF GP-TIME-ZONE-Q = "Y"
              MOVE EXTRDATE TO DLS-DATE
              PERFORM GET-DLS
              PERFORM OPEN-TZ1-FILE.

           IF GLOBAL-QUEUING-FG = "Y"
              PERFORM PURGE-GQS-SUMMARY
              PERFORM GLOBAL-INIT-COLLECTOR-POOLS.
   
           GO TO INITIALIZATION-EXIT.

       INITIALIZATION-END.
           MOVE "END" TO RTN-FG.
       INITIALIZATION-EXIT.
           EXIT.

      *********************************************
       EO-EXEC-AUDIT SECTION.
      *********************************************

           MOVE EXT-EOBUF-DATE2 TO EXTRDATE.

       EO-EXEC-EXIT.
           EXIT.

      *********************************************
       ENTER-PARAMETERS SECTION.
      *********************************************
       ENTER-PARM.

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE "R"    TO P-TIMER-TYPE-SET.
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           IF VDUSTATUS = "1U"
              GO TO GROUP-ID-YN.

      *----------------------------------------------------------------
       BR-01.
           MOVE "R  A000BR1." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "16" GO TO ALL-BR.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.

           IF VDUSTATUS = "1<"
              MOVE "WI/GRSCAN" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH GRSCAN-BUF EXIT-PATHNAME
              CANCEL FORM-PROGX
              IF GRSCAN-STATUS NOT = "00"
                 GO TO BR-01
              ELSE
                 MOVE "S  A000BR1." TO VDU
                 MOVE GRSCAN-KEY TO VDUBUF GR1-KEY
                 PERFORM SCREENIO
                 MOVE "00" TO VDUSTATUS.

           IF NOT (VDUSTATUS = "00" OR "1D") GO TO BR-01.

           MOVE VDUBUF TO WGR-WORD ENT-GROUP.

           IF WGR-WORD-ZERO
              GO TO BRANCH-IS-NUMERIC.

           MOVE 0 TO WGR-MIN-LEVEL.
           PERFORM CHECK-MEMBER.

           IF WGR-ERR > 0
              MOVE WGR-MSG(WGR-ERR) TO MESS
              PERFORM SEND-MESS
              GO TO BR-01.

           IF WGR-TYPE = "A"
              MOVE "S  A000BR2." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO
              MOVE "Y" TO GROUP-FLAG
              MOVE 0 TO BEG-BRANCH
              MOVE 9999 TO END-BRANCH
              GO TO CHECK-BRANCH-SECURITY.

      *----------------------------------------------------------------
       BRANCH-IS-NUMERIC.
           MOVE "N"           TO GROUP-FLAG.
           MOVE WGR-SRESULT   TO BEG-BRANCH.
           MOVE "SN N040BR1." TO VDU.
           MOVE BEG-BRANCH    TO VDUNUM0.
           PERFORM SCREENIO.

      *----------------------------------------------------------------
       BR-02.
           MOVE "ENNN040BR2." TO VDU.
           PERFORM SCREENIO.

           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO BR-01.
           IF NOT (VDUSTATUS = "00" OR "1D") GO TO BR-02.

           MOVE VDUNUM0 TO END-BRANCH.

           IF BEG-BRANCH > END-BRANCH
              MOVE "INVALID RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO BR-01.

           IF ( (BEG-BRANCH = 0) AND (END-BRANCH = 0) )
              MOVE "S  A160DISPLAY-USER." TO VDU
              MOVE "USER BRANCH ONLY" TO VDUBUF
              PERFORM SCREENIO
           ELSE
              MOVE "S  A160DISPLAY-USER." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO.

           GO TO CHECK-BRANCH-SECURITY.

      *----------------------------------------------------------------
       ALL-BR.
           MOVE "SNNN040BR1." TO VDU.
           MOVE 0             TO BEG-BRANCH VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN040BR2." TO VDU.
           MOVE 9999          TO END-BRANCH VDUNUM0.
           PERFORM SCREENIO.
           MOVE "N"           TO GROUP-FLAG.
           MOVE "S  A160DISPLAY-USER." TO VDU.
           MOVE SPACES TO VDUBUF.
           PERFORM SCREENIO.

      *-----------------------------------------------------------------
       CHECK-BRANCH-SECURITY.
           PERFORM BR-RANGE-SECURITY.

           IF BR-SECURITY-OKAY = "N"
              GO TO BR-01.

      *----------------------------------------------------------------
       EXTRACT-DATE.
      * BATCH WILL USE DATE RAN
           IF EXT-ROUTE-BUF = "40" OR "50"
              GO TO CL-01.

           MOVE "ERNM060EXTRDT." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO BR-02.
           IF NOT (VDUSTATUS = "00" OR "1D") GO TO EXTRACT-DATE.
           MOVE VDU-DATE-YYYYMMDD TO EXTRDATE HOLD-DATE.

           IF EXTRDATE = ZERO
              MOVE EXT-CONAME-SYSDATE TO ALP-DATE
              PERFORM CONVERT-ALPDATE-TO-YYYYMMDD
              MOVE "S  8000EXTRDT." TO VDU
              MOVE DATE-YYYYMMDD TO EXTRDATE HOLD-DATE VDU-DATE-YYYYMMDD
              PERFORM SCREENIO.
       CL-01.
           MOVE "ENNN020CL1." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "16" GO TO ALL-CL.
           IF VDUSTATUS = "1U" GO TO EXTRACT-DATE.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO CL-01.
           MOVE VDUNUM0 TO BEG-CLASS.
       CL-02.
           MOVE "ENNN020CL2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO CL-01.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO CL-02.
           MOVE VDUNUM0 TO END-CLASS.
           IF BEG-CLASS > END-CLASS
              MOVE "INVALID CLASS RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO CL-01.
           GO TO GROUP-ID-YN.
       ALL-CL.
           MOVE "SNNN020CL1." TO VDU.
           MOVE 1 TO BEG-CLASS VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN020CL2." TO VDU.
           MOVE 99 TO END-CLASS VDUNUM0.
           PERFORM SCREENIO.

      *-----------------------------------------------------------------
       GROUP-ID-YN.
           MOVE "E  A060GROUP-ID." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO CL-02.

      * FOR COLLECTOR QUEUE GROUP ID SCAN
      
           IF ( VDUSTATUS = "1<" )
              PERFORM CODE-SCAN
              IF ( IO-BAD )
                 GO TO GROUP-ID-YN
              ELSE
                 MOVE CDSCAN-CODE TO VDUBUF
                 MOVE "00"        TO VDUSTATUS.
      
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO GROUP-ID-YN.

           MOVE "EA"   TO CD-TYPE.
           MOVE VDUBUF TO CD-CODE BEG-GROUP-ID.
           PERFORM OPEN-CD1-FILE.
           PERFORM READ-CD1-FILE.
           PERFORM CLOSE-CD1-FILE.
           IF ( IO-BAD )
              GO TO GROUP-ID-YN.

           IF CD-EA-CQ-FG NOT = "Y"
              GO TO GROUP-ID-YN.

      *-----------------------------------------------------------------
       REMOVE-RESCHEDS.
           MOVE "E  A010REMRES." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO GROUP-ID-YN.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D"
              GO TO REMOVE-RESCHEDS.
           MOVE VDUBUF TO REMOVE-RESCHED-FG.
           IF REMOVE-RESCHED-FG = "N"
              MOVE 99 TO RESCHED-DAYS
              GO TO REMOVE-UNWORKED.
           IF REMOVE-RESCHED-FG NOT = "Y" GO TO REMOVE-RESCHEDS.
       ENTER-RESCHED-DAYS.
           MOVE "ENNN020RESDAYS." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO REMOVE-RESCHEDS.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-RESCHED-DAYS.
           MOVE VDUNUM0 TO RESCHED-DAYS.

      *-----------------------------------------------------------------
       REMOVE-UNWORKED.
           MOVE "E  A010REMUNW." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO REMOVE-RESCHEDS
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D"
              GO TO REMOVE-UNWORKED.
           MOVE VDUBUF TO REMOVE-UNWORKED-FG.
           IF REMOVE-UNWORKED-FG NOT = "N"
              IF REMOVE-UNWORKED-FG NOT = "Y"
                 GO TO REMOVE-UNWORKED.
       EXIT-PARM.
           EXIT.

      *********************************************
       DISPLAY-PARAMETERS SECTION.
      *********************************************
       DISPLAY-PARM.

           IF GROUP-FLAG = "Y"
              MOVE "S  A000BR1." TO VDU
              MOVE ENT-GROUP TO VDUBUF GTT-SV-ENT-GROUP
              PERFORM SCREENIO
              MOVE "S  A000BR2." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO
           ELSE
              MOVE "SNNN040BR1." TO VDU
              MOVE BEG-BRANCH TO VDUNUM0
              PERFORM SCREENIO
              MOVE "SNNN040BR2." TO VDU
              MOVE END-BRANCH TO VDUNUM0
              PERFORM SCREENIO.
      
           IF ( (BEG-BRANCH = 0) AND (END-BRANCH = 0) )
              MOVE "S  A160DISPLAY-USER." TO VDU
              MOVE "USER BRANCH ONLY" TO VDUBUF
              PERFORM SCREENIO
           ELSE
              MOVE "S  A160DISPLAY-USER." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO.
      
           MOVE "SNNN020CL1." TO VDU.
           MOVE BEG-CLASS TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN020CL2." TO VDU.
           MOVE END-CLASS TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "S  A060GROUP-ID." TO VDU.
           MOVE BEG-GROUP-ID TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A010REMRES." TO VDU.
           MOVE REMOVE-RESCHED-FG TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "SN N020RESDAYS." TO VDU.
           MOVE RESCHED-DAYS TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "S  A010REMUNW." TO VDU.
           MOVE REMOVE-UNWORKED-FG TO VDUBUF.
           PERFORM SCREENIO.

      *********************************************
       TEST-EA1-FIELDS SECTION.
      *********************************************

           MOVE SPACES TO RTN-FG.

      *TEST FOR LEGAL
           IF EA-LEGAL = "O"
              IF LN-LEGALDATE = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-LEGAL = "S"
              IF LN-LEGALDATE NOT = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

      *TEST FOR DEBT-AID
           IF EA-DEBTAID = "O"
              IF LN-DEBTAIDATE = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-DEBTAID = "S"
              IF LN-DEBTAIDATE NOT = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

      *TEST FOR JUDGEMENTS
           IF EA-JUDGEMENT = "O"
              IF LN-JDDATE = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-JUDGEMENT = "S"
              IF LN-JDDATE NOT = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST LOAN CONFIDENTIAL FLAG
           IF EA-CONFIDENTIAL-FG = "O"
              IF LN-CONFIDENTCD NOT = "Y"
      * BOTH FLAGS MUST NOT BE SET
                 IF BW-CONFIDENTIAL NOT = "Y"
                    GO TO TEST-EA1-FIELDS-EXIT.
           IF EA-CONFIDENTIAL-FG = "S"
      * IF EITHER FLAG IS SET, SKIP IT
              IF LN-CONFIDENTCD = "Y" OR BW-CONFIDENTIAL = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST 1ST PAYMENT MISSES
           IF EA-1ST-PMT-MISSES = "O"
              IF LN-MIDSTREAM NOT = "Y"
                 IF LN-DATE-PAID-LAST NOT = 0
                    GO TO TEST-EA1-FIELDS-EXIT
                 END-IF
              ELSE
                 IF BR-MIDSTREAM-1STPAY-FG NOT = "Y"
                    IF LN-DATE-PAID-LAST NOT = 0
                       GO TO TEST-EA1-FIELDS-EXIT
                    END-IF
                 ELSE
                    IF LN-ORIGPURAMT NOT = LN-CURBAL
                       GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-1ST-PMT-MISSES = "S"
              IF LN-MIDSTREAM NOT = "Y"
                 IF LN-DATE-PAID-LAST = 0
                    GO TO TEST-EA1-FIELDS-EXIT
                 END-IF
              ELSE
              IF BR-MIDSTREAM-1STPAY-FG NOT = "Y"
                 IF LN-DATE-PAID-LAST = 0
                    GO TO TEST-EA1-FIELDS-EXIT
                 END-IF
              ELSE
                 IF LN-ORIGPURAMT = LN-CURBAL
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST ACCOUNT BALANCES:
           COMPUTE LN-ACCUM-BAL = LN-CURBAL + LN-OTHBAL + LN-INTBAL
                                + LN-LCBAL.
           IF LN-ACCUM-BAL < EA-ACCT-BAL1 OR
              LN-ACCUM-BAL > EA-ACCT-BAL2
              GO TO TEST-EA1-FIELDS-EXIT.

      * TEST PL
      
           IF ( EA-PL = "O" )
              IF ( LN-PLDATE = ZEROES )
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF ( EA-PL = "S" )
              IF ( LN-PLDATE NOT = ZEROES )
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF ( LN-PLDATE NOT = ZEROES )
              IF ( EA-PL-IN-ACTIVE-BOTH = "A" )
                 IF ( LN-PLCD NOT = "P" )
                    GO TO TEST-EA1-FIELDS-EXIT.

           IF ( LN-PLDATE NOT = ZEROES )
              IF ( EA-PL-IN-ACTIVE-BOTH = "I" )
                 IF ( LN-PLCD NOT = "I" )
                    IF ( LN-PLCD NOT = "W" )
                       GO TO TEST-EA1-FIELDS-EXIT.

           IF ( LN-PLDATE      = ZEROES    ) OR
              ( EA-PL-BEG-DATE NOT NUMERIC ) OR
              ( EA-PL-BEG-DATE = 02020202    ) OR
              ( EA-PL-BEG-DATE = 20202020    )
              GO TO TEST-EA1-REPO.

           IF LN-PLDATE < EA-PL-BEG-DATE OR LN-PLDATE > EA-PL-END-DATE
              GO TO TEST-EA1-FIELDS-EXIT.

       TEST-EA1-REPO.
           IF EA-REPO = "O"
              IF NOT (LN-REPOCD = "X" OR "S")
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-REPO = "S"
              IF LN-REPOCD = "X" OR "S"
                 GO TO TEST-EA1-FIELDS-EXIT.

      * TEST BANKRUPT
           IF EA-BANKRUPT = "O"
              IF LN-BNKRPTDATE = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-BANKRUPT = "S"
              IF LN-BNKRPTDATE NOT = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

      * TEST ALLOTMENTS
           IF EA-ALLOTMENTS = "O"
              IF LN-ALLOTCD NOT = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF EA-ALLOTMENTS = "S"
              IF LN-ALLOTCD = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.

      * TEST DEALER NUMBER RANGE
           IF LN-DLNO < EA-DLNO1 OR
              LN-DLNO > EA-DLNO2
              GO TO TEST-EA1-FIELDS-EXIT.

      * DAY OF MONTH DUE DATE RANGE
      * NOTE: NEW FIELDS 10/30/02, SO MIGHT BE SPACES:
           IF EA-DAY-OF-MO-DUE1 = 20
              IF EA-DAY-OF-MO-DUE2 = 20
                 GO TO TEST-PASTDUE-DAYS.

           IF LN-1STPYDA < EA-DAY-OF-MO-DUE1 OR
              LN-1STPYDA > EA-DAY-OF-MO-DUE2
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST PASTDUE DAYS:
       TEST-PASTDUE-DAYS.
           IF EA-PASTDUE-DAY1 = 0
              IF EA-PASTDUE-DAY2 = 9999
                 GO TO TEST-EA1-PASTDUE-AMT.

           IF X-PDAYS NOT = "Y"
              PERFORM COMPUTE-PASTDUE
              IF RTN-FG = "NL"
                 GO TO TEST-EA1-FIELDS-EXIT.

           IF PDUE-DAYS < EA-PASTDUE-DAY1
                      OR > EA-PASTDUE-DAY2
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST PASTDUE AMOUNT:
       TEST-EA1-PASTDUE-AMT.
           IF EA-PASTDUE-AMT1 = 0
              IF EA-PASTDUE-AMT2 = 9999.99
                 GO TO TEST-EA1-RECENCY.
           IF X-ARREAR NOT = "Y"
              PERFORM COMPUTE-ARREAR
              IF RTN-FG = "NL"
                 GO TO TEST-EA1-FIELDS-EXIT.
           IF CDEL-ARREARAGE < EA-PASTDUE-AMT1
            OR (EA-PASTDUE-AMT2 NOT = 9999.99 AND
                    CDEL-ARREARAGE > EA-PASTDUE-AMT2)
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST RECENCY DAYS:
       TEST-EA1-RECENCY.

           IF EA-RECENCY-DAY1 = 0
              IF EA-RECENCY-DAY2 = 9999
                 GO TO TEST-EA1-CONTR.

           IF X-RECENCY NOT = "Y"
              PERFORM COMPUTE-RECENCY-SUB
              IF RTN-FG = "NL"
                 GO TO TEST-EA1-FIELDS-EXIT.

      * #1580 (RECENCY GETS PERFORMED IN OTHER PLACES, SO ALWAYS
      *        MOVE RECDEL TO RECENCY HERE)

           MOVE RECDEL TO RECENCY.

           IF RECENCY < 0
              MOVE 0 TO RECENCY.

      * SKIP ACCOUNTS DUE FOR 1ST PAYMENT TODAY:
           IF NOT GP-I-AM-WORLD
              IF LN-DATE-PAID-LAST = 0
                 IF RECENCY = 0
                    GO TO TEST-EA1-FIELDS-EXIT.

           IF RECENCY < EA-RECENCY-DAY1 OR > EA-RECENCY-DAY2
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST CONTRACTUAL DAYS:
       TEST-EA1-CONTR.
           IF EA-CONTRACTUAL-DAY1 = 0
              IF EA-CONTRACTUAL-DAY2 = 9999
                 GO TO TEST-EA1-CPOTS.
           IF X-CONTRACT NOT = "Y"
              PERFORM COMPUTE-CONTRACT-SUB
              IF RTN-FG = "NL"
                 GO TO TEST-EA1-FIELDS-EXIT.
           IF CONTRACTUAL < EA-CONTRACTUAL-DAY1
                    OR > EA-CONTRACTUAL-DAY2
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST CONTRACTUAL POTS:
       TEST-EA1-CPOTS.
           IF X-CONTRACT NOT = "Y"
              PERFORM COMPUTE-CONTRACT-SUB.
           IF EA-CPOTS = "S"
              IF CPOT30 = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.
           IF EA-CPOTS = "O"
              IF CPOT30 NOT = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST RECENCY POTS:
       TEST-EA1-RPOTS.
      * NOTE: NEW FIELD 10/17/00, SO MIGHT BE SPACES:
           IF EA-RPOTS NOT = "S"
              IF EA-RPOTS NOT = "I"
                 IF EA-RPOTS NOT = "O"
                    GO TO TEST-EA1-MISPAYS.

           IF X-RECENCY NOT = "Y"
              PERFORM COMPUTE-RECENCY-SUB.

      * #1580 (RECENCY GETS PERFORMED IN OTHER PLACES, SO ALWAYS
      *        MOVE RECDEL TO RECENCY HERE)

           MOVE RECDEL TO RECENCY.

           IF EA-RPOTS = "S"
              IF RDPOT30 = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.
           IF EA-RPOTS = "O"
              IF RDPOT30 NOT = "Y"
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST MISPAYS:
       TEST-EA1-MISPAYS.

           IF EA-MISPAYS NOT = "S"
              IF EA-MISPAYS NOT = "I"
                 IF EA-MISPAYS NOT = "O"
                    GO TO TEST-EA1-PROMISED.
           IF X-CONTRACT NOT = "Y"
              PERFORM COMPUTE-CONTRACT-SUB.
           IF EA-MISPAYS = "S"
              IF CPOT30 = "M"
                 GO TO TEST-EA1-FIELDS-EXIT.
           IF EA-MISPAYS = "O"
              IF CPOT30 NOT = "M"
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST PROMISED ACCOUNTS:
       TEST-EA1-PROMISED.
           IF EA-PROMISED = "I"
              IF LN-PROMDATE = 0
                 GO TO TEST-ACTION
               ELSE
                 GO TO TEST-PASTPROM-DAY.
           IF EA-PROMISED = "S"
              IF LN-PROMDATE NOT = 0
                 GO TO TEST-EA1-FIELDS-EXIT
               ELSE
                 GO TO TEST-ACTION.
           IF EA-PROMISED = "O"
              IF LN-PROMDATE = 0
                 GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST PAST PROMISED DAYS:
       TEST-PASTPROM-DAY.
           MOVE LN-PROMDATE TO NUM-DATE.
           MOVE HOLD-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS < EA-PASTPROM-DAY1
            OR ELAPSED-DAYS > EA-PASTPROM-DAY2
               GO TO TEST-EA1-FIELDS-EXIT.


      *  TEST ACTION CODES:
       TEST-ACTION.
           MOVE EA-ACTION TO TEST-ACTION-TABLE1.
           MOVE LN-ACTIONCD TO TEST-ACTION-TABLE2.
           MOVE 0 TO SUB.

       TEST-ACTION-CONT.
           ADD 1 TO SUB.
           IF SUB > 4
              GO TO TEST-ORIGIN.
           IF TEST-ACTION-TAB1(SUB) = "?"
              GO TO TEST-ACTION-CONT.
           IF TEST-ACTION-TAB1(SUB) NOT = TEST-ACTION-TAB2(SUB)
              GO TO TEST-EA1-FIELDS-EXIT.
           GO TO TEST-ACTION-CONT.

       TEST-ORIGIN.
           MOVE EA-ORIGIN TO TEST-ACTION-TABLE1.
           MOVE LN-ORIGIN TO TEST-ACTION-TABLE2.
           MOVE 4 TO TEST-LIMIT.
 
           MOVE 0 TO SUB.

       TEST-ORIGIN-CONT.
           ADD 1 TO SUB.
           IF SUB > TEST-LIMIT
              GO TO TEST-COLLECTOR.
           IF TEST-ACTION-TAB1(SUB) = "?"
              GO TO TEST-ORIGIN-CONT.
           IF TEST-ACTION-TAB1(SUB) NOT = TEST-ACTION-TAB2(SUB)
              GO TO TEST-EA1-FIELDS-EXIT.
           GO TO TEST-ORIGIN-CONT.

       TEST-COLLECTOR.
           MOVE EA-INCL-COLLECTOR TO TEST-COLLECTOR-TABLE1.
           MOVE LN-COLLECTOR TO TEST-COLLECTOR-TABLE2.
           MOVE 0 TO SUB.

       TEST-COLLECTOR-CONT.
           ADD 1 TO SUB.
           IF SUB > 3
              GO TO TEST-LNAME.
           IF TEST-COLLECTOR-TAB1(SUB) = "?"
              GO TO TEST-COLLECTOR-CONT.
           IF TEST-COLLECTOR-TAB1(SUB) NOT = TEST-COLLECTOR-TAB2(SUB)
              GO TO TEST-EA1-FIELDS-EXIT.
           GO TO TEST-COLLECTOR-CONT.

      *  TEST LAST NAME RANGE:
       TEST-LNAME.
      *-----------------------------------------------------------------
           IF (EA-ALPNAME1 = "AAAA" AND EA-ALPNAME2 = LITTLE-Z) OR
               (EA-ALPNAME1 = "AAAA" AND EA-ALPNAME2 = "~~~~")
              GO TO TEST-MATURED.
           IF EA-ALPNAME1 = " " AND EA-ALPNAME2 = " "
              GO TO TEST-MATURED.
           MOVE BW-LNAME TO WORK-LNAME.
           IF WORK-LNAME < EA-ALPNAME1
                       OR > EA-ALPNAME2
              GO TO TEST-EA1-FIELDS-EXIT.

      *  TEST MATURED ACCOUNT:
       TEST-MATURED.
           IF EA-MATURED NOT = "I"
              PERFORM MATURITY-DATE-CALCULATION
              IF EA-MATURED = "S"
                 IF MDTE-DATE < HOLD-DATE
                    GO TO TEST-EA1-FIELDS-EXIT
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF EA-MATURED = "O"
                    IF MDTE-DATE > HOLD-DATE
                       GO TO TEST-EA1-FIELDS-EXIT.

      * NOTE: NEW FIELDS 10/8/01, SO MIGHT BE SPACES:
           IF EA-LNDATE-DAYS1 = 2020
              IF EA-LNDATE-DAYS2 = 2020
                 GO TO TEST-MATURE-DAYS.
           IF EA-LNDATE-DAYS1 = 0
              IF EA-LNDATE-DAYS2 = 9999
                 GO TO TEST-MATURE-DAYS.

           MOVE LN-LOANDATE TO NUM-DATE.
           MOVE HOLD-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS < EA-LNDATE-DAYS1
            OR ELAPSED-DAYS > EA-LNDATE-DAYS2
              GO TO TEST-EA1-FIELDS-EXIT.

       TEST-MATURE-DAYS.
      * NOTE: NEW FIELDS 10/8/01, SO MIGHT BE SPACES:
           IF EA-MATURE-DAYS1 = 2020
              IF EA-MATURE-DAYS2 = 2020
                 GO TO TEST-NEXT-FIELD.
           IF EA-MATURE-DAYS1 = 0
              IF EA-MATURE-DAYS2 = 9999
                 GO TO TEST-NEXT-FIELD.

           PERFORM MATURITY-DATE-CALCULATION.
           MOVE HOLD-DATE TO NUM-DATE.
           MOVE MDTE-DATE TO SYS-DATE.
           PERFORM TIM.
           IF ELAPSED-DAYS < EA-MATURE-DAYS1
            OR (ELAPSED-DAYS > EA-MATURE-DAYS2)
              GO TO TEST-EA1-FIELDS-EXIT.

      * TEST-NEXT-FIELD:  THIS IS A DUMMY PARAGRAPH WHICH PRIOR TEST
      * SKIPS TO - WHEN YOU ADD A PARAMETER, CHANGE WHATEVER SKIPS TO
      * HERE TO SKIP TO YOUR NEW TEST.    BLV

       TEST-NEXT-FIELD.
           EXIT.

       TEST-EA1-FIELDS-AWUPD.
           MOVE "AW" TO RTN-FG.
       TEST-EA1-FIELDS-EXIT.
           EXIT.

      **********************************************
      * RECENCY FOR THIS PROGRAM ONLY COMPUTED ON 1STPYDATE
      * INSTEAD OF LOANDATE (WHEN LSTPAYMNT = 0):
      * 121688 BAH ADDED EA-RECENCYDATE FOR CITIZENS
      *********************************************
       COMPUTE-RECENCY-SUB SECTION.
      *********************************************
           PERFORM READ-SP-RECORD.
           MOVE HOLD-DATE   TO AGEING-DATE.
           MOVE LN-LOANDATE TO HOLD-LOAN-DATE.
           IF EA-RECENCYDATE NOT = "Y"
              MOVE LN-1STPYDATE TO LN-LOANDATE.
           PERFORM COMPUTE-RECENCY.
           MOVE HOLD-LOAN-DATE TO LN-LOANDATE.
           MOVE "Y" TO X-RECENCY.

      *********************************************
       COMPUTE-CONTRACT-SUB SECTION.
      *********************************************
           PERFORM READ-SP-RECORD.
           MOVE HOLD-DATE TO AGEING-DATE.
           PERFORM COMPUTE-CONTRACTUAL.
           MOVE "Y" TO X-CONTRACT.

      * COMPUTE PASTDUE AMOUNT:
      *********************************************
       COMPUTE-ARREAR SECTION.
      *********************************************
           PERFORM READ-SP-RECORD.
           MOVE LN-1STPYDATE TO CEPP1-DATE.
           MOVE HOLD-DATE    TO CEPP2-DATE.
           MOVE LN-MAKERCD(1) TO CEPP-MAKERCD.
           PERFORM TOTAL-DELINQUENCY.
           IF CDEL-ARREARAGE < 0
              MULTIPLY -1 BY CDEL-ARREARAGE
           ELSE
              MOVE 0 TO CDEL-ARREARAGE.
           MOVE "Y" TO X-ARREAR.

      * COMPUTE PASTDUE DAYS:
      *********************************************
       COMPUTE-PASTDUE SECTION.
      *********************************************
           PERFORM READ-SP-RECORD.
           MOVE LN-1STPYDATE TO PDUE-1STPYDATE.
           MOVE HOLD-DATE TO PDUE-TODAY-DATE.
           PERFORM PAST-DUE-DAYS-CALCULATION.
           MOVE "Y" TO X-PDAYS.

      *******************************************************************
      *  THIS LOOKS COMPLICATED - IT'S REALLY NOT.  THE TIME ZONE FILE
      *  IS KEYED BY AREA CODE & PREFIX.  ALMOST ALWAYS IT WILL BE
      *  AREA CODE & A PREFIX OF 0.  IT'S POSSIBLE TO HAVE AREA CODES
      *  THAT ENCOMPASS 2 DIFFERENT AREA CODES, THEN YOU COULD SET UP
      *  A ZONE WITH THE AREA CODE & THE 3 DIGIT PREFIX FOR THIS
      *  UNUSUAL SITUATION.
      *
      *  GET THE TIME ZONE:  FIRST TRY HOME PHONE, AREA CODE & PREFIX
      *                IF NO GOOD, TRY HOME PHONE, AREA CODE & 0 PREFIX
      *                IF NO GOOD, TRY EMP PHONE, AREA CODE & PREFIX
      *                IF NO GOOD, TRY EMP PHONE, AREA CODE & 0 PREFIX
      *                IF I-AM-UNITED & CELL PHONE NOT 2020,
      *                   TRY CELL PHONE, AREA CODE & PREFIX
      *                   IF NO GOOD, AREA CODE & 0 PREFIX
      *                IF NO GOOD, USE GP DEFAULT TIME ZONE
      *                IF ZONE IS DAYLIGHT SAVINGS SUBTRACT 1 IF NEEDED
      *******************************************************************
      *********************************************
       GET-TIME-ZONE SECTION.
      *********************************************
           MOVE 1 TO SUB.
           PERFORM GET-BORROWER.
       TRY-HOME-PHONE.
           MOVE BW-PHONE TO HOLD-PHONE.
           MOVE HOLD-AC TO TZ-CODE.
           MOVE HOLD-PREFIX TO TZ-PREFIX.
           PERFORM READ-TZ1-FILE.
           IF IO-FG NOT = 0
              MOVE HOLD-AC TO TZ-CODE
              MOVE 0 TO TZ-PREFIX
              PERFORM READ-TZ1-FILE.
           IF IO-FG NOT = 0
              MOVE BW-EMPPHONE TO HOLD-PHONE
              MOVE HOLD-AC TO TZ-CODE
              MOVE HOLD-PREFIX TO TZ-PREFIX
              PERFORM READ-TZ1-FILE.
           IF IO-FG NOT = 0
              MOVE HOLD-AC TO TZ-CODE
              MOVE 0 TO TZ-PREFIX
              PERFORM READ-TZ1-FILE.
           IF IO-FG NOT = 0
              MOVE GP-TIME-ZONE-FACTOR TO TZ-FACTOR
              MOVE GP-TIME-ZONE-DLS TO TZ-DLS
              MOVE "Y" TO AW-TIME-ZONE-ERROR.
           IF TZ-DLS = "Y"
              IF DLS-FG = "Y"
                 ADD 1 TO TZ-FACTOR.
           MOVE TZ-FACTOR TO AW-START-TIME.

       EXIT-GET-TIME-ZONE.
           EXIT.

      ********************************************************************
      *  FOR WORLD, KEY QUEUE BY RENEWABILITY BY HIGHEST AVAILABLE CREDIT
      *  IF ACCT DETERMINED TO BE RENEWABLE, KEY FIRST WITH REV-DEL OF 0
      *  IF ACCT DETERMINED NOT RENEWABLE, KEY LAST WITH REV-DEL OF 99999
      *  NEXT IN KEY IS REV-PDUE-DAYS, PUT IN INVERSE OF AVAIL CREDIT AMT
      ********************************************************************
      *********************************************
       CREATE-RENEWABILITY-KEY SECTION.
      *********************************************
           MOVE 0 TO AW-REV-DEL.
           IF SP-RENEWABLE-PAYS = 0
              IF SP-RENEWABLE-DAYS = 0
                 MOVE 99999 TO AW-REV-DEL
                 GO TO GET-AVAILABLE-CREDIT.
           MOVE LN-1STPYDATE TO PDTH-DATE-WORK.
           PERFORM PAID-THRU-CALCULATION.
           IF SP-RENEWABLE-PAYS = -1
              COMPUTE WK-RENEWABLE-PAYS = LN-ORGTERM / 3
              IF PDTH-PAYMENTS < WK-RENEWABLE-PAYS
                 MOVE 99999 TO AW-REV-DEL
                 GO TO GET-AVAILABLE-CREDIT
              END-IF
           ELSE
           IF PDTH-PAYMENTS < SP-RENEWABLE-PAYS
              MOVE 99999 TO AW-REV-DEL
              GO TO GET-AVAILABLE-CREDIT.
           MOVE LN-LOANDATE TO NUM-DATE.
           MOVE HOLD-DATE TO SYS-DATE.
           PERFORM TIM.
           IF SP-RENEWABLE-DAYS = -1
              COMPUTE WK-RENEWABLE-DAYS = (LN-ORGTERM / 3) * 30 + 1
              IF ELAPSED-DAYS < WK-RENEWABLE-DAYS
                 MOVE 99999 TO AW-REV-DEL
                 GO TO GET-AVAILABLE-CREDIT
              END-IF
           ELSE
           IF ELAPSED-DAYS < SP-RENEWABLE-DAYS
              MOVE 99999 TO AW-REV-DEL.

       GET-AVAILABLE-CREDIT.
           IF BR-AVAIL-CREDIT = "Y"
                     AND (LN-CREDITLIM NOT = 0)
                      AND (LN-BNKRPTDATE = 0)
              MOVE HOLD-DATE TO AVCR-PAYDATE
              MOVE LN-MAKERCD(1) TO AVCR-MAKERCD
              PERFORM COMPUTE-AVAILABLE-CREDIT
           ELSE
           IF BR-AVAIL-CREDIT = "S"
                     AND (LN-CREDITLIM NOT = 0)
                      AND (LN-BNKRPTDATE = 0)
              MOVE HOLD-DATE TO AVCR-PAYDATE
              MOVE LN-MAKERCD(1) TO AVCR-MAKERCD
              PERFORM COMPUTE-AVAILABLE-CREDIT
           ELSE
              MOVE 0 TO AVCR-AVAILCREDIT.

           SUBTRACT AVCR-AVAILCREDIT FROM 9999999.99
                                          GIVING AW-REV-PDUE-DAYS.

      *****************************************
       PURGE-CQ-RECORDS SECTION.
      *****************************************
           PERFORM OPEN-CQ1-FILE.

           MOVE BR-NO   TO CQ-BRNO
                           QCQ1-WBEG-BRNO
                           QCQ1-WEND-BRNO.
      *     MOVE 0       TO CQ-ACCTNO
      *                     QCQ1-WBEG-ACCTNO.
      *     MOVE ALL "9" TO QCQ1-WEND-ACCTNO.

           PERFORM START-CQ1-FILE.   *> SSP - CQ

       PURGE-CQ-NEXT.
           PERFORM READ-CQ1-FILE-NEXT.   *> SSP - CQ
           IF IO-BAD                     *> OR (CQ-BRNO NOT = CQ-PATH-OWNBR)
              GO TO END-PURGE-CQ.

      * SUMMARY
      *    IF CQ-TYPE = " "  
      *       GO TO DELETE-CQ-RECORD.

      * DETAIL
           IF CQ-WORKED-FG = "R"
              IF REMOVE-RESCHED-FG = "N"
                 GO TO PURGE-CQ-NEXT
              ELSE
                 MOVE "D" TO DATER-UNITPER-CD
                 MOVE 1   TO DATER-UNITPER-FREQ
                 MOVE EXTRDATE TO NDTE-DATE
                 COMPUTE NDTE-HOLD = RESCHED-DAYS * -1
                 PERFORM INCREMENT-UNITPER
                 IF NDTE-DATE NOT > CQ-DATE
                    GO TO PURGE-CQ-NEXT
                 ELSE
                    GO TO DELETE-CQ-RECORD.

           IF REMOVE-UNWORKED-FG = "N"
              IF CQ-WORKED-FG NOT = "Y"
                 GO TO PURGE-CQ-NEXT.

       DELETE-CQ-RECORD.
           PERFORM DELETE-CQ1-FILE.
           GO TO PURGE-CQ-NEXT.

       END-PURGE-CQ.
           PERFORM CLOSE-CQ1-FILE.

      ******************************************************
       PURGE-CQS-RECORDS SECTION. 
      *******************************************************

      * SUMMARY TOTAL RECORDS

      * CHANGED TO SIMPLE DELETE STATEMENT (FOR BRANCH) MB 12/2023
           PERFORM OPEN-CQS1-FILE.

           MOVE BR-NO   TO CQS-BRNO
                           QCQS1-WBEG-BRNO
                           QCQS1-WEND-BRNO.
      *     MOVE SPACES  TO CQS-COLLID
      *                     QCQS1-WBEG-COLLID.
      *     MOVE ALL "Z" TO QCQS1-WEND-COLLID.
      *     CALL "C$TOLOWER" USING QCQS1-WEND-COLLID, VALUE 3.

           PERFORM DELETE-CQS1-FILE-BRANCH-ALL.

           GO TO END-PURGE-CQS.

      *     PERFORM START-CQS1-FILE.
      *
      * PURGE-CQS-NEXT.
      *     PERFORM READ-CQS1-FILE-NEXT.
      *     IF IO-BAD OR (CQS-BRNO NOT = CQS-PATH-OWNBR)
      *        GO TO END-PURGE-CQS.
      *
      *    IF CQ-TYPE = " "     
      *       GO TO DELETE-CQ-RECORD.
      *
      * DELETE-CQS-RECORD.
      *     PERFORM DELETE-CQS1-FILE.
      *     GO TO PURGE-CQS-NEXT.
      *
       END-PURGE-CQS.
           PERFORM CLOSE-CQS1-FILE.


      *****************************************
       INITIALIZE-COLLECTOR-POOLS SECTION.
      * UPDATES  CP-COLLECTOR-COUNT AND CP-LAST-SUBSCRIPT
      *****************************************
           PERFORM OPEN-CP1-FILE.
      *     PERFORM OPEN-EA1-FILE.

      * CHANGED TO DRIVE FROM CP1 INSTEAD OF EA1 MB 12/2023
      *   STORED PROCEDURE JOINS FROM EAFILE TO CPFILE 
      *          ON CPFILE.CP_BRNO = EAFILE.EA_BRANCH
      *         AND CPFILE.CP_ID   = EAFILE.EA_COL_POOL
      *     MOVE BR-NO        TO EA-BRANCH
      *                          QEA1-WBEG-BRANCH
      *                          QEA1-WEND-BRANCH.                                
      *     MOVE BEG-CLASS    TO EA-CLASS
      *                          QEA1-WBEG-CLASS.
      *     MOVE END-CLASS    TO QEA1-WEND-CLASS.
      *     MOVE BEG-GROUP-ID TO EA-GROUP-ID
      *                          QEA1-WBEG-GROUP-ID
      *                          QEA1-WEND-GROUP-ID.
      *     MOVE 0            TO EA-SEQNO
      *                          QEA1-WBEG-SEQNO.
      *     MOVE ALL "9"      TO QEA1-WEND-SEQNO.
      *     PERFORM START-EA1-FILE.

           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE BR-NO  TO QCP1-WBEG-BRNO
           ELSE
              MOVE 0      TO QCP1-WBEG-BRNO.
           MOVE BEG-CLASS    TO PASS-BEG-CLASS.
           MOVE END-CLASS    TO PASS-END-CLASS.
           MOVE BEG-GROUP-ID TO PASS-GROUP-ID.

           PERFORM START-CP1-FILE.

       CLEAR-CP-NEXT.
      *     PERFORM READ-EA1-FILE-NEXT.
           PERFORM READ-CP1-FILE-NEXT.   *>  SSP  CP
           IF IO-BAD
              GO TO END-INITIALIZE-POOLS.

      *     IF EA-BRANCH NOT = BR-NO
      *        GO TO END-INITIALIZE-POOLS.
      *     IF EA-CLASS > END-CLASS
      *        OR EA-GROUP-ID NOT = BEG-GROUP-ID
      *           GO TO CLEAR-CP-NEXT.
      *     MOVE EA-COL-POOL TO CP-ID.
      *     PERFORM READ-CP1-FILE.
      *     IF IO-BAD
      *       UNLOCK CP-FILE
      *        GO TO CLEAR-CP-NEXT.

           MOVE 0 TO SUB COL-COUNT.

       COUNT-COL-LOOP.
           ADD 1 TO SUB.
           IF SUB > 80
              GO TO EXIT-CP-LOOP.
           IF CP-COL-ID(SUB) NOT = SPACES
              ADD 1 TO COL-COUNT
              GO TO COUNT-COL-LOOP.

       EXIT-CP-LOOP.
           MOVE COL-COUNT TO CP-COLLECTOR-COUNT.
           MOVE 0         TO CP-LAST-SUBSCRIPT.

      * ONLY UPDATES CP-COLLECTOR-COUNT AND CP-LAST SUBSCRIPT

           PERFORM REWRITE-CP1-FILE-INIT-CP. 

           GO TO CLEAR-CP-NEXT.

       END-INITIALIZE-POOLS.
      *     PERFORM CLOSE-EA1-FILE.
           PERFORM CLOSE-CP1-FILE.

      *****************************************
       PURGE-GQS-SUMMARY SECTION.
      *****************************************
      * SUMMARY GLOBAL QUEUE RECORDS
      * CHANGED TO SIMPLE DELETE STATMENT MB 12/2023

           MOVE SPACES  TO QGQS1-WBEG-COLLID.
           MOVE ALL "Z" TO QGQS1-WEND-COLLID.

           PERFORM DELETE-GQS1-FILE-ALL.

           GO TO EXIT-PURGE-GQS-SUMMARY.

      *    MOVE SPACES TO GQS1-KEY.
      *
      *    PERFORM START-GQS1-FILE.
      *
      *NEXT-GQS-SUMMARY.
      *    PERFORM READ-GQS1-FILE-NEXT.
      *    IF IO-BAD
      *       GO TO EXIT-PURGE-GQS-SUMMARY.
      *
      *    PERFORM DELETE-GQS1-FILE.
      *
      *    GO TO NEXT-GQS-SUMMARY.

       EXIT-PURGE-GQS-SUMMARY.
           EXIT.

      *****************************************
       PURGE-GQ-RECORDS SECTION.
      *****************************************
       SETUP-GQ-DETAIL-KEY.
           MOVE BR-NO   TO GQ-BRNO
                           QGQ1-WBEG-BRNO
                           QGQ1-WEND-BRNO.
      *     MOVE 0       TO GQ-ACCTNO
      *                     QGQ1-WBEG-ACCTNO.
      *     MOVE ALL "9" TO QGQ1-WEND-ACCTNO.

           PERFORM START-GQ1-FILE.   *> SSP - GQ

       PURGE-GQ-NEXT.
           PERFORM READ-GQ1-FILE-NEXT.   *> SSP - GQ
           IF IO-BAD
              GO TO END-PURGE-GQ.

           IF GQ-BRNO NOT = BR-NO
              GO TO END-PURGE-GQ.

           IF GQ-WORKED-FG = "R"
              IF REMOVE-RESCHED-FG = "N"
                 GO TO PURGE-GQ-NEXT
              ELSE
                 MOVE "D" TO DATER-UNITPER-CD
                 MOVE 1 TO DATER-UNITPER-FREQ
                 MOVE EXTRDATE TO NDTE-DATE
                 COMPUTE NDTE-HOLD = RESCHED-DAYS * -1
                 PERFORM INCREMENT-UNITPER
                 IF NDTE-DATE NOT > GQ-DATE
                    GO TO PURGE-GQ-NEXT
                 ELSE
                    GO TO DELETE-GQ-RECORD.

           IF REMOVE-UNWORKED-FG = "N"
              IF GQ-WORKED-FG NOT = "Y"
                 GO TO PURGE-GQ-NEXT.

       DELETE-GQ-RECORD.
           PERFORM DELETE-GQ1-FILE.
           GO TO PURGE-GQ-NEXT.

       END-PURGE-GQ.
           PERFORM CLOSE-GQ1-FILE.

       EXIT-PURGE-GQ.
           EXIT.

      * 12/19/00 - NOT SURE THIS IS COMPLETELY CORRECT.  THIS IS CLEARING
      * GLOBAL CPFILE, SO CHECK BEG-BRANCH & END-BRANCH IN READ-EA LOOP.
      * IF RUNNING BY GROUP, THIS WILL INCLUDE EA'S FROM ALL BRANCHES
      * WITH MATCHING GROUP.  IF THIS IS REALLY A PROBLEM, COULD ADD CHECK-
      * MEMBER TO THIS ROUTINE.  ALSO, GOOD CHANCE OF CLEARING SAME CP
      * MANY TIMES, BUT CAN'T COME UP WITH A GOOD CHECK TO STOP THIS,
      * BUT IT SHOULDN'T HURT, JUST SOME EXTRA IO.  FOR THIS GLOBAL
      * CLEAR I CONSIDERED JUST LOOPING THROUGH THE ENTIRE GLOBAL CPFILE
      * BUT TECHNICALLY SOMEONE COULD BE RUNNING ANOTHER GLOBAL RUN AT
      * THE SAME TIME.....                             BARB
      *****************************************
       GLOBAL-INIT-COLLECTOR-POOLS SECTION.
      *****************************************

      * NEED TO SET CP-GLOBAL-PATH HERE (CP-PATH-OVERRIDE EQUALS "G")
      * BECAUSE THIS IS EXECUTED PRIOR TO THE STANDARD BRANCH/GROUP
      * LOGIC BEING DONE.  SET AGAIN IN BRANCH/GROUP LOGIC.
      
           MOVE EXT-FILPATH-BASE           TO CP-GLOBAL-BASE.
           MOVE EXT-FILPATH-MACHINE        TO CP-GLOBAL-MACHINE.
           MOVE "G"                        TO CP-PATH-OVERRIDE.
           MOVE CP-GLOBAL-PATH             TO CP-PATH.

           PERFORM OPEN-CP1-FILE.

           MOVE BEG-BRANCH   TO EA-BRANCH
                                QEA1-WBEG-BRANCH.
           MOVE END-BRANCH   TO QEA1-WEND-BRANCH.
           MOVE BEG-CLASS    TO EA-CLASS
                                QEA1-WBEG-CLASS.
           MOVE END-CLASS    TO QEA1-WEND-CLASS.
           MOVE BEG-GROUP-ID TO EA-GROUP-ID
                                QEA1-WBEG-GROUP-ID
                                QEA1-WEND-GROUP-ID.
           MOVE 0            TO EA-SEQNO
                                QEA1-WBEG-SEQNO.
           MOVE ALL "9"      TO QEA1-WEND-SEQNO.

           PERFORM START-EA1-FILE.

       GLOBAL-CLEAR-CP-NEXT.
           PERFORM READ-EA1-FILE-NEXT.
           IF IO-BAD
              GO TO GLOBAL-END-INITIALIZE-POOLS.

           IF EA-BRANCH > END-BRANCH
              GO TO GLOBAL-END-INITIALIZE-POOLS.
           IF EA-CLASS > END-CLASS
              OR EA-GROUP-ID NOT = BEG-GROUP-ID
                 GO TO GLOBAL-CLEAR-CP-NEXT.

           MOVE EA-COL-POOL TO CP-ID.
           PERFORM READ-CP1-FILE.   *>  EMBEDDED CP
           IF IO-BAD
      *       UNLOCK CP-FILE
              GO TO GLOBAL-CLEAR-CP-NEXT.
           MOVE 0 TO SUB COL-COUNT.

       GLOBAL-COUNT-COL-LOOP.
           ADD 1 TO SUB.
           IF SUB > 80
              GO TO GLOBAL-EXIT-CP-LOOP.
           IF CP-COL-ID(SUB) NOT = SPACES
              ADD 1 TO COL-COUNT
              GO TO GLOBAL-COUNT-COL-LOOP.

       GLOBAL-EXIT-CP-LOOP.
           MOVE COL-COUNT TO CP-COLLECTOR-COUNT.
           MOVE 0 TO CP-LAST-SUBSCRIPT.
           MOVE 0 TO CP-TOTAL-ACCOUNTS.
           PERFORM REWRITE-CP1-FILE.
           GO TO GLOBAL-CLEAR-CP-NEXT.

       GLOBAL-END-INITIALIZE-POOLS.
           PERFORM CLOSE-CP1-FILE.

      *****************************************
       CREATE-CQS-RECORD SECTION.
      *****************************************
           MOVE "Y" TO FIRST-TIME-CQ.

           MOVE 0 TO TOTAL-CQS-RECS TOTAL-CQS-TIMED.

           PERFORM OPEN-CQ1-FILE.
           PERFORM OPEN-CQS1-FILE.

           MOVE CQ-PATH-OWNBR TO CQ-BRNO.
           MOVE SPACES        TO CQ-COLLID CQ-SEQ-FG CQ-MISC-KEY-FLD.
           MOVE 19000101      TO CQ-DATE.
           MOVE 0             TO CQ-START-TIME CQ-REV-DEL
                                 CQ-REV-PDUE-DAYS CQ-REV-BAL CQ-SEQ
                                 CQ-REV-BEHAVIOR-RISK.

           PERFORM START-CQ2-FILE.

       GET-NEXT-CQ.
           PERFORM READ-CQ2-FILE-NEXT.
           IF IO-BAD OR (CQ-BRNO NOT = CQ-PATH-OWNBR)
              PERFORM WRITE-CQS-RECORD
              PERFORM CLOSE-CQ1-FILE
              PERFORM CLOSE-CQS1-FILE
              GO TO END-CREATE-CQS-RECORD.

           IF FIRST-TIME-CQ = "Y"
              PERFORM SAVE-CQ2-KEY
              MOVE "N" TO FIRST-TIME-CQ.

           IF CQ-COLLID NOT = SPWSCQ-CQ2-COLLID
      * CANT SAVE THIS HERE BECAUSE WE NEED THE PRIOR COLLID
      *       PERFORM SAVE-CQ2-KEY  
              PERFORM WRITE-CQS-RECORD
              GO TO GET-NEXT-CQ.

           ADD 1 TO TOTAL-CQS-RECS.

      * 8/17/00 - IF QUEUE ORDERED BY TIME ZONE, CQ-START-TIME MAY
      *           NOW CONTAIN TIME ZONE FACTOR, SO A LOW VALUE IS
      *           JUST A NORMAL RECORD, HIGHER VALUE IS A RESCHEDULE

           IF CQ-START-TIME > 24
              ADD 1 TO TOTAL-CQS-TIMED.

           GO TO GET-NEXT-CQ.

       END-CREATE-CQS-RECORD.
           EXIT.

      *****************************************
       WRITE-CQS-RECORD SECTION.
      *****************************************
           IF TOTAL-CQS-RECS = 0
              GO TO EXIT-WRITE-CQS-RECORD.

           MOVE SPWSCQ-CQ2-COLLID TO SAVE-COLLID.
           PERFORM SAVE-CQ2-KEY.

           MOVE SPACES      TO CQS-REC.

           MOVE BR-NO       TO CQS-BRNO   CQS-CQ-BRNO.
           MOVE SAVE-COLLID TO CQS-COLLID CQS-CQ-COLLID.

           MOVE 0 TO CQS-CQ-REV-BEHAVIOR-RISK CQS-CQ-DATE
                     CQS-CQ-START-TIME
                     CQS-CQ-REV-DEL CQS-CQ-REV-PDUE-DAYS CQS-CQ-REV-BAL
                     CQS-WORKED-REC CQS-CQ-SEQ.

           MOVE TOTAL-CQS-RECS  TO CQS-TOT-REC.
           MOVE TOTAL-CQS-TIMED TO CQS-TIMED-REC.
           PERFORM WRITE-CQS1-FILE.
           IF IO-BAD
              GO TO IO-ERROR.

           MOVE 0 TO TOTAL-CQS-RECS TOTAL-CQS-TIMED.

           PERFORM LOAD-CQ2-KEY.
           IF CQ-DATE = 0
              MOVE 19000101 TO CQ-DATE.

           IF CQ-COLLID = "BK"
              MOVE SPACES TO MESS.

           PERFORM START-CQ2-FILE.

       EXIT-WRITE-CQS-RECORD.
           EXIT.

      *****************************************
       CREATE-GQS-RECORD SECTION.  
      *****************************************
           MOVE "Y" TO GQ-FIRST-TIME.

           PERFORM OPEN-GQS1-FILE.
           PERFORM OPEN-VGQ1-FILE.

           MOVE 0 TO TOTAL-GQS-RECS TOTAL-GQS-TIMED.

           MOVE SPACES   TO VGQ-COLLID VGQ-MISC-KEY-FLD VGQ-SEQ-FG.
           MOVE 19000101 TO VGQ-DATE.
           MOVE 0        TO VGQ-START-TIME VGQ-REV-DEL
                            VGQ-REV-PDUE-DAYS VGQ-REV-BAL 
                            VGQ-SEQ.
           PERFORM START-VGQ1-FILE.

       GET-NEXT-GQ.
           PERFORM READ-VGQ1-FILE-NEXT.

           IF IO-BAD
              PERFORM WRITE-GQS-RECORD      
              GO TO END-CREATE-GQS-RECORD.

           MOVE VGQ-GQ-REC TO GQ-REC.

           IF GQ-FIRST-TIME = "Y"
              PERFORM SAVE-GQ2-KEY
              MOVE "N" TO GQ-FIRST-TIME.

           IF GQ-COLLID NOT = SPWSGQ-GQ2-COLLID
              PERFORM WRITE-GQS-RECORD     
              GO TO GET-NEXT-GQ.

           ADD 1 TO TOTAL-GQS-RECS.
      * 8/17/00 - IF QUEUE ORDERED BY TIME ZONE, GQ-START-TIME MAY
      *           NOW CONTAIN TIME ZONE FACTOR, SO A LOW VALUE IS
      *           JUST A NORMAL RECORD, HIGHER VALUE IS A RESCHEDULE
           IF GQ-START-TIME > 24
              ADD 1 TO TOTAL-GQS-TIMED.
           GO TO GET-NEXT-GQ.

       END-CREATE-GQS-RECORD.
           PERFORM CLOSE-VGQ1-FILE.
           PERFORM CLOSE-GQS1-FILE.

      *****************************************
       WRITE-GQS-RECORD SECTION.
      *****************************************
           IF TOTAL-GQS-RECS = 0
              GO TO EXIT-WRITE-GQS-RECORD.

           MOVE SPWSGQ-GQ2-COLLID TO SAVE-COLLID.
           PERFORM SAVE-GQ2-KEY.

           MOVE SPACES TO GQS-REC.
           MOVE SAVE-COLLID TO GQS-COLLID GQ-COLLID.
           MOVE 0 TO GQS-GQ-DATE GQS-GQ-START-TIME
                      GQS-GQ-REV-DEL GQS-GQ-REV-PDUE-DAYS
                      GQS-GQ-REV-BAL GQS-WORKED-REC  GQS-GQ-SEQ.

           MOVE TOTAL-GQS-RECS  TO GQS-TOT-REC.
           MOVE TOTAL-GQS-TIMED TO GQS-TIMED-REC.
           PERFORM WRITE-GQS1-FILE.
           IF IO-BAD
              GO TO IO-ERROR.

           MOVE 0 TO TOTAL-GQS-RECS TOTAL-GQS-TIMED.

       RESTART-GQ.
      *    PERFORM LOAD-GQ2-KEY.
      *    IF GQ-DATE = 0
      *       MOVE 19000101 TO GQ-DATE.
      *
      *    PERFORM START-GQ2-FILE.

       EXIT-WRITE-GQS-RECORD.
           EXIT.

      *****************************************
       CODE-SCAN SECTION.
      *****************************************
           MOVE "EA"       TO CDSCAN-TYPE.
           MOVE SPACES     TO CDSCAN-CODE.
           MOVE "Y"        TO CDSCAN-EA-CQ-FG.
           MOVE "WI/CDSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CDSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF CDSCAN-STATUS NOT = "00" OR CDSCAN-CODE = SPACES
               MOVE 9 TO IO-FG
               GO TO EXIT-CODE-SCAN.

           MOVE "S  A060GROUP-ID." TO VDU
           MOVE CDSCAN-CODE       TO VDUBUF
           PERFORM SCREENIO.

           MOVE CDSCAN-CODE TO VDUBUF.
           MOVE 0           TO IO-FG.

       EXIT-CODE-SCAN.
           EXIT.

      *****************************************
       LOAD-EXTRACTION-TABLE SECTION.
      * LOAD ALL EXTRACTION ACTIONS FOR BRANCH INTO WS-EAFILE-TBL ON BRANCH BREAK
      *****************************************

           MOVE BR-NO        TO EA-BRANCH 
                                QEA1-WBEG-BRANCH 
                                QEA1-WEND-BRANCH.
           MOVE BEG-CLASS    TO EA-CLASS
                                QEA1-WBEG-CLASS.
           MOVE END-CLASS    TO QEA1-WEND-CLASS.
           MOVE BEG-GROUP-ID TO EA-GROUP-ID
                                QEA1-WBEG-GROUP-ID
                                QEA1-WEND-GROUP-ID.
           MOVE 0            TO EA-SEQNO
                                QEA1-WBEG-SEQNO.
           MOVE ALL "9"      TO QEA1-WEND-SEQNO.

           PERFORM START-EA1-FILE.
           MOVE 0 TO IO-FG.
           PERFORM UNTIL IO-BAD
              PERFORM READ-EA1-FILE-NEXT
              IF IO-GOOD
                ADD 1         TO WS-EAFILE-ROW-CTR
                MOVE EA-CLASS TO WS-EAFILE-TBL-CLASS(WS-EAFILE-ROW-CTR)
                MOVE EA-REC   TO WS-EAFILE-TBL-REC(WS-EAFILE-ROW-CTR)
              END-IF
           END-PERFORM.

           PERFORM CLOSE-EA1-FILE.

       LOAD-EXTRACTION-TABLE-EXIT.
           EXIT.

      ******************************************************************
      *
      *    C O P Y - L I B R A R Y - S E C T I O N S
      *
      ******************************************************************
       COPY "LIBLP/LPCPUPD.CPY".
       COPY "LIBLP/LPRATE.CPY".
       COPY "LIBLP/LPPDUE.CPY".
       COPY "LIBLP/LPCDEL.CPY".
       COPY "LIBLP/LPTDEL.CPY".
       COPY "LIBGB/SPPDTH.CPY".
       COPY "LIBGB/GPENV.CPY".
       COPY "LIBLP/LPSCHD.CPY".
       COPY "LIBLP/LPLCAS.CPY".
       COPY "LIBLP/LPLCHG.CPY".
       COPY "LIBLP/LPLCAP.CPY".
       COPY "LIBLP/DEFPOL.CPY".
       COPY "LIBLP/LPPOFF.CPY".
       COPY "LIBLP/LPPOF2.CPY".
       COPY "LIBLP/LPITRM.CPY".
       COPY "LIBLP/LPAVCR.CPY".
       COPY "LIBGB/REBATE.CPY".
       COPY "LIBLP/LPAPRS.CPY".
       COPY "LIBLP/LPAPRZ.CPY".
       COPY "LIBLP/LPUPER.CPY".
       COPY "LIBLP/LPMDTE.CPY".
       COPY "LIBLP/LPXDTE.CPY".
       COPY "LIBLP/LPIBPC.CPY".
       COPY "LIBLP/LPAMTS.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBLP/SETCTBL.CPY".
       COPY "LIBGB/AGEING.CPY".
       COPY "LIBLP/LPUPWK.CPY".
       COPY "LIBLP/LPCEPP.CPY".
       COPY "LIBLP/LPFMCL.CPY".
       COPY "LIBSP/SPGQCL.CPY".
       COPY "LIBSP/SPCQCL.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBGB/RBACT.CPY".
       COPY "LIBLP/ADDONSPR.CPY".
       COPY "LIBGB/GRWORK.CPY".
       COPY "LIBGB/GRSERCH.CPY".
       COPY "LIBGB/BRSECURE.CPY".
       COPY "LIBGB/GETDLS.CPY".

       COPY "LIBLP/ARRAYSP.CPY".
       COPY "LIBSP/SPFRVGQ.CPY".

      *********************************************************
       FORM-RESET SECTION.
      *********************************************************
           MOVE EXT-CONAME-CONAME TO CQRUN-CONAME.
           MOVE EXT-CONAME-SYSDATE TO CQRUN-SYSDATE.
           DISPLAY CQRUN-SCREEN UPON EXT-EOBUF-WINDOW-HANDLE.
           MOVE CQRUN-FORM-FIELDS TO WR-BUF.
           MOVE CQRUN-FORM-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       FORM-RESET-EXIT.
           EXIT.

      *********************************************************
       SETUP-LINK-INFO SECTION.
      *********************************************************
           MOVE CQRUN-HELP--FILE TO HELP-LINK-FILE.
           MOVE CQRUN-HELP--DIR  TO HELP-LINK-DIR.

      *********************************************************
       VDU-CONVERT-FIELD SECTION.
      *********************************************************
           MOVE "00" TO STAT.
           MOVE VDU-FIELD-TO-CONVERT TO VDU-ALP-FIELD.
           EVALUATE TRUE
              COPY "LIBLP/CQRUN_EVA.CPY".
              WHEN OTHER       MOVE   "2A" TO STAT
           END-EVALUATE.

      *********************************************************
       MISC-ROUTINES SECTION.
      *********************************************************
       COPY "LIBGB/MKTEMP.CPY".
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/GETENV.CPY".
       COPY "LIBGB/GETPR.CPY".
       COPY "LIBGB/RMFILE.CPY".

       READ-SP-RECORD.
           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.
           IF SP1-KEY NOT = LPWSSP-SP1-KEY
      *        PERFORM READ-SP1-FILE
              PERFORM ARRAYSP-READ
              IF IO-BAD
                 PERFORM FILE-ERRORS
                 PERFORM SEND-MESS
                 MOVE SPACES TO LPWSSP-SP1-KEY
                 MOVE "NL" TO RTN-FG
              ELSE
                 MOVE SP1-KEY TO LPWSSP-SP1-KEY.

      *=================================================================
      *GET-MAKER.
      *    MOVE 0 TO IO-FG.
      *
      *    IF LN-SSNO(1) NOT = HOLD-BW-SSNO
      *       MOVE LN-SSNO(1) TO BW-SSNO HOLD-BW-SSNO
      *       PERFORM READ-BW1-FILE
      *       IF IO-BAD
      *          MOVE ZEROES TO BW-SCORE-TABLE
      *          MOVE SPACES TO BW-ZIP
      *          MOVE "A" TO BW-LNAME.
      *
      *-----------------------------------------------------------------
       GET-BORROWER.

           MOVE LN-SSNO(SUB) TO BW-SSNO.
           PERFORM READ-BW1-FILE.
           IF IO-BAD
              MOVE SPACES TO BW-ZIP
              MOVE ZEROES TO BW-SCORE-TABLE
              MOVE 0 TO BW-PHONE BW-EMPPHONE BW-CELL-PHONE.

      ******************************************************************
       IO-ROUTINE SECTION.
      ******************************************************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBSP/SPGQSGS_SQL.CPY".
       COPY "LIBSP/SPGQGS_SQL.CPY".
       COPY "LIBSP/SPCQSGS_SQL.CPY".
       COPY "LIBSP/SPCQGS_SQL.CPY".
       COPY "LIBSP/SPCPGS_SQL.CPY".
       COPY "LIBSP/SPVGQ1IN.CPY".
       COPY "LIBLP/LPTZGS_SQL.CPY".
       COPY "LIBLP/LPSPGS_SQL.CPY".
       COPY "LIBLP/LPLTPGS_SQL.CPY".
       COPY "LIBLP/LPLTIGS_SQL.CPY".
       COPY "LIBLP/LPLPGS_SQL.CPY".
       COPY "LIBLP/LPLNGS_SQL.CPY".
       COPY "LIBLP/LPFMGS_SQL.CPY".
       COPY "LIBLP/LPFDGS_SQL.CPY".
       COPY "LIBLP/LPEAGS_SQL.CPY".
       COPY "LIBLP/LPCDGS_SQL.CPY".
       COPY "LIBLP/LPBWGS_SQL.CPY".
       COPY "LIBGB/GBGRGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBGB/GBGBGS_SQL.CPY".
       COPY "LIBGB/GBGR1RN.CPY".
       COPY "LIBGB/GBPRINT.CPY".

      * COPY "LIBLP/LPLN3RN.CPY".
      * COPYMEMBER: LIBLP/LPLN3RN
      *-----------------------------------------------------------------
      *    STILL NEED TO LOAD THE FILE PATH WORKERS
      *-----------------------------------------------------------------
       LOAD-LN3-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LN-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LN-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LN-ALL-BASE
              MOVE FILPATH-MACHINE         TO LN-ALL-MACHINE
              MOVE FILPATH-DATA            TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH.

      *-----------------------------------------------------------------
       OPEN-LN3-FILE.
           PERFORM LOAD-LN3-FILE.
           PERFORM OPEN-IT.
           MOVE LN-PATH-SQL TO E-FILE.

           IF LN3-CONN-OPEN-SW = "N" 
               EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS LN3_CONNECT
                    USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
               END-EXEC
               MOVE "Y" TO LN3-CONN-OPEN-SW
               EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-LN3-FILE.   *> SSP - LN, BW 
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

           IF ( LN3-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LN3-FILE.

      * SELECT     LNFILE.LN_OWNBR,
      *            LNFILE.LN_ACCTNO,
      *            LNFILE.LN_CLASS,
      *            LNFILE.LN_SUBCLASS,
      *            LNFILE.LN_LAWCODE,
      *            LNFILE.LN_SSNO1,
      *            LNFILE.LN_MAKERCD1,
      *            LNFILE.LN_SSNO2,
      *            LNFILE.LN_MAKERCD2,
      *            LNFILE.LN_SSNO3,
      *            LNFILE.LN_MAKERCD3,
      *            LNFILE.LN_SSNO4,
      *            LNFILE.LN_MAKERCD4,
      *            LNFILE.LN_ORGST,
      *            LNFILE.LN_ORGBR,
      *            LNFILE.LN_OWNST,
      *            LNFILE.LN_SPRCLASS,
      *            LNFILE.LN_CONVERCD,
      *            LNFILE.LN_MIDSTREAM,
      *            LNFILE.LN_PURCD,
      *            LNFILE.LN_SRCD,
      *            LNFILE.LN_COLLCD,
      *            LNFILE.LN_COLLID,
      *            LNFILE.LN_POCD,
      *            LNFILE.LN_PLCD,
      *            LNFILE.LN_PLTYPE,
      *            LNFILE.LN_CONFIDENTCD,
      *            LNFILE.LN_ALLOTCD,
      *            LNFILE.LN_RECASTCD,
      *            LNFILE.LN_SKIP_TRW,
      *            LNFILE.LN_STATUSFG,
      *            LNFILE.LN_SMALLOAN,
      *            LNFILE.LN_SALEFIN,
      *            LNFILE.LN_SERVACCT,
      *            LNFILE.LN_LOANTYPE,
      *            LNFILE.LN_ADDON_FG,
      *            LNFILE.LN_PAY_SCHLD_FG,
      *            LNFILE.LN_LC_CODE,
      *            LNFILE.LN_CAN_LOAN_NO,
      *            LNFILE.LN_STATFLAGS,
      *            CAST(LNFILE.LN_ENTDATE  AS VARCHAR(10)) AS LN_ENTDATE,
      *            CAST(LNFILE.LN_LOANDATE AS VARCHAR(10)) AS LN_LOANDATE,
      *            CAST(LNFILE.LN_PURDATE  AS VARCHAR(10)) AS LN_PURDATE,
      *            CAST(LNFILE.LN_INTDATE  AS VARCHAR(10)) AS LN_INTDATE,
      *            CAST(LNFILE.LN_CASHDATE AS VARCHAR(10)) AS LN_CASHDATE,
      *            CAST(LNFILE.LN_FILEDATE AS VARCHAR(10)) AS LN_FILEDATE,
      *            CAST(LNFILE.LN_RESCISSION_DATE    AS VARCHAR(10)) AS LN_RESCISSION_DATE,
      *            CAST(LNFILE.LN_PART_RECOURSE_DATE AS VARCHAR(10)) AS LN_PART_RECOURSE_DATE,
      *            CAST(LNFILE.LN_ORIG_1STPYDATE     AS VARCHAR(10)) AS LN_ORIG_1STPYDATE,
      *            CAST(LNFILE.LN_1STPYDATE          AS VARCHAR(10)) AS LN_1STPYDATE,
      *            CAST(LNFILE.LN_JDDATE             AS VARCHAR(10)) AS LN_JDDATE,
      *            CAST(LNFILE.LN_PLDATE             AS VARCHAR(10)) AS LN_PLDATE,
      *            CAST(LNFILE.LN_PL_TRDATE          AS VARCHAR(10)) AS LN_PL_TRDATE,
      *            CAST(LNFILE.LN_ACCELDATE          AS VARCHAR(10)) AS LN_ACCELDATE,
      *            CAST(LNFILE.LN_REDUDATE           AS VARCHAR(10)) AS LN_REDUDATE,
      *            CAST(LNFILE.LN_POFFDATE           AS VARCHAR(10)) AS LN_POFFDATE,
      *            CAST(LNFILE.LN_PO_TRDATE          AS VARCHAR(10)) AS LN_PO_TRDATE,
      *            CAST(LNFILE.LN_LEGALDATE          AS VARCHAR(10)) AS LN_LEGALDATE,
      *            CAST(LNFILE.LN_BNKRPTDATE         AS VARCHAR(10)) AS LN_BNKRPTDATE,
      *            CAST(LNFILE.LN_BNKRPT_DISMISS_DATE   AS VARCHAR(10)) AS LN_BNKRPT_DISMISS_DATE,
      *            CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE AS VARCHAR(10)) AS LN_BNKRPT_DISCHARGE_DATE,
      *            CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE  AS VARCHAR(10)) AS LN_BNKRPT_REAFFIRM_DATE,
      *            CAST(LNFILE.LN_DEBTAIDATE            AS VARCHAR(10)) AS LN_DEBTAIDATE,
      *            CAST(LNFILE.LN_REPODATE              AS VARCHAR(10)) AS LN_REPODATE,
      *            CAST(LNFILE.LN_REDEEMDATE            AS VARCHAR(10)) AS LN_REDEEMDATE,
      *            CAST(LNFILE.LN_SOLDDATE              AS VARCHAR(10)) AS LN_SOLDDATE,
      *            CAST(LNFILE.LN_INS_CONFIRM_DATE      AS VARCHAR(10)) AS LN_INS_CONFIRM_DATE,
      *            CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE   AS VARCHAR(10)) AS LN_PRIOR_RN_FOR10_DATE,
      *            CAST(LNFILE.LN_LAST_RN_FOR10_DATE    AS VARCHAR(10)) AS LN_LAST_RN_FOR10_DATE,
      *            CAST(LNFILE.LN_TRW_DOFD_DATE         AS VARCHAR(10)) AS LN_TRW_DOFD_DATE,
      *            CAST(LNFILE.LN_LAST_PYPA_DATE        AS VARCHAR(10)) AS LN_LAST_PYPA_DATE,
      *            CAST(LNFILE.LN_BT_TRDATE             AS VARCHAR(10)) AS LN_BT_TRDATE,
      *            CAST(LNFILE.LN_METRO2_LAST_PMT_DATE  AS VARCHAR(10)) AS LN_METRO2_LAST_PMT_DATE,
      *            CAST(LNFILE.LN_FOLLOWUP_DATE         AS VARCHAR(10)) AS LN_FOLLOWUP_DATE,
      *            CAST(LNFILE.LN_LAST_ACCRUAL_DATE     AS VARCHAR(10)) AS LN_LAST_ACCRUAL_DATE,
      *            LNFILE.LN_APRATE,
      *            LNFILE.LN_EFFRATE,
      *            LNFILE.LN_SMPRATE,
      *            LNFILE.LN_YLDRATE,
      *            LNFILE.LN_OVRDRATE,
      *            LNFILE.LN_ENDORATE,
      *            LNFILE.LN_JDRATE,
      *            LNFILE.LN_ACCRATE,
      *            LNFILE.LN_REDURATE,
      *            LNFILE.LN_CONRATE,
      *            LNFILE.LN_SERVPER,
      *            LNFILE.LN_SELLPR,
      *            LNFILE.LN_DOWNPY,
      *            LNFILE.LN_TRADEIN,
      *            LNFILE.LN_LNAMT,
      *            LNFILE.LN_FINCHG,
      *            LNFILE.LN_INTCHG,
      *            LNFILE.LN_SERCHG,
      *            LNFILE.LN_EXTCHG,
      *            LNFILE.LN_MAINTFEE,
      *            LNFILE.LN_POINTS,
      *            LNFILE.LN_PROCEEDS,
      *            LNFILE.LN_ORGTERM,
      *            LNFILE.LN_1STPYAMT,
      *            LNFILE.LN_NOREGPY,
      *            LNFILE.LN_REGPYAMT,
      *            LNFILE.LN_LASTPYAMT,
      *            LNFILE.LN_PROCASH,
      *            LNFILE.LN_TILLNO,
      *            LNFILE.LN_STATE_FLAG,
      *            LNFILE.LN_STATE_WORKER,
      *            LNFILE.LN_STATE_WORKER2,
      *            LNFILE.LN_FEECODE_1,
      *            LNFILE.LN_FEEAMT_1,
      *            LNFILE.LN_FEEOURS_1,
      *            LNFILE.LN_FEEFINCHG_1,
      *            LNFILE.LN_FEECODE_2,
      *            LNFILE.LN_FEEAMT_2,
      *            LNFILE.LN_FEEOURS_2,
      *            LNFILE.LN_FEEFINCHG_2,
      *            LNFILE.LN_FEECODE_3,
      *            LNFILE.LN_FEEAMT_3,
      *            LNFILE.LN_FEEOURS_3,
      *            LNFILE.LN_FEEFINCHG_3,
      *            LNFILE.LN_FEECODE_4,
      *            LNFILE.LN_FEEAMT_4,
      *            LNFILE.LN_FEEOURS_4,
      *            LNFILE.LN_FEEFINCHG_4,
      *            LNFILE.LN_FEECODE_5,
      *            LNFILE.LN_FEEAMT_5,
      *            LNFILE.LN_FEEOURS_5,
      *            LNFILE.LN_FEEFINCHG_5,
      *            LNFILE.LN_FEECODE_6,
      *            LNFILE.LN_FEEAMT_6,
      *            LNFILE.LN_FEEOURS_6,
      *            LNFILE.LN_FEEFINCHG_6,
      *            LNFILE.LN_FEECODE_7,
      *            LNFILE.LN_FEEAMT_7,
      *            LNFILE.LN_FEEOURS_7,
      *            LNFILE.LN_FEEFINCHG_7,
      *            LNFILE.LN_FEECODE_8,
      *            LNFILE.LN_FEEAMT_8,
      *            LNFILE.LN_FEEOURS_8,
      *            LNFILE.LN_FEEFINCHG_8,
      *            LNFILE.LN_FEECODE_9,
      *            LNFILE.LN_FEEAMT_9,
      *            LNFILE.LN_FEEOURS_9,
      *            LNFILE.LN_FEEFINCHG_9,
      *            LNFILE.LN_FEECODE_10,
      *            LNFILE.LN_FEEAMT_10,
      *            LNFILE.LN_FEEOURS_10,
      *            LNFILE.LN_FEEFINCHG_10,
      *            LNFILE.LN_FEECODE_11,
      *            LNFILE.LN_FEEAMT_11,
      *            LNFILE.LN_FEEOURS_11,
      *            LNFILE.LN_FEEFINCHG_11,
      *            LNFILE.LN_FEECODE_12,
      *            LNFILE.LN_FEEAMT_12,
      *            LNFILE.LN_FEEOURS_12,
      *            LNFILE.LN_FEEFINCHG_12,
      *            LNFILE.LN_FEECODE_13,
      *            LNFILE.LN_FEEAMT_13,
      *            LNFILE.LN_FEEOURS_13,
      *            LNFILE.LN_FEEFINCHG_13,
      *            LNFILE.LN_FEECODE_14,
      *            LNFILE.LN_FEEAMT_14,
      *            LNFILE.LN_FEEOURS_14,
      *            LNFILE.LN_FEEFINCHG_14,
      *            LNFILE.LN_FEECODE_15,
      *            LNFILE.LN_FEEAMT_15,
      *            LNFILE.LN_FEEOURS_15,
      *            LNFILE.LN_FEEFINCHG_15,
      *            LNFILE.LN_FEECODE_16,
      *            LNFILE.LN_FEEAMT_16,
      *            LNFILE.LN_FEEOURS_16,
      *            LNFILE.LN_FEEFINCHG_16,
      *            LNFILE.LN_FEECODE_17,
      *            LNFILE.LN_FEEAMT_17,
      *            LNFILE.LN_FEEOURS_17,
      *            LNFILE.LN_FEEFINCHG_17,
      *            LNFILE.LN_FEECODE_18,
      *            LNFILE.LN_FEEAMT_18,
      *            LNFILE.LN_FEEOURS_18,
      *            LNFILE.LN_FEEFINCHG_18,
      *            LNFILE.LN_FEECODE_19,
      *            LNFILE.LN_FEEAMT_19,
      *            LNFILE.LN_FEEOURS_19,
      *            LNFILE.LN_FEEFINCHG_19,
      *            LNFILE.LN_FEECODE_20,
      *            LNFILE.LN_FEEAMT_20,
      *            LNFILE.LN_FEEOURS_20,
      *            LNFILE.LN_FEEFINCHG_20,
      *            LNFILE.LN_INSURED,
      *            LNFILE.LN_INSTYPES,
      *            LNFILE.LN_INSELIGIBLE,
      *            LNFILE.LN_INSCOMP_1,
      *            LNFILE.LN_INSOURS_1,
      *            CAST(LNFILE.LN_INSEFF_DATE_1 AS VARCHAR(10)) AS LN_INSEFF_DATE_1,
      *            CAST(LNFILE.LN_INSEXP_DATE_1 AS VARCHAR(10)) AS LN_INSEXP_DATE_1,
      *            LNFILE.LN_INSPREM_1,
      *            LNFILE.LN_INSCOVR_1,
      *            LNFILE.LN_INSCOMM_1,
      *            LNFILE.LN_INSANTICERN_1,
      *            LNFILE.LN_INSANTICADJ_1,
      *            LNFILE.LN_INSUFERN_1,
      *            LNFILE.LN_INSACCERN_1,
      *            LNFILE.LN_INSEARN_ORDER_1,
      *            LNFILE.LN_INSFINCHG_1,
      *            LNFILE.LN_INSCOMP_2,
      *            LNFILE.LN_INSOURS_2,
      *            CAST(LNFILE.LN_INSEFF_DATE_2 AS VARCHAR(10)) AS LN_INSEFF_DATE_2,
      *            CAST(LNFILE.LN_INSEXP_DATE_2 AS VARCHAR(10)) AS LN_INSEXP_DATE_2,
      *            LNFILE.LN_INSPREM_2,
      *            LNFILE.LN_INSCOVR_2,
      *            LNFILE.LN_INSCOMM_2,
      *            LNFILE.LN_INSANTICERN_2,
      *            LNFILE.LN_INSANTICADJ_2,
      *            LNFILE.LN_INSUFERN_2,
      *            LNFILE.LN_INSACCERN_2,
      *            LNFILE.LN_INSEARN_ORDER_2,
      *            LNFILE.LN_INSFINCHG_2,
      *            LNFILE.LN_INSCOMP_3,
      *            LNFILE.LN_INSOURS_3,
      *            CAST(LNFILE.LN_INSEFF_DATE_3 AS VARCHAR(10)) AS LN_INSEFF_DATE_3,
      *            CAST(LNFILE.LN_INSEXP_DATE_3 AS VARCHAR(10)) AS LN_INSEXP_DATE_3,
      *            LNFILE.LN_INSPREM_3,
      *            LNFILE.LN_INSCOVR_3,
      *            LNFILE.LN_INSCOMM_3,
      *            LNFILE.LN_INSANTICERN_3,
      *            LNFILE.LN_INSANTICADJ_3,
      *            LNFILE.LN_INSUFERN_3,
      *            LNFILE.LN_INSACCERN_3,
      *            LNFILE.LN_INSEARN_ORDER_3,
      *            LNFILE.LN_INSFINCHG_3,
      *            LNFILE.LN_INSCOMP_4,
      *            LNFILE.LN_INSOURS_4,
      *            CAST(LNFILE.LN_INSEFF_DATE_4 AS VARCHAR(10)) AS LN_INSEFF_DATE_4,
      *            CAST(LNFILE.LN_INSEXP_DATE_4 AS VARCHAR(10)) AS LN_INSEXP_DATE_4,
      *            LNFILE.LN_INSPREM_4,
      *            LNFILE.LN_INSCOVR_4,
      *            LNFILE.LN_INSCOMM_4,
      *            LNFILE.LN_INSANTICERN_4,
      *            LNFILE.LN_INSANTICADJ_4,
      *            LNFILE.LN_INSUFERN_4,
      *            LNFILE.LN_INSACCERN_4,
      *            LNFILE.LN_INSEARN_ORDER_4,
      *            LNFILE.LN_INSFINCHG_4,
      *            LNFILE.LN_INSCOMP_5,
      *            LNFILE.LN_INSOURS_5,
      *            CAST(LNFILE.LN_INSEFF_DATE_5 AS VARCHAR(10)) AS LN_INSEFF_DATE_5,
      *            CAST(LNFILE.LN_INSEXP_DATE_5 AS VARCHAR(10)) AS LN_INSEXP_DATE_5,
      *            LNFILE.LN_INSPREM_5,
      *            LNFILE.LN_INSCOVR_5,
      *            LNFILE.LN_INSCOMM_5,
      *            LNFILE.LN_INSANTICERN_5,
      *            LNFILE.LN_INSANTICADJ_5,
      *            LNFILE.LN_INSUFERN_5,
      *            LNFILE.LN_INSACCERN_5,
      *            LNFILE.LN_INSEARN_ORDER_5,
      *            LNFILE.LN_INSFINCHG_5,
      *            LNFILE.LN_INSCOMP_6,
      *            LNFILE.LN_INSOURS_6,
      *            CAST(LNFILE.LN_INSEFF_DATE_6 AS VARCHAR(10)) AS LN_INSEFF_DATE_6,
      *            CAST(LNFILE.LN_INSEXP_DATE_6 AS VARCHAR(10)) AS LN_INSEXP_DATE_6,
      *            LNFILE.LN_INSPREM_6,
      *            LNFILE.LN_INSCOVR_6,
      *            LNFILE.LN_INSCOMM_6,
      *            LNFILE.LN_INSANTICERN_6,
      *            LNFILE.LN_INSANTICADJ_6,
      *            LNFILE.LN_INSUFERN_6,
      *            LNFILE.LN_INSACCERN_6,
      *            LNFILE.LN_INSEARN_ORDER_6,
      *            LNFILE.LN_INSFINCHG_6,
      *            LNFILE.LN_INSCOMP_7,
      *            LNFILE.LN_INSOURS_7,
      *            CAST(LNFILE.LN_INSEFF_DATE_7 AS VARCHAR(10)) AS LN_INSEFF_DATE_7,
      *            CAST(LNFILE.LN_INSEXP_DATE_7 AS VARCHAR(10)) AS LN_INSEXP_DATE_7 ,
      *            LNFILE.LN_INSPREM_7,
      *            LNFILE.LN_INSCOVR_7,
      *            LNFILE.LN_INSCOMM_7,
      *            LNFILE.LN_INSANTICERN_7,
      *            LNFILE.LN_INSANTICADJ_7,
      *            LNFILE.LN_INSUFERN_7,
      *            LNFILE.LN_INSACCERN_7,
      *            LNFILE.LN_INSEARN_ORDER_7,
      *            LNFILE.LN_INSFINCHG_7,
      *            LNFILE.LN_INSCOMP_8,
      *            LNFILE.LN_INSOURS_8,
      *            CAST(LNFILE.LN_INSEFF_DATE_8 AS VARCHAR(10)) AS LN_INSEFF_DATE_8,
      *            CAST(LNFILE.LN_INSEXP_DATE_8 AS VARCHAR(10)) AS LN_INSEXP_DATE_8,
      *            LNFILE.LN_INSPREM_8,
      *            LNFILE.LN_INSCOVR_8,
      *            LNFILE.LN_INSCOMM_8,
      *            LNFILE.LN_INSANTICERN_8,
      *            LNFILE.LN_INSANTICADJ_8,
      *            LNFILE.LN_INSUFERN_8,
      *            LNFILE.LN_INSACCERN_8,
      *            LNFILE.LN_INSEARN_ORDER_8,
      *            LNFILE.LN_INSFINCHG_8,
      *            LNFILE.LN_INSCOMP_9,
      *            LNFILE.LN_INSOURS_9,
      *            CAST(LNFILE.LN_INSEFF_DATE_9 AS VARCHAR(10)) AS LN_INSEFF_DATE_9,
      *            CAST(LNFILE.LN_INSEXP_DATE_9 AS VARCHAR(10)) AS LN_INSEXP_DATE_9,
      *            LNFILE.LN_INSPREM_9,
      *            LNFILE.LN_INSCOVR_9,
      *            LNFILE.LN_INSCOMM_9,
      *            LNFILE.LN_INSANTICERN_9,
      *            LNFILE.LN_INSANTICADJ_9,
      *            LNFILE.LN_INSUFERN_9,
      *            LNFILE.LN_INSACCERN_9,
      *            LNFILE.LN_INSEARN_ORDER_9,
      *            LNFILE.LN_INSFINCHG_9,
      *            LNFILE.LN_INSCOMP_10,
      *            LNFILE.LN_INSOURS_10,
      *            CAST(LNFILE.LN_INSEFF_DATE_10 AS VARCHAR(10)) AS LN_INSEFF_DATE_10,
      *            CAST(LNFILE.LN_INSEXP_DATE_10 AS VARCHAR(10)) AS LN_INSEXP_DATE_10,
      *            LNFILE.LN_INSPREM_10,
      *            LNFILE.LN_INSCOVR_10,
      *            LNFILE.LN_INSCOMM_10,
      *            LNFILE.LN_INSANTICERN_10,
      *            LNFILE.LN_INSANTICADJ_10,
      *            LNFILE.LN_INSUFERN_10,
      *            LNFILE.LN_INSACCERN_10,
      *            LNFILE.LN_INSEARN_ORDER_10,
      *            LNFILE.LN_INSFINCHG_10,
      *            LNFILE.LN_PY_YYYYMM_RECDEL,
      *            LNFILE.LN_MTD_PAYS_RECDEL,
      *            LNFILE.LN_GARNISH_EXTR,
      *            LNFILE.LN_SHIP_SAME_FG,
      *            LNFILE.LN_AD_D_INS_COVR,
      *            LNFILE.LN_TOT_PARTIAL_CHGOFF,
      *            LNFILE.LN_LPO,
      *            LNFILE.LN_REP_CD,
      *            LNFILE.LN_EMP_ID,
      *            LNFILE.LN_PROCESS_CD,
      *            LNFILE.LN_WCBC_CREDITLIM,
      *            LNFILE.LN_FOLLOWUP_CD,
      *            LNFILE.LN_MIP_FG,
      *            LNFILE.LN_MIP_MTD_CLAHPAID,
      *            CAST(LNFILE.LN_MIP_CLPDTH_DATE AS VARCHAR(10)) AS LN_MIP_CLPDTH_DATE,
      *            LNFILE.LN_MIP_TOT_CLPAID,
      *            CAST(LNFILE.LN_MIP_AHPDTH_DATE AS VARCHAR(10)) AS LN_MIP_AHPDTH_DATE,
      *            LNFILE.LN_MIP_TOT_AHPAID,
      *            LNFILE.LN_IL_GROSS_INCOME,
      *            LNFILE.LN_IL_GROSS_INCOME2,
      *            LNFILE.LN_RESCISSION,
      *            LNFILE.LN_INTERIM_TRW,
      *            LNFILE.LN_DLNO,
      *            LNFILE.LN_DLPOOL,
      *            LNFILE.LN_DLRECOURSE,
      *            LNFILE.LN_DLPARTRCAMT,
      *            LNFILE.LN_ORIGPURAMT,
      *            LNFILE.LN_PURBAL,
      *            LNFILE.LN_DLRVPRIN_1,
      *            LNFILE.LN_DLRVPRIN_2,
      *            LNFILE.LN_DLRVPRIN_3,
      *            LNFILE.LN_DLRVCHGS_1,
      *            LNFILE.LN_DLRVCHGS_2,
      *            LNFILE.LN_DLRVCHGS_3,
      *            LNFILE.LN_DLPARVHELD,
      *            LNFILE.LN_DLPARVPAID,
      *            LNFILE.LN_DLDISC,
      *            CAST(LNFILE.LN_LCPDTH_DATE  AS VARCHAR(10)) AS LN_LCPDTH_DATE,
      *            CAST(LNFILE.LN_INTPDTH_DATE AS VARCHAR(10)) AS LN_INTPDTH_DATE,
      *            LNFILE.LN_CURBAL,
      *            LNFILE.LN_INTBAL,
      *            LNFILE.LN_LCBAL,
      *            LNFILE.LN_OTHBAL,
      *            LNFILE.LN_OT2BAL,
      *            LNFILE.LN_LCPAID,
      *            LNFILE.LN_LCPARTIALS,
      *            LNFILE.LN_STMT_COUNTER,
      *            LNFILE.LN_PRIOR_STMT_COUNTER,
      *            LNFILE.LN_FROZEN_REASON,
      *            LNFILE.LN_COUPON_STATEMENT,
      *            LNFILE.LN_MONTHEND_BAL,
      *            LNFILE.LN_ANTICTERM,
      *            LNFILE.LN_ANTICERN_1,
      *            LNFILE.LN_ANTICADJ_1,
      *            LNFILE.LN_UFERN_1,
      *            LNFILE.LN_ACCERN_1,
      *            LNFILE.LN_EARN_ORDER_1,
      *            LNFILE.LN_ANTICERN_2,
      *            LNFILE.LN_ANTICADJ_2,
      *            LNFILE.LN_UFERN_2,
      *            LNFILE.LN_ACCERN_2,
      *            LNFILE.LN_EARN_ORDER_2,
      *            LNFILE.LN_ANTICERN_3,
      *            LNFILE.LN_ANTICADJ_3,
      *            LNFILE.LN_UFERN_3,
      *            LNFILE.LN_ACCERN_3,
      *            LNFILE.LN_EARN_ORDER_3,
      *            LNFILE.LN_ANTICERN_4,
      *            LNFILE.LN_ANTICADJ_4,
      *            LNFILE.LN_UFERN_4,
      *            LNFILE.LN_ACCERN_4,
      *            LNFILE.LN_EARN_ORDER_4,
      *            LNFILE.LN_ANTICERN_5,
      *            LNFILE.LN_ANTICADJ_5,
      *            LNFILE.LN_UFERN_5,
      *            LNFILE.LN_ACCERN_5,
      *            LNFILE.LN_EARN_ORDER_5,
      *            LNFILE.LN_ANTICERN_6,
      *            LNFILE.LN_ANTICADJ_6,
      *            LNFILE.LN_UFERN_6,
      *            LNFILE.LN_ACCERN_6,
      *            LNFILE.LN_EARN_ORDER_6,
      *            LNFILE.LN_ANTICERN_7,
      *            LNFILE.LN_ANTICADJ_7,
      *            LNFILE.LN_UFERN_7,
      *            LNFILE.LN_ACCERN_7,
      *            LNFILE.LN_EARN_ORDER_7,
      *            LNFILE.LN_ANTICERN_8,
      *            LNFILE.LN_ANTICADJ_8,
      *            LNFILE.LN_UFERN_8,
      *            LNFILE.LN_ACCERN_8,
      *            LNFILE.LN_EARN_ORDER_8,
      *            LNFILE.LN_ANTICERN_9,
      *            LNFILE.LN_ANTICADJ_9,
      *            LNFILE.LN_UFERN_9,
      *            LNFILE.LN_ACCERN_9,
      *            LNFILE.LN_EARN_ORDER_9,
      *            LNFILE.LN_ANTICERN_10,
      *            LNFILE.LN_ANTICADJ_10,
      *            LNFILE.LN_UFERN_10,
      *            LNFILE.LN_ACCERN_10,
      *            LNFILE.LN_EARN_ORDER_10,
      *            LNFILE.LN_LMO_PRIOR_INTEREST,
      *            LNFILE.LN_PRIOR_UNEARNED,
      *            LNFILE.LN_ERNDELQ_STOP,
      *            LNFILE.LN_NONACRERN,
      *            LNFILE.LN_PRIOR_NONACRERN,
      *            CAST(LNFILE.LN_ERN_IB_PDTH_DATE AS VARCHAR(10)) AS LN_ERN_IB_PDTH_DATE,
      *            LNFILE.LN_ERN_IB_PRINBAL,
      *            LNFILE.LN_ERN_IB_INTOWE,
      *            LNFILE.LN_TOTERN,
      *            LNFILE.LN_TOTOTH,
      *            LNFILE.LN_TOTINT,
      *            LNFILE.LN_TOTLCHG,
      *            LNFILE.LN_TOTDEF,
      *            LNFILE.LN_TOTSERACCT,
      *            LNFILE.LN_LCWAIVERS,
      *            LNFILE.LN_INTWAIVERS,
      *            LNFILE.LN_TOTPAYMNTD,
      *            LNFILE.LN_TOTEXCPAYMNTD,
      *            LNFILE.LN_TOTNODEF,
      *            LNFILE.LN_YTDNODEF,
      *            LNFILE.LN_TOTNODEFACT,
      *            LNFILE.LN_YTDNODEFACT,
      *            LNFILE.LN_TOTNOALDEL,
      *            LNFILE.LN_YTDNOALDEL,
      *            LNFILE.LN_YTDINTPD,
      *            LNFILE.LN_LYRINTPD,
      *            LNFILE.LN_TOTINTPD,
      *            LNFILE.LN_RECASTINT,
      *            LNFILE.LN_RECASTPRIN,
      *            LNFILE.LN_CL_REBATE,
      *            LNFILE.LN_AH_REBATE,
      *            LNFILE.LN_PP_REBATE,
      *            LNFILE.LN_INT_REBATE,
      *            LNFILE.LN_SC_REBATE,
      *            LNFILE.LN_MF_REBATE,
      *            LNFILE.LN_DF_REBATE,
      *            LNFILE.LN_EX_REBATE,
      *            LNFILE.LN_O1_REBATE,
      *            LNFILE.LN_O2_REBATE,
      *            LNFILE.LN_O3_REBATE,
      *            LNFILE.LN_O4_REBATE,
      *            LNFILE.LN_O5_REBATE,
      *            LNFILE.LN_O6_REBATE,
      *            LNFILE.LN_O7_REBATE,
      *            LNFILE.LN_UN_O7_REB,
      *            LNFILE.LN_UN_O8_REB,
      *            LNFILE.LN_UN_O9_REB,
      *            LNFILE.LN_UN_O10_REB,
      *            LNFILE.LN_PLREASON,
      *            LNFILE.LN_COLLECTOR,
      *            LNFILE.LN_ACTIONCD,
      *            LNFILE.LN_ACTIONCD2,
      *            LNFILE.LN_ATCODE,
      *            LNFILE.LN_RECODE,
      *            LNFILE.LN_ESCROW_FG,
      *            LNFILE.LN_PROMDAYS_PASTDUE,
      *            LNFILE.LN_PROMID,
      *            CAST(LNFILE.LN_PROMDATE AS VARCHAR(10)) AS LN_PROMDATE,
      *            LNFILE.LN_PROMAMT,
      *            CAST(LNFILE.LN_PROMDATE2      AS VARCHAR(10)) AS LN_PROMDATE2,
      *            CAST(LNFILE.LN_DATE_PAID_LAST AS VARCHAR(10)) AS LN_DATE_PAID_LAST,
      *            LNFILE.LN_AMT_PAID_LAST,
      *            LNFILE.LN_LASTCFORMNO,
      *            CAST(LNFILE.LN_LASTCFORMDATE AS VARCHAR(10)) AS LN_LASTCFORMDATE,
      *            LNFILE.LN_DELCNT,
      *            LNFILE.LN_DELCNT2,
      *            LNFILE.LN_CREDITLIM,
      *            LNFILE.LN_CRSCORE,
      *            LNFILE.LN_LASTSFORMNO,
      *            CAST(LNFILE.LN_LASTSFORMDATE AS VARCHAR(10)) AS LN_LASTSFORMDATE,
      *            LNFILE.LN_SOLCNT,
      *            LNFILE.LN_MESSAGE,
      *            LNFILE.LN_OLDACCTNO,
      *            LNFILE.LN_PRLNNO,
      *            LNFILE.LN_PRBAL,
      *            LNFILE.LN_PRINTDUE,
      *            LNFILE.LN_PRFINCHGRB,
      *            LNFILE.LN_PRINSRB,
      *            LNFILE.LN_PRPOCD,
      *            CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)) AS LN_PRPODATE,
      *            LNFILE.LN_PRDELINQAMT,
      *            LNFILE.LN_PRLNAMT,
      *            LNFILE.LN_PRPDUE_DAYS,
      *            LNFILE.LN_PRDLDISC_UNEARN,
      *            LNFILE.LN_PRCONPROFILE,
      *            LNFILE.LN_SUM_ORIGPURAMT,
      *            LNFILE.LN_SUM_LNAMT,
      *            LNFILE.LN_SUM_FINCHG,
      *            LNFILE.LN_SUM_INTCHG,
      *            LNFILE.LN_SUM_ORGTERM,
      *            LNFILE.LN_SUM_REGPYAMT,
      *            LNFILE.LN_SUM_EXTCHG,
      *            LNFILE.LN_SUM_SERCHG,
      *            LNFILE.LN_SUM_MAINTFEE,
      *            LNFILE.LN_UNITPER_CD,
      *            LNFILE.LN_UNITPER_FREQ,
      *            LNFILE.LN_DAYS_IN_UNITPER,
      *            LNFILE.LN_UNITPER_PER_YEAR,
      *            LNFILE.LN_REPOCD,
      *            LNFILE.LN_BR_TFR_FG,
      *            LNFILE.LN_O3INS_DLPROC,
      *            LNFILE.LN_INSPREM_DLADJ,
      *            LNFILE.LN_PLAMT,
      *            LNFILE.LN_MTD_PRIN,
      *            LNFILE.LN_MTD_LC,
      *            LNFILE.LN_MTD_INT,
      *            LNFILE.LN_MTD_OT,
      *            LNFILE.LN_MTD_EX,
      *            LNFILE.LN_BNKRPT_CHAPTER,
      *            LNFILE.LN_BMO_CON_STATUS,
      *            LNFILE.LN_BMO_REC_STATUS,
      *            LNFILE.LN_APP_NUMBER,
      *            LNFILE.LN_GIFTNET,
      *            LNFILE.LN_GIFTNET_OUR_PO,
      *            LNFILE.LN_PROC_DISBURSED,
      *            LNFILE.LN_NOODDPY,
      *            LNFILE.LN_CONPROFILE_1,
      *            LNFILE.LN_CONPROFILE_2,
      *            LNFILE.LN_CONPROFILE_3,
      *            LNFILE.LN_CONPROFILE_4,
      *            LNFILE.LN_CONPROFILE_5,
      *            LNFILE.LN_RECPROFILE_1,
      *            LNFILE.LN_RECPROFILE_2,
      *            LNFILE.LN_RECPROFILE_3,
      *            LNFILE.LN_RECPROFILE_4,
      *            LNFILE.LN_RECPROFILE_5,
      *            LNFILE.LN_TRW_STATUS,
      *            LNFILE.LN_ORIGIN,
      *            LNFILE.LN_PO_TRCD,
      *            LNFILE.LN_NEXIS_CRSCORE,
      *            LNFILE.LN_TRW_B_CONSUMER_IND,
      *            LNFILE.LN_PARVHELD_PAID_FG,
      *            LNFILE.LN_ACCT_FROZEN,
      *            LNFILE.LN_TRW_SPECIAL_CODE,
      *            LNFILE.LN_CREATION_STATUS,
      *            LNFILE.LN_TOTNOLCHG,
      *            LNFILE.LN_LBOX,
      *            LNFILE.LN_EXTRA_PRIN_LFP,
      *            LNFILE.LN_REMAIN_INT_SINCE_LFP,
      *            LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
      *            LNFILE.LN_INTERIM_COUPON,
      *            LNFILE.LN_DLCOMM_O3_CMSI,
      *            LNFILE.LN_DLCOMM_PP_CMSI,
      *            LNFILE.LN_TRW_J_CONSUMER_IND,
      *            LNFILE.LN_ACH,
      *            LNFILE.LN_1099_C_FG,
      *            LNFILE.LN_TRW_COMPLIANCE_CODE,
      *            LNFILE.LN_UNWIND_REASON_CODE,
      *            LNFILE.LN_PBI_PBD_FG,
      *            LNFILE.LN_OLD_ACCT_FORMAT_FG,
      *            LNFILE.LN_APPROVED_BY_USER,
      *            LNFILE.LN_APPROVED_BY_CODE,
      *            CAST(LNFILE.LN_APPROVED_BY_DATE AS VARCHAR(10)) AS LN_APPROVED_BY_DATE,
      *            LNFILE.LN_APPROVED_BY_TIME,
      *            CAST(LNFILE.LN_LTOUCH_DATE AS VARCHAR(10)) AS LN_LTOUCH_DATE,
      *            LNFILE.LN_LTOUCH_TIME,
      *            ISNULL(BWFILE.BW_OWNBR,0)  AS BW_OWNBR,
      *            ISNULL(BWFILE.BW_SSNO,0)   AS BW_SSNO,
      *            ISNULL(BWFILE.BW_LNAME,'') AS BW_LNAME,
      *            ISNULL(BWFILE.BW_ZIP,'')   AS BW_ZIP,
      *            ISNULL(BWFILE.BW_PHONE,0)  AS BW_PHONE,
      *            ISNULL(BWFILE.BW_CELL_PHONE,0) AS BW_CELL_PHONE,
      *            ISNULL(BWFILE.BW_EMPPHONE,0) AS BW_EMPPHONE,
      *            ISNULL(BWFILE.BW_CRED_SCORE_1,0) AS BW_CRED_SCORE_1,
      *            ISNULL(BWFILE.BW_CRED_SCORE_2,0) AS BW_CRED_SCORE_2,
      *            ISNULL(BWFILE.BW_CRED_SCORE_3,0) AS BW_CRED_SCORE_3,
      *            ISNULL(BWFILE.BW_CRED_SCORE_4,0) AS BW_CRED_SCORE_4,
      *            ISNULL(BWFILE.BW_BNKRPT_SCORE_1,0) AS W_BNKRPT_SCORE_1,
      *            ISNULL(BWFILE.BW_BNKRPT_SCORE_2,0) AS W_BNKRPT_SCORE_2,
      *            ISNULL(BWFILE.BW_BNKRPT_SCORE_3,0) AS W_BNKRPT_SCORE_3,
      *            ISNULL(BWFILE.BW_BNKRPT_SCORE_4,0) AS W_BNKRPT_SCORE_4,
      *            ISNULL(CAST(BWFILE.BW_LAST_RN_FOR10_DATE AS VARCHAR(10)),'1900-01-01') 
      *                      AS BW_LAST_RN_FOR10_DATE,
      *            ISNULL(BWFILE.BW_BAD_ADR_FG,'')   AS BW_BAD_ADR_FG,
      *            ISNULL(BWFILE.BW_CONFIDENTIAL,'') AS BW_CONFIDENTIAL,
      *       FROM DBO.LNFILE LNFILE
      *       LEFT OUTER JOIN DBO.BWFILE BWFILE
      *        ON BWFILE.BW_OWNBR = LNFILE.LN_OWNBR 
      *       AND BWFILE.BW_SSNO  = LNFILE.LN_SSNO1
      *      WHERE LNFILE.LN_OWNBR = @BEG_BRNO
      *        AND LNFILE.LN_CLASS BETWEEN @BEG_CLASS AND @END_CLASS
      *        AND LNFILE.LN_POCD NOT IN ('**', '*I', '*R', '*U') 
      *      ORDER BY LNFILE.LN_CLASS, LNFILE.LN_ACCTNO

           EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC.

           EXEC SQL
            DECLARE LN3_CURSOR CURSOR FOR
                :LN3-RETURN-CODE = 
                 EXEC SSP_CQRUN_LNFILE_SELECT
                  (:QLN3-WBEG-OWNBR, 
                   :QLN3-WBEG-CLASS, :QLN3-WEND-CLASS) 
                END-EXEC.

           EXEC SQL
               OPEN LN3_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           MOVE ZEROES TO QLN3-WBEG-OWNBR
                          QLN3-WEND-OWNBR
                          QLN3-WBEG-CLASS
                          QLN3-WEND-CLASS.

           MOVE STAT---GOOD TO LN3-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-LN3-FILE-NEXT.    *> SSP - LN, BW 
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

           INITIALIZE QLN-REC QBW-REC.

           EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL
               FETCH LN3_CURSOR INTO 
                   :QLN-OWNBR,
                   :QLN-ACCTNO,
                   :QLN-CLASS,
                   :QLN-SUBCLASS,
                   :QLN-LAWCODE,
                   :QLN-SSNO1,
                   :QLN-MAKERCD1,
                   :QLN-SSNO2,
                   :QLN-MAKERCD2,
                   :QLN-SSNO3,
                   :QLN-MAKERCD3,
                   :QLN-SSNO4,
                   :QLN-MAKERCD4,
                   :QLN-ORGST,
                   :QLN-ORGBR,
                   :QLN-OWNST,
                   :QLN-SPRCLASS,
                   :QLN-CONVERCD,
                   :QLN-MIDSTREAM,
                   :QLN-PURCD,
                   :QLN-SRCD,
                   :QLN-COLLCD,
                   :QLN-COLLID,
                   :QLN-POCD,
                   :QLN-PLCD,
                   :QLN-PLTYPE,
                   :QLN-CONFIDENTCD,
                   :QLN-ALLOTCD,
                   :QLN-RECASTCD,
                   :QLN-SKIP-TRW,
                   :QLN-STATUSFG,
                   :QLN-SMALLOAN,
                   :QLN-SALEFIN,
                   :QLN-SERVACCT,
                   :QLN-LOANTYPE,
                   :QLN-ADDON-FG,
                   :QLN-PAY-SCHLD-FG,
                   :QLN-LC-CODE,
                   :QLN-CAN-LOAN-NO,
                   :QLN-STATFLAGS,
                   :QLN-ENTDATE,
                   :QLN-LOANDATE,
                   :QLN-PURDATE,
                   :QLN-INTDATE,
                   :QLN-CASHDATE,
                   :QLN-FILEDATE,
                   :QLN-RESCISSION-DATE,
                   :QLN-PART-RECOURSE-DATE,
                   :QLN-ORIG-1STPYDATE,
                   :QLN-1STPYDATE,
                   :QLN-JDDATE,
                   :QLN-PLDATE,
                   :QLN-PL-TRDATE,
                   :QLN-ACCELDATE,
                   :QLN-REDUDATE,
                   :QLN-POFFDATE,
                   :QLN-PO-TRDATE,
                   :QLN-LEGALDATE ,
                   :QLN-BNKRPTDATE,
                   :QLN-BNKRPT-DISMISS-DATE,
                   :QLN-BNKRPT-DISCHARGE-DATE,
                   :QLN-BNKRPT-REAFFIRM-DATE,
                   :QLN-DEBTAIDATE,
                   :QLN-REPODATE,
                   :QLN-REDEEMDATE,
                   :QLN-SOLDDATE,
                   :QLN-INS-CONFIRM-DATE,
                   :QLN-PRIOR-RN-FOR10-DATE,
                   :QLN-LAST-RN-FOR10-DATE,
                   :QLN-TRW-DOFD-DATE,
                   :QLN-LAST-PYPA-DATE,
                   :QLN-BT-TRDATE,
                   :QLN-METRO2-LAST-PMT-DATE,
                   :QLN-FOLLOWUP-DATE,
                   :QLN-LAST-ACCRUAL-DATE,
                   :QLN-APRATE,
                   :QLN-EFFRATE,
                   :QLN-SMPRATE,
                   :QLN-YLDRATE,
                   :QLN-OVRDRATE,
                   :QLN-ENDORATE,
                   :QLN-JDRATE,
                   :QLN-ACCRATE,
                   :QLN-REDURATE,
                   :QLN-CONRATE,
                   :QLN-SERVPER,
                   :QLN-SELLPR,
                   :QLN-DOWNPY,
                   :QLN-TRADEIN,
                   :QLN-LNAMT,
                   :QLN-FINCHG,
                   :QLN-INTCHG,
                   :QLN-SERCHG,
                   :QLN-EXTCHG,
                   :QLN-MAINTFEE,
                   :QLN-POINTS,
                   :QLN-PROCEEDS,
                   :QLN-ORGTERM,
                   :QLN-1STPYAMT,
                   :QLN-NOREGPY,
                   :QLN-REGPYAMT,
                   :QLN-LASTPYAMT,
                   :QLN-PROCASH,
                   :QLN-TILLNO,
                   :QLN-STATE-FLAG,
                   :QLN-STATE-WORKER,
                   :QLN-STATE-WORKER2,
                   :QLN-FEECODE-1,
                   :QLN-FEEAMT-1,
                   :QLN-FEEOURS-1,
                   :QLN-FEEFINCHG-1,
                   :QLN-FEECODE-2,
                   :QLN-FEEAMT-2,
                   :QLN-FEEOURS-2,
                   :QLN-FEEFINCHG-2,
                   :QLN-FEECODE-3,
                   :QLN-FEEAMT-3,
                   :QLN-FEEOURS-3,
                   :QLN-FEEFINCHG-3,
                   :QLN-FEECODE-4,
                   :QLN-FEEAMT-4,
                   :QLN-FEEOURS-4,
                   :QLN-FEEFINCHG-4,
                   :QLN-FEECODE-5,
                   :QLN-FEEAMT-5,
                   :QLN-FEEOURS-5,
                   :QLN-FEEFINCHG-5,
                   :QLN-FEECODE-6,
                   :QLN-FEEAMT-6,
                   :QLN-FEEOURS-6,
                   :QLN-FEEFINCHG-6,
                   :QLN-FEECODE-7,
                   :QLN-FEEAMT-7,
                   :QLN-FEEOURS-7,
                   :QLN-FEEFINCHG-7,
                   :QLN-FEECODE-8,
                   :QLN-FEEAMT-8,
                   :QLN-FEEOURS-8,
                   :QLN-FEEFINCHG-8,
                   :QLN-FEECODE-9,
                   :QLN-FEEAMT-9,
                   :QLN-FEEOURS-9,
                   :QLN-FEEFINCHG-9,
                   :QLN-FEECODE-10,
                   :QLN-FEEAMT-10,
                   :QLN-FEEOURS-10,
                   :QLN-FEEFINCHG-10,
                   :QLN-FEECODE-11,
                   :QLN-FEEAMT-11,
                   :QLN-FEEOURS-11,
                   :QLN-FEEFINCHG-11,
                   :QLN-FEECODE-12,
                   :QLN-FEEAMT-12,
                   :QLN-FEEOURS-12,
                   :QLN-FEEFINCHG-12,
                   :QLN-FEECODE-13,
                   :QLN-FEEAMT-13,
                   :QLN-FEEOURS-13,
                   :QLN-FEEFINCHG-13,
                   :QLN-FEECODE-14,
                   :QLN-FEEAMT-14,
                   :QLN-FEEOURS-14,
                   :QLN-FEEFINCHG-14,
                   :QLN-FEECODE-15,
                   :QLN-FEEAMT-15,
                   :QLN-FEEOURS-15,
                   :QLN-FEEFINCHG-15,
                   :QLN-FEECODE-16,
                   :QLN-FEEAMT-16,
                   :QLN-FEEOURS-16,
                   :QLN-FEEFINCHG-16,
                   :QLN-FEECODE-17,
                   :QLN-FEEAMT-17,
                   :QLN-FEEOURS-17,
                   :QLN-FEEFINCHG-17,
                   :QLN-FEECODE-18,
                   :QLN-FEEAMT-18,
                   :QLN-FEEOURS-18,
                   :QLN-FEEFINCHG-18,
                   :QLN-FEECODE-19,
                   :QLN-FEEAMT-19,
                   :QLN-FEEOURS-19,
                   :QLN-FEEFINCHG-19,
                   :QLN-FEECODE-20,
                   :QLN-FEEAMT-20,
                   :QLN-FEEOURS-20,
                   :QLN-FEEFINCHG-20,
                   :QLN-INSURED,
                   :QLN-INSTYPES,
                   :QLN-INSELIGIBLE,
                   :QLN-INSCOMP-1,
                   :QLN-INSOURS-1,
                   :QLN-INSEFF-DATE-1,
                   :QLN-INSEXP-DATE-1,
                   :QLN-INSPREM-1,
                   :QLN-INSCOVR-1,
                   :QLN-INSCOMM-1,
                   :QLN-INSANTICERN-1,
                   :QLN-INSANTICADJ-1,
                   :QLN-INSUFERN-1,
                   :QLN-INSACCERN-1,
                   :QLN-INSEARN-ORDER-1,
                   :QLN-INSFINCHG-1,
                   :QLN-INSCOMP-2,
                   :QLN-INSOURS-2,
                   :QLN-INSEFF-DATE-2,
                   :QLN-INSEXP-DATE-2,
                   :QLN-INSPREM-2,
                   :QLN-INSCOVR-2,
                   :QLN-INSCOMM-2,
                   :QLN-INSANTICERN-2,
                   :QLN-INSANTICADJ-2,
                   :QLN-INSUFERN-2,
                   :QLN-INSACCERN-2,
                   :QLN-INSEARN-ORDER-2,
                   :QLN-INSFINCHG-2,
                   :QLN-INSCOMP-3,
                   :QLN-INSOURS-3,
                   :QLN-INSEFF-DATE-3,
                   :QLN-INSEXP-DATE-3,
                   :QLN-INSPREM-3,
                   :QLN-INSCOVR-3,
                   :QLN-INSCOMM-3,
                   :QLN-INSANTICERN-3,
                   :QLN-INSANTICADJ-3,
                   :QLN-INSUFERN-3,
                   :QLN-INSACCERN-3,
                   :QLN-INSEARN-ORDER-3,
                   :QLN-INSFINCHG-3,
                   :QLN-INSCOMP-4,
                   :QLN-INSOURS-4,
                   :QLN-INSEFF-DATE-4,
                   :QLN-INSEXP-DATE-4,
                   :QLN-INSPREM-4,
                   :QLN-INSCOVR-4,
                   :QLN-INSCOMM-4,
                   :QLN-INSANTICERN-4,
                   :QLN-INSANTICADJ-4,
                   :QLN-INSUFERN-4,
                   :QLN-INSACCERN-4,
                   :QLN-INSEARN-ORDER-4,
                   :QLN-INSFINCHG-4,
                   :QLN-INSCOMP-5,
                   :QLN-INSOURS-5,
                   :QLN-INSEFF-DATE-5,
                   :QLN-INSEXP-DATE-5,
                   :QLN-INSPREM-5,
                   :QLN-INSCOVR-5,
                   :QLN-INSCOMM-5,
                   :QLN-INSANTICERN-5,
                   :QLN-INSANTICADJ-5,
                   :QLN-INSUFERN-5,
                   :QLN-INSACCERN-5,
                   :QLN-INSEARN-ORDER-5,
                   :QLN-INSFINCHG-5,
                   :QLN-INSCOMP-6,
                   :QLN-INSOURS-6,
                   :QLN-INSEFF-DATE-6,
                   :QLN-INSEXP-DATE-6,
                   :QLN-INSPREM-6,
                   :QLN-INSCOVR-6,
                   :QLN-INSCOMM-6,
                   :QLN-INSANTICERN-6,
                   :QLN-INSANTICADJ-6,
                   :QLN-INSUFERN-6,
                   :QLN-INSACCERN-6,
                   :QLN-INSEARN-ORDER-6,
                   :QLN-INSFINCHG-6,
                   :QLN-INSCOMP-7,
                   :QLN-INSOURS-7,
                   :QLN-INSEFF-DATE-7,
                   :QLN-INSEXP-DATE-7,
                   :QLN-INSPREM-7,
                   :QLN-INSCOVR-7,
                   :QLN-INSCOMM-7,
                   :QLN-INSANTICERN-7,
                   :QLN-INSANTICADJ-7,
                   :QLN-INSUFERN-7,
                   :QLN-INSACCERN-7,
                   :QLN-INSEARN-ORDER-7,
                   :QLN-INSFINCHG-7,
                   :QLN-INSCOMP-8,
                   :QLN-INSOURS-8,
                   :QLN-INSEFF-DATE-8,
                   :QLN-INSEXP-DATE-8,
                   :QLN-INSPREM-8,
                   :QLN-INSCOVR-8,
                   :QLN-INSCOMM-8,
                   :QLN-INSANTICERN-8,
                   :QLN-INSANTICADJ-8,
                   :QLN-INSUFERN-8,
                   :QLN-INSACCERN-8,
                   :QLN-INSEARN-ORDER-8,
                   :QLN-INSFINCHG-8,
                   :QLN-INSCOMP-9,
                   :QLN-INSOURS-9,
                   :QLN-INSEFF-DATE-9,
                   :QLN-INSEXP-DATE-9,
                   :QLN-INSPREM-9,
                   :QLN-INSCOVR-9,
                   :QLN-INSCOMM-9,
                   :QLN-INSANTICERN-9,
                   :QLN-INSANTICADJ-9,
                   :QLN-INSUFERN-9,
                   :QLN-INSACCERN-9,
                   :QLN-INSEARN-ORDER-9,
                   :QLN-INSFINCHG-9,
                   :QLN-INSCOMP-10,
                   :QLN-INSOURS-10,
                   :QLN-INSEFF-DATE-10,
                   :QLN-INSEXP-DATE-10,
                   :QLN-INSPREM-10,
                   :QLN-INSCOVR-10,
                   :QLN-INSCOMM-10,
                   :QLN-INSANTICERN-10,
                   :QLN-INSANTICADJ-10,
                   :QLN-INSUFERN-10,
                   :QLN-INSACCERN-10,
                   :QLN-INSEARN-ORDER-10,
                   :QLN-INSFINCHG-10,
                   :QLN-PY-YYYYMM-RECDEL,
                   :QLN-MTD-PAYS-RECDEL,
                   :QLN-GARNISH-EXTR,
                   :QLN-SHIP-SAME-FG,
                   :QLN-AD-D-INS-COVR,
                   :QLN-TOT-PARTIAL-CHGOFF,
                   :QLN-LPO,
                   :QLN-REP-CD,
                   :QLN-EMP-ID,
                   :QLN-PROCESS-CD,
                   :QLN-WCBC-CREDITLIM,
                   :QLN-FOLLOWUP-CD,
                   :QLN-MIP-FG,
                   :QLN-MIP-MTD-CLAHPAID,
                   :QLN-MIP-CLPDTH-DATE,
                   :QLN-MIP-TOT-CLPAID,
                   :QLN-MIP-AHPDTH-DATE,
                   :QLN-MIP-TOT-AHPAID,
                   :QLN-IL-GROSS-INCOME,
                   :QLN-IL-GROSS-INCOME2,
                   :QLN-RESCISSION,
                   :QLN-INTERIM-TRW,
                   :QLN-DLNO,
                   :QLN-DLPOOL,
                   :QLN-DLRECOURSE,
                   :QLN-DLPARTRCAMT,
                   :QLN-ORIGPURAMT,
                   :QLN-PURBAL,
                   :QLN-DLRVPRIN-1,
                   :QLN-DLRVPRIN-2,
                   :QLN-DLRVPRIN-3,
                   :QLN-DLRVCHGS-1,
                   :QLN-DLRVCHGS-2,
                   :QLN-DLRVCHGS-3,
                   :QLN-DLPARVHELD,
                   :QLN-DLPARVPAID,
                   :QLN-DLDISC,
                   :QLN-LCPDTH-DATE,
                   :QLN-INTPDTH-DATE,
                   :QLN-CURBAL,
                   :QLN-INTBAL,
                   :QLN-LCBAL,
                   :QLN-OTHBAL,
                   :QLN-OT2BAL,
                   :QLN-LCPAID,
                   :QLN-LCPARTIALS,
                   :QLN-STMT-COUNTER,
                   :QLN-PRIOR-STMT-COUNTER,
                   :QLN-FROZEN-REASON,
                   :QLN-COUPON-STATEMENT,
                   :QLN-MONTHEND-BAL,
                   :QLN-ANTICTERM,
                   :QLN-ANTICERN-1,
                   :QLN-ANTICADJ-1,
                   :QLN-UFERN-1,
                   :QLN-ACCERN-1,
                   :QLN-EARN-ORDER-1,
                   :QLN-ANTICERN-2,
                   :QLN-ANTICADJ-2,
                   :QLN-UFERN-2,
                   :QLN-ACCERN-2,
                   :QLN-EARN-ORDER-2,
                   :QLN-ANTICERN-3,
                   :QLN-ANTICADJ-3,
                   :QLN-UFERN-3,
                   :QLN-ACCERN-3,
                   :QLN-EARN-ORDER-3,
                   :QLN-ANTICERN-4,
                   :QLN-ANTICADJ-4,
                   :QLN-UFERN-4,
                   :QLN-ACCERN-4,
                   :QLN-EARN-ORDER-4,
                   :QLN-ANTICERN-5,
                   :QLN-ANTICADJ-5,
                   :QLN-UFERN-5,
                   :QLN-ACCERN-5,
                   :QLN-EARN-ORDER-5,
                   :QLN-ANTICERN-6,
                   :QLN-ANTICADJ-6,
                   :QLN-UFERN-6,
                   :QLN-ACCERN-6,
                   :QLN-EARN-ORDER-6,
                   :QLN-ANTICERN-7,
                   :QLN-ANTICADJ-7,
                   :QLN-UFERN-7,
                   :QLN-ACCERN-7,
                   :QLN-EARN-ORDER-7,
                   :QLN-ANTICERN-8,
                   :QLN-ANTICADJ-8,
                   :QLN-UFERN-8,
                   :QLN-ACCERN-8,
                   :QLN-EARN-ORDER-8,
                   :QLN-ANTICERN-9,
                   :QLN-ANTICADJ-9,
                   :QLN-UFERN-9,
                   :QLN-ACCERN-9,
                   :QLN-EARN-ORDER-9,
                   :QLN-ANTICERN-10,
                   :QLN-ANTICADJ-10,
                   :QLN-UFERN-10,
                   :QLN-ACCERN-10,
                   :QLN-EARN-ORDER-10,
                   :QLN-LMO-PRIOR-INTEREST,
                   :QLN-PRIOR-UNEARNED,
                   :QLN-ERNDELQ-STOP,
                   :QLN-NONACRERN,
                   :QLN-PRIOR-NONACRERN,
                   :QLN-ERN-IB-PDTH-DATE,
                   :QLN-ERN-IB-PRINBAL,
                   :QLN-ERN-IB-INTOWE,
                   :QLN-TOTERN,
                   :QLN-TOTOTH,
                   :QLN-TOTINT,
                   :QLN-TOTLCHG,
                   :QLN-TOTDEF,
                   :QLN-TOTSERACCT,
                   :QLN-LCWAIVERS,
                   :QLN-INTWAIVERS,
                   :QLN-TOTPAYMNTD,
                   :QLN-TOTEXCPAYMNTD,
                   :QLN-TOTNODEF,
                   :QLN-YTDNODEF,
                   :QLN-TOTNODEFACT,
                   :QLN-YTDNODEFACT,
                   :QLN-TOTNOALDEL,
                   :QLN-YTDNOALDEL,
                   :QLN-YTDINTPD,
                   :QLN-LYRINTPD,
                   :QLN-TOTINTPD,
                   :QLN-RECASTINT,
                   :QLN-RECASTPRIN,
                   :QLN-CL-REBATE,
                   :QLN-AH-REBATE,
                   :QLN-PP-REBATE,
                   :QLN-INT-REBATE,
                   :QLN-SC-REBATE,
                   :QLN-MF-REBATE,
                   :QLN-DF-REBATE,
                   :QLN-EX-REBATE,
                   :QLN-O1-REBATE,
                   :QLN-O2-REBATE,
                   :QLN-O3-REBATE,
                   :QLN-O4-REBATE,
                   :QLN-O5-REBATE,
                   :QLN-O6-REBATE,
                   :QLN-O7-REBATE,
                   :QLN-UN-O7-REB,
                   :QLN-UN-O8-REB,
                   :QLN-UN-O9-REB,
                   :QLN-UN-O10-REB,
                   :QLN-PLREASON,
                   :QLN-COLLECTOR,
                   :QLN-ACTIONCD,
                   :QLN-ACTIONCD2,
                   :QLN-ATCODE,
                   :QLN-RECODE,
                   :QLN-ESCROW-FG,
                   :QLN-PROMDAYS-PASTDUE,
                   :QLN-PROMID,
                   :QLN-PROMDATE,
                   :QLN-PROMAMT,
                   :QLN-PROMDATE2,
                   :QLN-DATE-PAID-LAST,
                   :QLN-AMT-PAID-LAST,
                   :QLN-LASTCFORMNO,
                   :QLN-LASTCFORMDATE,
                   :QLN-DELCNT,
                   :QLN-DELCNT2,
                   :QLN-CREDITLIM,
                   :QLN-CRSCORE,
                   :QLN-LASTSFORMNO,
                   :QLN-LASTSFORMDATE,
                   :QLN-SOLCNT,
                   :QLN-MESSAGE,
                   :QLN-OLDACCTNO,
                   :QLN-PRLNNO,
                   :QLN-PRBAL,
                   :QLN-PRINTDUE,
                   :QLN-PRFINCHGRB,
                   :QLN-PRINSRB,
                   :QLN-PRPOCD,
                   :QLN-PRPODATE,
                   :QLN-PRDELINQAMT,
                   :QLN-PRLNAMT,
                   :QLN-PRPDUE-DAYS,
                   :QLN-PRDLDISC-UNEARN,
                   :QLN-PRCONPROFILE,
                   :QLN-SUM-ORIGPURAMT,
                   :QLN-SUM-LNAMT,
                   :QLN-SUM-FINCHG,
                   :QLN-SUM-INTCHG,
                   :QLN-SUM-ORGTERM,
                   :QLN-SUM-REGPYAMT,
                   :QLN-SUM-EXTCHG,
                   :QLN-SUM-SERCHG,
                   :QLN-SUM-MAINTFEE,
                   :QLN-UNITPER-CD,
                   :QLN-UNITPER-FREQ,
                   :QLN-DAYS-IN-UNITPER,
                   :QLN-UNITPER-PER-YEAR,
                   :QLN-REPOCD,
                   :QLN-BR-TFR-FG,
                   :QLN-O3INS-DLPROC,
                   :QLN-INSPREM-DLADJ,
                   :QLN-PLAMT,
                   :QLN-MTD-PRIN,
                   :QLN-MTD-LC,
                   :QLN-MTD-INT,
                   :QLN-MTD-OT,
                   :QLN-MTD-EX,
                   :QLN-BNKRPT-CHAPTER,
                   :QLN-BMO-CON-STATUS,
                   :QLN-BMO-REC-STATUS,
                   :QLN-APP-NUMBER,
                   :QLN-GIFTNET,
                   :QLN-GIFTNET-OUR-PO,
                   :QLN-PROC-DISBURSED,
                   :QLN-NOODDPY,
                   :QLN-CONPROFILE-1,
                   :QLN-CONPROFILE-2,
                   :QLN-CONPROFILE-3,
                   :QLN-CONPROFILE-4,
                   :QLN-CONPROFILE-5,
                   :QLN-RECPROFILE-1,
                   :QLN-RECPROFILE-2,
                   :QLN-RECPROFILE-3,
                   :QLN-RECPROFILE-4,
                   :QLN-RECPROFILE-5,
                   :QLN-TRW-STATUS,
                   :QLN-ORIGIN,
                   :QLN-PO-TRCD,
                   :QLN-NEXIS-CRSCORE,
                   :QLN-TRW-B-CONSUMER-IND,
                   :QLN-PARVHELD-PAID-FG,
                   :QLN-ACCT-FROZEN,
                   :QLN-TRW-SPECIAL-CODE,
                   :QLN-CREATION-STATUS,
                   :QLN-TOTNOLCHG,
                   :QLN-LBOX,
                   :QLN-EXTRA-PRIN-LFP,
                   :QLN-REMAIN-INT-SINCE-LFP,
                   :QLN-REMAIN-PRIN-SINCE-LFP,
                   :QLN-INTERIM-COUPON,
                   :QLN-DLCOMM-O3-CMSI,
                   :QLN-DLCOMM-PP-CMSI,
                   :QLN-TRW-J-CONSUMER-IND,
                   :QLN-ACH,
                   :QLN-1099-C-FG,
                   :QLN-TRW-COMPLIANCE-CODE,
                   :QLN-UNWIND-REASON-CODE,
                   :QLN-PBI-PBD-FG,
                   :QLN-OLD-ACCT-FORMAT-FG,
                   :QLN-APPROVED-BY-USER,
                   :QLN-APPROVED-BY-CODE,
                   :QLN-APPROVED-BY-DATE,
                   :QLN-APPROVED-BY-TIME,
                   :QLN-LTOUCH-DATE,
                   :QLN-LTOUCH-TIME,
                   :QBW-OWNBR, 
                   :QBW-SSNO,
                   :QBW-LNAME, 
                   :QBW-ZIP, 
                   :QBW-PHONE, 
                   :QBW-CELL-PHONE, 
                   :QBW-EMPPHONE, 
                   :QBW-CRED-SCORE-1, 
                   :QBW-CRED-SCORE-2, 
                   :QBW-CRED-SCORE-3, 
                   :QBW-CRED-SCORE-4,
                   :QBW-BNKRPT-SCORE-1, 
                   :QBW-BNKRPT-SCORE-2, 
                   :QBW-BNKRPT-SCORE-3, 
                   :QBW-BNKRPT-SCORE-4,
                   :QBW-LAST-RN-FOR10-DATE,
                   :QBW-BAD-ADR-FG,
                   :QBW-CONFIDENTIAL
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN3-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS
              PERFORM GET-BW-FIELDS.

      *-----------------------------------------------------------------
       CLOSE-LN3-FILE.

           PERFORM CLOSE-IT.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
              EXEC SQL
                   CLOSE LN3_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO LN3-CURSOR-STAT.

      *-----------------------------------------------------------------
       CLOSE-LN3-CONNECTION.

           IF LN3-CONN-OPEN-SW = "Y"
               EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
               EXEC SQL COMMIT END-EXEC
               EXEC SQL DISCONNECT LN3_CONNECT END-EXEC
               EXEC SQL SET CONNECTION C1 END-EXEC
               MOVE "N" TO LN3-CONN-OPEN-SW.

       COPY "LIBLP/LPEA1RN.CPY".
      *-----------------------------------------------------------------
       COUNT-EA1-FILE.
           PERFORM COUNT-IT.
           MOVE EA-PATH-SQL TO E-FILE.
           MOVE SPACES      TO E-KEYX.

           EXEC SQL
            SELECT COUNT(*)
            INTO :WS-EA1-ROWCOUNT
            FROM DBO.EAFILE
            WHERE EAFILE.EA_BRANCH = :QEA1-WBEG-BRANCH
              AND EAFILE.EA_CLASS BETWEEN :QEA1-WBEG-CLASS 
                     AND :QEA1-WEND-CLASS
              AND EAFILE.EA_GROUP_ID = :QEA1-WBEG-GROUP-ID
          END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO COUNT-EA1-FILE.
      *-----------------------------------------------------------------


      *COPY "LIBSP/SPCQ1IN.CPY".

      * COPYMEMBER: LIBSP/SPCQ1IN --- HARDCODE FOR SSP USAGE
       LOAD-CQ1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( CQ-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( CQ-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO CQ-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO CQ-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO CQ-ALL-DATA
              MOVE CQ-ALL-PATH             TO CQ-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( CQ-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO CQ-ALL-BASE
              MOVE FILPATH-MACHINE         TO CQ-ALL-MACHINE
              MOVE FILPATH-DATA            TO CQ-ALL-DATA
              MOVE CQ-ALL-PATH             TO CQ-PATH.

      *-----------------------------------------------------------------
       OPEN-CQ1-FILE.
           PERFORM LOAD-CQ1-FILE.
           PERFORM OPEN-IT.
           MOVE CQ-PATH-SQL TO E-FILE.

           IF CQ1-CONN-OPEN-SW = "N" 
               EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS CQ1_CONNECT
                    USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
               END-EXEC
               MOVE "Y" TO CQ1-CONN-OPEN-SW
               EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-CQ1-FILE.   *> SSP - CQ
      * RETREIVE ALL FIELDS FROM CQFILE FOR A BRANCH VIA TEMP TABLE
      * THIS ALLOWS CQFILE TO BE UPDATED DURING FETCH/READ NEXT PROCESS

           PERFORM START-IT.
           MOVE CQ-PATH-OWNBR  TO CQ-BRNO.
           MOVE CQ-PATH-SQL    TO E-FILE.
           MOVE CQ1-KEY        TO E-KEYX.

           IF ( CQ1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-CQ1-FILE.

      *     SELECT CQFILE.CQ_BRNO,
      *            CQFILE.CQ_ACCTNO,
      *            CQFILE.CQ_COLLID,
      *            CQFILE.CQ_REV_BEHAVIOR_RISK,
      *            CQFILE.CQ_SEQ_FG,
      *            CAST(CQFILE.CQ_DATE AS VARCHAR(10)) AS CQ_DATE,
      *            CQFILE.CQ_START_TIME,
      *            CQFILE.CQ_REV_DEL,
      *            CQFILE.CQ_MISC_KEY_FLD,
      *            CQFILE.CQ_REV_PDUE_DAYS,
      *            CQFILE.CQ_REV_BAL,
      *            CQFILE.CQ_SEQ,
      *            CAST(CQFILE.CQ_LTOUCH_DATE AS VARCHAR(10)) AS CQ_LTOUCH_DATE,
      *            CQFILE.CQ_WORK_COLLID,
      *            CQFILE.CQ_WORKED_FG,
      *            CQFILE.CQ_IN_PROCESS,
      *            CAST(CQFILE.CQ_DATE_QUEUED AS VARCHAR(10)) AS CQ_DATE_QUEUED,
      *            CQFILE.CQ_TIME_ZONE_ERROR
      *            INTO #TEMP_CQRUN_CQFILE
      *            FROM DBO.CQFILE CQFILE
      *            WHERE CQFILE.CQ_BRNO = @BEG_BRNO;
      *       SELECT *
      *       FROM #TEMP_CQRUN_CQFILE
      *       ORDER BY CQ_ACCTNO;

           EXEC SQL SET CONNECTION CQ1_CONNECT END-EXEC.

           EXEC SQL
            DECLARE CQ1_CURSOR CURSOR FOR
                :CQ1-RETURN-CODE = 
                 EXEC SSP_CQRUN_CQFILE_SELECT_BRANCH_ALL
                  (:QCQ1-WBEG-BRNO) 
           END-EXEC.

           EXEC SQL
               OPEN CQ1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           MOVE ZEROES TO QCQ1-WBEG-BRNO.
 
           MOVE STAT---GOOD TO CQ1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-CQ1-FILE.   *> EMBEDDED - CQ
           PERFORM READ-IT.
           MOVE CQ-PATH-OWNBR  TO CQ-BRNO. 
           MOVE CQ-PATH-SQL    TO E-FILE.
           MOVE CQ1-KEY        TO E-KEYX.
           INITIALIZE QCQ-REC. 

           MOVE CQ-BRNO   TO QCQ-BRNO.
           MOVE CQ-ACCTNO TO QCQ-ACCTNO.

           EXEC SQL
            SELECT CQFILE.CQ_BRNO,
                   CQFILE.CQ_ACCTNO,
                   CQFILE.CQ_COLLID,
                   CQFILE.CQ_REV_BEHAVIOR_RISK,
                   CQFILE.CQ_SEQ_FG,
                   CAST(CQFILE.CQ_DATE AS VARCHAR(10)),
                   CQFILE.CQ_START_TIME,
                   CQFILE.CQ_REV_DEL,
                   CQFILE.CQ_MISC_KEY_FLD,
                   CQFILE.CQ_REV_PDUE_DAYS,
                   CQFILE.CQ_REV_BAL,
                   CQFILE.CQ_SEQ,
                   CAST(CQFILE.CQ_LTOUCH_DATE AS VARCHAR(10)),
                   CQFILE.CQ_WORK_COLLID,
                   CQFILE.CQ_WORKED_FG,
                   CQFILE.CQ_IN_PROCESS,
                   CAST(CQFILE.CQ_DATE_QUEUED AS VARCHAR(10)),
                   CQFILE.CQ_TIME_ZONE_ERROR
            INTO :QCQ-REC
            FROM DBO.CQFILE
            WHERE CQFILE.CQ_BRNO = :QCQ-BRNO
              AND CQFILE.CQ_ACCTNO = :QCQ-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CQ1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-CQ-FIELDS.

      *-----------------------------------------------------------------
       READ-CQ1-FILE-NEXT.   *> SSP - CQ
           PERFORM READ-IT.
           MOVE CQ-PATH-OWNBR  TO CQ-BRNO.
           MOVE CQ-PATH-SQL    TO E-FILE.
           MOVE CQ1-KEY        TO E-KEYX.
           INITIALIZE QCQ-REC.

           EXEC SQL SET CONNECTION CQ1_CONNECT END-EXEC.

           IF ( CQ1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH CQ1_CURSOR
                   INTO :QCQ-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CQ1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-CQ-FIELDS.

      *-----------------------------------------------------------------
       WRITE-CQ1-FILE.
           MOVE CQ-PATH-OWNBR  TO CQ-BRNO.
           ACCEPT CQ-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM WRITE-IT.
           MOVE CQ-PATH-SQL    TO E-FILE.
           MOVE CQ1-KEY        TO E-KEYX.
           PERFORM SET-CQ-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            INSERT INTO DBO.CQFILE
             (CQFILE.CQ_BRNO,
              CQFILE.CQ_ACCTNO,
              CQFILE.CQ_COLLID,
              CQFILE.CQ_REV_BEHAVIOR_RISK,
              CQFILE.CQ_SEQ_FG,
              CQFILE.CQ_DATE,
              CQFILE.CQ_START_TIME,
              CQFILE.CQ_REV_DEL,
              CQFILE.CQ_MISC_KEY_FLD,
              CQFILE.CQ_REV_PDUE_DAYS,
              CQFILE.CQ_REV_BAL,
              CQFILE.CQ_SEQ,
              CQFILE.CQ_LTOUCH_DATE,
              CQFILE.CQ_WORK_COLLID,
              CQFILE.CQ_WORKED_FG,
              CQFILE.CQ_IN_PROCESS,
              CQFILE.CQ_DATE_QUEUED,
              CQFILE.CQ_TIME_ZONE_ERROR)
            VALUES
             (:QCQ-BRNO,
              :QCQ-ACCTNO,
              :QCQ-COLLID,
              :QCQ-REV-BEHAVIOR-RISK,
              :QCQ-SEQ-FG,
              :QCQ-DATE,
              :QCQ-START-TIME,
              :QCQ-REV-DEL,
              :QCQ-MISC-KEY-FLD,
              :QCQ-REV-PDUE-DAYS,
              :QCQ-REV-BAL,
              :QCQ-SEQ,
              :QCQ-LTOUCH-DATE,
              :QCQ-WORK-COLLID,
              :QCQ-WORKED-FG,
              :QCQ-IN-PROCESS,
              :QCQ-DATE-QUEUED,
              :QCQ-TIME-ZONE-ERROR)
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO WRITE-CQ1-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       DELETE-CQ1-FILE.

           MOVE CQ-PATH-OWNBR  TO CQ-BRNO.
           PERFORM DELETE-IT.
           MOVE CQ-PATH-SQL    TO E-FILE.
           MOVE CQ1-KEY        TO E-KEYX.

           PERFORM SET-CQ-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            DELETE FROM DBO.CQFILE
             WHERE CQFILE.CQ_BRNO = :QCQ-BRNO
               AND CQFILE.CQ_ACCTNO = :QCQ-ACCTNO
           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-CQ1-FILE.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *-----------------------------------------------------------------
       CLOSE-CQ1-FILE.

           PERFORM CLOSE-IT.

           IF ( CQ1-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION CQ1_CONNECT END-EXEC
              EXEC SQL
                   CLOSE CQ1_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO CQ1-CURSOR-STAT.

      *-----------------------------------------------------------------
       CLOSE-CQ1-CONNECTION.

           IF CQ1-CONN-OPEN-SW = "Y"
               EXEC SQL SET CONNECTION CQ1_CONNECT END-EXEC
               EXEC SQL COMMIT END-EXEC
               EXEC SQL DISCONNECT CQ1_CONNECT END-EXEC
               EXEC SQL SET CONNECTION C1 END-EXEC
               MOVE "N" TO CQ1-CONN-OPEN-SW.
      *-----------------------------------------------------------------


       COPY "LIBSP/SPCQS1IN.CPY".
      *-----------------------------------------------------------------
       DELETE-CQS1-FILE-BRANCH-ALL.

           PERFORM DELETE-IT.
           MOVE CQS-PATH-SQL    TO E-FILE.
           MOVE CQS1-KEY        TO E-KEYX.

           PERFORM SET-CQS-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            DELETE FROM DBO.CQSFILE
             WHERE CQSFILE.CQS_BRNO = :QCQS-BRNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-CQS1-FILE-BRANCH-ALL.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.
      *-----------------------------------------------------------------


      *COPY "LIBSP/SPGQ1IN.CPY".
      * COPYMEMBER: LIBSP/SPGQ1IN
       LOAD-GQ1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( GQ-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( GQ-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO GQ-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO GQ-ALL-MACHINE
              MOVE GQ-ALL-PATH             TO GQ-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( GQ-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO GQ-ALL-BASE
              MOVE FILPATH-MACHINE         TO GQ-ALL-MACHINE
              MOVE GQ-ALL-PATH             TO GQ-PATH.

      *-----------------------------------------------------------------
       OPEN-GQ1-FILE.
           PERFORM LOAD-GQ1-FILE.
           PERFORM OPEN-IT.
           MOVE GQ-PATH-SQL TO E-FILE.

           IF GQ1-CONN-OPEN-SW = "N" 
               EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS GQ1_CONNECT
                    USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
               END-EXEC
               MOVE "Y" TO GQ1-CONN-OPEN-SW
               EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-GQ1-FILE.   *> SSP - GQ
      * RETREIVE ALL FIELDS FROM GQFILE FOR A BRANCH VIA TEMP TABLE
      * THIS ALLOWS GQFILE TO BE UPDATED DURING FETCH/READ NEXT PROCESS
           PERFORM START-IT.
           MOVE GQ-PATH-SQL TO E-FILE.
           MOVE GQ1-KEY TO E-KEYX.

           IF ( GQ1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-GQ1-FILE.

      *     SELECT GQFILE.GQ_BRNO,
      *            GQFILE.GQ_ACCTNO,
      *            GQFILE.GQ_COLLID,
      *            GQFILE.GQ_SEQ_FG,
      *            CAST(GQFILE.GQ_DATE AS VARCHAR(10)) AS GQ_DATE,
      *            GQFILE.GQ_START_TIME,
      *            GQFILE.GQ_REV_DEL,
      *            GQFILE.GQ_MISC_KEY_FLD,
      *            GQFILE.GQ_REV_PDUE_DAYS,
      *            GQFILE.GQ_REV_BAL,
      *            GQFILE.GQ_SEQ,
      *            CAST(GQFILE.GQ_LTOUCH_DATE AS VARCHAR(10)) AS GQ_LTOUCH_DATE,
      *            GQFILE.GQ_WORK_COLLID,
      *            GQFILE.GQ_WORKED_FG,
      *            GQFILE.GQ_IN_PROCESS,
      *            CAST(GQFILE.GQ_DATE_QUEUED AS VARCHAR(10)) AS GQ_DATE_QUEUED,
      *            GQFILE.GQ_TIME_ZONE_ERROR
      *      INTO #TEMP_CQRUN_GQFILE
      *        FROM DBO.GQFILE GQFILE
      *        WHERE GQFILE.GQ_BRNO = @BEG_BRNO;
      *   SELECT *
      *   FROM #TEMP_CQRUN_GQFILE
      *   ORDER BY GQ_ACCTNO;

           EXEC SQL SET CONNECTION GQ1_CONNECT END-EXEC.

           EXEC SQL
            DECLARE GQ1_CURSOR CURSOR FOR
                :GQ1-RETURN-CODE = 
                 EXEC SSP_CQRUN_GQFILE_SELECT_BRANCH_ALL
                  (:QGQ1-WBEG-BRNO) 
           END-EXEC.

           EXEC SQL
               OPEN GQ1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           MOVE ZEROES TO QGQ1-WBEG-BRNO.

           MOVE STAT---GOOD TO GQ1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-GQ1-FILE.  *> EMBEDDED - GQ
           PERFORM READ-IT.
           MOVE GQ-PATH-SQL TO E-FILE.
           MOVE GQ1-KEY TO E-KEYX.
           INITIALIZE QGQ-REC.

           MOVE GQ-BRNO       TO QGQ-BRNO.  
           MOVE GQ-ACCTNO     TO QGQ-ACCTNO. 

           EXEC SQL
            SELECT GQFILE.GQ_BRNO,
                   GQFILE.GQ_ACCTNO,
                   GQFILE.GQ_COLLID,
                   GQFILE.GQ_SEQ_FG,
                   CAST(GQFILE.GQ_DATE AS VARCHAR(10)),
                   GQFILE.GQ_START_TIME,
                   GQFILE.GQ_REV_DEL,
                   GQFILE.GQ_MISC_KEY_FLD,
                   GQFILE.GQ_REV_PDUE_DAYS,
                   GQFILE.GQ_REV_BAL,
                   GQFILE.GQ_SEQ,
                   CAST(GQFILE.GQ_LTOUCH_DATE AS VARCHAR(10)),
                   GQFILE.GQ_WORK_COLLID,
                   GQFILE.GQ_WORKED_FG,
                   GQFILE.GQ_IN_PROCESS,
                   CAST(GQFILE.GQ_DATE_QUEUED AS VARCHAR(10)),
                   GQFILE.GQ_TIME_ZONE_ERROR
            INTO :QGQ-REC
            FROM DBO.GQFILE
            WHERE GQFILE.GQ_BRNO = :QGQ-BRNO
              AND GQFILE.GQ_ACCTNO = :QGQ-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GQ1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-GQ-FIELDS.

      *-----------------------------------------------------------------
       READ-GQ1-FILE-NEXT.  *> SSP - GQ 
           PERFORM READ-IT.
           MOVE GQ-PATH-SQL TO E-FILE.
           MOVE GQ1-KEY TO E-KEYX.

           INITIALIZE QGQ-REC.

           EXEC SQL SET CONNECTION GQ1_CONNECT END-EXEC.

           IF ( GQ1-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH GQ1_CURSOR INTO :QGQ-REC
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-GQ1-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-GQ-FIELDS.

      *-----------------------------------------------------------------
       WRITE-GQ1-FILE.   

           ACCEPT GQ-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM WRITE-IT.
           MOVE GQ-PATH-SQL TO E-FILE.
           MOVE GQ1-KEY TO E-KEYX.
           PERFORM SET-GQ-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            INSERT INTO DBO.GQFILE
             (GQFILE.GQ_BRNO,
              GQFILE.GQ_ACCTNO,
              GQFILE.GQ_COLLID,
              GQFILE.GQ_SEQ_FG,
              GQFILE.GQ_DATE,
              GQFILE.GQ_START_TIME,
              GQFILE.GQ_REV_DEL,
              GQFILE.GQ_MISC_KEY_FLD,
              GQFILE.GQ_REV_PDUE_DAYS,
              GQFILE.GQ_REV_BAL,
              GQFILE.GQ_SEQ,
              GQFILE.GQ_LTOUCH_DATE,
              GQFILE.GQ_WORK_COLLID,
              GQFILE.GQ_WORKED_FG,
              GQFILE.GQ_IN_PROCESS,
              GQFILE.GQ_DATE_QUEUED,
              GQFILE.GQ_TIME_ZONE_ERROR)
            VALUES
             (:QGQ-BRNO,
              :QGQ-ACCTNO,
              :QGQ-COLLID,
              :QGQ-SEQ-FG,
              :QGQ-DATE,
              :QGQ-START-TIME,
              :QGQ-REV-DEL,
              :QGQ-MISC-KEY-FLD,
              :QGQ-REV-PDUE-DAYS,
              :QGQ-REV-BAL,
              :QGQ-SEQ,
              :QGQ-LTOUCH-DATE,
              :QGQ-WORK-COLLID,
              :QGQ-WORKED-FG,
              :QGQ-IN-PROCESS,
              :QGQ-DATE-QUEUED,
              :QGQ-TIME-ZONE-ERROR)
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.


           IF ( IO-FG = 8 )     *> LOCKED
              GO TO WRITE-GQ1-FILE.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       DELETE-GQ1-FILE.

           PERFORM DELETE-IT.
           MOVE GQ-PATH-SQL TO E-FILE.
           MOVE GQ1-KEY TO E-KEYX.

           PERFORM SET-GQ-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
             DELETE FROM DBO.GQFILE
             WHERE GQFILE.GQ_BRNO = :QGQ-BRNO
               AND GQFILE.GQ_ACCTNO = :QGQ-ACCTNO
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-GQ1-FILE.

      *-----------------------------------------------------------------
       CLOSE-GQ1-FILE.

           PERFORM CLOSE-IT.

           IF ( GQ1-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION GQ1_CONNECT END-EXEC
              EXEC SQL
                   CLOSE GQ1_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO GQ1-CURSOR-STAT.

      *-----------------------------------------------------------------
       CLOSE-GQ1-CONNECTION.

           IF GQ1-CONN-OPEN-SW = "Y"
               EXEC SQL SET CONNECTION GQ1_CONNECT END-EXEC
               EXEC SQL COMMIT END-EXEC
               EXEC SQL DISCONNECT GQ1_CONNECT END-EXEC
               EXEC SQL SET CONNECTION C1 END-EXEC
               MOVE "N" TO GQ1-CONN-OPEN-SW.
      *-----------------------------------------------------------------


       COPY "LIBSP/SPGQS1IN.CPY".
      *-----------------------------------------------------------------
       DELETE-GQS1-FILE-ALL.

           PERFORM DELETE-IT.
           MOVE GQS-PATH-SQL TO E-FILE.
           MOVE SPACES TO E-KEYX.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            DELETE FROM DBO.GQSFILE
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO DELETE-GQS1-FILE-ALL.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *-----------------------------------------------------------------


      * COPY "LIBSP/SPCP1IN.CPY".
      * COPYMEMBER: LIBSP/SPCP1IN
      ******************************************************************
      * NOTE: CP-PATH-OVERRIDE = "G" MEANS USE GLOBAL VERSION (GCPFILE)
      * BLM 210723 IF CP-PATH-OVERRIDE = "B" MOVE CP-PATH-OWNBR TO CP-BRNO
      *            ELSE MOVE 0
      ******************************************************************
       LOAD-CP1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( CP-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( CP-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO CP-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO CP-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO CP-ALL-DATA
              MOVE CP-ALL-PATH             TO CP-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( CP-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO CP-ALL-BASE
              MOVE FILPATH-MACHINE         TO CP-ALL-MACHINE
              MOVE FILPATH-DATA            TO CP-ALL-DATA
              MOVE CP-ALL-PATH             TO CP-PATH.

      *-----------------------------------------------------------------
       OPEN-CP1-FILE.
           PERFORM LOAD-CP1-FILE.
           PERFORM OPEN-IT.
           MOVE CP-PATH-SQL TO E-FILE.

           IF CP1-CONN-OPEN-SW = "N" 
               EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS CP1_CONNECT
                    USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
               END-EXEC
               MOVE "Y" TO CP1-CONN-OPEN-SW
               EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-CP1-FILE.  *> SSP - CP
           PERFORM START-IT.
      *     IF ( CP-PATH-OVERRIDE NOT = "G" )
      *        MOVE CP-PATH-OWNBR  TO CP-BRNO
      *     ELSE
      *        MOVE 0              TO CP-BRNO.
           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.

           IF ( CP1-CURSOR-STAT-GOOD )
              PERFORM CLOSE-CP1-FILE.

      *     SELECT CPFILE.CP_BRNO,
      *            CPFILE.CP_ID,
      *            CPFILE.CP_COL_ID_1,
      *            CPFILE.CP_COL_ID_2,
      *            CPFILE.CP_COL_ID_3,
      *            CPFILE.CP_COL_ID_4,
      *            CPFILE.CP_COL_ID_5,
      *            CPFILE.CP_COL_ID_6,
      *            CPFILE.CP_COL_ID_7,
      *            CPFILE.CP_COL_ID_8,
      *            CPFILE.CP_COL_ID_9,
      *            CPFILE.CP_COL_ID_10,
      *            CPFILE.CP_COL_ID_11,
      *            CPFILE.CP_COL_ID_12,
      *            CPFILE.CP_COL_ID_13,
      *            CPFILE.CP_COL_ID_14,
      *            CPFILE.CP_COL_ID_15,
      *            CPFILE.CP_COL_ID_16,
      *            CPFILE.CP_COL_ID_17,
      *            CPFILE.CP_COL_ID_18,
      *            CPFILE.CP_COL_ID_19,
      *            CPFILE.CP_COL_ID_20,
      *            CPFILE.CP_COL_ID_21,
      *            CPFILE.CP_COL_ID_22,
      *            CPFILE.CP_COL_ID_23,
      *            CPFILE.CP_COL_ID_24,
      *            CPFILE.CP_COL_ID_25,
      *            CPFILE.CP_COL_ID_26,
      *            CPFILE.CP_COL_ID_27,
      *            CPFILE.CP_COL_ID_28,
      *            CPFILE.CP_COL_ID_29,
      *            CPFILE.CP_COL_ID_30,
      *            CPFILE.CP_COL_ID_31,
      *            CPFILE.CP_COL_ID_32,
      *            CPFILE.CP_COL_ID_33,
      *            CPFILE.CP_COL_ID_34,
      *            CPFILE.CP_COL_ID_35,
      *            CPFILE.CP_COL_ID_36,
      *            CPFILE.CP_COL_ID_37,
      *            CPFILE.CP_COL_ID_38,
      *            CPFILE.CP_COL_ID_39,
      *            CPFILE.CP_COL_ID_40,
      *            CPFILE.CP_COL_ID_41,
      *            CPFILE.CP_COL_ID_42,
      *            CPFILE.CP_COL_ID_43,
      *            CPFILE.CP_COL_ID_44,
      *            CPFILE.CP_COL_ID_45,
      *            CPFILE.CP_COL_ID_46,
      *            CPFILE.CP_COL_ID_47,
      *            CPFILE.CP_COL_ID_48,
      *            CPFILE.CP_COL_ID_49,
      *            CPFILE.CP_COL_ID_50,
      *            CPFILE.CP_COL_ID_51,
      *            CPFILE.CP_COL_ID_52,
      *            CPFILE.CP_COL_ID_53,
      *            CPFILE.CP_COL_ID_54,
      *            CPFILE.CP_COL_ID_55,
      *            CPFILE.CP_COL_ID_56,
      *            CPFILE.CP_COL_ID_57,
      *            CPFILE.CP_COL_ID_58,
      *            CPFILE.CP_COL_ID_59,
      *            CPFILE.CP_COL_ID_60,
      *            CPFILE.CP_COL_ID_61,
      *            CPFILE.CP_COL_ID_62,
      *            CPFILE.CP_COL_ID_63,
      *            CPFILE.CP_COL_ID_64,
      *            CPFILE.CP_COL_ID_65,
      *            CPFILE.CP_COL_ID_66,
      *            CPFILE.CP_COL_ID_67,
      *            CPFILE.CP_COL_ID_68,
      *            CPFILE.CP_COL_ID_69,
      *            CPFILE.CP_COL_ID_70,
      *            CPFILE.CP_COL_ID_71,
      *            CPFILE.CP_COL_ID_72,
      *            CPFILE.CP_COL_ID_73,
      *            CPFILE.CP_COL_ID_74,
      *            CPFILE.CP_COL_ID_75,
      *            CPFILE.CP_COL_ID_76,
      *            CPFILE.CP_COL_ID_77,
      *            CPFILE.CP_COL_ID_78,
      *            CPFILE.CP_COL_ID_79,
      *            CPFILE.CP_COL_ID_80
      *         INTO #TEMP_CQRUN_CPFILE
      *         FROM DBO.EAFILE EAFILE
      *         INNER JOIN DBO.CPFILE CPFILE
      *          ON CPFILE.CP_BRNO = EAFILE.EA_BRANCH
      *          AND CPFILE.CP_ID  = EAFILE.EA_COL_POOL
      *         WHERE EAFILE.EA_BRANCH = @WBEG_BRNO
      *          AND EAFILE.EA_CLASS BETWEEN @WBEG_CLASS AND @WEND_CLASS
      *          AND EAFILE.EA_GROUP_ID = @GROUP_ID;
      *     SELECT *
      *     FROM #TEMP_CQRUN_CPFILE
      *     ORDER BY CP_ID;

           EXEC SQL SET CONNECTION CP1_CONNECT END-EXEC.

           EXEC SQL
            DECLARE CP1_CURSOR CURSOR FOR
                :CP1-RETURN-CODE = 
                 EXEC SSP_CQRUN_CPFILE_SELECT
                  (:QCP1-WBEG-BRNO, 
                   :PASS-BEG-CLASS, :PASS-END-CLASS,
                   :PASS-GROUP-ID) 
                END-EXEC.

           EXEC SQL
               OPEN CP1_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           MOVE STAT---GOOD TO CP1-CURSOR-STAT.

      *-----------------------------------------------------------------
       READ-CP1-FILE.  *> EMBEDDED  CP
           PERFORM READ-IT.
           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE CP-PATH-OWNBR  TO CP-BRNO
           ELSE
              MOVE 0              TO CP-BRNO.
           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.
           INITIALIZE QCP-REC.

           MOVE CP-BRNO   TO QCP-BRNO.
           MOVE CP-ID     TO QCP-ID.

           EXEC SQL
            SELECT CPFILE.CP_BRNO,
                   CPFILE.CP_ID,
                   CAST(CPFILE.CP_LTOUCH_DATE AS VARCHAR(10)),
                   CPFILE.CP_DESC,
                   CPFILE.CP_COL_ID_1,
                   CPFILE.CP_COL_ID_2,
                   CPFILE.CP_COL_ID_3,
                   CPFILE.CP_COL_ID_4,
                   CPFILE.CP_COL_ID_5,
                   CPFILE.CP_COL_ID_6,
                   CPFILE.CP_COL_ID_7,
                   CPFILE.CP_COL_ID_8,
                   CPFILE.CP_COL_ID_9,
                   CPFILE.CP_COL_ID_10,
                   CPFILE.CP_COL_ID_11,
                   CPFILE.CP_COL_ID_12,
                   CPFILE.CP_COL_ID_13,
                   CPFILE.CP_COL_ID_14,
                   CPFILE.CP_COL_ID_15,
                   CPFILE.CP_COL_ID_16,
                   CPFILE.CP_COL_ID_17,
                   CPFILE.CP_COL_ID_18,
                   CPFILE.CP_COL_ID_19,
                   CPFILE.CP_COL_ID_20,
                   CPFILE.CP_COL_ID_21,
                   CPFILE.CP_COL_ID_22,
                   CPFILE.CP_COL_ID_23,
                   CPFILE.CP_COL_ID_24,
                   CPFILE.CP_COL_ID_25,
                   CPFILE.CP_COL_ID_26,
                   CPFILE.CP_COL_ID_27,
                   CPFILE.CP_COL_ID_28,
                   CPFILE.CP_COL_ID_29,
                   CPFILE.CP_COL_ID_30,
                   CPFILE.CP_COL_ID_31,
                   CPFILE.CP_COL_ID_32,
                   CPFILE.CP_COL_ID_33,
                   CPFILE.CP_COL_ID_34,
                   CPFILE.CP_COL_ID_35,
                   CPFILE.CP_COL_ID_36,
                   CPFILE.CP_COL_ID_37,
                   CPFILE.CP_COL_ID_38,
                   CPFILE.CP_COL_ID_39,
                   CPFILE.CP_COL_ID_40,
                   CPFILE.CP_COL_ID_41,
                   CPFILE.CP_COL_ID_42,
                   CPFILE.CP_COL_ID_43,
                   CPFILE.CP_COL_ID_44,
                   CPFILE.CP_COL_ID_45,
                   CPFILE.CP_COL_ID_46,
                   CPFILE.CP_COL_ID_47,
                   CPFILE.CP_COL_ID_48,
                   CPFILE.CP_COL_ID_49,
                   CPFILE.CP_COL_ID_50,
                   CPFILE.CP_COL_ID_51,
                   CPFILE.CP_COL_ID_52,
                   CPFILE.CP_COL_ID_53,
                   CPFILE.CP_COL_ID_54,
                   CPFILE.CP_COL_ID_55,
                   CPFILE.CP_COL_ID_56,
                   CPFILE.CP_COL_ID_57,
                   CPFILE.CP_COL_ID_58,
                   CPFILE.CP_COL_ID_59,
                   CPFILE.CP_COL_ID_60,
                   CPFILE.CP_COL_ID_61,
                   CPFILE.CP_COL_ID_62,
                   CPFILE.CP_COL_ID_63,
                   CPFILE.CP_COL_ID_64,
                   CPFILE.CP_COL_ID_65,
                   CPFILE.CP_COL_ID_66,
                   CPFILE.CP_COL_ID_67,
                   CPFILE.CP_COL_ID_68,
                   CPFILE.CP_COL_ID_69,
                   CPFILE.CP_COL_ID_70,
                   CPFILE.CP_COL_ID_71,
                   CPFILE.CP_COL_ID_72,
                   CPFILE.CP_COL_ID_73,
                   CPFILE.CP_COL_ID_74,
                   CPFILE.CP_COL_ID_75,
                   CPFILE.CP_COL_ID_76,
                   CPFILE.CP_COL_ID_77,
                   CPFILE.CP_COL_ID_78,
                   CPFILE.CP_COL_ID_79,
                   CPFILE.CP_COL_ID_80,
                   CPFILE.CP_ALPHA_FLAG,
                   CPFILE.CP_TOTAL_ACCOUNTS,
                   CPFILE.CP_COLLECTOR_COUNT,
                   CPFILE.CP_LAST_SUBSCRIPT
            INTO :QCP-REC
            FROM DBO.CPFILE
            WHERE CPFILE.CP_BRNO = :QCP-BRNO 
              AND CPFILE.CP_ID = :QCP-ID
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CP1-FILE.

           IF ( IO-FG = 0 )
              PERFORM GET-CP-FIELDS.

      *-----------------------------------------------------------------
       READ-CP1-FILE-NEXT.   *> SSP - CP
           PERFORM READ-IT.
           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE CP-PATH-OWNBR  TO CP-BRNO
           ELSE
              MOVE 0 TO CP-BRNO.
           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.
           INITIALIZE QCP-REC.

           IF ( CP1-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION CP1_CONNECT END-EXEC
              EXEC SQL
                 FETCH CP1_CURSOR INTO 
                   :QCP-BRNO,
                   :QCP-ID,
                   :QCP-COL-ID-1,
                   :QCP-COL-ID-2,
                   :QCP-COL-ID-3,
                   :QCP-COL-ID-4,
                   :QCP-COL-ID-5,
                   :QCP-COL-ID-6,
                   :QCP-COL-ID-7,
                   :QCP-COL-ID-8,
                   :QCP-COL-ID-9,
                   :QCP-COL-ID-10,
                   :QCP-COL-ID-11,
                   :QCP-COL-ID-12,
                   :QCP-COL-ID-13,
                   :QCP-COL-ID-14,
                   :QCP-COL-ID-15,
                   :QCP-COL-ID-16,
                   :QCP-COL-ID-17,
                   :QCP-COL-ID-18,
                   :QCP-COL-ID-19,
                   :QCP-COL-ID-20,
                   :QCP-COL-ID-21,
                   :QCP-COL-ID-22,
                   :QCP-COL-ID-23,
                   :QCP-COL-ID-24,
                   :QCP-COL-ID-25,
                   :QCP-COL-ID-26,
                   :QCP-COL-ID-27,
                   :QCP-COL-ID-28,
                   :QCP-COL-ID-29,
                   :QCP-COL-ID-30,
                   :QCP-COL-ID-31,
                   :QCP-COL-ID-32,
                   :QCP-COL-ID-33,
                   :QCP-COL-ID-34,
                   :QCP-COL-ID-35,
                   :QCP-COL-ID-36,
                   :QCP-COL-ID-37,
                   :QCP-COL-ID-38,
                   :QCP-COL-ID-39,
                   :QCP-COL-ID-40,
                   :QCP-COL-ID-41,
                   :QCP-COL-ID-42,
                   :QCP-COL-ID-43,
                   :QCP-COL-ID-44,
                   :QCP-COL-ID-45,
                   :QCP-COL-ID-46,
                   :QCP-COL-ID-47,
                   :QCP-COL-ID-48,
                   :QCP-COL-ID-49,
                   :QCP-COL-ID-50,
                   :QCP-COL-ID-51,
                   :QCP-COL-ID-52,
                   :QCP-COL-ID-53,
                   :QCP-COL-ID-54,
                   :QCP-COL-ID-55,
                   :QCP-COL-ID-56,
                   :QCP-COL-ID-57,
                   :QCP-COL-ID-58,
                   :QCP-COL-ID-59,
                   :QCP-COL-ID-60,
                   :QCP-COL-ID-61,
                   :QCP-COL-ID-62,
                   :QCP-COL-ID-63,
                   :QCP-COL-ID-64,
                   :QCP-COL-ID-65,
                   :QCP-COL-ID-66,
                   :QCP-COL-ID-67,
                   :QCP-COL-ID-68,
                   :QCP-COL-ID-69,
                   :QCP-COL-ID-70,
                   :QCP-COL-ID-71,
                   :QCP-COL-ID-72,
                   :QCP-COL-ID-73,
                   :QCP-COL-ID-74,
                   :QCP-COL-ID-75,
                   :QCP-COL-ID-76,
                   :QCP-COL-ID-77,
                   :QCP-COL-ID-78,
                   :QCP-COL-ID-79,
                   :QCP-COL-ID-80
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-CP1-FILE-NEXT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

           IF ( IO-FG = 0 )
              PERFORM GET-CP-FIELDS.

      *-----------------------------------------------------------------
       REWRITE-CP1-FILE.   

           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE CP-PATH-OWNBR  TO CP-BRNO
           ELSE
              MOVE 0              TO CP-BRNO.
           ACCEPT CP-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.
           PERFORM SET-CP-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.CPFILE
             SET
              CPFILE.CP_LTOUCH_DATE = :QCP-LTOUCH-DATE,
              CPFILE.CP_DESC     = :QCP-DESC,
              CPFILE.CP_COL_ID_1 = :QCP-COL-ID-1,
              CPFILE.CP_COL_ID_2 = :QCP-COL-ID-2,
              CPFILE.CP_COL_ID_3 = :QCP-COL-ID-3,
              CPFILE.CP_COL_ID_4 = :QCP-COL-ID-4,
              CPFILE.CP_COL_ID_5 = :QCP-COL-ID-5,
              CPFILE.CP_COL_ID_6 = :QCP-COL-ID-6,
              CPFILE.CP_COL_ID_7 = :QCP-COL-ID-7,
              CPFILE.CP_COL_ID_8 = :QCP-COL-ID-8,
              CPFILE.CP_COL_ID_9 = :QCP-COL-ID-9,
              CPFILE.CP_COL_ID_10 = :QCP-COL-ID-10,
              CPFILE.CP_COL_ID_11 = :QCP-COL-ID-11,
              CPFILE.CP_COL_ID_12 = :QCP-COL-ID-12,
              CPFILE.CP_COL_ID_13 = :QCP-COL-ID-13,
              CPFILE.CP_COL_ID_14 = :QCP-COL-ID-14,
              CPFILE.CP_COL_ID_15 = :QCP-COL-ID-15,
              CPFILE.CP_COL_ID_16 = :QCP-COL-ID-16,
              CPFILE.CP_COL_ID_17 = :QCP-COL-ID-17,
              CPFILE.CP_COL_ID_18 = :QCP-COL-ID-18,
              CPFILE.CP_COL_ID_19 = :QCP-COL-ID-19,
              CPFILE.CP_COL_ID_20 = :QCP-COL-ID-20,
              CPFILE.CP_COL_ID_21 = :QCP-COL-ID-21,
              CPFILE.CP_COL_ID_22 = :QCP-COL-ID-22,
              CPFILE.CP_COL_ID_23 = :QCP-COL-ID-23,
              CPFILE.CP_COL_ID_24 = :QCP-COL-ID-24,
              CPFILE.CP_COL_ID_25 = :QCP-COL-ID-25,
              CPFILE.CP_COL_ID_26 = :QCP-COL-ID-26,
              CPFILE.CP_COL_ID_27 = :QCP-COL-ID-27,
              CPFILE.CP_COL_ID_28 = :QCP-COL-ID-28,
              CPFILE.CP_COL_ID_29 = :QCP-COL-ID-29,
              CPFILE.CP_COL_ID_30 = :QCP-COL-ID-30,
              CPFILE.CP_COL_ID_31 = :QCP-COL-ID-31,
              CPFILE.CP_COL_ID_32 = :QCP-COL-ID-32,
              CPFILE.CP_COL_ID_33 = :QCP-COL-ID-33,
              CPFILE.CP_COL_ID_34 = :QCP-COL-ID-34,
              CPFILE.CP_COL_ID_35 = :QCP-COL-ID-35,
              CPFILE.CP_COL_ID_36 = :QCP-COL-ID-36,
              CPFILE.CP_COL_ID_37 = :QCP-COL-ID-37,
              CPFILE.CP_COL_ID_38 = :QCP-COL-ID-38,
              CPFILE.CP_COL_ID_39 = :QCP-COL-ID-39,
              CPFILE.CP_COL_ID_40 = :QCP-COL-ID-40,
              CPFILE.CP_COL_ID_41 = :QCP-COL-ID-41,
              CPFILE.CP_COL_ID_42 = :QCP-COL-ID-42,
              CPFILE.CP_COL_ID_43 = :QCP-COL-ID-43,
              CPFILE.CP_COL_ID_44 = :QCP-COL-ID-44,
              CPFILE.CP_COL_ID_45 = :QCP-COL-ID-45,
              CPFILE.CP_COL_ID_46 = :QCP-COL-ID-46,
              CPFILE.CP_COL_ID_47 = :QCP-COL-ID-47,
              CPFILE.CP_COL_ID_48 = :QCP-COL-ID-48,
              CPFILE.CP_COL_ID_49 = :QCP-COL-ID-49,
              CPFILE.CP_COL_ID_50 = :QCP-COL-ID-50,
              CPFILE.CP_COL_ID_51 = :QCP-COL-ID-51,
              CPFILE.CP_COL_ID_52 = :QCP-COL-ID-52,
              CPFILE.CP_COL_ID_53 = :QCP-COL-ID-53,
              CPFILE.CP_COL_ID_54 = :QCP-COL-ID-54,
              CPFILE.CP_COL_ID_55 = :QCP-COL-ID-55,
              CPFILE.CP_COL_ID_56 = :QCP-COL-ID-56,
              CPFILE.CP_COL_ID_57 = :QCP-COL-ID-57,
              CPFILE.CP_COL_ID_58 = :QCP-COL-ID-58,
              CPFILE.CP_COL_ID_59 = :QCP-COL-ID-59,
              CPFILE.CP_COL_ID_60 = :QCP-COL-ID-60,
              CPFILE.CP_COL_ID_61 = :QCP-COL-ID-61,
              CPFILE.CP_COL_ID_62 = :QCP-COL-ID-62,
              CPFILE.CP_COL_ID_63 = :QCP-COL-ID-63,
              CPFILE.CP_COL_ID_64 = :QCP-COL-ID-64,
              CPFILE.CP_COL_ID_65 = :QCP-COL-ID-65,
              CPFILE.CP_COL_ID_66 = :QCP-COL-ID-66,
              CPFILE.CP_COL_ID_67 = :QCP-COL-ID-67,
              CPFILE.CP_COL_ID_68 = :QCP-COL-ID-68,
              CPFILE.CP_COL_ID_69 = :QCP-COL-ID-69,
              CPFILE.CP_COL_ID_70 = :QCP-COL-ID-70,
              CPFILE.CP_COL_ID_71 = :QCP-COL-ID-71,
              CPFILE.CP_COL_ID_72 = :QCP-COL-ID-72,
              CPFILE.CP_COL_ID_73 = :QCP-COL-ID-73,
              CPFILE.CP_COL_ID_74 = :QCP-COL-ID-74,
              CPFILE.CP_COL_ID_75 = :QCP-COL-ID-75,
              CPFILE.CP_COL_ID_76 = :QCP-COL-ID-76,
              CPFILE.CP_COL_ID_77 = :QCP-COL-ID-77,
              CPFILE.CP_COL_ID_78 = :QCP-COL-ID-78,
              CPFILE.CP_COL_ID_79 = :QCP-COL-ID-79,
              CPFILE.CP_COL_ID_80 = :QCP-COL-ID-80,
              CPFILE.CP_ALPHA_FLAG = :QCP-ALPHA-FLAG,
              CPFILE.CP_TOTAL_ACCOUNTS  = :QCP-TOTAL-ACCOUNTS,
              CPFILE.CP_COLLECTOR_COUNT = :QCP-COLLECTOR-COUNT,
              CPFILE.CP_LAST_SUBSCRIPT  = :QCP-LAST-SUBSCRIPT

             WHERE CPFILE.CP_BRNO = :QCP-BRNO 
               AND CPFILE.CP_ID = :QCP-ID

           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-CP1-FILE.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       REWRITE-CP1-FILE-LAST-SUB.

           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE CP-PATH-OWNBR  TO CP-BRNO
           ELSE
              MOVE 0              TO CP-BRNO.
           ACCEPT CP-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.

           PERFORM SET-CP-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.CPFILE
             SET CPFILE.CP_LTOUCH_DATE    = :QCP-LTOUCH-DATE,
                 CPFILE.CP_LAST_SUBSCRIPT = :QCP-LAST-SUBSCRIPT

             WHERE CPFILE.CP_BRNO = :QCP-BRNO 
               AND CPFILE.CP_ID = :QCP-ID

           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-CP1-FILE-LAST-SUB.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       REWRITE-CP1-FILE-INIT-CP.

           IF ( CP-PATH-OVERRIDE NOT = "G" )
              MOVE CP-PATH-OWNBR  TO CP-BRNO
           ELSE
              MOVE 0              TO CP-BRNO.
           ACCEPT CP-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.

           MOVE CP-PATH-SQL    TO E-FILE.
           MOVE CP1-KEY        TO E-KEYX.
 
           PERFORM SET-CP-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW. 
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.CPFILE
             SET
              CPFILE.CP_LTOUCH_DATE     = :QCP-LTOUCH-DATE,
              CPFILE.CP_COLLECTOR_COUNT = :QCP-COLLECTOR-COUNT,
              CPFILE.CP_LAST_SUBSCRIPT  = :QCP-LAST-SUBSCRIPT

             WHERE CPFILE.CP_BRNO = :QCP-BRNO 
               AND CPFILE.CP_ID = :QCP-ID

           END-EXEC.
           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-CP1-FILE-INIT-CP.

      * CHANGE CONNECTION BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       CLOSE-CP1-FILE.

           PERFORM CLOSE-IT.

           IF ( CP1-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION CP1_CONNECT END-EXEC
              EXEC SQL
                   CLOSE CP1_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO CP1-CURSOR-STAT.

      *-----------------------------------------------------------------
       CLOSE-CP1-CONNECTION.

           IF CP1-CONN-OPEN-SW = "Y"
               EXEC SQL SET CONNECTION CP1_CONNECT END-EXEC
               EXEC SQL COMMIT END-EXEC
               EXEC SQL DISCONNECT CP1_CONNECT END-EXEC
               EXEC SQL SET CONNECTION C1 END-EXEC
               MOVE "N" TO CP1-CONN-OPEN-SW.
      *-----------------------------------------------------------------

       COPY "LIBLP/LPSP1RN.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBGB/GBGBRN.CPY".
       COPY "LIBLP/LPBW1RN.CPY".
       COPY "LIBLP/LPFD1RN.CPY".
       COPY "LIBLP/LPLTI1RN.CPY".
       COPY "LIBLP/LPLTP1RN.CPY".
       COPY "LIBSP/SPCQ2RN.CPY".
       COPY "LIBSP/SPVCQ1IN.CPY".
      *COPY "LIBSP/SPVCQ2RN.CPY".
       COPY "LIBSP/SPGQ2RN.CPY".
       COPY "LIBLP/LPCD1RN.CPY".
       COPY "LIBLP/LPFM1IN.CPY".
       COPY "LIBLP/LPLP1RN.CPY".
       COPY "LIBLP/LPTZ1RN.CPY".
       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO EXT-EOBUF-ERRCD.

      ******************************************************************
       END-PROGRAM SECTION.
      ******************************************************************

      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           MOVE "GB/TIMER" TO FORM-NAM.
           CALL FORM-PROGX USING P-TIMER-LINK-BUF.
           CANCEL FORM-PROGX.
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
           PERFORM CLOSE-FILES.

           PERFORM REMOVE-VGQ1-FILE.

       EXIT-PROG.
           IF SV-BEG-BR NOT = 9999
              MOVE SV-BEG-BR TO BEG-BRANCH
              MOVE SV-END-BR TO END-BRANCH.

           IF EXT-ROUTE-BUF = "00"
              MOVE "LP/LPCPMU" TO FORM-NAM
              MOVE FORM-PATH TO FORM-PATHNAME.

       STOP-RUN.
           IF EXT-ROUTE-BUF = "00" OR "40" OR "50"
              DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN
              DESTROY CQRUN-SCREEN
              DESTROY EXT-EOBUF-WINDOW-HANDLE.
           EXIT PROGRAM.
