       IDENTIFICATION DIVISION.
       PROGRAM-ID.      LONIJ0.
       DATE-WRITTEN.    012484.
      **************************************************************************
      *                 (LP)
      *  DESCRIPTION:   SALES FINANCE LOAN
      *                 CONVERSION - PAGE 1
      * REV:
      *  010294 JTG ADDED GB-DLALLOC-GL  (FAIRCO)
      *  031094 JTG FIXED SO LOAN NO ASSIGNMENT DOS'T HAPPEN ON SEQNO 2 & >
      *  072794 JTG SP-ERNFRMLA = 15, REAL INTEREST BEARING METHOD
      *                                                  - INSTANT AUTO, FL
      *  111794 JTG SP-ERNFRMLA = 16, REAL INTEREST BEARING METHOD
      *             DISCOUNT EARNINGS A % OF PRINCIPAL PAID FAIRCO, FL
      *  051295 SLC ADDED INSURANCE CHECK. MUST HAVE A&H AND LIFE,
      *             IF BRANCH OPTION IS ON.
      *  081095 MJD ADDED LOGIC FOR GP-THE-ONLY-SF-SRCD
      *  082395 JTG ADDED LOGIC FOR BR-AH-AND-CL
      *  MJD 091895 ADDED DS-DATE-CCYYMM LOGIC.
      *  MJD 010996 ADDED LOGIC TO COMPUTE COMMISSION ONLY IF
      *              LN-INSOURS() = "Y"
      *             ADDED LOGIC TO PREVENT ENTRY OF "MN_" AS INS TYPE.
      *  JFF 011796 ADDED CODE SCAN FOR PURPOSE, SOURCE, AND COLLATERAL.
      *  012596 BAH DONT ALLOW ANY PARTICIPATION ON "IB" LOANS !! (RSVENT)
      *             #E094
      *  012596 BAH PASSWORDED 1STPYDATE < 30 DAYS FROM LOANDATE, E097
      *  MJD 031196 ADDED LOGIC TO STOP ENTRY OF 0 AS ACCOUNT NUMBER.
      *  MJD 032896 ADDED LIBLP/PURFLDW. WORKER TO HOLD LN-REC FIELDS THAT
      *             ARE CHANGED/MODIFIED IN COMPUTE-PURCHASE-FIELDS.
      *  JTG 032896 ADDED SET OF PURFLD--FG FIELDS
      *  MJD 040896 ADDED TEST OF DL-AFP-DEALER AND LC-AFP-DEALER.
      *  MJD 041996 ADDED GP-DLR-DISC-TYPE.
      *  MJD 101596 ADDED MOVE OF LN-REC TO ORIGINAL-LN-REC WHEN
      *             LOAN IS CALLED FROM SCAN. CHANGED TO ONLY MOVE
      *             SP-JUDGRATE TO LN-JDRATE IF LN-JDDATE = 0.
      *             ADDED F3-LOAN STATUS OPTION TO CALL WI/LNSTAT.C
      *  MJD 101796 CHANGED TEST OF DL-RVCHGS-CODE = "B" TO " ", THIS WAS A BUG
      *  JTG 101196 ADDED FOR LPCERN-- A50 VERSION
      *                   SP-ERNFRMLA 15 & 16, REAL INTEREST BEARINGING METHOD
      *  BLV 111396 CODE SCAN WRONG FROM FEE ENTRY WINDOW; CHANGED CODE-SCAN TO
      *             BE ELCODE-SCAN & CD-SCAN TO BE CODE-SCAN
      *  BLV 111396 FIX SEND-CD-DESC; WASNT INITIALIZING CD-KEY(CD-FILLER)
      *  BLV 111396 FEE CODES GETTING WIPED OUT; GETFM NOT UNDER MISC SECTION
      *  BLV 111496 FIX FIELD 40 LC-CODE; COULDN'T READ CDFILE
      *  JTG 112096 FIXED BUG IN SPR-VERIFY, MISSING TEST ON SUBCLASS
      *  JTG 112196 CORRECTED BUG WITH WRONG SUBSCRIPT ON COMPUTE OF COMMISSION
      *             NEW COPY MEMBERS LIBLP/LPIEXP/W
      *             (IEXP-SUB/SUB1 --> IEXP-LN/IC)
      *  KEC 112596 CHANGED LN-POCD FOR RESCISSION.
      *  BAH 011796 SRCD WAS SHOWING 3 CHARACTERS, SHOULD ONLY BE 2...
      *  BAH 030397 ADDED LOGIC FOR DL-RECOURSE-FRMLA = 'A', FAIRCO
      *  JTG 042497 CHANGED TO DISPLAY UNIT PERIOD INFO IN ALL CASES
      *             EX. LN-INTDATE CHANGE, LN-1STPYDATE CHANGE,
      *                 LN-ORGTERM CHANGE, LN-UNITPER-CD CHANGE
      *  JTG 051297 ADDED USE OF 'SETCTBL' AND 'SETCTBLW'
      *  BAH 051997 ADDED LEGEND PROMPTS FOR ENTERING THE FIELD, #130
      *  MJD 060397 ADDED SCSCAN-TRANS-DATE.
      *  JTG 060397 ADDED TEST OF 'O3' RE: BR-OTH-INS-LEVELS
      *  JTG 070197 ALLOWED SCAN FOR SERVICE ACCOUNT CLASSES
      *  JTG 071497 ADDED "A" AND "C" OPTIONS FOR DL-PARVPAID-CODE RE: #515
      *  MJD 072397 REQ #163. ADD BRANCH FLAG, BR-AUTO-LNSTAT-WINDOW, TO
      *             AUTOMATICALLY OPEN THE LNSTAT WINDOW.
      *  BLV 072497 DON'T ALLOW PRINCIPAL 1 IF GP-DLRVPRIN-1-FG NOT "Y"
      *  JTG 081497 ADDED SET OF LN-GIFTNET WORLD A90
      *  JTG 080497 CHANGED 'COPY ...FEEENT1 AND FEEENTLN1 TO FEEENT & FEEENTLN
      *  BAH 090597 WAS NOT SETTING LT-TITLE, MILEAGE, VALUE, SELLPR OR MISC
      *  GLF 090897 REPLACED 'IO' ON GP-FILE WITH GET 'GPENV'
      *  MJD 112197 EXPANDED LN-REC TO 1800 BYTES
      *  BAH 012698 IF INSURED IS "S", TEST SECOND MAKER'S AGE EDITS, PR#641
      *  GLF 031998 PERFORM SEND-PURHCASE-FIELDS AFTER MOVE 0 TO ELE
      *  BAH 041398 BRING UP EXPANDED COLLATERAL AUTOMATICALLY FOR 'AUTO'
      *   CS 042398 MOVE BW-ORIGIN TO LN-ORIGIN
      *  BAH 090198 ADDED SP-INS-ADJ-PRIN-3PMTS, NC
      *  KEC 090498 ADDED 'MOVE LC-LOANTYPE TO LN-LOANTYPE' REGENCY REVOLVING.
      *  JTG 101398 ADDED SET OF LCSCAN-REVOLVING = 'N' AND STOPPED ENTRY
      *             OF REVOLVING ACCOUNTS, REGENCY REVOL
      *  JTG 102098 ADDED DL-PARVPAID-FRMLA-IB & DL-PARVPAID-CODE-IB "C"
      *             INSTANT AUTO #744
      *   CS 120298 ADD TEST OF GP-I-AM-MERC, DONT ALLOW NON-SERVICE ACCOUNTS
      *             TO BE CONVERTED UNLESS THEY ARE IN PL STATUS
      *  GLF 030199 ADD AUTOMATIC CALCULATION OF APR
      *             ADD PASSWD TO CHANGE APR
      *  JTG 990310 ALLOWED PARTICIPATION HELD ON IB ACCOUNTS, AUTOMOTIVE CREDIT
      *  GLF 990311 ADDED WI/TFCCDS FOR TFC TO ENTER LPO, PROCESS CODE, REP CODE
      *  JTG 990317 ADDED SP-DLDISC-RVPRIN1-PCNT,                       TFC #008
      *                   SP-LNCOST-FRMLA-VALID VALUE "D"
      *  BAH 990330 ADDED "MU" AND "MV" TO AUTO-COLLCD, TFC
      *  BAH 990409 APR WAS ALWAYS CALCULATING, EVEN AFTER AN OVERRIDE, HAD
      *             TO SET CALCULATE-APR-FG TO "N" IN F-19.
      *  MJD 990707 DEFAULT LPO CODE TO DL-LPO IN TFCCDS WINDOW, TFC PR# 31
      *  BAH 990716 ADDED NEW PASSWORD OPTION 2 (INSCO-SEQ) TO CHANGE DEFAULT
      *             INSURANCE COMPANY ON CL,AH,PP,O1, REGENCY PR# 56
      *  MJD 990722 FIXED AFP-DEALER/CLASS TEST TO COUNT " " AS "N".
      *  BAH 990730 REMOVED CHFG(5) FROM PROTECT-UNPROTECT, ALWAYS STOP ON
      *             ORGST, SALES INPUT DOES !! TFC PR# 44
      *  MJD 990803 ADDED GP-INCL-OTH-IN-EARNED FLAG. IF "Y" THEN INCLUDE
      *             EARNINGS BUCKET 6 (OTHER) IN ACCUMULATED TOTALS
      *             OTHERWISE EXCLUDE BUCKET 6.
      *  GLF 990803 ADDED GP-VALID-BDATE. IF "Y" AND THERE IS NOT A VALID
      *             BIRTH DATE FOR SSNO BEING ENTERED, DO NOT ALLOW ENTRY
      *             OF THE SSNO, REGENCY #57
      *  MJD 990817 ADDED TEST OF PURFLD-STAT AFTER PERFORMING
      *             COMPUTE-PURCHASE-FIELDS
      *   CS 991007 ADDED TEST OF BULK-CONVERSION-FG TO DETERMINE IF BULK
      *             OR CONVERSION SHOULD DISPLAY ON THE SCREEN, ALSO IF
      *             BULK-CONVERSION-FG = "B" UPDATE LN-CONVERCD WITH "B",
      *             IF CONVERSION UPDATE LN-CONVERCD WITH "Y"
      *  BAH 991027 O1 INSURANCE WAS NOT PART OF CALCULATED INSURANCE., LAURA
      *             FIXED ALL CODE REGARDING O1 INSURANCE, CALC'ING TERM, ETC.
      *  MJD 991103 REDUCED DISPLAY OF FEES FROM 6 TO 4. ADDED ENTRY
      *             OF 03 INSURANCE.  ARMED SERVICES FINANCIAL PR #251
      *  MJD 991207 ADDED LOGIC TO OPEN INSURANCE WINDOW IF
      *             BR-SFDLO3-WINDOW-FG IS A "B"., PR# 1023 ARMED SERVICES,JUDY
      *  JTG 991215 ADDED SP-DLDISC-RVPRIN1-AF-PCNT, TFC #058
      *  JTG 000104 CHANGED SP-DLDISC-RVPRIN1-AF-PCNT, TFC #058
      *             TO ACCEPT THE AMOUNT INPUTED IN RVPRIN1 WHEN IT IS LESS
      *             THAN TO COMPUTED AMOUNT
      *  JTG 000113 ADDED SP-INSREJECT-FG OPTION 'C', WHICH WILL CAUSE WRITING
      *             NO. OF MONTHS INSURANCE NOT IN VIOLATION, WISCONSIN #1032
      *  BAH 000120 AUTOMATICALLY PUT A "U" IN THIRD POSITION OF ACTIONCD FOR
      *             GP-I-AM-TFC, TFC PR# 65
      *  MJD 000208 ADDED GP-OT-INS-TERM (TFC PR#48) IF 'Y' THEN ALLOW
      *             ALLOW TERM ENTRY FOR O2O3O4O5 INSURANCE.
      *  BAH 000313 TEST SP-DLDISC-RVPRIN1-PCNT AND SP-DLDISC-RVPRIN1-AF-PCNT
      *              NOT = 202.02, KEVIN
      *  BLV 000426 DON'T COMPARE LN-PURDATE TO LOAN DATE IF LN-PURDATE
      *             IS 0 (SERVICE ACCT HAS PURDATE OF 0) - Y2K PROBLEM
      *  KEC 000530 {PR#00048} TFC [JUDY BRANIFF];
      *             ADDED THE FOLLOWING 'IF' CONDITION FOR ENTERING THE
      *             INSURANCE TERM (GP-OT-INS-TERM = "Y"):
      *                   IF ( VDUNUM0 > 360 )
      *                      GO TO ENTER-IC-TERM.
      *  JTG 000614 CORRECTED CONVERSION PROBLEM WITH INCORRECT AMOUNTS FOR
      *             LN-ANTICERN, LN-ANTICADJ & LN-ACCERN WHEN REFUNDS ARE
      *             SET VIA WI/LNSTAT.C                             #1203
      * MJD 000619 ADDED ENTRY OF CONTRACT RATE AND TEST OF VARIANCE
      *            (VH/VL) IN SPR (REGACC PR#1220)
      *  MJD 000912 ADDED LOGIC TO ASK LOCK BOX QUESTION IF ALLOTMENTS = "N"
      *             AND BR-LBOX = "Y".  (MFC PR#227)
      *  JTG 010112 ADDED NEW 88 SP-CAL-SET-SMPRATE-OVRRIDE VALUE 4 MERC PR#J016
      *  CS  010319 SET THE LC-POOLID TO DEFAULT LN-DLPOOL.
      *  CS  010326 ADDED LOGIC FOR SP-FEEINSCHG AND CD-GC-FEEFINCHG TO
      *             BE INCLUDED IN APR CALCULATION AND CALCULATION OF
      *             FINANCE CHARGE
      *  JTG 010329 CORRECTED SET OF LN-ANTICERN() AND LN-ACCERN() WHEN
      *             ENTRY OF REBATE FLAG AND REFUND AMOUNTS WERE ENTERED
      *             RE: LN-ANTICERN IS ALWAYS REDUCED BY REFUNDED AMOUNT
      *                 FROM IT'S ORIGINAL VALUE            WORLD #258
      *  JTG 010507 ALLOWED ENTRY OF 'TRADEIN' RE:SALE PRICE-DP-TI PAACO PR#1467
      *  BLV 010810 ADDED CONDITIONAL-SEND-MESS FOR CHANGE TO LPSPEDL,
      *             MERC PR# 253
      *  JTG 011001 DON'T ALLOW A FIRST PAY DAY OF 31 WHEN SEMI MONTHLY PAPER
      *                                                            FFG PR#333
      *  BAH 020712 SIGNED LN-TRADEIN, REGACC PR# 1808
      *  BLV 020820 IF GP-ENTER-LPO-FG = "Y", OPEN TFC WINDOW FOR ENTRY OF
      *             LPO, SOAUTO PR# 1885
      *  JTG 020916 ADDED LN-DLCOMM-03-CMSI LN-DLCOMM-PP-CMSI  REGACC #1846
      * CS  021008 DON'T ALLOW A FIRST PAY DAY OF 14, 15 OR 31 IF SEMI-MONTHLY
      *            PER JTG. CAUSED LATE CHARGE PROBLEM AT FFG, LATE CHARGE
      *            CYCLE DAYS WERE ALTERED IN FEB, FOR EXAMPLE: IF DUE DAY
      *            15/30, FEB SET DAY TO 28, THEN MARCH SET TO 13TH INTEAD OF
      *            15TH.
      *  BAH 031001 ADDED SP-INSCHGABLE '2' & '1',SP-INS-AMTFIN-2PMTS &
      *             SP-INS-AMTFIN-1PMTS FOR SIGNAL (WISC) PR# 2157
      *  JTG 031104 NEW SP-CAL-TBFRMLA (5) SP-FORCE-ENTRY-OVRDRATE CENTRIX #1592
      *                                                            MIDATL  #0427
      *   CS 041109 MAKE SURE GI EXISTS FOR CLASS ENTERED, IF NOT DONT ALLOW
      *             ANY ADDITIONAL ENTRY   [SUPPORT PR#451]
      *  BAH 050222 WHEN ENTERRING SUB CLASS, YOU DONT KNOW THE LOANDATE YET TO
      *             CHECK IF SPR IS EXPIRED, SO IT WAS JUST GRABBING THE FIRST
      *             LAWCODE FOUND TO DISPLAY THE DESCRIPTION, WHICH ISNT
      *             CORRECT IF THEY EXPIRE AND BUILD A NEW ONE WITH A DIFFERENT
      *             DESCRIPTION, VERY CONFUSING...AT LEAST SKIP EXPIRED SPR.
      *             RIVERSIDE PL# 467
      *   CS 050425 IF INSURANCE PREMIUM = ZERO, ZERO THE INSCOMP,INSCOMM,
      *             EFFDATE,EXPDATE, AND OUR FLAG   [PR#479] NSA
      * BAH 051128 UNDO CHANGE FROM 050222 PL# 467, WOULD NOT LET YOU BOOK A
      *            LOAN WITH AN EXPIRED SPR, AND YOU SHOULD BE ABLE TO.
      *            INSTEAD OF SKIPPING EXPIRED SPR IN READ-NEXT, JUST REDISPLAY
      *            THE SUBCLASS DESCRIPTION AFTER ENTERING THE LOANDATE.
      *  KEC 060721 PR#00127 REGIONAL ACCEPT. ADDED LOGIC FOR "AUTOPC".
      *   CS 081112 ADD TEST GP-INCL-OTH-IN-EARNED = 'R'. IF 'R' EXCLUDE
      *             OTHER(ANTICERN(6) AND MAINTFEE(ANTICERN(4) FROM EARNINGS
      *             AND UNEARNED   REGACC PR#210
      *   CS 081218 ADD BR-FILE, LIBWI/RSVENT NEEDS TO TEST BR-USE-PARTIC-FLAT
      *             TABLE PR#210 REGACC
      *  BAH 090609 UNITED WANTS TO FORCE THE USER TO ENTER A STATE, PR#3373
      *   CS 090713 IF WORLD, DONT ALLOW AN INPUT TO DISCOUNT, ITS USED FOR
      *             A 4% RESERVE ON BULK PURCHASES PR#643
      * BAH 090821 ADDED SP-INSCHGABLE "E" FOR REGMGM PR# 3437
      * BAH 091015 PASS SFDLO3-ORGST TO CL/SFDLO3 FOR REGMGM PR# 3475
      * BAH 100128 ADDED 3RD HHGS COLLATERAL FOR UNITED ACCEPT ONLY PR# 3524
      * BAH 110523 PASSWORD PROTECT ADDON SOURCE CODES, ET, LP, NP, RT, ST
      *            AND RB, REGMGM PR# 3792
      * BLM 120222 IF GP-PURGE-TO-ARCHIVE = "Y", CHECK TO SEE IF ACCT #
      *            ALREADY EXISTS IN ARCHIVED LOAN FILE; IF SO, SKIP TO
      *            NEXT NUMBER, REGACC PR# 304
      * BAH 120905 ADDED LT-VIN-CHG-DATE FOR REGACC PR# 319
      * BAH 121002 ADDED LC-SALES-FORCED-ENTRY REDEFINES LC-STOP-ON-DLNO
      *            FOR GP-I-AM-SECURITY SECURITY AUTO PR# 4116
      * BAH 130923 ALLOW GP-I-AM-WDT TO USE LT-SEQ 5 FOR A 3RD HHGS PR#4095
      *  CS 141111 CHANGED SS#INPUT TO "ERNX090"
      * BAH 160118 SPLIT OUT LTFILE, PD0003
      * KEC 2016.0309 PD#00003  [JAY CISZEWSKI]
      *         CHANGED CD-GROUP, CD-SECURED & CD-TRW TO BE
      *         CD-CO-GROUP, CD-CO-SECURED & CD-CO-TRW.
      * KEC 2016.0315 PD#00003  [JAY CISZEWSKI]
      *         CHANGED CD-FEE???? TO CD-GC-????.
      * KEC 2016.0325 PD#00003  [JAY CISZEWSKI]
      *         CHANGED CDSCAN-WINDOW-BUF TO HAVE MATCHING CD1-KEY
      *         LAYOUTS (FOR EACH CODE TYPE; CD-TYPE).
      *         CDSCAN-CD1-KEY IS THE NEW (PRIMARY) WITH REDEFINES OF
      *         CDSCAN-??-KEY (NEW).
      * KEC 2016.0329 PD#00003  [JAY CISZEWSKI]
      *         CHANGED ELSCAN WORKERS TO MATCH CD1-KEY FOR EL LAYOUT.
      *  CS 160401 WHEN DOING A PL ON ACCOUNT, USER GOT THE MESSAGE "MUST
      *            REDUCE PURBAL TO 0, IF THERE IS A PURCHASE BALANCE
      *            NOT = TO LN-ORIGPURAMT, CANNOT ALLOW THEM TO REWRITE THE
      *            RECORD BY CALLING UP THE LOAN & U TO UPDATE
      *            (IN COMPUTE-PRINCIPLE) WORLD PR# 1147  
      *             THIS HAS BEEN HAPPENING AS LONG AS I CAN REMEMBER AND WE
      *            WERE NEVER ABLE TO IDENTIFY WHAT CAUSEED IT, THANKS KM
      *            COMPUTE PURBAL RECOMPUTES PURCHASE BALANCE BASED ON TERM *  
      *            REGPY + 1ST + LAST.  SINCE WE DONT ALLOW ANY CHANGES ONCE
      *            LN-CURBAL IS SET, THIS COMPUTE ONLY NEEDS TO HAPPEN WHEN
      *            LN-CURBAL IS 0   PR#1147 WORLD
      *  CS 160407 ADDED CHECK WHEN ACTION UPDATE, THAT IF LN-CURBAL IS NOT 0
      *            OR LN-CURBAL IS 0 BUT PAID OFF, DONT ALLOW THE UPDATE, YOU
      *            COULD CHANGE ANYTHING IF THE ACCOUNT WAS PAID OFF. 
      * BAH 160414 ALLOW LN-CONVERCD "R" TO BE PULLED UP HERE FOR 
      *            MID-ATLANTIC AUTO CONVERTED ACCOUNTS, PR# 5047
      * BLM 160512 FIX FOR NEW FORMAT OF DS-DATE, PD0003
      *  CS 160805 CHANGED SCSCAN-KEY TO SCSCAN-SP1-KEY
      * KEC 2017.0105 CHANGED DS-DATE TO DS-DATE-CCYYMM FOR CONSISTENCY
      *               WITH THE DATE FIELDS IN BY & UD FILE.
      * BAH 2017.0609 ACTIVATE 8 DIGIT DATES, PD0006
      * BAH 2018.1030 GLOBAL GBFILE
      *  CS 2018.1205 GLOBAL LTCFILE
      * BAH 2018.1210 GLOBAL LNFILE
      * BAH 2019.0122 SPLIT CDFILE
      * BAH 2019.0625 REMOVED LC-REVOLVING, PT#0153
      * BAH 2020.0617 CHANGED PC-LT-RECORD TO PC-LTA-RECORD, ADDED LPPCCL CLEAR
      * BAH 2020.0615 MOVED OPEN-IC1-FILE, OPEN-SP1-FILE, OPEN-CD1-FILE,
      *              OPEN-BW1-FILE TO TOP OF PROGRAM #TST001
      * BAH 2022.0803 HARD CODED START
      * BAH 2023.0314 FIXED CHECK ON SP-EDT-NOEDITS CINDY FOUND
      * BAH 2023.0712 COMMENT OUT 3RD AND 4TH BORROWER TESTS, LN6 AND LN7
      * BAH 2024.0131 DELETE NOTICE IF EXIST
      * BAH 2025.0407 CLEAR 3RD LEVEL OF AUTO COLLATERAL, WK-AUTO-3 S35Q-194
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBLP/LPFSWK.CPY".

      *COPY "LIBLP/LPFSLN.CPY" REPLACING LEADING "LN" BY "ARCH-LN".

       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.

       COPY "LIBLP/LPFDWK.CPY".

      ********************************************************************
      *   ARCHIVED LOAN MASTER FILE
      ********************************************************************
      *FD  ARCH-LN-FILE
      *    LABEL RECORDS ARE STANDARD.
      *COPY "LIBLP/LP01LN.CPY" REPLACING LEADING "LN" BY "ARCH-LN"
      *                              TRAILING "STFG" BY "ARCH-LN-STFG".

       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(41) VALUE
           "@(#)LP/LONIJ0.CBL S35 01/30/24-09:38:34 >".
      **********************************
      *       F I L E   I F N          *
      **********************************
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".
       COPY "LIBGB/GB01GB.CPY".
       COPY "LIBGB/GB01GB_SQL.CPY".
       COPY "LIBGB/GBWSGB.CPY".
       COPY "LIBLP/LP01DL.CPY".
       COPY "LIBLP/LP01DL_SQL.CPY".
       COPY "LIBLP/LPWSDL.CPY".
       COPY "LIBLP/LP01LC.CPY".
       COPY "LIBLP/LP01LC_SQL.CPY".
       COPY "LIBLP/LPWSLC.CPY".
       COPY "LIBLP/LP01LN.CPY".
       COPY "LIBLP/LP01LN_SQL.CPY".
       COPY "LIBLP/LPWSLN.CPY".
       COPY "LIBLP/LP01LP.CPY".
       COPY "LIBLP/LP01LP_SQL.CPY".
       COPY "LIBLP/LPWSLP.CPY".
       COPY "LIBLP/LP01SP.CPY".
       COPY "LIBLP/LP01SPA.CPY".
       COPY "LIBLP/LP01SPB.CPY".
       COPY "LIBLP/LP01SPC.CPY".
       COPY "LIBLP/LP01SP_SQL.CPY".
       COPY "LIBLP/LPWSSP.CPY".
       COPY "LIBLP/LP01BW.CPY".
       COPY "LIBLP/LP01BW_SQL.CPY".
       COPY "LIBLP/LPWSBW.CPY".
       COPY "LIBLP/LP01CD.CPY".
       COPY "LIBLP/LP01CD_SQL.CPY".
       COPY "LIBLP/LPWSCD.CPY".
       COPY "LIBLP/LP01CDB.CPY".
       COPY "LIBLP/LP01CDB_SQL.CPY".
       COPY "LIBLP/LPWSCDB.CPY".
       COPY "LIBLP/LP01IC.CPY".
       COPY "LIBLP/LP01IC_SQL.CPY".
       COPY "LIBLP/LPWSIC.CPY".
       COPY "LIBLP/LP01DS.CPY".
       COPY "LIBLP/LP01DS_SQL.CPY".
       COPY "LIBLP/LPWSDS.CPY".
       COPY "LIBLP/LP01LTA.CPY".
       COPY "LIBLP/LP01LTA_SQL.CPY".
       COPY "LIBLP/LPWSLTA.CPY".
       COPY "LIBLP/LP01LTC.CPY".
       COPY "LIBLP/LP01LTC_SQL.CPY".
       COPY "LIBLP/LPWSLTC.CPY".
       COPY "LIBLP/LP01NO.CPY".
       COPY "LIBLP/LP01NO_SQL.CPY".
       COPY "LIBLP/LPWSNO.CPY".
       COPY "LIBLP/LP01PC.CPY".
       COPY "LIBLP/LP01PC_SQL.CPY".
       COPY "LIBLP/LPWSPC.CPY".
       COPY "LIBGL/GL01GI.CPY".
       COPY "LIBGL/GL01GI_SQL.CPY".
       COPY "LIBGL/GLWSGI.CPY".

       01  WK-KEY          PIC 9(2).
       01  WK-IFN          PIC XX         VALUE "WK".

      *********************************************************
      *   DATA PATH FROM GETENV ON "FIL"
      *********************************************************
      *01  DATA-PATH                           PIC X(35).
      *01  DATA-PATH-FIL-BUFFER      REDEFINES DATA-PATH.
      *    03  DATA-PATH-DIR1                  PIC X(3).
      *    03  FILLER                          PIC X(32).

      *********************************************************
      *   LNFILE ARCHIVE PATH WORKERS
      *********************************************************
      *01  LN-ARCHIVE-PATH.
      *    03  FILLER                     PIC X     VALUE "/".
      *    03  LN-ARCHIVE-PATH1.
      *        05  LN-ARCHIVE-DIR1        PIC X(3).
      *        05  FILLER                 PIC X     VALUE "/".
      *        05  LN-ARCHIVE-DIRECTORY   PIC X(4).
      *        05  FILLER                 PIC X     VALUE "/".
      *        05  LN-ARCHIVE-MACHINE     PIC XX.
      *        05  FILLER                 PIC X     VALUE "/".
      *        05  LN-ARCHIVE-DATA        PIC X(6).
      *    03  FILLER                     PIC X(10) VALUE
      *        "/LP/LNFILE".

       01  ONE             PIC S9.
       01  ELE             PIC 9(6).
       01  ACTION.
           03  CHKEY       PIC X(4).
           03  CHNO        PIC 9(2).
       01  IO-TYPE         PIC X(3).
       01  NEW-FLAG        PIC 9       VALUE 0.
       01  FIRST-ELE       PIC 99      VALUE 0.
       01  W-VDUSTATUS     PIC XX.

      * USED IN LOAN CLEAR COPY MEMBER
       01  HOLD-LN1-KEY    PIC 9(12).
       01  ORIGINAL-LN-REC PIC X(LN-SIZE).
       01  CHANGED-LN-REC  PIC X(LN-SIZE).

       01  SAVE-BW-KEY     PIC X(32).
       01  LAST-READ       PIC X(4).
       01  VALID-DELETE    PIC X.
       01  SET-NUMBER      PIC 9(8).
       01  SAVE-SSNO       PIC 9(10) COMP.
       01  ALLOT-BUF.
           03  FILLER      PIC X(5).
           03  ALLOT-CODE  PIC X.
       01  LBOX-BUF.
           03  FILLER      PIC X(5).
           03  LBOX-CODE   PIC X.

       01  DLRVPRIN-FG       OCCURS 3
                             PIC X.
       01  DLRVCHGS-FG       OCCURS 3
                             PIC X.
       01  DLPARVHELD-FG     PIC X.
       01  DLPARVPAID-FG     PIC X.
       01  DLDISC-FG         PIC X.
       01  DLCOMM-PP-CMSI-FG PIC X.
       01  DLCOMM-O3-CMSI-FG PIC X.

       01  CDCODE-FEE-FG   PIC 9.
       01  LC-INFO-LIST    PIC X(10)   VALUE "40P:S 400.".
       01  LC-INFO-BUF     PIC X(14).

       01  DLR-TYP-LIST      PIC X(6)   VALUE "39P:P.".
       01  DLR-TYP-BUF       PIC X(4).

       01  WSEL-LIST       PIC X(5)    VALUE "WSEL.".
       01  LEGEND-LIST     PIC X(8)   VALUE "MSEL".
       01  LEGEND          PIC X(70).
       01  DISPLAY-NUM-WK  PIC Z(7)9.99-.
       01  ACCTNO-WAS-SET-FG        PIC X   VALUE " ".
       01  MODIFY-LEGEND.
           03  FILLER      PIC X(26)  VALUE
           "F1, F4, F5-SCHED, F6-ADDON".
           03  FILLER      PIC X(41)  VALUE
           ", F3-STATUS, P2, P3, DELETE, FLD#, U-UPD:".
       01  WA-MODIFY-LEGEND.
           03  FILLER      PIC X(11)  VALUE
           "F1, F4-MEMO".
           03  FILLER      PIC X(46)  VALUE
           ", F3-LOAN STATUS, P2, P3, DELETE, FLD#, U-UPD:".

       01  RVNO            PIC 99       COMP.
       01  COUNTER             PIC 9(6)      COMP.
       01  PASSED-EDITS-FLAG   PIC X(01).
       01  RATE-LOW            PIC S9999V999.
       01  RATE-HIGH           PIC S9999V999.
       01  DISP-RATE           PIC ZZ9.999.
       01  IX1             PIC 99       COMP.
       01  IX2             PIC 99       COMP.
       01  SUB             PIC 9(6)     COMP.
       01  SUB2            PIC 9(6)     COMP.
       01  SP-SUB          PIC 9(6)     COMP.
       01  LN-SUB          PIC 9(6)     COMP.
       01  NON-MEMO-CHGS   PIC 9(6)V99  COMP.
       01  NOT-OUR-CHGS    PIC 9(6)V99  COMP.
       01  TEST-COLLCD     PIC XX.
           88  AUTO-COLLCD VALUE "AU" "AC" "AL" "RP" "HP" "AW"
                                 "MU" "MV".
       01  CHFG-ENDORATE   PIC X(01).
       01  OUR-CHGS        PIC 9(6)V99  COMP.
       01  INS-COMM        PIC S9(7)V99 COMP.
       01  TEST-PROCEEDS   PIC S9(7)V99 COMP.
       01  WORK-RATE       PIC 99V9(4)  COMP.
       01  OVER-20         PIC 99.
       01  I-LEVEL         PIC 9(6)     COMP.
       01  INSPECT-W       PIC X(86).
       01  INSPECT-X REDEFINES INSPECT-W.
           03  INSPECT-Z   PIC X OCCURS 86 TIMES.
       01  ADD-ON          PIC X(25).
       01  CALCULATE-APR-FG  PIC X      VALUE "Y".
       01  N-WK2           PIC S9(8)V99 COMP VALUE 0.
       01  AMT-HOLDER      PIC 9(6)V99  COMP VALUE 0.
       01  PREM-CHANGE     PIC X  VALUE " ".
       01  PREM-AMOUNT     PIC 9(4)V99  COMP VALUE 0.
       01  FORCE-ENTERED-PRIN1     PIC X    VALUE "N".
       01  FORCE-ENTERED-PRIN2     PIC X    VALUE "N".
       01  FORCE-ENTERED-DISC      PIC X    VALUE "N".

       01  HOLD-WORKER      PIC S9(9)V99    COMP.
       01  HOLD-TOTAL-REPAY PIC S9(7)V99    COMP.
       01  REGPY-WK         PIC S9(7)V99    COMP.
       01  ODDPY-WK         PIC S9(7)V99    COMP.
       01  REGPY-TEMP-WK    PIC S9(7)V99    COMP.
       01  DEFAULT-APR-FG   PIC X.
       01  TEST-PAY-FG      PIC X.
       01  REGPY-FG         PIC X.

       01  FIRST-SCAN        PIC 9     VALUE 0.
       01  SCAN-FLAG         PIC 9     VALUE 0.
       01  SCAN              PIC X(2)  VALUE SPACES.
           88  SCAN-ON       VALUE "ON".
       01  TYP               PIC 9     VALUE 0.

       01  MEMO-WK.
           03  MEMO-WK1    PIC X(30).
           03  MEMO-WK2    PIC X(30).

       01  ALP-BW.
           03  ALP-BW123   PIC X(3).
           03  ALP-HYPHEN1 PIC X.
           03  ALP-BW45    PIC X(2).
           03  ALP-HYPHEN2 PIC X.
           03  ALP-BW6789  PIC X(4).
       01  NUM-BW          PIC 9(9).
       01  NUM-BWX        REDEFINES NUM-BW.
           03  NUM-BW123   PIC X(3).
           03  NUM-BW45    PIC X(2).
           03  NUM-BW6789  PIC X(4).
       01  BW-ALP-TABLE.
           03  BW-ALP-TBL  OCCURS 70 TIMES
                           PIC X.

       01  COLLATERAL-BREAKOUT.
           03 COLLATERAL-30-1    PIC X(30).
           03 COLLATERAL-30-2    PIC X(30).
           03 FILLER             PIC X(20).

      ********************************
      *   S C R E E N   B U F F E R  *
      ********************************
       01  DISPLAY-BUF1        VALUE " ".
           03  D-LNNO          PIC 9(6).
           03  D-P             PIC X.
           03  D-J             PIC X.
           03  D-LCNO          PIC 99.
           03  D-LC-DESC       PIC X(16).
           03  D-LNAMT         PIC ZZZZZ9.99.
           03  D-PROCEEDS      PIC ZZZZZ9.99-.
           03  D-ANTIC         PIC ZZZZZ9.99-.
           03  D-010-040       OCCURS 4.
               05  D-010       PIC X(11).
               05  D-011       PIC X(24).
               05  D-012       PIC X(1).
           03  D-050           PIC XX.
           03  D-051           PIC 9(4)      BLANK ZERO.
           03  D-052           PIC 99        BLANK ZERO.
           03  D-053           PIC X(15).
           03  D-060           PIC 99/99/99  BLANK ZERO.
           03  D-070           PIC X(3).
           03  D-071           PIC X(15).
           03  D-080           PIC X(2).
           03  D-081           PIC X(15).
           03  D-090           PIC X(3).
           03  D-091           PIC X(15).
           03  D-100           PIC X(20).
           03  D-110           PIC X(30).
           03  D-111           PIC X(30).
       01  DISPLAY-BUF2 REDEFINES DISPLAY-BUF1.
           03  D-400           PIC ZZ.
           03  D-120           PIC 9(4).99   BLANK ZERO.
           03  D-121           PIC X(16).
           03  D-130           PIC X.
           03  D-131           PIC X(9).
           03  D-132           PIC Z(6).99   BLANK ZERO.
           03  D-140           PIC X.
           03  D-141           PIC ZZ9.
           03  D-150           PIC ZZZ.
           03  D-160           PIC 99/99/99  BLANK ZERO.
           03  D-170           PIC 99/99/99  BLANK ZERO.
           03  D-180           PIC 99/99/99  BLANK ZERO.
           03  D-190           PIC ZZ9.999   BLANK ZERO.
           03  D-200           PIC ZZ9.999   BLANK ZERO.
           03  D-210           PIC ZZ9.999   BLANK ZERO.
           03  D-211           PIC ZZ9.999   BLANK ZERO.
           03  D-220           PIC Z(5)9.99  BLANK ZERO.
           03  D-230           PIC Z(5)9.99  BLANK ZERO.
           03  D-231           PIC Z(5)9.99-  BLANK ZERO.
           03  D-240           PIC Z(3)9.99  BLANK ZERO.
           03  D-241           PIC ZZ9.99     BLANK ZERO.
           03  D-250           PIC Z(5)9.99  BLANK ZERO.
           03  D-251           PIC Z(3)9.99  BLANK ZERO.
           03  D-260           PIC XXX.
           03  D-270-290       OCCURS 4.
               05  D-1COMP      PIC 99        BLANK ZERO.
               05  D-1IOURS       PIC X.
               05  D-1TERM      PIC Z(3).
               05  D-1COVR      PIC Z(5)9.99  BLANK ZERO.
               05  D-1PREM      PIC Z(3)9.99  BLANK ZERO.
           03  D-300-320       OCCURS 2.
               05  D-2COMP      PIC 99        BLANK ZERO.
               05  D-2IOURS       PIC X.
               05  D-2EXP       PIC 9(6)      BLANK ZERO.
               05  D-2TERM REDEFINES D-2EXP
                                PIC Z(6)      BLANK ZERO.
               05  D-2COVR      PIC Z(5)9.99  BLANK ZERO.
               05  D-2PREM      PIC Z(3)9.99  BLANK ZERO.
           03  D-330-340.
               05  D-330-340X      OCCURS 2.
                   07  D-1FEECD     PIC X(2).
                   07  D-1FEEAMT    PIC Z(3)9.99  BLANK ZERO.
                   07  D-1FOURS     PIC X.
                   07  D-2FEECD     PIC X(2).
                   07  D-2FEEAMT    PIC Z(3)9.99  BLANK ZERO.
                   07  D-2FOURS     PIC X.
           03  D-350           PIC Z(5)9.99  BLANK ZERO.
           03  D-351           PIC Z(5)9.99  BLANK ZERO.
           03  D-360           PIC Z(5)9.99  BLANK ZERO.
           03  D-370           PIC 99/99/99  BLANK ZERO.
           03  D-380           PIC Z(5)9.99  BLANK ZERO.
           03  D-381           PIC Z(5)9.99  BLANK ZERO.
           03  D-390           PIC Z(5)9.99  BLANK ZERO.
           03  D-391           PIC Z(5)9.99  BLANK ZERO.
       01  DISPLAY-BUF3 REDEFINES DISPLAY-BUF1.
           03  D-X010-X040      OCCURS 4.
               05  D-X010       PIC X(11).
               05  D-X011       PIC X(24).
       01  X-BUF               REDEFINES DISPLAY-BUF1.
           03  X-PROCEEDS      PIC ZZZZZ9.99-.
           03  X-ANTIC         PIC ZZZZZ9.99-.
           03  X-350           PIC ZZZZZ9.99.
           03  X-351           PIC ZZZZZ9.99.
           03  X-360           PIC ZZZZZ9.99.
           03  X-370           PIC 99/99/99  BLANK ZERO.
           03  X-380           PIC Z(5)9.99  BLANK ZERO.
           03  X-381           PIC Z(5)9.99  BLANK ZERO.
           03  X-390           PIC Z(5)9.99  BLANK ZERO.
           03  X-391           PIC Z(5)9.99  BLANK ZERO.
       01  DEF-BUF             REDEFINES DISPLAY-BUF1.
           03  DEF-ORGST        PIC XX.
           03  DEF-ORGBR        PIC 9999.
           03  DEF-UNITPER-CD   PIC X.
           03  DEF-UNITPER-FREQ PIC ZZ9.
           03  DEF-SRCD         PIC XX.


       01  DEF-LIST            PIC X(20) VALUE
           "050 051 140 141 080.".

       01  X-LIST              PIC X(43) VALUE
           "DLCK ANTIC 350 351 360 370 380 381 390 391.".
       01  D-BW-WK.
           03  FILLER          PIC X(14).
           03  D-BW-PROMPT     PIC X(8).
           03  D-BW-LOANS      PIC 99.

       01  DISPLAY-LIST1.
           03  FILLER          PIC X(37)  VALUE
           "LNNO PJ CLASS LCDESC PRIN DLCK ANTIC ".
           03  FILLER          PIC X(40)  VALUE
           "010 011 012 020 021 022 030 031 032 040 ".
           03  FILLER          PIC X(56)  VALUE
           "041 042 050 051 052 053 060 070 071 080 081 090 091 100 ".
           03  FILLER          PIC X(8)   VALUE
           "110 111.".
       01  DISPLAY-LIST2.
           03  FILLER          PIC X(4)   VALUE
           "400 ".
           03  FILLER          PIC X(56)  VALUE
           "120 121 130 131 132 140 141 150 160 170 180 190 200 210 ".
           03  FILLER          PIC X(56)  VALUE
           "211 220 230 231 240 241 250 251 260 270 271 272 273 274 ".
           03  FILLER          PIC X(52)  VALUE
           "280 281 282 283 284 290 291 292 293 294 300 301 302 ".
           03  FILLER          PIC X(48)  VALUE
           "303 304 310 311 312 313 314 320 321 322 323 324 ".
           03  FILLER          PIC X(52)  VALUE
           "330 331 332 333 334 335 340 341 342 343 344 345 350 ".
           03  FILLER          PIC X(28)  VALUE
           "351 360 370 380 381 390 391.".
       01  DISPLAY-LIST3.
           03  FILLER          PIC X(32) VALUE
           "010 011 020 021 030 031 040 041.".
       01  FEE-LIST.
           03  FILLER           PIC X(24)  VALUE
           "330 331 332 333 334 335 ".
           03  FILLER           PIC X(24)  VALUE
           "340 341 342 343 344 345.".

      ********************************
      *   E L E M E N T   S P E C S  *
      ********************************
       01  MAX             PIC 99   VALUE 40.
       01  SPEC-TABLE.
      * 1  LN-SSNO(1)
           03  FILLER      PIC X(8) VALUE "ERNX090 ".
      * 2  LN-SSNO(2)
           03  FILLER      PIC X(8) VALUE "ERNX090 ".
      * 3  LN-SSNO(3)
           03  FILLER      PIC X(8) VALUE "ERNX090 ".
      * 4  LN-SSNO(4)
           03  FILLER      PIC X(8) VALUE "ERNX090 ".
      * 5  LN-ORGST
           03  FILLER      PIC X(8) VALUE "E  A020 ".
      * 6  LN-LOANDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 7  LN-PURCD
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 8  LN-SRCD
           03  FILLER      PIC X(8) VALUE "E  A020 ".
      * 9  LN-COLLCD
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 10 LN-COLLID
           03  FILLER      PIC X(8) VALUE "E  A200 ".
      * 11 LT-COLLATERAL-INFO
           03  FILLER      PIC X(8) VALUE "E  A300 ".
      * 12 LN-DLNO
           03  FILLER      PIC X(8) VALUE "ENNN042 ".
      * 13 LN-DLRECOURSE
           03  FILLER      PIC X(8) VALUE "E  A010 ".
      * 14 LN-UNITPER-CD
           03  FILLER      PIC X(8) VALUE "E  A010 ".
      * 15 LN-ORGTERM
           03  FILLER      PIC X(8) VALUE "ENNN030 ".
      * 16 LN-CASHDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 17 LN-INTDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 18 LN-ORIG-1STPYDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 19 LN-CONRATE
           03  FILLER      PIC X(8) VALUE "ENNN033 ".
      * 20 LN-APRATE
           03  FILLER      PIC X(8) VALUE "ENNN033 ".
      * 21 LN-OVRDRATE
           03  FILLER      PIC X(8) VALUE "ENNN033 ".
      * 22 LN-SELLPR
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 23 LN-DOWNPY
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 24 LN-SERCHG
           03  FILLER      PIC X(8) VALUE "ENNN042 ".
      * 25 LN-INTCHG
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 26 LN-INSURED
           03  FILLER      PIC X(8) VALUE "E  A030 ".
      * 27 LN-INSCOMP(1)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 28 LN-INSCOMP(2)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 29 LN-INSCOMP(3)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 30 LN-INSCOMP(4)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 31 LN-INSCOMP(5)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 32 LN-INSCOMP(6)
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
      * 33 LN-FEECODE(1), (2)
           03  FILLER      PIC X(8) VALUE "E  A020 ".
      * 34 LN-FEECODE(3), (4)
           03  FILLER      PIC X(8) VALUE "E  A020N".
      * 35 LN-1STPYAMT & LN-REGPYAMT
           03  FILLER      PIC X(8) VALUE "ENNN062N".
      * 36 LN-LASTPYAMT
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 37 LN-PURDATE
           03  FILLER      PIC X(8) VALUE "ERNM060 ".
      * 38 LN-DLDISC
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 39 LN-DLRVPRIN
           03  FILLER      PIC X(8) VALUE "ENNN062 ".
      * 40 LN-LC-CODE
           03  FILLER      PIC X(8) VALUE "ENNN020 ".
       01  SPEC-TABLE2     REDEFINES SPEC-TABLE.
           03  SPEC-REC    OCCURS 40 TIMES.
               05  SPEC    PIC X(7).
               05  CHFG    PIC X.

       COPY "LIBLP/LPIEXPW.CPY".
       COPY "LIBLP/PURFLDW.CPY".
       COPY "LIBLP/LPWKPATH.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/MESSWK.CPY".
       COPY "LIBCL/CREAIXW.CPY".
       COPY "LIBWI/PFSWINDOWSW.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBLP/LPUPERW.CPY".
       COPY "LIBLP/LPUPWKW.CPY".
       COPY "LIBLP/UPERTSTW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBGB/SYSTEMW.CPY".
       COPY "LIBGB/GPENVW.CPY".
       COPY "LIBLP/LPANTIW.CPY".
       COPY "LIBLP/LPAMTSW.CPY".
       COPY "LIBLP/LPITRMW.CPY".
       COPY "LIBLP/LPMNUIW.CPY".
       COPY "LIBLP/LPSPEDW.CPY".
       COPY "LIBLP/LPBAGEW.CPY".
       COPY "LIBLP/LPEDAYW.CPY".
       COPY "LIBLP/LPAPRSW.CPY".
       COPY "LIBLP/SETCTBLW.CPY".
       COPY "LIBLP/LPAPRZW.CPY".
       COPY "LIBLP/CALCPVW.CPY".
       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBGB/PASSWDW.CPY".
       COPY "LIBGB/GETENVW.CPY".
       01  1STPY30-SEQ          PIC 9 VALUE 0.
       01  OVERRIDE-APR         PIC 9 VALUE 1.
      * PASSWORD CHANGING THE INSURANCE COMPANY TO ANYTHING BUT DEFAULT
       01  INSCO-SEQ            PIC 9 VALUE 2.
       01  SRCD-SEQ             PIC 99 VALUE 17.

       01  WINDOW-WORKERS.
           03  WINDOW-LPO          PIC X(4).
           03  WINDOW-REP          PIC X(8).
           03  WINDOW-PROCESS      PIC X(1).
       COPY "LIBWI/PAYSCHW.CPY".
       COPY "LIBWI/DLSCANW.CPY".
       COPY "LIBWI/ELSCANW.CPY".
       COPY "LIBWI/BWLNSCW.CPY".
       COPY "LIBWI/LCSCANW.CPY".
       COPY "LIBWI/SCSCANW.CPY".
       COPY "LIBWI/BWCREAW.CPY".
       COPY "LIBWI/BWSCANW.CPY".
       COPY "LIBWI/ADONMNW.CPY".
       COPY "LIBWI/CDSCANW.CPY".
       COPY "LIBWI/CDBSCNW.CPY".
       COPY "LIBWI/RSVENTW.CPY".
       COPY "LIBCL/SFDLO3W.CPY".
       COPY "LIBWI/FEEENTW.CPY".
       COPY "LIBGB/SCREENW.CPY".
       COPY "LIBLP/LONIJ_DEF.CPY".
       COPY "LIBLP/LPCMNU_DEF.CPY".
       COPY "LIBWI/RSVENT_DEF.CPY".
       COPY "LIBWI/FEEENT_DEF.CPY".
       COPY "LIBWI/AUTOPCW.CPY".
       COPY "LIBWI/LTCREAW.CPY".
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBLP/LONIJ_WKS.CPY".
       COPY "LIBLP/LPCMNU_WKS.CPY".
       COPY "LIBWI/RSVENT_WKS.CPY".
       COPY "LIBWI/FEEENT_WKS.CPY".
       COPY "LIBGB/HELPLINK.CPY".

       COPY "LIBGB/GETFMW.CPY".
       COPY "LIBLP/LPLONIW.CPY".

       SCREEN SECTION.
       COPY "LIBLP/LONIJ_SCN.CPY".
       COPY "LIBLP/LPCMNU_SCN.CPY".
       COPY "LIBWI/RSVENT_SCN.CPY".
       COPY "LIBWI/FEEENT_SCN.CPY".

       PROCEDURE DIVISION
           USING FORM-PATHNAME EXIT-PATHNAME PROG-BUF.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
               WK-FILE.
       COPY "LIBGB/DECLARE.CPY".
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-PC1-FILE.
           PERFORM CLOSE-LTC1-FILE.
           PERFORM CLOSE-NO1-FILE.
           PERFORM CLOSE-LTA1-FILE.
           PERFORM CLOSE-LP1-FILE.
      *    PERFORM CLOSE-LN7-FILE.
      *    PERFORM CLOSE-LN6-FILE.
           PERFORM CLOSE-LN5-FILE.
           PERFORM CLOSE-LN4-FILE.
           PERFORM CLOSE-LN1-FILE.
           PERFORM CLOSE-LC1-FILE.
           PERFORM CLOSE-IC1-FILE.
           PERFORM CLOSE-DS1-FILE.
           PERFORM CLOSE-DL1-FILE.
           PERFORM CLOSE-CDB1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW4-FILE.
           PERFORM CLOSE-BW3-FILE.
           PERFORM CLOSE-BW2-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-GI1-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-BR-FILE.
           CLOSE WK-FILE.
       COPY "LIBGB/DECLAR2.CPY".

      /**********************************
      *   C O N T R O L   M O D U L E   *
      ***********************************
       MAIN-PROGRAM SECTION.

           PERFORM SQL-CONNECT.

      D    STOP MESS.
           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "LONIJ" TO VDU-FORM-NAME.

           PERFORM GET-GB.

           MOVE USER-PID TO TEMP-PID.
           MOVE " " TO ERRCD.

           MOVE BRANCH TO BR-NO.
           PERFORM OPEN-BR-FILE.
           PERFORM READ-BR-FILE.
           PERFORM CLOSE-BR-FILE.

           PERFORM GET-GPENV.

           PERFORM OPEN-IC1-FILE.
           PERFORM OPEN-CD1-FILE.
           PERFORM OPEN-SP1-FILE.
           PERFORM OPEN-BW1-FILE.

       MAIN-MODULE.
           PERFORM CREATE-TRAILER.

           PERFORM FORM-RESET.
           PERFORM DISPLAY-BULK-CONVERSION.

           MOVE " " TO MESS
           PERFORM MSG-LINE.

           IF BR-LC-CODE = "Y"
              MOVE " " TO CHFG(40)
              MOVE "40. LC CODE:__" TO LC-INFO-BUF
           ELSE
              MOVE "N" TO CHFG(40)
              MOVE " " TO LC-INFO-BUF.
           MOVE LC-INFO-BUF TO WR-BUF.
           MOVE LC-INFO-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           IF GP-DLR-DISP-TYPE = "C"
              MOVE "COMM" TO DLR-TYP-BUF
           ELSE
              MOVE "DISC" TO DLR-TYP-BUF.
           MOVE DLR-TYP-BUF TO WR-BUF.
           MOVE DLR-TYP-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           PERFORM ENTER-KEYS.
           IF IO-TYPE = "CLR"
              GO TO MAIN-MODULE.
           IF IO-TYPE = "END"
              GO TO END-ROUTINE.
       ENTER-LOAN.
           PERFORM ENTRY-MODULE.
           IF IO-TYPE = "END"
              GO TO END-ROUTINE.
           GO TO MAIN-MODULE.

      ************************************
       ENTER-KEYS SECTION.
      ************************************
       LOAN-GET-NUMBER.
           MOVE " " TO ACCTNO-WAS-SET-FG.
           MOVE 0 TO NEW-FLAG ELE.
           MOVE " " TO IO-TYPE.
           IF LOAN-KEY NOT = 0
              MOVE LOAN-KEY TO LN-ACCTNO
              MOVE 0 TO LOAN-KEY
              MOVE "SN N060LNNO." TO VDU
              MOVE LN-ACCTNO TO VDUNUM0
              PERFORM SCREENIO
              GO TO START-LN-LOOKUP.

           MOVE "F7-MENU, F5/F6-SCAN, ENTER LOAN NO:" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "EN N060LNNO." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1>"
              GO TO MENU-KEY.
           IF VDUSTATUS = "1:"
              PERFORM ENTER-SCANKEY
              GO TO CHECK-SALEFIN.
           IF VDUSTATUS = "1<"
              PERFORM BWLN-SCAN
              IF IO-FG NOT = 0
                 GO TO LOAN-GET-NUMBER
              ELSE
                 MOVE "00" TO VDUSTATUS.
           IF NOT (VDUSTATUS = "00" OR "16")
              GO TO LOAN-GET-NUMBER.
           IF VDUNUM0 = 0
              IF BR-CONVERT-AUTO-ACCTNO = "Y"
                 PERFORM GET-ACCOUNT-NUMBER
                 MOVE LN-ACCTNO TO VDUNUM0
                 MOVE "00" TO VDUSTATUS
                 PERFORM ALARM
                 PERFORM ALARM
              ELSE
                 GO TO LOAN-GET-NUMBER.
           MOVE VDUNUM0 TO LN-ACCTNO.                  

       START-LN-LOOKUP.
           PERFORM OPEN-LN1-FILE.
           PERFORM READ-LN1-FILE.
           MOVE LN1-KEY TO HOLD-LN1-KEY.
           PERFORM CLOSE-LN1-FILE.
      *    IF IO-FG = 9 AND GP-PURGE-TO-ARCHIVE-FG = "Y"
      *       MOVE LN-ACCTNO TO ARCH-LN-ACCTNO
      *       PERFORM OPEN-ARCH-LN1-FILE
      *       PERFORM READ-ARCH-LN1-FILE
      *       PERFORM CLOSE-ARCH-LN1-FILE
      *       IF IO-GOOD
      *          MOVE "ACCOUNT NUMBER EXISTS IN ARCHIVE" TO MESS
      *          PERFORM SEND-MESS
      *          GO TO LOAN-GET-NUMBER.

           IF IO-FG = 9
              IF BR-CONVERT-AUTO-ACCTNO = "Y" AND
                  ACCTNO-WAS-SET-FG NOT = "Y" 
                 GO TO LOAN-GET-NUMBER
              ELSE
                 PERFORM NEW-RECORD-SETUP
                 GO TO ENTER-CLASS.

           IF ( LN-POCD-VOID )
              MOVE "ACCOUNT HAS BEEN DELETED" TO MESS
              PERFORM SEND-MESS
              GO TO LOAN-GET-NUMBER.

           IF ( LN-POCD-INRESCISSION )
              MOVE "ACCOUNT IS IN RESCISSION" TO MESS
              PERFORM SEND-MESS
              GO TO LOAN-GET-NUMBER.

           IF ( LN-POCD-RESCIND )
              MOVE "ACCOUNT HAS BEEN RESCINDED" TO MESS
              PERFORM SEND-MESS
              GO TO LOAN-GET-NUMBER.
      *---{CS}----

           IF BULK-CONVERSION-FG = "B"
              IF LN-CONVERCD NOT = "B"
                 MOVE "ACCOUNT NOT INPUT AS BULK PURCHASE ACCOUNT"
                                                           TO MESS
                 PERFORM SEND-MESS
                 GO TO LOAN-GET-NUMBER.

           IF BULK-CONVERSION-FG = "C"
              IF LN-CONVERCD NOT = "Y" AND NOT = "R"
                 MOVE "ACCOUNT NOT INPUT AS CONVERSION ACCOUNT"
                                               TO MESS
                 PERFORM SEND-MESS
                 GO TO LOAN-GET-NUMBER.


      * MUST BE HERE BECAUSE DISPLAY-FIELDS CHANGES VALUE OF
      * LN-INSTRM
           MOVE LN-REC TO ORIGINAL-LN-REC.

           PERFORM DISPLAY-FIELDS.

      *----------------------------------------------------------------
      * SINCE THE LOAN RECORD DOESN'T HOLD RESERVE CALCULATION FLAGS,
      * ON LOAN RECALL MUST ASSUME THEY ARE ALL INPUTED AMOUNTS:
           MOVE "I" TO DLRVPRIN-FG(1)
                       DLRVPRIN-FG(2)
                       DLRVPRIN-FG(3)
                       DLRVCHGS-FG(1)
                       DLRVCHGS-FG(2)
                       DLRVCHGS-FG(3)
                       DLPARVHELD-FG
                       DLPARVPAID-FG
                       DLDISC-FG
                       DLCOMM-PP-CMSI-FG
                       DLCOMM-O3-CMSI-FG.
      *----------------------------------------------------------------

           GO TO CHECK-SALEFIN.
       ENTER-CLASS.
           MOVE "F1-CLEAR, F7-MENU, F6-SCAN, ENTER LOAN CLASS:"
                                                     TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "EN N020CLASS." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO EXIT-ENTER-KEYS.
           IF VDUSTATUS = "1>"
              GO TO MENU-KEY.
           IF VDUSTATUS = "1<"
              PERFORM CLASS-SCAN
              IF IO-FG NOT = 0
                 GO TO ENTER-CLASS.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-CLASS.
           MOVE VDUNUM0 TO LN-CLASS
                           LN-SPRCLASS
                           LC-CODE.
           PERFORM GET-LC.
           IF IO-FG = 9
              PERFORM NOT-FOUND
              GO TO ENTER-CLASS.

           MOVE "S  A000LCDESC." TO VDU.
           MOVE LC-DESC TO VDUBUF.
           PERFORM SCREENIO.
           IF ( LC-SALEFIN NOT = "Y" ) 
              PERFORM NOT-SALES-FINANCE
              GO TO ENTER-CLASS.

           MOVE LC-SMALLOAN TO LN-SMALLOAN.
           MOVE LC-SALEFIN  TO LN-SALEFIN.
           MOVE LC-SERVACCT TO LN-SERVACCT.
           MOVE LC-LOANTYPE TO LN-LOANTYPE.
           MOVE LC-GIFTNET  TO LN-GIFTNET.

      * SET DEFAULT POOLID FROM CLASS FILE MERC(03/16/01)
           IF NOT (LC-POOLID = 20202 OR 02020)
              MOVE LC-POOLID TO LN-DLPOOL.

      * CHECK FOR GI RECORD FOR CLASS ENTERED
            MOVE LC-CODE   TO GI-CLASS.
            MOVE BR-NO    TO GI-BRANCH.
            PERFORM GET-GI.
            IF IO-BAD
              PERFORM GI-NOT-FOUND
              GO TO ENTER-CLASS.


           MOVE 1 TO LN-STMT-COUNTER.
           GO TO EXIT-ENTER-KEYS.
       MENU-KEY.
           IF LN-ACCTNO NUMERIC
              MOVE LN-ACCTNO TO LOAN-KEY.
           DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN.
           DESTROY LONIJ-SCREEN.

           PERFORM MENU-SELECTION.
           IF MENU-FG = 99
              GO TO LOAN-GET-NUMBER.
           MOVE "END" TO IO-TYPE.
           GO TO EXIT-ENTER-KEYS.
       CHECK-SALEFIN.
           IF ( LC-SALEFIN NOT = "Y" ) 
              PERFORM NOT-SALES-FINANCE
              MOVE "CLR" TO IO-TYPE.
       EXIT-ENTER-KEYS.

      *****************************************
       CLASS-SCAN SECTION.
      *****************************************
           MOVE 0      TO LCSCAN-KEY.
           MOVE SPACES TO LCSCAN-VERIFY.
           MOVE "Y"    TO LCSCAN-SALEFIN.
           MOVE "WI/LCSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LCSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF LCSCAN-STATUS NOT = "00" OR LCSCAN-KEY = 0
               MOVE 9 TO IO-FG
               GO TO EXIT-CLASS-SCAN.
           MOVE "SNNN020CLASS." TO VDU.
           MOVE LCSCAN-KEY TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE LCSCAN-KEY TO VDUNUM0.
           MOVE 0 TO IO-FG.

       EXIT-CLASS-SCAN.
           EXIT.

      *****************************************
       BWLN-SCAN SECTION.
      *****************************************
           MOVE TRANS-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-ALPDATE.
           MOVE ALP-DATE   TO BWLNSC-SYSDATE.
           MOVE 0          TO BWLNSC-ACCTNO.
           MOVE "WI/BWLNSC " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWLNSC-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF BWLNSC-STATUS NOT = "00" OR BWLNSC-ACCTNO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BWLN-SCAN.

           MOVE BWLNSC-ACCTNO TO VDUNUM0.
           MOVE BWLNSC-SSNO   TO BW-SSNO BORROWER-KEY.
           MOVE 0 TO IO-FG.

       EXIT-BWLN-SCAN.
           EXIT.

      ********************************************
       FEECODE-SCAN SECTION.
      ********************************************
           MOVE "GC"   TO CDBSCN-TYPE.
           MOVE BRANCH TO CDBSCN-BRANCH.
           MOVE SPACES TO CDBSCN-CODE.

           MOVE "WI/CDBSCN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CDBSCN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF ( CDBSCN-STATUS NOT = "00" ) OR 
              (( CDBSCN-TYPE = "GC") AND ( CDBSCN-CODE = SPACES ))
              MOVE 9 TO IO-FG
              GO TO EXIT-FEECODE-SCAN.

           MOVE "S  A020  0." TO VDU.
           MOVE FW-ELE TO VDUROW.
           MOVE CDBSCN-CODE TO VDUBUF.
           PERFORM SCREENIO.

           MOVE CDBSCN-CODE TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-FEECODE-SCAN.
           EXIT.


      ********************************************
       CODE-SCAN SECTION.
      ********************************************

           MOVE SPACES TO CDSCAN-CODE.
           IF ELE = 7
              MOVE "PU"   TO CDSCAN-TYPE
           ELSE
           IF ELE = 8
              MOVE "SR"   TO CDSCAN-TYPE
           ELSE
           IF ELE = 9
              MOVE "CO"   TO CDSCAN-TYPE
           ELSE
              PERFORM FEECODE-SCAN
              GO TO EXIT-CODE-SCAN.

           MOVE "WI/CDSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH CDSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF ( CDSCAN-STATUS    NOT = "00"    ) OR 
              ((CDSCAN-TYPE    = "PU") AND (CDSCAN-CODE = SPACES)) OR
              ((CDSCAN-TYPE    = "CO") AND (CDSCAN-CODE = SPACES)) OR
              ((CDSCAN-TYPE    = "SR") AND (CDSCAN-CODE = SPACES))
              MOVE 9 TO IO-FG
              GO TO EXIT-CODE-SCAN.


           MOVE "S  A030  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE CDSCAN-CODE TO VDUBUF.
           PERFORM SCREENIO.

           MOVE CDSCAN-CODE TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-CODE-SCAN.
           EXIT.

      ***********************************
       ENTER-SCANKEY SECTION.
      ***********************************
       ENTER-SCAN.
           MOVE 1 TO SCAN-FLAG.
           MOVE "NEXT" TO LAST-READ.
           MOVE "N" TO VALID-LOAN.

           PERFORM OPEN-LN1-FILE.

           MOVE BW-PATH-OWNBR TO BW-OWNBR.

           MOVE "S  A050STYP." TO VDU.
           MOVE "SKEY:" TO VDUBUF.
           PERFORM SCREENIO.

           MOVE "SN N010TYP." TO VDU.
           MOVE 2 TO TYP VDUNUM0.
           PERFORM SCREENIO.

           MOVE "S  A160SORTKEY." TO VDU.
           MOVE "________________" TO VDUBUF.
           PERFORM SCREENIO.

           GO TO DISPLAY-TYPE.

       ENTER-TYPE.
           MOVE "1-SS#, 2-NAME, 3-SP SS#, 4-SP NAME" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "EN N010TYP." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO CLOSE-SCANKEY.
           IF VDUSTATUS = "1<"
              MOVE "S" TO VDUACTION
              MOVE 1 TO TYP
                        VDUNUM0
              PERFORM SCREENIO
              PERFORM DISPLAY-TYPE
              GO TO READ-FILES-NEXT.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-TYPE.
           MOVE VDUNUM0 TO TYP.
           IF TYP < 1 OR TYP > 4
              GO TO ENTER-TYPE.
       DISPLAY-TYPE.

           IF TYP = 1
              MOVE 0 TO BW-SSNO
              PERFORM START-BW1-FILE
              MOVE "SS#, F5-SCAN LOANS, F6-SCAN SS#" TO LEGEND
           ELSE
           IF TYP = 2
              MOVE SPACES TO BW-NAME
              PERFORM START-BW2-FILE
              MOVE "LAST NAME, F5-SCAN LN, F6-SCAN NAME" TO LEGEND
           ELSE
           IF TYP = 3
              MOVE 0 TO BW-SPSSNO
              PERFORM START-BW3-FILE
              MOVE "SP SS#, F5-SCAN LN, F6-SCAN SP SS#" TO LEGEND
           ELSE
           IF TYP = 4
              MOVE SPACES TO BW-SPNAME
              PERFORM START-BW4-FILE
              MOVE "SP NAME, F5-SCAN LN, F6-SCAN SP NAME" TO LEGEND.
           PERFORM SEND-LEGEND.
       ENTER-KEY.
           MOVE "E RA000SORTKEY." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO CLOSE-SCANKEY.
           IF VDUSTATUS = "1U"
              PERFORM CLOSE-SCANKEY
              GO TO ENTER-SCAN.
           IF VDUSTATUS = "1:"
              IF FIRST-SCAN = 0
                 MOVE " ENTER BORROWER # FIRST" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-KEY.
           IF VDUSTATUS = "1:"
              PERFORM SCAN-LOANS
              IF IO-TYPE = "CLR"
                 MOVE " " TO IO-TYPE
                 GO TO ENTER-KEY
              ELSE
                 GO TO ENTER-KEY.
           IF VDUSTATUS = "1<"
              IF LAST-READ = "NEXT"
                 GO TO READ-FILES-NEXT
              ELSE
                 MOVE SAVE-BW-KEY TO VDUBUF
                 GO TO START-FILES.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-KEY.
           IF VDUBUF = " "
              IF VALID-LOAN = "Y"
                 MOVE "   " TO IO-TYPE
                 GO TO CLOSE-SCANKEY
              ELSE
                 GO TO ENTER-KEY.
       START-FILES.
           MOVE BW-PATH-OWNBR TO BW-OWNBR.

           IF TYP = 1 OR 3
              MOVE VDUBUF TO BW-SSNO BW-SPSSNO
           ELSE
              IF TYP = 2 OR 4
                 PERFORM ARRANGE-BW-KEY
                 MOVE BW-ALP-TABLE TO BW-NAME BW-SPNAME.
           IF TYP = 1
              PERFORM START-BW1-FILE
           ELSE
              IF TYP = 2
                 PERFORM START-BW2-FILE
              ELSE
                 IF TYP = 3
                    PERFORM START-BW3-FILE
                 ELSE
                    IF TYP = 4
                       PERFORM START-BW4-FILE.
           MOVE 0 TO SCAN-FLAG.
       READ-FILES-NEXT.
           MOVE 0 TO FIRST-SCAN.
           IF TYP = 1 PERFORM READ-BW1-FILE-NEXT.
           IF TYP = 2 PERFORM READ-BW2-FILE-NEXT.
           IF TYP = 3 PERFORM READ-BW3-FILE-NEXT.
           IF TYP = 4 PERFORM READ-BW4-FILE-NEXT.
           IF (IO-FG = 9) OR (BW-OWNBR NOT = BW-PATH-OWNBR)
              MOVE "CLR" TO IO-TYPE
              GO TO CLOSE-SCANKEY.

           MOVE BW-SSNO TO SAVE-SSNO.
           PERFORM DISPLAY-BORROWER.

           MOVE "NEXT" TO LAST-READ.
           MOVE "N" TO VALID-LOAN.
           IF TYP = 1
              MOVE BW-SSNO TO SAVE-BW-KEY.
           IF TYP = 2
              MOVE BW-NAME TO SAVE-BW-KEY.
           IF TYP = 3
              MOVE BW-SPSSNO TO SAVE-BW-KEY.
           IF TYP = 4
              MOVE BW-SPNAME TO SAVE-BW-KEY.
           MOVE 1 TO SCAN-FLAG.
           MOVE 1 TO FIRST-SCAN.
           MOVE " " TO SCAN.
           GO TO ENTER-KEY.

       CLOSE-SCANKEY.
           PERFORM CLOSE-LN1-FILE.
       END-SCANKEY.
           MOVE 0 TO FIRST-SCAN.
           MOVE SPACES              TO WR-BUF.
           MOVE "SORTKEY TYP STYP." TO WR-LIST.
           PERFORM CALL-WRFORM.

       EXIT-ENTER-SCANKEY.
           EXIT.

      **************************************
       SCAN-LOANS SECTION.
      **************************************
           MOVE LN-PATH-OWNBR TO LN-OWNBR.
      *    GO TO START-LN4 START-LN5 START-LN6 START-LN7
           GO TO START-LN4 START-LN5 
                 DEPENDING ON SCAN-FLAG.
       START-LN4.
           IF SCAN-ON
              GO TO READ-LN4.

           MOVE LN-OWNBR    TO QLN4-WBEG-OWNBR
                               QLN4-WEND-OWNBR.
           MOVE SAVE-SSNO   TO LN-SSNO(1)
                               QLN4-WBEG-SSNO1
                               QLN4-WEND-SSNO1.

           PERFORM START-LN4-FILE.
           MOVE "ON" TO SCAN.
       READ-LN4.
           PERFORM READ-LN4-FILE-NEXT.
           IF IO-FG = 0
              IF (LN-OWNBR = LN-PATH-OWNBR) AND (LN-SSNO(1) = SAVE-SSNO)
                 IF ( LN-POCD-NONLOAN )
                    GO TO READ-LN4
                 ELSE
      * MUST BE HERE BECAUSE DISPLAY-FIELDS CHANGES VALUE OF LN-INSTRM
                    MOVE LN-REC TO ORIGINAL-LN-REC
                    PERFORM DISPLAY-FIELDS
                    GO TO END-SCAN-LOANS.

           ADD 1 TO SCAN-FLAG.
           MOVE " " TO SCAN.
       START-LN5.
           IF SCAN-ON
              GO TO READ-LN5.

           MOVE LN-OWNBR    TO QLN5-WBEG-OWNBR
                               QLN5-WEND-OWNBR.
           MOVE SAVE-SSNO   TO LN-SSNO(2)
                               QLN5-WBEG-SSNO2
                               QLN5-WEND-SSNO2.

           PERFORM START-LN5-FILE.
           MOVE "ON" TO SCAN.
       READ-LN5.
           PERFORM READ-LN5-FILE-NEXT.
           IF IO-FG = 0
              IF (LN-OWNBR = LN-PATH-OWNBR) AND (LN-SSNO(2) = SAVE-SSNO)
                 IF ( LN-POCD-NONLOAN )
                    GO TO READ-LN5
                 ELSE
      * MUST BE HERE BECAUSE DISPLAY-FIELDS CHANGES VALUE OF LN-INSTRM
                    MOVE LN-REC TO ORIGINAL-LN-REC
                    PERFORM DISPLAY-FIELDS
                    GO TO END-SCAN-LOANS.

      *    ADD 1 TO SCAN-FLAG.
      *    MOVE " " TO SCAN.
      *START-LN6.
      *    IF SCAN-ON
      *       GO TO READ-LN6.

      *    MOVE LN-OWNBR    TO QLN6-WBEG-OWNBR
      *                        QLN6-WEND-OWNBR.
      *    MOVE SAVE-SSNO   TO LN-SSNO(3)
      *                        QLN6-WBEG-SSNO3
      *                        QLN6-WEND-SSNO3.
      *    PERFORM START-LN6-FILE.
      *    MOVE "ON" TO SCAN.
      *READ-LN6.
      *    PERFORM READ-LN6-FILE-NEXT.
      *    IF IO-FG = 0
      *       IF (LN-OWNBR = LN-PATH-OWNBR) AND (LN-SSNO(3) = SAVE-SSNO)
      *          IF ( LN-POCD-NONLOAN )
      *             GO TO READ-LN6
      *          ELSE
      * MUST BE HERE BECAUSE DISPLAY-FIELDS CHANGES VALUE OF LN-INSTRM
      *             MOVE LN-REC TO ORIGINAL-LN-REC
      *             PERFORM DISPLAY-FIELDS
      *             GO TO END-SCAN-LOANS.
      *    ADD 1 TO SCAN-FLAG.
      *    MOVE " " TO SCAN.
      *START-LN7.
      *    IF SCAN-ON
      *       GO TO READ-LN7.

      *    MOVE LN-OWNBR    TO QLN7-WBEG-OWNBR
      *                        QLN7-WEND-OWNBR.
      *    MOVE SAVE-SSNO   TO LN-SSNO(4)
      *                        QLN7-WBEG-SSNO4
      *                        QLN7-WEND-SSNO4.
      *    PERFORM START-LN7-FILE.
      *    MOVE "ON" TO SCAN.
      *READ-LN7.
      *    PERFORM READ-LN7-FILE-NEXT.
      *    IF IO-FG = 0
      *       IF (LN-OWNBR = LN-PATH-OWNBR) AND (LN-SSNO(4) = SAVE-SSNO)
      *          IF ( LN-POCD-NONLOAN )
      *             GO TO READ-LN7
      *          ELSE
      * MUST BE HERE BECAUSE DISPLAY-FIELDS CHANGES VALUE OF LN-INSTRM
      *             MOVE LN-REC TO ORIGINAL-LN-REC
      *             PERFORM DISPLAY-FIELDS
      *             GO TO END-SCAN-LOANS.

           MOVE "CLR" TO IO-TYPE.
           MOVE 1 TO SCAN-FLAG.
           MOVE " " TO SCAN LN-REC.
       END-SCAN-LOANS.
           EXIT.

      ************************************
       DISPLAY-BORROWER SECTION.
      ************************************
           MOVE " " TO DISPLAY-BUF3.
           MOVE BW-SSNO TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE ALP-BW TO D-X010(1).
           MOVE BW-LNAME TO INSPECT-W.
           MOVE BW-FNAME TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO D-BW-WK.
           MOVE "# LOANS:" TO D-BW-PROMPT.
           MOVE BW-LOANS TO D-BW-LOANS.
           MOVE D-BW-WK TO D-X011(1).
           MOVE BW-ADR1 TO INSPECT-W.
           MOVE BW-ADR2 TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO D-X011(2).
           MOVE BW-CITY TO INSPECT-W.
           MOVE BW-STATE TO ADD-ON.
           PERFORM ADD-IT.
           MOVE BW-ZIP TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO D-X011(3).
           MOVE BW-SPSSNO TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE ALP-BW TO D-X010(4).
           MOVE BW-SPLNAME TO INSPECT-W.
           MOVE BW-SPFNAME TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO D-BW-WK.
           MOVE "(SPOUSE)" TO D-BW-PROMPT.
           MOVE D-BW-WK TO D-X011(4).
           MOVE DISPLAY-BUF3 TO WR-BUF.
           MOVE DISPLAY-LIST3 TO WR-LIST.
           PERFORM CALL-WRFORM.

      ******************************************
       ADDON-CREATE SECTION.
      ******************************************
           MOVE BRANCH     TO ADONMN-BRANCH.
           MOVE LN-ACCTNO  TO ADONMN-ACCTNO.
           MOVE LN-PLCD    TO ADONMN-PLCD.
           MOVE LN-SERVACCT TO ADONMN-SERVACCT.
           MOVE LN-SALEFIN TO ADONMN-SALEFIN.
           MOVE LN-LOANTYPE TO ADONMN-LOANTYPE.
           MOVE LN-LOANDATE TO ADONMN-LOANDATE.
           MOVE LN-ORIG-1STPYDATE TO ADONMN-ORIG-1STPYDATE.
           MOVE NEW-FLAG    TO ADONMN-NEW-FLAG.
           PERFORM TEST-BAL.
           MOVE IO-FG TO ADONMN-TEST-BAL.
           MOVE "WI/ADONMN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ADONMN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       EXIT-ADDON-CREATE.
           EXIT.

      ******************************************
       PAYSCH-CREATE SECTION.
      ******************************************
           MOVE TRANS-DATE   TO PAYSCH-TRANS-DATE.
           MOVE BRANCH       TO PAYSCH-BRANCH.
           MOVE LN-ACCTNO    TO PAYSCH-ACCTNO.
           MOVE LN-PLCD      TO PAYSCH-PLCD.
           MOVE LN-SERVACCT  TO PAYSCH-SERVACCT.
           MOVE LN-SALEFIN   TO PAYSCH-SALEFIN.
           MOVE LN-LOANTYPE  TO PAYSCH-LOANTYPE.
           MOVE LN-1STPYAMT  TO PAYSCH-1STPYAMT.
           MOVE LN-NOREGPY   TO PAYSCH-NOREGPY.
           MOVE LN-REGPYAMT  TO PAYSCH-REGPYAMT.
           MOVE LN-LASTPYAMT TO PAYSCH-LASTPYAMT.
           MOVE NEW-FLAG     TO PAYSCH-NEW-FLAG.
           PERFORM TEST-BAL.
           MOVE IO-FG        TO PAYSCH-TEST-BAL.
           MOVE "WI/PAYSCH" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH PAYSCH-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       EXIT-PAYSCH-CREATE.
           EXIT.

      ***************************************************
      *   ENTRY-MODULE                                  *
      *   NEW-FLAG = 0 - MODIFY EXISTING RECORD         *
      *              1 - INITIAL NEW RECORD ENTRY       *
      *              2 - MODIFY NEW RECORD              *
      ***************************************************
       ENTRY-MODULE SECTION.
       BEGIN-ENTRY.
           MOVE " " TO IO-TYPE.
           MOVE 1 TO ONE.
           MOVE FIRST-ELE TO ELE.
           MOVE 0 TO FIRST-ELE.
       CREATE-ROUTINE.
           IF NEW-FLAG NOT = 1
              GO TO MODIFY-ROUTINE.

           IF SP-FORCE-ENTRY-OVRDRATE(1)
              MOVE " " TO CHFG(21)
           ELSE
              MOVE "N" TO CHFG(21).

           MOVE "N" TO CHFG(20) CHFG(35) CHFG(36).

           IF LN-SERVACCT = "Y"
              MOVE "N" TO CHFG(37) CHFG(38) CHFG(39)
           ELSE
      *---{CS}--PER JTG & ME --NO WAY
              IF BULK-CONVERSION-FG = "B"
                 MOVE "N" TO CHFG(38) CHFG(39)
              ELSE
                 MOVE " " TO CHFG(37) CHFG(38) CHFG(39).

           ADD ONE TO ELE.
           IF ELE < 1
              MOVE 1 TO ELE ONE.
           IF ELE NOT > MAX
              GO TO ENTER-ELE.

           IF BR-AUTO-LNSTAT-WINDOW = "Y"
              PERFORM CALL-LNSTAT-WINDOW.

           MOVE 2 TO NEW-FLAG.
           MOVE 0 TO ELE.
      * ADDED 3/19/98, WASNT COMPUTING ANTIICAPATED AFTER ENTERING TERM..
           PERFORM SEND-PURCHASE-FIELDS.

           MOVE "S  A100PMOD:S." TO VDU.
           MOVE "25->MODIFY" TO VDUBUF.
           PERFORM SCREENIO.
       MODIFY-ROUTINE.
           MOVE "N" TO CHFG(33).
           MOVE " " TO STAT.
           PERFORM PROTECT-UNPROTECT.
           IF GP-USE-CONRATE = "Y"
              MOVE " " TO CHFG(19)
              MOVE "N" TO CHFG(20)
           ELSE
              MOVE "N" TO CHFG(19).

           IF LN-SERVACCT = "Y"
              MOVE "N" TO CHFG(37) CHFG(38) CHFG(39)
           ELSE
              IF BULK-CONVERSION-FG = "B"
                 MOVE "N" TO CHFG(38) CHFG(39)
              ELSE
                 MOVE " " TO CHFG(37) CHFG(38) CHFG(39).

      * ANY FIELD 1-11 EXCEPT FIELD 5 - SKIP THE CALCULATIONS
           IF ELE < 12
              IF ELE = 5
                 NEXT SENTENCE
              ELSE
                 GO TO BYPASS-CALCULATIONS.
      * ANY FIELD 13-21 EXCEPT FIELD 14 - SKIP THE CALCULATIONS
           IF ELE > 12 AND ELE < 22
              IF ELE = 15 OR 17
                 NEXT SENTENCE
              ELSE
                 GO TO BYPASS-CALCULATIONS.
           IF ELE = 35
              GO TO BYPASS-CALCULATIONS.
           PERFORM COMPUTE-PRINCIPLE.
           PERFORM COMPUTE-PAYMENTS.
           PERFORM COMPUTE-ANTICTERM.
           IF LN-CURBAL = 0 AND LN-POFFDATE = 0
              PERFORM COMPUTE-PURBAL.

           PERFORM SETUP-PURCHASE-FIELDS.

      * NOTE: THE FOLLOWING IF IS TO ASSURE THAT WHEN LNSTAT.C
      *       IS CALLED AND REBATES ARE SET THAT THOSE ADJUSTMENTS
      *       ARE NOT OVER WRITTEN HERE, JTG 010329
      
           IF ( LN-INT-REBATE = " " OR "N") AND
              ( LN-SC-REBATE  = " " OR "N") AND
              ( LN-MF-REBATE  = " " OR "N") AND
              ( LN-ANTICADJ(1) = 0        ) AND
              ( LN-ANTICADJ(3) = 0        ) AND
              ( LN-ANTICADJ(4) = 0        )
              PERFORM COMPUTE-ANTICIPATED.
      
           PERFORM COMPUTE-DEALER-CHECK.
           IF ELE = 15 OR 17 OR 22 OR 23 OR 24 OR 25 OR
                    PREM-CHANGE = "Y"
              PERFORM COMPUTE-INS-COVERAGE.
           IF ELE = 15 OR 17
              PERFORM COMPUTE-INS-TERM.
           PERFORM SEND-X-LIST.
       BYPASS-CALCULATIONS.
           PERFORM CALCULATE-APR.
           IF BR-INS-ADDON = "Y" OR "O"
              MOVE MODIFY-LEGEND TO LEGEND
           ELSE
              MOVE WA-MODIFY-LEGEND TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10"
              IF NEW-FLAG = 2
                 PERFORM DELETE-TRAILER-LT
                 MOVE "CLR" TO IO-TYPE
                 GO TO END-ENTRY-MODULE
              ELSE
                 MOVE "CLR" TO IO-TYPE
                 GO TO END-ENTRY-MODULE.
           IF VDUSTATUS = "16"
              PERFORM CALL-LNSTAT-WINDOW
              GO TO MODIFY-ROUTINE.
           IF VDUSTATUS = "18"
              PERFORM MEMO-ENTRY
              GO TO MODIFY-ROUTINE.
           IF BR-INS-ADDON = "Y" OR "O"
              IF VDUSTATUS = "1:"
                 PERFORM PAYSCH-CREATE
                 GO TO MODIFY-ROUTINE.
           IF BR-INS-ADDON = "Y" OR "O"
              IF VDUSTATUS = "1<"
                 PERFORM ADDON-CREATE
                 GO TO MODIFY-ROUTINE.
           IF VDUSTATUS NOT = "00"
              GO TO MODIFY-ROUTINE.
           MOVE VDUBUF TO ACTION.
           IF ACTION = "DELETE"
              MOVE "Y" TO VALID-DELETE
              PERFORM DELETE-MODULE
              IF VALID-DELETE NOT = "Y"
                 GO TO MODIFY-ROUTINE
              ELSE
                 PERFORM DELETE-NOTICE
                 PERFORM DELETE-TRAILER-LT
                 MOVE "CLR" TO IO-TYPE
                 GO TO END-ENTRY-MODULE.

           IF NOT (ACTION = "    P2"
                           OR "     U"
                            OR "    P3")
              GO TO MODIFY-FIELD.

           IF ACTION = "     U"
              IF LN-CURBAL NOT = 0  
                   OR (LN-CURBAL = 0 AND LN-POFFDATE NOT = 0)
                 MOVE "UPDATE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS 
                 GO TO MODIFY-ROUTINE.


      * ONLY HERE IF RECORD WILL BE WRITTEN;

           PERFORM D13-SP-EDT-TABLE-LOOKUP.
           IF PASSED-EDITS-FLAG NOT = "Y"
              GO TO MODIFY-ROUTINE.

           PERFORM COMPUTE-FINANCE-CHARGE.
           IF LN-FINCHG < SP-MINSF-CHG
              MOVE "FINANCE CHARGE BELOW MINIMUM" TO MESS
              PERFORM SEND-MESS
              GO TO MODIFY-ROUTINE.

           PERFORM VERIFY-MODULE.
           IF VALID-LOAN = "N"
              GO TO MODIFY-ROUTINE.

           IF LN-JDDATE = 0
              MOVE SP-JUDGRATE TO LN-JDRATE.

           IF ACTION = "    P2"
              MOVE LN-ACCTNO TO LOAN-KEY
              PERFORM WRITE-MODULE
              MOVE "K0K" TO NEW-PROG-FORM
              MOVE "END" TO IO-TYPE
              GO TO END-ENTRY-MODULE.
           IF ACTION = "    P3"
              MOVE LN-ACCTNO TO LOAN-KEY
              PERFORM WRITE-MODULE
              MOVE "U0U" TO NEW-PROG-FORM
              MOVE "END" TO IO-TYPE
              GO TO END-ENTRY-MODULE.
           IF ACTION = "     U"
              PERFORM TEST-ALLOT-LBOX
              IF IO-TYPE = "RTN"
                 MOVE " " TO IO-TYPE
                 GO TO MODIFY-ROUTINE
              ELSE
                 PERFORM WRITE-MODULE
                 MOVE "CLR" TO IO-TYPE
                 GO TO END-ENTRY-MODULE.
       MODIFY-FIELD.
           INSPECT ACTION REPLACING ALL " " BY "0".
           IF CHNO NOT NUMERIC
              GO TO MODIFY-ROUTINE.
           IF CHNO = 0
              GO TO MODIFY-ROUTINE.
           IF CHNO > MAX
              GO TO MODIFY-ROUTINE.
           IF NOT (GP-USE-CONRATE = "Y")
              IF CHNO = 20
                 MOVE OVERRIDE-APR TO PASSWDW-SEQ
                 MOVE "        TO CHANGE APR        " TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    GO TO MODIFY-ROUTINE
                 ELSE
                    MOVE " " TO CHFG(20).
           MOVE CHNO TO ELE.

      * TEST IF REFUNDS WERE SET IN WI/LNSTAT.C AND IF SO
      * DO NOT ALLOW CHANGE TO THESE COMPONENTS
      
           IF ( ELE = 25 AND LN-INT-REBATE NOT = " " ) OR
              ( ELE = 24 AND LN-SC-REBATE  NOT = " " ) OR
              ( ELE = 24 AND LN-MF-REBATE  NOT = " " )
              STRING "A REFUND FOR THIS COMPONENT WAS SET, "
                     "CHANGE NOT ALLOWED"
                    DELIMITED BY SIZE INTO MESS
              PERFORM SEND-MESS
              GO TO MODIFY-ROUTINE.

       ENTER-ELE.
           PERFORM TEST-BAL.
           IF IO-FG = 9
              MOVE "CURRENT BAL, INT BAL, AND OTH BAL MUST ALL BE 0.00"
                TO MESS
              PERFORM SEND-MESS
              GO TO MODIFY-ROUTINE.
           IF ELE < 5
              MOVE
              "BORROWER #, ENTER NEW SSNO & PRESS F5-CREATE, F6-SCAN"
                                           TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 5
              IF NEW-FLAG = 1
                    AND CHFG(5) = "N"
                 GO TO F-052.
           IF ELE = 6
              MOVE
              "F1-CLEAR, ENTER LOAN DATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 7
              MOVE
              "F1-CLEAR, F6-PURPOSE SCAN, ENTER PURPOSE CODE:"
              TO LEGEND
              PERFORM SEND-LEGEND.

           IF ELE = 8
              IF NEW-FLAG = 0
                 GO TO CREATE-ROUTINE.
           IF ELE = 8
              MOVE
              "F1-CLEAR, F6-SOURCE SCAN, ENTER SOURCE CODE:"
               TO LEGEND
               PERFORM SEND-LEGEND.
           IF ELE = 9
              MOVE
              "F1-CLEAR, F6-COLLATERAL SCAN, ENTER COLLATERAL CODE:"
               TO LEGEND
               PERFORM SEND-LEGEND.
           IF ELE = 10
              MOVE VDUSTATUS TO W-VDUSTATUS
              IF BR-TRAILER-REC = "Y"
                 MOVE LN-COLLCD TO TEST-COLLCD
                 IF AUTO-COLLCD
                    MOVE "N" TO CHFG(11)
                    MOVE " " TO MESS
                    MOVE WK-HHGS-1 TO INSPECT-X
                    PERFORM COLLATERAL-CREATE
                    PERFORM RESTORE-TRAILER-REC
                 ELSE
                 MOVE
                 "F1-CLEAR, ENTER COLLATERAL ID, F3-EXPANDED COLLATERAL"
                     TO LEGEND
                 PERFORM SEND-LEGEND
                 MOVE W-VDUSTATUS TO VDUSTATUS
              ELSE
                 MOVE "F1-CLEAR, ENTER-COLLATERAL ID:" TO LEGEND
                 PERFORM SEND-LEGEND
                 MOVE W-VDUSTATUS TO VDUSTATUS.

           IF ELE = 11
      * NEW RECORD
              MOVE "F1-CLEAR, ENTER COLLATERAL DESCRIPTION:" TO LEGEND
              PERFORM SEND-LEGEND
              IF NEW-FLAG = 1
                 IF LN-COLLID = " "
                    GO TO CREATE-ROUTINE.

           IF ELE = 12
              MOVE "F1-CLEAR, F6-DEALER SCAN, ENTER DEALER NO:"
                                                           TO LEGEND
              PERFORM SEND-LEGEND.

           IF ELE = 13
              IF LN-SERVACCT = "Y"
                  IF NEW-FLAG NOT = 1
                     GO TO MODIFY-ROUTINE
                  ELSE
                     GO TO CREATE-ROUTINE
              ELSE
               MOVE "F1-CLEAR, ENTER RECOURSE CODE (F,P,N):" TO LEGEND
               PERFORM SEND-LEGEND.

           IF ELE = 14
              MOVE "F1-CLEAR, ENTER PAYMENT PERIOD:" TO LEGEND
              PERFORM SEND-LEGEND
              IF NEW-FLAG = 1
                 IF BR-UNITPER-FG NOT = "Y"
                    PERFORM SEND-1STPYDATE
                    GO TO CREATE-ROUTINE
                 ELSE
                    NEXT SENTENCE
              ELSE
                 IF BR-UNITPER-FG NOT = "Y"
                         OR LN-ORGTERM = 1
                    GO TO CREATE-ROUTINE.
           IF ELE = 15
              MOVE "F1-CLEAR, ENTER TERM OF LOAN:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 16
              MOVE "F1-CLEAR, ENTER INTEREST START DATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 17
              MOVE "F1-CLEAR, ENTER FIRST PAYMENT DATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 18
              MOVE "F1-CLEAR, ENTER SAME AS CASH DATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 19
              MOVE "F1-CLEAR, ENTER CONTRACTS APR:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 20
              MOVE "F1-CLEAR, ENTER ANNUAL PERCENTAGE RATE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 22
              MOVE "F1-CLEAR, ENTER THE SELLING PRICE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 23
              MOVE "F1-CLEAR, ENTER THE DOWN PAYMENT:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE  = 24
              IF SP-SCFRMLA = 0 AND SP-MFFRMLA = 0
                 GO TO CREATE-ROUTINE
              ELSE
              MOVE "F1-CLEAR, ENTER THE SERVICE CHARGE (LOAN FEE):"
                 TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 25
              MOVE "F1-CLEAR, ENTER THE INTEREST CHARGE:" TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 26
              IF GP-ENTER-LPO-FG NOT = "Y"
                 MOVE "F1-CLEAR, ENTER INSURANCE CODES (EX. MCC):"
                                                          TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 MOVE "F1-CLEAR,F3-LPO,ENTER INSURANCE CODES (EX. MCC):"
                                                          TO LEGEND
                 PERFORM SEND-LEGEND
                 IF VDUSTATUS = "16"
      * FIRST TIME IN, DEFAULT TO DL-LPO, OTHERWISE, KEEP THE ONE THEY
      * MAY HAVE ENTERED...PR# 31
                    IF LN-LPO = SPACES
                       MOVE LN-DLNO TO DL-DLNO
                       PERFORM GET-DL1
                       MOVE DL-LPO TO WINDOW-LPO
                    ELSE
                       MOVE LN-LPO TO WINDOW-LPO
                    END-IF
                    MOVE LN-REP-CD TO WINDOW-REP
                    MOVE LN-PROCESS-CD TO WINDOW-PROCESS
                    MOVE "WI/TFCCDS" TO FORM-NAM
                    CALL FORM-PROGX USING FORM-PATH WINDOW-WORKERS
                    CANCEL FORM-PROGX
                    MOVE WINDOW-LPO TO LN-LPO
                    MOVE WINDOW-REP TO LN-REP-CD
                    MOVE WINDOW-PROCESS TO LN-PROCESS-CD.
           IF ELE = 27
             MOVE
             "F1-CLEAR, ENTER CREDIT LIFE INSURANCE COMPANY:"
                                                           TO LEGEND
             PERFORM SEND-LEGEND.
           IF ELE = 28
             MOVE
             "F1-CLEAR, ENTER ACCIDENT HEALTH INSURANCE COMPANY:"
                                                           TO LEGEND
             PERFORM SEND-LEGEND.
           IF ELE = 29
             MOVE
             "F1-CLEAR, ENTER PERSONAL PROPERTY INSURANCE COMPANY:"
                                                           TO LEGEND
             PERFORM SEND-LEGEND.
           IF ELE = 30
             MOVE
             "F1-CLEAR, ENTER OTHER #1 INSURANCE COMPANY:" TO LEGEND
             PERFORM SEND-LEGEND.
           IF ELE = 31
             MOVE
             "F1-CLEAR, ENTER OTHER #2 INSURANCE COMPANY:" TO LEGEND
             PERFORM SEND-LEGEND.
           IF ELE = 32
             MOVE
             "F1-CLEAR, ENTER OTHER #3 INSURANCE COMPANY:" TO LEGEND
             PERFORM SEND-LEGEND.
      * FEES
           IF ELE = 33
              IF CHFG(33) = " "
                 MOVE "F1-CLEAR, F3-ENTER FEES, (RTN)-SKIP" TO LEGEND
                 PERFORM SEND-LEGEND
              ELSE
                 PERFORM DO-FEEENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 35
              MOVE
              "F1-CLEAR, F3-CALC, ENTER AMOUNT OF FIRST PAYMENT:"
                                                          TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 36
              MOVE
              "F1-CLEAR, ENTER AMOUNT OF THE LAST PAYMENT:"
                                                          TO LEGEND
              PERFORM SEND-LEGEND.
           IF ELE = 37
              MOVE "F1, ENTER PURCHASE DATE:" TO LEGEND
              PERFORM SEND-LEGEND
              PERFORM GET-SP
              PERFORM SEND-PURCHASE-FIELDS.
           IF ELE = 38
              IF CHFG(38) = " "
                 IF LN-DLRVPRIN(2) = 0
                         AND LN-DLRVPRIN(3) = 0
                          AND LN-DLRVCHGS(2) = 0
                           AND LN-DLRVCHGS(3) = 0
                    MOVE
                 "F1, F3-RESERVE WINDOW, ENTER PRINCIPAL RESERVE #1:"
                                                            TO LEGEND
                    PERFORM SEND-LEGEND
                 ELSE
                    PERFORM DO-RSVENT-WINDOW
                    GO TO CREATE-ROUTINE.
           IF ELE = 39
              IF CHFG(39) = " "
                 IF LN-DLPARVPAID = 0
                    MOVE
                 "F1, F3-RESERVE WINDOW, ENTER PARTICIPATION HELD:"
                                                            TO LEGEND
                    PERFORM SEND-LEGEND
                 ELSE
                    PERFORM DO-RSVENT-WINDOW
                    GO TO CREATE-ROUTINE.

           IF CHKEY NOT = ZEROS
              IF CHFG (ELE) = " "
                 IF NEW-FLAG NOT = 1
                    GO TO MODIFY-ROUTINE.
           IF CHFG(ELE) = "N"
              IF NEW-FLAG = 1
                 GO TO CREATE-ROUTINE
              ELSE
                 GO TO MODIFY-ROUTINE.
           MOVE SPEC(ELE) TO VDU.
           MOVE ELE TO VDUROW.
           MOVE 0 TO VDUCOL.
           MOVE "." TO VDUDECIMAL.
           PERFORM SCREENIO.
       TEST-F1.
           IF VDUSTATUS = "10"
              MOVE "CLR" TO IO-TYPE
              GO TO END-ENTRY-MODULE.
       TEST-F3.
           IF VDUSTATUS NOT = "16"
              GO TO TEST-UP.
           IF ELE = 33
              IF CHFG(33) = " "
                 PERFORM DO-FEEENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 35
              MOVE " " TO REGPY-FG
              GO TO CREATE-ROUTINE.
           IF ELE = 38
              IF CHFG(38) = " "
                 PERFORM DO-RSVENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 39
              IF CHFG(39) = " "
                 PERFORM DO-RSVENT-WINDOW
                 GO TO CREATE-ROUTINE.
           IF ELE = 10 AND BR-TRAILER-REC = "Y"
              MOVE "N" TO CHFG(11)
              MOVE " " TO MESS
              MOVE WK-HHGS-1 TO INSPECT-X
              PERFORM COLLATERAL-CREATE
              PERFORM RESTORE-TRAILER-REC.
       TEST-UP.
           IF VDUSTATUS NOT = "1U"
              GO TO TEST-F4.
           IF ELE = 6
              MOVE " " TO CHFG(5).
           IF NEW-FLAG = 1
              MOVE -1 TO ONE
              GO TO CREATE-ROUTINE.
      *-----------------------------------------------------------------
       TEST-F4.

           IF NOT ( F4-KEY )
              GO TO TEST-F5.

           IF ( ELE = 10 )
              PERFORM AUTOPC-ROUTINE.

      *-----------------------------------------------------------------
       TEST-F5.
           IF VDUSTATUS NOT = "1:"
              GO TO TEST-F6.
           IF ELE < 5
              PERFORM BORROWER-CREATE
              IF IO-FG = 0
                 GO TO GOTO-FIELD.
           MOVE 1 TO ONE.
           GO TO GOTO-FIELD.
       TEST-F6.
           IF VDUSTATUS NOT = "1<"
              GO TO TEST-00.
           IF ELE < 5
              PERFORM BORROWER-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
           IF ELE = 7 OR 8 OR 9
              MOVE 0 TO CDCODE-FEE-FG
              PERFORM CODE-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
           IF ELE = 12
              PERFORM DEALER-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
           IF ELE = 40
              PERFORM ELCODE-SCAN
              IF IO-FG = 0
                 GO TO GOTO-FIELD
              ELSE
                 GO TO ENTER-ELE.
       TEST-00.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-ELE.
       GOTO-FIELD.
           IF (ELE > 21 AND ELE < 35)
                             OR ELE = 15
              MOVE " " TO REGPY-FG.

           MOVE 1 TO ONE.
           IF ELE > 20
              GO TO GOTO-FIELD-20.
           GO TO F-01 F-02 F-03 F-04 F-05 F-06 F-07 F-08 F-09 F-10
                 F-11 F-12 F-13 F-14 F-15 F-16 F-17 F-18 F-19 F-20
                 DEPENDING ON ELE.
       GOTO-FIELD-20.
           SUBTRACT 20 FROM ELE GIVING OVER-20.
           GO TO F-21 F-22 F-23 F-24 F-25 F-26 F-27 F-28 F-29 F-30
                 F-31 F-32 F-33 F-34 F-35 F-36 F-37 F-38 F-39 F-40
                 DEPENDING ON OVER-20.
           GO TO END-ENTRY-MODULE.

      *************************************
      *    S E T   E L E M E N T S        *
      *************************************
       F-01.
           PERFORM BORROWER-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-02.
           PERFORM BORROWER-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-03.
      *    PERFORM BORROWER-ENTRY.
      *    IF IO-FG = 9
      *       GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-04.
      *    PERFORM BORROWER-ENTRY.
      *    IF IO-FG = 9
      *       GO TO ENTER-ELE.
      *    PERFORM BW-CHECK-ENDORSER.
           GO TO CREATE-ROUTINE.
       F-05.
           MOVE VDUBUF TO LN-ORGST
                          LN-OWNST.
       F-052.
           MOVE " " TO CHFG(5).
           MOVE "^-BACK, F6-SCAN, ENTER SUB CLASS:" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "EN N020052." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF VDUSTATUS = "1<"
              PERFORM SUBCLASS-SCAN
              IF IO-FG = 9
                 GO TO F-052.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-052.

           MOVE LN-ORGST    TO SP-ORGST
                               QSP1-WBEG-ORGST
                               QSP1-WEND-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS
                               QSP1-WBEG-SPRCLASS
                               QSP1-WEND-SPRCLASS.
           MOVE VDUNUM0     TO SP-SUBCLASS LN-SUBCLASS
                               QSP1-WBEG-SUBCLASS
                               QSP1-WEND-SUBCLASS.
           MOVE 0           TO SP-LAWCODE
                               QSP1-WBEG-LAWCODE.
           MOVE ALL "9"     TO QSP1-WEND-LAWCODE.

           PERFORM START-SP1-FILE.
       F-052-NEXT-SP.
           PERFORM READ-SP1-FILE-NEXT.
           IF NOT (SP-ORGST = LN-ORGST
                     AND SP-SPRCLASS = LN-SPRCLASS
                       AND SP-SUBCLASS = LN-SUBCLASS)
              MOVE 9 TO IO-FG.

           IF IO-FG = 9
              PERFORM SP-INVALID
              GO TO F-052.

           MOVE "S  A015053." TO VDU.
           MOVE SP-DESC TO VDUBUF.
           PERFORM SCREENIO.
           GO TO CREATE-ROUTINE.
       F-06.
           MOVE VDU-DATE-YYYYMMDD TO LN-LOANDATE.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.

           PERFORM CHECK-EFFECTIVE-SPR.
           IF IO-FG = 9
              PERFORM SP-INVALID
              GO TO ENTER-ELE
           ELSE
              MOVE "S  A015053." TO VDU
              MOVE SP-DESC       TO VDUBUF
              PERFORM SCREENIO.

           MOVE SP-LAWCODE TO LN-LAWCODE.
           IF NEW-FLAG = 1
              MOVE "S  8000160." TO VDU
              MOVE LN-LOANDATE TO VDU-DATE-YYYYMMDD
                                  LN-INTDATE
              PERFORM SCREENIO.
           GO TO CREATE-ROUTINE.
       F-07.
           MOVE VDUBUF TO LN-PURCD
                          CD-CODE.
           MOVE "PU"   TO CD-TYPE.
           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-08.
           MOVE VDUBUF TO LN-SRCD
                          CD-CODE.
           MOVE "SR"   TO CD-TYPE.
           IF LN-SRCD = "SC"
              GO TO ENTER-ELE.

           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.

           IF GP-THE-ONLY-SF-SRCD NOT = " "
              IF LN-SRCD NOT = GP-THE-ONLY-SF-SRCD
                 MOVE "INVALID FOR SALES FINANCE CONTRACTS" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           IF LN-SRCD = "ET" OR "LP" OR "NP" OR "RT" OR "ST" OR "RB"
              MOVE SRCD-SEQ TO PASSWDW-SEQ
              MOVE "TO USE THIS SRCD" TO PASSWDW-PROMPT2
              PERFORM VERIFY-PASSWORD
              IF PASSWDW-STAT NOT = "OK"
                 MOVE "INVALID SOURCE CODE" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           GO TO CREATE-ROUTINE.
       F-09.
           MOVE VDUBUF TO LN-COLLCD
                          CD-CODE.
           MOVE "CO"   TO CD-TYPE.
           PERFORM SEND-CD-DESC.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           MOVE CD-CO-SECURED TO SPTEST-CD-SECURED.
           GO TO CREATE-ROUTINE.
       F-10.
           MOVE VDUBUF TO LN-COLLID.
           GO TO CREATE-ROUTINE.
       F-11.
           MOVE VDUBUF TO WK-HHGS-1
                          MEMO-WK1.
           IF MEMO-WK1 = " "
              MOVE " " TO VDUBUF
              MOVE "S  A300111." TO VDU
              PERFORM SCREENIO
              PERFORM SAVE-TRAILER-REC
              GO TO CREATE-ROUTINE.
       CONT-F-11.
           MOVE "E  A330111." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO CONT-F-11.
           MOVE VDUBUF TO MEMO-WK2.
           STRING MEMO-WK1,MEMO-WK2 DELIMITED BY "   " INTO
              WK-HHGS-1.
           PERFORM SAVE-TRAILER-REC.
           GO TO CREATE-ROUTINE.
       F-12.
           MOVE VDUNUM2 TO DL-DLNO
                           LN-DLNO.
           PERFORM GET-DL1.
           MOVE "S  A160121." TO VDU.
           MOVE DL-SHORT TO VDUBUF.
           PERFORM SCREENIO.
           IF IO-FG = 9
              GO TO ENTER-ELE.
      *    IF (GB-DLALLOC-GL = "Y" AND BRANCH NOT = 10)
      *              OR (GB-DLALLOC-GL NOT = "Y")
      *       IF BR-BOOK-SF-BR-ONLY = "Y"
      *          IF LN-OWNBR NOT = DL-BRANCH
      *             MOVE " " TO MESS
      *             MOVE DL-BRANCH TO NDTE-HOLD
      *             STRING
      *              "YOU MUST BE POSTING BRANCH "
      *                NDTE-HOLD
      *                 " TO BOOK THIS QUOTE!!"
      *                   DELIMITED BY SIZE INTO MESS
      *             PERFORM SEND-MESS
      *             GO TO ENTER-ELE.
           IF LN-LOANTYPE = "I"
              IF DL-MAXPURPER NOT = 100
                 MOVE "DEALER HAS INVALID PURCHASE PERCENT" TO MESS
                 PERFORM SEND-MESS
                 MOVE "FOR INTEREST BEARING LOAN CLASS." TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           IF DL-TERMDATE NOT = 0
              IF DL-TERMDATE NOT > LN-LOANDATE
                 MOVE "DEALER HAS BEEN TERMINATED" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           MOVE "SIGN:" TO INSPECT-W.
           MOVE DL-SIGN1 TO ADD-ON.
           PERFORM ADD-IT2.
           MOVE DL-SIGN2 TO ADD-ON.
           PERFORM ADD-IT2.
           MOVE DL-SIGN3 TO ADD-ON.
           PERFORM ADD-IT.
           MOVE INSPECT-W TO MESS.
           PERFORM MSG-LINE.
           IF BR-LC-CODE = "Y"
              MOVE "SNNN020400." TO VDU
              MOVE DL-LC-CODE TO VDUNUM0
                                 LN-LC-CODE
              PERFORM SCREENIO.
           IF (LC-AFP-CLASS-N AND DL-AFP-DEALER-Y) OR
              (LC-AFP-CLASS-Y AND DL-AFP-DEALER-N)
              MOVE "AFP MISMATCH" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-13.
           MOVE VDUBUF TO LN-DLRECOURSE.
           MOVE "S  A090131." TO VDU.
           PERFORM GET-RECOURSE-DESC.
           PERFORM SCREENIO.
           IF VDUBUF = " INVALID"
              MOVE "F-FULL,P-PARTIAL,N-NONE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.
           IF (DL-RECOURSE-FRMLA = "A"
                             AND LN-DLRECOURSE = "F")
              GO TO F-13X.
           IF LN-DLRECOURSE NOT = "P"
              MOVE 0 TO LN-DLPARTRCAMT
              MOVE "132." TO MESS
              PERFORM RESET-MESS
              GO TO CREATE-ROUTINE.
       F-13X.
           MOVE "ENNN062132." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF VDUSTATUS NOT = "00"
                     AND NOT = "1D"
              GO TO F-13X.
           IF VDUNUM2 = 0
              GO TO F-13X.
           MOVE VDUNUM2 TO LN-DLPARTRCAMT.
           GO TO CREATE-ROUTINE.
       F-14.
           MOVE VDUBUF TO LN-UNITPER-CD
                          UPERTST-UNITPER-CD.
           PERFORM UPERTST-UNITPER-CODE.
           IF UPERTST-ERRCD NOT = " "
              GO TO ENTER-ELE.
           IF BR-UNITPER-Y-D-FG NOT = "Y"
              MOVE "SNNN030141." TO VDU
              MOVE 1 TO LN-UNITPER-FREQ
                        VDUNUM0
              PERFORM SCREENIO
              IF NEW-FLAG = 1
                 PERFORM SEND-1STPYDATE
                 GO TO CREATE-ROUTINE
              ELSE
                 GO TO CREATE-ROUTINE.
       F-141.
           MOVE "ENNN030141." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-141.
           MOVE VDUNUM0 TO LN-UNITPER-FREQ
                           UPERTST-UNITPER-FREQ.
           MOVE LN-UNITPER-CD TO UPERTST-UNITPER-CD.
           PERFORM UPERTST-UNITPER-FREQUENCY.
           IF UPERTST-ERRCD NOT = " "
              GO TO F-141.

           IF NEW-FLAG = 1
              PERFORM SEND-1STPYDATE.
           IF NOT (LN-UNITPER-CD = "M"
                          AND LN-UNITPER-FREQ = 1)
              PERFORM UPERTST-SET-MESS
              MOVE UPERTST-MESS TO MESS
              PERFORM SEND-MESS.
           IF NEW-FLAG NOT = 1
                   OR LN-ORGTERM = 1
              PERFORM SET-UNITPER-INFO.
           GO TO CREATE-ROUTINE.
       F-15.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.
           MOVE LN-ORGTERM TO HOLD-WORKER.
           MOVE VDUNUM0 TO LN-ORGTERM
                           LN-SUM-ORGTERM.
           IF HOLD-WORKER NOT = LN-ORGTERM
              PERFORM SET-UNITPER-INFO.
           GO TO CREATE-ROUTINE.
       F-16.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.

           MOVE LN-INTDATE TO HOLD-WORKER.
           MOVE VDU-DATE-YYYYMMDD TO LN-INTDATE.

           IF LN-INTDATE < LN-LOANDATE
              MOVE "CAN'T BE PRIOR TO  LOAN DATE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

           IF NEW-FLAG NOT = 1
              MOVE LN-INTDATE   TO NUM-DATE
              MOVE LN-1STPYDATE TO SYS-DATE
              PERFORM TIM
              IF ELAPSED-DAYS NOT > 0
                 MOVE
                 "INTEREST DATE MUST BE PRIOR TO THE FIRST PAY DATE"
                                                           TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           IF HOLD-WORKER NOT = LN-INTDATE
              PERFORM SET-UNITPER-INFO.
           GO TO CREATE-ROUTINE.
       F-17.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.
           MOVE LN-1STPYDATE TO HOLD-WORKER.
           MOVE VDU-DATE-YYYYMMDD TO LN-ORIG-1STPYDATE
                                     LN-1STPYDATE.
           IF LN-ORIG-1STPYDATE NOT > LN-INTDATE
              MOVE "FIRST PAY MUST BE AFTER THE INTEREST DATE"
                                                    TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.

      * DO NOT ALLOW A FIRST PAYMENT DATE < 30 DAYS FROM LOAN DATE
      * OR < THAN 1 UNIT PERIOD FROM INT DATE
           MOVE LN-INTDATE      TO NDTE-DATE.
           MOVE 1               TO NDTE-HOLD.
           MOVE LN-UNITPER-CD   TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           IF LN-1STPYDATE < NDTE-DATE
              MOVE 1STPY30-SEQ TO PASSWDW-SEQ
              MOVE "1ST PAY < 30 DAYS FROM LNDATE"
                                        TO PASSWDW-PROMPT2
              PERFORM VERIFY-PASSWORD
              IF PASSWDW-STAT NOT = "OK"
                 GO TO ENTER-ELE.

      *  JTG 011001 DON'T ALLOW A FIRST PAY DAY OF 31 WHEN SEMI MONTHLY PAPER
      *                                                            FFG PR#333
      *CS  IF LN-UNITPER-CD = "S"
      *CS     IF LN-1STPYDA = 31
      *CS        MOVE " 31ST OF MONTH INVALID FOR SEMI-MONTHLY PAPER"
      *CS                                                     TO MESS
      *CS        PERFORM SEND-MESS
      *CS        GO TO ENTER-ELE.

      *  CS  021001 PER JOHN DON'T ALLOW A FIRST PAY DAY OF 14 OR 15 EITHER IF
      *      SEMI-MONTHLY.  FEB CAUSED THE CYCLE DATES FOR LATE CHARGES TO BE
      *      OUT OF SYNC. FOR EXAMPLE: WITH PAYDATE OF 15 LCPDTH GOES TO 2/28/YY      *      MARCH WENT TO 3/13/YY INSTEAD OF 3/15/YY [DISCOVERED AT FFG]

           IF LN-UNITPER-CD = "S"
              IF LN-1STPYDA = 14 OR 15 OR 31
                 PERFORM INVALID-DUE-DAY
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.

           IF HOLD-WORKER NOT = LN-1STPYDATE
              PERFORM SET-UNITPER-INFO.
           GO TO CREATE-ROUTINE.
       F-18.
           MOVE VDU-DATE-YYYYMMDD TO LN-CASHDATE.
           IF LN-CASHDATE NOT = 0
              IF LN-CASHDATE < LN-LOANDATE
                 MOVE "CAN'T BE PRIOR TO LOAN-DATE" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-19.
           MOVE VDUNUM3 TO LN-CONRATE.
           GO TO CREATE-ROUTINE.
       F-20.
           MOVE "N" TO  CALCULATE-APR-FG.
           MOVE VDUNUM3 TO LN-APRATE.
           GO TO CREATE-ROUTINE.
       F-21.
           MOVE VDUNUM3 TO LN-OVRDRATE.
           IF SP-FORCE-ENTRY-OVRDRATE(1)
              IF VDUNUM3 = 999.999
                 MOVE " AN OVERRIDE RATE MUST BE ENTERED" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE
              END-IF
              IF VDUNUM3 = 0
                 MOVE " THE OVERRIDE RATE CAN'T BE ZERO" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           IF CHFG-ENDORATE = "N"
              GO TO CREATE-ROUTINE.
       F-211.
           MOVE "ENNN033211." TO VDU.
           PERFORM SCREENIO.
           IF UP-KEY THEN GO TO ENTER-ELE.
           MOVE VDUNUM3 TO LN-ENDORATE.
           GO TO CREATE-ROUTINE.
       F-22.
           IF VDUNUM2 = 0
              GO TO ENTER-ELE.
           MOVE VDUNUM2 TO LN-SELLPR.
           GO TO CREATE-ROUTINE.
       F-23.
           MOVE VDUNUM2 TO LN-DOWNPY.
       F-231.
           IF GP-ALLOW-ENTRY-TRADEIN NOT = "Y"
              MOVE "SNNS062231." TO VDU
              MOVE 0 TO LN-TRADEIN
                        VDUNUM2
              PERFORM SCREENIO
              GO TO CREATE-ROUTINE.
           MOVE "ENNS062231." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO F-231.
           MOVE VDUNUM2 TO LN-TRADEIN.
           GO TO CREATE-ROUTINE.
       F-24.
           MOVE VDUNUM2 TO LN-SERCHG
                           LN-SUM-SERCHG.
       F-241.
           IF SP-MFFRMLA = 0
              GO TO CREATE-ROUTINE.
           MOVE "ENNN032241." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO F-241.
           DIVIDE VDUNUM2 BY LN-ORGTERM GIVING LN-MAINTFEE
              REMAINDER AMT-HOLDER.
           IF AMT-HOLDER NOT = 0
              MOVE "AMOUNT MUST BE EVENLY DIVISABLE BY TERM" TO MESS
              PERFORM SEND-MESS
              GO TO F-241.
           COMPUTE LN-SUM-MAINTFEE = LN-MAINTFEE * LN-ORGTERM.
           GO TO CREATE-ROUTINE.
       F-25.
           MOVE VDUNUM2 TO LN-INTCHG
                           LN-SUM-INTCHG.
       F-251.
           IF SP-PYEXFRMLA = 0
              PERFORM ENTER-LOAN-AMT
              IF VDUSTATUS = "1U"
                 GO TO ENTER-ELE
              ELSE
                 GO TO CREATE-ROUTINE.
           MOVE "ENNN042251." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO F-251.
           MOVE VDUNUM2 TO LN-EXTCHG
                           LN-SUM-EXTCHG.
           PERFORM ENTER-LOAN-AMT.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-26.
           MOVE " " TO CHFG(27) CHFG(28) CHFG(29) CHFG(30) CHFG(31).
           MOVE VDUBUF TO LN-INSCODES.
           IF LN-INSURED NOT = "M"
              IF LN-INSURED NOT = "J"
                 IF LN-INSURED NOT = "N"
                    IF LN-INSURED NOT = "S"
                       MOVE "ENTER 'N','M','S',OR 'J'" TO MESS
                       PERFORM SEND-MESS
                       GO TO ENTER-ELE.
           IF NOT LN-INSTYPES-VALID
              GO TO ENTER-ELE.
           IF NOT LN-INSELIGIBLE-VALID
              GO TO ENTER-ELE.

      * ADDED TO PREVENT ENTRY OF MNN, ETC.
           IF LN-INSTYPES = "N"
              IF LN-INSURED NOT = "N"
                 GO TO ENTER-ELE.

           IF LN-INSURED = "N"
              PERFORM VERIFY-INSURANCE
              IF IO-FG = 9
                 GO TO ENTER-ELE.

           PERFORM VALID-INS-TYPES-ELIG.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           IF CHFG(27) = "N"
              MOVE 0 TO LN-INSCOMP(1) LN-INSTRM(1) LN-INSCOVR(1)
                        LN-INSPREM(1) LN-INSEXP-DATE(1) LN-INSCOMM(1)
              MOVE " " TO LN-INSOURS(1)
              MOVE "270 271 272 273 274." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(28) = "N"
              MOVE 0 TO LN-INSCOMP(2) LN-INSTRM(2) LN-INSCOVR(2)
                        LN-INSPREM(2) LN-INSEXP-DATE(2) LN-INSCOMM(2)
              MOVE " " TO LN-INSOURS(2)
              MOVE "280 281 282 283 284." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(29) = "N"
              MOVE 0 TO LN-INSCOMP(3) LN-INSTRM(3) LN-INSCOVR(3)
                        LN-INSPREM(3) LN-INSEXP-DATE(3) LN-INSCOMM(3)
              MOVE " " TO LN-INSOURS(3)
              MOVE "290 291 292 293 294." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(30) = "N"
              MOVE 0 TO LN-INSCOMP(4) LN-INSTRM(4) LN-INSCOVR(4)
                        LN-INSPREM(4) LN-INSEXP-DATE(4) LN-INSCOMM(4)
              MOVE " " TO LN-INSOURS(4)
              MOVE "300 301 302 303 304." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(31) = "N"
              MOVE 0 TO LN-INSCOMP(5) LN-INSTRM(5) LN-INSCOVR(5)
                        LN-INSPREM(5) LN-INSEXP-DATE(5) LN-INSCOMM(5)
              MOVE " " TO LN-INSOURS(5)
              MOVE "310 311 312 313 314." TO MESS
              PERFORM RESET-MESS.
           IF CHFG(32) = "N"
              MOVE 0 TO LN-INSCOMP(6) LN-INSTRM(6) LN-INSCOVR(6)
                        LN-INSPREM(6) LN-INSEXP-DATE(6) LN-INSCOMM(6)
              MOVE " " TO LN-INSOURS(6)
              MOVE "320 321 322 323 324." TO MESS
              PERFORM RESET-MESS.
           IF (GP-ENTER-LPO-FG = "Y")
              IF NEW-FLAG = 1
                 MOVE LN-DLNO TO DL-DLNO
                 PERFORM GET-DL1
                 MOVE DL-LPO TO WINDOW-LPO
                 MOVE LN-REP-CD TO WINDOW-REP
                 MOVE LN-PROCESS-CD TO WINDOW-PROCESS
                 MOVE "WI/TFCCDS" TO FORM-NAM
                 CALL FORM-PROGX USING FORM-PATH WINDOW-WORKERS
                 CANCEL FORM-PROGX
                 MOVE WINDOW-LPO TO LN-LPO
                 MOVE WINDOW-REP TO LN-REP-CD
                 MOVE WINDOW-PROCESS TO LN-PROCESS-CD.
           GO TO CREATE-ROUTINE.
       F-27.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-28.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-29.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-30.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-31.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-32.
           PERFORM INSURANCE-ENTRY.
           IF IO-FG = 9
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-33.
           GO TO CREATE-ROUTINE.
       F-34.
           GO TO CREATE-ROUTINE.
       F-35.
           IF VDUNUM2 = 0
              GO TO CREATE-ROUTINE.
           MOVE VDUNUM2 TO LN-1STPYAMT.
       F-351.
           MOVE "^-BACK, ENTER THE REGULAR PAYMENT AMOUNT:"
                                                      TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "ENNN062351." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-351.
           MOVE VDUNUM2 TO LN-REGPYAMT.
           MOVE 36 TO ELE.
           MOVE "SNNN062360." TO VDU.
           COMPUTE LN-LASTPYAMT
                   VDUNUM2 =
                        HOLD-TOTAL-REPAY - LN-1STPYAMT
                                - (LN-NOREGPY * LN-REGPYAMT).
           IF VDUNUM2 < 0
              MOVE "THIS PAYMENT WILL CAUSE A NEGATIVE LAST PAYMENT!"
                                                    TO MESS
              PERFORM SEND-MESS
              GO TO F-351.
           PERFORM SCREENIO.
           GO TO ENTER-ELE.
       F-36.
           MOVE VDUNUM2 TO LN-LASTPYAMT.
           PERFORM TEST-PAY.
           IF TEST-PAY-FG NOT = " "
              MOVE HOLD-TOTAL-REPAY TO TOTAL-REPAY
              MOVE 35 TO ELE
              GO TO ENTER-ELE.
           MOVE "C" TO REGPY-FG.
           GO TO CREATE-ROUTINE.
       F-37.
           MOVE VDU-DATE-YYYYMMDD TO LN-PURDATE.
           IF VDUNUM0 = 0
              GO TO ENTER-ELE.

           IF LN-PURDATE < LN-LOANDATE
              MOVE "CAN'T BE PRIOR TO LOAN-DATE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       F-38.
           MOVE "Y" TO FORCE-ENTERED-PRIN1.
           IF GP-DLRVPRIN-1-FG NOT = "Y"
              IF VDUNUM2 NOT = 0
                 MOVE "RESERVE PRINCIPAL 1 MUST BE 0" TO MESS
                 PERFORM SEND-MESS
              END-IF
              MOVE "SN N062380." TO VDU
              MOVE 0 TO VDUNUM2
              PERFORM SCREENIO.
           IF (SP-DLDISC-RVPRIN1-PCNT NOT = 0   ) OR
              (SP-DLDISC-RVPRIN1-AF-PCNT NOT = 0)
              IF (SP-DLDISC-RVPRIN1-PCNT NOT = 0 AND
                   SP-DLDISC-RVPRIN1-PCNT NOT = 202.02)
                 COMPUTE LN-DLDISC ROUNDED =
                      VDUNUM2 * SP-DLDISC-RVPRIN1-PCNT * 0.01
                 COMPUTE LN-DLRVPRIN(1) = VDUNUM2 - LN-DLDISC
              ELSE
                 PERFORM RSV-CALC-AMTFIN
                 IF (SP-DLDISC-RVPRIN1-AF-PCNT NOT = 0 AND
                      SP-DLDISC-RVPRIN1-AF-PCNT NOT = 202.02)
                    COMPUTE LN-DLRVPRIN(1) ROUNDED =
                         RSVENT-AMTFIN
                           * SP-DLDISC-RVPRIN1-AF-PCNT * 0.01
                    IF VDUNUM2 < LN-DLRVPRIN(1)
                       MOVE 0       TO LN-DLDISC
                       MOVE VDUNUM2 TO LN-DLRVPRIN(1)
                       MOVE
            " AMOUNT ENTERED IS LESS THAN COMPUTED RSV PRIN RE: SPR%"
                                                        TO MESS
                       PERFORM SEND-MESS
                    ELSE
                       COMPUTE LN-DLDISC = VDUNUM2 - LN-DLRVPRIN(1)
                    END-IF
                 END-IF
              END-IF
              MOVE "SNNN062380."  TO VDU
              MOVE LN-DLRVPRIN(1) TO VDUNUM2
              PERFORM SCREENIO
              MOVE "SNNN062391." TO VDU
              MOVE LN-DLDISC     TO VDUNUM2
              PERFORM SCREENIO
              MOVE "I"           TO DLDISC-FG
           ELSE
              MOVE VDUNUM2 TO LN-DLRVPRIN(1).
           MOVE "I" TO DLRVPRIN-FG(1).
       F-381.
           MOVE
            "^-BACK, F3-RSV WINDOW, ENTER RESERVE CHARGES #1:"
                                                        TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "ENNN062381." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "16"
              PERFORM DO-RSVENT-WINDOW
              GO TO CREATE-ROUTINE.
           IF VDUSTATUS = "1U"
              GO TO ENTER-ELE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO F-381.
           MOVE VDUNUM2 TO LN-DLRVCHGS(1).
           MOVE "I" TO DLRVCHGS-FG(1).
           GO TO CREATE-ROUTINE.
       F-39.
           IF LN-LOANTYPE = "I"
              IF VDUNUM2 NOT = 0
                 MOVE
           "PARTICIPATION HELD NOT ALLOWED ON 'IB' ACCOUNTS, USE F3"
                     TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-ELE.
           MOVE VDUNUM2 TO LN-DLPARVHELD.
           MOVE "I" TO DLPARVHELD-FG.
           IF SP-ERNFRMLA(5) = 0
              GO TO CREATE-ROUTINE.
           IF (SP-DLDISC-RVPRIN1-PCNT NOT = 0 AND
                SP-DLDISC-RVPRIN1-PCNT NOT = 202.02) OR
              ( SP-DLDISC-RVPRIN1-AF-PCNT NOT = 0  AND
                 SP-DLDISC-RVPRIN1-AF-PCNT NOT = 202.02)
              GO TO CREATE-ROUTINE.
       F-391.
      *    IF GP-I-AM-WORLD
      *       GO TO END-F391.
      *    MOVE "^-BACK, F3-RSV WINDOW, ENTER DEALER DISC:" TO LEGEND.
      *    PERFORM SEND-LEGEND.
      *    MOVE "ENNN062391." TO VDU.
      *    PERFORM SCREENIO.
      *    IF VDUSTATUS = "16"
      *       PERFORM DO-RSVENT-WINDOW
      *       GO TO CREATE-ROUTINE.
      *    IF VDUSTATUS = "1U"
      *       GO TO ENTER-ELE.
      *    IF NOT (VDUSTATUS = "00" OR "1D")
      *       GO TO F-391.
      *    MOVE VDUNUM2 TO LN-DLDISC.
      *    MOVE "I" TO DLDISC-FG.
      *END-F391.
           GO TO CREATE-ROUTINE.
       F-40.
           MOVE VDUNUM0 TO LN-LC-CODE.

           MOVE "EL"       TO CD-TYPE.
           MOVE LN-LC-CODE TO CD-EL-CODE.
           MOVE SPACES     TO CD-EL-FILLER.
           PERFORM GET-CD.
           IF IO-FG NOT = 0 AND LN-LC-CODE NOT = 0
              MOVE "INVALID CODE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ELE.
           GO TO CREATE-ROUTINE.
       END-ENTRY-MODULE.
           EXIT.

      ***********************************
       BORROWER-ENTRY SECTION.
      ***********************************
           MOVE 0 TO IO-FG.

           MOVE VDUNUM0 TO NUM-BW.
           MOVE NUM-BW TO LN-SSNO(ELE)
                          BW-SSNO.
           IF NUM-BW NOT = 0
              GO TO GET-BORROWER.
           IF ELE = 1
              MOVE 9 TO IO-FG
              GO TO EXIT-ENTER-BORROWER.
           MOVE 0 TO BW-SSNO.
           MOVE " " TO INSPECT-W.
       NEXT-BW-CLEAR.
           MOVE 0   TO LN-SSNO(ELE).
           MOVE " " TO LN-MAKERCD(ELE).
           PERFORM SEND-BW-NO-NAME.
           PERFORM SEND-BW-MAKERCD.

           IF ELE < 4
              ADD 1 TO ELE
              GO TO NEXT-BW-CLEAR.

           PERFORM BW-CHECK-ENDORSER.
           MOVE 0 TO IO-FG.
           GO TO EXIT-ENTER-BORROWER.
       GET-BORROWER.
           PERFORM BW-TABLE-CHECK.
           IF IO-FG = 9
              GO TO EXIT-ENTER-BORROWER.

           PERFORM GET-BW1.
           PERFORM SEND-BW-NAME.
           IF IO-FG = 9
              GO TO EXIT-ENTER-BORROWER.

           IF GP-VALID-BDATE = "Y"
              MOVE BW-BDATE TO NUM-DATE
              PERFORM TSTDAT
              IF NUM-DATE = 0
                 MOVE "BORROWER HAS AN INVALID BIRTHDATE" TO MESS
                 PERFORM SEND-MESS
                 MOVE 9 TO IO-FG
                 GO TO EXIT-ENTER-BORROWER.

           IF ELE = 1
              MOVE "M"             TO LN-MAKERCD(1)
              PERFORM SEND-BW-MAKERCD
              MOVE BW-CONFIDENTIAL TO LN-CONFIDENTCD
              MOVE BW-ORIGIN       TO LN-ORIGIN
              GO TO EXIT-ENTER-BORROWER.

       ENTER-MAKER-CODE.
           MOVE "E  A010  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE 9 TO IO-FG
              GO TO EXIT-ENTER-BORROWER.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-MAKER-CODE.
           IF VDUBUF NOT = "J"
              IF VDUBUF NOT = "E"
                 MOVE "(M-MAKER),J-JOINT,E-ENDORSER" TO MESS
                 PERFORM SEND-MESS
                 GO TO ENTER-MAKER-CODE.
           MOVE VDUBUF TO LN-MAKERCD(ELE).
       EXIT-ENTER-BORROWER.
           EXIT.

      ****************************************
       BW-TABLE-CHECK SECTION.
      ****************************************
           IF ELE NOT = 1
              SUBTRACT 1 FROM ELE GIVING I-LEVEL
              IF LN-SSNO(I-LEVEL) = 0
                 MOVE 9 TO IO-FG
                 MOVE "ENTER SERIALLY" TO MESS
                 PERFORM SEND-MESS
                 GO TO EXIT-BW-TABLE-CHECK.
           MOVE 4 TO I-LEVEL.
       NEXT-BW-LEVEL-CHECK.
           IF LN-SSNO(I-LEVEL) = LN-SSNO(ELE)
                                  AND I-LEVEL NOT = ELE
              MOVE 9 TO IO-FG
              MOVE "NO DUPLICATES" TO MESS
              PERFORM SEND-MESS
              GO TO EXIT-BW-TABLE-CHECK.
           SUBTRACT 1 FROM I-LEVEL.
           IF I-LEVEL > 0
              GO TO NEXT-BW-LEVEL-CHECK.
       EXIT-BW-TABLE-CHECK.
           EXIT.

      ****************************************
       BW-CHECK-ENDORSER SECTION.
      ****************************************
           MOVE 0 TO I-LEVEL.
       NEXT-ENDORSER-CHECK.
           ADD 1 TO I-LEVEL.
           IF LN-MAKERCD(I-LEVEL) = "E"
              MOVE " " TO CHFG-ENDORATE
              GO TO EXIT-CHECK-ENDORSER.
           IF I-LEVEL < 4
              GO TO NEXT-ENDORSER-CHECK.
       EXIT-CHECK-ENDORSER.
           EXIT.

      ******************************************
       SUBCLASS-SCAN SECTION.
      ******************************************
           MOVE SPACES      TO SCSCAN-SP1-KEY.
           MOVE LN-ORGST    TO SCSCAN-ORGST.
           MOVE LN-SPRCLASS TO SCSCAN-SPRCLASS.
           MOVE 0           TO SCSCAN-SUBCLASS
                               SCSCAN-LAWCODE.
           MOVE "Y"         TO SCSCAN-LAST-LAW.
           MOVE TRANS-DATE  TO SCSCAN-TRANS-DATE.
           MOVE "WI/SCSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH SCSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF SCSCAN-STATUS NOT = "00" OR SCSCAN-SP1-KEY = " "
              MOVE 9 TO IO-FG
              GO TO EXIT-SUBCLASS-SCAN
           ELSE
              MOVE 0 TO IO-FG.

           MOVE "SNNN020052." TO VDU.
           MOVE SCSCAN-SP-SUBCLASS TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE SCSCAN-SP-SUBCLASS TO VDUNUM0.

       EXIT-SUBCLASS-SCAN.
           EXIT.

      ******************************************************************
       ELCODE-SCAN SECTION.
      ******************************************************************

           MOVE "EL"   TO ELSCAN-TYPE.
           MOVE ZEROES TO ELSCAN-CODE.

           MOVE "WI/ELSCAN " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH ELSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           IF ( ELSCAN-STATUS NOT = "00") OR (ELSCAN-CODE = 0 )
               MOVE 9 TO IO-FG
               GO TO EXIT-ELCODE-SCAN.

           MOVE "SNNN020400." TO VDU.
           MOVE ELSCAN-CODE   TO VDUNUM0.
           PERFORM SCREENIO.

           MOVE ZEROES        TO IO-FG.
           MOVE ELSCAN-CODE   TO VDUNUM0.

       EXIT-ELCODE-SCAN.
           EXIT.

      *************************************
       BORROWER-CREATE SECTION.
      *************************************
           IF VDUBUF = " " AND LN-SSNO(ELE) NOT = 0
              MOVE LN-SSNO(ELE) TO BWCREA-NO
           ELSE
              MOVE VDUBUF TO ALP-BW
              MOVE ALP-BW123 TO NUM-BW123
              MOVE ALP-BW45 TO NUM-BW45
              MOVE ALP-BW6789 TO NUM-BW6789
              IF NUM-BW NOT NUMERIC
                 MOVE 0 TO BWCREA-NO
              ELSE
                 MOVE NUM-BW TO BWCREA-NO.

           MOVE LN-SSNO(1) TO BWCREA-SSNO(1).
           MOVE LN-SSNO(2) TO BWCREA-SSNO(2).
           MOVE LN-SSNO(3) TO BWCREA-SSNO(3).
           MOVE LN-SSNO(4) TO BWCREA-SSNO(4).
           MOVE BWCREA-NO TO BWCREA-SSNO(ELE).

           MOVE "N"                       TO BWCREA-ALLOW-CHG.
           MOVE TRANS-DATE                TO BWCREA-TRANS-DATE.
           MOVE BRANCH                    TO BWCREA-BRANCH.
           MOVE "WI/BWCREA" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWCREA-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF BWCREA-STATUS NOT = "00" OR BWCREA-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BORROWER-CREATE.

           MOVE BWCREA-NO TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           MOVE ALP-BW TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-BORROWER-CREATE.
           EXIT.

      ***********************************************
       BORROWER-SCAN SECTION.
      ***********************************************
           MOVE 0   TO BWSCAN-NO.
           MOVE "S" TO BWSCAN-SCAN-TYPE.
           MOVE "WI/BWSCAN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH BWSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF BWSCAN-STATUS NOT = "00" OR BWSCAN-NO = 0
              MOVE 9 TO IO-FG
              GO TO EXIT-BORROWER-SCAN.

           MOVE BWSCAN-NO TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           MOVE ALP-BW TO VDUBUF.
           MOVE 0 TO IO-FG.

       EXIT-BORROWER-SCAN.
           EXIT.

      ********************************************
       DEALER-SCAN SECTION.
      ********************************************
           MOVE 0 TO DLSCAN-NUM.
           MOVE "WI/DLSCAN " TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH DLSCAN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
           IF DLSCAN-STATUS NOT = "00" OR DLSCAN-NUM = " "
               MOVE 9 TO IO-FG
               GO TO EXIT-DEALER-SCAN.

           MOVE "SN N042120." TO VDU.
           MOVE DLSCAN-DLNO TO VDUNUM2.
           PERFORM SCREENIO.
           MOVE DLSCAN-DLNO TO VDUNUM2.
           MOVE 0 TO IO-FG.

       EXIT-DEALER-SCAN.
           EXIT.

      *****************************************************
       SET-UNITPER-INFO SECTION.
      *****************************************************
           IF LN-ORGTERM > 1
              IF LN-UNITPER-CD = "D"
                 MOVE "M" TO LN-UNITPER-CD
                 MOVE 1 TO LN-UNITPER-FREQ
                 MOVE "NOTE: ------> SWITCHING BACK TO MONTHLY PAPER!!"
                                                        TO MESS
                 PERFORM SEND-MESS.

           MOVE LN-UNITPER-CD   TO UPER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO UPER-UNITPER-FREQ.
           MOVE LN-INTDATE      TO UPER-INTDATE.
           MOVE LN-ORIG-1STPYDATE TO UPER-1STPYDATE.
           MOVE LN-ORGTERM TO UPER-TERM.
           PERFORM UPER-CALCULATION.

           MOVE UPER-UNITPER-PER-YEAR TO LN-UNITPER-PER-YEAR.
           MOVE UPER-DAYS-IN-UNITPER TO LN-DAYS-IN-UNITPER.
           IF LN-ORGTERM = 1
              MOVE UPER-SINGLE-PAY-CD TO LN-UNITPER-CD
              MOVE UPER-SINGLE-PAY-FREQ TO LN-UNITPER-FREQ.

           MOVE "S  A010140." TO VDU.
           MOVE LN-UNITPER-CD TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "SN N030141." TO VDU.
           MOVE LN-UNITPER-FREQ TO VDUNUM0.
           PERFORM SCREENIO.

           IF LN-ORGTERM = 1
              MOVE "DEFAULTS FOR SINGLE PAY LOANS SET!!" TO MESS
              PERFORM SEND-MESS.

       SET-UNITPER-INFO-EXIT.
           EXIT.

      ***********************************
       ARRANGE-BW-KEY SECTION.
      ***********************************
           MOVE 1 TO IX1 IX2.
           MOVE " " TO BW-ALP-TABLE.
       ARR-BW-KEY-AGAIN.
           IF IX1 NOT < 35
              GO TO ARR-BW-KEY-EXIT.
           IF VDUTAB(IX1) NOT = ","
              MOVE VDUTAB(IX1) TO BW-ALP-TBL(IX2)
            ELSE
              MOVE 35 TO IX2.
           ADD 1 TO IX1.
           ADD 1 TO IX2.
           GO TO ARR-BW-KEY-AGAIN.
       ARR-BW-KEY-EXIT.
           EXIT.

      ***********************************
       INSURANCE-ENTRY SECTION.
      ***********************************
           MOVE 0 TO IO-FG.
           SUBTRACT 26 FROM ELE GIVING I-LEVEL.
           IF VDUNUM0 = 0
              MOVE VDUNUM0 TO LN-INSCOMP(I-LEVEL) IC-CODE
              GO TO ENTER-IC-OURS.

      * TEST PASSWD TO CHANGE DEFAULT INSURANCE COMPANY ON CL,AH,PP,O1
           IF I-LEVEL < 5
              IF VDUNUM0 NOT = LN-INSCOMP(I-LEVEL)
                 MOVE INSCO-SEQ TO PASSWDW-SEQ
                 MOVE "TO CHANGE INS. COMPANY....:" TO PASSWDW-PROMPT2
                 PERFORM VERIFY-PASSWORD
                 IF PASSWDW-STAT NOT = "OK"
                    MOVE "SNNN020  0." TO VDU
                    MOVE ELE TO VDUROW
                    MOVE LN-INSCOMP(I-LEVEL) TO VDUNUM0
                    PERFORM SCREENIO
                    MOVE 9 TO IO-FG
                    GO TO EXIT-ENTER-INSURANCE.

           MOVE VDUNUM0 TO LN-INSCOMP(I-LEVEL) IC-CODE.
           PERFORM READ-IC1-FILE.
           IF IO-FG = 9
              MOVE "INVALID COMPANY" TO MESS
              PERFORM SEND-MESS
              GO TO EXIT-ENTER-INSURANCE.

           PERFORM COMPUTE-INS-TERM-I-LEVEL.

       ENTER-IC-OURS.
           IF IC-CODE = 0
              MOVE " " TO LN-INSOURS(I-LEVEL)
              GO TO SEND-IC-OURS.
           MOVE "SPACE = Y" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "R  A010  1." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE 9 TO IO-FG
              GO TO EXIT-ENTER-INSURANCE.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-IC-OURS.
           IF VDUBUF = " "
              MOVE "Y" TO VDUBUF
              IF LN-SERVACCT = "Y"
                 MOVE "N" TO VDUBUF.
           IF VDUBUF NOT = "Y"
              IF VDUBUF NOT = "N"
                 IF VDUBUF NOT = "M"
                    MOVE "Y-YES, N-NO, M-MEMO" TO MESS
                    PERFORM SEND-MESS
                    GO TO ENTER-IC-OURS.
           MOVE VDUBUF TO LN-INSOURS(I-LEVEL).
       SEND-IC-OURS.
           MOVE "S  A010  1." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-INSOURS(I-LEVEL) TO VDUBUF.
           PERFORM SCREENIO.
           MOVE " " TO MESS.
           PERFORM SEND-LEGEND.
           IF IC-CODE NOT = 0
              IF I-LEVEL > 4
                 GO TO ENTER-IC-COVR
              ELSE
                 GO TO ENTER-IC-PREM.
       ENTER-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM NOT = "Y"
              GO TO ENTER-IC-EXP.
           IF IC-CODE = 0
              MOVE 0 TO LN-INSTRM(I-LEVEL)
              GO TO SEND-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM = "Y"
              MOVE "RNNN060  2." TO VDU
           ELSE
              MOVE "RNNN030  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-IC-OURS.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO ENTER-IC-TERM.
           IF ( VDUNUM0 > 360 )
              GO TO ENTER-IC-TERM.
           MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL).
       SEND-IC-TERM.
           IF I-LEVEL > 4 AND GP-OT-INS-TERM = "Y"
              MOVE "SN N060  2." TO VDU
           ELSE
              MOVE "SN N030  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-INSTRM(I-LEVEL) TO VDUNUM0.
           PERFORM SCREENIO.
           GO TO ENTER-IC-COVR.
       ENTER-IC-EXP.
           IF IC-CODE = 0
              MOVE 0 TO LN-INSEXP-DATE(I-LEVEL)
              GO TO SEND-IC-EXP.
           MOVE "RNNN060  2." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-IC-OURS.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO ENTER-IC-EXP.
           IF VDUNUM0 = 0
              GO TO ENTER-IC-EXP.
           MOVE VDUNUM0 TO DATE-MMDDYY.
           PERFORM CONVERT-MMDDYY-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO LN-INSEXP-DATE(I-LEVEL) NUM-DATE.
           PERFORM TSTDAT.
           IF NUM-DATE = 0
              MOVE "INVALID DATE" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-IC-EXP.
       SEND-IC-EXP.
           MOVE "SNNN060  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-INSEXP-DATE(I-LEVEL) TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO VDUNUM0.
           PERFORM SCREENIO.
       ENTER-IC-COVR.
           IF IC-CODE = 0
              MOVE 0 TO LN-INSCOVR(I-LEVEL)
              GO TO SEND-IC-COVR.
           MOVE "RNNN062  3." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-IC-TERM.
           IF NOT (VDUSTATUS = "00" OR = "1D")
              GO TO ENTER-IC-COVR.
           MOVE VDUNUM2 TO LN-INSCOVR(I-LEVEL).
       SEND-IC-COVR.
           MOVE "SN N062  3." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-INSCOVR(I-LEVEL) TO VDUNUM2.
           PERFORM SCREENIO.
       ENTER-IC-PREM.
           MOVE " " TO PREM-CHANGE.
           MOVE LN-INSPREM(I-LEVEL) TO PREM-AMOUNT.
           IF IC-CODE = 0
              MOVE 0 TO LN-INSPREM(I-LEVEL)
                        LN-INSCOMM(I-LEVEL)
              IF ELE = 32
                 MOVE 0 TO LN-O3INS-DLPROC
              END-IF
              GO TO SEND-IC-PREM.
           IF ELE = 32
              IF ((BR-SFDLO3-WINDOW-FG NOT =  "N")
                             AND (LN-INSOURS(I-LEVEL) = "Y"))
                             OR  (BR-SFDLO3-WINDOW-FG = "B")
                 MOVE LN-INSPREM(I-LEVEL) TO SFDLO3-PREM
                 MOVE LN-INSCOMM(I-LEVEL) TO SFDLO3-COMM
                 MOVE LN-O3INS-DLPROC TO SFDLO3-DLPROC
                 MOVE LN-ORGST TO SFDLO3-ORGST
                 MOVE "CL/SFDLO3" TO FORM-NAM
                 CALL FORM-PROGX USING FORM-PATH SFDLO3-WORKERS
                                                EXIT-PATHNAME
                 CANCEL FORM-PROGX
                 MOVE SFDLO3-PREM TO LN-INSPREM(I-LEVEL)
                 MOVE SFDLO3-COMM TO LN-INSCOMM(I-LEVEL)
                 MOVE SFDLO3-DLPROC TO LN-O3INS-DLPROC
                 MOVE "SN N042  4." TO VDU
                 MOVE ELE TO VDUROW
                 MOVE LN-INSPREM(I-LEVEL) TO VDUNUM2
                 PERFORM SCREENIO
                 GO TO EXIT-ENTER-INSURANCE
              ELSE
                 MOVE 0 TO LN-INSCOMM(I-LEVEL)
                           LN-O3INS-DLPROC.

      *--->MOVE "^-BACK, ENTER THE INSURANCE PREMIUM:" TO MESS.
      *--->PERFORM SEND-LEGEND.
           MOVE "RNNN042  4." TO VDU.
           MOVE ELE TO VDUROW.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-IC-COVR.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-IC-PREM.
           MOVE VDUNUM2 TO LN-INSPREM(I-LEVEL).
       SEND-IC-PREM.
           MOVE "SN N042  4." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-INSPREM(I-LEVEL) TO VDUNUM2.
           PERFORM SCREENIO.
           IF LN-INSPREM(I-LEVEL) NOT = PREM-AMOUNT
              MOVE "Y" TO PREM-CHANGE.

       EXIT-ENTER-INSURANCE.
           EXIT.

      ***********************************
       CHECK-EFFECTIVE-SPR SECTION.
      ***********************************

           MOVE LN-ORGST    TO SP-ORGST
                               QSP1-WBEG-ORGST
                               QSP1-WEND-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS
                               QSP1-WBEG-SPRCLASS
                               QSP1-WEND-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS
                               QSP1-WBEG-SUBCLASS
                               QSP1-WEND-SUBCLASS.
           MOVE 0           TO SP-LAWCODE
                               QSP1-WBEG-LAWCODE.
           MOVE ALL "9"     TO QSP1-WEND-LAWCODE.

           PERFORM START-SP1-FILE.
       CHECK-EFF-SPR-NEXT.
           PERFORM READ-SP1-FILE-NEXT.
           IF IO-FG = 9
              GO TO CHECK-EFF-SPR-EXIT.

           IF NOT (SP-ORGST = LN-ORGST
                         AND SP-SPRCLASS = LN-SPRCLASS
                          AND SP-SUBCLASS = LN-SUBCLASS)
              MOVE 9 TO IO-FG
              GO TO CHECK-EFF-SPR-EXIT.

           IF SP-EFFDATE > LN-LOANDATE
              GO TO CHECK-EFF-SPR-NEXT
           ELSE
              IF SP-EXPDATE = 0
                 GO TO CHECK-EFF-SPR-EXIT.

           IF SP-EXPDATE NOT > LN-LOANDATE
              GO TO CHECK-EFF-SPR-NEXT.

       CHECK-EFF-SPR-EXIT.
           EXIT.

      *********************************
       SEND-PURCHASE-FIELDS SECTION.
      *********************************
           IF LN-PURDATE = 0
              MOVE TRANS-DATE TO LN-PURDATE.

           PERFORM COMPUTE-PRINCIPLE.
           PERFORM COMPUTE-PAYMENTS.
           PERFORM COMPUTE-ANTICTERM.
           IF LN-CURBAL = 0 AND LN-POFFDATE = ZEROS
               PERFORM COMPUTE-PURBAL.

           PERFORM SETUP-PURCHASE-FIELDS.

      * NOTE: THE FOLLOWING IF IS TO ASSURE THAT WHEN LNSTAT.C
      *       IS CALLED AND REBATES ARE SET THAT THOSE ADJUSTMENTS
      *       ARE NOT OVER WRITTEN HERE, JTG 010329

           IF ( LN-INT-REBATE = " " OR "N") AND
              ( LN-SC-REBATE  = " " OR "N") AND
              ( LN-MF-REBATE  = " " OR "N") AND
              ( LN-ANTICADJ(1) = 0        ) AND
              ( LN-ANTICADJ(3) = 0        ) AND
              ( LN-ANTICADJ(4) = 0        )
              PERFORM COMPUTE-ANTICIPATED.

           PERFORM COMPUTE-DEALER-CHECK.
           PERFORM COMPUTE-INS-COVERAGE.
           PERFORM SEND-X-LIST.
           PERFORM CALCULATE-APR.

       EXIT-SEND-PURCHASE-FIELDS.
           EXIT.

      *********************************
       COMPUTE-INS-COVERAGE SECTION.
      *********************************
           PERFORM LOAN-CALCULATIONS.
           IF LN-INSTYPES-LL
                      OR LN-INSTYPES-DL
              IF LN-INSCOMP(1) NOT = 0
                 MOVE "SN N062273." TO VDU
                 MOVE 1 TO LN-SUB
                 IF LN-INSTYPES-LL
                    MOVE 3 TO SP-SUB
                    PERFORM SET-COVERAGE
                 ELSE
                    MOVE 1 TO SP-SUB
                    PERFORM SET-COVERAGE.
           IF LN-INSTYPES-AH
              IF LN-INSCOMP(2) NOT = 0
                 MOVE "SN N062283." TO VDU
                 MOVE 5 TO SP-SUB
                 MOVE 2 TO LN-SUB
                 PERFORM SET-COVERAGE.
           IF LN-INSTYPES-PP
                      OR LN-INSTYPES-PP2
              IF LN-INSCOMP(3) NOT = 0
                 MOVE "SN N062293." TO VDU
                 MOVE 3 TO LN-SUB
                 IF LN-INSTYPES-PP
                    MOVE 6 TO SP-SUB
                    PERFORM SET-COVERAGE
                 ELSE
                    MOVE 7 TO SP-SUB
                    PERFORM SET-COVERAGE.
           IF LN-INSTYPES-O1
              IF LN-INSPREM(4) NOT = 0
                 MOVE "SN N062303." TO VDU
                 MOVE 8 TO SP-SUB
                 MOVE 4 TO LN-SUB
                 PERFORM SET-COVERAGE.

           GO TO COMPUTE-INS-COVERAGE-EXIT.

       SET-COVERAGE.
           IF LN-INSURED = "J"
               IF SP-SUB = 1 OR 3
                  ADD 1 TO SP-SUB.
           IF SP-INS-TOTAL-NOTE(SP-SUB)
              MOVE TOTAL-NOTE TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-PRINCIPAL(SP-SUB) OR SP-INS-ADJ-PRIN-NO1INT(SP-SUB)
              MOVE DISCLOSED-FINAMT TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-CASH-ADVANCE(SP-SUB)
              MOVE CASH-ADVANCE TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-SP-CASH-ADVANCE(SP-SUB)
              MOVE SPCASH-ADVANCE TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-CASH-ADV-FEES(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) = CASH-ADVANCE - NONMEMO-FEES
              MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-TOTAL-NOTE-EXT(SP-SUB)
              ADD TOTAL-NOTE LN-EXTCHG GIVING VDUNUM2
                                              LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-ALL(SP-SUB)
              MOVE TOTAL-REPAY TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-ADJ-PRINCIPAL(SP-SUB)
              MOVE ADJ-PRINCIPAL TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-ADJ-PRIN-3PMTS(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) =
                     DISCLOSED-FINAMT + (3 * LN-REGPYAMT)
                     MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-AMTFIN-2PMTS(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) =
                     DISCLOSED-FINAMT + (2 * LN-REGPYAMT)
                     MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-AMTFIN-1PMTS(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) = DISCLOSED-FINAMT
                                          + LN-REGPYAMT
                            MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-ADJ-CASH-ADVANCE(SP-SUB)
              MOVE HIGH-CREDIT TO VDUNUM2 LN-INSCOVR(LN-SUB)
           ELSE
           IF SP-INS-BENEFIT-TERM(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) = TOTAL-NOTE / LN-ORGTERM
                                         * LN-INSTRM(LN-SUB)
              MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-TN-INT-CL(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) =
                 LN-PROCEEDS + NONMEMO-FEES + LN-SERCHG
                    + (LN-PRBAL + LN-PRINTDUE - LN-PRFINCHGRB
                         - LN-PRINSRB) + LN-INSPREM(2) + LN-INSPREM(3)
                    + LN-INSPREM(4) + LN-INSPREM(5) + LN-INSPREM(6)
              MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-TN-INT-SC-CL(SP-SUB)
              COMPUTE LN-INSCOVR(LN-SUB) = LN-PROCEEDS + NONMEMO-FEES
                    + LN-INSPREM(2) + LN-INSPREM(3)
                    + LN-INSPREM(4) + LN-INSPREM(5) + LN-INSPREM(6)
              MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
           ELSE
           IF SP-INS-NET-PAYOFF(SP-SUB)
              MOVE DISCLOSED-FINAMT TO LN-INSCOVR(LN-SUB) VDUNUM2
           ELSE
              MOVE 0 TO VDUNUM2 LN-INSCOVR(LN-SUB).
           IF SP-INS-MAX-TERM-BENEFIT(SP-SUB)
              IF LN-ORGTERM > SP-INSMAXTERM(SP-SUB)
                 IF LN-REGPYAMT > SP-INSMAXBENIF(SP-SUB)
      * BOTH TERM AND PAYMENT EXCEED MAX
                    COMPUTE LN-INSCOVR(LN-SUB) =
                     ( SP-INSMAXTERM(SP-SUB) * SP-INSMAXBENIF(SP-SUB) )
                                - LN-SUM-MAINTFEE - LN-EXTCHG
                    MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
                 ELSE
      * TERM EXCEEDS MAX BUT PAYMENT DOES NOT
                    COMPUTE LN-INSCOVR(LN-SUB) =
                          ( SP-INSMAXTERM(SP-SUB) * LN-REGPYAMT )
                                - LN-SUM-MAINTFEE - LN-EXTCHG
                    MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
              ELSE
                 IF LN-REGPYAMT > SP-INSMAXBENIF(SP-SUB)
      * TERM DOES NOT EXCEED MAX BUT PAYMENT DOES
                    COMPUTE LN-INSCOVR(LN-SUB) =
                          ( LN-ORGTERM * SP-INSMAXBENIF(SP-SUB) )
                                - LN-SUM-MAINTFEE - LN-EXTCHG
                    MOVE LN-INSCOVR(LN-SUB) TO VDUNUM2
                  ELSE
                     MOVE TOTAL-NOTE TO LN-INSCOVR(LN-SUB) VDUNUM2.

           PERFORM SCREENIO.

       COMPUTE-INS-COVERAGE-EXIT.
           EXIT.

      *********************************
       COMPUTE-INS-TERM SECTION.
      *********************************
           MOVE 0 TO I-LEVEL.
       COMPUTE-INS-TRM.
           IF I-LEVEL < 5
              ADD 1 TO I-LEVEL
              PERFORM COMPUTE-INS-TERM-I-LEVEL
              GO TO COMPUTE-INS-TRM.

      *********************************
       COMPUTE-INS-TERM-I-LEVEL SECTION.
      *********************************
           IF I-LEVEL = 1
              IF LN-INSCOMP(1) NOT = 0
                 MOVE 0 TO SUB
                 IF LN-INSURED = "J"
                    MOVE 1 TO SUB.

           IF I-LEVEL = 1
              IF LN-INSCOMP(1) NOT = 0
                 MOVE "SN N030272." TO VDU
                 IF LN-INSTYPES-DL
                    ADD 1 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO
                 ELSE
                    IF LN-INSTYPES-LL
                       ADD 3 TO SUB
                       PERFORM SET-INSURANCE-TERM-VDU
                       MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                       PERFORM SCREENIO.

           IF I-LEVEL = 2
              IF LN-INSCOMP(2) NOT = 0
                 IF LN-INSTYPES-AH
                    MOVE "SN N030282." TO VDU
                    MOVE 5 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO.

           IF I-LEVEL = 3
              IF LN-INSCOMP(3) NOT = 0
                 MOVE "SN N030292." TO VDU
                 IF LN-INSTYPES-PP
                    MOVE 6 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO
                 ELSE
                    IF LN-INSTYPES-PP2
                       MOVE 7 TO SUB
                       PERFORM SET-INSURANCE-TERM-VDU
                       MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                       PERFORM SCREENIO.

           IF I-LEVEL = 4
              IF LN-INSCOMP(4) NOT = 0
                 IF LN-INSTYPES-O1
                    MOVE "SN N030302." TO VDU
                    MOVE 8 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO.

           IF I-LEVEL = 5
              IF LN-INSCOMP(5) NOT = 0
                 IF GP-OT-INS-TERM = "Y"
                    MOVE "SNNN060312." TO VDU
                    MOVE 9 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO
                 ELSE
                    MOVE LN-INTDATE TO NDTE-DATE
                    MOVE LN-ORGTERM TO NDTE-HOLD
                    MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
                    MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
                    PERFORM INCREMENT-UNITPER
                    MOVE "SNNN060312." TO VDU
                    MOVE NDTE-DATE TO DATE-YYYYMMDD LN-INSEXP-DATE(5)
                    PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
                    MOVE DATE-MMDDYY TO VDUNUM0
                    PERFORM SCREENIO.

           IF I-LEVEL = 6
              IF LN-INSCOMP(6) NOT = 0
                 IF GP-OT-INS-TERM = "Y"
                    MOVE "SNNN060322." TO VDU
                    MOVE 10 TO SUB
                    PERFORM SET-INSURANCE-TERM-VDU
                    MOVE VDUNUM0 TO LN-INSTRM(I-LEVEL)
                    PERFORM SCREENIO
                 ELSE
                    MOVE LN-INTDATE TO NDTE-DATE
                    MOVE LN-ORGTERM TO NDTE-HOLD
                    MOVE LN-UNITPER-CD TO DATER-UNITPER-CD
                    MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ
                    PERFORM INCREMENT-UNITPER
                    MOVE "SNNN060322." TO VDU
                    MOVE NDTE-DATE TO DATE-YYYYMMDD LN-INSEXP-DATE(6)
                    PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
                    MOVE DATE-MMDDYY TO VDUNUM0
                    PERFORM SCREENIO.

      *********************************
       SET-INSURANCE-TERM-VDU SECTION.
      *********************************
           IF SP-INSURE-EXT-PERIOD(SUB)
              PERFORM EXTENSION-DAYS-CALCULATION
              IF EDAY-MONTHS > 0
                 COMPUTE VDUNUM0 = EDAY-MONTHS + LN-ORGTERM
              ELSE
                 MOVE LN-ORGTERM TO VDUNUM0
           ELSE
              MOVE LN-ORGTERM TO VDUNUM0.

      *********************************
       COMPUTE-PAYMENTS SECTION.
      *********************************
           IF REGPY-FG NOT = " "
              GO TO COMPUTE-PAYMENTS-EXIT.

           MOVE 0 TO LN-NOREGPY
                     LN-REGPYAMT
                     LN-LASTPYAMT.
           IF LN-LOANTYPE = "I"
              COMPUTE REGPY-WK = LN-LNAMT + LN-INTCHG
           ELSE
              COMPUTE REGPY-WK = LN-LNAMT - LN-EXTCHG
                                  - (LN-MAINTFEE * LN-ORGTERM).

           IF SP-IRREGULAR-PAY-FG = "L"
              PERFORM COMPUTE-PAYMENTS-ODD-LAST
           ELSE
              PERFORM COMPUTE-PAYMENTS-ODD-FIRST.

       COMPUTE-PAYMENTS-EXIT.
           MOVE LN-REGPYAMT TO LN-SUM-REGPYAMT.

      ****************************************
       COMPUTE-PAYMENTS-ODD-FIRST SECTION.
      ****************************************
           DIVIDE REGPY-WK BY LN-ORGTERM GIVING REGPY-WK
                                            REMAINDER ODDPY-WK.

           ADD REGPY-WK ODDPY-WK LN-EXTCHG LN-MAINTFEE
                                         GIVING LN-1STPYAMT.
           ADD LN-MAINTFEE TO REGPY-WK.
           IF LN-ORGTERM = 1
              MOVE REGPY-WK TO LN-REGPYAMT
           ELSE
              MOVE REGPY-WK TO LN-REGPYAMT
                             LN-LASTPYAMT
              IF LN-ORGTERM > 2
                 SUBTRACT 2 FROM LN-ORGTERM GIVING LN-NOREGPY.

      ****************************************
       COMPUTE-PAYMENTS-ODD-LAST SECTION.
      ****************************************
           DIVIDE REGPY-WK BY LN-ORGTERM
                            GIVING REGPY-TEMP-WK
                                     REMAINDER ODDPY-WK.
           IF ODDPY-WK = 0
              MOVE REGPY-TEMP-WK TO REGPY-WK
           ELSE
              COMPUTE ODDPY-WK = REGPY-WK
                  - ((REGPY-TEMP-WK + .01) * LN-ORGTERM)
              ADD 0.01 REGPY-TEMP-WK GIVING REGPY-WK.

           ADD REGPY-WK LN-EXTCHG LN-MAINTFEE
                                     GIVING LN-1STPYAMT.
           ADD LN-MAINTFEE TO REGPY-WK.
           IF LN-ORGTERM = 1
              ADD ODDPY-WK TO LN-1STPYAMT
              MOVE REGPY-WK TO LN-REGPYAMT
           ELSE
              MOVE REGPY-WK TO LN-REGPYAMT
                               LN-LASTPYAMT
              ADD ODDPY-WK TO LN-LASTPYAMT
              IF LN-ORGTERM > 2
                 SUBTRACT 2 FROM LN-ORGTERM GIVING LN-NOREGPY.


      *********************************
       DEFAULT-APR SECTION.
      *********************************
      * DEFAULT EXCEPT WHEN MANUAL OVERRIDE OCCURS:
           IF DEFAULT-APR-FG = "N"
              GO TO DEFAULT-APR-EXIT.
           MOVE "N" TO DEFAULT-APR-FG.
           PERFORM COMPUTE-MEMO-OURS-NOTOURS.

           COMPUTE APR-FINANCED = LN-SELLPR + NON-MEMO-CHGS.
           IF BR-DOWNPY-FLAG NOT = "Y"
              SUBTRACT LN-DOWNPY LN-TRADEIN FROM APR-FINANCED.

           MOVE LN-ORGTERM TO APR-ORGTERM.
           MOVE LN-1STPYAMT TO APR-1STPYAMT.
           MOVE LN-REGPYAMT TO APR-REGPYAMT.
           MOVE LN-LASTPYAMT TO APR-LASTPYAMT.
           MOVE LN-INTDATE TO APR-INTDATE.
           MOVE LN-1STPYDATE TO APR-1STPYDATE.
           MOVE LN-UNITPER-CD TO APR-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO APR-UNITPER-FREQ.
           MOVE SP-DISFRMLA TO APR-DISFRMLA.
           PERFORM APR-REGZ.
           MOVE "SN N033200." TO VDU.
           MOVE APR-APR TO VDUNUM3
                           LN-APRATE.
           PERFORM SCREENIO.

       DEFAULT-APR-EXIT.
           EXIT.

      *********************************
       TEST-PAY SECTION.
      *********************************
           MOVE " " TO TEST-PAY-FG.
           IF LN-ORGTERM = 1
              IF LN-LASTPYAMT NOT = 0
                 MOVE "E" TO TEST-PAY-FG
                 MOVE "LAST PAYMENT MUST BE ZERO" TO MESS
                 PERFORM SEND-MESS.
           IF LN-ORGTERM > 1
              IF NOT (LN-1STPYAMT > 0
                          AND LN-REGPYAMT > 0
                            AND LN-LASTPYAMT > 0
                     )
                 MOVE "E" TO TEST-PAY-FG
                 MOVE "FIRST, REGULAR OR LAST PAYMENT CAN'T BE ZERO"
                                                               TO MESS
                 PERFORM SEND-MESS.

           SUBTRACT 1 FROM LN-ORGTERM GIVING LN-NOREGPY.
           IF LN-LASTPYAMT NOT = 0
              SUBTRACT 1 FROM LN-NOREGPY.

           PERFORM LOAN-CALCULATIONS.
           IF HOLD-TOTAL-REPAY NOT = TOTAL-REPAY
              MOVE "E" TO TEST-PAY-FG
              MOVE "PAYMENTS DO NOT NET TO LOAN AMOUNTS" TO MESS
              PERFORM SEND-MESS.

       TEST-PAY-EXIT.
           EXIT.

      ***********************************
       COMPUTE-FINANCE-CHARGE SECTION.
      ***********************************
           MOVE LN-INTCHG TO LN-FINCHG.
           IF SP-FINCHG = 1
              COMPUTE LN-FINCHG = LN-INTCHG + LN-EXTCHG
           ELSE IF SP-FINCHG = 2
              COMPUTE LN-FINCHG = LN-INTCHG + LN-SERCHG
           ELSE IF SP-FINCHG = 3
              COMPUTE LN-FINCHG = LN-INTCHG +
                                  (LN-MAINTFEE * LN-ORGTERM)
           ELSE IF SP-FINCHG = 4
              COMPUTE LN-FINCHG = LN-INTCHG + LN-EXTCHG
                                + LN-SERCHG
           ELSE IF SP-FINCHG = 5
              COMPUTE LN-FINCHG = LN-INTCHG + LN-EXTCHG
                                + (LN-MAINTFEE * LN-ORGTERM)
           ELSE IF SP-FINCHG = 6
              COMPUTE LN-FINCHG = LN-INTCHG + LN-EXTCHG
                          + LN-SERCHG
                          + (LN-MAINTFEE * LN-ORGTERM)
           ELSE IF SP-FINCHG = 7
              COMPUTE LN-FINCHG = LN-INTCHG
                                + LN-SERCHG
                         + (LN-MAINTFEE * LN-ORGTERM)
           ELSE IF SP-FINCHG = 8
              COMPUTE LN-FINCHG = LN-SERCHG +
                      (LN-MAINTFEE * LN-ORGTERM).
      *CS  03/26/01
            ADD TOTAL-FEEFINCHG TOTAL-INSFINCHG TO LN-FINCHG.

           MOVE LN-FINCHG TO LN-SUM-FINCHG.

      *********************************
       CALCULATE-APR SECTION.
      *********************************

      * CALCULATE EXCEPT WHEN MANUAL OVERRIDE OCCURS:

           IF CALCULATE-APR-FG = "N"
              GO TO CALCULATE-APR-EXIT.

           PERFORM COMPUTE-MEMO-OURS-NOTOURS.

           COMPUTE APR-FINANCED =
                 LN-SELLPR + NON-MEMO-CHGS
                    + LN-PRBAL + LN-PRINTDUE
                     - LN-PRFINCHGRB - LN-PRINSRB.
           IF BR-DOWNPY-FLAG NOT = "Y"
              SUBTRACT LN-DOWNPY LN-TRADEIN FROM APR-FINANCED.
           PERFORM LOAN-CALCULATIONS.
           SUBTRACT TOTAL-INSFINCHG TOTAL-FEEFINCHG
                                            FROM APR-FINANCED.

      * JTG 032296
      * ADDED 'IF' TO STOP LOANS WITH ZERO FINANCE CHARGES,
      * ODD FIRST OR LAST PAYMENTS AND DISCLOSURE FORMULA 'B'
      * FROM RETURNING .0XX APRS:
           IF APR-FINANCED = (LN-1STPYAMT
                                  + (LN-NOREGPY * LN-REGPYAMT)
                                   + LN-LASTPYAMT
                             )
              MOVE 0 TO APR-APR
           ELSE
              MOVE LN-ORGTERM TO APR-ORGTERM
              MOVE LN-1STPYAMT TO APR-1STPYAMT
              MOVE LN-REGPYAMT TO APR-REGPYAMT
              MOVE LN-LASTPYAMT TO APR-LASTPYAMT
              MOVE LN-INTDATE TO APR-INTDATE
              MOVE LN-1STPYDATE TO APR-1STPYDATE
              MOVE LN-UNITPER-CD TO APR-UNITPER-CD
              MOVE LN-UNITPER-FREQ TO APR-UNITPER-FREQ
              MOVE SP-DISFRMLA TO APR-DISFRMLA
              PERFORM APR-REGZ.

           COMPUTE VDUNUM2 ROUNDED = APR-APR.
           MOVE VDUNUM2 TO LN-APRATE.

           MOVE "SN N033200." TO VDU.
           MOVE LN-APRATE TO VDUNUM3.
           PERFORM SCREENIO.

       CALCULATE-APR-EXIT.
           EXIT.

      *********************************
       ENTER-LOAN-AMT SECTION.
      *********************************
       ENTER-LN-AMT.
           MOVE "ENNN062PRIN." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO EXIT-LOAN-AMT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-LN-AMT.
           MOVE VDUNUM2 TO LN-LNAMT LN-SUM-LNAMT.
           IF LN-SERVACCT = "Y" OR BR-DLRCHK = "N"
              MOVE 0 TO LN-PROCEEDS
              GO TO EXIT-LOAN-AMT.
       ENTER-DEALER-CHECK.
           MOVE "ENNS062DLCK." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              GO TO ENTER-LN-AMT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-DEALER-CHECK.
           MOVE VDUNUM2 TO LN-PROCEEDS.
           IF LN-PROCEEDS < 0
              GO TO ENTER-DEALER-CHECK.
       EXIT-LOAN-AMT.
           EXIT.

      ***********************************************
       VERIFY-MODULE SECTION.
      ***********************************************
           MOVE "Y" TO VALID-LOAN.

           MOVE TRANS-DATE TO VERIFY-TODAY-DATE.
           IF LN-SSNO(1) = 0
              MOVE 0 TO BW-BDATE BW-REFDATE
           ELSE
              IF LN-INSURED = "S"
                 IF LN-SSNO(2) NOT = BW-SSNO
                    MOVE LN-SSNO(2) TO BW-SSNO
                    PERFORM READ-BW1-FILE
                    IF IO-FG = 9
                       MOVE 0 TO BW-BDATE BW-REFDATE
                    END-IF
                 END-IF
              ELSE
                 IF LN-SSNO(1) NOT = BW-SSNO
                    MOVE LN-SSNO(1) TO BW-SSNO
                    PERFORM READ-BW1-FILE
                    IF IO-FG = 9
                       MOVE 0 TO BW-BDATE BW-REFDATE.

           MOVE BW-BDATE   TO VERIFY-AGE.
           MOVE BW-REFDATE TO VERIFY-REFDATE.

      * VERIFY-TERMCEIL IS A COPY MEMBER AND SETS VALID-LOAN TO 'Y'
      * THEREFORE; MUST BE FIRST VALIDATION
           MOVE LN-APRATE TO VERIFY-TERMCEIL-APR.
           MOVE 0         TO VERIFY-TERMCEIL-EFF.
           MOVE "N"       TO VERIFY-TERMCEIL-EFF-FG.
           MOVE " "       TO VERIFY-REJECT-TERM-FG.
           PERFORM VERIFY-TERMCEIL.

           PERFORM VERIFY-LOAN-AMOUNT.
           IF BR-DLRCHK NOT = "N"
              PERFORM VERIFY-DEALER-CHECK.

           PERFORM VERIFY-DATES.
           PERFORM VERIFY-PAYMENTS.
           PERFORM VERIFY-DEALER-RECOURSE.
           PERFORM VERIFY-INSURANCE.
           PERFORM VERIFY-ANTICIPATED.

      ***********************************************
       VERIFY-LOAN-AMOUNT SECTION.
      ***********************************************
           PERFORM COMPUTE-MEMO-OURS-NOTOURS.

           COMPUTE N-WK1 = LN-SELLPR + NON-MEMO-CHGS + LN-SERCHG.
           IF BR-DOWNPY-FLAG NOT = "Y"
              SUBTRACT LN-DOWNPY LN-TRADEIN FROM N-WK1.

           IF LN-LOANTYPE = "P"
              COMPUTE N-WK1 = N-WK1 + LN-EXTCHG + LN-INTCHG
                            + (LN-ORGTERM * LN-MAINTFEE).
           IF LN-LNAMT NOT = N-WK1
              MOVE "N" TO VALID-LOAN
              MOVE "LOAN AMOUNT INVALID" TO MESS
              PERFORM SEND-MESS.

      ***********************************************
       VERIFY-DEALER-CHECK SECTION.
      ***********************************************
           IF LN-SERVACCT = "Y" OR BR-DLRCHK = "N"
              MOVE 0 TO N-WK1
              GO TO VERIFY-PROC.

           COMPUTE N-WK1 =
              LN-LNAMT -  LN-DLRVPRIN(1) - LN-DLRVPRIN(2)
                       -  LN-DLRVPRIN(3)
                       - (LN-ANTICERN(1) + LN-ANTICADJ(1))
                       -  LN-ANTICERN(2)
                       - (LN-ANTICERN(3) + LN-ANTICADJ(3))
                       -  LN-ANTICERN(5)
                       -  OUR-CHGS.

           IF NOT (GP-INCL-OTH-IN-EARNED-N OR GP-INCL-OTH-IN-EARNED-R)
              SUBTRACT LN-ANTICERN(6) FROM N-WK1.

           IF NOT (GP-INCL-OTH-IN-EARNED-R)
              SUBTRACT LN-ANTICERN(4) FROM N-WK1
              ADD LN-ANTICADJ(4)     TO N-WK1.

      *JTG.AC
           IF LN-LOANTYPE = "P"
              IF DL-RVCHGS-CODE(1) = " "
                 SUBTRACT LN-DLRVCHGS(1) FROM N-WK1
              END-IF
              IF DL-RVCHGS-CODE(2) = " "
                 SUBTRACT LN-DLRVCHGS(2) FROM N-WK1
              END-IF
              IF DL-RVCHGS-CODE(3) = " "
                 SUBTRACT LN-DLRVCHGS(3) FROM N-WK1
              END-IF
              IF DL-PARVHELD-CODE = "B"
                 SUBTRACT LN-DLPARVHELD FROM N-WK1
              END-IF
              IF DL-PARVPAID-CODE = "A" OR "C"
                 ADD LN-DLPARVPAID TO N-WK1.
      *JTG.AC

           IF LN-LOANTYPE = "I"
              IF DL-PARVPAID-CODE-IB = " " OR "C"
                 ADD LN-DLPARVPAID TO N-WK1.

       VERIFY-PROC.
           IF LN-PROCEEDS < 0
              MOVE "DEALER CHECK IS NEGATIVE" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.
           IF N-WK1 NOT = LN-PROCEEDS
              MOVE N-WK1 TO DISPLAY-NUM-WK
              STRING "DEALER CHECK AMOUNT SHOULD BE: "
                     DISPLAY-NUM-WK DELIMITED BY "       "
                      INTO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

      *********************************************
       VERIFY-DATES SECTION.
      *********************************************
           IF LN-INTDATE < LN-LOANDATE
              MOVE "INTEREST DATE CAN'T BE PRIOR TO LOAN DATE"
                                                           TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

       VERIFY-1STPY-DATE.
           IF LN-1STPYDATE < LN-INTDATE
              MOVE "1ST PMT DATE CAN'T BE PRIOR TO INTEREST DATE"
                                                            TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

       VERIFY-CASH-DATE.
           IF LN-CASHDATE NOT = 0
              IF LN-CASHDATE < LN-LOANDATE
                 MOVE "CASH DATE CAN'T BE PRIOR TO LOAN-DATE" TO MESS
                 PERFORM SEND-MESS
                 MOVE "N" TO VALID-LOAN.

       VERIFY-PUR-DATE.
           IF LN-PURDATE NOT = 0
              IF LN-PURDATE < LN-LOANDATE
                 MOVE "PURCHASE DATE CAN'T BE < LOAN DATE" TO MESS
                 PERFORM SEND-MESS
                 MOVE "N" TO VALID-LOAN.

       VERIFY-DATES-EXIT.
           EXIT.

      *********************************************
        VERIFY-PAYMENTS SECTION.
      *********************************************
           COMPUTE N-WK1 =
                     LN-1STPYAMT
                         + (LN-NOREGPY * LN-REGPYAMT)
                                 + LN-LASTPYAMT.
           IF LN-LOANTYPE = "I"
              COMPUTE N-WK1 = N-WK1 - LN-INTCHG - LN-EXTCHG
                              - (LN-ORGTERM * LN-MAINTFEE).
           IF N-WK1 NOT = LN-LNAMT
              MOVE "PAYMENTS DO NOT EQUAL LOAN AMOUNT" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

           MOVE LN-SELLPR TO N-WK1.
           IF BR-DOWNPY-FLAG NOT = "Y"
              SUBTRACT LN-DOWNPY LN-TRADEIN FROM N-WK1.

           IF BR-DOWNPY-FLAG NOT = "F"
              IF N-WK1 < 0
                 MOVE "AMOUNT FINANCED MAY NOT BE < 0" TO MESS
                 PERFORM SEND-MESS
                 MOVE "N" TO VALID-LOAN.

           IF LN-FINCHG < SP-MINSF-CHG
              MOVE "FINANCE CHARGE BELOW MINIMUM" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

      * THIS NEEDS MORE WORK:
           ADD LN-SERCHG TO N-WK1.
           IF LN-LOANTYPE = "P"
              COMPUTE N-WK1 = N-WK1 + LN-EXTCHG + LN-INTCHG +
                              (LN-ORGTERM * LN-MAINTFEE).
           COMPUTE N-WK1 = N-WK1 - LN-DLRVPRIN(1) - LN-DLRVPRIN(2)
                                 - LN-DLRVPRIN(3).
           COMPUTE N-WK1 = N-WK1 - LN-ANTICERN(1) - LN-ANTICERN(2)
                                 - LN-ANTICERN(3) - LN-ANTICERN(4)
                                 - LN-ANTICERN(5) - LN-ANTICERN(6).
           IF N-WK1 < 0
              MOVE "CHECK TO DEALER MAY NOT BE < 0" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.
       EXIT-VERIFY-PAYMENTS.
           EXIT.

      *********************************************
       VERIFY-DEALER-RECOURSE SECTION.
      *********************************************
           IF LN-DLRECOURSE = "F"
              MOVE 1 TO SUB
              MOVE DL-FULLCEIL TO N-WK2.
           IF LN-DLRECOURSE = "P"
              MOVE 2 TO SUB
              MOVE DL-PARTCEIL TO N-WK2.
           IF LN-DLRECOURSE = "N"
              MOVE 3 TO SUB
              MOVE DL-NONCEIL TO N-WK2.

           MOVE TRANS-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-YYYYMM.
           MOVE DATE-YYYYMM TO DS-DATE-CCYYMM.
           MOVE LN-DLNO  TO DS-DLNO.
           MOVE LN-OWNBR TO DS-BRANCH.
           MOVE LN-CLASS TO DS-CLASS.
           PERFORM OPEN-DS1-FILE.
           PERFORM READ-DS1-FILE.
           PERFORM CLOSE-DS1-FILE.
           IF IO-FG = 9
              MOVE 0 TO DS-RCOURSE-AMT(SUB).
           IF LN-DLRECOURSE = "P"
              ADD LN-DLPARTRCAMT DS-RCOURSE-AMT(SUB) GIVING N-WK1
           ELSE
              ADD LN-LNAMT DS-RCOURSE-AMT(SUB) GIVING N-WK1.
           IF N-WK1 > N-WK2
              MOVE "DEALER RCOURSE CEILING EXCEEDED" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.
           IF LN-DLRECOURSE = "P"
              IF LN-DLPARTRCAMT > LN-LNAMT
                 MOVE "PARTIAL RECOURSE AMOUNT EXCEEDS LOAN AMOUNT"
                      TO MESS
                 PERFORM SEND-MESS
                 MOVE "N" TO VALID-LOAN.
       EXIT-VERIFY-DEALER-RECOURSE.
           EXIT.

      ****************************************
       VERIFY-INSURANCE SECTION.
      ****************************************
           IF LN-INSURED NOT = "N"
              GO TO VERIFY-INS-AH.

           MOVE 0 TO IO-FG.
           IF LN-INSCOMP(1) NOT = 0 OR LN-INSPREM(1) NOT = 0
              MOVE 9 TO IO-FG.
           IF LN-INSCOMP(2) NOT = 0 OR LN-INSPREM(2) NOT = 0
              MOVE 9 TO IO-FG.
           IF LN-INSCOMP(3) NOT = 0 OR LN-INSPREM(3) NOT = 0
              MOVE 9 TO IO-FG.
           IF LN-INSCOMP(4) NOT = 0 OR LN-INSPREM(4) NOT = 0
              MOVE 9 TO IO-FG.
           IF IO-FG = 9
              MOVE "INS CO/PREMIUM MUST BE 0 FOR INS CD 'N'" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.
           GO TO EXIT-VERIFY-INS.

       VERIFY-INS-AH.
           IF BR-AH-AND-CL = "Y"
              IF (LN-INSPREM(2) NOT = 0)
                         AND (LN-INSOURS(2) = "Y")
                 IF LN-INSPREM(1) = 0
                    MOVE "MUST WRITE CREDIT LIFE TO WRITE A&H"
                                                        TO MESS
                    PERFORM SEND-MESS
                    MOVE "N" TO VALID-LOAN.
       EXIT-VERIFY-INS.
           EXIT.

      *******************************************************
      *    VERIFY THAT RESERVE FROM CHARGES
      *       AND/OR PARTICIPATING RESERVES WILL NOT EXCEED
      *       INTEREST CHARGE
      *******************************************************
       VERIFY-ANTICIPATED SECTION.
           COMPUTE AMT-HOLDER =
              LN-DLRVCHGS(1) + LN-DLRVCHGS(2) + LN-DLRVCHGS(3)
                    + LN-DLPARVHELD + LN-DLPARVPAID.
           IF LN-INTCHG < AMT-HOLDER
              MOVE
           "PARTIC AND/OR RESERVE FROM CHGS EXCEEDS INTEREST CHARGE"
                                                        TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-LOAN.

      *********************************
       MEMO-ENTRY SECTION.
      *********************************
           PERFORM SEND-MEMO.
       ENTER-MEMO.
           MOVE "E  A300M2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS NOT = "00"
              GO TO ENTER-MEMO.
           MOVE VDUBUF TO LN-MESSAGE.
           IF LN-MESSAGE = " "
              MOVE "M1 M2." TO MESS
              PERFORM RESET-MESS.

      *********************************
       NEW-RECORD-SETUP SECTION.
      *********************************
           MOVE " " TO DEF-BUF.
           MOVE 1 TO NEW-FLAG.
           MOVE " " TO MEMO-WK.
           MOVE "S  A000SORTKEY." TO VDU.
           MOVE "* NEW *" TO VDUBUF.
           PERFORM SCREENIO.

           PERFORM CLEAR-LN-FILE.

           MOVE BR-STATE TO DEF-ORGST
                            LN-ORGST
                            LN-OWNST.

           MOVE BRANCH TO DEF-ORGBR
                          LN-ORGBR
                          LN-OWNBR.
           MOVE 999.99 TO LN-SERVPER.
           MOVE 999.999 TO LN-OVRDRATE
                           LN-ENDORATE.
           MOVE "M" TO DEF-UNITPER-CD
                       LN-UNITPER-CD.
           MOVE 1 TO DEF-UNITPER-FREQ
                     LN-UNITPER-FREQ.

           MOVE "SR" TO CD-TYPE.
           IF GP-THE-ONLY-SF-SRCD NOT = " "
              MOVE GP-THE-ONLY-SF-SRCD TO DEF-SRCD
                                          LN-SRCD
                                          CD-CODE
              MOVE "N" TO  CHFG(8)
           ELSE
              MOVE "NB" TO DEF-SRCD
                           LN-SRCD
                           CD-CODE
              MOVE " " TO CHFG(8).
           MOVE 8 TO ELE.
           PERFORM SEND-CD-DESC.

           MOVE DEF-BUF TO WR-BUF.
           MOVE DEF-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           MOVE "C" TO DLRVPRIN-FG(1)
                       DLRVPRIN-FG(2)
                       DLRVPRIN-FG(3)
                       DLRVCHGS-FG(1)
                       DLRVCHGS-FG(2)
                       DLRVCHGS-FG(3)
                       DLPARVHELD-FG
                       DLPARVPAID-FG
                       DLDISC-FG.

           IF GP-DLRVPRIN-1-FG NOT = "Y"
              MOVE "I" TO DLRVPRIN-FG(1).
           IF GP-DLRVPRIN-2-FG NOT = "Y"
              MOVE "I" TO DLRVPRIN-FG(2).
           IF GP-DLRVPRIN-3-FG NOT = "Y"
              MOVE "I" TO DLRVPRIN-FG(3).
           IF GP-DLRVCHGS-3-FG NOT = "Y"
              MOVE "I" TO DLRVCHGS-FG(3).

           MOVE "N" TO CHFG(20).
           MOVE "Y" TO CALCULATE-APR-FG.
           MOVE "N" TO STAT LN-DLRECOURSE.
      *--{CS}---
           IF BULK-CONVERSION-FG = "B"
              MOVE "B" TO LN-CONVERCD
           ELSE
              MOVE "Y" TO LN-CONVERCD.

           PERFORM PROTECT-UNPROTECT.
           IF GP-USE-CONRATE = "Y"
              MOVE " " TO CHFG(19).

           MOVE 0 TO ELE.

      ******************************************************************
       TEST-ALLOT-LBOX SECTION.
      ******************************************************************
           PERFORM ACCOUNT-LBOX.
           IF IO-TYPE = "RTN"
              GO TO TEST-ALLOT-LBOX-EXIT.
           IF LBOX-CODE NOT = "Y"
              PERFORM ACCOUNT-ALLOTMENTS.

       TEST-ALLOT-LBOX-EXIT.
           EXIT.

      ******************************************************************
       ACCOUNT-ALLOTMENTS SECTION.
      ******************************************************************
       ACCT-ALLOT.
           MOVE " " TO LN-ALLOTCD IO-TYPE ALLOT-BUF.
           IF BR-ALLOTMNTS NOT = "Y"
              GO TO ACCOUNT-ALLOT-EXIT.

           MOVE "^, ACCOUNT UNDER AN ALLOTMENT PLAN ?" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO ACCOUNT-ALLOT-EXIT.
           IF VDUSTATUS NOT = "00"
              GO TO ACCT-ALLOT.
           MOVE VDUBUF TO ALLOT-BUF.
           IF ALLOT-CODE = "Y"
              MOVE "Y" TO LN-ALLOTCD
           ELSE
              IF ALLOT-CODE NOT = "N"
                 GO TO ACCT-ALLOT.
           MOVE " " TO MESS.
           PERFORM SEND-LEGEND.
       ACCOUNT-ALLOT-EXIT.
           EXIT.

      ******************************************************************
       ACCOUNT-LBOX SECTION.
      ******************************************************************
       ACCT-LBOX.
           MOVE " " TO LN-LBOX IO-TYPE LBOX-BUF.
           IF BR-LBOX NOT = "Y"
              GO TO ACCOUNT-LBOX-EXIT.
           MOVE "^, ACCOUNT UNDER A LOCK BOX PLAN ?" TO LEGEND.
           PERFORM SEND-LEGEND.
           MOVE "R RA060SEL." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "1U"
              MOVE "RTN" TO IO-TYPE
              GO TO ACCOUNT-LBOX-EXIT.
           IF VDUSTATUS NOT = "00"
              GO TO ACCT-LBOX.
           MOVE VDUBUF TO LBOX-BUF.
           IF LBOX-CODE = "Y"
              MOVE "Y" TO LN-LBOX
           ELSE
              IF LBOX-CODE NOT = "N"
                 GO TO ACCT-LBOX.
           MOVE " " TO MESS.
           PERFORM SEND-LEGEND.
       ACCOUNT-LBOX-EXIT.
           EXIT.

      *******************************
       WRITE-MODULE SECTION.
      *******************************
           PERFORM OPEN-LN1-FILE.
           IF NEW-FLAG NOT = 0
              GO TO WRITE-RECORD.

           MOVE LN-REC TO CHANGED-LN-REC.
           IF ORIGINAL-LN-REC = CHANGED-LN-REC
              PERFORM UPDATE-LT
              GO TO END-WRITE-MODULE.
           PERFORM UPDATE-MSG.
           PERFORM READ-LN1-FILE.
           IF IO-FG NOT = 0
              PERFORM UNDERGONE-CHANGE
              PERFORM RECORD-DELETED
              GO TO END-WRITE-MODULE.
           IF LN-REC NOT = ORIGINAL-LN-REC
              PERFORM UNDERGONE-CHANGE
              PERFORM CHANGE-AGAIN
              GO TO END-WRITE-MODULE.
           MOVE CHANGED-LN-REC TO LN-REC.

      * GET IB EARNINGS FIELDS SP-ERNFRMLA = 15:
           IF SP-ERNFRMLA(1) = 15
              SUBTRACT LN-DLDISC FROM LN-LNAMT GIVING LN-ERN-IB-PRINBAL
              IF LN-LOANTYPE = "P"
                 SUBTRACT LN-INTCHG LN-EXTCHG FROM LN-ERN-IB-PRINBAL.

      * GET IB EARNINGS FIELDS SP-ERNFRMLA = 16:
           IF SP-ERNFRMLA(5) = 16
              MOVE LN-LNAMT TO LN-ERN-IB-PRINBAL
              IF LN-LOANTYPE = "P"
                 SUBTRACT LN-INTCHG LN-EXTCHG FROM LN-ERN-IB-PRINBAL.

           PERFORM UPDATE-LN1-INSURANCE.
           PERFORM REWRITE-LN1-FILE.
           PERFORM UPDATE-LT.

           GO TO END-WRITE-MODULE.

       WRITE-RECORD.
           PERFORM UPDATE-MSG.
           MOVE TRANS-DATE TO LN-ENTDATE.
           IF BR-CONVERT-AUTO-ACCTNO = "Y"
              IF ACCTNO-WAS-SET-FG = "Y"
                 PERFORM SET-ACCOUNT-NUMBER.

           PERFORM UPDATE-LN1-INSURANCE.

           PERFORM APRS-RATE.
           MOVE APRS-SMPRATE TO LN-SMPRATE.
           MOVE APRS-EFFRATE TO LN-EFFRATE.
           IF SP-CAL-SET-EFFECTIVE(APRS-CTBL)
              MOVE LN-EFFRATE TO LN-OVRDRATE.
      *  JTG 010112 ADDED NEW 88  SP-CAL-SET-SMPRATE-OVRRIDE VALUE 4 MERC PR#J0
           IF SP-CAL-SET-SMPRATE-OVRRIDE(APRS-CTBL)
              MOVE LN-SMPRATE TO LN-OVRDRATE.

           IF BR-AVAIL-CREDIT = "Y" OR "S"
              IF LC-CALC-HI-CREDIT NOT = "I"
                 PERFORM LOAN-CALCULATIONS
                 MOVE HIGH-CREDIT TO LN-CREDITLIM.

           PERFORM WRITE-LN1-FILE.
           IF IO-FG = 9
              PERFORM ALREADY-CREATED
           ELSE
              PERFORM UPDATE-LT.
       END-WRITE-MODULE.
           PERFORM CLOSE-LN1-FILE.

      ************************
       UPDATE-LT SECTION.
      ************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           IF IO-FG = 9 OR WK-SAVE-RECORD = " "
              GO TO EXIT-UPDATE-LT.

           PERFORM CLEAR-LTC-FILE.
           PERFORM OPEN-LTC1-FILE.

           IF WK-DESC-1 NOT = SPACES OR WK-DESC-2 NOT = SPACES OR
               WK-HHGS-1 NOT = SPACES OR WK-HHGS-2 NOT = SPACES OR
                WK-HHGS-3 NOT = SPACES
              MOVE LN-OWNBR  TO LTC-BRNO
              MOVE LN-ACCTNO TO LTC-ACCTNO
              MOVE 1         TO LTC-SEQNO

              MOVE WK-DESC-1  TO LTC-DESC(1)
              MOVE WK-MAKE-1  TO LTC-MAKE(1)
              MOVE WK-MODEL-1 TO LTC-MODEL(1)
              MOVE WK-YEAR-1  TO LTC-YEAR(1)
              MOVE WK-STYLE-1 TO LTC-STYLE(1)
              MOVE WK-CLASS-1 TO LTC-CLASS(1)
              MOVE WK-VIN-1   TO LTC-VIN(1)
              MOVE WK-TITLE-NO-1 TO LTC-TITLE-NO(1)
              MOVE WK-MILEAGE-1  TO LTC-MILEAGE(1)
              MOVE WK-VALUE-1    TO LTC-VALUE(1)
              MOVE WK-SELLPR-1   TO LTC-SELLPR(1)
              MOVE WK-MISC-AMT-1 TO LTC-MISC-AMT(1)
              MOVE 0             TO LTC-VIN-CHG-DATE(1)

              MOVE WK-DESC-2  TO LTC-DESC(2)
              MOVE WK-MAKE-2  TO LTC-MAKE(2)
              MOVE WK-MODEL-2 TO LTC-MODEL(2)
              MOVE WK-YEAR-2  TO LTC-YEAR(2)
              MOVE WK-STYLE-2 TO LTC-STYLE(2)
              MOVE WK-CLASS-2 TO LTC-CLASS(2)
              MOVE WK-VIN-2   TO LTC-VIN(2)
              MOVE WK-TITLE-NO-2 TO LTC-TITLE-NO(2)
              MOVE WK-MILEAGE-2  TO LTC-MILEAGE(2)
              MOVE WK-VALUE-2    TO LTC-VALUE(2)
              MOVE WK-SELLPR-2   TO LTC-SELLPR(2)
              MOVE WK-MISC-AMT-2 TO LTC-MISC-AMT(2)
              MOVE 0             TO LTC-VIN-CHG-DATE(2)

              MOVE WK-HHGS-1 TO LTC-HHGS(1)
              MOVE WK-HHGS-2 TO LTC-HHGS(2)
              MOVE WK-HHGS-3 TO LTC-HHGS(3)
              PERFORM WRITE-LTC1-FILE
              IF IO-FG NOT = 0
                 PERFORM REWRITE-LTC1-FILE.


           PERFORM CLOSE-LTC1-FILE.
       EXIT-UPDATE-LT.
           EXIT.

      *******************************
       DELETE-MODULE SECTION.
      *******************************
           IF NEW-FLAG NOT = 0
              MOVE "ONLY DELETE AN EXISTING LOAN" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-DELETE
              GO TO END-DELETE-MODULE.

           MOVE "VERIFICATION OF DELETE IN PROGRESS....." TO LEGEND.
           PERFORM SEND-LEGEND.
           PERFORM OPEN-LP1-FILE.
           PERFORM OPEN-LN1-FILE.
           PERFORM READ-LN1-FILE.
           IF IO-FG NOT = 0
              PERFORM UNDERGONE-CHANGE
              PERFORM RECORD-DELETED
              MOVE "N" TO VALID-DELETE
              GO TO END-DELETE-MODULE.
           IF LN-REC NOT = ORIGINAL-LN-REC
              PERFORM UNDERGONE-CHANGE
              PERFORM RECORD-CHANGED
              MOVE "N" TO VALID-DELETE
              GO TO END-DELETE-MODULE.

           MOVE LN-OWNBR      TO LP-BRNO
                                 QLP1-WBEG-BRNO
                                 QLP1-WEND-BRNO.
           MOVE LN-ACCTNO     TO LP-ACCTNO
                                 QLP1-WBEG-ACCTNO
                                 QLP1-WEND-ACCTNO.
           MOVE 0             TO LP-SEQNO
                                 QLP1-WBEG-SEQNO.
           MOVE ALL "9"       TO QLP1-WEND-SEQNO.

           PERFORM START-LP1-FILE.
           PERFORM READ-LP1-FILE-NEXT.
           IF IO-FG = 9
              GO TO CONTINUE-DELETE.

           IF (LP-BRNO = LN-OWNBR) AND (LP-ACCTNO = LN-ACCTNO)
              MOVE "ACCOUNT HAS PAYMENT RECORD - CANT DELETE" TO MESS
              PERFORM SEND-MESS
              MOVE "N" TO VALID-DELETE
              GO TO END-DELETE-MODULE.

       CONTINUE-DELETE.
           MOVE "DELETING LOAN MASTER.............." TO LEGEND.
           PERFORM SEND-LEGEND.
           PERFORM DELETE-LN1-FILE.

       END-DELETE-MODULE.
           PERFORM CLOSE-LN1-FILE.
           PERFORM CLOSE-LP1-FILE.

      ***************************************************
       UPDATE-LN1-INSURANCE SECTION.
      ***************************************************
           PERFORM VARYING IEXP-LN FROM 1 BY 1 UNTIL IEXP-LN > 8
              PERFORM IEXP-INS-CALCULATIONS
              MOVE IEXP-EFFDATE TO LN-INSEFF-DATE(IEXP-LN)
              MOVE IEXP-EXPDATE TO LN-INSEXP-DATE(IEXP-LN)
              IF NOT ( IEXP-LN = 6
                         AND (
                               (BR-SFDLO3-WINDOW-FG = "Y"
                                     AND LN-INSOURS(IEXP-LN) = "Y")
                                  OR
                                    (BR-SFDLO3-WINDOW-FG = "B")
                             )
                     )
                 MOVE IEXP-INSCOMM TO LN-INSCOMM(IEXP-LN)
              END-IF

      *- WHEN FLAT RATE APPLIED TO COMMISSION & BR-SFDLO3-WINDOW-FG IS 'N'
      *  WE WERE COMPUTING A COMMISSION, SET ALL FIELDS BACK
              IF LN-INSPREM(IEXP-LN) = ZEROS
                 MOVE ZEROS TO LN-INSCOMP(IEXP-LN)
                               LN-INSEFF-DATE(IEXP-LN)
                               LN-INSEXP-DATE(IEXP-LN)
                               LN-INSCOVR(IEXP-LN)
                               LN-INSPREM(IEXP-LN)
                               LN-INSCOMM(IEXP-LN)
                 MOVE SPACES TO LN-INSOURS(IEXP-LN)
              END-IF
           END-PERFORM.


      ***************************************
       DISPLAY-FIELDS SECTION.
      ***************************************
           MOVE " " TO DISPLAY-BUF1.
           PERFORM GET-SP.
           MOVE "Y" TO VALID-LOAN.

           MOVE "C" TO REGPY-FG.
           PERFORM COMPUTE-PRINCIPLE.

           MOVE "NVLD" TO LAST-READ.
           MOVE LN-ACCTNO TO D-LNNO.
           IF LN-PLCD = "P"
              MOVE "P" TO D-P.
           IF LN-JDDATE NOT = 0
              MOVE "J" TO D-J.
           MOVE LN-CLASS TO LC-CODE D-LCNO.
           PERFORM GET-LC.
           MOVE LC-DESC TO D-LC-DESC.
           MOVE LN-LNAMT TO D-LNAMT.
           MOVE LN-PROCEEDS TO D-PROCEEDS.

           IF GP-INCL-OTH-IN-EARNED-N
              COMPUTE D-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3) + LN-ANTICERN(4)
                              + LN-ANTICERN(5)
           ELSE
           IF GP-INCL-OTH-IN-EARNED-R
              COMPUTE D-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3) + LN-ANTICERN(5)
           ELSE

              COMPUTE D-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3) + LN-ANTICERN(4)
                              + LN-ANTICERN(5) + LN-ANTICERN(6).

           MOVE 1 TO SUB.
       DISP-NEXT-BW.
           MOVE LN-SSNO(SUB) TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE " " TO BW-LNAME BW-FNAME.
           IF NUM-BW NOT = 0
              MOVE NUM-BW TO BW-SSNO
              PERFORM GET-BW1
              MOVE ALP-BW TO D-010(SUB)
              MOVE INSPECT-W TO D-011(SUB)
              MOVE LN-MAKERCD(SUB) TO D-012(SUB).
           IF SUB < 4
              ADD 1 TO SUB
              GO TO DISP-NEXT-BW.

           MOVE LN-ORGST TO D-050.
           MOVE LN-ORGBR TO D-051.
           MOVE LN-SUBCLASS TO D-052.
           MOVE SP-DESC TO D-053.
           MOVE LN-LOANDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-060.

           MOVE "PU"     TO CD-TYPE.
           MOVE LN-PURCD TO CD-CODE D-070.
           PERFORM GET-CD.
           MOVE CD-DESC  TO D-071.

           MOVE "SR"    TO CD-TYPE.
           MOVE LN-SRCD TO CD-CODE D-080.
           PERFORM GET-CD.
           MOVE CD-DESC TO D-081.

           MOVE "CO"      TO CD-TYPE.
           MOVE LN-COLLCD TO CD-CODE D-090.
           PERFORM GET-CD.
           MOVE CD-DESC   TO D-091.

           MOVE CD-CO-SECURED TO SPTEST-CD-SECURED.
           MOVE LN-COLLID TO D-100.

           PERFORM GET-COLLATERAL.
           MOVE LTC-HHGS(1) TO COLLATERAL-BREAKOUT.
           MOVE COLLATERAL-30-1 TO D-110.
           MOVE COLLATERAL-30-2 TO D-111.


           MOVE DISPLAY-BUF1 TO WR-BUF.
           MOVE DISPLAY-LIST1 TO WR-LIST.
           PERFORM CALL-WRFORM.

           MOVE " " TO DISPLAY-BUF2.
           IF BR-LC-CODE = "Y"
              MOVE LN-LC-CODE TO D-400.
           MOVE LN-DLNO TO D-120 DL-DLNO.
           PERFORM GET-DL1.
           MOVE DL-SHORT TO D-121.
           MOVE LN-DLRECOURSE TO D-130.
           PERFORM GET-RECOURSE-DESC.
           MOVE VDUBUF TO D-131.
           IF LN-DLRECOURSE = "P"
               MOVE LN-DLPARTRCAMT TO D-132.
           MOVE LN-UNITPER-CD TO D-140.
           MOVE LN-UNITPER-FREQ TO D-141.
           MOVE LN-ORGTERM TO D-150.
           MOVE LN-INTDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-160.
           MOVE LN-1STPYDATE  TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY   TO D-170.
           MOVE LN-CASHDATE   TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY   TO D-180.
           MOVE LN-CONRATE    TO D-190.
           MOVE LN-APRATE     TO D-200.
           MOVE LN-OVRDRATE   TO D-210.
           MOVE LN-ENDORATE   TO D-211.
           MOVE LN-SELLPR     TO D-220.
           MOVE LN-DOWNPY     TO D-230.
           MOVE LN-TRADEIN    TO D-231.
           MOVE LN-SERCHG     TO D-240.
           MULTIPLY LN-MAINTFEE BY LN-ORGTERM GIVING D-241.
           MOVE LN-INTCHG     TO D-250.
           MOVE LN-EXTCHG     TO D-251.
           MOVE LN-INSCODES   TO D-260.

           MOVE 1 TO SUB.
       DISP-NEXT-IC.
           MOVE LN-INSCOMP(SUB) TO D-1COMP(SUB).
           MOVE LN-INSPREM(SUB) TO D-1PREM(SUB).
           MOVE SUB TO ITRM-SUB.
           PERFORM INS-TERM-CALCULATION.
           MOVE ITRM-INSTERM TO D-1TERM(SUB)
                                LN-INSTRM(SUB).
           MOVE LN-INSCOVR(SUB) TO D-1COVR(SUB).
           MOVE LN-INSOURS(SUB) TO D-1IOURS(SUB).
           IF SUB < 4
              ADD 1 TO SUB
              GO TO DISP-NEXT-IC.

           MOVE 1 TO SUB.
           MOVE 5 TO ELE.
       DISP-NEXT-2IC.
           MOVE LN-INSCOMP(ELE) TO D-2COMP(SUB).
           MOVE LN-INSPREM(ELE) TO D-2PREM(SUB).
           IF GP-OT-INS-TERM = "Y"
              MOVE ELE TO ITRM-SUB
              PERFORM INS-TERM-CALCULATION
              MOVE ITRM-INSTERM TO D-2TERM(SUB)
                                   LN-INSTRM(ELE)
           ELSE
              MOVE LN-INSEXP-DATE(ELE) TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO D-2EXP(SUB).
           MOVE LN-INSCOVR(ELE) TO D-2COVR(SUB).
           MOVE LN-INSOURS(ELE) TO D-2IOURS(SUB).
           IF ELE < 6
              ADD 1 TO SUB ELE
              GO TO DISP-NEXT-2IC.

           PERFORM SETUP-FEES-FOR-DISPLAY.

           MOVE LN-1STPYAMT TO D-350.
           MOVE LN-REGPYAMT TO D-351.
           MOVE LN-LASTPYAMT TO D-360.
           MOVE LN-PURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO D-370.

           IF LN-DLRVPRIN(2) = 0
                   AND LN-DLRVPRIN(3) = 0
              MOVE LN-DLRVPRIN(1) TO D-380
           ELSE
              ADD LN-DLRVPRIN(1) LN-DLRVPRIN(2) LN-DLRVPRIN(3)
                                         GIVING D-380
              INSPECT D-380 REPLACING LEADING " " BY "*".

           IF LN-DLRVCHGS(2) = 0
                   AND LN-DLRVCHGS(3) = 0
              MOVE LN-DLRVCHGS(1) TO D-381
           ELSE
              ADD LN-DLRVCHGS(1) LN-DLRVCHGS(2) LN-DLRVCHGS(3)
                                         GIVING D-381
              INSPECT D-381 REPLACING LEADING " " BY "*".

           IF LN-DLPARVPAID = 0
              MOVE LN-DLPARVHELD TO D-390
           ELSE
              ADD LN-DLPARVHELD LN-DLPARVPAID GIVING D-390
              INSPECT D-390 REPLACING LEADING " " BY "*".

           MOVE LN-DLDISC TO D-391.
           MOVE DISPLAY-BUF2 TO WR-BUF.
           MOVE DISPLAY-LIST2 TO WR-LIST.
           PERFORM CALL-WRFORM.
           IF LN-MESSAGE NOT = " "
              PERFORM SEND-MEMO
              PERFORM ALARM.

           PERFORM CREATE-PC-A-RECORD.
           PERFORM SET-COLLATERAL-WORK.
           IF BR-AUTO-LNSTAT-WINDOW = "Y"
              PERFORM CALL-LNSTAT-WINDOW.

      ************************************
       SETUP-FEES-FOR-DISPLAY SECTION.
      ************************************
           MOVE 1 TO SUB2
                     SUB.
       DISPLAY-NEXT-FEE.
           MOVE LN-FEECODE(SUB) TO D-1FEECD(SUB2).
           MOVE LN-FEEAMT(SUB) TO D-1FEEAMT(SUB2).
           MOVE LN-FEEOURS(SUB) TO D-1FOURS(SUB2).
           ADD 1 TO SUB.
           MOVE LN-FEECODE(SUB) TO D-2FEECD(SUB2).
           MOVE LN-FEEAMT(SUB) TO D-2FEEAMT(SUB2).
           MOVE LN-FEEOURS(SUB) TO D-2FOURS(SUB2).
           IF SUB2 < 2
              ADD 1 TO SUB2
                       SUB
              GO TO DISPLAY-NEXT-FEE.
           IF LN-FEECODE(5) NOT = " "
              MOVE "->" TO D-2FEECD(2)
              ADD LN-FEEAMT(5) LN-FEEAMT(6) LN-FEEAMT(7)
                  LN-FEEAMT(8) LN-FEEAMT(9) LN-FEEAMT(10)
                         GIVING D-2FEEAMT(2).

      ****************************************************
       DELETE-NOTICE SECTION.
      ****************************************************
           MOVE "DELETING NOTICE.............." TO LEGEND.
           PERFORM SEND-LEGEND.

           PERFORM OPEN-NO1-FILE.
           MOVE LN-OWNBR  TO NO-BRNO.
           MOVE LN-ACCTNO TO NO-ACCTNO.
           PERFORM READ-NO1-FILE.
           IF IO-FG = 0
              PERFORM DELETE-NO1-FILE.

           PERFORM CLOSE-NO1-FILE.
       EXIT-DELETE-NOTICE.
           EXIT.

      ****************************************************
       DELETE-TRAILER-LT SECTION.
      ****************************************************
           MOVE "DELETING LOAN TRAILER.............." TO LEGEND.
           PERFORM SEND-LEGEND.

           PERFORM OPEN-LTC1-FILE.

           MOVE LTC-PATH-OWNBR  TO LTC-BRNO
                                   QLTC1-WBEG-BRNO
                                   QLTC1-WEND-BRNO.
           MOVE LN-ACCTNO       TO LTC-ACCTNO
                                   QLTC1-WBEG-ACCTNO
                                   QLTC1-WEND-ACCTNO.
           MOVE 1               TO LTC-SEQNO
                                   QLTC1-WBEG-SEQNO.
           MOVE ALL "9"         TO QLTC1-WEND-SEQNO.

           PERFORM START-LTC1-FILE.
       NEXT-LT-DELETE.
           PERFORM READ-LTC1-FILE-NEXT.
           IF IO-FG = 9 OR (LTC-BRNO NOT = LTC-PATH-OWNBR)
                         OR (LTC-ACCTNO NOT = LN-ACCTNO)
              GO TO EXIT-DELETE-TRAILER.

           PERFORM DELETE-LTC1-FILE.

           GO TO NEXT-LT-DELETE.
       EXIT-DELETE-TRAILER.
           PERFORM CLOSE-LTC1-FILE.

      *********************************************
       VALID-INS-TYPES-ELIG SECTION.
      *********************************************
           MOVE 0 TO IO-FG.
           IF LN-INSURED = "S" OR "J"
              IF LN-SSNO(2) = 0
                 MOVE 9 TO IO-FG
                 GO TO EXIT-VALID-INS-TYPES-ELIG.

      * READ CURRENT STATE PARAMATER RECORD INORDER
      * TO CHECK INSURANCE COMPANIES (SUBSCRIPTED) = 0.
           PERFORM GET-SP.

      * CHECK IF ADDITIONAL INSURANCES WERE PURCHASED
           IF BR-OTH-INS-LEVELS NOT = "Y"
              MOVE "N" TO CHFG(30) CHFG(31) CHFG(32).

           IF LN-INSURED = "N"
              IF LN-INSTYPES NOT = "N"
                 MOVE 9 TO IO-FG
                 GO TO EXIT-VALID-INS-TYPES-ELIG
              ELSE
                 MOVE "N" TO CHFG(27) CHFG(28) CHFG(29) CHFG(30)
                 GO TO EXIT-VALID-INS-TYPES-ELIG.

           MOVE "N" TO CHFG(27) CHFG(28) CHFG(29) CHFG(30).

           IF LN-INSTYPES-LL
              MOVE " " TO CHFG(27)
              PERFORM LEVEL-INSURANCE.
           IF LN-INSTYPES-DL
              MOVE " " TO CHFG(27)
              PERFORM DECREASING-INSURANCE.
           IF LN-INSTYPES-AH
              MOVE " " TO CHFG(28)
              PERFORM ACCIDENT-INSURANCE.
           IF LN-INSTYPES-PP OR LN-INSTYPES-PP2
              MOVE " " TO CHFG(29)
              PERFORM PROPERTY-INSURANCE.
           IF LN-INSTYPES-O1
              MOVE " " TO CHFG(30)
              PERFORM O1-INSURANCE.

       EXIT-VALID-INS-TYPES-ELIG.
           EXIT.

      ***************************************
       LEVEL-INSURANCE SECTION.
      ***************************************
           IF LN-INSURED = "J"
              IF SP-INSCOM(4) = 0
                 MOVE "N" TO CHFG(27)
                 MOVE 9 TO IO-FG
                 MOVE "JOINT LEVEL LIFE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  A020270." TO VDU
                 MOVE SP-INSCOM(4) TO VDUNUM0 LN-INSCOMP(1)
                 PERFORM SCREENIO
      *CS 03/26/01
                 MOVE SP-INSFINCHG(4) TO  LN-INSFINCHG(1)
           ELSE
              IF SP-INSCOM(3) = 0
                 MOVE "N" TO CHFG(27)
                 MOVE 9 TO IO-FG
                 MOVE "LEVEL LIFE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  A020270." TO VDU
                 MOVE SP-INSCOM(3) TO VDUNUM0 LN-INSCOMP(1)
                 PERFORM SCREENIO
                 MOVE SP-INSFINCHG(3) TO LN-INSFINCHG(1).

      *    IF BR-AH-AND-CL = "Y"
      *       IF LN-INSTYPES-AH
      *          IF NOT (LN-INSTYPES-DL OR LN-INSTYPES-LL)
      *             MOVE "N" TO CHFG(27) CHFG(28)
      *             MOVE 9 TO IO-FG
      *             MOVE "MUST HAVE LIFE AND A&H" TO MESS
      *             PERFORM SEND-MESS.

      ***************************************
       DECREASING-INSURANCE SECTION.
      ***************************************
           IF LN-INSURED = "J"
              IF SP-INSCOM(2) = 0
                 MOVE "N" TO CHFG(27)
                 MOVE 9 TO IO-FG
                 MOVE "JOINT DECLINING LIFE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  N020270." TO VDU
                 MOVE SP-INSCOM(2) TO VDUNUM0 LN-INSCOMP(1)
                 PERFORM SCREENIO
                 MOVE SP-INSFINCHG(2) TO LN-INSFINCHG(1)
           ELSE
              IF SP-INSCOM(1) = 0
                 MOVE "N" TO CHFG(27)
                 MOVE 9 TO IO-FG
                 MOVE "DECLINING LIFE NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  N020270." TO VDU
                 MOVE SP-INSCOM(1) TO VDUNUM0 LN-INSCOMP(1)
                 PERFORM SCREENIO
                 MOVE SP-INSFINCHG(1) TO LN-INSFINCHG(1).

      *    IF BR-AH-AND-CL = "Y"
      *       IF LN-INSTYPES-AH
      *          IF NOT(LN-INSTYPES-DL OR LN-INSTYPES-LL)
      *             MOVE "N" TO CHFG(27) CHFG(28)
      *             MOVE 9 TO IO-FG
      *             MOVE "MUST HAVE LIFE AND A&H" TO MESS
      *             PERFORM SEND-MESS.

      ********************************************
       ACCIDENT-INSURANCE SECTION.
      ********************************************
           IF SP-INSCOM(5) = 0
              MOVE "N" TO CHFG(28)
              MOVE 9 TO IO-FG
              MOVE "A & H NOT ALLOWED" TO MESS
              PERFORM SEND-MESS
           ELSE
              MOVE "S  N020280." TO VDU
              MOVE SP-INSCOM(5) TO VDUNUM0 LN-INSCOMP(2)
              PERFORM SCREENIO
              MOVE SP-INSFINCHG(5) TO LN-INSFINCHG(2).

      *    IF BR-AH-AND-CL = "Y"
      *       IF LN-INSTYPES-AH
      *          IF NOT(LN-INSTYPES-DL OR LN-INSTYPES-LL)
      *             MOVE "N" TO CHFG(27) CHFG(28)
      *             MOVE 9 TO IO-FG
      *             MOVE "MUST HAVE LIFE AND A&H" TO MESS
      *             PERFORM SEND-MESS.

      ********************************************
       PROPERTY-INSURANCE SECTION.
      ********************************************
           IF LN-INSTYPES-PP
              IF SP-INSCOM(6) = 0
                 MOVE "N" TO CHFG(29)
                 MOVE 9 TO IO-FG
                 MOVE "PROPERTY NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  N020290." TO VDU
                 MOVE SP-INSCOM(6) TO VDUNUM0 LN-INSCOMP(3)
                 PERFORM SCREENIO
      *CS  03/26/01
                 MOVE SP-INSFINCHG(6) TO LN-INSFINCHG(3)
           ELSE
              IF SP-INSCOM(7) = 0
                 MOVE "N" TO CHFG(29)
                 MOVE 9 TO IO-FG
                 MOVE "PROPERTY NOT ALLOWED" TO MESS
                 PERFORM SEND-MESS
              ELSE
                 MOVE "S  N020290." TO VDU
                 MOVE SP-INSCOM(7) TO VDUNUM0 LN-INSCOMP(3)
                 PERFORM SCREENIO
      *CS  03/26/01
                 MOVE SP-INSFINCHG(7) TO LN-INSFINCHG(3).

      ********************************************
       O1-INSURANCE SECTION.
      ********************************************
           IF SP-INSCOM(8) = 0
              MOVE "N" TO CHFG(30)
              MOVE 9 TO IO-FG
              MOVE "OTHER 1 INSURANCE NOT ALLOWED" TO MESS
              PERFORM SEND-MESS
           ELSE
              MOVE "S  N020300." TO VDU
              MOVE SP-INSCOM(8) TO VDUNUM0 LN-INSCOMP(4)
              PERFORM SCREENIO
              MOVE SP-INSFINCHG(8) TO LN-INSFINCHG(4).


      *********************************
       RESTORE-TRAILER-REC SECTION.
      *********************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           PERFORM CLOSE-WK-FILE.

      * INSPECT-X HOLDS FREE FROM BEFORE CALL
           IF INSPECT-X = WK-HHGS-1
              GO TO RESTORE-TRAILER-EXIT.

           MOVE "S  A300110." TO VDU.
           MOVE WK-HHGS-1 TO INSPECT-X.
           MOVE 1 TO IX1 IX2.
       RESTORE-FREE-1A.
           MOVE INSPECT-Z(IX1) TO VDUTAB(IX2).
           IF IX1 < 30
              ADD 1 TO IX1 IX2
              GO TO RESTORE-FREE-1A.
           PERFORM SCREENIO.
           MOVE "S  A330111." TO VDU.
           MOVE 31 TO IX1.
           MOVE 1 TO IX2.
       RESTORE-FREE-1B.
           MOVE INSPECT-Z(IX1) TO VDUTAB(IX2).
           IF IX1 < 63
              ADD 1 TO IX1 IX2
              GO TO RESTORE-FREE-1B.
           PERFORM SCREENIO.

       RESTORE-TRAILER-EXIT.
           EXIT.

      **************************
       CREATE-TRAILER SECTION.
      **************************
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM READ-WK-FILE.
           IF IO-FG = 0
              MOVE SPACES TO WK-SAVE-RECORD
              MOVE 0 TO WK-MILEAGE-1 WK-VALUE-1
                        WK-SELLPR-1 WK-MISC-AMT-1
                        WK-VIN-CHG-DATE-1
                        WK-MILEAGE-2 WK-VALUE-2
                        WK-SELLPR-2 WK-MISC-AMT-2
                        WK-VIN-CHG-DATE-2
                        WK-MILEAGE-3 WK-VALUE-3
                        WK-SELLPR-3 WK-MISC-AMT-3
                        WK-VIN-CHG-DATE-3
              PERFORM REWRITE-WK-FILE
              GO TO CLOSE-TRAILER.

           MOVE SPACES TO WK-SAVE-RECORD.
           MOVE 0 TO WK-MILEAGE-1 WK-VALUE-1
                     WK-SELLPR-1 WK-MISC-AMT-1
                     WK-VIN-CHG-DATE-1
                     WK-MILEAGE-2 WK-VALUE-2
                     WK-SELLPR-2 WK-MISC-AMT-2
                     WK-VIN-CHG-DATE-2
                     WK-MILEAGE-3 WK-VALUE-3
                     WK-SELLPR-3 WK-MISC-AMT-3
                     WK-VIN-CHG-DATE-3.
           MOVE 0 TO WK-ELE.
           PERFORM WRITE-WK-FILE.
           IF IO-FG = 9
              GO TO IO-ERROR.
       CLOSE-TRAILER.
           PERFORM CLOSE-WK-FILE.
           MOVE " " TO CHFG(11).

      ******************************************
       CREATE-PC-A-RECORD SECTION.
      ******************************************

           PERFORM OPEN-LTA1-FILE.
           PERFORM OPEN-PC1-FILE.

           MOVE SPACES                     TO WK-LTA-RECORD.

      * CREATE AUTO INSURANCE TRAILER RECORD

           MOVE LTA-PATH-OWNBR             TO LTA-BRNO.
           MOVE LN-ACCTNO                  TO LTA-ACCTNO.
           MOVE 01                         TO LTA-SEQNO.
           PERFORM READ-LTA1-FILE.
           IF ( IO-BAD  )
              GO TO CREATE-PC-A-RECORD-WRITE.

           MOVE LTA-DLR-REQ               TO WK-LTA-DLR-REQ.
           MOVE LTA-INS-TYPE              TO WK-LTA-INS-TYPE.
           MOVE LTA-INS-CO                TO WK-LTA-INS-CO.
           MOVE LTA-POLICY-NO             TO WK-LTA-POLICY-NO.
           MOVE LTA-AGENCY                TO WK-LTA-AGENCY.
           MOVE LTA-AGENT                 TO WK-LTA-AGENT.

           MOVE LTA-ADR1                  TO WK-LTA-ADR1.
           MOVE LTA-ADR2                  TO WK-LTA-ADR2.
           MOVE LTA-CITY                  TO WK-LTA-CITY.
           MOVE LTA-STATE                 TO WK-LTA-STATE.
           MOVE LTA-ZIP                   TO WK-LTA-ZIP.
           MOVE LTA-PHONE                 TO WK-LTA-PHONE.
           MOVE LTA-EFF-DATE              TO WK-LTA-EFF-DATE.
           MOVE LTA-EXP-DATE              TO WK-LTA-EXP-DATE.
           MOVE LTA-CAN-DATE              TO WK-LTA-CAN-DATE.

           MOVE LTA-CONF-DATE             TO WK-LTA-CONF-DATE.
           MOVE LTA-LAST-FORM             TO WK-LTA-LAST-FORM.

           MOVE LTA-COV-TYPE              TO WK-LTA-COV-TYPE.
           MOVE LTA-BIL-COV               TO WK-LTA-BIL-COV.
           MOVE LTA-PDL-COV               TO WK-LTA-PDL-COV.
           MOVE LTA-PIP-COV               TO WK-LTA-PIP-COV.
           MOVE LTA-UMB-COV               TO WK-LTA-UMB-COV.
           MOVE LTA-COL-COV               TO WK-LTA-COL-COV.
           MOVE LTA-LOSS-PAYEE            TO WK-LTA-LOSS-PAYEE.
           MOVE LTA-COM-COV               TO WK-LTA-COM-COV.
           MOVE LTA-TRACK-ONLY            TO WK-LTA-TRACK-ONLY.
           MOVE LTA-INSURANCE             TO WK-LTA-INSURANCE.
           MOVE LTA-TRACK-MONTHS          TO WK-LTA-TRACK-MONTHS.
           MOVE LTA-INS-MONTHS            TO WK-LTA-INS-MONTHS.
           MOVE LTA-CPP-MONTHS            TO WK-LTA-CPP-MONTHS.

       CREATE-PC-A-RECORD-WRITE.

           IF ( WK-LTA-RECORD = SPACES )
              GO TO CREATE-PC-A-RECORD-END.

           PERFORM CLEAR-PC-FILE.

           MOVE "A"                        TO PC-ID.
           MOVE BRANCH                     TO PC-BRANCH.
           MOVE LN-SSNO(1)                 TO PC-SOC-SEC.
           MOVE WK-LTA-RECORD              TO PC-LTA-AUTO-RECORD.
           MOVE LN-LOANDATE                TO PC-LOANDATE.
           MOVE LN-ORGTERM                 TO PC-ORGTERM.
           MOVE LN-REGPYAMT                TO PC-REGPYAMT.
           MOVE PC-ID                      TO PC2-ID.
           MOVE BRANCH                     TO PC2-BRANCH.
           MOVE LN-SSNO(1)                 TO PC2-BWNAME.

           PERFORM WRITE-PC1-FILE.
           IF ( IO-BAD )
              PERFORM REWRITE-PC1-FILE.

       CREATE-PC-A-RECORD-END.

           PERFORM CLOSE-LTA1-FILE.
           PERFORM CLOSE-PC1-FILE.

       CREATE-PC-A-RECORD-EXIT.
           EXIT.

      *******************************************
       SET-COLLATERAL-WORK SECTION.
      *******************************************
           PERFORM OPEN-LTC1-FILE.
           MOVE LTC-PATH-OWNBR TO LTC-BRNO.
           MOVE LN-ACCTNO      TO LTC-ACCTNO.
           MOVE 1              TO LTC-SEQNO.
           PERFORM READ-LTC1-FILE.
           IF IO-FG =  0
              MOVE LTC-DESC(1)         TO WK-DESC-1
              MOVE LTC-MAKE(1)         TO WK-MAKE-1
              MOVE LTC-MODEL(1)        TO WK-MODEL-1
              MOVE LTC-YEAR(1)         TO WK-YEAR-1
              MOVE LTC-STYLE(1)        TO WK-STYLE-1
              MOVE LTC-CLASS(1)        TO WK-CLASS-1
              MOVE LTC-VIN(1)          TO WK-VIN-1
              MOVE LTC-TITLE-NO(1)     TO WK-TITLE-NO-1
              MOVE LTC-MILEAGE(1)      TO WK-MILEAGE-1
              MOVE LTC-VALUE(1)        TO WK-VALUE-1
              MOVE LTC-SELLPR(1)       TO WK-SELLPR-1
              MOVE LTC-MISC-AMT(1)     TO WK-MISC-AMT-1
              MOVE LTC-VIN-CHG-DATE(1) TO WK-VIN-CHG-DATE-1
              MOVE LTC-DESC(2)  TO WK-DESC-2
              MOVE LTC-MAKE(2)  TO WK-MAKE-2
              MOVE LTC-MODEL(2) TO WK-MODEL-2
              MOVE LTC-YEAR(2)  TO WK-YEAR-2
              MOVE LTC-STYLE(2) TO WK-STYLE-2
              MOVE LTC-CLASS(2) TO WK-CLASS-2
              MOVE LTC-VIN(2)   TO WK-VIN-2
              MOVE LTC-TITLE-NO(2) TO WK-TITLE-NO-2
              MOVE LTC-MILEAGE(2)  TO WK-MILEAGE-2
              MOVE LTC-VALUE(2)    TO WK-VALUE-2
              MOVE LTC-SELLPR(2)   TO WK-SELLPR-2
              MOVE LTC-MISC-AMT(2) TO WK-MISC-AMT-2
              MOVE LTC-VIN-CHG-DATE(2) TO WK-VIN-CHG-DATE-2
              MOVE SPACES TO WK-AUTO-3
              MOVE 0      TO WK-MILEAGE-3 WK-VALUE-3 WK-SELLPR-3
                             WK-MISC-AMT-3 WK-VIN-CHG-DATE-3
              MOVE LTC-HHGS(1)     TO WK-HHGS-1
              MOVE LTC-HHGS(2)     TO WK-HHGS-2
              MOVE LTC-HHGS(3)     TO WK-HHGS-3
           ELSE
              MOVE SPACES TO WK-AUTO-1
              MOVE 0      TO WK-MILEAGE-1 WK-VALUE-1 WK-SELLPR-1
                             WK-MISC-AMT-1 WK-VIN-CHG-DATE-1
              MOVE SPACES TO WK-AUTO-2
              MOVE 0      TO WK-MILEAGE-2 WK-VALUE-2 WK-SELLPR-2
                             WK-MISC-AMT-2 WK-VIN-CHG-DATE-2
              MOVE SPACES TO WK-AUTO-3
              MOVE 0      TO WK-MILEAGE-3 WK-VALUE-3 WK-SELLPR-3
                             WK-MISC-AMT-3 WK-VIN-CHG-DATE-3
              MOVE SPACES TO WK-HHGS-1
              MOVE SPACES TO WK-HHGS-2
              MOVE SPACES TO WK-HHGS-3.


           PERFORM SAVE-TRAILER-REC.

           PERFORM CLOSE-LTC1-FILE.

       COPY "LIBLP/LPMNUI.CPY".
           IF LN-ACCTNO NUMERIC AND MENU-FG NOT = 99
              MOVE LN-ACCTNO TO LOAN-KEY.

       COPY "LIBLP/LPLTCCL.CPY".
       COPY "LIBLP/LPLNCL.CPY".
       COPY "LIBLP/LPPCCL.CPY".
       COPY "LIBWI/PFSWINDOWS.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBLP/LPUPER.CPY".
       COPY "LIBLP/LPUPWK.CPY".
       COPY "LIBLP/UPERTST.CPY".
       COPY "LIBLP/LPANTI.CPY".
       COPY "LIBLP/LPAMTS.CPY".
       COPY "LIBLP/LPITRM.CPY".
       COPY "LIBLP/LPSPEDL.CPY".
       COPY "LIBLP/LPBAGE.CPY".
       COPY "LIBLP/LPAPRS.CPY".
       COPY "LIBLP/SETCTBL.CPY".
       COPY "LIBLP/LPAPRZ.CPY".
       COPY "LIBLP/CALCPV.CPY".
       COPY "LIBLP/LPEDAY.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBLP/YIELDLN.CPY".
       COPY "LIBLP/OURSLN.CPY".
       COPY "LIBLP/PURFLDLN.CPY".
       COPY "LIBLP/DLCKLN.CPY".
       COPY "LIBWI/RSVENT.CPY".
       COPY "LIBWI/RSVENTLN.CPY".
       COPY "LIBWI/FEEENT.CPY".
       COPY "LIBWI/FEEENTLN.CPY".
       COPY "LIBLP/LPIEXP.CPY".
       COPY "LIBGB/GPENV.CPY".

      *****************************************
       GET-ACCOUNT-NUMBER SECTION.
      *****************************************
           MOVE "Y" TO ACCTNO-WAS-SET-FG.
           PERFORM OPEN-GB-FILE.
           MOVE LN-OWNBR TO GB-BRNO.
           MOVE 1        TO GB-NO.
           PERFORM READ-GB-FILE.
           PERFORM CLOSE-GB-FILE.
           IF IO-FG = 9
              GO TO IO-ERROR.
           IF LN-SMALLOAN = "Y"
              MOVE GB-NEXT-SMALL TO LN-ACCTNO
           ELSE
              MOVE GB-NEXT-SF TO LN-ACCTNO.

      *****************************************************************
      * OK, NOT QUITE SURE WHAT TO DO HERE.  I'M CHECKING ARCHIVE
      * IF THEY ENTER ACCT# & REJECTING NUMBER IF EXISTS IN ARCHIVE.
      * HERE THEY'VE HIT RETURN FOR NEXT LN NUMBER; IF NEXT # EXISTS
      * IN ARCHIVE, I'M ADDING 1 UNTIL ACCT DOESN'T EXIST IN ARCHIVE.
      * BUT IF I ADD TO NEXT, I'M TURNING OFF ACCTNO-WAS-SET-FG,
      * OTHERWISE IN SET-ACCOUNT-NUMBER IT WON'T MATCH THE NEXT & THEY
      * WOULD GET BOGUS "ACCOUNT NUMBER WILL BE CHANGING" MESS.  ALSO,
      * NOT TO FOND OF BUMPING NEXT BY 2, 200, 2000....   BARB
      *****************************************************************
      *TEST-FOR-LN-IN-ARCHIVE.

           MOVE "SN N060LNNO." TO VDU.
           MOVE LN-ACCTNO TO VDUNUM0.
           PERFORM SCREENIO.

      *****************************************
       SET-ACCOUNT-NUMBER SECTION.
      *****************************************
           PERFORM OPEN-GB-FILE.
           MOVE LN-OWNBR TO GB-BRNO.
           MOVE 1        TO GB-NO.
           PERFORM READ-GB-FILE.
           IF IO-FG = 9
              GO TO IO-ERROR.

           IF LN-SMALLOAN = "Y"
              IF GB-NEXT-SMALL = 0
                 ADD 1 TO GB-NEXT-SMALL
              END-IF
              MOVE GB-NEXT-SMALL TO SET-NUMBER
              ADD 1 TO GB-NEXT-SMALL
           ELSE
              IF GB-NEXT-SF = 0
                 ADD 1 TO GB-NEXT-SF
              END-IF
              MOVE GB-NEXT-SF TO SET-NUMBER
              ADD 1 TO GB-NEXT-SF.
           PERFORM REWRITE-GB-FILE.
           PERFORM CLOSE-GB-FILE.
           IF SET-NUMBER NOT = LN-ACCTNO
              MOVE "ACCOUNT NUMBER WILL BE CHANGING!!!!!!!!!!!!!"
                                                        TO MESS
              PERFORM SEND-MESS
              MOVE "SN N060LNNO." TO VDU
              MOVE SET-NUMBER TO VDUNUM0
                                 LN-ACCTNO
              PERFORM SCREENIO
              MOVE "MAKE (N O T E) OF THE NEW NUMBER !!!!!!!!!!!!"
                                                        TO MESS
              PERFORM SEND-MESS.


      ******************************************************************
       AUTOPC-ROUTINE SECTION.
      ******************************************************************

           MOVE "A"                        TO AUTOPC-PC-ID.
           MOVE BRANCH                     TO AUTOPC-PC-BRANCH.
           MOVE LN-SSNO(1)                 TO AUTOPC-PC-SOC-SEC.

           MOVE "WI/AUTOPC" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH AUTOPC-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

       AUTOPC-ROUTINE-EXIT.
           EXIT.

      ***********************************
       COLLATERAL-CREATE SECTION.
      ***********************************
           MOVE TEMP-PATH TO LTCREA-PATH.
           MOVE "WI/LTCREA" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LTCREA-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.
       EXIT-COLLATERAL-CREATE.
           EXIT.

      *********************************************
       DO-FEEENT-WINDOW SECTION.
      *********************************************
           MOVE 1 TO ONE.
           MOVE SP-FEEFRMLA(1) TO FW-PROTECT-FEE1-FG.
           MOVE SP-FEEFRMLA(2) TO FW-PROTECT-FEE2-FG.

           PERFORM FEEENT-WIN.
           MOVE "LONIJ" TO VDU-FORM-NAME.

           PERFORM SETUP-FEES-FOR-DISPLAY.
           MOVE D-330-340 TO WR-BUF.
           MOVE FEE-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

           PERFORM SEND-PURCHASE-FIELDS.

      *********************************************
       DO-RSVENT-WINDOW SECTION.
      *********************************************
           MOVE 1 TO ONE.
           PERFORM RSV-CALC-AMTFIN.
           COMPUTE RSVENT-ANTICERN =
                     LN-ANTICERN(1) + LN-ANTICERN(2)
                   + LN-ANTICERN(3) + LN-ANTICERN(5).

           IF NOT(GP-INCL-OTH-IN-EARNED-N OR GP-INCL-OTH-IN-EARNED-R)
              ADD LN-ANTICERN(6) TO RSVENT-ANTICERN.

           IF NOT(GP-INCL-OTH-IN-EARNED-R)
              ADD LN-ANTICERN(4) TO RSVENT-ANTICERN.


      *JTG   + PD-ANTICERN(5) + PD-ANTICERN(6). PERSP-LNCOST-FRMLA 'D'

           MOVE LN-PROCEEDS TO RSVENT-PROCEEDS.
           MOVE LN-YLDRATE TO RSVENT-YLDRATE.
           MOVE LN-DLDISC TO RSVENT-DLDISC.
           MOVE LN-DLRVPRIN(1)    TO RSVENT-DLRVPRIN(1).
           MOVE LN-DLRVPRIN(2)    TO RSVENT-DLRVPRIN(2).
           MOVE LN-DLRVPRIN(3)    TO RSVENT-DLRVPRIN(3).
           MOVE LN-DLRVCHGS(1)    TO RSVENT-DLRVCHGS(1).
           MOVE LN-DLRVCHGS(2)    TO RSVENT-DLRVCHGS(2).
           MOVE LN-DLRVCHGS(3)    TO RSVENT-DLRVCHGS(3).
           MOVE LN-DLPARVHELD     TO RSVENT-DLPARVHELD.
           MOVE LN-DLPARVPAID     TO RSVENT-DLPARVPAID.
           MOVE LN-ANTICERN(6)    TO RSVENT-LNCOST.
           MOVE LN-INSPREM-DLADJ  TO RSVENT-INSPREM-DLADJ.
           MOVE LN-DLCOMM-PP-CMSI TO RSVENT-DLCOMM-PP-CMSI.
           MOVE LN-DLCOMM-O3-CMSI TO RSVENT-DLCOMM-O3-CMSI.

           MOVE DLRVPRIN-FG(1)    TO RSVENT-DLRVPRIN-FG(1).
           MOVE DLRVPRIN-FG(2)    TO RSVENT-DLRVPRIN-FG(2).
           MOVE DLRVPRIN-FG(3)    TO RSVENT-DLRVPRIN-FG(3).
           MOVE DLRVCHGS-FG(1)    TO RSVENT-DLRVCHGS-FG(1).
           MOVE DLRVCHGS-FG(2)    TO RSVENT-DLRVCHGS-FG(2).
           MOVE DLRVCHGS-FG(3)    TO RSVENT-DLRVCHGS-FG(3).
           MOVE DLPARVHELD-FG     TO RSVENT-DLPARVHELD-FG.
           MOVE DLPARVPAID-FG     TO RSVENT-DLPARVPAID-FG.
           MOVE DLDISC-FG         TO RSVENT-DLDISC-FG.
           MOVE DLCOMM-PP-CMSI-FG TO RSVENT-DLCOMM-PP-CMSI-FG.
           MOVE DLCOMM-O3-CMSI-FG TO RSVENT-DLCOMM-O3-CMSI-FG.

           MOVE LN-LOANTYPE TO RSVENT-LOANTYPE.

           PERFORM RSVENT-WIN.
           MOVE "LONIJ" TO VDU-FORM-NAME.

           MOVE RSVENT-DLDISC         TO LN-DLDISC.
           MOVE RSVENT-DLRVPRIN(1)    TO LN-DLRVPRIN(1).
           MOVE RSVENT-DLRVPRIN(2)    TO LN-DLRVPRIN(2).
           MOVE RSVENT-DLRVPRIN(3)    TO LN-DLRVPRIN(3).
           MOVE RSVENT-DLRVCHGS(1)    TO LN-DLRVCHGS(1).
           MOVE RSVENT-DLRVCHGS(2)    TO LN-DLRVCHGS(2).
           MOVE RSVENT-DLRVCHGS(3)    TO LN-DLRVCHGS(3).
           MOVE RSVENT-DLPARVHELD     TO LN-DLPARVHELD.
           MOVE RSVENT-DLPARVPAID     TO LN-DLPARVPAID.
           MOVE RSVENT-LNCOST         TO LN-ANTICERN(6).
           MOVE RSVENT-INSPREM-DLADJ  TO LN-INSPREM-DLADJ.
           MOVE RSVENT-DLCOMM-PP-CMSI TO LN-DLCOMM-PP-CMSI.
           MOVE RSVENT-DLCOMM-O3-CMSI TO LN-DLCOMM-O3-CMSI.

           MOVE RSVENT-DLRVPRIN-FG(1)    TO DLRVPRIN-FG(1).
           MOVE RSVENT-DLRVPRIN-FG(2)    TO DLRVPRIN-FG(2).
           MOVE RSVENT-DLRVPRIN-FG(3)    TO DLRVPRIN-FG(3).
           MOVE RSVENT-DLRVCHGS-FG(1)    TO DLRVCHGS-FG(1).
           MOVE RSVENT-DLRVCHGS-FG(2)    TO DLRVCHGS-FG(2).
           MOVE RSVENT-DLRVCHGS-FG(3)    TO DLRVCHGS-FG(3).
           MOVE RSVENT-DLPARVHELD-FG     TO DLPARVHELD-FG.
           MOVE RSVENT-DLPARVPAID-FG     TO DLPARVPAID-FG.
           MOVE RSVENT-DLDISC-FG         TO DLDISC-FG.
           MOVE RSVENT-DLCOMM-PP-CMSI-FG TO DLCOMM-PP-CMSI-FG.
           MOVE RSVENT-DLCOMM-O3-CMSI-FG TO DLCOMM-O3-CMSI-FG.

           PERFORM COMPUTE-PRINCIPLE.
           PERFORM COMPUTE-PAYMENTS.
           PERFORM COMPUTE-INS-COVERAGE.
           PERFORM COMPUTE-INS-TERM.
           PERFORM COMPUTE-ANTICTERM.
           IF LN-CURBAL = 0 AND LN-POFFDATE = 0
               PERFORM COMPUTE-PURBAL.
           PERFORM COMPUTE-FINANCE-CHARGE.
      
      * NOTE: THE FOLLOWING IF IS TO ASSURE THAT WHEN LNSTAT.C
      *       IS CALLED AND REBATES ARE SET THAT THOSE ADJUSTMENTS
      *       ARE NOT OVER WRITTEN HERE, JTG 010329
      
           IF ( LN-INT-REBATE = " " OR "N") AND
              ( LN-SC-REBATE  = " " OR "N") AND
              ( LN-MF-REBATE  = " " OR "N") AND
              ( LN-ANTICADJ(1) = 0        ) AND
              ( LN-ANTICADJ(3) = 0        ) AND
              ( LN-ANTICADJ(4) = 0        )
              PERFORM COMPUTE-ANTICIPATED.

           PERFORM COMPUTE-DEALER-CHECK.
           PERFORM CALC-YIELD.
           PERFORM SEND-X-LIST.
           PERFORM CALCULATE-APR.


      *******************************************************
       VERIFY-PASSWORD SECTION.
      *******************************************************
           MOVE " " TO PASSWDW-STAT.
           MOVE "LONIJ0" TO PASSWDW-PGM.
           MOVE "PLEASE ENTER THE PASSWORD," TO PASSWDW-PROMPT1.
           MOVE "CL/PASSWD" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH PASSWDW-BUF.
           CANCEL FORM-PROGX.

      *******************************************************
       SETUP-PURCHASE-FIELDS SECTION.
      *******************************************************

      * SET LOAN RESERVE FIELDS INTO PURFLD FIELDS:
           MOVE LN-DLRVPRIN(1) TO PURFLD-DLRVPRIN(1).
           MOVE LN-DLRVPRIN(2) TO PURFLD-DLRVPRIN(2).
           MOVE LN-DLRVPRIN(3) TO PURFLD-DLRVPRIN(3).
           MOVE LN-DLRVCHGS(1) TO PURFLD-DLRVCHGS(1).
           MOVE LN-DLRVCHGS(2) TO PURFLD-DLRVCHGS(2).
           MOVE LN-DLRVCHGS(3) TO PURFLD-DLRVCHGS(3).
           MOVE LN-DLPARVHELD  TO PURFLD-DLPARVHELD.
           MOVE LN-DLPARVPAID  TO PURFLD-DLPARVPAID.
           MOVE LN-DLDISC      TO PURFLD-DLDISC.

      * SET LOAN RESERVE FLAG FIELDS INTO PURFLD FIELDS:
           MOVE DLRVPRIN-FG(1) TO PURFLD-DLRVPRIN-FG(1).
           MOVE DLRVPRIN-FG(2) TO PURFLD-DLRVPRIN-FG(2).
           MOVE DLRVPRIN-FG(3) TO PURFLD-DLRVPRIN-FG(3).
           MOVE DLRVCHGS-FG(1) TO PURFLD-DLRVCHGS-FG(1).
           MOVE DLRVCHGS-FG(2) TO PURFLD-DLRVCHGS-FG(2).
           MOVE DLRVCHGS-FG(3) TO PURFLD-DLRVCHGS-FG(3).
           MOVE DLPARVHELD-FG  TO PURFLD-DLPARVHELD-FG.
           MOVE DLPARVPAID-FG  TO PURFLD-DLPARVPAID-FG.
           MOVE DLDISC-FG      TO PURFLD-DLDISC-FG.

           PERFORM COMPUTE-PURCHASE-FIELDS.
           IF PURFLD-STAT = "DL"
              MOVE "DEALER RECORD NOT FOUND" TO MESS
              PERFORM SEND-MESS
              GO TO IO-ERROR.

      * SET NEW VALUES OF LOAN RESERVE FIELDS FROM PURFLD FIELDS:
           MOVE PURFLD-DLRVPRIN(1) TO LN-DLRVPRIN(1).
           MOVE PURFLD-DLRVPRIN(2) TO LN-DLRVPRIN(2).
           MOVE PURFLD-DLRVPRIN(3) TO LN-DLRVPRIN(3).
           MOVE PURFLD-DLRVCHGS(1) TO LN-DLRVCHGS(1).
           MOVE PURFLD-DLRVCHGS(2) TO LN-DLRVCHGS(2).
           MOVE PURFLD-DLRVCHGS(3) TO LN-DLRVCHGS(3).
           MOVE PURFLD-DLPARVHELD  TO LN-DLPARVHELD.
           MOVE PURFLD-DLPARVPAID  TO LN-DLPARVPAID.
           MOVE PURFLD-DLDISC      TO LN-DLDISC.

      *******************************************************
       CALL-LNSTAT-WINDOW SECTION.
      *******************************************************
           MOVE "WI/LNSTAT" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH LN-REC EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           MOVE "SN N062ANTIC." TO VDU.
           COMPUTE VDUNUM2 = LN-ANTICERN(1) + LN-ANTICERN(2)
                           + LN-ANTICERN(3) + LN-ANTICERN(5).

           IF NOT (GP-INCL-OTH-IN-EARNED-N OR GP-INCL-OTH-IN-EARNED-R)
              ADD LN-ANTICERN(6) TO VDUNUM2.

           IF NOT GP-INCL-OTH-IN-EARNED-R
              ADD LN-ANTICERN(4) TO VDUNUM2.

           PERFORM SCREENIO.

      *******************************************************
       D13-SP-EDT-TABLE-LOOKUP SECTION.
      *******************************************************
           MOVE "Y" TO PASSED-EDITS-FLAG.
           SET ETBL TO 1.
           MOVE 0 TO COUNTER.
           MOVE  9999.999 TO RATE-LOW
           MOVE -9999.999 TO RATE-HIGH
           MOVE SPACES TO MESS.

           IF LN-ORGTERM < 1
              MOVE "VALUE OUT OF RANGE SET IN SP RECORD" TO MESS
              GO TO D13-EXIT-WITH-ERROR.

      *----------------------------------------------------------------
      * TEST THE VARIANCE EDITS IN THE SPR (VL & VH)
      *  RATHER THAN TESTING A FLAT RATE, THE VARIANCE TELLS HOW MUCH
      *  THE CONTRACT RATE CAN VARY FROM THE CALCULATED APR
      *  EXAMPLE:   CALCULATED RATE = 12.270 %
      *             VARIANCE HIGH   = .20
      *             VARIANCE LOW    = .23
      *
      *        COMPUTE RATE LOW  = 12.270 - .20 = 12.070 %
      *        COMPUTE RATE HIGH = 12.270 + .23 = 12.500 %
      *
      *        IF THE CONTRACT RATE DOES NOT FALL BETWEEN
      *             12.070 AND 12.500
      *        THEN
      *           THE CONTRACT CANNOT BE UPDATED.
      *----------------------------------------------------------------
       D13-APR-VARIANCE-VALIDATION.
           IF NOT (GP-USE-CONRATE = "Y")
              GO TO D13-EXIT.

           ADD 1 TO COUNTER.

           IF COUNTER > SP-EDT-NOEDITS(ETBL)
              GO TO D13-APR-VARIANCE-TABLE2.

           IF SP-EDT-TYPE(ETBL,COUNTER) = "V"
              IF SP-EDT-HL(ETBL,COUNTER) = "L"
                 SUBTRACT SP-EDT-RATE(ETBL,COUNTER) FROM LN-APRATE
                          GIVING RATE-LOW
              ELSE
                 ADD SP-EDT-RATE(ETBL,COUNTER) TO LN-APRATE
                          GIVING RATE-HIGH.

           IF COUNTER NOT > SP-EDT-NOEDITS(ETBL)
              GO TO D13-APR-VARIANCE-VALIDATION.

       D13-APR-VARIANCE-TABLE2.
           IF SP-EDT-NOEDITS(ETBL) NOT < 6 AND ETBL NOT = 2
              MOVE 0 TO COUNTER
              SET ETBL TO 2
              GO TO D13-APR-VARIANCE-VALIDATION.

      *    -------------------------------------------------------------
      *    TEST FOR ERROR:  APR - VARIANCE NOT < 0
      *    -------------------------------------------------------------
           IF RATE-LOW < 0
              MOVE " SPR ERROR: APR - VARIANCE < 0" TO MESS
              GO TO D13-EXIT-WITH-ERROR.

      *    -------------------------------------------------------------
      *    TEST FOR ERROR:  APR + VARIANCE EXCEEDS 999.999
      *    -------------------------------------------------------------
           IF RATE-HIGH > 999.999
              MOVE " SPR ERROR: APR + VARIANCE > 999.999" TO MESS
              GO TO D13-EXIT-WITH-ERROR.

      *    -------------------------------------------------------------
      *    TEST VARIANCE RATE LOW: CONTRACT APR < CALC'D APR - VARIANCE
      *    -------------------------------------------------------------
           IF (LN-CONRATE < RATE-LOW) AND (RATE-LOW NOT = 9999.999)
              MOVE RATE-LOW TO DISP-RATE
              STRING " CONTRACT APR FALLS BELOW MINIMUN VARIANCE OF "
                      DISP-RATE "%" DELIMITED BY SIZE INTO MESS
              GO TO D13-EXIT-WITH-ERROR.

      *    -------------------------------------------------------------
      *    TEST VARIANCE RATE LOW: CONTRACT APR > CALC'D APR + VARIANCE
      *    -------------------------------------------------------------
           IF (LN-CONRATE > RATE-HIGH) AND (RATE-HIGH NOT = -9999.999)
              MOVE RATE-HIGH TO DISP-RATE
              STRING " CONTRACT APR EXCEEDS MAXIMUM VARIANCE OF "
                      DISP-RATE "%" DELIMITED BY SIZE INTO MESS
              GO TO D13-EXIT-WITH-ERROR.

           GO TO D13-EXIT.
       D13-EXIT-WITH-ERROR.
           PERFORM SEND-MESS.
           MOVE "N" TO PASSED-EDITS-FLAG.
       D13-EXIT.
           EXIT.


      ***************************************************
       FORM-RESET SECTION.
      ***************************************************
           MOVE LPLONI-SYSDATE TO LONIJ-SYSDATE.
           DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN.
           DISPLAY LONIJ-SCREEN UPON TCLP-MAIN-WINDOW-HANDLE.
           MOVE LONIJ-FORM-FIELDS TO WR-BUF.
           MOVE LONIJ-FORM-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.


      ***************************************************
       SETUP-LINK-INFO SECTION.
      ***************************************************
           MOVE LONIJ-HELP--FILE TO HELP-LINK-FILE.
           MOVE LONIJ-HELP--DIR TO HELP-LINK-DIR.

      ***************************************************
       VDU-CONVERT-FIELD SECTION.
      ***************************************************
           MOVE "00" TO STAT.
           MOVE VDU-FIELD-TO-CONVERT TO VDU-ALP-FIELD.
           EVALUATE TRUE
              COPY "LIBLP/LONIJ_EVA.CPY".
              COPY "LIBLP/LPCMNU_EVA.CPY".
              COPY "LIBWI/RSVENT_EVA.CPY".
              COPY "LIBWI/FEEENT_EVA.CPY".
              WHEN OTHER       MOVE   "2A" TO STAT
           END-EVALUATE.

      *********************************
       MISC-PARAGRAPHS SECTION.
      *********************************
       COPY "LIBGB/CHKSEC.CPY".
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/SYSTEM.CPY".
       COPY "LIBGB/GETENV.CPY".
       CALC-YIELD.
           PERFORM COMPUTE-YIELD.
           MOVE APR-APR TO LN-YLDRATE.
       GET-GB.
           PERFORM OPEN-GB-FILE.
           MOVE BRANCH TO GB-BRNO.
           MOVE 1      TO GB-NO.
           PERFORM READ-GB-FILE.
           PERFORM CLOSE-GB-FILE.

       SEND-1STPYDATE.
           MOVE LN-INTDATE TO NDTE-DATE.
           MOVE 1          TO NDTE-HOLD.
           MOVE LN-UNITPER-CD TO DATER-UNITPER-CD.
           MOVE LN-UNITPER-FREQ TO DATER-UNITPER-FREQ.
           PERFORM INCREMENT-UNITPER.
           IF LN-UNITPER-CD = "S"
              IF NDTE-DD  = 14 OR 15
                 MOVE 16 TO NDTE-DD.
           MOVE "S  8000170." TO VDU.
           MOVE NDTE-DATE TO VDU-DATE-YYYYMMDD
                             LN-1STPYDATE
                             LN-ORIG-1STPYDATE.
           PERFORM SCREENIO.


      *----------------------------------------------------------------
      *   INVALID DUE DAY FOR SEMI MONTHLY ACCOUNTS
      *---------------------------------------------------------------
       INVALID-DUE-DAY.
           IF LN-1STPYDA = 31
              MOVE " 31ST OF MONTH INVALID FOR SEMI-MONTHLY PAPER"
                                                           TO MESS
           ELSE
              STRING
            LN-1STPYDA,"TH OF MONTH INVALID FOR SEMI-MONTHLY PAPER"
                                       DELIMITED BY "  " INTO MESS.

      *-----------------------------------------------------------------
       DISPLAY-BULK-CONVERSION.
           MOVE "S  A200TITLE." TO VDU.
           IF BULK-CONVERSION-FG = "B"
              MOVE "SALES BULK PURCHASE" TO VDUBUF
           ELSE
              MOVE "SALES FINANCE CONVR" TO VDUBUF.
           PERFORM SCREENIO.

       TEST-BAL.
           MOVE 9 TO IO-FG.
           IF LN-CURBAL = 0
              IF LN-INTBAL = 0
                 IF LN-LCBAL = 0
                    IF LN-OTHBAL = 0
                        MOVE 0 TO IO-FG.
       GET-CODE.
           MOVE "GC"     TO CDB-TYPE.
           MOVE LN-OWNBR TO CDB-BRANCH.
           PERFORM OPEN-CDB1-FILE.
           PERFORM READ-CDB1-FILE.
           PERFORM CLOSE-CDB1-FILE.
           IF IO-FG = 9
              MOVE " * NOT ON FILE * " TO CDB-DESC.
       GET-LC.
           PERFORM OPEN-LC1-FILE.
           PERFORM READ-LC1-FILE.
           PERFORM CLOSE-LC1-FILE.
           IF IO-FG = 9
              MOVE "INVALID" TO LC-DESC.
           MOVE "N" TO FORCE-ENTERED-PRIN1 FORCE-ENTERED-PRIN2
                       FORCE-ENTERED-DISC.
       GET-CD.
           PERFORM READ-CD1-FILE.
           IF IO-FG = 9
              MOVE " INVALID CODE" TO CD-DESC.

       GET-GI.
           PERFORM OPEN-GI1-FILE.
           PERFORM READ-GI1-FILE.
           PERFORM CLOSE-GI1-FILE.

       GET-DL1.
           PERFORM OPEN-DL1-FILE.
           PERFORM READ-DL1-FILE.
           PERFORM CLOSE-DL1-FILE.
           IF IO-FG = 9
              MOVE " INVALID DEALER" TO DL-SHORT.
       GET-BW1.
           PERFORM READ-BW1-FILE.
           IF IO-FG = 9
              MOVE " " TO BW-FNAME
              MOVE "NOT FOUND" TO BW-LNAME.
           PERFORM APPEND-BW-NAMES.
       GET-SP.
           MOVE LN-ORGST TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE TO SP-LAWCODE.
           PERFORM READ-SP1-FILE.
           IF IO-FG = 9
              MOVE "STATE PARA DELETED" TO MESS
              PERFORM SEND-MESS
              GO TO IO-ERROR.
       SAVE-TRAILER-REC.
           MOVE 6 TO WK-KEY.
           PERFORM OPEN-WK-FILE.
           PERFORM REWRITE-WK-FILE.
           PERFORM CLOSE-WK-FILE.
       GET-RECOURSE-DESC.
           MOVE " INVALID" TO VDUBUF.
           IF LN-DLRECOURSE = "F"
              MOVE "ULL" TO VDUBUF.
           IF LN-DLRECOURSE = "P"
              MOVE "ARTIAL" TO VDUBUF.
           IF LN-DLRECOURSE = "N"
              MOVE "ONE" TO VDUBUF.
       SEND-CD-DESC.
           PERFORM GET-CD.
           MOVE "S  A000  1." TO VDU.
           MOVE ELE           TO VDUROW.
           MOVE CD-DESC       TO VDUBUF.
           PERFORM SCREENIO.
       GET-COLLATERAL.
           PERFORM OPEN-LTC1-FILE.
           MOVE LTC-PATH-OWNBR  TO LTC-BRNO.
           MOVE LN-ACCTNO       TO LTC-ACCTNO.
           MOVE 1               TO LTC-SEQNO.
           PERFORM READ-LTC1-FILE.
           IF IO-FG = 9
              MOVE SPACES TO LTC-HHGS(1).
           PERFORM CLOSE-LTC1-FILE.
       APPEND-BW-NAMES.
           MOVE BW-LNAME TO INSPECT-W.
           MOVE BW-FNAME TO ADD-ON.
           PERFORM ADD-IT.
       ADD-IT.
           INSPECT INSPECT-W REPLACING FIRST "  " BY " +".
           INSPECT INSPECT-W REPLACING FIRST
              "+                        " BY ADD-ON.
       ADD-IT2.
           PERFORM ADD-IT.
           MOVE "/" TO ADD-ON.
           PERFORM ADD-IT.
       NUMBW-TO-ALPBW.
           MOVE " " TO ALP-BW.
           IF NUM-BW NOT = 0
              MOVE NUM-BW123 TO ALP-BW123
              MOVE NUM-BW45 TO ALP-BW45
              MOVE NUM-BW6789 TO ALP-BW6789
              MOVE "-" TO ALP-HYPHEN1 ALP-HYPHEN2.
       SEND-BW-NO-NAME.
           MOVE BW-SSNO TO NUM-BW.
           PERFORM NUMBW-TO-ALPBW.
           MOVE "S  A110  0." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE ALP-BW TO VDUBUF.
           PERFORM SCREENIO.
           PERFORM SEND-BW-NAME.
       SEND-BW-NAME.
           MOVE "S  A330  1." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE INSPECT-W TO VDUBUF.
           PERFORM SCREENIO.
       SEND-BW-MAKERCD.
           MOVE "S  A010  2." TO VDU.
           MOVE ELE TO VDUROW.
           MOVE LN-MAKERCD(ELE) TO VDUBUF.
           PERFORM SCREENIO.
       SEND-MEMO.
           MOVE "S  A060M1." TO VDU.
           MOVE "MEMO: " TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A300M2." TO VDU.
           MOVE LN-MESSAGE TO VDUBUF.
           PERFORM SCREENIO.
       NOT-FOUND.
           MOVE "NOT FOUND" TO MESS.
           PERFORM SEND-MESS.
       GI-NOT-FOUND.
           MOVE "G/L INTERFACE RECORD NOT FOUND" TO MESS
           PERFORM SEND-MESS.
       SP-INVALID.
           MOVE "ENTRY INCONSISTENT WITH STATE PARAMETERS" TO MESS.
           PERFORM SEND-MESS.
       NOT-SALES-FINANCE.
           MOVE "INVALID FOR SALES FINANCE" TO MESS.
           PERFORM SEND-MESS.
       UPDATE-MSG.
           MOVE "UPDATING LOAN MASTER.........." TO LEGEND.
           PERFORM SEND-LEGEND.
       MSG-LINE.
      *    CALL TMMSG USING MESS.
           MOVE MESS TO TMMSG-MESS.
           PERFORM CALL-TMMSG.
       SEND-LEGEND.
           MOVE LEGEND TO WR-BUF.
           MOVE LEGEND-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       RESET-LEGEND.
           MOVE " " TO LEGEND.
           PERFORM SEND-LEGEND.
       SEND-WSEL-LEGEND.
           MOVE MESS TO WR-BUF.
           MOVE WSEL-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
       RECORD-DELETED.
           MOVE "RECORD WAS DELETED!" TO MESS.
           PERFORM SEND-MESS.
       RECORD-CHANGED.
           MOVE "CHANGES WERE MADE TO THIS RECORD!" TO MESS.
           PERFORM SEND-MESS.
       CHANGE-AGAIN.
           MOVE "PLEASE RE-INPUT YOUR CHANGES!" TO MESS.
           PERFORM SEND-MESS.
       ALREADY-CREATED.
           MOVE "RECORD HAS BEEN ALREADY CREATED!" TO MESS.
           PERFORM SEND-MESS.
       UNDERGONE-CHANGE.
           MOVE "RECORD HAS UNDERGONE CHANGE BY ANOTHER USER" TO MESS.
           PERFORM SEND-MESS.
       PROTECT-UNPROTECT.
           MOVE STAT TO CHFG(16) CHFG(18) CHFG(19) CHFG(21) CHFG(35)
                        CHFG(36) CHFG(38) CHFG(39) CHFG-ENDORATE.
       SEND-X-LIST.
           MOVE LN-PROCEEDS TO X-PROCEEDS.
           IF GP-INCL-OTH-IN-EARNED-N
              COMPUTE X-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3) + LN-ANTICERN(4)
                              + LN-ANTICERN(5)
           ELSE
           IF GP-INCL-OTH-IN-EARNED-R
              COMPUTE X-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3)
                              + LN-ANTICERN(5)
           ELSE
              COMPUTE X-ANTIC = LN-ANTICERN(1) + LN-ANTICERN(2)
                              + LN-ANTICERN(3) + LN-ANTICERN(4)
                              + LN-ANTICERN(5) + LN-ANTICERN(6).

      *JTG   + PD-ANTICERN(5) + PD-ANTICERN(6). PERSP-LNCOST-FRMLA 'D'
           MOVE LN-1STPYAMT TO X-350.
           MOVE LN-REGPYAMT TO X-351.
           MOVE LN-LASTPYAMT TO X-360.
           MOVE LN-PURDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYY.
           MOVE DATE-MMDDYY TO X-370.
           IF LN-DLRVPRIN(2) = 0
                   AND LN-DLRVPRIN(3) = 0
              MOVE LN-DLRVPRIN(1) TO X-380
           ELSE
              ADD LN-DLRVPRIN(1) LN-DLRVPRIN(2) LN-DLRVPRIN(3)
                                         GIVING X-380
              INSPECT X-380 REPLACING LEADING " " BY "*".

           IF LN-DLRVCHGS(2) = 0
                   AND LN-DLRVCHGS(3) = 0
              MOVE LN-DLRVCHGS(1) TO X-381
           ELSE
              ADD LN-DLRVCHGS(1) LN-DLRVCHGS(2) LN-DLRVCHGS(3)
                                         GIVING X-381
              INSPECT X-381 REPLACING LEADING " " BY "*".

           IF LN-DLPARVPAID = 0
              MOVE LN-DLPARVHELD TO X-390
           ELSE
              ADD LN-DLPARVHELD LN-DLPARVPAID GIVING X-390
              INSPECT X-390 REPLACING LEADING " " BY "*".

           MOVE LN-DLDISC TO X-391.
           MOVE X-BUF TO WR-BUF.
           MOVE X-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.
      *-----------------------------------------------------------------
       CONDITIONAL-SEND-MESS.
           PERFORM SEND-MESS.

      *********************************
       IO-ROUTINE SECTION.
      *********************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBLP/LPSPGS_SQL.CPY".
       COPY "LIBLP/LPPCGS_SQL.CPY".
       COPY "LIBLP/LPNOGS_SQL.CPY".
       COPY "LIBLP/LPLTCGS_SQL.CPY".
       COPY "LIBLP/LPLTAGS_SQL.CPY".
       COPY "LIBLP/LPLPGS_SQL.CPY".
       COPY "LIBLP/LPLNGS_SQL.CPY".
       COPY "LIBLP/LPLCGS_SQL.CPY".
       COPY "LIBLP/LPICGS_SQL.CPY".
       COPY "LIBLP/LPDSGS_SQL.CPY".
       COPY "LIBLP/LPDLGS_SQL.CPY".
       COPY "LIBLP/LPCDBGS_SQL.CPY".
       COPY "LIBLP/LPCDGS_SQL.CPY".
       COPY "LIBLP/LPBWGS_SQL.CPY".
       COPY "LIBGL/GLGIGS_SQL.CPY".
       COPY "LIBGB/GBGBGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBLP/LPDL1RN.CPY".
       COPY "LIBLP/LPLTA1IN.CPY".
       COPY "LIBLP/LPLTC1IN.CPY".
       COPY "LIBLP/LPNO1IN.CPY".
       COPY "LIBLP/LPPC1IN.CPY".
       COPY "LIBLP/LPWKI.CPY".
       COPY "LIBLP/LPLC1RN.CPY".
       COPY "LIBLP/LPLN1IN.CPY".
       COPY "LIBLP/LPLN4RN.CPY".
       COPY "LIBLP/LPLN5RN.CPY".
      *COPY "LIBLP/LPLN6RN.CPY".
      *COPY "LIBLP/LPLN7RN.CPY".
       COPY "LIBLP/LPLP1IN.CPY".
       COPY "LIBLP/LPSP1RN.CPY".
       COPY "LIBLP/LPBW1RN.CPY".
       COPY "LIBLP/LPBW2RN.CPY".
       COPY "LIBLP/LPBW3RN.CPY".
       COPY "LIBLP/LPBW4RN.CPY".
       COPY "LIBLP/LPCD1RN.CPY".
       COPY "LIBLP/LPCDB1RN.CPY".
       COPY "LIBLP/LPIC1RN.CPY".
       COPY "LIBLP/LPDS1RN.CPY".
       COPY "LIBGB/GBGBIN.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBGL/GLGI1RN.CPY".

      **************************************************************
      *   ARCHIVED LNFILE IO
      **************************************************************
      *OPEN-ARCH-LN1-FILE.
      *    PERFORM OPEN-IT.
      *    MOVE LN-ARCHIVE-PATH TO E-FILE.
      *    OPEN INPUT ARCH-LN-FILE.
      *    IF IO-FG = 8
      *      GO TO OPEN-ARCH-LN1-FILE.
      *    IF IO-FG = 7
      *      CLOSE ARCH-LN-FILE
      *      GO TO OPEN-ARCH-LN1-FILE.
      *    UNLOCK ARCH-LN-FILE.
      *READ-ARCH-LN1-FILE.
      *    PERFORM READ-IT.
      *    MOVE LN-ARCHIVE-PATH TO E-FILE.
      *    MOVE ARCH-LN1-KEY TO E-KEYX.
      *    READ ARCH-LN-FILE.
      *    IF IO-FG = 8
      *      GO TO READ-ARCH-LN1-FILE.
      *CLOSE-ARCH-LN1-FILE.
      *    PERFORM CLOSE-IT.
      *    CLOSE ARCH-LN-FILE.
      **************************************************************

       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO ERRCD.

      *********************************
       END-ROUTINE SECTION.
      *********************************
           PERFORM CLOSE-FILES.
       EXIT-PROG.
       STOP-RUN.
           DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN.
           DESTROY LONIJ-SCREEN.
           PERFORM CLOSE-WINDOW UNTIL WINDOWS-OPEN = 0.
           EXIT PROGRAM.
