       IDENTIFICATION DIVISION.
       PROGRAM-ID.      CHBMMO.
       DATE-WRITTEN.    121489.
      *******************************************************
      *  DESC:  LOAN PROCESSING
      *  CALLED FROM: WI/MODBOR, WI/BWCREA, WI/CHBORR
      *
      *         WRITE A MEMO RECORD FOR THE CHANGE MADE TO
      *         THE BORROWER RECORD
      * REV:
      *  BLV 100797 MEMO CHANGE OF BW-CREDIT-SCORE
      *  BAH 021298 LNAME AND FNAME WERE MIXED UP IN THE DESCRIPTIONS
      *              OLD BORROWER LNAME : WAS FNAME
      *              OLD BORROWER FNAME : WAS LNAME
      *  GLF 110598 MADE 2000 COMPATIBLE
      *   CS 120798 ADDED CREDIT-LIMIT
      *  MG  990927 FIXED VDUSTATUS/IO-FG/STAT PER DEVELOPMENT MEETING.
      *  BAH 010627 ADDED BW-PRIVACY-OPT-OUT , TFC PR# 90
      *   CS 030117 ADDED BW-COUNTY, BW-CITY-TAX-CD [WORLD KY]
      *  BAH 090520 ADDED BW-CELL-PHONE, SUPPORT PR# 3368
      *  BAH 140407 CHANGED PRIVACY-OPT-OUT TO TEXT OPTION FOR WORLD PR#983
      *  BAH 141219 CREATE FORM REQUESTS FOR ADDRESS CHANGES FOR
      *              GP-I-AM-REGENCY ONLY, FOR A LETTER, PR#4668
      *  BAH 150218 CREATE MEMO FOR MISC PHONE CHANGES, UNITED PR#4700
      *
      *  KEC 2016.0216 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *                FIXED KEYS & RECS FOR FD-REC.
      *                CHANGED FMNO/FORMNO/NEXTFM/SETFM FROM 3 TO 4 BYTES.
      *  BAH 160217 SET BM-BRNO, PD0003
      *  BAH 160609 FIXED BUG - WASN'T MOVING BRANCH INTO FM-BRNO2 BEFORE
      *             READ-FM1, YOU COULD GET A "22" ON WRITE, REGENCY #4668
      *  BAH 170323 ACTIVATE 8 DIGIT DATES, PD0006
      *  BAH 180925 GLOBAL BMFILE
      *  BAH 190311 MOVED FM-BRNO2 INTO LPWSFM-EDIT-FM-INITKEY TO REMOVE THE
      *            REDEFINE IN THE FM-REC
      *  BAH 20220127 COMMENTED OUT GP-I-AM
      *  BAH 2024.1204 ADDED BW-CEASE-DESIST-DATE, BW-CEASE-DESIST-TYPE
      *                BW-UMC-EXPIRE-DATE, BW-UMC-PR-EXPIRE-DATE, AND 
      *                BW-DEALTRACK-CHG-DATE #1686 S35Q-145
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.

       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(41) VALUE
           "@(#)CL/CHBMMO.CBL A32 05/13/19-12:15:05 >".
      **************************************************
      *     P R O G R A M   W O R K E R S              *
      **************************************************
       COPY "LIBLP/LP01CH.CPY".
       COPY "LIBLP/LP01CH_SQL.CPY".
       COPY "LIBLP/LPWSCH.CPY".
       COPY "LIBLP/LP01BM.CPY".
       COPY "LIBLP/LP01BM_SQL.CPY".
       COPY "LIBLP/LPWSBM.CPY".
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".

       01  ERRCD               PIC X     VALUE SPACES.
       01  SAVE-BM1-KEY.
           03  SAVE-BM-BRNO    PIC 9(4).
           03  SAVE-BM-SSNO    PIC 9(9).
           03  SAVE-BM-DATE    PIC 9(8).
           03  SAVE-BM-SEQ     PIC 9(3).

       01  MEMO-AREA.
           03  FILLER          PIC X(5)  VALUE "OLD: ".
           03  MEMO-DESCRIPT   PIC X(20).
           03  FILLER          PIC X     VALUE " ".
           03  MEMO-ORG-CHAR   PIC X(24).
           03  FILLER          PIC X     VALUE " ".
           03  MEMO-USERID     PIC X(10).

       01  MISC-PHONE-HOLD.
           03  MISC-PHONE      PIC  ZZZ/ZZZ/ZZZZ.
           03  FILLER          PIC X VALUE SPACES.
           03  MISC-EXT        PIC  ZZZZ.
           03  FILLER          PIC X VALUE SPACES.
           03  MISC-CODE       PIC XX.

      * FOR BORROWER ADDRESS CHANGE LETTER REGENCY PR#4668
       01  MEMO-BLANK          PIC X(13) VALUE
           "---BLANK---".
       01  BORROWER-CHANGE-FG  PIC X VALUE " ".

       01  DESCRIPTION-TABLE.
           03  DESC-TAB.
               05 FILLER          PIC X(20) VALUE
               "BORROWER LAST NAME  ".
               05 FILLER          PIC X(20) VALUE
               "BORROWER FIRST NAME ".
               05 FILLER          PIC X(20) VALUE
               "ADDRESS 1           ".
               05 FILLER          PIC X(20) VALUE
               "ADDRESS 2           ".
               05 FILLER          PIC X(20) VALUE
               "CITY                ".
               05 FILLER          PIC X(20) VALUE
               "STATE               ".
               05 FILLER          PIC X(20) VALUE
               "PHONE               ".
               05 FILLER          PIC X(20) VALUE
               "CELL PHONE          ".
               05 FILLER          PIC X(20) VALUE
               "EMPLOYER'S NAME     ".
               05 FILLER          PIC X(20) VALUE
               "EMPLOYMENT POSITION ".
               05 FILLER          PIC X(20) VALUE
               "EMPLOYMENT PHONE NO.".
               05 FILLER          PIC X(20) VALUE
               "EMP PHONE EXTENSION ".
               05 FILLER          PIC X(20) VALUE
               "YEARS OF EMPLOYMENT ".
               05 FILLER          PIC X(20) VALUE
               "NET INCOME MONTHLY  ".
               05 FILLER          PIC X(20) VALUE
               "OTHER INCOME MONTHLY".
               05 FILLER          PIC X(20) VALUE
               "OTHER INCOME SOURCE ".
               05 FILLER          PIC X(20) VALUE
               "REFERENCE DATE      ".
               05 FILLER          PIC X(20) VALUE
               "AGE OR BIRTHDATE    ".
               05 FILLER          PIC X(20) VALUE
               "ORIGIN              ".
               05 FILLER          PIC X(20) VALUE
               "DEPENDENTS          ".
               05 FILLER          PIC X(20) VALUE
               "RENT OR OWN CODE    ".
               05 FILLER          PIC X(20) VALUE
               "TIME AT ADDRESS     ".
               05 FILLER          PIC X(20) VALUE
               "SOLICIT CODE        ".
               05 FILLER          PIC X(20) VALUE
               "CONFIDENTIAL        ".
               05 FILLER          PIC X(20) VALUE
               "SPOUSE'S LAST NAME  ".
               05 FILLER          PIC X(20) VALUE
               "SPOUSE'S FIRST NAME ".
               05 FILLER          PIC X(20) VALUE
               "SPOUSE'S SOC SEC NO.".
               05 FILLER          PIC X(20) VALUE
               "SPOUSE'S AGE/BIRTH  ".
               05 FILLER          PIC X(20) VALUE
               "CREDIT SCORE        ".
               05 FILLER          PIC X(20) VALUE
               "CREDIT LIMIT        ".
               05 FILLER          PIC X(20) VALUE
               "PRIVACY OPT OUT     ".
               05 FILLER          PIC X(20) VALUE
               "COUNTY CD           ".
               05 FILLER          PIC X(20) VALUE
               "CITY CD             ".

           03  FILLER REDEFINES DESC-TAB.
               05  D-TAB          PIC X(20) OCCURS 33 TIMES.


       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBGB/TIMEWK.CPY".

       COPY "LIBGB/GETFMW.CPY".
       COPY "LIBLP/LP01BW.CPY".
      * ORIGINAL RECORD
       COPY "LIBLP/LP01BW.CPY" REPLACING LEADING "BW" BY "ORG-BW".
       01  BRANCH               PIC 9(4).

      **************************************************
      *   C O N T R O L   M O D U L E                  *
      **************************************************
       PROCEDURE DIVISION
            USING FORM-PATHNAME BW-REC ORG-BW-REC BRANCH EXIT-PATHNAME.

      **************************************************
      *      P R O G R A M   C O N T R O L             *
      **************************************************
       MAIN-PROGRAM SECTION.

           PERFORM SQL-CONNECT.

      D    STOP MESS.
           MOVE FORM-PATHNAME TO FORM-PATH.

           PERFORM OPEN-BR-FILE.
           MOVE BRANCH TO BR-NO.
           PERFORM READ-BR-FILE.
           PERFORM CLOSE-BR-FILE.
           IF IO-BAD
              GO TO IO-ERROR.

           PERFORM UPDATE-CHANGES.

           GO TO END-ROUTINE.

      ***********************************
       UPDATE-CHANGES SECTION.
      ***********************************
           PERFORM GETDAT.

           PERFORM OPEN-CH-FILE.
           PERFORM OPEN-BM1-FILE.

           MOVE "N" TO BORROWER-CHANGE-FG.

           IF ORG-BW-LNAME NOT = BW-LNAME
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(1)     TO CH-DESCRIPT
              MOVE ORG-BW-LNAME TO CH-ORG-CHAR
              MOVE BW-LNAME     TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-FNAME NOT = BW-FNAME
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(2)     TO CH-DESCRIPT
              MOVE ORG-BW-FNAME TO CH-ORG-CHAR
              MOVE BW-FNAME     TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-MNAME NOT = BW-MNAME
              PERFORM CREATE-SETUP-REC
              MOVE "MIDDLE NAME" TO CH-DESCRIPT
              MOVE ORG-BW-MNAME  TO CH-ORG-CHAR
              MOVE BW-MNAME      TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-NICKNAME NOT = BW-NICKNAME
              PERFORM CREATE-SETUP-REC
              MOVE "NICKNAME"      TO CH-DESCRIPT
              MOVE ORG-BW-NICKNAME TO CH-ORG-CHAR
              MOVE BW-NICKNAME     TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-GENERATION NOT = BW-GENERATION
              PERFORM CREATE-SETUP-REC
              MOVE "GENERATION          " TO CH-DESCRIPT
              MOVE ORG-BW-GENERATION TO CH-ORG-CHAR
              MOVE BW-GENERATION TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-ADR1 NOT = BW-ADR1
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(3) TO CH-DESCRIPT
              MOVE ORG-BW-ADR1 TO CH-ORG-CHAR
              MOVE BW-ADR1 TO CH-NEW-CHAR
              MOVE "Y" TO BORROWER-CHANGE-FG
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-ADR2 NOT = BW-ADR2
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(4) TO CH-DESCRIPT
              MOVE ORG-BW-ADR2 TO CH-ORG-CHAR
              MOVE BW-ADR2 TO CH-NEW-CHAR
              MOVE "Y" TO BORROWER-CHANGE-FG
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CITY NOT = BW-CITY
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(5) TO CH-DESCRIPT
              MOVE ORG-BW-CITY TO CH-ORG-CHAR
              MOVE BW-CITY TO CH-NEW-CHAR
              MOVE "Y" TO BORROWER-CHANGE-FG
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-STATE NOT = BW-STATE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(6) TO CH-DESCRIPT
              MOVE ORG-BW-STATE TO CH-ORG-CHAR
              MOVE BW-STATE TO CH-NEW-CHAR
              MOVE "Y" TO BORROWER-CHANGE-FG
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-ZIP NOT = BW-ZIP
              PERFORM CREATE-SETUP-REC
              MOVE "ZIP" TO CH-DESCRIPT
              MOVE ORG-BW-ZIP TO CH-ORG-CHAR
              MOVE BW-ZIP TO CH-NEW-CHAR
              MOVE "Y" TO BORROWER-CHANGE-FG
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-REFDATE NOT = BW-REFDATE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(17) TO CH-DESCRIPT
              MOVE ORG-BW-REFDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY    TO CH-ORG-DATE
              MOVE BW-REFDATE     TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY    TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-BDATE NOT = BW-BDATE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(18) TO CH-DESCRIPT
              MOVE ORG-BW-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-PHONE NOT = BW-PHONE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(7) TO CH-DESCRIPT
              MOVE ORG-BW-PHONE TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-PHONE TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CELL-PHONE NOT = BW-CELL-PHONE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(8) TO CH-DESCRIPT
              IF ORG-BW-CELL-PHONE = 2020202020 OR 0202020202
                 MOVE 0 TO CH-ORG-PHONE
              ELSE
                 MOVE ORG-BW-CELL-PHONE TO CH-ORG-PHONE
              END-IF
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CELL-PHONE TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-NATIONALITY NOT = BW-NATIONALITY
              PERFORM CREATE-SETUP-REC
              MOVE "NATIONALITY         " TO CH-DESCRIPT
              MOVE ORG-BW-NATIONALITY TO CH-ORG-CHAR
              MOVE BW-NATIONALITY TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-GENDER NOT = BW-GENDER
              PERFORM CREATE-SETUP-REC
              MOVE "GENDER         " TO CH-DESCRIPT
              MOVE ORG-BW-GENDER TO CH-ORG-CHAR
              MOVE BW-GENDER TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-EMPLOYER NOT = BW-EMPLOYER
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(9) TO CH-DESCRIPT
              MOVE ORG-BW-EMPLOYER TO CH-ORG-CHAR
              MOVE BW-EMPLOYER TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPLPOS NOT = BW-EMPLPOS
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(10) TO CH-DESCRIPT
              MOVE ORG-BW-EMPLPOS TO CH-ORG-CHAR
              MOVE BW-EMPLPOS TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPPHONE NOT = BW-EMPPHONE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(11) TO CH-DESCRIPT
              MOVE ORG-BW-EMPPHONE TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-EMPPHONE TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPEXT NOT = BW-EMPEXT
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(12) TO CH-DESCRIPT
              MOVE ORG-BW-EMPEXT TO CH-ORG-PHONE
              MOVE BW-EMPEXT TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPYEARS NOT = BW-EMPYEARS
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(13) TO CH-DESCRIPT
              MOVE ORG-BW-EMPYEARS TO CH-ORG-NUM
              MOVE BW-EMPYEARS TO CH-NEW-NUM
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPPAY NOT = BW-EMPPAY
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(14) TO CH-DESCRIPT
              MOVE ORG-BW-EMPPAY TO CH-ORG-2DEC
              MOVE BW-EMPPAY TO CH-NEW-2DEC
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPPAYOT NOT = BW-EMPPAYOT
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(15) TO CH-DESCRIPT
              MOVE ORG-BW-EMPPAYOT TO CH-ORG-2DEC
              MOVE BW-EMPPAYOT TO CH-NEW-2DEC
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-EMPPAYSR NOT = BW-EMPPAYSR
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(16) TO CH-DESCRIPT
              MOVE ORG-BW-EMPPAYSR TO CH-ORG-CHAR
              MOVE BW-EMPPAYSR TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-ORIGIN NOT = BW-ORIGIN
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(19) TO CH-DESCRIPT
              MOVE ORG-BW-ORIGIN TO CH-ORG-CHAR
              MOVE BW-ORIGIN TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-DEPEND NOT = BW-DEPEND
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(20) TO CH-DESCRIPT
              MOVE ORG-BW-DEPEND TO CH-ORG-NUM
              MOVE BW-DEPEND TO CH-NEW-NUM
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-RENTCD NOT = BW-RENTCD
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(21) TO CH-DESCRIPT
              MOVE ORG-BW-RENTCD TO CH-ORG-CHAR
              MOVE BW-RENTCD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-TIMEADDR NOT = BW-TIMEADDR
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(22) TO CH-DESCRIPT
              MOVE ORG-BW-TIMEADDR TO CH-ORG-CHAR
              MOVE BW-TIMEADDR TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-SOLICIT NOT = BW-SOLICIT
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(23) TO CH-DESCRIPT
              MOVE ORG-BW-SOLICIT TO CH-ORG-CHAR
              MOVE BW-SOLICIT TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONFIDENTIAL NOT = BW-CONFIDENTIAL
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(24) TO CH-DESCRIPT
              MOVE ORG-BW-CONFIDENTIAL TO CH-ORG-CHAR
              MOVE BW-CONFIDENTIAL TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-SPLNAME NOT = BW-SPLNAME
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(25) TO CH-DESCRIPT
              MOVE ORG-BW-SPLNAME TO CH-ORG-CHAR
              MOVE BW-SPLNAME TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-SPFNAME NOT = BW-SPFNAME
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(26) TO CH-DESCRIPT
              MOVE ORG-BW-SPFNAME TO CH-ORG-CHAR
              MOVE BW-SPFNAME TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-SPSSNO NOT = BW-SPSSNO
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(27) TO CH-DESCRIPT
              MOVE ORG-BW-SPSSNO TO CH-ORG-SSNO
              INSPECT CH-ORG-SSNO REPLACING ALL "/" BY "-"
              MOVE BW-SPSSNO TO CH-NEW-SSNO
              INSPECT CH-NEW-SSNO REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-SP-BDATE NOT = BW-SP-BDATE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(28) TO CH-DESCRIPT
              MOVE ORG-BW-SP-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-SP-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CREDIT-SCORE NOT = BW-CREDIT-SCORE
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(29) TO CH-DESCRIPT
              MOVE ORG-BW-CREDIT-SCORE TO CH-ORG-NUM
              MOVE BW-CREDIT-SCORE TO CH-NEW-NUM
              PERFORM UPDATE-CH-BM-FILE.
            IF ORG-BW-CREDIT-LIMIT NOT = BW-CREDIT-LIMIT
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(30) TO CH-DESCRIPT
              MOVE ORG-BW-CREDIT-LIMIT TO CH-ORG-NUM
              MOVE BW-CREDIT-LIMIT TO CH-NEW-NUM
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-PRIVACY-OPT-OUT NOT = BW-PRIVACY-OPT-OUT
              PERFORM CREATE-SETUP-REC
              MOVE ORG-BW-PRIVACY-OPT-OUT TO CH-ORG-CHAR
              MOVE BW-PRIVACY-OPT-OUT TO CH-NEW-CHAR
      *       IF GP-I-AM-WORLD
                 MOVE "TEXT OPTION" TO CH-DESCRIPT
      *       ELSE
      *          MOVE D-TAB(31) TO CH-DESCRIPT
      *       END-IF
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-COUNTY NOT = BW-COUNTY
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(32) TO CH-DESCRIPT
              MOVE ORG-BW-COUNTY TO CH-ORG-CHAR
              MOVE BW-COUNTY TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CITY-TAX-CD NOT = BW-CITY-TAX-CD
              PERFORM CREATE-SETUP-REC
              MOVE D-TAB(33) TO CH-DESCRIPT
              MOVE ORG-BW-CITY-TAX-CD TO CH-ORG-CHAR
              MOVE BW-CITY-TAX-CD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(1) NOT = BW-MISC-PHONE(1)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 1 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(1) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(1)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(1) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(1) TO MISC-PHONE
              MOVE BW-MISC-EXT(1)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(1) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(2) NOT = BW-MISC-PHONE(2)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 2 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(2) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(2)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(2) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(2) TO MISC-PHONE
              MOVE BW-MISC-EXT(2)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(2) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(3) NOT = BW-MISC-PHONE(3)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 3 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(3) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(3)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(3) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(3) TO MISC-PHONE
              MOVE BW-MISC-EXT(3)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(3) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(4) NOT = BW-MISC-PHONE(4)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 4 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(4) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(4)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(4) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(4) TO MISC-PHONE
              MOVE BW-MISC-EXT(4)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(4) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(5) NOT = BW-MISC-PHONE(5)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 5 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(5) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(5)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(5) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(5) TO MISC-PHONE
              MOVE BW-MISC-EXT(5)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(5) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-MISC-PHONE(6) NOT = BW-MISC-PHONE(6)
              PERFORM CREATE-SETUP-REC
              MOVE "MISC PHONE 6 " TO CH-DESCRIPT
              MOVE ORG-BW-MISC-PHONE(6) TO MISC-PHONE
              MOVE ORG-BW-MISC-EXT(6)   TO MISC-EXT
              MOVE ORG-BW-MISC-PHONE-CD(6) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-ORG-CHAR
              MOVE BW-MISC-PHONE(6) TO MISC-PHONE
              MOVE BW-MISC-EXT(6)   TO MISC-EXT
              MOVE BW-MISC-PHONE-CD(6) TO MISC-CODE
              INSPECT MISC-PHONE REPLACING ALL "/" BY "-"
              MOVE MISC-PHONE-HOLD TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-EMAIL NOT = BW-EMAIL
              PERFORM CREATE-SETUP-REC
              MOVE "EMAIL               " TO CH-DESCRIPT
              MOVE ORG-BW-EMAIL TO CH-ORG-CHAR
              MOVE BW-EMAIL TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

      * CONTACT TABLE OF 10
           IF ORG-BW-CONTACT-DESC(1) NOT = BW-CONTACT-DESC(1)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  1    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(1) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(1) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(1) NOT = BW-CONTACT-PHONE(1)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  1    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(1) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(1)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(1) NOT = BW-CONTACT-EXT(1)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 1 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(1)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(1)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(2) NOT = BW-CONTACT-DESC(2)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  2    "  TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(2) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(2)     TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(2) NOT = BW-CONTACT-PHONE(2)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  2    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(2) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(2)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(2) NOT = BW-CONTACT-EXT(2)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 2 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(2)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(2)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(3) NOT = BW-CONTACT-DESC(3)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  3    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(3) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(3) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(3) NOT = BW-CONTACT-PHONE(3)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  3    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(3) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(3)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(3) NOT = BW-CONTACT-EXT(3)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 3 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(3)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(3)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(4) NOT = BW-CONTACT-DESC(4)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  4    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(4) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(4) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(4) NOT = BW-CONTACT-PHONE(4)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  4    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(4) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(4)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(4) NOT = BW-CONTACT-EXT(4)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 4 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(4)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(4)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(5) NOT = BW-CONTACT-DESC(5)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  5    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(5) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(5) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(5) NOT = BW-CONTACT-PHONE(5)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  5    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(5) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(5)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(5) NOT = BW-CONTACT-EXT(5)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 5 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(5)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(5)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(6) NOT = BW-CONTACT-DESC(6)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  6    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(6) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(6) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(6) NOT = BW-CONTACT-PHONE(6)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  6    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(6) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(6)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(6) NOT = BW-CONTACT-EXT(6)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 6 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(6)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(6)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(7) NOT = BW-CONTACT-DESC(7)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  7    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(7) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(7) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(7) NOT = BW-CONTACT-PHONE(7)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  7    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(7) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(7)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(7) NOT = BW-CONTACT-EXT(7)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 7 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(7)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(7)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(8) NOT = BW-CONTACT-DESC(8)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  8    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(8) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(8) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(8) NOT = BW-CONTACT-PHONE(8)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  8    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(8) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(8)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(8) NOT = BW-CONTACT-EXT(8)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 8 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(8)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(8)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(9) NOT = BW-CONTACT-DESC(9)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  9    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(9) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(9) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(9) NOT = BW-CONTACT-PHONE(9)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  9    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(9) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(9)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(9) NOT = BW-CONTACT-EXT(9)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 9 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(9)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(9)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CONTACT-DESC(10) NOT = BW-CONTACT-DESC(10)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT DESC  10    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-DESC(10) TO CH-ORG-CHAR
              MOVE BW-CONTACT-DESC(10) TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-PHONE(10) NOT = BW-CONTACT-PHONE(10)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE  10    " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-PHONE(10) TO CH-ORG-PHONE
              INSPECT CH-ORG-PHONE REPLACING ALL "/" BY "-"
              MOVE BW-CONTACT-PHONE(10)     TO CH-NEW-PHONE
              INSPECT CH-NEW-PHONE REPLACING ALL "/" BY "-"
              PERFORM UPDATE-CH-BM-FILE.
           IF ORG-BW-CONTACT-EXT(10) NOT = BW-CONTACT-EXT(10)
              PERFORM CREATE-SETUP-REC
              MOVE "CONTACT PHONE EXT 10 " TO CH-DESCRIPT
              MOVE ORG-BW-CONTACT-EXT(10)  TO CH-ORG-PHONE
              MOVE BW-CONTACT-EXT(10)      TO CH-NEW-PHONE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-DEALTRACK-CHG-DATE NOT = BW-DEALTRACK-CHG-DATE
              PERFORM CREATE-SETUP-REC
              MOVE "DEALTRACK DATE"  TO CH-DESCRIPT
              MOVE ORG-BW-DEALTRACK-CHG-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-DEALTRACK-CHG-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-UMC-EXPIRE-DATE NOT = BW-UMC-EXPIRE-DATE
              PERFORM CREATE-SETUP-REC
              MOVE "UMC EXPIRE DATE"  TO CH-DESCRIPT
              MOVE ORG-BW-UMC-EXPIRE-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-UMC-EXPIRE-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-UMC-PR-EXPIRE-DATE NOT = BW-UMC-PR-EXPIRE-DATE
              PERFORM CREATE-SETUP-REC
              MOVE "UMC PR EXPIRE "  TO CH-DESCRIPT
              MOVE ORG-BW-UMC-PR-EXPIRE-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-UMC-PR-EXPIRE-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CEASE-DESIST-DATE NOT = BW-CEASE-DESIST-DATE
              PERFORM CREATE-SETUP-REC
              MOVE "CEASE & DESIST DATE"  TO CH-DESCRIPT
              MOVE ORG-BW-CEASE-DESIST-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-ORG-DATE
              MOVE BW-CEASE-DESIST-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYY
              MOVE DATE-MMDDYY TO CH-NEW-DATE
              PERFORM UPDATE-CH-BM-FILE.

           IF ORG-BW-CEASE-DESIST-TYPE NOT = BW-CEASE-DESIST-TYPE
              PERFORM CREATE-SETUP-REC
              MOVE "CEASE & DESIST TYPE"  TO CH-DESCRIPT
              MOVE ORG-BW-CEASE-DESIST-TYPE TO CH-ORG-CHAR
              MOVE BW-CEASE-DESIST-TYPE TO CH-NEW-CHAR
              PERFORM UPDATE-CH-BM-FILE.

           PERFORM CLOSE-CH-FILE.
           PERFORM CLOSE-BM1-FILE.
           GO TO EXIT-CREATE-CHANGE-REC.

       CREATE-SETUP-REC.
           PERFORM CLEAR-CH-FILE.

           MOVE BW-OWNBR           TO CH-BRNO.
           MOVE SYS-DATE           TO CH-DATE.
           MOVE "M"                TO CH-CODE.
           MOVE EXT-CONAME-USER-ID TO CH-USERID.
           PERFORM GET-TIME.
           MOVE HH-MM-SS           TO CH-TIME.
           MOVE 1                  TO CH-SEQ.

           MOVE BW-SSNO            TO CH-SSNO.

       EXIT-CREATE-CHANGE-REC.
           EXIT.

      ****************************************
       UPDATE-CH-BM-FILE SECTION.
      ****************************************
       UPDATE-CH-AGAIN.
           PERFORM WRITE-CH-FILE.
           IF IO-FG NOT = 0
              IF CH-SEQ < 999
                 ADD 1 TO CH-SEQ
                 GO TO UPDATE-CH-AGAIN.

           IF BR-CHANGE-MEMO NOT = "Y"
              GO TO UPDATE-CH-BM-FILE-EXIT.

           MOVE BM-PATH-OWNBR TO SAVE-BM-BRNO.
           MOVE CH-SSNO       TO SAVE-BM-SSNO.
           COMPUTE SAVE-BM-DATE = 99999999 - SYS-DATE.
           MOVE 1             TO SAVE-BM-SEQ.

       UPDATE-CH-BM-FILE-AGAIN.

           MOVE SPACES TO BM-REC.

           MOVE SAVE-BM1-KEY  TO BM1-KEY.

           MOVE CH-USERID   TO MEMO-USERID.
           MOVE CH-DESCRIPT TO MEMO-DESCRIPT.
           MOVE CH-ORG-CHAR TO MEMO-ORG-CHAR.
      * FOR BORROWER CHANGE LETTER REGENCY PR#4668
           IF MEMO-ORG-CHAR = SPACES
              MOVE MEMO-BLANK TO MEMO-ORG-CHAR.
           MOVE MEMO-AREA TO BM-MEMO.

           MOVE "9 " TO BM-MEMO-TYPE.
           PERFORM WRITE-BM1-FILE.
           IF IO-BAD
              IF SAVE-BM-SEQ < 999
                 ADD 1 TO SAVE-BM-SEQ
                 GO TO UPDATE-CH-BM-FILE-AGAIN.

       UPDATE-CH-BM-FILE-EXIT.
           EXIT.

       COPY "LIBGB/DATER.CPY".
       COPY "LIBGB/TIMEIO.CPY".
       COPY "LIBLP/LPCHCL.CPY".


      **********************
       MISC-ROUTINES SECTION.
      **********************
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/GETDAT.CPY".

      ********************************************
       IO-ROUTINES SECTION.
      ********************************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBGB/DECLARE_SQL.CPY".
           PERFORM CLOSE-CH-FILE.
           PERFORM CLOSE-BM1-FILE.
           PERFORM CLOSE-BR-FILE.
       COPY "LIBLP/LPCHGS_SQL.CPY".
       COPY "LIBLP/LPBMGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBLP/LPBM1IN.CPY".
       COPY "LIBLP/LPCHIN.CPY".
       COPY "LIBGB/GBBRRN.CPY".

       COPY "LIBGB/FERRORS.CPY".
       END-ROUTINE.
           PERFORM CLOSE-FILES.
       EXIT-PROG.
       STOP-RUN.
           EXIT PROGRAM.
