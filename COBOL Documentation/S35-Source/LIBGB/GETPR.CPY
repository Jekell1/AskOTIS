      *********************************************************
      *A30 CONVERSION  STARTED
      *   GETPR - PRINTER CONTROL ROUTINES
      *
      *   MOVE PROG NAME TO FORM-PROG IF DIFFERENT THAN DEFAULT.
      *                                       (MUST BE 6 BYTES).
      *   MOVE SPOOL DIRECTORY TO PRU-DIR, IF DIFFERENT THAN DEFAULT.
      *   PERFORM PRU-IN.  STAT = "00" INDICATES PRINTER WAS RESERVED.
      *   OPEN PRINT FILE AND EXECUTE PROGRAM.
      *   CLOSE PRINT FILE.
      *   IF RELEASING PRINTER RESERVATION!!
      *      PERFORM PRU-OUT
      *   ELSE
      *      PERFORM PRU-RESET TO RESET TERMINAL MODE!!
      *
      *   QUEUE Y/N MAY BE FORCED BY SETTING 'STAT':
      *     N - DIRECT OR PIGGYBACK ONLY
      *     D - DIRECT ONLY
      *     P - PIGGYBACK ONLY
      *     Y - SPOOL ONLY
      *     T - TERMINAL ONLY
      *     U - WON'T ALLOW "N" IN QUEUE, SO ONLY VIEW OR SPOOL
      *     * - ANY PRINT OPTION (* = DEFAULT, NOT ASTERISK)
      *
      *   ON ENTRY, QUEUE OPTIONS ARE SELECTED AS FOLLOWS:
      *   DESCRIPTION     QUEUE Y/N:     PRINTER#:
      *   -----------     ----------     ---------
      *   QUEUE PRINT     Y              1-99
      *   DIRECT PRINT    N              1-99
      *   TERMINAL        T              0-99
      *   PIGGYBACK       N              0
      *
      * REV:
      *  JTG 110790 PUT STOP ON PRUOUT IF TERMINAL PRINT
      *             TO KEEP CTRL 'S' FROM LOCKING TERMINAL
      *  BLV 020408 MOVE SPAES TO PRU-FILE BEFORE CALLING TSTPRU; THIS
      *             WILL HOPEFULLY FIX THE PROBLEMS WHEN YOU F1 OR UP
      *             ARROW BACK TO PRINTER FIELD & SPOOL FILE GETS LONG
      *             & GARBLED, FOR EX. LNAGEDALNAGEDA0001XX
      *  BAH 060113 REMOVED PRU-IN-NO-READ GB/LCKPRU.
      *  MJD 121023 DO NOT OPEN/CLOSE POP-UP WINDOWS - A30
      *********************************************************
       PRU-IN.
      *    DISPLAY WINDOW POP-UP AREA IS PRU-POP-UP-WINDOW.
      *  PERFORMED WHEREVER PRINTER FIELD IS READ
      *  SETS LOCK ON PRINTER IF DIRECT PRINT
           MOVE SPACES TO PRU-FILE.
           IF FORM-PROG = SPACES
              MOVE FORM-PROGX TO FORM-PROG.
           MOVE FORM-DIRX TO P-CALLING-DIR.
           MOVE FORM-PROG TO PRU-PROG P-CALLING-PROG.
           MOVE "GB/TSTPRU" TO FORM-NAM.
           CALL FORM-PROGX USING STAT PRU-PATH FORM-PATH PRU-LINK.
           CANCEL FORM-PROGX.
      *    CLOSE WINDOW PRU-POP-UP-WINDOW.


       PRU-PREP.
      *  PERFORMED INSIDE OF OPEN-PR-FILE
           MOVE "GB/PREPRU" TO FORM-NAM.
           CALL FORM-PROGX USING STAT PRU-PATH FORM-PATH PRU-LINK.
           CANCEL FORM-PROGX.

       PRU-RESET.
      *    DISPLAY WINDOW POP-UP AREA IS PRU-POP-UP-WINDOW.
      *  PERFORMED AT END-PROG
      *  RESETS TERMINAL SETUP IF TERMINAL PRINT OR AUXILIARY
      *  BUT DOES NOT REMOVE LOCK
      * HAD TO ADD THE 'IF' TO CATCH SECURITY VIOLATIONS
           IF FORM-OBJ NOT = "3S" AND NOT = "3O" AND NOT = "3Z"
              MOVE "GB/POSPRU" TO FORM-NAM
              CALL FORM-PROGX USING STAT PRU-PATH FORM-PATH PRU-LINK
              CANCEL FORM-PROGX.
      *    CLOSE WINDOW PRU-POP-UP-WINDOW.

       PRU-OUT.
      *    DISPLAY WINDOW POP-UP AREA IS PRU-POP-UP-WINDOW.
      *  PERFORMED AT END-PROG
      *  REMOVES LOCK ON PRINTER IF DIRECT PRINT
      * HAD TO ADD THE 'IF' TO CATCH SECURITY VIOLATIONS
           IF FORM-OBJ NOT = "3S" AND NOT = "3O" AND NOT = "3Z"
              MOVE "GB/QUEPRU" TO FORM-NAM
              CALL FORM-PROGX USING STAT PRU-PATH FORM-PATH PRU-LINK
              END-CALL
              CANCEL FORM-PROGX.
      *    CLOSE WINDOW PRU-POP-UP-WINDOW.
