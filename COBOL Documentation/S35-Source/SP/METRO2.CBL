       IDENTIFICATION DIVISION.
       PROGRAM-ID.      METRO2.
       DATE-WRITTEN.   7/15/03.
      ***************************************************************
      *   CREATE FILE FOR CREDIT BUREAU REPORTING IN METRO 2 FORMAT
      ***************************************************************
      ***************************************************************
      * * * * *  EOM MUST BE RUN FIRST, THIS PERFORMS A VERIFY * * * * * *
      *           CHECKING FOR THE EOM TAG BASED UPON ENDING DATE
      ***************************************************************
      * RSZ 1364 WITHOUT .E
      * RSZ 1366 FOR EMAIL WITH .E
      *
      *       STANDARD 426 CHARACTER RECORD LAYOUT
      *
      *
      *  ../../ED/METRO2              TRANSMIT "N", INTERIM "N", NOT WORLD
      *  ../../ED/METRO2.BBBB         TRANSMIT "N", INTERIM "N", WORLD
      *
      *  ../../ED/METRO2.E.YYMMDD     TRANSMIT "N", INTERIM "Y", NOT WORLD
      *  ../../ED/METRO2.YYMMDD       TRANSMIT "N", INTERIM "Y", WORLD
      *
      *  ../../ED/METRO2.E            TRANSMIT "Y", INTERIM "N", ALL
      *  ../../ED/METRO2.E.YYMMDD     TRANSMIT "Y", INTERIM "Y", ALL
      *
      *
      * REV:
      *  031210 BAH SECURITY, MN EQUIFAX NEEDED ACCOUNT NUMBER RIGHT JUST
      *             NUMERIC, BUT MIDA, MD ALREADY REPORTED AS LEFT JUST
      *             ZERO PADDED, SO I LEFT MIDA ALONE AND CHANGED THE
      *             PROGRAM TO RIGHT JUST, ZERO FILL NUMERIC THE ACCOUNT NO.
      *  040112 BAH J2 SEGMENT DID NOT HAVE ADDRESS FILLED IN ...
      *  040219 BAH SPLIT OUT MIDDLE NAME, PR# 2252
      *  040305 BAH ADDED LT-B-WHO-FILED FOR WHO DECLARED BANKRUPTCY,
      *             REGACC PR# 51
      *  040428 BAH ADDED TRW-INFO-BRNO-ACCTNO TO INCLUDE THE BRNO IN FRONT
      *             OF THE ACCTNO TO PREVENT DUPS IN MULTIPLE BRANCH
      *             COMPANIES, EXPERIAN/SOAUTO
      *  040506 BAH INVALID COLLATERAL CODE WAS MOVING "31", WHICH WAS
      *             INVALID, PAYMENT RATING HAD '9'S, ALSO INVALID. SOAUTO
      *  040617 BAH IF TRW-INFO-IDENT-BRNO = "Y", MOVE BRNO TO FIELD 5,
      *             IDENTIFICATION NUMBER, INSTEAD OF CREDITOR GRANTOR ID.
      *             LENDMARK PR# 2328
      *  BAH 040617 MAKE POCD "BT" STATUS "DA", TO HAVE THEM PURGED AT THE
      *             BUREAU, REGACC PR# 64  FOR GP-I-AM-REGACC ONLY !!
      *  BAH 040721 ECOA CODE NOT SET PROPERLY IN THE J1 AND J2 SEGMENT FOR
      *             COMAKERS, USING THE WRONG SUBSCRIPT, WAS ALWAYS MOVING
      *             A 3....
      *  BAH 040804 IF RUNNING FOR A CREDIT-BUREAU-ID OTHER THAN 1, IT WILL
      *             PUT THE ID ON THE END OF THE OUTPUT FILE, METRO2.2 ETC.
      *             LENDMARK HAS TO CREATE 2 SEPARATE FILES CAUSE EXPERIAN
      *             DOESNT LIKE THE PR# 2328 ABOVE WE DID FOR EQUIFAX.
      *  BAH 041004 ONLY REPORT THE NET PAYOFF BALANCE ON REAL ESTATE ACCOUNTS
      *              LENDMARK
      *  BAH 041013 DONT REPORT ECOA OF "3" OR "7" IN THE SUBSCRIBER RECORD
      *  BAH 041027 THESE CHANGES ARE ONLY FOR GP-I-AM-MODERN; PR# 2389
      *               SKIP BRANCH 3 ACCOUNTS WITH DEALER NO. > 9900.00
      *               CREATE K1 SEGMENTS FOR ALL BRANCH 3 ACCOUNTS
      *               SET FIELD 9 ACCOUNT TYPE TO "0C" (ZERO C) FOR BRANCH 3
      *  BAH 041119 REMOVED THE FOLLOWING CHANGE THAT WAS PUT IN ON 11/04/04;
      *               FOR LENDMARK ONLY, ALWAYS MOVE LN-CURBAL TO TRW-B-CURBAL
      *               NOT JUST FOR NON REAL ESTATE LIKE THE BOOK SAYS...PR# 2412
      *              LENDMARK PR# 2424
      *             THIS CHANGE WAS ONLY IN PLACE FROM 11/04/04 UNTIL 11/19/04
      *  BAH 041203 SPLIT OUT FIRST NAME AND MIDDLE NAME IN THE J1 AND J2
      *             SEGMENTS, REGWAN
      *  BAH 041222 AUTOMATICALLY FIX THE OLD STATUS OF "68" TO A COMMENT
      *             OF "AU",
      *  BAH 050119 FIELD 16, ACTUAL PAYMENT AMOUNT, SHOULD BE LP-TRAMT,
      *             NOT LP-APCUR.  RICHARD/LENDMARK
      *  BAH 050202 ADDED TEST FOR BANKRUPT DISMISSAL, LN-BNKRPT-DISMISS-DATE
      *             SECURITY AUTO PL# 461
      *  BAH 050216 AUTOMATICALLY FIX OLD STATUS OF 98 TO BE REAL STATUS
      *             AND A CONSUMER IND OF "T", AND OLD STATUS OF 85 TO BE
      *             REAL STATUS AND CONSUMER IND OF "U"....ACCPFS
      *             DATE OF ACCOUNT INFO (FIELD 24), USED TO BE BILLDATE
      *             PAIDOUTS NEED TO SEND PAID OUT DATE.
      *  BAH 050329 TRANSFERRING P&L ACCOUNTS NEED A "05" IN STATUS, NOT "64",
      *             SOAUTO PR# 2491
      *  BAH 050331 ADDED LN-TRW-B-CONSUMER-IND AND LN-TRW-J-CONSUMER-IND FOR
      *             ACC , PR# 2502
      *  BAH 050401 MOVED THE TRWINFO FILE FROM GLOBAL SP TO GLOBAL GB
      *  BAH 050427 ADDED TRW-YEARS-STOP-REPORTING TO TEST DOFD AND STOP
      *            REPORTING IF MORE YEARS THAN THIS, ACC PR# 2517
      *  BAH 050518 TRW-B-BILL-DATE WAS MMDDYY IF A PAYOFF, WRONG FORMAT...
      *  BAH 050601 RENAMED LN-TRW-1ST-30 TO LN-TRW-DOFD-DATE, DATE OF FIRST
      *             DELINQUENCY
      *  BAH 050601 IF REPO OR P&L, LN-TRW-DOFD-DATE CAN NOT BE 0, KEVIN PR# 2540
      *  BAH 050610 REGACC WANTS TRW-B-CURBAL TO ALWAYS BE NET PAYOFF
      *  BAH 050713 ADDED TWSCAN FOR THE TRW-INFO-FILE
      *  BAH 050928 ADDED LN-TRW-COMPLIANCE-CODE, LIBERAL PR# 2591
      *  BAH 051107 PR# 2540, WAS SETTING LN-TRW-DOFD-DATE BUT NOT THE DATE OF
      *             FIRST DELINQ IN THE METRO2 FILE !! DUH...
      *             PR# 2636 MODERN IF OWNBR 3, USE PURDATE FOR DATE OPENED
      *                      AND LOANDATE FOR DOFD
      *  BAH 051108 TEST NEW LT-B-ENDORSER-FILED FIELD FOR THE CONSUMER
      *              INDICATOR IN THE J1 AND J2 SEGMENT, MULLEN PR# 2645
      *  BAH 051115 IF LN-POCD = "BT", ONLY REPORT FOR 2 MONTHS FROM POFFDATE
      *             REGACC SAYS IT PREVENTS THE ACCOUNT FROM BEING REPORTED IN
      *             THE NEW BRANCH (DOUBLE REPORTING)...REGACC PR# 116
      *  BAH 060116 MODERN CREATES K1, USED TO ONLY TAKE LN-MESSAGE UP UNTIL
      *             FIRST SPACE, NOW THEY WANT THE ENTIRE LN-MESSAGE MOVED
      *             IN FOR CREDITOR NAME, MODERN PR# 2683
      *  BAH 060203 BIRTHDATE WAS GETTING 2043 AND 2042, CAN NOT PERFORM
      *             MMMDDYY-TO-MMDDYYYY, USED 50 AS CUTOFF DATE
      *  BAH 060222 IF LN-PURDATE IS 0, GET FIRST PAYMENT RECORD BALANCE
      *             FORWARD DATE AND USE AS DATE OPENED FOR THESE BRANCH
      *             3 MODERN FINANCE ACCOUNTS PR# 2715
      *  BAH 060223 ECOA IN J1 AND J2 WILL ALWAYS BE A "2", ALL OTHER SIGNERS
      *             WHETHER ENDORSERS OR JOINT, HAVE RESPONSIBILITY AND MUST
      *             BE FLAGGED AS "2". THE "3" WAS ONLY VALID FOR CREDIT CARD
      *             AUTHORIZED USERS WITHOUT ANY LEGAL RESPONSIBILITY
      *             MODERN PR# 2723
      *  BAH 060314 MODERN, BRANCH 3 ACCOUNTS, REPORT DOFD AS BALANCE FORWARD
      *             PAYMENT DATE, MODERN PR# 2740
      *  BAH 060428 MODERN, REMOVE CHANGE ABOVE, THEY MANUALLY FIXED ALL THE
      *             DOFD DATES, MODERN PR# 2776
      *  BAH 061030 ADDED "26" TO BE REAL-ESTATE FROM CD-TRW, LENDMARK PR#2863
      *  BAH 061030 NOW REPORT THE NET PAYOFF BALANCE ON ALL ACCOUNTS, NOT JUST
      *             REAL ESTATE, LENDMARK PR# 2860
      *  BAH 061030 REPORT AMOUNT FINANCED FOR ALL LOANS FOR FIELD 12, HIGH
      *             CREDIT OR ORIG LOAN AMOUNT, LENDMARK PR# 2862
      *  BAH 070103 RICHARD NOW WANTS ALL IB ACCOUNTS TO REPORT CURBAL AND
      *             ONLY PC REPORT NET PAYOFF BALANCE, LENDMARK PR# 2891
      *  BAH 080117 MAKE POCD "BT" STATUS "DA", TO HAVE THEM PURGED AT THE
      *             BUREAU(LIKE REGACC), MULL PR# 3140
      *  BAH 080411 ALL ACCOUNTS CODED AS BANKRUPT, REGARDLESS OF CHAPTER,
      *             SHOULD HAVE 0 IN CURBAL AND PAST DUE, WORLD PR# 579
      *  BAH 080911 CHECK LN-PROMDATE2 FOR BACKDATED PAIDOUTS, WORLD PR# 596
      *  BAH 080916 EXPAND TRW-KEY FROM 9(6) TO 9(9) FOR WORLD
      *  BAH 090827 ADDED CHECK FOR BR-SKIP-MIDSTREAM-TRW FLAG TO SKIP
      *             MIDSTREAM ACCOUNTS BOARDED SAME MONTH AND FOLLOWING MONTH
      *             REGACC PR# 253
      *  BAH 091116 ADDED LN-POCD 96 TO BE MOVED TO TRW-SB-STATUS FOR
      *             WHITESTONE PL# 668
      *  BAH 100920 ADDED MISC CHANGES FOR REVOLVING ACCOUNTS, REGENCY PR#3655
      *  BAH 110104 CHANGED ECOA FOR JOINT AND ENDORSERS, MIDWEST PR# 3706
      *  BAH 110929 BANKRUPT DISMISSALS CHAPTER 11,12, AND 13 WERE CHECKING
      *             LOAN RECORD BK CHAPTER INSTEAD OF LT TRAILER BK CHAPTER
      *             IN ERROR, LOAN GETS CLEARED ON A "BD", ONLY CHAPTER 7 WAS
      *             CORRECT. WORLD PR# 772
      *   CS 120113 CHANGED AMOUNT FIELD TO 9(10), WORLD HAS REACHED A BILLION
      *                                               WORLD PR#783
      *  BAH 120717 ADD ECOA OF "T" TO TERMINATE A NON-FILER ASSOCIATION TO
      *             A CHAPTER 13 BANKRUPT, GP-I-AM-REGACC ONLY PR# 313
      *  BAH 140114 WORLD HAD A BAD CAN LOAN SITUATION WITH GARBAGE IN
      *             DISMISSAL DATE WHICH SOMEHOW REPORTED AS "I", SAFE
      *             GUARD THAT FROM HAPPENING AGAIN! WORLD PR# 958
      *  KEC 140804 {PR#04590} UNITED <A15> [JUDY]
      *             FOR JUST UNITED, MOVE SPACES TO TRW-N1-EMP-NAME.
      *  BAH 140822 CHECK VOLUNTARY/INVOLUNTARY FLAG IN TRAILER AND SET
      *             STATUS "95" IF "V", REGACC PR# 358, UNITED PR# 4605
      *  BAH 140825 FOR VOLUNTARY REPO REDEEMED, SPECIAL COMMENT SHOULD BE
      *             "AO" AND "AZ" IS FOR INVOLUNTARY
      *             ONLY CHANGE THE PAYMENT HISTORY PROFILE FOR THE MONTHS
      *             THE ACCOUNT WAS IN ACTIVE REPO, AND "J" IS VOLUNTARY, 
      *             WHILE "K" IS INVOLUNTARY BASED ON TRAILER FLAG, PR# 4608
      *  BAH 150402 CUSTOM CODE FOR SOLD ACCOUNTS AT WORLD, CREATE K2
      *             SEGMENTS AND ZERO OUT SOME FIELDS, WORLD  PR# 1065
      *  BAH 150413 IF LN-TRW-DOFD-DATE IS ZERO AND THE ACCOUNT IS BANKRUPT,
      *             SET DOFD TO BANKRUPT DATE, WORLD PR#1069 SOAUTO PR#4733
      *  BAH 150424 MAKE CUSTOM CODE FROM PR#1065 MORE GENERIC SO IT CAN
      *             IDENTIFY SALES FROM OTHER MONTHS, WORLD PR# 1074
      *  BAH 150429 CREATE K2 FOR BUYBACK FROM DEBT SALE, WORLD PR# 1076
      *  BAH 150715 ADD GP-I-AM-WDT TO MOVE 0 TO CURBAL AND PASTDUE IF
      *             BANKRUPT, WDT PR# 4795
      *  BAH 150911 CHARGE-OFF REPORTING FOR 2 MONTHS, REGMGM PR# 4798
      *  BAH 150930 TEST ENDORSER FOR BNKRPT CHAPTER 13 ECOA, REGACC PR#377
      *  BAH 151007 REMOVED ABOVE CHANGE, PUT BACK METRO2.150930 REGACC PR#377
      *  BAH 151008 CHECK FOR LT-B-ENDORSER-FILED FOR REGACC, PR#377
      *  BAH 151208 MAKE POCD "BT" STATUS "DA", TO HAVE THEM PURGED AT THE
      *             BUREAU, GP-I-AM-BARNETT, PR#4914
      *  BAH 160111 J1 AND J2 SEGMENTS SETTING BIRTHDATE WRONG, MISSED
      *             THEM WHEN I FIXED PRIMARY BIRTHDATE, PL# 916 UNITED
      *             ANYONE BORN PRIOR TO 1950 WERE GETTING CENTURY 20, 2048
      *  BAH 160112 ADDED TRW-INVALID-SSNO "9" FOR REGMGM PR# 4931
      *             IF ANY SSNO > 990000000, FORCE TO ALL 9'S
      *  BAH 160128 REMOVED CHANGE FROM PR4590 AND WILL NOW FILL IN
      *             N1 SEGMENT EMPLOYER NAME FOR UNITED PR# 4966
      *  BAH 160128 SPLIT OUT LTFILE, PD0003
      *  BAH 160208 MOVE 0 TO TRW-B-REGPYAMT IF PAID OUT ACCOUNT, PR#4979
      *  BAH 160209 SPLIT OUT LSFILE, PD0003
      *  BAH 160218 EXPANDED LM-REC ADDED LM-BRNO, PD0003
      *  BAH 160303 DO NOT FILL IN ANY N1 SEGMENT INFO FOR EMPLOYER
      *             FOR UNITED, PR# 5003
      *  BAH 160303 ADDED TRW-INVALID-SSNO "0" FOR WORLD PR# 1129
      *             IF ANY SSNO STARTS WITH 9XX-XX-XXXX OR 000-XX-XXXX
      *             FORCE TO ALL 9'S IN BASE AND J1/J2 SEGMENTS
      *  BAH 160303 DO NOT PRINT ERROR IF CD-TRW IS NOT NUMERIC
      *             IT CAN BE ALPHANUMERIC, MODERN PR#5008
      *
      * KEC 2016.0310 {PD#00003} PARADATA <A30> [JAY CISZEWSKI]
      *         CHANGED CD-GROUP, CD-SECURED & CD-TRW TO BE
      *         CD-CO-GROUP, CD-CO-SECURED & CD-CO-TRW.
      *  BAH 160316 ADDED GENERATION FOR UNITED ONLY, PR# 4978
      *  BAH 160316 DONT FORCE REPODATE IF REPO WAS REDEEMED, NSA 5014
      *  BAH 160321 IF COLLATERAL CODE TRW EXHIBIT I IS "27", REPORT
      *             PORTFOLIO TYPE AS "M" FOR MORTGAGE, COLONIAL PR#5024
      *  BAH 160404 CHANGES FOR "WI" PERSONAL RECEIVERSHIP CHAPTER 28
      *             BANKRUPT, CONTINUE REPORTING BALANCE AND PAST DUE
      *             UNLIKE OTHER WORLD BANKRUPTS AND CONSUMER-INFO-IND
      *             "1A" IF BANKRUPT CHAPTER 28, "Q" IF DISMISSED OR IF
      *             BANKRUPT CHAPTER 28 AND ZERO BALANCE.  WORLD PR# 1139
      *  BAH 160408 ZERO OUT SCHEDULED MONTHLY PAYMENT AMOUNT, FIELD 15,
      *             106-114 OF THE BASE FOR P&L ACCOUNTS, UNITED 5019
      *  BAH 160412 CHANGED MEANING OF TRW-INVALID-SSNO VALUE "9" TO
      *             ALSO INCLUDE SSNO STARTING WITH 98, SO IF ANY
      *             SSNO => 980000000, FORCE TO ALL 9'S REGMGM PR#5036
      *  BAH 160419 FOUND A BUG IN MY UNITED CHANGE FOR GENERATION
      *             IN THE J2 SEGMENT
      *  BAH 160427 ADDED REAFFIRMATION AND DISCHARGE, WORLD #1150
      *  BAH 160505 COMPARE OF YEARS-STOP-REPORTING TO DOFD DIDNT HAVE A
      *             YEAR TYPE BEING SET AND WAS PERFORMING TIMALL, THE
      *             YEAR TYPE WAS GETTING CHANGED FROM OTHER ROUTINES
      *             BETWEEN ACCOUNTS, FORCE TO TIM365, MIDATL PL#930
      *  BAH 160509 TEST FOR DISCHARGE BEFORE CHECKING REAFFIRMATION
      *                                                 WORLD PR# 1150A
      *  BAH 160509 READ LT SEQ 5 FOR DISCHARGE, THEN READ SEQ 1 FOR
      *             WHO FILED, THEN TESTED DISCHARGE DATE AGAIN, NEEDED 
      *             TO READ IN SEQ 5 AGAIN!             WORLD PR# 1150B
      *  BAH 160512 ZIP CODE WITH "-" IN IT WAS NOT REPORTING CORRECTLY
      *             NEED TO STRIP OUT THE DASH            SUPPORT PR#5075
      *  BAH 160512 GENERATION NOT WORKING IF LAST NAME WAS 16 CHARACTERS, 
      *             MUST HAVE A SPACE ON THE END TO FIND THE GENERATION CODE
      *             INSPECT, " JR ", TEST A HOLD FIELD, UNITED PL#931
      *  BAH 160517 MISSED FIXING THE ZIPCODE IN J2 SEGMENT PR#5075
      *  BAH 160520 IF AMT PAST DUE > CURBAL, SEND AMT PAST DUE AS
      *             CURBAL, MIDTAL PR#5081
      *  BAH 160701 ACCURATELY REPORT BANKRUPTCY DISCHARGES FOR ACCOUNTS
      *             WITH MORE THAN ONE BORROWER. IF MAKER IS DISCHARGED
      *             AND JOINT DID NOT FILE, REPORT THE DISCHARGE FOR MONTH
      *             OF DISCHARGE ONLY AND THEN DISCONTINUE REPORTING THE
      *             MAKER AND MOVE JOINT SIGNER TO THE BASE RECORD. IF 
      *             DISCHARGE IS REMOVED, RETURN REPORTING MAKER AS NORMAL.
      *                                                WORLD  PR#1165
      *  BAH 160705 UNITED ONLY, ANY ACCOUNT THAT IS P&L WITH A CURBAL, AND
      *             REPO AND VOLUNTARY, REPORT THE REGPAYAMT, UNITED 5107
      *  BAH 160706 USE DISCHARGE-SYSDATE FOR DATE RANGE TEST IN CASE
      *             IT WAS BACKDATED, WORLD 1165
      *  BAH 160713 WORLD ONLY, DO NOT CREATE INTERIM FILE WITH CR/LF, AND
      *             NAME THE FILE METRO2.YYMMDD, WORLD PR#1130A
      *  BAH 160808 IF TRW-INFO-SCHED-PAY = "Y", MOVE NO-SCHED-PAYMENT TO
      *             FIELD 15, SCHEDULED MONTHLY PAYMENT AMOUNT INSTEAD OF
      *             LOAN REGPAY SO ADD-ONS OR RESCHEDULE HAVE CORRECT 
      *             PAYMENT AMOUNT, REGACC PR# 383
      *  BAH 161228 REPORT BK DISCHARGES FOR HOME CREDIT BASED ON OVERRIDE
      *             LN-TRW-B-CONSUMER-IND, 0 CURBAL AND PASTDUE AND "13"
      *             STATUS, HCRED PR#5234
      *  BAH 170109 TRW-B-ATYPE OF 27 IS NO LONGER VALID, CHANGE TO 26,
      *             CUSTOMERS RESPONSIBLE FOR CHANGING COLLATERAL CODE
      *             TRW EXHIBIT I, SUN FINANCE PR#5244
      *  BAH 170209 ADDED CHECK FOR LP-TRCD "AA" AND LP-REFNO "INVES" TO
      *             ADD LP-TRAMT TO TRW-B-ACTUAL-PAID, WORLD PR#1226
      *             SP/INVEST AUTOMATICALLY CREATE LP RECORDS WITH "AA"
      *             THAT NEED TO GET ADDED TO ACTUAL-PAID, THOUGHT I SHOULD
      *             CHECK THE REFNO IN CASE WE EVER ALLOW "AA" AS A REAL
      *             TRANSACTION
      *  BAH 170217 SET THE ORIG PLAMT IF STATUS CODE 93 FOR WORLD ONLY
      *             THESE ACCOUNTS WERE AUTOMATICALLY SET WITH STATUS 93
      *             IN SP/SETIMP SO THIS OVERRIDE CAUSED PLAMT TO NOT GET SET
      *                                                WORLD PR#1226A
      *  BAH 170426 REPORT BK DISCHARGES FOR REGENCY BASED ON OVERRIDE
      *             LN-TRW-B-CONSUMER-IND, 0 CURBAL AND PASTDUE AND "13"
      *             STATUS, SAME AS HCRED PR#5234, REGENCY PR#5246
      *  BAH 170426 ACTIVATE 8 DIGIT DATES, PD0006
      *  BAH 170803 ADD WORLD TO THE GENERATION TEST, ADD MOVE INSPECTS AND
      *             REPLACES TO THE LAST NAME FOR MORE GENERATION CHECKS
      *                                                   WORLD PR#1266
      *  BAH 170811 CHANGED INSPECT FOR GENERATION SO IT WILL CATCH
      *             ", JR." AND THIS ONE SHOULD DO IT, " JR.". WORLD #1266A
      *  BAH 171004 IF CHARGED OFF ACCOUNT, TRW-B-CURBAL AND TRW-B-AMT-PASTDUE
      *             MUST BE THE OUTSTANDING BALANCE (NETDUE), REGACC PR#390
      *             MADE THIS CHANGE FOR EVERYONE EXCEPT WORLD
      * BAH 180503 SET TRW-B-STATUS "13" FOR PR#5246/5234 BEFORE 17B
      *            BECAUSE PAYMENT RATING MUST BE SET FOR A "13" AND IT
      *            WASNT! PL#992 REGENCY
      * BAH 180627 MAKE SURE ACCTNO CONTINUES TO HAVE 01 ON THE END, CANT 
      *            CHANGE ACCTNO ON FILE AT CREDIT BUREAU!
      * BAH 181214 GLOBAL LNFILE
      * BAH 190206 USE THE TILA "AMOUNT FINANCED" IN FIELD 12. ORIGINAL LOAN
      *            AMOUNT. THIS IS THE TOTAL OF PAYMENTS LESS INTCHG, SERCHG
      *            EXT, AND MF. ONLY FOR ACCOUNTS WITH AN ENTERED DATE
      *            >=02/01/2019
      *            USE THE CUSTOMER PAYOFF AS OF THE EOM DATE ENTERED
      *            FOR ACCOUNTS WITH AN ENTERED DATE >=02/01/2019. THIS IS
      *            GROSS BALANCE LESS ANY REFUNDS OF INT/INS/FEES PLUS ANY
      *            LATE CHARGES, SIMPLE INT, OR OTHCHG DUE AS OF THE LAST
      *            DAY OF THE MONTH.                  WORLD #1360
      * BAH 20190627 REMOVED LN-REVOLVING, PT0153
      *  CS 20190708 REMOVED CHECK ON EOM-TAG AND REPLACED WITH READ OF
      *              GBFILE FOR MONTH END DATE
      * BAH 20190930 REMOVED ACCESS-CALL LNFILE
      * BAH 191010 SKIP ALL CONVERTED ACCOUNTS PRIOR TO 01012019 AND CREATE
      *            K2 SEGMENT IF LSM-MISC-FIELD(5) ISNT BLANK, PR#1395
      * BAH 191107 SKIP ACCOUNT IF CONVERTED AND MISC-FIELD(5) IS SPACES OR NO
      *            LSM RECORD, DONT CREATE N1 ON CONVERTED ACCOUNTS, #1395B
      * BAH 2020.06.08 REPORT STATUS CODE "DA" WHEN AN ACCOUNT IS 6 YEARS,
      *                8 MONTHS FROM DOFD, THEN STOP REPORTING WHEN 6 YEARS 
      *                9 MONTHS, REMOVE TRW-YEARS-STOP-REPORTING #1440
      * BAH 20200615 ADDED A FLAG TO PRESERVE THAT YOU SET "DA" WAY AT TOP
      *              OF PROGRAM BECAUSE IT'S GETTING OVERWRITTEN BY REAL
      *              STATUS.
      * BAH 20200827 REMOVED RESET ON BR1 
      * BAH 20200930 BANKRUPT REPORTING - ANY BK ON OR BEFORE 11/30/2020,
      *              SET STATUS "DA" TO DELETE, OTHERWISE, REPORT BK GROSS
      *              BALANCE AND TRUE AMOUNT PAST DUE. IF DISCHARGE DATE 
      *              NOT 0 AND RESCIND = 0, SEND 0 CURBAL AND PAST DUE, #1461
      * BAH 20211020 IN THE "FROM" BRANCH OF A BRANCH TRANSFER, FORCE A SPECIAL
      *              COMMENT CODE OF "AT" FOR ALL ACCOUNTS REPORTED
      *              CLOSED VIA PAYOFF CODE "BT". #1521
      * BAH 20220224 REMOVE THE DATE FILTER OF 013119 FROM #1360. ALWAYS SEND
      *              DISCLOSED-FINAMT FOR TRW-B-AMT (12) AND POFF-NETDUE FOR
      *              TRW-B-CURBAL (21). #1545
      * BAH 20220321 BRANCH TRANSFERRED ACCOUNTS IN THE 'FROM' BRANCH ARE
      *              NOW BEING SKIPPED (BT) AND THE 'TO' BRANCH WILL CREATE
      *              AN "L1" SEGMENT FOR THE MONTH IT WAS TRANSFERRED WITH
      *              THE NEW ACCOUNT (BRNO/ACCOUNT) AND THE OLD ACCOUNT IN
      *              THE BASE SEGMENT, THEN SUBSEQUENT MONTHS IT WILL REPORT
      *              NORMAL, WITH THE NEW BRNO/ACCOUNT IN THE BASE SEGMENT.
      *              CREATED NEW LS-M-TRANS FIELDS TO HOLD FROM INFORMATION
      *                                                                #1547
      * BAH 20220818 REMOVED GLOBRD, READ GB-FILE INSTEAD
      * BAH 20220803 HARD CODED START
      * BAH 20220823 REMOVED TEST OF LN-TRW-STATUS "05" FOR SOLD/TRANSFERRED
      *              ACCOUNTS, CODE IS OBSOLETE NOW #1567
      * MB  20231107 PERFORMANCE TUNING - CREATED STORED PROCEDURE TO RETRIEVE
      *               LNFILE ROWS WITH LSM AND BW DATA.
      *               STORES LCFILE DATA IN WS-LC1-TBL
      *               ADDED STATE PARAMETER ARRAY PROCESSING
      *       NOTE - ALL LNFILE COLUMNS RETURNED IN CURSOR
      * BAH 20231117 REMOVED CRNOR2 AND PERFORM PAID-THRU-CALCULATION TO
      *              GET PDTH-CUR-SCHD-PAY, DONT NEED FULL NOTICE! 
      * BAH 20240111 CHANGES FOR SETTLEMENT ACCOUNTS, SPECIAL COMMENT "AU"
      *                                                               #1639
      * BAH 20240125 REMOVE ALL LOGIC WITH 62 AND 68. THEY CAN USE AS
      *              OVERRIDE #1639
      * MB  20240613 CHANGED LN CURSOR TO USE TEMP TABLE S35Q-67
      * BAH 20240823 TRANSFERRED ACCOUNTS; MOVE ORIGINAL FROM BRANCH TO
      *              TRW-B-IDENT-NO, MOVE 3 TO TRW-L1-CHANGE-IND AND MOVE
      *              NEW OWNING BRANCH (TO) TO TRW-L1-NEW-IDENT #1675 S35Q-122
      * BAH 2025.0304 ADDED MOVE TRW-INFO-INNOVIS-ID TO TRW-H-INNOVIS-ID #1702
      *                                                              S35Q-169
      ************************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. 3B.
       OBJECT-COMPUTER. 3B.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       COPY "LIBGB/GBFSPR.CPY".
       COPY "LIBSP/SPFSTW.CPY".
           SELECT TRW-E-FILE ASSIGN TO TRW-E-PATH
                           ORGANIZATION RELATIVE
                           ACCESS DYNAMIC
                           LOCK MODE AUTOMATIC WITH LOCK ON RECORD
                           RELATIVE KEY TRW-E-KEY
                           FILE STATUS FILE-STAT.
       I-O-CONTROL.
       DATA DIVISION.
       FILE SECTION.
       COPY "LIBGB/GBFDPR.CPY".
       COPY "LIBSP/SPFDMETRO2.CPY".
       FD  TRW-E-FILE
           LABEL RECORDS ARE STANDARD.
       01  TRW-E-REC.
           03  FILLER              PIC X(1364).
           03  TRW-E-CR            PIC X.
           03  TRW-E-LF            PIC X.


       WORKING-STORAGE SECTION.
       77  SCCS-IDENTIFIER PIC X(41) VALUE
           "@(#)SP/METRO2.CBL S35 05/21/24-09:40:17 >".
       COPY "LIBGB/GB01GB.CPY".
       COPY "LIBGB/GB01GB_SQL.CPY".
       COPY "LIBGB/GBWSGB.CPY".
       COPY "LIBGB/GB01BR.CPY".
       COPY "LIBGB/GB01BR_SQL.CPY".
       COPY "LIBGB/GBWSBR.CPY".
       COPY "LIBSP/SP01TRWINFO.CPY".
       COPY "LIBSP/SP01TRWINFO_SQL.CPY".
       COPY "LIBSP/SPWSTRWINFO.CPY".
       COPY "LIBGB/GB01GR.CPY".
       COPY "LIBGB/GB01GR_SQL.CPY".
       COPY "LIBGB/GBWSGR.CPY".
       COPY "LIBLP/LP01BW.CPY".
       COPY "LIBLP/LP01BW_SQL.CPY".
       COPY "LIBLP/LPWSBW.CPY".
       COPY "LIBLP/LP01BM.CPY".
       COPY "LIBLP/LP01BM_SQL.CPY".
       COPY "LIBLP/LPWSBM.CPY".
       COPY "LIBLP/LP01LN.CPY".
       COPY "LIBLP/LP01LN_SQL.CPY".
       COPY "LIBLP/LPWSLN.CPY".
       COPY "LIBLP/LP01LP.CPY".
       COPY "LIBLP/LP01LP_SQL.CPY".
       COPY "LIBLP/LPWSLP.CPY".
       COPY "LIBLP/LP01LM.CPY".
       COPY "LIBLP/LP01LM_SQL.CPY".
       COPY "LIBLP/LPWSLM.CPY".
       COPY "LIBLP/LP01LTB.CPY".
       COPY "LIBLP/LP01LTB_SQL.CPY".
       COPY "LIBLP/LPWSLTB.CPY".
       COPY "LIBLP/LP01LTI.CPY".
       COPY "LIBLP/LP01LTI_SQL.CPY".
       COPY "LIBLP/LPWSLTI.CPY".
       COPY "LIBLP/LP01LTP.CPY".
       COPY "LIBLP/LP01LTP_SQL.CPY".
       COPY "LIBLP/LPWSLTP.CPY".
       COPY "LIBLP/LP01LSX.CPY".
       COPY "LIBLP/LP01LSX_SQL.CPY".
       COPY "LIBLP/LPWSLSX.CPY".
       COPY "LIBLP/LP01LSM.CPY".
       COPY "LIBLP/LP01LSM_SQL.CPY".
       COPY "LIBLP/LPWSLSM.CPY".
       COPY "LIBLP/LP01LC.CPY".
       COPY "LIBLP/LP01LC_SQL.CPY".
       COPY "LIBLP/LPWSLC.CPY".
       COPY "LIBLP/LP01CD.CPY".
       COPY "LIBLP/LP01CD_SQL.CPY".
       COPY "LIBLP/LPWSCD.CPY".
       COPY "LIBLP/LP01SP.CPY".
       COPY "LIBLP/LP01SPA.CPY".
       COPY "LIBLP/LP01SPB.CPY".
       COPY "LIBLP/LP01SPC.CPY".
       COPY "LIBLP/LP01SP_SQL.CPY".
       COPY "LIBLP/LPWSSP.CPY".
       COPY "LIBSP/SPWSMETRO2.CPY".

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.
       01  PASS-SQL                    PIC X(7500).
       01  RET-TOT-DELETED             PIC 9(9).
       01  RET-TOT-BYPASSED            PIC 9(9).
       EXEC SQL END DECLARE SECTION END-EXEC.

       01  LN3-CONN-OPEN-SW            PIC X        VALUE "N".

       01  LNFC-CURSOR-STAT            PIC X(2) VALUE SPACES.
           88  LNFC-CURSOR-STAT-GOOD            VALUE "00".
           88  LNFC-CURSOR-STAT-BAD             VALUE "  " THRU "//"
                                                      "01" THRU "~~".

       01  WS-FOUND-SW                 PIC X       VALUE "N".
       01  WS-MISC-SUB                 PIC 9(9)    VALUE 0.
       01  WS-LC1-TBL-CTR              PIC 9(9)    VALUE 0.
       01  WS-LC1-TBL.
          03  WS-LC1-TBL-DATA          OCCURS 1 TO 1000 TIMES 
                                        DEPENDING ON LC1-ROW-COUNT.
             05  WS-LC1-TBL-CODE       PIC 9(3).
             05  WS-LC1-TBL-SKIP-TRW   PIC X.

      *    **********************************
      *    *      PROGRAM WORKERS
      *    **********************************

       01  PR-IFN               PIC X(2)   VALUE "PR".
       01  TRW-KEY              PIC 9(9)   VALUE 0.
       01  TRW-E-KEY            PIC 9(9)   VALUE 0.

       01  WS-A15-ACCTNO.
           03  WS-NEW-NUMBER    PIC 9(6).
           03  WS-NEW-SEQNO     PIC 9(2).
       01  WHO-FILED            PIC X      VALUE SPACES.
       01  ENDORSER-FILED       PIC X      VALUE SPACES.
       01  BNKRPT-CHAPTER       PIC 99     VALUE 0.
       01  REAFF-DATE           PIC 9(8)   VALUE 0.
       01  DISCHARGE-DATE       PIC 9(8)   VALUE 0.
       01  DISCHARGE-SYSDATE    PIC 9(8)   VALUE 0.
       01  RESCIND-DATE         PIC 9(8)   VALUE 0.
       01  BK-GROSS-BAL         PIC 9(6)V99 COMP-3   VALUE 0.
       01  VOL-INVOL-FLAG       PIC X      VALUE "I".
       01  I-AM-STATUS-DA       PIC X      VALUE SPACES.
       01  LAST-CLASS-READ      PIC 9(3)   VALUE 0.
       01  READ-LP-FILE         PIC X      VALUE SPACES.
       01  HOLD-LAST-TRANS-DATE PIC 9(8)   VALUE 0.
       01  HOLD-SECURED         PIC X      VALUE SPACES.
       01  WS-CONSUMER-INFO-IND PIC XX     VALUE SPACES.
       01  LN-WORKERS.
           03  LN-FEED         PIC 99     VALUE 0.
           03  LN-COUNT        PIC 999    VALUE 99.
           03  LN-WK           PIC 999    VALUE 0.
       01  PAGE-NUMBER         PIC 9(4)   VALUE 0.

       01  WK-PROFILES         PIC X(24).
       01  WK-PROFILE-BYTE REDEFINES WK-PROFILES PIC X OCCURS 24 TIMES.
       01  WK-PROFILES-24 REDEFINES WK-PROFILES.
           03  WK-CONPROFILE1  PIC 9(12).
           03  WK-CONPROFILE2  PIC 9(12).

       01  WK-PROFILE3         PIC 9(12).
       01  WK-PROF-BYTE REDEFINES WK-PROFILE3 PIC 9 OCCURS 12 TIMES.

       01  WS-DLPOOL-DATE      PIC 9(5).
       01  WS-DLPOOLX REDEFINES WS-DLPOOL-DATE.
           03  FILLER          PIC 9.
           03  WS-DLPOOL-MM    PIC 99.
           03  WS-DLPOOL-YY    PIC 99.

       01  TEST-IND            PIC XX.
           88 VALID-INDICATOR          VALUE "A " "B " "C " "D "
                                             "E " "F " "G " "H "
                                             "I " "J " "K " "L "
                                             "M " "N " "O " "P "
                                             "Q " "R " "S " "T "
                                             "U " "V " "W " "X "
                                             "Y " "Z " "1A" "  ".
       01  WK-NAME.
           03  WK-NAME-BYTE    PIC X OCCURS 16 TIMES.
       01  OUT-NAME.
           03  WK-OUT-BYTE     PIC X OCCURS 16 TIMES.
       01  ACTIVITY-MMDDYYYY    PIC 9(8).
       01  EOM-RUN              PIC X VALUE "Y".
       01  HOLD-LNAME           PIC X(25).
       01  ZIP-IN.
           03  ZIP-IN-BYTE      PIC X OCCURS 10 TIMES.
       01  ZIP-OUT.
           03  ZIP-OUT-BYTE     PIC X OCCURS 9 TIMES.

       01  BORROWER-INFO-01.
           03  BORROWER-INFO        OCCURS 2 TIMES.
               05  BORROWER-ADR1     PIC X(24).
               05  BORROWER-ADR2     PIC X(24).
               05  BORROWER-CITY     PIC X(15).
               05  BORROWER-STATE    PIC X(2).
               05  BORROWER-ZIP      PIC X(10).

       01  NEXT-MO-AGEING-DATE  PIC 9(8).
       01  SUB                  PIC 99.
       01  SUB1                 PIC 99.
       01  SUB2                 PIC 99.
       01  IN-SUB               PIC 99.
       01  OUT-SUB              PIC 99.
       01  MAKER-SUB            PIC 9.
       01  END-SUB              PIC 9 VALUE 0.
       01  J1-SUB               PIC 9.
       01  J2-SUB               PIC 9.

       01  REAL-ESTATE-TEST     PIC XX.
           88  REAL-ESTATE VALUE "08", "19", "25", "26".

       01  NEW-COUNT            PIC 9(8) COMP-3 VALUE 0.
       01  UPDATED-COUNT        PIC 9(8) COMP-3 VALUE 0.
       01  CONV-COUNT           PIC 9(8) COMP-3 VALUE 0.

       01  REPORTED-COUNT       PIC 9(8) COMP-3 OCCURS 10 TIMES.
       01  REPORTED-AMOUNT      PIC 9(10) COMP-3 OCCURS 10 TIMES.
       01  AGE-COUNT            PIC 9(8) COMP-3 OCCURS 11 TIMES.
       01  AGE-AMOUNT           PIC S9(10)V99 COMP-3 OCCURS 11 TIMES.
       01  BASE-COUNT           PIC 9(8) COMP-3 VALUE 0.
       01  N1-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  K1-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  K2-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  K3-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  K4-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  J1-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  J2-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  DA-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  05-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  11-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  13-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  61-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  62-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  63-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  64-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  65-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  71-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  78-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  80-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  82-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  83-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  84-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  88-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  89-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  93-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  94-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  95-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  96-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  97-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  Z-COUNT              PIC 9(8) COMP-3 VALUE 0.
       01  L1-COUNT             PIC 9(8) COMP-3 VALUE 0.
       01  SSNO-COUNT           PIC 9(8) COMP-3 VALUE 0.
       01  BASE-SSNO-COUNT      PIC 9(8) COMP-3 VALUE 0.
       01  J1-SSNO-COUNT        PIC 9(8) COMP-3 VALUE 0.
       01  J2-SSNO-COUNT        PIC 9(8) COMP-3 VALUE 0.
       01  BDATE-COUNT          PIC 9(8) COMP-3 VALUE 0.
       01  BASE-BDATE-COUNT     PIC 9(8) COMP-3 VALUE 0.
       01  J1-BDATE-COUNT       PIC 9(8) COMP-3 VALUE 0.
       01  J2-BDATE-COUNT       PIC 9(8) COMP-3 VALUE 0.
       01  PHONE-COUNT          PIC 9(8) COMP-3 VALUE 0.

       01  AGEING-DESC-01.
           03  AGEING-DESC.
               05  FILLER      PIC X(10) VALUE "ZERO BALS ".
               05  FILLER      PIC X(10) VALUE "CURRENT   ".
               05  FILLER      PIC X(10) VALUE "30 DAYS   ".
               05  FILLER      PIC X(10) VALUE "60 DAYS   ".
               05  FILLER      PIC X(10) VALUE "90 DAYS   ".
               05  FILLER      PIC X(10) VALUE "120 DAYS  ".
               05  FILLER      PIC X(10) VALUE "150 DAYS  ".
               05  FILLER      PIC X(10) VALUE "180 DAYS  ".
               05  FILLER      PIC X(10) VALUE "OVER 180 *".
               05  FILLER      PIC X(10) VALUE "P & L     ".
               05  FILLER      PIC X(10) VALUE "VOIDS     ".
           03  AGEING-DESCX REDEFINES AGEING-DESC.
               05  AGE-DESC    PIC X(10) OCCURS 11 TIMES.

       01  AMT-PASTDUE      PIC 9(10)V99 COMP-3 VALUE 0.

       01  TOT-RECORDS      PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-ACTIVE       PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-DELETED      PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-BYPASSED     PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-ZBALS        PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-INCORRECT    PIC 9(9)  COMP-3 VALUE 0.
       01  TOT-80-DA        PIC 9(9)  COMP-3 VALUE 0.
       01  WORK-COUNT       PIC 9(9)  COMP-3 VALUE 0.
       01  WORK-AMOUNT      PIC S9(10)V99 COMP-3 VALUE 0.
      *-------------------------------------------------

       01  VERSION-CONTROL      PIC X VALUE "B".

       COPY "LIBGB/EOBUF_EXT.CPY".
           03  BEG-BR           PIC 9(4).
           03  END-BR           PIC 9(4).
           03  BEG-CL           PIC 9(3).
           03  END-CL           PIC 9(3).
           03  BEG-ACCOUNT      PIC 9(6).
           03  END-ACCOUNT      PIC 9(6).
           03  BEG-REPORT-DATE  PIC 9(8).
           03  END-REPORT-DATE  PIC 9(8).
           03  INCL-CONF        PIC X.
           03  UPDATE-TYPE      PIC X.
           03  GROUP-FLAG       PIC X.
           03  ENT-GROUP        PIC X(4).
           03  DEL-FLAG         PIC X.
           03  INTERIM-ONLY     PIC X.
           03  CREDIT-BUREAU-ID PIC 9(4).

       01  MESS-LIST            PIC X(5) VALUE "MESS.".
       01  DISPLAY-BUF.
           03  FILLER           PIC X(12) VALUE "PROCESSING..".
           03  DISPLAY-BRNO     PIC Z(4).
           03  FILLER           PIC X(34) VALUE SPACES.

       01  CREATE-DATE          PIC 9(8).

      ********************************************************
      *            P R I N T    B U F F E R S                *
      ********************************************************
       01  HEAD1.
           03  H-DATE             PIC X(8)    VALUE " ".
           03  FILLER             PIC XX      VALUE " ".
           03  H-HR               PIC 99      VALUE 0.
           03  FILLER             PIC X       VALUE ":".
           03  H-MIN              PIC 99      VALUE 0.
           03  FILLER             PIC X(5)   VALUE " ".
           03  H-NAME             PIC X(40)   VALUE " ".
           03  FILLER             PIC X(11)   VALUE " ".
           03  FILLER             PIC X(5)    VALUE "PAGE ".
           03  H-PAGE-NO          PIC ZZZ9.

       01  HEAD2.
           03  FILLER             PIC X(10)   VALUE "USER ID:".
           03  H-USERID           PIC X(12).
           03  FILLER             PIC X(3)    VALUE " ".
           03  FILLER             PIC X(27)   VALUE
               "LISTING FOR TRW FILE CREATE".

       01  HEAD3.
           03  FILLER             PIC X(14)   VALUE "  BRNO  NUMBER".
           03  FILLER             PIC X(20)    VALUE "  NAME ".
           03  FILLER             PIC X(6)   VALUE "STAT".
           03  FILLER             PIC X(7)   VALUE "COMMENT".

       01  DETAIL-LINE          PIC X(80) VALUE SPACES.
       01  DETAIL-LINE1 REDEFINES DETAIL-LINE.
           03  D-SERIOUS        PIC X.
           03  FILLER           PIC X.
           03  D-BRNO           PIC Z(4).
           03  FILLER           PIC XX.
           03  D-NUMBER         PIC Z(6).
           03  FILLER           PIC XX.
           03  D-NAME           PIC X(16).
           03  FILLER           PIC X(3).
           03  D-STATUS         PIC X(2).
           03  FILLER           PIC X(5).
           03  D-COMMENTS       PIC X(2).
           03  FILLER           PIC X(3).
           03  D-MSG1           PIC X(33).


       01  RANGE-LINE REDEFINES DETAIL-LINE.
           03  RANGE-SELECTION  PIC X(30).
           03  FILLER           PIC X(5).

           03  RANGE1           PIC X(10).
           03  RANGE1N REDEFINES RANGE1 PIC 9(10).

           03  FILLER           PIC X(2).
           03  RANGE2N          PIC 9(10).
           03  RANGE3           PIC Z(10).99-.

       COPY "LIBGB/GPENVW.CPY".

       COPY "LIBWI/GRSCANW.CPY".
       COPY "LIBGB/DATERW.CPY".
       COPY "LIBGB/TIMEWK.CPY".
       COPY "LIBGB/CONNECTW_SQL.CPY".
       COPY "LIBGB/FILEWK.CPY".
       COPY "LIBGB/GRWORKW.CPY".
       COPY "LIBGB/RBACTW.CPY".
       COPY "LIBWI/TWISCNW.CPY".
       COPY "LIBLP/LPAMTSW.CPY".
       COPY "LIBLP/LPUPERW.CPY".
       COPY "LIBLP/LPPOFFW.CPY".
       COPY "LIBLP/ADDONSPRW.CPY".
       COPY "LIBLP/LPITRMW.CPY".
       COPY "LIBGB/REBATEW.CPY".
       COPY "LIBLP/LPAPRSW.CPY".
       COPY "LIBLP/LPAPRZW.CPY".
       COPY "LIBGB/AGEINGW.CPY".
       COPY "LIBLP/LPUPWKW.CPY".
       COPY "LIBGB/SPPDTHW.CPY".
       COPY "LIBLP/LPPDUEW.CPY".
       COPY "LIBLP/LPCEPPW.CPY".
       COPY "LIBLP/LPCDELW.CPY".
       COPY "LIBLP/LPMDTEW.CPY".
       COPY "LIBLP/LPXDTEW.CPY".
       COPY "LIBLP/LPRATEW.CPY".
       COPY "LIBLP/LPIBPCW.CPY".
       COPY "LIBLP/LPLCAPW.CPY".
       COPY "LIBLP/LPLCASW.CPY".
       COPY "LIBLP/LPSCHDW.CPY".
       COPY "LIBLP/LPLCHGW.CPY".
       COPY "LIBGB/ACCESSW.CPY".
       COPY "LIBLP/SETCTBLW.CPY".
       COPY "LIBGB/GETPRW.CPY".

       COPY "LIBGB/DACCESSW.CPY".
       COPY "LIBGB/SYSTEMW.CPY".
       COPY "LIBGB/CONAME_EXT.CPY".
       COPY "LIBGB/SCREENW.CPY".
       COPY "LIBSP/METRO2_DEF.CPY".
       COPY "LIBSP/METRO2_WKS.CPY".
       COPY "LIBGB/HELPLINK.CPY".
       COPY "LIBGB/PRU_LNK.CPY".

       COPY "LIBLP/ARRAYSPW.CPY". 

      *****************************************************************
      *
      *     P R O G R A M   C O N T R O L
      *
      *****************************************************************
       COPY "LIBGB/GETFMW.CPY".
       SCREEN SECTION.
       COPY "LIBSP/METRO2_SCN.CPY".

      *----------------------------------------------------------------
       PROCEDURE DIVISION
           USING FORM-PATHNAME EXIT-PATHNAME.
       DECLARATIVES.
       DECLARE-ERROR SECTION.
           USE AFTER ERROR PROCEDURE ON
               TRW-FILE PR-FILE TRW-E-FILE.
       COPY "LIBGB/DECLRP.CPY".
           PERFORM CLOSE-SP1-FILE.
           PERFORM CLOSE-LTP1-FILE.
           PERFORM CLOSE-LTI1-FILE.
           PERFORM CLOSE-LTB1-FILE.
           PERFORM CLOSE-LSX1-FILE.
           PERFORM CLOSE-LSM1-FILE.
           PERFORM CLOSE-LP1-FILE.
           PERFORM CLOSE-LN3-FILE.
           PERFORM CLOSE-LM1-FILE.
           PERFORM CLOSE-LC1-FILE.
           PERFORM CLOSE-CD1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-BM1-FILE.
           PERFORM CLOSE-GR1-FILE.
           PERFORM CLOSE-GB-FILE.
           PERFORM CLOSE-BR-FILE.
           PERFORM CLOSE-LN3-CONNECTION.
           PERFORM SQL-CLOSE-UPDATE-CONNECTION.
           CLOSE
               TRW-FILE PR-FILE TRW-E-FILE.
       COPY "LIBGB/DECLRP2.CPY".

      *    ***************************
      *    *      MAIN PROGRAM MODULE
      *    ***************************
       MAIN-MODULE SECTION.
           PERFORM SQL-CONNECT.
       MAIN-ROUTINE.
      D    STOP MESS.

           MOVE FORM-PATHNAME TO FORM-PATH.
           MOVE "METRO2" TO VDU-FORM-NAME.

           PERFORM GET-GPENV.

           PERFORM INITIALIZATION.
           IF EXT-EOBUF-ERRCD NOT = " "
              GO TO END-PROGRAM.

           IF TRW-INFO-GRANTOR-CODE = SPACES
              MOVE "MUST FILL IN CREDIT BUREAU INFO FILE FIRST"
                TO MESS
              PERFORM SEND-MESS
              MOVE "X" TO EXT-EOBUF-ERRCD
              GO TO END-PROGRAM.

           PERFORM CREATE-HEADER-RECORD.

           IF GROUP-FLAG = "N"
              MOVE BEG-BR TO BR-NO
              PERFORM START-BR-FILE
              GO TO NEXT-BRANCH-NO.

           MOVE ENT-GROUP TO GR-ID.
           PERFORM SEARCH-GR-INIT.

       NEXT-GROUP-LOC.
           IF GROUP-FLAG NOT = "Y"
              GO TO NEXT-BRANCH-NO.
           PERFORM SEARCH-GR-NEXT.
           IF WGR-SRESULT = 0
              GO TO END-ROUTINE.
           MOVE WGR-SRESULT TO BR-NO.
           PERFORM READ-BR-FILE.
           IF IO-FG NOT = 0
              GO TO IO-ERROR.

           GO TO MOVE-BRANCH-PATH-INFO.

       NEXT-BRANCH-NO.
           PERFORM READ-BR-FILE-NEXT.
           IF IO-FG = 9 OR BR-NO > END-BR
              GO TO END-ROUTINE.

       MOVE-BRANCH-PATH-INFO.
           MOVE EXT-FILPATH-BASE TO FILPATH-BASE.
           MOVE BR-MACHINE       TO FILPATH-MACHINE.
           MOVE BR-DATA-PATH     TO FILPATH-DATA.

           MOVE "B"     TO BW-PATH-OVERRIDE
                           BM-PATH-OVERRIDE
                           LN-PATH-OVERRIDE
                           LP-PATH-OVERRIDE
                           LM-PATH-OVERRIDE
                           GB-PATH-OVERRIDE
                           LSX-PATH-OVERRIDE
                           LSM-PATH-OVERRIDE
                           LTB-PATH-OVERRIDE
                           LTI-PATH-OVERRIDE
                           LTP-PATH-OVERRIDE.

           IF EXT-ROUTE-BUF = "00"
              IF PRU-LP NOT = "VDU" AND NOT = "PRU"
                 MOVE BR-NO TO DISPLAY-BRNO
                 MOVE DISPLAY-BUF TO WR-BUF
                 MOVE MESS-LIST TO WR-LIST
                 PERFORM CALL-WRFORM.


           PERFORM OPEN-BW1-FILE.
           PERFORM OPEN-BM1-FILE.
           PERFORM OPEN-LN3-FILE.
           PERFORM OPEN-LM1-FILE.
           PERFORM OPEN-LP1-FILE.
           PERFORM OPEN-LSX1-FILE.
           PERFORM OPEN-LSM1-FILE.

           MOVE "Y"              TO GB-PATH-OVERRIDE.
           MOVE EXT-FILPATH-BASE TO GB-ALL-BASE.
           MOVE BR-MACHINE       TO GB-ALL-MACHINE.
           MOVE BR-DATA-PATH     TO GB-ALL-DATA.
           MOVE GB-ALL-PATH      TO GB-PATH.

      * NEED FOR LCAS ROUTINES (REPLACES GLOBRD)
           MOVE GB-PATH-OWNBR TO GB-BRNO.
           MOVE 1             TO GB-NO.
           PERFORM READ-GB-FILE.
           IF IO-BAD
              GO TO END-OF-GROUP.

           MOVE BR-NO       TO LN-OWNBR
                               QLN3-WBEG-OWNBR
                               QLN3-WEND-OWNBR.
           MOVE BEG-CL      TO LN-CLASS
                               QLN3-WBEG-CLASS.
           MOVE END-CL      TO QLN3-WEND-CLASS.
           MOVE BEG-ACCOUNT TO LN-ACCTNO
                               QLN3-WBEG-ACCTNO.
           MOVE END-ACCOUNT TO QLN3-WEND-ACCTNO.

      * RETRIEVE DELETED AND BYPASS COUNTS FOR ROWS THAT WILL NOT BE
      *   RETURNED BY STORED PROCEDURE.
           PERFORM START-LN-FILE-COUNT.
           PERFORM READ-LN-FILE-COUNT-NEXT.
           PERFORM CLOSE-LN3-FILE.

           ADD RET-TOT-DELETED  TO TOT-DELETED.
           ADD RET-TOT-BYPASSED TO TOT-BYPASSED.

           PERFORM START-LN3-FILE.  *> SSP LN LSM BW

       NEXT-LN.
           PERFORM READ-LN3-FILE-NEXT.   *> SSP LN LSM BW
           IF IO-BAD                        *> OR (LN-OWNBR NOT = LN-PATH-OWNBR)
              GO TO END-OF-GROUP.

           IF LN-OWNBR > END-BR
              GO TO END-OF-GROUP.

           ADD 1 TO TOT-RECORDS.

      * THIS COUNTED IN READ-LN-FILE-COUNT-NEXT SINCE ROWS WILL NOT BE 
      *   RETURNED FROM STORED PROCEDURE
      * SKIP LOANS IN RESCISSION
           IF LN-POCD-INRESCISSION OR LN-POCD-RESCIND
      *        ADD 1 TO TOT-DELETED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * MUST INCLUDE VOIDED LOANS IF VOIDED IN A DIFFERENT MONTH
           IF LN-POCD-VOID
              MOVE LN-LOANDATE TO SYS-DATE
              MOVE LN-POFFDATE TO NUM-DATE
              IF NUM-MO = S-MM AND NUM-YR = S-YY
                 ADD 1 TO TOT-DELETED
      *          UNLOCK LN-FILE
                 GO TO NEXT-LN.

      * SKIP CONVERTED ACCOUNTS WITHOUT BALFWD
      * THIS COUNTED IN READ-LN-FILE-COUNT-NEXT SINCE ROWS WILL NOT BE 
      *   RETURNED FROM STORED PROCEDURE
           IF LN-CURBAL = 0 AND LN-POFFDATE = 0
      *        ADD 1 TO TOT-BYPASSED
      **       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * BRANCH TRANSFERRED ACCOUNTS IN THE 'FROM' BRANCH ARE NOW BEING
      * SKIPPED AND THE 'TO' BRANCH WILL CREATE AN "L1" SEGMENT FOR THE
      * MONTH IT WAS TRANSFERRED WITH THE NEW ACCOUNT (BRNO/ACCOUNT) AND
      * THE OLD ACCOUNT IN THE BASE SEGMENT, THEN SUBSEQUENT MONTHS IT
      * WILL REPORT NORMAL, WITH THE NEW BRNO/ACCOUNT IN THE BASE SEGMENT.
      * #1547 3/21/2022

      * THIS COUNTED IN READ-LN-FILE-COUNT-NEXT SINCE ROWS WILL NOT BE 
      *   RETURNED FROM STORED PROCEDURE
           IF LN-POCD = "BT"
      *        ADD 1 TO TOT-BYPASSED
      **       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * SKIP CONVERTED ACCOUNTS ENTERED PRIOR TO 2019
      * LN-CONVERCD = "Y" AND LN-ENTDATE < 20190101 COUNTED IN READ-LN-FILE-COUNT-NEXT SINCE ROWS WILL NOT BE 
      *   RETURNED FROM STORED PROCEDURE
      * LSM CHECK STILL NEEDED
           IF LN-CONVERCD = "Y"
              IF LN-ENTDATE < 20190101
      *          ADD 1 TO TOT-BYPASSED
      *          UNLOCK LN-FILE
                 GO TO NEXT-LN
              ELSE
      * IF A VALID CONVERTED ACCOUNT, CHECK IF A VALUE IN MISC FIELD (5)
      * IF NO RECORD OR NO VALUE, SKIP THE ACCOUNT
      * LSMFILE DATA IN STORED PROCEDURE CURSOR
      * LSMFILE.LSM_BRNO WILL = 0 AND LSM-MISC-FIELD(5) = SPACES IF ROW NOT FOUND
      *           MOVE LN-OWNBR  TO LSM-BRNO
      *           MOVE LN-ACCTNO TO LSM-ACCTNO
      *           MOVE 1         TO LSM-SEQNO
      *           PERFORM READ-LSM1-FILE
      *           IF IO-FG NOT = 0 OR (LSM-MISC-FIELD(5) = SPACES)
                  IF LSM-MISC-FIELD(5) = SPACES
                    ADD 1 TO TOT-BYPASSED
      *             UNLOCK LN-FILE
                    GO TO NEXT-LN.

      * THIS WILL NOT OCCUR DUE TO WHERE CLAUSE IN CURSOR
           IF LN-CLASS < BEG-CL OR LN-CLASS > END-CL
              ADD 1 TO TOT-BYPASSED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * THIS WILL NOT OCCUR DUE TO WHERE CLAUSE IN CURSOR
           IF LN-ACCTNO < BEG-ACCOUNT OR LN-ACCTNO > END-ACCOUNT
              ADD 1 TO TOT-BYPASSED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * THIS COUNTED IN READ-LN-FILE-COUNT-NEXT SINCE ROWS WILL NOT BE 
      *   RETURNED FROM STORED PROCEDURE
           IF LN-SKIP-TRW = "Y"
      *        ADD 1 TO TOT-BYPASSED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

           IF INTERIM-ONLY = "Y"
              IF LN-INTERIM-TRW NOT = "Y"
                 ADD 1 TO TOT-BYPASSED
      *          UNLOCK LN-FILE
                 GO TO NEXT-LN.


      * TEST CLASS FLAG TO BE INCLUDED OR NOT
      * ALL LCFILE CODES HELD IN WS-LC1-TBL
           IF LN-CLASS NOT = LAST-CLASS-READ
              MOVE LN-CLASS TO LC-CODE LAST-CLASS-READ
      *       PERFORM READ-LC1-FILE
              MOVE "N" TO WS-FOUND-SW  
              PERFORM VARYING WS-MISC-SUB FROM 1 BY 1 
               UNTIL WS-MISC-SUB > WS-LC1-TBL-CTR
               OR WS-FOUND-SW = "Y"
                 IF WS-LC1-TBL-CODE(WS-MISC-SUB) = LN-CLASS
                   MOVE "Y" TO WS-FOUND-SW
                   MOVE WS-LC1-TBL-SKIP-TRW(WS-MISC-SUB) TO LC-SKIP-TRW
                 END-IF	
              END-PERFORM
      *        IF IO-FG NOT = 0
              IF WS-FOUND-SW = "N"
                 MOVE "N" TO LC-SKIP-TRW.

           IF LC-SKIP-TRW = "Y"
              ADD 1 TO TOT-BYPASSED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

           IF UPDATE-TYPE = "C"
      * ONLY DO FOR MID ATLANTIC "MD"
              IF LN-CONVERCD NOT = "M"
      *          UNLOCK LN-FILE
                 GO TO NEXT-LN
              ELSE
                 GO TO CONT-CONVERSION.

      * COMPARE (PAYOFF DATE + 2MO) TO LAST ACTIVITY DATE
      *  SO THE PAID OUTS ARE ONLY REPORTED FOR 2 MONTHS
      * LN-POFFDATE IS ACTUAL PAYDATE THAT YOU ENTERED, EFFECTIVE DATE

           IF LN-POFFDATE NOT = 0
              MOVE LN-POFFDATE TO NDTE-DATE
              MOVE 2 TO NDTE-HOLD
              PERFORM INCREMENT-MONTHS
              IF NDTE-DATE < END-REPORT-DATE
      * YOU FOUND A PAIDOUT THAT IS OLDER THAN 2 MONTHS, NOW;
      * TEST THAT IT WAS NOT BACKDATED, THE TRUE TRANDATE IS IN PROMDATE2
                 IF LN-PROMDATE2 = 0
                    ADD 1 TO TOT-ZBALS
      *             UNLOCK LN-FILE
                    GO TO NEXT-LN
                 ELSE
                    MOVE LN-PROMDATE2 TO NDTE-DATE
                    MOVE 2 TO NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                    IF NDTE-DATE < END-REPORT-DATE
                       ADD 1 TO TOT-ZBALS
      *                UNLOCK LN-FILE
                       GO TO NEXT-LN.

      * COMPARE ENTRY DATE TO LAST ACTIVITY DATE
           IF LN-ENTDATE > END-REPORT-DATE
              ADD 1 TO TOT-BYPASSED
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * IF USING THE SKIP MIDSTREAM BRANCH FLAG, SKIP MIDSTREAM
      * PURCHASED ACCOUNTS IN THE MONTH THEY ARE BOARDED AND THE FOLLOWING
      * MONTH
           IF BR-SKIP-MIDSTREAM-TRW = "Y"
              IF LN-MIDSTREAM = "Y"
                 MOVE LN-PURDATE      TO NUM-DATE
                 MOVE END-REPORT-DATE TO SYS-DATE
                 IF (NUM-MO = S-MM) AND (NUM-YR = S-YY)
                    ADD 1 TO TOT-BYPASSED
      *             UNLOCK LN-FILE
                    GO TO NEXT-LN
                 ELSE
                    MOVE LN-PURDATE TO NDTE-DATE
                    MOVE 1          TO NDTE-HOLD
                    PERFORM INCREMENT-MONTHS
                    MOVE END-REPORT-DATE TO SYS-DATE
                    IF (NDTE-MM = S-MM) AND (NDTE-YY = S-YY)
                       ADD 1 TO TOT-BYPASSED
      *                UNLOCK LN-FILE
                       GO TO NEXT-LN.

      * COMPLIANCE WOULD LIKE TO REPORT A STATUS CODE OF "DA" FOR RECORDS
      * WHERE THE REPORTING DATE IS 6 YEARS, 8 MONTHS FROM DOFD, AND THEN
      * STOP REPORTING THE ACCOUNT THE FOLLOWING MONTH (6 YEARS, 9 MONTHS).  
      * 6 YEARS, 8 MONTHS = 80 MONTHS

           MOVE SPACES TO I-AM-STATUS-DA.
           IF LN-TRW-DOFD-DATE NOT = 0 
              MOVE LN-TRW-DOFD-DATE TO NUM-DATE
              MOVE END-REPORT-DATE  TO SYS-DATE
              PERFORM TIM365
      * SKIP REPORTING AT 6 YEARS, 9 MONTHS (81 MONTHS)
              IF ELAPSED-MONTHS NOT < 81
                 ADD 1 TO TOT-BYPASSED
      *          UNLOCK LN-FILE
                 GO TO NEXT-LN
              ELSE
                 IF ELAPSED-MONTHS = 80
                    ADD 1 TO TOT-80-DA
                    MOVE "DA" TO TRW-B-STATUS
                    MOVE "Y" TO I-AM-STATUS-DA.

      * ANY BK FILING ON OR BEFORE CUTOFF DATE OF 11/30/20 WILL BE SENT 
      * WITH A STATUS CODE OF "DA" TO DELETE THE ACCOUNT
           IF LN-BNKRPTDATE NOT = 0
              IF LN-BNKRPTDATE NOT > 20201130
                 MOVE "DA" TO TRW-B-STATUS
                 MOVE "Y" TO I-AM-STATUS-DA.

      * SAVE FIELDS USED EVERYWHERE SO YOU DONT KEEP READING IT
           PERFORM GET-LT-BANKRUPT.
           MOVE LTB-WHO-FILED         TO WHO-FILED.
           MOVE LTB-ENDORSER-FILED    TO ENDORSER-FILED.
           MOVE LTB-CHAPTER           TO BNKRPT-CHAPTER.
           MOVE LTB-REAFF-DATE        TO REAFF-DATE.
           MOVE LTB-DISCHARGE-DATE    TO DISCHARGE-DATE.
           MOVE LTB-DISCHARGE-SYSDATE TO DISCHARGE-SYSDATE.
           MOVE LTB-RESCIND-DATE      TO RESCIND-DATE.
           MOVE LTB-GROSS-BAL         TO BK-GROSS-BAL.

      * DISCHARGE
      * IF ALL SIGNERS FILED, ONLY REPORT THE MONTH OF THE DISCHARGE, SKIP
      * REPORTING AFTER THAT

           IF DISCHARGE-DATE NOT = 0 
      * IF DISCHARGE DATE IS PRIOR TO BEGINNING DATE RANGE, IT WAS
      * REPORTED LAST MONTH AND NEEDS TO BE SKIPPED THIS MONTH
              IF DISCHARGE-SYSDATE < BEG-REPORT-DATE
      * SKIP REPORTING ALL TOGETHER IF ALL SIGNERS FILED
      * IF WHO-FILED IS "S", THE LOAN MUST GET REPORTED FOR MAKER
      * IF WHO-FILED IS "M" AND A SECOND SIGNER, THE LOAN MUST GET REPORTED
      *                     FOR THE SECOND SIGNER (MOVED TO BASE)
      * IF WHO-FILED IS "B" AND A THIRD SIGNER, THE LOAN MUST GET REPORTED
      *                     FOR THE THIRD SIGNER (MOVED TO BASE)
      * IF WHO-FILED IS "B" AND ENDORSER-FILED "1", MUST BE MAKER, JOINT, AND
      *                     ENDORSER, IF NO 4TH, SKIP THE RECORD
                 IF (WHO-FILED = "B" AND LN-SSNO(3) = 0) OR
                     (WHO-FILED = "M" AND LN-SSNO(2) = 0) OR
                       (WHO-FILED = "M" AND LN-MAKERCD(2) = "E" AND
                          ENDORSER-FILED = "1" AND LN-SSNO(3) = 0) OR
                         (WHO-FILED = "B" AND ENDORSER-FILED = "1" 
                                           AND LN-SSNO(4) = 0)
                    ADD 1 TO TOT-BYPASSED
      *             UNLOCK LN-FILE
                    GO TO NEXT-LN.

       CONT-CONVERSION.
      * BWFLE DATA FOR LN_SSNO(1) IS IN STORED PROCEDURE CURSOR
      *  BW-OWNBR WILL = 0 IF ROW NOT FOUND FOR LN_SSNO(1)
      *     MOVE LN-SSNO(1) TO BW-SSNO.
      *     PERFORM READ-BW1-FILE.
      *     IF IO-FG = 9
           IF BW-OWNBR = 0 
              MOVE LN-ACCTNO TO D-NUMBER
              MOVE "*"       TO D-SERIOUS
              MOVE "INVALID BORROWER, ACCOUNT BYPASSED!" TO D-MSG1
              MOVE LN-OWNBR  TO D-BRNO
              PERFORM WRITE-DETAIL-LINE
              ADD 1 TO TOT-INCORRECT
      *       UNLOCK LN-FILE
              GO TO NEXT-LN.

      * WORLD SOLD ACCOUNTS, RAN A FIX TO SET THESE VALUES PRIOR TO A
      * TRANSFER.
      * THEY NEED TO REPORT ONCE IN A SPECIAL WAY, THEN NEVER REPORT AGAIN
      * EVEN IF THEY ARE CONFIDENTIAL, THEY MUST REPORT
      * LN-DLPOOL WILL ALWAYS START WITH 9, THEN MMYY, 90315, 90415, ETC.


      * TEST CONFIDENTIAL FLAG
           IF INCL-CONF = "N"
              IF (LN-TRW-SPECIAL-CODE = "AH" AND LN-DLPOOL > 90000)
                 NEXT SENTENCE
              ELSE
                 IF (LN-SKIP-TRW = "B")
                    NEXT SENTENCE
                 ELSE
                    IF LN-CONFIDENTCD = "Y" OR BW-CONFIDENTIAL = "Y"
                       ADD 1 TO TOT-BYPASSED
      *                UNLOCK LN-FILE
                       GO TO NEXT-LN.

           ADD 1 TO TOT-ACTIVE.

      *
           PERFORM CREATE-SUBSCRIBER-RECORDS.
      *

      * SETTLEMENT ACCOUNTS * 1/10/2024 PR#1639 FAQ38

      * NOW CHECK FOR SETTLEMENT STATUS AND FIX NECESSARY FIELDS
      * FOR ALL CASES OF "AU" TRW-B-COMMENT;
      *   CURRENT BALANCE SHOULD REPORT 0
      *   AMOUNT PAST DUE SHOULD REPORT 0
      *   SCHEDULED MONTHLY PAYMENT SHOULD CONTINUE TO REPORT 0
      *   DATE OF ACCOUNT INFO/BILLING DATE SHOULD BE DATE OF LAST
      *     TRANSACTION/PAYMENT
      *   DATE CLOSED SHOULD BE LAST TRANSACTION DATE
      *   IF NO STATUS OVERRIDE OR STATUS OVERRIDE OF 97, FORCE 64 AS STATUS
      *   IF STATUS OVERRIDE 93, FORCE 62 AS STATUS

      * IF FIND-ACTUAL-PAYMENTS WAS PERFORMED, IT SET HOLD-LAST-TRANS-DATE
      * AND TURNS ON THE READ-LP-FILE FLAG. IF NOT, YOU NEED TO PERFORM IT

           IF TRW-B-COMMENT = "AU"
              IF LN-TRW-STATUS = SPACES OR "97"
                 MOVE "64" TO TRW-B-STATUS
              ELSE
              IF LN-TRW-STATUS = "93"
                 MOVE "62" TO TRW-B-STATUS.
           IF I-AM-STATUS-DA = "Y"
              MOVE "DA" TO TRW-B-STATUS.

      * NEED THIS HERE AFTER VERY LAST STATUS CHANGES
           PERFORM UPDATE-STATUS-COUNTS.

           IF TRW-B-COMMENT = "AU"
              MOVE 0 TO TRW-B-CURBAL
                        TRW-B-AMT-PASTDUE
                        TRW-B-REGPYAMT
              IF READ-LP-FILE NOT = "Y"
                 PERFORM FIND-ACTUAL-PAYMENTS
              END-IF
              MOVE HOLD-LAST-TRANS-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY   TO TRW-B-BILL-DATE
                                      TRW-B-DATE-CLOSED.
  
      * FOR ALL "AU" TRW-B-COMMENT ACCOUNTS THAT DO NOT HAVE A
      * A STATUS CODE OVERRIDE OR THE OVERRIDE IS ANY VALUE OTHER
      * THAN 13;
      *   PAYMENT RATING SHOULD BE BLANK
      *   ORIGINAL CHARGE OFF SHOULD REPORT ORIGINAL PL AMOUNT

           IF TRW-B-COMMENT = "AU"
              IF LN-TRW-STATUS NOT = "13"
                 MOVE SPACES   TO TRW-B-PAY-RATING
                 MOVE LN-PLAMT TO TRW-B-ORIG-PLAMT
      * FOR ALL "AU" TRW-B-COMMENT ACCOUNTS THAT HAVE 13 AS STATUS
      * CODE OVERRIDE;
      *   PAYMENT RATING SHOULD BE 0
      *   ORIGINAL CHARGE OFF AMOUNT SHOULD BE 0
              ELSE
                 MOVE "0" TO TRW-B-PAY-RATING
                 MOVE 0   TO TRW-B-ORIG-PLAMT.

      * IF FIXED-LENGTH RECORDS ARE BEING REPORTED AND A RECORD DOES
      * NOT REQUIRE THE INFO FOR THE APPENDAGE SEGMENT, THE SEGMENT
      * IDENTIFIER (E.G., J1) MUST BE REPORTED AND THE REMAINDER OF THE
      * SEGMENT MUST BE BLANK FILLED.   (PAGE 3-12)

           MOVE "J1" TO TRW-J1-ID(1) TRW-J1-ID(2).
           MOVE "J2" TO TRW-J2-ID(1) TRW-J2-ID(2).
           MOVE "K1" TO TRW-K1-ID.
      *    IF GP-I-AM-MODERN AND LN-OWNBR = 3
      *       PERFORM CREATE-SEGMENT-K1.

           MOVE "K2" TO TRW-K2-ID.
           IF (LN-TRW-SPECIAL-CODE = "AH" AND LN-DLPOOL > 90000)
             OR (LN-SKIP-TRW = "B") OR (LN-CONVERCD = "Y")
               PERFORM CREATE-SEGMENT-K2.

           MOVE "K3" TO TRW-K3-ID.
           MOVE "K4" TO TRW-K4-ID.
           MOVE "L1" TO TRW-L1-ID.
           MOVE "N1" TO TRW-N1-ID.

           MOVE SPACES TO BORROWER-INFO(1) BORROWER-INFO(2).

      * PRIMARY MAKER
           MOVE BW-ADR1 TO BORROWER-ADR1(1).
           MOVE BW-ADR2 TO BORROWER-ADR2(1).
           MOVE BW-CITY TO BORROWER-CITY(1).
           MOVE BW-STATE TO BORROWER-STATE(1).
           MOVE BW-ZIP TO BORROWER-ZIP(1).

           IF LN-SSNO(2) = 0
              GO TO TEST-SSNO3.

      * IF LN-SKIP-TRW = "E", DO NOT REPORT ANY ENDORSERS
           IF LN-SKIP-TRW = "E"
              IF LN-MAKERCD(2) = "E"
                 GO TO TEST-SSNO3.

      * DISCHARGE
      * IF SECONDARY FILED, ONLY REPORT THE MONTH OF THE DISCHARGE, SKIP
      * REPORTING AFTER THAT
           IF DISCHARGE-DATE NOT = 0 
      * IF DISCHARGE DATE IS PRIOR TO BEGINNING DATE RANGE, IT WAS
      * REPORTED LAST MONTH AND NEEDS TO BE SKIPPED THIS MONTH
              IF DISCHARGE-SYSDATE < BEG-REPORT-DATE
      * IF WHO-FILED IS "S", THE LOAN MUST GET REPORTED FOR MAKER ONLY
      * IF ENDORSER-FILED IS SET, THE LOAN MUST GET REPORTED FOR MAKER ONLY
      *        (SECOND SLOT COULD NEVER BE ENDORSER SUB 2, ONLY CHECK FOR 1)
                 IF (LN-MAKERCD(2) = "J" AND WHO-FILED = "S")
                    GO TO TEST-SSNO3
                 ELSE
                    IF (LN-MAKERCD(2) = "E") AND
                                 (ENDORSER-FILED = "1" OR "B")
                       GO TO TEST-SSNO3.

           MOVE 2 TO MAKER-SUB.
           MOVE LN-SSNO(2) TO BW-SSNO.
           PERFORM GET-BORROWER.
           IF IO-FG NOT = 0
              GO TO TEST-SSNO3.

           IF LN-MAKERCD(2) = "E"
              MOVE 1 TO END-SUB.

           MOVE 1 TO J1-SUB.
           MOVE 1 TO J2-SUB.
           IF BORROWER-INFO(1) = BORROWER-INFO(2)
              PERFORM CREATE-SEGMENT-J1
           ELSE
              PERFORM CREATE-SEGMENT-J2.

      * IF WHO-FILED IS MAKER ONLY AND THERE IS A JOINT SIGNER, WE MUST
      * MOVE THE JOINT SIGNER INFORMATION TO THE BASE SEGMENT AND CLEAR
      * OUT THE J1/J2 SEGMENT
           IF DISCHARGE-DATE NOT = 0 
      * IF DISCHARGE DATE IS PRIOR TO BEGINNING DATE RANGE, IT WAS
      * REPORTED LAST MONTH IF THERE IS JOINT SIGNER, BUT MAKER ONLY FILED,
      * WE MUST MOVE THE JOINT SIGNER INFO TO THE BASE SUBSCRIBER RECORD
      * AND CONTINUE REPORTING THE JOINT SIGNER ONLY
      * OR
      * REPORTED LAST MONTH AND THERE IS AN ENDORSER SIGNER, BUT MAKER ONLY
      * FILED AND THERE ARE NO OTHER SIGNERS, MOVE ENDORSER INFO TO THE BASE
              IF DISCHARGE-SYSDATE < BEG-REPORT-DATE
                 IF (WHO-FILED = "M" AND LN-MAKERCD(2) = "J") OR
                     (WHO-FILED = "M" AND LN-MAKERCD(2) = "E" AND
                          ENDORSER-FILED = " ")
                    IF BORROWER-INFO(1) = BORROWER-INFO(2)
                       PERFORM MOVE-SEGMENT-J1
                    ELSE
                       PERFORM MOVE-SEGMENT-J2.

       TEST-SSNO3.
           IF LN-SSNO(3) = 0
              GO TO TEST-SSNO4.

      * IF LN-SKIP-TRW = "E", DO NOT REPORT ANY ENDORSERS
           IF LN-SKIP-TRW = "E"
              IF LN-MAKERCD(3) = "E"
                 GO TO TEST-SSNO4.

      * DISCHARGE
      * IF SECONDARY FILED, ONLY REPORT THE MONTH OF THE DISCHARGE, SKIP
      * REPORTING AFTER THAT
           IF DISCHARGE-DATE NOT = 0 
      * IF DISCHARGE DATE IS PRIOR TO BEGINNING DATE RANGE, IT WAS
      * REPORTED LAST MONTH AND NEEDS TO BE SKIPPED THIS MONTH
              IF DISCHARGE-SYSDATE < BEG-REPORT-DATE
      * IF WHO-FILED IS "S", THE LOAN MUST GET REPORTED FOR MAKER ONLY
      * IF ENDORSER-FILED IS SET, THE LOAN MUST GET REPORTED FOR MAKER ONLY
      *        (THIRD SLOT CAN BE ENDORSER SUB 2, CHECK FOR 1 AND 2)
                 IF (LN-MAKERCD(3) = "J" AND WHO-FILED = "S")
                    GO TO TEST-SSNO4
                 ELSE
                    IF (LN-MAKERCD(3) = "E") AND
                               (ENDORSER-FILED = "1" OR "2" OR "B")
                       GO TO TEST-SSNO4.

           MOVE 3 TO MAKER-SUB.
           MOVE LN-SSNO(3) TO BW-SSNO.
           PERFORM GET-BORROWER.
           IF IO-FG NOT = 0
              GO TO TEST-SSNO4.

           IF LN-MAKERCD(3) = "E"
              ADD 1 TO END-SUB.
           IF BORROWER-INFO(1) = BORROWER-INFO(2)
              PERFORM CREATE-SEGMENT-J1
           ELSE
              PERFORM CREATE-SEGMENT-J2.

       TEST-SSNO4.
           IF LN-SSNO(4) = 0
              GO TO TEST-CONVERSION.

      * IF LN-SKIP-TRW = "E", DO NOT REPORT ANY ENDORSERS
           IF LN-SKIP-TRW = "E"
              IF LN-MAKERCD(4) = "E"
                 GO TO TEST-CONVERSION.

      * DISCHARGE
      * IF SECONDARY FILED, ONLY REPORT THE MONTH OF THE DISCHARGE, SKIP
      * REPORTING AFTER THAT
           IF DISCHARGE-DATE NOT = 0 
      * IF DISCHARGE DATE IS PRIOR TO BEGINNING DATE RANGE, IT WAS
      * REPORTED LAST MONTH AND NEEDS TO BE SKIPPED THIS MONTH
              IF DISCHARGE-SYSDATE < BEG-REPORT-DATE
      * IF WHO-FILED IS "S", THE LOAN MUST GET REPORTED FOR MAKER ONLY
      * IF ENDORSER-FILED IS SET, THE LOAN MUST GET REPORTED FOR MAKER ONLY
      *        (FOURTH SLOT CAN BE ENDORSER SUB 2, CHECK FOR 1 AND 2)
                 IF (LN-MAKERCD(4) = "J" AND WHO-FILED = "S")
                    GO TO TEST-CONVERSION
                 ELSE
                    IF (LN-MAKERCD(4) = "E") AND
                               (ENDORSER-FILED = "1" OR "2" OR "B")
                       GO TO TEST-CONVERSION.

           IF LN-MAKERCD(4) = "E"
              ADD 1 TO END-SUB.
           MOVE 4 TO MAKER-SUB.
           MOVE LN-SSNO(4) TO BW-SSNO.
           PERFORM GET-BORROWER.
           IF IO-FG NOT = 0
              GO TO TEST-CONVERSION.

           IF BORROWER-INFO(1) = BORROWER-INFO(2)
      * HAVE NOT CREATED 2 J1 APPENDAGES YET, THEN ITS OK
              IF J1-SUB NOT > 2
                 PERFORM CREATE-SEGMENT-J1
              ELSE
      * IF YOU HAVE ALREADY CREATED 2 J1'S, THEN NO MATTER WHAT, CREATE
      * THIS WOULD BE IMPOSSIBLE TO THEN HAVE
                 PERFORM CREATE-SEGMENT-J2
            ELSE
              IF J2-SUB NOT > 2
                 PERFORM CREATE-SEGMENT-J2.

       TEST-CONVERSION.
           IF UPDATE-TYPE = "C"
              PERFORM CREATE-SEGMENT-L1.

      * ACCOUNT WAS TRANSFERRED "TO" THIS BRANCH
           IF LN-BR-TFR-FG = "Y"
              PERFORM CREATE-SEGMENT-L1-TRANSFERRED.

      * GET ORIGINAL MAKER BACK
           MOVE LN-SSNO(1) TO BW-SSNO.
           PERFORM READ-BW1-FILE.
           IF IO-FG = 0
              IF BW-EMPLOYER NOT = SPACES
                 IF LN-CONVERCD NOT = "Y"
                    PERFORM CREATE-SEGMENT-N1.

      * WORLD DOES NOT WANT THE INTERIM FLAG TO WRITE CR/LF, ONLY IF TRANSMIT
      * SO IF THEY EVER TURN ON TRANSMIT FLAG, IT WILL WORK, IF ONLY
      * INTERIM IT WRITES TO THE FILE METRO2.YYMMDD WITHOUT CR/LF
           IF TRW-INFO-CR-LF = "Y"
              ADD 1 TO TRW-E-KEY BASE-COUNT
              PERFORM WRITE-THE-TRANSMIT-FILE
           ELSE
              ADD 1 TO TRW-KEY BASE-COUNT
              PERFORM WRITE-TRW-FILE.

      * SWITCH CONNECTION TO UPDATE_CONN FOR UPDATES; SWITCH BACK TO C1 AFTER UPDATES
           IF INTERIM-ONLY = "Y"
              MOVE "N" TO LN-INTERIM-TRW
              MOVE '2' TO SQL-UPDATE-CONN-USE-SW   *> SWITCH TO UPDATE_CONN CONNECTION
              PERFORM SQL-SWAP-UPDATE-CONNECTION
              PERFORM REWRITE-LN3-FILE
              PERFORM UPDATE-LM-FILE
              MOVE '1' TO SQL-UPDATE-CONN-USE-SW   *> SWITCH TO C1 CONNECTION
              PERFORM SQL-SWAP-UPDATE-CONNECTION
              PERFORM SETUP-DETAIL-LINE.


      *    UNLOCK LN-FILE.
           GO TO NEXT-LN.

       END-OF-GROUP.
           PERFORM CLOSE-LN3-FILE.
           PERFORM CLOSE-LM1-FILE.
           PERFORM CLOSE-BW1-FILE.
           PERFORM CLOSE-BM1-FILE.
           PERFORM CLOSE-LP1-FILE.
           PERFORM CLOSE-LSX1-FILE.
           PERFORM CLOSE-LSM1-FILE.
           PERFORM CLOSE-LTB1-FILE.
           GO TO NEXT-GROUP-LOC.

       END-ROUTINE.
           PERFORM CREATE-TRAILER-RECORD.

           PERFORM PRINT-RANGE-LINES.
           GO TO END-PROGRAM.

      ***********************************
       INITIALIZATION SECTION.
      ***********************************
           MOVE METRO2-QUEUE-POS TO Q-POS.
           MOVE METRO2-COPIES-POS TO C-POS.
           MOVE METRO2-PRU-POS   TO P-POS.
           MOVE SPACES TO Q-BUF C-BUF P-BUF.

       COPY "LIBGB/EOINIT.CPY".

           PERFORM OPEN-CD1-FILE.
           PERFORM OPEN-BR-FILE.
           PERFORM OPEN-GR1-FILE.
           PERFORM OPEN-LC1-FILE
           PERFORM OPEN-SP1-FILE
           PERFORM OPEN-PR-FILE.
           PERFORM OPEN-GB-FILE.

      * FROM MENU OR THE ACTUAL BATCH RUN, NOT AUDIT !
           IF EXT-ROUTE-BUF = "00" OR "70"
              IF INTERIM-ONLY NOT = "Y"
                 PERFORM VERIFY-EOM-RUN
                 IF EOM-RUN = "N"
                    GO TO ENDIT.

           IF EXT-ROUTE-BUF = "00"
              MOVE "FILE CREATE IN PROCESS" TO WR-BUF
              MOVE MESS-LIST TO WR-LIST
              PERFORM CALL-WRFORM.

           MOVE EXT-FILPATH-BASE TO TRW-PATH-BASE
                                    TRW-PATH-2-BASE
                                    TRW-E-PATH-BASE
                                    TRW-E2-PATH-BASE
                                    TRW-WORLD-I-PATH-BASE.

           MOVE EXT-FILPATH-MACHINE TO TRW-PATH-MACHINE
                                       TRW-PATH-2-MACHINE
                                       TRW-E-PATH-MACHINE
                                       TRW-E2-PATH-MACHINE
                                       TRW-WORLD-I-PATH-MACHINE.

      * WORLD USES BRANCH/GROUP EXTENSIONS ON THEIR TRWFILE
           MOVE "." TO TRW-PATH-WORLD-DOT
           IF GROUP-FLAG = "Y"
              MOVE ENT-GROUP TO TRW-PATH-WORLD-GROUP
           ELSE
              IF BEG-BR = 0 AND END-BR = 9999
                 MOVE "ALL" TO TRW-PATH-WORLD-GROUP
              ELSE
                 MOVE BEG-BR TO TRW-PATH-WORLD-BRNO.

           IF CREDIT-BUREAU-ID NOT = 1
              MOVE CREDIT-BUREAU-ID TO TRW-E2-PATH-ID TRW-PATH-ID
              IF TRW-INFO-CR-LF = "Y"
                 MOVE TRW-E2-PATH TO TRW-E-PATH
              ELSE
                 MOVE TRW-PATH-2 TO TRW-PATH.

      * WORLD DOES NOT WANT THE INTERIM FLAG TO USE METRO2.E, ONLY IF TRANSMIT
      * THEY WANT THE INTERIM PATH TO BE METRO2.YYMMDD 
      * EVERYONE WITH TRANSMIT FLAG "Y" WILL USE CR/LF FILE
           IF TRW-INFO-CR-LF = "Y"
              PERFORM OPEN-TRW-E-FILE-OUTPUT
           ELSE
              IF INTERIM-ONLY = "Y"
                 MOVE TRW-PATH-WORLD-INTERIM TO TRW-PATH
              END-IF
              PERFORM OPEN-TRW-FILE-OUTPUT.

           MOVE 0 TO TOT-RECORDS TOT-80-DA
                     TOT-ACTIVE TOT-DELETED TOT-BYPASSED
                     TOT-ZBALS TOT-INCORRECT.

           MOVE 1 TO SUB.
           PERFORM ZERO-AGEING 11 TIMES.
           MOVE 1 TO SUB.
           PERFORM ZERO-REPORTED 10 TIMES.

           MOVE EXT-CONAME-CONAME TO H-NAME.
           MOVE EXT-CONAME-SYSDATE TO H-DATE.
           MOVE EXT-CONAME-USER-ID TO H-USERID.
           PERFORM HEAD-PAGE.

      * LOAD WS-LC1-TBL WITH VALID LCFILE CODES
           PERFORM COUNT-LC1-FILE.
           INITIALIZE WS-LC1-TBL.
           MOVE 0   TO QLC1-WBEG-CODE.
           MOVE 999 TO QLC1-WEND-CODE.
           PERFORM START-LC1-FILE.
           PERFORM UNTIL IO-BAD
              PERFORM READ-LC1-FILE-NEXT
              IF NOT IO-BAD
                ADD 1 TO WS-LC1-TBL-CTR
                MOVE LC-CODE TO WS-LC1-TBL-CODE(WS-LC1-TBL-CTR)
                MOVE LC-SKIP-TRW TO WS-LC1-TBL-SKIP-TRW(WS-LC1-TBL-CTR)
              END-IF
           END-PERFORM.
           PERFORM CLOSE-LC1-FILE.

           PERFORM SQL-OPEN-UPDATE-CONNECTION.

           PERFORM ARRAYSP-LOAD.

           GO TO EXIT-INITIALIZE.
       ENDIT.
           MOVE "X" TO EXT-EOBUF-ERRCD.
       EXIT-INITIALIZE.
           EXIT.

      **************************
       VERIFY-EOM-RUN SECTION.
      **************************
           MOVE "Y" TO EOM-RUN.
           MOVE END-REPORT-DATE TO DATE-YYYYMMDD.

           IF GROUP-FLAG = "N"
              MOVE BEG-BR TO BR-NO
              PERFORM START-BR-FILE
              GO TO VERIFY-NEXT-BRANCH.

           MOVE ENT-GROUP TO GR-ID.
           PERFORM SEARCH-GR-INIT.
       VERIFY-NEXT-GROUP.
           IF GROUP-FLAG NOT = "Y"
              GO TO VERIFY-NEXT-BRANCH.

           PERFORM SEARCH-GR-NEXT.
           IF WGR-SRESULT = 0
              GO TO EXIT-VERIFY-EOM-RUN.

           MOVE WGR-SRESULT TO BR-NO.
           PERFORM READ-BR-FILE.
           IF IO-FG NOT = 0
              GO TO IO-ERROR.

           GO TO VERIFY-MOVE-BRANCH-PATH.
       VERIFY-NEXT-BRANCH.
           PERFORM READ-BR-FILE-NEXT.
           IF IO-FG = 9 OR BR-NO > END-BR
              GO TO EXIT-VERIFY-EOM-RUN.
       VERIFY-MOVE-BRANCH-PATH.

           MOVE "Y"              TO GB-PATH-OVERRIDE.
           MOVE EXT-FILPATH-BASE TO GB-ALL-BASE.
           MOVE BR-MACHINE       TO GB-ALL-MACHINE.
           MOVE BR-DATA-PATH     TO GB-ALL-DATA.
           MOVE GB-ALL-PATH      TO GB-PATH.

           MOVE GB-PATH-OWNBR  TO GB-BRNO.
           MOVE 1              TO GB-NO.
           PERFORM READ-GB-FILE.
           IF IO-BAD
               GO TO IO-ERROR.

           PERFORM CONVERT-YYYYMMDD-TO-YYYYMM.
           IF GB-EOM-TAG-CCYYMM NOT = DATE-YYYYMM
              MOVE "N" TO EOM-RUN
              MOVE "*" TO D-SERIOUS
              MOVE "EOM NOT RUN IN BRANCH" TO D-MSG1
              MOVE BR-NO TO D-BRNO
              PERFORM WRITE-DETAIL-LINE
              STRING "EOM NOT RUN IN BRANCH: ",BR-NO DELIMITED BY
               "  " INTO MESS
              PERFORM SEND-MESS
              GO TO EXIT-VERIFY-EOM-RUN.              


           GO TO VERIFY-NEXT-GROUP.

       EXIT-VERIFY-EOM-RUN.
           EXIT.

      ***************************
       ENTER-PARAMETERS SECTION.
      ***************************
       ENTER-PARM.

           IF VDUSTATUS = "1U"
              GO TO INTERIM-FLAG.

           MOVE EXT-CONAME-SYSDATE TO ALP-DATE.
           PERFORM CONVERT-ALPDATE-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO CREATE-DATE.

       ENTER-ID.
           MOVE "ENNN040ID." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "1<"
              PERFORM TRW-INFO-SCAN
              IF IO-FG NOT = 0
                 GO TO ENTER-ID
              ELSE
                 MOVE "SN N040ID." TO VDU
                 MOVE TWISCN-TRW-KEY TO VDUNUM0
                 PERFORM SCREENIO
                 MOVE TWISCN-TRW-KEY TO VDUNUM0.
           IF VDUSTATUS NOT = "00" AND NOT = "1D"
              GO TO ENTER-ID.
           MOVE VDUNUM0 TO CREDIT-BUREAU-ID TRW-INFO-ID.
           PERFORM OPEN-TRW-INFO-FILE.
           PERFORM READ-TRW-INFO-FILE.
           PERFORM CLOSE-TRW-INFO-FILE.
           IF IO-FG NOT = 0
              MOVE "INVALID TRW INFO ID" TO MESS
              PERFORM SEND-MESS
              GO TO ENTER-ID.
       BR-01.
           MOVE "E  A000BR1." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "16" GO TO ALL-BR.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO ENTER-ID.
           IF VDUSTATUS = "1<"
              MOVE "WI/GRSCAN" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH GRSCAN-BUF EXIT-PATHNAME
              CANCEL FORM-PROGX
              IF GRSCAN-STATUS NOT = "00"
                 GO TO BR-01
              ELSE
                 MOVE "S  A000BR1." TO VDU
                 MOVE GRSCAN-KEY TO VDUBUF GR1-KEY
                 PERFORM SCREENIO
                 MOVE "00" TO VDUSTATUS.
           IF NOT (VDUSTATUS = "00" OR "1D") GO TO BR-01.

      D    STOP MESS.
           MOVE VDUBUF TO WGR-WORD ENT-GROUP.
           IF WGR-WORD-ZERO
              GO TO BRANCH-IS-NUMERIC.
           MOVE 0 TO WGR-MIN-LEVEL.
           PERFORM CHECK-MEMBER.
           IF WGR-ERR > 0
              MOVE WGR-MSG(WGR-ERR) TO MESS
              PERFORM SEND-MESS
              GO TO BR-01.
           IF WGR-TYPE = "A"
              MOVE "S  A000BR2." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO
              MOVE "Y" TO GROUP-FLAG
              MOVE 0 TO BEG-BR
              MOVE 9999 TO END-BR
              GO TO CL-01.
       BRANCH-IS-NUMERIC.
           MOVE "N" TO GROUP-FLAG.
           MOVE WGR-SRESULT TO BEG-BR.
           MOVE "SN N040BR1." TO VDU.
           MOVE BEG-BR TO VDUNUM0.
           PERFORM SCREENIO.
       BR-02.
           MOVE "ENNN040BR2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO BR-01.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO BR-02.
           MOVE VDUNUM0 TO END-BR.
           IF BEG-BR > END-BR
              MOVE "INVALID BRANCH RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO BR-01.
           GO TO CL-01.
       ALL-BR.
           MOVE "SNNN040BR1." TO VDU.
           MOVE 0 TO BEG-BR VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN040BR2." TO VDU.
           MOVE 9999 TO END-BR VDUNUM0.
           PERFORM SCREENIO.
           MOVE "N" TO GROUP-FLAG.
       CL-01.
           MOVE "ENNN020LC1." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "16" GO TO ALL-CL.
           IF VDUSTATUS = "1U" GO TO BR-02.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO CL-01.
           MOVE VDUNUM0 TO BEG-CL.
       CL-02.
           MOVE "ENNN020LC2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO CL-01.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO CL-02.
           MOVE VDUNUM0 TO END-CL.
           IF BEG-CL > END-CL
              MOVE "INVALID CLASS RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO CL-01.
           GO TO ACCT1.
       ALL-CL.
           MOVE "SNNN020LC1." TO VDU.
           MOVE 0 TO BEG-CL VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN020LC2." TO VDU.
           MOVE 99 TO END-CL VDUNUM0.
           PERFORM SCREENIO.
       ACCT1.
           MOVE "ENNN060AC1." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "16" GO TO ALLACC.
           IF VDUSTATUS = "1U" GO TO CL-02.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO ACCT1.
           MOVE VDUNUM0 TO BEG-ACCOUNT.
       ACCT2.
           MOVE "ENNN060AC2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO ACCT1.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO ACCT2.
           MOVE VDUNUM0 TO END-ACCOUNT.
           IF BEG-ACCOUNT > END-ACCOUNT
              MOVE "INVALID ACCOUNT RANGE" TO MESS
              PERFORM SEND-MESS
              GO TO ACCT1.
           GO TO BEG-DT.
       ALLACC.
           MOVE "SNNN060AC1." TO VDU.
           MOVE 0 TO BEG-ACCOUNT VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN060AC2." TO VDU.
           MOVE 999999 TO END-ACCOUNT VDUNUM0.
           PERFORM SCREENIO.

       BEG-DT.
           IF EXT-ROUTE-BUF NOT = "00"
              GO TO END-DT.

           MOVE "ERNM060DT1." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO ACCT2.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO BEG-DT.
           MOVE VDU-DATE-YYYYMMDD TO BEG-REPORT-DATE.
           IF BEG-REPORT-DATE = 0
              GO TO BEG-DT.
       END-DT.
           IF EXT-ROUTE-BUF NOT = "00"
              GO TO ENTER-DEL-FLAG.

           MOVE "ERNM060DT2." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO BEG-DT.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO END-DT.
           MOVE VDU-DATE-YYYYMMDD TO END-REPORT-DATE.
           IF END-REPORT-DATE = 0
              GO TO END-DT.

      *----------------------------------------------------------------
       ENTER-DEL-FLAG.
           MOVE "E  A010DELFLAG." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U"
              IF EXT-ROUTE-BUF NOT = "00"
                 GO TO ACCT2
              ELSE
                 GO TO END-DT.
           IF NOT (VDUSTATUS = "00" OR "1D")
              GO TO ENTER-DEL-FLAG.

           MOVE VDUBUF TO DEL-FLAG.

           IF DEL-FLAG NOT = "Y" AND NOT = "N"
              GO TO ENTER-DEL-FLAG.

           IF DEL-FLAG = "N"
              GO TO CONF-ACCT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SETUP NEXT MONTH DATE:
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE END-REPORT-DATE TO NDTE-DATE.
           MOVE 1               TO NDTE-DD.
           MOVE 1               TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO NEXT-MO-AGEING-DATE.
      *-----------------------------------------------------------------
       CONF-ACCT.
           MOVE "E  A010CONF." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO ENTER-DEL-FLAG
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D"
              GO TO CONF-ACCT.
           MOVE VDUBUF TO INCL-CONF.
           IF INCL-CONF NOT = "Y" AND NOT = "N" GO TO CONF-ACCT.
           IF INTERIM-ONLY = " "
              MOVE "S  A010INT." TO VDU
              MOVE "N" TO INTERIM-ONLY VDUBUF
              PERFORM SCREENIO.
           IF EXT-ROUTE-BUF NOT = "00"
              MOVE "U" TO UPDATE-TYPE
      * IF YOU DONT STOP WHILE IN BATCH INPUT, YOU CAN NEVER UP ARROW
      * CAUSE BATCH INPUT DOES NOT STOP ON THE ACCEPT BUF !!!
              GO TO INTERIM-FLAG.
           IF EXT-ROUTE-BUF = "00"
              GO TO EXIT-PARM.
       U-OR-C.
           MOVE "E  A010TYP." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO CONF-ACCT.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D" GO TO U-OR-C.
           MOVE VDUBUF TO UPDATE-TYPE.
           IF UPDATE-TYPE NOT = "U" AND NOT = "C"
              GO TO U-OR-C.
       INTERIM-FLAG.
           MOVE "E  A010INT." TO VDU.
           PERFORM SCREENIO.
           IF VDUSTATUS = "10" GO TO EXIT-PARM.
           IF VDUSTATUS = "1U" GO TO U-OR-C.
           IF VDUSTATUS = "1>" GO TO EXIT-PARM.
           IF VDUSTATUS NOT = "00" AND NOT = "1D"
              GO TO INTERIM-FLAG.
           MOVE VDUBUF TO INTERIM-ONLY.
           IF INTERIM-ONLY NOT = "Y" AND NOT = "N"
              GO TO INTERIM-FLAG.

           MOVE SPACES TO TRW-E-DATE.
           IF INTERIM-ONLY = "Y"
              MOVE EXT-FILPATH-BASE    TO TRW-E-PATH-BASE
              MOVE EXT-FILPATH-MACHINE TO TRW-E-PATH-MACHINE
      * METRO2.E.YYMMDD
              MOVE "." TO TRW-E-PATH-PERIOD
              MOVE CREATE-DATE TO NUM-DATE
              MOVE NUM-YR TO TRW-E-PATH-YY
              MOVE NUM-MO TO TRW-E-PATH-MM
              MOVE NUM-DA TO TRW-E-PATH-DD
              MOVE TRW-E-PATH TO ACCESS-BUF
      * INTERIM BUT NOT TRANSFER
      * METRO2.YYMMDD
              IF TRW-INFO-CR-LF = "N"
                 MOVE NUM-YR TO TRW-WORLD-I-PATH-YR
                 MOVE NUM-MO TO TRW-WORLD-I-PATH-MO
                 MOVE NUM-DA TO TRW-WORLD-I-PATH-DA
                 MOVE TRW-PATH-WORLD-INTERIM TO TRW-PATH ACCESS-BUF
              END-IF
              PERFORM ACCESS-CALL
              IF STAT = "00"
                 MOVE "FILE ALREADY EXIST FOR TODAYS DATE" TO MESS
                 PERFORM SEND-MESS
                 GO TO INTERIM-FLAG.

       EXIT-PARM.
           EXIT.

      ***********************
       TRW-INFO-SCAN SECTION.
      ***********************

           MOVE 0           TO TWISCN-TRW-KEY.
           MOVE "WI/TWISCN" TO FORM-NAM.
           CALL FORM-PROGX USING FORM-PATH TWISCN-BUF EXIT-PATHNAME.
           CANCEL FORM-PROGX.

           IF  TWISCN-TRW-KEY = 0
              MOVE 9 TO IO-FG
           ELSE
              MOVE 0 TO IO-FG.

      ****************************************
       EO-EXEC-AUDIT SECTION.
      ****************************************
      * FIRST DATE OF REPORTING PERIOD
           MOVE EXT-EOBUF-DATE1 TO BEG-REPORT-DATE.
      * LAST DATE OR REPORTING PERIOD
           MOVE EXT-EOBUF-DATE2 TO END-REPORT-DATE.

      * CREATE DATE = DATE TAPE IS CREATED
           MOVE EXT-CONAME-SYSDATE TO ALP-DATE.
           PERFORM CONVERT-ALPDATE-TO-YYYYMMDD.
           MOVE DATE-YYYYMMDD TO CREATE-DATE.


           MOVE SPACES TO TRW-E-DATE TRW-WORLD-I-DATE.
           IF INTERIM-ONLY = "Y"
              MOVE EXT-FILPATH-BASE TO TRW-E-PATH-BASE
              MOVE EXT-FILPATH-MACHINE TO TRW-E-PATH-MACHINE
              MOVE "." TO TRW-E-PATH-PERIOD
              MOVE CREATE-DATE TO NUM-DATE
      * METRO2.E.YYMMDD
              MOVE NUM-YR TO TRW-E-PATH-YY
              MOVE NUM-MO TO TRW-E-PATH-MM
              MOVE NUM-DA TO TRW-E-PATH-DD
              MOVE TRW-E-PATH TO ACCESS-BUF
      * INTERIM BUT NOT TRANSFER
      * ../../ED/METRO2.YYMMDD
              IF TRW-INFO-CR-LF = "N"
                 MOVE NUM-YR TO TRW-WORLD-I-PATH-YR
                 MOVE NUM-MO TO TRW-WORLD-I-PATH-MO
                 MOVE NUM-DA TO TRW-WORLD-I-PATH-DA
                 MOVE TRW-PATH-WORLD-INTERIM TO TRW-PATH ACCESS-BUF
              END-IF
              PERFORM ACCESS-CALL
              IF STAT = "00"
                 MOVE "FILE ALREADY EXIST FOR TODAYS DATE" TO MESS
                 PERFORM SEND-MESS
                 MOVE "X" TO EXT-EOBUF-ERRCD.

           MOVE CREDIT-BUREAU-ID TO TRW-INFO-ID.
           PERFORM OPEN-TRW-INFO-FILE.
           PERFORM READ-TRW-INFO-FILE.
           PERFORM CLOSE-TRW-INFO-FILE.
           IF IO-FG NOT = 0
              MOVE "CREDIT BUREAU ID DOES NOT EXIST" TO MESS
              PERFORM SEND-MESS
              MOVE "X" TO EXT-EOBUF-ERRCD.

           IF DEL-FLAG NOT = "Y"
              MOVE EXT-EOBUF-DATE2 TO AGEING-DATE CEPP2-DATE
              GO TO EXIT-EO-EXEC-AUDIT.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SETUP NEXT MONTH DATE (WORLD ONLY, FOR CORRECT EOM AGEING):
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
           MOVE EXT-EOBUF-DATE2 TO NDTE-DATE.
           MOVE 1               TO NDTE-DD.
           MOVE 1               TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           MOVE NDTE-DATE TO NEXT-MO-AGEING-DATE.

       EXIT-EO-EXEC-AUDIT.
           EXIT.

      ***************************
       DISPLAY-PARAMETERS SECTION.
      ***************************
           MOVE "S  A040ID." TO VDU.
           MOVE CREDIT-BUREAU-ID TO VDUBUF.
           PERFORM SCREENIO.
           IF GROUP-FLAG = "Y"
              MOVE "S  A000BR1." TO VDU
              MOVE ENT-GROUP TO VDUBUF
              PERFORM SCREENIO
              MOVE "S  A000BR2." TO VDU
              MOVE SPACES TO VDUBUF
              PERFORM SCREENIO
           ELSE
              MOVE "SNNN040BR1." TO VDU
              MOVE BEG-BR TO VDUNUM0
              PERFORM SCREENIO
              MOVE "SNNN040BR2." TO VDU
              MOVE END-BR TO VDUNUM0
              PERFORM SCREENIO.

           MOVE "SNNN020LC1." TO VDU.
           MOVE BEG-CL TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN020LC2." TO VDU.
           MOVE END-CL TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN060AC1." TO VDU.
           MOVE BEG-ACCOUNT TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "SNNN060AC2." TO VDU.
           MOVE END-ACCOUNT TO VDUNUM0.
           PERFORM SCREENIO.
           MOVE "S  A010DELFLAG." TO VDU.
           MOVE DEL-FLAG TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A010CONF." TO VDU.
           MOVE INCL-CONF TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A010TYP." TO VDU.
           MOVE UPDATE-TYPE TO VDUBUF.
           PERFORM SCREENIO.
           MOVE "S  A010INT." TO VDU.
           MOVE INTERIM-ONLY TO VDUBUF.
           PERFORM SCREENIO.

      ********************************************
       CREATE-HEADER-RECORD SECTION.
      ********************************************

           MOVE SPACES TO TRW-REC.

           MOVE 1364     TO TRW-H-RDW.
           MOVE "HEADER" TO TRW-H-ID.

           MOVE TRW-INFO-EQUIFAX-ID  TO TRW-H-EQUIFAX-ID.
           MOVE TRW-INFO-EXPERIAN-ID TO TRW-H-EXPERIAN-ID.
           MOVE TRW-INFO-TUC-ID      TO TRW-H-TRANSUNION-ID.
           MOVE TRW-INFO-INNOVIS-ID  TO TRW-H-INNOVIS-ID.
           MOVE END-REPORT-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY        TO TRW-H-ACTIVITY-DATE
                                        ACTIVITY-MMDDYYYY.
           MOVE CREATE-DATE          TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY        TO TRW-H-DATE-CREATED.
           MOVE 07282003             TO TRW-H-PROGRAM-DATE.
           MOVE 07282003             TO TRW-H-REVISION-DATE.

           MOVE TRW-INFO-REPORTER-NAME    TO TRW-H-REPORTER-NAME.
           MOVE TRW-INFO-REPORTER-ADDRESS TO TRW-H-REPORTER-ADR.
           MOVE TRW-INFO-REPORTER-PHONE   TO TRW-H-REPORTER-PHONE.

           MOVE "PARADATA"                TO TRW-H-SOFTWARE-VENDOR.

           MOVE SPACES                    TO TRW-H-SOFTWARE-VERSION.

      * WORLD DOES NOT WANT THE INTERIM FLAG TO WRITE CR/LF, ONLY IF TRANSMIT
      * SO IF THEY EVER TURN ON TRANSMIT FLAG, IT WILL WORK, IF ONLY
      * INTERIM IT WRITES TO THE FILE METRO2.YYMMDD WITHOUT CR/LF
           IF TRW-INFO-CR-LF = "Y"
              MOVE 1 TO TRW-E-KEY
              PERFORM WRITE-THE-TRANSMIT-FILE
           ELSE
              MOVE 1 TO TRW-KEY
              PERFORM WRITE-TRW-FILE.

      ********************************************
       CREATE-TRAILER-RECORD SECTION.
      ********************************************

           MOVE SPACES TO TRW-REC.

           MOVE 1364 TO TRW-T-RDW.

           MOVE "TRAILER" TO TRW-T-ID.

      * (3) TOTAL BASE RECORDS
           MOVE BASE-COUNT TO TRW-T-RECORDS.

      * (4) AND (5) FILLER RESERVED
      * (6) TOTAL J1 SEGMENTS
           MOVE J1-COUNT TO TRW-T-TOT-J1.

      * (7) TOTAL J2 SEGMENTS
           MOVE J2-COUNT TO TRW-T-TOT-J2.

      * (8) BLOCK COUNT
           MOVE 0 TO TRW-T-BLOCKS.

      * (9) TOTAL OF STATUS CODE "DA"
           MOVE DA-COUNT TO TRW-T-TOT-DA.
      * (10) TOTAL OF STATUS CODE "05"
           MOVE 05-COUNT TO TRW-T-TOT-05.
      * (11) TOTAL OF STATUS CODE "11"
           MOVE 11-COUNT TO TRW-T-TOT-11.
      * (12) TOTAL OF STATUS CODE "13"
           MOVE 13-COUNT TO TRW-T-TOT-13.
      * (13) TOTAL OF STATUS CODE "61"
           MOVE 61-COUNT TO TRW-T-TOT-61.
      * (14) TOTAL OF STATUS CODE "62"
           MOVE 62-COUNT TO TRW-T-TOT-62.
      * (15) TOTAL OF STATUS CODE "63"
           MOVE 63-COUNT TO TRW-T-TOT-63.
      * (16) TOTAL OF STATUS CODE "64"
           MOVE 64-COUNT TO TRW-T-TOT-64.
      * (17) TOTAL OF STATUS CODE "65"
           MOVE 65-COUNT TO TRW-T-TOT-65.
      * (18) TOTAL OF STATUS CODE "71"
           MOVE 71-COUNT TO TRW-T-TOT-71.
      * (19) TOTAL OF STATUS CODE "78"
           MOVE 78-COUNT TO TRW-T-TOT-78.
      * (20) TOTAL OF STATUS CODE "80"
           MOVE 80-COUNT TO TRW-T-TOT-80.
      * (21) TOTAL OF STATUS CODE "82"
           MOVE 82-COUNT TO TRW-T-TOT-82.
      * (22) TOTAL OF STATUS CODE "83"
           MOVE 83-COUNT TO TRW-T-TOT-83.
      * (23) TOTAL OF STATUS CODE "84"
           MOVE 84-COUNT TO TRW-T-TOT-84.
      * (24) TOTAL OF STATUS CODE "88"
           MOVE 88-COUNT TO TRW-T-TOT-88.
      * (25) TOTAL OF STATUS CODE "89"
           MOVE 89-COUNT TO TRW-T-TOT-89.
      * (26) TOTAL OF STATUS CODE "93"
           MOVE 93-COUNT TO TRW-T-TOT-93.
      * (27) TOTAL OF STATUS CODE "94"
           MOVE 94-COUNT TO TRW-T-TOT-94.
      * (28) TOTAL OF STATUS CODE "95"
           MOVE 95-COUNT TO TRW-T-TOT-95.
      * (29) TOTAL OF STATUS CODE "96"
           MOVE 96-COUNT TO TRW-T-TOT-96.
      * (30) TOTAL OF STATUS CODE "97"
           MOVE 97-COUNT TO TRW-T-TOT-97.

      * (31) TOTAL OF ECOA CODE "Z"
           MOVE Z-COUNT TO TRW-T-TOT-ECOA-Z.

      * (32) TOTAL EMPLOYMENT SEGMENTS
           MOVE N1-COUNT TO TRW-T-TOT-N1.
      * (33) TOTAL ORIG CREDITOR SEGMENTS
           MOVE K1-COUNT TO TRW-T-TOT-K1.
      * (34) TOTAL PURCHASED/SOLD TO  SEGMENTS
           MOVE K2-COUNT TO TRW-T-TOT-K2.
      * (35) TOTAL MORTGAGE SEGMENTS
           MOVE K3-COUNT TO TRW-T-TOT-K3.
      * (36) TOTAL SPECIAL PAY SEGMENTS
           MOVE K4-COUNT TO TRW-T-TOT-K4.
      * (37) TOTAL CHANGE SEGMENTS
           MOVE L1-COUNT TO TRW-T-TOT-L1.
      * (38) TOTAL VALID SSNO
           MOVE SSNO-COUNT TO TRW-T-TOT-SSNO-ALL.
      * (39) TOTAL VALID SSNO BASE
           MOVE BASE-SSNO-COUNT TO TRW-T-TOT-SSNO-BASE.
      * (40) TOTAL VALID SSNO J1
           MOVE J1-SSNO-COUNT TO TRW-T-TOT-SSNO-J1.
      * (41) TOTAL VALID SSNO J2
           MOVE J2-SSNO-COUNT TO TRW-T-TOT-SSNO-J2.
      * (42) TOTAL VALID BDATES
           MOVE BDATE-COUNT TO TRW-T-TOT-BDATE-ALL.
      * (43) TOTAL VALID BDATES BASE
           MOVE BASE-BDATE-COUNT TO TRW-T-TOT-BDATE-BASE.
      * (44) TOTAL VALID BDATES J1
           MOVE J1-BDATE-COUNT TO TRW-T-TOT-BDATE-J1.
      * (45) TOTAL VALID BDATES J2
           MOVE J2-BDATE-COUNT TO TRW-T-TOT-BDATE-J2.
      * (46) TOTAL TELEPHONE NUMBERS ALL SEGMENTS
           MOVE PHONE-COUNT TO TRW-T-TOT-PHONE.

      * WORLD DOES NOT WANT THE INTERIM FLAG TO WRITE CR/LF, ONLY IF TRANSMIT
      * SO IF THEY EVER TURN ON TRANSMIT FLAG, IT WILL WORK, IF ONLY
      * INTERIM IT WRITES TO THE FILE METRO2.YYMMDD WITHOUT CR/LF
           IF TRW-INFO-CR-LF = "Y"
              ADD 1 TO TRW-E-KEY
              PERFORM WRITE-THE-TRANSMIT-FILE
           ELSE
              ADD 1 TO TRW-KEY
              PERFORM WRITE-TRW-FILE.


      ********************************************
       CREATE-SUBSCRIBER-RECORDS SECTION.
      ********************************************

      * RESET THE FLAG THAT YOU ALREADY READ THE LP FILE, ADDED
      * THIS FOR SETTLEMENT ACCOUNTS THAT ALSO NEEDED TO READ LP PREVIOUS
           MOVE "N" TO READ-LP-FILE.

           PERFORM COMPUTE-AGEING-CAT.
           PERFORM LOAN-CALCULATIONS.

           IF (LN-REPOCD = "X" OR "S" OR "V") OR
               (LN-ACTIONCD = "REPO") OR (LN-REPODATE NOT = 0)
              PERFORM FIND-VOLUNTARY-FLAG.

           MOVE SPACES TO TRW-REC.

           MOVE 1364 TO TRW-B-RDW.

           MOVE 1 TO TRW-B-PROC-INDICATOR.
           MOVE CREATE-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-DATE-STAMP.
           PERFORM GET-TIME.
           MOVE HH-MM-SS TO TRW-B-TIME-STAMP.

           MOVE 0 TO TRW-B-CORRECTION.

      * (5) IDENTIFICATION NUMBER X(20)

      * NOTE: THIS IDENTIFICATION NUMBER (LAST 4) GETS CHANGED BELOW IF YOU
      *       ARE A TRANSFERRED ACCOUNT. FIRST MONTH REPORTING AFTER
      *       TRANSFER THIS BASE ACCOUNT # NEEDS TO BE OLD BRANCH #
      *       AND A "L1" SEGMENT WILL BE CREATED WITH THE NEW BRANCH #.
      *       SUBSEQUENT MONTHS WILL BE REAL BRANCH

           MOVE TRW-INFO-GRANTOR-CODE TO TRW-B-IDENT-NO.
           IF TRW-INFO-IDENT-BRNO = "Y"
              MOVE 0        TO TRW-B-IDENT-NO1
              MOVE LN-OWNBR TO TRW-B-IDENT-NO2.

      * (6) CYCLE IDENTIFIER
           MOVE SPACES TO TRW-B-CYCLE.

      * (7) CONSUMER ACCOUNT NUMBER
      *
      * NOTE: THIS CONSUMER ACCOUNT NUMBER GETS CHANGED BELOW IF YOU
      *       ARE A TRANSFERRED ACCOUNT. FIRST MONTH REPORTING AFTER
      *       TRANSFER THIS BASE ACCOUNT # NEEDS TO BE OLD ACCOUNT #
      *       AND A "L1" SEGMENT WILL BE CREATED WITH THE NEW ACCOUNT #.
      *       SUBSEQUENT MONTHS WILL BE REAL NEW ACCOUNT #

           MOVE 0             TO TRW-B-ACCTNO.
           MOVE LN-OWNBR      TO TRW-B-W-BRNO.
      * ACCTNO MUST CONTINUE TO HAVE THE 01 SEQUENCE 
           MOVE LN-ACCTNO     TO WS-NEW-NUMBER.
           MOVE 01            TO WS-NEW-SEQNO.
           MOVE WS-A15-ACCTNO TO TRW-B-W-ACCT.

           INSPECT TRW-B-ACCTNOX REPLACING ALL " " BY "0".
           INSPECT TRW-B-ACCTNO REPLACING ALL " " BY "0".

      * (8) PORTFOLIO TYPE (73)
           MOVE "CO"      TO CD-TYPE.
           MOVE LN-COLLCD TO CD-CODE.
           PERFORM READ-CD1-FILE.
           IF IO-FG = 9
              MOVE LN-ACCTNO TO D-NUMBER
              MOVE "*"       TO D-SERIOUS
              MOVE "CREATED WITH INVALID COLLATERAL" TO D-MSG1
              MOVE LN-OWNBR TO D-BRNO
              PERFORM WRITE-DETAIL-LINE
              MOVE "02" TO CD-CO-TRW.

           MOVE "I" TO TRW-B-PTYPE.
           IF CD-CO-TRW = "26"
              MOVE "M" TO TRW-B-PTYPE.

      * (9) ACCOUNT TYPE, EXHIBIT 1 (74-75)

           IF CD-CO-TRW = SPACES
              MOVE LN-ACCTNO TO D-NUMBER
              MOVE "*" TO D-SERIOUS
              MOVE "CREATED WITH INVALID COLLATERAL" TO D-MSG1
              MOVE LN-OWNBR TO D-BRNO
              PERFORM WRITE-DETAIL-LINE
              MOVE "02" TO CD-CO-TRW.

           MOVE CD-CO-TRW TO TRW-B-ATYPE.
           MOVE CD-CO-SECURED TO HOLD-SECURED.

      * (10) DATE OPENED
           MOVE LN-LOANDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-DATE-OPENED.

      * (11) CREDIT LIMIT  PAGE 29 FOR INSTALLMENT, ZERO FILL
           MOVE 0 TO TRW-B-CREDITLIMIT.

      * (12) HIGHEST CREDIT OR ORIGINAL LOAN AMOUNT
      *     INSTALLMENT = ORIGINAL LOAN AMOUNT
           MOVE LN-SUM-LNAMT TO TRW-B-AMT.

      * 2/6/2019 USE THE TILA "AMOUNT FINANCED" IN FIELD 12. ORIGINAL LOAN
      *          AMOUNT. THIS IS THE TOTAL OF PAYMENTS LESS INTCHG, SERCHG
      *          EXT, AND MF.
           MOVE DISCLOSED-FINAMT TO TRW-B-AMT.

      * (13) TERMS DURATION IN MONTHS
      * IF SINGLE PAY LOAN, MUST BLACK FILL !! (EXHIBIT 3)
           MOVE LN-ORGTERM TO TRW-B-TERMS.
           IF LN-ORGTERM = 1
              MOVE SPACES TO TRW-B-TERMSX.
           IF LN-UNITPER-CD = "W" OR "S" OR "B"
              COMPUTE TRW-B-TERMS ROUNDED =
                  (LN-ORGTERM / LN-UNITPER-PER-YEAR) * 12.
      * TEST REAL ESTATE (MORTGAGE = YEARS)
           MOVE CD-CO-TRW TO REAL-ESTATE-TEST.
           IF REAL-ESTATE
              COMPUTE TRW-B-TERMS = TRW-B-TERMS / 12.

      * (14) TERMS FREQUENCY
           MOVE LN-UNITPER-CD TO TRW-B-TERMS-FREQ.
           IF LN-UNITPER-CD = "S"
              MOVE "E" TO TRW-B-TERMS-FREQ
           ELSE
              IF LN-ORGTERM = 1
                 MOVE "P" TO TRW-B-TERMS-FREQ.

      * (15) SCHEDULED MONTHLY PAYMENT AMOUNT
           IF LN-CURBAL = 0 OR LN-PLDATE NOT = 0
              MOVE 0 TO TRW-B-REGPYAMT
           ELSE
              IF TRW-INFO-SCHED-PAY = "Y"
                 MOVE LN-1STPYDATE TO PDTH-DATE-WORK
                 PERFORM PAID-THRU-CALCULATION
                 MOVE PDTH-CUR-SCHD-PAY TO TRW-B-REGPYAMT
                 IF LN-UNITPER-CD = "W" OR "S" OR "B"
                    COMPUTE TRW-B-REGPYAMT =
                     (PDTH-CUR-SCHD-PAY * LN-UNITPER-PER-YEAR) / 12
                 END-IF
              ELSE
                 MOVE LN-REGPYAMT TO TRW-B-REGPYAMT
                 IF LN-UNITPER-CD = "W" OR "S" OR "B"
                    COMPUTE TRW-B-REGPYAMT =
                     (LN-REGPYAMT * LN-UNITPER-PER-YEAR) / 12.

      * (16) ACTUAL PAYMENT AMOUNT
            MOVE 0 TO TRW-B-ACTUAL-PAID.
            IF LN-DATE-PAID-LAST NOT = 0
               IF LN-DATE-PAID-LAST NOT < BEG-REPORT-DATE
                  PERFORM FIND-ACTUAL-PAYMENTS.


      * (17) ACCOUNT STATUS, EXHIBIT 4 (PAGE 68)

      * 30 DAYS PAST THE DUE DATE
           IF CSUB = 1 MOVE "71" TO TRW-B-STATUS.
           IF CSUB = 2 MOVE "78" TO TRW-B-STATUS.
           IF CSUB = 3 MOVE "80" TO TRW-B-STATUS.
           IF CSUB = 4 MOVE "82" TO TRW-B-STATUS.
           IF CSUB = 5 MOVE "83" TO TRW-B-STATUS.
           IF CSUB = 6 MOVE "84" TO TRW-B-STATUS.
           IF CSUB = 7 MOVE "84" TO TRW-B-STATUS.
      * A10: 8-MISPAYS, 9-POTS, 10-CUR; ALL CURRENT FOR TRW
           IF CSUB = 8 OR 9 OR 10
              MOVE "11" TO TRW-B-STATUS.
      *
           IF CSUB = 8 OR CSUB = 9 OR CSUB = 10
              MOVE 2 TO CSUB
           ELSE
              ADD 2 TO CSUB.

      * REPO, NOT REDEEMED
      * TRW-B-STATUS "95" VOLUNTARY ELSE "96"
           IF (LN-REPOCD = "X" OR "S")
              MOVE "96" TO TRW-B-STATUS
              IF VOL-INVOL-FLAG = "V" 
                 MOVE "95" TO TRW-B-STATUS.

      * SHOULD BE THE VOLUNTARY REPO
           IF (LN-ACTIONCD = "REPO")
              IF LN-REDEEMDATE = 0
                 MOVE "96" TO TRW-B-STATUS.

           IF LN-CURBAL = 0
              IF LN-POCD  = "**"
                 MOVE 11 TO CSUB
                 MOVE "DA" TO TRW-B-STATUS
              ELSE
                 MOVE 1 TO CSUB
                 MOVE "13" TO TRW-B-STATUS
                 PERFORM TEST-POCD.

           IF LN-PLCD NOT = SPACES
      * MODERN FINANCE
              IF LN-POCD NOT = "ZZ"
      * MODERN FINANCE
                 ADD LN-CURBAL TO AGE-AMOUNT(10)
                 ADD 1 TO AGE-COUNT(10).

           ADD 1 TO AGE-COUNT(CSUB).
           ADD LN-CURBAL TO AGE-AMOUNT(CSUB).

           IF CSUB > 8 MOVE 8 TO CSUB.

           IF LN-PLCD NOT = SPACES
      * MODERN FINANCE
              IF LN-POCD NOT = "ZZ"
                 MOVE 9 TO CSUB
                 MOVE "97" TO TRW-B-STATUS
      * ADDED 11-15-94 AS PER TOM ECKART
                 IF LN-CURBAL = 0
                    MOVE "64" TO TRW-B-STATUS
                    IF LN-POCD = "97"
                       MOVE "97" TO TRW-B-STATUS.

      * WANT THE TRANSFERRED ACCOUNTS REMOVED IN THE OLD BRANCH
      * REGACC, MULL, BARNETT
      *    IF LN-POCD = "BT" 
      *       MOVE "DA" TO TRW-B-STATUS.

      * TEST LN-TRW-STATUS, IF NOT SPACES AND NOT 00, FORCE THAT
      * STATUS  1/8/98
      * 02/16/05 STATUS 98 NEEDS REAL STATUS AND CONSUMER IND OF "T"
      *          STATUS 85 NEEDS REAL STATUS AND CONSUMER IND OF "U"
           IF LN-TRW-STATUS NOT = "00" AND
               LN-TRW-STATUS NOT = "  " AND
                  LN-TRW-STATUS NOT = "98" AND
                   LN-TRW-STATUS NOT = "85"
              MOVE LN-TRW-STATUS TO TRW-B-STATUS.

      * NEED TO MAKE SURE THE "DA" GETS PUT BACK FROM THE COMPLIANCE 80
      * MONTH CHECK AT TOP OF PROGRAM, WAS GETTING WIPED OUT BY OTHERS
           IF I-AM-STATUS-DA = "Y"
              MOVE "DA" TO TRW-B-STATUS.

      * NEED ALL THESE HERE CAUSE YOU NEVER KNOW WHAT THE OVERRIDE STATUS
      * MIGHT BE !!
           IF TRW-B-STATUS = "DA"
              ADD 1 TO DA-COUNT
           ELSE
           IF TRW-B-STATUS = "05"
              ADD 1 TO 05-COUNT
           ELSE
           IF TRW-B-STATUS = "11"
              ADD 1 TO 11-COUNT
           ELSE
           IF TRW-B-STATUS = "13"
              ADD 1 TO 13-COUNT
           ELSE
           IF TRW-B-STATUS = "61"
              ADD 1 TO 61-COUNT
           ELSE
           IF TRW-B-STATUS = "62"
              ADD 1 TO 62-COUNT
           ELSE
           IF TRW-B-STATUS = "63"
              ADD 1 TO 63-COUNT
           ELSE
           IF TRW-B-STATUS = "64"
              ADD 1 TO 64-COUNT
           ELSE
           IF TRW-B-STATUS = "65"
              ADD 1 TO 65-COUNT
           ELSE
           IF TRW-B-STATUS = "71"
              ADD 1 TO 71-COUNT
           ELSE
           IF TRW-B-STATUS = "78"
              ADD 1 TO 78-COUNT
           ELSE
           IF TRW-B-STATUS = "80"
              ADD 1 TO 80-COUNT
           ELSE
           IF TRW-B-STATUS = "82"
              ADD 1 TO 82-COUNT
           ELSE
           IF TRW-B-STATUS = "83"
              ADD 1 TO 83-COUNT
           ELSE
           IF TRW-B-STATUS = "84"
              ADD 1 TO 84-COUNT
           ELSE
           IF TRW-B-STATUS = "88"
              ADD 1 TO 88-COUNT
           ELSE
           IF TRW-B-STATUS = "89"
              ADD 1 TO 89-COUNT
           ELSE
           IF TRW-B-STATUS = "93"
              ADD 1 TO 93-COUNT
           ELSE
           IF TRW-B-STATUS = "94"
              ADD 1 TO 94-COUNT
           ELSE
           IF TRW-B-STATUS = "95"
              ADD 1 TO 95-COUNT
           ELSE
           IF TRW-B-STATUS = "96"
              ADD 1 TO 96-COUNT
           ELSE
           IF TRW-B-STATUS = "97"
              ADD 1 TO 97-COUNT.

           IF LN-BNKRPTDATE NOT = 0
      * AS LONG AS NOT THE SECONDARY MAKER THE ONE WHO DECLARED ONLY
              IF WHO-FILED NOT = "S"
                 PERFORM TEST-LN-CONSUMER-INFO-IND
                 MOVE WS-CONSUMER-INFO-IND TO
                                    TRW-B-CONSUMER-INFO-IND.

      * BANKRUPTCY DISMISSAL
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
              IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * AS LONG AS NOT THE SECONDARY MAKER THE ONE WHO DECLARED ONLY
      * ONLY VALID CHAPTER IS IN THE LT TRAILER, LN WAS CLEARED
                 IF WHO-FILED NOT = "S"
                    PERFORM TEST-LT-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO 
                                       TRW-B-CONSUMER-INFO-IND.

      * ADDED 04-24-96 FOR MIDATLANTIC PR# 310
           IF BW-TIMEADDR = "98  " OR LN-TRW-STATUS = "98"
              MOVE "T" TO TRW-B-CONSUMER-INFO-IND.
           IF LN-TRW-STATUS = "85"
              MOVE "U" TO TRW-B-CONSUMER-INFO-IND.

      * TEST FOR DISCHARGE BEFORE REAFFIRMATION
      * ONLY REPORT DISCHARGES THE MONTH THE STATUS CHANGES, NOT ANY
      * SUBSEQUENT MONTHS
      * KM SAID DISCHARGE MEANS THE DEBTOR HAS FINISHED THE TERMS OF
      * THE BANKRUPT PROCESS AND THE CHAPTER SHOULD REMAIN IN THE LOAN

      * BANKRUPT REAFFIRMATIONS AND DISCHARGES
           IF DISCHARGE-DATE NOT = 0 
              PERFORM TEST-FOR-BASE-DISCHARGE
           ELSE
              IF REAFF-DATE NOT = 0 AND RESCIND-DATE = 0 
      * MUST BE MAKER OR BOTH
                 IF WHO-FILED NOT = "S"
                    MOVE "R" TO TRW-B-CONSUMER-INFO-IND.

           IF LN-POCD = "**"
              MOVE 10 TO CSUB.

           ADD 1 TO REPORTED-COUNT(CSUB).
           ADD LN-CURBAL TO REPORTED-AMOUNT(CSUB).

      * 12/28/2016 PR# 5234 HOME CREDIT
      * 04/26/2017 PR# 5246 REGENCY
      *   HOW THEY WANT TO REPORT "BK" DISCHARGES. THEY WANT
      *   ACCOUNT TO REMAIN OPEN ON THE SYSTEM SO THAT PX/PL MAY
      *   BE POSTED IF THEY AGREE TO PAY A PORTION OF REMAIN DEBT
      *   OR DONT END UP PAYING IT OFF
      * 05/03/2018 NEED TO TEST THIS HERE SO TRW-B-STATUS IS SET
      *            PRIOR TO PAYMENT RATING, IT LOOKS FOR "13"
      *    IF (HOME-CREDIT) OR
      *        (GP-I-AM-REGENCY AND LN-BNKRPTDATE NOT = 0)
      *       IF LN-TRW-B-CONSUMER-IND = "E" OR "F" OR "G" OR "H" OR
      *           LN-TRW-J-CONSUMER-IND = "E" OR "F" OR "G" OR "H"
      *          MOVE "13" TO TRW-B-STATUS.

      * (17B) PAYMENT RATING
           IF TRW-B-STATUS = "05" OR "13" OR "65" OR "88" OR "89"
                                   OR "94" OR "95"
              MOVE LN-CONPROFILE(1) TO WK-CONPROFILE1
      * YOU NEED THE STATUS 1 MONTH PRIOR TO THE PAYOFF, THE PAYOFF
      * WILL MAKE IT CURRENT
              MOVE WK-PROFILE-BYTE(2) TO TRW-B-PAY-RATING
              INSPECT TRW-B-PAY-RATING REPLACING ALL "7" BY "6"
      * IF PROFILE HASNT BEEN SET YET, CLEAR IT
              INSPECT TRW-B-PAY-RATING REPLACING ALL "9" BY "0"
              IF LN-PLDATE NOT = 0
                 MOVE "L" TO TRW-B-PAY-RATING.


      * (18) PAYMENT HISTORY PROFILE  24 MONTHS OF PAY HISTORY
      * WITH THE FIRST BYTE BEING THE PREVIOUS MONTHS'S STATUS AND
      * SINCE THIS IS RUN AFTER EOM, WE HAVE TO SHIFT THEM ALL 1 LEFT

           MOVE LN-CONPROFILE(1) TO WK-CONPROFILE1.
           MOVE LN-CONPROFILE(2) TO WK-CONPROFILE2.

      * MOVE SLOT 2 TO 1, 3 TO 2, ETC...LOSING THE FIRST SLOT BECAUSE
      * THAT WOULD BE FROM EOM, AND THEY WANT THE PREVIOUS MONTH FIRST.
      * MOVE SLOT 24 TO 23, THEN THE NEW 24 SLOT HAS TO COME FROM THE NEXT
      * PROFILE
           PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 23
              MOVE WK-PROFILE-BYTE(SUB + 1) TO WK-PROFILE-BYTE(SUB)
           END-PERFORM.

      * NOW WE NEED THE FIRST BYTE FROM THE 3RD PROFILE INTO THE LAST
      * BYTE
           MOVE LN-CONPROFILE(3) TO WK-PROFILE3.
           MOVE WK-PROF-BYTE(1) TO WK-PROFILE-BYTE(24).

           INSPECT WK-PROFILES REPLACING ALL "7" BY "6".
           INSPECT WK-PROFILES REPLACING ALL "9" BY "B".

           IF LN-PLDATE NOT = 0 OR LN-REPODATE NOT = 0
              PERFORM FIX-PROFILE-STATUS.

           MOVE WK-PROFILES TO TRW-B-HIST-PROFILE.


      * (19) SPECIAL COMMENT
      * LN-TRW-SPECIAL-CODE OF "**" WILL UNCONDITIONALLY OVERWRITE
      * ANY PROGRAM GENERATED SB-COMMENT , WITH SPACES
           IF LN-TRW-SPECIAL-CODE NOT = "**"
              MOVE LN-TRW-SPECIAL-CODE TO TRW-B-COMMENT.
      * "AZ" REDEEMED REPO
      * "AO" VOLUNTARILY SURRENDERED, THEN REDEEMED
           IF (LN-REPODATE NOT = 0 ) 
      * DO NOT USE REDEEMDATE NOT = 0, REDEEMDATE DOES NOT CLEAR IF ANOTHER
      * REPO TAKES PLACE!
              IF LN-REPOCD = "V"
                 IF VOL-INVOL-FLAG = "V"
                    MOVE "AO" TO TRW-B-COMMENT
                 ELSE
                    MOVE "AZ" TO TRW-B-COMMENT.

           IF (LN-ACTIONCD = "REPO")
              IF LN-REDEEMDATE NOT = 0
                 MOVE "AZ" TO TRW-B-COMMENT.

      * #1521 METRO2 GUIDELINES, "AT" INDICATES THE ACCOUNT HAS BEEN
      * INTERNALLY TRANSFERRED FROM ONE BRANCH/DEPT TO ANOTHER.
      *    IF LN-POCD = "BT"
      *       MOVE "AT" TO TRW-B-COMMENT.

           IF LN-TRW-SPECIAL-CODE = "**"
              MOVE "  " TO TRW-B-COMMENT.

      * (20) COMPLIANCE CONDITION CODE
           MOVE LN-TRW-COMPLIANCE-CODE TO TRW-B-CONDITION.

      * (21) CURRENT BALANCE
      *      REPORT THE PAYOFF BALANCE ON REAL ESTATE ACCOUNTS
      *      REPORT THE BALANCE ON NON REAL ESTATE ACCOUNTS

           MOVE END-REPORT-DATE TO POFF-PAYDATE.
           MOVE "M" TO POFF-MAKERCD.
           MOVE "N" TO POFF-DEF-STOP.
           MOVE " " TO POFF-RECAST-FG.

      * 02/06/2019 USE THE CUSTOMER PAYOFF AS OF THE EOM DATE ENTERED.
      *            THIS IS GROSS BALANCE LESS ANY REFUNDS OF
      *            INT/INS/FEES PLUS ANY LATE CHARGES, SIMPLE INT,
      *            OR OTHCHG DUE AS OF THE LAST DAY OF THE MONTH.

           MOVE "PO" TO POFF-LPTRCD.
           PERFORM PAYOFF-LOAN-ROUTINE.
           MOVE POFF-NETDUE TO TRW-B-CURBAL.

      * DO NOT DO THIS FOR "WI" PERSONAL RECEIVERSHIP BANKRUPTS
      * 9/29/2020 PR# 1461 REPORT BALANCE AS CURRENT GROSS BALANCE AS OF THE
      *           DATE OF THE LAST NON-REVERSED BK (FROM LTB TRAILER)
      *           AND AMOUNT PAST DUE WILL REPORT NATURALLY

           IF LN-CURBAL NOT = 0
              IF LN-BNKRPTDATE NOT = 0 
                 IF LN-BNKRPT-CHAPTER NOT = 28
                    MOVE BK-GROSS-BAL TO TRW-B-CURBAL.

      * (22) AMOUNT PAST DUE
           MOVE AMT-PASTDUE TO TRW-B-AMT-PASTDUE.
      * IF STATUS 11 (CURRENT ACCOUNT), THIS FIELD SHOULD BE ZERO
           IF TRW-B-STATUS =  "11"
              MOVE 0 TO TRW-B-AMT-PASTDUE.

      * 9/29/2020 #1461 IF DISCHARGE DATE NOT 0, SEND 0 TO CURRENT BALANCE
      *                 AND AMOUNT PAST DUE, UNLESS RESCIND DATE ALSO NOT 0
           IF DISCHARGE-DATE NOT = 0
              IF RESCIND-DATE = 0
                 MOVE 0 TO TRW-B-CURBAL TRW-B-AMT-PASTDUE.

      * 4/02/2015 PR# 1065
      *           FAQ 47. HOW TO REPORT ACCOUNTS SOLD TO ANOTHER COMPANY
      *                   SCHEDULED MONTHLY PAYMENT AMOUNT = ZERO
      *                   CURRENT BALANCE AND AMOUNT PAST DUE = ZERO
           IF (LN-TRW-SPECIAL-CODE = "AH" AND LN-DLPOOL > 90000)
              MOVE 0 TO TRW-B-CURBAL TRW-B-AMT-PASTDUE
                        TRW-B-REGPYAMT.

      * (23) ORIGINAL CHARGE-OFF AMOUNT
           IF TRW-B-STATUS = "97" OR "64"
              MOVE LN-PLAMT TO TRW-B-ORIG-PLAMT
           ELSE
              IF (TRW-B-STATUS = "93") AND LN-PLCD NOT = SPACES
                 MOVE LN-PLAMT TO TRW-B-ORIG-PLAMT.

      * (24) DATE OF ACCOUNT INFORMATION
           MOVE END-REPORT-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-BILL-DATE.
           IF LN-POFFDATE NOT = 0
              MOVE LN-POFFDATE TO  DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY TO TRW-B-BILL-DATE.

      * (25) FCRA COMPLIANCE/DATE OF FIRST DELINQUENCY (190-197)
      * DATE OF THE FIRST DELINQUENCY THAT LED TO THE STATUS BEING REPORTED
      *
      * OUR EOMALL PROGRAM UPDATES LN-TRW-DOFD-DATE, EOMALL IS RUN PRIOR TO
      * THIS PROGRAM !
      * PAIDOUT WILL STILL HAVE THE DATE FROM PRIOR TO THE PAYOUT MAKING
      * THEM CURRENT

      * DONT FORCE REPODATE IF REPO WAS REDEEMED
           IF LN-TRW-DOFD-DATE = 0
              IF (LN-REPODATE NOT = 0 AND LN-REPOCD NOT = "V")
                 MOVE LN-REPODATE TO LN-TRW-DOFD-DATE
              ELSE
                 IF LN-PLDATE NOT = 0
                    MOVE LN-PLDATE TO LN-TRW-DOFD-DATE
                 ELSE
                    IF LN-BNKRPTDATE NOT = 0
                       MOVE LN-BNKRPTDATE TO LN-TRW-DOFD-DATE.
           MOVE LN-TRW-DOFD-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-DATE-DELINQ.


      * (26) DATE CLOSED
           MOVE LN-POFFDATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-DATE-CLOSED.
           IF (LN-TRW-SPECIAL-CODE = "AH" AND LN-DLPOOL > 90000)
              MOVE LN-DLPOOL TO WS-DLPOOL-DATE
              MOVE WS-DLPOOL-MM TO DATE-MMDDYY-MM
              MOVE 33           TO DATE-MMDDYY-DD
              MOVE WS-DLPOOL-YY TO DATE-MMDDYY-YY
              PERFORM CONVERT-MMDDYY-TO-YYYYMMDD
              MOVE DATE-YYYYMMDD TO NDTE-DATE
      * TO GET LAST DAY OF THE MONTH
              PERFORM NEW-DATE-CALCULATION
              MOVE NDTE-DATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY TO TRW-B-DATE-CLOSED.


      * (27) DATE OF LAST PAYMENT
           MOVE LN-DATE-PAID-LAST TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY.
           MOVE DATE-MMDDYYYY TO TRW-B-DATE-LAST-PAY.

      * (29) CONSUMER TRANSACTION TYPE
      *     1 = NEWLY OPENED ACCOUNT

           IF LN-ENTDATE NOT < BEG-REPORT-DATE
              ADD 1 TO NEW-COUNT
              MOVE "1" TO TRW-B-CONSUMER-TRAN-TYPE
           ELSE
              ADD 1 TO UPDATED-COUNT.


      * (30) SURNAME (LAST NAME)
           MOVE BW-LNAME TO TRW-B-LNAME.

      * (31) FIRST NAME
           PERFORM FIND-FIRST-NAME.
           MOVE OUT-NAME TO TRW-B-FNAME.
      * (32) MIDDLE NAME
           PERFORM FIND-MIDDLE-NAME.
           MOVE OUT-NAME TO TRW-B-MNAME.

      * (33) GENERATION
           MOVE SPACES TO TRW-B-GENERATION.
           MOVE TRW-B-LNAME TO HOLD-LNAME.
           PERFORM FIND-GENERATION.
           MOVE HOLD-LNAME TO TRW-B-LNAME.
           MOVE OUT-NAME TO TRW-B-GENERATION.

      * (34) SOCIAL SECURITY NUMBER
           MOVE LN-SSNO(1) TO TRW-B-SSNO.
           IF LN-SSNO(1) < 999999 OR > 999000000
              MOVE LN-ACCTNO TO D-NUMBER
              MOVE LN-OWNBR TO D-BRNO
              MOVE "PRIMARY SSNO# COULD BE INVALID" TO D-MSG1
              PERFORM WRITE-DETAIL-LINE.
      * CAN NOT START WITH 99X-XX-XXXX OR 98X-XX-XXXX
           IF TRW-INVALID-SSNO = "9"
              IF LN-SSNO(1) NOT < 980000000
                 MOVE 999999999 TO TRW-B-SSNO.
      * CAN NOT START WITH 9XX-XX-XXXX OR 000-XX-XXXX
           IF TRW-INVALID-SSNO = "0"
              IF (LN-SSNO(1) NOT < 900000000) OR 
                   (LN-SSNO(1) NOT > 000999999)
                 MOVE 999999999 TO TRW-B-SSNO.
           IF LN-SSNO(1) NOT = 0 AND NOT = 999999999
              ADD 1 TO SSNO-COUNT BASE-SSNO-COUNT.

      * (35) DATE OF BIRTH
           IF (BW-BDATE = 0)
              MOVE 0 TO TRW-B-BDATE
           ELSE
              MOVE BW-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY TO TRW-B-BDATE.
           IF (BW-BDATE NOT = 0)
              MOVE BW-BDATE TO NUM-DATE
              PERFORM TSTDAT
              IF NUM-DATE NOT = 0
                 ADD 1 TO BDATE-COUNT BASE-BDATE-COUNT.

      * (36) TELEPHONE
           MOVE BW-PHONE TO TRW-B-PHONE.
           IF BW-PHONE NOT = 0
              ADD 1 TO PHONE-COUNT.

      * (37) ECOA CODE RELATIONSHIP
      *    1 = INDIVIDUAL, THIS INDIVIDUAL HAS CONTRACTUAL RESPONSIBILITY FOR
      *                    THIS ACCOUNT AND IS PRIMARILY RESPONSIBLE FOR ITS
      *                    PAYMENT
      *    2 = JOINT CONTRACTUAL LIABILITY. JOINT ACCOUNT FOR WHICH THIS
      *              BORROWER HAS CONTRACTUAL RESPONSIBILITY.
      *    7 = MAKER. ACCOUNT FOR WHICH SUBJECT IS LIABLE BUT A CO-MAKER IS
      *               LIABLE IF MAKER DEFAULTS.
      *    T = TERMINATED (USED FOR BANKRUPTCY)
      *    X = DECEASED
      * NO NEED TO CHECK ALL BORROWERS, JUST WHAT IS IN SLOT 2

           MOVE "1" TO TRW-B-ECOA-CODE.
           IF LN-SSNO(2) NOT = 0
              IF LN-MAKERCD(2) = "J"
                 MOVE "2" TO TRW-B-ECOA-CODE
              ELSE
                 MOVE "7" TO TRW-B-ECOA-CODE.

      * FOR CHAPTER 13 BANKRUPT ACCOUNTS, IF THERE IS A NON-FILING CUSTOMER
      * ASSOCIATED WITH THE ACCOUNT, USE THE ECOA CODE OF "T" TO
      * TERMINATE THE CUSTOMER'S ASSOCIATION WITH THE ACCOUNT.
      *    IF GP-I-AM-REGACC
      *       IF LN-BNKRPTDATE NOT = 0 AND LN-BNKRPT-CHAPTER = 13
      * IF SECONDARY MAKER THE ONE WHO FILED, TERMINATE MAKERS RESPONSIBILITY
      *          IF WHO-FILED = "S"
      *             MOVE "T" TO TRW-B-ECOA-CODE
      *          ELSE
      *             IF (WHO-FILED = " " AND ENDORSER-FILED NOT = " ")
      *                MOVE "T" TO TRW-B-ECOA-CODE.

           IF LN-POCD = "21"
              MOVE "X" TO TRW-B-ECOA-CODE.

      * (38) CONSUMER INFO INDICATOR TRW-B-CONSUMER-INFO-IND
      * THIS IS SET ALL OVER THE PLACE, BUT THIS IS THE LAST OVERRIDE!
           MOVE LN-TRW-B-CONSUMER-IND TO TEST-IND.
           IF VALID-INDICATOR
              IF LN-TRW-B-CONSUMER-IND NOT = SPACES
                 MOVE LN-TRW-B-CONSUMER-IND TO
                                  TRW-B-CONSUMER-INFO-IND.

      * (39) COUNTRY
           MOVE "US" TO TRW-B-COUNTRY.

      * (40) FIRST LINE OF ADDRESS
           MOVE BW-ADR1 TO TRW-B-ADR1.

      * (41) SECOND LINE OF ADDRESS
           MOVE BW-ADR2 TO TRW-B-ADR2.

      * (42) CITY
           MOVE BW-CITY TO TRW-B-CITY.
      * (43) STATE
           MOVE BW-STATE TO TRW-B-STATE.
      * (44) ZIP
           MOVE BW-ZIP TO TRW-B-ZIP ZIP-IN.
           IF ZIP-IN-BYTE(6) = "-"
              MOVE 1 TO OUT-SUB
              MOVE SPACES TO ZIP-OUT
              PERFORM VARYING IN-SUB FROM 1 BY 1 UNTIL IN-SUB > 10
                 IF ZIP-IN-BYTE(IN-SUB) NOT = "-"
                    MOVE ZIP-IN-BYTE(IN-SUB) TO ZIP-OUT-BYTE(OUT-SUB)
                    ADD 1 TO OUT-SUB
                 END-IF
              END-PERFORM
              MOVE ZIP-OUT TO TRW-B-ZIP.

      * (45) ADDRESS INDICATOR
           MOVE SPACES TO TRW-B-ADD-IND.

      * (46) RESIDENCE CODE
           IF BW-RENTCD = "RENT" OR "R   "
              MOVE "R" TO TRW-B-RESIDENCE
           ELSE
           IF BW-RENTCD = "OWNS" OR "OWN " OR "O   "
              MOVE "O" TO TRW-B-RESIDENCE.

      ***************************
       FIND-GENERATION SECTION.
      ***************************

      * HOLD-LNAME HOLDS EITHER TRW-B-LNAME, TRW-J1-LNAME(), OR
      *                                      TRW-J2-LNAME()
      * HAVE TO REMOVE THE GENERATION YOU FIND FROM THE LAST NAME

           MOVE SPACES TO OUT-NAME.

           MOVE 0 TO SUB SUB1 SUB2.

           INSPECT HOLD-LNAME TALLYING SUB  FOR ALL " JR ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " JR.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",JR".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "J" TO OUT-NAME
      * THESE 2 ARE FOUND BY " JR "
              INSPECT HOLD-LNAME REPLACING ALL ", JR " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " JR "  BY "    "
      * THIS IS FOUND BY " JR."
              INSPECT HOLD-LNAME REPLACING ALL ", JR." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " JR."  BY "    "
      * THEN THESE ARE FOUND BY ",JR"
              INSPECT HOLD-LNAME REPLACING ALL ",JR." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",JR"  BY "   "
              GO TO EXIT-FIND-GENERATION.

           INSPECT HOLD-LNAME TALLYING SUB  FOR ALL " SR ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " SR.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",SR".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "S" TO OUT-NAME
      * THESE 2 ARE FOUND BY " SR "
              INSPECT HOLD-LNAME REPLACING ALL ", SR " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " SR "  BY "    "
      * THIS IS FOUND BY " SR."
              INSPECT HOLD-LNAME REPLACING ALL ", SR." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " SR."  BY "    "
      * THEN THESE ARE FOUND BY ",SR"
              INSPECT HOLD-LNAME REPLACING ALL ",SR." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",SR"  BY "   "
              GO TO EXIT-FIND-GENERATION.

      * MUST DO III BEFORE II BECAUSE " II" WILL GRAB " III"
           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " III ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " III.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",III".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "3" TO OUT-NAME
      * THESE 2 ARE FOUND BY " III "
              INSPECT HOLD-LNAME REPLACING ALL ", III " BY "      "
              INSPECT HOLD-LNAME REPLACING ALL " III "  BY "     "
      * THIS IS FOUND BY " III."
              INSPECT HOLD-LNAME REPLACING ALL ", III." BY "      "
              INSPECT HOLD-LNAME REPLACING ALL " III."  BY "     "
      * THEN THESE ARE FOUND BY ",III"
              INSPECT HOLD-LNAME REPLACING ALL ",III." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL ",III"  BY "    "
              GO TO EXIT-FIND-GENERATION.

           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " II ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " II.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",II".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "2" TO OUT-NAME
      * THESE 2 ARE FOUND BY " II "
              INSPECT HOLD-LNAME REPLACING ALL ", II " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " II "  BY "    "
      * THIS IS FOUND BY " II."
              INSPECT HOLD-LNAME REPLACING ALL ", II." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " II."  BY "    "
      * THEN THESE ARE FOUND BY ",II"
              INSPECT HOLD-LNAME REPLACING ALL ",II." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",II"  BY "   "
              GO TO EXIT-FIND-GENERATION.


           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " IV ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " IV.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",IV".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "4" TO OUT-NAME
      * THESE 2 ARE FOUND BY " IV "
              INSPECT HOLD-LNAME REPLACING ALL ", IV " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " IV "  BY "    "
      * THIS IS FOUND BY " IV."
              INSPECT HOLD-LNAME REPLACING ALL ", IV." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " IV."  BY "    "
      * THEN THESE ARE FOUND BY ",IV"
              INSPECT HOLD-LNAME REPLACING ALL ",IV." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",IV"  BY "   "
              GO TO EXIT-FIND-GENERATION.

      * NOTE: ***********************************************************
      * NOTE: ***********************************************************
      * NEED TO GO IN THIS ORDER BECAUSE SOME CAN BE FOUND WITHIN OTHERS
      * ,VII WOULD BE FOUND IN A ,VIII AND ONLY REPLACE THE ,VII LEAVING I

           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " VIII ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " VIII.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",VIII".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "8" TO OUT-NAME
      * THESE 2 ARE FOUND BY " VIII "
              INSPECT HOLD-LNAME REPLACING ALL ", VIII " BY "       "
              INSPECT HOLD-LNAME REPLACING ALL " VIII "  BY "      "
      * THIS IS FOUND BY " VIII."
              INSPECT HOLD-LNAME REPLACING ALL ", VIII." BY "       "
              INSPECT HOLD-LNAME REPLACING ALL " VIII."  BY "      "
      * THEN THESE ARE FOUND BY ",VIII"
              INSPECT HOLD-LNAME REPLACING ALL ",VIII." BY "      "
              INSPECT HOLD-LNAME REPLACING ALL ",VIII"  BY "     "
              GO TO EXIT-FIND-GENERATION.

           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " VII ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " VII.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",VII".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "7" TO OUT-NAME
      * THESE 2 ARE FOUND BY " VII "
              INSPECT HOLD-LNAME REPLACING ALL ", VII " BY "      "
              INSPECT HOLD-LNAME REPLACING ALL " VII "  BY "     "
      * THIS IS FOUND BY " VII."
              INSPECT HOLD-LNAME REPLACING ALL ", VII."  BY "      "
              INSPECT HOLD-LNAME REPLACING ALL " VII."   BY "     "
      * THEN THESE ARE FOUND BY ",VII"
              INSPECT HOLD-LNAME REPLACING ALL ",VII." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL ",VII"  BY "    "
              GO TO EXIT-FIND-GENERATION.

           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " VI ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " VI.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",VI".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "6" TO OUT-NAME
      * THESE 2 ARE FOUND BY " VI "
              INSPECT HOLD-LNAME REPLACING ALL ", VI " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " VI "  BY "    "
      * THIS IS FOUND BY " VI."
              INSPECT HOLD-LNAME REPLACING ALL ", VI."  BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " VI."   BY "    "
      * THEN THESE ARE FOUND BY ",VI"
              INSPECT HOLD-LNAME REPLACING ALL ",VI." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",VI"  BY "   "
              GO TO EXIT-FIND-GENERATION.

      * THIS ONE MUST BE LAST BECAUSE ,V WILL BE FOUND IN ,VIII BUT
      * ONLY REPLACE THE ,V IN THE LAST NAME!
           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " V ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " V.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",V".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "5" TO OUT-NAME
      * THESE 2 ARE FOUND BY " V "
              INSPECT HOLD-LNAME REPLACING ALL ", V " BY "    "
              INSPECT HOLD-LNAME REPLACING ALL " V "  BY "   "
      * THIS IS FOUND BY " V."
              INSPECT HOLD-LNAME REPLACING ALL ", V."  BY "    "
              INSPECT HOLD-LNAME REPLACING ALL " V."   BY "   "
      * THEN THESE ARE FOUND BY ",V"
              INSPECT HOLD-LNAME REPLACING ALL ",V." BY "   "
              INSPECT HOLD-LNAME REPLACING ALL ",V"  BY "  "
              GO TO EXIT-FIND-GENERATION.


           INSPECT HOLD-LNAME TALLYING SUB FOR ALL " IX ".
           INSPECT HOLD-LNAME TALLYING SUB1 FOR ALL " IX.".
           INSPECT HOLD-LNAME TALLYING SUB2 FOR ALL ",IX".
           IF SUB > 0 OR SUB1 > 0 OR SUB2 > 0
              MOVE "9" TO OUT-NAME
      * THESE 2 ARE FOUND BY " IX "
              INSPECT HOLD-LNAME REPLACING ALL ", IX " BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " IX "  BY "    "
      * THIS IS FOUND BY " IX."
              INSPECT HOLD-LNAME REPLACING ALL ", IX." BY "     "
              INSPECT HOLD-LNAME REPLACING ALL " IX."  BY "    "
      * THEN THESE ARE FOUND BY ",IX"
              INSPECT HOLD-LNAME REPLACING ALL ",IX." BY "    "
              INSPECT HOLD-LNAME REPLACING ALL ",IX"  BY "   "
              GO TO EXIT-FIND-GENERATION.

       EXIT-FIND-GENERATION.
           EXIT.

      ***************************
       FIND-FIRST-NAME SECTION.
      ***************************
           MOVE SPACES TO OUT-NAME.
           MOVE BW-FNAME TO WK-NAME.
           MOVE 1 TO SUB.
       FIND-FNAME-NEXT.
           IF WK-NAME-BYTE(SUB) NOT = " "
              MOVE WK-NAME-BYTE(SUB) TO WK-OUT-BYTE(SUB)
              ADD 1 TO SUB
              IF SUB NOT > 16
                 GO TO FIND-FNAME-NEXT.

      ***************************
       FIND-MIDDLE-NAME SECTION.
      ***************************
           MOVE SPACES TO OUT-NAME.

           IF SUB > 15
              GO TO EXIT-FIND-MIDDLE.

           MOVE 1 TO OUT-SUB.
      * YOU ARE SITTING ON A SPACE.
           ADD 1 TO SUB.
      * NOW INCLUDE EVERYTHING UP UNTIL BYTE 16 AS MIDDLE NAME
       FIND-MIDDLE-NEXT.
           MOVE WK-NAME-BYTE(SUB) TO WK-OUT-BYTE(OUT-SUB).
           ADD 1 TO SUB OUT-SUB.
           IF SUB NOT > 16
              GO TO FIND-MIDDLE-NEXT.

       EXIT-FIND-MIDDLE.
           EXIT.

      ************************************
       MOVE-SEGMENT-J1 SECTION.
      ************************************

      * END OF CREATE SEGMENT ADDS TO THESE, MUST BACK THAT OUT
           SUBTRACT 1 FROM J1-COUNT.
           SUBTRACT 1 FROM J1-SUB.
           MOVE TRW-J1-LNAME(J1-SUB)             TO TRW-B-LNAME.
           MOVE TRW-J1-FNAME(J1-SUB)             TO TRW-B-FNAME.
           MOVE TRW-J1-MNAME(J1-SUB)             TO TRW-B-MNAME.
           MOVE TRW-J1-GENERATION(J1-SUB)        TO TRW-B-GENERATION.
           MOVE TRW-J1-SOCSEC(J1-SUB)            TO TRW-B-SSNO.
           MOVE TRW-J1-BDATE(J1-SUB)             TO TRW-B-BDATE.
           MOVE TRW-J1-PHONE(J1-SUB)             TO TRW-B-PHONE.
           MOVE TRW-J1-ECOA-CODE(J1-SUB)         TO TRW-B-ECOA-CODE.
           MOVE TRW-J1-CONSUMER-INFO-IND(J1-SUB) TO
                                           TRW-B-CONSUMER-INFO-IND.

           MOVE SPACES TO TRW-J1-RECS(1).
           MOVE "J1"   TO TRW-J1-ID(1).

      ************************************
       MOVE-SEGMENT-J2 SECTION.
      ************************************

      * END OF CREATE SEGMENT ADDS TO THESE, MUST BACK THAT OUT
           SUBTRACT 1 FROM J2-COUNT.
           SUBTRACT 1 FROM J2-SUB.
           MOVE TRW-J2-LNAME(J2-SUB)      TO TRW-B-LNAME.
           MOVE TRW-J2-FNAME(J2-SUB)      TO TRW-B-FNAME.
           MOVE TRW-J2-MNAME(J2-SUB)      TO TRW-B-MNAME.
           MOVE TRW-J2-GENERATION(J2-SUB) TO TRW-B-GENERATION.
           MOVE TRW-J2-SOCSEC(J2-SUB)     TO TRW-B-SSNO.
           MOVE TRW-J2-BDATE(J2-SUB)      TO TRW-B-BDATE.
           MOVE TRW-J2-PHONE(J2-SUB)      TO TRW-B-PHONE.
           MOVE TRW-J2-ECOA-CODE(J2-SUB)  TO TRW-B-ECOA-CODE.
           MOVE TRW-J2-CONSUMER-INFO-IND(J2-SUB) TO
                                            TRW-B-CONSUMER-INFO-IND.
           MOVE TRW-J2-COUNTRY(J2-SUB)    TO TRW-B-COUNTRY.
           MOVE TRW-J2-ADR1(J2-SUB)       TO TRW-B-ADR1
           MOVE TRW-J2-ADR2(J2-SUB)       TO TRW-B-ADR2
           MOVE TRW-J2-CITY(J2-SUB)       TO TRW-B-CITY
           MOVE TRW-J2-STATE(J2-SUB)      TO TRW-B-STATE.
           MOVE TRW-J2-ZIP(J2-SUB)        TO TRW-B-ZIP.
           MOVE TRW-J2-ADD-IND(J2-SUB)    TO TRW-B-ADD-IND.
           MOVE TRW-J2-RESIDENCE(J2-SUB)  TO TRW-B-RESIDENCE.

           MOVE SPACES TO TRW-J2-RECS(1).
           MOVE "J2"   TO TRW-J2-ID(1).

      *****************************
       FIX-PROFILE-STATUS SECTION.
      *****************************
      * NEED TO FILL IN "L" FOR ALL MONTHS THAT WERE P&L,
      *                 "K" FOR ALL MONTHS THAT WERE REPO
      *                 "J" FOR ALL MONTHS THAT WERE VOLUNTARY SURRENDER
      * FIRST SLOT OF PROFILE WILL BE LAST MONTH

           MOVE 1 TO SUB.
           MOVE END-REPORT-DATE TO NDTE-DATE.
       FIX-NEXT-PROFILE.
           MOVE -1 TO NDTE-HOLD.
           PERFORM INCREMENT-MONTHS.
           IF LN-REPODATE NOT = 0
              IF NDTE-DATE NOT < LN-REPODATE
                 IF LN-REDEEMDATE = 0
                    IF VOL-INVOL-FLAG = "V"
                       MOVE "J" TO WK-PROFILE-BYTE(SUB)
                    ELSE
                       MOVE "K" TO WK-PROFILE-BYTE(SUB)
                 ELSE
      * ONLY REPORT FOR THE MONTHS IT WAS ONHAND, NOT REDEEMED
      * WAS REPO BUT REDEEMED, ONLY REPORT FOR WHEN IT WAS IN REPO
      * EXAMPLE REPO 6/25/14, REDEEMED 8/25/14, REPORT DATE 11/30/14
      * FOR 10/31/14, NO FLAG, 9/30/14, NO FLAG, 8/31/14, NO FLAG
      *      7/31/14, REPORT A FLAG
      * MAKE SURE IT IS CURRENTLY REDEEMED, CAUSE IF THEY REPO'D AGAIN
      * THE REDEEM DATE STAYS SET FROM THE FIRST REDEEM. UGLY.
                    IF LN-REPOCD = "V"
                       IF NDTE-DATE < LN-REDEEMDATE
                          IF VOL-INVOL-FLAG = "V"
                             MOVE "J" TO WK-PROFILE-BYTE(SUB)
                          ELSE
                             MOVE "K" TO WK-PROFILE-BYTE(SUB).

           IF LN-PLDATE NOT = 0
              IF NDTE-DATE NOT < LN-PLDATE
                 MOVE "L" TO WK-PROFILE-BYTE(SUB).

           IF SUB < 24
              ADD 1 TO SUB
              GO TO FIX-NEXT-PROFILE.

      ********************************************
      * THE K1 SEGMENT MUST BE PRESENT EACH TIME THE ACCOUNT IS REPORTED
      * BY COLLECTION AGENCIES, DEBT COLLECTORS, ETC.
      * TO REPORT THE ORIGINAL CREDITOR
      *  CURRENTLY ONLY REPORTING THIS SEGMENT FOR GP-I-AM-MODERN
      ********************************************
      *CREATE-SEGMENT-K1 SECTION.

      *    MOVE LN-MESSAGE TO TRW-K1-CREDITOR.

      *    IF LN-MESSAGE NOT = SPACES
      *       ADD 1 TO K1-COUNT.

      ********************************************
      * THE K2 SEGMENT MUST BE PRESENT FOR PURCHASING
      *        OR SELLING ACCOUNTS FROM YOUR PORTFOLIO
      *
      * - CURRENTLY ONLY REPORTING THIS SEGMENT FOR GP-I-AM-WORLD
      * - LN-TRW-SPECIAL-CODE = "AH"
      * - LN-DLPOOL > 90000 - SOLD TO
      * - CREATE FOR LN-SKIP-TRW "B", BUYBACK FROM DEBT SALE
      * - LN-CONVERCD = "Y" AND LSM-MISC-FIELD(5) NOT BLANK, PURCHASED
      ********************************************
       CREATE-SEGMENT-K2 SECTION.

      * 1 - PURCHASED FROM
      * 2 - SOLD TO NAME
      * 9 - REMOVE PREVIOUSLY REPORTED K2 SEGMENT INFORMATION

           IF LN-CONVERCD = "Y"
              MOVE LN-OWNBR  TO LSM-BRNO
              MOVE LN-ACCTNO TO LSM-ACCTNO
              MOVE 1         TO LSM-SEQNO
              PERFORM READ-LSM1-FILE
              IF IO-FG NOT = 0
                 GO TO EXIT-CREATE-SEGMENT-K2
              ELSE
                 IF LSM-MISC-FIELD(5) NOT = SPACES
                    MOVE "1"               TO TRW-K2-INDICATOR
                    MOVE LSM-MISC-FIELD(5) TO TRW-K2-NAME
                    ADD 1 TO K2-COUNT
                    GO TO EXIT-CREATE-SEGMENT-K2
                 ELSE
                    GO TO EXIT-CREATE-SEGMENT-K2.

           IF LN-SKIP-TRW = "B"
              MOVE "9" TO TRW-K2-INDICATOR
           ELSE
              MOVE "2" TO TRW-K2-INDICATOR
              MOVE LN-SSNO(1) TO BM-SSNO
              MOVE 99999999 TO BM-DATE
              MOVE 10 TO BM-SEQ
              PERFORM READ-BM1-FILE
              IF IO-FG = 0
                 MOVE BM-MEMO TO TRW-K2-NAME.

           ADD 1 TO K2-COUNT.

       EXIT-CREATE-SEGMENT-K2.
           EXIT.


      ********************************************
      *   CREATE TRW APPENDAGE SEGMENT J1        *
      * ACCOMMODATE THE REQUIREMENTS OF ECOA AND APPLIES WHEN
      * THE ASSOCIATED CONSUMER RESIDES AT THE "SAME" ADDRESS AS
      * THE INDIVIDUAL REPORTED IN THE BASE SEGMENT
      ********************************************
       CREATE-SEGMENT-J1 SECTION.

           MOVE "J1" TO TRW-J1-ID(J1-SUB).

           MOVE TRW-B-CONSUMER-TRAN-TYPE TO
                 TRW-J1-CONSUMER-TRAN-TYPE(J1-SUB).

           MOVE BW-LNAME TO TRW-J1-LNAME(J1-SUB).
           PERFORM FIND-FIRST-NAME.
           MOVE OUT-NAME TO TRW-J1-FNAME(J1-SUB).
           PERFORM FIND-MIDDLE-NAME.
           MOVE OUT-NAME TO TRW-J1-MNAME(J1-SUB).

      * (6) 69 - 69
           MOVE SPACES TO TRW-J1-GENERATION(J1-SUB).
           MOVE TRW-J1-LNAME(J1-SUB) TO HOLD-LNAME.
           PERFORM FIND-GENERATION.
           MOVE HOLD-LNAME TO TRW-J1-LNAME(J1-SUB) .
           MOVE OUT-NAME TO TRW-J1-GENERATION(J1-SUB).


      * (7)
           MOVE BW-SSNO TO TRW-J1-SOCSEC(J1-SUB).
      * CAN NOT START WITH 99X-XX-XXXX OR 98X-XX-XXXX
           IF TRW-INVALID-SSNO = "9"
              IF BW-SSNO NOT < 980000000
                 MOVE 999999999 TO TRW-J1-SOCSEC(J1-SUB).
      * CAN NOT START WITH 9XX-XX-XXXX OR 000-XX-XXXX
           IF TRW-INVALID-SSNO = "0"
              IF (BW-SSNO NOT < 900000000) OR 
                   (BW-SSNO NOT > 000999999)
                 MOVE 999999999 TO TRW-J1-SOCSEC(J1-SUB).

           IF BW-SSNO NOT = 0 AND BW-SSNO NOT = 999999999
              ADD 1 TO SSNO-COUNT J1-SSNO-COUNT.

      * (8)
           IF (BW-BDATE = 0)
              MOVE 0 TO TRW-J1-BDATE(J1-SUB)
           ELSE
              MOVE BW-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY TO TRW-J1-BDATE(J1-SUB).
           IF (BW-BDATE NOT = 0)
              MOVE BW-BDATE TO NUM-DATE
              PERFORM TSTDAT
              IF NUM-DATE NOT = 0
                 ADD 1 TO BDATE-COUNT J1-BDATE-COUNT.

      * (9) TELEPHONE
           MOVE BW-PHONE TO TRW-J1-PHONE(J1-SUB).
           IF BW-PHONE NOT = 0
              ADD 1 TO PHONE-COUNT.

      * (10) ECOA CODE 97 - 97
      *    2 = JOINT CONTRACTUAL LIABILITY. JOINT ACCOUNT FOR WHICH THIS
      *              BORROWER HAS CONTRACTUAL RESPONSIBILITY.
      *    5 = CO-MAKER. ACCOUNT FOR WHICH THE SUBJECT IS THE CO-MAKER AND
      *                  BECOMES LIABLE IF THE MAKER DEFAULTS; NO SPOUSAL
      *                  RELATIONSHIP
           IF LN-MAKERCD(MAKER-SUB) = "J"
              MOVE "2" TO TRW-J1-ECOA-CODE(J1-SUB)
           ELSE
              MOVE "5" TO TRW-J1-ECOA-CODE(J1-SUB).


      * FOR CHAPTER 13 BANKRUPT ACCOUNTS, IF THERE IS A NON-FILING CUSTOMER
      * ASSOCIATED WITH THE ACCOUNT, USE THE ECOA CODE OF "T" TO
      * TERMINATE THE CUSTOMER'S ASSOCIATION WITH THE ACCOUNT.

      *    IF GP-I-AM-REGACC
      *       IF LN-BNKRPTDATE NOT = 0 AND LN-BNKRPT-CHAPTER = 13
      *          IF LN-MAKERCD(MAKER-SUB) = "J" AND WHO-FILED = "M"
      *             MOVE "T" TO TRW-J1-ECOA-CODE(J1-SUB)
      *          ELSE
      *          IF LN-MAKERCD(MAKER-SUB) = "E" AND
      *                                        ENDORSER-FILED = " "
      *             MOVE "T" TO TRW-J1-ECOA-CODE(J1-SUB).

      * (11) CONSUMER INFO INDICATOR
      ******************************************************
      * TEST FOR JOINT BANKRUPTCY
      ******************************************************
           IF LN-BNKRPTDATE NOT = 0
      * JOINT
             IF LN-MAKERCD(MAKER-SUB) = "J"
      * SECONDARY MAKER (JOINT) OR BOTH
               IF WHO-FILED = "S" OR "B"
                PERFORM TEST-LN-CONSUMER-INFO-IND
                MOVE WS-CONSUMER-INFO-IND TO
                         TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      * BANKRUPTCY DISMISSAL
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
              IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * JOINT
                 IF LN-MAKERCD(MAKER-SUB) = "J"
                    IF WHO-FILED = "S" OR "B"
                       PERFORM TEST-LT-CONSUMER-INFO-IND
                       MOVE WS-CONSUMER-INFO-IND TO
                              TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      ******************************************************
      * TEST FOR FIRST ENDORSER BANKRUPTCY
      ******************************************************

           IF LN-BNKRPTDATE NOT = 0
      * FIRST ENDORSER OR BOTH
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 1
                 IF ENDORSER-FILED = "1" OR "B"
                    PERFORM TEST-LN-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                          TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      * BANKRUPTCY DISMISSAL FIRST ENDORSER
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
             IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 1
                IF ENDORSER-FILED = "1" OR "B"
                  PERFORM TEST-LT-CONSUMER-INFO-IND
                  MOVE WS-CONSUMER-INFO-IND TO
                          TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      * SECOND ENDORSER OR BOTH
           IF LN-BNKRPTDATE NOT = 0
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 2
                IF ENDORSER-FILED = "2" OR "B"
                   PERFORM TEST-LN-CONSUMER-INFO-IND
                   MOVE WS-CONSUMER-INFO-IND TO
                          TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      * BANKRUPTCY DISMISSAL SECOND ENDORSER
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
             IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 2
                 IF ENDORSER-FILED = "2" OR "B"
                    PERFORM TEST-LT-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                           TRW-J1-CONSUMER-INFO-IND(J1-SUB).

      * BANKRUPT REAFFIRMATIONS AND DISCHARGES
           IF LN-MAKERCD(MAKER-SUB) = "J"
              IF DISCHARGE-DATE NOT = 0 
      * SHARING THIS ROUTINE WITH J1/J2 SO USE A HOLD FIELD
      * TEST-FOR-JOINT-DISCHARGE MAY OR MAY NOT CHANGE WS-CONSUMER-INFO-IND
                 MOVE TRW-J1-CONSUMER-INFO-IND(J1-SUB) TO
                                        WS-CONSUMER-INFO-IND
                 PERFORM TEST-FOR-JOINT-DISCHARGE
                 MOVE WS-CONSUMER-INFO-IND TO
                                 TRW-J1-CONSUMER-INFO-IND(J1-SUB)
              ELSE
                 IF REAFF-DATE NOT = 0 AND RESCIND-DATE = 0 
      * MUST BE SECONDARY OR BOTH
                    IF (WHO-FILED = "S" OR "B")
                        MOVE "R" TO TRW-J1-CONSUMER-INFO-IND(J1-SUB).
   
           IF BW-TIMEADDR = "98  "
              MOVE "T" TO TRW-J1-CONSUMER-INFO-IND(J1-SUB).

           MOVE LN-TRW-J-CONSUMER-IND TO TEST-IND.
           IF VALID-INDICATOR
              IF LN-TRW-J-CONSUMER-IND NOT = SPACES
                 MOVE LN-TRW-J-CONSUMER-IND TO
                                  TRW-J1-CONSUMER-INFO-IND(J1-SUB).

           ADD 1 TO J1-COUNT.
           ADD 1 TO J1-SUB.


      ********************************************
      *   CREATE TRW APPENDAGE SEGMENT J2
      * ACCOMMODATE THE REQUIREMENTS OF ECOA AND APPLIES WHEN
      * THE ASSOCIATED CONSUMER RESIDES AT A DIFFERENT ADDRESS AS
      * THE INDIVIDUAL REPORTED IN THE BASE SEGMENT
      ********************************************
       CREATE-SEGMENT-J2 SECTION.

           MOVE "J2" TO TRW-J2-ID(J2-SUB).

           MOVE TRW-B-CONSUMER-TRAN-TYPE TO
                 TRW-J2-CONSUMER-TRAN-TYPE(J2-SUB).

           MOVE BW-LNAME TO TRW-J2-LNAME(J2-SUB).
           PERFORM FIND-FIRST-NAME.
           MOVE OUT-NAME TO TRW-J2-FNAME(J2-SUB).
           PERFORM FIND-MIDDLE-NAME.
           MOVE OUT-NAME TO TRW-J2-MNAME(J2-SUB).

      * (6) 69 - 69
           MOVE SPACES TO TRW-J2-GENERATION(J2-SUB).
           MOVE TRW-J2-LNAME(J2-SUB) TO HOLD-LNAME.
           PERFORM FIND-GENERATION.
           MOVE HOLD-LNAME TO TRW-J2-LNAME(J2-SUB).
           MOVE OUT-NAME TO TRW-J2-GENERATION(J2-SUB).

      * (7)
           MOVE BW-SSNO TO TRW-J2-SOCSEC(J2-SUB).
      * CAN NOT START WITH 99X-XX-XXXX OR 98X-XX-XXXX
           IF TRW-INVALID-SSNO = "9"
              IF BW-SSNO NOT < 980000000
                 MOVE 999999999 TO TRW-J2-SOCSEC(J2-SUB).
      * CAN NOT START WITH 9XX-XX-XXXX OR 000-XX-XXXX
           IF TRW-INVALID-SSNO = "0"
              IF (BW-SSNO NOT < 900000000) OR 
                   (BW-SSNO NOT > 000999999)
                 MOVE 999999999 TO TRW-J2-SOCSEC(J2-SUB).

           IF BW-SSNO NOT = 0 AND BW-SSNO NOT = 999999999
              ADD 1 TO SSNO-COUNT J2-SSNO-COUNT.

      * (8)
           IF (BW-BDATE = 0)
              MOVE 0 TO TRW-J2-BDATE(J2-SUB)
           ELSE
              MOVE BW-BDATE TO DATE-YYYYMMDD
              PERFORM CONVERT-YYYYMMDD-TO-MMDDYYYY
              MOVE DATE-MMDDYYYY TO TRW-J2-BDATE(J2-SUB).
           IF (BW-BDATE NOT = 0)
              MOVE BW-BDATE TO NUM-DATE
              PERFORM TSTDAT
              IF NUM-DATE NOT = 0
                 ADD 1 TO BDATE-COUNT J2-BDATE-COUNT.

      * (9) TELEPHONE
           MOVE BW-PHONE TO TRW-J2-PHONE(J2-SUB).
           IF BW-PHONE NOT = 0
              ADD 1 TO PHONE-COUNT.

      * (10) ECOA CODE 97 - 97
      *    2 = JOINT CONTRACTUAL LIABILITY. JOINT ACCOUNT FOR WHICH THIS
      *              BORROWER HAS CONTRACTUAL RESPONSIBILITY.
      *    5 = CO-MAKER. ACCOUNT FOR WHICH THE SUBJECT IS THE CO-MAKER AND
      *                  BECOMES LIABLE IF THE MAKER DEFAULTS; NO SPOUSAL
      *                  RELATIONSHIP
           IF LN-MAKERCD(MAKER-SUB) = "J"
              MOVE "2" TO TRW-J2-ECOA-CODE(J2-SUB)
           ELSE
              MOVE "5" TO TRW-J2-ECOA-CODE(J2-SUB).

      * (11) CONSUMER INFO INDICATOR

      * FOR CHAPTER 13 BANKRUPT ACCOUNTS, IF THERE IS A NON-FILING CUSTOMER
      * ASSOCIATED WITH THE ACCOUNT, USE THE ECOA CODE OF "T" TO
      * TERMINATE THE CUSTOMER'S ASSOCIATION WITH THE ACCOUNT.

      *    IF GP-I-AM-REGACC
      *       IF LN-BNKRPTDATE NOT = 0 AND LN-BNKRPT-CHAPTER = 13
      *          IF LN-MAKERCD(MAKER-SUB) = "J" AND WHO-FILED = "M"
      *             MOVE "T" TO TRW-J2-ECOA-CODE(J2-SUB)
      *          ELSE
      *             IF LN-MAKERCD(MAKER-SUB) = "E" AND
      *                                        ENDORSER-FILED = " "
      *                MOVE "T" TO TRW-J2-ECOA-CODE(J2-SUB).

      ******************************************************
      * TEST FOR JOINT BANKRUPTCY
      ******************************************************

           IF LN-BNKRPTDATE NOT = 0
      * JOINT
              IF LN-MAKERCD(MAKER-SUB) = "J"
      * SECONDARY MAKER (JOINT) OR BOTH
               IF WHO-FILED = "S" OR "B"
                  PERFORM TEST-LN-CONSUMER-INFO-IND
                  MOVE WS-CONSUMER-INFO-IND TO
                      TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * BANKRUPTCY DISMISSAL
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
             IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * JOINT
              IF LN-MAKERCD(MAKER-SUB) = "J"
                 IF WHO-FILED = "S" OR "B"
                    PERFORM TEST-LT-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                           TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      ******************************************************
      * TEST FOR FIRST ENDORSER BANKRUPTCY
      ******************************************************

           IF LN-BNKRPTDATE NOT = 0
      * FIRST ENDORSER OR BOTH
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 1
                 IF ENDORSER-FILED = "1" OR "B"
                    PERFORM TEST-LN-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                           TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * BANKRUPTCY DISMISSAL FIRST ENDORSER
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
             IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 1
                 IF ENDORSER-FILED = "1" OR "B"
                    PERFORM TEST-LT-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                            TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * SECOND ENDORSER OR BOTH
           IF LN-BNKRPTDATE NOT = 0
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 2
                 IF ENDORSER-FILED = "2" OR "B"
                    PERFORM TEST-LN-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                           TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * BANKRUPTCY DISMISSAL SECOND ENDORSER
           IF LN-BNKRPT-DISMISS-DATE NUMERIC
             IF LN-BNKRPT-DISMISS-DATE NOT = 0 
      * ENDORSER
              IF LN-MAKERCD(MAKER-SUB) = "E" AND END-SUB = 2
                 IF ENDORSER-FILED = "2" OR "B"
                    PERFORM TEST-LT-CONSUMER-INFO-IND
                    MOVE WS-CONSUMER-INFO-IND TO
                          TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * BANKRUPT REAFFIRMATIONS AND DISCHARGES
           IF LN-MAKERCD(MAKER-SUB) = "J"
              IF DISCHARGE-DATE NOT = 0 
      * SHARING THIS ROUTINE WITH J1/J2 SO USE A HOLD FIELD
      * TEST-FOR-JOINT-DISCHARGE MAY OR MAY NOT CHANGE WS-CONSUMER-INFO-IND
                 MOVE TRW-J2-CONSUMER-INFO-IND(J2-SUB) TO
                                        WS-CONSUMER-INFO-IND
                 PERFORM TEST-FOR-JOINT-DISCHARGE
                 MOVE WS-CONSUMER-INFO-IND TO
                                 TRW-J2-CONSUMER-INFO-IND(J2-SUB)
              ELSE
                 IF REAFF-DATE NOT = 0 AND RESCIND-DATE = 0 
      * MUST BE SECONDARY OR BOTH
                    IF (WHO-FILED = "S" OR "B")
                        MOVE "R" TO TRW-J2-CONSUMER-INFO-IND(J2-SUB).

           IF BW-TIMEADDR = "98  "
              MOVE "T" TO TRW-J2-CONSUMER-INFO-IND(J2-SUB).

           MOVE LN-TRW-J-CONSUMER-IND TO TEST-IND.
           IF VALID-INDICATOR
              IF LN-TRW-J-CONSUMER-IND NOT = SPACES
                 MOVE LN-TRW-J-CONSUMER-IND TO
                                  TRW-J2-CONSUMER-INFO-IND(J2-SUB).

      * (12) COUNTRY
           MOVE "US" TO TRW-J2-COUNTRY(J2-SUB).

      * (13) FIRST LINE OF ADDRESS
           MOVE BW-ADR1 TO TRW-J2-ADR1(J2-SUB).

      * (14) SECOND LINE OF ADDRESS
           MOVE BW-ADR2 TO TRW-J2-ADR2(J2-SUB).

      * (15) CITY
           MOVE BW-CITY TO TRW-J2-CITY(J2-SUB).
      * (16) STATE
           MOVE BW-STATE TO TRW-J2-STATE(J2-SUB).
      * (17) ZIP
           MOVE BW-ZIP TO TRW-J2-ZIP(J2-SUB).
           IF ZIP-IN-BYTE(6) = "-"
              MOVE 1 TO OUT-SUB
              MOVE SPACES TO ZIP-OUT
              PERFORM VARYING IN-SUB FROM 1 BY 1 UNTIL IN-SUB > 10
                 IF ZIP-IN-BYTE(IN-SUB) NOT = "-"
                    MOVE ZIP-IN-BYTE(IN-SUB) TO ZIP-OUT-BYTE(OUT-SUB)
                    ADD 1 TO OUT-SUB
                 END-IF
              END-PERFORM
              MOVE ZIP-OUT TO TRW-J2-ZIP(J2-SUB).

      * (18) ADDRESS INDICATOR
           MOVE SPACES TO TRW-J2-ADD-IND(J2-SUB).

      * (19) RESIDENCE CODE
           IF BW-RENTCD = "RENT" OR "R  "
              MOVE "R" TO TRW-J2-RESIDENCE(J2-SUB)
           ELSE
           IF BW-RENTCD = "OWNS" OR "OWN " OR "O  "
              MOVE "O" TO TRW-J2-RESIDENCE(J2-SUB).


           ADD 1 TO J2-COUNT.
           ADD 1 TO J2-SUB.

      ********************************************
      *   CREATE TRW APPENDAGE SEGMENT L1
      * PROVIDES AN AUTOMATED METHOD FOR CHANGING THE CONSUMER
      * ACCOUNT NUMBER AND/OR IDENTIFICATION NUMBER AND
      * SHOULD ONLY BE REPORTED ONLY 1 TIME
      ********************************************
       CREATE-SEGMENT-L1 SECTION.

           MOVE "L1" TO TRW-L1-ID.

           MOVE 1 TO TRW-L1-CHANGE-IND.

           MOVE 0 TO TRW-L1-NEW-ACCTNO1.
           IF (TRW-INFO-BRNO-ACCTNO = "Y")
              MOVE 0 TO TRW-L1-NEW-ACCTNO2
              MOVE LN-OWNBR TO TRW-L1-W-BRNO
              MOVE LN-ACCTNO     TO WS-NEW-NUMBER
              MOVE 01            TO WS-NEW-SEQNO
              MOVE WS-A15-ACCTNO TO TRW-L1-W-ACCT
           ELSE
              MOVE LN-ACCTNO     TO WS-NEW-NUMBER
              MOVE 01            TO WS-NEW-SEQNO
              MOVE WS-A15-ACCTNO TO TRW-L1-NEW-ACCTNO2.
      * THE L1 SEGMENT CONTAINS THE NEW ACCOUNT NUMBER AND THE BASE
      * SEGMENTS CONTAINS THE OLD ACCOUNT NUMBER

           MOVE LN-COLLID TO TRW-B-ACCTNOX.

      ********************************************
      *   CREATE TRW APPENDAGE SEGMENT L1
      * PROVIDES AN AUTOMATED METHOD FOR CHANGING THE CONSUMER
      * ACCOUNT NUMBER AND/OR IDENTIFICATION NUMBER AND
      * SHOULD ONLY BE REPORTED 1 TIME
      *
      * THIS ONE IF FOR ACCOUNTS THAT WERE TRANSFERRED FROM
      * ANOTHER BRANCH WITH BULKT2 OR BULKG2
      ********************************************
       CREATE-SEGMENT-L1-TRANSFERRED SECTION.

           MOVE LN-OWNBR  TO LSM-BRNO.
           MOVE LN-ACCTNO TO LSM-ACCTNO.
           MOVE 1         TO LSM-SEQNO.
           PERFORM READ-LSM1-FILE.
           IF IO-FG NOT = 0
              GO TO EXIT-CREATE-SEGMENT-L1-TRANSFERRED.

      * IF THE TRANSFER DATE IS THE SAME AS ENTERED DATE, DO NOT CREATE
      * THE "L1" AS ACCOUNT HAS NEVER BEEN REPORTED, SO DO NOT NEED

           MOVE LSM-TRANS-FROM-DATE TO NUM-DATE.
           MOVE LN-ENTDATE          TO DATE-YYYYMMDD.
           IF NUM-MO = DATE-YYYYMMDD-MM AND
               NUM-YR = DATE-YYYYMMDD-YY
              GO TO EXIT-CREATE-SEGMENT-L1-TRANSFERRED.

      * ONLY CREATE THE "L1" SEGMENT IF THE TRANSFERRED DATE MMYY IS
      * SAME AS THE REPORTING MMYY. ONLY CREATE THIS ONCE AND DONE.

           MOVE LSM-TRANS-FROM-DATE TO NUM-DATE.
           MOVE END-REPORT-DATE     TO DATE-YYYYMMDD.
           IF NUM-MO NOT = DATE-YYYYMMDD-MM OR
               NUM-YR NOT = DATE-YYYYMMDD-YY
              GO TO EXIT-CREATE-SEGMENT-L1-TRANSFERRED.

      * THE "L1" SEGMENT CONTAINS THE NEW CONSUMER ACCOUNT NUMBER AND
      * THE BASE SEGMENT CONTAINS THE OLD CONSUMER ACCOUNT FOR FIRST MONTH
      * OF THE TRANSFER, THEN SUBSEQUENT REPORTING, THE BASE WILL
      * CONTAIN THE NEW NUMBER AND THE "L1" IS NOT REPORTED.

      * BASE SEGMENT = OLD FROM ACCOUNT
      * BASE SEGMENT = OLD TRW-B-IDENT-NO = ORIGINAL FROM BRANCH

           MOVE 0                     TO TRW-B-ACCTNO.
           MOVE LSM-TRANS-FROM-BRNO   TO TRW-B-W-BRNO
                                         TRW-B-IDENT-NO2.
      * ACCTNO MUST CONTINUE TO HAVE THE 01 SEQUENCE 
           MOVE LSM-TRANS-FROM-ACCTNO TO WS-NEW-NUMBER.
           MOVE 01                    TO WS-NEW-SEQNO.
           MOVE WS-A15-ACCTNO         TO TRW-B-W-ACCT.

      * (1) SEGMENT IDENTIFIER
           MOVE "L1" TO TRW-L1-ID.

      * (2) CHANGE INDICATOR
      *     1 = CONSUMER ACCOUNT NUMBER CHANGE
      *     2 = IDENTIFICATION NUMBER CHANGE ONLY
      *     3 = CONSUMER ACCOUNT NUMBER AND IDENTIFICATION NUMBER CHANGE

           MOVE 3 TO TRW-L1-CHANGE-IND.

      * (3) NEW CONSUMER ACCOUNT NUMBER

           MOVE 0             TO TRW-L1-NEW-ACCTNO1.
           MOVE 0             TO TRW-L1-NEW-ACCTNO2.
           MOVE LN-OWNBR      TO TRW-L1-W-BRNO.
      * ACCTNO MUST CONTINUE TO HAVE THE 01 SEQUENCE 
           MOVE LN-ACCTNO     TO WS-NEW-NUMBER.
           MOVE 01            TO WS-NEW-SEQNO.
           MOVE WS-A15-ACCTNO TO TRW-L1-W-ACCT.

      * (4) IDENTIFICATION NUMBER
      * NEW IDENTIFICATION NUMBER - NEW OWNING BRANCH

           IF TRW-INFO-IDENT-BRNO = "Y"
              MOVE 0        TO TRW-L1-NEW-IDENT1
              MOVE LN-OWNBR TO TRW-L1-NEW-IDENT2.
       
       EXIT-CREATE-SEGMENT-L1-TRANSFERRED.
           EXIT.

      ********************************************
      *   CREATE TRW APPENDAGE SEGMENT N1
      * REPORT EMPLOYMENT INFO FOR THE CONSUMER REPORTED
      * IN THE BASE SEGMENT
      ********************************************
       CREATE-SEGMENT-N1 SECTION.

           MOVE "N1" TO TRW-N1-ID.
           MOVE BW-EMPLOYER TO TRW-N1-EMP-NAME.
      *(3)
           MOVE BW-EMPADDR1 TO  TRW-N1-EMP-ADR1.
      *(4)
           MOVE BW-EMPADDR2 TO  TRW-N1-EMP-ADR2.
      *(5) EMPLOYER CITY                            
      *(6) EMPLOYER STATE                           
      *(7) EMPLOYER ZIPCODE                         
      *(8) OCCUPATION                               
           MOVE BW-EMPLPOS TO TRW-N1-OCCUPATION.


      ******************************************
       COMPUTE-AGEING-CAT SECTION.
      ******************************************
           MOVE LN-ORGST    TO SP-ORGST.
           MOVE LN-SPRCLASS TO SP-SPRCLASS.
           MOVE LN-SUBCLASS TO SP-SUBCLASS.
           MOVE LN-LAWCODE  TO SP-LAWCODE.
           IF LPWSSP-SP1-KEY NOT = SP1-KEY
              MOVE SP1-KEY TO LPWSSP-SP1-KEY
      *       PERFORM READ-SP1-FILE
              PERFORM ARRAYSP-READ
              IF IO-FG NOT = 0
                 GO TO IO-ERROR.

           MOVE LN-1STPYDATE TO CEPP1-DATE.
           MOVE END-REPORT-DATE TO AGEING-DATE CEPP2-DATE.
           IF DEL-FLAG = "Y"
              MOVE NEXT-MO-AGEING-DATE TO AGEING-DATE CEPP2-DATE.

      *---------------------------------------------------------
      *    SET TRW CONTRACTUAL CODES
      *---------------------------------------------------------
           MOVE SP-TRWBANKRULE TO SP-BANKRULE.
           MOVE SP-TRWCONTPDTH TO SP-CONTPDTH.
           MOVE SP-TRWBANKUNITPER-CD TO SP-BANKUNITPER-CD.
      *---------------------------------------------------------
           PERFORM COMPUTE-CONTRACTUAL.

      *    PERFORM CONTRACTUAL-DELINQUENCY.  NOTE: USED IN A50

           MOVE LN-1STPYDATE TO CEPP1-DATE.
           MOVE END-REPORT-DATE TO AGEING-DATE CEPP2-DATE.
           IF DEL-FLAG = "Y"
              MOVE NEXT-MO-AGEING-DATE TO AGEING-DATE CEPP2-DATE.
           PERFORM TOTAL-DELINQUENCY.

           MOVE CDEL-ARREARAGE TO AMT-PASTDUE.

      * CSUB = 8 = MISSPAY
      * CSUB = 9 = POT 30
      * CSUB =10 = CURRENT
           IF CSUB > 7
              MOVE 0 TO AMT-PASTDUE.

      *****************************
       FIND-ACTUAL-PAYMENTS SECTION.
      *****************************

      * ADDED THIS FLAG SO YOU DONT HAVE TO PERFORM FIND-LAST-TRANS-DATE
           MOVE "Y" TO READ-LP-FILE.
           MOVE 0   TO HOLD-LAST-TRANS-DATE.

           MOVE LN-OWNBR      TO LP-BRNO
                                 QLP1-WBEG-BRNO
                                 QLP1-WEND-BRNO.
           MOVE LN-ACCTNO     TO LP-ACCTNO
                                 QLP1-WBEG-ACCTNO
                                 QLP1-WEND-ACCTNO.
           MOVE 99999         TO LP-SEQNO
                                 QLP1-WEND-SEQNO.
           MOVE ALL "0"       TO QLP1-WBEG-SEQNO.

           PERFORM START-LP1-FILE-NOT-GREATER.
       FIND-ACTUAL-NEXT.
           PERFORM READ-LP1-FILE-PREVIOUS.
           IF IO-FG NOT = 0
              GO TO EXIT-FIND-ACTUAL-PAYMENTS.

           IF LP-BRNO NOT = LN-OWNBR OR LP-ACCTNO NOT = LN-ACCTNO
              GO TO EXIT-FIND-ACTUAL-PAYMENTS.

           IF LP-REV = "Y" OR LP-TRCD = "RV"
              GO TO FIND-ACTUAL-NEXT.

           MOVE LP-PAYDATE TO HOLD-LAST-TRANS-DATE.

      * IF LAST PAYMENT IS PRIOR TO BEG REPORTING PERIOD DATE, THEN
      * YOU ARE DONE, YOU WONT FIND ANY
            IF LP-TRDATE < BEG-REPORT-DATE
               GO TO EXIT-FIND-ACTUAL-PAYMENTS.

            IF LP-TRDATE NOT > END-REPORT-DATE
      * WORLD #1226 INVESTINET AUTO CREATED PAYMENTS (SP/INVEST)
               IF LP-TRCD = "AA" AND LP-REFNO = "INVES"
                   ADD LP-TRAMT TO TRW-B-ACTUAL-PAID
               ELSE
               IF LP-TRCD = "PY" OR "PA" OR "PO" OR "PE"
                         OR "DF" OR "D2" OR "D3" OR "D4"
                         OR "D5" OR "D6" OR "D7" OR "D8"
                         OR "D9" OR "IN"
                         OR "PR" OR "PC" OR "PP" OR "Z2"
                         OR "SS" OR "AH" OR "PN" OR "PZ"
                   ADD LP-TRAMT TO TRW-B-ACTUAL-PAID.

            GO TO FIND-ACTUAL-NEXT.

       EXIT-FIND-ACTUAL-PAYMENTS.
           EXIT.

      ****************************
       WRITE-DETAIL-LINE SECTION.
      ****************************
           ADD LN-FEED LN-COUNT GIVING LN-WK.
           IF LN-WK > EXT-CONAME-RPT-LINES
              PERFORM HEAD-PAGE.
           MOVE DETAIL-LINE TO PR-REC.
           PERFORM WRITE-PR-REC.
           ADD LN-FEED TO LN-COUNT.
           MOVE 1 TO LN-FEED.
           MOVE SPACES TO DETAIL-LINE.

      *******************************
       HEAD-PAGE SECTION.
      *******************************
           ADD 1 TO PAGE-NUMBER.
           MOVE PAGE-NUMBER TO H-PAGE-NO.
      *    PERFORM GET-TIME.
      *    MOVE T-HH TO H-HR.
      *    MOVE T-MM TO H-MIN.

           MOVE HEAD1 TO PR-REC.
           MOVE 99 TO LN-FEED.
           PERFORM WRITE-PR-REC.

           MOVE HEAD2 TO PR-REC.
           MOVE 1 TO LN-FEED.
           PERFORM WRITE-PR-REC.

       END-HEAD-PAGE.
           MOVE 2 TO LN-COUNT.
           MOVE 2 TO LN-FEED.

      *******************************
       PRINT-RANGE-LINES SECTION.
      *******************************

           MOVE 2 TO LN-FEED.

           IF GROUP-FLAG = "Y"
              MOVE "BRANCH GROUP" TO RANGE-SELECTION
              MOVE ENT-GROUP TO RANGE1
              PERFORM WRITE-DETAIL-LINE
           ELSE
              MOVE "BEG BR - END BR" TO RANGE-SELECTION
              MOVE BEG-BR TO RANGE1N
              MOVE END-BR TO RANGE2N
              PERFORM WRITE-DETAIL-LINE.

           MOVE "BEG CL - END CL" TO RANGE-SELECTION.
           MOVE BEG-CL TO RANGE1N.
           MOVE END-CL TO RANGE2N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "BEG ACCT - END ACCT" TO RANGE-SELECTION.
           MOVE BEG-ACCOUNT TO RANGE1N.
           MOVE END-ACCOUNT TO RANGE2N.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TAPE CREATION DATE" TO RANGE-SELECTION.
           MOVE CREATE-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-ALPDATE.
           MOVE ALP-DATE TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "BEGIN DATE OF REPORTING PERIOD" TO RANGE-SELECTION.
           MOVE BEG-REPORT-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-ALPDATE.
           MOVE ALP-DATE TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "END DATE   OF REPORTING PERIOD" TO RANGE-SELECTION.
           MOVE END-REPORT-DATE TO DATE-YYYYMMDD.
           PERFORM CONVERT-YYYYMMDD-TO-ALPDATE.
           MOVE ALP-DATE TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "EXPERIAN ID" TO RANGE-SELECTION.
           MOVE TRW-INFO-EXPERIAN-ID TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "EQUIFAX ID" TO RANGE-SELECTION.
           MOVE TRW-INFO-EQUIFAX-ID TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TRANS UNION ID" TO RANGE-SELECTION.
           MOVE TRW-INFO-TUC-ID TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "INNOVIS ID" TO RANGE-SELECTION.
           MOVE TRW-INFO-INNOVIS-ID TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "GRANTOR CODE" TO RANGE-SELECTION.
           MOVE TRW-INFO-GRANTOR-CODE TO RANGE1.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "TOTAL RECORDS READ" TO RANGE-SELECTION.
           MOVE TOT-RECORDS TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL RECORDS DELETED" TO RANGE-SELECTION.
           MOVE TOT-DELETED TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL RECORDS OUT OF RANGE" TO RANGE-SELECTION.
           MOVE TOT-BYPASSED TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL SKIPPED ZERO BALS   " TO RANGE-SELECTION.
           MOVE TOT-ZBALS TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL RECORDS INCORRECT DATA" TO RANGE-SELECTION.
           MOVE TOT-INCORRECT TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL RECORDS 80 MONTH 'DA' " TO RANGE-SELECTION.
           MOVE TOT-80-DA TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "TOTAL RECORDS SUBMITTED" TO RANGE-SELECTION.
           MOVE TOT-ACTIVE TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.

           MOVE 2 TO LN-FEED.
           MOVE "AGEING:" TO RANGE-SELECTION.
           PERFORM WRITE-DETAIL-LINE.
           MOVE 0 TO WORK-COUNT WORK-AMOUNT.
           MOVE 1 TO LN-FEED.
           MOVE 1 TO CSUB.
       PRINT-AGEING-LOOP.
           MOVE AGE-DESC(CSUB)   TO RANGE-SELECTION.
           MOVE AGE-COUNT(CSUB)  TO RANGE1N.
           MOVE AGE-AMOUNT(CSUB) TO RANGE3.
           ADD AGE-COUNT(CSUB)   TO WORK-COUNT.
           ADD AGE-AMOUNT(CSUB)  TO WORK-AMOUNT.
           PERFORM WRITE-DETAIL-LINE.

           ADD 1 TO CSUB.
           IF CSUB < 10
              GO TO PRINT-AGEING-LOOP.

           MOVE "TOTALS.............." TO RANGE-SELECTION.
           MOVE WORK-COUNT             TO RANGE1N.
           MOVE WORK-AMOUNT            TO RANGE3.
           PERFORM WRITE-DETAIL-LINE.

           MOVE AGE-DESC(10)           TO RANGE-SELECTION.
           MOVE AGE-COUNT(10)          TO RANGE1N.
           MOVE AGE-AMOUNT(10)         TO RANGE3.
           PERFORM WRITE-DETAIL-LINE.

           MOVE AGE-DESC(11)           TO RANGE-SELECTION.
           MOVE AGE-COUNT(11)          TO RANGE1N.
           MOVE AGE-AMOUNT(11)         TO RANGE3.
           PERFORM WRITE-DETAIL-LINE.

           MOVE 0 TO WORK-COUNT WORK-AMOUNT.
           MOVE 2 TO LN-FEED.
           MOVE "REPORTED:" TO RANGE-SELECTION.
           PERFORM WRITE-DETAIL-LINE.

           MOVE 1 TO LN-FEED.
           MOVE 1 TO CSUB.
       PRINT-AGEING-LOOP2.
           MOVE AGE-DESC(CSUB)        TO RANGE-SELECTION.
           MOVE REPORTED-COUNT(CSUB)  TO RANGE1N.
           MOVE REPORTED-AMOUNT(CSUB) TO RANGE3.
           ADD REPORTED-COUNT(CSUB)   TO WORK-COUNT.
           ADD REPORTED-AMOUNT(CSUB)  TO WORK-AMOUNT.
           IF CSUB > 7
              ADD 1 CSUB GIVING SUB
              MOVE AGE-DESC(SUB) TO RANGE-SELECTION.
           PERFORM WRITE-DETAIL-LINE.

           ADD 1 TO CSUB.
           IF CSUB < 11
              GO TO PRINT-AGEING-LOOP2.

           MOVE "TOTALS.............." TO RANGE-SELECTION.
           MOVE WORK-COUNT             TO RANGE1N.
           MOVE WORK-AMOUNT            TO RANGE3.
           PERFORM WRITE-DETAIL-LINE.

           MOVE 2 TO LN-FEED.
           MOVE "CONVERSION RECORDS" TO RANGE-SELECTION.
           MOVE CONV-COUNT           TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.

           MOVE 1 TO LN-FEED.
           MOVE "UPDATED RECORDS" TO RANGE-SELECTION.
           MOVE UPDATED-COUNT     TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "NEW RECORDS" TO RANGE-SELECTION.
           MOVE NEW-COUNT     TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.

           MOVE "J1 SEGMENTS" TO RANGE-SELECTION.
           MOVE J1-COUNT      TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "J2 SEGMENTS" TO RANGE-SELECTION.
           MOVE J2-COUNT      TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "K1 SEGMENTS" TO RANGE-SELECTION.
           MOVE K1-COUNT      TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.
           MOVE "K2 SEGMENTS" TO RANGE-SELECTION.
           MOVE K2-COUNT      TO RANGE1N.
           PERFORM WRITE-DETAIL-LINE.

      *********************************************
       FIND-VOLUNTARY-FLAG SECTION.
      *********************************************

           MOVE "I" TO VOL-INVOL-FLAG.

      * REGACC REDEEMED REPO MUST READ LAST SEQUENCED LS RECORD AS THE
      * "SV" TRANSACTION MOVES SEQ 1 TO NEXT AVAILABLE SEQ AND DELETES
      * SEQUENCE 1
           IF GP-REPO-CODE = "A" AND LN-REPOCD = "V"
              PERFORM FIND-LAST-VOLUNTARY-FLAG
              GO TO EXIT-FIND-VOLUNTARY-FLAG.

           MOVE LN-OWNBR  TO LSX-BRNO.
           MOVE LN-ACCTNO TO LSX-ACCTNO.
           MOVE 1         TO LSX-SEQNO.
           PERFORM READ-LSX1-FILE.
           IF IO-FG = 0
              MOVE LSX-VOLUNTARY-FG TO VOL-INVOL-FLAG
           ELSE
              MOVE "I" TO VOL-INVOL-FLAG.

       EXIT-FIND-VOLUNTARY-FLAG.
           EXIT.

      *********************************************
       FIND-LAST-VOLUNTARY-FLAG SECTION.
      *********************************************
      * REGACC REDEEMED REPO MUST READ LAST SEQUENCED LS RECORD AS THE
      * "SV" TRANSACTION MOVES SEQ 1 TO NEXT AVAILABLE SEQ AND DELETES
      * SEQUENCE 1

           MOVE LN-OWNBR  TO LSX-BRNO
                             QLSX1-WBEG-BRNO
                             QLSX1-WEND-BRNO.
           MOVE LN-ACCTNO TO LSX-ACCTNO
                             QLSX1-WBEG-ACCTNO
                             QLSX1-WEND-ACCTNO.
           MOVE 99        TO LSX-SEQNO
                             QLSX1-WEND-SEQNO.
           MOVE ALL "0"   TO QLSX1-WBEG-SEQNO.

           PERFORM START-LSX1-FILE-NOT-GREATER.
           PERFORM READ-LSX1-FILE-PREVIOUS.
           IF IO-BAD
              GO TO EXIT-FIND-LAST-VOLUNTARY-FLAG.

      * DID NOT FIND ANY
           IF (LSX-ACCTNO NOT = LN-ACCTNO) OR
                    (LSX-SEQNO = 1)
              GO TO EXIT-FIND-LAST-VOLUNTARY-FLAG.

           MOVE LSX-VOLUNTARY-FG TO VOL-INVOL-FLAG.


       EXIT-FIND-LAST-VOLUNTARY-FLAG.
           EXIT.

      * CREATE A MEMO IF EXTRACTED FOR INTERIM ONLY
      ***************************
       UPDATE-LM-FILE SECTION.
      ***************************

           MOVE LN-OWNBR  TO LM-BRNO.
           MOVE LN-ACCTNO TO LM-ACCTNO.

           SUBTRACT CREATE-DATE FROM 99999999 GIVING LM-DATE.

           MOVE 1 TO LM-SEQ.

           MOVE "EXTRACTED IN INTERIM CREDIT BUREAU" TO LM-MEMO.

           MOVE "S " TO LM-MEMO-TYPE.

       WRITE-MEMO.
           PERFORM WRITE-LM1-FILE.
           IF IO-FG NOT = 0
              IF LM-SEQ NOT = 999
                 ADD 1 TO LM-SEQ
                 GO TO WRITE-MEMO
              ELSE
                 MOVE BR-NO TO D-BRNO
                 MOVE LN-ACCTNO TO D-NUMBER
                 MOVE TRW-B-LNAME TO D-NAME
                 MOVE "*" TO D-SERIOUS
                 MOVE "MAX LINES FOR MEMO REACHED" TO D-MSG1
                 PERFORM WRITE-DETAIL-LINE.

       COPY "LIBGB/TIMEIO.CPY".
       COPY "LIBGB/DATER.CPY".
       COPY "LIBLP/ADDONSPR.CPY".
       COPY "LIBLP/LPAMTS.CPY".
       COPY "LIBLP/LPUPWK.CPY".
       COPY "LIBLP/LPUPER.CPY".
       COPY "LIBLP/LPPOFF.CPY".
       COPY "LIBLP/LPPOF2.CPY".
       COPY "LIBGB/RBACT.CPY".
       COPY "LIBLP/LPITRM.CPY".
       COPY "LIBGB/REBATE.CPY".
       COPY "LIBLP/LPAPRS.CPY".
       COPY "LIBLP/LPAPRZ.CPY".
       COPY "LIBGB/AGEING.CPY".
       COPY "LIBGB/SPPDTH.CPY".
       COPY "LIBLP/LPPDUE.CPY".
       COPY "LIBLP/LPCEPP.CPY".
       COPY "LIBLP/LPTDEL.CPY".
       COPY "LIBLP/LPCDEL.CPY".
       COPY "LIBLP/LPMDTE.CPY".
       COPY "LIBLP/LPXDTE.CPY".
       COPY "LIBLP/LPRATE.CPY".
       COPY "LIBLP/LPIBPC.CPY".
       COPY "LIBLP/LPLCAP.CPY".
       COPY "LIBLP/LPLCAS.CPY".
       COPY "LIBLP/LPSCHD.CPY".
       COPY "LIBLP/LPLCHG.CPY".
       COPY "LIBGB/SCREEN.CPY".
       COPY "LIBGB/GRWORK.CPY".
       COPY "LIBGB/GRSERCH.CPY".
       COPY "LIBLP/SETCTBL.CPY".
       COPY "LIBGB/GPENV.CPY".

       COPY "LIBLP/ARRAYSP.CPY".

      **************************************************
       FORM-RESET SECTION.
      **************************************************
           MOVE EXT-CONAME-CONAME TO METRO2-CONAME.
           MOVE EXT-CONAME-SYSDATE TO METRO2-SYSDATE.
           DISPLAY METRO2-SCREEN UPON EXT-EOBUF-WINDOW-HANDLE.
           MOVE METRO2-FORM-FIELDS TO WR-BUF.
           MOVE METRO2-FORM-LIST TO WR-LIST.
           PERFORM CALL-WRFORM.

      **************************************************
       SETUP-LINK-INFO SECTION.
      **************************************************
           MOVE METRO2-HELP--FILE TO HELP-LINK-FILE.
           MOVE METRO2-HELP--DIR TO HELP-LINK-DIR.

      **************************************************
       VDU-CONVERT-FIELD SECTION.
      **************************************************
           MOVE "00" TO STAT.
           MOVE VDU-FIELD-TO-CONVERT TO VDU-ALP-FIELD.
           EVALUATE TRUE
              COPY "LIBSP/METRO2_EVA.CPY".
              WHEN OTHER       MOVE   "2A" TO STAT
           END-EVALUATE.

      *************************
       MISC-ROUTINES SECTION.
      *************************
       COPY "LIBGB/GETPR.CPY".
       COPY "LIBGB/ACCESS.CPY".
       COPY "LIBGB/DACCESS.CPY".
       COPY "LIBGB/SYSTEM.CPY".
       UPDATE-STATUS-COUNTS.
           IF TRW-B-STATUS = "DA"
              ADD 1 TO DA-COUNT
           ELSE
           IF TRW-B-STATUS = "05"
              ADD 1 TO 05-COUNT
           ELSE
           IF TRW-B-STATUS = "11"
              ADD 1 TO 11-COUNT
           ELSE
           IF TRW-B-STATUS = "13"
              ADD 1 TO 13-COUNT
           ELSE
           IF TRW-B-STATUS = "61"
              ADD 1 TO 61-COUNT
           ELSE
           IF TRW-B-STATUS = "62"
              ADD 1 TO 62-COUNT
           ELSE
           IF TRW-B-STATUS = "63"
              ADD 1 TO 63-COUNT
           ELSE
           IF TRW-B-STATUS = "64"
              ADD 1 TO 64-COUNT
           ELSE
           IF TRW-B-STATUS = "65"
              ADD 1 TO 65-COUNT
           ELSE
           IF TRW-B-STATUS = "71"
              ADD 1 TO 71-COUNT
           ELSE
           IF TRW-B-STATUS = "78"
              ADD 1 TO 78-COUNT
           ELSE
           IF TRW-B-STATUS = "80"
              ADD 1 TO 80-COUNT
           ELSE
           IF TRW-B-STATUS = "82"
              ADD 1 TO 82-COUNT
           ELSE
           IF TRW-B-STATUS = "83"
              ADD 1 TO 83-COUNT
           ELSE
           IF TRW-B-STATUS = "84"
              ADD 1 TO 84-COUNT
           ELSE
           IF TRW-B-STATUS = "88"
              ADD 1 TO 88-COUNT
           ELSE
           IF TRW-B-STATUS = "89"
              ADD 1 TO 89-COUNT
           ELSE
           IF TRW-B-STATUS = "93"
              ADD 1 TO 93-COUNT
           ELSE
           IF TRW-B-STATUS = "94"
              ADD 1 TO 94-COUNT
           ELSE
           IF TRW-B-STATUS = "95"
              ADD 1 TO 95-COUNT
           ELSE
           IF TRW-B-STATUS = "96"
              ADD 1 TO 96-COUNT
           ELSE
           IF TRW-B-STATUS = "97"
              ADD 1 TO 97-COUNT.
       WRITE-THE-TRANSMIT-FILE.
           MOVE TRW-REC TO TRW-E-REC.
           MOVE X"0D" TO TRW-E-CR.
           MOVE X"0A" TO TRW-E-LF.
           PERFORM WRITE-TRW-E-FILE.
       TEST-LN-CONSUMER-INFO-IND.
           MOVE SPACES TO WS-CONSUMER-INFO-IND.
           IF LN-BNKRPT-CHAPTER = 7 
              MOVE "A" TO WS-CONSUMER-INFO-IND
           ELSE
           IF LN-BNKRPT-CHAPTER = 11 
              MOVE "B" TO WS-CONSUMER-INFO-IND
           ELSE
           IF LN-BNKRPT-CHAPTER = 12
              MOVE "C" TO WS-CONSUMER-INFO-IND
           ELSE
           IF LN-BNKRPT-CHAPTER = 13
              MOVE "D" TO WS-CONSUMER-INFO-IND
           ELSE
           IF LN-BNKRPT-CHAPTER = 28
              IF LN-CURBAL NOT = 0
                 MOVE "1A" TO WS-CONSUMER-INFO-IND
              ELSE
                 MOVE "Q"  TO WS-CONSUMER-INFO-IND.
       TEST-LT-CONSUMER-INFO-IND.
           MOVE SPACES TO WS-CONSUMER-INFO-IND.
           IF BNKRPT-CHAPTER = 7 
              MOVE "I" TO WS-CONSUMER-INFO-IND
           ELSE
           IF BNKRPT-CHAPTER = 11 
              MOVE "J" TO WS-CONSUMER-INFO-IND
           ELSE
           IF BNKRPT-CHAPTER = 12
              MOVE "K" TO WS-CONSUMER-INFO-IND
           ELSE
           IF BNKRPT-CHAPTER = 13
              MOVE "L" TO WS-CONSUMER-INFO-IND
           ELSE
           IF BNKRPT-CHAPTER = 28
              MOVE "Q" TO WS-CONSUMER-INFO-IND.

       TEST-FOR-BASE-DISCHARGE.
           IF WHO-FILED NOT = "S"
              IF DISCHARGE-SYSDATE NOT < BEG-REPORT-DATE
                 IF DISCHARGE-SYSDATE NOT > END-REPORT-DATE
                    IF LN-BNKRPT-CHAPTER = 7
                       MOVE "E" TO TRW-B-CONSUMER-INFO-IND
                    ELSE
                       IF LN-BNKRPT-CHAPTER = 11
                          MOVE "F" TO TRW-B-CONSUMER-INFO-IND
                       ELSE
                          IF LN-BNKRPT-CHAPTER = 12
                             MOVE "G" TO TRW-B-CONSUMER-INFO-IND
                          ELSE
                            IF LN-BNKRPT-CHAPTER = 13
                              MOVE "H" TO TRW-B-CONSUMER-INFO-IND.
       TEST-FOR-JOINT-DISCHARGE.
      * SHARED BY J1/J2 ROUTINE SO IT SETS WS-CONSUMER-INFO-IND
           IF (WHO-FILED = "S" OR "B")
              IF DISCHARGE-SYSDATE NOT < BEG-REPORT-DATE
                 IF DISCHARGE-SYSDATE NOT > END-REPORT-DATE
                    IF LN-BNKRPT-CHAPTER = 7
                       MOVE "E" TO WS-CONSUMER-INFO-IND
                    ELSE
                       IF LN-BNKRPT-CHAPTER = 11
                          MOVE "F" TO WS-CONSUMER-INFO-IND
                       ELSE
                         IF LN-BNKRPT-CHAPTER = 12
                            MOVE "G" TO WS-CONSUMER-INFO-IND
                         ELSE
                           IF LN-BNKRPT-CHAPTER = 13
                              MOVE "H" TO WS-CONSUMER-INFO-IND.
       GET-LT-BANKRUPT.
           MOVE LN-OWNBR  TO LTB-BRNO.
           MOVE LN-ACCTNO TO LTB-ACCTNO.
           MOVE 1         TO LTB-SEQNO.
           PERFORM OPEN-LTB1-FILE.
           PERFORM READ-LTB1-FILE.
           PERFORM CLOSE-LTB1-FILE.
           IF IO-FG NOT = 0
              MOVE SPACES TO LTB-WHO-FILED LTB-ENDORSER-FILED
              MOVE 0 TO LTB-CHAPTER LTB-REAFF-DATE LTB-DISCHARGE-DATE
                        LTB-DISCHARGE-SYSDATE LTB-RESCIND-DATE.
       SETUP-DETAIL-LINE.
           MOVE BR-NO TO D-BRNO.
           MOVE LN-ACCTNO TO D-NUMBER.
           MOVE TRW-B-LNAME TO D-NAME.
           MOVE TRW-B-STATUS TO D-STATUS.
           MOVE TRW-B-COMMENT TO D-COMMENTS.
           MOVE "INTERIM TRW " TO D-MSG1.
           PERFORM WRITE-DETAIL-LINE.
       TEST-POCD.
           IF LN-POCD = "RN" OR "10"
              MOVE "13" TO TRW-B-STATUS
              MOVE "AS" TO TRW-B-COMMENT
           ELSE
      * 13 PAID OR CLOSED ACCOUNT/ZERO BALANCE
      * 61 PAID ACCOUNT/WAS A VOLUNTARY SURRENDER
      * 63 ACCOUNT PAID IN FULL/WAS A REPO
      * 64 ACCOUNT PAID IN FULL/WAS A CHARGE-OFF
      * 96 MERCHANDISE WAS REPOSSESSED BY CREDIT GRANTOR, THERE MAY
      *    BE A BALANCE DUE
      * 97 UNPAID BALANCE REPORTED AS A LOSS BY CREDIT GRANTOR
           IF LN-POCD = "13" OR "61" OR "63" OR "64" OR "97" OR "96"
              MOVE LN-POCD TO TRW-B-STATUS
           ELSE
           IF LN-POCD = "DP" OR "66"
              MOVE "13" TO TRW-B-STATUS
              MOVE "BN" TO TRW-B-COMMENT
           ELSE
      * CLAIM FILED FOR INSURED PORTION OF BALANCE
           IF LN-POCD = "92"
              MOVE "13" TO TRW-B-STATUS
              MOVE "BP" TO TRW-B-COMMENT
           ELSE
      * ACCOUNT TRANSFERRED TO ANOTHER OFFCE
           IF LN-POCD = "BT" OR "05"
              MOVE "05" TO TRW-B-STATUS.
       ZERO-AGEING.
           MOVE 0 TO AGE-COUNT(SUB).
           MOVE 0 TO AGE-AMOUNT(SUB).
           ADD 1 TO SUB.
       ZERO-REPORTED.
           MOVE 0 TO REPORTED-COUNT(SUB).
           MOVE 0 TO REPORTED-AMOUNT(SUB).
           ADD 1 TO SUB.
       GET-BORROWER.
           PERFORM READ-BW1-FILE.
           IF IO-FG NOT = 0
              MOVE SPACES TO BORROWER-INFO(2)
           ELSE
              MOVE BW-ADR1 TO BORROWER-ADR1(2)
              MOVE BW-ADR2 TO BORROWER-ADR2(2)
              MOVE BW-CITY TO BORROWER-CITY(2)
              MOVE BW-STATE TO BORROWER-STATE(2)
              MOVE BW-ZIP TO BORROWER-ZIP(2).

      *********************************
       IO-ROUTINE SECTION.
      *********************************
       COPY "LIBGB/CONNECT_SQL.CPY".
       COPY "LIBSP/SPTRWINFOGS_SQL.CPY".
       COPY "LIBLP/LPSPGS_SQL.CPY".
       COPY "LIBLP/LPLTPGS_SQL.CPY".
       COPY "LIBLP/LPLTIGS_SQL.CPY".
       COPY "LIBLP/LPLTBGS_SQL.CPY".
       COPY "LIBLP/LPLSXGS_SQL.CPY".
       COPY "LIBLP/LPLSMGS_SQL.CPY".
       COPY "LIBLP/LPLPGS_SQL.CPY".
       COPY "LIBLP/LPLNGS_SQL.CPY".
       COPY "LIBLP/LPLMGS_SQL.CPY".
       COPY "LIBLP/LPLCGS_SQL.CPY".
       COPY "LIBLP/LPCDGS_SQL.CPY".
       COPY "LIBLP/LPBWGS_SQL.CPY".
       COPY "LIBLP/LPBMGS_SQL.CPY".
       COPY "LIBGB/GBGRGS_SQL.CPY".
       COPY "LIBGB/GBGBGS_SQL.CPY".
       COPY "LIBGB/GBBRGS_SQL.CPY".
       COPY "LIBSP/SPTRWINFORN.CPY".
       COPY "LIBGB/GBGBRN.CPY".
       COPY "LIBGB/GBBRRN.CPY".
       COPY "LIBGB/GBGR1RN.CPY".
       COPY "LIBGB/GBPRINT.CPY".
       COPY "LIBSP/SPTWRN.CPY".
       COPY "LIBSP/SPTWERN.CPY".
       COPY "LIBLP/LPCD1RN.CPY".
       COPY "LIBLP/LPLC1RN.CPY".

      * COPYMEMBER: LIBLP/LPLM1IN
      * 2024.0219 SET LM-LTOUCH-TIME-HHMM AND LM-LTOUCH-USERID
       LOAD-LM1-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LM-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LM-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LM-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LM-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LM-ALL-DATA
              MOVE LM-ALL-PATH             TO LM-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LM-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LM-ALL-BASE
              MOVE FILPATH-MACHINE         TO LM-ALL-MACHINE
              MOVE FILPATH-DATA            TO LM-ALL-DATA
              MOVE LM-ALL-PATH             TO LM-PATH.

      *-----------------------------------------------------------------
       OPEN-LM1-FILE.
           PERFORM LOAD-LM1-FILE.
           PERFORM OPEN-IT.
           MOVE LM-PATH-SQL TO E-FILE.

      *    IF ( SQL-CONNECT-STAT-BAD )
      *       PERFORM SQL-CONNECT.

      *-----------------------------------------------------------------
       WRITE-LM1-FILE.

           MOVE LM-PATH-OWNBR         TO LM-BRNO.
           ACCEPT LM-LTOUCH-DATE      FROM CENTURY-DATE.
           ACCEPT WS-LM-LTOUCH-TIME   FROM TIME.
           MOVE WS-LM-LTOUCH-HHMM     TO LM-LTOUCH-TIME-HHMM.
           MOVE EXT-CONAME-USER-ID    TO LM-LTOUCH-USERID.
           PERFORM WRITE-IT.
           MOVE LM-PATH-SQL    TO E-FILE.
           MOVE LM1-KEY        TO E-KEYX.
           PERFORM SET-LM-FIELDS.

      * CHANGE CONNECTION TO UPDATE_CONNECT
           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            INSERT INTO DBO.LMFILE
             (LMFILE.LM_BRNO,
              LMFILE.LM_ACCTNO,
              LMFILE.LM_DATE_REVERSED,
              LMFILE.LM_SEQ,
              LMFILE.LM_LTOUCH_DATE,
              LMFILE.LM_LTOUCH_TIME_HHMM,
              LMFILE.LM_LTOUCH_USERID,
              LMFILE.LM_MEMO,
              LMFILE.LM_MEMO_TYPE)
            VALUES
             (:QLM-BRNO,
              :QLM-ACCTNO,
              :QLM-DATE-REVERSED,
              :QLM-SEQ,
              :QLM-LTOUCH-DATE,
              :QLM-LTOUCH-TIME-HHMM,
              :QLM-LTOUCH-USERID,
              :QLM-MEMO,
              :QLM-MEMO-TYPE)
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO WRITE-LM1-FILE.

      * CHANGE CONNECTION TO BACK TO C1
           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

      *    IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION.

      *-----------------------------------------------------------------
       CLOSE-LM1-FILE.

           PERFORM CLOSE-IT.
      *-----------------------------------------------------------------

       COPY "LIBLP/LPLP1RN.CPY".
       COPY "LIBLP/LPLTB1RN.CPY".
       COPY "LIBLP/LPLTP1RN.CPY".
       COPY "LIBLP/LPLTI1RN.CPY".
       COPY "LIBLP/LPLSX1RN.CPY".
       COPY "LIBLP/LPLSM1RN.CPY".
       COPY "LIBLP/LPBW1RN.CPY".
       COPY "LIBLP/LPBM1RN.CPY".
       COPY "LIBLP/LPSP1RN.CPY".

      * COPY "LIBLP/LPLN3IN.CPY".
      * COPYMEMBER: LIBLP/LPLN3IN
      ***********************************************************
      *                (LPLN3IN)
      * REV:
      *  JTG 081497 CHANGED LN-SALEFIN TO LN-GIFTNET WORLD A90
      *  BLV 012298 RENAME UPDATE-BI-FILE PARAGRAPH TO
      *             LN3-UPDATE-BI-FILE (CONFLICT WITH LPLN1IN)
      *  BLV 020698 ADDED LN-SALEFIN BACK TO BICREA CALL
      *  MJD ADDED LN-PLCD AND LN-CONVERCD TO BICREA CALL
      *  BAH 04/22/2016 ADDED LN-SMALLOAN TO BICREA CALL, REGENCY PR#5030
      *  BAH 20180316 ADDED LN-PLDATE TO BICREA CALL, WORLD #1308
      ***********************************************************
       LN3-UPDATE-BI-FILE.
           IF IO-FG = 0
              MOVE "CL/BICREA" TO FORM-NAM
              CALL FORM-PROGX USING FORM-PATH
                                   STAT
                                   LN-ACCTNO
                                   LN-BWTABLE
                                   LN-OWNBR
                                   LN-ORGST
                                   LN-SALEFIN
                                   LN-GIFTNET
                                   LN-ENTDATE
                                   LN-POFFDATE
                                   LN-PLCD
                                   LN-CONVERCD
                                   "000000000"
                                   LN-SMALLOAN
                                   LN-PLDATE
             CANCEL FORM-PROGX.
       LOAD-LN3-FILE.
      *- - - -{ SET OVERRIDE TO A "Y" TO NOT TOUCH THE PATH AT ALL  }- -
           IF ( LN-PATH-OVERRIDE = "Y" ) 
              NEXT SENTENCE
           ELSE
      *- - - -{ SPACES IS THE DEFAULT, NO CROSSING BRANCHES }- - - - - -
           IF ( LN-PATH-OVERRIDE = SPACES ) 
              MOVE EXT-FILPATH-BASE        TO LN-ALL-BASE
              MOVE EXT-FILPATH-MACHINE     TO LN-ALL-MACHINE
              MOVE EXT-FILPATH-DATA        TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH
           ELSE
      *- - - -{ USE BRANCH VALUES }- - - - - - - - - - - - - - - - - - -
           IF ( LN-PATH-OVERRIDE = "B" ) 
              MOVE FILPATH-BASE            TO LN-ALL-BASE
              MOVE FILPATH-MACHINE         TO LN-ALL-MACHINE
              MOVE FILPATH-DATA            TO LN-ALL-DATA
              MOVE LN-ALL-PATH             TO LN-PATH.

      *-----------------------------------------------------------------
       OPEN-LN3-FILE.
           PERFORM LOAD-LN3-FILE.
           PERFORM OPEN-IT.
           MOVE LN-PATH-SQL TO E-FILE.

            IF LN3-CONN-OPEN-SW = "N" 
               EXEC SQL CONNECT TO :SQL-CONNECT-SERVER AS LN3_CONNECT
                    USER :SQL-CONNECT-USERID USING :SQL-CONNECT-PSWD
               END-EXEC
               MOVE "Y" TO LN3-CONN-OPEN-SW
               EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       START-LN3-FILE.   *> SSP LN LSM BW
           PERFORM START-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

           IF ( LN3-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LN3-FILE.

           EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC.

      *    SELECT LNFILE.LN_OWNBR,
      *            LNFILE.LN_ACCTNO,
      *            LNFILE.LN_CLASS,
      *            LNFILE.LN_SUBCLASS,
      *            LNFILE.LN_LAWCODE,
      *            LNFILE.LN_SSNO1,
      *            LNFILE.LN_MAKERCD1,
      *            LNFILE.LN_SSNO2,
      *            LNFILE.LN_MAKERCD2,
      *            LNFILE.LN_SSNO3,
      *            LNFILE.LN_MAKERCD3,
      *            LNFILE.LN_SSNO4,
      *            LNFILE.LN_MAKERCD4,
      *            LNFILE.LN_ORGST,
      *            LNFILE.LN_ORGBR,
      *            LNFILE.LN_OWNST,
      *            LNFILE.LN_SPRCLASS,
      *            LNFILE.LN_CONVERCD,
      *            LNFILE.LN_MIDSTREAM,
      *            LNFILE.LN_PURCD,
      *            LNFILE.LN_SRCD,
      *            LNFILE.LN_COLLCD,
      *            LNFILE.LN_COLLID,
      *            LNFILE.LN_POCD,
      *            LNFILE.LN_PLCD,
      *            LNFILE.LN_PLTYPE,
      *            LNFILE.LN_CONFIDENTCD,
      *            LNFILE.LN_ALLOTCD,
      *            LNFILE.LN_RECASTCD,
      *            LNFILE.LN_SKIP_TRW,
      *            LNFILE.LN_STATUSFG,
      *            LNFILE.LN_SMALLOAN,
      *            LNFILE.LN_SALEFIN,
      *            LNFILE.LN_SERVACCT,
      *            LNFILE.LN_LOANTYPE,
      *            LNFILE.LN_ADDON_FG,
      *            LNFILE.LN_PAY_SCHLD_FG,
      *            LNFILE.LN_LC_CODE,
      *            LNFILE.LN_CAN_LOAN_NO,
      *            LNFILE.LN_STATFLAGS,
      *            CAST(LNFILE.LN_ENTDATE            AS VARCHAR(10)) AS LN_ENTDATE,
      *            CAST(LNFILE.LN_LOANDATE           AS VARCHAR(10)) AS LN_LOANDATE,
      *            CAST(LNFILE.LN_PURDATE            AS VARCHAR(10)) AS LN_PURDATE,
      *            CAST(LNFILE.LN_INTDATE            AS VARCHAR(10)) AS LN_INTDATE,
      *            CAST(LNFILE.LN_CASHDATE           AS VARCHAR(10)) AS LN_CASHDATE,
      *            CAST(LNFILE.LN_FILEDATE           AS VARCHAR(10)) AS LN_FILEDATE,
      *            CAST(LNFILE.LN_RESCISSION_DATE    AS VARCHAR(10)) AS LN_RESCISSION_DATE,
      *            CAST(LNFILE.LN_PART_RECOURSE_DATE AS VARCHAR(10)) AS LN_PART_RECOURSE_DATE,
      *            CAST(LNFILE.LN_ORIG_1STPYDATE     AS VARCHAR(10)) AS LN_ORIG_1STPYDATE,
      *            CAST(LNFILE.LN_1STPYDATE          AS VARCHAR(10)) AS LN_1STPYDATE,
      *            CAST(LNFILE.LN_JDDATE             AS VARCHAR(10)) AS LN_JDDATE,
      *            CAST(LNFILE.LN_PLDATE             AS VARCHAR(10)) AS LN_PLDATE,
      *            CAST(LNFILE.LN_PL_TRDATE          AS VARCHAR(10)) AS LN_PL_TRDATE,
      *            CAST(LNFILE.LN_ACCELDATE          AS VARCHAR(10)) AS LN_ACCELDATE,
      *            CAST(LNFILE.LN_REDUDATE           AS VARCHAR(10)) AS LN_REDUDATE,
      *            CAST(LNFILE.LN_POFFDATE           AS VARCHAR(10)) AS LN_POFFDATE,
      *            CAST(LNFILE.LN_PO_TRDATE          AS VARCHAR(10)) AS LN_PO_TRDATE,
      *            CAST(LNFILE.LN_LEGALDATE          AS VARCHAR(10)) AS LN_LEGALDATE,
      *            CAST(LNFILE.LN_BNKRPTDATE         AS VARCHAR(10)) AS LN_BNKRPTDATE,
      *            CAST(LNFILE.LN_BNKRPT_DISMISS_DATE   AS VARCHAR(10)) AS LN_BNKRPT_DISMISS_DATE,
      *            CAST(LNFILE.LN_BNKRPT_DISCHARGE_DATE AS VARCHAR(10)) AS LN_BNKRPT_DISCHARGE_DATE,
      *            CAST(LNFILE.LN_BNKRPT_REAFFIRM_DATE  AS VARCHAR(10)) AS LN_BNKRPT_REAFFIRM_DATE,
      *            CAST(LNFILE.LN_DEBTAIDATE            AS VARCHAR(10)) AS LN_DEBTAIDATE,
      *            CAST(LNFILE.LN_REPODATE              AS VARCHAR(10)) AS LN_REPODATE,
      *            CAST(LNFILE.LN_REDEEMDATE            AS VARCHAR(10)) AS LN_REDEEMDATE,
      *            CAST(LNFILE.LN_SOLDDATE              AS VARCHAR(10)) AS LN_SOLDDATE,
      *            CAST(LNFILE.LN_INS_CONFIRM_DATE      AS VARCHAR(10)) AS LN_INS_CONFIRM_DATE,
      *            CAST(LNFILE.LN_PRIOR_RN_FOR10_DATE   AS VARCHAR(10)) AS LN_PRIOR_RN_FOR10_DATE,
      *            CAST(LNFILE.LN_LAST_RN_FOR10_DATE    AS VARCHAR(10)) AS LN_LAST_RN_FOR10_DATE,
      *            CAST(LNFILE.LN_TRW_DOFD_DATE         AS VARCHAR(10)) AS LN_TRW_DOFD_DATE,
      *            CAST(LNFILE.LN_LAST_PYPA_DATE        AS VARCHAR(10)) AS LN_LAST_PYPA_DATE,
      *            CAST(LNFILE.LN_BT_TRDATE             AS VARCHAR(10)) AS LN_BT_TRDATE,
      *            CAST(LNFILE.LN_METRO2_LAST_PMT_DATE  AS VARCHAR(10)) AS LN_METRO2_LAST_PMT_DATE,
      *            CAST(LNFILE.LN_FOLLOWUP_DATE         AS VARCHAR(10)) AS LN_FOLLOWUP_DATE,
      *            CAST(LNFILE.LN_LAST_ACCRUAL_DATE     AS VARCHAR(10)) AS LN_LAST_ACCRUAL_DATE,
      *            LNFILE.LN_APRATE,
      *            LNFILE.LN_EFFRATE,
      *            LNFILE.LN_SMPRATE,
      *            LNFILE.LN_YLDRATE,
      *            LNFILE.LN_OVRDRATE,
      *            LNFILE.LN_ENDORATE,
      *            LNFILE.LN_JDRATE,
      *            LNFILE.LN_ACCRATE,
      *            LNFILE.LN_REDURATE,
      *            LNFILE.LN_CONRATE,
      *            LNFILE.LN_SERVPER,
      *            LNFILE.LN_SELLPR,
      *            LNFILE.LN_DOWNPY,
      *            LNFILE.LN_TRADEIN,
      *            LNFILE.LN_LNAMT,
      *            LNFILE.LN_FINCHG,
      *            LNFILE.LN_INTCHG,
      *            LNFILE.LN_SERCHG,
      *            LNFILE.LN_EXTCHG,
      *            LNFILE.LN_MAINTFEE,
      *            LNFILE.LN_POINTS,
      *            LNFILE.LN_PROCEEDS,
      *            LNFILE.LN_ORGTERM,
      *            LNFILE.LN_1STPYAMT,
      *            LNFILE.LN_NOREGPY,
      *            LNFILE.LN_REGPYAMT,
      *            LNFILE.LN_LASTPYAMT,
      *            LNFILE.LN_PROCASH,
      *            LNFILE.LN_TILLNO,
      *            LNFILE.LN_STATE_FLAG,
      *            LNFILE.LN_STATE_WORKER,
      *            LNFILE.LN_STATE_WORKER2,
      *            LNFILE.LN_FEECODE_1,
      *            LNFILE.LN_FEEAMT_1,
      *            LNFILE.LN_FEEOURS_1,
      *            LNFILE.LN_FEEFINCHG_1,
      *            LNFILE.LN_FEECODE_2,
      *            LNFILE.LN_FEEAMT_2,
      *            LNFILE.LN_FEEOURS_2,
      *            LNFILE.LN_FEEFINCHG_2,
      *            LNFILE.LN_FEECODE_3,
      *            LNFILE.LN_FEEAMT_3,
      *            LNFILE.LN_FEEOURS_3,
      *            LNFILE.LN_FEEFINCHG_3,
      *            LNFILE.LN_FEECODE_4,
      *            LNFILE.LN_FEEAMT_4,
      *            LNFILE.LN_FEEOURS_4,
      *            LNFILE.LN_FEEFINCHG_4,
      *            LNFILE.LN_FEECODE_5,
      *            LNFILE.LN_FEEAMT_5,
      *            LNFILE.LN_FEEOURS_5,
      *            LNFILE.LN_FEEFINCHG_5,
      *            LNFILE.LN_FEECODE_6,
      *            LNFILE.LN_FEEAMT_6,
      *            LNFILE.LN_FEEOURS_6,
      *            LNFILE.LN_FEEFINCHG_6,
      *            LNFILE.LN_FEECODE_7,
      *            LNFILE.LN_FEEAMT_7,
      *            LNFILE.LN_FEEOURS_7,
      *            LNFILE.LN_FEEFINCHG_7,
      *            LNFILE.LN_FEECODE_8,
      *            LNFILE.LN_FEEAMT_8,
      *            LNFILE.LN_FEEOURS_8,
      *            LNFILE.LN_FEEFINCHG_8,
      *            LNFILE.LN_FEECODE_9,
      *            LNFILE.LN_FEEAMT_9,
      *            LNFILE.LN_FEEOURS_9,
      *            LNFILE.LN_FEEFINCHG_9,
      *            LNFILE.LN_FEECODE_10,
      *            LNFILE.LN_FEEAMT_10,
      *            LNFILE.LN_FEEOURS_10,
      *            LNFILE.LN_FEEFINCHG_10,
      *            LNFILE.LN_FEECODE_11,
      *            LNFILE.LN_FEEAMT_11,
      *            LNFILE.LN_FEEOURS_11,
      *            LNFILE.LN_FEEFINCHG_11,
      *            LNFILE.LN_FEECODE_12,
      *            LNFILE.LN_FEEAMT_12,
      *            LNFILE.LN_FEEOURS_12,
      *            LNFILE.LN_FEEFINCHG_12,
      *            LNFILE.LN_FEECODE_13,
      *            LNFILE.LN_FEEAMT_13,
      *            LNFILE.LN_FEEOURS_13,
      *            LNFILE.LN_FEEFINCHG_13,
      *            LNFILE.LN_FEECODE_14,
      *            LNFILE.LN_FEEAMT_14,
      *            LNFILE.LN_FEEOURS_14,
      *            LNFILE.LN_FEEFINCHG_14,
      *            LNFILE.LN_FEECODE_15,
      *            LNFILE.LN_FEEAMT_15,
      *            LNFILE.LN_FEEOURS_15,
      *            LNFILE.LN_FEEFINCHG_15,
      *            LNFILE.LN_FEECODE_16,
      *            LNFILE.LN_FEEAMT_16,
      *            LNFILE.LN_FEEOURS_16,
      *            LNFILE.LN_FEEFINCHG_16,
      *            LNFILE.LN_FEECODE_17,
      *            LNFILE.LN_FEEAMT_17,
      *            LNFILE.LN_FEEOURS_17,
      *            LNFILE.LN_FEEFINCHG_17,
      *            LNFILE.LN_FEECODE_18,
      *            LNFILE.LN_FEEAMT_18,
      *            LNFILE.LN_FEEOURS_18,
      *            LNFILE.LN_FEEFINCHG_18,
      *            LNFILE.LN_FEECODE_19,
      *            LNFILE.LN_FEEAMT_19,
      *            LNFILE.LN_FEEOURS_19,
      *            LNFILE.LN_FEEFINCHG_19,
      *            LNFILE.LN_FEECODE_20,
      *            LNFILE.LN_FEEAMT_20,
      *            LNFILE.LN_FEEOURS_20,
      *            LNFILE.LN_FEEFINCHG_20,
      *            LNFILE.LN_INSURED,
      *            LNFILE.LN_INSTYPES,
      *            LNFILE.LN_INSELIGIBLE,
      *            LNFILE.LN_INSCOMP_1,
      *            LNFILE.LN_INSOURS_1,
      *            CAST(LNFILE.LN_INSEFF_DATE_1 AS VARCHAR(10)) AS LN_INSEFF_DATE_1,
      *            CAST(LNFILE.LN_INSEXP_DATE_1 AS VARCHAR(10)) AS LN_INSEXP_DATE_1,
      *            LNFILE.LN_INSPREM_1,
      *            LNFILE.LN_INSCOVR_1,
      *            LNFILE.LN_INSCOMM_1,
      *            LNFILE.LN_INSANTICERN_1,
      *            LNFILE.LN_INSANTICADJ_1,
      *            LNFILE.LN_INSUFERN_1,
      *            LNFILE.LN_INSACCERN_1,
      *            LNFILE.LN_INSEARN_ORDER_1,
      *            LNFILE.LN_INSFINCHG_1,
      *            LNFILE.LN_INSCOMP_2,
      *            LNFILE.LN_INSOURS_2,
      *            CAST(LNFILE.LN_INSEFF_DATE_2 AS VARCHAR(10)) AS LN_INSEFF_DATE_2,
      *            CAST(LNFILE.LN_INSEXP_DATE_2 AS VARCHAR(10)) AS LN_INSEXP_DATE_2,
      *            LNFILE.LN_INSPREM_2,
      *            LNFILE.LN_INSCOVR_2,
      *            LNFILE.LN_INSCOMM_2,
      *            LNFILE.LN_INSANTICERN_2,
      *            LNFILE.LN_INSANTICADJ_2,
      *            LNFILE.LN_INSUFERN_2,
      *            LNFILE.LN_INSACCERN_2,
      *            LNFILE.LN_INSEARN_ORDER_2,
      *            LNFILE.LN_INSFINCHG_2,
      *            LNFILE.LN_INSCOMP_3,
      *            LNFILE.LN_INSOURS_3,
      *            CAST(LNFILE.LN_INSEFF_DATE_3 AS VARCHAR(10)) AS LN_INSEFF_DATE_3,
      *            CAST(LNFILE.LN_INSEXP_DATE_3 AS VARCHAR(10)) AS LN_INSEXP_DATE_3,
      *            LNFILE.LN_INSPREM_3,
      *            LNFILE.LN_INSCOVR_3,
      *            LNFILE.LN_INSCOMM_3,
      *            LNFILE.LN_INSANTICERN_3,
      *            LNFILE.LN_INSANTICADJ_3,
      *            LNFILE.LN_INSUFERN_3,
      *            LNFILE.LN_INSACCERN_3,
      *            LNFILE.LN_INSEARN_ORDER_3,
      *            LNFILE.LN_INSFINCHG_3,
      *            LNFILE.LN_INSCOMP_4,
      *            LNFILE.LN_INSOURS_4,
      *            CAST(LNFILE.LN_INSEFF_DATE_4 AS VARCHAR(10)) AS LN_INSEFF_DATE_4,
      *            CAST(LNFILE.LN_INSEXP_DATE_4 AS VARCHAR(10)) AS LN_INSEXP_DATE_4,
      *            LNFILE.LN_INSPREM_4,
      *            LNFILE.LN_INSCOVR_4,
      *            LNFILE.LN_INSCOMM_4,
      *            LNFILE.LN_INSANTICERN_4,
      *            LNFILE.LN_INSANTICADJ_4,
      *            LNFILE.LN_INSUFERN_4,
      *            LNFILE.LN_INSACCERN_4,
      *            LNFILE.LN_INSEARN_ORDER_4,
      *            LNFILE.LN_INSFINCHG_4,
      *            LNFILE.LN_INSCOMP_5,
      *            LNFILE.LN_INSOURS_5,
      *            CAST(LNFILE.LN_INSEFF_DATE_5 AS VARCHAR(10)) AS LN_INSEFF_DATE_5,
      *            CAST(LNFILE.LN_INSEXP_DATE_5 AS VARCHAR(10)) AS LN_INSEXP_DATE_5,
      *            LNFILE.LN_INSPREM_5,
      *            LNFILE.LN_INSCOVR_5,
      *            LNFILE.LN_INSCOMM_5,
      *            LNFILE.LN_INSANTICERN_5,
      *            LNFILE.LN_INSANTICADJ_5,
      *            LNFILE.LN_INSUFERN_5,
      *            LNFILE.LN_INSACCERN_5,
      *            LNFILE.LN_INSEARN_ORDER_5,
      *            LNFILE.LN_INSFINCHG_5,
      *            LNFILE.LN_INSCOMP_6,
      *            LNFILE.LN_INSOURS_6,
      *            CAST(LNFILE.LN_INSEFF_DATE_6 AS VARCHAR(10)) AS LN_INSEFF_DATE_6,
      *            CAST(LNFILE.LN_INSEXP_DATE_6 AS VARCHAR(10)) AS LN_INSEXP_DATE_6,
      *            LNFILE.LN_INSPREM_6,
      *            LNFILE.LN_INSCOVR_6,
      *            LNFILE.LN_INSCOMM_6,
      *            LNFILE.LN_INSANTICERN_6,
      *            LNFILE.LN_INSANTICADJ_6,
      *            LNFILE.LN_INSUFERN_6,
      *            LNFILE.LN_INSACCERN_6,
      *            LNFILE.LN_INSEARN_ORDER_6,
      *            LNFILE.LN_INSFINCHG_6,
      *            LNFILE.LN_INSCOMP_7,
      *            LNFILE.LN_INSOURS_7,
      *            CAST(LNFILE.LN_INSEFF_DATE_7 AS VARCHAR(10)) AS LN_INSEFF_DATE_7,
      *            CAST(LNFILE.LN_INSEXP_DATE_7 AS VARCHAR(10)) AS LN_INSEXP_DATE_7,
      *            LNFILE.LN_INSPREM_7,
      *            LNFILE.LN_INSCOVR_7,
      *            LNFILE.LN_INSCOMM_7,
      *            LNFILE.LN_INSANTICERN_7,
      *            LNFILE.LN_INSANTICADJ_7,
      *            LNFILE.LN_INSUFERN_7,
      *            LNFILE.LN_INSACCERN_7,
      *            LNFILE.LN_INSEARN_ORDER_7,
      *            LNFILE.LN_INSFINCHG_7,
      *            LNFILE.LN_INSCOMP_8,
      *            LNFILE.LN_INSOURS_8,
      *            CAST(LNFILE.LN_INSEFF_DATE_8 AS VARCHAR(10)) AS LN_INSEFF_DATE_8,
      *            CAST(LNFILE.LN_INSEXP_DATE_8 AS VARCHAR(10)) AS LN_INSEXP_DATE_8,
      *            LNFILE.LN_INSPREM_8,
      *            LNFILE.LN_INSCOVR_8,
      *            LNFILE.LN_INSCOMM_8,
      *            LNFILE.LN_INSANTICERN_8,
      *            LNFILE.LN_INSANTICADJ_8,
      *            LNFILE.LN_INSUFERN_8,
      *            LNFILE.LN_INSACCERN_8,
      *            LNFILE.LN_INSEARN_ORDER_8,
      *            LNFILE.LN_INSFINCHG_8,
      *            LNFILE.LN_INSCOMP_9,
      *            LNFILE.LN_INSOURS_9,
      *            CAST(LNFILE.LN_INSEFF_DATE_9 AS VARCHAR(10)) AS LN_INSEFF_DATE_9,
      *            CAST(LNFILE.LN_INSEXP_DATE_9 AS VARCHAR(10)) AS LN_INSEXP_DATE_9,
      *            LNFILE.LN_INSPREM_9,
      *            LNFILE.LN_INSCOVR_9,
      *            LNFILE.LN_INSCOMM_9,
      *            LNFILE.LN_INSANTICERN_9,
      *            LNFILE.LN_INSANTICADJ_9,
      *            LNFILE.LN_INSUFERN_9,
      *            LNFILE.LN_INSACCERN_9,
      *            LNFILE.LN_INSEARN_ORDER_9,
      *            LNFILE.LN_INSFINCHG_9,
      *            LNFILE.LN_INSCOMP_10,
      *            LNFILE.LN_INSOURS_10,
      *            CAST(LNFILE.LN_INSEFF_DATE_10 AS VARCHAR(10)) AS LN_INSEFF_DATE_10,
      *            CAST(LNFILE.LN_INSEXP_DATE_10 AS VARCHAR(10)) AS LN_INSEXP_DATE_10,
      *            LNFILE.LN_INSPREM_10,
      *            LNFILE.LN_INSCOVR_10,
      *            LNFILE.LN_INSCOMM_10,
      *            LNFILE.LN_INSANTICERN_10,
      *            LNFILE.LN_INSANTICADJ_10,
      *            LNFILE.LN_INSUFERN_10,
      *            LNFILE.LN_INSACCERN_10,
      *            LNFILE.LN_INSEARN_ORDER_10,
      *            LNFILE.LN_INSFINCHG_10,
      *            LNFILE.LN_PY_YYYYMM_RECDEL,
      *            LNFILE.LN_MTD_PAYS_RECDEL,
      *            LNFILE.LN_GARNISH_EXTR,
      *            LNFILE.LN_SHIP_SAME_FG,
      *            LNFILE.LN_AD_D_INS_COVR,
      *            LNFILE.LN_TOT_PARTIAL_CHGOFF,
      *            LNFILE.LN_LPO,
      *            LNFILE.LN_REP_CD,
      *            LNFILE.LN_EMP_ID,
      *            LNFILE.LN_PROCESS_CD,
      *            LNFILE.LN_WCBC_CREDITLIM,
      *            LNFILE.LN_FOLLOWUP_CD,
      *            LNFILE.LN_MIP_FG,
      *            LNFILE.LN_MIP_MTD_CLAHPAID,
      *            CAST(LNFILE.LN_MIP_CLPDTH_DATE AS VARCHAR(10)) AS LN_MIP_CLPDTH_DATE,
      *            LNFILE.LN_MIP_TOT_CLPAID,
      *            CAST(LNFILE.LN_MIP_AHPDTH_DATE AS VARCHAR(10)) AS LN_MIP_AHPDTH_DATE,
      *            LNFILE.LN_MIP_TOT_AHPAID,
      *            LNFILE.LN_IL_GROSS_INCOME,
      *            LNFILE.LN_IL_GROSS_INCOME2,
      *            LNFILE.LN_RESCISSION,
      *            LNFILE.LN_INTERIM_TRW,
      *            LNFILE.LN_DLNO,
      *            LNFILE.LN_DLPOOL,
      *            LNFILE.LN_DLRECOURSE,
      *            LNFILE.LN_DLPARTRCAMT,
      *            LNFILE.LN_ORIGPURAMT,
      *            LNFILE.LN_PURBAL,
      *            LNFILE.LN_DLRVPRIN_1,
      *            LNFILE.LN_DLRVPRIN_2,
      *            LNFILE.LN_DLRVPRIN_3,
      *            LNFILE.LN_DLRVCHGS_1,
      *            LNFILE.LN_DLRVCHGS_2,
      *            LNFILE.LN_DLRVCHGS_3,
      *            LNFILE.LN_DLPARVHELD,
      *            LNFILE.LN_DLPARVPAID,
      *            LNFILE.LN_DLDISC,
      *            CAST(LNFILE.LN_LCPDTH_DATE  AS VARCHAR(10)) AS LN_LCPDTH_DATE,
      *            CAST(LNFILE.LN_INTPDTH_DATE AS VARCHAR(10)) AS LN_INTPDTH_DATE,
      *            LNFILE.LN_CURBAL,
      *            LNFILE.LN_INTBAL,
      *            LNFILE.LN_LCBAL,
      *            LNFILE.LN_OTHBAL,
      *            LNFILE.LN_OT2BAL,
      *            LNFILE.LN_LCPAID,
      *            LNFILE.LN_LCPARTIALS,
      *            LNFILE.LN_STMT_COUNTER,
      *            LNFILE.LN_PRIOR_STMT_COUNTER,
      *            LNFILE.LN_FROZEN_REASON,
      *            LNFILE.LN_COUPON_STATEMENT,
      *            LNFILE.LN_MONTHEND_BAL,
      *            LNFILE.LN_ANTICTERM,
      *            LNFILE.LN_ANTICERN_1,
      *            LNFILE.LN_ANTICADJ_1,
      *            LNFILE.LN_UFERN_1,
      *            LNFILE.LN_ACCERN_1,
      *            LNFILE.LN_EARN_ORDER_1,
      *            LNFILE.LN_ANTICERN_2,
      *            LNFILE.LN_ANTICADJ_2,
      *            LNFILE.LN_UFERN_2,
      *            LNFILE.LN_ACCERN_2,
      *            LNFILE.LN_EARN_ORDER_2,
      *            LNFILE.LN_ANTICERN_3,
      *            LNFILE.LN_ANTICADJ_3,
      *            LNFILE.LN_UFERN_3,
      *            LNFILE.LN_ACCERN_3,
      *            LNFILE.LN_EARN_ORDER_3,
      *            LNFILE.LN_ANTICERN_4,
      *            LNFILE.LN_ANTICADJ_4,
      *            LNFILE.LN_UFERN_4,
      *            LNFILE.LN_ACCERN_4,
      *            LNFILE.LN_EARN_ORDER_4,
      *            LNFILE.LN_ANTICERN_5,
      *            LNFILE.LN_ANTICADJ_5,
      *            LNFILE.LN_UFERN_5,
      *            LNFILE.LN_ACCERN_5,
      *            LNFILE.LN_EARN_ORDER_5,
      *            LNFILE.LN_ANTICERN_6,
      *            LNFILE.LN_ANTICADJ_6,
      *            LNFILE.LN_UFERN_6,
      *            LNFILE.LN_ACCERN_6,
      *            LNFILE.LN_EARN_ORDER_6,
      *            LNFILE.LN_ANTICERN_7,
      *            LNFILE.LN_ANTICADJ_7,
      *            LNFILE.LN_UFERN_7,
      *            LNFILE.LN_ACCERN_7,
      *            LNFILE.LN_EARN_ORDER_7,
      *            LNFILE.LN_ANTICERN_8,
      *            LNFILE.LN_ANTICADJ_8,
      *            LNFILE.LN_UFERN_8,
      *            LNFILE.LN_ACCERN_8,
      *            LNFILE.LN_EARN_ORDER_8,
      *            LNFILE.LN_ANTICERN_9,
      *            LNFILE.LN_ANTICADJ_9,
      *            LNFILE.LN_UFERN_9,
      *            LNFILE.LN_ACCERN_9,
      *            LNFILE.LN_EARN_ORDER_9,
      *            LNFILE.LN_ANTICERN_10,
      *            LNFILE.LN_ANTICADJ_10,
      *            LNFILE.LN_UFERN_10,
      *            LNFILE.LN_ACCERN_10,
      *            LNFILE.LN_EARN_ORDER_10,
      *            LNFILE.LN_LMO_PRIOR_INTEREST,
      *            LNFILE.LN_PRIOR_UNEARNED,
      *            LNFILE.LN_ERNDELQ_STOP,
      *            LNFILE.LN_NONACRERN,
      *            LNFILE.LN_PRIOR_NONACRERN,
      *            CAST(LNFILE.LN_ERN_IB_PDTH_DATE AS VARCHAR(10)) AS LN_ERN_IB_PDTH_DATE,
      *            LNFILE.LN_ERN_IB_PRINBAL,
      *            LNFILE.LN_ERN_IB_INTOWE,
      *            LNFILE.LN_TOTERN,
      *            LNFILE.LN_TOTOTH,
      *            LNFILE.LN_TOTINT,
      *            LNFILE.LN_TOTLCHG,
      *            LNFILE.LN_TOTDEF,
      *            LNFILE.LN_TOTSERACCT,
      *            LNFILE.LN_LCWAIVERS,
      *            LNFILE.LN_INTWAIVERS,
      *            LNFILE.LN_TOTPAYMNTD,
      *            LNFILE.LN_TOTEXCPAYMNTD,
      *            LNFILE.LN_TOTNODEF,
      *            LNFILE.LN_YTDNODEF,
      *            LNFILE.LN_TOTNODEFACT,
      *            LNFILE.LN_YTDNODEFACT,
      *            LNFILE.LN_TOTNOALDEL,
      *            LNFILE.LN_YTDNOALDEL,
      *            LNFILE.LN_YTDINTPD,
      *            LNFILE.LN_LYRINTPD,
      *            LNFILE.LN_TOTINTPD,
      *            LNFILE.LN_RECASTINT,
      *            LNFILE.LN_RECASTPRIN,
      *            LNFILE.LN_CL_REBATE,
      *            LNFILE.LN_AH_REBATE,
      *            LNFILE.LN_PP_REBATE,
      *            LNFILE.LN_INT_REBATE,
      *            LNFILE.LN_SC_REBATE,
      *            LNFILE.LN_MF_REBATE,
      *            LNFILE.LN_DF_REBATE,
      *            LNFILE.LN_EX_REBATE,
      *            LNFILE.LN_O1_REBATE,
      *            LNFILE.LN_O2_REBATE,
      *            LNFILE.LN_O3_REBATE,
      *            LNFILE.LN_O4_REBATE,
      *            LNFILE.LN_O5_REBATE,
      *            LNFILE.LN_O6_REBATE,
      *            LNFILE.LN_O7_REBATE,
      *            LNFILE.LN_UN_O7_REB,
      *            LNFILE.LN_UN_O8_REB,
      *            LNFILE.LN_UN_O9_REB,
      *            LNFILE.LN_UN_O10_REB,
      *            LNFILE.LN_PLREASON,
      *            LNFILE.LN_COLLECTOR,
      *            LNFILE.LN_ACTIONCD,
      *            LNFILE.LN_ACTIONCD2,
      *            LNFILE.LN_ATCODE,
      *            LNFILE.LN_RECODE,
      *            LNFILE.LN_ESCROW_FG,
      *            LNFILE.LN_PROMDAYS_PASTDUE,
      *            LNFILE.LN_PROMID,
      *            CAST(LNFILE.LN_PROMDATE       AS VARCHAR(10)) AS LN_PROMDATE,
      *            LNFILE.LN_PROMAMT,
      *            CAST(LNFILE.LN_PROMDATE2      AS VARCHAR(10)) AS LN_PROMDATE2,
      *            CAST(LNFILE.LN_DATE_PAID_LAST AS VARCHAR(10)) AS LN_DATE_PAID_LAST,
      *            LNFILE.LN_AMT_PAID_LAST,
      *            LNFILE.LN_LASTCFORMNO,
      *            CAST(LNFILE.LN_LASTCFORMDATE AS VARCHAR(10)) AS LN_LASTCFORMDATE,
      *            LNFILE.LN_DELCNT,
      *            LNFILE.LN_DELCNT2,
      *            LNFILE.LN_CREDITLIM,
      *            LNFILE.LN_CRSCORE,
      *            LNFILE.LN_LASTSFORMNO,
      *            CAST(LNFILE.LN_LASTSFORMDATE AS VARCHAR(10)) AS LN_LASTSFORMDATE,
      *            LNFILE.LN_SOLCNT,
      *            LNFILE.LN_MESSAGE,
      *            LNFILE.LN_OLDACCTNO,
      *            LNFILE.LN_PRLNNO,
      *            LNFILE.LN_PRBAL,
      *            LNFILE.LN_PRINTDUE,
      *            LNFILE.LN_PRFINCHGRB,
      *            LNFILE.LN_PRINSRB,
      *            LNFILE.LN_PRPOCD,
      *            CAST(LNFILE.LN_PRPODATE AS VARCHAR(10)) AS LN_PRPODATE,
      *            LNFILE.LN_PRDELINQAMT,
      *            LNFILE.LN_PRLNAMT,
      *            LNFILE.LN_PRPDUE_DAYS,
      *            LNFILE.LN_PRDLDISC_UNEARN,
      *            LNFILE.LN_PRCONPROFILE,
      *            LNFILE.LN_SUM_ORIGPURAMT,
      *            LNFILE.LN_SUM_LNAMT,
      *            LNFILE.LN_SUM_FINCHG,
      *            LNFILE.LN_SUM_INTCHG,
      *            LNFILE.LN_SUM_ORGTERM,
      *            LNFILE.LN_SUM_REGPYAMT,
      *            LNFILE.LN_SUM_EXTCHG,
      *            LNFILE.LN_SUM_SERCHG,
      *            LNFILE.LN_SUM_MAINTFEE,
      *            LNFILE.LN_UNITPER_CD,
      *            LNFILE.LN_UNITPER_FREQ,
      *            LNFILE.LN_DAYS_IN_UNITPER,
      *            LNFILE.LN_UNITPER_PER_YEAR,
      *            LNFILE.LN_REPOCD,
      *            LNFILE.LN_BR_TFR_FG,
      *            LNFILE.LN_O3INS_DLPROC,
      *            LNFILE.LN_INSPREM_DLADJ,
      *            LNFILE.LN_PLAMT,
      *            LNFILE.LN_MTD_PRIN,
      *            LNFILE.LN_MTD_LC,
      *            LNFILE.LN_MTD_INT,
      *            LNFILE.LN_MTD_OT,
      *            LNFILE.LN_MTD_EX,
      *            LNFILE.LN_BNKRPT_CHAPTER,
      *            LNFILE.LN_BMO_CON_STATUS,
      *            LNFILE.LN_BMO_REC_STATUS,
      *            LNFILE.LN_APP_NUMBER,
      *            LNFILE.LN_GIFTNET,
      *            LNFILE.LN_GIFTNET_OUR_PO,
      *            LNFILE.LN_PROC_DISBURSED,
      *            LNFILE.LN_NOODDPY,
      *            LNFILE.LN_CONPROFILE_1,
      *            LNFILE.LN_CONPROFILE_2,
      *            LNFILE.LN_CONPROFILE_3,
      *            LNFILE.LN_CONPROFILE_4,
      *            LNFILE.LN_CONPROFILE_5,
      *            LNFILE.LN_RECPROFILE_1,
      *            LNFILE.LN_RECPROFILE_2,
      *            LNFILE.LN_RECPROFILE_3,
      *            LNFILE.LN_RECPROFILE_4,
      *            LNFILE.LN_RECPROFILE_5,
      *            LNFILE.LN_TRW_STATUS,
      *            LNFILE.LN_ORIGIN,
      *            LNFILE.LN_PO_TRCD,
      *            LNFILE.LN_NEXIS_CRSCORE,
      *            LNFILE.LN_TRW_B_CONSUMER_IND,
      *            LNFILE.LN_PARVHELD_PAID_FG,
      *            LNFILE.LN_ACCT_FROZEN,
      *            LNFILE.LN_TRW_SPECIAL_CODE,
      *            LNFILE.LN_CREATION_STATUS,
      *            LNFILE.LN_TOTNOLCHG,
      *            LNFILE.LN_LBOX,
      *            LNFILE.LN_EXTRA_PRIN_LFP,
      *            LNFILE.LN_REMAIN_INT_SINCE_LFP,
      *            LNFILE.LN_REMAIN_PRIN_SINCE_LFP,
      *            LNFILE.LN_INTERIM_COUPON,
      *            LNFILE.LN_DLCOMM_O3_CMSI,
      *            LNFILE.LN_DLCOMM_PP_CMSI,
      *            LNFILE.LN_TRW_J_CONSUMER_IND,
      *            LNFILE.LN_ACH,
      *            LNFILE.LN_1099_C_FG,
      *            LNFILE.LN_TRW_COMPLIANCE_CODE,
      *            LNFILE.LN_UNWIND_REASON_CODE,
      *            LNFILE.LN_PBI_PBD_FG,
      *            LNFILE.LN_OLD_ACCT_FORMAT_FG,
      *            LNFILE.LN_APPROVED_BY_USER,
      *            LNFILE.LN_APPROVED_BY_CODE,
      *            CAST(LNFILE.LN_APPROVED_BY_DATE AS VARCHAR(10)) AS LN_APPROVED_BY_DATE,
      *            LNFILE.LN_APPROVED_BY_TIME,
      *            CAST(LNFILE.LN_LTOUCH_DATE      AS VARCHAR(10)) AS LN_LTOUCH_DATE,
      *            LNFILE.LN_LTOUCH_TIME,
      *            ISNULL(LSMFILE.LSM_BRNO,0)   AS LSM_BRNO,
      *            ISNULL(LSMFILE.LSM_ACCTNO,0) AS LSM_ACCTNO,
      *            ISNULL(LSMFILE.LSM_SEQNO,0)  AS LSM_SEQNO,
      *            ISNULL(LSMFILE.LSM_MISC_FIELD_5,' ')    AS LSM_MISC_FIELD,
      *            ISNULL(LSMFILE.LSM_TRANS_FROM_BRNO,0)   AS LSM_TRANS_FROM_BRNO,
      *            ISNULL(LSMFILE.LSM_TRANS_FROM_ACCTNO,0) AS LSM_TRANS_FROM_ACCTNO,
      *            ISNULL(CAST(LSMFILE.LSM_TRANS_FROM_DATE AS VARCHAR(10)),'0') AS LSM_TRANS_FROM_DATE,
      *            ISNULL(BWFILE.BW_OWNBR,0)   AS BW_OWNBR,
      *            ISNULL(BWFILE.BW_SSNO,0)    AS BW_SSNO,
      *            ISNULL(BWFILE.BW_LNAME,' ') AS BW_LNAME,
      *            ISNULL(BWFILE.BW_FNAME,' ') AS BW_FNAME,
      *            ISNULL(BWFILE.BW_ADR1,' ')  AS BW_ADR1,
      *            ISNULL(BWFILE.BW_ADR2,' ')  AS BW_ADR2,
      *            ISNULL(BWFILE.BW_CITY,' ')  AS BW_CITY,
      *            ISNULL(BWFILE.BW_STATE,' ') AS BW_STATE,
      *            ISNULL(BWFILE.BW_ZIP,'')    AS BW_ZIP,
      *            ISNULL(CAST(BWFILE.BW_BDATE AS VARCHAR(10)),'0') AS BW_BDATE,
      *            ISNULL(BWFILE.BW_PHONE,0)     AS BW_PHONE ,
      *            ISNULL(BWFILE.BW_RENTCD,'')   AS BW_RENTCD ,
      *            ISNULL(BWFILE.BW_TIMEADDR,'') AS BW_TIMEADDR,
      *            ISNULL(BWFILE.BW_EMPLOYER,'') AS BW_EMPLOYER,
      *            ISNULL(BWFILE.BW_EMPLPOS,'')  AS BW_EMPLPOS,
      *            ISNULL(BWFILE.BW_EMPADDR1,'') AS BW_EMPADDR1,
      *            ISNULL(BWFILE.BW_EMPADDR2,'') AS BW_EMPADDR2,
      *            ISNULL(BWFILE.BW_CONFIDENTIAL,'') AS BW_CONFIDENTIAL
      *  INTO #TEMP_METRO2_LNFILE
      *  FROM DBO.LNFILE LNFILE
      *  LEFT OUTER JOIN DBO.LSMFILE LSMFILE
      *   ON LSMFILE.LSM_BRNO   = LNFILE.LN_OWNBR
      *   AND LSMFILE.LSM_ACCTNO =  LNFILE.LN_ACCTNO 
      *   AND LSMFILE.LSM_SEQNO  = 1
      *  LEFT OUTER JOIN DBO.BWFILE BWFILE
      *   ON BWFILE.BW_OWNBR = LNFILE.LN_OWNBR
      *  AND BWFILE.BW_SSNO = LNFILE.LN_SSNO1
      *  WHERE LNFILE.LN_OWNBR = @QLN3_WBEG_OWNBR
      *   AND LNFILE.LN_CLASS  BETWEEN @QLN3_WBEG_CLASS  AND @QLN3_WEND_CLASS
      *   AND LNFILE.LN_ACCTNO BETWEEN @PASS_WBEG_ACCTNO AND @PASS_WEND_ACCTNO
      *   AND LNFILE.LN_POCD NOT IN ('*I','*R', 'BT')
      *   AND LNFILE.LN_SKIP_TRW != 'Y'
      *   AND (LNFILE.LN_CURBAL != 0 OR LNFILE.LN_POFFDATE != '1900-01-01');
      * SELECT *
      * FROM #TEMP_METRO2_LNFILE
      * ORDER BY LN_CLASS, LN_ACCTNO;

           EXEC SQL
            DECLARE LN3_CURSOR CURSOR FOR
                :LN3-RETURN-CODE = 
                 EXEC SSP_METRO2_LNFILE_SELECT
                  ( :QLN3-WBEG-OWNBR,
                    :QLN3-WBEG-CLASS, :QLN3-WEND-CLASS, 
                    :QLN3-WBEG-ACCTNO,:QLN3-WEND-ACCTNO)
                END-EXEC.
   
           EXEC SQL
               OPEN LN3_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE ZEROES TO QLN3-WBEG-OWNBR
                          QLN3-WBEG-CLASS
                          QLN3-WEND-CLASS
                          QLN3-WBEG-ACCTNO
                          QLN3-WEND-ACCTNO.

           MOVE STAT---GOOD TO LN3-CURSOR-STAT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       READ-LN3-FILE-NEXT.  *> SSP LN LSM BW
           PERFORM READ-IT.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.
           INITIALIZE QLN-REC QLSM-REC QBW-REC.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
              EXEC SQL
                   FETCH LN3_CURSOR INTO 
                   :QLN-OWNBR,
                   :QLN-ACCTNO,
                   :QLN-CLASS,
                   :QLN-SUBCLASS,
                   :QLN-LAWCODE,
                   :QLN-SSNO1,
                   :QLN-MAKERCD1,
                   :QLN-SSNO2,
                   :QLN-MAKERCD2,
                   :QLN-SSNO3,
                   :QLN-MAKERCD3,
                   :QLN-SSNO4,
                   :QLN-MAKERCD4,
                   :QLN-ORGST,
                   :QLN-ORGBR,
                   :QLN-OWNST,
                   :QLN-SPRCLASS,
                   :QLN-CONVERCD,
                   :QLN-MIDSTREAM,
                   :QLN-PURCD,
                   :QLN-SRCD,
                   :QLN-COLLCD,
                   :QLN-COLLID,
                   :QLN-POCD,
                   :QLN-PLCD,
                   :QLN-PLTYPE,
                   :QLN-CONFIDENTCD,
                   :QLN-ALLOTCD,
                   :QLN-RECASTCD,
                   :QLN-SKIP-TRW,
                   :QLN-STATUSFG,
                   :QLN-SMALLOAN,
                   :QLN-SALEFIN,
                   :QLN-SERVACCT,
                   :QLN-LOANTYPE,
                   :QLN-ADDON-FG,
                   :QLN-PAY-SCHLD-FG,
                   :QLN-LC-CODE,
                   :QLN-CAN-LOAN-NO,
                   :QLN-STATFLAGS,
                   :QLN-ENTDATE  ,
                   :QLN-LOANDATE ,
                   :QLN-PURDATE ,
                   :QLN-INTDATE ,
                   :QLN-CASHDATE ,
                   :QLN-FILEDATE ,
                   :QLN-RESCISSION-DATE ,
                   :QLN-PART-RECOURSE-DATE ,
                   :QLN-ORIG-1STPYDATE ,
                   :QLN-1STPYDATE ,
                   :QLN-JDDATE ,
                   :QLN-PLDATE ,
                   :QLN-PL-TRDATE ,
                   :QLN-ACCELDATE ,
                   :QLN-REDUDATE  ,
                   :QLN-POFFDATE  ,
                   :QLN-PO-TRDATE ,
                   :QLN-LEGALDATE ,
                   :QLN-BNKRPTDATE ,
                   :QLN-BNKRPT-DISMISS-DATE ,
                   :QLN-BNKRPT-DISCHARGE-DATE,
                   :QLN-BNKRPT-REAFFIRM-DATE,
                   :QLN-DEBTAIDATE,
                   :QLN-REPODATE,
                   :QLN-REDEEMDATE,
                   :QLN-SOLDDATE,
                   :QLN-INS-CONFIRM-DATE,
                   :QLN-PRIOR-RN-FOR10-DATE,
                   :QLN-LAST-RN-FOR10-DATE,
                   :QLN-TRW-DOFD-DATE,
                   :QLN-LAST-PYPA-DATE,
                   :QLN-BT-TRDATE,
                   :QLN-METRO2-LAST-PMT-DATE,
                   :QLN-FOLLOWUP-DATE,
                   :QLN-LAST-ACCRUAL-DATE,
                   :QLN-APRATE,
                   :QLN-EFFRATE,
                   :QLN-SMPRATE,
                   :QLN-YLDRATE,
                   :QLN-OVRDRATE,
                   :QLN-ENDORATE,
                   :QLN-JDRATE,
                   :QLN-ACCRATE,
                   :QLN-REDURATE,
                   :QLN-CONRATE,
                   :QLN-SERVPER,
                   :QLN-SELLPR,
                   :QLN-DOWNPY,
                   :QLN-TRADEIN,
                   :QLN-LNAMT,
                   :QLN-FINCHG,
                   :QLN-INTCHG,
                   :QLN-SERCHG,
                   :QLN-EXTCHG,
                   :QLN-MAINTFEE,
                   :QLN-POINTS,
                   :QLN-PROCEEDS,
                   :QLN-ORGTERM,
                   :QLN-1STPYAMT,
                   :QLN-NOREGPY,
                   :QLN-REGPYAMT,
                   :QLN-LASTPYAMT,
                   :QLN-PROCASH,
                   :QLN-TILLNO,
                   :QLN-STATE-FLAG,
                   :QLN-STATE-WORKER,
                   :QLN-STATE-WORKER2,
                   :QLN-FEECODE-1,
                   :QLN-FEEAMT-1,
                   :QLN-FEEOURS-1,
                   :QLN-FEEFINCHG-1,
                   :QLN-FEECODE-2,
                   :QLN-FEEAMT-2,
                   :QLN-FEEOURS-2,
                   :QLN-FEEFINCHG-2,
                   :QLN-FEECODE-3,
                   :QLN-FEEAMT-3,
                   :QLN-FEEOURS-3,
                   :QLN-FEEFINCHG-3,
                   :QLN-FEECODE-4,
                   :QLN-FEEAMT-4,
                   :QLN-FEEOURS-4,
                   :QLN-FEEFINCHG-4,
                   :QLN-FEECODE-5,
                   :QLN-FEEAMT-5,
                   :QLN-FEEOURS-5,
                   :QLN-FEEFINCHG-5,
                   :QLN-FEECODE-6,
                   :QLN-FEEAMT-6,
                   :QLN-FEEOURS-6,
                   :QLN-FEEFINCHG-6,
                   :QLN-FEECODE-7,
                   :QLN-FEEAMT-7,
                   :QLN-FEEOURS-7,
                   :QLN-FEEFINCHG-7,
                   :QLN-FEECODE-8,
                   :QLN-FEEAMT-8,
                   :QLN-FEEOURS-8,
                   :QLN-FEEFINCHG-8,
                   :QLN-FEECODE-9,
                   :QLN-FEEAMT-9,
                   :QLN-FEEOURS-9,
                   :QLN-FEEFINCHG-9,
                   :QLN-FEECODE-10,
                   :QLN-FEEAMT-10,
                   :QLN-FEEOURS-10,
                   :QLN-FEEFINCHG-10,
                   :QLN-FEECODE-11,
                   :QLN-FEEAMT-11,
                   :QLN-FEEOURS-11,
                   :QLN-FEEFINCHG-11,
                   :QLN-FEECODE-12,
                   :QLN-FEEAMT-12,
                   :QLN-FEEOURS-12,
                   :QLN-FEEFINCHG-12,
                   :QLN-FEECODE-13,
                   :QLN-FEEAMT-13,
                   :QLN-FEEOURS-13,
                   :QLN-FEEFINCHG-13,
                   :QLN-FEECODE-14,
                   :QLN-FEEAMT-14,
                   :QLN-FEEOURS-14,
                   :QLN-FEEFINCHG-14,
                   :QLN-FEECODE-15,
                   :QLN-FEEAMT-15,
                   :QLN-FEEOURS-15,
                   :QLN-FEEFINCHG-15,
                   :QLN-FEECODE-16,
                   :QLN-FEEAMT-16,
                   :QLN-FEEOURS-16,
                   :QLN-FEEFINCHG-16,
                   :QLN-FEECODE-17,
                   :QLN-FEEAMT-17,
                   :QLN-FEEOURS-17,
                   :QLN-FEEFINCHG-17,
                   :QLN-FEECODE-18,
                   :QLN-FEEAMT-18,
                   :QLN-FEEOURS-18,
                   :QLN-FEEFINCHG-18,
                   :QLN-FEECODE-19,
                   :QLN-FEEAMT-19,
                   :QLN-FEEOURS-19,
                   :QLN-FEEFINCHG-19,
                   :QLN-FEECODE-20,
                   :QLN-FEEAMT-20,
                   :QLN-FEEOURS-20,
                   :QLN-FEEFINCHG-20,
                   :QLN-INSURED,
                   :QLN-INSTYPES,
                   :QLN-INSELIGIBLE,
                   :QLN-INSCOMP-1,
                   :QLN-INSOURS-1,
                   :QLN-INSEFF-DATE-1 ,
                   :QLN-INSEXP-DATE-1 ,
                   :QLN-INSPREM-1,
                   :QLN-INSCOVR-1,
                   :QLN-INSCOMM-1,
                   :QLN-INSANTICERN-1,
                   :QLN-INSANTICADJ-1,
                   :QLN-INSUFERN-1,
                   :QLN-INSACCERN-1,
                   :QLN-INSEARN-ORDER-1,
                   :QLN-INSFINCHG-1,
                   :QLN-INSCOMP-2,
                   :QLN-INSOURS-2,
                   :QLN-INSEFF-DATE-2 ,
                   :QLN-INSEXP-DATE-2 ,
                   :QLN-INSPREM-2,
                   :QLN-INSCOVR-2,
                   :QLN-INSCOMM-2,
                   :QLN-INSANTICERN-2,
                   :QLN-INSANTICADJ-2,
                   :QLN-INSUFERN-2,
                   :QLN-INSACCERN-2,
                   :QLN-INSEARN-ORDER-2,
                   :QLN-INSFINCHG-2,
                   :QLN-INSCOMP-3,
                   :QLN-INSOURS-3,
                   :QLN-INSEFF-DATE-3 ,
                   :QLN-INSEXP-DATE-3 ,
                   :QLN-INSPREM-3,
                   :QLN-INSCOVR-3,
                   :QLN-INSCOMM-3,
                   :QLN-INSANTICERN-3,
                   :QLN-INSANTICADJ-3,
                   :QLN-INSUFERN-3,
                   :QLN-INSACCERN-3,
                   :QLN-INSEARN-ORDER-3,
                   :QLN-INSFINCHG-3,
                   :QLN-INSCOMP-4,
                   :QLN-INSOURS-4,
                   :QLN-INSEFF-DATE-4 ,
                   :QLN-INSEXP-DATE-4 ,
                   :QLN-INSPREM-4,
                   :QLN-INSCOVR-4,
                   :QLN-INSCOMM-4,
                   :QLN-INSANTICERN-4,
                   :QLN-INSANTICADJ-4,
                   :QLN-INSUFERN-4,
                   :QLN-INSACCERN-4,
                   :QLN-INSEARN-ORDER-4,
                   :QLN-INSFINCHG-4,
                   :QLN-INSCOMP-5,
                   :QLN-INSOURS-5,
                   :QLN-INSEFF-DATE-5 ,
                   :QLN-INSEXP-DATE-5 ,
                   :QLN-INSPREM-5,
                   :QLN-INSCOVR-5,
                   :QLN-INSCOMM-5,
                   :QLN-INSANTICERN-5,
                   :QLN-INSANTICADJ-5,
                   :QLN-INSUFERN-5,
                   :QLN-INSACCERN-5,
                   :QLN-INSEARN-ORDER-5,
                   :QLN-INSFINCHG-5,
                   :QLN-INSCOMP-6,
                   :QLN-INSOURS-6,
                   :QLN-INSEFF-DATE-6 ,
                   :QLN-INSEXP-DATE-6 ,
                   :QLN-INSPREM-6,
                   :QLN-INSCOVR-6,
                   :QLN-INSCOMM-6,
                   :QLN-INSANTICERN-6,
                   :QLN-INSANTICADJ-6,
                   :QLN-INSUFERN-6,
                   :QLN-INSACCERN-6,
                   :QLN-INSEARN-ORDER-6,
                   :QLN-INSFINCHG-6,
                   :QLN-INSCOMP-7,
                   :QLN-INSOURS-7,
                   :QLN-INSEFF-DATE-7 ,
                   :QLN-INSEXP-DATE-7 ,
                   :QLN-INSPREM-7,
                   :QLN-INSCOVR-7,
                   :QLN-INSCOMM-7,
                   :QLN-INSANTICERN-7,
                   :QLN-INSANTICADJ-7,
                   :QLN-INSUFERN-7,
                   :QLN-INSACCERN-7,
                   :QLN-INSEARN-ORDER-7,
                   :QLN-INSFINCHG-7,
                   :QLN-INSCOMP-8,
                   :QLN-INSOURS-8,
                   :QLN-INSEFF-DATE-8 ,
                   :QLN-INSEXP-DATE-8 ,
                   :QLN-INSPREM-8,
                   :QLN-INSCOVR-8,
                   :QLN-INSCOMM-8,
                   :QLN-INSANTICERN-8,
                   :QLN-INSANTICADJ-8,
                   :QLN-INSUFERN-8,
                   :QLN-INSACCERN-8,
                   :QLN-INSEARN-ORDER-8,
                   :QLN-INSFINCHG-8,
                   :QLN-INSCOMP-9,
                   :QLN-INSOURS-9,
                   :QLN-INSEFF-DATE-9 ,
                   :QLN-INSEXP-DATE-9 ,
                   :QLN-INSPREM-9,
                   :QLN-INSCOVR-9,
                   :QLN-INSCOMM-9,
                   :QLN-INSANTICERN-9,
                   :QLN-INSANTICADJ-9,
                   :QLN-INSUFERN-9,
                   :QLN-INSACCERN-9,
                   :QLN-INSEARN-ORDER-9,
                   :QLN-INSFINCHG-9,
                   :QLN-INSCOMP-10,
                   :QLN-INSOURS-10,
                   :QLN-INSEFF-DATE-10 ,
                   :QLN-INSEXP-DATE-10 ,
                   :QLN-INSPREM-10,
                   :QLN-INSCOVR-10,
                   :QLN-INSCOMM-10,
                   :QLN-INSANTICERN-10,
                   :QLN-INSANTICADJ-10,
                   :QLN-INSUFERN-10,
                   :QLN-INSACCERN-10,
                   :QLN-INSEARN-ORDER-10,
                   :QLN-INSFINCHG-10,
                   :QLN-PY-YYYYMM-RECDEL,
                   :QLN-MTD-PAYS-RECDEL,
                   :QLN-GARNISH-EXTR,
                   :QLN-SHIP-SAME-FG,
                   :QLN-AD-D-INS-COVR,
                   :QLN-TOT-PARTIAL-CHGOFF,
                   :QLN-LPO,
                   :QLN-REP-CD,
                   :QLN-EMP-ID,
                   :QLN-PROCESS-CD,
                   :QLN-WCBC-CREDITLIM,
                   :QLN-FOLLOWUP-CD,
                   :QLN-MIP-FG,
                   :QLN-MIP-MTD-CLAHPAID,
                   :QLN-MIP-CLPDTH-DATE ,
                   :QLN-MIP-TOT-CLPAID,
                   :QLN-MIP-AHPDTH-DATE ,
                   :QLN-MIP-TOT-AHPAID,
                   :QLN-IL-GROSS-INCOME,
                   :QLN-IL-GROSS-INCOME2,
                   :QLN-RESCISSION,
                   :QLN-INTERIM-TRW,
                   :QLN-DLNO,
                   :QLN-DLPOOL,
                   :QLN-DLRECOURSE,
                   :QLN-DLPARTRCAMT,
                   :QLN-ORIGPURAMT,
                   :QLN-PURBAL,
                   :QLN-DLRVPRIN-1,
                   :QLN-DLRVPRIN-2,
                   :QLN-DLRVPRIN-3,
                   :QLN-DLRVCHGS-1,
                   :QLN-DLRVCHGS-2,
                   :QLN-DLRVCHGS-3,
                   :QLN-DLPARVHELD,
                   :QLN-DLPARVPAID,
                   :QLN-DLDISC,
                   :QLN-LCPDTH-DATE  ,
                   :QLN-INTPDTH-DATE ,
                   :QLN-CURBAL,
                   :QLN-INTBAL,
                   :QLN-LCBAL,
                   :QLN-OTHBAL,
                   :QLN-OT2BAL,
                   :QLN-LCPAID,
                   :QLN-LCPARTIALS,
                   :QLN-STMT-COUNTER,
                   :QLN-PRIOR-STMT-COUNTER,
                   :QLN-FROZEN-REASON,
                   :QLN-COUPON-STATEMENT,
                   :QLN-MONTHEND-BAL,
                   :QLN-ANTICTERM,
                   :QLN-ANTICERN-1,
                   :QLN-ANTICADJ-1,
                   :QLN-UFERN-1,
                   :QLN-ACCERN-1,
                   :QLN-EARN-ORDER-1,
                   :QLN-ANTICERN-2,
                   :QLN-ANTICADJ-2,
                   :QLN-UFERN-2,
                   :QLN-ACCERN-2,
                   :QLN-EARN-ORDER-2,
                   :QLN-ANTICERN-3,
                   :QLN-ANTICADJ-3,
                   :QLN-UFERN-3,
                   :QLN-ACCERN-3,
                   :QLN-EARN-ORDER-3,
                   :QLN-ANTICERN-4,
                   :QLN-ANTICADJ-4,
                   :QLN-UFERN-4,
                   :QLN-ACCERN-4,
                   :QLN-EARN-ORDER-4,
                   :QLN-ANTICERN-5,
                   :QLN-ANTICADJ-5,
                   :QLN-UFERN-5,
                   :QLN-ACCERN-5,
                   :QLN-EARN-ORDER-5,
                   :QLN-ANTICERN-6,
                   :QLN-ANTICADJ-6,
                   :QLN-UFERN-6,
                   :QLN-ACCERN-6,
                   :QLN-EARN-ORDER-6,
                   :QLN-ANTICERN-7,
                   :QLN-ANTICADJ-7,
                   :QLN-UFERN-7,
                   :QLN-ACCERN-7,
                   :QLN-EARN-ORDER-7,
                   :QLN-ANTICERN-8,
                   :QLN-ANTICADJ-8,
                   :QLN-UFERN-8,
                   :QLN-ACCERN-8,
                   :QLN-EARN-ORDER-8,
                   :QLN-ANTICERN-9,
                   :QLN-ANTICADJ-9,
                   :QLN-UFERN-9,
                   :QLN-ACCERN-9,
                   :QLN-EARN-ORDER-9,
                   :QLN-ANTICERN-10,
                   :QLN-ANTICADJ-10,
                   :QLN-UFERN-10,
                   :QLN-ACCERN-10,
                   :QLN-EARN-ORDER-10,
                   :QLN-LMO-PRIOR-INTEREST,
                   :QLN-PRIOR-UNEARNED,
                   :QLN-ERNDELQ-STOP,
                   :QLN-NONACRERN,
                   :QLN-PRIOR-NONACRERN,
                   :QLN-ERN-IB-PDTH-DATE ,
                   :QLN-ERN-IB-PRINBAL,
                   :QLN-ERN-IB-INTOWE,
                   :QLN-TOTERN,
                   :QLN-TOTOTH,
                   :QLN-TOTINT,
                   :QLN-TOTLCHG,
                   :QLN-TOTDEF,
                   :QLN-TOTSERACCT,
                   :QLN-LCWAIVERS,
                   :QLN-INTWAIVERS,
                   :QLN-TOTPAYMNTD,
                   :QLN-TOTEXCPAYMNTD,
                   :QLN-TOTNODEF,
                   :QLN-YTDNODEF,
                   :QLN-TOTNODEFACT,
                   :QLN-YTDNODEFACT,
                   :QLN-TOTNOALDEL,
                   :QLN-YTDNOALDEL,
                   :QLN-YTDINTPD,
                   :QLN-LYRINTPD,
                   :QLN-TOTINTPD,
                   :QLN-RECASTINT,
                   :QLN-RECASTPRIN,
                   :QLN-CL-REBATE,
                   :QLN-AH-REBATE,
                   :QLN-PP-REBATE,
                   :QLN-INT-REBATE,
                   :QLN-SC-REBATE,
                   :QLN-MF-REBATE,
                   :QLN-DF-REBATE,
                   :QLN-EX-REBATE,
                   :QLN-O1-REBATE,
                   :QLN-O2-REBATE,
                   :QLN-O3-REBATE,
                   :QLN-O4-REBATE,
                   :QLN-O5-REBATE,
                   :QLN-O6-REBATE,
                   :QLN-O7-REBATE,
                   :QLN-UN-O7-REB,
                   :QLN-UN-O8-REB,
                   :QLN-UN-O9-REB,
                   :QLN-UN-O10-REB,
                   :QLN-PLREASON,
                   :QLN-COLLECTOR,
                   :QLN-ACTIONCD,
                   :QLN-ACTIONCD2,
                   :QLN-ATCODE,
                   :QLN-RECODE,
                   :QLN-ESCROW-FG,
                   :QLN-PROMDAYS-PASTDUE,
                   :QLN-PROMID,
                   :QLN-PROMDATE ,
                   :QLN-PROMAMT,
                   :QLN-PROMDATE2 ,
                   :QLN-DATE-PAID-LAST ,
                   :QLN-AMT-PAID-LAST,
                   :QLN-LASTCFORMNO,
                   :QLN-LASTCFORMDATE ,
                   :QLN-DELCNT,
                   :QLN-DELCNT2,
                   :QLN-CREDITLIM,
                   :QLN-CRSCORE,
                   :QLN-LASTSFORMNO,
                   :QLN-LASTSFORMDATE ,
                   :QLN-SOLCNT,
                   :QLN-MESSAGE,
                   :QLN-OLDACCTNO,
                   :QLN-PRLNNO,
                   :QLN-PRBAL,
                   :QLN-PRINTDUE,
                   :QLN-PRFINCHGRB,
                   :QLN-PRINSRB,
                   :QLN-PRPOCD,
                   :QLN-PRPODATE ,
                   :QLN-PRDELINQAMT,
                   :QLN-PRLNAMT,
                   :QLN-PRPDUE-DAYS,
                   :QLN-PRDLDISC-UNEARN,
                   :QLN-PRCONPROFILE,
                   :QLN-SUM-ORIGPURAMT,
                   :QLN-SUM-LNAMT,
                   :QLN-SUM-FINCHG,
                   :QLN-SUM-INTCHG,
                   :QLN-SUM-ORGTERM,
                   :QLN-SUM-REGPYAMT,
                   :QLN-SUM-EXTCHG,
                   :QLN-SUM-SERCHG,
                   :QLN-SUM-MAINTFEE,
                   :QLN-UNITPER-CD,
                   :QLN-UNITPER-FREQ,
                   :QLN-DAYS-IN-UNITPER,
                   :QLN-UNITPER-PER-YEAR,
                   :QLN-REPOCD,
                   :QLN-BR-TFR-FG,
                   :QLN-O3INS-DLPROC,
                   :QLN-INSPREM-DLADJ,
                   :QLN-PLAMT,
                   :QLN-MTD-PRIN,
                   :QLN-MTD-LC,
                   :QLN-MTD-INT,
                   :QLN-MTD-OT,
                   :QLN-MTD-EX,
                   :QLN-BNKRPT-CHAPTER,
                   :QLN-BMO-CON-STATUS,
                   :QLN-BMO-REC-STATUS,
                   :QLN-APP-NUMBER,
                   :QLN-GIFTNET,
                   :QLN-GIFTNET-OUR-PO,
                   :QLN-PROC-DISBURSED,
                   :QLN-NOODDPY,
                   :QLN-CONPROFILE-1,
                   :QLN-CONPROFILE-2,
                   :QLN-CONPROFILE-3,
                   :QLN-CONPROFILE-4,
                   :QLN-CONPROFILE-5,
                   :QLN-RECPROFILE-1,
                   :QLN-RECPROFILE-2,
                   :QLN-RECPROFILE-3,
                   :QLN-RECPROFILE-4,
                   :QLN-RECPROFILE-5,
                   :QLN-TRW-STATUS,
                   :QLN-ORIGIN,
                   :QLN-PO-TRCD,
                   :QLN-NEXIS-CRSCORE,
                   :QLN-TRW-B-CONSUMER-IND,
                   :QLN-PARVHELD-PAID-FG,
                   :QLN-ACCT-FROZEN,
                   :QLN-TRW-SPECIAL-CODE,
                   :QLN-CREATION-STATUS,
                   :QLN-TOTNOLCHG,
                   :QLN-LBOX,
                   :QLN-EXTRA-PRIN-LFP,
                   :QLN-REMAIN-INT-SINCE-LFP,
                   :QLN-REMAIN-PRIN-SINCE-LFP,
                   :QLN-INTERIM-COUPON,
                   :QLN-DLCOMM-O3-CMSI,
                   :QLN-DLCOMM-PP-CMSI,
                   :QLN-TRW-J-CONSUMER-IND,
                   :QLN-ACH,
                   :QLN-1099-C-FG,
                   :QLN-TRW-COMPLIANCE-CODE,
                   :QLN-UNWIND-REASON-CODE,
                   :QLN-PBI-PBD-FG,
                   :QLN-OLD-ACCT-FORMAT-FG,
                   :QLN-APPROVED-BY-USER,
                   :QLN-APPROVED-BY-CODE,
                   :QLN-APPROVED-BY-DATE ,
                   :QLN-APPROVED-BY-TIME,
                   :QLN-LTOUCH-DATE ,
                   :QLN-LTOUCH-TIME,
                   :QLSM-BRNO,
                   :QLSM-ACCTNO,
                   :QLSM-SEQNO,
                   :QLSM-MISC-FIELD-5, 
                   :QLSM-TRANS-FROM-BRNO,
                   :QLSM-TRANS-FROM-ACCTNO,
                   :QLSM-TRANS-FROM-DATE,
                   :QBW-OWNBR,
                   :QBW-SSNO,
                   :QBW-LNAME,
                   :QBW-FNAME,
                   :QBW-ADR1,
                   :QBW-ADR2,
                   :QBW-CITY,
                   :QBW-STATE,
                   :QBW-ZIP,
                   :QBW-BDATE,
                   :QBW-PHONE,
                   :QBW-RENTCD,
                   :QBW-TIMEADDR,
                   :QBW-EMPLOYER,
                   :QBW-EMPLPOS,
                   :QBW-EMPADDR1,
                   :QBW-EMPADDR2,
                   :QBW-CONFIDENTIAL 
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           IF ( IO-FG = 8 )     *>LOCKED
              GO TO READ-LN3-FILE-NEXT.

           IF ( IO-FG = 0 )
              PERFORM GET-LN-FIELDS
              PERFORM GET-LSM-FIELDS
              PERFORM GET-BW-FIELDS.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       REWRITE-LN3-FILE.
           MOVE LN-PATH-OWNBR  TO LN-OWNBR.
           ACCEPT LN-LTOUCH-DATE FROM CENTURY-DATE.
           PERFORM REWRITE-IT.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           STRING LN-OWNBR, LN-CLASS,LN-ACCTNO
              DELIMITED BY " " INTO E-KEYX.

           PERFORM SET-LN-FIELDS.

           MOVE '2' TO SQL-UPDATE-CONN-USE-SW.    *> CHANGE CONNECTION TO UPDATE_CONNECT
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           EXEC SQL
            UPDATE DBO.LNFILE
             SET LNFILE.LN_CLASS = :QLN-CLASS,
              LNFILE.LN_SUBCLASS = :QLN-SUBCLASS,
              LNFILE.LN_LAWCODE  = :QLN-LAWCODE,
              LNFILE.LN_SSNO1    = :QLN-SSNO1,
              LNFILE.LN_MAKERCD1 = :QLN-MAKERCD1,
              LNFILE.LN_SSNO2    = :QLN-SSNO2,
              LNFILE.LN_MAKERCD2 = :QLN-MAKERCD2,
              LNFILE.LN_SSNO3    = :QLN-SSNO3,
              LNFILE.LN_MAKERCD3 = :QLN-MAKERCD3,
              LNFILE.LN_SSNO4    = :QLN-SSNO4,
              LNFILE.LN_MAKERCD4 = :QLN-MAKERCD4,
              LNFILE.LN_ORGST    = :QLN-ORGST,
              LNFILE.LN_ORGBR    = :QLN-ORGBR,
              LNFILE.LN_OWNST    = :QLN-OWNST,
              LNFILE.LN_SPRCLASS = :QLN-SPRCLASS,
              LNFILE.LN_CONVERCD = :QLN-CONVERCD,
              LNFILE.LN_MIDSTREAM   = :QLN-MIDSTREAM,
              LNFILE.LN_PURCD       = :QLN-PURCD,
              LNFILE.LN_SRCD        =  QLN-SRCD,
              LNFILE.LN_COLLCD      = :QLN-COLLCD,
              LNFILE.LN_COLLID      = :QLN-COLLID,
              LNFILE.LN_POCD        = :QLN-POCD,
              LNFILE.LN_PLCD        = :QLN-PLCD,
              LNFILE.LN_PLTYPE      = :QLN-PLTYPE,
              LNFILE.LN_CONFIDENTCD = :QLN-CONFIDENTCD,
              LNFILE.LN_ALLOTCD     = :QLN-ALLOTCD,
              LNFILE.LN_RECASTCD    = :QLN-RECASTCD,
              LNFILE.LN_SKIP_TRW    = :QLN-SKIP-TRW,
              LNFILE.LN_STATUSFG    = :QLN-STATUSFG,
              LNFILE.LN_SMALLOAN    = :QLN-SMALLOAN,
              LNFILE.LN_SALEFIN     = :QLN-SALEFIN,
              LNFILE.LN_SERVACCT    = :QLN-SERVACCT,
              LNFILE.LN_LOANTYPE    = :QLN-LOANTYPE,
              LNFILE.LN_ADDON_FG    = :QLN-ADDON-FG,
              LNFILE.LN_PAY_SCHLD_FG = :QLN-PAY-SCHLD-FG,
              LNFILE.LN_LC_CODE     = :QLN-LC-CODE,
              LNFILE.LN_CAN_LOAN_NO = :QLN-CAN-LOAN-NO,
              LNFILE.LN_STATFLAGS   = :QLN-STATFLAGS,
              LNFILE.LN_ENTDATE     = :QLN-ENTDATE,
              LNFILE.LN_LOANDATE    = :QLN-LOANDATE,
              LNFILE.LN_PURDATE     = :QLN-PURDATE,
              LNFILE.LN_INTDATE     = :QLN-INTDATE,
              LNFILE.LN_CASHDATE    = :QLN-CASHDATE,
              LNFILE.LN_FILEDATE    = :QLN-FILEDATE,
              LNFILE.LN_RESCISSION_DATE    = :QLN-RESCISSION-DATE,
              LNFILE.LN_PART_RECOURSE_DATE = :QLN-PART-RECOURSE-DATE,
              LNFILE.LN_ORIG_1STPYDATE     = :QLN-ORIG-1STPYDATE,
              LNFILE.LN_1STPYDATE = :QLN-1STPYDATE,
              LNFILE.LN_JDDATE    = :QLN-JDDATE,
              LNFILE.LN_PLDATE    = :QLN-PLDATE,
              LNFILE.LN_PL_TRDATE = :QLN-PL-TRDATE,
              LNFILE.LN_ACCELDATE = :QLN-ACCELDATE,
              LNFILE.LN_REDUDATE  = :QLN-REDUDATE,
              LNFILE.LN_POFFDATE  = :QLN-POFFDATE,
              LNFILE.LN_PO_TRDATE = :QLN-PO-TRDATE,
              LNFILE.LN_LEGALDATE = :QLN-LEGALDATE,
              LNFILE.LN_BNKRPTDATE = :QLN-BNKRPTDATE,
              LNFILE.LN_BNKRPT_DISMISS_DATE   = 
                        :QLN-BNKRPT-DISMISS-DATE,
              LNFILE.LN_BNKRPT_DISCHARGE_DATE = 
                        :QLN-BNKRPT-DISCHARGE-DATE,
              LNFILE.LN_BNKRPT_REAFFIRM_DATE  = 
                       :QLN-BNKRPT-REAFFIRM-DATE,
              LNFILE.LN_DEBTAIDATE = :QLN-DEBTAIDATE,
              LNFILE.LN_REPODATE   = :QLN-REPODATE,
              LNFILE.LN_REDEEMDATE = :QLN-REDEEMDATE,
              LNFILE.LN_SOLDDATE   = :QLN-SOLDDATE,
              LNFILE.LN_INS_CONFIRM_DATE =
                 :QLN-INS-CONFIRM-DATE,
              LNFILE.LN_PRIOR_RN_FOR10_DATE =
                 :QLN-PRIOR-RN-FOR10-DATE,
              LNFILE.LN_LAST_RN_FOR10_DATE =
                 :QLN-LAST-RN-FOR10-DATE,
              LNFILE.LN_TRW_DOFD_DATE =
                 :QLN-TRW-DOFD-DATE,
              LNFILE.LN_LAST_PYPA_DATE =
                 :QLN-LAST-PYPA-DATE,
              LNFILE.LN_BT_TRDATE =
                 :QLN-BT-TRDATE,
              LNFILE.LN_METRO2_LAST_PMT_DATE =
                 :QLN-METRO2-LAST-PMT-DATE,
              LNFILE.LN_FOLLOWUP_DATE =
                 :QLN-FOLLOWUP-DATE,
              LNFILE.LN_LAST_ACCRUAL_DATE =
                 :QLN-LAST-ACCRUAL-DATE,
              LNFILE.LN_APRATE   = :QLN-APRATE,
              LNFILE.LN_EFFRATE  = :QLN-EFFRATE,
              LNFILE.LN_SMPRATE  = :QLN-SMPRATE,
              LNFILE.LN_YLDRATE  = :QLN-YLDRATE,
              LNFILE.LN_OVRDRATE = :QLN-OVRDRATE,
              LNFILE.LN_ENDORATE = :QLN-ENDORATE,
              LNFILE.LN_JDRATE   = :QLN-JDRATE,
              LNFILE.LN_ACCRATE  = :QLN-ACCRATE,
              LNFILE.LN_REDURATE = :QLN-REDURATE,
              LNFILE.LN_CONRATE  = :QLN-CONRATE,
              LNFILE.LN_SERVPER  = :QLN-SERVPER,
              LNFILE.LN_SELLPR   = :QLN-SELLPR,
              LNFILE.LN_DOWNPY   = :QLN-DOWNPY,
              LNFILE.LN_TRADEIN  = :QLN-TRADEIN,
              LNFILE.LN_LNAMT    = :QLN-LNAMT,
              LNFILE.LN_FINCHG   = :QLN-FINCHG,
              LNFILE.LN_INTCHG   = :QLN-INTCHG,
              LNFILE.LN_SERCHG   = :QLN-SERCHG,
              LNFILE.LN_EXTCHG   = :QLN-EXTCHG,
              LNFILE.LN_MAINTFEE = :QLN-MAINTFEE,
              LNFILE.LN_POINTS   = :QLN-POINTS,
              LNFILE.LN_PROCEEDS = :QLN-PROCEEDS,
              LNFILE.LN_ORGTERM  = :QLN-ORGTERM,
              LNFILE.LN_1STPYAMT = :QLN-1STPYAMT,
              LNFILE.LN_NOREGPY  = :QLN-NOREGPY,
              LNFILE.LN_REGPYAMT = :QLN-REGPYAMT,
              LNFILE.LN_LASTPYAMT  = :QLN-LASTPYAMT,
              LNFILE.LN_PROCASH    = :QLN-PROCASH,
              LNFILE.LN_TILLNO     = :QLN-TILLNO,
              LNFILE.LN_STATE_FLAG = :QLN-STATE-FLAG,
              LNFILE.LN_STATE_WORKER  = :QLN-STATE-WORKER,
              LNFILE.LN_STATE_WORKER2 = :QLN-STATE-WORKER2,
              LNFILE.LN_FEECODE_1     = :QLN-FEECODE-1,
              LNFILE.LN_FEEAMT_1      = :QLN-FEEAMT-1,
              LNFILE.LN_FEEOURS_1     = :QLN-FEEOURS-1,
              LNFILE.LN_FEEFINCHG_1   = :QLN-FEEFINCHG-1,
              LNFILE.LN_FEECODE_2     = :QLN-FEECODE-2,
              LNFILE.LN_FEEAMT_2      = :QLN-FEEAMT-2,
              LNFILE.LN_FEEOURS_2     = :QLN-FEEOURS-2,
              LNFILE.LN_FEEFINCHG_2   = :QLN-FEEFINCHG-2,
              LNFILE.LN_FEECODE_3     = :QLN-FEECODE-3,
              LNFILE.LN_FEEAMT_3      = :QLN-FEEAMT-3,
              LNFILE.LN_FEEOURS_3     = :QLN-FEEOURS-3,
              LNFILE.LN_FEEFINCHG_3   = :QLN-FEEFINCHG-3,
              LNFILE.LN_FEECODE_4     = :QLN-FEECODE-4,
              LNFILE.LN_FEEAMT_4      = :QLN-FEEAMT-4,
              LNFILE.LN_FEEOURS_4     = :QLN-FEEOURS-4,
              LNFILE.LN_FEEFINCHG_4   = :QLN-FEEFINCHG-4,
              LNFILE.LN_FEECODE_5     = :QLN-FEECODE-5,
              LNFILE.LN_FEEAMT_5      = :QLN-FEEAMT-5,
              LNFILE.LN_FEEOURS_5     = :QLN-FEEOURS-5,
              LNFILE.LN_FEEFINCHG_5   = :QLN-FEEFINCHG-5,
              LNFILE.LN_FEECODE_6     = :QLN-FEECODE-6,
              LNFILE.LN_FEEAMT_6      = :QLN-FEEAMT-6,
              LNFILE.LN_FEEOURS_6     = :QLN-FEEOURS-6,
              LNFILE.LN_FEEFINCHG_6   = :QLN-FEEFINCHG-6,
              LNFILE.LN_FEECODE_7     = :QLN-FEECODE-7,
              LNFILE.LN_FEEAMT_7      = :QLN-FEEAMT-7,
              LNFILE.LN_FEEOURS_7     = :QLN-FEEOURS-7,
              LNFILE.LN_FEEFINCHG_7   = :QLN-FEEFINCHG-7,
              LNFILE.LN_FEECODE_8     = :QLN-FEECODE-8,
              LNFILE.LN_FEEAMT_8      = :QLN-FEEAMT-8,
              LNFILE.LN_FEEOURS_8     = :QLN-FEEOURS-8,
              LNFILE.LN_FEEFINCHG_8   = :QLN-FEEFINCHG-8,
              LNFILE.LN_FEECODE_9     = :QLN-FEECODE-9,
              LNFILE.LN_FEEAMT_9      = :QLN-FEEAMT-9,
              LNFILE.LN_FEEOURS_9     = :QLN-FEEOURS-9,
              LNFILE.LN_FEEFINCHG_9   = :QLN-FEEFINCHG-9,
              LNFILE.LN_FEECODE_10    = :QLN-FEECODE-10,
              LNFILE.LN_FEEAMT_10     = :QLN-FEEAMT-10,
              LNFILE.LN_FEEOURS_10    = :QLN-FEEOURS-10,
              LNFILE.LN_FEEFINCHG_10  = :QLN-FEEFINCHG-10,
              LNFILE.LN_FEECODE_11    = :QLN-FEECODE-11,
              LNFILE.LN_FEEAMT_11     = :QLN-FEEAMT-11,
              LNFILE.LN_FEEOURS_11    = :QLN-FEEOURS-11,
              LNFILE.LN_FEEFINCHG_11  = :QLN-FEEFINCHG-11,
              LNFILE.LN_FEECODE_12    = :QLN-FEECODE-12,
              LNFILE.LN_FEEAMT_12     = :QLN-FEEAMT-12,
              LNFILE.LN_FEEOURS_12    = :QLN-FEEOURS-12,
              LNFILE.LN_FEEFINCHG_12  = :QLN-FEEFINCHG-12,
              LNFILE.LN_FEECODE_13    = :QLN-FEECODE-13,
              LNFILE.LN_FEEAMT_13     = :QLN-FEEAMT-13,
              LNFILE.LN_FEEOURS_13    = :QLN-FEEOURS-13,
              LNFILE.LN_FEEFINCHG_13  = :QLN-FEEFINCHG-13,
              LNFILE.LN_FEECODE_14    = :QLN-FEECODE-14,
              LNFILE.LN_FEEAMT_14     = :QLN-FEEAMT-14,
              LNFILE.LN_FEEOURS_14    = :QLN-FEEOURS-14,
              LNFILE.LN_FEEFINCHG_14  = :QLN-FEEFINCHG-14,
              LNFILE.LN_FEECODE_15    = :QLN-FEECODE-15,
              LNFILE.LN_FEEAMT_15     = :QLN-FEEAMT-15,
              LNFILE.LN_FEEOURS_15    = :QLN-FEEOURS-15,
              LNFILE.LN_FEEFINCHG_15  = :QLN-FEEFINCHG-15,
              LNFILE.LN_FEECODE_16    = :QLN-FEECODE-16,
              LNFILE.LN_FEEAMT_16     = :QLN-FEEAMT-16,
              LNFILE.LN_FEEOURS_16    = :QLN-FEEOURS-16,
              LNFILE.LN_FEEFINCHG_16  = :QLN-FEEFINCHG-16,
              LNFILE.LN_FEECODE_17    = :QLN-FEECODE-17,
              LNFILE.LN_FEEAMT_17     = :QLN-FEEAMT-17,
              LNFILE.LN_FEEOURS_17    = :QLN-FEEOURS-17,
              LNFILE.LN_FEEFINCHG_17  = :QLN-FEEFINCHG-17,
              LNFILE.LN_FEECODE_18    = :QLN-FEECODE-18,
              LNFILE.LN_FEEAMT_18     = :QLN-FEEAMT-18,
              LNFILE.LN_FEEOURS_18    = :QLN-FEEOURS-18,
              LNFILE.LN_FEEFINCHG_18  = :QLN-FEEFINCHG-18,
              LNFILE.LN_FEECODE_19    = :QLN-FEECODE-19,
              LNFILE.LN_FEEAMT_19     = :QLN-FEEAMT-19,
              LNFILE.LN_FEEOURS_19    = :QLN-FEEOURS-19,
              LNFILE.LN_FEEFINCHG_19  = :QLN-FEEFINCHG-19,
              LNFILE.LN_FEECODE_20    = :QLN-FEECODE-20,
              LNFILE.LN_FEEAMT_20     = :QLN-FEEAMT-20,
              LNFILE.LN_FEEOURS_20    = :QLN-FEEOURS-20,
              LNFILE.LN_FEEFINCHG_20  = :QLN-FEEFINCHG-20,
              LNFILE.LN_INSURED       = :QLN-INSURED,
              LNFILE.LN_INSTYPES      = :QLN-INSTYPES,
              LNFILE.LN_INSELIGIBLE   = :QLN-INSELIGIBLE,
              LNFILE.LN_INSCOMP_1     = :QLN-INSCOMP-1,
              LNFILE.LN_INSOURS_1     = :QLN-INSOURS-1,
              LNFILE.LN_INSEFF_DATE_1 = :QLN-INSEFF-DATE-1,
              LNFILE.LN_INSEXP_DATE_1 = :QLN-INSEXP-DATE-1,
              LNFILE.LN_INSPREM_1     = :QLN-INSPREM-1,
              LNFILE.LN_INSCOVR_1     = :QLN-INSCOVR-1,
              LNFILE.LN_INSCOMM_1     = :QLN-INSCOMM-1,
              LNFILE.LN_INSANTICERN_1 = :QLN-INSANTICERN-1,
              LNFILE.LN_INSANTICADJ_1 = :QLN-INSANTICADJ-1,
              LNFILE.LN_INSUFERN_1    = :QLN-INSUFERN-1,
              LNFILE.LN_INSACCERN_1   = :QLN-INSACCERN-1,
              LNFILE.LN_INSEARN_ORDER_1 = :QLN-INSEARN-ORDER-1,
              LNFILE.LN_INSFINCHG_1     = :QLN-INSFINCHG-1,
              LNFILE.LN_INSCOMP_2     = :QLN-INSCOMP-2,
              LNFILE.LN_INSOURS_2     = :QLN-INSOURS-2,
              LNFILE.LN_INSEFF_DATE_2 = :QLN-INSEFF-DATE-2,
              LNFILE.LN_INSEXP_DATE_2 = :QLN-INSEXP-DATE-2,
              LNFILE.LN_INSPREM_2     = :QLN-INSPREM-2,
              LNFILE.LN_INSCOVR_2     = :QLN-INSCOVR-2,
              LNFILE.LN_INSCOMM_2     = :QLN-INSCOMM-2,
              LNFILE.LN_INSANTICERN_2 = :QLN-INSANTICERN-2,
              LNFILE.LN_INSANTICADJ_2 = :QLN-INSANTICADJ-2,
              LNFILE.LN_INSUFERN_2    = :QLN-INSUFERN-2,
              LNFILE.LN_INSACCERN_2   = :QLN-INSACCERN-2,
              LNFILE.LN_INSEARN_ORDER_2 = :QLN-INSEARN-ORDER-2,
              LNFILE.LN_INSFINCHG_2     = :QLN-INSFINCHG-2,
              LNFILE.LN_INSCOMP_3       = :QLN-INSCOMP-3,
              LNFILE.LN_INSOURS_3       = :QLN-INSOURS-3,
              LNFILE.LN_INSEFF_DATE_3   = :QLN-INSEFF-DATE-3,
              LNFILE.LN_INSEXP_DATE_3   = :QLN-INSEXP-DATE-3,
              LNFILE.LN_INSPREM_3       = :QLN-INSPREM-3,
              LNFILE.LN_INSCOVR_3       = :QLN-INSCOVR-3,
              LNFILE.LN_INSCOMM_3       = :QLN-INSCOMM-3,
              LNFILE.LN_INSANTICERN_3   = :QLN-INSANTICERN-3,
              LNFILE.LN_INSANTICADJ_3   = :QLN-INSANTICADJ-3,
              LNFILE.LN_INSUFERN_3      = :QLN-INSUFERN-3,
              LNFILE.LN_INSACCERN_3     = :QLN-INSACCERN-3,
              LNFILE.LN_INSEARN_ORDER_3 = :QLN-INSEARN-ORDER-3,
              LNFILE.LN_INSFINCHG_3     = :QLN-INSFINCHG-3,
              LNFILE.LN_INSCOMP_4       = :QLN-INSCOMP-4,
              LNFILE.LN_INSOURS_4       = :QLN-INSOURS-4,
              LNFILE.LN_INSEFF_DATE_4   = :QLN-INSEFF-DATE-4,
              LNFILE.LN_INSEXP_DATE_4   = :QLN-INSEXP-DATE-4,
              LNFILE.LN_INSPREM_4       = :QLN-INSPREM-4,
              LNFILE.LN_INSCOVR_4       = :QLN-INSCOVR-4,
              LNFILE.LN_INSCOMM_4       = :QLN-INSCOMM-4,
              LNFILE.LN_INSANTICERN_4   = :QLN-INSANTICERN-4,
              LNFILE.LN_INSANTICADJ_4   = :QLN-INSANTICADJ-4,
              LNFILE.LN_INSUFERN_4      = :QLN-INSUFERN-4,
              LNFILE.LN_INSACCERN_4     = :QLN-INSACCERN-4,
              LNFILE.LN_INSEARN_ORDER_4 = :QLN-INSEARN-ORDER-4,
              LNFILE.LN_INSFINCHG_4     = :QLN-INSFINCHG-4,
              LNFILE.LN_INSCOMP_5       = :QLN-INSCOMP-5,
              LNFILE.LN_INSOURS_5       = :QLN-INSOURS-5,
              LNFILE.LN_INSEFF_DATE_5   = :QLN-INSEFF-DATE-5,
              LNFILE.LN_INSEXP_DATE_5   = :QLN-INSEXP-DATE-5,
              LNFILE.LN_INSPREM_5       = :QLN-INSPREM-5,
              LNFILE.LN_INSCOVR_5       = :QLN-INSCOVR-5,
              LNFILE.LN_INSCOMM_5       = :QLN-INSCOMM-5,
              LNFILE.LN_INSANTICERN_5   = :QLN-INSANTICERN-5,
              LNFILE.LN_INSANTICADJ_5   = :QLN-INSANTICADJ-5,
              LNFILE.LN_INSUFERN_5      = :QLN-INSUFERN-5,
              LNFILE.LN_INSACCERN_5     = :QLN-INSACCERN-5,
              LNFILE.LN_INSEARN_ORDER_5 = :QLN-INSEARN-ORDER-5,
              LNFILE.LN_INSFINCHG_5     = :QLN-INSFINCHG-5,
              LNFILE.LN_INSCOMP_6       = :QLN-INSCOMP-6,
              LNFILE.LN_INSOURS_6       = :QLN-INSOURS-6,
              LNFILE.LN_INSEFF_DATE_6   = :QLN-INSEFF-DATE-6,
              LNFILE.LN_INSEXP_DATE_6   = :QLN-INSEXP-DATE-6,
              LNFILE.LN_INSPREM_6       = :QLN-INSPREM-6,
              LNFILE.LN_INSCOVR_6       = :QLN-INSCOVR-6,
              LNFILE.LN_INSCOMM_6       = :QLN-INSCOMM-6,
              LNFILE.LN_INSANTICERN_6   = :QLN-INSANTICERN-6,
              LNFILE.LN_INSANTICADJ_6   = :QLN-INSANTICADJ-6,
              LNFILE.LN_INSUFERN_6      = :QLN-INSUFERN-6,
              LNFILE.LN_INSACCERN_6     = :QLN-INSACCERN-6,
              LNFILE.LN_INSEARN_ORDER_6 = :QLN-INSEARN-ORDER-6,
              LNFILE.LN_INSFINCHG_6     = :QLN-INSFINCHG-6,
              LNFILE.LN_INSCOMP_7       = :QLN-INSCOMP-7,
              LNFILE.LN_INSOURS_7       = :QLN-INSOURS-7,
              LNFILE.LN_INSEFF_DATE_7   = :QLN-INSEFF-DATE-7,
              LNFILE.LN_INSEXP_DATE_7   = :QLN-INSEXP-DATE-7,
              LNFILE.LN_INSPREM_7       = :QLN-INSPREM-7,
              LNFILE.LN_INSCOVR_7       = :QLN-INSCOVR-7,
              LNFILE.LN_INSCOMM_7       = :QLN-INSCOMM-7,
              LNFILE.LN_INSANTICERN_7   = :QLN-INSANTICERN-7,
              LNFILE.LN_INSANTICADJ_7   = :QLN-INSANTICADJ-7,
              LNFILE.LN_INSUFERN_7      = :QLN-INSUFERN-7,
              LNFILE.LN_INSACCERN_7     = :QLN-INSACCERN-7,
              LNFILE.LN_INSEARN_ORDER_7 = :QLN-INSEARN-ORDER-7,
              LNFILE.LN_INSFINCHG_7     = :QLN-INSFINCHG-7,
              LNFILE.LN_INSCOMP_8       = :QLN-INSCOMP-8,
              LNFILE.LN_INSOURS_8       = :QLN-INSOURS-8,
              LNFILE.LN_INSEFF_DATE_8   = :QLN-INSEFF-DATE-8,
              LNFILE.LN_INSEXP_DATE_8   = :QLN-INSEXP-DATE-8,
              LNFILE.LN_INSPREM_8       = :QLN-INSPREM-8,
              LNFILE.LN_INSCOVR_8       = :QLN-INSCOVR-8,
              LNFILE.LN_INSCOMM_8       = :QLN-INSCOMM-8,
              LNFILE.LN_INSANTICERN_8   = :QLN-INSANTICERN-8,
              LNFILE.LN_INSANTICADJ_8   = :QLN-INSANTICADJ-8,
              LNFILE.LN_INSUFERN_8      = :QLN-INSUFERN-8,
              LNFILE.LN_INSACCERN_8     = :QLN-INSACCERN-8,
              LNFILE.LN_INSEARN_ORDER_8 = :QLN-INSEARN-ORDER-8,
              LNFILE.LN_INSFINCHG_8     = :QLN-INSFINCHG-8,
              LNFILE.LN_INSCOMP_9       = :QLN-INSCOMP-9,
              LNFILE.LN_INSOURS_9       = :QLN-INSOURS-9,
              LNFILE.LN_INSEFF_DATE_9   = :QLN-INSEFF-DATE-9,
              LNFILE.LN_INSEXP_DATE_9   = :QLN-INSEXP-DATE-9,
              LNFILE.LN_INSPREM_9       = :QLN-INSPREM-9,
              LNFILE.LN_INSCOVR_9       = :QLN-INSCOVR-9,
              LNFILE.LN_INSCOMM_9       = :QLN-INSCOMM-9,
              LNFILE.LN_INSANTICERN_9   = :QLN-INSANTICERN-9,
              LNFILE.LN_INSANTICADJ_9   = :QLN-INSANTICADJ-9,
              LNFILE.LN_INSUFERN_9      = :QLN-INSUFERN-9,
              LNFILE.LN_INSACCERN_9     = :QLN-INSACCERN-9,
              LNFILE.LN_INSEARN_ORDER_9 = :QLN-INSEARN-ORDER-9,
              LNFILE.LN_INSFINCHG_9     = :QLN-INSFINCHG-9,
              LNFILE.LN_INSCOMP_10      = :QLN-INSCOMP-10,
              LNFILE.LN_INSOURS_10      = :QLN-INSOURS-10,
              LNFILE.LN_INSEFF_DATE_10  = :QLN-INSEFF-DATE-10,
              LNFILE.LN_INSEXP_DATE_10  = :QLN-INSEXP-DATE-10,
              LNFILE.LN_INSPREM_10      = :QLN-INSPREM-10,
              LNFILE.LN_INSCOVR_10      = :QLN-INSCOVR-10,
              LNFILE.LN_INSCOMM_10      = :QLN-INSCOMM-10,
              LNFILE.LN_INSANTICERN_10  = :QLN-INSANTICERN-10,
              LNFILE.LN_INSANTICADJ_10  = :QLN-INSANTICADJ-10,
              LNFILE.LN_INSUFERN_10     = :QLN-INSUFERN-10,
              LNFILE.LN_INSACCERN_10    = :QLN-INSACCERN-10,
              LNFILE.LN_INSEARN_ORDER_10 = :QLN-INSEARN-ORDER-10,
              LNFILE.LN_INSFINCHG_10     = :QLN-INSFINCHG-10,
              LNFILE.LN_PY_YYYYMM_RECDEL = :QLN-PY-YYYYMM-RECDEL,
              LNFILE.LN_MTD_PAYS_RECDEL  = :QLN-MTD-PAYS-RECDEL,
              LNFILE.LN_GARNISH_EXTR     = :QLN-GARNISH-EXTR,
              LNFILE.LN_SHIP_SAME_FG     = :QLN-SHIP-SAME-FG,
              LNFILE.LN_AD_D_INS_COVR    = :QLN-AD-D-INS-COVR,
              LNFILE.LN_TOT_PARTIAL_CHGOFF = :QLN-TOT-PARTIAL-CHGOFF,
              LNFILE.LN_LPO              = :QLN-LPO,
              LNFILE.LN_REP_CD           = :QLN-REP-CD,
              LNFILE.LN_EMP_ID           = :QLN-EMP-ID,
              LNFILE.LN_PROCESS_CD       = :QLN-PROCESS-CD,
              LNFILE.LN_WCBC_CREDITLIM   = :QLN-WCBC-CREDITLIM,
              LNFILE.LN_FOLLOWUP_CD      = :QLN-FOLLOWUP-CD,
              LNFILE.LN_MIP_FG           = :QLN-MIP-FG,
              LNFILE.LN_MIP_MTD_CLAHPAID = :QLN-MIP-MTD-CLAHPAID,
              LNFILE.LN_MIP_CLPDTH_DATE  = :QLN-MIP-CLPDTH-DATE,
              LNFILE.LN_MIP_TOT_CLPAID   = :QLN-MIP-TOT-CLPAID,
              LNFILE.LN_MIP_AHPDTH_DATE  = :QLN-MIP-AHPDTH-DATE,
              LNFILE.LN_MIP_TOT_AHPAID   = :QLN-MIP-TOT-AHPAID,
              LNFILE.LN_IL_GROSS_INCOME  = :QLN-IL-GROSS-INCOME,
              LNFILE.LN_IL_GROSS_INCOME2 = :QLN-IL-GROSS-INCOME2,
              LNFILE.LN_RESCISSION       = :QLN-RESCISSION,
              LNFILE.LN_INTERIM_TRW      = :QLN-INTERIM-TRW,
              LNFILE.LN_DLNO             = :QLN-DLNO,
              LNFILE.LN_DLPOOL           = :QLN-DLPOOL,
              LNFILE.LN_DLRECOURSE       = :QLN-DLRECOURSE,
              LNFILE.LN_DLPARTRCAMT      = :QLN-DLPARTRCAMT,
              LNFILE.LN_ORIGPURAMT       = :QLN-ORIGPURAMT,
              LNFILE.LN_PURBAL           = :QLN-PURBAL,
              LNFILE.LN_DLRVPRIN_1       = :QLN-DLRVPRIN-1,
              LNFILE.LN_DLRVPRIN_2       = :QLN-DLRVPRIN-2,
              LNFILE.LN_DLRVPRIN_3       = :QLN-DLRVPRIN-3,
              LNFILE.LN_DLRVCHGS_1       = :QLN-DLRVCHGS-1,
              LNFILE.LN_DLRVCHGS_2       = :QLN-DLRVCHGS-2,
              LNFILE.LN_DLRVCHGS_3       = :QLN-DLRVCHGS-3,
              LNFILE.LN_DLPARVHELD       = :QLN-DLPARVHELD,
              LNFILE.LN_DLPARVPAID       = :QLN-DLPARVPAID,
              LNFILE.LN_DLDISC           = :QLN-DLDISC,
              LNFILE.LN_LCPDTH_DATE      = :QLN-LCPDTH-DATE,
              LNFILE.LN_INTPDTH_DATE     = :QLN-INTPDTH-DATE,
              LNFILE.LN_CURBAL           = :QLN-CURBAL,
              LNFILE.LN_INTBAL           = :QLN-INTBAL,
              LNFILE.LN_LCBAL            = :QLN-LCBAL,
              LNFILE.LN_OTHBAL           = :QLN-OTHBAL,
              LNFILE.LN_OT2BAL           = :QLN-OT2BAL,
              LNFILE.LN_LCPAID           = :QLN-LCPAID,
              LNFILE.LN_LCPARTIALS       = :QLN-LCPARTIALS,
              LNFILE.LN_STMT_COUNTER     = :QLN-STMT-COUNTER,
              LNFILE.LN_PRIOR_STMT_COUNTER = :QLN-PRIOR-STMT-COUNTER,
              LNFILE.LN_FROZEN_REASON      = :QLN-FROZEN-REASON,
              LNFILE.LN_COUPON_STATEMENT   = :QLN-COUPON-STATEMENT,
              LNFILE.LN_MONTHEND_BAL       = :QLN-MONTHEND-BAL,
              LNFILE.LN_ANTICTERM = :QLN-ANTICTERM,
              LNFILE.LN_ANTICERN_1 = :QLN-ANTICERN-1,
              LNFILE.LN_ANTICADJ_1 = :QLN-ANTICADJ-1,
              LNFILE.LN_UFERN_1 = :QLN-UFERN-1,
              LNFILE.LN_ACCERN_1 = :QLN-ACCERN-1,
              LNFILE.LN_EARN_ORDER_1 = :QLN-EARN-ORDER-1,
              LNFILE.LN_ANTICERN_2 = :QLN-ANTICERN-2,
              LNFILE.LN_ANTICADJ_2 = :QLN-ANTICADJ-2,
              LNFILE.LN_UFERN_2 = :QLN-UFERN-2,
              LNFILE.LN_ACCERN_2 = :QLN-ACCERN-2,
              LNFILE.LN_EARN_ORDER_2 = :QLN-EARN-ORDER-2,
              LNFILE.LN_ANTICERN_3 = :QLN-ANTICERN-3,
              LNFILE.LN_ANTICADJ_3 = :QLN-ANTICADJ-3,
              LNFILE.LN_UFERN_3 = :QLN-UFERN-3,
              LNFILE.LN_ACCERN_3 = :QLN-ACCERN-3,
              LNFILE.LN_EARN_ORDER_3 = :QLN-EARN-ORDER-3,
              LNFILE.LN_ANTICERN_4 = :QLN-ANTICERN-4,
              LNFILE.LN_ANTICADJ_4 = :QLN-ANTICADJ-4,
              LNFILE.LN_UFERN_4 = :QLN-UFERN-4,
              LNFILE.LN_ACCERN_4 = :QLN-ACCERN-4,
              LNFILE.LN_EARN_ORDER_4 = :QLN-EARN-ORDER-4,
              LNFILE.LN_ANTICERN_5 = :QLN-ANTICERN-5,
              LNFILE.LN_ANTICADJ_5 = :QLN-ANTICADJ-5,
              LNFILE.LN_UFERN_5 = :QLN-UFERN-5,
              LNFILE.LN_ACCERN_5 = :QLN-ACCERN-5,
              LNFILE.LN_EARN_ORDER_5 = :QLN-EARN-ORDER-5,
              LNFILE.LN_ANTICERN_6 = :QLN-ANTICERN-6,
              LNFILE.LN_ANTICADJ_6 = :QLN-ANTICADJ-6,
              LNFILE.LN_UFERN_6 = :QLN-UFERN-6,
              LNFILE.LN_ACCERN_6 = :QLN-ACCERN-6,
              LNFILE.LN_EARN_ORDER_6 = :QLN-EARN-ORDER-6,
              LNFILE.LN_ANTICERN_7 = :QLN-ANTICERN-7,
              LNFILE.LN_ANTICADJ_7 = :QLN-ANTICADJ-7,
              LNFILE.LN_UFERN_7 = :QLN-UFERN-7,
              LNFILE.LN_ACCERN_7 = :QLN-ACCERN-7,
              LNFILE.LN_EARN_ORDER_7 = :QLN-EARN-ORDER-7,
              LNFILE.LN_ANTICERN_8 = :QLN-ANTICERN-8,
              LNFILE.LN_ANTICADJ_8 = :QLN-ANTICADJ-8,
              LNFILE.LN_UFERN_8 = :QLN-UFERN-8,
              LNFILE.LN_ACCERN_8 = :QLN-ACCERN-8,
              LNFILE.LN_EARN_ORDER_8 = :QLN-EARN-ORDER-8,
              LNFILE.LN_ANTICERN_9 = :QLN-ANTICERN-9,
              LNFILE.LN_ANTICADJ_9 = :QLN-ANTICADJ-9,
              LNFILE.LN_UFERN_9 = :QLN-UFERN-9,
              LNFILE.LN_ACCERN_9 = :QLN-ACCERN-9,
              LNFILE.LN_EARN_ORDER_9 = :QLN-EARN-ORDER-9,
              LNFILE.LN_ANTICERN_10 = :QLN-ANTICERN-10,
              LNFILE.LN_ANTICADJ_10 = :QLN-ANTICADJ-10,
              LNFILE.LN_UFERN_10 = :QLN-UFERN-10,
              LNFILE.LN_ACCERN_10 = :QLN-ACCERN-10,
              LNFILE.LN_EARN_ORDER_10 = :QLN-EARN-ORDER-10,
              LNFILE.LN_LMO_PRIOR_INTEREST = :QLN-LMO-PRIOR-INTEREST,
              LNFILE.LN_PRIOR_UNEARNED = :QLN-PRIOR-UNEARNED,
              LNFILE.LN_ERNDELQ_STOP = :QLN-ERNDELQ-STOP,
              LNFILE.LN_NONACRERN = :QLN-NONACRERN,
              LNFILE.LN_PRIOR_NONACRERN = :QLN-PRIOR-NONACRERN,
              LNFILE.LN_ERN_IB_PDTH_DATE =
                 :QLN-ERN-IB-PDTH-DATE,
              LNFILE.LN_ERN_IB_PRINBAL = :QLN-ERN-IB-PRINBAL,
              LNFILE.LN_ERN_IB_INTOWE = :QLN-ERN-IB-INTOWE,
              LNFILE.LN_TOTERN = :QLN-TOTERN,
              LNFILE.LN_TOTOTH = :QLN-TOTOTH,
              LNFILE.LN_TOTINT = :QLN-TOTINT,
              LNFILE.LN_TOTLCHG = :QLN-TOTLCHG,
              LNFILE.LN_TOTDEF = :QLN-TOTDEF,
              LNFILE.LN_TOTSERACCT = :QLN-TOTSERACCT,
              LNFILE.LN_LCWAIVERS = :QLN-LCWAIVERS,
              LNFILE.LN_INTWAIVERS = :QLN-INTWAIVERS,
              LNFILE.LN_TOTPAYMNTD = :QLN-TOTPAYMNTD,
              LNFILE.LN_TOTEXCPAYMNTD = :QLN-TOTEXCPAYMNTD,
              LNFILE.LN_TOTNODEF = :QLN-TOTNODEF,
              LNFILE.LN_YTDNODEF = :QLN-YTDNODEF,
              LNFILE.LN_TOTNODEFACT = :QLN-TOTNODEFACT,
              LNFILE.LN_YTDNODEFACT = :QLN-YTDNODEFACT,
              LNFILE.LN_TOTNOALDEL = :QLN-TOTNOALDEL,
              LNFILE.LN_YTDNOALDEL = :QLN-YTDNOALDEL,
              LNFILE.LN_YTDINTPD = :QLN-YTDINTPD,
              LNFILE.LN_LYRINTPD = :QLN-LYRINTPD,
              LNFILE.LN_TOTINTPD = :QLN-TOTINTPD,
              LNFILE.LN_RECASTINT = :QLN-RECASTINT,
              LNFILE.LN_RECASTPRIN = :QLN-RECASTPRIN,
              LNFILE.LN_CL_REBATE = :QLN-CL-REBATE,
              LNFILE.LN_AH_REBATE = :QLN-AH-REBATE,
              LNFILE.LN_PP_REBATE = :QLN-PP-REBATE,
              LNFILE.LN_INT_REBATE = :QLN-INT-REBATE,
              LNFILE.LN_SC_REBATE = :QLN-SC-REBATE,
              LNFILE.LN_MF_REBATE = :QLN-MF-REBATE,
              LNFILE.LN_DF_REBATE = :QLN-DF-REBATE,
              LNFILE.LN_EX_REBATE = :QLN-EX-REBATE,
              LNFILE.LN_O1_REBATE = :QLN-O1-REBATE,
              LNFILE.LN_O2_REBATE = :QLN-O2-REBATE,
              LNFILE.LN_O3_REBATE = :QLN-O3-REBATE,
              LNFILE.LN_O4_REBATE = :QLN-O4-REBATE,
              LNFILE.LN_O5_REBATE = :QLN-O5-REBATE,
              LNFILE.LN_O6_REBATE = :QLN-O6-REBATE,
              LNFILE.LN_O7_REBATE = :QLN-O7-REBATE,
              LNFILE.LN_UN_O7_REB = :QLN-UN-O7-REB,
              LNFILE.LN_UN_O8_REB = :QLN-UN-O8-REB,
              LNFILE.LN_UN_O9_REB = :QLN-UN-O9-REB,
              LNFILE.LN_UN_O10_REB = :QLN-UN-O10-REB,
              LNFILE.LN_PLREASON   = :QLN-PLREASON,
              LNFILE.LN_COLLECTOR  = :QLN-COLLECTOR,
              LNFILE.LN_ACTIONCD   = :QLN-ACTIONCD,
              LNFILE.LN_ACTIONCD2  = :QLN-ACTIONCD2,
              LNFILE.LN_ATCODE     = :QLN-ATCODE,
              LNFILE.LN_RECODE     = :QLN-RECODE,
              LNFILE.LN_ESCROW_FG  = :QLN-ESCROW-FG,
              LNFILE.LN_PROMDAYS_PASTDUE = :QLN-PROMDAYS-PASTDUE,
              LNFILE.LN_PROMID = :QLN-PROMID,
              LNFILE.LN_PROMDATE  = :QLN-PROMDATE,
              LNFILE.LN_PROMAMT   = :QLN-PROMAMT,
              LNFILE.LN_PROMDATE2 = :QLN-PROMDATE2,
              LNFILE.LN_DATE_PAID_LAST = :QLN-DATE-PAID-LAST,
              LNFILE.LN_AMT_PAID_LAST = :QLN-AMT-PAID-LAST,
              LNFILE.LN_LASTCFORMNO = :QLN-LASTCFORMNO,
              LNFILE.LN_LASTCFORMDATE =
                 :QLN-LASTCFORMDATE,
              LNFILE.LN_DELCNT = :QLN-DELCNT,
              LNFILE.LN_DELCNT2 = :QLN-DELCNT2,
              LNFILE.LN_CREDITLIM = :QLN-CREDITLIM,
              LNFILE.LN_CRSCORE = :QLN-CRSCORE,
              LNFILE.LN_LASTSFORMNO = :QLN-LASTSFORMNO,
              LNFILE.LN_LASTSFORMDATE =
                 :QLN-LASTSFORMDATE,
              LNFILE.LN_SOLCNT = :QLN-SOLCNT,
              LNFILE.LN_MESSAGE = :QLN-MESSAGE,
              LNFILE.LN_OLDACCTNO = :QLN-OLDACCTNO,
              LNFILE.LN_PRLNNO = :QLN-PRLNNO,
              LNFILE.LN_PRBAL = :QLN-PRBAL,
              LNFILE.LN_PRINTDUE = :QLN-PRINTDUE,
              LNFILE.LN_PRFINCHGRB = :QLN-PRFINCHGRB,
              LNFILE.LN_PRINSRB = :QLN-PRINSRB,
              LNFILE.LN_PRPOCD = :QLN-PRPOCD,
              LNFILE.LN_PRPODATE = :QLN-PRPODATE,
              LNFILE.LN_PRDELINQAMT = :QLN-PRDELINQAMT,
              LNFILE.LN_PRLNAMT = :QLN-PRLNAMT,
              LNFILE.LN_PRPDUE_DAYS = :QLN-PRPDUE-DAYS,
              LNFILE.LN_PRDLDISC_UNEARN = :QLN-PRDLDISC-UNEARN,
              LNFILE.LN_PRCONPROFILE = :QLN-PRCONPROFILE,
              LNFILE.LN_SUM_ORIGPURAMT = :QLN-SUM-ORIGPURAMT,
              LNFILE.LN_SUM_LNAMT = :QLN-SUM-LNAMT,
              LNFILE.LN_SUM_FINCHG = :QLN-SUM-FINCHG,
              LNFILE.LN_SUM_INTCHG = :QLN-SUM-INTCHG,
              LNFILE.LN_SUM_ORGTERM = :QLN-SUM-ORGTERM,
              LNFILE.LN_SUM_REGPYAMT = :QLN-SUM-REGPYAMT,
              LNFILE.LN_SUM_EXTCHG = :QLN-SUM-EXTCHG,
              LNFILE.LN_SUM_SERCHG = :QLN-SUM-SERCHG,
              LNFILE.LN_SUM_MAINTFEE = :QLN-SUM-MAINTFEE,
              LNFILE.LN_UNITPER_CD = :QLN-UNITPER-CD,
              LNFILE.LN_UNITPER_FREQ = :QLN-UNITPER-FREQ,
              LNFILE.LN_DAYS_IN_UNITPER = :QLN-DAYS-IN-UNITPER,
              LNFILE.LN_UNITPER_PER_YEAR = :QLN-UNITPER-PER-YEAR,
              LNFILE.LN_REPOCD = :QLN-REPOCD,
              LNFILE.LN_BR_TFR_FG = :QLN-BR-TFR-FG,
              LNFILE.LN_O3INS_DLPROC = :QLN-O3INS-DLPROC,
              LNFILE.LN_INSPREM_DLADJ = :QLN-INSPREM-DLADJ,
              LNFILE.LN_PLAMT = :QLN-PLAMT,
              LNFILE.LN_MTD_PRIN = :QLN-MTD-PRIN,
              LNFILE.LN_MTD_LC = :QLN-MTD-LC,
              LNFILE.LN_MTD_INT = :QLN-MTD-INT,
              LNFILE.LN_MTD_OT = :QLN-MTD-OT,
              LNFILE.LN_MTD_EX = :QLN-MTD-EX,
              LNFILE.LN_BNKRPT_CHAPTER = :QLN-BNKRPT-CHAPTER,
              LNFILE.LN_BMO_CON_STATUS = :QLN-BMO-CON-STATUS,
              LNFILE.LN_BMO_REC_STATUS = :QLN-BMO-REC-STATUS,
              LNFILE.LN_APP_NUMBER = :QLN-APP-NUMBER,
              LNFILE.LN_GIFTNET = :QLN-GIFTNET,
              LNFILE.LN_GIFTNET_OUR_PO = :QLN-GIFTNET-OUR-PO,
              LNFILE.LN_PROC_DISBURSED = :QLN-PROC-DISBURSED,
              LNFILE.LN_NOODDPY = :QLN-NOODDPY,
              LNFILE.LN_CONPROFILE_1 = :QLN-CONPROFILE-1,
              LNFILE.LN_CONPROFILE_2 = :QLN-CONPROFILE-2,
              LNFILE.LN_CONPROFILE_3 = :QLN-CONPROFILE-3,
              LNFILE.LN_CONPROFILE_4 = :QLN-CONPROFILE-4,
              LNFILE.LN_CONPROFILE_5 = :QLN-CONPROFILE-5,
              LNFILE.LN_RECPROFILE_1 = :QLN-RECPROFILE-1,
              LNFILE.LN_RECPROFILE_2 = :QLN-RECPROFILE-2,
              LNFILE.LN_RECPROFILE_3 = :QLN-RECPROFILE-3,
              LNFILE.LN_RECPROFILE_4 = :QLN-RECPROFILE-4,
              LNFILE.LN_RECPROFILE_5 = :QLN-RECPROFILE-5,
              LNFILE.LN_TRW_STATUS = :QLN-TRW-STATUS,
              LNFILE.LN_ORIGIN = :QLN-ORIGIN,
              LNFILE.LN_PO_TRCD = :QLN-PO-TRCD,
              LNFILE.LN_NEXIS_CRSCORE = :QLN-NEXIS-CRSCORE,
              LNFILE.LN_TRW_B_CONSUMER_IND =
                   :QLN-TRW-B-CONSUMER-IND,
              LNFILE.LN_PARVHELD_PAID_FG = :QLN-PARVHELD-PAID-FG,
              LNFILE.LN_ACCT_FROZEN = :QLN-ACCT-FROZEN,
              LNFILE.LN_TRW_SPECIAL_CODE = :QLN-TRW-SPECIAL-CODE,
              LNFILE.LN_CREATION_STATUS = :QLN-CREATION-STATUS,
              LNFILE.LN_TOTNOLCHG = :QLN-TOTNOLCHG,
              LNFILE.LN_LBOX = :QLN-LBOX,
              LNFILE.LN_EXTRA_PRIN_LFP = :QLN-EXTRA-PRIN-LFP,
              LNFILE.LN_REMAIN_INT_SINCE_LFP =
                   :QLN-REMAIN-INT-SINCE-LFP,
              LNFILE.LN_REMAIN_PRIN_SINCE_LFP =
                   :QLN-REMAIN-PRIN-SINCE-LFP,
              LNFILE.LN_INTERIM_COUPON = :QLN-INTERIM-COUPON,
              LNFILE.LN_DLCOMM_O3_CMSI = :QLN-DLCOMM-O3-CMSI,
              LNFILE.LN_DLCOMM_PP_CMSI = :QLN-DLCOMM-PP-CMSI,
              LNFILE.LN_TRW_J_CONSUMER_IND = :QLN-TRW-J-CONSUMER-IND,
              LNFILE.LN_ACH = :QLN-ACH,
              LNFILE.LN_1099_C_FG = :QLN-1099-C-FG,
              LNFILE.LN_TRW_COMPLIANCE_CODE =
                   :QLN-TRW-COMPLIANCE-CODE,
              LNFILE.LN_UNWIND_REASON_CODE =
                   :QLN-UNWIND-REASON-CODE,
              LNFILE.LN_PBI_PBD_FG = :QLN-PBI-PBD-FG,
              LNFILE.LN_OLD_ACCT_FORMAT_FG =
                   :QLN-OLD-ACCT-FORMAT-FG,
              LNFILE.LN_APPROVED_BY_USER = :QLN-APPROVED-BY-USER,
              LNFILE.LN_APPROVED_BY_CODE = :QLN-APPROVED-BY-CODE,
              LNFILE.LN_APPROVED_BY_DATE = :QLN-APPROVED-BY-DATE,
              LNFILE.LN_APPROVED_BY_TIME = :QLN-APPROVED-BY-TIME,
              LNFILE.LN_LTOUCH_DATE      = :QLN-LTOUCH-DATE,
              LNFILE.LN_LTOUCH_TIME      = :QLN-LTOUCH-TIME

             WHERE LNFILE.LN_OWNBR  = :QLN-OWNBR
               AND LNFILE.LN_ACCTNO = :QLN-ACCTNO
           END-EXEC.

      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * NOTE: THE WHERE CONSTRAINT IN THE ABOVE REWRITE NEEDS TO USE
      *       THE PRIMARY KEY WHERE CONSTRAINT; CANNOT DO A REWRITE ON
      *       THE SECONDARY KEY SINCE THE Q??#-KEY IS CHANGED AND WILL
      *       NOT FIND THE ORIGINAL KEY, AS WELL AS Q??#-KEY COULD
      *       MATCH ANOTHER RECORD/ROW THAT SHOULD NOT CHANGE!!!
      *- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

           PERFORM SQL-IO-VALIDATION.

           MOVE '1' TO SQL-UPDATE-CONN-USE-SW.    *> CHANGE CONNECTION BACK TO C1
           PERFORM SQL-SWAP-UPDATE-CONNECTION.

           IF ( IO-FG = 8 )     *> LOCKED
              GO TO REWRITE-LN3-FILE.

           IF ( IO-FG = 0 )
      *       EXEC SQL COMMIT END-EXEC
      *       PERFORM SQL-IO-VALIDATION
              IF LN-BI-FG = "Y"
                 MOVE "R" TO STAT
                 PERFORM LN3-UPDATE-BI-FILE.

      *-----------------------------------------------------------------
       START-LN-FILE-COUNT.
           PERFORM START-IT.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.

           INITIALIZE PASS-SQL.

           IF (LNFC-CURSOR-STAT-GOOD )
              PERFORM CLOSE-LN3-FILE.

           STRING "SELECT SUM(CASE WHEN LNFILE.LN_POCD IN ('*I','*R')"
                 "        THEN 1 ELSE 0 END) TOTDELETED"
                 ",SUM(CASE WHEN LNFILE.LN_POCD IN ('*I','*R') THEN 0" 
                 "  WHEN LNFILE.LN_POCD = 'BT' "
                 "    OR LNFILE.LN_SKIP_TRW = 'Y' THEN 1"
                 "  WHEN LNFILE.LN_CONVERCD = 'Y'"
                 "    AND LNFILE.LN_ENTDATE < '2019-01-01' THEN 1"
                 "  WHEN LNFILE.LN_CURBAL = 0 "
                 "    AND LNFILE.LN_POFFDATE = '1900-01-01' THEN 1"
                 "  ELSE 0 END) TOTBYPASSED"
                 " FROM DBO.LNFILE LNFILE"
                 " WHERE LNFILE.LN_OWNBR = ", 
                 QLN3-WBEG-OWNBR
                " AND LNFILE.LN_CLASS BETWEEN ",
                 QLN3-WBEG-CLASS
                " AND ",
                 QLN3-WEND-CLASS
                " AND LNFILE.LN_ACCTNO BETWEEN ",
                 QLN3-WBEG-ACCTNO
                   " AND ",
                 QLN3-WEND-ACCTNO 
                INTO PASS-SQL.
 
           EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC.

           EXEC SQL
            DECLARE LNFC_CURSOR CURSOR FOR
                :LN3-RETURN-CODE = 
                 EXEC SSP_TCLP_SELECT
                  ( :PASS-SQL)
                END-EXEC.

           EXEC SQL
               OPEN LNFC_CURSOR
           END-EXEC.

           PERFORM SQL-IO-VALIDATION.

           MOVE STAT---GOOD TO LNFC-CURSOR-STAT.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       READ-LN-FILE-COUNT-NEXT.
           PERFORM READ-IT.
           MOVE LN-PATH-SQL    TO E-FILE.
           MOVE SPACES         TO E-KEYX.
           INITIALIZE RET-TOT-DELETED RET-TOT-BYPASSED.

           EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC.

           IF ( LNFC-CURSOR-STAT-GOOD )
              EXEC SQL
                   FETCH LNFC_CURSOR INTO 
                       :RET-TOT-DELETED,
                       :RET-TOT-BYPASSED
              END-EXEC
           ELSE
              MOVE 9        TO SQLCODE
              MOVE "RDNXCR" TO SQLSTATE.

           PERFORM SQL-IO-VALIDATION.

           EXEC SQL SET CONNECTION C1 END-EXEC.

      *-----------------------------------------------------------------
       CLOSE-LN3-FILE.

           PERFORM CLOSE-IT.

           IF ( LNFC-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
              EXEC SQL
                   CLOSE LNFC_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO LNFC-CURSOR-STAT.

           IF ( LN3-CURSOR-STAT-GOOD )
              EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
              EXEC SQL
                   CLOSE LN3_CURSOR
              END-EXEC
              EXEC SQL SET CONNECTION C1 END-EXEC
              MOVE STAT---BAD TO LN3-CURSOR-STAT.

      *-----------------------------------------------------------------
       CLOSE-LN3-CONNECTION.

           IF LN3-CONN-OPEN-SW = "Y"
               EXEC SQL SET CONNECTION LN3_CONNECT END-EXEC
               EXEC SQL COMMIT END-EXEC
               EXEC SQL DISCONNECT LN3_CONNECT END-EXEC
               EXEC SQL SET CONNECTION C1 END-EXEC
               MOVE "N" TO LN3-CONN-OPEN-SW.
      *-----------------------------------------------------------------


       COPY "LIBGB/FERRORS.CPY".
           MOVE "E" TO EXT-EOBUF-ERRCD.

      *********************************
       END-PROGRAM SECTION.
      *********************************
           PERFORM CLOSE-FILES.
           IF EXT-ROUTE-BUF = "00"
              PERFORM PRU-OUT.
       EXIT-PROG.
           IF EXT-ROUTE-BUF = "00"
              MOVE "SP/TWMENU" TO FORM-NAM
              MOVE FORM-PATH TO FORM-PATHNAME.
       STOP-RUN.
           IF EXT-ROUTE-BUF = "00" OR "40" OR "50"
              DISPLAY SPACES LINE 0 COL 0 ERASE SCREEN
              DESTROY METRO2-SCREEN
              DESTROY EXT-EOBUF-WINDOW-HANDLE.
           EXIT PROGRAM.
