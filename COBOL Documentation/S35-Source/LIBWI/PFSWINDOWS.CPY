      ********************************************************************
      *REV:
      * MJD 130117 CHANGED LINE/COL TO BE SCREEN LINE/SCREEN COL
      *            THIS MAKES THE WINDOW OPEN BASED ON SCREEN COORDINATES RATHER
      *            THAN RELATIVE TO THE CALLING WINDOW.
      *            SET CELL HEIGHT/WIDTH BASED ON EXT VARIABLES.
      * MJD 130118 CHANGED CALL-WINDOW-PRORAM TO NO LONGER OPEN A WINDOW.
      *            A PROGRAMS WINDOW WILL NOW BE OPENED IN THE CALLED PROGRAM.        *            THIS ROUTINE WILL SIMPLY SAVE THE FORMPATH INFO, CALL THE
      *            PROGRAM AND THEN RESTORE THE FORMPATH INFO UPON IT'S RETURN.
      *            LEAVING IT IN THIS FORM SHOULD PROVIDE A CLEAN CHANGE
      *            WITHOUT A LOT OF INTERNAL CODING IN THE CALLING PROGRAMS.
      *            OPEN AND CLOSE WINDOW ROUTINES LEFT IN TACT.
      *            SOME PROGRAMS OPEN A WINDOW AND THEN PERFORM THE LOGIC
      *            FOR THAT ACTIONS WITHIN THAT WINDOW INTERALLY WITHOUT
      *            CALLING A SEPARATE PROGRAM (I.E. LONPF? AND LOAN APPS)
      * MJD 130112 ADDED "CANCEL FORM-PROGX." TO CALL-WINDOW-PROGRAM.  IT WAS
      *            REMOVED INADVERTANTLY DURING THE A30 CONVERSION.
      * MJD 130905 REMOVED REFERENCED TO FLDVAL.  IT WAS USED TO DIM/BOLD
      *            WINDOW TITLES AND NO LONGER RELEVENT WITH THE NEW SCREEN
      *            HANDLER. SEE LIBWI/SV/WINDOWS.130905 FOR REFERENCE TO
      *             OLD CODE
      * MJD 140606 ADDED EXIT-PATHNAME TO CALL..., REMOVED WINDOW-BOXED OPTION.
      ********************************************************************
       WINDOW-ROUTINES SECTION.
      *-------------------------------------------------------------------------
      * OPEN-WINDOW SHOULD ONLY BE USED WHEN OPENING A WINDOW IN WHICH
      *       THE LOGIC RESIDES WITHIN THE PROGRAM THAT IS OPENING THE WINDOW.
      *       IF THE LOGIC RESIDES IN A SEPARATE PROGRAM THEN USE
      *       CALL-WINDOW-PROGRAM
      *-------------------------------------------------------------------------
       OPEN-WINDOW.
           ADD 1 TO WINDOWS-OPEN.
           MOVE NEWWIN-BUF TO WINDOWS-NEWWIN-BUF(WINDOWS-OPEN)
           DISPLAY FLOATING GRAPHICAL WINDOW
              AT SCREEN LINE WINDOW-BEGIN-Y * VDU-WIN-L-OFFSET
              AT SCREEN COL  WINDOW-BEGIN-X * VDU-WIN-C-OFFSET
              SIZE    WINDOW-COLUMNS + VDU-WIN-W-MOD
              LINES   WINDOW-LINES + VDU-WIN-H-MOD
              BLANK SCREEN
              CELL  SIZE IS LABEL FONT
              COLOR IS VDU-WCOLOR-TCLP
              CONTROL VALUE IS VDU-WCTRL-TCLP
      * BH 1/9/2013
              POP-UP AREA IS WINDOWS-POP-UP-AREA(WINDOWS-OPEN).

      *--->IF WINDOW-FIT-TO = SPACES
      *       CALL NEWWIN USING STAT NEWWIN-BUF
      *    ELSE
      *       CALL NEWWIN USING STAT NEWWIN-BUF WINDOW-FIT-TO
      *       MOVE SPACES TO WINDOW-FIT-TO.
      *    IF STAT NOT = "00"
      *       MOVE "WINDOW ERROR" TO E-MSG
      *       GO TO IO-ERROR.
      *--->ADD 1 TO WINDOWS-OPEN.
           MOVE FORM-PATHNAME TO UNDERLAYED-FORM-PATHS(WINDOWS-OPEN)
                                 FORM-PATH.

           MOVE WINDOW-FORM-NAM TO FORM-NAM.
           MOVE FORM-PATH TO FORM-PATHNAME.
           MOVE 5 TO WINDOW-BEGIN-Y.
           MOVE 10 TO WINDOW-BEGIN-X.

      *-------------------------------------------------------------------------
      * CLOSE-WINDOW SHOULD ONLY BE USED WHEN CLOSING A WINDOW IN WHICH
      *       THE LOGIC RESIDES WITHIN THE PROGRAM THAT IS OPENING THE WINDOW.
      *-------------------------------------------------------------------------
       CLOSE-WINDOW.
           IF WINDOWS-OPEN > ZERO
              MOVE UNDERLAYED-FORM-PATHS(WINDOWS-OPEN)
                             TO FORM-PATHNAME, FORM-PATH
              CLOSE WINDOW WINDOWS-POP-UP-AREA(WINDOWS-OPEN)
              DESTROY WINDOWS-POP-UP-AREA(WINDOWS-OPEN)
              MOVE WINDOWS-NEWWIN-BUF(WINDOWS-OPEN) TO NEWWIN-BUF
              SUBTRACT 1 FROM WINDOWS-OPEN.
           MOVE " " TO WINDOW-INTERRUPT-FG.

      *-------------------------------------------------------------------------
      * OPEN-WINDOW-PROGRAM SHOULD ONLY BE USED WHEN OPENING A WINDOW IN WHICH
      *       THE LOGIC RESIDES A SEPARATE PROGRAM
      *
      * CALL-WINDOW-PROGRAM  NO LONGER OPENS A CLOSES A WINDOW. IT ONLY
      *       SAVES FORMPATH INFO AND CALLS THE REQUIRED PROGRAM.   THE
      *       WINDOW LOGIC FOR THE CALLED PROGRAM WILL NEED TO RESIDE
      *       WITHIN THAT PROGRAM
      *-------------------------------------------------------------------------
       CALL-WINDOW-PROGRAM.
           MOVE SCAN-FORM-NAM TO WINDOW-FORM-NAM.
           MOVE FORM-PATHNAME TO UNDERLAYED-FORM-PATH2 FORM-PATH.
           MOVE WINDOW-FORM-NAM TO FORM-NAM.
           MOVE FORM-PATH TO FORM-PATHNAME.
           MOVE "CO" TO FORM-OBJ.
           CALL FORM-PROGX USING FORM-PATH
                                SCAN-STATUS
                                SCAN-BUF
                                EXIT-PATHNAME
               ON OVERFLOW PERFORM LOAD-SCAN-OVERFLOW
           END-CALL.
           CANCEL FORM-PROGX.
           MOVE UNDERLAYED-FORM-PATH2 TO FORM-PATHNAME FORM-PATH.
           MOVE " " TO WINDOW-INTERRUPT-FG.

       LOAD-SCAN-OVERFLOW.
           MOVE "OVERFLOW IN CALLING SCAN" TO MESS.
           PERFORM SEND-MESS.

