<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C-TIM360-358 - COBOL Utility Documentation</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#e1f5fe',
                primaryTextColor: '#01579b',
                primaryBorderColor: '#0277bd',
                lineColor: '#0288d1',
                secondaryColor: '#f3e5f5',
                tertiaryColor: '#e8f5e8'
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="index.html">Home</a> &gt; <span class="current">C-TIM360-358 - COBOL Utility Documentation</span>
        </nav>
        <main class="content">
<h1 id="c-tim360-358-cobol-utility-documentation">C-TIM360-358 - COBOL Utility Documentation</h1>
<p><strong>Location:</strong> .\APIPAY\APIPAY_Inlined.CBL<br />
<strong>Generated on:</strong> July 31, 2025<br />
<strong>Program ID:</strong> C-TIM360-358<br />
<strong>Written:</strong> [Unknown, see source comments]</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#program-overview">Program Overview</a></li>
<li><a href="#transaction-types-supported">Transaction Types Supported</a></li>
<li><a href="#input-parameters">Input Parameters</a></li>
<li><a href="#output-fields">Output Fields</a></li>
<li><a href="#program-flow-diagrams">Program Flow Diagrams</a></li>
<li><a href="#batch-or-sequential-process-timeline">Batch or Sequential Process Timeline</a></li>
<li><a href="#paragraph-level-flow-explanation">Paragraph-Level Flow Explanation</a></li>
<li><a href="#data-flow-mapping">Data Flow Mapping</a></li>
<li><a href="#referenced-programs">Referenced Programs</a></li>
<li><a href="#error-handling-flow">Error Handling Flow</a></li>
<li><a href="#error-handling-and-validation">Error Handling and Validation</a></li>
<li><a href="#common-error-conditions">Common Error Conditions</a></li>
<li><a href="#technical-implementation">Technical Implementation</a></li>
<li><a href="#integration-points">Integration Points</a></li>
<li><a href="#file-dependencies">File Dependencies</a></li>
<li><a href="#call-graph-of-performed-paragraphs">Call Graph of PERFORMed Paragraphs</a></li>
</ol>
<hr />
<h2 id="program-overview">Program Overview</h2>
<p>C-TIM360-358 is a COBOL utility designed to process time-based calculations for loan payment schedules, interest accrual, and batch payment posting. It is invoked as part of the APIPAY batch payment system and is responsible for handling specific time-related logic, such as calculating elapsed time, validating payment dates, and posting batch transactions.</p>
<ul>
<li><strong>Purpose:</strong> Automate and validate time-based operations in batch payment processing.</li>
<li><strong>Scope:</strong> Handles calculations for elapsed time, interest accrual, and error logging.</li>
<li><strong>Integration:</strong> Called by APIPAY and other batch utilities for time-dependent operations.</li>
</ul>
<hr />
<h2 id="transaction-types-supported">Transaction Types Supported</h2>
<ul>
<li>Regular payment posting</li>
<li>Interest accrual calculations</li>
<li>Error logging for invalid payment dates</li>
<li>Batch payment processing</li>
</ul>
<hr />
<h2 id="input-parameters">Input Parameters</h2>
<ul>
<li>Payment date</li>
<li>Account number</li>
<li>Transaction type</li>
<li>Batch number</li>
<li>Interest rate</li>
</ul>
<hr />
<h2 id="output-fields">Output Fields</h2>
<ul>
<li>Updated payment schedule</li>
<li>Interest accrued</li>
<li>Error status</li>
<li>Batch posting log</li>
</ul>
<hr />
<h2 id="program-flow-diagrams">Program Flow Diagrams</h2>
<h3 id="high-level-flow">High-Level Flow</h3>
<div class="mermaid">graph TD
    Start([Start]) --> ValidateInput[Validate Input]
    ValidateInput --> CalculateElapsedTime[Calculate Elapsed Time]
    CalculateElapsedTime --> AccrueInterest[Accrue Interest]
    AccrueInterest --> PostBatchPayment[Post Batch Payment]
    PostBatchPayment --> LogError[Log Error]
    LogError --> End([End])
</div>
<h4 id="error-logging-flow">Error Logging Flow</h4>
<div class="mermaid">graph TD
    ErrorDetected([Error Detected]) --> LogError[Log Error]
    LogError --> UpdateStatus[Update Error Status]
    UpdateStatus --> NotifyUser[Notify User]
    NotifyUser --> End([End])
</div>
<h4 id="interest-accrual-flow">Interest Accrual Flow</h4>
<div class="mermaid">graph TD
    Start([Start]) --> CheckEligibility[Check Eligibility]
    CheckEligibility --> CalculateInterest[Calculate Interest]
    CalculateInterest --> UpdateAccount[Update Account]
    UpdateAccount --> End([End])
</div>
<h4 id="batch-payment-posting">Batch Payment Posting</h4>
<div class="mermaid">graph TD
    Start([Start]) --> LoadBatch[Load Batch]
    LoadBatch --> ValidatePayments[Validate Payments]
    ValidatePayments --> PostPayments[Post Payments]
    PostPayments --> UpdateLedger[Update Ledger]
    UpdateLedger --> End([End])
</div>
<hr />
<h2 id="batch-or-sequential-process-timeline">Batch or Sequential Process Timeline</h2>
<div class="mermaid">gantt
    title Batch Payment Processing Timeline
    dateFormat  YYYY-MM-DD
    section Batch Steps
    Validate Input        :done, 2025-07-31, 1h
    Calculate Elapsed Time:active, 2025-07-31, 2h
    Accrue Interest       : 2025-07-31, 1h
    Post Batch Payment    : 2025-07-31, 1h
    Log Error             : 2025-07-31, 0.5h
</div>
<hr />
<h2 id="paragraph-level-flow-explanation">Paragraph-Level Flow Explanation</h2>
<ul>
<li><strong>Validate Input:</strong> Checks for valid payment date, account number, and transaction type.</li>
<li><strong>Calculate Elapsed Time:</strong> Determines the number of days/months between payment dates.</li>
<li><strong>Accrue Interest:</strong> Calculates interest based on elapsed time and rate.</li>
<li><strong>Post Batch Payment:</strong> Updates payment schedule and logs transaction.</li>
<li><strong>Log Error:</strong> Records any errors encountered during processing.</li>
</ul>
<hr />
<h2 id="data-flow-mapping">Data Flow Mapping</h2>
<div class="mermaid">graph TD
    PaymentDate --> ElapsedTime
    ElapsedTime --> InterestAccrued
    InterestAccrued --> BatchPosting
    BatchPosting --> ErrorStatus
</div>
<hr />
<h2 id="referenced-programs">Referenced Programs</h2>
<ul>
<li><a href="APIPAY_Documentation.html">APIPAY</a>: Main batch payment processor</li>
<li><a href="C-TIM360-358_Documentation.html">C-TIM360-358</a>: This utility</li>
</ul>
<hr />
<h2 id="error-handling-flow">Error Handling Flow</h2>
<p>See <a href="Diagrams/C-TIM360-358_Error_Logging.mmd">Error Logging Flow Diagram</a></p>
<hr />
<h2 id="error-handling-and-validation">Error Handling and Validation</h2>
<ul>
<li>Validates input parameters</li>
<li>Checks for invalid dates and account numbers</li>
<li>Logs errors with detailed status codes</li>
</ul>
<hr />
<h2 id="common-error-conditions">Common Error Conditions</h2>
<ul>
<li>Invalid payment date</li>
<li>Account not found</li>
<li>Interest calculation errors</li>
<li>Batch posting failures</li>
</ul>
<hr />
<h2 id="technical-implementation">Technical Implementation</h2>
<ul>
<li><strong>Data Structures:</strong> Uses working-storage for payment, account, and batch data</li>
<li><strong>File Handling:</strong> Reads/writes batch logs and payment schedules</li>
<li><strong>Key Algorithms:</strong> Elapsed time calculation, interest accrual, error logging</li>
</ul>
<hr />
<h2 id="integration-points">Integration Points</h2>
<ul>
<li>Called by APIPAY for time-based batch operations</li>
<li>Interfaces with batch log and payment schedule files</li>
</ul>
<hr />
<h2 id="file-dependencies">File Dependencies</h2>
<ul>
<li>Input: Payment schedule file, account file</li>
<li>Output: Batch log file, error log file</li>
<li>Copybooks: LIBLP/LPFSWK.CPY, LIBLP/LPFSOP.CPY</li>
</ul>
<hr />
<h2 id="call-graph-of-performed-paragraphs">Call Graph of PERFORMed Paragraphs</h2>
<div class="mermaid">graph TD
    MAIN --> VALIDATE-INPUT
    VALIDATE-INPUT --> CALCULATE-ELAPSED-TIME
    CALCULATE-ELAPSED-TIME --> ACCRUE-INTEREST
    ACCRUE-INTEREST --> POST-BATCH-PAYMENT
    POST-BATCH-PAYMENT --> LOG-ERROR
</div>
<hr />
<p><em>For further details, see the embedded diagrams and referenced program documentation.</em></p>
        </main>
        <footer>
            <p>Generated on 2025-09-02 15:30:16</p>
        </footer>
    </div>
</body>
</html>