graph TD
    A[MAIN-PROGRAM] --> B[SQL-CONNECT]
    A --> C[GET-GPENV]
    A --> D[SELECTION-MODULE]
    
    D --> E[VALIDATE-TRANSACTION-TYPE]
    D --> F[DISPLAY-ACCOUNT-INFO]
    D --> G[ACCEPT-TRANSACTION-DATA]
    D --> H[PROCESS-PAYMENT-LOGIC]
    
    H --> I[CALCULATE-PAYMENT-DISTRIBUTION]
    H --> J[APPLY-LATE-CHARGES]
    H --> K[PROCESS-ESCROW-COLLECTION]
    H --> L[HANDLE-DEFERMENT-PROCESSING]
    
    J --> M[LPLCAP-ROUTINE]
    K --> N[ESAPPL-PROCESSING]
    L --> O[DEFERMENT-CALCULATION]
    
    I --> P[VALIDATE-BALANCE-CONSISTENCY]
    P --> Q[UPDATE-LOAN-BALANCES]
    Q --> R[WRITE-PAYMENT-HISTORY]
    R --> S[UPDATE-CASH-DRAWER]
    
    D --> T[SPECIALIZED-PROCESSING]
    T --> U[PROCESS-Z2-TRANSACTION]
    T --> V[PROCESS-SS-TRANSACTION]
    T --> W[PROCESS-PX-TRANSACTION]
    T --> X[PROCESS-NONCASH-PAYMENTS]
    
    V --> Y[AUTO-REPO-WINDOW-CHECK]
    X --> Z[GL-DISTRIBUTION-PROCESSING]
    Z --> AA[ALLENT-ROUTINE]
    
    D --> BB[ERROR-HANDLING-ROUTINES]
    BB --> CC[CONDITIONAL-SEND-MESS]
    BB --> DD[ACCEPT-F4-BYPASS]
    BB --> EE[TEST-FOR-PE-AL]
    
    A --> FF[FILE-MANAGEMENT]
    FF --> GG[OPEN-CLOSE-ROUTINES]
    FF --> HH[READ-WRITE-OPERATIONS]
    FF --> II[ERROR-RECOVERY]
    
    A --> JJ[EARNINGS-INTEGRATION]
    JJ --> KK[LPEARN-PROCESSING]
    JJ --> LL[LPCERN-PROCESSING]
    JJ --> MM[ACCUMULATION-UPDATES]
    
    style A fill:#e1f5fe
    style D fill:#fff3e0
    style H fill:#e8f5e8
    style BB fill:#ffebee
    style JJ fill:#f3e5f5
