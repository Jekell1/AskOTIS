graph TD
    A[External Calling Program] --> B[TIM SECTION]
    B --> C[TIMALL]
    C --> D[DATER-ROUTINE]
    D --> E[365-Day Year Calculations]
    D --> F[Date Arithmetic Logic]
    D --> G[Result Processing]
    E --> H[Calculation Results]
    F --> H
    G --> H
    H --> C
    C --> B
    B --> A
    
    I[Payment Calculations] --> B
    J[Interest Calculations] --> B
    K[Account Aging] --> B
    L[Report Generation] --> B
    M[General Date Arithmetic] --> B
    
    B --> N[ELAPSED-DAYS]
    B --> O[ELAPSED-MONTHS]
    B --> P[ELAPSED-REM]
    B --> Q[ELAPSED-RESULTS]
    
    R[TIM360] -.->|360-day alternative| B
    S[TIM999] -.->|Truth-in-lending alternative| B
    T[TIM361] -.->|361-day alternative| B
    
    style B fill:#e1f5fe
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style A fill:#e8f5e8
    style N fill:#fff3e0
    style O fill:#fff3e0
    style P fill:#fff3e0
    style Q fill:#fff3e0
