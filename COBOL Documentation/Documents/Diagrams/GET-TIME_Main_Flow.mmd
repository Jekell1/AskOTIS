graph TD
    A[GET-TIME Entry] --> B[ACCEPT TIME-NOW FROM TIME]
    B --> C{TIME-MILITARY-FG = Y?}
    C -->|Yes| D[Set T-AMPM = blank]
    C -->|No| E{H-AND-M <= 1159?}
    E -->|Yes| F[Set T-AMPM = AM]
    E -->|No| G[Set T-AMPM = PM]
    
    D --> H{12-Hour Format?}
    F --> H
    G --> H
    
    H -->|Yes| I{H-AND-M >= 1300?}
    H -->|No| M
    I -->|Yes| J[Subtract 1200 from H-AND-M]
    I -->|No| K{CUR-HH = 0?}
    J --> K
    K -->|Yes| L[Set CUR-HH = 12]
    K -->|No| M[Format Output Fields]
    L --> M
    
    M --> N[Set T-HH = CUR-HH]
    N --> O[Set T-MM = CUR-MM]
    O --> P[Set T-COL = :]
    P --> Q[Set T-SPACE = blank]
    Q --> R[Reset TIME-MILITARY-FG]
    R --> S[Return]
    
    style A fill:#e1f5fe
    style S fill:#e8f5e8
    style C fill:#fff3e0
    style E fill:#fff3e0
    style H fill:#fff3e0
    style I fill:#fff3e0
    style K fill:#fff3e0
