<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIM - 365-Day Year Timing Calculations</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#e1f5fe',
                primaryTextColor: '#01579b',
                primaryBorderColor: '#0277bd',
                lineColor: '#0288d1',
                secondaryColor: '#f3e5f5',
                tertiaryColor: '#e8f5e8'
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="index.html">Home</a> &gt; <span class="current">TIM - 365-Day Year Timing Calculations</span>
        </nav>
        <main class="content">
<h1>TIM - 365-Day Year Timing Calculations</h1>
<p><strong>Location:</strong> <code>.\APIPAY_Inlined.CBL</code><br />
<strong>Program ID:</strong> TIM<br />
<strong>Program Type:</strong> Date/Time Processing Utility<br />
<strong>Generated on:</strong> July 22, 2025  </p>
<h2>Table of Contents</h2>
<ol>
<li><a href="#program-overview">Program Overview</a></li>
<li><a href="#purpose-and-description">Purpose and Description</a></li>
<li><a href="#technical-implementation">Technical Implementation</a></li>
<li><a href="#inputoutput-specifications">Input/Output Specifications</a></li>
<li><a href="#program-flow">Program Flow</a></li>
<li><a href="#integration-points">Integration Points</a></li>
<li><a href="#usage-examples">Usage Examples</a></li>
<li><a href="#related-utilities">Related Utilities</a></li>
</ol>
<h2>Program Overview</h2>
<p><strong>Program Name:</strong> TIM<br />
<strong>Program Type:</strong> Date/Time Processing Utility<br />
<strong>Primary Function:</strong> Standard 365-Day Year Timing Calculations<br />
<strong>Source Location:</strong> APIPAY_Inlined.CBL lines 16695-16698<br />
<strong>Usage:</strong> Calculate elapsed time between dates using standard 365-day year  </p>
<h2>Purpose and Description</h2>
<p>TIM is a simple wrapper utility that provides standard 365-day year calculations by configuring and calling the comprehensive TIMALL routine. It represents the most common timing calculation method used in financial and business applications.</p>
<h3>Key Responsibilities</h3>
<ol>
<li><strong>Year Type Configuration</strong> - Set elapsed year type to 365 days</li>
<li><strong>TIMALL Integration</strong> - Delegate processing to comprehensive timing engine</li>
<li><strong>Standard Calendar</strong> - Provide standard Gregorian calendar calculations</li>
<li><strong>Simple Interface</strong> - Offer streamlined access to common timing functionality</li>
</ol>
<h3>365-Day Year Model</h3>
<p>The TIM utility uses a standard 365-day year calculation method:
- <strong>Year Length</strong>: 365 days (standard non-leap year)
- <strong>Month Handling</strong>: Standard calendar months with actual day counts
- <strong>Leap Year Treatment</strong>: Typically ignored or handled separately
- <strong>Calculation Basis</strong>: Most common financial calculation method</p>
<h2>Technical Implementation</h2>
<h3>Input Parameters</h3>
<ul>
<li><strong>NUM-DATE</strong> - From date in YYYYMMDD format</li>
<li><strong>SYS-DATE</strong> - To date in YYYYMMDD format</li>
<li>All other parameters inherited from TIMALL interface</li>
</ul>
<h3>Output Parameters</h3>
<ul>
<li><strong>ELAPSED-DAYS</strong> - Number of days between dates</li>
<li><strong>ELAPSED-MONTHS</strong> - Number of months between dates</li>
<li><strong>ELAPSED-REM</strong> - Remaining days after month calculation</li>
<li><strong>ELAPSED-RESULTS</strong> - Comparison result indicators</li>
<li>All other outputs provided by TIMALL</li>
</ul>
<h3>Processing Logic</h3>
<p><img alt="TIM Main Flow" src="Diagrams/TIM_Main_Flow.mmd" /></p>
<h4>Core Implementation</h4>
<pre><code class="language-cobol">TIM SECTION.
    MOVE 365 TO ELAPSED-YRTYPE.
    PERFORM TIMALL.
</code></pre>
<h3>Algorithm Steps</h3>
<ol>
<li><strong>Year Type Setup</strong></li>
<li>
<p>Sets ELAPSED-YRTYPE to 365 to specify standard year calculations</p>
</li>
<li>
<p><strong>Delegate Processing</strong></p>
</li>
<li>Calls TIMALL which performs all actual timing calculations</li>
<li>
<p>TIMALL uses the 365-day year type for its internal algorithms</p>
</li>
<li>
<p><strong>Result Propagation</strong></p>
</li>
<li>All results generated by TIMALL are available to caller</li>
<li>No additional processing or result modification</li>
</ol>
<h2>Input/Output Specifications</h2>
<h3>Input Fields (Inherited from TIMALL)</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NUM-DATE</td>
<td>Numeric</td>
<td>YYYYMMDD</td>
<td>Starting date for calculation</td>
</tr>
<tr>
<td>SYS-DATE</td>
<td>Numeric</td>
<td>YYYYMMDD</td>
<td>Ending date for calculation</td>
</tr>
</tbody>
</table>
<h3>Output Fields (Inherited from TIMALL)</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ELAPSED-DAYS</td>
<td>Numeric</td>
<td>Integer</td>
<td>Total days between dates</td>
</tr>
<tr>
<td>ELAPSED-MONTHS</td>
<td>Numeric</td>
<td>Integer</td>
<td>Month difference</td>
</tr>
<tr>
<td>ELAPSED-REM</td>
<td>Numeric</td>
<td>Integer</td>
<td>Remaining days</td>
</tr>
<tr>
<td>ELAPSED-RESULTS</td>
<td>Char</td>
<td>Various</td>
<td>Comparison indicators</td>
</tr>
</tbody>
</table>
<h3>Configuration Fields</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>ELAPSED-YRTYPE</td>
<td>365</td>
<td>Specifies 365-day year calculations</td>
</tr>
</tbody>
</table>
<h2>Program Flow</h2>
<p><img alt="TIM Call Graph" src="Diagrams/TIM_Call_Graph.mmd" /></p>
<h3>Execution Flow</h3>
<ol>
<li><strong>Entry Point</strong>: TIM SECTION called by external routines</li>
<li><strong>Configuration</strong>: ELAPSED-YRTYPE set to 365</li>
<li><strong>Delegation</strong>: TIMALL performs all calculations</li>
<li><strong>Completion</strong>: Control returns to caller with TIMALL results</li>
</ol>
<h3>Call Chain</h3>
<pre><code>Calling Program → TIM → TIMALL → DATER-ROUTINE → [Year-Type Calculations] → Return
</code></pre>
<h2>Integration Points</h2>
<h3>Called By</h3>
<ul>
<li><strong>Payment calculations</strong> - Standard monthly payment computations</li>
<li><strong>Interest calculations</strong> - Standard interest accrual periods</li>
<li><strong>Aging analysis</strong> - Account aging using standard calendar</li>
<li><strong>Report generation</strong> - Standard time period reporting</li>
<li><strong>General date arithmetic</strong> - Common business date calculations</li>
</ul>
<h3>Calls To</h3>
<ul>
<li><strong>TIMALL</strong> - Comprehensive timing calculation engine</li>
<li><strong>DATER-ROUTINE</strong> - Core date processing (through TIMALL)</li>
</ul>
<h3>Usage Context</h3>
<p>TIM is used when standard calendar calculations are needed without special year-type considerations:
- Most common business calculations
- Standard financial reporting
- General-purpose date arithmetic
- Non-specialized timing requirements</p>
<h2>Usage Examples</h2>
<h3>Basic Elapsed Time Calculation</h3>
<pre><code class="language-cobol">MOVE 20240101 TO NUM-DATE     * January 1, 2024
MOVE 20240401 TO SYS-DATE     * April 1, 2024  
PERFORM TIM
* Results available in ELAPSED-DAYS, ELAPSED-MONTHS, etc.
DISPLAY &quot;Days elapsed: &quot; ELAPSED-DAYS
DISPLAY &quot;Months elapsed: &quot; ELAPSED-MONTHS
</code></pre>
<h3>Payment Period Calculation</h3>
<pre><code class="language-cobol">MOVE LOAN-START-DATE TO NUM-DATE
MOVE CURRENT-DATE TO SYS-DATE
PERFORM TIM
IF ELAPSED-MONTHS &gt;= PAYMENT-GRACE-PERIOD
   PERFORM CALCULATE-PAYMENT-DUE
ELSE
   PERFORM APPLY-GRACE-PERIOD
END-IF
</code></pre>
<h3>Account Aging Example</h3>
<pre><code class="language-cobol">MOVE ACCOUNT-OPEN-DATE TO NUM-DATE
MOVE SYSTEM-DATE TO SYS-DATE
PERFORM TIM
EVALUATE ELAPSED-DAYS
   WHEN 0 THRU 30
        MOVE &quot;CURRENT&quot; TO AGING-STATUS
   WHEN 31 THRU 60
        MOVE &quot;30-DAY&quot; TO AGING-STATUS
   WHEN 61 THRU 90
        MOVE &quot;60-DAY&quot; TO AGING-STATUS
   WHEN OTHER
        MOVE &quot;90+ DAY&quot; TO AGING-STATUS
END-EVALUATE
</code></pre>
<h3>Interest Accrual Calculation</h3>
<pre><code class="language-cobol">MOVE LAST-INTEREST-DATE TO NUM-DATE
MOVE CURRENT-DATE TO SYS-DATE
PERFORM TIM
COMPUTE ACCRUED-INTEREST = PRINCIPAL-BALANCE * 
                          INTEREST-RATE * 
                          ELAPSED-DAYS / 365
</code></pre>
<h2>Performance Considerations</h2>
<ul>
<li><strong>Efficiency</strong>: Minimal overhead - just sets year type and delegates</li>
<li><strong>Memory Usage</strong>: No additional working storage required</li>
<li><strong>Processing Time</strong>: Identical to TIMALL with 365-day year type</li>
<li><strong>Optimization</strong>: Direct delegation provides maximum efficiency</li>
</ul>
<h2>Comparison with Related Utilities</h2>
<h3>TIM vs Other Year Types</h3>
<table>
<thead>
<tr>
<th>Utility</th>
<th>Year Type</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>TIM</td>
<td>365</td>
<td>Standard business calculations</td>
</tr>
<tr>
<td>TIM360</td>
<td>360</td>
<td>Financial industry standard</td>
</tr>
<tr>
<td>TIM361</td>
<td>361</td>
<td>Specialized financial calculations</td>
</tr>
<tr>
<td>TIM362</td>
<td>362</td>
<td>Hybrid calculation method</td>
</tr>
<tr>
<td>TIM365</td>
<td>365</td>
<td>Identical to TIM</td>
</tr>
<tr>
<td>TIM367</td>
<td>367</td>
<td>Leap year inclusive</td>
</tr>
<tr>
<td>TIM999</td>
<td>999</td>
<td>Truth-in-lending calculations</td>
</tr>
</tbody>
</table>
<h3>When to Use TIM</h3>
<ul>
<li>General business date calculations</li>
<li>Standard accounting periods</li>
<li>Non-financial timing requirements  </li>
<li>Default choice for most applications</li>
</ul>
<h2>Error Handling</h2>
<h3>Error Conditions (Inherited from TIMALL)</h3>
<ul>
<li>Invalid date formats in NUM-DATE or SYS-DATE</li>
<li>Zero dates passed to calculation</li>
<li>Date range limitations</li>
</ul>
<h3>Error Processing</h3>
<pre><code class="language-cobol">PERFORM TIM
IF ELAPSED-RESULTS = SPACES
   DISPLAY &quot;TIM CALCULATION ERROR&quot;
   PERFORM ERROR-HANDLING
ELSE
   PERFORM PROCESS-TIMING-RESULTS
END-IF
</code></pre>
<h2>Quality Assurance</h2>
<h3>Test Cases</h3>
<table>
<thead>
<tr>
<th>From Date</th>
<th>To Date</th>
<th>Expected Days</th>
<th>Expected Months</th>
</tr>
</thead>
<tbody>
<tr>
<td>20240101</td>
<td>20240201</td>
<td>31</td>
<td>1</td>
</tr>
<tr>
<td>20240101</td>
<td>20240701</td>
<td>182</td>
<td>6</td>
</tr>
<tr>
<td>20240101</td>
<td>20241231</td>
<td>365</td>
<td>12</td>
</tr>
<tr>
<td>20240229</td>
<td>20240301</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<h3>Validation Points</h3>
<ul>
<li>Results should match TIMALL with ELAPSED-YRTYPE = 365</li>
<li>Standard calendar behavior expected</li>
<li>Consistent with business calculation conventions</li>
</ul>
<h2>Related Documentation</h2>
<ul>
<li><strong><a href="C-TIMALL_Documentation.html">TIMALL Documentation</a></strong> - Comprehensive timing calculation engine</li>
<li><strong><a href="TIM360_Documentation.html">TIM360 Documentation</a></strong> - 360-day year calculations</li>
<li><strong><a href="TIM999_Documentation.html">TIM999 Documentation</a></strong> - Truth-in-lending calculations  </li>
<li><strong><a href="DATER-ROUTINE_Documentation.html">DATER-ROUTINE Documentation</a></strong> - Core date processing</li>
<li><strong><a href="APIPAY_Documentation.html#datetime-processing-utilities">Date/Time Processing Overview</a></strong> - Complete utilities listing</li>
</ul>
<h2>Maintenance Notes</h2>
<h3>Design Patterns</h3>
<ul>
<li><strong>Wrapper Pattern</strong> - Simple wrapper around TIMALL functionality</li>
<li><strong>Configuration Pattern</strong> - Sets specific parameters for delegation</li>
<li><strong>Delegation Pattern</strong> - All processing delegated to specialized engine</li>
</ul>
<h3>Modification Guidelines</h3>
<ul>
<li>Avoid changing the year type value (365)</li>
<li>Maintain compatibility with TIMALL interface</li>
<li>Ensure consistency with other TIM variants</li>
<li>Preserve delegation relationship with TIMALL</li>
<li>Test against standard business calculation expectations</li>
</ul>
        </main>
        <footer>
            <p>Generated on 2025-07-22 16:03:01</p>
        </footer>
    </div>
</body>
</html>